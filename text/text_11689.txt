BACKGROUND
barley  is among the four most important cereal crops worldwide  <cit> . but in contrast to its agronomical importance efficient gene isolation and genome-wide studies on genetic diversity are hampered by the lack of a reference genome sequence. such a reference would resolve barley's genetic outfit and would serve as the essential basis to elucidate mechanisms underlying phenotype and traits as well as processes towards plant's adaptation and improvement.

genome size  and the high content of repetitive dna elements  are the major obstacles towards sequencing the entire barley genome  <cit> . in contrast to sanger sequencing  <cit>  for a budget of over  <dig> million usd  a medium sized plant genome like rice , the same endeavor for barley was not affordable . here, the massively parallel or "next generation sequencing"  technologies, currently represented by the 454/roche, solexa/illumina and solid/abi platforms, promise to change the situation since several gigabases  of sequence data can be accumulated in a few weeks for only a fraction of the costs of sanger sequencing . ngs technology was successfully applied to de novo and re-sequencing of entire prokaryotic genomes  <cit>  and to re-sequencing higher eukaryotes including humans  <cit> . recently, similar efforts were made in plants by using the solexa/illumina platform for re-sequencing of arabidopsis thaliana  <cit>  and by a mixed sanger and 454/roche sequencing strategy for grapevine   <cit> . whereas the relatively short read lengths of the solexa/illumina  and abi  platforms  may not yet match the requirements to sequence efficiently across long stretches of repetitive dna in barley, the 454/roche system  allows to generate average read lengths of ~ <dig> bp  and ~ <dig> bp  which are potentially more appropriate to achieve the goals of de novo sequencing in complex genomes. however, it remains to be proven whether this holds true with regard to the extraordinarily high content of repetitive dna elements within the barley genome, often forming blocks extending over regions of several  <dig> kb  <cit> .

independently of the platform, two different sequencing strategies are widely used. whole genome shotgun  sequencing is based on random shearing of whole genomic dna and is preferentially applied to medium sized genomes with limited amounts of repetitive dna. for plant genomes, wgs by ngs was so far restricted to re-sequencing purposes if a reference sequence was available  and to de novo sequencing  of small and medium sized genomes like strawberry   <cit>  and sorghum bicolor   <cit> , or with support of non-ngs data   <cit> .

the second, hierarchical shotgun  approach is based on sequencing bacterial artificial chromosomes  anchored to a physical map . this strategy is more costly than wgs but in return is suitable to generate high quality reference sequences even for highly repetitive genomes  <cit> . the map-based strategy was not only applied to sequencing the human genome but also to plant genomes such as arabidopsis  <cit> , rice  <cit>  and maize  <cit> . due to its accuracy and reliability, the "clone-by-clone" strategy was also favored for producing a high-quality reference sequence of the barley genome  <cit> .

previously, it was demonstrated that genes could be assembled into contigs when barley bacs were sequenced by short reads of ~ <dig> bp provided by the earlier 454/roche platform  at sequence coverage of ~ <dig> - 20-fold  <cit> . similar results were obtained by sequencing bac clones of salmon  using the gs flx , however, the potential of the method to result in high-quality bac clone sequences was put in question  <cit> .

based on these initial studies the 454/roche platform can be considered a robust platform to assemble genes from genomic sequences given sufficient sequence coverage. however, at sequencing capacity of up to  <dig> mb per single gs flx titanium run the sequencing of individual bac clones would be a rather non-economical approach and efficient use of the technology would require the possibility of multiplexing individual samples. recently, pools of  <dig> bac clones of wild rice oryza barthii, selected from fingerprinted contigs, were sequenced by the  <dig> technology and assembled to superscaffolds by mapping to the o. sativa rice reference genome  <cit> . due to the lack of a reference genome this bac pool sequencing approach is not yet feasible for barley and multiplex sequencing would require a reliable tagging  strategy to reveal sequence read and bac clone origin relationships. barcodes are specific short sequence tags that can be introduced either before the  <dig> sequencing library preparation  <cit>  or by ligation of individual adaptors  to fragmented bac dnas prior to sequencing in pools.

here, as a proof of concept for a new strategic component of sequencing a large complex and highly repetitive crop plant genome in a clone-by-clone approach, we report the pool sequencing of  <dig> barcoded, randomly selected, gene containing barley bacs by the  <dig> technology. furthermore, we present the assembly of the sequence data under variable parameters and evaluate the resulting assemblies for their consistency and reliability.

RESULTS
sequencing and preassembly processing
initially,  <dig> non-overlapping bacs were selected based on the information to carry at least one gene  <cit> . five of these clones, were previously sanger-sequenced by others and deposited at ncbi genbank . whereas the sequence of one bac clone  is an unfinished htgs <dig> phase entry  <cit>  encompassing  <dig> unordered contigs, the four others  were available as finished sequence and served as reference to monitor the quality of the  <dig> sequencing and assembly. in the following these four clones are referred to as 'reference bacs'.

in two different laboratories, one set each of  <dig> independent bacs plus the same five reference bacs were barcode tagged by two different strategies and sequenced in pools on roche gs flx sequencers.

for the vast majority of all reads , the correct barcoding adaptor motifs could be recognized allowing the unambiguous assignment of sequences to the corresponding bacs. this resulted in  <dig>  reads per clone on average except for  <dig> bacs of set  <dig> with less than  <dig>  sequences per clone , prompting to re-sequence them. after that, altogether the bacs of both sets were represented by  <dig> , <dig> reads . since absolute accuracy and lack of any bias in clone size estimation, barcoding, determination of dna concentration, equimolar pooling and library preparation is rather impossible, deviations from the expected equal read recovery rate per bac clone were expected. in fact, with a ratio of minimum to maximum number of reads per bac of 1: <dig>  we observed such deviations as illustrated in fig.  <dig> and additional file 1: table s <dig> 

after clipping of the bac specific barcodes the obtained sequences were processed following the assembly pipeline depicted in fig.  <dig>  in the preprocessing phase, reads derived from bac vector and e. coli dna were discarded  leaving  <dig> , <dig> sequences with average read length of  <dig> bp  for assembly. presuming that the combined length of all contigs per assembly represented the overall bac insert length, the obtained sequencing coverage by  <dig> reads ranged between  <dig> × and  <dig> × per individual bac clone  with an average of  <dig> ×. if considering the accumulated contig length per bac after assembly equals true insert length  this coverage corresponded to average  <dig>  reads per  <dig> kb insert.

mapping  <dig> sequences to sanger references
to evaluate how completely and evenly the clone inserts were represented by the obtained sequences we mapped the  <dig> reads of the reference bacs from both sets to the complete sanger sequences by blastn  <cit>  . considering all blastn matches with e-values < 10- <dig>  altogether  <dig>  out of  <dig>  reference positions  were hit by  <dig> reads. a similar result was obtained by evaluating exclusively the best blastn alignments. if two or more hits with the same maximum match score were obtained, one of the alternative hits was randomly chosen. by this algorithm  <dig>  reference positions  were covered.

examination of the blastn alignments also provided distribution patterns of the  <dig> reads along the sanger reference sequences, as exemplarily illustrated for bacs 259i <dig> and 711n <dig> from both sets . for all eight alignments,  <dig>  positions of the reference sequences  were covered by at least five sequences. only  <dig>  positions  were covered less than fivefold.

optimal assembly parameters differ both between bacs and sequence sets
for assembly of the  <dig> sequences we tested initially the program newbler , and subsequently mira  <cit> . since all assemblies obtained with the latter program resulted in significantly higher n50/n <dig> contig lengths and less gaps when compared to the sanger references, sequence assembly by newbler was skipped for further analysis of the data. using mira, hss and bph  were the two parameters which most strongly influenced contig numbers and lengths during assembly. however, while systematically changing the values of these parameters during assembly of all bac clones, we were not able to identify a distinct or at least a restricted number of hss/bph combinations that outperformed others in regard to yielding the largest contigs for each individual bac. the most suitable hss/bph combination to obtain the longest contigs differed between bacs as well as the set in which the data were generated .

sequence assembly under iterative parameter changes
since optimal ab initio assembly parameters could not be defined, the clipped sequences were assembled by mira with  <dig> iterative changes of the hss/bph parameter set for each of the  <dig> bac data sets, resulting in  <dig>  assemblies. for each clone, the assembly with the largest contig was defined as the 'best assembly' and selected for further analyses. as expected from the parameter optimization attempts , this approach led to assemblies with less and larger contigs as compared with assemblies obtained under default settings  .

for 68%  of the best assemblies, the largest contig spanned more than  <dig> kb. in  <dig> assemblies , the number of contigs > <dig> kb was lower than  <dig> at a 21× mean sequence coverage, in  <dig> assemblies  lower than  <dig> with a 20× mean coverage. fig.  <dig> summarizes the  <dig> best assemblies by depicting all contigs larger than  <dig> kb.

altogether, the  <dig> best alignments spanned  <dig> , <dig> bp in  <dig> contigs > <dig> kb  with n50> <dig>  kb  and an average coverage of 22×. in terms of sequence quality 94%, 97% and 99% of the sequence were represented with phred confidence values  <cit>  above q <dig>  q <dig> and q <dig>  respectively. a detailed inspection for sequencing errors was done by comparing the contigs of the  <dig> best mira assemblies with the sanger reference sequences . over a total length of  <dig>  bp inspected sequence,  <dig> differences were found, thereof  <dig> single base exchanges and  <dig> single base insertions/deletions. this corresponded to a mean phred confidence value of q <dig>  ranging from q <dig> to q <dig> among the  <dig> assemblies. the majority of sequencing errors was identified within homo-nucleotide stretches . this type of error is known as intrinsic for the pyrosequencing based  <dig> technology. these errors could be resolved by additional sequences generated by other technologies.

the assemblies of six bacs from set  <dig> resulted in exceptionally high contig numbers or particularly short contig lengths compared to the other clones . for two bacs , this is due to low amounts of  <dig> reads even after re-sequencing . another two clones  have considerably longer inserts than the others  and were therefore not sufficiently covered by  <dig> reads to get satisfactory assemblies. for 551k <dig> a fair number of reads was obtained but the assembly represented only 87% of the insert length expected by restriction fingerprinting. here, repetitive regions were assumed as underlying reason since parts of three contigs in the assembly are covered by more sequences than the two-fold median of the entire clone . in the 569h <dig> assembly, parts of nearly all contigs were overrepresented by  <dig> reads indicating a high amount of repetitive structures hampering an assembly with less contigs .

consistency of assemblies
to evaluate the assembly completeness and consistency, we compared in detail the best mira assemblies of the four reference bacs from both sets to their sanger-derived sequences which were assumed to reflect the genuine bac inserts. these comparisons resulted in eight tuple plots  and showed that globally all parts of the reference sequence were represented in the  <dig> assemblies. within the entire set of  <dig> contigs > <dig> kb we observed nine mis-assemblies in nine contigs . four out of the five sequence parts affected by wrong assemblies in set  <dig> were identical to those in set  <dig> indicating that always the same repetitive structures were the underlying cause. indeed, by closer inspection of the mis-assembled regions, different types of repetitive elements were identified which caused all incorrect assemblies . thus, by the chosen assembly strategy we can estimate that about  <dig>  mis-assemblies  can be expected per bac, preferentially in repetitive regions. based on  <dig> mis-assembled contigs out of  <dig> in the reference bac clones, about  <dig> out of  <dig> contigs > <dig> kb  might be affected within the entire dataset of > <dig> mb.

gene content and representation
to test to which degree the  <dig> de novo sequenced bac clones contained genes and to measure the completeness and sequence integrity of the respective genes, we compared all contigs of the best mira assemblies with three protein   <cit>  and two est libraries   <cit> . the protein and est references were aligned against the contigs using genomethreader  <cit>  and the coverage of the query sequences against the homologous regions was measured as a proxy for completeness of the respective gene locus and to evaluate assembly correctness on gene containing regions on the hordeum contigs .

on the contig level, brachypodium proteins hit  <dig> contigs, rice  <dig> and sorghum  <dig> contigs.  <dig> contigs were hit by at least one protein entry,  <dig> were hit by all three libraries. on the bac level, brachypodium proteins hit  <dig> bacs, rice  <dig> and sorghum  <dig> bacs. a total of  <dig> out of  <dig> bacs hit at least one protein,  <dig> bacs contained at least one gene that showed similarity to all three databases. the reproducibly larger number of sequence matches with genes of brachypodium was consistent with the closer phylogenetic relationship to barley compared to the two other fully sequenced grass reference genomes of rice and sorghum  <cit> . a comparison to barley and wheat ests revealed  <dig>  hits  and  <dig>  hits , respectively.

in total,  <dig> genes or gene fragments were identified.  <dig>  were supported by hits to all grass model species ,  <dig>  to two and  <dig>  to only one grass species. for  <dig> genes , on average > <dig>  of the gene was covered, for  <dig> genes  ≥  <dig> . this indicated that the genomic sequences of the orthologous barley genes were almost completely represented on the contigs . however, for three genes  a representation < <dig>  was determined, indicating a partial presence in the respective assemblies. to analyze the underlying reasons, the assemblies were manually inspected. in one gene locus a frameshift was found causing an interrupted alignment. adjustment of the frameshift resulted in an uninterrupted reading frame with full gene coverage. the second case of under-representation has potentially been caused by a truncated pseudogene, as indicated by the absence of start and stop codon and the lack of complementary gene fragments on other contigs. finally, for the third gene we found two complementary fragments located on two contigs from the respective bac. thus in summary, for  <dig> of  <dig> predicted genes  the assembly resulted in coherent gene loci on individual contigs and only one gene appeared to be split between two contigs.

we also tested for consistency of exon order and orientation to identify potential mis-assemblies. no such events were observed. thus, using gene containing regions as a measure we found no evidence for wrong assemblies indicated by missing exons, wrong exon order or orientation .

discussion
the high-throughput capacity of next generation sequencing  platforms promises new possibilities for sequencing large and complex genomes. due to shorter read length as typically obtained in comparison to classical sanger sequencing the full potential for de novo sequencing of plant genomes carrying more than 80% repetitive dna, however, still needs to be demonstrated for ngs technologies. in the present pilot study we prove that  <dig> sequencing of pools of barcoded barley bacs and automated, sequence assembly can efficiently contribute to map-based clone-by-clone whole genome sequencing of a triticeae genome. sequencing of  <dig> barley bac clones including four clones sequenced twice with independent strategies and comparison to the complete sanger reference sequences revealed that 20- <dig> fold shotgun sequencing routinely lead to htgs phase  <dig> assemblies . furthermore, mapping of sequence reads to the sanger references demonstrated the evenness of read distribution except for repetitive regions of high nucleotide identities.

sequence output and assembly conditions
sequence read length is known to be one of the key parameters influencing the efficiency to sequence and assemble stretches of repetitive dna of a genome. in the present study, reads with average lengths between 200- <dig> bp were obtained, which are typical for the 454/roche gs flx platform. at a 20-25-fold sequence coverage, the majority of the assemblies achieved htgs phase i quality with n <dig> ~ <dig> kb and less than  <dig> unordered contigs. this is comparable to a typical sanger shotgun sequencing to 6-fold or higher coverage. although it can not be ruled out that pre-selection of the clones for gene content may have positively influenced the assembly performance and results, this indicated that neither the moderate sequence lengths nor the high repeat content of the genome caused principle limitations for de novo sequencing of gene-containing barley bacs by the  <dig> technology.

our results differed from those of another study describing the  <dig> sequencing of pooled but not barcoded salmon bac clones  <cit> . here, the obtained moderate contig lengths  were interpreted as indication that considering  <dig> flx sequencing without additional paired end sequences alone would provide a too limited strategy in context of a complex eukaryotic genome sequencing project. yet to our understanding the moderate contig lengths could be caused by the limitations of the newbler assembly software. in our study, with the sequences of the reference bacs, newbler produced assemblies in which different copies of repetitive elements were not correctly separated. in contrast, mira  <cit>  could resolve these structures and superior assemblies were obtained. however, not only the assembly algorithm influences contig length. assembly quality is usually negatively correlated to the concentration of related repeated dna elements in the target sequence. pooling bac clones without barcoding would extend the overall sequence length to be assembled and thus increases the chance for coincidental presence of members of highly conserved repetitive element families in the selected set of pooled bacs. this ultimately interferes with assembly quality and thus may explain to some extent the shorter assemblies obtained in case of salmon/newbler.

applying iterative changes of different mira assembly parameters revealed that mainly hss  and bph  affected the outcome of the assemblies. aiming for those with the largest contig per individual clone as the postulated best assemblies, the key parameters were found to be variable and unpredictable. this holds true not only for the assembly of different bacs but also when assembling the sequences of the same bac from different sequencing sources . different hss and bph parameters leading to the best assemblies of different bacs indicated that at a given minimum sequence coverage individual features like repeat content and/or composition may essentially influence the quality of the assembly. the fact that different sequence sets from the same bac - although both being representative for the sequenced clone - required different parameters for yielding a 'best' assembly, suggested that experimental and stochastic conditions like fragmentation profile, library representativeness and sequence length distribution influenced the outcome of the assemblies. furthermore, it cannot be ruled out that the sequential order of individual reads fed into the assembly controlled the final outcome of the assembly.

with respect to these findings, iterative assembly with as many as reasonable parameter permutations as carried out in our study, seemed appropriate while consuming considerable computing time and performance. selection of the best assembly as the one with the largest contig might be questionable, since production of chimeric contigs can be suspected and other metrics are probably better indicators for a low number of mis-assemblies. to address this we counted mis-assemblies and chimeric contigs in assemblies selected by the best n <dig>  n <dig>  and n <dig> values and by default parameters, respectively . as a result, compared to the largest contig metric  n <dig>  n <dig> and n <dig> led to similar numbers  and application of the default mira parameters even produced  <dig> errors. furthermore, except for one case , none of the alternative metrics generated less chimeric contigs than the respective largest contig assemblies. this indicated that selection of the latter metrics did not warrant for the lowest number of mis-assemblies but was indeed a reasonable criterion due to lack of expensive validation experiments.

assemblies, genes and repeat structures
for de novo sequenced bacs we demonstrated that all genes present on the clones were practically completely represented in the best mira assemblies. furthermore, with the exception of one gene, all orfs were found uninterrupted by gaps between contigs. this outcome has been postulated before in another pilot study applying the roche/ <dig> gs <dig> sequencing to barley bacs  <cit> . therefore, the selected approach of pooled bac sequencing should enable to survey the entire gene content of the targeted bacs. other, maybe more cost effective, approaches of reduced representation sequencing were published that are suited to survey gene content of a complex genome . however, our presented strategy of barcoded bac-pool sequencing delivered not only fully assembled gene sequences instead of partial gene information but could also serve as the basal approach for whole genome clone-by-clone sequencing in complex plant genomes.

on the other hand, comparing the assemblies of the four reference bacs to the sanger-derived sequences also revealed limitations of the automated assembly of complex repetitive dna regions. mis-assemblies in these clones were observed preferentially in ltr regions of retrotransposons. ltr transposons are very frequent in barley and the occurrence of such elements with nucleotide identities of up to >99% in several copies is known to complicate even the assembly of sanger sequenced bacs. wrong assemblies in regions harboring such elements typically can occur in two ways:

 sequences derived from different copies of the repeat "collapse" into one single region, finally "shortening" the consensus sequence . since this normally should be accompanied by significantly increased sequence coverage in the "collapsed" region, those effects are possibly amenable to automated pattern recognition and thus could become corrected by reassembly under modified conditions. the "collapse" assembly problem is a strong argument for the selection of the assembly producing the largest contig as the optimal one. however, the fact that the best assembly of 184g <dig>  produced the largest contig by falsely resolving the retrotransposon structure , whereas, in contrast, the default assembly produced shorter contigs but no mis-assembly , indicated that the "largest-is-best-rule" remains a simplification and is not universally valid.

 repetitive sequences are correctly split into different copies but the copies are arranged in the wrong order and/or direction. this type of incorrect assembly can not be detected without the availability of a reference sequence or knowledge about the involved types of repeats.

in both cases the use of paired end/mated pair sequencing approaches may help to overcome such shortcomings in the future. paired-end sequencing applications are available and protocols for the preparation of libraries with read distances of ~ <dig> bp  and 2- <dig> kb  were successfully applied  <cit> . in combination with the barcoding step this strategy may introduce inacceptable additional labour to the bac pool sequencing. therefore, additional non-barcoded paired end/mate-pair libraries could be prepared for an alternative higher throughput, shorter read ngs platform from the same sets of bacs which were already processed as barcoded pools by the  <dig> technology. assembly errors in structural variants could be resolved in a similar context by deep coverage paired end illumina sequencing with different fragment size in human whole genome sequencing  <cit> . in our case, as an example, the untagged fragments of  <dig> pools of  <dig> bacs  could be mixed and converted into illumina paired end and/or mate pair libraries, respectively. sequencing of such a library in just one lane on the illumina gaii platform usually could produce  <dig> ×  <dig> mio. reads at affordable costs. this would deliver clone coverages between ~150× for a  <dig> bp distance paired end library and ~ <dig> × for a  <dig> kb distance mate pair library. reads from the  <dig> bp insert library may only resolve errors in homopolymer stretches known as a methodological shortcoming of the  <dig> pyrosequencing method. in contrast, sequences from the longer distance mate pair library will help to bridge and order contigs of the  <dig> assemblies since the distance between the corresponding reads should be larger than repetitive elements hampering the joining of contigs. furthermore, assembly errors will be identified by verification of direction and distance of the mate read pairs. such a mixed two step strategy should allow the establishment of a largely automated bac assembly and verification pipeline.

CONCLUSIONS
proving the initial concept, our study has demonstrated that multiplex sequencing of barcoded bacs by the  <dig> technology is appropriate for a clone based strategy of sequencing complex plant genomes. though the content of complex repeat structures causes pitfalls for the assembly process, the sequence information obtained with a >20× coverage was highly representative for gene containing barley bacs by producing assemblies with n <dig> ~ <dig> kb  and q <dig> ~94%, which in most cases yielded phase i assemblies . whereas the majority of contigs were expected to be correctly assembled in their gene loci, bacs harbouring complex repetitive structures will require additional experimental efforts to yield final assemblies. this may encompass paired end genomic sequencing approaches as well as gap closure by primer walking and sanger sequencing of individual reads.

