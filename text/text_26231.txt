BACKGROUND
patterns of genetic diversity in populations of infectious agents contain important information about their epidemiology and evolution. they depend on the population dynamics of the infectious agents, which involves their replication within hosts and transmission between hosts, their mutation and recombination rate. infectious agents vary enormously in their ability to mutate and to transmit, which will lead to large differences in levels of variability. furthermore there can be variation within an infectious species for the ability to evade the host immune system. in fact, infectious agent genetic diversity can help in targeting genes under selection pressure created by the immune system  <cit> . in addition patterns of infectious agent variation can, under certain circumstances, be used to infer host population history  <cit> , and the level of infectious agent genetic structure may reflect its evolutionary potential  <cit> . importantly, the need for a continuous integration between population genetics and epidemiology has been increasingly recognized  <cit> .

in population genetics the standard neutral model has a long history in dna sequence data analysis  <cit> , and has been extensively used as a null model for understanding genetic variation in natural populations, including that in our own species  <cit> . the standard neutral model makes several simplifying assumptions: in particular it makes the simple assumption that individuals form one single constant size population. when considering populations of infectious agents it is much more reasonable to assume, as the null model, a population composed of a collection of much smaller populations.

here we develop population genetics models of structured populations, that incorporate epidemiological parameters explicitly, in order to study genetic variability under one of the simplest possible epidemiological models. we ask mainly two questions: 1) what do levels and patterns of sequence variation in these infectious agents look like under this model? and 2) how does host contact structure influence their diversity?

the models we will study here are very similar to the metapopulation models where each subpopulation can go extinct and be recolonized  <cit> . generally studies of genetic diversity in such subdivided populations  <cit>  assume a simple symmetric topology for the metapopulation – the most well studied is the island model of wright. simple as it is, this model has provided a wealth of results that have led to enormous contributions to our understanding of evolution in structured populations  <cit> . nevertheless, there are several reasons to think that this model is too simple to be readily applicable to natural populations  <cit> , especially if the goal is to understand molecular diversity of infectious agents. as we know, the underlying topology at which certain disease epidemics and spreading takes place is that of social networks  <cit> . several recent investigations have demonstrated that real networks of interaction have a much more complex structure than those predicted by totally regular networks or totally random networks  <cit> . most real networks of social interactions present two different topological properties: a low average pairwise distance between nodes and a high clustering degree .

the former occurs in random networks and the latter in regular networks. in such way, some models of network topologies have been recently proposed in the literature . one of the most successful models for network structure is the scale-free network  <cit> . in addition to the common properties of real interaction networks, in scale-free networks the distribution of connectivities obeys a power-law distribution as p∝ki−γ
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgqbaucqggoaakcqwgrbwadawgaawcbagaemyaakgabeaakiabcmcapiabg2hi1kabdugarnaadaaaleaacqwgpbqaaeaacqghsisliigacqwfzowzaaaaaa@3979@, which is observed in some actual systems ranging from world wide web to the network of human sexual contacts  <cit> . as initially proposed, scale-free networks are dynamical networks where growth and preferential attachment are some of the key mechanisms.

accordingly, each newly introduced node in the network preferentially joins with an already well connected-node. as a result, it will produce a highly heterogeneous network where most nodes have a low connectivity while a few nodes display a very large connectivity. these latter ones are referred to as hubs. the understanding of the interplay between the underlying topology and the forces driving systems is of crucial relevance  <cit> . one example of this, that has received a great deal of attention, is that of network epidemiology: the study of epidemic and disease spreading  <cit> , which are strictly tied to the topology of social contact networks. in this context, a striking result has arisen from the study of the classical susceptible-infected-susceptible  epidemiological model on scale free networks: scale-free networks are more prone to spreading of diseases than random graphs and regular lattices  <cit> . in this kind of model the role of microbe evolution is disregarded. recently, we have focused on this latter feature and we have shown that although scale-free networks are more prone to infectious agent spread, the accumulation of deleterious mutations in asexual infectious agent with high mutation rates can also be accelerated in this kind of networks in comparison to random graphs  <cit> . this shows that not only disease dynamics but also its evolution should be considered as an important key in the investigation of epidemiological models  <cit> . another very important feature that has to be considered is co-evolution between infectious agent and their hosts  <cit> . modeling of these complex systems have provided us with insights into how host-parasite interactions can modulate the mode of reproduction  <cit> , ploidy levels  <cit> , the patterns of gene expression in hosts and parasites  <cit>  and how different types of interspecies interactions affect genetic and phenotypic variation  <cit> .

RESULTS
levels of metapopulation infection
the susceptible-infected-susceptible model  is one of the simplest classical models in epidemiology. in this model, hosts born susceptible  can become infected  at a rate β per unit time, given contact with at least one infected host. infected hosts become susceptible at a rate λ, such that 1/λ is the average duration of an infection. one of the most fundamental quantities to assess the equilibrium frequency of infections in the population is the r <dig> of the infectious agent. the r <dig> is defined as the number of secondary cases produced by an infectious individual in a totally susceptible population. at epidemiological equilibrium, the frequency of infected individuals is i =  <dig> - 1/r <dig>  with r <dig> = β/λ. if r <dig> <  <dig> then the infection does not spread.

to assess the patterns of variation under the sis model, we have studied a population genetic model of a structured population that is composed of many small subpopulations, which are named demes. there is a total of d demes, which are connected according to a given network topology: corresponding to either the island model or the scale free network. these demes can go extinct and be recolonized through migrants that they received from the other demes. each deme can contain at most nd individuals, which reproduce and mutate within each deme . in table  <dig> we make a summary of the model's key parameters.

we now relate our metapopulation model with the sis model and in this study we will ask what equilibrium patterns of infectious agent genetic variation look like under this model. in our model a deme corresponds to a host. an empty deme means that the host is susceptible, whereas a deme which is full corresponds to an infected host. a deme that is currently full can become empty with probability e, which means that e corresponds to λ. a deme that is currently empty can become full through the migrants it receives from nearby demes. this implies that β is proportional to m. given that the average connectivity of a deme is k and that the number of migrants per link is ndm, then β corresponds to ndmk.

in order to assess the correspondence between our model and the sis model, we have compared the average frequency of infected individuals in our metapopulation with the expectation for the deterministic sis model, which implies that:

 i =  <dig> - 1/r <dig> =  <dig> - e/ndmk 

equation  <dig> is the expected frequency when there is no variance in ki, which is not the case in scale free networks.

in figure  <dig> we show the results from our simulations, where the proportion of infected individuals in the metapopulation is measured as we increase the transmission coefficient of the infectious agent, β, through increments in m. the results for the different types of networks considered are shown, and the deterministic expectation is also plotted. in all cases r <dig> = ndmk/e, where k = d -  <dig> for the island model and k =  <dig> for the scale free topology. the results of the simulations show that the proportion of infected individuals observed and that predicted are quite concordant. in particular, if we assume the topology corresponding to the island model, then the level of infection is exactly that predicted by equation  <dig>  we notice that the prediction holds for an effectively infinite population under the mass action assumption.

one may expect deviations to be observed when these assumptions are violated  <cit> . nevertheless the deviations we observe are small, unless r <dig> is very low. in fact in the case of very low r <dig> there is a high probability that the infection does not spread. for example in the scale free network, if the infection starts in a poorly connected host it may have very little chance of spreading. we performed simulations with the scale free topology in conditions where the infection starts in a single randomly chosen host. with the same parameters as in figure  <dig> and for r <dig> =  <dig> , we observed 66% of cases where the disease could not spread. with r <dig> =  <dig>  the fraction of cases where the infectious agent could not invade dropped to 40%.

levels of metapopulation diversity
we now study the level of genetic diversity in infectious agents sampled randomly from the whole population of infected hosts. we first consider a metapopulation where every host contacts every other host. this corresponds to the island model in the populations genetics literature and mass action assumption in epidemiological models. we then assess how the level of diversity is affected by differences in the level of contact between hosts, in particular when a small number of hosts can have a very large number of contacts, such as in the scale free network. in figure  <dig> we show the level of diversity in samples taken from the whole population, πt, as we increase r <dig>  through increments in m.

we observe that, for both topologies and for the sets of parameters considered, the level of πt is maximal for intermediate values of r <dig>  for instance, when e =  <dig>  this maximum value is achieved at r <dig> around  <dig> for the island model and around  <dig> for the scale free topology. beyond these points the level of diversity starts to decrease with increasing r <dig>  from figure  <dig> we observe the occurrence of two quite distinct regimes, according to the level of transmission. in the region of low transmission, r <dig> is small, extinction is much stronger than migration , the fraction of infected hosts is small and levels of diversity are low. in fact, starting from r <dig> =  <dig>  where the fraction of infected individuals, i, is  <dig>  as we increase r <dig> , the level of infection rises and the level of diversity accompanies that increase. in this region the level of infection bounds the level of diversity in the population, since it is expected that diversity will be higher when the total number of infectious agents in the metapopulation is larger. when the level of infection achieves a value close to  <dig> , increments in m, lead to small increments in i and the level of diversity stops increasing. the second regime comes about at high transmission, where r <dig> is very large. in this region migration is much stronger than extinction, mk >> e, the level of infection is close to  <dig> and so it is not the limiting factor for diversity to grow. from this point, increments in migration cause a drastic reduction in the isolation between demes and lead to a reduction in diversity. in fact in the limit of extremely high levels of migration the diversity in the structured population tends to that expected in a panmitic population of size nt = dnd. so, for very high values of r <dig>  diversity tends toward the value πt = πd = 2nddμ, which in the case of figure  <dig> is  <dig>  for the value of the mutation rate, μ, assumed. figure  <dig> also shows that in the region of low r <dig>  diversity in the island model is higher than in the scale free network, whereas for large values of r <dig>  there is little difference between the topologies. the latter is expected since the larger the value of the migration rate the less important the precise contact structure will be. the former can be understood as follows: a low value of r <dig> corresponds to a small fraction of infected hosts both in the island model and in the scale free network. but whereas in the island model new infections of a susceptible host occur from contact with any of the infected hosts in the metapopulation, in the scale free network infections are more likely to come from well connected hosts, which are a small subset of the metapopulation. this then will lead to lower diversity levels in the scale free network, as compared to the island model, for the same low r <dig> value.

we have compared our simulation results with some of the analytical approximations for the levels of diversity in metapopulations  <cit> . in the vast majority of metatopulation models with extinction and recolonization, the island model of population subdivision is assumed. furthermore, the processes of migration and recolonization are assumed to be distinct. two different schemes of colonization are normally considered, according to where colonists come from: the migrant pool model and the propagule pool model  <cit> . in both models there are k colonists , which may constitute a random sample from the whole metapopulation  or from a single deme . pannell and charlesworth  <cit>  have studied levels of within and between population diversity under these models and have provided a set of analytical approximations. we have adapted the approximations in their table  <dig>  which correspond to the infinite sites mutation model as we assume here, to the metapopulation model that we are studying, which is slightly different from the one they have used. in particular, besides the different types of contact structure studied here, there are two key differences in the models: 1) in our model recolonization and migration are similar processes; and 2) while in the classical model it is assumed that when one deme goes extinct it gets immediately recolonized, in our model when a deme goes extinct it will only be recolonized when it receives migrants. in this way, the equilibrium number of empty demes  decreases as m, or r <dig>  increases. whereas for infectious agent populations assumption 2) is more appropriate, for some infectious agents assumption 1) may be too simple. one can imagine that when a host is infected, its ability to transmit the infectious agents to another infected host is reduced compared to its ability to transmit the infectious agent to a susceptible individual. this implies that the migration rate between subpopulations may, in some infectious agents, depend on the host history. we have taken the simplest scenario here.

parameter values: d = 1000; nd = 10; μ =  <dig> , e =  <dig> , r <dig> =  <dig> 

we have thus compared the expected level of metapopulation genetic diversity in our simulations for the symmetric island model  with the following approximation:

 πtisl=2nddμr0+1/2end+r0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfapacdawgaawcbagaemidaq3aasbaawqaaiabdmgapjabdohazjabdygasbqabaaaleqaaogaeyypa0jaegomaijaemota40aasbaasqaaiabdsgakbqabagccqwgebarcqggoaakcqaixaqmcqghsislcqaixaqmcqggvawlcqwgsbgudawgaawcbagaegimaadabeaakiabcmcapiab=x7atnaalaaabagaemouai1aasbaasqaaiabicdawaqabagccqghrawkcqaixaqmcqggvawlcqaiyagmcqwglbqzaeaacqwgobgtdawgaawcbagaemizaqgabeaakiabgucariabdkfasnaabaaaleaacqaiwaamaeqaaaaaaaa@50c9@ 

which is adapted from the approximation for the classical case of the migrant pool model of recolonization. we can expect that in the case of the scale free topology, where a large number of hosts have few connections and a few hosts are very well connected, levels of diversity will be closer to those expected for the propagule pool recolonization model. this is because hubs in the network will contribute much more than the other nodes in the process of recolonization. we have thus compared the expected level of genetic diversity for the scale free network with the following approximation for the propagule pool model:

 πtsf=dμ1−ee
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfapacdawgaawcbagaemidaq3aasbaawqaaiabdohazjabdagambqabaaaleqaaogaeyypa0jaemiraqkaeiikagiaegymaejaeyoei0iaegymaejaei4la8iaemouai1aasbaasqaaiabicdawaqabagccqggpaqkcqwf8oqbdawcaaqaaiabigdaxiabgkhitiabdwgalbqaaiabdwgaljabcicaoiabikdayiabgkhitiabdwgaljabcmcapaaaaaa@4808@ 

which is valid only when mk <e  <cit> . we therefore expect this expression to provide a good approximation for cases in which r <dig> <nd.

as seen in figure  <dig>  these formulas provide very good approximations to the simulation results, for low values of r <dig>  for very large values of r <dig>  the level of diversity is similar in the two topologies and is very well approximated by equation  <dig> 

equation  <dig> suggests a strong dependence of the level of metapopulation diversity with nd, the effective population size within a host. this effective population size is likely to vary considerably among different infectious agent species. we have therefore explored how the value of nd affects the levels of diversity with simulations.

in figure  <dig> we show the results of varying nd, for both types of network . figure  <dig> clearly shows that when e < 1/nd , levels of diversity are maximal for intermediate r <dig>  but for e > 1/nd diversity always increases with r <dig>  this occurs both in the island model and in scale free networks. this shows that, independently of the type of host contact structure, for infectious agents with large intrahost effective population size, levels of diversity increase with increasing r <dig> 

furthermore, as suggested by equation  <dig>  for small values of r <dig>  increasing nd has a very small effect on the level of diversity, but for intermediate to high r <dig> values the effect is more pronounced.

when r <dig> >  <dig>  the level of infection is not a limiting factor in the level of diversity, because the number of infected hosts is very high. thus for large values of r <dig> infectious agent diversity will increase with nd.

comparing the panels in figure  <dig>  we can observe that when r <dig> <<  <dig>  diversity is always smaller in the scale free network, whereas when r <dig> >>  <dig> and e > 1/nd the levels of diversity are similar in both contact networks. in fact, for large values of r <dig>  the largest difference between the topologies can be observed when e = 1/nd.

in this metapopulation model there are two forces which generate diversity within each host: mutation and transmission; there are also two forces that undermine diversity: extinction and genetic drift. so in general, we can expect that, when the forces that reduce diversity are stronger than those that generate it , diversity levels will be low. on the contrary, high r <dig>  high nd or low e, we can expect levels of diversity to be much larger.

metapopulation mutation frequency spectrum
the spectrum of frequencies of mutations that are segregating in the population is important to understand deviations from the standard neutral model, which assumes an undivided, constant size population at equilibrium between mutation and drift  <cit> . in fact, the mutational spectrum of infectious agent gene sequences has been used to reject the standard neutral model suggesting that natural selection is determining the evolution of certain genes  <cit> . tajima's d is a widely used statistic to assess distortions in the frequency spectrum  <cit> . if the number of mutations that appear at frequency 1/n in sample of size n  is higher than that expected under the standard neutral model, then tajima's d becomes negative. on the other hand if the number of mutations at intermediate frequency is large then tajima's d becomes positive. when a departure from the standard neutral model is observed in a given gene of a given species, several alternative hypotheses can be made. these typically involve natural selection and/or demographic factors, such as population growth or population structure. in infectious agent populations the relevant null model against which we would like to test for the molecular signature of selection is closer to a metapopulation neutral model than to the standard neutral model. from all the simulations in all the metapopulation structures we have studied, we have observed that dt was always very close to  <dig>  this is in agreement with the results of coalescent theory and simulations in metapopulations under the island model  <cit> . however, we have observed that in some simulations of scale free networks a slight distortion of the frequency spectrum was apparent. in cases of low r <dig> mean values of the tajima's d statistic become negative. in table  <dig> we show one example where this occurs. although the values of dt are not very negative when the sample size is small, they become more negative with increasing sample size.

in figure  <dig> we show an example of the mutation frequency spectrum in the scale free network for two values of transmission with a large sample size. clearly we see that when r <dig> is small the proportion of singletons in the samples is much higher than when r <dig> is large. for r <dig> =  <dig> the spectrum is similar to the one expected under the standard neutral model. these results imply that it is very dificult to reject an equilibrium neutral model with constant population size when using tajima's d.

infectious agent diversity within hosts and differentiation amongst hosts
in infectious agents with very high mutation rates, as it is the case of rna viruses  <cit> , one may expect some level of within host diversity to be observed. we have therefore studied the level of diversity in samples taken from each infected host. we also studied the level of genetic differentiation between hosts measured by fst  <cit> . the statistic of genetic differentiation we use measures the difference between the level of infectious agent diversity within an infected host and that of the entire infectious agent metapopulation. it is known that all of these statistics are important for the understanding of the relative importance of the processes governing metapopulation dynamics  <cit>  and therefore they can be important in understanding their epidemiology. figure  <dig> shows the results for the levels of genetic differentiation, as measured by fst, for different values of r <dig>  as can be seen from this figure, for infectious agents with low transmission, the levels of host differentiation are very high. in this case and with the value of the mutation rate considered, the levels of within host genetic variability can be very low. for example in the case of the island model with r <dig> =  <dig> , the observed mean level of intrahost infectious agent diversity was  <dig> , which is only  <dig>  of the level observed in the whole metapopulation. in certain rna viruses, such as the dengue virus, the levels of intrahost genetic diversity that have been observed are about  <dig>  of that between hosts  <cit> . in infectious agents with high transmission rates the levels of differentiation are much smaller and are accompanied by higher levels of within host diversity. in the case of the island model every host has similar levels of diversity. and so, as the infectious agent transmission rate increases, so does the level of within host diversity. but in scale free networks, host connectivity affects infectious agent diversity within that host and the levels of differentiation between hosts. we have considered the case of two infectious agent with different transmission coeficients and have looked at the relation between host connectivity and within host diversity. figure  <dig> shows that well connected hosts have much higher levels of πd and much lower levels of fst. in this instance, fst reflects the average divergence between demes with connectivity ki and all other demes. from the figure we see that well connected hosts also show significantly larger mean values of the tajima's d statistic, for intermediate values of r <dig> 

CONCLUSIONS
one of the main goals in infectious disease research is to understand how infectious agent variation, host immunity, transmission dynamics and epidemic dynamics determine patterns of infectious agent evolution. information about evolutionary and epidemiological processes can be extracted from studying infectious agent genetic diversity. in particular it can help us to understand the origin of disease and the selective pressures that act on certain infectious agent genes. the link between infectious agent dynamics and genetic diversity at within and between host level is a very important problem. the means towards its solution requires the integration of population genetics and epidemiology. this has recently been recognized as a major step for understanding infectious agent evolution  <cit> .

here we have studied levels and patterns of infectious agent diversity under one of the simplest classical epidemiological models: the sis model. in this model, hosts that are susceptible can become infected at a given rate, and hosts that are infected can become susceptible by clearance of the infectious agent. we have found that, under this model and in the conditions studied, for low clearance rates and low intrahost effective population size, levels of genetic variability in samples from the whole infectious agent population are maximal for intermediate levels of transmission. this pattern of dna sequence diversity was found to be independent of the type of host contact structure.

although we have not performed simulations with values of nd close to those that have been estimated for some infectious agent  due to the high computational cost, from the simulations we have done we have checked that when the rate at which the immune system clears the infectious agent  is higher than the rate of drift  within the host, levels of infectious agent diversity in the whole metapopulation monotonically increase with r <dig> 

in highly transmitted infectious agents, levels of diversity are weakly dependent on the type of host contact structure. however for infectious agents with low values of r <dig>  levels of diversity do depend on the host contact structure: when interactions between hosts are such that every host is in contact with every other, levels of diversity are higher than when the host contact structure is such that a few hosts have a disproportionate number of contacts, whereas the majority has a small number of contacts. in this latter case levels of infectious agent diversity are expected to be low. furthermore, in this latter case the frequency spectrum of neutral mutations can be distorted, in relation to that expected for the standard neutral model  <cit> . this feature is captured by negative values of the tajima's d statistics. the observation of positive values of dt in infections agent genes suggests that strong diversifying selection could be occurring, since even when we account for the complex contact structure in which infectious agents evolve, under a neutral model one would expect to observe values of dt close to  <dig> or negative.

the results presented here can also be used to make some predictions about future adaptation in infectious agents. if we assume that new adaptive mutations in infectious agents arise from standing neutral variation  <cit> , figures  <dig>   <dig> and  <dig> imply that for infectious agents with low intrahost effective population size, those with intermediate r <dig> will be likely to adapt more rapidly than those with larger r <dig>  for infectious agents in which these conditions are met, an important implication regarding public health measures can be drawn: if control programs with the aim of lowering transmission do not reduce r <dig> to very low values, but instead only lead to small reductions in r <dig>  then this may imply an increased chance of the infectious agent escaping the immune system.

one feature of several natural populations, including infectious agent populations is the occurrence of correlations between genetic and geographical distance  <cit> . in the island model of population structure that pattern does not arise, whereas in the stepping stone model it is evident. we have explored the relation between genetic and geographical distance in the scale free contact network, which is likely to be closer to the relevant contact structure for infectious agent evolution. although in our models we have not considered geography explicitly, we have assumed that it can be related to the shortest path length between nodes in the network. figure  <dig> shows a clear correlation between these distances. one can intuitively suspect that natural selection can cause infectious agents to adapt to local conditions and that local adaptation can lead to spatial genetic structuring. but before one jumps to the conclusion that natural selection is playing a role in spatially structuring diversity one has to rule out the simpler explanation of neutral evolution in a complex host contact network. hopefully, the careful consideration of all diversity measures and the use of several test statistics will help us to find the molecular signature of adaptation in infectious agent gene sequences.

