BACKGROUND
changes in genes and genomes associated with permanent splits of evolutionary lineages contribute key information for our understanding of the evolution of new species  <cit> . following speciation, large parts of the genomes still have paraphyletic genealogies but, with time, an increasing number of genes will convert to monophyly by lineage sorting  <cit> . however, lineage sorting takes time, particularly if populations are large, and the reciprocal monophyly criterion cannot be applied for species delimitation in recent radiations  <cit> . in addition, it is now widely accepted that conflicting gene genealogies may exist within a given species tree, which complicates phylogenetic inferences and may even lead to an incorrect species tree  <cit> . in current approaches, phylogenetic and phylogeographic inferences more and more often rely on a large number of genes, sampled across the genome, e.g.
. nevertheless, the vast majority of phylogenies published recently using molecular systematics, for various groups of organisms, are based on one or very few genes. we can now test and pose a timely question: whether we can trust phylogenies based on mtdna and single nuclear gene variation in the era of genomics. in particular, the utility of mitochondrial dna  markers for phylogenetic and phylogeographic inferences has been questioned, e.g.
 <cit> .

in addition to random variation in lineage sorting across the genome, diversifying selection is another process leading to discordance between genealogies and the true phylogeny of lineages . genes that contribute to barriers against gene flow between incipient or recently separated species will evolve at higher rates compared to neutral genomic regions  <cit> . further, these genes may drive divergence of surrounding genomic regions . genome-wide approaches have recently been used to identify loci with elevated degrees of divergence in several systems, e.g. . closely related lineages with various splitting times are of special interest in studying the progress of genome evolution  <cit> . parallel processes of divergence in demographically independent systems give an opportunity to test whether the same or alternative genomic architectures have been used in repeated adaptations to similar environments  <cit> .

the snail genus littorina provides ample opportunities for genomic studies of divergence, adaptive radiation and ecotype formation. in the north-atlantic region, there is one planktotrophic species l. littorea and the five non-planktotrophic species of the subgenus neritrema: l. fabalis. l obtusata, l. saxatilis, l. arcana and l. compressa
 <cit> . the evolutionary history of these five species includes a split between two sister clades,  <dig> to  <dig> mya, one containing l. fabalis and l. obtusata and the other containing l. saxatilis, l. arcana and l. compressa
 <cit> . divergence of the sister-species l. fabalis and l. obtusata and between the three sibling species l. arcana, l. compressa and l. saxatilis is even more recent,  <dig>  –  <dig>  mya by different estimates . in both clades, studies of mtdna variation revealed lack of reciprocal monophyly and shared alleles, likely due to incomplete lineage sorting . however, shared haplotypes may also indicate rare hybridization between species, as has been suggested for l. saxatilis and l. arcana
 <cit> .figure  <dig> 
phylogeny of five north-atlantic species of
littorina
subgenus
neritrema.
a) dendrogram representing the phylogeny of the five north-atlantic species of littorina, subgenus neritrema. numbers indicate divergence times in ma, estimated from molecular data in previous studies. b) possible relationships between the three sibling species of the “saxatilis” complex, suggested by analyses of different molecular markers.



the relationships between the three sibling species l. saxatilis, l. arcana and l. compressa are especially interesting. all three species live in sympatry over large parts of their distribution and are morphologically very similar although l. compressa often can be distinguished by a characteristic shell pattern  <cit> . species identification of l. saxatilis and l. arcana is possible only in the case of mature females, which have a jelly gland in egg-laying l. arcana and a brood pouch with embryos in ovoviviparous l. saxatilis
 <cit> . a dna marker has been suggested for discrimination of these two species, but 12-14% of analyzed individuals deviate from species-specific amplification patterns  <cit> . notably, comprehensive phylogenies reconstructed from morphology and several types of genetic markers place either l. arcana and l. compressa or l. saxatilis and l. arcana as sister taxa , and hitherto this trichotomy has remained unresolved  <cit> .

all species of the subgenus neritrema are polymorphic  <cit> , but the most pronounced example of intraspecific variation is found in l. saxatilis. in particular, distinct “crab” and “wave” ecotypes have evolved in parapatric microhabitats as adaptation to crab predation or wave exposure  <cit> . pairs of these ecotypes have been extensively studied in britain, on the galician coast of spain, and on the west coast of sweden to address mechanisms of ecotype formation and incipient speciation . the phylogeographic reconstruction of the species’ history based on mtdna data suggests a close phylogenetic relationship through shared glacial refugia between british and swedish populations, and a history of long isolation for galician populations  <cit> . a recent comprehensive study based on three nuclear introns, mtdna and aflp data showed that ecotypes most likely have evolved independently in the three regions as a result of local adaptations in the face of gene flow  <cit> .

thus crab and wave ecotypes of l. saxatilis present an opportunity to study mechanisms and genes involved in local adaptation and in the evolution of reproductive barriers in parallel systems. the genomic architecture of the adaptive variation in l. saxatilis is hitherto unknown, but transcriptome sequencing of the british ecotypes indicated a number of snp’s associated with the ecotypes  <cit> . a genome scan of the british ecotypes using amplified fragment length polymorphism  markers also revealed several outlying loci  <cit> . two of them have been further characterized through sequencing of large genomic fragments around the outliers from a bacterial artificial chromosome library , but candidate genes could not be identified  <cit> .

the application of genomic approaches in littorina snails is needed to clarify phylogenetic relationships between closely related species and populations that have so far been based on one or a few loci. furthermore, comprehensive genome-wide studies will be necessary for identification of genes and genome regions that are under diversifying selection and/or involved in recent or on-going speciation events. one way to search for genomic divergence between species and populations is by using array comparative genomic hybridization , which is based on hybridization of labeled genomic dna fragments to a microarray, representing a subset of the genome of the target species. acgh has been widely used in model organisms and in human medical genetics  <cit> . depending on the array design and platform used, acgh can target different types of genomic variation – from chromosomal rearrangements and copy number variants  to single nucleotide polymorphisms  . probe design varies depending on the targeted type of variation, e.g. reliable snp detection requires short  probes with relatively low gc content and multiple tiling probes per target snp . on the contrary, oligonucleotide probes in a gene expression array are usually longer  and have higher gc content in order to tolerate single mismatches and provide reliable estimates of gene expression despite variation in dna sequence among individuals .

acgh has been used to detect gene loss and acquisition and highly polymorphic genes in bacteria  <cit> , cnvs between different cultivars of rice  <cit>  and for genotyping known snps in caenorhabditis elegans
 <cit> . since acgh design requires the reference genome, this method has not been available for non-model organisms. however, for species with existing transcriptome libraries and gene expression arrays, genomic dna can be hybridized using transcriptome arrays to detect cnvs  and, to some extent, sequence divergence in coding parts of the genome . this approach has been applied successfully to identify rapidly evolving genes and cnvs in different strains of the ectomycorrhizal fungus paxillus involutus
 <cit> .

in the present study, we applied acgh analysis to explore genome divergence at different evolutionary scales: species that are easily recognized by morphological characters and show reciprocal monophyly in traditional single-gene phylogenies ; recently diverged sibling species with unclear phylogenetic relationship , geographically distant populations of a species with high level of population structure  and, finally, l. saxatilis ecotypes that have evolved repeatedly in the three different regions. the goals of the study are to detect overall patterns of genome divergence  and to identify outliers for future studies.

for the experiments, we used a high-density oligonucleotide gene-expression array for l. saxatilis, representing more than  <dig>  partial transcripts. to our knowledge, expression oligoarrays have not been used for acgh before and the sensitivity of this method is unknown. the obvious advantage of this approach is that the array represents the coding part of the genome. the pitfalls are that intron/exon boundaries within the probes may have a large effect and we need to distinguish cnv’s from sequence divergence. to investigate this, we included in the array design the genomic sequences that are available for the species  and mitochondrial dna probes with mismatches. at the time of data analyses, we had produced the first preliminary draft of the l. saxatilis genome, which gave us an opportunity to explore in more detail what types of genetic variation was detected by our method. specifically, we address the following questions:what type of genetic variation can be detected by hybridization of genomic dna to oligonucleotide transcriptomic arrays?

does acgh analysis confirm phylogenetic relationships among and within closely related species inferred from analyses of only a few genes?

can we resolve the trichotomy between the three sister species l. arcana, l. compressa and l. saxatilis?

does acgh analysis confirm the high divergence between galician and the two more northern populations of l. saxatilis?

can we use this approach to detect adaptive variation underlying crab and wave ecotypes of l. saxatilis and test for parallelism of adaptations?

are there genes with elevated rates of evolution in this lineage of littorina and, if so, are similar or different genes involved in different species pairs?



methods
array design and genome information represented
we used an oligonucleotide microarray platform for l. saxatilis that was developed by nimblegen roche  and contained sequence information based on  <dig>  partial transcripts, hereafter referred to as “genes”, from the littorina sequence database, lsd  <cit> . these transcripts were obtained mainly by  <dig> sequencing  of cdna libraries from pooled tissues and individuals of british crab and wave ecotypes of l. saxatilis . in addition to sequence information on transcripts, we added l. saxatilis genome sequences that were available in public databases at the time of the array design:  <dig>  nt in total from four sequenced bac clones: ch317-88d <dig>  -123m <dig>  -148l <dig> and -10n <dig>  <cit>  . this library was constructed using genomic dna of four crab-ecotype individuals from one british population . in the array design, these bac clones were divided into  <dig> fragments of  <dig>  nt each, which for simplicity are also referred to as “genes”, although most of these fragments constitute non-coding dna  <cit> . an  <dig>  nt long mt genome sequence of l. saxatilis, also from a british population  <cit>   was divided into  <dig> “genes” of  <dig> nt each and these were also included on the array, along with  <dig> transcripts from other mollusks and  <dig> flanking regions of microsatellites, developed for l. saxatilis
 <cit>  and l. subrotundata
 <cit>  and earlier used in population studies of l. saxatilis
 <cit> .

each “gene” was represented on the array by five non-overlapping 60-nt probes, except for transcripts with the total length < <dig> bp, for which probes overlapped. to provide optimal hybridization, probes were designed with 44% gc content, unless the whole fragment had lower gc content. in total, each array contained approximately  <dig>  probes representing  <dig>  “genes”, and each slide contained  <dig> identical subarrays.

sample collection, preparation and hybridization to microarray
littorina fabalis were collected in the vicinity of the tjärnö marine research station . littorina arcana and l. compressa were obtained from the east coast of britain; since the males cannot be distinguished from l. saxatilis, we used only mature females of these species. for each of these species, four snails were included in the experiment . littorina saxatilis samples were obtained from three regions  as pairs of local crab and wave ecotypes . for each group , we used four randomly chosen individuals; in total  <dig> individuals of l. saxatilis. thus, the whole experiment included  <dig> snails for which genomic dna extracts were individually hybridized to the array.table  <dig> 
littorina
samples used for acgh 



l. fabalis

l. compressa

l. arcana

l. saxatilis

l. saxatilis

l. saxatilis

l. saxatilis

l. saxatilis

l. saxatilis


genomic dna was extracted from foot muscle tissue using a ctab extraction method modified from  <cit>  to include rnaase treatment and to increase dna yield . dna concentration and purity were assessed using a nanodrop spectrophotometer  and agarose-gel electrophoresis. for each group  two individual dna samples were labeled with cy <dig> and two with the cy <dig> dye. labeling was performed with a starting amount of  <dig> μg of genomic dna per sample, 5′-cy random primers and klenow fragments , following the manufacturer’s protocol.

individuals from the different groups were randomly distributed between the subarrays, i.e. each subarray hosted two individual samples, one labeled with cy <dig> and one with cy3; no common reference sample was included in the experiment. this experimental design was chosen in order to conduct intensity-based analyses of data instead of ratio-based analyses. ratio-based analysis for dual-colour microarrays has been used commonly to control for the high inter-array variation in earlier microarray platforms. however, in high density synthetic oligoarrays the inter-array variance is much lower  <cit> , which removes the need for reference sample and allows the use of intensity data from separate channels  <cit> . this design also helps to separate more reliably the types of genetic variation behind the low-hybridization signals in the absence of a reference genome. for example, in the reference design, low sample-to-reference ratios can be due to high sequence divergence in the sample or higher number of copies in the reference. using normalized signal intensities instead of ratios, multiple-copy regions can be detected in all samples, as having signals twice or above the average, single-copy level.

for hybridization,  <dig> μg of cy3- and cy5-labeled dna of two samples for each subarray were combined, vacuum-dried and resuspended in  <dig> μl of hybridization solution, of which  <dig> μl was applied onto a subarray for hybridization. hybridization was performed in a nimblegen hybridization system at 42° for  <dig> hours following the manufacturer’s protocol . after hybridization the slides were washed using the nimblegen washing kit and immediately scanned at 2-μm resolution using an agilent g2565aa microarray scanner .

image processing and data normalization
the array images were processed using the nimblescan v. <dig>  software . first, we assessed the quality of the images according to the manufacturer’s guidelines and discarded images with signal intensity or other metrics outside the recommended range. . after quality control, the signal intensity data for each channel were corrected for the local background signal, log2-transformed and used for normalization.

normalization of microarray data is necessary to remove differences in signal intensity between individual slides and subarrays as well as the systematic difference in signal intensities of the cy <dig> and cy <dig> dyes. there are numerous algorithms for data normalization serving this purpose, including the robust multi-array normalization algorithm , implemented in the nimblescan software. rma adjusts the raw signal data using a quantile method so that signal intensity data for all individual samples have similar normal distributions  <cit> . the assumption of similar signal intensity distributions in all samples is likely to hold for gene expression data sets, when many genes are expressed at similar levels in all samples and there are roughly equal numbers of sample-specific up- and down-regulated genes . for expression data conforming to this general pattern, rma has been shown to perform very well  <cit> . for our data, however, based on hybridizations of genomic dna to a transcriptomic array, we did not know a priori whether the assumption of similar signal intensity distributions would be met. in theory, heterologous hybridizations  may produce signal intensity distributions skewed towards low values, if interspecific sequence divergence is large enough to lower hybridization efficiency in many genes.

to test this, we compared the normalization by the rma procedure in nimblescan to a method that is not based on the assumption of similar signal intensity distributions in all samples. for this, we used an anova normalization, i.e. fitting the “normalization” anova model, that estimates non-biological variation due to dye  and subarray  and saving the residuals  <cit> . normalization was carried out for the effect of the subarray and not of the array since there was no systematic difference between the three slides  used in the experiment, although we did observe significant variation in signal strength between subarrays within each slide. the interaction term dye*subarray was not included because it defines a single sample in the experiment and thus is confounded with levels of biological variation .

in all samples, both normalization methods produced signal intensity distributions of similar shape: slightly bimodal with a second right peak of high signal and with a left tail with the low-signal data . moreover, there was a high correlation between rma-normalized and anova-normalized signal per gene . thus, we concluded that both normalization methods performed similarly on our dataset and used the rma-normalized data in the subsequent analyses.

usually, in the second step of the rma algorithm, the signal intensities for individual probes  are summarized to obtain a single value for each gene using the method of irizarry et al.
 <cit> . this step is based on the assumption that, in gene expression data, the true signal intensity level for all probes, representing one gene, should be the same. in acgh data, however, hybridization efficiency for individual probes depends on sequence similarity between them and the hybridized dna and thus can vary between probes that come from different fragments of one gene. for this reason we performed both gene-level and probe-level data analyses.

statistical analyses of genomic divergence between species and populations
to test whether genome divergence between l. saxatilis and the other studied littorina species lowered the success of heterologous  dna hybridization, the variation of average log2-signal intensities between the samples was analyzed by fitting a mixed analysis of variance  model with species  + dye  + subarray  using the jmp  <dig> . <dig> software . all three factors had highly significant effects , and signal intensity levels were compared between the species using student’s t-test on residuals after the effects of dye and subarray had been removed.

principal component analysis  using the qlucore omics explorer  <dig>   was applied to visualize the variation in hybridization success between species and populations . pca across all variables is useful to detect very strong patterns in the dataset, but many individual effects are likely to be obscured by the high total variation in a dataset with very many variables . hence, to further explore patterns in the data, pca was also performed including only genes that showed significant differences in hybridization signal intensities between the groups. these genes were identified by one-way anova for each genes and applying a false-discovery rate q =  <dig>  cut off across the tests  <cit> . signal intensity data for the genes with significant variation in the species pairs were used to produce a heat map  using the qlucore omics explorer. in addition, we performed hierarchical clustering analyses of different species and populations based on hybridization signal intensity in all genes and with  <dig>  bootstrap permutations of the data. this was done using euclidean distance and the single linkage clustering algorithm in the maanova package  <cit>  in r  <cit> .

finally, we identified genes with significant differences in hybridization success for pairs of species and for each sample against the british l. saxatilis sample  by performing t-tests for each gene and setting a cut-off at q =  <dig>  in the qlucore omics explorer. the number of significant genes in pair-wise comparisons was used for neighbour-joining clustering of species and populations in the package ape v. <dig> . <dig>  <cit>  in r  <cit> . to test whether the same genes show elevated divergence rates between different species, lists of pair-wise significant genes were compared using venn diagrams using the biovenn tool  <cit> .

sensitivity analysis and identification of candidate duplicated genes
for single-copy genes, divergence between the hybridized dna sample and probes on the array results in a lower hybridization signal. since a majority of the probes were designed from cdna sequence information, we expect that some probes will span exon-intron boundaries in the genome. in such cases only a part of the labeled genomic dna fragment is complementary to the probe and this should significantly reduce hybridization. in addition, mismatches at the nucleotide level between the probe on the array and the hybridized dna can decrease the hybridization efficiency. one mismatch per  <dig> nt  is hardly detected  <cit> , but several mismatches per probe are likely to have a negative effect on the hybridization  <cit> . in addition to the number of mismatches, other factors, such as type of base changes between the probe and the hybridized dna, their position within the probe and the gc content of the probe have been shown to have large effects on hybridization success for long-oligonucleotide arrays  <cit> .

to investigate what types of genomic variation were detected by our acgh-method, we used two approaches: comparing sequences of the array probes with low and high signal intensities to the draft genome of l. saxatilis and re-sequencing fragments of the mitochondrial cytochrome b gene, represented on the array, in the analyzed individuals. the littorina saxatilis genome sequencing project is currently being carried out by the linneaus centre for marine evolutionary biology at gothenburg university  <cit> . at the time of the data analyses presented here, the available assembly was performed on  <dig> gbp of illumina reads from a  <dig> nt-insert library using the clc assembly cell v  <dig> . <dig>  and produced a total assembly size of  <dig> mbp and n <dig> contig size of  <dig> nt. sequenced genomic dna comes from a single individual of the swedish crab-ecotype of l. saxatilis from the island saltö, which is the same population as included in the present cgh experiment. while there is certainly much genetic variation within any population, many protein-coding sequences are likely to be invariable. given the large amount of cdna sequence information on our array we assumed that the genome sequences of the snails in our acgh experiment were basically the same as in the genome assembly. hence, we correlated differences between probes on the array  and the genome sequences  with the hybridization signal intensities of the swedish l. saxatilis crab-ecotypes. genome contigs corresponding to different probes from the array were identified as the top hit using blastn  <dig> .25+ algorithm  <cit> . we calculated correlations between hybridization signal intensities and blastn top hit parameters  as well as with gc content of the probes in jmp  <dig> . <dig> 

for the mitochondrial cytochrome b gene fragments, we included several sequence variants on the array representing previously detected variants of this gene in littorina
 <cit> . we amplified and sequenced the cytochrome b fragment  in  <dig> of the  <dig> individuals used in the acgh, counted the number of actual mismatches between the obtained sequences and array probes, and compared the hybridization signal intensities between probes with different numbers of mismatches. the haploid mtdna fragment was chosen for this sensitivity analysis in order to avoid potential heterozygotes.

finally, array sequences representing duplicated genes and multiple-copy variants are expected to produce two-fold or higher hybridization signals than single-copy variants. to detect such genes we fitted a model with a mixture of three normal distributions, representing average-signal genes, low-signal outliers  and high-signal outliers  to signal distributions in hybridized samples. this was done using the em algorithm in the mixtools package  <cit>  for r  <cit> . high-signal outliers were defined as genes showing signal levels greater than or equal to the mean minus two standard deviations of the right hand peak . lists of candidate genes were obtained for each of the groups  and the lists were compared between the groups. in the data on the swedish l. saxatilis crab-ecotype, we calculated sequencing coverage of genome contigs, containing genes with the normal signal level and compared it to sequencing coverage of genome contigs containing genes with high signal level .figure  <dig> 
acgh hybridization signals in
littorina saxatilis
. frequency histogram shows distribution of log- <dig> normalized and centred signals ; colour curves – a fitted mixture of three normal distributions from mixtools r package. red curve – low signals, blue curve – normal signals , green curve – high signals due to multiple gene copies.



RESULTS
genes with low hybridization signal
in order to conduct genomic comparisons of populations and species we first needed to understand what type of genome variation was causing the variation in hybridization signal. to do this, we compared sequences on the array that showed low hybridization signal in the swedish crab ecotype to the genome sequences from a preliminary l. saxatilis genome assembly made from an individual of the same ecotype and from the same locality. in these analyses we assume that the genomes of the sequenced individual and of the snails used for the acgh experiment are identical.

the log2-transformed signal intensity per gene, averaged over the four snails of the swedish l. saxatilis crab-ecotype, had an average of  <dig>  ±  <dig>  ). we defined low hybridization signal to be below  <dig>  , which corresponds to a drop of more than six-times in the fluorescent intensity on an absolute scale. we chose this method instead of using parameters of a left-side distribution from the mixed-distribution model since the left peak was not clearly defined and largely overlapped with the main peak . this resulted in  <dig> “genes” on the array of which  <dig> came from the ch317-123m <dig> bac-clone,  <dig> came from l. saxatilis transcripts, seven from heterologous sequences and a random class of oligonucleotides with 44%-gc content that are included on nimblegen oligoarrays as standard procedure.

the ch317-123m <dig> bac-fragment  has a total length of  <dig>  nt and was divided into  <dig> fragments , each  <dig> -nt long, on the array. inspection of data for all fragments of this bac clone showed that hybridization success in crab ecotype-snails varied along the bac clone, with two regions of very low hybridization signal  and two regions of average or high hybridization signals ; see figure 3a, red line. we performed blastn searches for the  <dig> -nt fragments of this bac-clone against the l. saxatilis draft genome assembly . the fragments with low hybridization signals had only short matches to the genome sequence that were likely to occur by chance while the fragments with high hybridization success had long matches with high similarity to the genome data, as represented by alignment bits scores in figure 3b. overall, the distribution of alignment bit score along the bac clone closely followed hybridization success . however, the genome draft assembly at present has a total size of  <dig> mbp, while the haploid genome size estimated by flow cytometry is  <dig>  gbp  <cit> , indicating that some regions are problematic to assemble from short reads and are missing in the assembly. to test whether this was the reason why we did not find some bac fragments in the genome assembly, we mapped illumina reads from the genome sequencing to the ch317-123m <dig> bac clone using qualimap  <cit> . however, the regions of the bac clone that were not found by blastn also had zero coverage by unassembled reads .figure  <dig> 
low acgh signal for ch317_123m <dig> fragments suggests deletions in
littorina saxatilis
genome. a) centered hybridization signals in crab ecotypes of l. saxatilis from sweden  and britain  calculated for  <dig> -nt intervals of ch317_123m <dig> bac. b) results of blastn search in l. saxatilis genome assembly for  <dig> -nt intervals of ch317_123m <dig> bac, represented by a bit score of the top hit. c) mapping of reads from the illumina sequencing of 300-nt genomic library to ch317_123m <dig> bac.



thus, it is likely that two large fragments of the ch317-123m <dig> genomic region are absent in the genome of the swedish crab-ecotype snails that were used in our acgh experiment as well as in the genome of another crab-ecotype individual that is being sequenced in the genome project. the ch317-123m <dig> bac clone was originally characterized for the british crab-ecotype  <cit> . surprisingly, the hybridization success along ch317-123m <dig> for four snails of the british crab-ecotype were very similar to the one described for the swedish crab-snail individuals . this suggests that there may be an insertion-deletion polymorphism for large genomic regions in l. saxatilis, and the deletion variant may be rather common. alternatively, there may be an artifact in the bac assembly.

low hybridization success of genomic dna from the swedish l. saxatilis crab-ecotype snails was also observed for  <dig> “genes” on the array representing transcripts. for these, we retrieved probe sequences  and performed blastn search in the littorina genome assembly with default blastn parameters. for comparison, we performed the same analyses for the transcripts that had hybridization signal intensity around the average. probes representing four of the low-signal transcripts were not found in the genome; the rest of the low-signal probes showed only partial similarity to the genome contigs , although often with high identity . the majority of the probes yielding average-signal transcripts had full-length or nearly full length-matches to contigs from the genome assembly  and identity close to 100% . since the probes were derived from transcript sequences, partial matches with high similarity to the genome contigs are expected when a particular probe spanned the boundary between two exons. in such cases, 5′ or 3′ ends of hybridized genomic dna fragments contained an intron sequence and did not match the probe. analyses of the blastn results for probes with partial similarity to the genome  showed that in most cases  the second blastn hit, including the other  end of the probe, was on a different scaffold. in a few cases , the second blastn hit was on the same scaffold. this result is expected given that the genome scaffolds at present are very short  and consecutive exons are likely to be on different scaffolds. thus, the transcripts with lower hybridization success seem to be the ones where all or a majority of the probes happened to span exon boundaries.figure  <dig> 
exon/intron boundaries cause low hybridization to 60-nt probes in
littorina
acgh. sequences of acgh probes with low  and normal  signal in the swedish crab ecotype of l. saxatilis were compared to the littorina genome draft by blastn. low-signal probes had shorter lengths of the top hit than normal-signal probes , indicating exon/intron boundaries within low-signal probes. identity scores for low-signal probes were slightly lower than for normal-signal probes . each distribution is shown as a frequency histogram and a box plot , showing 25% and 75% quantiles , mean ± c.i. , median , outliers  and the densest region of the distribution .



however, some of the low-signal probes  had full-length matches to the genome contigs. for those we calculated the gc content and the number of mismatches to the genome sequence and compared them to the same parameters for  <dig>  probes with average hybridization signal and full-length match to the genome sequences. while the average number of mismatches in the low-signal probes was only slightly higher compared to the average-signal probes , the gc-content of the low-signal probes was low compared to the average-signal probes . the optimal gc-content for nimblegen oligoarray-probes is 44%, and average-signal probes were all close to this value. however, due to variation in gc-content of partial transcripts used in the array design, some probes had a lower, i.e. sub-optimal, gc-content and this appears to have had a large negative effect on hybridization.

effect of mismatches on the hybridization signal
as shown above, genes with very low hybridization efficiency in the swedish crab-ecotype of l. saxatilis depended on occurrences of exon-intron boundaries within the probe sequences or low gc-content of the probes. to further investigate the sensitivity in hybridization of 60-nt probes to sequence divergence , we looked at the correlation between signal intensity and the number of substitutions for the probes that had full-length matches to the genome sequences . we identified  <dig>  such probes with  <dig> up to  <dig> nt differences compared to the genome sequence. among these the hybridization signal intensity did not decrease with the number of substitutions  but correlated positively with the gc content of the probe .

in the analyses above we did not know the actual genome sequences of the individual snails used for hybridization, although we expected that they were highly similar to the genome of the sequenced swedish crab-ecotype individual, originating from exactly the same locality. to test directly how the number of mismatches affected the hybridization, we sequenced a fragment of the mt cytochrome b gene for  <dig> out of  <dig> individuals used in our experiment and calculated the number of mismatches between these sequences and the cytochrome b probes on the array. for this gene, the array contained two sets of probes designed from two non-overlapping fragments, and each set contained five sequence variants that differed from each other by 1- <dig> snps, making a total of  <dig> probes. in addition, five of these probes were included on the array twice. for replicated probes, there was a high consistency of hybridization for identical probe replicates . the direct sequencing of these fragments in the dna samples revealed up to six mismatches between the probe and hybridized dna. single mismatches did not affect the success of hybridization  while two or more mismatches significantly decreased the hybridization efficiency . however, there was high variation in hybridization efficiency within each mismatch class of probes. this could not be explained by the length of the perfect match, the position of the first mismatch relative the 5′ end of the probe or by change in the gc content caused by the mismatches . however, probes with lower gc content  were more sensitive to mismatches than probes with higher gc content . to test whether the level of variation in the mt cytochrome b gene is representative for other genes in the littorina genome, we calculated the proportions of variable sites in the british population of l. saxatilis in the cytochrome b fragment using data from  <cit>  and for the transcripts used in the array design based on data from  <cit> . the proportions were similar:  <dig>  for cytochrome b and  <dig>  on average for the transcripts.figure  <dig> 
effect of mismatches on acgh signal in
littorina
in re-sequenced
cytochrome b
probes. a fragment of the mitochondrial cytochrome b gene was re-sequenced in  <dig> littorina individuals and compared to the probe sequences to identify mismatches. a) signals from two replicates of identical probes; b) the effect of 1- <dig> mismatches within the probe on the hybridization signal .



altogether our sensitivity analysis showed that occurrences of exon-intron boundaries and the gc-content of probes had major effects on the hybridization success when using genomic dna for hybridization. occurrence of two or more nt mismatches within the probe may decrease hybridization efficiency, but to a smaller extent, and this effect varied widely among the probes.

candidates for gene duplication
in addition to the genes with low hybridization signal intensities there were a number of genes showing hybridization signals far above the average, possibly resulting from segmental duplications in the genome. the overall signal intensity distribution for each sample could be described as a mixture of three normal distributions: a small low-signal peak of genes, a major peak in the center and a high-signal peak of genes with intensities well above the average. figure  <dig> shows the mean signal intensity distribution for the  <dig> l. saxatilis individuals together with a fitted model; distributions for other species were similar and are not shown. parameters for the fitted distributions for each species are presented in table  <dig>  after fitting the model, we defined high-signal genes as those with intensities greater than or equal to the mean minus two standard deviations of the right side distribution and normal-signal genes as those within two standard deviations of the mean for the central distribution. the cut-off at two standard deviations was chosen in order to include 95% of the distributions and at the same time avoid a large overlap between the thresholds .table  <dig> 
identification of potentially duplicated genes and genomic regions in
littorina



l. saxatilis
 <dig>  ±  <dig> 

l. compressa
 <dig>  ±  <dig> 

l. arcana
 <dig>  ±  <dig> 

l. fabalis
 <dig>  ±  <dig> 
a model with three mixed normal distributions was fitted to overall distributions of hybridization signal intensity in each species:  <dig> – low signal genes,  <dig> – normal signal genes ,  <dig> – high signal  genes, in bold. see also colour curves in figure  <dig>  m ± s.d are means and standard deviations for three normal curves in each species.



a relatively high number of genes on the array, approx. 10%, showed a high hybridization signal and thus indicate multiple copies in the littorina genomes . for the swedish crab-ecotype of l. saxatilis,  <dig>  genes belonged to the high-signal peak of the distribution, compared to the  <dig>  genes in the middle peak, the normal-signal distribution . for these two groups of genes, we first retrieved genome sequences from the littorina genome assembly corresponding to these array sequences . of the genes with normal signal levels, 94% were found in the genome assembly producing  <dig>  putatively single-copy genome contigs. of genes showing high signals, 90% were found in the genome assembly producing  <dig>  genome contigs that possibly contain segmental duplications. . second, we compared the genome sequencing coverage for these two groups. median sequencing coverage for single-copy contigs was 50× , while multiple-copy genome contigs had generally higher coverage with median at 880× .

in the analysis of all l. saxatilis individuals together we identified  <dig>  genes as potentially present in many copies. of these only  <dig> showed similarity to known proteins, and mainly to reverse transcriptases found in various organisms . reverse-transcriptase genes are known to be present in eukaryotic genomes in many copies as a part of retrotransposons and long interspersed elements . similarly, the e <dig> genomic fragment , coming from genome scans of the british ecotypes of l. saxatilis and containing signatures of sine-retrotransposon elements  <cit> , showed evidence of multiple copies in acgh . thus, at least some of the segmental duplications in the littorina genome suggested here by acgh are likely to be associated with different types of repeats and transposable elements.

a more surprising finding is that a large proportion of genome regions available from a previously characterized l. saxatilis bac-library suggest high copy numbers:  <dig> kb of  <dig> kb, or 23%, in l. saxatilis. . in addition, three regions of mtdna, containing trnas, nadh- <dig> and cytochrome b genes showed high hybridization signals in all species. high hybridization signal for mitochondrial genes on the array is expected since the mitochondrial genome is present in more copies per cell than the nuclear genome. additional inspection of signal data also revealed signal intensities that were two times the average for other mitochondrial genes . at the same time, mitochondrial regions containing genes for small and large subunits of ribosomal rnas hybridized at a level of half or less, of the average, possibly due to a propensity of these dna fragments to form secondary structures that impede hybridization.

genome divergence between four closely related littorinaspecies
overall hybridization success  varied among the species  and was significantly lower for dna samples of l. fabalis and l. compressa than for dna samples of l. saxatilis and l. arcana . however, the drop of signal was small, e.g. the differences in average hybridization signal intensity between l. fabalis and l. saxatilis was  <dig>  on a log- <dig> scale, or  <dig>  times on an absolute scale.figure  <dig> 
overall comparative genomic hybridization levels in four
littorina
species.  <dig> – l. saxatilis,  <dig> - l. arcana,  <dig> – l. compressa,  <dig> – l. fabalis. bars show 95% confidence intervals.



neighbour-joining clustering based on the number of genes that differed significantly in all pair-wise contrasts between the species and populations  corroborated the phylogeny of this group . interestingly, differentiation between the british and spanish populations of l. saxatilis in this analysis was of similar magnitude to that among the sibling species. hierarchical clustering based on hybridization signal intensities from all genes on the array also produced a tree similar to the phylogeny of the group but the order of splits between l.arcana, l. compressa and l. saxatilis had low support and could not be resolved .figure  <dig> 
clustering of
littorina
species and populations based on acgh data. a) neighbour-joining clustering by the number of divergent genes between littorina species. genes with significantly different hybridization signal were identified in comparisons of species and populations against l. saxatilis-britain . numbers of divergent genes and their percentage of the total number of genes on the array are shown along the branches. b) consensus tree of  <dig>  bootstrap replicates based on all genes on the array. numbers showed proportion of trees containing each cluster.



in pca plots based on signal intensity variation across all sequences on the array, l. fabalis was well separated from the other three species . similar results were obtained when we included only sequences representing transcripts , or including only bac sequences, containing mainly non-coding regions . pca based on mitochondrial genes only, however, did not show separation between species, except for the outlying l. fabalis individuals . this can be partly due to a low number of mitochondrial genes on the array  and partly due to the fact that divergence in mitochondrial gene sequences is mainly at the substitution level, which in the sensitivity analyses above was found to affect hybridization less than gene duplications and genomic deletions.figure  <dig> 
pca plots comparing genomic hybridizations of
littorina
species. a) four species, all sequences . b) four species, only bac fragments . c) four species, only mt dna sequences . d) three sibling species, based on genes with significant variation among species . e) three sibling species and geographic populations of l. saxatilis, based on genes with significant variation among these groups . f) geographic populations of l. saxatilis, based on genes with significant variation among groups . also shown are numbers of significant genes for pairwise comparison of the populations.



the three sibling species l. saxatilis, l. arcana and l. compressa did not show separation in pca analysis based on all genes. however, after excluding the l. fabalis samples, and using only  <dig>  genes that showed significant differences in hybridization among the three remaining species , l. arcana, l. compressa and l. saxatilis formed distinct groups, separated along the different axes . to compare the degree of divergence between these sibling species with the intraspecific variation in l. saxatilis, we repeated the analysis with l. saxatilis divided into the three geographic regions. notably, in this case the samples from the spanish population of l. saxatilis also formed a distinct group, with the magnitude of separation close to that among the three sister species .

variation in l. saxatilisdue to geographic regions and ecotypes
in the analysis including only l. saxatilis individuals, we found genome divergence among the three geographic regions  in  <dig> genes . in the pca based on these genes, the spanish population separated from the other two populations along the first axis explaining 45% of the variation, while the british and swedish populations separated along the second axis explaining 15% of the variation .

no genes showed significant differences in hybridization between the ecotypes of l. saxatilis, neither in the comparison of crab vs. wave ecotypes across the three regions, nor in separate comparisons of the ecotypes within each region . however, we found some indication that there may be cnvs between the ecotypes across all the regions: there were  <dig> genes that showed evidence of multiple copies in one but not the other ecotype . of these, only  <dig> had annotations in lsd and mainly to proteins containing the reverse-transcriptase domain .

genes with high divergence rates
significant differences in acgh signal intensities between the species indicate genes and genome regions with elevated divergence rates and/or cnvs. we identified such genes in different species and populations in comparison to the l. saxatilis samples from britain, since the array design was based on sequence data from the british population. the highest number of genes that differed significantly from the british l. saxatilis was found in l. fabalis; the numbers in l. arcana and l. compressa were roughly an order of magnitude lower .

we compared cohorts of genes that showed significant differences between the british populations of l. saxatilis and one of the other three species . of  <dig>  genes,  <dig> were found in two comparisons and  <dig> showed divergence between l. saxatilis and all three other species ; most of the genes showed significance for only one pair of species. similar results were obtained from a heat map of the signal strength for the  <dig>  genes in different samples ). for most of the genes with significant variation the hybridization efficiency was higher in l. saxatilis than in the compared species . however, a number of genes showed differences in the opposite direction, especially in l. fabalis, possibly due to higher copy numbers in this species compared to l. saxatilis or mutations increasing gc content of the sequences.figure  <dig> 
genes with high divergences between
littorina
species. a) venn diagram showing number of genes with significant  divergences between l. saxatilis-britain and each of the three other species; b) heatmap showing hybridization success in the four littorina species in the genes with significant divergence between the species.



for different littorina species, the high-signal portion of the distribution contained  <dig>  –  <dig>  genes , which is approximately 10% of all sequences represented on the array. in general, there was a large overlap between the species suggesting that expansion of these genome regions occurred before the diversification of this littorinid lineage .

discussion
in the present study we applied hybridization of genomic dna from several species and populations of the north-atlantic littorina to an oligonucleotide array representing mainly l. saxatilis transcriptional sequence information. we showed that this approach can successfully detect cnvs, deletion and high sequence divergence  but that it is not sensitive enough to detect single snps. using this method we found a close agreement between patterns of genomic hybridization and previous phylogenetic reconstructions for this group based on only one or a few genes. however, we were not able to detect genes and genomic regions that have diverged between the crab and wave ecotypes of l. saxatilis. below we discuss these results in detail.

types of genome divergence detected by genomic dna hybridizations to oligonucleotide gene expression arrays
our sensitivity analyses showed that hybridization of genomic dna to long-oligonucleotide arrays designed mainly from transcript sequences can potentially detect sequence divergence at the level of roughly  <dig> or more mismatches per  <dig> nt probe length . however, the signal drop could not be directly translated into the number of mismatches due to high variation between the probes. we observed a significant correlation between number of mismatches and hybridization signal intensity in the subset of mitochondrial probes, but not for all probes on the array. it has been shown that other factors, such as the probe gc content, the position and type of substitution, may have larger effects on hybridization success using oligonucleotide arrays than the number of mismatches  <cit> . this is in agreement with our results, where the most important factor for hybridization success at the probe level was found to be the gc content. it has been shown that oligonucleotide probes with 42% gc  had the highest hybridization intensity at 42°c as compared to 30% and 56% gc  <cit> . probes with high gc content, however, were not sensitive to mismatches and outperformed probes with optimal gc content when there were several mismatches between the hybridizing dna fragment and the probe  <cit> . we conclude that this approach is rather conservative at the snp level and identifies only genes with high divergence and is likely to miss single snps.

secondly, we were able to reliably detect genetic variation above the snp level, such as segmental duplications and deletions. genes and regions showing high signal intensity  had higher coverage in the littorina genome sequencing and some of them had been previously annotated as transposon-like elements in littorina
 <cit> . genomic regions with signal intensity at the background level  were absent in the littorina genome assembly. in addition, hybridization of genomic dna fragments to the transcriptome-based array provided information on the position of exon-intron boundaries.

to conclude, using an oligoarray platform, it is possible to detect large deletions, segmental duplications and high divergence between sequences. owing to the rapid development of next generation sequencing techniques, future methods to study genome divergence between closely related species and populations are likely to employ low coverage genome re-sequencing and reduced representation sequencing approaches. still our analyses show that long oligonucleotide genomic arrays can be a useful tool for genotyping different types of genetic variation simultaneously, especially if probe length is optimized for snp detection. for example, a 50-nt tiling array has been designed for single snp genotyping in caenorhabditis elegans
 <cit>  and a tiling array with various probe lengths has been used to screen for novel deletions, chromosomal breakpoints and snps in the fungus trichoderma reesei
 <cit> .

genome divergence and phylogenetic relationships in closely related north-atlantic littorinaspecies
the overall genome divergence pattern of the four closely related north-atlantic littorina species included here corresponds well to the phylogenetic reconstructions based on only a few genes  <cit> . littorina fabalis, which diverged from l. saxatilis 2- <dig> mya, showed lower hybridization success to the l. saxatilis array and was clearly separated by pca. littorina arcana and l. compressa, with divergence times from l. saxatilis estimated to be  <dig> - <dig>  ma, did not show separation from l. saxatilis by pca when all genes were taken into account. however, there were a number of genes with significant signal variation among the three sibling species, and species separation was much more pronounced  than between british and swedish populations of l. saxatilis. this suggests that some genes have diverged but a large part of the genome still shares ancestral variation in these sibling species. this finding is in agreement with earlier reports on shared genetic variation in allozymes, nuclear introns and mtdna .

our genome-wide analysis could not resolve the trichotomy between these three species. on one hand, the overall hybridization success was lower in l. compressa than in the other two species, likely due to a higher sequence divergence. this would imply that l. compressa was first to split out within this group, as was suggested by knight & ward  <cit>  and wilding et al.
 <cit> . on the other hand, there were more genes with significant divergence between l. arcana and l. saxatilis than between l. compressa and l. saxatilis. finally, our hierarchical clustering analyses based on all genes could not resolve the order of splits between these species, and the degree of separation by pca was roughly similar for all pairwise species comparisons. solving the phylogenetic relationships between these sibling species is further complicated by the fact that the number of diverged genes can reflect both the on-going process of lineage sorting  <cit>  or divergent selection in newly formed species  <cit> . the geographic ranges of l. compressa and l. arcana are much more limited than that of l. saxatilis and, when all three species co-exist on the same shore, their micro-zonal distributions are only partly overlapping  <cit> . this may indicate differences in ecological and microhabitat preferences between these species. under diversifying selection some genes may have achieved higher divergence between l. arcana and l. saxatilis, while others have diverged more between l. compressa and l. saxatilis, which is supported by our comparison of the genes with pair-wise divergence between the species . at this point we agree with reid et al.
 <cit>  that the phylogenetic relationships between these three species are best represented as a trichotomy, reflecting the fact that the two divergence events occurred recently and very close in time, and that their order cannot be resolved. hence, we predict that if more genes are analyzed in the future, the genealogies will continue to produce conflicting phylogenies for this group.

altogether, the neighbour-joining tree of the studied littorina lineage based on the acgh data is very similar to earlier phylogenetic trees based on a few loci for species relationships  <cit>  or even on single mtdna locus for regional variation in l. saxatilis
 <cit> . even discrepancies between markers, as in case of the three sibling species that had earlier led to conclusion of an unresolved trichotomy, have support by the observed genome-wide pattern. thus, this study provides one of the first comparisons of genome-wide variation to single locus estimates. together with other studies demonstrating the utility of, for example, mtdna markers in phylogeny and phylogeography  <cit> , our results suggest that single-gene phylogenies can indeed be informative and reliable, and even in the future may serve as useful tools for at least pilot phylogenetic reconstructions.

geographic variation in l. saxatilis
the spanish population of l. saxatilis appears to be genetically distinct from the two more northern populations almost to the same degree as the three sibling species included in this study . this confirms the conclusion from mtdna analyses of a long independent evolutionary history of the spanish l. saxatilis population and divergence time estimates of approx.  <dig>  ma  <cit> . interestingly, a breeding experiment showed that crosses between spanish and swedish snails produce viable and fertile offspring . the two other populations of l. saxatilis, from britain and sweden, did not show any divergence at all in our analyses. this agrees with a hypothesis that these populations were established through relatively recent, post-glacial colonization events from a shared refugium or refugia other than the spanish coast  <cit> .

local forms of crab and wave ecotypes of l. saxatilis exist in spain, britain and sweden and a key issue is whether or not these ecotypes have evolved repeatedly or have one common origin  <cit> . genome divergence of the spanish populations from the two northern populations, detected in this study, clearly supports a recent finding  <cit>  that the crab and wave ecotypes of spain vs. sweden/britain, have evolved independently of each other and possibly from different genetic backgrounds, despite similar phenotypic characteristics.

rapidly evolving and duplicated genes in the studied littorinalineage
most of the genes showing significant divergence in the studied littorina lineage were specific to pairs of species. this might be due to random accumulation of differences with time or due to species-specific selection regimes . moreover,  <dig> genes showed elevated divergence in all pair-wise species comparisons. these come from the transcriptome library and did not show similarity to any know proteins, probably due to their short length, and will be a focus in future studies.

we did not find any genes with significant array hybridization differences between crab and wave ecotypes. however, there is evidence for a genetic basis of ecotype differences  and of limited gene exchange between the ecotypes  <cit> . given that our acgh approach was not sensitive enough to detect single snps, our results suggest that the genetic variation behind the ecotype differences is likely to be at the level of single mutations in coding or regulatory sequences, that may have large phenotypic effects  <cit> . indeed, an earlier study detected snp variation in transcript sequences between the ecotypes in britain  <cit> . another type of genetic variation that may facilitate adaptive divergence is chromosomal inversions. this has been suggested e.g. for ecotypes of l. fabalis, although direct evidence for it is lacking  <cit> . our acgh method cannot provide any information on chromosomal inversions, and the importance of this mechanism in the evolution of littorina ecotypes is yet to be investigated.

the hybridization pattern along the ch317-123m <dig> bac-clone indicated an insertion-deletion polymorphism for a large genomic region in l. saxatilis. the deleted region, identified in this study, does not appear to contain any open reading frames  <cit> . the ch317-123m <dig> fragment has been identified previously by an aflp-scan for outliers between the british ecotypes of l. saxatilis
 <cit>  and contains insertions of repeated transposable elements outside the putatively deleted regions  <cit> . although our data support an insertion-deletion polymorphism and transposable elements in this region, we did not observe any differences between the ecotypes, and deletion variants appear to be common in both british and swedish populations. an alternative explanation to the lack of hybridization to this fragment is that there is an artifact in bac assembly.

in contrast to the cohort of rapidly evolving genes, multiple-copy genes were mostly shared between the studied littorina species. we found evidence that the snail genome probably contains a high level of segmental duplications, as 23% of bac regions had high signals, which is not surprising given the relatively large genome size of  <dig>  gbp  <cit> . further, our data indicate that at least some of the duplicated regions in the littorina genome are associated with transposable elements and repeats. high abundance of repeats and multiple-copy regions has been found in the recently published genomes of the mollusks conus bullatus
 <cit>  and crassostrea gigas
 <cit> . our analyses produced a list of over  <dig>  genes that are likely to be present in multiple copies in the snail genome. however, due to the short length of transcripts used for the array design, several transcripts may correspond to the same gene  <cit> , or different members of gene families may be represented by the same partial transcript. thus, the number of duplicated genes in the snail genome will require further investigation.

a few percent of the analyzed genes appear to be duplicated in only one species, suggesting that there are cnvs between these closely related littorinid species. finally, in the comparisons of duplicated genes we found some indication for cnvs between the crab and wave ecotypes. this will require further confirmation since these differences were not significant in the anova, but they are generally in agreement with the earlier observation of transposable element variation associated with the british ecotypes  <cit> .

presently, the low annotation success of littorina transcripts  limits the biological and functional information that we can extract from the present dataset, i.e. we do not know the function of genes that show signs of duplication and/or rapid divergence in the analyzed littorinid species. however, on-going de novo genome sequencing and several transcriptome characterization projects in littorina will potentially change the situation in the near future. when these resources become available, the next step will be to map the candidate sequences, identified in the present study, to annotated genes. further, the identified candidate genes with high divergence between the species will be used in re-sequencing studies in order to distinguish signatures of diversifying selection from incomplete lineage sorting.

CONCLUSIONS
in the present study we showed that acgh can be performed for non-model organisms by hybridization of labeled genomic dna to transcriptome oligonucleotide arrays. we used this approach to study genome divergence in the north-atlantic intertidal species of littorina snails  as well as among geographic populations of l. saxatilis, representing radiation events from approximately 2- <dig> mya to very recent post-glacial events. in addition, we looked for genome differentiation between the two common ecotypes of l. saxatilis.by comparisons of probe hybridization signals to the littorina genome draft and the direct re-sequencing of probes we showed that acgh can successfully detect copy number variations, segmental deletions and high sequence divergence . however, the method is not sensitive enough to detect single snps.

overall, genomic hybridization patterns are in agreement with the single-gene phylogenies and molecular estimates of divergence times for these closely related species, which lends credibility to the numerous phylogenies that have been, and still are, based on only one or a few genes.

we were not able to resolve conflicting phylogenies produced by different markers for the three sibling species l. saxatilis, l. arcana and l. compressa. we hypothesize that there is high variation between individual gene genealogies in this group owing to very incomplete processes of lineage sorting and/or diversifying selection, and the order of the species splits may not be resolvable.

we detected a surprisingly high level of genomic divergence between the spanish and the british/swedish populations of l. saxatilis, in fact similar to divergences among the sibling species. this lends strong support to the hypothesis of long isolation of the spanish populations and independent evolution of snail ecotypes in spain and in the two other regions.

while there are multiple sources of evidence for a genetic basis of the l. saxatilis ecotype variation, this variation could not be detected by the present method and is likely to be on the level of single snps.

finally, we found  <dig> genes that could be candidates for rapidly evolving genes within the entire littorina  lineage. however, many more genes showed elevated divergence between pairs of the species compared. on the other hand, duplicated genes were mainly shared between all the species studied here. our analyses indicated a high degree of segmental duplication in the littorina genome  and likely to be associated with transposable elements.



to conclude, the results of the present study provide new information on the sensitivity and potential use of long oligonucleotide arrays for genotyping in non-model organisms. applying this method to littorina sp. provided the first insight into genome evolution of a recently speciated genus and an ongoing radiation within one of the species, l. saxatilis.

availability of supporting data
the full dataset from the oligonucleotide acgh experiment has been submitted to the ncbi gene expression omnibus  <cit>  under the accession id gse <dig> 

electronic supplementary material
additional file 1: figure s1: example of signal distributions after anova and rma normalizations. 

 additional file 2: figure s2: genome sequencing coverage for genes with normal and high acgh signal intensities. 

 additional file 3: table s1: lists of genes with high acgh signal in littorina species, populations and ecotypes. 

 additional file 4: table s2: lists of genes with significant  acgh differences between littorina species. 

 abbreviations
acgharray comparative genomic hybridization

aflpamplified fragment length polymorphism

anovaanalysis of variance

bacbacterial artificial chromosome

cnvscopy number variants

mtdnamitochondrial dna

pcaprincipal component analysis

snpssingle nucleotide polymorphisms.

competing interests

the authors declare that they have no competing interests.

authors’ contributions

mp, ca, kj, tj, at conceived the study, discussed the experiment design and the initial strategy for data analyses. bc, tj, mp, ca designed the microarray. mp and tj conducted the experiments and analyzed the microarray data. mp performed the statistical analyses with advises and support from mar, bc and jb. mar provided the littorina genome draft. jb analyzed the coverage. mp drafted the manuscript. all authors read and approved the final manuscript.

