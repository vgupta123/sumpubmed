BACKGROUND
chromatin immunoprecipitation  is the reference method for investigating protein-dna interactions and chromatin-binding protein modifications, such as histone tail modifications. genome-wide applications first coupled chip with microarrays   <cit> . then with the develop of next generation sequencing  technology, chip coupled with high-throughput sequencing  became the golden standard  <cit> . while chip-seq offers several important improvements over the array-based application  <cit> , such as higher resolution, less noise and greater coverage, chip-seq still suffers from the limitation imposed by the large amount of cellular material needed for the chromatin immunoprecipitation step and amplification of the isolated dna. therefore, in the last few years a great deal of effort has been directed at developing chip-seq protocols to lower the scale by orders of magnitude.

chip-seq is a complex and multi-step process. the numerous steps with few quality control steps throughout contribute to the challenges when scaling chip-seq. in addition, limited amounts of chromatin are further challenged by non-specific interactions with beads and antibody. the signal-to-noise ratio, therefore, tends to decrease as the number of cells used for chip decreases. previously, two methods were developed in an attempt to solve the issue of constructing libraries from small amounts of dna obtained from chip on as few as  <dig>  cells. nano-chip-seq achieved success for several histone modifications using  <dig>  cells by implementing a modified primer to first amplify the dna by primer extension using sequenase, followed by pcr amplification, then restriction digest to remove the primer/adaptor prior to standard library amplification  <cit> . this study also pointed out the need of titrating the quantities of antibody and beads for each mark, as optimizing antibody to beads and antibody-coated beads to chromatin are not linear in reduction , making these steps perhaps the greatest hurdle for small-scale chip. a single tube linear amplification method  was recently developed and successful for chip-seq for h3k4me <dig> on  <dig>  cells  <cit> . this method requires additional modifications prior to standard library preparation. t <dig> linkers are added for in vitro transcription and cdna synthesis, which are subsequently removed by restriction digest prior to standard library preparation. each of these methods, however, have yet to be widely adopted, perhaps due to the complex nature of the amplification schemes as well as the aforementioned need to optimize chip reaction conditions. this amplification complexity is potentially overcome by the use of whole genome amplification  approaches. this was illustrated for chip-seq of h3k4me <dig> largely optimized on chromatin equivalents of  <dig>  cells, with spearman’s correlation values for replicates ranging from  <dig>  to  <dig> . slightly lower correlations were found for chromatin equivalents of  <dig> cells  <cit> .

the most complex, but scalable chip approach to date is ichip   <cit> . this method overcomes the issue of limited cells by pooling multiple cell populations together after on-bead indexing of the sonicated, chromatinized dna. a sequential chip process is used with this intermediate indexing step. first, histone h <dig> is immunoprecipitated, as this is an abundant and genome-wide histone that provides a working scale chip reaction, which is followed by ligating barcode sequences that are later used to identify each cell population. once multiple cell types are barcoded, they are pooled and subjected to paralleled histone modification chip-seq. although this method allowed for chip on as few as  <dig> cells per population, the need for contextually assaying multiplexed cell populations limits the usage to large comparative studies.

the pooling of cell types to create a working scale chip reaction was originally described by o’neill and colleagues by using drosophila chromatin as a carrier  <cit> , and therefore called carrier chip , in order to chip limited numbers of mouse cells . this has the advantage of establishing a single scale for chip because the bulk of input chromatin applies to the carrier. this is also advantageous when using multiple antibodies, as most function similarly at such a scale, and therefore optimization for each antibody is not needed. the overwhelming disadvantage of this method, as applied to chip-seq, is the presence of carrier dna, which is not problematic when using species-specific primers for quantitative pcr, but will overwhelm sequencing libraries. thus, making this approach unsuitable for chip-seq, but provides a basis for a working scale chip reaction for limited cell amounts. for example, a similar approach was taken for developing a small-scale chip-seq protocol using a bacterial dna as a carrier to aid library preparation  <cit> . the caveat is that in order to get the sequencing depth necessary for profiling either histone marks or transcription factors the library needs to be sequenced to a substantially greater depth as up to 80 % of the reads mapped to the bacterial genome.

collectively, these approaches point out two disadvantages of low scale chip-seq, namely chromatin to beads to antibody ratio optimization and amplification of isolated dna. the need to optimize the amount of antibody-coated beads is due to the fact that a disproportion between antibody and epitopes contributes to non-specificity, and therefore noise. cchip  <cit> , as well as ichip-seq  <cit> , overcome this by using a working scale chip reaction in the range of a few thousand to hundreds of cells. our goal was to develop a method for chip-seq that does not require i) highly tailored optimization of chromatin to beads to antibody ratios and ii) extensive processing for the amplification of chromatin immunoprecipitated dna. we developed cchip-seq: carrier chip-seq . as illustrated in fig.  <dig>  this method is based on a widely utilized standard chip protocol  <cit> , where the main modification is the introduction of a chemically modified recombinant histone h <dig> as the carrier. we reasoned that recombinant histones with a single chemical modification, matching that which is to be assayed, could serve as a “chromatin carrier” for the purpose of maintaining the working scale of the chip reactions. this removes the need to optimize the chromatin to antibody to beads ratios as a suitable number of modified histones are present as an epitope for the antibody. furthermore, a dna-free carrier does not require dealing with unwanted dna during library preparation and sequencing. we show that cchip-seq is highly successful at generating data on  <dig>  cells for several key histone modifications, and requires little modification to a standard chip-seq protocol.fig.  <dig> cchip-seq. a the schematic illustrates conceptual design and key steps of the cchip-seq protocol. b ucsc genome browser snapshot showing a representative example of cchip-seq and encode data for h3k4me <dig> , h3k4me <dig>  and h3k27me <dig>  generated in the k <dig> cell line . r1: replicate 1; r2: replicate 2



RESULTS
to establish cchip-seq , we optimized sonication of a limited number of crosslinked cells down to  <dig>  cells using the covaris le <dig> ultrasonicator . for each test, cells were counted prior to chromatin isolation, as were nuclei prior to sonication to ensure cell and chromatin amounts in each cchip experiment. we estimated the amount of recombinant carrier histone based on potentially marked histones . we have applied cchip-seq to three informative and commonly investigated histone modifications: h3k4me <dig>  h3k4me <dig> and h3k27me <dig> . we have compared our data to existing data from either the encode consortium or roadmap epigenomics consortium . we provide a robust, yet simple method for chip-seq of  <dig>  cells, which should be applicable to almost any histone modification and compatible with most working chip protocols.

as an initial optimization, we performed cchip-seq for h3k4me <dig> in k <dig> cells , reasoning that it is the most robust mark to chip and should perform best at a small scale. after chromatin sonication, we mixed  <dig> ,  <dig>   <dig> and  <dig> whole-cell equivalents with recombinant histone h <dig> with a lysine  <dig> trimethylation modification  and incubated with magnetic beads pre-bound with antibody against h3k4me <dig>  we then proceeded to perform chip-seq as described previously  <cit> , but with the minor modification of generating libraries using pcr amplification performed in two sequential rounds of limited cycles to help reduce amplification-based background . we generated a total of ~  <dig> million monoclonal mapped reads so that all libraries were likely sequenced to saturation. we assessed correlations between replicates and across cell amounts, followed by a comparison to encode consortium data as a standard for the field  <cit> . in order to account for differences that arise from variation in lab-to-lab practices, we compared our data to two different replicated datasets from encode: broad and sydh. in order to avoid bias due to differences in the computational analysis, we obtained raw data for each datasets  and analyzed all datasets with our pipeline under the same settings .

cchip-seq replicates for  <dig>  cells correlated as well as replicates for each encode group . pearson’s correlation coefficients calculated across cchip-seq, broad and sydh showed that at  <dig>  cells cchip-seq performed well relative to encode data with average coefficients of  <dig>  with respect to broad and  <dig>  with respect to sydh. the average pearson’s correlation coefficient between broad and sydh was ~ <dig>  . for lower cell numbers we did not obtain data of sufficient quality . although enrichment for h3k4me <dig> at promoter regions could be observed when using  <dig> cells , the pearson’s correlation coefficient with respect to encode data was less than  <dig>  . this led us to conclude that below  <dig>  cells cchip-seq was sub-optimal. given our goal to develop a protocol with minimal optimizations per mark or per starting amount of cells, we focused on  <dig>  cells for the remaining validation of cchip-seq. in addition, visual inspection across the genome of h3k4me <dig> cchip-seq data using  <dig>  cells, demonstrates that our data is highly similar to encode data  further supporting the reliability of our method.fig.  <dig> cchip-seq for h3k4me <dig> on  <dig>  cells in k <dig> cells. a pearson’s correlation values heatmap for replicates of cchip-seq on  <dig>  cells and encode data. b ucsc genome browser snapshot showing h3k4me <dig> signal  for the three datasets at the hemoglobin locus . c venn diagram showing the number of unique and common regions enriched for h3k4me <dig> across cchip-seq, broad and sydh datasets. d heatmap representation of the signal intensity  across the three datasets in a 5 kb window centered at all protein-coding transcription start sites  . r1: replicate 1; r2: replicate 2



we compared cchip-seq data to encode data with respect to peak recovery. we used macs to call peaks on each replicate of cchip-seq and encode data  <cit> . we called a similar number of peaks across the three datasets, and each replicate recovered a similar overlap for each group . overlap of cchip-seq peaks recovered approximately 80 % of the peaks called in either replicate. similar peak overlaps were found for encode replicates . next, we compared the peaks called on merged replicates across the three datasets. when comparing cchip-seq peaks to both broad and sydh, 71 % of the cchip-seq peaks were found in both encode datasets . asking the reverse, cchip-seq recovered 60 % of the broad peaks and 67 % of the sydh peaks, performing as well as the encode datasets when compared to each other . only 17 % of cchip-seq peaks were unique to cchip-seq, similar to sydh  and lower than broad . we also observed a similar enrichment of the signal across datasets at gencode transcription start sites , regardless of peak calls . to confirm this observation we determined the overlap of peaks across the three datasets at tss. we observed that over 90 % of the tsss captured by each datasets were also enriched for h3k4me <dig> in the other two datasets. these results indicate that cchip-seq is a robust method to profile h3k4me <dig> marks using three orders of magnitude fewer cells with respect to what was used for generating encode data. based on the three-way comparison across groups, we conclude that differences between cchip-seq and encode data are likely to due more to expected lab-to-lab variability rather than operating at a lower scale . furthermore, the use of modified carrier histones results in a simple method that does not require any upfront optimization to scale down chip reaction conditions.

we next sought to apply our method to other histone modifications as well as test the performance on a different cell line. we first applied cchip-seq to profile h3k4me <dig>  a highly cell-type specific mark  <cit>  associated with enhancer regions  <cit> . h3k4me <dig> enrichment in k <dig> was highly comparable to encode data . pearson’s correlation across cchip-seq, broad and sydh confirmed that our method was highly reproducible  and correlated with both encode datasets  as well as encode datasets correlated with each other  . next, we compared peaks called in the two replicates per each datasets and observed that correlation across replicates was again comparable to encode replicates . moreover, cchip-seq identified the same numbers of putative enhancers  as predicted by either encode dataset in this cell line . after replicates were merged, each datasets shared an average of 47 % of the peaks  with both the other two datasets . this drop in percent overlap compared to h3k4me <dig> may be due to challenges calling broader h3k4me <dig> peaks. when asking how many of the encode peaks cchip-seq identified, we observed that our method recovered 81 % of the peaks called in both broad and sydh . again we observed that the cchip-seq data performed well with respect to either encode dataset, and as well as encode datasets performed with respect to each other confirming that differences between cchip-seq and encode data are due to inter-laboratory variability rather than the operating scale.fig.  <dig> cchip-seq for h3k4me <dig> on  <dig>  cells in k <dig> cells. a pearson’s correlation values heatmap for replicates of cchip-seq on  <dig>  cells and encode data. b venn diagram showing the number of unique and common regions enriched for h3k4me <dig> across cchip-seq, broad and sydh datasets. c heatmap representation of the signal intensity  across the three datasets in a 4 kb window centered at all h3k4me <dig> enriched regions called in the three datasets  for the three datasets at the integrin beta  <dig>  locus . r1: replicate 1; r2: replicate 2



next, we compared the signal intensity of the three datasets in a 4 kb window centered at all h3k4me <dig> enriched regions called in the three datasets . the three datasets performed similarly at all peaks regardless of peak calls. we did observe a higher baseline signal across our data with respect to encode and a similar trend was observed for this mark in h <dig> hesc ; however, the signal-to-noise ratio is more than adequate for accurately calling peaks. to further confirm our results on h3k4me <dig>  we compared the signal intensity of cchip-seq and encode data at k <dig> enhancers previously predicted by rfecs, a random-forest based algorithm recently developed to identify enhancers based on several histone modifications and p <dig> localization  <cit> . all datasets showed some degree of enrichment at rfecs enhancer locations  as well as a similar fraction of rfecs enhancers captured  . overall, data generated for h3k4me <dig> on three orders of magnitude fewer cells by cchip-seq performed in a highly comparable manner with respect to encode data .

to ensure that cchip-seq has applicability for various cell types, we performed cchip-seq on  <dig>  cells for h3k4me <dig> in h <dig> hescs and compared these data to those previously generated by the rec on a few million cells  <cit> . both visual inspection of the global enrichment and the pearson’s correlation between replicates , indicate that cchip-seq replicates are highly reproducible . furthermore, cchip-seq data correlate well with rec data  . we observed that 63 % of the rec h3k4me <dig> peak calls on merged replicates were recovered by cchip-seq . however, more than half of peaks called on cchip-seq data appeared to be unique. we reasoned that at least a fraction of those unique peaks could have been captured by either of the rec chip-seq replicates. when we specifically looked for overlap between the unique cchip-seq and either of the rec replicates , we found than 11 % of the unique cchip-seq peaks  overlapped peaks called in rec replicate  <dig> that were not called on the merged replicates. similarly, an additional 19 % of the unique cchip-seq  were captured by rec replicate  <dig> that were not called on the merged replicates. considering the total number of rec peaks captured by cchip-seq, we concluded that our data correlated well with data previously generated on few million cells. this is supported by comparing the signal intensity of both datasets in a 4 kb window centered at h3k4me <dig> enriched regions for rec chip-seq . we also compared enrichment in both datasets on rfecs-predicted enhancers in h <dig> cells  <cit> . while both data showed enrichment at these sites, we observed higher signal in cchip-seq compared to data chip-seq both at and around the peaks . finally, we sought to measure how many rfecs-predicted enhancers  <cit>  were captured by cchip-seq as compared to rec data. we observed that cchip-seq h3k4me <dig> peaks overlapped 61 %  of rfecs enhancers, while rec data captured 45 %  of rfecs enhancers. furthermore, cchip-seq captured all the rfecs enhancers captured by chip-seq. altogether, we have shown that cchip-seq method successfully scaled our previous chip-seq protocol  <cit>  by two orders of magnitude for h3k4me <dig> in h <dig> hesc line.

finally we tested cchip-seq for the polycomb repressive complexes-associated modification h3k27me <dig> in the k <dig> cell line. we generated h3k27me <dig> data on  <dig>  cells using cchip-seq and compared our data to both broad and sydh encode datasets . pearson’s correlation coefficients calculated across the three datasets indicated  that our replicates were highly reproducible . while the correlation with the broad dataset was good , our data correlated less well with sydh dataset . the pearson’s correlation coefficient between the two encode datasets was  <dig>  . we used chromablocks, an algorithm previously developed to determine broad domains of histone modifications such as h3k27me <dig>  <cit> , and called domains on merged replicated. when we merged all the domains called in cchip-seq and encode data , we identified  <dig> broad h3k27me <dig> enriched regions common to all three datasets, accounting for 72 % of all enriched regions in cchip-seq data. similarly, 88 % of broad h3k27me <dig> enriched regions and 59 % of sydh regions were shared with both the other two datasets. we next looked at the global distribution of the signal in a 10 kb window around those protein-coding tss that we found enriched for h3k27me <dig> in all the three datasets . although the cchip-seq and broad data showed a better global correlation , the cchip-seq and sydh data showed a greater degree of enrichment around tsss. overall, these results indicate that cchip-seq successfully generated h3k27me3chip-seq data using  <dig>  cells.fig.  <dig> cchip-seq for h3k27me <dig> on  <dig>  cells in k <dig> cells. a ucsc genome browser snapshot showing h3k27me <dig> signal  for cchip-seq and encode data at the sox <dig> locus . r1: replicate 1; r2: replicate  <dig>  b pearson’s correlation values heatmap for replicates of cchip-seq on  <dig>  cells and encode data. c venn diagram shows the number of unique and common regions enriched for h3k27me <dig> across cchip-seq, broad and sydh datasets. d heatmap representation of the signal intensity  across cchip-seq and encode data in a 10 kb window centered at protein-coding transcription start sites   overlapping chromablocks domains found in any of the three datasets 



discussion
in the last few years, there has been an upsurge in the use of chip-seq to map histone modifications in various cells. if we are to continue at this rate and to explore new cell types, we will need to profile rare cell populations whose abundance is limited. to aid in that endeavor we developed a robust, yet facile method for performing chip-seq on  <dig>  cells, which includes sonication of limited cell amounts and does not require any advanced amplification scheme. we applied this to three of the most informative histone modifications as a measure of applicability to a broad set of modifications. data generated with cchip-seq were highly comparable to encode and rec data. in comparison with other methods of scale  cchip-seq bypasses the challenges of optimizing chip-seq when scaling the number of cells by utilizing a recombinant histone carrier with a single modification corresponding to the mark to be assayed in chip-seq without the need to alter any of the upstream or downstream steps of the chip-seq procedure. given that our strategy is based on matching the recombinant histone carrier with the histone modification to be assayed, we anticipate few hurdles in applying cchip-seq to other types of histone modifications, such as acetylation, to further expand the number of chromatin modifications that can be surveyed using cchip-seq. furthermore, a similar approach was adopted for chip-seq targeting transcription factors  <cit> , confirming the importance of a chromatin-like carrier. the nucleic acid-free recombinant carrier reported here for cchip-seq provides advantages over other methods in that there is no need for removal of the carrier  <cit> , either in vitro or in silico. therefore, this approach can be easily and readily adopted into any chip-seq protocol without requiring further modification or optimization.

chromatin modifications are key for distinguishing regulatory elements  <cit> . the use of histone modifications to identify previously unknown regulatory elements, such as promoters and enhancers, has also aided our understanding of disease associated genetic variant in the genome  <cit> . combinations of modifications are also informative about active versus poised states of these elements . the recent advances in various genomic applications, such as atac-seq for open chromatin accessibility  <cit> , provide the unprecedented opportunity for profiling epigenomes moving away from cell lines and towards small cell populations in complex tissues. in line with this trend cchip-seq offers a robust approach to access various histone modification landscapes in limited cell populations.

CONCLUSIONS
in summary, cchip-seq proved to generate highly reproducible, quality chip-seq data for multiple histone modifications, and should be applicable to a broad array of histone modifications. coupling cchip-seq with more complex library amplification schemes may prove useful for lower cell amounts, but would likely require substantial optimization of the amplification. in conclusion, the simplicity of cchip-seq should make this method easily and widely adopted when applying to  <dig>  cells.

