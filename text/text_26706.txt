BACKGROUND
the geometrical shape of a molecule has been widely acknowledged as a key factor for biological activity and thus is regarded as a very important pattern for which to search in various applications, such as computer aided molecular design, rational drug design, molecular docking and function prediction. for example, a newly discovered protein is predicted to exert the same function as the most similar proteins in a database with known proteins. this similarity among two proteins can be defined in many different ways, such as their sequences aligning well, or structures matching well, or geometrical shape matching well, or both having common surface clefts or bindings sites, or similar chemical features  <cit> . to exploit the geometrical shape similarity between molecules, a useful tool is molecular shape comparison that compares the shapes of two or more molecules and identifies common spatial features  <cit> . the underlying assumption is that molecules similar to the active query molecule are likely to share the similarly spatial properties. when using molecular shape comparison, the molecules with shape similarity can be found without any specification of chemical structures.

although many researchers have proposed various methods for molecular shape comparison  <cit> , most of them treat molecules as rigid shapes and only few attentions are paid on the deformed shapes of flexible molecules. nevertheless, many molecules of interest are flexible and often undergo significant shape deformation as part of their function. when flexible molecules in different conformations are compared to each other as rigid bodies, strong shape similarities may be missed. methods of molecular shape comparison can be operated with either global or local matching methods. most existing global rigid matching methods  <cit>  are only effective for comparing 3d rigid objects, but they cannot handle the deformed shapes of flexible objects well. alternatively, if one performs local alignment and considers multiple solutions from local structure alignments  <cit> , many conformational changes can be effectively detected. however, many times, the local matching methods do not provide a good description of the overall shape.

to address this issue, our recent studies have presented several global matching methods for flexible shapes based on a new shape intrinsic measure, called inner distance shape signature   <cit> . compared with the traditional structural alignment methods, our methods only considers the geometrical shape of a molecule without requiring any prior structural alignment and any specification of chemical structure. in contrast to local matching methods, our methods does not require any detection for prior knowledge of the flexible regions. in our new shape signature, the inner distance is defined as the length of the shortest path between landmark points within the molecular shape. we found that the inner distance reflects well the molecular structure and deformation without explicit decomposition. the idss is stored as a histogram which is a probability distribution of inner distances between all sample point pairs on the molecular surface. the idss is insensitive to shape deformation of flexible molecules and more effective at capturing molecular structures than traditional molecular shape comparison methods. in particular, the point is that our approach reduces the 3d shape comparison problem of flexible molecules to the comparison of idss histograms, where the signatures are deformation-invariant, making it robust and efficient. we also presented many examples, both of detailed pairwise comparisons and of database, using the flexible database of motions.

in this paper, we develop a new web-based retrieval and navigation tool, named 3dmolnavi, for flexible molecular shape comparison. this tool aims to fast search the database of flexible molecules by combining the idss histogram, and it also supports the intuitive navigation for the searched results in 2d and 3d spaces by combing dimensionality reduction techniques.

related work
the methods of molecular shape comparison can be roughly divided into two categories  <cit> : superposition methods and descriptor methods. the former relies on finding an optimal superposition/alignment of two or more molecules compared, and the later  is independent of molecular orientation and position.

superposition methods
the superposition methods usually compare molecular shapes in a particular coordinate system by a priori superposition/alignment, which is non-trivial to achieve robustly. the representative superposition methods, for example, are based on protein structure comparison. there have been quite a few papers in the area of flexible protein structure comparison and some papers using atom-atom distances for structure comparison. a widely used strategy is based on the root-mean-square deviation  measure of the average distance between the atoms  of superimposed proteins. for instance, damm and carlson  <cit>  developed a structural comparison method for flexible proteins using a gaussian-weighted rmsd fit, which calculates the minimal weighted deviation between the two coordinate sets. in order to overcome the large displacement of flexible proteins, we recently presented a new structural comparison method for flexible proteins between their atomic coordinates using least median of squares  <cit> . theobald et al.  <cit>  proposed and applied the principle of maximum likelihood to macromolecular structure comparison by assuming a gaussian distribution of the whole structures in the analysis. in addition, several methods have been developed for flexible protein structure comparison, which automatically identifies hinges and internal rearrangements in two protein structures  <cit> . the reader may consult refs.  <cit>  for a review of some available methods for flexible protein structure comparison using atom-atom distances.

however, most of flexible protein structure comparison methods are based on structural alignment algorithms. structural alignment aims to compare a pair of structures, where the alignment between equivalent residues is not given prior. therefore, an optimal sequence alignment needs to be identified, which has been shown to be np-complete  <cit> . the tool developed in the paper is simpler than the traditional structural alignment methods, it does not require any prior structural alignment and has no any specification of chemical structure.

descriptor methods
the descriptor methods are independent of molecular orientation and position by using descriptor to represent the shape of molecule. the descriptor methods compute the similarity score by comparing the corresponding descriptors between two molecular shapes without any superposition. a shape descriptor, or named signature, is a compact representation for some essence of the shape.

an early molecular shape description is developed by bemis et al.  <cit>  by considering each molecule as a collection of its 3-atom submolecules. nilakantan et al.  <cit>  also introduced a method for the rapid quantitative shape matching between two molecules or a molecule and a template, using atom triplets as descriptors. several recent works have been developed for molecular shape comparison in various definition of shape descriptors, including shape distribution descriptor, spherical harmonic signature, 3d zernike descriptor, lightfield shape descriptor, moment invariant descriptor, etc  <cit> . these descriptors are rigid-body-transformation invariant, and they are effective for matching rigid objects. nevertheless, none of these methods is deformation invariant and they can not support flexible molecular shape comparison.

the shape descriptor is often used as an index in a database of shapes and it enables fast queries and retrieval. the descriptor methods are simpler and much faster than the superposition methods in searching large molecular databases. the shape descriptor is often represented by a histogram or vector. the idss histogram  <cit>  also belongs to descriptor methods. a review of many available methods for molecular shape comparison is beyond the scope of this paper. the reader may consult ref.  <cit>  for detailed expositions.

by combining shape histograms, some related studies have been developed towards the retrieval and navigation tools that enhance user’s interaction and comprehension for molecular shape comparison. for instance, sael et al.  <cit>  developed a web-based 3d-surfer software  for protein surface retrieval based on histogram of 3d zernike moments. 3d-surfer treats molecules as rigid shapes for searching, however, can not handle the flexible molecules. in addition, 3d-surfer does not provide a navigation method for assisting the retrieval visualization and mining. another similar tool was presented by  <cit>  using the lightfield shape descriptors , which has the similar limitation to  <cit> . recently, pu et al.  <cit>  implemented a software for retrieving 3d mechanical models and navigating the retrieved results in 2d and 3d spaces, but it is only for 3d mechanical models not for molecular shapes. in summary, there still is a limited effort in retrieval and navigation for flexible molecular shape comparison, which would improve data retrieval by helping users locate the desirable molecule in a convenient way.

in contrast to the previous work, we introduce a new web-based retrieval and navigation tool that can have better cognitive performance with concern to flexible molecular shapes by combining our previous methods  <cit> . we use this retrieval and navigation tool to enhance user’s interaction, better retrieval and visual data mining performance.

implementation
a molecule can be defined by a set of spherical atoms whose exposed surface represents a molecular surface that defines the boundary of the molecular volume. here we consider the input molecule as a volumetric representation that is popularly used in many biological research fields. the volumetric model is built through first computing the connolly surface of the molecule and then voxelizing it into a uniform 3d lattice.

our retrieval system is based on the idss histogram for describing 3d shapes of flexible molecules, where idss is used as an index in a database of molecules and enables fast queries and retrieval. the original program  <cit>  is available from https://engineering.purdue.edu/precise/idss. one new version  <cit>  for fast idss computation with advanced analysis and applications is at https://engineering.purdue.edu/precise/vmid. the idssalgorithm is summarized as follows. 

· first, some point pairs are uniformly sampled on the molecular boundary surface using lloyd’s algorithm.

· then, inner distances of all sample point pairs are calculated by applying a shortest path algorithm.

· finally, idss is built as the histogram/vector of values of inner distances using  <dig> bins.

idss, being an intrinsic property, remains invariance under geometrical shape deformation of flexible molecules. the details of idss algorithm and implementation can be found at  <cit> . the similarity score between two histograms in our algorithm is calculated using the well-known minkowski l <dig> norm of the probability density functions   <cit> . figure  <dig> illustrates the flowchart of flexible molecular shape comparison and similarity measure based on the computed idss histograms, where two different molecules  have a low similarity score equal to  <dig> . figure  <dig> gives an example of the similarity score between two conformations  of the same protein based on their idss histograms, where two conformations have a high similarity score equal to  <dig> .

then we implement the web-based retrieval and navigation system by combing the above idss histogram for retrieval and multidimensional scaling   <cit>  for dimensionality reduction. alternatively, some other dimensionality reduction techniques can also be used instead of mds. here, the mds technique embeds the idss histogram/vector of each molecular shape into 2d and 3d spaces for the visualized navigation. the mds algorithm and the visualized navigation are implemented by matlab and flex, respectively. in order to achieve fast interaction and visualization, we alternatively display the 2d image of each 3d molecular shape. in order to speed up the visualization during navigation, we set the “visibility” property to avoid loading too much images at one time. any images within a certain controlled scope will be loaded and displayed, and others too far away from the view point would not be displayed. in addition, the molecules belonging to different classes are highlighted in different colors for having a better cognitive performance.

RESULTS
3dmolnavi is currently built on two databases. one database is from the cath , which contains thousands of protein chains. the users can either search by pdb id and chain name or upload their own protein chain structures. another database is from a benchmark of flexible molecules with conformations. this benchmark is the database of macromolecular movements , which contains a diverse set of molecules that display conformational changes in proteins and other macromolecules , also including the intermediate morphs. the original benchmark has the total  <dig>  pdb files that are classified into  <dig> groups. we typically choose around  <dig> groups with large conformational changes from molmovdb for 3dmolnavi. the user selects a molecule from molmovdb and 3dmolnavi computes the similarity measure for all molecules in the database, where the button “link to molmovdb” links to the website in the molmovdb database to see how deformation of the query molecule works.

to compare the effectiveness of our method, we compare idss with some known 3d shape retrieval methods: d <dig>  geodesic distance , shape distribution , spherical harmonic descriptor , and solid angle histogram  in terms of the performance in retrieving similar shapes. 

· shape distribution   <cit>  represents the shape descriptor as a probability distribution sampled from a shape function measuring the geometric properties of a 3d model. here, we use the d <dig> shape measure for the triangle surface of a molecule.

· spherical harmonic descriptor   <cit>  is a rotation invariant shape descriptor based on spherical harmonics.

· solid angle histogram   <cit>  measures the concavity and the convexity of a molecular surface. histograms are computed based on a complete partitioning of the 3d space into disjoint cells which correspond to the bins of the histograms.

we use standard evaluation procedures from information retrieval, namely precision-recall curves, for evaluating the various shape retrieval methods. precision-recall curves describe the relationship between precision and recall for an information retrieval method. a perfect retrieval retrieves all relevant models consistently at each recall level, producing a horizontal line at a precision =  <dig> .

discussion
3dmolnavi can be applied to several future applications. one is to search molecular databases for computer-aided drug design, which aims to identify compounds that are complementary to the site in molecular shape. some softwares that treat molecules as rigid shapes have been proposed for this purpose. for instance, zauhar et al.  <cit>  developed a tool for searching the nci database and the tripos fragment database. ballester et al.  <cit>  implemented a software for retrieving several compound databases, including the vendor database and an independent benchmark from drugbank. however the molecular databases may include some information about the flexibility of the molecule with its possible conformations, the traditional methods can not capture the shape similarity of flexible molecules well. the presented 3dmolnavi tool may directly replace the existing rigid methods for search the molecular databases.

another application is protein structure retrieval. there have been many protein structural comparison methods presented by computing the similarity scores, but most of them are based on protein structure alignment, such as dali and ce. in contrast, 3dmolnavi presented in this paper can be applied to a search for similar protein structures. the main advantage is that the shape-based protein searching method does not produce any alignment between two proteins.

the third application may be in cryo-electron microscopy , where sheer shape comparison is important for example in discovery of high resolution structural homologues from cryo-em maps. 3dmolnavi can overcome the different resolutions by considering both the geometrical shape and flexibility. for more explanation of applications, the reader can refer to  <cit> .

the main advantage of our method is to deal with flexible molecular shape comparison with large deformations. however, our method has no distinct advantage for some small molecules with little deformation, in contrast to previous works  <cit> . it is expected that the presented idss method can be considered as an alternative and complementary tool for the existing methods for protein structure comparison and rigid molecular shape comparison.

CONCLUSIONS
the new software, named 3dmolnavi, has been developed for retrieval and navigation during flexible molecular shape comparison. 3dmolnavi is based on the idss histogram for fast retrieving molecules that are similar to a query molecule, and uses dimensionality reduction to navigate the retrieved results in 2d and 3d spaces. we tested 3dmolnavi in the database of cath and molmovdb. compared to other shape descriptors, our tool achieves better performance and retrieval results for different classes of flexible molecules. the advantages of 3dmolnavi, over other existing softwares, are to integrate retrieval for flexible molecular shape comparison and enhance navigation for user’s interaction.

availability and requirements
software name: 3dmolnavi

software homepage:https://engineering.purdue.edu/precise/3dmolnavi/index.html

operating system: windows system is tested

web browser: mozilla firefox  <dig>  chrome  <dig> and internet explorer  <dig> are tested

programming language: matlab and flex 

other requirements: no

license: no

abbreviations
idss, inner distance shape signature; mds, multidimensional scaling; molmovdb, database of macromolecular movements; auc, area under curve; rmsd, root-mean-square deviation; sd, shape distribution; shd, spherical harmonic descriptor; sah, solid angle histogram.

competing interests
the authors declare that they have no competing interests.

author’s contributions
yl generated the original idea, executed the research and wrote the manuscript. mw implemented the idea. jp and kr supported and participated in the research. all authors read and approved the final manuscript.

