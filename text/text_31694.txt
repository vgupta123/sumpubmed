BACKGROUND
de novo prediction of protein three-dimensional  structure from the primary sequence remains a fundamental and extraordinarily challenging problem  <cit> . contact maps, or similar distance restraints have been proposed as intermediate steps between the primary sequence and the 3d structure , for various reasons: unlike 3d coordinates, they are invariant to rotations and translations, hence less challenging to predict by machine learning systems  <cit> ; quick, effective algorithms exist to derive 3d structures from them, for instance stochastic optimisation methods  <cit> , distance geometry  <cit> , or algorithms derived from the nmr literature and elsewhere  <cit> . numerous methods have been developed for protein residue contact map prediction  <cit>  and coarse  contact map prediction  <cit> , and some improvements are slowly occurring .

still, accurate prediction of residue contact maps is far from being achieved and limitations of existing prediction methods have again emerged at casp <dig> and from automatic evaluation of structure prediction servers such as eva  <cit> . there are various reasons for this: the number of positive and negative examples  is strongly unbalanced; the number of examples grows with the squared length of the protein making this a tough computational challenge; capturing long ranged interactions in the primary sequence is difficult, hence grasping an adequate global picture of the map is a formidable problem. for this reason simpler, alternative representations of protein topologies are particularly appealing, provided that they are informative and, especially, predictable .

in this paper we focus on one such representation: the principal eigenvector  of residue contact maps. the pe is a sequence of the same length as a protein's primary sequence. a vast machinery of tools for sequence processing is available . moreover, recently  <cit>  a branch-and-bound algorithm was described that is capable of reconstructing the contact map from the exact pe, at least for single domain proteins of up to  <dig> amino acids. this means that the pe contains most of the information encoded in the contact map. predicting the pe is thus interesting: it leads to a drastic reduction in the size of the problem compared to two-dimensional contact maps, i.e. considerable data compression, and also a reduction in the scale length of interactions that need to be learned; contact maps may be derived from the pe by modifying the reconstruction algorithm in  <cit>  to deal with noise in the pe; alternatively the pe may be adopted as an additional input feature to systems for the direct prediction of contact maps ; information contained in the pe may be used, in combination with other constraints, to guide the search for optimal 3d configurations; predicted pe may prove useful to identify domains, as in  <cit> , and discussed in  <cit> .

in this paper, we model the problem of inferring the pe as a classification task with multiple classes. we use machine learning methods to map amino acids into their corresponding component of the principal eigenvector. similarly to  <cit> , we adopt bidirectional recurrent neural networks   <cit>  with shortcut connections, accurate coding of input profiles obtained from multiple sequence alignments, secondary structure predictions, second stage filtering by recurrent neural networks, and finally large-scale ensembles of predictors. our models classify correctly up to  <dig> % residues, 16% above a base-line statistical predictor always assigning a residue to the most numerous pe class.

to prove that these levels can lead to improved contact maps, we incorporate the predicted pe into a state-of-the-art system for contact map prediction  <cit> . our tests show that the pe yields sizeable gains, and that these gains are especially significant for long-ranged contacts, which are known to be both harder to predict and critical for accurate 3d reconstruction.

RESULTS
principal eigenvector prediction
we evaluate model performances using different prediction indices. if the task is the prediction of the eigenvector components λ¯x¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuah7oabgaqeaiqbdiha4zaaraaaaa@3009@i  in m classes, we measure: qm, or overall percentage of correctly predicted amino acids; the set q <dig>  ..., qm- <dig>  where each qj is the percentage of correctly classified amino acids whose eigenvector component belongs to interval ij+1; an analogous of the sov measure  <cit>  adapted for the case of m classes. the intent in this case is to measure the quality of prediction over contiguous segments of amino acids belonging to the same class. finally, we compare our methodology with a base-line predictor that assigns each amino acid to its most frequently occurring class .

we train different ensembles of brnns. differences depend on whether or not we use output filtering by second stage networks  and whether or not the input encoding includes predicted secondary structure from porter  <cit>  and the hydrophobicity interaction scale in  <cit>  . tables  <dig>   <dig> and  <dig> show respectively estimated performance indices for classification in two, three and four classes. the first three columns indicate whether secondary structure, hydrophobicity profile and second stage filtering are employed in the network ensemble .

in all multi-class prediction cases, the best network ensemble shows an increment of global predictive accuracy of ≈ 16% with respect to the base-line predictor. the sov and the overall accuracy increase using filters and augmenting the number of input features with hydrophobicity scales  and secondary structure . interestingly, predicted secondary structure is a valuable feature: in all cases, using true secondary structures results in only moderate improvements with respect to the performance obtained with secondary structure predicted by porter  <cit>  .

in the 2-class problem, q <dig> exceeds 72% with the two classes almost equally well predicted. in this case, the network with full features finds a nearly optimal  decision threshold. this is not surprising because the threshold on the eigenvector component was chosen so as to divide the training set values in two equally distributed halves. the 3- and 4-class prediction problems are more difficult to solve, but the observed improvements over the baseline predictor are roughly the same as in the 2-class case. strong improvements over the base-line predictor are observed especially for the intermediate classes . interestingly, these classes are more difficult to predict even if all classes are nearly equally distributed. this is possibly because boundary classes  correspond to well-defined situations, i.e. isolated residues or residues with high connectivity, for which clear signal exists in the data. a typical example of 4-class pe prediction is shown in figure  <dig> 

contact map prediction from predicted pe
as a final step, we test the possibility of directly using the information encoded in the pe to improve state-of-the-art residue contact map predictors. we choose the model based on dag-rnns described in  <cit>  and  <cit> . this model was among the most successful contact map predictors at the casp <dig> competition  <cit> . the architecture we adopt is identical to the one described in  <cit>  and used at casp <dig>  except for the presence of shortcut connections and for the ensembling technique . these differences allow a substantially  faster training, and yield marginally improved results compared to  <cit>  when the same input features and same training/test sets are adopted .

to ensure fairness, here we retrain dag-rnns from scratch using the same training and testing sets used to predict the pe. the sets are first processed to remove sequences longer than  <dig> amino acids , leaving  <dig> proteins in the training set and  <dig> proteins in the test set. two amino acids are defined as being in contact if the distance between their cα is below a contact threshold. we consider two different contact thresholds:  <dig> and  <dig> Å. for comparison purposes, we encode each pair  of amino acids in the input by four different features: a  <dig> ×  <dig> matrix representing the probability distribution of pairs of amino acids observed in the two corresponding columns of the alignment ; ma plus the actual discretised 4-class pe component for both residue i and j ; ma plus the actual secondary structure  and binary thresholded  relative solvent accessibility ; and finally, the previous feature plus the actual 4-class pe components . we train  <dig> predictors, with the same architecture, one for each input feature and contact threshold.

differently from the training phase, testing takes place by encoding each pair  on input with the predicted 4-class pe component as given by the filtered ensemble of brnns using profiles, predicted secondary structure and hydrophobicity profiles . secondary structure and solvent accessibility information input into the dag-rnn is also predicted during testing. these predictions are obtained from an architecture identical to the one adopted to predict the pe, and trained on the same training set. hence the protocol we adopt leads to fully realistic results, since no protein in the the test set shows significant sequence similarity to any of the structures used to train the contact map predictor and all the underlying feature predictors.

tables  <dig>   <dig>   <dig> and  <dig> show performance indices for all the  <dig> networks. indices considered are: accuracy p = tp/, with tp = true positives and fp = false positives; coverage r = tp/, with fn = false negatives; f <dig>  defined as the harmonic mean of accuracy and coverage ); pnc, the percentage of correctly predicted non-contacts. performances are computed for three different sets of contacts, based on the separation of two residues in the linear sequence: |i - j| ≥ { <dig> , 24}. in tables  <dig> and  <dig> we report p, r and f <dig> when the threshold between contacts and non-contacts is set to  <dig> . in tables  <dig> and  <dig>  for consistency with casp assessment rules  <cit> , we report p and r when only the top n/ <dig> and n/ <dig> contacts are considered, n being the length of the protein. in this case contacts are ranked, and top contacts are selected, based on their expected probability as estimated by the predictor.

as evident from the tables, the introduction of pe predictions increases the f <dig> measure in all cases. this is true for both  <dig> and  <dig> Å maps, and for all separation thresholds. an improvent is observed both in the ma_pe vs. ma case and in the ma_ss_acc_pe vs. ma_ss_acc case. in all cases the introduction of the predicted pe yields larger performance gains than secondary structure and solvent accessibility combined. interestingly, the gains become more significant for longer range contacts. for instance for |i - j| ≥  <dig> f <dig> grows from  <dig> % to  <dig> % at 8Å and from  <dig> % to  <dig> % at 12Å . pe-based networks are more confident away from the main diagonal , with a better balance between false positives and false negatives.

when we take into account only small numbers  of contacts considered most likely by the predictor, the gains become less marked, but remain significant, especially for longer range contacts: for |i - j| ≥  <dig> at 8Å, when considering the top n/ <dig> contacts, p grows from  <dig> % to  <dig> % in the ma vs. ma_pe case and from  <dig> % to  <dig> % in the in the ma_ss_acc vs. ma_ss_acc_pe case. similar gains  are observed for the 12Å predictors.

residue contact map predictors at casp <dig>  <cit>  were evaluated on a small set  of novel fold targets. the performances of the best system  on the top n/ <dig> contacts were 24% and 22%  and  <dig> % and 5%  for minimum residue separations of  <dig> and  <dig>  respectively. although the statistical relevance of a set of only  <dig> targets is limited, our predictor's accuracy on it compares favourably with the best casp <dig> predictors, achieving  <dig> % accuracy and  <dig> % coverage for separation of at least  <dig> and  <dig> % accuracy and  <dig> % coverage for separation of at least  <dig> 

CONCLUSIONS
we developed sophisticated predictors of a novel sequential feature of protein structure: the principal eigenvector of residue contact maps. our predictors classify correctly up to  <dig> % of residues, and show large gains over simple base-line statistical predictors.

we showed that predicted principal eigenvectors can be effectively used as an additional input feature to a state-of-the-art method for contact map prediction, yielding sizeable gains especially for long-range contacts which are particularly critical for accurate protein 3d reconstruction.

these results suggest a number of futher points to investigate:

• the algorithm in  <cit>  may be directly tested in noisy contexts, and extended to increase its robustness. this may give rise to an alternative pipeline for the prediction of contact maps.

• the pe could be used directly to improve protein domain predictors  <cit> .

• pe-based maps may be adopted to guide the ab initio reconstruction of quick, draft cα traces, for instance using a stochastic search algorithm similar to  <cit> .

• residue coordination number correlates well with the pe – as such, predicted coordination number  <cit>  may yield similar gains to contact map prediction, while providing a more intuitive structural representation of a protein.

ultimately, the third point is the most crucial test of the validity of our approach. even if the 3d models produced were fairly coarse, they might be provide a valuable source of information, for instance to identify protein functions more accurately than it would be possible by sequence alone  <cit> . although training a contact map prediction system is computationally expensive, once training is over, generating predictions is fast. even on a small cluster of machines, this may allow multi-genomic scale structural prediction efforts in manageable times.

