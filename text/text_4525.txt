BACKGROUND
decoding regulatory interactions between transcription factors  and their target genes is critical in understanding the complex gene expression patterns in response to extra- or intra-cellular signals. many computational methods have been developed to identify the cis-regulatory elements recognized by tfs  <cit> . these dna motifs have also been determined by experimental measurements  <cit> . the accumulation of known tf motifs facilitates addressing a more challenging question, understanding the combinatorial regulation of tfs and deciphering the rules of how the tfs cooperate with each other, which is particularly important for studying transcriptional regulation in higher organisms  <cit> .

the previous efforts have been mainly focused on inferring which tfs may function together  <cit> . however, these studies cannot reveal the regulatory mechanisms of combinatorial regulation, namely whether a tf motif has a positional preference relative to the transcription start site  or whether the order of the two motifs matters for their cooperation. the importance of such regulatory "grammar" has been observed in numerous studies. for example, the binding site of the repressor giant relative to those of the gal <dig> activators determined transcription of a reporter gene in the embryo of drosophila melanogaster  <cit> .

searching for the sequence constraints between tf motifs is a difficult task. as we will see below, simple enumeration of all possible sequence features and conducting statistical test to evaluate the significance for each of them is computationally expensive for even a modest number of candidate motifs. alternative methods are thus needed to tackle this problem. recently, elemento et al. developed a motif finding algorithm called fire that can predict various sequence constraints of motifs and whether pairs of motifs interact with each other  <cit> . fire is based on the mutual information between the sequence features of interest and gene expression. however, because elemento et al. emphasized on removing false positives, the relative small number of predicted motifs implies that some true motifs might be missed. for example, only  <dig> dna motifs and  <dig> rna motifs were identified from  <dig> clusters generated from  <dig> microarray experiments in yeast  <cit> . in addition, fire only considers consensus sequences with mismatches, which is a relatively simple representation of motifs compared with position weight matrix. more importantly, fire cannot consider the joint effects of multiple rules. the rules were tested individually by fire and the computational cost would be too high to enumerate all possible combinations of rules . therefore, for example, synergy between rules cannot be detected by fire.

in the present study, we adopted a bayesian network approach to identify regulatory grammars because bayesian network explicitly models the nonlinear relationship between sequence rules. our goal is to find enriched constraints for dna motifs such as spacing between tf binding sites and positional bias of a tf sites relative to tss in a group of sequences, often promoter sequences of a set of co-regulated genes. this can be considered as a generalization of motif finding algorithms. it is important to emphasize that we do not aim to predict gene expression based on sequences, which is the goal of the studies of, such as, beer and tavazoie  <cit>  and yuan et al.  <cit> .

we implemented a gibbs sampling procedure to search for optimal bayesian network structure. we call our method gbnet, gibbs sampler enhanced bayesian network, and the software is available at . to demonstrate the strength of our searching strategy, we compared the performance of gbnet with bbnet, in which a greedy searching algorithm is implemented to search for the optimal bayesian network. we have applied both methods to simulated data as well as yeast and human data. the results showed that gibbs sampling has much better performance than greedy search in searching for sequence constraints between cooperative tfs. we also demonstrated that numerous sequence features identified by gbnet for human transcription factor yy <dig> were supported by literature and experimental evidence.

RESULTS
gbnet: a gibbs-sampler enhanced bayesian network
uncovering transcriptional grammar in a group of genes exhibiting similar expression patterns may reveal the mechanisms of combinatorial regulation of transcription factors. we adopted a bayesian network to model the non-linear regulatory relationship between sequence features and gene expression . the structure of the bayesian network represents the grammar  of cis-regulation. our aim is to maximize the posterior probability of the network structure given the data, i.e. bayesian score of eq. .

because the number of sequence features grows exponentially with the number of candidate motifs, searching a set of optimal sequence features is not trivial. we employed a gibbs sampler enhanced global search strategy to tackle this problem . six sequence features as defined in  <cit>  were considered: presence of a motif, distance from transcription start site , spacing between two motifs, orientation of a motif, presence of a second copy of a motif and order between two motifs. gbnet can therefore be considered as a generalization of sequence motif finding: instead of searching for enriched consensus motifs, enriched combinations of motifs satisfying a specific constraint is being searched.

validation of gbnet on simulated data
we first validated the performance of gbnet using simulated data. to keep the sequences as natural as possible, we took the sequences from the  <dig> promoters in the fourth yeast cluster of  <cit> . we then implanted a spacing constraint between two yeast motifs, distance between pac and rrpe motifs less than  <dig> bp, in a portion of genes ranging from 40% to 80% with an interval of 10%. the original instances of pac and rrpe were removed. these simulated sequences and the weight matrices of the  <dig> yeast motifs taken from  <cit>  were input to gbnet for identification of enriched sequence constraints between these motifs. we used the same  <dig> background sequences as in  <cit> .

gbnet successfully learned the implemented spacing rule in all the five simulated datasets but bbnet learned none of them . for example, when 40% of the genes contained the spacing rule, the presence of single motif pac and rrpe were ranked 2nd and 5th, respectively, among all motifs under consideration. bbnet only learned the presence of pac while gbnet still found the spacing constraint between the pac and rrpe motifs. in all the five datasets, the rules found by gbnet gave better bayesian scores than those found by bbnet , which suggests better fitting to the data. it is important to point out that the bayesian networks learned by gbnet were not necessarily more complex than those learned by bbnet. on the datasets that 60% and 70% of the genes contained the spacing rule, gbnet even gave bayesian networks with less number of rules than bbnet . our analysis showed that gbnet outperforms bbnet in search of the best bayesian network structure even for such a simple simulated data with only one sequence constraint implemented.

 <dig>  presence of pac
 <dig>  distance between rrpe and pac:40
 <dig>  distance to tss of m599:160
 <dig>  distance to tss of m604:180
 <dig>  distance between rrpe and pac:40
 <dig>  distance to tss of m604:180
 <dig>  presence of rrpe
 <dig>  distance to tss of m604:140
 <dig>  presence of rrpe
 <dig>  presence of rrpe
 <dig>  distance between m <dig> and m599:340
 the mxxx are alignace motif matrices taken from  <cit> .

athe percentage of sequences satisfying the spacing rule between pac and rrpe motifs ranges from  <dig>  to  <dig> . bthe single motif ranks for pac and rrpe in each dataset are also shown: the first is pac and the second is rrpe.

validation of gbnet on the pac and rrpe example
we then validated the performance of gbnet using a real dataset. we took the fourth yeast cluster of  <cit>  in which beer and tavazoie found two regulatory rules for pac and rrpe:  <dig>  pac  is within  <dig> bp of atg;  <dig>  rrpe  is within  <dig> bp of atg. when both rules are satisfied, the genes containing the two motifs showed highly correlated expression patterns across a variety of conditions. when neither of these rules was satisfied, the gene expression patterns were indistinguishable from the background  <cit> .

in  <cit> , the above two rules were learned from the bootstrap samples but not directly from the original sequences in the fourth yeast cluster. we generated numerous sets of  <dig> bootstrap samples. the two rules could be simultaneously identified in only  <dig> to  <dig> out of  <dig> bootstrap samples by bbnet and they were not necessarily the most abundant rules learned by bbnet from these samples. different from beer and tavazoie's goal to predict gene expression from sequence, we aim to identify sequence constraints between cooperative tf binding motifs from a group of genes with coherent expression patterns. therefore, bootstrap is not an option for our purpose. when we applied bbnet and gbnet to the original sequences in the fourth yeast cluster, bbnet correctly found the first rule of pac but only the presence of rrpe instead of the distance constraint ; in contrast, gbnet successfully found both rules.

to illustrate why the gbnet could but bbnet could not find the two rules, we examined each step of the bayesian network structure learning . when the searching reached a local optimum  with a bayesian score of - <dig> , the network contained two parent nodes : "distance to atg of pac" and "presence of rrpe". if the "distance to atg of rrpe" node was added, the bayesian score would decrease. therefore, the greedy search in bbnet stopped and did not add this rule. the searching was thus trapped in the local optimum. in contrast, a metropolis jump was tried in gbnet with an accepting probability calculated based on the difference of the bayesian scores before and after the jump : the closer the two bayesian scores, the more likely a jump got accepted. to further enhance the sampling power, simulated annealing was also employed in gbnet and multiple iterations were executed until the model was converged at a specific temperature. as a result of this searching strategy, the "distance to atg of rrpe" rule was added by gbnet even though the bayesian score became worse : - <dig>  versus - <dig> . next, the bayesian score was improved to - <dig>  by removing the "presence of rrpe" node . the two correct rules were thus found and being kept to the end of the searching. this example illustrates the advantages of the searching strategy implemented in gbnet to avoid being trapped in the local optimum compared with the greedy search algorithm in bbnet.

applying gbnet to the  <dig> yeast clusters
the above analyses suggested that gbnet can find the rules of combinatorial regulation between tfs. to have a large scale comparison between gbnet and bbnet, we then applied them to the  <dig> yeast clusters of  <dig> genes in  <cit>  . we compared gbnet and bbnet on the following aspects using the original data without bootstrap sampling.

gbnet fits better models to the data than bbnet
a bayesian score reflects how well a model fits to the data. the rules learned by gbnet gave better bayesian scores in  <dig> clusters than those learned by bbnet . the sum of bayesian scores for all  <dig> clusters is - <dig>  for bbnet and - <dig>  for gbnet. on average, gbnet achieved a better bayesian score ~ <dig> /cluster than bbnet. again, the bayesian networks learned by gbnet are not more complex than those learned by bbnet. this can be seen by the average number of rules per cluster:  <dig>  for bbnet vs.  <dig>  for gbnet.

gbnet finds more biologically interesting rules
from the  <dig> yeast clusters, bbnet and gbnet learned  <dig> and  <dig> regulatory rules in total, respectively. consistent with the observation in  <cit> , most  of the regulatory rules learned by bbnet were simply "presence of a motif", which could also be learned by any motif finding algorithm. because the searching started with "presence of a motif" and bbnet is easy to get trapped in local optima, it is not surprising that other types of sequence constraints were underrepresented. although presence of a motif is still the majority of the rules learned by gbnet, the percentage is only 73%  and the portion of other types of constraints was significantly increased . finding rules other than presence distinguishes gbnet from other motif finding algorithms. this feature is particularly important in studying combinatorial regulation in higher organisms such as human.

gbnet searches more thoroughly in the rule space
to further demonstrate that gbnet is less prone to get trapped in local optima, we examined the ranks of single motifs that appear in the rules learned by gbnet and bbnet. in search for the optimal bayesian network, all motifs under consideration were first sorted in the descending order by their individual bayesian scores, which reflect how well an individual motif can explain the data. the motifs were then added to the bayesian network in this order to expedite the convergence of searching. therefore, it is not unexpected to see that a large portion  of motifs present in the rules learned by bbnet had the highest individual ranks . as a comparison, gbnet found rules that involved motifs giving lower bayesian score if considered individually  but higher  bayesian score if considered together with satisfying specific sequence constraints .

gbnet searches much more efficiently in the rule space than enumeration
an alternative to developing models like gbnet for learning sequence constraints is enumerating all possible rules and selecting the best scored ones, using either bayesian score or mutual information like in fire. however, the possible number of combinations of rules is so large to make this straightforward approach computationally prohibited. for example, learning spacing constraints among  <dig> candidate motifs in yeast, one needs to consider  <dig> function depths  for each motif and  <dig> possible distances between two motifs . in total,  ×  <dig> ×  <dig> ×  <dig> =  <dig> , <dig> statistical tests have to be computed for learning the single spacing constraint. for a distance constraint from tss ,  <dig> ×  <dig> ×  <dig> =  <dig> tests need to be performed. therefore, when consider the combination of the above two rules , there are total  <dig> ,750* <dig> =  <dig> * <dig> possibilities, which makes enumeration infeasible. as a comparison, on average, gbnet calculated  <dig>  times of bayesian scores per cluster that considered combinations of all six types of constraints. the running time of gbnet per cluster was  <dig> to  <dig> hours on a desktop computer with a  <dig>  ghz cpu, which means enumeration would take > <dig> * <dig> to  <dig> * <dig> hours for only considering the two types of rules mentioned above per cluster. the efficiency difference between gbnet and enumeration becomes more significant when more candidate motifs are considered for learning sequence constrains. this is because gbnet scales better than linearly with the number of candidate motifs . as a comparison, the computational cost of enumeration is polynomial to the number of candidate motifs when considering one rule or exponential when considering combination of rules.

dissecting transcriptional regulatory rules of a human transcription factor yy1
combinatorial regulation is much more prevalent in higher organisms than in yeast. to demonstrate the usefulness of gbnet, we applied it to studying transcriptional regulation by a human transcription factor  called yy <dig>  which plays essential roles during development  <cit> . for the purpose of comparison, we also analyzed this human dataset using bbnet. our previous study showed that yy <dig> mainly binds to the  <dig>  kbp regions around the transcription start site  <cit> . therefore, we focus on searching for sequence constraints between yy <dig> and its cofactors in the proximal promoters.

identifying yy <dig> target genes and clustering of gene expression profiles
chip-chip analysis of yy <dig> binding has been conducted using a whole-genome promoter array in human hela cells  <cit> . we used a gibbs sampler based computational algorithm, called gibbs sampler for finding transcription factor target genes   <cit>  that integrates sequence motif and chip-chip binding information to identify a set of confident yy <dig> target genes. the intuition behind the gittar algorithm is the same as that of modem  <cit> , namely genes containing the yy <dig> motif and showing significant chip-chip ratio are likely to be yy <dig> targets. gittar identified  <dig> such genes and the average of their log <dig> ratios is  <dig>  ±  <dig> , which significantly deviates from the background . a 12-bp long motif defined by gittar  was used in the following analyses.

because yy <dig> can cooperate with various tfs, we used gene expression profiles to define these co-regulated subgroups of the yy <dig> target genes. su et al.  <cit>  performed microarray experiments in  <dig> human tissues and  <dig> yy <dig> target genes identified by gittar were probed in their arrays. we found five clusters among these yy <dig> target genes using hierarchical clustering algorithm  <cit>  . cluster h <dig> to h <dig> were selected based on a correlation cutoff of  <dig>  and a cluster size cutoff of  <dig> genes. cluster h <dig> was manually selected because its members were significantly up-regulated and tightly correlated in testis tissues  despite the average pairwise correlation over all the  <dig> tissues was only  <dig> . cluster h <dig> represents tissue-specific expression of yy <dig> targets and it is interesting to examine the underlying mechanism of transcriptional regulation.

finding enriched motifs in each cluster
to search for potential yy <dig> co-factors, we collected  <dig> motifs of human tfs from the transfac database   <cit>  and examined their enrichment in each of the five clusters against the genes outside of the cluster but included in the yy <dig> chip-chip study using fisher's exact test  <cit>  based on hypergeometric distribution . in addition, we also conducted de novo motif finding using bioprospector  <cit> . it is not surprising that the yy <dig> motif was always ranked on the top in fisher's test. numerous motifs like e2fs, creb, elk <dig> and nfy were also significantly enriched. in total, a list of  <dig> motifs was compiled  as the candidate motifs for further analysis of combinatorial rules by gbnet and bbnet.

learning combinatorial regulation between yy <dig> and its co-factors
the regulatory rules learned by gbnet and bbnet for all five clusters along with their p-values and bayesian scores are listed in table  <dig>  consistent with the observation in the simulated data and the yeast clusters, gbnet found sequence constraints between cooperative tfs in every cluster while bbnet only learned presence of motifs that can also be found by other means. the gbnet rules also achieved higher bayesian scores than the bbnet presence rules, which suggest better fitting to the data. again, the bayesian networks learned by gbnet are not more complex than those learned by bbnet. in cluster h <dig>  gbnet gave a bayesian network with one less rule than bbnet but its bayesian score is  <dig>  higher. two spacing constraints were found on h3: yy1-e2f and e2f-elk <dig>  we examined the gene expression pairwise correlation  of the target genes of the two spacing constraints. while the e2f-elk <dig> pair only marginally raises the pc, the yy1-e2f pair significantly improves the pc compared with background . this shows the yy1-e2f pair is much more specific than the e2f-elk <dig> pair in regulating transcriptional levels of their target genes. finally, combining the two spacing constraints gives the optimal pc .

presence of e2f ,  <dig> e-33
literature evidence to support the rules learned by gbnet
most of the rules learned by gbnet were supported by literature: yy <dig> and ets family proteins have been shown to form a complex that helps to maintain the normal function of human immune system  <cit> ; both yy <dig> and ets are required for the transcriptional regulation of a variety of cellular processes such as adipocyte differentiation  <cit> ; yy <dig> has been shown to physically interact with e2f family proteins for the specificity of e2f function  <cit> ; synergistic cooperation has been observed between yy <dig> and e2f <dig> for the transcriptional activity of p <dig>  through a mechanism involving a physical interaction  <cit> ; two independent groups have verified that yy <dig> and elk <dig> co-ordinate the expression of the sod gene  <cit> . in addition, gbnet also identified two new cooperative pairs: yy1-wt <dig> and e2f-elk <dig>  it is worth pointing out that gbnet specifies how the above tfs cooperative with each other and provides specific guidance for experimental validation.

independent e2f chip-chip experiments support the yy1-e2f distance constraint
a direct evidence to support the sequence constraints found by gbnet came from a recent study on the binding of e2f family members. farnham and colleagues recently conducted chip-chip experiments on e2f family members, e2f <dig>  e2f <dig> and e2f <dig>  using the same promoter array that we used for our yy <dig> study . they showed that e2f family members mainly bind to promoter regions within  <dig> kb of transcription start site  in hela cells and their bindings are interchangeable  <cit> . among the  <dig> human genes that are targets of any of the three e2f family members,  <dig> are in common with the  <dig> gittar yy <dig> targets .

to confirm the distance constraint between yy <dig> and e2f family members, we examined how many of yy <dig> and e2f sites that satisfy the distance constraint  were supported by the e2f chip-chip experiments . because the probes in the promoter array were not uniformly distributed in each promoter, a predicted e2f site by gbnet may fall into a gap between probes. in addition, the sonicated dna segments in chip-chip experiments had a length of hundreds of base pairs. therefore, if a predicted e2f site is within a short distance from a probe with significant binding ratio, it is likely the e2f proteins bind to the predicted site. among the  <dig> yy1-e2f motif pairs predicted by gbnet in the cluster h <dig> genes, we found that 79% of them were close to a probe  with significant binding ratio of more than 2-fold  . as a control,  <dig> genes which contain an yy <dig> site but do not satisfy the yy1-e2f spacing constraint were selected from the genome. among these control genes, only 20% contain a probe  with significant binding ratio of more than 2-fold. the statistical significance  was evaluated by fisher's exact test between the two groups. this suggests that most of the predicted e2f sites by gbnet were bound by e2f proteins and the majority of the yy1-e2f distance constraints identified by gbnet were thus supported by the e2f chip-chip experiments.

discussion and 
CONCLUSIONS
combinatorial regulation of transcription factors is critical in gene expression control particularly in higher organisms. for the purpose of reconstructing transcription regulatory network, understanding the molecular mechanisms and deciphering the grammar of combinatorial regulation are the natural steps after finding the binding sites of tfs  <cit> . identification of cooperative tfs and learning sequence constraints between their motifs can provide great insights into building mechanistic and quantitative models of transcriptional regulation  <cit> .

we have developed a bayesian network approach to find regulatory rules enriched in a foreground sequences, for example the promoters of a set of co-regulated genes, compared with the background sequences. this method can be applied to any genome as we showed its success in yeast and human here. we designed a powerful searching strategy in bayesian network structure learning by employing gibbs sampling and simulated annealing. compared with the exhaustive enumeration, gbnet can find the optimal rules much more efficiently. the more candidate motifs under consideration, the more save of computational cost gbnet would achieve over enumeration. given the improved searching strategy, it is not surprising that gbnet outperforms bbnet that employs greedy search for optimal network structure in all the datasets we have tested, including simulated, yeast and human data.

in the present study, we were focused on the six sequence constraints using in  <cit>  and analyzing combinatorial regulations in proximal promoters. obviously, there exist other sequence constraints, particularly those for the interactions between distal enhancers and promoters and those related to other regulatory elements such as silencers. new approaches are emerging to define all the regulatory elements, for example, using chromatin modification patterns  <cit>  or protein-dna interaction data to predict enhancers  <cit> . the accumulation of such knowledge can facilitate gbnet to learn rules that involve other regulatory elements or long-range regulatory interactions such as the looping interaction between distal enhancers and promoters. it is straightforward to search for other types of rules by gbnet without significantly increasing the computational cost.

