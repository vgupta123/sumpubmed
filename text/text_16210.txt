BACKGROUND
most common diseases have an etiology so complex that years of research have yielded scarce results towards the elucidation of their causes. technology and methodology are improving quickly but results have been arriving slowly. nonetheless, optimism is in the air, because large studies of many individuals and genetic markers seem to finally be revealing some of the genetic factors behind these common diseases  <cit> .

the difficulty of elucidating the genetic basis of complex diseases roots in the many factors that can affect the development of a disease. many factors, both genetic and environmental, each with possibly only a small effect, may be necessary for the expression of a particular disease phenotype. for example, most associations reported in the recent wave of genome-wide association studies of different common diseases exhibited small  to moderate  odds ratios  <cit> .

these small effects may only be detectable by means of genetic association analysis in very large samples, or in smaller sub-samples in which, by sample selection, this effect is enlarged: a sub-sample where the allele frequency of a particular risk gene is increased; or a sub-sample where a combination of other alleles or environmental factors act to increase the observable effect of a particular gene  <cit> .

many genes may contribute to the expression of complex diseases. it is quite reasonable to expect that the effects of some of these genes do not sum up in a simple fashion. epistasis generally refers to an interaction between the effects of genes at different loci, although the term has been used in different contexts by different disciplines  <cit> . some of these genetic effects may interact among them, such that the presence of two or more particular genes may increase the risk to a disease more than expected from their independent effects, the expectation being derived from a pre-defined model, such as additive or multiplicative. for example, the odds ratio for an epistatic effect of two genes may be larger, even much larger, than the combined effect  of each of the two single genes  <cit> . moreover, there are biological models of epistasis where genes only have epistatic effects  <cit> , such as a two-locus mutation masking a known phenotype. some of these genetic effects may prove undetectable by current single-locus methodology  <cit> . there have been some early attempts to search for epistatic effects  <cit> , but there is currently a need for methods to study this important genetic phenomenon, perhaps key for complex diseases.

a wealth of current research in molecular genetics has discovered millions of genetic markers which provide a good coverage of common genetic variation across the entire human genome  <cit> . at the same time, advances in genotyping technology have greatly increased the quantity and quality of genotypes. current genotyping platforms can generate millions of genotypes in short periods of time. these events have made possible the genetic association analysis of a trait across the entire genome.

although the arrival of genome-wide association testing is great news for the genetic dissection of complex traits, the large number of statistical tests involved raises the issue of statistical significance. for example, to maintain a type i error of  <dig> percent when testing  <dig>  markers for genetic association may require a test-statistic with a probability value of  <dig> × 10- <dig>  if a bonferroni correction is applied. nonetheless, many of these markers are correlated so this correction would be too strict, but in any case the required p-value would be very small.

this problem of multiple testing is even more extreme for the test of epistasis. for example, for  <dig>  markers, there are a total of  <dig> × 10+ <dig> two-locus combinations, which would require a bonferroni-corrected p-value of  <dig> × 10- <dig> for a genome-wide significance level of  <dig> , which again would be overly conservative due to the correlated nature of many of these tests. to achieve these significance levels it is necessary to study large samples and expect to find large epistatic effects.

replication of findings in independent samples is sought for growing confidence in statistical results. the lack of replication of association results may be due to different causes, some technical  and some biological . an approach to tackle the multiple testing issue is to divide the available sample into independent groups and to carry out the analysis in these independent groups to look for consistent results across the groups. some true genetic effects will be missed due to lack of power  and to heterogeneity, but this approach may allow the identification of moderate/large-sized epistatic effects that are frequent and consistent.

in this scenario, we have developed an analysis tool to search for genome-wide epistasis in a case-control design. hypothesis free clinical cloning  is an standalone software which allows for single-locus genetic association testing, as well as epistasis testing for multi-locus combinations of markers. due to the intense computational burden, it is programmed to take advantage of computer clusters by dividing the tasks into processes which can migrate to the available cpus. we present here the method, as well as a genome-wide two-locus epistatic analysis performed on a real dataset of parkinson's disease that illustrates the method. with the current availability of genetic studies with large numbers of individuals and genetic markers, hfcc can have a great impact in the identification of epistatic effects that escape the standard single-locus association analyses.

methods
input data
sample
the standard input to hfcc is a case-control sample with hundreds or thousands of individuals. similarly to other association methods, it is convenient that cases and controls are matched for potentially important covariates like age, sex, ethnicity, geographical location, environmental factors, etc. dichotomous phenotypes with a potential effect on the trait may be used as covariates in the analysis.

if all cases have only one disease phenotype or trait, hfcc carries out a single-phenotype analysis. in the single-phenotype scenario, hfcc can analyze the full sample simultaneously for extra statistical power. in addition, we have developed a multi-group analysis strategy, explained in more detail in a later section, that allows the replication of consistent results, and it also aids the elimination of false positives results, a very attractive quality for genome-wide analysis of large number of genetic markers. for this single-phenotype multi-group analysis option, cases can be sub-divided into groups to allow for replication of consistent results across these groups. controls can also be sub-divided into groups to eliminate spurious associations.

nonetheless, one of the strengths of hfcc is that it can analyze multiple phenotypes simultaneously. for this multiple-trait analysis, several groups of cases with different but related phenotypes are formed, each matched to its own control group. indeed, the multi-group analysis strategy is especially convenient for the simultaneous analysis of several related diseases, or different symptoms of a syndrome, so that we can identify the genetic effects common to the different groups.

genotypes
hfcc can currently analyze di-allelic markers such as single nucleotide polymorphisms , and it can also accommodate other dichotomous markers such as the presence or absence of a particular allele of a multi-allelic marker or of a haplotype. hfcc can analyze anything from small sets of candidate gene markers to genome-wide arrays of hundreds of thousands of markers.

markers can be filtered out before analysis if they have low call rate, low minor allele frequency, or if they fail a hardy-weinberg equilibrium test. nonetheless, data analysis filters inherent in the software can eliminate, at least partly, these problematic markers.

currently, linkage disequilibrium  among markers is ignored during the analysis, although it is useful for the validation and interpretation of results.

datasets
to illustrate the method we used data from the snp resource at the ninds human genetics resource center dna and cell line repository . the original genotyping was performed in the laboratory of drs. singleton and hardy , bethesda, md usa  <cit> . we have used data on  <dig> patients with parkinson's disease and  <dig> normal control individuals who were genotyped for  <dig>  snps in all  <dig> autosomal chromosomes using the illumina infinium i and infinium ii assays. cases were all unrelated white individuals with idiopathic parkinson's disease and age of onset between 55– <dig> years . the control sample was composed of neurologically normal, unrelated, white individuals from the usa.

to explore the power of hfcc we also analyzed a simulated dataset that was originally generated to evaluate the power of a different gene-gene interaction method  <cit> . these case-control data were simulated under different genetic models, and different sources of noise . for each genetic model and noise condition,  <dig> datasets were generated. each dataset contains  <dig> cases and  <dig> controls, with genotypes for  <dig> snps under hwe. an epistatic effect with no single-locus marginal effect was simulated for a pair of snps, and the remaining  <dig> snps were simulated under the null hypothesis of no genetic effect. for the genetic heterogeneity case, two epistatic effects  were simulated. more detail of these simulated datasets can be found in the original publication  <cit> .

hfcc modelling
statistical tests
single-locus association tests
hfcc can perform a single-locus genome-wide association scan. a di-allelic marker with alleles a and b, has  <dig> possible genotypes: aa, ab and bb. for each genetic marker, hfcc performs three statistical tests, comparing each genotype against the other two. for example, the frequency of the aa genotype is compared against the combined frequency of the ab-bb genotypes, in cases and controls. this could be considered a dominance model test for the b allele. similarly, recessive  and heterozygote models  are also considered. the test for association between the established genotypic classes and the case-control groups can be a wald test or a chi-squared test with one degree of freedom .

multi-locus and epistatic association tests
hfcc can also perform a multi-locus genome-wide association scan. for a two-locus scan, hfcc first forms all possible combinations of two markers from all available markers. for each two-marker combination , there are  <dig> possible genotypic classes , and a total of  <dig> fully penetrant disease models  <cit> . for our purpose, this number of models can be reduced to  <dig>  because some models are redundant or represent a model with no genetic effect. these  <dig> models include a variety of standard models  as well as other rare models. the user can select to test all available models or a subset of them.

as in the single-locus case, the statistical test involves comparing the frequency of two sets of genotypic classes in cases versus controls. the two sets of genotypic classes are defined by the model being tested. for example, in the case of the double-recessive model, the frequency of the bbdd genotypic class is compared against the combined frequency of all other genotypes , in cases and controls, from which a wald-test z statistic, or a chi-squared statistic with one degree of freedom, can be obtained.

another analysis option is a more general multi-locus test  <cit>  which compares two chi-squared statistics with four degrees of freedom . this test, although more general, may not be able to detect some disease models.

for a three-locus scan, there are  <dig> possible genotypic classes, and the software is currently implemented to test the  <dig> simplest 3-locus genetic models, comparing the frequency of a genotypic class  against the combined frequency of all other genotypes.

post-hoc tests
a variety of post-hoc statistical tests are included in the post-hoc analysis software, named alambique. for single-locus analysis, it is possible to carry out hardy-weinberg equilibrium, heterozygous, homozygous, allele positivity , recessive, common odds ratio   <cit> , and genotypic  tests.

for the two-locus analysis, all  <dig> fully-penetrant models can be tested. moreover, interaction indices can be estimated to determine to which extent an observed two-locus association deviates from an additive model  <cit> . finally, departures from a multiplicative model can be tested using a case-only chi-squared test  <cit> .

these post-hoc analyses are useful to determine which genetic model explains better an observed association, and to measure the epistatic component of associated multi-locus combinations.

grouping
replication  groups
the statistical tests for association of a trait with a marker are based on the differential frequency between cases and controls of a particular allelic or genotypic combination. comparing the full sample of cases versus the full sample of controls is the most powerful approach to find statistically significant associations. nonetheless, to evaluate genomewide association or epistasis we need to test a very large number of markers or marker combinations, which in turn can produce a large number of spurious results. therefore, we need to improve the filtering of false-positive results, at the expense of increasing the false-negative findings.

we have approached this multiple-testing issue by partitioning the available sample into multiple replication groups. cases are selected randomly to be part of one and only one case group, and similarly for control individuals and control groups. then, the statistical analysis is performed on each of the paired case-control groups, and results that are consistent across all replication groups are selected. this sample-splitting technique may prove less powerful to detect positive results in general, but provides a powerful tool to eliminate false positives, thereby highlighting potentially true effects that are consistent across samples. the number of groups into which the sample is partitioned can be chosen by the user depending on the study design, and the number of subjects and markers available for analysis.

this multi-group strategy is one of the differentiating aspects between hfcc and conventional association methods, and it is particularly useful for the analysis of multiple related phenotypes. case groups are directly defined by phenotypic criteria, and control groups are matched to each case group. this type of analysis can reveal genetic associations that are common to these phenotypes, revealing a common etiology for multiple symptoms of a disease, or for several related diseases  <cit> .

control filter  groups
hfcc has developed an efficient noise filter, by applying the association tests to independent groups of controls. positive results that arise from a comparison of two groups of controls must be spurious associations due to marker or sample characteristics. these spurious associations can be filtered out of the results from the case-control analysis, providing an efficient sample-specific background noise filter.

algorithm and program execution
hfcc requires specific data and parameter files. the input data file is a simple-text matrix of integers in which rows represent genetic markers and columns represent individuals. each integer represents the genotype for one individual at one marker, coded as  <dig> for missing,  <dig> for one homozygote,  <dig> for the heterozygote, and  <dig> for the other homozygote. these integers are entered sequentially, with no blank spaces or lines, to save space. there is one data matrix for each group of cases , controls  and noise-filter controls , as can be seen in figure  <dig>  a parameter data file defines the type of analysis , number of genetic markers, number of groups, sample size per group, statistical cut-off for significance, and other necessary parameters.

the following algorithm describes hfcc analysis flow . genetic markers are analyzed sequentially in the order in which they are entered in the data matrices. first, hfcc selects a marker variable . then, for the selected analysis model, it computes genotype frequencies and test statistics in each replication group, sequentially. if the test statistic is smaller than a pre-defined cut-off in any of the replication groups, the marker variable is dropped at that stage and no more computations are performed on this marker variable to save processing time. if the test statistic is larger than the cut-off in all replication groups, then the marker variable is written to the output file and also entered in the control noise filter. this noise reduction analysis computes frequencies and test statistics in each control filter  group sequentially. if the test statistic is larger than a pre-defined cut-off in any of the filter groups, the marker variable is flagged for removal from the final output file. the marker can fail at any of the sequential group analyses , at which point that marker is dropped to save processing time. this procedure is repeated for all possible marker variables, writing to the output file all associations considered statistically significant. this output file contains the marker  and the genetic model for which it yielded a positive association .

these selected marker variables can then be included in two sequential post-hoc analyses which aid in the interpretation of the results. the first post-hoc analysis yields odds ratios and chi-squared values for all selected marker variables. it also applies a direction filter, by selecting only those results which display the same direction of effect in all replication groups, and writes a new output file, which contains only those marker variables with a significant and consistent effect  in all replication groups.

the second post-hoc analysis  identifies the best type of genetic model for each association selected in the first post-hoc analysis. for this reason, all replication groups are combined into a single group, that is, all cases in one case group and all controls in a control group. alambique has its own noise elimination algorithm, denominated tracking filter. many of the selected associations are due to what we call a tracking marker, a locus with a very large marginal effect. many of these tracking markers are not in hwe and are filtered at this stage. in any case, having a large marginal effect makes a locus appear in many two-locus associations, because the large effect tracks other loci. because our focus is on finding epistatic interactions, the many positive associations due to these tracking effects can be filtered out and analyzed independently. for the remaining marker variables, which have passed this tracking filter, there is one analysis option that groups the two-locus results into those with marginal effects for only one locus , or for both loci  or those without marginal effects   <cit> . some of the conditional and simultaneous results may still exhibit epistatic effects if the two-locus effect size deviates from an additive or multiplicative expectation, and these epistatic effects can also be flagged. a second analysis option tests all  <dig> fully-penetrant models in selected marker variables, to help choosing the model that best fit the data.

due to the extremely time-consuming and computer-intensive nature of these analyses, especially for genomewide multi-locus analysis, it will often be necessary to run hfcc under a small selection of genetic models, and then use alambique to identify the best genetic model for the selected markers. the number and selection of genetic models to analyze will depend on the phenotype, the dataset, previous knowledge and computer resources available.

RESULTS
we have applied hfcc to both simulated and real datasets to illustrate the power and the functioning of the method.

simulated data analysis
to evaluate the power of the method, we analyzed a simulated dataset published previously  <cit> . data were simulated under three types of two-locus epistasis models: model  <dig> was a logical xor model, a combination of exactly one heterozygous and one homozygous loci , similar to m <dig>  <cit>  but with variable penetrances; model  <dig> involved the inheritance of exactly two, and only two, risk alleles  from any of two different loci , such as m <dig>  <cit> ; model  <dig> was a variable penetrance risk model with a protective double-heterozygote , similar to m <dig>  <cit> . in addition, to make the simulated data more similar to real data, and therefore to evaluate the effect of noise in the detection of these epistatic effects, different sources of noise were modeled in the simulations. for each of the three types of genetic models described above, the data was simulated and analyzed under six types of noise: without noise, with 5% genotyping error , with 5% missing data , with 50% phenocopy , with 50% genetic heterogeneity , and with all sources of noise simultaneously. for more information on these simulated datasets please refer to the original publication  <cit> . power was defined as the proportion of times the correct model was detected out of each set of  <dig> simulations. for genetic heterogeneity the correct model was defined as detection of either one of the two epistatic loci simulated.

to detect potential epistatic loci, we ran hfcc two-locus analysis with nine simple genetic models, the m <dig>  m <dig> and m <dig> models  <cit> . there are a total of  <dig> possible two-locus combinations that can be formed with the  <dig> simulated genetic markers. due to this relatively small number of tests , hfcc was performed with only one group of cases and controls, and a chi-square cut-off of  <dig>  . using only one case-control group allows also for direct comparison of hfcc's power to the power estimates published previously for this dataset. results from the snps simulated under the null hypothesis reveal fewer type i errors than expected, confirming that the method is not biased and perhaps conservative. this reduced number of false positives may reflect that some of the epistasis tests used were correlated, as well as a general lack of power to detect some epistatic effects, especially for rare genotypes.

hfcc had excellent power , with a type i error of  <dig> , to detect the simulated two-locus interactions under most genetic models and noise conditions, including genotyping error and missing data . genetic heterogeneity reduced the power to 82% under model  <dig>  and the presence of phenocopies had also a significant impact on power for models  <dig>  and especially,  <dig>  finally, if all four sources of noise were acting simultaneously the power was reduced to 51% for model  <dig>  71% for model  <dig>  and 34% to model  <dig> 

power of hfcc to detect a two-locus interaction at an alpha level of  <dig>  under  <dig> genetic epistasis models and different sources of noise: no noise , genotyping error , missing data , phenocopy , genetic heterogeneity , and all sources of noise simultenously . for the datasets with genetic heterogeneity, we reported the power to detect either of the two simulated two-locus effects. model  <dig> is a heterozygote-homozygote risk ; model  <dig> represents a " <dig> and only 2"-allele risk  from any of two loci ; model  <dig> represents a protective double-heterozygote .

parkinson's disease analysis
to demonstrate the hfcc software in real data we analyzed the open-access parkinson's dataset described in the methods section. we included all  <dig>  snp markers. many of them had low minor allele frequencies or failed hardy-weinberg equilibrium , but were included in order to test the data filters inherent in hfcc, which are meant to eliminate, at least partially, these problematic markers.

the  <dig> cases and  <dig> controls were separated into groups, to illustrate hfcc multi-group analysis strategy. we created  <dig> replication groups of  <dig> cases each  and  <dig> groups of controls of approximately similar size . because of the lack of more control individuals, the noise filter control groups  were selected respectively from each of the control groups, chosen so that the noise filter would not pair two identical control groups . ideally, independent groups of c and cf controls would be used, so we expected that the noise filter in this experiment, in which the same groups of controls were used as c and cf, would not be as effective.

to detect potential epistatic loci, we ran hfcc two-locus analysis with nine simple genetic models, the m <dig>  m <dig> and m <dig> models  <cit> . these nine genetic models were tested in all possible  two-locus marker combinations. in order to be considered a preliminary positive result, the chi-squared  cut-off value was set at  <dig> , which yields a probability value of  <dig>  for each replication group . although this p-value may be considered low compared to the number of statistical tests performed, this is only a cut-off to select preliminary positive results, which are then filtered and subjected to post-hoc analysis to select the most promising results. we obtained a total of  <dig>  preliminary two-locus associations at this p-value cut-off . to evaluate the impact of the different noise filters  we applied them selectively to these preliminary results.

method i: only direction filter applied.

method ii: direction and tracking filters applied.

method iii: all filters applied .

n: number of selected two-locus snp pairs.

%: percentage of selected two-locus snp pairs over the preliminary set .

a total of  <dig> snps were identified as tracking snps in the two methods using tracking filter.

noise filters 
direction filter
when the control filter is not used, the direction filter has a large impact on the number of results selected. of the  <dig>  preliminary associations, only  <dig>  %  had effects in the same direction in all replication groups. these results can then be grouped into those with marginal effects in both loci , only one marginal effect , and no marginal effect . a marginal effect was defined as a single-locus effect with a chi-squared  statistic larger than  <dig>  . this liberal cut-off serves our goal of selecting as pure epistatic effects those marker combinations with no or small marginal effects. under these criteria,  <dig> %  of the results had simultaneous marginal effects,  <dig> %  had conditional effects, and only  <dig> %  had epistatic effects. at this point, out of the hundreds of thousands of preliminary results, only  <dig> two-locus associations without marginal effects remained, very likely to be epistatic interactions. the many thousand simultaneous and conditional results may also involve epistatic effects on top of the marginal effects, but the large number of them prevents a thorough post-hoc analysis.

direction and tracking filters
in order to distil further the post-direction-filter results we can apply the tracking filter. many of these two-locus associations are due to what we have denominated tracking loci, that is, markers with large marginal effects, which therefore display significant two-locus effects with many other markers. most of these tracking markers exhibit large association effects because they fail hwe, and they are filtered out at this stage. in this parkinson dataset we detected  <dig> tracking markers, defined as those markers showing up in  <dig> or more two-locus associations . most of these tracking markers  failed hwe , and others failed minor allele frequency  or call rate  criteria. therefore, results involving these markers can be safely excluded.

a few of these tracking markers represent the best single-locus association results which, due to their large marginal effects, also appear in a large number of two-locus association results. these large-single-locus-effect tracking markers need their own specific post-hoc analysis. because of their large marginal effects, these markers are likely identifiable by single-locus analysis, but it is still noteworthy to discover if they have epistatic effects, and with which genes. however, it is hard to identify a significant epistatic interaction in the background of such a large marginal effect. individual post-hoc analysis for each of these markers may identify the most likely multi-locus combination involving those marker.

interestingly, by filtering out the marker combinations involving the tracking markers, we can eliminate  <dig> % of the previous positive results. most of these results were conditional effects, involving the tracking locus  and a tracked locus . the post-tracking-filter results include a total of  <dig> marker variables with epistatic effects,  <dig>  with conditional effects, and  <dig>  with simultaneous effects.

control, direction and tracking filters
we can repeat this data filtering process, but this time starting by applying the control noise filter. the control filter was set to employ the same statistical cut-off  used in the case-control comparisons. association results above this cut-off value obtained in analysis of two control groups can be deemed problematic and excluded from further analysis. this control filter was able to eliminate  <dig> % of the preliminary results, leaving a total of  <dig>  associations . applying the direction filter to the post-control-filter results eliminates only a further  <dig> % of preliminary results, yielding a total of  <dig>  associations, almost exactly the same quantity as when the direction filter was used alone. therefore, the control and direction filters seem to eliminate most of the same results, which reassures their correct functioning and also allow for different analysis strategies. on one hand, when enough control subjects are not available and consequently the control filter can not be used, these results suggest that the direction filter may work well alone. on the other hand, the direction filter may not be useful for some multiple-phenotype studies, expecting effects on different directions in different replication groups. thus, in some scenarios, the control and tracking filters may provide enough noise elimination by themselves.

when the tracking filter was applied to the results selected by the control and direction filters, we obtained  <dig> two-locus combinations with epistatic effects,  <dig>  with conditional effects, and  <dig>  with simultaneous effects. by applying three consecutive data filters , we excluded almost 94% of the preliminary results. the remaining  <dig> % of results are subsequently analyzed for departures of additive or multiplicative two-locus models, to estimate their potential for epistatic effects.

epistatic interaction indices
hfcc analysis yielded  <dig> two-locus combinations with epistatic effects and no noticeable single-locus marginal effects, ten of which are displayed in table  <dig>  in addition, there are  <dig>  conditional or simultaneous two-locus combinations, which may display interaction effects over and above the marginal effects. there are a variety of tests and indices to detect departures from additive or multiplicative models. for example, a case-only chi-squared test can detect two-locus interactions which deviate from a multiplicative model. for the present study, this case-only statistic was used to choose, among the conditional and simultaneous marker variables, those with the most significant interactions . in addition, marker quality control criteria were checked to assure all markers in selected combinations passed a minimum requirement .

a selection of two-locus marker combinations consistently and significantly associated to parkinson's disease  and displaying an epistatic  effect, or conditional  or simultaneous  effects with significant deviations of a multiplicative model. the genetic model tested is specified as snp <dig> genotype * snp <dig> genotype.

validation analysis
in order to validate to some extent these results, and without immediate access to a truly independent sample, we created  <dig> validation samples by randomly re-creating the case groups  from the full pool of cases , and similarly for the control groups . in the described analysis of the parkinson dataset, three replication groups were created randomly, to find consistent results across these groups. to examine the possible effect of this random group membership, the replication groups were re-created randomly and reanalysed in what we called validation experiments. these validation experiments are not permutation simulations to estimate the empirical significance level of parameter estimates, and are not a standard bootstrapping technique because they use sampling without replacement. the replication groups in each validation analysis were re-created under association , and not under the null hypothesis of no association. these validation experiments are used to examine the consistency of results when the replication groups are re-created.

the control noise filter was not employed for these validations analyses to save computing time, since it was found that for this dataset the direction and tracking filters alone were sufficiently efficient. because we are using the same set of cases and controls in all the validation groups, a high degree of consistency of results across validations analyses would be expected a priori. nonetheless, due to the small sample size of each group, the many requirements for the selection of marker variables, such as the consistency of strength and direction of result in three replication groups, and the subjective categorization  of results into different types of effects , a large variability in results across validation analyses is reasonable.

the total number of preliminary results varies noticeably across validation groups . this variability illustrates the randomness inherent in this type of analysis. the total number of two-locus combinations selected as simultaneous or conditional are much more consistent. nonetheless, the number of epistatic effects is quite variable again, perhaps a consequence of the small number of marker combinations selected under this category.

number of total preliminary results, and number of selected simultaneous, conditional and epistatic two-locus combinations in the original sample, and in ten random-placement validation samples. average numbers  for the  <dig> samples, and average percentage of each category, are included.

in addition to the variability in the number of results, it is important to note the general lack of consistent results across validation groups. the simultaneous effects were the most consistent type of result. one two-locus combination  showed up in the original analysis and the  <dig> validation samples. five other combinations with simultaneous effects were consistent in  <dig> out of the  <dig> samples, and  <dig> combinations were consistent in  <dig> samples. of the conditional results, thirteen marker combinations were consistent in  <dig> samples. perhaps because their effect is harder to replicate, only one epistatic marker combination was present in as much as  <dig> samples, while  <dig> combinations were present in  <dig> samples, and three combinations in three samples.

discussion
hfcc is a new computer software for exhaustive genome-wide analysis of multi-locus association effects in a case-control design. it carries out different types of statistical tests to assess a variety of genetic and epistatic models. hfcc differs from other association or multi-locus methods in that it can analyze simultaneously multiple samples or multiple phenotypes, and incorporates several complementary noise-signal filters, and also post-hoc analysis tools. to address the enormous computing task, it is elegantly designed to take advantage of the multiple cpus available nowadays in computer servers or clusters.

the goal of hfcc analysis is to find multi-locus marker combinations which are significantly associated with a phenotype, especially those displaying interaction effects which may not be detected in a single-locus analysis. by setting the type of genetic model, the number of subjects in each group, the number of replication groups, the statistical cut-offs for the different tests, and applying different noise elimination filters, hfcc can arrive at a selection of the most promising multi-locus combinations.

other multi-locus methods to detect gene-gene interactions exist. for example mdr  <cit>  is a method for exhaustive search of high-level multi-locus interactions, although it is extremely computationally intensive, and genome-wide searches for epistasis are prohibitive. more recently a promising bayesian method  has been suggested as a powerful alternative for detecting epistatic interactions, although it is not exhaustive and still requires further improvements to effectively handle the large snp datasets commonly used in genome-wide studies  <cit> . other methods, like plink  <cit>  or others based on logistic regression  <cit> , can carry out genome-wide epistasis tests relatively quick, but are currently limited to two- or three-locus models, and only perform general tests of epistasis. hfcc combines a relatively fast computing algorithm for genome-wide epistasis detection, with the flexibility to test a variety of different epistatic models in multi-locus combinations. our analysis of a simulated dataset reveals that hfcc has good power, at least as good as or better than mdr  <cit> , to detect epistatic interactions, as long as they are relatively strong and common. in the most extreme simulation, with 5% genotyping error, 5% missing data, 50% phenocopies, and 50% genetic heterogeneity, hfcc still had 71% power to detect some types of epistasis, although the power for other types of epistasis was smaller . we will need to carry out more extensive simulations to evaluate the power under different conditions and genetic models.

for this illustrative application of the software we have also analyzed an open-access dataset of parkinson's disease patients and unaffected controls. we would like to emphasize here the importance of these public datasets of real data to improve the quality of applied research, and also to foster the development of new methodology.

one of the pecularities of hfcc is the possibility of dividing the case-control sample into replication groups, to detect only those effects that are consistent across samples. the number of replication case-control groups to be used depends on the available dataset . it is an important analysis parameter because the overall significance level is a function of the selected critical value for the test statistic and the number of replication groups. for the current analysis, the sample of cases was divided into three replication groups, and so were the controls. this strategy focuses on the detection of large and consistent effects, which are hopefully detectable with the available datasets. it is reasonable to expect that the joint effect of a combination of genes is larger and more penetrant than each of the single-locus effects, and therefore under some circumstances , these multi-locus effects can be identified. the detection of small, rare or heterogeneous effects may need larger samples and more complex models.

hfcc allows for a variety of different genetic models and tests. different models may be necessary to detect different types of effects, such as recessive, dominant or heterozygote effects. the best analysis strategy may depend on prior knowledge or hypothesis about the trait. an optimal strategy would apply a selected subset of models which would maximize the chances of detecting a hypothesized effect. for example, for this parkinson's disease study, we have employed a subset of nine epistatic models which typically detects recessive effects.

another characteristic of hfcc analysis is the successive application of noise-signal filters. control groups can be compared against each other to remove background noise associations. direction of effect can be taken into account, so that only those results consistent in strength and direction across replication samples are selected. a final filter is able to remove those multi-locus results which are primarily due to quality-control failing markers  or to large single-locus effects. the remaining multi-locus combinations can be categorized into epistatic, conditional and simultaneous effects, and interaction tests can be used to detect possible epistatic interactions over and above the marginal effects. the selected markers can then be included in a validation analysis in an independent sample. as an illustration, table  <dig> displays  <dig> two-locus combinations suggestive of displaying epistatic interactions influencing the development of parkinson's disease. it is important to note that due to the small sample size used in this experiment, these results may not be reliable, and need re-analysis or confirmation in larger datasets. the number of combinations selected for a validation analysis depends on many factors, and tools are included to help perform this selection.

the parkinson's disease study reported here can illustrate several issues regarding the search for epistatic effects in large datasets. one of the most difficult tasks in large dataset analysis is selecting the most promising candidate results. the huge number of statistical tests performed requires a severe statistical cut-off, or a protocol of data filtering, to be able to select only the most promising results. for example, the two-locus analysis of a genome-wide association snp dataset presented here reveals several hundred thousands two-locus marker combinations at a liberal significance level . using a stringer significance level, such as a bonferroni correction, may be overly conservative, sometimes potentially missing real effects. hfcc filters and post-hoc analyses help selecting the most promising two-locus interactions from a large set of preliminary findings. for example, all two-marker combinations in table  <dig> are consistently associated with parkison's disease in three replication groups  in the range 21–30), and they all also deviate from a multiplicative model  in the range 7–33) suggesting an epistatic interaction.

the resampling validation analysis raises an important issue regarding the difficulty in replicating a result across different validation samples, a finding that may reflect the general lack of power to detect these types of effects, especially in the presence of heterogeneity. with the available sample size for this study we have approximately 80% power to detect large common effects  at a significance level of  <dig>  per replication group. however, this small dataset is underpowered to find more moderate, and perhaps more realistic, effect sizes. the general lack of consistency suggested by our own sensitivity analysis may be a consequence of the small sample size analyzed. fung et al.  claimed that there is no common genetic variant that exerts a large genetic risk for late-onset parkinson's disease in white north americans. multi-locus analysis may, however, reveal the existence of large complex  genetic effects.

analysis guidelines
hfcc provides a tool for the genome-wide study of epistasis. its use may depend heavily on the researcher's goals and the data available. for this reason, it is hard to provide general guidelines on the optimal parameters for analysis, but hfcc's flexibility to accommodate to the specific needs of each study is a great asset.

a key parameter is the number of replication groups. when the available sample size is fixed, dividing the sample into more replication groups decreases the power of the analysis, but also increases the confidence in the remaining results. for example, the two-locus analysis of the full parkinson's dataset in one case-control group with a type i error set at 10- <dig> yields a total of  <dig>  preliminary positive results. the analysis of the same data splitted in three replication groups, each with alpha = 10- <dig>  yields only  <dig>  results .

there is not an optimal number of replication groups. researchers need to select this parameter as well as the significance level cut-off to fit their dataset and study design. for example, a study of three related diseases or phenotypes suggests the use of three replication groups. in the case of a single disease, the number of replication groups, the sample size in each group, and the statistical cut-off should be chosen depending on the nature of the study. a strict statistical correction may be necessary if the results are to be conclusive, while a more relaxed criterion may be used in a two-stage study where the goal of the preliminary analysis is to select a subset of markers for subsequent validation.

hfcc's flexibility is also possible in the application of data filters. the results displayed in table  <dig> suggest that the control filter and the direction filter can eliminate most of the same noise results. the application of either or both of these filters can therefore depend on the study design. if a study has many control subjects and a limited number of cases, it can benefit from using the control filter. if a study has many affected individuals, then several replication groups and the direction filter can be used.

there are also  <dig> possible two-marker genetic models that can be tested. many of them are correlated, so it is probably not necessary to test them all. we suggest using a small subsample of models that cover the researcher's hypothesis. for example, for the parkinson's analysis in this paper we tested nine simple genetic models. to identify subsamples of models that may optimize the chances of discovering epistatic effects of different nature would need a thorough simulation analysis that is beyond the scope of the current paper. another analysis option is to use more general tests of epistasis, which are also implemented in the software.

statistical issues
the two-locus analysis of the full parkinson's dataset as presented here comprises a total of  <dig> ×  <dig> statistical tests. the two-locus analysis of these data in one case-control group with a type i error set at 10- <dig> yields a total of  <dig>  preliminary positive results, about 10% more of those expected by chance. this false positive inflation is probably due to the tracking markers  as well as to the correlated nature of some of the statistical tests, and can be controlled by the use of replication groups, or by applying more stringent cut-offs if necessary.

for the simulated dataset, analyzed with only one case-control group a significance level of 10- <dig> , the type i error was actually lower than expected . these results demonstrate that hfcc analysis is not only powerful but can also be conservative, preserving against types i and ii errors. more thorough simulations to assess the impact of sample size, allele frequency, number of replication groups, and noise filter applications are needed in the future to understand these issues in detail.

applying strict multiple testing correction  to the parkison's disease analysis, we do not find any significant two-locus interactions. the reason for this may be the small sample size available in the parkinson's dataset. but we can still select the most promising two-locus results for subsequent validation. the key issue is whether we are concerned with achieving an absolute level of statistical significance, which may not be properly defined in this setting given the complexity of the analysis suggested , or selecting the most promising markers or marker combinations that pass a more or less stringent statistical criterion. in either case, the usefulness of hfcc for selecting marker combinations for later validation is doubtless.

computational issues
multi-locus analysis is computationally intensive and is therefore limited by computing capabilities. hfcc is a relatively fast algorithm considering the huge number of computations it performs. the dataset analyzed in this study consists of  <dig>  genetic markers, which results in  <dig>  ×  <dig> two-locus marker combinations. nine genetic models were tested in the current study, resulting in a total of  <dig> ×  <dig> statistical tests. moreover, these tests may be carried out in as many as three case-control replication groups, and also in as many as three control-control noise-filter groups, so the computing task is staggering. hfcc is programmed to take advantage of computer resources by dividing the computing task into processes which can migrate to the available cpus in a computer server or cluster. for the current analysis, we employed a computer cluster consisting of twelve  <dig>  ghz cpus, which was able to carry out the full genome-wide analysis in approximately  <dig> days.

another computational complication for multi-locus analysis is related to ram memory. the data matrices need to be loaded onto memory to speed computations, and therefore a limitation exists for the analysis of very large datasets  where ram memory is rapidly exhausted. this limitation, however, can be solved with parallel processing techniques , such as dividing the data matrices into smaller subsets which are distributed around the computer network.

hfcc can perform more complex multi-locus analysis , but the number of computations grows exponentially with the number of interacting markers, and the analysis becomes dependent on computing resources and time limitations. depending on these resources, genome-wide three- or four-locus analysis may require a two-stage strategy, where some markers are selected first by single-locus analysis, and then employed to guide the multi-locus testing  <cit> . our exhaustive two-locus genome-wide analysis of a parkinson's disease dataset reveals that pure epistatic effects, as defined here, are rare . therefore, a two-stage strategy for multi-locus analysis may be a more economical analysis with minimal information loss. this statement assumes that we had power to detect these epistatic effects, that more complex interactions behave as two-locus ones, and that parkinson's disease is representative of other diseases. our results suggest the use of a conditional two-stage strategy, where a liberal single-locus threshold is first used to select loci with marginal effects, and then these markers are used against the full panel for multi-locus analysis. this conclusion is similar to some previous suggestions  <cit>  but not all  <cit> , confirming that a liberal single-locus cut-off  greatly reduces the computational task while minimizing the probability of discarding potential epistatic loci.

it is also important to note that linkage disequilibrium  is unaccounted for in our analyses. ld reflects an association among markers and therefore can affect the results of some tests. for example, it can produce a significant case-only chi-squared test. nonetheless, hfcc's algorithm and analysis filters seem to prevent this bias. in the case where one marker is associated with several markers in ld, these results are detected in the last stage of marker selection.

CONCLUSIONS
in summary, we propose that genome-wide multi-locus analysis is performed on available datasets of common diseases, because they can exploit the large genetic datasets and computing resources becoming available, to open a new phase of genetic analysis. the analysis of parkinson's disease reported here represents the first exhaustive genome-wide epistasis search on a real dataset, effectively handling hundred of thousands of genetic markers, and demonstrating its feasibility. due to the small sample size, however, these results are only illustrative and require re-analysis or confirmation in larger datasets. these multi-locus analyses would not substitute conventional single-locus analysis but add a new layer of genome-wide association studies, allowing the identification of new candidate markers for further validation. hfcc is a new genome-wide multi-locus software, which allows the user a high degree of control over analysis parameters, so that data analysis can be tailored to the specific needs of each project. hfcc can have a great impact on the discovery of the genetic causes of common diseases, especially to identify those multi-locus effects that may not be detectable using the available single-locus methods. the discovery of new genes affecting a disease may be useful as predictive tools or to find new therapeutic targets. hfcc has multiple applications, not only in the study of disease phenotypes, but also of other qualitative traits, and can be used in clinical trials or pharmacogenetics studies.

availability and requirements
hfcc is written in c and freely available for linux platforms from this website: 

list of abbreviations
cpu: central processing unit; ge: genotyping error; gh: genotyping heterogeneity; hfcc: hypothesis free clinical cloning; hwe: hardy-weinberg equilibrium; ld: linkage disequilibrium; ms: missing data; pc: phenocopy; snp: single nucleotide polymorphism; xor: logical exclusive "or" statement.

authors' contributions
jg, ag–p, and ar conceived and designed the experiments. jg, ag–p and ar analyzed the data. jg and ar wrote the paper. ar conceived the analysis tool. all authors helped develop the analysis tool. fb and aq wrote the analysis tool. all authors read and approved the final manuscript.

competing interests
as a declaration of competing financial interest, authors in the paper are employees and/or shareholders in neocodex. neocodex owns a patent on  the hfcc algorithm described in this paper .

