BACKGROUND
many experimental studies produce multiple types of molecular profiles per sample to help understand if, and how, different molecular levels influence each other. this has led to a growing interest in methods for analyzing multiple high-dimensional datasets together. as a result, a number of methods have been developed in recent years for studying the association patterns between high-dimensional datasets, i.e. performing integrated genomic analyses  <cit> . in a study where dna copy number and gene expression profiles are available for all samples, there is often interest in questions such as which copy number changes effectively affect gene expression levels, as well as which genes have their expression levels regulated by copy number changes. both questions can be answered by a method such as the one described in  <cit> . this method is characterized by testing for the association between one variable in one dataset, say copy number at a fixed locus, and a set of variables in the other dataset, such as the expression levels of genes around the locus. this approach is implemented in r and available through bioconductor as the package sim.

studying these association patterns using integration analysis evokes another very important but yet overlooked question: do these association patterns differ between groups of samples? consider for example the case where gene expression regulation is studied on the basis of genomic copy number changes. in such studies, there is often interest in comparing gene-dosage led gene expression variation between groups of samples. furthermore, if there are clinical variables defining the groups of samples, there is interest in finding group-specific associations between copy number and gene expression.

in this paper, we propose a method, named dsim, to find these association differences between two groups of samples, while using an extension of the model described in  <cit> . it first corrects for the baseline association present for both groups using ridge regression  <cit> . testing is done using the global test  <cit>  on the residual associations, to check if they differ between the groups. the final p-values are calculated using permutation testing. the various steps involved in the method are discussed in more detail in the methods section . to demonstrate its performance, we applied dsim to several simulated datasets  and to two publicly available breast cancer datasets , where we compare samples on the basis of their estrogen receptor status. throughout this paper we use examples based upon copy number and gene expression datasets, but this method can be applied to other types of genomic data as well.

methods
motivation
we first give a brief overview of the model and method of sim  <cit>  before describing our extension to that method. suppose there is interest in finding regions where copy number variation regulates gene expression. then, if the copy number data corresponding to a single copy number probe y with n observations is y = ⊤, the regression model can then be written as 

  e=α+∑k=1pβkxjk,j= <dig> …,n, 

xjk is the gene expression measured for jth sample and kth probe, and α is the intercept. here, βk is the coefficient value for kth gene expression probe; it explains the association patterns between copy number probe y and gene expression data {xjk,j= <dig> …,n;k= <dig> …,p}. for testing the copy number and gene expression associations, the global test  <cit>  is used. the global test tests the hypothesis {h0:βk =  <dig> k =  <dig> …,p} in high-dimensional data by using a random effects model context, where it is assumed that the coefficients {βk} come from a normal distribution with mean  <dig> and variance ω <dig>  instead of testing h0:βk =  <dig>  the global test  <cit>  considers the null hypothesis h0:ω2 =  <dig> against the alternative h1:ω2> <dig> 

the main objective of this work is to test for differences in association between copy number and gene expression data, when the samples are grouped according to some binary grouping variable . in other words, we would like to find regions where copy number variation regulates gene expression differentially between two groups. one possible way of doing this would be to divide the datasets into two groups and to fit the model given in  for these two groups separately. however, this idea has three serious drawbacks. first, analyzing the two subsets separately results into two distinct sets of p-values, that should be combined and interpreted. second, it is inefficient as the power of finding associations is reduced by considering a subset of samples at a time. the third issue ignored by analyzing the datasets separately like this is the baseline association between copy number and gene expression. association patterns common to both groups should be removed before we start looking at the differences between them.

our new approach dsim extends the model given in  as follows. it starts by correcting for the baseline associations and then works with the corrected data to directly test for differential association patterns. for the sake of simplicity, we describe the model in the following subsections by using one copy number probe at a time. in practice and in the examples shown in this paper, it is applied to all copy number probes in a similar way.

correcting for the baseline association
for removing copy number and gene expression associations common to both groups, we start by fitting the model given in  on all samples together. the issue of  is dealt with by fitting  using ridge regression  <cit> . it is obvious that the ridge regression fit requires estimation of a tuning parameter λ. we do this by leave-one-out cross-validation. for each λ value, the dataset is divided into a test set containing a single sample i from the original sample set, and a training set containing all remaining samples with j =  <dig> …,n,j≠i. the ridge regression model is fitted and the coefficients are estimated on the training dataset. note that the coefficients estimated here are obtained without introducing the group effect. these estimated coefficients are then used to predict the test sample as 

  eyip=α+∑k=1pβ^k-ixik,i= <dig> …,n. 

where β^k-i is the estimated coefficient for the kth gene expression probe, obtained after leaving the ith sample out from the training set. this is repeated such that each sample is used once as the test set. once this is done for all λ values, the λ∗ leading to the set {yip∗} which maximizes the cross-validated likelihood is chosen. the predictions {yip∗} obtained during cross validation for all samples using that λ∗ value are then used to get the leave one out cross-validated residuals as 

  rj=yj-yjp∗,j= <dig> …,n. 

this approach helps in choosing a λ that does not overfit the data. the residuals {rj,j =  <dig> …,n} now represent the copy number data corrected for association with gene expression over all samples regardless of the group.

testing for the group effect
the cross validated residuals {rj} from  are now used for testing the association differences between the two groups of samples. for performing the test, first we write a linear model with the residuals as dependent data. this model holds for all samples together and is given as 

  rj=δcj+∑k=1pγkmjk+εj,j= <dig> …,n. 

in this model, δ acts as the intercept and δcj represents the baseline shift in association between copy number and gene expression for group  <dig> when compared to group  <dig>  here, cj∈c, where c, the factor defining the groups, can be written as c = ⊤. now, since {rj} represents average residual effects over all samples, it is important to parameterize c in such a way that 1⊤c =  <dig>  here  <dig> is a column vector of ones with length n. therefore, for all examples in the paper, we define cj=ng2n if the jth sample belongs to group  <dig> and cj=-ng1n if the jth sample belongs to group  <dig>  where cj are values in c and ng <dig>  ng <dig> are the number of samples for group  <dig> and group  <dig> respectively. the value mjk is the gene expression data for the jth sample and kth probe with grouping effect in it. it can be defined, in words, as an gene × group interaction term or mjk = xjkcj, where xjk is the gene expression measured for jth sample and kth probe and cj is the corresponding group variable. the error term in the model is denoted by εj.

the effect of interest in model  is represented by the parameters {γk,k =  <dig> …,p}, which account for the difference in association between the copy number data and gene expression data between the two groups. similar to the {βk} coefficients, we here assume that {γk} come from a normal distribution with mean  <dig> and variance θ <dig>  our approach is to then test the variance for the distribution of these {γk} values with, h0:θ2 =  <dig> against the alternative h1:θ2> <dig>  this is done by using the global test  <cit> . more information on the test statistic used is given in the additional file 1: section  <dig>  the distribution of the test statistic under the null hypothesis h0:θ2 =  <dig> is not known because of the ridge regression step. hence, we propose to use permutation of the independent data sample labels to yield p-values.

permuting the sample labels
permutation resampling can be used to estimate p-values while avoiding parametric assumptions about the joint distribution of the test statistic. in the microarray setting, the joint distribution under the complete null hypothesis of the test statistic can be estimated by permuting the rows of the matrix x, where x is the n×p gene expression data matrix with samples as rows and genes as columns. for this, we first permute the sample labels b times. the baseline association is corrected, residual values are obtained, and the global test  <cit>  is done for every permuted dataset. for each permutation we get a global test statistic ti∗, or, as in our case, 1- <dig> transformation of it such as the asymptotic global test p-value pi∗, leading to a set of permutation based values {ti∗,i= <dig> …,b} or {pi∗,i= <dig> …,b}.

as described in subsection ‘correcting for the baseline association’, while fitting the regression model and calculating the residuals using ridge regression, one needs to optimize the tuning parameter λ. this ridge regression step given in  does not involve the grouping factor c. moreover, permuting the sample label of x retains the correlation structure, distributional characteristics exhibited by the genomic data matrix x and the ill-conditionedness of x⊤x. since λ depends on x⊤x, we can use the same optimized λ value and hence, the same residuals for each permutation. permuting the sample labels avoids the optimization of λ parameter for every permutation, making the method computationally less intensive.

the steps involved in the method described in the previous subsections as well as this one are done for a single copy number probe at a time. these are then repeated for all m copy number probes which gives us a matrix of global test p-values, p∗, with m rows and  columns. the first column of this matrix consist of the observed global test p-values for all probes, obtained for the observed data , whilst remaining columns represent permuted global test p-values obtained after permuting the sample labels.

multiple testing correction
to exploit the dependence structure of the permuted dsim p-values, we use meinshausen’s procedure for multiple testing correction  <cit> . for general sets of hypotheses r, meinshausen’s permutation based method makes false discovery proportion  confidence statements of the form p≤ō)≥1-α by finding critical values. here o is the proportion of type i errors for the set r in hypothesis testing and ō is the estimate of this proportion  <cit> . we apply this procedure on the matrix of permuted global test p-values p∗, which gives us a single vector of length m, containing the multiple testing corrected dsim p-values.

RESULTS
simulation study
we perform various simulations to study the properties of dsim. for this, we start with generating the copy number data and gene expression data, both of them with same dimensions. the copy number probes are assumed to have similar distribution across the two groups and the gene expression data is generated per group, as a function of copy number. in our case, we consider copy number as the dependent data and use meinshausen’s approach for multiple testing correction. more details on the simulation setup are given in the additional file  <dig> 

dsim detects correct regions
this simulation study tests if dsim is able to detect desired regions of differential associations. it also tests the accuracy of dsim by studying the number of false positives in the scenario when there is no differential association between groups of samples. we test dsim in three different scenarios. in each scenario, we vary the type of association present between copy number data matrix y and the two different groups of gene expression data x as follows: scenario  <dig> for this scenario, copy number and gene expression show similar association patterns for both groups of samples. hence, no significant association differences between the two groups are expected. under this scenario, we test the specificity of dsim. scenario  <dig> in this scenario, copy number and gene expression show different association patterns between groups of samples. hence, significant association differences between two groups should be detected. scenario  <dig> this scenario has association patterns between copy number and gene expression for one group of samples only, so here again differences should be detected. this scenario is similar to the second scenario in the sense that there are association differences present between groups of samples.for scenario  <dig>  no probes are selected, as expected . for scenario  <dig>  most probes in regions affected are detected , although there are some false negatives. results of scenario  <dig> are similar to those of scenario  <dig> . for each scenario,  <dig> datasets were simulated, and the accuracy of dsim was calculated based on those  <dig> runs. figure 1d  shows that dsim has overall good accuracy and specificity, although it sometimes has false negatives, lowering the sensitivity.

dsim corrects for baseline effect
the validity of the results obtained from dsim is based on how well we correct for the baseline association. the model uses the simple structure of explaining copy number aberrations on the basis of gene expression variations. one of the factors that might differ between these two groups is the distribution of copy number variations or gene expression intensities.

if the method does not correct for baseline effects, then our results will be biased, resulting in possible false positives. to test if dsim really corrects for the baseline association, we perform  <dig> simulation studies. these four simulation studies are divided under two cases as follows, case 1: the copy number and gene expression data for both groups of samples were generated with similar association patterns. hence, there is no association differences between groups of samples. case 2: the copy number and gene expression data for both groups of samples were generated with different association patterns. hence, there is significant association differences between groups of samples.

under each of these two cases we perform two simulation studies which can be described as follows, case  <dig>  and case  <dig> : the distribution of copy number aberrations are kept exactly the same for the two groups of samples. this makes sure there are no distributional differences between the two groups for copy number aberrations. case  <dig>  and case  <dig> : the distribution of copy number aberrations for one group of samples are made to differ from the other group. this is achieved by using different means for generating the copy number aberrations for the two groups of samples.

all the other parameters are exactly the same between the cases, including the number of samples, number of genes etc. each study was then run  <dig> times and dsim was applied on these  <dig> simulated datasets for the simulations.figure  <dig> shows the regions picked up in one of the runs for all simulation studies. for case  <dig> , dsim detects nothing as significant with similar or different copy number aberrations as there are no differential associations. the sensitivities and accuracies  are comparable for datasets with similar copy number aberrations and different copy number aberrations. similarly, for case  <dig>  the desired regions with differential associations are detected by dsim in both sub cases. the accuracies and sensitivities  in this case are also similar for datasets with similar and different copy number aberrations between groups of samples. these results show that dsim correctly adjusts for the baseline effect. it detects significant results only when there is differential association between two groups, irrespective of their copy number distributions.

sensitivity of dsim towards changes in lambda values
our results depend upon the ridge penalty parameter λ, which is estimated using cross-validation. we will now study the sensitivity of dsim towards the variation of these λ values.

firstly, we study the variation of λ value within and across different cases. for this, we conduct four different simulation studies. in every simulation study, a certain parameter that affects the value of lambda  is changed. each study is then run  <dig> times, producing  <dig> simulated datasets from the same setup. the data points for the matrix x change between these  <dig> runs, but the number of probes and the regions showing differential association between the the two groups remain exactly the same. for every run, the λ value is estimated using the method described in section ‘correcting for the baseline association’. this makes sure that while the value of λ might vary a lot across the four simulations, intra-study variations would be minimal. the roc curves for these simulation studies are given in additional file 1: figure s <dig> . each graph depicts an individual simulation study with  <dig> roc curves for each run of the setup. from the graphs we can see that, for a given setup, all  <dig> roc curves are tightly bound together with very little or almost no variation. this suggests that the true positive rate of dsim remains the same even if λ displays some variations.

secondly, we study the effect of changing λ values over the dsim p-values. for this we perform a simulation study where only some simulated copy number probes show differential association with gene expression data. for each probe, the optimum lambda value  is obtained and a range of  <dig> λ values around λopt is generated. for each of these λ values, meinshausen-selected dsim p-value is calculated, resulting in a vector of  <dig> p-values for each probe. these p-values are then plotted against the corresponding λ value for some chosen probes. from additional file 1: figure s1e and 1f, we can see that the meinshausen selected dsim p-values exhibit a similar trend over a wide range of λ values. the probes that exhibit differential association between groups of samples are selected as significant irrespective of the λ values. the probes with no association, on the other hand, are never selected by dsim and meinshausen’s method, irrespective of the changes in λopt. this shows that dsim is capable of identifying the probes with differential association and maintaining the true positive rate, even with small variations in the value of λopt.

effect of small sample size on separate analysis and dsim
to demonstrate that separate analysis suffers from differences in sample sizes, we performed a small simulation study. in this study we simulated  <dig> datasets with  <dig> samples and  <dig> probes in each. out of these  <dig> samples,  <dig> were assigned to group  <dig> and  <dig> to group  <dig>  so that to have one larger and one smaller group of samples. all the other parameters between the two groups of samples are kept exactly the same, including the region of copy number aberrations. the samples in both groups show similar type of associations with between copy number and gene expression data. hence, there is no differential association between the two groups of samples.

we started with performing a separate analysis of these  <dig> datasets, using sim. the multiple tested corrected p-values obtained from separate analysis, for one of the  <dig> simulated datasets, are shown in additional file 1: figure s2a. from the figure, we can see that although the associations between gene expression and copy number are exactly the same for both groups, separate analysis is more sensitive for the larger group of samples. these separate analysis results give a specious indication that there is differential association between the two groups of samples. on the other hand, dsim results, in additional file 1: figure s2b, are in line with the simulation setup with no significant detection of differences in associations. this shows that separate analysis gets influenced by the sample size, specially when it is small. the overall sensitivity of separate analysis and dsim, for  <dig> simulated datasets, is shown in figure additional file 1: figure s2c. it can be clearly seen that the separate analysis is more sensitive towards larger number of samples. on the other hand, the overall sensitivity and specificity for dsim is not affected by the sample size differences.

application to breast cancer data
datasets
we apply dsim to two publicly available breast cancer datasets, namely, the tcga dataset and the nki dataset  <cit> . both datasets are very different when considering the platforms, genomic coverage, and the sample sizes used. the tcga data  consist of copy number  for  <dig> locations  and gene expression  for  <dig> probes. in the nki dataset, the arraycgh  data and the gene expression data  have both  <dig>  probes and  <dig> samples.

we considered estrogen receptor  status of the samples as the grouping variable. the tcga dataset consists of  <dig> er-positive samples and  <dig> er-negative, while the nki data consists of  <dig> er-positive and  <dig> er-negative samples. er status is considered an important prognostic and a predictor factor for endocrine response in breast cancer. it has been shown to have strong association with the prognosis of the disease and exhibits strong associations with distinct gene expression patterns  <cit> . this makes estrogen receptor status an interesting grouping variable when studying differential associations in the tcga and nki breast cancer datasets.

separate analysis using sim
we start by simply analyzing the nki and tcga datasets by fitting model  per group, er-positive and er-negative. we report the results through whole genome plots for both groups, while controlling the fdr at 5%. the r package sim was used to perform these analyses. the results from the separate analyses are then compared with the results from the application of dsim to the nki and tcga datasets.

the selected probes for the two groups of samples, obtained from separate analyses of the nki dataset, are shown in additional file 1: figure s <dig>  it can be seen from the figures that a lot of associations present for the larger er-positive  group, are not there for the smaller er-negative  group, for example chromosome arm 1q and chromosome arm 3p. these different results for the groups might be due to sample size difference between the two groups. on the other hand, many associations on chromosome arms 12p and 20p are specific to er-negative group of samples and are not detected for the larger er-positive group. apart from group-specific effects, there are chromosome arms, such as 17q, where separate analyses detects effects in both groups, and chromosome arm 7q, where not many effects are seen for any of the two groups.

similar results can be seen from the separate analysis of tcga dataset also . most of the associations detected for the larger er-positive group are not detected for the smaller er-negative group. analyzing the two groups separately produces two distinct sets of p-values. these p-values are useful when answering questions about group-specific associations between copy number aberration and gene expression levels. however, we cannot say anything about the differences between these association patterns without an additional step of combining these p-values and measuring the error. this makes the separate analyses more complicated and less interpretable when it comes to studying differential association patterns between two groups of samples. in addition, any combination of these two separate analysis results will have power limited by the smallest sample size, which in this case is only a quarter of the size of the biggest groups.

joint analysis using dsim
we now apply dsim on both nki and tcga datasets. since we consider copy number as the dependent data, meinshausen’s procedure is used for multiple testing correction while controlling the significance level at  <dig> .

as described in section ‘methods’, dsim takes all samples together while testing for differential associations, thus, avoiding the loss of power of separate analyses per group. from figure  <dig>  it can be seen that significant probes were identified in partially overlapping regions in the two datasets despite the larger power yielded by the tcga data due to having twice as many samples as the nki data. some examples are chromosome arm 1q, 7q, 12p, and 17q. in the case of chromosome arm 1q, the difference seems to be due to a relatively larger gene dosage affecting gene expression levels in the er-positive group . although the difference in copy number is subtle, it is enough to motivate differential associations. the findings from dsim for chromosome arm 1q are in line with the results obtained from the separate analyses. this suggests that the absence of effects for er-negative group, in contrast with effects for er-positive group, may not be simply due to sample size difference between the two groups.

another chromosome arm in the nki data where separate analyses detect strong association patterns for er-positive group of samples, but very few for er-negative groups of samples, is 3p. however for this chromosome arm, dsim does not detect significant probes for the nki dataset . if we examine the empirical p-value distribution yielded by sim , we note that p-values do not follow a uniform distribution, suggesting that there are associations between copy number and gene expression in both groups. however, due to the smaller sample size in the er-negative group, very few probes are selected at 5% fdr. thus, the differences in significant probes found for er-positive and er-negative group are likely due to lack of power in the smaller er-negative group, in line with the dsim results.

in contrast with 1q, separate analyses of the two groups of samples for chromosome arm 12p identified most of the significant probes in the smaller group of samples with er-negative. when dsim is applied to 12p for nki and tcga datasets, similar regions are identified , confirming the differential association patterns suggested by the separate analyses.some other examples of chromosome arms where separate analyses results correspond with dsim results are 17q and 7q. for 17q, dsim detects significant association differences between the two groups in both datasets . this supports the separate analyses result for 17q where it detects association effects in both groups, though more strongly in the larger er-positive group than in er-negative group. similarly, for chromosome arm 7q, separate analyses results show almost no associations between copy number aberrations and gene expression levels for both groups. correctly, dsim also does not find differences in associations.

a closer look at 11q13
an interesting chromosome region to analyze is 11q <dig>  a recent study shows that the amplification of chromosomal region 11q <dig>  including the ccnd <dig> gene is associated significantly with er-positive breast tumors  <cit> . we analyzed this chromosome region using sim and dsim on the larger tcga dataset to see if copy number driven gene expression differs between er-positive and er-negative groups of samples.

from the additional file 1: figure s <dig>  we can see that separate analysis of er-positive and er-negative group of samples, using sim, suggests differential associations by detecting a lot of associations in the larger er-positive group and no associations in the er-negative group. however, as the er-negative group involves a much smaller sample size than the er-positive group, we cannot be sure that these differences are not due to differences in power. for refining the results further, we reduced the window size to  <dig> mb  so as to focus just on 11q <dig> and re-analyzed the datasets using sim. the raw p-value distributions are shown in additional file 1: figure s8a, where it is evident that the larger er-positive group has strong associations between copy number and gene expression levels. on the other hand, the smaller er-negative group of samples show almost no association between copy number and gene expression. these separate analysis results suggest that 11q <dig> associations are indeed specific to er-positive subtype and hence suggests differential association between er-positive and er-negative group of samples. however, when we analyzed the same region of 11q <dig> using dsim, it detected no significant differential associations between the two groups of samples . this motivated us to explore the datasets the underlying association patterns in more details.

firstly, we fitted a ridge regression between each copy number probe and all gene expression probes in 11q <dig>  we then found that coefficients with the largest ridge estimates tended to be the same for er-positive and er-negative groups of samples, for those copy number probes with significant association with all gene expression probes, as given by sim. secondly, we looked at the sim results for these copy number probes in more detail, by studying the individual  influences of each gene expression probe on the global test. the scatter plot of global test z-scores for er-positive and er-negative groups of samples are shown in additional file 1: figure s <dig> for a chosen copy number probe. from additional file 1: figure s <dig>  we can see that both in er-positive and er-negative groups of samples same probes drive the sim results. from these results, it is evident that gene expression probes with the largest influences are the same, for er-positive and er-negative groups of samples, confirming the ridge regression results. this led us to conclude that er-positive and er-negative groups of samples display the same copy number-led regulation of gene expression on 11q <dig>  in agreement with dsim results. the lack of power due to small sample size is also one of the reasons why sim suggests differential association, whilst dsim does not. however, here similar underlying association patterns in er-positive and er-negative groups of samples lead to dsim not detecting differences in association between groups.

biological interpretation
from the biological viewpoint, it is important to check if the genes detected by dsim are known to be associated with breast cancer and more, importantly, estrogen receptor status. literature review brings up important breast cancer-associated genes located in regions detected by dsim. here we focus on chromosome arm 12p of the nki dataset, where tumors in the er-negative group showed more frequent gains compared with the er-positive group, and several regions of differential association were detected. we selected the five most differentially associated copy number probes on 12p  and for each of those, four gene expression probes were selected based on association priority  and proximity . more information on the selection criterion and the list of copy number probes along with the selected gene expression probes is given in the additional file 1: table s <dig> 

in the first region, from  <dig> to  <dig> mb, one copy number probe was selected, covering a genomic region from  <dig> – <dig>  kb and including the adipor <dig>  cacna2d <dig> and lrtm <dig> genes. the highest associated gene expressions were adipor <dig>  which overlaps with the gene expression probe, rad <dig> and wnk <dig>  which are more upstream, and itfg <dig>  which is more downstream . loss of heterozygosity of rad <dig> is related to breast cancer. however, no link is known between rad <dig> expression and er status. the adiponectin receptor adipor <dig> was found to be expressed in human breast cancer cells  <cit> . its ligand adiponectin, an adipocyte-secreted hormone that plays an important role in diabetes and cardiovascular disease, may also be of importance in the development and progression of several malignancies, including breast cancer  <cit> . a peptide-based adiponectin receptor agonist has been proposed for cancer treatment that restricted proliferation and suppressed growth of human breast cancer xenografts in mice  <cit> . since we found adipor <dig> over expressed due to copy number gain in the er-negative group, these data suggest that er-negative breast cancer may be a potential target for future adiponectin receptor agonist treatment.

in the second region, from 8– <dig> mb, copy number gains were also more frequently found in the er-negative group, and the selected gene expression probes showed positive association with copy number in the er-negative samples . among these genes, three have been described in breast cancer. two embryonic stem cell genes, gdf <dig> and nanog, were shown to be expressed in breast cancer  <cit> . gdf <dig> was upregulated in 4/ <dig> breast cancers compared to paired normal, and downregulated in 12/ <dig>  <cit> , but no information on er status of the studied patients was available. our data suggest that gdf <dig> may be a novel gene whose expression is related to er status.

overexpression of nanog was shown to characterize an embryonic stem cell-like signature in breast cancer, associated with high-grade estrogen receptor negative tumors, often of the basal-like subtype, and with poor clinical outcome  <cit> . our data suggest that the embryonic stem cell-like signature is associated with increased copy number of 12p that is more frequently found in er-negative breast cancer. in the same region, phb <dig> , was positively associated with copy number gain in the er-negative samples . phb <dig> functions as an estrogen receptor -selective coregulator that potentiates the inhibitory activities of anti-estrogens and represses the activity of estrogens  <cit> . while upregulation of phb <dig> might inhibit tumor growth in er-positive tumors, the biological consequences of upregulation in er-negative breast cancer are unknown.

it should be noted that in examples where gene expression probe and copy number probe do not overlap with each other, it is important to check for specious associations. it is possible that the dsim detections are due to co-amplification of copy number probes, for example.

together, these results show that by testing differential copy number-expression associations between relevant groups of tumors, new hypotheses for tumor biology based on underlying genetic aberrations can be generated.

computation time of dsim
in this subsection we show the approximate computation time of dsim. to demonstrate how the computation time is effected by size of the gene sets, we ran dsim on datasets with different number of probes. for all datasets, number of samples in group  <dig> and group  <dig> were  <dig> and  <dig>  respectively. calculation time of dsim is more affected by the size of the gene set  than by the sample size itself. the reason for this is that dsim is fitted per outcome gene. hence, larger the number of genes, higher will be the calculation time. sample sizes  have an effect on the calculation time but it is almost negligible. we ran all analyses using r i <dig>  <dig> . <dig> on an intel core2duo cpu with  <dig>  gb of ram. the run times are given in table  <dig> 

discussion
we proposed a method to compare associations found between two high-dimensional data sets, for two groups of samples. our method models associations between features in one data set and sets of covariates in the other, thus facilitating the search for markers that are related to a set of features.

our method uses all data at the same time in the model, thus being less susceptible to small sample sizes in  one of the groups, compared with separate analysis per group. in addition, we consider associations between probes and gene sets. these characteristics make for a powerful method that finds robust differences in associations.

to the best of our knowledge, we are the first to suggest an integrated analysis method for comparing association patterns between two groups of samples. the most closely related method seems to be the one proposed by artmann et al.  <cit> , as they consider two high-dimensional data sets and a grouping factor. artmann et al.  <cit>  essentially proposed to first look for differential behavior between features in the two groups of samples, per data set separately. subsequently, results are combined via meta-analysis. their proposed method is in the context of microrna and mrna analysis, so their meta-analysis involves connecting micrornas to a set of possible targets. so there is no actual joint analysis of the two data sets, but rather a combination of results of two separate analyses.

our method does not require that features are differentially valued between the two groups of samples. indeed, we argue that this is not necessary and, in our view, not even desirable. we have in fact made sure that dsim results cannot be driven merely by differences on the data distribution of the dependent data between the two sample groups. in our view, such differences in a single data set would not necessarily mean different associations between sample groups, and should not be seen by the method as such either. furthermore, the lack of differential values does not rule out differential associations, so by considering differential values one actually restricts the results too much.

this makes biological sense. let us take for example the setup in the tcga data example. it is entirely possible that dna copy number behaves in the same way, and displays the same distribution, in both er-positive and er-negative groups, and yet are associated differently with gene expression sets in those groups. this could happen due to another molecular mechanism coming into play, say. we feel that an open-minded analysis should be able to pick up those effects.

a unique feature of dsim is that it corrects for the baseline association before looking for differential associations between groups of samples. thus, the association effects common to both groups are eliminated, and only those association patterns left over in the residuals are analyzed. in subsection ‘correcting for the baseline association’, we describe the steps taken by dsim to correct the baseline association while using ridge regression. the rational behind the usage of ridge penalty is that the metric for the global test statistic is the same as that of ridge. therefore, the entire method makes use of the same metric.

the residual effects studied by dsim are relatively small as they are obtained after removing the large association effects during baseline association correction. these effects may weaken further due to overfitting of the ridge penalized model, making them harder to detect. hence, for detecting these weak effects, it is important to minimize the loss of information during baseline association correction. we ensure this by optimizing the tuning parameter λ for ridge penalization using leave-one-out cross-validation. then the leave-one-out cross-validated predictions, corresponding to the selected λ value, are used to get the residuals. unlike the traditional way of using the fitted predictions, we use the cross-validated predictions, as leaving out a sample during cross-validation makes the estimated coefficients unbiased towards that sample. this, in turn, avoids overfitting of the model when predicting the outcome for the left out sample, hence minimizing the loss while obtaining the residuals.

the fact that we test for a large number of copy number probes simultaneously requires choosing an appropriate multiple testing correction method. as the dsim p-values are generated using permutation testing, the traditional methods for controlling fwer like bonferroni, holm or hommel are not very useful. firstly, they are too conservative and secondly, they do not take into account the dependence structure of the data  <cit> . the less stringent fdr control methods such as benjamini-hochberg also do not fully exploit the information concerning dependence in the dataset, hence suffering from loss of power. therefore, we use meinshausen’s multiple testing correction method which not only takes into account the dependence structure of the permuted p-values, but is also more powerful if the effects are small and spread over a larger region . since we consider copy number as dependent data, using meinshausen’s procedure ensures detection of subtle yet significant effects, like in the case of chromosome arm 1q. another method that can also be used is the westfall and young’s multiple testing correction method  <cit> . like meinshausen’s approach, it also takes into account the dependence structure of the data and is useful for working with permuted p-values when gene expression is considered as the dependent data.

in this paper we focus on analyzing copy number regulated gene expression, where the gene sets are defined on the basis of their genomic locations. the method can be easily extended to analyze other types of genomic data and gene sets as well. for example, there could be interest in finding group-specific interaction effects between microrna and mrna expression, while looking at pathway specific genes. it is also possible to invert the model given in  to have copy number as independent data and gene expression as dependent data. however, we should indicate that ridge penalty does not exploit the inherit spatial correlation structure found in natural ordering of the copy number probes. in the case where copy number data is independent data, one possible option would be to use fused lasso penalty instead of ridge.

another interesting extension of this model is to consider more than two groups of samples. the extension involves complex steps as the degrees of freedom goes up from one to ng -  <dig>  where ng is the number of groups. as the association patterns are then compared between more that two groups, the number of interaction terms  in the model increases. one possible way to compare multiple groups is to use the method proposed in this paper for performing pairwise comparison. this problem is beyond the scope of this paper and will be dealt with elsewhere.

our method, dsim, is based on a linear model where we assume that there is a linear relationship between the two genomic datasets. however, we should point out that the non-linear associations present between the datasets may not be detected by dsim. we also assume the the distribution of the errors to be normal. in cases, with non-normal random errors, one can consider transforming the data before using dsim. another assumption made by dsim is in using the global test for testing the null hypothesis h0:θ2 =  <dig>  where θ <dig> is the variance of the distribution for {γk}. the permutation test not only tests for h0:θ2 =  <dig> but also for δ =  <dig>  where δ is the intercept. the correct size of the test is therefore not guaranteed if θ2 =  <dig> but δ≠ <dig>  however, because we use a global test for the null hypothesis h0:θ2 =  <dig> internally in the permutation, it is unlikely that the permutation procedure has any serious power for h0:δ =  <dig>  in practice, dsim is not sensitive to those copy number variations that do not affect gene expression levels.

in summary, we developed a method to test for the copy number and gene expression associations differing between two groups of samples. through several simulation studies, we showed the robustness of dsim under various conditions. application of dsim to the tcga and nki breast cancer datasets highlights the importance of having all samples together in the model.

CONCLUSIONS
we propose a novel method for identifying genes that show different expression regulation between two groups. by using all samples together, it can more objectively and effectively find such differences, compared to separate analyses. it can help elucidate differences in gene expression regulation between two groups of samples due to copy number alterations or other  genetic changes.

availability of supporting data
the data sets supporting the results of this article are available in the labarchives repository .

the r scripts for simulation studies and dsim can be made available upon request.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
nc implemented the method in r, wrote the manuscript and performed the data analysis. this work uses an original idea by rxm, further developed by rxm, jjg, wvw and nc. rxm and jjg supervised the work. jmb helped with biological interpretation of the results. all authors read and approved of the final manuscript.

supplementary material
additional file 1
supplementary material. supplementary document containing details about the simulation study setup, additional figures and tables.

click here for file

 acknowledgements
this work has been supported and funded by netherlands bioinformatics centre.
