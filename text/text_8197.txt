BACKGROUND
a central goal of several international consortia led by the rosbreed project  <cit>  has been to establish high-throughput genotyping platforms for five rosaceous crops: peach, apple, sweet and sour cherry, and strawberry, to facilitate marker-assisted breeding in these economically and nutritionally important crops. this goal has been realized in part through the development of three snp  arrays: a 9 k whole genome scanning array for peach  <cit> , an 8 k apple and 1 k pear array  <cit> , and a 6 k array for cherry  <cit> . these three projects utilized the illumina® infinium® genotyping platform. to date, these arrays have been used for the generation of linkage maps  <cit> , evaluation of the quality of physical maps  <cit> , fine mapping and validation of quantitative trait loci   <cit> , elucidation of marker-trait associations  <cit> , genome-wide association studies  <cit> , genomic selection studies  <cit> , validation of pedigrees and verification of trueness to type of breeding lines and accessions  <cit> , and for design of the future generation of arrays  <cit> . thus, these three arrays have had broad utility for the rosaceae genomics and genetics research and breeding communities.

polyploidy is challenging for snp discovery and genotyping
polyploidy and whole genome duplication have long been recognized as major components of both genome and species evolution  <cit> , and are widely evident in rosaceae genera including fragaria, malus, prunus, and rubus. polyploidy is prevalent in many plant families, and it is estimated that  <dig> to 70% of flowering plants are polyploids  <cit> . in addition to the plethora of examples represented by polyploid complexes, all the sequenced plant genomes previously considered as “diploids”  have revealed superimposed traces of past genome duplication events  <cit> . polyploidization is usually followed by processes of genomic and/or chromosomal diploidization, such as homoeolog loss  <cit> , divergence of homoeolog expression leading to bias that may favor one of the subgenomes  <cit> , and establishment of preferential, bivalent pairing  <cit> .

marker snps are dna sequence variants at orthologous sites within or between individuals. in array development projects, snps are discovered by alignment of sequences from a detection panel to a reference genome. in diploid species projects, such as for sweet cherry and peach, marker snps need only be distinguished from variants at paralogous sites within the diploid genome. however, as reviewed by kaur et al.  <cit> , in allopolyploid plants, paralogy is possible both within and between homoeologous subgenomes, thus complicating the differentiation of marker snps from nuisance paralogous variants. of particular concern and interest in allopolyploids are homoeologous sequence variants , which are variants occurring at corresponding reference coordinates but between, rather than within, subgenomes  <cit> . following kaur et al.  <cit> , hsvs are distinct from type  <dig> and type  <dig> paralogous sequence variants , which occur, respectively, at non-identical reference coordinates within and between subgenomes. to date, high-density marker platforms have been developed for very few polyploid crops: auto-tetraploid potato  <cit> , allo-tetraploid sour cherry  <cit> , rose  <cit> , and oilseed rape  <cit> , as well as the more complex allo-hexaploid wheat  <cit> . to address the challenges of snp detection in polyploids, the scientific communities in some of these important crops have formed international research and development consortia, thereby facilitating the development of a 9 k infinium array in wheat  <cit>  and the 7 k  <cit>  and 60 k infinium arrays  <cit>  in allo-tetraploid oilseed rape.

polyploidy in the cultivated strawberry
the cultivated strawberry, fragaria × ananassa , is an allo-octoploid  species that arose from a chance hybridization in a european botanical garden in the mid-1700s between representatives of the octoploid species f. chiloensis  and f. virginiana   <cit> . an allo-polyploid aaa'a'bbb'b' model comprising four differentiated subgenomes was proposed for the fragaria octoploids by bringhurst  <cit> , and is consistent with reports of full disomic inheritance in marker-based linkage maps  <cit> . however, a definitive model of subgenome composition for the cultivated strawberry and its progenitor species has not yet been established, nor has it been confirmed that a common model would be applicable to all octoploid germplasm. in this study, we adopted the simplifying assumption that the cultivated strawberry genome composition conforms to an allo-polyploid model of four distinct subgenomes: aabbccdd.

early cytogenetic and cross-ability studies and subsequent molecular analyses implicated diploid f. vesca as a likely progenitor and a-subgenome donor to the cultivated strawberry and its octoploid species ancestors, and phylogenetic analyses based on almost complete chloroplast sequences of  <dig> fragaria species and subspecies identified the western north american f. vesca subsp. bracteata as the likely chloroplast genome donor  <cit> . a reference genome sequence of the a-related f. vesca subsp. vesca accession ‘hawaii 4’  has been published  <cit> . diploid fragaria iinumae has been suggested as a second genome donor to the octoploids, based on phylogenetic analyses of low-copy nuclear loci  <cit> , and has been shown to uniquely share a robust mitochondrial marker with the octoploids  <cit> .

snp detection in strawberry
a preliminary attempt to identify snps in strawberry from transcriptome sequences resulted in a low validation rate of 9% in a mendelian transmission test, likely caused by misidentification and coincidence with hsvs  <cit> . to address the predicted challenges of a low rate of validation and difficulties in accurate automated genotyping by existing software programs for analysing array data , the international strawberry consortium developed multiple approaches for snp discovery and array design in strawberry, which are described herein. to simplify genotype scoring and enhance the accuracy of automated genotyping, we have developed standard di-allelic snp and indel-based markers and have assessed the potential of using multi-allelic snps. in addition, we devised an innovative new class of markers called “haplosnps” as the basis for achieving a technical reduction in ploidy and thereby diminishing the problem of cluster compression associated with snp array genotype calling in polyploids. a novel, non-discovery-based snp marker development strategy was also explored. finally, a set of array snps was developed specifically for mapping purposes in the ancestral diploid, f. iinumae. herein is reported the development and preliminary evaluation of the first high-throughput snp genotyping platform for strawberry: a 90 k snp array named istraw <dig>  based on the affymetrix axiom platform.

methods
sequence resources
the genomes of  <dig> octoploid and six diploid strawberry accessions were sequenced to serve as resources for snp discovery and interpretation . the octoploid germplasm global discovery panel  included: 1) a diverse sampling of 15 f. ×ananassa accessions that comprised six cultivars , two breeding selections , six f <dig> progeny  from ‘holiday’ × ‘korona’, and one f <dig> generation progeny plant from ‘dover’ × ‘camarosa’; and 2) one and three accessions respectively of the ancestral octoploids f. virginiana and f. chiloensis . the diploids included three representatives of f. vesca, one of f. mandshurica, and two of f. iinumae . of the latter, accession f1d is an intraspecific hybrid that is being used as a parent in an f. iinumae linkage mapping project .table  <dig> 
strawberry accessions and sequence data used for variant discovery in the respective filtration panels



name
taxon
ncbi srx numbers
total trimmed reads 
mean coverage depth 
gdp
hd-16
hd-20

‘winter dawn’
f. ×ananassa

‘sweet charlie’
f. ×ananassa

‘fenella’
f. ×ananassa

holkor 2321
f. ×ananassa

‘emily’
f. ×ananassa

holkor 2637
1
f. ×ananassa

holkor 2557
f. ×ananassa

holkor 2549
f. ×ananassa

dover × camarosa f
2
_34
2
f. ×ananassa

holkor 2637
3
f. ×ananassa

holkor 2580
f. ×ananassa

‘korona’
f. ×ananassa

holkor 2529
f. ×ananassa

‘holiday’
f. ×ananassa

ca <dig> -601
f. ×ananassa

nh sb480
4
f. ×ananassa

cfra  <dig> 
f. virginiana

cfra 1691
f. chiloensis

cfra 743
f. chiloensis

fc
4
f. chiloensis

cfra  <dig> 
5
f. vesca

cfra  <dig> 
5
f. vesca

cfra  <dig> 
5
f. vesca

cfra 1947
6
f. mandshurica

cfra 1849
6
f. iinumae

f1d
4
f. iinumae

1sequenced at the center for genome research and biocomputing at oregon state university.


2150 bp paired-end sequencing and use of gaiix for sequencing.


3sequenced by illumina inc.


4sequences provided upon request from thomas davis.


5illumina index adaptors were added and samples were pooled in equimolar amounts for sequencing in one lane.


680 bp paired-end sequencing with gaiix.

the octoploid global discovery panel  and f. iinumae f1d sample were used for variant discovery. filtration subpanels consisted of octoploid hd- <dig> and hd- <dig> subpanels described in the methods. total trimmed reads, mean coverage depth and ncbi srx numbers are listed. note that the holkor  <dig> seedling was sequenced twice, and so is listed twice in this table.



validation set
the strawberry accessions chosen to validate usefulness of the array consisted of the following:  <dig> octoploid f. ×ananassa breeding accessions and cultivars ;  <dig> “non-ananassa” octoploid accessions; three widely studied accessions of diploid f. vesca; and a pedigree-connected population of diploid f. iinumae that included crossing parents j <dig> and j <dig>  their first generation hybrid f1d, and 21 second generation ‘f2d’ progeny. the  <dig> octoploid f. ×ananassa samples  encompassed: all members of the gdp, including four replicate samples of ‘korona’ and two of ‘holiday’; one large mapping population of  <dig> offspring ; three small mapping populations ; and founding parents and progeny of public breeding programs in the u.s. including the university of florida, michigan state university, and the usda-ars corvallis programs. the  <dig> “non-ananassa” octoploid accessions included  <dig> parents and progeny from a f. ×ananassa reconstruction population  <cit>  named fvc, and  <dig> individuals of multiple pedigree-connected families from the new hampshire breeding program .table  <dig> 
summary of strawberry samples  evaluated with the array



validation set/category
number of individuals

f. ×ananassa
gdp members
13

university of florida selections
25

cultivars, selections and parents of breeding populations
43

‘holiday’ replicates
1

‘korona’ replicates
3

mapping populations 
74
26
20
40

f.
×
ananassa
octoploid breeding populations 
10
10
10
6
5
10
10

“
non-ananassa
”
octoploid breeding populations 
10
41

f. vesca
cultivars
3

f. iinumae
diploid pedigreed population 
24

total
384


library preparation and sequencing
with the exception of the f. iinumae f1d and holkor  <dig> samples, dna for illumina library preparation was extracted from either fresh or freeze-dried unfolded leaves with the e-z 96® plant dna kit   <cit>  and quantified with the quant-it™ picogreen® assay  using a victor multiplate reader . the f1d dna was isolated using a ctab miniprep method  <cit> . the holkor dna was isolated as previously described  <cit> . with the exception of holkor  <dig>  library preparations were performed with either the illumina’s truseq dna v <dig> kit  or using a modified version of illumina’s paired-end protocol and non-illumina enzymes, primers and adaptors . holkor  <dig> library preparation and sequencing were performed by illumina, inc. library preparation for each strawberry sample is described in additional file  <dig>  the sequence data are deposited in the ncbi sequence read archive  as bioproject prjna <dig> with sra experiment accession  numbers as listed in table  <dig> 

sequence alignment
a variant call format  file was generated from each of the illumina short read data sets listed in table  <dig>  the fastx_barcode_splitter.pl script from the fastx_toolkit  was used to separate reads in multiplexed f. vesca accessions . adaptor sequences and low-quality ends were removed from the raw reads using cutadapt with filtering set at a phred compatible score of  <dig> and a minimum length of  <dig> to keep the read  <cit> . the burrows-wheeler aligner , with default arguments  <cit> , was used to align the resulting reads to the f. vesca ‘hawaii 4’ v <dig>  reference genome  <cit> . the bwa aln command was used with both forward and reverse reads from each panel member to produce separate forward and reverse sequence alignment index  files. the bwa sampe command was used to incorporate the .sai files into sequence alignment maps  for paired-end reads. the samse command was used for incorporating reads with a missing mate-pair. the sequence alignment map  files were then converted into binary alignment map  files using the samtools view command. the bam files were sorted using the samtools sort command, then indexed with the samtools index command. duplicate reads that had been generated during library preparation as an artifact of the pcr enrichment process were removed using the samtools rmdups command  <cit> . the bam files were reformatted using the picard-tools reheader command, then subjected to local realignment around indel sites using the genome analysis toolkit gatk  <cit>  to remedy alignment issues associated with small indel polymorphisms occurring near the beginnings and/or ends of the short reads. from the resulting “improved” bam files, read depth per coordinate was calculated for each accession in the discovery panel using the samtools depth command, and mean coverage depth per accession was calculated from the resulting coverage files . variant calling was achieved using freebayes  to produce vcf files, one for each of the sequenced accessions. the original illumina sequences and resulting alignment files in bam format are available .

variant discovery and filtration panels
variant discovery was conducted separately in the octoploid germplasm panel versus in diploid f. iinumae hybrid f1d. for variant discovery at the octoploid level, the vcf files from all members of the gdp were employed. as noted in additional file  <dig>  holkor  <dig> was sequenced twice and was therefore represented by two vcf files, so the gdp of  <dig> octoploid accessions was represented by  <dig> vcf files. for subsequent filtration procedures, two gdp subpanels were defined. the hd- <dig> subpanel consisted of the ten data sets with a minimum of 16× genome coverage , and as such included both of the holkor  <dig> samples. the hd- <dig> subpanel consisted of the eight data sets with a minimum of 20× coverage , and therefore excluded the lower-coverage holkor  <dig> sample.

variant filtering in octoploids
the gdp vcf files were entered into various filtering pipelines  aimed at discovering marker candidates of several types: di-allelic snps , multi-allelic snps  , di-allelic indels , and three categories of haplosnps . the term “haplosnp” denotes the coupling of two variants:  a marker snp and  a closely adjacent hsv snp or indel that provides a critical “destabilization site”, which is intended to confer subgenomic exclusivity and thereby achieve technical ploidy reduction at the respective site of probe hybridization.figure  <dig> 
allelic configurations of snp  and indel markers in an octoploid. panel a) di-allelic snps: to qualify as di-allelic, only two alleles can be detected at the site. the “marker allele” is present only in one subgenome , within which it can be homozygous present, heterozygous, or homozygous absent. in case  <dig> a single probe can be used to interrogate the marker because the indicated polymorphism is neither a/t nor g/c. in case  <dig> two probes must be used because the indicated polymorphism is an a/t . panels b and c) multi-allelic snps: more than two alleles are represented at the site. three distinctive cases are shown for tri-allelic  and for tetra-allelic sites . in tri-allelic case  <dig> the marker polymorphism is g/t, while there is a c at the same site in the background subgenomes. genotyping of this marker would require two probes. in case  <dig> the marker polymorphism is g/t, with a background g in one subgenome and a background c in the others. genotyping of this marker would require two probes. in case  <dig> there are two marker polymorphisms, a g/t in one subgenome and a g/c in another, while there is a c at the site in the background subgenomes. three probes and a non-standard analysis algorithm are needed for this polymorphism. genotyping of case  <dig> tri-allelic markers, and of tetra-allelic markers  is currently not possible. panel d) di-allelic indels: only two alleles are represented at the site. although they are genomic insertions and deletions, the indel polymorphisms are genotyped as snps, and various probing strategies may be employed depending upon the sequence characteristics within and immediately adjacent to the indel.
representation of the three haplosnp categories consisting of snp-snp , indel-snp , and snp-in-insertion . a) in the snp-snp  and indel-snp  strategies the “critical form” of the destabilizing site, to which the probe is targeted, must be coupled to the snp marker allele. due to its asymmetric nature, a snp-snp or indel-snp site can be probed only on one strand. a single probe is employed if the marker polymorphism is not a/t or g/c, while two probes are required if it is a/t or g/c. in the snp-snp strategy, the destabilizing snp site must be present within  <dig> bp of the marker snp site, while in the indel-snp strategy, the destabilizing indel site must be present within  <dig> bp of the marker snp site. in relation to the background alleles, the critical form of an indel destabilization site  can be either an insertion or a deletion. in the snp-in-insertion  strategy, the probe is expected to anneal only to the insertional form of an indel, and to interrogate a snp polymorphism that resides within the insertion in one subgenome. a snp-in-insertion site can be probed on either or both strands.



key filters or filtration steps that were included in more than one pipeline are described as follows and exemplified in additional files  <dig>   <dig>   <dig>   <dig>   <dig>   <dig> and  <dig>  in-house python scripts were written to implement the various filtration pipelines. the minimum variant read count filter excluded variants that occurred in less than three  or two  reads when summed across all gdp vcf files. its purpose was to remove variants likely due to sequencing errors. the minimum presence filter excluded snp variants not represented in at least two members of the indicated germplasm panel  or subpanel , while the minimum absence filter excluded snp or indel variants not absent in at least two members of the indicated germplasm panel  or subpanel . in combination, the minimum presence and absence filters were intended to ensure that identified variants were polymorphic among germplasm panel members and therefore would constitute markers rather than hsvs.

the a/t-g/c filter was used to exclude a/t and g/c variants in the di-allelic snp and codon-based pipelines, on the basis that such variants require the use of multiple probes in the axiom platform. the cds or genic filters were employed to exclude variants that were not located in coding sequence or in coding plus intron sequence, respectively, as determined by gene models for the f. vesca v.  <dig>  reference genome  <cit> . the marker candidates identified as residing on ‘hawaii 4’ linkage group  <dig> , were ultimately excluded from consideration because they could not be subjected to cds confirmation.

the upsafe-downsafe filters were used to assure that the regions immediately upstream  or downstream , or both upstream and downstream , of a marker variant were free of any other variants across the gdp. this filtration step was intended to maximize the likelihood that probe sites were conserved across diverse germplasm.

di-allelic and multi-allelic snp  candidates and di-allelic indel candidates were identified as described in additional files  <dig>   <dig>  and  <dig>  respectively. the di-allelic snp and msnp pipelines identified candidate sites lacking polymorphisms within 24 bp upstream and downstream of the variant site, while in the di-allelic indel pipeline the upstream and downstream exclusion intervals were 24 bp and 30 bp, respectively; the extra 6 bp being added downstream because the 3–6 bp size of the candidate indels contributed to the nominal downstream distance from the candidate coordinate site.

haplosnp strategies and filters
as defined above and depicted in figure  <dig>  ploidy-reducing haplosnps consist of two closely coupled or overlapping variant sites: a marker site and a “destabilization site”. the marker site is the site of the snp variant that is to be genotyped and is intended to be polymorphic within a single subgenome. the “destabilization site” is defined as the site of a snp  or indel  identified as polymorphic among subgenomes , and non-polymorphic within the subgenome containing the marker variant. the marker snp site is intended to be interrogated by a probe that targets the “critical” form of the hsv: i.e., the form that is coupled with the marker variant. thus, the probe is expected to hybridize to the subgenome that contains the marker variant , but fail to hybridize to one or more of the subgenomes that lack the marker variant . for each of the three haplosnp categories, the degree of achieved ploidy reduction depends on whether the critical form of the target site occurs in only one , two , or three  subgenomes.

within the haplosnp category, three strategies were explored, each requiring a distinct filtration pipeline. in the snp-snp strategy , the destabilizing hsv was a snp residing within 6 bp of the marker variant site . in the indel-snp strategy , the destabilizing hsv was a 4-to-6 bp indel residing within 14 bp of the marker variant site . in the snp-in-insertion strategy , the hsv was an insertion  of 3–6 bp which contained within it the marker snp site . in each of the three haplosnp strategies, no variant other than the destabilizing hsv was permitted within the 24 bp region delimited by the marker snp site and containing the destabilization site.

in each of the three haplosnp pipelines, the set of ~ <dig> million variants was initially mined for sites that could serve as critical destabilization sites, after which the pipeline proceeded to the identification of neighbouring marker snp candidates. the remaining pipeline steps were aimed at identifying suitable pairings of marker snp and destabilization site candidates, and confirming that all instances of the marker snp were coupled to the targeted form of the destabilization site.

variant discovery in diploid f. iinumae
for diploid f. iinumae, variants were initially discovered by specifically mining the f. iinumae f1d vcf file . snps were sought that were heterozygous in f1d and would therefore be expected to segregate in the derived f2d mapping population. many of the filtration procedures used in di-allelic snp discovery in the octoploid gdp were also employed for snp discovery in f1d as described in additional file  <dig>  importantly, in the discovery of f1d snps, the upsafe-downsafe filter employed all of the octoploid gdp vcfs as well as the f1d vcf to maximize the likelihood that f1d-based probe sites would also be conserved in octoploid germplasm.

non-discovery-based approach
finally, a novel, non-discovery-based approach was explored, and is referred to as the “codon-based” approach. here, coding sequences  that were widely distributed across the seven ‘hawaii 4’ linkage groups, as determined from gene models for the f. vesca v <dig>  reference genome  <cit> , were mined for proline codons. probes were then designed to interrogate the third positions of these 4-fold degenerate codons without regard to or reliance on prior variant discovery. these codon-based snp candidates were purely speculative, and were included in our study to test the hypothesis that snps could be discovered in useful numbers through the array genotyping process itself without relying on extensive, prior sequencing of germplasm panels.

affymetrix filtering and axiom array design and construction
for each marker type, a list of candidate sites was submitted to affymetrix for further distillation into a final set of sites that met quality criteria for representation on the array. then, depending upon the marker category, the nature of the polymorphism and other criteria as detailed below, an appropriate probing strategy was defined for each site, utilizing from one to eight distinct probe sequences on the array.

candidate markers were chosen for array inclusion in the following order of priority:  markers expected to provide ploidy reduction, including msnps and haplosnps,  markers from the remaining categories identified from the octoploid vcfs ,  f1d snps, and  codon-based snps that met the threshold criteria for predicting reproducibility of markers based on affymetrix’ in silico design scores.

to prioritize probe sets for polymorphisms, the flanking sequences of each candidate marker site were analyzed by the affymetrix bioinformatics team for the following characteristics:existence of other polymorphisms within  <dig> bases that align with sequence adjacent to the targeted polymorphism site. probe design was classified as: “not recommended” when one or more polymorphisms were found within  <dig> bases, or more than  <dig> polymorphisms within  <dig> bases; “neutral” when one or two polymorphisms were found between  <dig> and  <dig> bases, and; “recommended” if no polymorphisms were found. in contrast to the previously applied upsafe/downsafe filters, which utilized comparisons of illumina reads aligned to the reference genome, the affymetrix filter relied on comparisons among the flanking sequences of the submitted marker candidates and was intended to preclude interrogation of paralogous marker sites.

high sequence similarity to the rest of the genome as measured by a count of all of the 16-mer substrings of the probe found in the genome. probe design was classified as: “not recommended” when more than  <dig> matches of 16-mers were found in the genome.

predicted probe quality based on a random forest model trained on the performance of  <dig>  human snps. probe design was classified as: “not recommended” for a score below  <dig> ; “neutral” if the score was between  <dig>  and  <dig> , and “recommended” if the score exceeded  <dig> .



for the standard  snps and indels, including f1d and codon-based snps, only recommended probes were used. for the remaining snp categories , recommended and neutral probes were included in order to fully populate the array. multi-allelic single-site polymorphisms were interrogated by designing all four bases at that position.

the array was built using the axiom mydesign™ custom genotyping platform. markers were designed with two replicates on either the forward or reverse strand. in a subset of the polymorphisms from most snp categories except for snp-snps and indel-snps, both strands were tiled, given they passed the reproducibility threshold. the resulting design included  <dig>  polymorphisms from the octoploid genome, along with  <dig>  target sites from the diploid f. iinumae genome, and  <dig>  speculative  sites . the a/c, a/g, c/t and g/t polymorphisms were interrogated with two replicates with a single probe while a/t and c/g snps were interrogated with two replicates each of two different probes. the msnps were interrogated with two replicates of four distinct probes. the total number of target sites of  <dig>  was interrogated with  <dig>  probesets . after accounting for all of the replicated probes the total number of 6-micron square features on the chip dedicated to strawberry polymorphisms was  <dig> .table  <dig> 
variants from each category submitted to affymetrix, classified by affymetrix, and tiled on the final array


snp
msnp
indel
snp-snp
indel-snp
snp-in-insertion
f1d
codon-based

submitted candidates
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 

affymetrix classification

recommended 
 <dig> 
380
 <dig> 
433
487
 <dig> 
 <dig> 

recommended 
 <dig> 
359
 <dig> 
541
 <dig> 
 <dig> 
 <dig> 

recommended 
 <dig> 
470
296
 <dig> 
 <dig> 

neutral 
815
170
 <dig> 
464
125
355
 <dig> 
939

neutral 
834
147
 <dig> 
589
107
216
 <dig> 
886

neutral 
 <dig> 
476
 <dig> 
41
109
 <dig> 

tiled on array

no. of target sites
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 

no of probesets
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
filtered candidates from each variant category were classified by the affymetrix’ in silico design scores into ‘recommended’ and ‘neutral’ in the forward  strand, in the reverse  strand, and in both forward and reverse  strands. a ‘not-recommended’ class is not listed here as none of the candidates in this category were tiled on the array. also listed are the number of markers or polymorphisms tiled on the array and the corresponding number of probe sets .



genotyping in octoploid strawberry
dna was isolated and quantified as described above for the octoploid strawberry validation set . up to 50 μl of dna  from each sample was submitted to affymetrix for genotyping. the axiom assay was performed on four 96-sample axiom arrays using the affymetrix genetitan® system according to the procedure described by affymetrix . next, cell intensity files  generated by the genetitan instrument were converted to genotype calls using the axiom genotyping algorithm version  <dig>  available through affymetrix power tools or genotyping console™v <dig>  software package. the procedure is documented by affymetrix . executing the axiom best practices genotyping workflow, snps sorted into six quality classes according to their clustering performance with respect to various quality-control measures . these snp classes were:  “poly high resolution” , which were polymorphic and passed all quality control ;  “no minor homozygote” , which passed all qc but only two clusters were observed;  “off-target variant” , which had an additional low intensity cluster resulting from slight mismatches between the probe and the sequences for that group of individuals;  “mono high resolution” ,which passed all qc but were monomorphic;  “callrate below threshold” , where genotype call rate was under 97%; and  “other”, where the resultant snp cluster pattern did not fall into any of the previous classes. snps that fell into the otv class were further genotyped using otv caller, a statistical method developed by affymetrix and included in the “snpolisher” r package to identify samples that were homozygous for a null-allele.figure  <dig> 
six snp quality classes  and four variance filters  applied to the
phr
genotype class. a. default snp quality classes produced by the axiom best practices genotyping workflow. b. an example cluster plot for a snp identified with each of the four variance filters used including: ab.vary identified large heterozygous cluster variance in the y dimension; aa.vary for homozygous  variance in the y dimension; bb.vary, for homozygous  variance in the y dimension; and ab.varx, for heterozygous variance in the x dimension.



cluster plot characterization
the homozygous ratio offset  is a measure that allows automated discrimination between snps that display a diploid-like cluster  as opposed to a polyploid-like cluster . it measures the displacement from  <dig> contrast of the homozygous cluster closest to that value. from simulation results, snps in a diploid organism are expected to have a positive homro value and snps in a polyploid organism to have a negative  homro value. based on simulation, we used a homro value ≥ <dig>  to classify snps as clustering like a diploid, and a homro value < <dig>  to classify snps clustering like a polyploid.figure  <dig> 
apparent polyploid levels based on comparing simulated to observed cluster locations. points for plots in upper row are the simulated cluster center locations for the given genotype where a =  + background_intensity and b =  + background_intensity. intensity_per_a_allele = intensity_per_b_allele = background_intensity =  <dig>  the #a_alleles and #b_alleles are the counts of each allele in the given genotype. points for plots in lower row are the observed contrast vs size values for each sample. each column in 4a, 4b, and 4c is a snp locus at a different polyploid level. an “x” is drawn over subgenome genotypes to indicate effective absence. a vertical bar is drawn at contrast = zero. a: the 2x/diploid-like cluster pattern. alleles segregate in one subgenome and are effectively absent in the other three subgenomes. the ab cluster is centered ~ contrast = zero and the homozygous bb and aa genotype clusters have negative and positive contrast values, respectively, in the simulated and observed cluster patterns. b: the 4x/allo-tetraploid-like cluster pattern. alleles segregate in one subgenome, are fixed in another subgenome, and are effectively absent in the other two subgenomes. one of the genotype clusters aabb, is centered near contrast = zero and the other two genotype clusters are offset to negative contrast values in both the simulated and observed cluster patterns, and correspond to one subgenome being fixed for the b-allele. c: the 8x/allo-octoploid-like pattern. alleles segregate in one subgenome, and are fixed in at least two other subgenomes. simulation is shown for allo-octoploid genotypes, where alleles segregate in one subgenome and three other subgenomes are present and fixed for the same allele. the pattern is the same as that for the 4x locus, except that all genotype clusters are offset to the positive  or negative  contrast values.



to examine the basis for diploid-like clustering as observed in ~30% of the di-allelic snps, we examined the relationship between clustering pattern and genomic read depth. first, we extracted read depth information from the bam files and compiled corresponding lists of mean read depths for each of the  <dig>  genes defined by the gene models for the f. vesca ‘hawaii 4’ v <dig>  reference genome  <cit> . the mean read depth of each gene was the average of the read depths at each nucleotide coordinate within that gene. the frequency  of each mean read depth category  was then plotted for each of the hd- <dig> octoploids.

genotyping in diploid strawberry
the axiom assay was used initially to process all  <dig> diploid strawberry samples, and these samples were genotyped with the axiomgt <dig> algorithm. all samples passed qc. as with the analysis of octoploid samples, the snpolisher software was used to classify the snps into six quality classes according to their clustering performance. however, for these samples, the default diploid settings were used. subsequently, the three f. vesca samples were excluded from the analysis, and genotype calling was repeated using only the 24 f. iinumae samples.

inheritance-based snp validation
genotyping accuracy of snps was estimated based on the proportion of snps that generated concordant genotype calls between parents and offspring using microsoft® excel, after excluding snps that had a missing genotype call in one or both parents in three biparentally derived populations: octoploids ‘holiday’ × ‘korona’ and its 79 f <dig> progeny , and ‘capitola’ × cf <dig> and its 20 f <dig> progeny ; and diploid  j17 × j <dig>  f1d, and its 21 f <dig> progeny .

linkage mapping of phr, nmh and otv snps in the ‘holiday’ × ‘korona’ population
snps were chosen that were polymorphic in at least one of the two parents of the mapping population, or, in case of otv snps, that showed clear segregation in this mapping population despite monomorphic genotypes in both parents. otv snps were hypothesized to be tri-allelic within a common subgenome, having a so-called null allele that did not show probe extension with labelled nucleotides in addition to the usual two alleles from the originally targeted polymorphism between the true nucleotides. such null alleles are thought to represent deletions  or to be due to additional snp at the probe site that hamper probe hybridization. parental genotypes and progeny genotypes were deduced from their initial calls and from the marker segregation pattern. for instance, an aa × bb snp that gave four cluster classes  was reclassified as an a∅ × b∅ snp that gave a∅, ab, b∅ and ∅∅ progeny genotypes.

to facilitate mapping efforts, markers were discarded that gave “nocall” or that showed non-concordant genotype calls between parents and offspring for more than 5% of the progeny.

when non-concordant calls occurred for less than 5% of the progeny, such calls were assumed to be caused by inadequate genotype designation of some individual progeny samples rather than inadequate genotyping of the parents, and were converted to missing values. integrated genetic linkage maps were constructed using the software joinmap  <dig>   <cit>  with the multipoint maximum likelihood mapping algorithm approach for cross pollinators  <cit>  and the haldane mapping function using all preset default settings for the calculation options. for linkage group 6d , quality of genotype calls and of the presented maps was evaluated through a graphical genotyping approach  <cit>  using excel. single data points causing double recombination events were checked by examination of the corresponding cluster plots.

linkage groups were identified by integration of the ssr data of van dijk et al.  <cit>  with the current snp data. once the snp markers were grouped according to linkage groups, these ssr data were excluded from the generation of linkage maps in order to avoid issues of data consistency that may easily arise among markers from different experiments and genotyping platforms. linkage groups were named according to van dijk et al.  <cit> : chromosome numbers followed the physical map of the diploid f. vesca ‘hawaii 4’  <cit>  and subgenomes a to d were distinguished based on decreasing similarity to f. vesca genomic sequences as revealed by decreasing amplification efficiency of f. vesca-based ssr markers  <cit> .

inheritance-based snp validation in the f. iinumae f2d population
genotype calls were obtained for the two crossing parents , for f <dig> progeny plant f1d, and for  <dig> individuals of the derived f <dig> population . to be employed for mapping in the f2d population, snps that displayed segregation in the f2d population also had to be heterozygous in f1d, and the j <dig> and j <dig> parents could not share the same homozygous genotype. a genetic linkage map was constructed using the software joinmap  <dig>   <cit>  following the same procedures described above for ‘holiday’ × ‘korona’.

sequence-based snp validation
sequences of the shotgun genomic reads for each of the individuals in the octoploid, hd- <dig> subset, except for holkor  <dig> , were compared to genotype calls obtained only from the  <dig>  di-allelic snp markers classified as phr. the genotype call rate was <97% in holkor  <dig> and genotype information was thus not available for analyses. sequence-derived genotypes were only called when a minimum of  <dig> reads were present at the snp site. for each snp, the sequence-derived genotype was compared to the axiom array-derived genotype when the latter was homozygous for either allele or if it was heterozygous; it was ignored when “nocall” or null genotypes were obtained. to resolve homozygosity of snps with very few counts for the minor allele, a binomial test was performed where the null hypothesis was an expected minor allele frequency ≥1/ <dig>  . an alpha value threshold of  <dig>  was used to assign a homozygous  or heterozygous genotype  at a snp position.

analyses of snp data
minor allele frequency  was calculated in  <dig> strawberry cultivars representing breeding selections and founders from europe and across u.s. breeding programs in florida, eastern u.s., california and the pacific northwest  with an r script available in plantbreeding r software  <cit> . distribution of snps was also drawn with plantbreeding r  <cit>  by minor allele frequency according to physical location on the f. vesca ‘hawaii 4’ v <dig>  reference genome in  <dig> diverse strawberry accessions .

RESULTS
snp discovery
after eliminating duplicate reads generated during the pcr enrichment of the libraries, mean depth of genome sequence coverage among the octoploids ranged from a low of 2× in f. virginiana cfra  <dig>  to a high of  <dig> × in ‘winter dawn’ . upon visual examination of read alignments using integrated genome viewer   <cit> , numerous instances of misalignment were observed at the ends of reads, especially in the presence of repetitive motifs. implementation of gatk  <cit>  for correction of local misalignment was effective in correcting such misalignments, and resulted in the elimination of numerous artifactual variants while increasing the read counts of some actual variants.

from the  <dig> octoploid vcf files, a total of  <dig> , <dig> unique variants distributed over  <dig> , <dig> coordinate sites in the ‘hawaii 4’  reference genome were discovered. the number of variants exceeded the number of sites because multiple variants could exist at any given site. as reported in the vcf files, these variants were of three basic types relative to the reference: snp , ins , and del . beginning with the input information of the  <dig> , <dig> variants and their respective genomic coordinates , outputs were generated from the various filter pipelines, as described below and in table  <dig> 

di-allelic snp pipeline 
a total of  <dig>  di-allelic snp candidate sites was identified, and submitted to affymetrix. of these,  <dig>  were classified as either recommended for only the forward or reverse strand  or for both strands  . in total,  <dig>   di-allelic snps were chosen for inclusion on the array . given that these candidate snps passed the a/t-g/c exclusion, each could be genotyped using a single probe. however, for  <dig>  of the  <dig>  bothsafe candidates, we elected to “tile”  both forward and reverse strands, necessitating the use of two probes. tiling probe-sets on both strands as opposed to one strand substantially reduced the proportion of markers that did not work, as estimated from the lower proportion of snps classified into “other” , and “crbt” , as well as the higher proportion of markers that were converted into phr  .

multi-allelic snp pipeline 
a total of  <dig>  potentially suitable msnp sites comprising  <dig>  tri-allelic and  <dig> tetra-allelic sites were identified for submission to affymetrix. a total of  <dig>  sites were suitable for tiling on both strands, each requiring eight distinct probe sequences, while  <dig> were chosen for tiling on one strand, each requiring four distinct probe sequences. thus,  <dig>  msnp sites were represented on the array , using a total of  <dig>  distinct probe sequences for a total of  <dig>  probesets .

di-allelic indel pipeline 
a total of  <dig>  indel sites were discovered. of these,  <dig>  passed the affymetrix quality criteria, enabling tiling on one or both strands. in total,  <dig>  indel sites were represented on the array . probes were designed on both strands for  <dig>  of these sites, and  <dig>  sites contained a/t or g/c sites that required two allele-specific probes per site, for a total of  <dig>  distinct probe sequences interrogated by  <dig>  probesets .

haplosnp pipelines 
variants qualifying as marker snp candidates in the haplosnp pipelines were required to be present in at least two germplasm panel members and absent in at least two others, upon which basis they were considered likely to be true marker snps and not hsvs. in contrast, the “critical” hsv candidates were required to be present in all panel members, upon which basis they were considered likely to be true hsvs and not marker variants. for the snp-snp category, the pipeline produced  <dig>  candidate sites, of which  <dig>  were included in the array using  <dig>  probes . for the indel-snp category, the pipeline produced  <dig>  candidate sites, of which  <dig>  were included in the array using  <dig>  probes. for the snp-in-insertion category, the pipeline produced a total of  <dig>  candidate sites, of which  <dig>  were included in the array using  <dig>  probes .

diploid  snp discovery 
mean read depth in the f. iinumae vcf file was 36× . a total of  <dig> , <dig> variants were identified in comparison to the ‘hawaii 4’ reference genome, and  <dig>  snps passed the filtering criteria. of the  <dig>  included on the array ,  <dig>  were tiled on a single strand, and  <dig> were tiled on both strands . the f1d probe sites were chosen to be widely distributed across the seven linkage groups defined by the ‘hawaii 4’ genome and to exclude duplication of octoploid-derived and codon-based probes sites.

codon-based snps
a total of  <dig>  proline codons were identified at sites that qualified as bothsafe in relation to the gdp. of the  <dig>  included on the array,  <dig>  were tiled on a single strand and  <dig> were tiled on both strands. the  <dig>  marker sites  were chosen to be widely distributed across the seven linkage groups defined by the ‘hawaii 4’ genome, and to exclude duplication of discovered  snp sites.

snp genotyping in octoploid strawberry
the goal of the axiom best practices genotyping workflow and snp quality control procedures is to identify snps whose microarray intensities form three well resolved genotyping clusters for two segregating alleles from a single locus in a single subgenome. the genotyping algorithm  automatically assigns genotypes to the samples in such clusters . the position of these clusters is expected to vary with the number of non-segregating subgenomes that are targeted in addition to the segregating subgenome. this behavior is consistent with the differing reduction of the polyploid levels at these loci . however, the genotyping algorithm was designed to dynamically adapt to such variation in cluster locations.

the first attempt at genotyping the polyploid samples included the 306 f. ×ananassa samples and  <dig> octoploid “non-ananassa” accessions . for some snps, adequate genotyping was hampered due to the inclusion of different octoploid species, which caused samples to form more than three intensity clusters . snps with such complex cluster groups resulted in a higher error rate of automated assignments of genotypes to clusters. in addition, samples whose intensities fell between the three prototypical clusters were more likely to have miscalled genotypes. while procedures and filter thresholds proposed by affymetrix adequately identified snps with complex cluster patterns in diploid species, they needed to be extended for use with allo-polyploid species. therefore, a second attempt was performed using advanced approaches to identify such snps and samples and filter them appropriately.figure  <dig> 
effect of excluding  <dig> “non-ananassa” octoploid accessions from genotyping co-cluster runs for two snps. the cluster plots in the left column are for  <dig> strawberry samples. the cluster plots in the right column are for  <dig> strawberry samples, excluding the non-ananassa samples . snp a is a robust diploid-like snp site that produces only three genotype clusters in the presence as well in the absence of the wild progenitor samples, and thus is genotyped correctly in both circumstances. snp b is a more challenging snp site at which the genomes of the divergent non-ananassa form a 4th genotype cluster . this 4th cluster causes the samples in the bb homozygous genotype cluster to be incorrectly called as heterozygous . when the non-ananassa samples are excluded , the software correctly calls the samples in the homozygous bb cluster as “bb” .



three steps were taken to further analyze snps whose intensities formed only three well resolved genotype clusters typified by the phr class, as these snp were thought to have the best prospects for application across highly diverse germplasm. these steps were also aimed at excluding samples whose intensities fell between the prototypical clusters.

step  <dig> only co-cluster f. ×ananassa accessions
as compared with the f. ×ananassa samples, the  <dig> octoploid “non-ananassa” samples tended to cluster more often in their own intensity space, and so their inclusion produced more than three intensity clusters for some snps . therefore, only the 306 f. ×ananassa samples were analyzed as a batch with the best practices genotyping workflow. two hundred and eighty four of these samples passed all sample qc filters  and were co-clustered by the axiomgt <dig> algorithm to produce genotype calls .

step  <dig> execute axiom best practices genotyping workflow
the axiom best practices genotyping workflow sorted snps into the six quality classes as described in the methods . three of the six classes generated accurate genotypes and deserved further validation: phr, nmh and otv classes. the remaining three snp classes were either not informative  or had intensity clusters that were too complex to fit a simple three-state genotype model  .table  <dig> 
number of snps in six classes after applying reproducibility, variance and nminorhom filters



snp class
no. of snps
no. of snps in category
snp
msnp
indel
snp-snp
indel-snp
snp-in-insertion
f1d
codon-based

mhr

crbt

other

nmh

otv

phr

filtered
phr

no of markers on array
these snp classes were: mhr , which passed all qc but were monomorphic; crbt , where genotype call rate was under 97%; other, where the resultant snp cluster pattern did not fall into any of the other classes; nmh , which passed all qc but only two clusters were observed; otv , which had an additional low intensity cluster resulting from mismatches between the probe and the sequences for that group of individuals; and phr  which were polymorphic and passed all qc. phr snps were subjected to additional filters .



while phr snps indicated high quality because they had three well-distinguished clusters, many snps in the nmh class were also of high quality. lack of one of the classes may have a clear genetic reason, such as limited representation of genetic variation within the examined germplasm, low frequency of the minor allele for the snp, or snp localization in a recently introgressed region or linked to a gametophytic incompatibility locus or a recessive gene with deleterious effects. the otv class contained snps for which some individuals fell in a subcluster with lower hybridization signal and that can be genotyped as homozygous for a so-called null allele. otv caller was used to further genotype  <dig>  otv snps, which resulted in  <dig> in the otv-phr class, one as nmh,  <dig> snps that were classified as crbt, and  <dig> in other. for the otv-phr snps, homozygous null genotypes  were assigned to the individuals in the low hybridization zone or otv cluster.

even with the exclusion of the  <dig> octoploid “non-ananassa” samples, strawberry samples formed complex cluster groups for many snps, and not all such snps were excluded from the default phr class. therefore, the  <dig>  k default phr snps were subjected to six additional filters developed or optimized for the strawberry data . these filters included:a reproducibility filter that required 100% reproducibility of technical replicates, thus removing snps with potentially higher error rates due to various sources.

four variance filters that specifically targeted snps with more than three genotype clusters .

an nminorhom filter that excluded snps with less than n samples of called minor homozygous genotypes. a threshold of  <dig> was used, which excluded snps for which less than three samples clustered in their own intensity space. such small sample sets may be true clusters but may also be an additional cluster causing the true aa, ab, and bb genotype clusters to be fused and miscalled.



this advanced filtering decreased the number of snps in the phr class from  <dig>  k to  <dig>  k  and greatly increased the quality of the snps based on visual examination.

step  <dig>  increase the stringency of sample calling
steps  <dig> and  <dig> are effective in identifying snps with three potentially well resolved genotype clusters. however, the error rate, due to individual samples falling between clusters or being located at cluster junctions, is likely to be higher at higher ploidy levels  . to address this problem, the stringency of sample calling was increased so that in a final step, such samples in the phr snps were set to “nocall” . the axiomgt <dig> algorithm uses a confidence score of  <dig> – p, where x is the assigned genotype call. for strawberry, the default setting of  <dig>  was replaced by  <dig>  for the genotype calls used in linkage mapping and data analyses.

genotyping success
the conversion rates of snps into the phr and filtered phr classes was considered a measure of genotyping success. prior to advanced filtering, the phr, nmh, and otv classes comprised 25%, 38%, and 1%, respectively, of array snps . after implementing the additional filters described above, 13% of the 95 k snps interrogated on the array fell into the phr class, resulting in  <dig>  “filtered” phr snps . a large variation was observed in the proportion of snps that fell into this class based on the snp category and haplosnp marker type . conversion into filtered phr snps was  <dig> % for the standard di-allelic snps, and averaged  <dig> % for indels, and 20% for haplosnps. conversion rate was highest in the snp-snp approach  and lowest in the snp-in-insertion category  .figure  <dig> 
proportion of 90k array markers classified into each of the six classes by “snpolisher”.

conversion rate of each snp category into the
phr
and filtered
phr
class of markers. snp categories consisted of: standard di-allelic snps; multi-allelic snps ; indels; reduced ploidy haplosnps, including snp-snp, indel-snp, and snp-in-insertion ; f. iinumae f1d snps; and speculative codon-based snps.



conversion rate of f1d snps and codon-based snps into filtered phr snps was <1%  in the octoploid f. ×ananassa validation set . in comparison, an 84% conversion rate from candidate to phr class was achieved for the  <dig>  f1d arrayed snps in relation to the diploid f. iinumae validation set.

cluster characteristics
the homro parameter indicated that, in the di-allelic snps, 30% of the  <dig>  filtered phr snps generated diploid-like clusters while 70% had polyploid-like clusters . in the msnps, indels and haplosnps, 56-87% of the snps generated diploid-like clusters while 13-44% had polyploid-like clusters . snp-snps generated the largest proportion of diploid-like clusters at 87% . the contrasting diploid-like clustering percentages for di-allelic snps versus the snp-snps clearly indicates that the intended ploidy reduction effect was achieved by the haplosnp strategy.figure  <dig> 
proportion of diploid- and polyploid-clustering snps in the snp categories designed from the octoploid gdp. marker categories include di-allelic snps, multi-allelic snps , indels, and the three haplosnp categories of snp-snp, indel-snp, and snp-in-insertion.



as exemplified by the plot for f. ×ananassa ‘winter dawn’ , the read depth distributions of snps were distinctly bi-modal and sometimes tri-modal, indicating an underlying discontinuous distribution as would be expected if the genome was partitioned into regions that were effectively diploid, tetraploid, hexaploid, or octoploid, the latter being the predominant component . when frequencies of phr markers that exhibited diploid clustering in each read depth category were computed and depicted graphically for di-allelic snps  and for snp-snps , diploid clustering for the di-allelic snps was most prevalent at marker sites that displayed reduced read depth, as would be expected if elevated diploid clustering was related to localized biological  ploidy reduction. in contrast, diploid clustering for the snp-snps was more prevalent in the zones of higher read depth, and particularly at the presumed octoploid level, indicating that the diploid clustering resulted from the effectiveness of the technical ploidy reduction strategy and not from underlying biological ploidy reduction.figure  <dig> 
relationship of diploid clustering to mean genic read depth in
f.
×
ananassa
‘winter dawn’, displayed for
phr
di-allelic snps  and for
phr
snp-snps . black dot positions, which are identical in panels a and b, represent the mean read depth category , and the relative frequency of this read depth category . the size of each dot is directly proportional to the fraction of di-allelic snp  or snp-snp  markers that displayed diploid-like clustering. for example, the green arrow in  points to a large black dot with mean read depth category of approximately 28×  and a category frequency of approximately  <dig>  . the red arrow in  points to a small black dot corresponding to a mean read depth category of about 100× and a category frequency of about  <dig> . the larger dot sizes  occur in  in regions of comparatively low read depth, and in  in regions of comparatively high read depth. conversely, smaller dot sizes occur in  in regions of comparatively high read depth, and in  in regions of comparatively low read depth .



inheritance-based snp validation: parent–child concordance
genotyping accuracy was estimated for the  <dig>  filtered phr snps using the proportion of snps that generated concordant genotypes between parents and offspring in two octoploid biparental populations: ‘holiday’ × ‘korona’ and its  <dig> progeny , and ‘capitola’ × cf <dig> and its  <dig> progeny . in the hk progeny, of the  <dig>  filtered phr snps that had genotype calls in both parents,  <dig>  or 91% of the snps had concordant genotypes while  <dig>  snps or  <dig> % had at least one progeny with a genotype call that was not consistent with its pedigree. in the ccf progeny,  <dig>  of  <dig>   had genotypes that were consistent with declared pedigree while  <dig>   had at least one progeny with genotype inconsistencies. additional filtering for robust performing snps will leave sufficient numbers of snps to allow for integrated qtl analyses across multiple pedigreed families by the pedigree based analyses approach  <cit> .

in diploid f. iinumae, genotyping accuracy was evaluated in two ways. for the  <dig>  phr f1d snps,  <dig>   were concordant between the two parents  and f1d. in all  <dig> instances of non-concordance, f1d was genotyped as heterozygous while j <dig> and j <dig> had identical homozygous genotypes. all of the  <dig>  phr f2d snps that were parentally concordant and genotyped as heterozygous in f1d also displayed segregation in the f2d population.

inheritance-based snp validation: performance in mapping
of the  <dig>  filtered phr markers,  <dig>   were monomorphic for the hk-family, being homozygous in both parents. also,  <dig> snps  had a missing genotype call for at least one parent of which  <dig> were segregating in hk. these  <dig> snps were discarded from the current mapping effort because absence of parental genotypes was assumed to indicate non-robust genotyping performance and therefore a potential source of major mapping problems. the remaining  <dig>   filtered phr snps  were polymorphic in at least one parent and were further processed. of these,  <dig>   were discarded because more than 5% of the progeny showed “nocall” and/or marker genotypes that were non-concordant with the parents. during the map construction process with the remaining  <dig>  markers, another  <dig> markers were discarded because of poor integration, giving rise to considerable stress or mapping at large distances from any other marker, or because they mapped to a small linkage group that could not be assigned to any of the  <dig> chromosome pairs. in this first mapping effort, of the initial  <dig>  hk-polymorphic phr snps,  <dig>   were successfully mapped across all  <dig> chromosome pairs. the successful incorporation of a segregating snp or indel marker into the linkage map was considered to provide conclusive evidence that the respective variant was not an hsv or psv.

marker performance and map quality were further examined by a more in-depth analysis of lg6d through graphical genotyping of the single parent maps. two offspring showed a high number of singletons  that could not be reduced by alternative maps of at least equal quality. two further offspring were represented twice . these results from the four individuals indicated errors in labeling of samples after the ssr genotyping of hk  <cit> . exclusion of data from these offspring resulted in a reduction in map size from 163 cm to 106 cm . graphical genotyping showed the ‘holiday’ map to still be of poor quality with several blocks of multiple snps that had double recombination in multiple offspring . the ‘korona’ map had a block of snps with high degree of double recombination on lg6d. for both maps, these double recombinant regions could be resolved by manual adjustment of marker order, leaving five singletons for ‘holiday’   and one pair and three singletons for ‘korona’. genotype calling of these singletons and pair was validated through inspection of the relevant cluster plots. due to their major negative impact on obtaining good quality high-density snp maps, these data points were rescored as missing. the resulting integrated linkage map had a length of 90 cm , and the joinmap-derived single parental maps no longer contained suspicious double recombinations. we therefore concluded that the presence of even very few incongruent data points  had a major impact on the quality of a high marker density genetic linkage map. once these were removed, previous marker data for ten ssr loci  <cit>  could be easily integrated with the current snp data . graphical genotyping plots demonstrated lack of double recombination and the map size remained stable .figure  <dig> 
five snp linkage maps for linkage group 6d. maps were derived from successive steps in map construction: i)  <dig> phr snps on the full family ; ii) using  <dig> progeny  after scrutinizing genotype calls, some data points were replaced with missing values thus removing singletons and a pair; iv) adding  <dig> previously mapped ssr loci  <cit> ; and v) a full data set totaling  <dig> ssrs and  <dig> snps consisting of  <dig> phr,  <dig> nmh and  <dig> otv snps. black, blue and pink locus lines indicate phr, nmh and otv snps respectively, and green lines indicate ssr loci. the outer phr snps of the maps are highlighted. phr markers  <dig> to  <dig> refer to ax- <dig>  ax- <dig> and ax- <dig> respectively. otv markers  <dig> to  <dig> refer to the snp  ax- <dig> , ax- <dig> , ax- <dig> , ax- <dig> , ax- <dig> , ax- <dig> , and ax- <dig> , respectively.



removing the data from the four above-mentioned offspring and another  <dig> snps that were easily identified as causing major problems in mapping gave  <dig>  mapped phr snps , which resulted in a genetic map of  <dig>  cm, accounting for 82% of the initial  <dig>  phr snp that were polymorphic in hk. the genetic length of the individual linkage groups varied greatly . the mapped snps showed an uneven distribution across the subgenomes as most markers were from subgenome a, followed by b . overall, subgenomes c and d had the least number of markers, except in lg6c & 6d . this general pattern was in accordance with commonalities in the approaches for subgenome assignment and that for designing snps, as both used f. vesca genomic sequences as a reference. subgenomes a to d were distinguished by decreasing similarity to the f. vesca genomic sequences as revealed by decreasing amplification efficiency of f. vesca-based ssr markers  <cit> . design of the array snp markers included a step of aligning re-sequencing data to the published f. vesca genome sequence. consequently, subgenomes c and d were expected to have the largest sequence divergence to f. vesca based on ssr data, and were thus expected to have a lower proportion of their re-sequenced fragments aligned to the reference genome sequence, which would lead to reduced representation of corresponding snp markers.figure  <dig> 
integrated
phr
-snp linkage map of allo-octoploid strawberry using the ‘holiday’ × ‘korona’ family . a total of  <dig>  markers were placed on this map. linkage groups are named according to van dijk et al.  <cit> . large gaps mostly coincide with homozygous regions as revealed by ssr-haplotype profiles  <cit> ).
number of snps mapped in 'holiday' x 'korona' to the four subgenomes of
f.
×
ananassa



lg
subgenome
a
b
c
d

1

2

3

4

5

6

7

total
2606
1578
1025
1385


this general tendency is expected to occur when genetically diverse germplasm is investigated. for a specific family, such a general tendency might be counteracted by differences in homozygosity between the subgenomes. for the hk snp linkage maps, two chromosomes followed the expected general trend . relatively high levels of homozygosity may explain the relatively low number of snp markers for lg4c and lg7c  <cit> . also, deviations from the expected general pattern might be due to differences between the ssr-estimated and true sequence similarities. such deviations might have occurred for lgs 4a, 4b, 5c, 5d, 6c and 6d for which only a low number of f. vesca-derived ssr loci were analyzed and for which differences in amplification efficiency were minor.

the 36 k nmh and 1 k otv snps provided an additional reservoir of thousands of potentially useful markers. of these,  <dig>  nmh snps  and  <dig> otv snps  were polymorphic in hk, of which  <dig>   and  <dig> , respectively, met quality criteria for inclusion in the mapping process. nmh and otv snps integrated well into the phr maps, as demonstrated for lg6d . of the initial 263nmh and  <dig> otv snp evaluated for lg6d mapping,  <dig>  were removed due to their poor performance in joinmap. the resulting map was 113 cm long and was free of double recombinants, with just one pair and seven singletons for ‘holiday’  and five singletons for ‘korona’. the pair and singletons were caused by a single nmh snp, but one that was related to an ssr marker. removal of the marker with multiple singletons and rescoring the data for the other singletons as missing resulted in a map of 97 cm. the addition of the  <dig> nmh and  <dig> otv markers  thus resulted in good integration into the phr framework map of lg6d  and a 62% increase in marker density to the initial phr map of  <dig> snps for this linkage group . the actual chromosomal fragment that was represented by markers was thus hardly affected by inclusion of nmh and otv snps . the respective increase and decrease in the corresponding genetic maps thus indicates the occurrence of occasional genotyping errors in a large series of overall well-performing markers.

the presence of some genotyping problems was revealed during the mapping process. of the  <dig> hk-polymorphic otv snps, a large group of  <dig> snps showed a similar pattern of non-concordance for parent-progeny genotypes that could not be solely explained by the introduction of null alleles. for the hk progeny, these otv snps showed a clear 1: <dig> segregation for the aa and bb clusters whereas the parents were genotyped as homozygous aa and bb or bb and aa. the 1: <dig> segregation indicated segregation from just a single parent. to examine their performance in mapping, these snp data were scored as two alternatives, either as a maternal or as a paternal marker. the alternative that integrated well into the phr framework map was maintained. in this way, three such markers could be well integrated into lg6d . examination of their cluster plots identified this otv subset to be of type nmh whereby the heterozygous genotype was erroneously classified as homozygous . this analysis allowed for correctly identifying the heterozygous parent. two of the three markers were of type ab × bb  and one of type a∅ × ∅∅  additional file 15).

initial comparisons between physical and genetic maps demonstrated the prospects of the snp array for further improvement of the physical map, including re-orientation of contigs and scaffolds, re-allocations to different regions within the assigned lg, and even re-assignment to other lgs .figure  <dig> 
relationship between the genetic map of lg6d of the allo-octoploid cultivar holiday and that of the diploid cultivar
f. vesca
‘hawaii 4’. panels a and b present snps and ssrs that physically came from lg <dig> or other lgs, respectively. the rulers indicate genetic distances in cm and physical distances in bases/  <dig>  . different colours highlight cases of large discrepancies , or indicate different physical lgs . panel a: red & blue, proximal markers becoming distal and vice versa; green, medium shift in position; pink and orange, opposite order of multiple snps for a small and large chromosomal segment respectively.



validation of f1d snps by mapping in f. iinumae
of the  <dig>  f1d snps that were classified as phr and that were parentally concordant, all but  <dig>  were able to be incorporated into a linkage map of the expected seven linkage groups based upon segregation in the 21-member f2d population. also mapped in the f2d population were  <dig> octoploid-derived markers  and seven codon-based markers. the resulting f. iinumae linkage map will be presented elsewhere.

sequence-based validation
for seven of the eight hd- <dig> filtration panel members , comparisons were made between sequence-derived genotype calls and those of  <dig>  di-allelic phr snps. in total,  <dig>  comparisons were attempted . a comparison could not be made if the snp had “nocall” in the detection panel for a given individual, fewer than  <dig> sequencing reads were present at the snp location, or the snp had more than two alleles at the snp location. at least one comparison was possible for all but  <dig> of the  <dig>  snps. these snps failed to meet the requirements for all seven individuals of the hd- <dig> panel. in total,  <dig>  comparisons were possible, and of these,  <dig>   had the same genotype calls from both the axiom array and sequencing data. of the  <dig>   comparisons that did not have matching genotype calls,  <dig>   were heterozygous based on sequencing and had homozygous axiom array genotype calls, likely caused by sequencing or genotyping error. another  <dig>  appeared homozygous based on sequencing, and were heterozygous based on array genotyping, possibly due to absence of allele representation of alternate allele in sequence or presence of signal from paralogous sequences; and  <dig>  had alternative homozygous genotypes. the number of comparisons for an individual appeared to be highly correlated with sequence read coverage. a smaller number of snps were compared in the hd- <dig> member with the lowest genome sequence coverage , as opposed to the remaining six hd- <dig> with higher genome coverage .figure  <dig> 
matching and non-matching hd- <dig> genotypes obtained by comparing sequence-derived to array-obtained genotypes. genotype data was not available for holkor  <dig> as the genotype calls were < 97%. no genotype comparison was possible when read depth at the variant site was less than  <dig> .



codon-based approach
of the  <dig>  codon-based markers placed on the array,  <dig>  were classified into the filtered phr category, and none of these achieved incorporation into the ‘holiday’ x ‘korona’ linkage map. as previously noted, seven of  <dig>   codon-based markers were incorporated into the f. iinumae map.

snp polymorphism in the cultivated strawberry
snp polymorphism as present in wider germplasm was estimated based on maf in the  <dig>  phr snps obtained after filtering across the  <dig> diverse cultivar accessions . maf ranged from  <dig> to  <dig>  with  <dig> indicating monomorphism and  <dig>  indicating the presence of both alleles at equal frequency. approximately 91%  of the snps were polymorphic as indicated by a maf ≥ <dig> . these polymorphic snps , and a highly polymorphic fraction of snps with maf ≥ <dig>  , were well distributed across the seven pseudochromosomes of the f. vesca ‘hawaii 4’ v.  <dig>  reference genome according to physical location . the largest snp gap was  <dig> kbp in length and observed on linkage group  <dig> . nine  snps were monomorphic, while  <dig>  snps  exhibited low polymorphism with an observed maf < <dig>  in the evaluated germplasm.figure  <dig> 
distribution of minor allele frequency  of snps across seven lgs. maf is shown according to physical location on the f. vesca ‘hawaii 4’ v <dig>  reference genome in  <dig> diverse strawberry accessions.



discussion
implementation of marker-assisted breeding, including genome wide selection and upstream genomics studies such as genome-wide association studies, requires large numbers of robust markers that are widely distributed across the genome. single nucleotide polymorphisms are the preferred marker type for these applications due to their preponderance in the genome and their amenability to automated genotyping  <cit> . for maximum utility in the allo-octoploid, cultivated strawberry, the genotyping platform must interrogate and provide accurate genotypic information for large numbers of snp markers that occur in a predominantly octoploid genomic setting and that are distributed across the multiple subgenomes. as part of the rosbreed project  <cit> , a broadly collaborative research and development project was initiated to establish a high-throughput snp genotyping platform for octoploid strawberry and to assess its usefulness. to this end, multiple approaches were developed and implemented for identifying snps suitable for genotyping on an affymetrix axiom array platform coupled with the axiom gt <dig> clustering algorithm for automated snp genotype calling. these approaches included the development of multiple bioinformatic pipelines and optimized strategies for snp discovery and genotyping at the octoploid level.

the tangible product of this initiative is the istraw <dig> axiom array, released commercially by affymetrix on october  <dig>   <dig>  in total,  <dig>  marker loci  were included on the array, of which  <dig>  were developed on the basis of discovery in an octoploid germplasm discovery panel,  <dig>  were discovered in the important diploid mapping parent f. iinumae f1d, and  <dig>  were developed via a speculative, non-discovery based approach. in an initial  assessment of array performance in two octoploid progeny populations , a diverse sampling of cultivated and non-cultivated octoploid germplasm, and a diploid mapping population, performance of the array has met or exceeded expectations. further evaluation and analysis will be required to establish the full potential of the array; however, ongoing improvements in gridding and genotyping algorithms promise to further increase the number of useful markers. in addition to evaluating the marker classes obtained from this new gridding algorithm, the array will be evaluated in additional strawberry germplasm. still, the substantial demand for the array that has already arisen internationally in strawberry genomics and breeding communities is evidence of the need for such a tool and the platform’s realized effectiveness.

performance of the array in linkage mapping
of the  <dig>  marker loci on the array, it has thus far been possible to incorporate  <dig>  markers from the filtered and most amenable marker class of  <dig>  phr markers into an octoploid linkage map based upon the cross ‘holiday’ × ‘korona’. linkage group segments on the resulting map that most lacked markers usually coincided with chromosomal regions for which ‘holiday’ and ‘korona’ are known to be homozygous based on ssr-haplotype information  <cit> . the genetic map length of  <dig>  cm is close to the reported  <dig>  cm for the segregating part of the integrated ssr linkage map  <cit> . in most cases, the lengths of the lgs were similar to those of the published ssr linkage maps of ‘holiday’ × ‘korona’, where less than  <dig> cm differentiated  <dig> of the  <dig> chromosome pairs . in some cases, however, the lengths of the snp maps were larger, and in two cases  they were at least  <dig> cm longer. the existing ssr maps well represented the proximal and distal ends of the physical map of the f. vesca reference genome  <cit> . major increases in sizes of the snp maps could thus not be due to an actual increase in the represented genomic region, but are likely to be due to genotyping errors for these phr markers, which had not been scrutinized further following filtering. other aspects that may affect the length of linkage maps are the ease by which the two parental maps could be integrated, in addition to differences in coverage and mapping algorithm. the relative importance of these factors may be evaluated once the snp data have been carefully examined for other snp linkage maps.table  <dig> 
lengths  of the  <dig> integrated genetic linkage groups of the full-sib family ‘holiday’ × ‘korona’



lg
subgenome
a
b
c
d
ssr
snp
ssr
snp
ssr
snp
ssr
snp

1two snp sub-maps present , due to which the total length could not be estimated.

lengths are based on previous estimation using highly scrutinized ssr markers  <cit>  taking into consideration only the segregating part of these ssr maps, and on current observations using filtered but otherwise non-scrutinized snp markers.



ongoing analyses indicate that thousands of additional, non-phr  markers could be mapped, and thus the full potential of the array for mapping in the ‘holiday’ × ‘korona’ cross has yet to be realized. nevertheless, the existing set of  <dig>  markers provides coverage of all  <dig> expected linkage groups, with an average marker density of approximately one marker per  <dig>  cm, thus exceeding our benchmark goal of one marker per cm. results to date indicate that a similar number of markers can be mapped in the ‘capitola’ × cf <dig> population, and more than  <dig>  markers have been identified as robust and suitable for mapping in a four-generation “non-ananassa” pedigree-connected population .

the availability and use of otv snps not only increased marker density but also increased the power for integration of the maternal and paternal linkage maps in these f <dig> mapping populations. the introduction of a third null allele in addition to the two conventional alleles a and b introduces markers of ab × ac segregation type through the crosses ab × a∅, ab × b∅, a∅ × b∅, and their reciprocals. their segregation is fully informative in both parents, whereas snps of segregation type ab × ab are informative for only 50% of meioses. null alleles were also fully informative markers in developing a linkage map in four inter-specific crosses of pear as demonstrated by montanari et al.  <cit> . accounting for null alleles introduces bridge markers of the highest level of informativeness. for lg6d, one such snp marker was present in hk  as two ssr markers. scrutinizing genotype calls at the cluster and/or individual sample level may also increase the number of useful markers. this strategy should facilitate the mapping process and improve overall quality of maps, resulting in shorter lengths and more correct marker orders. this improvement was demonstrated for the mapped phr, nmh, and otv snps of lg6d.

success rate & number of informative and high quality snps
in addition to the  <dig>  phr markers mapped in hk, another 30k snps of similar quality were polymorphic with other test panel germplasm, but could not be genetically mapped because they were monomorphic in the hk family. this success rate, which is much higher than expected, is likely driven by the greater than expected presence of naturally occurring variation in effective ploidy level within polyploid individuals, as well as by the array design employed and snp genotyping strategies.

at face value, the success rate expressed as a proportion of the 90k markers on the array that were mapped in a population is comparatively low; however, this rate was expected in part due to the challenges of octoploidy for genotype calling. in addition, the success rate was expected to be lowered because a substantial proportion of array space was invested in exploring innovative strategies, the outcomes of which are expected to inform future array development efforts in strawberry and other polyploids.

synteny and divergence among subgenomes
high levels of synteny among the four subgenomes have been demonstrated by conserved order of ssr loci on ssr-based genetic linkage maps . these same maps demonstrated subgenome divergence as ssr primer pairs frequently generated amplicons for only some of the four subgenomes. diversification was also demonstrated by the current hk snp data, where the number of mapped snp markers tended to decrease from subgenome a to subgenomes c and d . this pattern presumably reflects sequence divergence between the latter two subgenomes and the reference f. vesca genome. such divergence may explain why up to 50% of the illumina reads from the re-sequenced octoploid strawberry cultivars could not be aligned to the reference genome . physical maps for additional progenitor fragaria species are needed to better represent the genetic diversity between the subgenomes of f. ×ananassa.

a central and recurring issue for array development in a polyploid organism is the relationship between ploidy reduction – both technical and biological – and cluster compression. the cultivated strawberry and its immediate ancestors f. chiloensis and f. virginiana are octoploids, as defined by chromosome number , and so the default expectation was that any given snp locus would be represented eight times in the genome . thus, in principle, genotyping of a target snp segregating in only one subgenome would have to be successfully achievable in an octoploid context wherein an identified marker allele would be present in two, one, or zero copies in combination, respectively, with six, seven, or eight background alleles. thus, the marker genotypes to be differentiated by genotyping would be: aabbbbbb, abbbbbbb, and bbbbbbbb, where a is the “marker allele”. the parallel diploid case would be aa, ab, and bb, without the many additional b alleles. thus, the preponderance of “background” alleles in an octoploid as compared with the diploid setting is the source of excessive signal from the array probe, resulting in cluster compression . cluster compression is the primary challenge to genotyping in any allo-polyploid and particularly in an octoploid, and is an issue for all genotyping platforms such as illumina infinium and affymetrix axiom platforms that rely on two-color probe labelling systems.

ploidy reduction is a potential solution to the problem of cluster compression. in the present study, we devised and successfully implemented strategies for “technical” ploidy reduction, in which three categories of haplosnp sites were identified and targeted with probes intended to have subgenomic specificity.

biological ploidy reduction
in addition to “technical ploidy reduction”, our outcome benefitted from “biological” ploidy reduction, which derived from the fortuitous existence of localized regions of effectively reduced ploidy in an otherwise octoploid genomic context, with the ploidy reduction assumed to be the result of large or small scale insertions and deletions among subgenomes .figure  <dig> 
genomic basis for biologically effective ploidy reduction. a. site-specific ploidy reduction in one or more subgenomes is a proportional consequence of site-specific deletion within the alternate subgenomes. site-specific ploidy may be reduced from the octoploid  to the hexaploid , tetraploid , or diploid  levels. b. alignment of illumina short reads to the ‘hawaii 4’ v <dig>  reference genome reveals a ~ <dig>  kb region of localized read depth reduction, indicative of ploidy reduction, in octoploid f. ×ananassa ‘winter dawn’, corresponding to the site of a ~ <dig>  kb deletion in diploid f. iinumae relative to the f. vesca diploid reference genome. the deletion is absent in diploid f. mandshurica, a close relative of f. vesca. visualized in integrated genome viewer .



the existence of localized regions of reduced ploidy is indicated by several factors. first, the size  of the octoploid genomes is almost 25% less than the expected four times the size of the average diploid strawberry genome  <cit> , of which the ~260 mb flow cytometric size of the ‘hawaii 4’ genome is typical. thus, genomic dna loss has evidently occurred since the origin of the octoploids as observed in numerous polyploid species . one manifestation of such loss is the reduction in number of 25s and 5s rrna sites in octoploid fragaria species as detected by fish  <cit> . also, sites of localized read depth reduction were evident in alignments of octoploid read sets to the reference genome, and at least some of these sites coincided with sites of species-specific deletion in the ancestral diploid species, as exemplified by f. iinumae . in addition, plotting of mean read depths at gene sites throughout octoploid genomes revealed a distribution that is far from normal , with multi-modality suggestive of underlying partitioning into distinct classes. these classes might correspond to genomic regions that are effectively diploid, tetraploid, hexaploid, and  octoploid. finally, a substantial proportion  of the  <dig>  filtered phr standard snps and indels displayed diploid-like clustering, which likely contributed to their phr status. when superimposed on a plot of read depth frequency in relation to mean read depth , the standard snps displaying diploid-like clustering were found to occur preferentially at sites of comparatively low read depth, suggesting that these were sites of biologically reduced ploidy, although not necessarily reduced to the diploid level. these could also be sites of high sequence diversification, resulting in homoeolog-specific impairment of probe hybridization. therefore, in the following discussion of various technical ploidy reduction strategies, the possibility must be recognized that snp sites targeted for technical ploidy reduction strategies might also correspond to sites of biological ploidy reduction.

approaches for technical ploidy reduction
technical ploidy reduction was sought by means of four snp discovery strategies. first, snps classified as multi-allelic  were thought to hold potential for technical ploidy reduction on the basis that one subgenome might contain alleles that were not represented in the other homeologs  and that with appropriate probe design these segregating marker alleles could be genotyped effectively. however, of all the employed strategies, the msnp strategy was perhaps the least effective, for several reasons. first, the number of identified candidate sites was relatively few . second, the number of probes  required to interrogate an msnp site was higher than for any other marker class, thus consuming disproportionate array space. third, the snp genotyping algorithm was not, and is still not, optimized for msnps, and requires further manual examination. finally, the conversion rate of msnps as measured by the extent of their representation in the phr category was low . conversion rate of msnps into filtered phr was ~ <dig> %. since each msnp required, on average,  <dig>  times as many probes as di-allelic snps , targeting msnps is not recommended from an efficiency standpoint.

a second and much more effective strategy was the haplosnp approach, which took three distinct forms: a marker snp nearby a subgenome-differentiating snp ; nearby an indel ; or within an insertion . the bioinformatics pipelines needed to identify such sites were somewhat elaborate and case-specific, and while effective were not subjected to extensive optimization. thus, the potential effectiveness of these pipelines in maximizing the discovery of favorable genomic sites cannot be precisely assessed. nevertheless, the relative rates of conversion of the three haplosnp forms, as indicated by their participation in the phr class, offers useful insight. by far, the snp-snp strategy was the most effective haplosnp strategy, based on two criteria. first, the greatest numbers of haplosnp candidates were in the snp-snp class and are therefore more abundant to target . second, the highest conversion rate into filtered phr  was obtained in the snp-snp category .

transferability to diploid f. iinumae
although the istraw <dig> array was developed primarily as a tool for genotyping octoploid strawberry germplasm and breeding materials, for purposes of comparison a set of snps was discovered and then genotyped in an important family of diploid individuals, specifically the f. iinumae mapping parents and  <dig> f <dig> generation progeny. of the  <dig>  f1d snps,  <dig>  or 82% could be incorporated into an f. iinumae linkage map. in contrast, of the  <dig>  array loci that were based upon discovery in the octoploid germplasm panel, only  <dig> could be placed upon the f. iinumae linkage map, while less than 1% of the  <dig>  f1d snps achieved the phr rating in relation to octoploid genotyping. thus, transferability of discovery-based snp markers between octoploid and diploid germplasm sets in fragaria was very low, suggesting caution as to the applicability of the istraw <dig> array for studies in fragaria germplasm other than the octoploids and diploid f. iinumae.

the codon-based strategy
the codon-based strategy was explored as an intriguing option made possible by the large number of snps  that could be tested on the affymetrix axiom array. here, the rationale was to test a strategy for developing polymorphic snps based on physical location without the need for previously obtained data on sequence variation. however, the conversion rate to useful polymorphism of  <dig>  codon-based snps on the array was very low , with zero and seven codon-based markers being incorporated into the hk and f2d linkage maps respectively. further analysis of these data is in progress, and may reveal opportunities for modification and improvement of the codon-based strategy.

array design in allo-octoploids
for array design in allo-polyploids of high ploidy level, a combination of targeting both standard, di-allelic snps and ploidy-reducing haplosnps may be most effective, as these two snp categories may be complementary with respect to their patterns of genomic distribution. the former may well represent regions of reduced effective ploidy due to true local ploidy reduction or to sequence diversification. the latter may better represent regions that remain at high effective ploidy levels. furthermore, given the reported trend of biased patterns of gene loss/retention post polyploidization  <cit> , combining standard di-allelic and ploidy-reduction snps will likely target genes from different functional categories, useful for future discovery of marker-trait relationships. functional analyses across the asterids, rosids, and monocots recently confirmed that, post polyploidization, genes involved in “biological regulation” were retained in multiple copies  while those responsible for metabolic activities tended to lose copies  <cit> .

CONCLUSIONS
the affymetrix istraw <dig> axiom array is the first high-throughput genotyping platform for allo-octoploid strawberry. in the design of the array, strategies were successfully developed and applied that enhanced cluster resolution by achieving technical ploidy reduction. the most effective strategy was “snp-snp”, in which a subgenome-specific snp located within  <dig> bp of a marker snp was exploited as a probe destabilization site. presence of diploid-like clusters even in the standard di-allelic snp category indicated that effective ploidy levels have already been reduced in the octoploid strawberry at multiple genomic regions due to subgenome sequence diversification and subgenomic deletions. genotyping procedures for polyploids were improved by the addition of new functionalities to the axiom best practices genotyping workflow, which streamlined automatic genotyping for compressed clusters and for complex clustering patterns. validation of the array indicated that combining standard and ploidy-reducing haplosnps is a useful approach for high-density genome scans and linkage mapping of allo-polyploids of high ploidy levels.

additional files
additional file 1: 
list of  <dig> cultivated strawberry
f.
×
ananassa
samples evaluated with the strawberry array. this list contains  <dig> unique accessions because we included four replicate samples of ‘korona’ and two of ‘holiday’. cultivar names and parents are provided. individuals whose genotyping call rates were below the affymetrix threshold of 97% and were excluded from genotyping are indicated. also the sixty-five diverse cultivars used for estimating minor allele frequency are indicated.

additional file 2: 
illumina library preparation from strawberry gdp.


additional file 3: 
di-allelic snp discovery pipeline. initially, only the “bothsafe” candidates were processed through steps 4– <dig>  later, when more snp candidates were needed to fill out the array, the upsafe candidates were also advanced and utilized. it is noteworthy that step  <dig>  as implemented, excluded sites in which the reference allele differed uniquely from the alleles represented in the discovery panels. for instance, in figure 1a, cases  <dig> and  <dig>  if the reference allele had been “c”, which was not represented in any of the discovery panel reads, the variant type would have been reported as snp,snp, and would have been classified as multi-allelic and therefore excluded from the di-allelic snp category.

additional file 4: 
multi-allelic snp discovery pipeline. five of the eight steps in this pipeline are in common with the di-allelic snp pipeline , but are applied in a differing order with the aim of reducing computational time. only the bothsafe candidate sites were advanced through steps 4– <dig> to allow for the option of probing on both strands as needed to resolve the alternate possible genotypes. the msnp filter pipeline presented some unique challenges, because multiple variants were sought at a single position. the rationale for implementing a “minimum variant read count” filter twice in the pipeline  is as follows. steps  <dig> and  <dig> were applied in an integrated process that yielded candidate sites at which at least three reads contained a variant base, but – importantly – the three reads were not required to contain an identical variant at the respective site. nonetheless, only a small fraction of these sites contained multiple variants, thus explaining why the number of candidate sites dropped so substantially upon the integrated application of steps  <dig> and  <dig>  at step  <dig>  a minimum read count filter was applied alone to assure that any particular variant  was present in at least three reads. thus, some additional sites were excluded because no one variant  was present in at least three reads. thus, the distinction is that at steps 1 +  <dig>  the filter combination was acting to identify qualifying sites, while at step  <dig> the employed filter was acting to assure that the selected sites contained qualifying variants.

additional file 5: 
di-allelic indel discovery pipeline. for indels, the variant read count filter  was set at x =  <dig>  because of the reduced likelihood that indel variants, and especially those of greater than  <dig> bp would be due to sequencing errors. the upsafe-downsafe filters were used to assure that the regions  <dig> bp upstream and  <dig> bp downstream of the indel site were free of other variants. the  <dig> bp  downstream exclusion was required here because the indel site location is defined at a single, upstream reference coordinate, yet it spans several  bp. at step  <dig>  the genic rather than the cds filter was employed to enable consideration of indels within introns as well as coding sequences, thus increasing the available number of indel candidates yet avoiding potentially poorly conserved intergenic space.

additional file 6: 
snp-snp discovery pipeline. in pathway step  <dig>  snps that can serve as subgenome-specific “destabilization” sites are identified. these snps must be present in all  <dig> hd- <dig> members. step  <dig> identifies instances where a potential marker snp site is present within  <dig> bp of an identified “destabilization” site. steps  <dig> and  <dig>  including the “snp association check” depicted next, are intended to ensure that the marker snp is polymorphic only in the subgenome to which the designed probe will be specific.

additional file 7: 
indel-snp filter pipeline. in parallel with the snp-snp pipeline , the purpose of step  <dig> in the present pipeline is to identify potential subgenome-specific “destabilization” sites, which in the present case are indels rather than snps. the maximum size of indels reported in the vcf files is  <dig> bp; therefore, the minimum size limit imposed at step  <dig> means that the candidate indels must be in the range of 4–6 bp. steps  <dig> through  <dig> in the present pipeline are analogous to steps  <dig> through  <dig> in the snp-snp pipeline , in a differing order. in the present pipeline, the  <dig> bp +/− filter was not applied because it would have reduced the number of candidate to a negligible level. details of step  <dig> and  <dig> are provided on the second page of this file.

additional file 8: 
snp-in-insertion filter pipeline. because of the constraints imposed by vcf structure, two distinct pipelines were needed to identify snp-within-insertion sites. in case  <dig> , the reference sequence contains the “deletion form” at the site in question. in case  <dig> , the reference sequence contains the “insertion form” at the site in question. thus, these two cases are reported separately in the vcf files, as ins and del variants, respectively.

additional file 9: 
diploid f1d snp filter pipeline. in steps  <dig> through  <dig>  this pipeline parallels that used for identifying di-allelic snps in the octoploid gdp , a key difference being that only a single vcf file was mined for f1d snp discovery, while  <dig> files were simultaneously mined in the octoploid snp discovery process. unlike in the octoploid discovery pipelines, linkage group  <dig>  of the ‘hawaii 4’ reference genome was included in the diploid discovery process; however, no snps from lg <dig> were ultimately included in the array.

additional file 10: 
list of  <dig>  probesets used to interrogate  <dig>  target sites and their physical location. polymorphism in ‘holiday’ and/or ‘korona’ and presence on the linkage map shown in figure  <dig> are indicated. also indicated are the  <dig>  filtered phr snps and their clustering pattern .

additional file 11: 
conversion rate of di-allelic snps interrogated with one versus two strands.


additional file 12: 
effect of increasing nocall rate with decreasing confidence score. the grey squares signify no calls. the number of grey squares  increase from panel a to b to c with the increasingly more stringent confidence score. a. confidence score =  <dig>   b. confidence score =  <dig>  c. confidence score =  <dig> .

additional file 13: 
graphical genotyping graphs for ‘holiday’ from different stages of the mapping process. panels a & b relate to step  <dig> of figure  <dig> where the original joinmap derived phr map of  <dig> cm for the subset of  <dig> progeny  has been manually re-ordered . panel c presents the map for step  <dig> where the full snp data set  were scrutinised for some singletons and a pair of double recombinant snps. each colored row represents a single offspring from ‘holiday’ × ‘korona’. each column represents a snp marker. a green/blue transition within a row indicates a recombination event. non-colored segments indicate non-informative data, which can be due to true missing data or to non-informative ab genotypes. pink indicates singletons or a pair of recombinant snps. orange lines indicate unstable map regions.

additional file 14: 
data underlying the genetic and physical map of lg6d and as used for figures 10
v,
11
and
12
. identity, snp-class, genetic and physical positions, and joinmap calls for the ‘holiday’ x ‘korona’ progeny.

additional file 15: 
cluster plots for three
otv
s added to lg6d lacking one homozygote cluster . they mapped on lg6d . progenies and their parents ‘holiday’ and ‘korona’ are marked by red , green  and blue  triangles respectively. non-colored triangles represent the other genotyped germplasm. for ‘holiday’, two replicated samples are presented. the direction of the crosses was confirmed by genetic mapping whereby these otv-nmh snps integrated well as maternal marker into the phr framework map .



abbreviations
bambinary alignment map

xburrows-wheeler aligner

ccfcapitola’ × cf1116

crbtcallrate below threshold

gatkgenome analysis toolkit

gdpglobal discovery panel

gt1genotyping algorithm v1

hd-16high depth filtration subset with a minimum 16× coverage depth

hd-20high depth filtration subset with a minimum 20× coverage depth

hkholiday’ × ‘korona

homrohomozygous ratio offset

hsvshomoeologous sequence variants

lglinkage group

mafminor allele frequency

mhrmonohighresolution

msnpmulti-allelic snp

nmhno minor homozygote

otvoff-target variant

phrpoly high resolution

psvsparalogous sequence variants

qcquality control

qtlquantitative trait locus

saisequence alignment index

samsequence alignment map

snpsingle nucleotide polymorphism

srasequence read archive

srxsra experiment accessions

vcfvariant call format

nahla v bassil, thomas m davis and eric van de weg contributed equally to this work.

competing interests

one commercial organization- affymetrix- was involved in the development of the array and in preparation of the manuscript. among the authors, tw, fb, mm, lb and ap work for affymetrix ltd and hold shares in affymetrix ltd.

authors’ contributions

constructed the illumina libraries: la. bioinformatic analyses and snp discovery: sf, hz, tmd, evdw, lm, dw, yy. array design: mm. dna extraction and preparation: ea. project design, manuscript preparation and overall supervision: nvb, tmd, evdw. genotyping data analyses: tw, ap, ur, sv, nvb, tmd, evdw, lm, dw, djs, bd. linkage mapping: evdw, djs, lb, bd, hk, lm. contributed reagents/materials/analyses/tools: vw, sv, tvd, hz, am, ia, ai, cp. all authors read and approved the final manuscript.

authors’ information

nahla v bassil and thomas m davis share first authorship.

