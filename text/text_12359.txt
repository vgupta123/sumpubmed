BACKGROUND
cis-regulatory circuits have been applied to model cell cycle control and other developmental processes  <cit> . recently, the genetic regulatory and transcriptional networks of yeast have been studied  <cit> . however, in order to understand the regulation of any particular gene in the network, one should study carefully how the genes in the network collectively operate with remarkable precision in response to environmental cues and the structure and function of the cis-regulatory circuit of the gene  <cit> . the cis-regulatory circuit of a gene consists of its cis elements, i.e., binding motifs of transcription factor , and the interactions among their recognizing tfs. the cis elements of a gene can be considered as the information processing units in the regulatory circuit; they receive multiple inputs from the tfs that bind the cis elements of the gene. the output is the instruction for the transcription apparatus to determine whether the gene is to be expressed at a specific rate or to be repressed  <cit> .

a cis-regulatory circuit may be regarded as a control device that is called into play by the tfs that have target sites inside the promoter  <cit> . a well-known example is the promoter region of the developmentally regulated endo  <dig> gene of the sea urchin  <cit> . it is about ~ <dig> bp in length and consists of several clusters of target sites for distinct functions. yuh et al.  <cit>  have explored the function of each subregion of the endo  <dig> system and every target site within each subregion, using a cis-regulatory logic model.

however, a drawback of most current methods for inferring cis-regulatory circuits is that they rely on changing or deleting some binding site sequences , which may not provide intact functional information for reconstructing the cis-regulatory circuit. the deletion or mutation experiments may change or destroy the original cis-regulatory circuit structure. using such data, one may lose significant interactions among transcription factors . obviously, it is appealing to develop a method that can infer intact cis-regulatory circuits. recently, there are some statistical and system level approaches to study the genome-wide transcription regulation and address cooperativity among tfs . important advances have been made toward understanding transcriptional regulatory networks. one strategy infers global networks directly from whole genome microarray data, and another strategy focuses on the identification of shared cis elements in the promoters of co-regulated genes, signified by similar expression profiles  <cit> . in this paper we develop a new method to combine microarray data and tf-binding location data by chromatin immunoprecipitation  <cit>  to study the regulatory and interaction functions of various cis elements with regard to the target gene. the data of lee et al.  <dig>  <cit>  can reveal the in vivo physical interactions of tfs with their cis elements on the promoter and therefore can provide a more reliable view of functional interactions between tfs and cis elements. combining these types of data and microarray data, we propose a novel cross-gene identification scheme to infer how multiple tfs coordinate to regulate gene transcription. our approach is rather different from most existing statistical and system level methods for analyzing gene expression data. our results show that this novel method is suitable for deciphering the complex tfs interactions and for predicting the gene expression. in addition, we also identify the dynamic regulatory functions of tfs interaction in the yeast cell cycle, which cannot be achieved by current methods.

RESULTS
characterizing the cis-regulatory circuit of a gene
in this study, there are two steps for characterizing the cis-regulatory circuit of a gene. the first is to find a cluster of genes that includes the gene of interest and a number of other genes each of which shares a subset of cis elements with the gene of interest. assuming a certain regulatory function for each of the tfs that recognize the cis elements of genes in the cluster and certain interaction functions among the tfs of a circuit, we set up dynamic equations for the cis-regulatory circuits of the genes in the cluster to describe their expression profiles. since each gene in the cluster shares some cis elements with the gene of interest, a matrix of cis elements for the cluster of genes can be constructed. in this model, the regulatory functions of individual tfs and the interactions among tfs can be estimated from microarray data. in the second step, a cross-gene identification scheme is developed with an array of expression profiles of genes in the cluster  to identify regulatory functions of the tfs and their possible interactions for each gene in the cluster; the parameters are estimated by the least square estimation algorithm.

finally, plugging these estimated regulatory functions and interactions into the dynamic equations, one can explicitly describe the cis-regulatory circuit of the gene of interest.

choice of a cluster of genes
as an illustration, suppose some genes of the yeast cell cycle are of interest. we find a cluster of genes for each gene of interest according to their cis elements found in simon et al.  <dig>  <cit> . to simplify the analysis, we consider only the nine tfs that are currently known to be important cell cycle tfs of the yeast . the cluster of genes for the gene of interest is called the reference gene cluster . in an rgc, we assume that each gene shares some cis elements of the gene of interest. furthermore, the regulatory functions and the interactions of the tfs recognizing the same cis elements are assumed to be the same for all genes in the rgc. for example, in figure 1a gene mfa <dig> is the gene of interest; it causes cell cycle arrest and is essential for mating in yeast  <cit> . this gene has three main cis elements, ndd <dig>  mcm <dig> and swi <dig>  <cit> , from which we want to reconstruct the cis-regulatory circuit of mfa <dig> from yeast microarray data. the cis elements of mfa <dig> are denoted as follows:

mfa2:{ndd <dig>  mcm <dig>  swi5}.     

some genes chosen for the cluster and their cis elements are:

yal022c:{swi5}, yar018c:{ndd <dig>  mcm1}, ykl163w:{mcm <dig>  swi5} ....

the cluster of genes can be represented by a connectivity matrix of cis elements as shown in table  <dig> in which "1" denotes the connection of a cis element with a gene, while "0" means no connection. similarly, the rgc for gene clb <dig> can be represented by the connectivity matrix in table  <dig> 

dynamic modeling of cis-regulatory circuits
y˙mfa2=gndd1+gmcm1+gswi5+gndd <dig> mcm1+      gndd <dig> swi5+gmcm <dig> swi5+gndd <dig> mcm <dig> swi5−λmfa2ymfa2+εmfa <dig>      
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqacigacagaaeqabaqabegadaaakqaabeqaaiqbdmfazzaacawaasbaasqaaiabd2eanjabdaeagjabdgeabjabikdayaqabagccqggoaakcqwg0badcqggpaqkcqgh9aqpcqwgnbwzdawgaawcbagaeeota4kaeeizaqmaeeizaqmaeeymaedabeaakiabcicaoiabdsha0jabcmcapiabgucariabdegannaabaaaleaacqqgnbqtcqqgjbwycqqgtbqbcqqgxaqmaeqaaogaeiikagiaemidaqnaeiykakiaey4kasiaem4zac2aasbaasqaaiabbofatjabbeha3jabbmgapjabbwda1aqabagccqggoaakcqwg0badcqggpaqkcqghrawkcqwgnbwzdawgaawcbagaeeota4kaeeizaqmaeeizaqmaeeymaejaeeilawiaeeyta0kaee4yammaeeyba0maeeymaedabeaakiabcicaoiabdsha0jabcmcapiabgucaraqaaiaaxmaacaamc8uaagpavlaaykw7caamc8uaagpavlaaykw7cqwgnbwzdawgaawcbagaeeota4kaeeizaqmaeeizaqmaeeymaejaeeilawiaee4uamlaee4dacnaeeyaakmaeeynaudabeaakiabcicaoiabdsha0jabcmcapiabgucariabdegannaabaaaleaacqqgnbqtcqqgjbwycqqgtbqbcqqgxaqmcqqgsaalcqqgtbwucqqg3bwdcqqgpbqacqqg1aqnaeqaaogaeiikagiaemidaqnaeiykakiaey4kasiaem4zac2aasbaasqaaiabb6eaojabbsgakjabbsgakjabbgdaxiabbycasiabb2eanjabbogajjabb2gatjabbgdaxiabbycasiabbofatjabbeha3jabbmgapjabbwda1aqabagccqggoaakcqwg0badcqggpaqkcqghsislcqah7oabdawgaawcbagaemyta0kaemoraykaemyqaekaegomaidabeaakiabdmfaznaabaaaleaacqwgnbqtcqwggbgrcqwgbbqqcqaiyagmaeqaaogaeiikagiaemidaqnaeiykakiaey4kasiaeqytdu2aasbaasqaaiabd2eanjabdaeagjabdgeabjabikdayaqabagccqggoaakcqwg0badcqggpaqkcqggsaalcawljagaaczcamaabmaabagaegomaidacagloagaayzkaaaaaaa@c2ab@

where εmfa <dig> denotes the noise , gndd <dig>  gmcm <dig> and gswi <dig> are the regulatory functions of transcription factors ndd <dig>  mcm <dig>  and swi <dig> or the incident transcriptional regulations at the ndd <dig>  mcm <dig>  and swi <dig> cis elements, respectively, λmfa <dig> represents the mrna decay rate of the target gene and we used the degradation rate measured by wang et al.  <dig>  <cit> . the gndd <dig> mcm <dig>  gndd <dig> swi <dig>  gmcm <dig> swi <dig> and gndd <dig> mcm <dig> swi <dig> denote the following nonlinear interactions among the three tfs:

gndd <dig> mcm <dig> =: f, gmcm1),

gndd <dig> swi <dig> =: f, gswi5),     

gmcm <dig> swi <dig> =: f, gswi5),

and

gndd <dig> mcm <dig> swi <dig> =: f, gmcm <dig>  gswi5).     

the biological meaning of equation  is that the change in the mrna expression level of gene mfa <dig> is due to the productions of regulatory functions of individual tfs and interactions among the tfs, i.e., gndd <dig> + gmcm <dig> + gswi <dig> + gndd <dig> mcm <dig> + gndd <dig> swi <dig> + gmcm <dig> swi <dig> + gndd <dig> mcm <dig> swi <dig>  and -λmfa2ymfa <dig>  which is the degradation of mrna. similarly, the cis-regulatory circuit of the target gene clb <dig> in figure 1b is modeled by

y˙clb2=gfkh1+gfkh2+⋯+gfkh <dig> fkh2+⋯+gfhk <dig> fkh <dig> ndd1+⋯                           −λclb2yclb2+εclb <dig> 
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqacigacagaaeqabaqabegadaaakqaabeqaaiqbdmfazzaacawaasbaasqaaiabdoeadjabdyeamjabdkeacjabikdayaqabagccqggoaakcqwg0badcqggpaqkcqgh9aqpcqwgnbwzdawgaawcbagaeeoraykaee4aasmaeeiaagmaeeymaedabeaakiabcicaoiabdsha0jabcmcapiabgucariabdegannaabaaaleaacqqggbgrcqqgrbwacqqgobaacqqgyagmaeqaaogaeiikagiaemidaqnaeiykakiaey4kasiaes47iwkaey4kasiaem4zac2aasbaasqaaiabbaeagjabbugarjabbigaojabbgdaxiabbycasiabbaeagjabbugarjabbigaojabbkdayaqabagccqggoaakcqwg0badcqggpaqkcqghrawkcqwivlctcqghrawkcqwgnbwzdawgaawcbagaeeoraykaeeiaagmaee4aasmaeeymaejaeeilawiaeeoraykaee4aasmaeeiaagmaeeomaijaeeilawiaeeota4kaeeizaqmaeeizaqmaeeymaedabeaakiabcicaoiabdsha0jabcmcapiabgucariabl+uimjaaxmaacawljawaaewaaeaacqai1aqnaiaawicacaglpaaaaeaacaamc8uaagpavlaaykw7caamc8uaagpavlaaykw7caamc8uaagpavlaaykw7caamc8uaagpavlaaykw7caamc8uaagpavlaaykw7caamc8uaagpavlaaykw7caamc8uaagpavlaaykw7caamc8uaeyoei0iaeq4udw2aasbaasqaaiabdoeadjabdyeamjabdkeacjabikdayaqabagccqwgzbqwdawgaawcbagaem4qamkaemitawkaemoqaikaegomaidabeaakiabcicaoiabdsha0jabcmcapiabgucariabew7alnaabaaaleaacqwgdbwqcqwgmbatcqwgcbgqcqaiyagmaeqaaogaeiikagiaemidaqnaeiykakiaeiola4caaaa@b83f@

for simplicity, the indices of target genes and cis elements are denoted by numerical notation, so that the cis-regulatory circuit of gene i can be written as

y˙i=∑pvgp+∑pqgp,q+∑pqrgp,q,r+⋯−λiyi+εi,     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqacigacagaaeqabaqabegadaaakeaacuwgzbqwgagaamaabaaaleaacqwgpbqaaeqaaogaeiikagiaemidaqnaeiykakiaeyypa0zaaabcaeaacqwgnbwzdawgaawcbagaemicaahabeaaaeaacqwgwbacaeaacqwg2bgda0gaeyyeiuoakiabcicaoiabdsha0jabcmcapiabgucarmaaqahabagaem4zac2aasbaasqaaiabdchawjabcycasiabdghaxbqabaaabagaemicaanaemycaehabaaaniabgghildgccqggoaakcqwg0badcqggpaqkcqghrawkdaaewbqaaiabdegannaabaaaleaacqwgwbaccqggsaalcqwgxbqccqggsaalcqwgybgcaeqaaaqaaiabdchawjabdghaxjabdkhaybqaaaqdcqghris5aogaeiikagiaemidaqnaeiykakiaey4kasiaes47iwkaeyoei0iaeq4udw2aasbaasqaaiabdmgapbqabagccqwgzbqwdawgaawcbagaemyaakgabeaakiabcicaoiabdsha0jabcmcapiabgucariabew7alnaabaaaleaacqwgpbqaaeqaaogaeiikagiaemidaqnaeiykakiaeiilawiaaczcaiaaxmaadaqadaqaaiabiada2agaayjkaiaawmcaaaaa@780b@

where v is the total number of cis elements in gene i and its corresponding degradation rate λi measured by wang et al.  <dig>  <cit> . if λi is unavailable, it should be estimated together with the parameters gp, gp,q, gp,q,r . for the cis-regulatory circuits in equations ,  and , one obviously cannot estimate the multiple unknowns gp, gp,q, gp,q,r, … by only the expression profile ) of the ith target gene. however, since the functions gp, gp,q, gp,q,r, … are assumed to be the same for all genes in the rgc and since there are overlaps of cis elements among genes in this rgc, one can estimate these functions from an array of expression profiles y <dig>  y <dig>  …, yn of the genes in the rgc simultaneously, taking advantage of cross information enhancement. the rgcs for mfa <dig> and clb <dig> are shown in table  <dig> and table  <dig>  respectively. in this situation, a cross-gene identification method is proposed as follows. by integrating the dynamic equations of cis-regulatory circuits for n genes in the rgc of the gene of interest, we obtain the following array of dynamic equations

y˙2⋮⋮y˙i⋮⋮y˙n)=•g2⋮g <dig> g <dig> ⋮g <dig> ,3⋮gp,q,r)−λ2y2⋮⋮λiyi⋮⋮λnyn)+ε2⋮⋮εi⋮⋮εn).     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqadaabaiqabagafmywaklbaiaadawgaawcbagaegymaedabeaakiabcicaoiabdsha0jabcmcapaqaaiqbdmfazzaacawaasbaasqaaiabikdayaqabagccqggoaakcqwg0badcqggpaqkaeaacqwiulstaeaacqwiulstaeaacuwgzbqwgagaamaabaaaleaacqwgpbqaaeqaaogaeiikagiaemidaqnaeiykakcabagaeso7i0eabagaeso7i0eabagafmywaklbaiaadawgaawcbagaemota4eabeaakiabcicaoiabdsha0jabcmcapaaacagloagaayzkaagaeyypa0zaaewaaeaafaqabeacjaaaaaaaaeaacqaixaqmaeaacqaiwaamaeaacqwivlctaeaacqaiwaamaeaacqaixaqmaeaacqwivlctaeaacqaiwaamaeaacqwivlctaeaacqaixaqmaeaacqaixaqmaeaacqaixaqmaeaacqwivlctaeaacqaixaqmaeaacqaixaqmaeaacqwivlctaeaacqaixaqmaeaacqwivlctaeaacqaiwaamaeaaaeaacqwiulstaeaaaeaaaeaacqwiulstaeaaaeaacqwiulstaeaaaeaacqwiulstaeaaaeaacqwiulstaeaaaeaaaeaacqwiulstaeaaaeaacqwiulstaeaaaeaacqwiulstaeaacqaiwaamaeaacqaixaqmaeaacqwivlctaeaacqaiwaamaeaacqaiwaamaeaacqwivlctaeaacqaiwaamaeaacqwivlctaeaacqaixaqmaeaaaeaacqwiulstaeaaaeaaaeaacqwiulstaeaaaeaacqwiulstaeaaaeaacqwiulstaeaaaeaacqwiulstaeaaaeaaaeaacqwiulstaeaaaeaacqwiulstaeaaaeaacqwiulstaeaacqaixaqmaeaacqaixaqmaeaacqwivlctaeaacqaixaqmaeaacqaiwaamaeaacqwivlctaeaacqaiwaamaeaacqwivlctaeaacqaixaqmaaaacagloagaayzkaagaeyoigc7aaewaaeaafaqabegabaaaeagabeaacqwgnbwzdawgaawcbagaegymaedabeaakiabcicaoiabdsha0jabcmcapaqaaiabdegannaabaaaleaacqaiyagmaeqaaogaeiikagiaemidaqnaeiykakcabagaeso7i0eabagaem4zac2aasbaasqaaiabigdaxiabcycasiabikdayaqabagccqggoaakcqwg0badcqggpaqkaeaacqwgnbwzdawgaawcbagaegymaejaeiilawiaeg4mamdabeaakiabcicaoiabdsha0jabcmcapaqaaiabl6uinbqaaiabdegannaabaaaleaacqaixaqmcqggsaalcqaiyagmcqggsaalcqaizawmaeqaaogaeiikagiaemidaqnaeiykakcabagaeso7i0eaaeaacqwgnbwzdawgaawcbagaemicaanaeiilawiaemycaenaeiilawiaemocaihabeaakiabcicaoiabdsha0jabcmcapaaaaiaawicacaglpaaacqghsisldaqadaabaiqabagaeq4udw2aasbaasqaaiabigdaxaqabagccqwgzbqwdawgaawcbagaegymaedabeaakiabcicaoiabdsha0jabcmcapaqaaiabeu7asnaabaaaleaacqaiyagmaeqaaogaemywak1aasbaasqaaiabikdayaqabagccqggoaakcqwg0badcqggpaqkaeaacqwiulstaeaacqwiulstaeaacqah7oabdawgaawcbagaemyaakgabeaakiabdmfaznaabaaaleaacqwgpbqaaeqaaogaeiikagiaemidaqnaeiykakcabagaeso7i0eabagaeso7i0eabagaeq4udw2aasbaasqaaiabd6eaobqabagccqwgzbqwdawgaawcbagaemota4eabeaakiabcicaoiabdsha0jabcmcapaaacagloagaayzkaagaey4kasyaaewaaqaaceqaaiabew7alnaabaaaleaacqaixaqmaeqaaogaeiikagiaemidaqnaeiykakcabagaeqytdu2aasbaasqaaiabikdayaqabagccqggoaakcqwg0badcqggpaqkaeaacqwiulstaeaacqwiulstaeaacqah1oqzdawgaawcbagaemyaakgabeaakiabcicaoiabdsha0jabcmcapaqaaiabl6uinbqaaiabl6uinbqaaiabew7alnaabaaaleaacqwgobgtaeqaaogaeiikagiaemidaqnaeiykakcaaiaawicacaglpaaacqgguaglcawljagaaczcamaabmaabagaeg4nacdacagloagaayzkaaaaaa@277f@

in the cross-gene dynamic equations in , the process to identify regulatory functions gp, gp,q and gp,q,r from microarray data yi, i =  <dig>   <dig> ..., n is called the cross-gene identification approach, in which the regulatory functions gp, gp,q and gp,q,r are shared by genes in the rgc. therefore, the estimation of the regulatory functions of one gene can also use the information from the profiles y <dig>  y <dig>  …, yn of other genes in rgc to improve the identification ability of the regulatory functions to reconstruct the cis-regulatory circuit of the gene of interest, which is called cross information enhancement.

remark  <dig> : suppose that the gene of interest in equation  has cis elements p =  <dig> ..., v. then all genes whose cis elements are subsets of these v cis elements are included in the same rgc of the gene of interest.

cross-gene identification scheme
since the number of functions gp, gp,q, gp,q,r, … is finite, we can estimate these functions if the number n of dynamic equations in equation  is large enough. equation  can be rewritten in an algebraic form

x = a·g + e,     

where

x=+λ1y1y˙2+λ2y2⋮⋮y˙i+λiyi⋮⋮y˙n+λnyn),        g=g2⋮g <dig> g <dig> ⋮g <dig> ,3⋮gp,q,r),        e=ε2⋮⋮εi⋮⋮εn)
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqacigacagaaeqabaqabegadaaakeaacqqgybawcqggoaakcqwg0badcqggpaqkcqgh9aqpdaqadaabaiqabagafmywaklbaiaadawgaawcbagaegymaedabeaakiabcicaoiabdsha0jabcmcapiabgucariabeu7asnaabaaaleaacqaixaqmaeqaaogaemywak1aasbaasqaaiabigdaxaqabagccqggoaakcqwg0badcqggpaqkaeaacuwgzbqwgagaamaabaaaleaacqaiyagmaeqaaogaeiikagiaemidaqnaeiykakiaey4kasiaeq4udw2aasbaasqaaiabikdayaqabagccqwgzbqwdawgaawcbagaegomaidabeaakiabcicaoiabdsha0jabcmcapaqaaiabl6uinbqaaiabl6uinbqaaiqbdmfazzaacawaasbaasqaaiabdmgapbqabagccqggoaakcqwg0badcqggpaqkcqghrawkcqah7oabdawgaawcbagaemyaakgabeaakiabdmfaznaabaaaleaacqwgpbqaaeqaaogaeiikagiaemidaqnaeiykakcabagaeso7i0eabagaeso7i0eabagafmywaklbaiaadawgaawcbagaemota4eabeaakiabcicaoiabdsha0jabcmcapiabgucariabeu7asnaabaaaleaacqwgobgtaeqaaogaemywak1aasbaasqaaiabd6eaobqabagccqggoaakcqwg0badcqggpaqkaagaayjkaiaawmcaaiabcycasiaaykw7caamc8uaagpavlaaykw7caamc8uaagpavlaaykw7caamc8+exlmbbxgbcf2cpn2qvrwzqf2zlnharygvljhzh5wyagabaiaa=deacqggoaakcqwg0badcqggpaqkcqgh9aqpdaqadaabaiqabagaem4zac2aasbaasqaaiabigdaxaqabagccqggoaakcqwg0badcqggpaqkaeaacqwgnbwzdawgaawcbagaegomaidabeaakiabcicaoiabdsha0jabcmcapaqaaiabl6uinbqaaiabdegannaabaaaleaacqaixaqmcqggsaalcqaiyagmaeqaaogaeiikagiaemidaqnaeiykakcabagaem4zac2aasbaasqaaiabigdaxiabcycasiabiodazaqabagccqggoaakcqwg0badcqggpaqkaeaacqwiulstaeaacqwgnbwzdawgaawcbagaegymaejaeiilawiaegomaijaeiilawiaeg4mamdabeaakiabcicaoiabdsha0jabcmcapaqaaiabl6uinbqaaiabdegannaabaaaleaacqwgwbaccqggsaalcqwgxbqccqggsaalcqwgybgcaeqaaogaeiikagiaemidaqnaeiykakcaaiaawicacaglpaaacqggsaalcaamc8uaagpavlaaykw7caamc8uaagpavlaaykw7caamc8uaagpavlabbweafjabcicaoiabdsha0jabcmcapiabg2da9maabmaaeagabeaacqah1oqzdawgaawcbagaegymaedabeaakiabcicaoiabdsha0jabcmcapaqaaiabew7alnaabaaaleaacqaiyagmaeqaaogaeiikagiaemidaqnaeiykakcabagaeso7i0eabagaeso7i0eabagaeqytdu2aasbaasqaaiabdmgapbqabagccqggoaakcqwg0badcqggpaqkaeaacqwiulstaeaacqwiulstaeaacqah1oqzdawgaawcbagaemota4eabeaakiabcicaoiabdsha0jabcmcapaaacagloagaayzkaaaaaa@fecf@

remark  <dig> : in order to calculate the derivatives in x from undersampled data, a cubic spline interpolation method  <cit>  is employed for curve fitting to obtain more accurate differential values and to learn more reliable models.

in equation , x can be calculated from microarray data for the rgc of the gene of interest, which can then be used to estimate the vector g by the least squares method, leading to the following solution:

g^=-1atx     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqacigacagaaeqabaqabegadaaakeaacuqghbwrgaqcaiabcicaoiabdsha0jabcmcapiabg2da9iabcicaoiabbgeabnaacaaaleqabagaemivaqfaaogaeeyqaekaeeykakyaawbaasqabeaacqqgtaqlcqqgxaqmaagccqqgbbqqdaahaawcbeqaaiabdsfaubaakiabbifayjabcicaoiabdsha0jabcmcapiaaxmaacawljawaaewaaeaacqai5aqoaiaawicacaglpaaaaaa@43c0@

for all t. after g^
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqacigacagaaeqabaqabegadaaakeaacuqghbwrgaqcaiabcicaoiabdsha0jabcmcapaaa@30f6@ is estimated from equation , the regulatory functions g <dig>  …, g <dig> , … and gp,q,r in equation  can be reconstructed for the genes in the rgc at every time point. if a cis-regulatory circuit is free of any function gp, gp,q, or gp,q,r, the value of the estimated function should be very small or zero. after the functions are estimated, they can be plugged into equation  and the reconstruction of the cis-regulatory circuit of the gene of interest is completed. the flowchart for modeling, identifying and predicting a cis-regulatory circuit is shown in figure  <dig> 

in order to obtain more accurate cis-regulatory circuits, the model should include the triple interactions among the recognizing tfs; i.e., the vector g in equation  should include gp,q,r.

remark 3: if the degradation parameters λi in  are unavailable, the estimation procedure of g and λi from equation  to equation  should be modified as in methods.

two application examples
i. the cis-regulatory circuit of mfa2
suppose that the cis-regulatory circuit of the mfa <dig> gene is of interest. we construct a dynamic model of the cis-regulatory circuits of the genes in the rgc of mfa <dig> in table  <dig> and then estimate the regulatory functions and interactions by the cross-gene identification scheme. the estimated transcriptional regulatory functions gp and interactions gp,q and gp,q,r are shown as the insets in figure 1a. these insets indicate that cis elements ndd <dig>  mcm <dig> and swi <dig> in mfa <dig> all have cell cycle regulatory abilities in the late g <dig> phase. in addition, every individual cis element has a positive regulatory function on the mfa <dig> gene; for example, the function g <dig> for mcm <dig> has an obvious peak value in the transition phase late g <dig> of the cell cycle. michaelis and herskowitz  <cit>  found that the mfa <dig> gene causes the cell cycle arrest at the g <dig> phase and is required for mating in yeast. note that the interaction g <dig>  between tfs ndd <dig> and swi <dig> is very weak or absent in the cell cycle. in contrast, the interaction g <dig>  between tfs mcm <dig> and swi <dig> is dynamic; it has a high positive peak value in the late g <dig> phase, which coincides with mfa2's activity phase. this interaction seems to play an important role of positive regulation in this cis-regulatory circuit. on the other hand, the regulatory function g <dig> , <dig> of the interaction among tfs ndd <dig>  mcm <dig> and swi <dig> is negative on gene mfa <dig>  this regulation may repress the expression of gene mfa <dig> to make the expression decay to the steady state. if there is no repression function such as g <dig> , <dig>  the expression of mfa <dig> will increase and may disrupt in the cell cycle.

ii. the cis-regulatory circuit of clb2
clb proteins are crucial cyclins for completing the g2/m transition of the mitotic cell cycle and the most typical one is the b-type mitotic cyclin clb <dig>  which is required for entry into mitosis  <cit> . suppose that the cis-regulatory circuit of gene clb <dig> is of interest. fkh <dig>  fkh <dig>  ndd <dig>  mcm <dig>  swi <dig> and swi <dig> have been identified as the tfs that bind to the promoter sequence of clb <dig> <cit> . as shown in figure 1b, the possible cis-regulatory circuit of clb <dig> is very complex. using the cross-gene identification scheme, we reconstructed the cis-regulatory functions shown in figure  <dig>  although there are  <dig> possible regulatory functions, including gp, gp,q and gp,q,r, only  <dig> regulatory functions are found to have nonzero values .

the two cis elements fkh <dig> and fkh <dig> are found to have very similar regulatory functions g <dig> and g <dig>  in agreement with the experimental evidence that the forkhead family members fkh <dig> and fkh <dig> of transcription factors have overlapping roles in the control of the g2/m transition  <cit> . the regulatory function g <dig> of fkh <dig> has a distinct cell cycle regulatory ability  and especially, the interaction function g <dig>  between fkh <dig> and ndd <dig> has a strong regulatory contribution to the gene expression profile in the m/g <dig> phase. the regulatory function g <dig> of mcm <dig> has two peaks. there is experimental evidence that mcm <dig> is a member of an evolutionarily conserved class of transcription factors that have related to dna binding sequences and dimerization domains. in addition, mcm <dig> binds the early cell cycle box  that contains a mcm <dig> cis element in the swi <dig>  cln <dig>  cdc <dig>  and cdc <dig> promoters and activates m/g1-specific transcription  <cit> .

the cell cycle genes that are activated during the late g <dig> or s phase have sbf or mbf sequence-specific transcription factors that bind the cis elements in their promoter region. sbf  is a heterodimer of swi <dig> and swi <dig>  <cit> . the regulatory functions g <dig> and g <dig> of swi <dig> and swi <dig> and their interaction function g <dig>  are estimated using the dynamic expression model . it is well-known that neither swi <dig> nor swi <dig> alone has obvious cell cycle regulation ability, and indeed we found that g <dig> has only one peak and so shows no cycle and that g <dig> shows no capability of cell cycle regulation . in contrast, the combination of swi <dig> and swi <dig> to make the complex sbf enables the cis elements swi <dig> and swi <dig> to provide cell cycle regulation capacity; that is, the interaction function g <dig>  of swi <dig> and swi <dig> has a peak during the g1/s phase of the cell cycle. ndd <dig> and fkh <dig> are bound to identical promoters throughout the cell cycle and their interaction g <dig>  is an important transcriptional process targeted by the cdk activity  <cit> . in addition, there is another obvious positive interaction g <dig> , <dig> among ndd <dig>  mcm <dig>  and swi <dig> . it has a large regulatory ability in the g1/s phase, which almost dominates the expression profile of clb <dig>  in contrast, g <dig>  has a negative regulation contribution. we therefore propose that the key factor swi <dig> in the interaction g <dig> , <dig> is similar to its role in sbf and mbf. at any rate, our model suggests that swi <dig> plays a key role in the interaction among ndd <dig>  mcm <dig>  and swi <dig>  this is a new finding in the cis-regulatory circuit of clb <dig> 

we also confirm the well-known interaction among ndd <dig>  fkh <dig>  and mcm <dig> in the cis-regulatory circuits of the clb <dig> and swi <dig> genes because the interaction function g <dig> , <dig> has a distinct regulatory ability in the g2/m phase of the cell cycle . interestingly, the interaction function g <dig> , <dig> among ndd <dig>  mcm <dig> and swi <dig> is about two times higher than any of the other functions in figure  <dig>  in addition, the interaction g <dig> , <dig> among fkh <dig>  ndd <dig> and mcm <dig> is highly positive, the interaction g <dig> , <dig> among ndd <dig>  mcm <dig> and swi <dig> is mildly positive, while the interaction g <dig> , <dig> among ndd <dig>  swi <dig> and swi <dig> is negative. these observations are in agreement with the fact that the regulatory ability of an interaction among tfs is usually much stronger than that of an individual tf; in other words, there is synergy among tfs.

in summary, there are many experimental observations that support the cis-regulatory functions identified by the dynamic model and our model provides novel insights into the quantitative regulation of the cis-regulatory circuit of a gene of interest.

support from expression phases of tfs in the cell cycle
in this paper, the question of why the strengths of regulatory functions in the cis-regulatory circuits are different in different phases of the cell cycle is investigated. based on the mrna expression profiles of transcription factor genes from experiments, the distribution of the expressions of the nine tf genes in the different phases of the cell cycle is shown in figure  <dig>  in support of our results, the large positive interaction functions  among a set of tfs always occur during the expression phases of the genes of the interacting tfs. for example, for the cis-regulatory circuit of mfa <dig> , there is an obvious peak for the function g <dig>  of the interaction between tfs mcm <dig> and swi <dig> during the m phase, and in figure  <dig>  this peak indeed occurs during the expression phases of the two tf genes  <cit> . as another example, for the cis-regulatory circuit of clb <dig>  there is a strong interaction ) among ndd <dig>  mcm <dig> and swi <dig> starting from the g <dig> phase . we can therefore infer that the expression of a cell cycle gene in a specific phase of the cell cycle needs a specific inducing signal, which is mainly from the interactions of certain specific tfs that bind the cis elements of the gene.

accuracy of reconstructed cis-regulatory circuits
the accuracy of the reconstructed cis-regulatory circuit of a gene can be evaluated by reconstructing the expression profile of the gene using the reconstructed cis-regulatory circuit

y^˙i=∑pvg^p+∑pqg^p,q+∑pqrg^p,q,r+⋯−λiy^i,     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqacigacagaaeqabaqabegadaaakeaacuwgzbqwgaqcgagaamaabaaaleaacqwgpbqaaeqaaogaeiikagiaemidaqnaeiykakiaeyypa0zaaabcaeaacuwgnbwzgaqcamaabaaaleaacqwgwbacaeqaaaqaaiabdchawbqaaiabdaha2bqdcqghris5aogaeiikagiaemidaqnaeiykakiaey4kasyaaabcaeaacuwgnbwzgaqcamaabaaaleaacqwgwbaccqggsaalcqwgxbqcaeqaaogaeiikagiaemidaqnaeiykakcaleaacqwgwbaccqwgxbqcaeaaa0gaeyyeiuoakiabgucarmaaqahabagafm4zacmbakaadawgaawcbagaemicaanaeiilawiaemycaenaeiilawiaemocaihabeaaaeaacqwgwbaccqwgxbqccqwgybgcaeaaa0gaeyyeiuoakiabcicaoiabdsha0jabcmcapiabgucariabl+uimjabgkhitiabeu7asnaabaaaleaacqwgpbqaaeqaaogafmywaklbakaadawgaawcbagaemyaakgabeaakiabcicaoiabdsha0jabcmcapiabcycasiaaxmaacawljawaaewaaeaacqaixaqmcqaiwaamaiaawicacaglpaaaaaa@7216@

where g^p
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqacigacagaaeqabaqabegadaaakeaacuwgnbwzgaqcamaabaaaleaacqwgwbacaeqaaogaeiikagiaemidaqnaeiykakcaaa@32d7@, g^p,q
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqacigacagaaeqabaqabegadaaakeaacuwgnbwzgaqcamaabaaaleaacqwgwbaccqggsaalcqwgxbqcaeqaaogaeiikagiaemidaqnaeiykakcaaa@3522@ and g^p,q,r
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqacigacagaaeqabaqabegadaaakeaacuwgnbwzgaqcamaabaaaleaacqwgwbaccqggsaalcqwgxbqccqggsaalcqwgybgcaeqaaogaeiikagiaemidaqnaeiykakcaaa@376f@ have been estimated by the cross-gene identification scheme. the reconstructed profile and the observed profile are compared in figure  <dig>  we find that if the number of the cis elements of a gene is large enough, the reconstructed expression profile is very accurate; otherwise, it may be inaccurate. fortunately, although the reconstructed expression profile is not accurate in some genes, the trend of the expression profile for a gene is always correct.

prediction of gene expression profile
in the above, each regulatory circuit was identified using 95% of genes in its rgc, and the remaining 5% of genes in the rgc will now be used for predicting expression profiles, i.e., for cross validation. our cross-gene identification scheme assumes that the regulatory functions of tfs are universal in the cluster of genes with similar functions. under this assumption, our method should be able to predict the expression profiles of other genes in the same cluster that have not been employed in equation  to reconstruct the cis-regulatory circuits. this is one way to validate our model.

in figure  <dig>  we randomly chose  <dig> rgcs to test the prediction accuracy; that is, for each rgc we show the prediction result for one of the unused genes. figure 6a shows the predicted target gene and the mean square error  of prediction results which has the maximum of  <dig>  and the minimum of  <dig> . in addition, three examples of the detailed comparison between the actual and the predicted gene expression profiles are shown in figure 6b. in general, the predicted profiles are satisfactory approximations of the observed expression profiles. we found that the smaller the number of the cis elements, the less accurate the prediction results. however, if some cis elements of a gene have strong regulatory functions, the expression profiles of this gene can be predicted accurately even when the number of cis elements is small. if some genes in the rgc have the same cis elements but have different observed gene expression profiles, these expression profiles will lead to poor estimation of parameters. this is the main cause of prediction error. why does this situation arise? it may be that some cis elements of these genes have not yet been identified or there are some errors in the inference of the cis elements. for example, mmr <dig> may have another cis element gcr <dig>  <cit>  and this may be why the predicted profile is quite different from the observed profile .

discussion
in contrast to current methods, our method uses all possible expression profile information from the cluster of genes to reconstruct the cis-regulatory circuit of a target gene. in particular, our method is capable of extracting dynamic interactions among tfs. for this reason, the analysis and interpretation of output expression profiles become straightforward. therefore, our method has a high potential for applications such as studying variations of the cis-regulatory circuit of the same gene in different yeast strains to investigate the regulatory evolution of the gene.

the contributions of this study include:  a nonlinear dynamical model is developed for cis-regulatory circuits in terms of regulatory functions and interactions among tfs,  a cross-gene identification scheme is proposed to estimate many parameters involved in the dynamical model of cis-regulatory circuits from the expression profiles of genes in the reference gene cluster,  a detailed identification of the dynamic cis-regulatory abilities of tfs, which vary with time, and  a gene expression prediction method is developed by the proposed dynamic cis-regulatory circuit, assuming that the cis-regulatory functions of the same tfs in different circuits are the same. three advantages of our method over current methods are that the cis-regulatory circuit is constructed with the circuit structure intact, that it uses the expression profiles of many genes simultaneously to obtain extra information, and that it is dynamic and quantitative.

significantly, our model not only can confirm known regulations but also can provide conjectures for experimental verification. consider the key positive cis-regulatory function g <dig>  in figure 1a. we propose that during the expression of gene mfa <dig>  the transcription factor ndd <dig>  communicates with the transcription factor mcm <dig>  to transmit a specific signal to induce the expression of the mfa <dig> gene. such conjectures from the reconstructed cis-regulatory circuits may be useful for studying the regulatory evolution of genes by comparing the cis-regulatory functions of different strains, or for predicting the gene expression behavior before conducting an experiment.

however, we found poor results in some cases. for example, in figure  <dig>  we were unable to find the basal regulatory function g <dig> of individual swi <dig> or the interaction g <dig>  between fkh <dig> and mcm <dig> for gene clb <dig>  <cit> . these regulatory functions have not been identified by our scheme because they have no obvious specific phase regulatory ability. besides, from the cis-regulatory functions in figures  <dig> and  <dig>  several cis-regulatory function profiles did not show a clear periodicity. a possible reason may be that the original microarray data were noisy and the use of cubic spline interpolation and linear transformation of microarray data in our scheme had introduced new noise and distortions. most probably, the cis element information used to construct the cis-regulatory circuits under yeast cell cycle is not complete; only nine significant cis elements were considered in this study to reduce the complexity of the mathematical model. another possible source of error is that we have not considered the order of the cis elements on the promoter region, which may affect the strength of the interaction between tfs  <cit> . such differences, however, can be incorporated by putting, say both gp,q and gp,q,r, into the model.

in view of the facts that there are uncertainties about the cis elements of some of the genes studied and that microarray data are noisy, it is remarkable that our method gave accurate results for the expression profiles of the majority of the cell cycle genes studied and also gave fairly accurate predictions of the expression profiles of other cell cycle genes. in the future, if better cis elements data and more accurate and longer gene expression profile data become available, we should be able to improve the reconstruction of cis-regulatory circuits. also, our approach may be extended to reconstruct cis-regulatory circuits in more diverse conditions and more complex eukaryotes. after cis-regulatory circuits are accurately described by explicit dynamical equations, some applications will be straightforward.

CONCLUSIONS
in this study, we assume that the regulatory functions of the same cis elements and the interaction functions among their tfs are similar across genes within the cluster of genes with overlapping cis elements; i.e., the regulatory functions and interaction functions are universal in this cluster of genes. under this assumption, the cross-gene identification scheme takes advantage of cross-information enhancement to improve the accuracy of parameter estimation. the number of genes used should be large enough, so that we have a large number of outputs  for parameter estimation.

after the parameters of the cis-regulatory circuits of interest have been estimated, the circuits can be explicitly described by plugging these parameters into their corresponding dynamic equations. moreover, these estimated functions and interactions can be used to predict the expression profiles of other genes that share the same cis-regulatory elements but have not been used to identify the cis-regulatory circuits. in this manner, we can evaluate the performance of the proposed dynamic model of cis-regulatory circuits. from a number of examples, we have found that the predicted results are in most cases satisfactory, confirming the validity of the proposed dynamic model of cis-regulatory circuits. our modeling represents a new approach to studying cis-regulatory circuits from cross-gene expression data. it is a systems biology approach because we consider the regulatory circuits of many genes and many tfs at the same time and we use system identification techniques to estimate the parameters of the circuits. the results of expression prediction from experimental data suggest that our novel approach is suitable for deciphering the regulatory functions and the cooperativity of the tfs that regulate the expression of a gene.

