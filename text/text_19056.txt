BACKGROUND
in order to characterize the molecular basis underlying self-renewal versus differentiation decision-making process we investigated the transcriptomic changes of various states related to this process, in two model systems : one derived from chicken and the other from human cells. we decided to use serial analysis of gene expression   <cit>  to attain this aim, for a number of reasons including the absence of available pan-genomic dna arrays in the chicken and the ability to compare sage libraries across different experiments. we therefore had to resolve two problems : tag-to-gene mapping in chicken and comparing sage libraries from two different species .

serial analysis of gene expression is a comprehensive method for analyzing transcriptomes  without any a priori regarding the genes to be studied. it can be used with mrnas derived from cells of any eukaryotic species. sage is based on the isolation of a unique sequence tag from each individual transcript and on serial concatenation of several tags into long dna molecules. sequencing of concatemer clones reveals individual tags and allows quantification and identification of transcripts. tag counts are digitally archived and statistically significant comparisons of expression levels can be made between tag counts derived from different populations of cells.

an essential step in sage library analysis is the unambiguous assignment of each  <dig> bp tag to the transcript from which it was derived. this process, called tag-to-gene mapping, represents a step that has yet to be completed in the analysis of sage libraries. the automated version of this process mostly involves extracting "virtual tags" from sequence databanks : these virtual tags are predictions of the  <dig> bp sequences that might be produced by a sage experiment. the quality of the databanks from which the virtual tags are extracted represents a limiting step in this process. ideally, the databanks should represent the complete collection of each and every transcript, fully sequenced and annotated. this clearly has yet to be achieved for most species, and therefore one must use the available information that comes mainly from large est  projects.

different resources have already been described for tag identification in human and mouse, including the sage map  <cit> , the sage genie  <cit> , the melbourne brain genome project  <cit> , the mouse sage site  <cit>  and the human transcriptome map  <cit>  web sites, but fewer resources are available for tag-to-gene mapping in other species. nevertheless, a very large number of species have been subjected to a sage analysis  and actually the sage map web site hosts a sage tag to unigene mapping for  <dig> species . however, this site doesn't include tag to unigene mapping for several other species for which numerous est and cdna have already been sequenced. this is the reason why we designed and implemented a freely available tool for tag identification that can be used in any species for which transcript sequences are available. it can include both complete cdnas and est cluster sequences and allow to interrogate the database according to the source of data, to assess the quality of virtual tags derived from different transcript sequences. in this paper we describe the use of this tool for the chicken  where a large est sequencing effort was completed  <cit> .

in order to allow rapid and easy storage and updating of data and, most importantly, in order to be able to query the results using sophisticated combinations of criteria, we have designed a relational database structure. we implemented this relational database called identitag using the freely available mysql database management system   <cit> .

one important function of identitag is the possibility to compare the tags obtained in a given species to their counterpart present in another species. this allows a direct comparison of sage transcription profiles obtained from different species. to the best of our knowledge, this is the first tool that allows sage libraries interspecies comparison : this open the way to comparative transcriptomic analysis.

here we describe the use of identitag for chicken sage tag identification as well as for chicken to human interspecies comparison.

implementation
database for tag identification : identitag
database organization
the identitag relational schema is presented in figure  <dig>  and a complete data dictionary of the database is available on the identitag web site . we implemented this database using the freely available and cross-platform mysql dbms. a perl script which generates the sql script creating identitag tables according to the name of the species considered, is also available on identitag web site.

completing the database
various sources of data presented in figure  <dig> are needed to complete identitag. transcript sequences in fasta format and a file resulting from their comparison with protein from databanks using the blastx algorithm  <cit>  are needed for completing the first and third identitag modules. for chicken identitag we used various transcript sequences :  <dig> chicken mrna from genbank  and  <dig> sigenae chicken est cluster consensus sequences . as consensus sequence orientation is not always known, we used both sequences and their reverse complementary. then we could assess the correct orientation of the sequences using various sources of information stored in identitag database . for completing the second module, a flat file with tag sequences and their relative frequency is required, for each library. so far in chicken identitag we have stored four different libraries generated from normal chicken immature erythroid progenitors called t2ecs  <cit> . the first two libraries were generated from self-renewing t2ec cells and from t2ec cells induced to differentiate for  <dig> hours respectively  <cit> . the last two libraries have been generated from t2ec cells treated with two inhibitors of the mek- <dig> signaling pathway which is important for maintaining self-renewal . for these four libraries, we used sage  <dig> software  <cit>  in order to extract tags from concatemer sequences : we generated  <dig> files for the  <dig> sage libraries considered, with  <dig>   <dig>   <dig> and  <dig> tags respectively.  <dig> different tags appear more than once in these  <dig> libraries.

several programs were then used for loading these data into identitag database. they are written in perl and shell and are available on identitag web site. a shell script that allows to launch all these programs is also available on this web site : it asks for all information required by these different programs, then launches all programs with adapted arguments and loads the files generated by these programs in the corresponding identitag tables. the creation and completion of identitag tables with these programs was successfully tested on sun, linux and mac os x operating systems.

querying the database
the completed database can be interrogated using sql  and allows a number of tag identification procedures to be launched .

redundancy reduction
when several transcripts identify a same tag, these transcripts are compared with each other using blastclust  <cit>  to determine whether they correspond to redundant sequences of the same transcript or to different transcripts. we consider that two sequences are redundant if they share more than 95% similarity over more than  <dig> bp.

database for interspecies comparison of sage libraries
we connected two identitag databases from two different species by using orthology relationships between transcripts that identify sage tags .

design of the orthology relationship
we designed a method for identifying transcript sequence pairs that are putatively orthologous between the two species considered. this method  is an approximation of the search for reciprocal best blast hits for two datasets with redundancy and that do not represent the entire transcriptome of the two species considered.

the first step of this method  consists of two reciprocal tblastx. first, we compare each species a transcript with a databank containing species b transcripts, using the tblastx algorithm  <cit>  ). we store all the best hits for which the corresponding e-value is less than  <dig>  : all these sequences form a subset of species b transcripts. second, we compare each sequence from this subset with a databank containing species a transcripts, using the tblastx algorithm ). we further consider corresponding best hits harboring an e-value lower than  <dig> , they form a subset of species a transcripts that are considered for further analysis.

the second step  consists in staring only pairs of transcript sequences sufficiently similar between tblastx and tblastx. for example, transcript sequence a <dig> is similar to transcript sequence b <dig> ), and transcript sequence b <dig> is similar to transcript sequence ax ). if the two transcript datasets were complete and non-redundant, x should be equal to  <dig> : when that is the case, a <dig> is paired with b <dig>  if not, we search if ax transcript sequence is redundant with a <dig>  with the same criteria as described above to asses if two sequences are redundant. if ax is similar to a <dig>  we further consider the pair a1-b <dig>  if not, the a1-b <dig> pair is discarded from further analysis. we use the same method for each transcript pair obtained in first step.

if the set of transcripts from species a and b are not complete, the best reciprocal hits might correspond to paralogs . to limit this risk of erroneous orthology assignment we consider the pairs stored in previous step: we compare the species a transcript sequence from each pair with species b proteins from swissprot and trembl databanks, using the blastx algorithm . we compare the best resulting hit  with the species b transcript putatively orthologous to species a transcript : if these two sequences are similar , we consider the pair of the species a transcript and the species b transcript as a pair of orthologous sequences. if these two sequences are not similar, it means that protein databanks contain a species b sequence that is more similar to species a transcript than the species b sequence found using best reciprocal hit. thus the pair of the species a transcript and the species b transcript might correspond to a pair of paralogous sequences.

these three steps allow us to obtain pairs of transcripts which are probably orthologous, by trying to eliminate erroneous assignments of orthology for paralogous sequences instead of orthologous ones. however a limiting aspect of this method is the identification of only 1- <dig> orthology relationships : if one transcript sequence from species a has several orthologous sequences in species b this method will only identify one of the pairs of orthologous sequences. the scripts that implement this method are available on identitag web site.

we applied this method to chicken and human. for this we used chicken transcript sequences from genbank, chicken sigenae est cluster consensus sequences and human transcript sequences from refseq release  <dig> .

connecting two identitag databases by using this relationship
the database for interspecies comparisons of sage libraries is composed of two identitag databases for tag identification in two different species, and connected through the speciesa_speciesb_transcript table . a shell script available on identitag web site asks for all information required. then it searches for putative orthologous sequences using the method previously described, creates the table speciesa_speciesb_transcript, and then loads corresponding data in this table.

RESULTS
the use of identitag for identification purpose
database organization
identitag can be depicted as three interconnected modules, as presented in figure  <dig> 

the first module stores data concerning transcript sequences and virtual tags extracted from these sequences. the species_transcript table contains transcript identification , together with information that can then be used for assessing the quality of the "virtual" sage. the quality of virtual tags depends on the source of the transcript sequence from which it was derived , this is why this information is stored in the species_transcript table. other information can also be used for assessing the quality of the "virtual" sage. this information allows one to assess if a transcript sequence is complete and if its orientation correct. this includes the presence or absence of different polya signals  as well as their localization along the sequence and the length of the possible poly a tail. this length corresponds to the longest poly a stretch among the  <dig> last base pairs of the transcript sequence : this calculation allows us to take into account the polya tail even if there are some bases belonging to a cloning vector or sequencing errors at the end of the corresponding transcript sequence. some of the est we used were labeled as constructed and sequenced from the 3' region. when available this information was stored in the database. the species_transcript table is linked with an nn relationship to the species_virtual_tag table. this table contains virtual tags extracted from the transcript sequences and information about how the tags were extracted. this includes the anchoring enzyme considered  and the position of its recognition site in the transcript sequence : the species_virtual_tag table stores both the  <dig> bp sequence immediately downstream of the most 3' anchoring enzyme recognition site and  <dig> bp sequence downstream of the next-to-last anchoring enzyme recognition site. indeed, the cutting enzyme may on rare occasions  cut not its most 3' but its recognition site that is just 5' from the last one . both conventional  <dig> bp tag sequences as well as virtual long-sage  <dig> bp tag sequences  <cit>  are stored in the species_virtual_tag table.

the second identitag module allows storage and retrieval of the experimental part of the sage experiments. it consists of a table containing information about the construction of sage libraries , connected with a table that stores tag sequences from that sage library and their corresponding count .

the connection between modules  <dig> and  <dig> leads to a direct comparison between observed and virtual tags : it is the key to the tag identification procedure. only perfect matches are allowed at that stage.

the third identitag module allows annotation of transcript sequences from which virtual tags are extracted, via their similarity to known proteins. for this purpose we compare each transcript sequence with the protein sequences from swissprot and trembl databanks, using the blastx algorithm  <cit> . for this sequence comparison we only consider the same transcript sequence orientation as the orientation that we used for tag extraction. when available, the best blastx hits  are stored in identitag , together with different blast statistics . this information can then be used for assessing the quality of the annotation.

identitag web site provides all scripts necessary to build a such identitag database and to load all data into this database, for any species from which transcript sequences are available. to do this one need data represented in figure  <dig>  after running the main script one just have to answer all questions asked by the script and then all tables of the database are created and completed, for the species considered.

various identification situations
identitag can be interrogated in various ways, using different identification criteria concerning the quality of the virtual sage and the annotation provided. for example, the interrogator can use the following step-by-step procedure , for each observed tag from the sage experiment considered  :

 <dig>  if the observed tag matched to no virtual tag, then it is declared unidentified and the identification process is aborted : approximately 25% of the tags belonging to the four chicken sage libraries we have studied are unidentified. if this is not the case it means that the observed tag corresponds to a virtual tag extracted from one or more transcript sequence ; the identification process proceeds to the next step.

 <dig>  if these transcript sequences are not annotated , the observed tag is identified as matching non-annotated est cluster : 37% of the tags belonging to the four chicken sage libraries we studied correspond to non-annotated est cluster. then we distinguish tags identified as matching one est cluster  or more than one est clusters. for tags corresponding to more than one est clusters, we compare these sequences to determine whether they are redundant or not. indeed, there could be redundancy in transcript databanks based on est clusters due to the threshold for sequence similarity being to high to assign different est to the same cluster. therefore, there could be different est clusters corresponding to the same transcript. this is the reason why we use the procedure described in implementation section to identify sequence redundancy. among the tag identifications corresponding to more than one est clusters, 19% correspond to redundant sequences. finally, 65% of identifications corresponding to non-annotated est cluster are unambiguous . if the observed tag does not correspond to previous identification cases, it means that the observed tag corresponds to a virtual tag extracted from one or more annotated transcript sequence and the identification process proceeds to the next step.

 <dig>  if there is only one annotated transcript sequence from which this virtual tag has been extracted, then the protein name  is used to identify this tag and the identification process is stopped : 26% of the tags belonging to the four chicken libraries we studied correspond to this identification case. we call these tags "annotated tags". when this is not the case it means that the observed tag corresponds to a virtual tag extracted from different annotated transcript sequences ; the identification process proceeds to the next step.

 <dig>  if the different transcript sequences have the same annotation , then the protein name is used as the identification and the identification process halts. this case is mainly due to transcript databank redundancy. thus by using annotation to identify sage tags, we reduce the number of multiple matches. as in previous identification situation we designate the corresponding tags as "annotated tags" because their annotation is not ambiguous : 4% of the tags belonging to the four chicken libraries we studied correspond to this identification case. when this is not the case it means that the observed tag corresponds to a virtual tag extracted from several transcript sequences differently annotated ; the identification process proceeds to the next step.

 <dig>  the last case corresponds to an observed tag matching to more than one transcript sequences with more than one different annotations. this corresponds to 8% of the tags belonging to the four chicken sage libraries we studied. by using annotation to identify sage tags, we reduce the number of multiple matches that may occur because of redundancy in transcript databanks. nevertheless, some of these multiple matches remain. this may occur because there is redundancy in protein databank, thus the redundant transcripts can be differently annotated : this leads to a multiple match. it also appear when redundant transcripts match to the same protein but in different species. indeed the annotation is provided by a blastx against swissprot and trembl databanks  : thus we could annotate transcripts for which we don't already know the corresponding protein in the species considered, but which is identified in another species. however, this method presents the drawback of causing multiple matches when redundant transcripts match to the same protein in different species. this case is considered as a multiple match because the best blastx hits of transcripts identifying the same tag are different. to reduce these two cases of ambiguity, we align the different transcript sequences identifying the same tag  : according to the sequence similarity between them we could avoid these cases of multiple matches. among the  <dig> identifications corresponding to more than one transcript sequences with more than one different annotations in our four chicken libraries, 28% could be discarded by this method. the cases of multiple matches remaining occur presumably mainly due to different transcripts that really have the same tag.

we provide an example illustrating the repartition of these different situations regarding tag identification in the chicken libraries we studied . when we don't consider the next-to-last tag during the identification procedure, we reduce the number of multiple matches, but increase the number unidentified tags.

this process could be pursued further by discriminating between multiple matches, using criteria concerning the quality of the virtual sage, e.g. the quality of the transcript sequences , the tag position in the transcript sequence  and/or the availability of the transcript sequence end.

one can also consider a process for tag identification based only on high quality tag identifications. for example, one could obtain an identification based solely on cdna sequences, or only using tags appearing at the last position. one can also use any logical combination of the above criteria.

the use of identitag for interspecies comparison of sage libraries
in order to directly compare sage libraries performed in chicken  with those performed in human , one first needs to associate each chicken tag with its human counterpart. for this we decided to connect the chicken identitag to its human counterpart. this connection relies upon the concept of orthology   <cit> . two genes in two different species are said to be orthologous if they diverged after a speciation event. it is important to note that conservation of function is not part of the definition of orthology, but rather its consequence. it can also be envisaged that after the speciation event, the function of the resulting genes diverged in the two species. a tool for interspecies comparison of expression data would be very helpful for investigating such questions, and notably the level of conservation in expression patterns of orthologous genes, a task that has only begun using dna arrays .

the structure of identitag was originally designed with this purpose in mind and therefore chicken and human identitag could easily be connected together . for example, this procedure will allow the chicken gata- <dig> tag  to be associated with its human counterpart  via the chicken transcript gata- <dig> <-> human transcript gata- <dig> orthology. we designed a method for identifying transcript sequence pairs that are putatively orthologous between the two species considered. this method  is an approximation of the search for reciprocal best blast hits for two datasets with redundancy and that do not represent the entire transcriptome of the two species considered. we first perform two reciprocal tblastx between species a and species b transcript sequences  and tblastx). we then conserve only the pairs of transcript sequences originating consistent tblastx and tblastx results. we finally consider previously obtained pairs in order to limit erroneous assignment of orthologous pairs for paralogous ones. for a more precise description of the design of this design of orthology relationship see implementation section.

among the  <dig> transcripts corresponding to unambiguously identified tags from our  <dig> chicken libraries ),  <dig> have a human orthologue as previously defined. therefore the corresponding tags can now be translated into their human counterpart and thus sage libraries from two different species can be compared.

discussion
we have designed and implemented a tool allowing the identification of sage tags, based on a relational database. this structure allows to use identitag in two different ways.

first one can precisely choose identification criteria and obtain only the tag identifications provided by using these criteria. one can specify different criteria and thus determine the quality of the identification : e.g. identification generated from est clusters or mrna sequences, from last or next-to-last tag, presence of the 3' end of the transcript sequence that could be inferred through the presence of a 3' label or a poly a tail and/or signal. one can also specify different criteria allowing the quality of the annotation to be controlled, e.g. quality of the similarity between transcript and protein sequences through blast parameters, quality of the protein sequence used to annotate the transcript via the databank from which the protein originated  and its species . all these criteria can be combined allowing the investigator to perform sophisticated interrogations of the database. to the best of our knowledge it is the first tool that allows the user to precisely adjust the identification parameters depending upon its needs.

the second way to use identitag is to ask for all identifications available, for example for a tag of interest, and how these identifications have been generated : it is then possible to consider all these identifications and to further choose among the different identifications if necessary.

these two different ways of using identitag can be used for any species for which transcript sequences are available. identitag is an open source tool, the programs necessary to build and run the database are available on the identitag web site . identitag can therefore be used to build a tag-to-gene mapping procedure in any species, using a flat file containing transcript sequences and a blastx file results as input of these programs.

identitag was successfully used for tag-to-gene mapping in chicken. it played a key role for allowing biological interpretation of the sage libraries obtained from normal chicken erythroid progenitor cells and allowed us to better understand the changes underlying the self-renewal versus differentiation-making process in these cells  <cit> . among the identifications provided by identitag, a few were investigated further and the vast majority of these identifications were subsequently confirmed by real-time pcr  <cit> . identitag has also been successfully used for tag-to-gene mapping in bombyx mori .identitag is currently in use to identify human tags from sage libraries generated in order to investigate the molecular basis underlying the self-renewal versus differentiation decision-making process in human cells.

the next step will be to compare gene expression patterns between our chicken and human model systems, in order to study the possible conservation of the molecular basis of self-renewal during evolution. comparisons of gene expression between two organisms have recently been initiated with dna arrays . but it is one on the main limitations of dna arrays that comparisons between experiments done in different laboratories  are at best approximate. it is one of the main advantage of the sage technique for which results can be compared without the need for sophisticated and approximative normalization procedures. the sage technique is therefore ideally suited for quantitative comparisons to be performed between different libraries made from different cell types in different laboratories. we therefore expect that identitag will become a standard tool for comparative transcriptomic analysis using sage data, an emerging branch of biology consisting in the comparison of large scale transcriptomes obtained from various cell types belonging to different species.

CONCLUSIONS
identitag is a flexible and powerful tool for tag identification in any single species and for interspecies comparison of sage libraries. it opens the way to comparative transcriptomic analysis, an emerging branch of biology.

availability and requirements
• project name: identitag

• project home page: 

• operating system: sun, linux, mac os x

• programming languages: perl, bourne shell, mysql

• license: gnu gpl

authors' contributions
ck participated to the design of identitag, implemented identitag, and participated to the biological validation of identitag with sage libraries. fd constructed the first two sage libraries with which identitag was tested and participated to the biological validation of identitag with these data. ld and dm brought their expertise in the orthology area, in order to design the orthology relationship. og supervised this work. all authors participated in the writing of the manuscript, read and approved the final manuscript.

