BACKGROUND
experiments have demonstrated the presence of considerable cell-to-cell variability in mrna and protein numbers  and slow fluctuations on timescales similar to the cell cycle  <cit> . broadly speaking, there are two plausible causes of such variability. one is the inherent stochasticity of biochemical processes which are dependent on small numbers of molecules. the other relates to differences in numbers of protein, mrna, metabolites and other molecules available for each reaction or process within a cell, as well as any heterogeneity in the physical environment of the cell population. these sources of variability have been dubbed as “intrinsic noise” and “extrinsic noise”, respectively.

one of the earliest investigations into the relationship between intrinsic and extrinsic noise employed two copies of a protein with different fluorescent tags, expressed from identical promoters equidistant from the replication origin in e. coli  <cit> . by quantifying fluorescence for a range of expression levels and genetic backgrounds the authors concluded that intrinsic noise decreases monotonically as transcription rate increases while extrinsic noise attains a maximum at intermediate expression levels. other studies have considered extrinsic noise in the context of a range of cellular processes including the induction of apoptosis  <cit> ; the distribution of mitochondria within cells  <cit> ; and progression through the cell cycle  <cit> . from a computational perspective, extrinsic variability has been modelled by linking the perturbation of model parameters to perturbation of the model output using a range of methods, including the unscented transform  <cit>  the method of moment closure  <cit> , and density estimation  <cit> .

taniguchi et al.  <cit>  carried out a high-throughput quantitative survey of gene expression in e. coli. by analysing images from fluorescent microscopy they obtained discrete counts of protein and mrna molecules in individual e. coli cells. they provided both the measurements of average numbers of protein and mrna molecules in a given cell, as well as measurements of cell-to-cell variability of molecule numbers. the depth and scale of their study revealed the influence of extrinsic noise on gene expression levels. the authors demonstrated that the measured protein number distributions can be described by gamma distributions, the parameters of which can be related to the transcription rate and protein burst size  <cit> . to quantify extrinsic noise they consider the relationship between the means and the fano factors of the observed protein distributions. they also illustrate how extrinsic noise in protein numbers may be attributed to fluctuations occurring on a timescale much longer than the cell cycle.

here we aim to describe extrinsic noise at a more detailed, mechanistic, level using a stochastic model of gene expression. a relatively simple mechanistic model of gene expression may represent mrna production as a zero order reaction with protein being produced from each mrna via first order reactions. this can be described as the one-state model since the promoter is modelled as being constitutively active . in the one-state model, mrna production is represented by a homogeneous poisson process and the fano factor of the mrna distribution at any time point will be one. however, experimental counts of mrna molecules in single cells indicate that the fano factor is often considerably higher than one  <cit> .
fig.  <dig> schematic representations of the one- and two-state models. in the one-state model , mrna is produced at a constant rate . protein is produced from mrna with first order kinetics at a rate k
 <dig>  both mrna and protein molecules are degraded according to first order kinetics with rates d
 <dig> and d
 <dig> respectively. the two-state model  has the added feature of two promoter states. in the inactive state the promoter produces mrna at a fraction  of that of the active state. switching between the two states corresponds to a telegraph process characterised by two rate constants 



such a description calls for quantitative inference of the model’s parameters. we achieve this by relying on the data made available by taniguchi et al. and employing approximate bayesian computation   <cit> . one difficulty that arises when trying to investigate the extent and effect of extrinsic noise is that it is difficult to separate it from intrinsic noise. to overcome this confounding effect, the parameters of our model come in two varieties. firstly, reaction rate parameters describe the probability of events occurring per unit of time. these correspond to the reaction rate parameters of a typical stochastic model which accounts for intrinsic noise. secondly, noise parameters describe the variability in reaction rate parameters caused by the existence of extrinsic noise. in this model, extrinsic noise is represented by a perturbation of the model’s rate parameters using a truncated gaussian distribution. the magnitude of the perturbation of each rate parameter depends on the corresponding noise parameter, which is closely related to the standard deviation of the relevant gaussian . this approach allows us to simultaneously infer the rate parameters and the magnitude of extrinsic noise and may be thought of as an application of mixed effect modelling  <cit>  in the context of exact stochastic simulation.

stochastic simulation and abc inference methods are both computationally costly endeavours. in this particular case, the experimental data corresponds to snapshots of the system at a single time point. the data are made available in the form of summary statistics, measures of central tendency  and statistical dispersion .

thus, a complete temporal trajectory of the system is not necessary to carry out comparisons with the data. this allows us to make the problem computationally tractable. to this end, we develop a model-specific simulation method which takes advantage of the poissonian relationship between the number of surviving protein molecules produced from a given mrna molecule and its lifetime, under certain assumptions.

RESULTS
posterior distributions of parameters
we begin our analysis by examining the posterior distributions of parameters obtained for each gene using the abc sequential monte carlo  inference procedure  <cit>  a selection of distributions is shown in fig.  <dig> and the additional files  <dig>   <dig>   <dig> and  <dig> supplementary figures. the simulated summary statistics converged to within the desired threshold of the experimental measurements for  <dig> out of  <dig> genes. the inferred posterior for the one remaining gene converged relatively slowly and we chose to terminate the process after  <dig> days of cpu time.
fig.  <dig> posterior distribution of summary statistics and the mrna degradation rate for the gene dnak. contour plots indicating the density of points with the corresponding summary statistic for each particle in the final population. the summary statistics for each particle are calculated from  <dig> simulation runs. the posterior distribution consists of  <dig> particles

fig.  <dig> posterior distribution of model parameters for the gene dnak. contour plots indicating the density of points with the corresponding parameter values for each particle in the final population. the posterior distribution consists of  <dig> particles



we begin with a discussion of features of the posterior parameter distributions, that are common to most genes. next, we examine the relationships between model parameters and summary statistics of the model outputs. lastly, we carry out a sensitivity analysis on the inferred posteriors to assess the importance of each parameter in setting the overall levels of extrinsic noise.

in the two-state model, the switching of the promoter between active and inactive states is described by a telegraph process that can be parametrised either in terms of the switching reaction rates  or in terms of the on/off bias  and frequency of switching events  . the simulation algorithm takes parameters in the form of kon and koff. however, the effects of kr and kf on the observed mrna distribution may be interpreted more directly and intuitively.

for the majority of genes the k <dig> and kr parameters are relatively small. this appears to be a prerequisite for a high fano factor of the mrna distribution and the mean marginal inferred values of these parameters are negatively correlated with fano factors across all  <dig> genes as discussed below. a low switching rate combined with a low basal expression rate ensures that there are two distinct mrna expression levels. this in turn produces a larger variance in measured mrna counts and results in fano factor values well above one. conversely, genes for which mrna production appears to be more poissonian were inferred to have basal mrna production rates close to one, i.e. similar to the active mrna production rates. in other words, these genes appear to be constitutively active. here again, we point out that the two-state promoter model provides a convenient abstraction and a hypothesis for explaining the super-poissonian variance in mrna copy number  <cit> . however, based on these observations it is difficult to determine whether a model with more states or some other more elaborate regulatory model, would not be more appropriate. our attempts at carrying out the inference procedure with a one-state model indicate that extrinsic noise alone does not explain the observed mrna distributions without also producing unacceptably high variability in protein numbers.

our initial inference attempts used only the summary statistics from the data. we observed that the production and degradation rate parameters for mrna  and protein  tended to be positively correlated in the posterior parameter distributions of many genes. this is due to limited identifiability of model parameters since different combinations of rates may produce similar steady state expression levels. we included the mrna degradation rate in the inference procedure with the aim of overcoming the problem of unidentifiable parameters. however, this did not alleviate the problem entirely and there is still considerable uncertainty, or sloppiness, in the posterior with regard to some directions in parameter space. while this does make it difficult to pick precise parameter values it also illustrates how using abc provides us with a way of measuring the model’s sensitivity to changes in parameters. our approach provides an indication of the possible range of extrinsic noise values that can account for the observed variability in mrna and protein numbers .

although the posterior summary statistics  are reasonably well constrained and distinct for each gene, the distributions of model parameters can still be relatively broad . there are a number of reasons for this. firstly, changes in parameters associated with active transcription and translation, as well as degradation rates, are more easily inferred than parameters describing switching between promoter states, basal transcription or extrinsic noise. in particular, when the production and degradation rates for the same species are subjected to different extrinsic noise parameters, the inference procedure struggles to resolve between the different source of extrinsic noise. this explains the correlation between the means of inferred extrinsic noise parameters . such correlations between extrinsic noise parameters are not observed in the posterior of each gene or when taking the single particle with the highest weight from the final population of each gene as in fig.  <dig> 
fig.  <dig> relationships between means of the marginal parameter posteriors. scatter plots of the means of the marginal distributions of parameter posteriors are shown for all pairs of parameters. each point corresponds to a gene. warmer hues are used to indicate a higher density of data points

fig.  <dig> relationships between the heaviest particles. scatter plots of the particles with the highest weight in the final abc-smc population, shown for all pairs of parameters. each point corresponds to one particle from the inferred posterior of one gene. warmer hues are used to indicate a higher density of data points



a comparison of figs.  <dig> and  <dig> suggests that a certain level of extrinsic noise is expected for all genes. however, the extrinsic noise may affect various combinations of rate parameters and it may not be possible to discern if, for example, the production rate or the degradation rate is more affected by extrinsic variability. while our inference procedure does not indicate a distinctive lower boundary for the amount of extrinsic noise affecting each reaction rate, there is usually an upper limit to the inferred noise parameters ranges. the extrinsic noise parameters for most genes are below  <dig>  in the units set here ; however, for some genes, ηkon and ηkoff have relatively broad posterior marginal distributions.

to better understand the relationship between model parameters and observed patterns of gene expression, we look for correlations between means and variances of the inferred marginal parameters of each gene and the summary statistics used in the inference procedure . as expected, the correlation between the measured mrna degradation rate, calculated form mrna lifetime, and the inferred mrna degradation rate parameter of the model, is close to one.
fig.  <dig> heat maps of correlation coefficients between parameters and summary statistics. heat maps are of the correlation coefficients calculated between experimentally obtained summary statistics and the mean  or the variance  of the marginal posterior for each model parameter. correlation coefficients for which the associated p-values are greater than  <dig> , after correcting for multiple testing using the benjamini-hochberg method  <cit> , are treated as zero for plotting purposes



the promoter switching rate parameters, kon and koff, display positive and negative correlation with the mean mrna number, respectively . they have the opposite relationship with the fano factor associated with the mrna distribution. this is consistent with the idea that distinct levels of transcription are required to account for the observed mrna fano factors. the corresponding extrinsic noise parameters ηkon and ηkoff are positively correlated with mrna abundance. however, the means and variances of the marginal distributions of these parameters are negatively correlated with the fano factor of the mrna distribution. this indicates that when promoter switching is affected by higher extrinsic noise, the mrna distribution becomes more poissonian as the effect of the two distinct promoter states is averaged out.

curiously, the mean and variance of the protein degradation rate  are positively correlated with mean mrna number and negatively correlated with the mrna fano factor. unlike the translation rate , it shows no significant correlation with the mean or variance of the protein number.

parameter sensitivity
there are two complementary approaches to investigating the sensitivity of a modelled system to its parameters or inputs  <cit> . one approach is to consider a single point in parameter space and study how the model responds to infinitesimal changes in parameters. this local approach usually involves calculating the partial derivatives of the model output with respect to the parameters of interest. alternatively, one may consider how the model behaviour varies within a region of parameter space by sampling parameters and observing model behaviour. regardless of the method used, different linear combinations of parameters will affect the model output to varying degrees  <cit> . gutenkunst et al.  <cit>  coined the terms “stiff” and “sloppy” to describe these differences. they defined a hessian matrix, 
 hi,jχ2≡d2χ2dlogθidlogθj,  where χ <dig> provides a measure of model behaviour, such as the average squared change in the species time course. by considering the eigenvalues of this hessian, λi, the authors were able to quantify the  responsiveness of the system to a given change in parameters. conceptually, moving along a stiff direction in parameter space causes a large change in model behaviour; conversely moving along a sloppy direction results in comparatively little effect on the output of the system.

secrier et al.  <cit>  later demonstrated how these ideas can be applied to the analysis of posterior distributions obtained by abc methods  <cit> . principal component analysis  may be used to approximate the log posterior density using a multivariate normal  distribution. they showed that the eigenvalues of the covariance matrix, si, of this mvn distribution are related to the eigenvalues of the hessian as λi=1/si.

to assess the the stiffness/sloppiness of the inferred parameters we carry out pca of the covariance matrices of log posterior distributions for each gene. in interpreting the results of the pca we assume that the posterior distribution is, in practice, unimodal. the principal components , ν, and the corresponding loadings , s, provided by the pca are then used to obtain the eigen-parameters, q, as 
 qi=siνi. 

we calculate the projections of each parameter, θi, onto each eigen-parameter, qj, as 
 cij=θi·qj. 

as a measure of the overall sloppiness of each parameter, l, we use the sum of the contributions of each parameter to the eigen-parameters, li=∑jcij. this can also be thought of as the sum of the projections of each principal component onto the parameter, weighted by the fraction of total variance explained by each of the principal components.

having obtained a measure of the sloppiness of each parameter, for each gene, we carry out hierarchical clustering  <cit>  of genes and parameters using a euclidean distance metric for both .
fig.  <dig> clustering of genes and inferred posteriors according to parameter sloppiness. the clustergram shows a heat map of parameter  sloppiness for each gene . warmer hues indicate more sloppy parameters. dendograms above and to the left of the heat map display the hierarchical tree obtained when clustering either the model parameters or the genes using a euclidean distance metric



the majority of genes show a similar pattern of parameter stiffness/sloppiness. the most distinctive and the second most distinctive clusters consist of just two genes each, yiiu with acee and cspe with map, respectively. these four genes are distinguished by unusually sloppy promoter activity ratio, kr, and promoter switching frequency, kf, parameters. the pair yiiu and acee display a high ratio of protein variance to protein mean  and are stiff with regard to the protein degradation rate noise parameter ηd <dig>  cspe also has a high fano factor of the protein distribution while map has an unusually low mrna fano factor. what these four genes appear to have in common is that the variability in their protein numbers is difficult to explain based solely on the mrna variability. thus, a higher level of extrinsic noise is inferred to account for the observed variability. since these genes comprise a small minority, it may be that their expression is subject to regulatory mechanisms that are not well approximated by the two state model. the remaining majority of genes are broadly divided into two similar groups which differ mostly in the sloppiness of k <dig> 

the noise and rate parameters segregate into two clusters with the noise parameters generally being sloppier than the rate parameters . the least sloppy parameter is the mrna degradation rate . this is not surprising since it was used, together with the molecule number summary statistics, to infer the posterior distribution. of the rate parameters, the basal transcription rate  is the sloppiest and often approaches the noise parameters in its sloppiness. since this parameter is defined as a fraction of the active transcription rate , its relative sloppiness should not be equated to a lack of importance. for most genes the marginal posterior of k <dig> is largely constrained to the lower half of its prior distribution, u. the only exception being the gene map for which the measured mrna fano factor was close to one and the marginal posterior of k <dig> is in the top half of the prior range. the mean of the marginal posterior of k <dig> is negatively correlated with the mrna fano factor across all genes . the two other parameters that influence the mrna fano factor, kr and kf, are the next sloppiest rate parameters.

CONCLUSIONS
cell-to-cell variability in genetically homogeneous populations of cells is a ubiquitous phenomenon . attempts to quantify it are complicated by the difficulty of assigning it to a single cellular process or any one experimentally measurable variable. it can also be difficult, for example, to distinguish between the intrinsic stochasticity of biochemical processes in the short term and longer term variations which may have been inherited from previous cell generations.

by including a representation of extrinsic noise in our model of gene expression we infer the extent to which the rates of biochemical processes can vary between cells while still producing the experimentally measured mrna and protein variability. we demonstrate the usefulness of an efficient method for exact stochastic simulation of the two-state model of gene expression. the two-state model is necessary to explain the experimentally measured mrna variation , and is capable of describing the majority of the observed data. the corresponding single-state model, with constant promoter activity and extrinsic noise, does not produce mrna fano factors as high as those measured experimentally without leading to unacceptably high variability in the protein numbers. we show that the amount of extrinsic noise affecting most genes appears to be limited, but non-negligible.

the exact simulation method described here occupies a niche between those cases when only samples from the steady state mrna distribution of the two-state model  <cit>  are required, and cases when an approximation to the protein distribution  <cit>  is sufficient. the computational advantages of the simulation method described here are limited to specific conditions, such as, low numbers of mrna molecules and higher numbers of protein molecules. the most limiting factor of this simulation method is that it is not applicable to models in which the protein products affect upstream processes such as promoter activity, transcription or translation. the addition of such interactions would mean that the assumptions used in deriving the poissonian relationship between the number of surviving protein molecules produced form a given mrna molecule and mrna’s lifetime would no longer be satisfied. perhaps an approximate algorithm could be developed on the basis of algorithm  to handle such situations. alternatively, the tau-leaping algorithm  <cit> , or moment expansion  <cit> , may be more appropriate for models involving these kinds of feedback interactions. algorithm  could, however, be naturally extended to models involving regulatory interactions between non-coding rnas as the simulation of that part of the model is equivalent to gillespie’s exact algorithm. although here we use summary statistics of mrna and protein number measurements, the simulation method is also applicable to cases where a direct comparison between sample distributions, for example using the hellinger distance, is required.

here we have worked under the assumption that experimental measurement error associated with individual mrna or protein counts obtained by fluorescence microscopy are small relative to the combined effects of extrinsic and intrinsic noise. we deem this to be justifiable given the experimental method used by tanaguchi et al.  <cit>  and the results presented in their publication. more generally, such measurement errors would inflate estimates of the variances in molecule numbers and may skew the inferred extrinsic noise parameters. other studies, which look directly at the interplay between intrinsic and extrinsic noise in single cells  <cit>  — using time-resolved proteomics data — do also bear this out.

the inferred extrinsic noise parameters will also include the effects of regulatory mechanisms that are not well described by the two-state model. in this sense, our definition of noise becomes blurred with our ignorance about the regulatory interactions involved in the expression of each gene. nonetheless, the biochemical mechanisms governing gene expression in a given species are shared between many genes. this is in agreement with our observation that, for most genes, inferred model parameters show similar patterns of sloppiness. if we are able to refine our understanding of the shared aspects of gene expression, we may be able to improve our understanding of both the nature of the noise affecting it, and the regulatory mechanisms controlling it. in practice this may mean finding a mechanistic explanation for the two-state model or further refining it to achieve a better agreement between simulations and experimental results.

the in silico approach used here not only relied on, but was inspired by the experimental work of tanaguchi et al.  <cit> . as the resolution of high throughput experimental techniques and the quantity of data they generate continues to increase, more complete observations of cellular processes may begin to yield data amenable to statistical analysis and inference of extrinsic noise. these may in turn require other modelling, computational and theoretical approaches which would not rely on the assumptions and simplifications that we make in this work  <cit> .

