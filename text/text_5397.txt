BACKGROUND
the biological functions of 16s, 23s and 5s rrnas, trnas, telomerase rna, group i and ii introns, rnasep, and other structural rnas are dictated by their three-dimensional structures. thus, an accurate depiction of an rna's secondary and tertiary structure is fundamental for our understanding of the mechanisms and consequences of its function, and an accurate prediction of an rna folding into its secondary and tertiary structure from its primary structure will have a significant effect on our study of molecular biology. this rna folding problem is usually divided into two components: the first is the determination of an rna's folding pathway, and the second is the accurate and reliable prediction of an rna's secondary and tertiary structure from its primary structure. in this paper, we focus on the second aspect and in particular rna secondary structure prediction, which is a difficult problem. it has been estimated that the number of secondary structures models is greater than  <dig> n, where n is the number of nucleotides  in the sequence <cit> . for example, saccharomyces cerevisiae phe-trna is only  <dig> nt in length and has an estimated  <dig>  ×  <dig> secondary structure models, while a larger rna, such as the 16s rrna from escherichia coli, with  <dig> nt, has an estimated total of  <dig>  ×  <dig> possible secondary structure models.

the most popular method for predicting rna secondary structure from a single sequence is free energy minimization using a dynamic programming approach <cit> , based on energy parameters determined according to the nearest-neighbor model <cit> . programs based on this technique include mfold <cit> , rnastructure <cit>  and rnafold <cit> . mfold is the most popular program in use today. by default, mfold determines the optimal  structure and a set of suboptimal foldings that are within  <dig> kcal/mol  of the minimum energy structure. the set of suboptimal foldings exists and covers such a large energy range due to uncertainties in the thermodynamic data <cit> . mfold applies the following constraints: 1) only g:c, a:u and g:u base-pairs are formed , 2) hairpin loops have at least three bases, and 3) no pseudoknotted structures are formed <cit> . attempts have been made to characterize the reliability of an rna secondary structure prediction using dot plots <cit> .

comparative analysis is another method for predicting rna secondary and some tertiary structure <cit> . comparative analysis of rna sequences and structures is a knowledge-based technique based on two fundamental assumptions: 1) different, homologous rna sequences are capable of folding into the same secondary and tertiary structure, and 2) during the course of evolution, the secondary and tertiary structure of an rna molecule remains mostly unchanged, while the primary structure can change significantly. the accuracy of the comparative method has recently been established using high-resolution crystal structures for the 30s and 50s ribosomal subunits <cit> . over 97% of the secondary structure base-pairs predicted by comparative analysis are present in the crystal structures <cit> .

the superior performance of the comparative method may lead one to incorrectly assume that the other methods for rna secondary structure prediction are no longer necessary. different methods for predicting rna secondary structure are utilized in different situations and can have different objectives. free energy minimization based rna structure prediction methods are usually applied to a single rna sequence. the most energetically stable rna secondary structure that are composed of canonical g:c, a:u, and g:u base-pairs and organized into standard helices are predicted. non-canonical base-pairs and base-pairs not in standard helices cannot be predicted at this time. in contrast, rna comparative sequence analysis methods predict a structure by searching an alignment for base-pairings that are common to all sequences in the dataset. this latter method can accurately predict canonical and non-canonical base-pairs that occur in secondary and tertiary structures. however, rna comparative analysis is an iterative process requiring substantial sequence data, accurate sequence alignments, and the analysis of a structure that is common to all of the sequences in the dataset. in order to create an initial alignment, sequences must have significant identity to be aligned accurately while having sufficient variation  to identify potential base-pairs and posit a structural hypothesis. the structural hypothesis is subsequently tested, refined, and expanded by the addition of more sequences to the alignment. much of this process is still done manually, as computational tools to automate the process do not currently exist. the most recent comparative structure model for ssu rrna is based on an alignment of  <dig>  sequences <cit> . the data was collected and the model was refined over a period of  <dig> years. the sequences included in this analysis are very diverse, spanning the entire tree of life.

in  <dig> and  <dig>  the gutell lab conducted two comprehensive studies that: 1) determined how well the optimal secondary structure model predicted with the program mfold  matched the structure model determined with comparative analysis for a set of 16s and 23s rrnas, and 2) examined other aspects of the folding, such as the prediction accuracy of "short-range" base-pairs , or the prediction accuracy for base-pairs in different loop environments, to learn more about differences between the thermodynamic and comparative models <cit> . the most significant findings from those studies were: 1) the average accuracy of the optimal prediction for a 16s rrna was 46% while the average accuracy for a 23s rrna was 44%. 2) the accuracies of the predicted secondary structure models for at least one individual 16s or 23s rrna sequence were as high as 80% and as low as 10%. 3) on average, the archaeal rrnas were predicted with the highest accuracy, followed by the -bacterial and chloroplast, then mitochondrial and eukaryotic nuclear rrnas. 4) short-range pairings, which comprised 75% of the total comparative base pairings for both 16s and 23s rrna, were predicted more accurately than long-range pairings . 5) base-pairs closing hairpin loops were predicted more accurately than those closing internal and multistem loops.

since those studies were completed in  <dig>  four new developments have directly affected rna structure prediction. 1) a new version of mfold  was released with energy parameters revised to include sequence dependence and different secondary structure motifs <cit> . 2) the accuracy of the comparative model for ribosomal rna was established <cit>  with high-resolution crystal structure data from both the small and large ribosomal subunits <cit> . 3) the number of available 16s and 23s rrna secondary structures determined by comparative analysis increased significantly <cit> . 4) faster computers, which have significantly decreased the time it takes to fold an individual sequence, had become available to facilitate large-scale folding studies. these developments afforded us the opportunity to do a comprehensive re-evaluation of mfold.

for more than  <dig> years, the basic paradigm for rna secondary structure prediction, from a single sequence, has essentially remained the same: global free energy minimization with refinements to the nearest-neighbor energy parameters and minimization algorithms in an attempt to improve prediction accuracy. refinements to the energy parameters, summarized in multiple sources <cit> , included measures for effects such as base-pair mismatches, base-pair positioning in helices, internal, bulge and multistem loops, and coaxial stacking. newer versions of the program mfold included these refinements in energy parameters in addition to improvements in the folding algorithm <cit> . we questioned whether the improvements in the energy parameters and the algorithms could result in dramatic improvements in the accuracy and reliability of rna secondary structure prediction programs such as mfold, or would the energy-based rna folding approach need to be fundamentally altered.

to begin to address this question, we analyzed the ability of mfold  <dig>  to predict rna secondary structure models determined with comparative analysis. in addition, we compared the predictions and accuracies of mfold  <dig>  with its predecessor, mfold  <dig> , for a large set of phylogenetically diverse 16s and 23s rrna sequences. all metrics considered in previous studies to evaluate the accuracy of mfold  <dig>  <cit>  were revisited here. in addition, we analyzed the suboptimal population of predicted secondary structures and characterized metrics such as the number of suboptimals that were better  than the optimal structure prediction, the total number of comparative base-pairs observed, and the number of times a given base-pair is predicted in a set of optimal and suboptimal structure predictions. only the most significant findings and metrics were discussed here; the reader is referred to the website <cit>  for a detailed presentation of all results from this analysis.

RESULTS
comparative structure database
the dataset assembled for this study was significantly larger than previous studies comparing rna structure models predicted by comparative analysis and the mfold folding program <cit> . in particular, the  <dig> and  <dig> studies conducted by the gutell lab with mfold  <dig>  analyzed only  <dig> 16s <cit>  and  <dig> 23s <cit>  rrna sequences respectively, and the  <dig> study by mathews et al. with mfold  <dig>  analyzed a total of  <dig>  nt and  <dig>  comparatively predicted canonical base-pairs  from  <dig> sequences, which included  <dig> 16s,  <dig> 23s, and  <dig> 5s rrna sequences,  <dig> trna sequences  <dig> group i and three group ii intron sequences,  <dig> srp sequences, and  <dig> rnase p sequences <cit> . for this study, our sequence set included all three types of rrna  and type i trna. as shown in table  <dig>  we analyzed a total of  <dig>  rna sequences, encompassing  <dig> , <dig> nt and  <dig>  canonical secondary structure base-pairs. of the  <dig>  sequences analyzed,  <dig> were trna,  <dig> were 16s rrna,  <dig> were 23s rrna, and  <dig> were 5s rrna.

while the size of the comparative structure databases increased significantly between this study and previous gutell lab studies, only minor differences exist between the  <dig> and  <dig> versions of the 16s and 23s rrna comparative structure models. for the  <dig> version of the haloferax volcanii 16s rrna secondary structure model,  <dig> base-pairs were added,  <dig> base-pairs were removed, and  <dig> base-pairs remained unchanged, resulting in a net difference of approximately 3% in the total number of base-pairs in the model. similar numbers were observed for the other comparatively predicted structures evaluated. the comparative structure database used by mathews et al. utilized known modified nucleotide information in trna to limit the base-pairing potential for those nucleotides that are modified <cit> . in this study, rrna or trna base modifications were not taken into account. a simple analysis of our trna dataset shows that 70% of our trna sequences came from genomic dna sequences: as a result, no modification data was available for those sequences. for the remaining 30%, the number of modifications that could prevent a-form helix formation was minimal; between only  <dig> to  <dig> modifications per sequence.

our dataset was extremely diverse in sequence and structure and included sequences from each of the three major phylogenetic domains, the archaea, bacteria, and eucarya <cit> . the eukaryotic dataset included sequences encoded in the nucleus, chloroplast and mitochondrion. since a dataset with sequences that were nearly identical would be less useful than a dataset with significant variation between the sequences, we characterized the diversity of the sequences in our dataset by calculating sequence identity for all pairs of 16s and 23s rrna sequences within the different phylogenetic classifications of our dataset.

for our 16s rrna dataset, 75% of the archaeal, 86% of the bacteria, 71% of the chloroplast, 99% of the mitochondrial, and 94% of the eukaryotic nuclear sequence pairs had less than 80% sequence identity, while only 4% or fewer of the pairs in a given phylogenetic classification had 95% or more sequence identity . moreover, 79% of the mitochondrial and 48% of the eukaryotic nuclear 16s rrna sequence pairs had less than 50% sequence identity . the 23s rrna dataset exhibited even more diversity than the 16s rrna dataset, as 87% of the archaeal, 94% of the bacteria, 76% of the chloroplast, 99% of the mitochondrial, and 97% of the eukaryotic nuclear sequence pairs had less than 80% sequence identity, while 2% or fewer of the sequence pairs in a given phylogenetic classification had more than 95% sequence identity . this demonstration of significant sequence variation between sequences in the same phylogenetic categories reveals the relative independence of the sequences within our dataset.

rna secondary structure prediction
the most important parameters used to control rna secondary structure prediction by mfold are window size , percent suboptimality , and the inclusion or exclusion of additional energy calculations based on coaxial stacking . the percent suboptimality variable establishes the energy range for computed foldings. the range is Δgmin to Δgmin + ΔΔg, where ΔΔg is p% of Δgmin. the window size variable establishes the difference between the suboptimal folds by requiring that given folding has at least w base-pairs that are at least a distance w from any base-pairs in the foldings already computed. the program efn <dig> is used to re-compute the energetics of each predicted structure based on coaxial stacking opportunities with the structure. the structures are then re-ordered by the modified Δg and a new optimal structure is selected. previous studies by the gutell lab, konings et al. <cit>  and fields et al. <cit> , with mfold  <dig>  used window sizes of  <dig> and  <dig>  respectively, with no efn <dig> re-evaluation; the selection of window size was limited by the computational resources available at the time the studies were conducted. mathews et al. <cit>  used mfold  <dig>  with a window size of  <dig>  percent suboptimality of 20%, and efn <dig> re-evaluation.

each of the  <dig>  sequences in our dataset was folded with mfold  <dig> , using a window size  of  <dig>  percent suboptimality  of 5%, and maximum number of suboptimal foldings  of  <dig>  the optimal, or minimum, free energy prediction and  <dig> suboptimal predictions were determined after re-ordering the structure predictions by the efn <dig> re-computed energetics.  we configured the folding of our rna sequences to:  <dig>  maximize the number of structures predicted for any given sequence,  <dig>  densely sample the suboptimal population close to the minimum free energy structure, since the structure with the lowest free energy  is expected to be most similar to the structure observed in nature for the free energy minimization techniques, and  <dig>  to include coaxial stacking in the energy calculations with the efn <dig> option in mfold  <dig> .

the only difference between the run parameters from the previous gutell lab studies and this study was the significantly smaller window size used in the current study. the difference in window size affects the number of suboptimal structures computed. since the previous gutell lab studies did not include any energy re-computation and re-ordering of predicted structures for potential coaxial stacking, this difference would not have a significant impact on the results.

the study by mathews et al. used different values for percent suboptimality and window size in computing suboptimal structure predictions. the net result of the difference is that the mathews et al. study considered suboptimal structures with energy values further away from the minimum free energy prediction than in our study. this difference could have an impact on the results since the mathews et al. study may include a structure prediction for a given sequence that is not very energetically stable  but upon efn <dig> re-ordering becomes the minimum energy structure. if this predicted structure was more accurate than any other prediction in the population, the mathews et al. study would reflect a higher prediction accuracy score for that given sequence.

overall accuracy for rna structure prediction with mfold  <dig> 
given that 97–98% of the rna secondary structure base-pairs predicted with comparative analysis were verified with the high resolution crystal structures <cit> , we scored the accuracy of the structures predicted with mfold  <dig>  by quantifying how well the optimal  structure prediction matched the comparative structure model for each sequence in our dataset. results were only based on sequences folded in their entirety. we calculated accuracy by dividing the number of comparative base-pairs that were predicted exactly with mfold by the total number of canonical base-pairs in the comparative model . this method for calculating accuracy was the same as the previous gutell lab studies that utilized mfold  <dig>  <cit> , with the exception that previous studies excluded comparative base-pairs that were pseudoknotted from consideration.

in contrast, base-pairs predicted with mfold  <dig>  in the mathews et al. <cit>  study were considered correct if:  <dig>  they matched a comparatively predicted base-pair exactly or  <dig>  either nucleotide of the mfold predicted base-pair  is within one nucleotide of its comparatively predicted position . while the mathews et al. study included a measure of the percentage of comparative base-pairs considered pseudoknotted, we were unsure if those base-pairs were specifically excluded from their accuracy calculations. based on these differences in the accuracy calculations, the mathews et al. study is reporting higher accuracies than our study.

direct comparisons between the current study and the two previous gutell lab studies are meaningful due to the use of similar methodologies to calculate prediction accuracy. the only difference is the scoring method between the studies is the exclusion of pseudoknotted base-pairs from previous gutell lab studies. however, direct comparison of results between the current study and the mathews et al. study are impacted by differences in the folding parameters and the scoring criteria.

raw folding accuracy
the compilation of the accuracies for each sequence and the accuracy ranges for each rna type and phylogenetic grouping were summarized in table  <dig>  the average folding accuracies per sequence for 5s rrna and trna, the two smallest molecules in this study, were 71% and 69% respectively. the study by mathews et al. reported average accuracy per sequence of 78% for 5s rrna and 83% for trna <cit> . accuracies for our sets of 5s rrnas and trnas were about 25% higher than the average accuracies for the 16s  and 23s  rrnas. by comparison, the gutell lab's previous studies using mfold  <dig>  reported an average folding accuracy of 46% for 16s rrna and 44% for 23s rrna <cit> . the study by mathews et al. reported average accuracies  of 51% for a dataset of  <dig> 16s rrnas and 57% for a dataset of  <dig> 23s rrnas <cit> . when considering only sequences analyzed in previous gutell lab studies, the average prediction accuracy with mfold  <dig>  was 45% for 16s rrna and 43% for 23s rrna .

variation in observed folding accuracy
to gauge the variation in accuracy score for the optimal structures predicted with mfold, the percentages of scores greater than 60% and less than 20%, the median accuracy score, and the highest and lowest accuracy scores were identified for the four rna types . this analysis revealed a large range of accuracy scores with values significantly larger and smaller than the respective average value. for our current analysis, the highest accuracy score for the optimal structure for each rna type was 100% for trna , 98% for 5s rrna, 77% for 16s rrna, and 74% for 23s rrna. in contrast, at least one of the optimal folds for 5s rrna or trna had a score of  <dig> . the lowest accuracy score was 5% for 16s rrna and 1% for 23s rrna.

the median accuracy score observed for each rna type was 70% for trna, 81% for 5s rrna, 41% for 16s rrna and 41% for 23s rrna. for 16s and 23s rrna the overwhelming majority  of optimal structures predicted with mfold had an accuracy score greater than 20% and less than 60%, a trend also observed in our previous studies  <cit> . the majority of optimal structures predicted for 5s rrna  had an accuracy score greater than 60% . for the trna, 60% of the optimal structures were predicted with accuracy greater than 60% and 39% of the optimal structures predicted with accuracy between 20% and 60%. the percentage of predicted structures with an accuracy score below 20% was highest for 23s rrna ; increased from 1% previously <cit> , followed by 16s rrna ; decreased from 9% previously <cit> , 5s rrna , and trna  . our website <cit>  contains a complete list of accuracy scores and secondary structure diagrams indicating base-pairs that were predicted correctly for all sequences in our dataset.

phylogenetic dependence in observed folding accuracy
our previous thermodynamic-based folding analysis of 16s rrnas <cit>  and 23s rrnas <cit>  also revealed significant variation in the accuracy scores within and between the five major phylogenetic groups. for our current 16s rrna dataset, the archaeal sequences had the highest average accuracy , while the mitochondrial sequences had the lowest average accuracy . between these two extremes were the bacteria , chloroplast , and eukaryotic nuclear  sequences . these results were consistent with our previous studies, except that the archaeal and bacterial accuracy scores were slightly lower in our newer analysis  <cit> . for 23s rrna , the archaeal dataset again had the highest accuracy scores , followed by the bacterial , eukaryotic nuclear , chloroplast , and mitochondrion . these results were also consistent with the trends observed in the previous studies, although the accuracy values for the current study were slightly less than the earlier analysis.

direct comparison of structure predictions by mfold  <dig>  and mfold  <dig>  for specific rna sequences
to access specific differences between the optimal foldings from mfold  <dig>  and mfold  <dig>  for select 16s and 23s rrna sequences, we mapped the base-pairs predicted with both versions of mfold onto the comparative structure models for each sequence. some of the base-parings were predicted correctly with both versions of mfold, other base-pairings were predicted exclusively by one version, while a third set of base-pairings were not predicted correctly with either version. the haloferax volcanii 16s rrna  and thermococcus celer 23s rrna  sequences were generally predicted very well with both versions of mfold. meanwhile, giardia intestinalis 16s  and 23s  rrna sequences were predicted poorly with both versions of mfold. the base-pairings in the comparative model that were missed by both versions of mfold were generally longer range . this relationship between the comparative structure model for g. intestinalis 16s and 23s rrna and the poor prediction of this structure with both versions of mfold  was representative of other sequences predicted with low accuracy by mfold  <dig> . a total of  <dig> out of  <dig> 16s sequences and  <dig> of the  <dig> 23s sequences predicted with accuracy of 30% or less with mfold  <dig>  were still predicted with less than 30% accuracy with mfold  <dig>  .

six significant results came from this section. 1) direct comparison of previous gutell lab studies with the current study  suggests that refinements in the energy parameters and folding algorithm have not improved the accuracy of the mfold program between versions  <dig>  and  <dig>  for the set of 16s and 23s rrnas analyzed. 2) the discrepancies between the results of the mathews et al. study and our study could be due to the different methods by which the sequences were folded and prediction accuracy calculated. 3) the accuracy scores for the majority of the 16s and 23s rrna secondary structure models predicted with mfold  <dig>  and  <dig>  were between 20% and 60%, while the accuracy scores for the majority of 5s secondary structure models predicted with mfold were greater than 60%. 4) some secondary structure models predicted with mfold  <dig>  and  <dig>  have accuracy scores less than 20%. 5) the folding accuracy for archaeal rrnas was the highest, followed by bacterial, eukaryotic chloroplast, nuclear, and mitochondrial rrnas. 6) sequences that were well-predicted with mfold  <dig>  tend to be well-predicted with mfold  <dig> , and sequences that were poorly-predicted using mfold  <dig>  tend to be poorly-predicted using mfold  <dig> .

accuracy and the rna contact distance
for a given protein, the average sequence separation between pairs of amino acids involved in non-covalent interactions is defined as the "contact order" <cit> . two similar topological descriptions for non-covalent interactions in rna are: 1) "rna contact distance" is the separation on the rna sequence between two nucleotides that base-pair, and 2) "rna contact order" is the average of the rna contact distances for a given rna sequence. we considered any base-pair with a contact distance of  <dig> nt or less to be "short-range," a contact distance of 101– <dig> nt to be "mid-range," and a contact distance of  <dig> or greater to be "long-range." the majority of base-pairs in the 16s and 23s rrna secondary structure models predicted with comparative analysis were short-range , and previous studies have established that short-range base-pairs are predicted more accurately than long-range base-pairs <cit> . in this section, we: 1) compared the accuracies of the short-range interactions predicted with mfold  <dig>  and mfold  <dig> , 2) compared the number of short-, mid-, and long-range base-pairs in the comparative models with those predicted by mfold  <dig> , and 3) determined the relationship between the base-pair prediction accuracy and the contact distance for 16s rrna.

accuracy of short-range interactions
the  <dig> 16s rrna comparative structure models in this study were comprised of  <dig>  canonical base-pairs. a total of  <dig>   of these base-pairs were short-range, and  <dig>   of these base-pairs were predicted correctly by mfold  <dig>  . the average accuracy for short-range base-pairs was 50% per sequence  . by comparison, in the  <dig> study, an average accuracy of approximately 55% per sequence was observed for short-range base-pairs <cit> .

for the 23s rrna dataset, the  <dig> comparative structures contained a total of  <dig>  canonical base-pairs.  <dig>   of the 23s rrna comparative, canonical base-pairs were short-range, and  <dig>   of those base-pairs were predicted correctly by mfold  <dig>  . the average prediction accuracy for short-range base-pairs was 47% per sequence . in the  <dig> study, an average accuracy of approximately 53% per sequence was observed for short-range base-pairs <cit> .

distribution by rna contact distance of comparative and mfold predicted base-pairs
a total of  <dig>  base-pairs were predicted with mfold  <dig>  for our 16s rrna dataset . this was  <dig>  more than in the 16s rrna comparative structure models . of the  <dig>  base-pairs,  <dig>   were short-range and  <dig>   were mid- or long-range. of the  <dig>  short-range base-pairs,  <dig>   were correct while only  <dig>   of the mid- and long-range base-pairs were correct.

a total of  <dig>  long-range base-pairs were predicted with mfold  <dig> , while the comparative models contained only a total of  <dig>  long-range base-pairs; in other words, 13% of the total number of 16s rrna base-pairs predicted with mfold  <dig>  were long-range while only 2% of the comparatively predicted base-pairs were long-range. finally, of the  <dig>  long-range base-pairs predicted by mfold  <dig> , only  <dig>  were correct.

similar results were observed for our 23s rrna dataset . a total of  <dig>  base-pairs were predicted by mfold  <dig> ;  <dig>   were short-range, while  <dig>   were mid- or long-range.  <dig>   of the total short-range base-pairs predicted were correct, but only  <dig>   of the total mid- and long-range base-pairs predicted were correct. akin to the 16s rrna dataset, a total of  <dig>   23s rrna long-range base-pairs were predicted with mfold  <dig> , while only  <dig>   of the comparatively predicted base-pairs were long-range. only  <dig>  of the  <dig>   long-range base-pairs predicted by mfold  <dig>  were correct.

relationship between prediction accuracy and rna contact distance
these results prompted a more sophisticated analysis to quantify the relationship between the accuracy of base-pairs predicted with mfold  <dig>  and rna contact distance. figure 2a shows the distribution of contact distances for the  <dig>  canonical base-pairs from the  <dig> 16s rrna comparative structure models in this study. the frequency of base-pairs observed decreases exponentially as contact distance increases. based on this observation, we divided the  <dig>  16s rrna comparative base-pairs into seven somewhat equally-sized bins  by considering the contact distance values on a logarithmic scale instead of a linear scale. .

the mfold prediction accuracy for each of these bins was determined. the prediction accuracy was 61% for base-pairs in the smallest contact distance bin, 3– <dig>  57% for base-pairs in the 9– <dig> contact distance bin, 47% for base-pairs in the 20– <dig> bin, 46% for the 48– <dig> bin, 15% for the 118– <dig> bin, 7% for the 294– <dig> bin, and 0% for the 734– <dig> bin . the approximately linear relationship obtained from plotting the accuracy for logarithmically-scaled bins revealed an exponential relationship between the accuracy of mfold and the contact distance .

five significant results were observed from the analysis in this section. 1) the accuracy of the predictions for short-range base-pairings was similar for mfold  <dig>  and mfold  <dig> . 2) more base-pairs were predicted with mfold for any given sequence than in the corresponding comparative structure model. 3) significantly more long-range base-pairs were predicted with mfold  <dig>  than in the comparative structure models. 4) the number of base-pairs in the comparative structure models decreases exponentially as the contact distance increases. 5) base-pairs with a contact distance between  <dig> and  <dig> were predicted with the highest accuracy  by mfold, and accuracy values decreased exponentially as the rna contact distance increases. the complete set of results for the prediction of 16s and 23s rrna short-, mid-, and long-range base-pairs with mfold  <dig>  and comparisons with the comparative structure models are provided at our website <cit> .

suboptimal foldings
one of the features of the dynamic programming algorithm for free energy minimization employed by mfold was the ability to provide a set of suboptimal structure predictions in addition to the minimum free energy or optimal structure prediction <cit> . mathews et al. included metrics which consider how suboptimal population may impact the prediction accuracy <cit> . in this section, we introduce new metrics to continue the examination of the suboptimal population using the  <dig> 16s rrna sequences in our dataset. due to the differences in the folding parameters and in the methods for computing accuracy, our survey of the suboptimal population should not be directly compared with the mathews et al. study. rather, our metrics provide a different perspective from which to excogitate the importance of the suboptimal structure predictions. in particular, we considered: 1) the amount of structural variation and the ΔΔg difference  for pairs of structure predictions in the suboptimal population, 2) how many additional unique, canonical base-pairs in the comparative models were found in the suboptimal population, and how many incorrect base-pairs were predicted, and 3) which comparative base-pairs were predicted correctly in all, an intermediate number, or no structure predictions, in the set of suboptimal foldings.

structural variation and ΔΔg difference for structure predictions in the suboptimal population
it has been previously noted that suboptimal structure predictions can be very similar or very different from one another <cit> . here we tested for a relationship between the ΔΔg  and the structural variation score  for pairs of structure predictions within a suboptimal population. higher structural variation scores indicate that two structures compared were more different from one another, while lower structural variation scores indicate that two structures were more similar. we analyzed the two 16s rrna sequences with the highest and lowest optimal accuracy before efn <dig> re-evaluation and re-ordering in the archaea dataset, haloferax volcanii and methanospirillum hungatei. the accuracy for h. volcanii based on the pre-efn <dig> minimum free energy structure prediction was 80%, while m. hungatei was predicted at 46% accuracy . for the suboptimal population of each sequence, we calculated the structural variation and the difference in free energy for all possible pairwise comparisons. the total number of unique pairwise combinations for each sequence was  <dig> , based on a total of  <dig> structure predictions .

for h. volcanii,  <dig>  pairs  of structure predictions had a structural variation score of  <dig> or higher, while  <dig>  pairs  had a score of  <dig> or less . thus, the majority of the structural predictions in the suboptimal population were more similar with one another. the observed ΔΔg range was the same for both categories, 0– <dig> kcal/mol . more striking was the similarity in the average ΔΔg. for those pairwise comparisons with a structural variation score of  <dig> or less, the average ΔΔg was ~ <dig>  kcal/mol  . for those pairwise comparisons with a structural variation score of  <dig> or higher, the average ΔΔg was  <dig>  kcal/mol . these results were summarized graphically in figure 3a.

in contrast with h. volcanii, our analysis for m. hungatei revealed that a significant number of the structure predictions were different from one another. a total of  <dig>  pairs  of structure predictions had a structural variation score of  <dig> or higher, while only  <dig>  pairs  had a score of  <dig> or less . the observed ΔΔg range was slightly smaller than in h. volcanii, 0– <dig>  kcal/mol, while the average ΔΔg values were similar for h. volcanii and m. hungatei. for the pairwise comparisons with a structural variation score of  <dig> or higher, the average ΔΔg was  <dig>  kcal/mol . for those pairwise comparisons with a structural variation score of  <dig> or less, the average ΔΔg was ~ <dig>  kcal/mol  . these results were summarized graphically in figure 3b.

the most important observation from this section was that the ΔΔg between two structure predictions appeared to be independent of the similarity between the structure predictions. for example, h. volcanii pairwise comparisons with a structural variation score of  <dig> or higher had an average ΔΔg of  <dig>  kcal/mol, while those pairwise comparisons where the score was  <dig> or less had an average ΔΔg of ~ <dig>  kcal/mol . in other words, free energy alone was not sufficient to adequately distinguish between different structure predictions. while the results suggest that suboptimal structural variation score could potentially be used as an indicator of the reliability of the structure prediction by mfold, further investigation is required to evaluate the extent of this correlation.

number of comparative base-pairs in the suboptimal population
for each individual 16s rrna sequence, we identified the set of unique comparative base-pairs present from the collection of all base-pairs predicted in the suboptimal population. since most comparative base-pairs were observed in more than one suboptimal structure, the total number of unique base-pairs observed was much lower than the total number of comparative base-pairs in the suboptimal population. our entire 16s rrna dataset of  <dig> comparative structure models contained a total of  <dig>  unique canonical, comparative base-pairs .  <dig>  of these canonical base-pairs were predicted with mfold  <dig>  to be in a minimum free energy structure , an average accuracy of 41% per sequence  . however, when considering the entire suboptimal population of structure predictions for each sequence, a total of  <dig>  comparative canonical base-pairs were predicted correctly by mfold, an average accuracy of 71% per sequence . this represented a 30% increase in the average number of base-pairs in the comparative model that were predicted correctly per sequence. the average accuracy per sequence for an archaeal, bacterial, eukaryotic nuclear, chloroplast, and mitochondrial sequence increased by 21%-41% respectively , and the largest increase for a single sequence  was observed in the mitochondrial dataset .

however, these dramatic improvements in accuracy were offset by a significant increase in the number of base-pairs predicted incorrectly; mfold experienced a large drop in selectivity. the total number of unique incorrect base-pair predictions for the  <dig> optimal structure predictions was only  <dig> , while the total number of unique incorrect predictions was  <dig> , <dig> for the  <dig> sets of optimal plus  <dig> suboptimal structure predictions, a  <dig> % increase in the number of incorrect predictions .

two significant results came from this analysis. 1) when all of the base-pairs in the suboptimal population were included in the accuracy computation, we observed a 30% increase in average accuracy per sequence. 2) this same collection of suboptimal structures contained a  <dig> % overall increase in the number of base-pairs that were not in the comparative model compared to the optimal structure prediction. in other words, a large decrease in selectivity was observed.

distribution of base pairs throughout a suboptimal population
in the previous section, we considered the unique base-pairs predicted with mfold  <dig> . as mentioned earlier, the number of unique base-pairs is very small compared to the total number of base-pairs predicted within the top  <dig> predicted structures. a total of  <dig> , <dig> base-pairs were predicted in the top  <dig> structure predictions for all  <dig> 16s rrna sequences in our dataset . of these,  <dig> , <dig> were correct, while  <dig> , <dig> were incorrect. in this section, we investigated 1) the frequency at which each base-pair in the comparative structure model appeared in the set of  <dig> structures  predicted with mfold  <dig>  and 2) the relationship between this frequency and the rna contact distance.

the frequency of prediction with mfold  <dig>  for each base-pair in the comparative structure model was displayed for two archaeal 16s rrna comparative structure models in figure  <dig>  given the analysis in the previous section on suboptimal structural variation, we selected h. volcanii and m hungatei for the panels in figure  <dig>  for both h. volcanii 16s rrna , and m. hungatei 16s rrna , some comparative base-pairs were predicted correctly in all  <dig> structure predictions, while others were predicted correctly in 600– <dig> structure predictions, 151– <dig> structure predictions, and 1– <dig> structure predictions. a few of the canonical base-pairs in the comparative structure model were not predicted in any of the  <dig> structure predictions. for h.volcanii , the majority of the base-pairs predicted correctly were present in  <dig> to  <dig> structure predictions, with a significant number of base-pairs predicted correctly in all  <dig> structure predictions. base-pairs predicted correctly in all  <dig> structure predictions were almost exclusively short-range , while those predicted correctly in only 1– <dig> structure predictions were almost always long-range . this distribution was different for the m. hungatei 16s rrna . here, smaller numbers of base-pairs were predicted correctly in all  <dig> structure predictions, and more base-pairs were predicted correctly in only  <dig> to  <dig> of the structure predictions. similar to h. volcanii, the majority of base-pairs predicted correctly in all  <dig> structure predictions have small rna contact distances. for both sequences, short-range and long-range base-pairs were observed that were predicted correctly in zero structure predictions.

the distribution of comparatively predicted base-pairs, as observed from up to  <dig> structures of the suboptimal population, as a function of the rna contact distance for all  <dig> 16s rrna sequences in our dataset, was summarized in table  <dig>  76% of the base-pairs were short-range , 22% were mid-range , and 2% were long-range . of the comparative base-pairs predicted correctly in all  <dig> structure predictions for each 16s rrna sequence in our data set, 98% were short-range, representing almost 15%  of the total number of base-pairs predicted correctly. in contrast, only 2% of long-range base-pairs were predicted correctly in  <dig> or more structure predictions, representing <<1%  of the total number of base-pairs predicted correctly. for comparative base-pairs predicted correctly in 600– <dig> structure predictions, 94% were short-range, for 151– <dig> structure predictions, 81% were short-range, and for 1– <dig> structure predictions, 70% were short-range. 80%  of the long-range base-pairs predicted correctly appeared in  <dig> or fewer structure predictions. a total of  <dig>  canonical, comparative base pairs were never predicted correctly, an average of  <dig> per 16s rrna considered; 54% of these base pairs were short-range, 42% were mid-range, and 4% were long-range.

three important observations were presented in this section. 1) for a given sequence, some of the comparative base-pairs were predicted correctly in all  <dig> structures . 2) a sequence with higher optimal accuracy contained a larger percentage of the comparative base-pairs predicted correctly in more of the structure predictions within the suboptimal population, compared to a sequence with lower optimal accuracy. 3) base-pairs predicted correctly in more suboptimal structure predictions tend to have a smaller rna contact distance.

CONCLUSIONS
in this paper, we evaluated how well the computer program mfold  <dig>  <cit> , with the newest nearest-neighbor energy values, can predict the secondary structure base-pairs in comparative structure models for different rnas. this study expands upon previous studies conducted by this lab in four ways. first, we analyzed 5s rrna and trna sequences in addition to 16s and 23s rrna sequences. second, the number of comparative structure models in the current dataset was significantly larger, with a total of  <dig>  rnas ,  <dig>  million nucleotides and over  <dig>  base-pairs, which covered all three phylogenetic domains and exhibited significant sequence variation . third, the increase in the speed of computers allowed us to analyze the best  <dig> suboptimal predictions in addition to the optimal prediction. finally, the latest version of mfold  was used. our five most important conclusions are summarized hereunder.

1) the comparative structure models for most sequences are predicted with similar accuracy by mfold  <dig>  and mfold  <dig>   when the differences between the datasets for previous gutell lab studies and the current study  are considered. the average folding accuracy for our current study is 41% for complete 16s rrna sequences and 41% for complete 23s rrna sequences, which is slightly less than in our earlier studies . while the majority of optimal structure predictions for each rna sequence still have an accuracy score between 20% and 60%, sequences with accuracy scores less than 20% are also observed . on average, archaeal and bacterial 16s and 23s rrna sequences still have higher accuracy scores than eukaryotic nuclear, chloroplast, and mitochondrial sequences .

2) base-pairs with smaller rna contact distances are both abundant in comparatively predicted structures and predicted more accurately by both versions of mfold, and base-pairs with large rna contact distances which are abundant in mfold predicted structures only, are frequently incorrect. the prediction accuracy for individual base-pairs decreases exponentially as rna contact distance increases. figure 2a shows that the number of comparative base-pairs decreases exponentially as the rna contact distance increases. using a logarithmic scale, we show that the base-pair prediction accuracy decreases in a linear fashion as contact distance increases , which indicates an exponential relationship between base-pair prediction accuracy and rna contact distance. in addition, many more long-range base-pairs  are predicted than found in the corresponding comparative structure model, and the overwhelming majority of these predicted base-pairs are incorrect .

3) while uncertainties in the energy parameters may play a small role, free energy  alone is insufficient to distinguish between different structural possibilities for the same sequence. the variation between any two structure predictions within the suboptimal population is not correlated with the ΔΔg between those two structure predictions . we observe that two structures that are more similar with one another , and very different from one another , have very similar ΔΔg values.

4) without prior knowledge of the correct structure model, analysis of the suboptimal structure models can not improve our ability to both predict correctly the base-pairs in the secondary structure and assemble them into a single secondary structure model. our analysis of the accuracy of base-pairs predicted in the suboptimal population for our 16s rrna dataset reveals that the entire population contained a higher percentage of base-pairs present in the comparative model than the optimal structure prediction alone . when considering the suboptimal population, the free energy minimization method is able to identify an average of 71% or more of the comparatively predicted base-pairs for a given sequence  vs. only 41% when considering just the optimal structure prediction. however, this same suboptimal population contains a significant increase in the number of incorrect base-pairs . in other words, the increase in recall is offset by the inability of mfold to consistently identify a single structure model containing a high percentage of comparative base-pairs.

5) the frequency of correctly predicted base-pairs in the suboptimal population is extremely variable, and base-pairs with a smaller rna contact distance are more likely to be observed at a higher frequency. a qualitative analysis of figure  <dig> shows that some base-pairs in the comparative structure model are predicted in all structure predictions within a suboptimal population, others are predicted in a subset, and yet others are not predicted at all. 98% of base-pairs predicted correctly in all structure predictions have an rna contact distance less than  <dig> nt, while 80% of base-pairs with an rna contact distance of  <dig> nt or more are only predicted correctly in  <dig> or less structure predictions . additionally, 63%  of base-pairs with an rna contact distance of  <dig> nt or more are never predicted correctly in the suboptimal population .

from our previous analysis with version  <dig>  of mfold, we had determined that free energy minimization does not consistently identify the correct base-pairs in the 16s and 23s rrna comparative secondary structure models <cit> . we arrive at the same conclusion with our analysis of the current version  <dig>  of mfold and a significantly larger set of rrna comparative structure models. one explanation could be incorrect energy parameters for multi-stem loops. especially with longer sequences such as 16s or 23s rrna, many long-range base-pairs occur along with the formation of these multi-stem loops. as we have shown in table  <dig>  only 8%  of 16s rrna and 13%  23s rrna base-pairs predicted by mfold with an rna contact distance  <dig> or more nucleotides are correct. a more accurate characterization of the energetics of multi-stem loops may lead to significantly better prediction accuracies. mathews et al. have started to address this issue using experimental studies <cit>  and known rna secondary structures <cit>  to generate multi-stem loop initiation parameters that can be used in energetic calculations.

we believe that another potential reason for the inaccurate structures predicted with mfold is that kinetics plays a role in rna folding. here, we suspect that nucleotide interactions with smaller contact distances will form more quickly, as suggested by higgs <cit> , and will dominate the number of base-paired interactions formed. presumably, these short-range interactions that form rapidly will be in equilibrium with other helices with a minimum contact distance , and in the process, prevent energetically stable helices with larger contact distances from forming <cit> . several of our results support these ideas: 1) in the 16s and 23s rrna comparative structure models, 75% of the predicted base-pairings have a contact distance of  <dig> or less; 2) minimum free energy structures for 16s rrna  have almost  <dig> times more long-range base-pairs than the comparative structure models ; 3) 92%  and 86%  of correctly predicted base-pairs have a contact distance of  <dig> or less for 16s and 23s rrna ; 4) the higher prediction accuracy observed for short rna molecules such as 5s rrna or trna .

knowledge-based approaches that incorporate comparative analysis and high-resolution crystal structure data have been successful in the prediction of protein structures <cit> . with the recent increase in the number of high-resolution crystal structures for different rna molecules, it has been suggested that similar approaches could be utilized to predict rna structure <cit> . we envision a knowledge-based rna folding algorithm with three fundamental facets: 1) a kinetic model of rna folding that includes cooperative formation of short-range base-pairs and helices, 2) a thermodynamic component provided by the nearest-neighbor model applied locally within different parts of the sequence, and 3) relationships between rna sequence and structure elements and observed structural biases, for example tetraloops <cit> , aa:ag motifs at the ends of helices <cit> , a bias for unpaired adenosines in the secondary structure model  <cit> , and lone pair triloops <cit> . use of sequence-structure relationships requires evaluation of known two- and three- dimensional rna structures, hence the "knowledge-based" facet of the algorithm. some researchers in the field have begun to adopt this approach. in mfold  <dig> , free-energy bonuses are applied to certain classes of hairpin loops and the energetic parameters for multi-branch loops were tuned using comparatively predicted structures <cit> . other researchers have developed rna secondary structure prediction algorithms that combine energetics and comparative sequence analysis  <cit> . we believe that a tuned algorithm of the form just described has the potential to predict rna secondary and eventually tertiary structure more accurately and reliably than methods currently available.

