BACKGROUND
it is often difficult for a population to acquire an adaptive phenotype that requires simultaneous changes in the co-expression of multiple genes
 <cit> . if selection favours a change in the way a group of genes are regulated, then each of the target genes must independently gain novel binding sites and/or lose existing ones
 <cit> . this has led to the proposal that adaptive rewiring of a regulatory network can be accelerated if pairs of transcription factors bind their targets cooperatively, through a physical interaction between the transcription factor proteins themselves
 <cit> .

given the potential adaptive benefit of cooperative regulation, it makes sense to ask, when will cooperative binding between a pair of transcription factors be able to invade a population that lacks such cooperativity? to answer this we must understand the following tradeoff: although cooperative binding between a pair of factors may result in improved regulation at the target genes shared by both factors, any mutation that results in a physical interaction between the transcription factors will effect all of their targets . thus the advantageous fitness effects of improved binding at some, shared targets must outweigh any deleterious effects of misregulation at other, non-shared targets in order for cooperative binding to be favored by evolution.

a number of previous studies have explored the mechanistic details of cooperative transcription factor binding at a given target gene
 <cit> . such biophysical studies focus on transcription factor binding at a single target gene and are able, with remarkable accuracy, to account for a number of the physical properties of binding sites
 <cit> . however, the evolution of cooperative binding occurs through mutations at transcription factor proteins, and such mutations can alter transcription factor binding at every binding site across the genome. to understand the fitness effects of such a mutation therefore requires that we understand the evolution of the whole ensemble of binding sites for a transcription factor. the population genetics of such an ensemble cannot be understood in a simple way just by focusing on the details of a single member of the ensemble. they depend critically on the population-genetic parameters of the ensemble, such as number of target genes, overall mutation rates and selection coefficients, and population size. therefore in this paper, we do not focus on the details of a cooperative binding at a single target gene. instead our analysis is in terms of these population-genetic parameters, and whilst we estimate selective coefficients from biophysical studies, we do not specify the mechanistic details of protein-dna interactions that give rise to them.

we use a mathematical model to study the conditions under which cooperative binding between pairs of transcription factors is favoured. we first determine the evolutionary conditions that favour cooperative binding under stabilising selection, in terms of the basic evolutionary parameters of the population: the strength of selection on binding sites, the rate of mutation, and the population size. we then study the influence of cooperative regulation on the capacity for a transcriptional circuit to adapt under positive selection. we calculate the time required for a target gene to gain a new, adaptive transcription factor binding site, in the presence or absence of cooperative interactions among its regulators. we confirm our analytical results on the evolution of cooperative regulation by comparison to monte-carlo simulations of the wright-fisher process associated with our system, and we compare our qualitative conclusions to systematic empirical data.

our population-genetic model describes a pair of transcription factors, each with its own set of target genes, with some degree of overlap between these sets . according to our model, which is specified in detail below, a target gene that is regulated by both factors has two corresponding binding sites, while a target gene that is regulated by only one of the factors has a single binding site. we assume that mutations that result in loss of function can occur at any binding site, and that non-functional binding sites can also undergo gain of function mutations. when there is no cooperative regulation between the two transcription factors, binding to each of their targets is determined solely by their binding sites. if a binding site is not functional, this results in reduced fitness. when cooperative binding is present, two conflicting effects occur: on the one hand, cooperative binding partially compensates for the deleterious effects of loss of function mutations to the binding sites at shared targets. on the other hand, cooperative binding results in some degree of mis-regulation at each of the targets that are not shared, and this has a deleterious impact on fitness. by constructing our model in terms of these fitness benefits and costs we are able to study the evolutionary dynamics of the system, and determine the effects of varying different population-genetic parameters on the evolution of cooperative gene regulation. this approach therefore complements the detailed mechanistic models of gene regulation that have been studied elsewhere
 <cit> .

RESULTS
stabilising selection without cooperative binding
we consider a pair of transcription factors, labelled  <dig> and  <dig>  that have k <dig> and k <dig> targets, respectively. a fraction β of the binding sites are at shared target genes, so that the number of binding sites at genes that are co-regulated by the pair is β, as illustrated in figure
 <dig>  loss of function mutations occur at binding sites at a rate ul, and back mutations, which result in a functional binding site being gained at a target, occur at rate ug. an individual incurs a fitness penalty s, where 0≤s <  <dig>  for each non-functional binding site, and fitness is assumed to be multiplicative across loci. therefore the fitness of an individual that lacks i≤k <dig> + k <dig> of its required binding sites is wi=i. the fitness landscape associated with our model thus has a single peak at i=0; and for each transcription factor binding site that is lost, fitness is reduced by an additional factor . empirical estimates of the strength of selection on transcription factor binding sites suggest that typically ns∼10
 <cit> , suggesting that s is small. we assume that s is the same for all binding sites, an assumption which we relax in the methods section.

we consider a population of n asexual individuals. the evolution of the population can be described by keeping track of the relative abundances of each “hamming class”
 <cit> . hamming class i corresponds to those individuals who currently lack i transcription factor binding sites. we denote the frequency of individuals in hamming class i by xi. in an infinitely large population, the evolution of hamming class i is then described by the differential equations
 <cit> 

  x˙i=∑j=0k1+k2wiw¯zipij, 

where
w¯=∑i=0k1+k2wixi, and pij is the probability a genotype lacking j functional binding sites mutates to a genotype lacking i functional binding sites . previous work
 <cit>  has shown that at equilibrium, when rates of forward and back mutations are identical , the solution to equation  <dig> is a binomial distribution. in the more general case of a finite population, with ul≠ug, we find that the equilibrium continues to be well approximated by a binomial distribution, with mean as. the term as is the probability that a binding site will be non-functional in a randomly chosen individual at equilibrium. the probability as depends on the strength of selection against non-functional binding sites, s, population size, n, and the rates of forward and back mutation, uland ug .

the equilibrium distribution above describes how stabilizing selection determines the frequencies of functional binding sites in a population. the associated mean fitness for a pair of transcription factors that do not bind cooperatively is
w¯=k1+k <dig> , and the mean fitness contribution of each binding site is 1−ass. we are typically concerned with the case in which ul,ug ≪ s. in this case, when 2ns >  <dig>  as can be approximated by 

 as≈12nsulul+ug+uls 

 and otherwise by 

  as≈ulul+ug 

. these equations have an intuitive interpretation: when 2ns >  <dig> the first term describes the effect of genetic drift which tends to push the system towards its neutral equilibrium, a0=ul/, and the second term describes the effect of selection. in the limit n→∞, as equals ul/s, which is the standard result for the frequency of a deleterious allele in an infinite population under mutation-selection balance. when 2ns <  <dig>  evolution is nearly neutral and drift dominates, so the system is close to the neutral equilibrium a <dig> 

stabilising selection with cooperative binding
here we modify our model to account for cooperative regulation by a pair of factors. this allows us to ask when cooperative regulation is favored by evolution. a mutation that results in cooperative binding between a pair of transcription factors has two effects on the fitness of a transcriptional circuit. for a target that is regulated by both transcription factors, we assume that cooperative binding mitigates the effects of deleterious mutations at transcription factor binding sites
 <cit> . this results in a reduced fitness penalty for a mutation at the β shared targets, so that  is replaced by  for some constant 0≤h≤ <dig>  nonetheless, there are also  targets that are regulated by only one or the other of the transcription factors. we assume that the cooperative binding of the transcription factors causes pleiotropic mis-regulation at these targets . this results in a fitness penalty t at each of the  targets that are not co-regulated. fitness is again assumed to be multiplicative, so that the cost of pleiotropy associated with cooperative binding is
.

provided ul,ug ≪  <dig>  genes that are co-regulated and genes that are not co-regulated have equilibrium distributions described by independent binomial distributions with means ahsand asrespectively, which are approximated by equation  <dig> . we can now specify the conditions for the invasion of cooperative gene regulation. a mutation resulting in cooperative binding between a pair of factors will be favoured if the expected fitness of the mutant is greater than the equilibrium mean fitness. using the expressions for mean fitness given above, this occurs when
β<β. assuming t,s ≪  <dig>  this expression can be simplified to give
β>tt+sas. this means that, when the fraction of binding sites at shared targets, β, is greater than a threshold depending on s, h, t and as, a mutation that results in cooperative binding can invade a population at equilibrium.

similarly, a mutation that results in the loss of cooperative binding in a population where it is present will be favoured when
β<β. again assuming t,s ≪  <dig>  this expression can be simplified to give
β<tt+sahs so that, when the fraction of binding sites at shared targets, β, is less than a threshold depending on s, h, t and ahs, a mutation that results in loss of cooperative binding can invade a population at equilibrium.

since the first expression in equation  <dig> is monotonically decreasing in s, and the second expression is independent of s, it is always true that ahs≤as, i.e populations that have cooperative binding accumulate more deleterious mutations, that result in weaker transcription factor binding sites, than populations that lack it. as a result there is a range of β for which both a population that lacks cooperative binding, and a population that has cooperative binding are not invadable by mutations that gain or remove cooperative binding respectively. in this range, the evolutionary dynamics of the system are bi-stable. in this range, we expect to find some genes that are regulated by pairs of transcription factors that act cooperatively and some that don’t.

using the expression for as given in equation  <dig>  and recalling that a <dig> = ul/ is the neutral equilibrium in a system dominated by drift, the threshold value of β above which selection favours a mutation causing cooperative binding in a population that lacks it, is given by 

  β>2nt2nt+a0if2ns>1tt+sa0otherwise. 

similarly, the threshold value of β below which selection favours a mutation resulting in loss of cooperative binding in a population that has it, is given by 

  β<2nth2nth+a0if2nhs>1tt+sa0otherwise. 

these equations allow us to make a number of observations about the evolution of cooperative gene regulation . beginning with equation  <dig> for a population lacking cooperative binding, we see that when n and/or s is large, so that 2ns >  <dig>  the threshold number of shared targets βabove which cooperative binding becomes advantageous is independent of the strength of selection s . however the threshold decreases as the mutation-buffering effect of cooperative binding increases . as population size n increases, selection becomes more efficient and the threshold value of β increases . finally, the threshold also increases with the cost of pleiotropy t . in contrast, when n and/or s is small, so that 2ns <  <dig>  drift dominates and the threshold number of shared targets βis independent of population size n . however the threshold decreases with the strength of selection s , because when drift dominates the number of deleterious mutations is at the neutral equilibrium, and increasing s increases the impact of each mutation on overall fitness.

similarly, from equation  <dig> for a population with cooperative binding, we see that when n and/or hs is large, so that 2nhs >  <dig>  the threshold number of shared targets βbelow which cooperative binding becomes disadvantageous is independent of the strength of selection s . as before, the threshold decreases as the mutation buffering effect of cooperative binding increases  and the threshold increases with population size n , and the cost of pleiotropy t . in contrast, when n and/or hs is small, so that 2nhs <  <dig>  drift dominates and the threshold number of shared targets βis independent of population size n , but decreases with the strength of selection s . the size of the bistable region is largest when s is large and h is small, and for intermediate values of n and t, as shown in figure
 <dig>  as this analysis demonstrates, there is a broad range of possible evolutionary outcomes and, crucially, cooperative binding can evolve under a wide range of circumstances despite the deleterious pleiotropic effects associated with physical interactions among transcription factors.

adaptation of transcriptional circuits under positive selection
when cooperative binding is present, under stabilising selection, transcription factor binding sites at co-regulated genes are better able to tolerate mutations . under positive selection for a novel expression phenotype, this may speed adaptation, since greater mutational robustness generates greater genetic diversity and can help speed adaptation 
 <cit> . this may occur, for example, when adaptation involves change in the transcription factor that regulates a target gene
 <cit> , through turnover of transcription factor binding sites
 <cit> . we use our model to quantify the extent to which cooperative binding among transcription factors accelerates the adaptive rewiring of transcriptional circuits under positive selection.

we study adaptive change that involves replacement of an existing transcription factor by a new one that confers higher fitness. we assume that the target gene must first suffer an initially deleterious mutation at its existing binding site before a newly adaptive binding site can be acquired 
 <cit> . the newly adaptive binding site is produced from binding sites that have already mutated at a rate ur. the expected waiting time for such a gene to produce a newly adaptive binding site therefore depends on the number of binding sites in the population that harbor a deleterious mutation, which is proportional to as when cooperativity is absent and ahs when it is present. since ahs >as, this number is greater when cooperative binding is present than when it is absent.

the ratio of waiting times before a newly adaptive binding site arises,
tr∗/tr , quantifies the degree to which cooperative binding of transcription factors accelerates adaptation under positive selection. this ratio is given by ahs/as . as figure
 <dig> shows, provided ns >  <dig> , rewiring of transcriptional circuits is significantly accelerated by cooperative binding among transcription factors. thus, a population that has cooperative binding among transcription factors under stabilizing selection, can also experience an accelerated rate of adaptation.

cooperative binding and the fraction of shared targets in yeast
our model predicts that, under stabilising selection, cooperative binding will be favoured when the fraction of targets shared by a pair of transcription factors exceeds a certain threshold. in order to test this prediction, and to get some idea of the degree of overlap that is required for cooperative binding to arise in natural systems, we inspected pairs of transcription factors in saccharomyces cerevisiae. a total of  <dig> pairs are reported as participating in cooperative binding
 <cit> , based on a combination of chip-chip data, transcription factor knockout data, and direct experimental evidence. using the set of genes regulated through a transcription factor binding site for a total of  <dig> yeast transcription factors
 <cit> , we determined the fraction of overlapping targets, β, for all pairs of transcription factors . it is important to note that, typically, studies that systematically look for cooperative gene interactions take into account the number of targets shared by a gene pair. therefore, to minimise the risk of circularity in our analysis, we have used separate datasets to determine cooperative gene interactions, and to determine regulatory targets. the mean fraction of overlapping targets for genes identified as participating in cooperative binding was 10-fold greater  than the mean fraction of overlapping targets at genes that do not bind cooperatively  which is highly statistically significant . this supports the prediction of our population-genetic analysis, and it suggests that a sizeable overlap in targets is required before cooperative binding becomes advantageous.

cooperative binding in the yeast sex determination network
the ability of cooperative transcription factors to facilitate adaptation also has empirical support, from observations in the sex determination networks of different yeast species
 <cit> . the acquisition of a protein-protein interaction between the mating factor matα <dig> and mcm <dig> was able to buffer the deleterious effects of mutations that strengthened mcm <dig> binding sites
 <cit> . prior to the emergence of a protein-protein interaction, sex determining genes were activated only in the presence of mcm <dig> and mata <dig> together
 <cit> . the buffering effects of the protein-protein interaction allowed mcm <dig> binding sites to acquire strengthening mutations such that sex determining genes became activated by mcm <dig> alone. as a result, mata <dig> became redundant and was lost
 <cit> . the result was a significant upstream reorganization of the yeast sex determination network without the need for any parallel changes to the downstream output of the network. similar patterns, in which acquisition of cooperative binding between transcription factors is followed by changes to the regulation of their shared targets, are observed across the yeast transcriptome
 <cit> , and support the prediction of our analysis of positive selection on transcriptional networks.

CONCLUSIONS
we have shown that cooperative binding between a pair of transcription factors is favoured under stabilising selection, provided the overlap between their targets is sufficiently large. the threshold fraction of shared targets depends upon the strength of selection on binding sites, the cost of pleiotropy associated with protein-protein interactions, and the rates of mutations. it also depends on the population size. just as in models that consider the evolution of redundancy
 <cit> , we find that greater redundancy  is more strongly favoured in smaller populations; and that for intermediate population sizes the evolutionary dynamics are bistable, such that cooperative binding is maintained if it is already present, but cannot evolve if it is absent. finally, we found that cooperative binding facilitates the rewiring of transcriptional circuits under positive selection.

this study shows that, even when the deleterious effects of pleiotropy are taken into account, mutations that change transcription factor function can play an important role in the evolution of gene expression. taking account of mutations both to regulatory binding sites and to the transcription factors themselves reveals a rich set of evolutionary dynamics that helps explain how complex transcriptional networks can rapidly rewire large sets of genes in order to adapt to new environments.

