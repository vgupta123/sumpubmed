BACKGROUND
systems biology paradigm has provided insights in the maintenance of robustness for biological processes involving a multitude of interconnected elements   <cit> . in addition, recent advances in metabolomics have provided a large amount of highly reproducible data  <cit> , allowing reconstruction and analysis of genome-scale metabolic networks  <cit> . these developments in metabolomics technologies have challenged computational systems biology with the need to accurately describe the dynamics of metabolic networks in order not only to glean the flux rates at different time points, representing the temporal flux distribution, and the interdependent metabolic profiles, but also to identify key elements for metabolic engineering  <cit> .

metabolic flux analysis  has propelled the development of computational methods for analysis of metabolic networks  <cit> . flux balance analysis , as one of the most prominent of the mfa methods, is based on linear programming  whereby a given objective function  is optimized under the assumption that the system operates at steady state under the constraints given by the stoichiometric matrix  <cit> . by optimizing an objective function, the linear program identifies one feasible flux distribution from the set of fluxes satisfying the constraints imposed by the mass-balance equations and reaction bounds  <cit> . consequently, the biological implications of the optimal flux distribution depend on the choice of the objective function  <cit> . maximization of biomass is one of these functions, which is assumed particularly suitable for microbial models  <cit> . for eukaryotic cells  where biomass or yield may not be the primary goal, a different objective function has to be determined. for instance, cellular maintenance at minimal efforts has been proposed to be one of the alternatives  <cit> . nevertheless, finding an adequate objective of a metabolic network, and especially a sub network related to particular metabolic processes, remains a problem of ongoing interest  <cit> . however, the steady-state assumption on which fba is based precludes the analysis of the dynamics of metabolite concentrations and flux distribution. furthermore, the classical fba ignores the possibility that perturbed metabolic networks may not immediately regulate towards the  optimal objective.

based on the hypothesis that fluxes in metabolic networks, altered by removal of a reaction, undergo a minimal redistribution compared to those of the wild type, minimization of metabolic adjustment   <cit>  and regulatory on/off minimization   <cit>  have been devised as two contending alternatives for analysis of perturbed metabolic network models. moma predicts the flux redistribution which has the smallest euclidean distance to the wild type flux distribution obtained by fba, while room minimizes the number of  flux changes from the wild type flux distribution. as a consequence, large modifications in single fluxes are prevented in moma; however, such large modifications may be required for rerouting metabolic flux through alternative pathways  <cit> , which has been observed in experiments  <cit> . existing studies have demonstrated that room outperforms moma and fba in the flux prediction of the final metabolic steady state, albeit, in the particular case of pyruvate kinase knockout in e. coli  <cit> .

the analysis of metabolic network dynamics has traditionally been facilitated by models based on ordinary differential equations  which require a large amount of information for simulating the temporal metabolic changes  <cit> . to this end, the phenomenological parameters of specific enzyme kinetics  have to be determined by accurate measurements of enzyme activities and data-fitting to experimentally obtained  data. in turn, the obtained fits are often used to make predictions and draw conclusions based on the postulated kinetic model.

on the other hand, dynamic fba  offers the alternative to predict time-resolved metabolic profiles with limited knowledge of enzyme kinetics  <cit> . unlike, the analyses based on fba, which focus on the steady-state behavior, dfba offers the means to analyze transient  states. in addition, dfba has been combined with moma, resulting in the m-dfba approach which has been employed for predicting the dynamics of photosynthetic metabolism and positing hypotheses about its robustness under different co <dig> and water conditions  <cit> . m-dfba extends the moma hypothesis from minimal redistribution of metabolic fluxes in perturbed metabolic networks to a minimal fluctuation of the profile of metabolite concentrations over time.

we point out that the mechanisms describing the temporal changes in the metabolic state, characterized by the metabolite concentrations and flux rates, are principal to the notion of robustness, as used with dfba-based approaches. for instance, the posited mechanism in m-dfba is that metabolic networks operate to minimize the fluctuations in metabolic concentrations over time. this suggests alterations to the definition of robustness as a property that maintains system function in the case of external perturbations  <cit>  to include the internal perturbations due to changes in the dynamic state of the system's elements. external perturbations arise due to changing environmental conditions, such as stress conditions , but also by changes in the structure of a metabolic networks . in contrast, internal perturbations are due to temporal changes of the metabolic state characterized by the coupling of metabolite concentrations and flux distributions. considering mass actions kinetics, which states that the flux rate of a reaction is proportional to the product of the concentrations of the participating reactants  <cit> . as a result, even in this simplest kinetic law, a change in metabolite concentrations may affect flux rates, which, in turn, as a result of the mass balances have an effect on the concentrations. here, we investigate a set of biochemically plausible hypotheses which can be used to characterize the mechanisms responsible for maintaining the metabolic network robustness due to internal perturbations. these mechanisms can in turn be used to simulate the dynamics of a given metabolic network relying purely on the stoichiometry and a limited amount of information regarding the phenomenological constants.

driven by the idea of mutually influencing system elements, central to the systems biology paradigm, we argue that minimal fluctuations of metabolic profiles may only represent one possible explanation of the temporal changes in metabolic state. in this study, we design the room-based dfba approach  by coupling the principle of room with dfba. r-dfba extends the premise of the room approach, which relies on significant flux changes, by considering the minimization of the total number of significant changes of metabolite concentrations. furthermore, the coupling of room and dfba renders it possible to use the advantages of room compared to moma in a dynamic setting.

in addition, we modify and extend the proposed r-dfba and the existing m-dfba approaches to consider minimizing fluctuations not only in concentrations but also in flux levels, which result in seven proposed methods based on different optimization functions and programming formulations. including classical dfba and the two known variants of m-dfba  <cit> , a total of ten different approaches are presented to predict and analyze the dynamics of metabolite concentrations and flux levels over time. finally, the accuracy of a dynamic fba-based approach in simulating the dynamics of metabolic networks must be established based on the comparison of the obtained results and the outcome of a well-defined kinetic model for a given metabolic network. here, by comparing the results of applying dfba, m-dfba, r-dfba and their extensions to those of the kinetic models for the calvin-benson cycle and plant carbohydrate metabolism, our analysis discriminates between the different mechanisms which result in the apparent metabolic network dynamics and robustness. our quantitative and qualitative comparative analyses demonstrate that the extensions based on r-dfba outperform the existing dfba-based approaches.

RESULTS
here we describe the seven proposed methods and the comparison of their performance with two kinetic models--of the calvin-benson cycle and of the plant carbohydrate metabolism. since the proposed methods build upon the dfba approaches, we provide a brief overview of the mathematical apparatus used in their formulation. the suite of proposed methods and their relation to the existing dfba approaches are depicted in figure  <dig> 

we point out that dfba-based methods and kinetic modeling constitute independent approaches. the dfba-based methods involve performing a constrained optimization over a time period to approximate the dynamics of a system with stoichiometric constraints only, which include relative quantities of reactants and products of the particular reaction. in contrast, a kinetic model requires all kinetic parameters to simulate the dynamics of the system. however, kinetic modeling is often hampered by incomplete knowledge of the underlying enzyme-kinetics and their associated parameter values  <cit> .

in addition, it is necessary to determine the extent to which the dynamics of both metabolite profiles as well as flux predictions can be successfully predicted from dfba-based approaches. the outcome of testing this hypothesis will then suggest the most likely mechanism which describes the robustness of the system to internal perturbations over time. we argue that such approach goes beyond the analysis of steady states typical for metabolic control analysis   <cit>  and structural kinetic modeling as its extension  <cit> .

dfba
dfba overcomes the main drawback of the classical fba which precludes the analysis of the dynamic behavior of a network-the steady-state assumption. mahadevan and coworkers introduced two dfba formulations--static and dynamic  <cit> . the static optimization  involves first dividing the time period of interest into uniform time intervals and then solving the instantaneous optimization problem at the beginning of each time interval, followed by integration to compute the metabolite concentration over time. in contrast, the general dynamic optimization approach  is formulated as follows:

 max ∫ t0tffdxs.t.dxdt=s⋅vvmin≤v≤vmaxxmin≤x≤xmaxx=x <dig>  

where x and v are vectors of metabolite concentrations and reaction fluxes over time, s denotes the stoichiometric matrix, with rows corresponding to metabolites and columns to reactions of the metabolic network described by s, and t is the time. the minimum and maximum allowable fluxes of each reaction and metabolite concentrations are defined by vmin and vmax and xmin and xmax, respectively. the vector x <dig> gives the initial concentration for the set of metabolites. the formulation of the doa approach results in a nonlinear program  if nonlinear constraints and/or a nonlinear objective function are included.

the doa involves optimization over the entire time period t to obtain time-resolved flux rates and metabolite concentrations. the optimization is rendered computationally feasible by parameterizing the dynamic equations with the help of orthogonal collocation on finite elements  <cit> . to this end the time period of interest is divided into a finite number of intervals, named finite elements. furthermore, the metabolite concentrations x and flux levels v are parameterized at the roots of an orthogonal polynomial  within each finite element  <cit> . for readers not familiar with orthogonal collocation on finite elements an instructive example of how this algorithm works is provided in additional file  <dig> 

we point out that the number of variables in each optimization step of soa is smaller compared to that of doa, allowing scalability to larger networks. however, soa does not allow dynamic formulation, and the remainder of the methods focus on doa.

m-dfba
luo and coworkers developed an approach called m-dfba which combines moma with dfba  <cit> . by employing the moma hypothesis, the objective function of the dynamic optimization approach of dfba is altered to a minimization of the euclidean distance between metabolite concentrations at adjacent orthogonal roots ∑i=1nxi,j-xi,j- <dig>  where n is the number of metabolites in the network and xi,j represents the concentration of metabolite i at the time point given by the orthogonal root j. hence, the general m-dfba optimization problem is defined as follows:

 minx ∑j=1m∫ t0tf∑i=1nxi,j-xi,j-12δdts.t.dxdt=s⋅vvmin≤v≤vmaxxmin≤x≤xmaxx=x <dig> 

with m representing the number of orthogonal roots, and δ, the dirac delta function .

extended versions of m-dfba
we extend the m-dfba method so that the objective function, subject to minimization, is given by the sum of euclidean distances between metabolite concentrations and reaction rates at adjacent orthogonal roots:

 minx,v ∑j=1m∫ t0tf∑i=1nxi,j-xi,j-12+∑l=1fvl,j-vl,j-12δdt, 

where f represents the number of reactions in the network. this approach, denoted m-dfbacf, extends the m-dfba approach by considering the hypothesis of the minimal fluctuation of flux levels in addition to minimal fluctuation of the profile of metabolite concentrations. in general, only limited knowledge of the enzyme-kinetic rate laws is available for an incorporation of kinetic expressions in the constraints. on the other hand, the inclusion of only stoichiometric constraints for the majority of the reactions can have the effect that flux rates and metabolite concentrations do not change as expected due to their coupling based on the underlying kinetics. therefore, stabilizing only the profile of metabolite concentrations in the objective function, like in the basic m-dfba approach, may lead to a large variation of flux rates over time. the inclusion of both metabolite concentrations and flux rates in the objective function renders a more constrained optimization problem, which could avoid large fluctuations in the predictions.

moreover, to facilitate discrimination of the different mechanisms yielding a particular time-resolved metabolic state, we consider a third type of the m-dfba method, whereby the objective function, subject to minimization, includes only the fluctuation of flux rates, as follows:

 minv ∑j=1m∫ t0tf∑l=1fvl,j-vl,j-12δdt. 

r-dfba
in contrast to moma, room minimizes the total number of significant  flux changes from the wild-type flux distribution. in our approach, we combine room with dfba, naming this modeling approach r-dfba. here, the room hypothesis is extended from a minimization of significant flux changes to a minimization of fluctuation of the profile of metabolite concentrations, according to the assumption of the basic m-dfba approach. unlike m-dfba, in r-dfba this is realized by minimizing the significant concentration changes at adjacent orthogonal roots. in contrast to m-dfba, which captures smooth changes over time , r-dfba prevents a large number of small  changes over time. instead, it allows a large concentration change at a few time points  and a relatively constant concentration of the metabolites elsewhere, which is bounded by thresholds determining the significant change. finally, there are two possibilities to capture concentration changes between two time points--the continuous, specified by the usage of a distance measure , and the binary, based on an appropriate definition of significant change. the proposed formulation of r-dfba captures the binary case, as the remaining alternative to specify dynamic changes. from a biological perspective, the possibility for large concentration changes in a small time range, as specified in r-dfba, may be necessary to capture the difference in concentrations between two steady states in a bi-stable system  <cit> .

two different types of the r-dfba approach are considered: the first includes the basic room approach with integer constraints, whereas the second relies on relaxing the integer constraints. due to the relaxation of the integer constraints, the programming problem in room becomes linear in comparison to mixed-integer linear program  in the basic room approach  <cit> . the first r-dfba approach, based on milp room, is described as follows:

 miny ∑j=1m∫ t0tf∑i=1nyi,jδdts.t.dxdt=s⋅vvmin≤v≤vmaxxmin≤x≤xmaxx=x0∀j,i1≤j≤m,1≤i≤nxi,j-yi,jxmax,i-wi,ju≤wi,juxi,j-yi,jxmin,i-wi,jl≥wi,jlyi,j∈{ <dig> }wi,ju=xi,j-1+γxxi,j-1+εxwi,jl=xi,j-1-γxxi,j-1-εx, 

where wu, wl are the thresholds determining significant changes of metabolite concentrations  and γx, εx are the relative and absolute ranges of tolerance, respectively.

due to the constraints defining the thresholds, the programming problem becomes a mixed-integer nonlinear programming problem . these problems are difficult to solve precisely as they couple the combinatorial nature of mixed-integer programming  problem and the computational complexity of solving nlp problems  <cit> .

consequently, we formulate a second r-dfba approach based on relaxed integer constraints, described as follows:

 miny ∑j=1m∫ t0tf∑i=1nyi,jδdts.t.dxdt=s⋅vvmin≤v≤vmaxxmin≤x≤xmaxx=x0∀j,i1≤j≤m,1≤i≤nxi,j-yi,jxmax,i-xi,j-1≤xi,j-1xi,j-yi,jxmin,i-xi,j-1≥xi,j-10≤yi,j≤ <dig>  

compared to the first formulation of r-dfba, the relative and absolute ranges of tolerance  are set to be zero, due to the relaxed integer constraints for yi,j.

extended versions of r-dfba
as for the m-dfba approach, we also extend the proposed r-dfba by considering the minimization of fluctuation of flux levels in addition to the minimized fluctuation of the profile of metabolite concentrations at adjacent orthogonal roots. we denote this approach as r-dfbacf:

 miny,z ∑j=1m∫ t0tf∑i=1nyi,j+ ∑l=1fzl,jδdts.t.dxdt=s⋅vvmin≤v≤vmaxxmin≤x≤xmaxx=x0∀j,i,l1≤j≤m,1≤i≤n,1≤l≤fxi,j-yi,jxmax,i-wi,ju≤wi,juxi,j-yi,jxmin,i-wi,jl≥wi,jlyi,j∈{ <dig> }wi,ju=xi,j-1-γxxi,j-εxwi,jl=xi,j-1-γxxi,j-εxvl,j=zl,jvmax,l-bl,ju≤bl,juvl,j=zl,jvmin,l-bl,jl≥bl,jlzl,j∈{ <dig> }bl,ju=vl,j-1+γvvl,j-1+εvbl,jl=vl,j-1-γvvl,j-1-εv, 

where bu, bl are the thresholds determining significance of the flux levels  and γv, εv are the relative and absolute ranges of tolerance, respectively. due to the inclusion of the flux rates and metabolite concentrations in the description of the thresholds, r-dfbacf is solved based on mixed-integer nonlinear programming, by the first r-dfba formulation, and based on nonlinear programming, according to the second. this extension minimizes fluctuations of both, metabolite concentrations and flux rates, over time, similarly to m-dfbacf. in comparison, in r-dfbacf large concentration and flux rate changes between two adjacent orthogonal roots for some metabolites and/or reactions are possible, which is precluded in m-dfbacf.

additionally, we consider a third objective function for the r-dfba approach, whereby only fluctuation of the profile of flux levels of the network over time is minimized:

 minz ∑j=1m∫ t0tf∑l=1fzl,jδdts.t.dxdt=s⋅vvmin≤v≤vmaxxmin≤x≤xmaxx=x0∀j,l1≤j≤m,1≤l≤fvl,j-zl,jvmax,l-bl,ju≤bl,juvl,j-zl,jvmin,l-bl,jl≥bl,jlzl,j∈{ <dig> }bl,ju=vl,j-1+γvvl,j-1+εvbl,jl=vl,j-1-γvvl,j-1-εv, 

the proposed optimization functions of the minlp and nlp variants of r-dfba, flux-based r-dfba and r-dfbacf allow a comparison of the necessity of stabilizing the system's profile of concentration, flux or a combination of both to predict dynamics in a metabolic network.

comparison of the proposed methods and a kinetic model of the calvin-benson cycle
the calvin-benson cycle consists of three phases relying on energy supply in form of atp and redox elements  and supply of co2:  carboxylation, during which the enzyme rubisco adds co <dig> to ribulose- <dig> -bisphosphate  to get two molecules of phosphoglycerate ,  reduction, converting the obtained pga into  <dig> -diphosphoglycerate  and glyceraldehyde-3-phosphate , and  regeneration, which recovers rubp after several intermediate steps from ribulose-5-phosphate   <cit> . the calvin-benson cycle is a well-studied system of the plant metabolism due to its importance in providing precursors for the biomass synthesis which is necessary for plant growth. more than  <dig> kinetic models were already developed to analyze the dynamics of this important pathway  <cit> . in this study, we use the simplified model of zhu et al.  <cit>  to describe the dynamic behavior of the calvin cycle, depicted in figure  <dig> and table  <dig>  the concentrations of atp, nadph, phosphate , and co <dig> are assumed to be positive and unbounded, yielding the simplified equations shown in table  <dig> <cit> . for the present analysis, other factors which affect photosynthetic metabolism, such as illumination and temperature, are assumed to be constant.

with the simplified model of the calvin cycle, we examine and compare the performance of the proposed r-dfba approach together with its extensions, the existing m-dfba approach and our proposed extensions, as well as the classical dfba. in total, ten different approaches, based on different constraint-based formulations, are used in the analysis of the dynamics of metabolite and flux profiles in the calvin cycle . with each approach, the concentration of the metabolites ribulose-5-phosphate , ribulose- <dig> -bisphosphate , 3-phosphoglycerate ,  <dig> -diphosphoglycerate , glyceraldehyde-3-phosphate  and sink as well as the rate of the seven reactions  are investigated over a time period of ten seconds, which is sufficient due to the fast settling of the system in a steady state  <cit> .

for the analysis, the time period is divided into five finite elements, and the variables  are parameterized at the roots of the fifth order legendre polynomial. maximizing the sink production is assumed as systemic objective for the dfba approach, capturing the utilization of pga and gap to build the metabolite precursors necessary for sucrose and starch synthesis. for the remaining methods, the objective is modified to minimizing the fluctuation of the profile of metabolite concentrations/fluxes, according to the hypotheses of m-dfba and r-dfba.

the results obtained by the different methods are compared to the outcome of a kinetic model of the calvin cycle, described in  <cit> . for the kinetic model as well as for the other compared methods, the same initial conditions are used . in addition, for the dfba-based approaches the limits for the gap concentration over time are set to the outcome of the kinetic model with an added tolerance of +/-  <dig>  mmol l- <dig>  the solutions to minlp formulation of r-dfba  are obtained with γx =  <dig> , γv =  <dig> , and εx =  <dig> , εv =  <dig> , representing the relative and absolute ranges of tolerance, respectively. for each approach, we determine the residual sum of squares , quantifying the correspondence between the constraint-based and kinetic modeling approaches. furthermore, we determine the temporal evolution of kendall τ for the metabolic states of the constraint-based and kinetic modeling approaches in order to qualitatively examine the coupling between metabolic profiles and distribution of fluxes for the two types of modeling approaches.

r-dfba yields accurate time-resolved predictions of metabolite profiles
the effect of minimizing the flux changes is especially pronounced in the two variants of the flux-based r-dfba. here, the results for the dpga concentration are similar to those of the basic m-dfba and its extensions. the behavior of the dpga concentration predicted by both flux-based r-dfba variants at the beginning of the simulation is very close to the kinetic modeling results, which can be explained by the coupling between fluxes and concentrations giving rise to particular temporal profiles.

however, this behavior is lost in  r-dfbacf, which combines the basic and flux-based variant of r-dfba. in the variants of r-dfbacf, the changes in flux rates and metabolite concentrations are weighted equally, as given by the objective function: ∑i=1nyi,j+ ∑l=1fzl,j. a different weighting in the objective function of r-dfbacf could avoid the loss of the observed behavior. this suggest that the objective function may have a more intricate form zl,j, where α is a parameter weighting the contribution of reaction rates and metabolite concentrations).

the results from the dfba approach for the dpga and rubp concentration over time are very similar, with small changes in the first three seconds, leading to almost zero concentrations at the end of the simulation. the predicted rubp concentrations of the basic m-dfba and its extensions are nearly constant over time; on the other hand, with the proposed nlp-based r-dfba approach, changes in concentrations are obtained in the first half of the simulated time interval, followed by a constant concentration. the concentration of this metabolite at the end of the simulation differs between the proposed minlp-based r-dfba variants. we point out that experimental measurements in isolated cells and chloroplasts have resulted in low levels of rubp  <cit> .

comparing these results with the outcome of kinetic modeling shows that for these two metabolites minlp-based r-dfba predicts the most accurate temporal profiles. the constant concentration in the second half of the simulated interval of the nlp-based r-dfba is very close to that of kinetic modeling, for both, the basic r-dfba and r-dfbacf. to quantify these observations, we determine the residual sum of squares, by calculating the distance between kinetic modeling results and predicted results of the different approaches, see table  <dig>  the proposed approaches exhibit the smallest rss values for these two metabolites, demonstrating the predictive power of r-dfba not only on minlp but also on nlp.

the discrepancy between the kinetic modeling results and the results obtained from the dfba-based approaches is quantified based on the residual sum of squares

the simulated results of the concentrations of the other four metabolites are depicted in figures s <dig> - s <dig> in additional file  <dig>  due to the fact that we have integrated rather strict constraints for gap, the predicted concentrations of this metabolite over time are very similar for all approaches and also compared to the kinetic-based model. for ru5p, the results obtained by the basic minlp-based r-dfba are in accordance with the kinetic modeling results and outperform the remaining approaches; on the other hand, the nlp-based r-dfba variants predict a constant amount of ru5p of about  <dig> mmol l- <dig> except for the flux-based variant, which also predict a nearly consumed ru5p after four seconds similar to the kinetic-based results. surprisingly, the predictions based on the minlp-based r-dfbacf are inconsistent with all other approaches. here, the minimization of significant fluctuation changes of flux levels and metabolite concentrations results in a short decrease followed by an increase of the ru5p concentration. we believe that this behavior of the r-dfbacf variants is due to the over-constraining of both fluxes and concentrations.

in addition, the pga concentration closest to the kinetic modeling results is predicted by the minlp-based r-dfba approach which minimizes significant flux changes. contradictory to the results from all other methods, the flux-based r-dfba, formulated as nlp, predicts an increase of the pga concentration.

finally, we analyze the concentration of sink over time. intriguingly, the sink concentrations are almost constant in the predictions of all nlp-based variants of m-dfba and r-dfba. however, for all minlp-based r-dfba variants as well as for the dfba approach, an increase of the sink concentration is observed, which is in line with the kinetic modeling results. quantitatively the basic minlp-based r-dfba approach predicts the best simulation results for the concentration of sink.

taken together, the results of the rss-based analysis demonstrate that minlp-based r-dfba outperforms m-dfba in four out of six cases in predicting metabolite concentrations over time.

coupling of time-resolved flux predictions
the flux levels over time, also known as time-resolved flux predictions, obtained by the different methods are depicted in figures s <dig> - s <dig> in additional file  <dig>  by inspecting the results, it becomes apparent that the predictions of the nlp-based variants of both m-dfba and r-dfba differ from the outcome of kinetic modeling. the reactions rates are very small for these six methods. comparing the basic methods with the flux-based variants of m-dfba and r-dfba show smoothing of curves, which is also appears in the results of m-dfbacf and r-dfbacf. furthermore, it can be observed, that after four seconds for all nlp-based r-dfba variants the reaction rates are close to zero.

interestingly, the reaction rates results obtained by dfba are very close to the kinetic modeling results, as indicated by the rss values in table  <dig>  the accuracy of dfba in the prediction of reaction rates demonstrates that the non-perturbed network may operate towards maximization of sink production. however, we point out that for the reactions v <dig>  v <dig>  v <dig>  v <dig> and v <dig> the predicted reaction rates by dfba are bounded by the corresponding vmax; the latter do not constrain the predictions in the rest of dfba-based methods.

the discrepancy between the kinetic modeling results and the results obtained from the different dfba-based approaches is quantified based on the residual sum of squares

we argue that to maintain robustness in case of an internal perturbation, the system may opt to optimize additional objectives which are captured by the dfba-based extensions. indeed, we observe that the predicted rates obtained by the minlp-based r-dfbacf are closer to the kinetic results than all m-dfba approaches, as quantified by the rss.

in the results of the minlp-based r-dfba variants, we observe slight local fluctuation which may be attributed to the presence of a large null space in the process of searching an optimal solution of the objective function. a higher-order legendre polynomial and, therefore, more orthogonal roots in each finite element may reduce these fluctuations. altogether, these results indicate the decoupling of metabolite concentrations and flux rates in the determined solutions, i.e., that the metabolite concentrations and flux levels change independently of each other. however, it is possible that other optimal solution may reside in the vicinity of the results from the kinetic modeling.

to qualitatively examine the extent to which both metabolic concentrations and flux distributions are in agreement with the outcome of kinetic modeling over time, we determine the kendall τ correlation for the corresponding metabolic states. the results in figure  <dig> demonstrate that, qualitatively, the dfba approach captures best the coupling of flux distributions and metabolic concentrations over time, followed by the flux-based m-dfba and three of the proposed approaches--the flux-based r-dfba and r-dfbacf based on minlp as well as m-dfbacf.

in addition, these results demonstrate that while the nlp-based r-dfba methods yield good predictions of metabolite concentrations, the predicted flux distributions over time are decoupled from the metabolite profiles. interestingly, the same observations for the decoupling of fluxes from metabolite concentrations hold for all m-dfba-based approaches, except the flux-based m-dfba. these findings indicate that some results of dfba-based approaches warrant caution in biological interpretation and applications to metabolic engineering via flux control. due to the highly coupled regulation of flux and concentrations in metabolic networks  <cit> , it is not surprising that the minlp-based formulations, especially the flux based r-dfba and r-dfbacf, outperform the rest of the investigated approaches.

comparison of the proposed methods and a kinetic model of the plant carbohydrate metabolism
in this section, we analyze the diurnal dynamics of central carbohydrates in leaf cells of wild type c3-plants with the help of the ten implemented methods. in parallel to the wild type, analyses are performed for the inv <dig> mutant, which is defective in the vacuolar invertase gene, atβfruct <dig> . like in the previous section, the performance of the methods to accurately simulate the dynamics of the metabolite concentrations and fluxes is determined based on the rss values between the results of the constrained-based approaches and the kinetic models for the wild type plant and the inv <dig> mutant .

the models for both, wild type and mutant, include six metabolites, namely: glucose, fructose, sucrose, sugar phosphates, and starch, as well as a combined sink export, which are interconverted through seven reactions . these models include the most abundant sugars and sugar phosphates in the carbon metabolism of plants, without resolving subcellular compartments. therefore, they sacrifice the complexity to increase feasibility of simulation studies. the reactions are modeled over a  <dig> h diurnal cycle with inclusion of limited knowledge regarding the kinetic parameters in the models of the wild type and the mutant. therefore, these examples demonstrate that the constrained-based formulations proposed in this study support also the inclusion of kinetic information. the kinetic models used in these comparisons depend on publicly unavailable measurements. however, among others, the rate of net photosynthesis was approximated by a smoothing spline interpolation of measurements over whole diurnal cycles. furthermore, unknown model parameters were identified by minimizing the sum of squared errors between simulated and measured states  <cit> . as a result, these case scenarios of comparing the performances with the results from the kinetic models can be viewed as a proxy for the data-driven comparison.

the simulation day begins at  <dig> o'clock and has a  <dig> hours light and  <dig> hours dark phase. the time period is divided into twelve finite elements, and orthogonal collocation is applied to a time interval of two hours. this results in at least  <dig> variables which need to be optimized based on over  <dig> constraints, depending on the different approaches. for the dfba approach, maximal sinks production is supposed to be the systemic objective to be optimized.

rss for metabolite concentrations and reaction fluxes
inspection of the rss results for the metabolite concentrations, presented in table s <dig> and s <dig> in additional file  <dig> for the wild type and the inv <dig> mutant, respectively, support the statements made in the previous section, dealing with the model of the calvin-benson cycle-the nlp-based r-dfbacf variant outperforms not only the three m-dfba variants, but also the classical dfba based on maximal sink production for the wild type as well as the mutant. in addition, the same claim holds for majority of the metabolites for the basic and the flux-based nlp variants of r-dfba.

with respect to the reaction fluxes for the wild type as well as for the inv <dig> mutant, the flux-based m-dfba outperforms all other methods; nevertheless, the basic nlp-based r-dfba ranks second. inspection of the rss results, presented in table s <dig> and s <dig> in additional file  <dig>  are in line with our observation that constraint-based approaches result in decoupling of the metabolite concentrations and reaction fluxes. nevertheless, taken together, these findings indicate that the proposed constraint-based approaches for simulating the dynamics of metabolic networks may be a suitable tool in analyzing models of metabolic processes for which little information, aside from stoichiometry, is available.

challenges in comparison of experimental data with the findings from method applications
the time-dependent concentration and flux profiles predicted by the proposed methods are in good agreement with the respective profiles generated from the kinetic models of the calvin-benson cycle and carbohydrate metabolism. nevertheless, the ultimate biological validity of the minimization principle, used to obtain the aforementioned predications, remains to be established with the help of experimental data of in vivo metabolite concentrations and intracellular reaction fluxes. however, designing and conducting experiments from which non-stationary metabolite concentrations and reaction fluxes are to be measured is an extremely challenging task. for instance, decades of experimental work for quantifying the absolute concentrations of photosynthetic intermediates  <cit>  and end-product pathways have resulted in methods applicable for obtaining the in vivo steady-state levels for  <dig> metabolites  <cit> . moreover, virtually all existing methods for determining intracellular fluxes rely on model estimates generated with the help of labeled metabolomics data and the steady-state assumption  <cit> . finally, the methods for monitoring the non-stationary state are currently not suited for system-level probing. given the state-of-the-art, we employed synthetic data, generated from the considered models, as a first step in validating the claims.

application to genome-scale metabolic networks
the analysis of genome-scale networks is the focus of current modeling strategies with many different applications, including metabolic engineering and drug targeting  <cit> . furthermore, in the last years, the quality of genome-scale models has improved due to the incorporation of extensive experimental data, resulting in a large number of included reactions and metabolites. for instance, the new reconstruction of escherichia coli includes  <dig>  metabolic reactions, and  <dig>  unique metabolites  <cit> . an accurately simulation of the behavior of this network over  <dig> seconds using dfba-based methods with the same setting as for the calvin-benson cycle model, would result in at least  <dig>  unknown variables for the flux rates and  <dig>  for the metabolite concentrations over time. it is important to note, that while solving some special classes of nlp can be performed in polynomial time, minlp problems are often not tractable . therefore, an application of dfba-based methods to genome-scale models is currently hampered by the size of the resulting instances as well as the lack of optimization platforms which scale well. in addition, a comparison of the predictive power of the different methods is only possible by including experimental data, or at least kinetic model predictions, as it is the case for our analysis. to our knowledge, kinetic model based predictions, and particularly experimental data of the profile of metabolite concentrations and flux levels, are not available for genome-scale models. nevertheless, as shown above, the predictive power demonstrates that dfba-based methods are useful for an accurate prediction of time-resolved metabolite concentrations and flux rates of metabolic networks for which kinetic parameters cannot be obtained but solving at least the nlp problems are possible.

CONCLUSIONS
in the present work, we proposed a new approach to analyze the dynamic adjustment of metabolic networks, called r-dfba. r-dfba combines the dynamic fba with regulatory on/off minimization by minimizing the total number of significant metabolite concentration changes in comparison to flux changes in the classical approach. additionally, we extended this method and the m-dfba approach by considering not only the fluctuation of the metabolite concentration profiles but also those of the flux levels in the network. we introduced seven new approaches and, in total, ten constraint-based approaches were implemented and their accuracy was compared with the outcome of two kinetic models--for the calvin-benson cycle and for the plant carbohydrate metabolism.

for the models of the calvin-benson cycle and the plant carbohydrate metabolism, we demonstrated that our proposed approaches yielded results in accordance with predictions from kinetic modeling, specifically for the case of metabolite concentrations. in addition, we demonstrated that the nlp-based r-dfba approach captures the dynamic coupling of reaction fluxes and metabolite concentrations. therefore, constraint-based approaches in combination with collocation on finite elements offer a promising framework for analysis of metabolic network dynamics without specifying the details of enzyme kinetics. the proposed approaches outperform the existing variants in several cases and are suitable for positing model-based hypotheses for the dynamics of metabolic pathways when little enzymatic details are available. finally, our findings suggest that minimizing the combination of flux and metabolite concentration fluctuations is the mechanism most likely responsible for maintaining the metabolic network robustness due to internal perturbations.

