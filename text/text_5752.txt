BACKGROUND
it has become apparent that surfaces, comprised of a fraction of the total residues, are the most conserved functional features of proteins. proteins utilize common surface motifs to create precise chemical environments designed to perform specific functions. these motifs are not restricted to a single protein scaffold but can be found within different protein folds or at domain/domain and subunits interfaces. while biochemical activity can be attributed to a few key residues , the broader surrounding environment  often plays an equally import role in fine-tuning molecular recognition and/or catalysis.

powerful evolutionary forces have allowed proteins to govern ligand binding through seemingly subtle local surface variability. these changes, which are not easily detectable by sequence analysis, may provide competitive advantage for optimization of co-factor specificity. in some circumstances, surface diversity adversely affects normal cell process by providing environments for undesired binding events  or mutations directly correlated to disease <cit> . the conservation of functional surfaces presents an opportunity to compare and analyze proteins independent of sequence or fold. these comparisons can be used to classify protein functions or to infer biochemical activity for proteins with unknown function, such as those targeted by structural genomics programs.

several methods have been developed detecting localized, spatial protein similarities with applications for evolutionary analysis, function prediction and drug discovery. the use of graph theory has been widely applied to the comparison of three-dimensional patterns. artymiuk et al. developed an algorithm based on subgraph isomorphism detection to search residue patterns against the pdb <cit> . kinoshita et al. used clique detection algorithms to assign protein biochemical functions using the similarity information of molecular surface geometries and electrostatic potentials <cit> . using a clique-detection algorithm, schmitt et al., compared generic pseudo-centers that code for possible ligand-protein interactions in protein cavities. query cavities are searched against cavbase, a pre-computed database of cavities extracted from the pdb <cit> . the method has been applied to identify surfaces in non-homologous proteins as well as for the classification of protein families <cit> . kleywegt searched for motifs of residue pseudo-centers in a library of protein structures using a depth-first search algorithm <cit> . russell also developed an algorithm based on depth-first search that detects atomic geometric patterns common in between side-chains in proteins and presented new examples of convergent evolution <cit> . parametric statistical evaluations of russell's atomic superposition method were extended by stark et al.  <cit> .

another widely used approach is geometric hashing, which is an efficient method for matching features against a database. jackson and gold used geometric hashing to perform an all-against-all comparison of protein-ligand binding sites in the sitesbase database  <cit> . their method was also applied for functional annotation and building pharmacophore models for drug discovery <cit> . fischer et. al. developed an algorithm based on geometric hashing that detects surface similarities of proteins using spatial patterns of atoms <cit> . a similar method, tess, has been applied for the derivation and matching of annotated spatial templates <cit> . jess <cit> , a successor to tess, searches small groups of atoms under arbitrary constraints on geometry and chemistry and utilized statistics to evaluate matches. it is used to query the catalytic site atlas  <cit>  a collection of annotated residues patterns extracted from manual literature searches. jess is also used in the profunc <cit>  suite of annotation tools in the reverse template search, where a radius defined perimeter extends a local residue pattern search for improved search specificity.

a protein evolution based method, pvsoar, was developed that used the unique approach of aligning sub-sequences of surface residues to establish a residue correspondence between surfaces <cit> . the residues were then superimposed on each other and statistical significance was evaluated for the resulting rmsd. this method was used to detect similar functional surfaces in non-homologous proteins. furthermore, in a recent study of shape variation of ligand binding pockets, kahraman et. al., used a shape-only comparison metric based on spherical harmonics <cit> . it was shown that shape descriptors could be used to classify ligand into their binding sites.

in this study, we describe a new method for the sequence order independent comparison and alignment of protein functional surfaces. our method, surfacescreen, attempts to optimize two components, global surface shape and local physicochemical texture, for evaluating the similarity between a pair of surfaces. surface shape similarity is assessed using a three-dimensional object recognition algorithm and is used to rapidly pre-classify surfaces from a large library of surfaces. surfaces with sufficient shape complimentarity are then aligned by combinatorially identifying the best superimposition of common residues between the two surfaces. we introduce several metrics for scoring different properties of a surface alignment and an overall scoring function used in library searches. furthermore, we introduce the global protein surface survey , a library of annotated protein surfaces calculated from all structures in the pdb. querying surfaces from proteins of unknown function against the gpss library allows surfacescreen to be utilized as predictive tool.

we describe three types of analysis to assess surface shape comparisons and spatial alignments. first, we describe the retrieval of surfaces from the gpss library for surfaces, from the same protein, that bind ligands of various size, shape and pharmacophore properties. for this we use the example of hiv- <dig> protease. second, we use the example of heme  binding sites to describe the retrieval of a functionally diverse binding surface that binds the same ligand. we provide the example of using our method as an annotation tool, identifying a new member of the heme binding monooxygenase family. third, we describe how conformational diversity of bound ligands impacts retrieval rate for ubiquitous nucleotide binding sites. we also present the example of a nucleotide binding surface prediction and crystallographic validation for a structural genomics target with a new fold. we conclude with an analysis of the atp binding surface landscape to provide insight on the correlation between surface similarity and function for structures in the pdb and for the subset of protein kinases.

methods
theory and algorithms
while key conserved residues are localized within a surface for function, additional residues contribute to the overall size and shape of the functional surface environment. in some instances, these non-key residues play an important, but non-obvious, functional role. this has been shown for aminopeptidases, where the mouth opening diameter filters peptide access into the active sites <cit> , or for n-acetyltransferases, where the acetyl-coa and substrate binding surfaces are sub-pockets within a larger cleft <cit> . in other instances, these auxiliary residues have no obvious relevance, being positioned simply as a result of folding and structural requirements, codon pressure or unrelated functional specifications. therefore, a detachment exists between global and local surface properties of functional sites, which can distort comparison measures and mask similarities.

our approach to identifying meaningful similarities between two surfaces is accomplished by decomposing surface comparisons into two components, global shape and local physicochemical texture. global shape comparisons can be a very powerful precursor of overall surface similarity. they are computed very efficiently and can help rapidly reject grossly dissimilar surfaces. this is followed by a non-heuristic spatial residue alignment, which assures the optimal superposition of conserved residues between two surfaces.

surface shape signatures for rapid global surface shape comparison
unlike protein folds, a common lexicon has not emerged to precisely describe the shapes formed by surfaces yet quantitative measures can be computed to empirically describe shape. here, we introduce a metric, the surfaceshapesignature , which describes the global shape of a protein surface that can be used for comparison. adapted from three-dimensional database object retrieval, the method represents the signature of an object as a probability distribution sampled from a shape function measuring global geometric properties <cit> . the complexity of shape matching is then reduced to the comparison of two probability distributions. this approach was used to quickly and successfully retrieve and classify complex shapes from three-dimensional databases.

after a protein's binding surfaces has been identified , the sss is constructed by systematically measuring the euclidean distance between all unique atom pairs for a given surface. this is seen for the nicotinamide-adenine-dinucleotide phosphate  binding surface from human pathogen s. pyogenes  in figure 1c. the inter-atomic distances are then sorted to form the shape signatures. the sss distributions for a selection of heme, nicotinamide adenine dinucleotide  and adenosine 5'-triphosphate  binding surfaces are shown in figure 1d. for reference, sss distributions for a selection of dna and metal binding surfaces are also shown. once the shape distributions for two surfaces are computed, we apply the kolmogorov-smirnov  test <cit>  to compare the probability distributions. the ks test identifies the greatest distance between the observed and expected cumulative frequencies and is bound between zero  and  <dig> .

advantages and limitations of surface shape signatures
the primary advantages of this approach are computational robustness and efficiency. in the original work of osada, the robustness of shape signatures was verified against a variety of transformations including scale, rotation and mirroring and were insensitive to model simplification. these properties are ideal for applications in structural biology as minor conformational changes or small surface perturbations should not mask overall shape similarities. for example, we should be able to detect the similarity between the apo and bound states of a binding site, yet still discern between the two states. insensitivity to model simplification allows for meaningful comparisons between surfaces comprised of non-trivial atoms count differences. the implementation and execution of this algorithm is computationally straightforward and allows a query surface to be searched against the gpss library in minutes.

biochemical functions rely on a combination of shape and chemical compatibility and therefore one should not expect that shape alone could describe this complexity. figure  <dig> shows that nad, atp, and heme binding surfaces share similar and, in some cases, overlapping distributions. the sss comparison can convey gross shape similarity but is void of chemical typing information and cannot be used to infer specific functional information. instead, it provides a fast and robust comparison metric utilized as the entry point into more comprehensive surface shape matching methodology.

surface shape signature similarity threshold
the choice of a shape similarity threshold has a significant impact on the efficiency and specificity of surface library searching. operating under the pretense that ligands with similar shape and molecular weight are more likely to bind to similar pockets, we correlated these properties to sss ks distances. our training data is taken from querying camp-dependent kinase  atp binding surface against the gpss library. with a correlation coefficient of  <dig> , we see that some degree of surface similarity can be inferred simply by molecular weight . we highlight a region on the plot  that corresponds to +/-  <dig> d from the molecular weight of atp and identify the similarity distance of  <dig> , along the x-axis, in which only 11% of surfaces exist as outliers. next, atp was compared to ligands corresponding to the surfaces in our library using the molecular shape matching application rocs . rocs identifies the best superposition of two molecules by optimizing their overlapping volume and reports a normalized tanimoto score. tanimoto values greater than  <dig>  are generally regarded as having similar shape and are highlighted on our plot . the tanimoto scores are correlated to the sss distance in figure 2b. we identify a distance of  <dig> , in which only 10% are outliers. since our assumptions about molecular weight and ligand shape similarity are simplistic and surface comparison hope to identify more evolutionary distant relationships, we set our default threshold distance at  <dig> . in the benchmarking retrieval experiments presented in results section, our default threshold excludes less than 1% of true-positive surfaces, all of which can be justified by unique structural incident .

local spatial surface residue alignments for physicochemical texture similarity
the spatial arrangement of localized surface patterns and orientation of side chains are used to assess our evaluations of biochemical function complimentarity. an exhaustive enumeration and search algorithm, surfacealign, is applied to detect groups of spatially conserved amino acid residue sets. in this application, the term "conserved" refers to the identical residues common to two protein surfaces. our three-dimensional representation of a surface residue is represented by a single point located at the center of mass of all atoms identified as contributing to a particular surface.

the alignment of two surfaces is performed by combinatorially identifying the best superposition of the maximum subset of conserved residues between surfaces. for all conserved residues of each type, we enumerate all combinations and permutations to create unique coordinate sets of common residues between the two surfaces. a visual depiction of an alignment between the heme binding pockets of myoglobin from p. catodon  and structural genomics target hemoglobin alpha- <dig>  is shown in figure  <dig>  the geometric dissimilarity of each coordinate combination is evaluated following the methods of umeyama <cit> , which is based on singular value decomposition of the correlation matrix of the coordinates to identify the least square rotational matrix, translation vector and the root mean square distance . we utilize two variants of the rmsd: the coordinate root mean square distance , for atomic coordinates as represented in our residue model, and the orientation root mean square distance  <cit> . the ormsd is a derivative dissimilarity measure that reduces the effect of outliers on an rmsd value and simulates the conformational flexibility of amino acid side chains.

statistical significance of aligned surface distances
rmsd calculations are sensitive to the number of data points compared, making it necessary to assess the statistical significance of raw distance measures. this is accomplished by converting calculated crmsd and ormsd values to a probability value  measuring the likelihood of obtaining a specific rmsd value for a solution with a given number of residues. this allows for the meaningful comparisons between alignments with differing number of common residues. following the method described by binkowski et al <cit> , random surface alignments were performed for alignment solutions of nres residues, where  <dig> ≤ nres ≤  <dig>  calculations numbering  <dig> were computed to construct lookup tables associating crmsd and ormsd scores to p-values. to minimize the inherent bias in the pdb toward particular protein families, special consideration was employed to utilize a non-redundant surface library consisting of proteins sharing less than 90% whole-protein sequence similarity.

surface volumes overlap of aligned surfaces
while the alignment compares key residues important for shared biochemical function, the volume overlap of an alignment provides a comparison of all atoms belonging to a surface. the overlap volume is defined as the volume difference between the superimposed surfaces and is calculated from the formula:

 vab = va + vb - va∪b 

where va, vb, and va∪b are the volumes of surface a, b and the superimposed construct ab, respectively. volumes are calculated using the weighted delauney triangulation and alpha shape methods  <cit> .

the overlap volume is then used to calculate a tanimoto coefficient, which is a normalized similarity measure <cit> . by using the self overlap volumes , we define the surface volume overlap tanimoto :

 svotab=vabvaa+vbb−vab 

a svot score is bounded between  <dig>  and  <dig>  . the svot values for the spatial alignment series show in figure 3d are  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> , and  <dig>  when viewed from left  to right . the best spatial alignment, as judged by rmsd values, does not guarantee the best svot score .

the interpretation of the svot score is not straightforward for surfaces that have a large volume disparity. figure  <dig> shows a large surface pocket on f420-0:gamma-glutamyl ligase homolog from a. fuldgidus  where a sub-surface  is highly conserved to the gdp binding surface in gdp-binding protein from b. taurus . the volume overlap of the superimposed surfaces has a calculated svot score of  <dig> , suggesting low similarity . in this case, the svot score fails to account for strong sub-surface similarity; hidden by the overall volume disparity.

to improve the alignment scoring, we compute two versions of the svot, the local and global surface overlap volumes. in the global svot , we apply the rotation matrix from the conserved residues to the entire surface . the local svot  is limited to the subset of conserved residues from the alignment solution . the local and global svot are calculated as follows:

 gsvotab=vabvaa+vbb−vab,lsvotab=vabvaa+vbb−vab 

where va and vb are the volumes of the surfaces formed only by the conserved residues used in the alignment solution. the lsvot for the alignment in figure 4g is  <dig> , conveying stronger similarity.

finally, we introduce the ratio svot , to establish a correspondence between the global and local surface volumes:

 rsvot=gsvotablsvotab 

the rsvot is bounded between  <dig> and  <dig> and represents the fraction of a surface utilized in the alignment solution. in figure  <dig>  the rsvot value of  <dig>  confirms that it is a sub-pocket match. the rsvot score can be used to automatically detect surfaces that do not have the desired properties for a particular search .

automated identification of ligand binding surfaces
functional surfaces of proteins can be derived from structural information extracted from three-dimensional coordinates. this task can be automated for pdb files deposited with heteroatom records  describing atoms belonging to small molecule cofactors rather than to part of a biopolymer chain. to extract the functional surfaces that surround structural features of a protein, an exclusion contact surface is generated by measuring a difference in solvent accessibility between a structure with and without a molecule in proximity. this is illustrated for the nadp binding surface from human pathogen s. pyogenes  in figure 1a. atoms with a change in solvent accessibility between the bound and apo structure are identified as the contact surface . we utilize the delauney triangulation and alpha shape method for measuring solvent accessibility  <cit> .

a library of protein functional surfaces
an exclusion contact surface has been calculated for every heteroatom molecule associated with a protein's pdb file and organized into the global protein surface survey . the gpss contains three-dimensional libraries of functionally annotated surfaces from ligand, dna, metal and peptide binding surfaces and is updated weekly to correspond to pdb deposits. libraries are publicly accessible through a web browser <cit>  or via a pymol <cit>  plugin. in this study, we utilize only the ligand binding surfaces of the gpss:  <dig>  members representing  <dig>  unique ligands . for this subset of the gpss, the average number of residues forming a surface is  <dig> and the average molecular weight of the bound ligands is  <dig>  to reduce redundancy and improve search efficiency, we further limit our search library to a single ligand of each type from each protein deposit. the first ligand of each type, as described in the pdb file, was selected.

similarity searching surface libraries
we incorporate our two comparison algorithms, surfaceshapesignatures and surfacealign into a comprehensive searching methodology, surfacescreen, to query a protein surface against the gpss library. the gpss library contains pre-computed binding surfaces for ligand, dna, metals, and peptides from all structures in the pdb. surfacescreen is outlined in figure  <dig>  given a protein structure, we first identify all solvent accessible surfaces on the structure utilizing the castp <cit>  database and select a query surface of interest. the query surface is compared to each member of our surface library using sss. each surface, whose shape is not within a threshold, is eliminated from the library. in this manner, the sss is used as a fast pre-classifier before the computationally intensive alignment algorithm and scoring functions are applied. finally, the spatial alignment is performed and the alignments are scored and ranked.

independently, each scoring function conveys unique properties about a surface alignment, but an overall score is necessary to consistently evaluate and rank surfaces in a database search. to this end, we define the surfacescreen score:

 surfacescreen score=+log⁡−9+gsvot 

the surfacescreen score is bounded between  <dig> and  <dig>  and represents contributions from global shape similarity, local spatial residue alignment, and global alignment volume overlap. the denominator in the crmsd p-value component reflects the maximum probability value estimated by our statistical significance evaluations, 10- <dig>  the ormsd, lsvot, and rsvot scores are omitted because they are too highly correlated to the crmsd and gsvot scores, respectively. they are, however, still useful for post-processing results.

data analysis and classification
receiver operator characteristic curves
surface retrieval benchmarking experiments are summarized in a receiver operator characteristic  curve, where the sensitivity is plotted against its specificity at various significance levels of summed probabilities. in the roc curve, the x-axis represents the false positive rate, or 1-specificity, which is calculated by as 1-tn/, where tn is the number of true negatives and fp is the number of false positives. the y-axis represents the true positive rate, or sensitivity, and is calculated as tp/, where fn is the number of false negatives. an overall performance measure of a classification test can be calculated by the area under the roc curve  <cit> . bound between  <dig> and  <dig>  an auc of  <dig> is indicative of a perfectly accurate classification test, in which all true positives are distinguished from false positive. an auc of  <dig>  corresponds to a random classification test . the auc is a combined measure of sensitivity and specificity.

for our surfacescreen methodology, the roc curves measure our ability to accurately identify similar surfaces from a large database. a true-positive data point in our database retrieval experiments is defined when the ligand from the query surface matches the ligand from the corresponding library surface . this definition should be considered conservative, as protein surfaces have the ability to bind multiple ligands and, in some cases, a false-positive prediction may indeed be a biologically relevant hit.

atp conformation classification
the coordinates for all atp molecules in the pdb were identified and extracted. multiple occurrences of the ligand in structure deposit were included and treated as unique molecules. a pairwise, least-squares superposition of all remaining molecules was performed and rmsd values recorded in a distance matrix. complete linkage clustering was applied to the data matrix. for clarity, we chose to discover the minimum number of conformation families that would accurately represent all atp molecules. a range of cut values was tested and we chose to set the number of clusters to four based on manual visualization and analysis. the four conformations represent the bent, extended, and two intermediary forms of atp.

RESULTS
surface-based retrieval of binding sites for the same protein: hiv- <dig> protease
the utility of surface shape comparisons was assessed by retrieving functionally homologous human immunodeficiency virus  protease-ligand complexes from the gpss. hiv- <dig> protease is an essential aspartyl protease that cleaves nascent polypeptides enabling maturation of viral proteins. inactivation of the protease blocks production of infectious viral particles <cit> . therefore, hiv- <dig> has been an active target and one of the early success stories of rational drug design <cit> . we identified  <dig> hiv- <dig> protein-inhibitor complexes deposited in the pdb with the following criteria: proteins are in the dimer conformation, inhibitors are not compound fragments , and inhibitors are unique in our dataset. the proteins in our dataset share at least 48% sequence similarity and secondary structure similarity z-scores greater  <dig> , as measured using the secondary structure matching  algorithm <cit> .

the binding surface of human hiv- <dig>  with bound inhibitor beb  was selected as a query. first, the query was searched against the gpss library using the sss comparisons. the sorted ks distance scores between the query surface and all members from the library are plotted in figure 6d. points highlighted in red indicate known hiv- <dig> inhibitor binding surfaces. the results behave expectedly as  <dig> of  <dig> have ks distance scores less than  <dig> . plotting the search results in a receiver operator characteristic  curve  we measure the retrieval rate using sss at  <dig> % from the area under the curve  . the poorest ranking hiv- <dig> protease surfaces are associated with aggressive mutation studies in the binding pocket or correlated to decisively small  or large  molecular weight inhibitors.

next, we performed the same search using only the spatial alignment scores to evaluate similarity. we observe that all three alignment-based scoring measures provide better specificity than sss distance score. the auc for crmsd p-value, ormsd p-value, and svot are:  <dig> %,  <dig> % and  <dig> %, respectively. the roc plots are shown for each measure in figure 6e. the improved specificity of the spatial alignment scores comes at a significant runtime disadvantage. the sss shape retrieval method took  <dig> minutes to compare the query to the gpsss library, while the spatial alignment took  <dig>  minutes. when using the sss scores to pre-filter the search library, as described in the surfacescreen methodology, we can achieve an auc of  <dig> % for the combined surfacescreen  score with an overall runtime of  <dig> minutes. the shape signature filter reduced the library 86%, to just over  <dig>  surfaces, yet did not eliminate any true positives from the library.

using the surfacescreen score, the most similar  non hiv- <dig> surface was from plasmepsin ii from p. falciparum , another aspartic protease and a major virulence factor <cit> .p. falciparm is a species of plasmodiums that causes one of the major malaria infections in humans. plasmepsin ii plays an essential role in p. falciparm in the degradation of hemoglobin as a source of amino acids for growth and maturation. the binding surface of inhibitor eh <dig> exhibited strong similarity to the hiv- <dig> inhibitor binding site, with a surfacescreen score of  <dig> . plasmepsin ii shares only 12% sequence identity to hiv- <dig> protease and an ssm alignment produces a non-significant z-score of  <dig> . the surfaces are both formed at the intersection of loops and β-sheets, although the plasmepsin ii binding surface is formed from a single chain, unlike hiv- <dig> protease, which is occurs at a dimer interface. there are  <dig> residues that are conserved between the two surfaces. while it is not surprising that proteases share a similar binding site, the low level of sequence and secondary structure similarity highlights that localized functional conservation can be found in surfaces. our observation is in agreement with recent reports where hiv- <dig> inhibitors have been shown to be effective antimalarial agents <cit> .

the highest-ranking non-protease surface was from aclacinomycin methylesterase  from s. purpurascens . rdmc modifies the aklavinone skeleton in the biosynthesis of anthracyclines in streptomyces species <cit> . anthracyclines are a class of aromatic polyketide antibiotics used as chemotherapuetic agents to treat a wide range of cancers, including leukemia, lymphoma, and breast, uterine, ovarian and lung cancers. despite sharing only 7% sequence identity and being built present in different scaffolds , the rdmc binding surface of dcmat , was found to be similar with a surfacescreen score of  <dig>  . the superposition of the surfaces is shown in figure 6ij and with their corresponding inhibitors in figure 6k. the surprising similarity of these surfaces has significant medicinal impact as it supports the recent reports of the inhibitory effects of anthracycline agents on protease activity <cit> . this result shows how identification of similar binding surfaces  can provide guidance for structure based drug discovery, not only in scaffold design but also to screen against potential undesirable binding site similarities that could result in undesired side effects.

retrieval and prediction of heme binding surfaces
heme is a versatile prosthetic group that plays an important role across many biological systems. hemoproteins have diverse functions including oxygen binding and transport, electron transfer and redox, and catalysis. their functional diversity is accomplished through an equally diverse range of protein topologies <cit> . a comprehensive analysis of  <dig> b-type heme binding interactions by schneider et. al. identified over  <dig> different folds that bind heme in both solvent accessible cavities and buried voids <cit> . even functional homologues show diversity in binding orientation as observed in hasa and hems <cit> . surfaces from myoglobin , nitrophorin , and inducible nitric oxide synthase   <cit> , representing extrema of heme binding, are shown in figure  <dig> 

the variability of heme binding proteins presents considerable challenges for automated identification and retrieval of hemoproteins from sequence and structure databases. using myoglobin from p. catodon  as a query protein, we compared it to a non-redundant  pdb set using blast <cit> . using the  <dig> heme binding proteins in the pdb as true-positive hits, a retrieval rate of  <dig> % is calculated from the rank order of sorted  search results. comparing the structure of myoglobin against the same set of proteins using ssm search results provides a retrieval rate of  <dig> %. the retrieval rate was calculated from the rank order of sorted z-scores. the roc plots are shown for both methods in figure 7h.

the myoglobin query was then searched against the gpss library. the retrieval rate, using the surfacescreen score, is  <dig> %. all surface scoring measures had superior performance over sequence and structure methods . the most selective was the sss ks distance with retrieval at  <dig> %. despite the variability of topologies forming binding surfaces, the binding surface shape appears to be the most conserved feature of hemoproteins. this can be seen in the shape signature plots for myoglobin, nitrophorin and inos . the inos heme binding pocket is the lowest ranking true-positive surface against our query, as observed by the stark difference in shape signatures. it appears that despite evolutionary pressure imposed for functional specification, surface must maintain geometry necessary to accommodate the canonical heme shape. surface shape is better conserved for heme binding than the amino acid environment. these observations agree with that of schneider in which heme binding interactions were found to be generally diverse, with the exception of only three amino acids at "hot spots".

while true heme binding surfaces dominate the top scoring surfaces we find that other binding surfaces have surprising similarity to our query surface. the highest ranking, at position  <dig>  was the ampcpr binding surface from adp-ribose pyrophosphatase  from e. coli . a nudix hydrolase enzyme, adprase catalyzes the mg2+-dependent hydrolysis of adp-ribose to amp and ribose 5-phosphate <cit> . the surface, formed at the intersection of β-sheets and loops, is shown in figure 7ij. the sss plot confirms that strong visual shape similarity between the two surfaces . a shape-based superposition  of the ligands shows that  the similarity of these functionally unrelated proteins may lie strictly in their ability to accommodate similarly sized molecules.

detection of a convergent heme binding surface
convergent evolution presents a far more difficult challenge for annotation of proteins of unknown function. structural genomics target, isdg from s. aureus <cit>  , shows no significant sequence similarity and does not contain the conserved n-terminal histidine or the gxxxg motif characteristic present in the heme-monooxygenases family, yet this enzyme displays classical heme-monooxygenase activity <cit> . also, while all known members of heme-oxygenase superfamily are of all α-helical fold, isdg adopts α+β sandwich with an anti-parallel β-sheet and ferredoxin-like fold and a β-barrel at the dimer interface <cit> .

the structure of isdg has a prominent pocket formed between the α-helices and beta sheets . this is the largest surface pocket identified by the castp webserver <cit> . querying this surface against the gpss library reveals a striking similarity to the heme binding pocket in heme oxygenase  from c. diphtheriae . the sss distributions have distance of  <dig>  . there are  <dig> conserved residues between the surfaces that come from diverse regions of the primary sequence . the surfaces align with crmsd p-value of  <dig>  × 10- <dig>  and ormsd p-value of  <dig>  × 10- <dig> . superposition of the surfaces results in gsvot of  <dig> , lsvot  <dig> , and rsvot of  <dig>  . the gsvot overlap is highlighted in figure 8j. the surfacescreen score for the comparison is  <dig> , which ranked fourth overall against the search library.

several other structural homologues to isdg have subsequently been solved in the structural genomics effort. a clustering of the putative binding sites for four additional enzymes is shown in figure  <dig>  surface analysis reveals that the heme binding pocket is well conserved in protein tt <dig> from t. thermopilus  and protein bc <dig> from b. cereus  suggesting that both t. thermopilus and b. cereus can acquire iron through heme degradation. despite overall structural similarity, the binding surface is not well conserved in actva-orf <dig> from s. coelicolor , a protein involved in antibiotic synthesis that is known to bind 6-deoxydihydrokalafungin  <cit> . expectedly, this surface forms the most distant branch of the clustering. although all proteins appear to function as monooxygenases they operate on very different substrates suggesting that convergent evolution may be an important driving force to evolve new functions from existing protein scaffolds. in this manner, surface analysis could be used to define a chemical structure space by interpolating between known substrates clustered on each node.

binding site retrieval of functionally diverse and conformationally variable nucleotides
specific nucleotide binding site retrieval
atp is a multifunctional nucleotide associated that has been classified to catalyze  <dig> different reactions by the enzyme commission . in over  <dig> structural complexes, atp binding is associated with domains from  <dig> homologous superfamilies, some sharing less than 8% sequence identity <cit> . the nucleotide is quite flexible and adopts a wide range of conformations, some in less than energetically favorable states <cit> . to determine the extent that conformational variability exerts on similarity searching, we conducted retrieval experiments with query surfaces binding atp in diverse conformations: camp- dependent kinase  protein kinase ck <dig> from z. mays  <cit> , atp:corrinoid adenosyltransferase from s. typhimurium  <cit> , purt-encoded glycinamide ribonucleotide transformylase from e. coli  <cit> . the conformations were selected by clustering all atp molecules by their three-dimensional shape similarity  and are shown in figure  <dig> 

the aucs calculated using the surfacescreen score were  <dig> %,  <dig> %,  <dig> %, and  <dig> % for atp:corrinoid adenosyltransferase, purt-encoded glycinamide ribonucleotide transformylase, protein kinase ck <dig> and camp-dependent kinase, respectively . the extended atp form, which is the most prominent form in the pdb, had the best retrieval rate, while the bent form atp had the poorest. overall, the rates underperform compared to the hiv- <dig> inhibitor and heme binding surface retrievals. despite the influence of ligand conformation of surface conformations, our method appears rather tolerant to flexible ligands  albeit at the expense of the specificity seen in more rigid molecules.

it should be noted that the retrieval rates for atp are especially conservative, as a disproportional number of atp binding surfaces complexed with other molecules are in the pdb. for example, there are  <dig> structures of protein kinase a from bos taurus  which have atp competitive inhibitors bound. by correcting for protein kinase inhibitor complexes, the aucs improve approximately 4% across all query surfaces. unfortunately, there is no automated method to associate these types of complexes with their native cofactors except through literature analysis, which can be uninformative, as every structure deposit does not have a corresponding publication. the authors are developing an automated database that catalogs such natural cofactor/inhibitor relationships between structures in the pdb.

non-specific nucleotide retrieval
in some proteins, ligand binding is not an exclusive event, as some proteins are able to utilize different cofactors to catalyze the same reaction. casein kinase  <dig>  is a highly conserved eukaryotic serine/threonine kinase that plays a key role in various cellular processes and possesses dual-cosubstrate specificity for guanosine-5'-triphosphate  or atp <cit> . this feature, whose biological significance is not well understood, is exceptional among eukaryotic protein kinases. querying the ck <dig> atp binding surface , we can retrieve gtp binding surfaces from the gpss library with auc of  <dig> %, slightly better than atp. given that the two molecules differ only in their nucleoside, this result is not surprising, as we have shown ligand shape complimentarity is a strong precursor of overall surface similarity. in a comparison of the surface retrieval rates for all nucleotides binding surfaces in the pdb against the ck <dig> atp binding surface, we observe trends which mirror ligand shape similarity: purine derivatives retrieval is better than the pyrimidines and tri-phosphate molecules retrieval is better than di-phosphates which are retrieved better than mono-phosphates. these results suggest that our method may be useful to identify a diverse set of molecular shapes that could potentially bind to a given surface.

prediction and validation of a gdp binding site
the f <dig> coenzyme plays important roles in archaea and eubacteria in a variety of biochemical reactions  <cit> . cofe, a f420-0:gamma-glutamyl ligase, is responsible for the last two enzymatic steps in coenzyme f420- <dig> biosynthesis. belonging to a structurally uncharacterized family of enzymes, cofe from a. fulgidus was solved as a structural genomics target by the midwest center for structural genomics and found to be of novel fold  . solvent accessible cavities were calculated using the castp webserver  <cit> , and the largest pocket, presumably the f <dig>  gtp and l-glutamate binding pocket, was selected to query against the gpss ligand surface library. the top-ranking surface was from gdp-binding protein from b. taurus . a gdp molecule is posed into the surface based on the superposition from the alignment . based on this prediction, the protein was co-crystallized with gdp and a model of the complex was determined  <cit> . the gdp position had rmsd of  <dig> Ǻ from the predicted pose . the addition of the ligand also improved the resolution of the structure from  <dig> Ǻ to  <dig> Ǻ and allowed two loop regions to be modeled where no electron density was previously seen .

atp binding surface landscape
the contributions of molecular flexibility only partially account for reduced retrieval rates observed for atp binding surfaces. it is surprising that binding surfaces for this essential nucleotide do not exhibit a greater level of conservation. to explore the global relationship between surfaces, enzymatic functions and ligand conformation, we carried out an all-against-all comparison for a limited homology dataset  of atp binding surfaces. this cutoff was selected to encourage surface diversity between functionally homologous proteins yet eliminate redundant analysis. a distance matrix for the  <dig> surface set was constructed using the surfacescreen score and complete linkage clustering was applied. a dendrogram of the clustering is shown in figure  <dig> 

the cluster results show that there is minimal functional exclusivity between binding surfaces and atp conformation. the same enzymatic functions can be accomplished using a variety of binding surfaces and, within each surface, multiple ligand conformations can be bound. in the most well represented functional families, hyrdolases, ligases, and transferases, we observe different degrees of binding mode conservation. a breakdown of surface clustering and ligand conformations is shown as a balloon plot in figure  <dig>  hydrolases have two conformation preferences and favor, deep, encapsulating binding surfaces. bent form atp is disfavored in hydrolases. ligases are the most conserved, heavily favoring the bent form of atp that requires a wide-mouth surface shape. transferases are the most adept of the atp binding proteins, sampling the most surface/conformation combinations. they do not discriminate between atp conformations but have a preference for encapsulating binding sites. several combinations occur with higher frequencies, including an exclusive combination , which is the most observed in this family.

analysis of a broad collection of atp binding proteins suggest that some functional families may have conserved binding surfaces while others are more divergent. binding surfaces themselves also deviate on their level of ligand conformation tolerance. it is likely that altering protein surfaces may be the most cost effective evolutionary mechanism for exploiting functional niches, even within functional families.

automated protein kinase classification by atp binding site comparisons
within the transferase family, the most well conserved atp binding surfaces belong to protein kinases. protein kinases play vital roles in regulating cellular pathways by phosphorylating other proteins. malfunctioning kinases have been linked to a variety of diseases such as immunodeficiency, endocrine disorders and cancer, making them the target of drug discovery efforts. at their highest level, kinases are divided by the amino acid residues they target  and further classified by more specific biochemical activity. functional classification of kinase families has been undertaken by many methodologies utilizing primary sequence, structure, binding sites, pharmacophore profiles and expert manual analysis  <cit> 

we apply our comparison methodology to protein kinases to assess our ability to automatically classify them into their functional subfamilies using only atp binding surfaces. a dataset of  <dig> protein kinases with bound ligands, including both natural and synthetic molecules, were annotated using a combination of the pdb web query system, ec numbers, kinbase <cit>  and the protein kinase resource <cit> . for consistency, family nomenclature is applied from kinbase.

an all-against-all comparison was performed with results used to populate a distance matrix of surfacescreen scores. a dendrogram showing the complete-linkage clustering is shown in figure  <dig> where each surface node is color coded by kinase subfamily. overall, the method shares strong agreement with the annotated classification, as seen by the color banding. cdk <dig> kinases are the most ordered; with all members perfectly clustered together and distinct sub-grouping separating nucleotide ligands from small compound inhibitors. the ck <dig> and camp families also show divergence between natural ligands and inhibitors. the camp groupings are further clustered by the molecular weight of their bound ligands. the mitogen activated protein kinases  are successfully classified into their sub-families, but on distant nodes in the graph. in all families, we observe differentiation based on the activation state of the kinase.

surface based classification conveys many similarities to other methods, but has advantages of additional functional insight that could not be automated in other methods. the ability to distinguish between different activation states and to organized surfaces based on ligand types and molecular weight differences could prove useful in developing binding profiles for enhanced specificity in kinase drug discovery.

binding surface similarity of c-abl kinase inhibitors
the surreptitious fusion of the cellular form of abelson leukemia virus tyrosine kinase  with the breakpoint cluster region  gene disrupts the internal control mechanism causing increased tyrosine kinase activity <cit> . the fusion protein bcr-abl results in the disease chronic myelogenous leukemia . five structures of c-abl proteins can be found in the pdb with two classes of small molecule inhibitors: pyrido pyrimidine-type  and 2-phenylaminopyrimidine-type . both inhibitor classes bind in the atp binding, but 2-phenylaminopyrimidine-type bind exclusively in the inactive conformation of the activation loop. the smaller pyrido pyrimidine-type class are indifferent to activation state, making them more potent but less specific inhibitors <cit> . our clustering accounts for this behavior and groups them in distinct nodes.

the 2-phenylaminopyrimidine-type inhibitor sti- <dig>  is an effective inhibitor of c-abl activity for treatment against cml  <cit> . it has been shown to be specific for tyrosine kinases and also inhibits stem-cell factor receptor kinase c-kit . results from querying c-abl  against the gpss library show ckit is the best scoring non-abl kinase. this cross reactivity is detected in our cluster .

a surprising member of this cluster node is serine/threonine kinase p <dig> mitogen-activated protein  kianse . p <dig> map kinases play critical roles in regulation of proinflammatory cytokines such as tumor necrosis factor and interleukin- <dig> and are a target for many inflammatory diseases <cit> . sti- <dig> is not currently known to inhibit, by design or mechanism, any serine/threonine kinase <cit> . the structure of 1kv <dig>  complexed with inhibitor b <dig>  occupies a unique conformation for p <dig> maps, where the highly conserved dfg motif is turned out <cit>  . this is the first observation of this state in a serine/threonine kinase, where it is a hallmark for tyrosine kinases .

a superposition, based on the alignment of the binding surfaces of c-abl and p <dig> map, shows that the inhibitors bind in similar orientation . sti- <dig> can be posed into the p <dig> map surface, based on the alignment of the surfaces, with no steric clashing and preserves the orientation of several polar atoms . while the conformation of this p <dig> map is unique and presumed to occur infrequently, its existence presents opportunity to explore the use of sti- <dig> and analogs for additional therapeutic uses. automated surface classification can also provides important cross-reactivity analysis; where unexpected binding sites similarities could result in undesired side effects.

CONCLUSIONS
proteins maintain the surprising ability to preserve local, sequentially unordered, surface residue patterns capable of performing explicit biochemical functions in proteins showing negligible evolutionary relationships. even in homologous proteins, subtle amino acid mutations, which can be underappreciated by sequence analysis, can alter the properties of a surface and protein function. in this study, we describe a novel method for the comparison and analysis of protein functional surfaces. we observe that conservation of surface shape and physicochemical texture provides sufficient discriminative features for accurate retrieval of functionally homologous binding sites. the method serves as a predictive tool allowing for the identification of cross-binding ligands or binding sites on proteins of unknown function and for the comparative analysis of proteins, such as the classification of functionally diverse families. we introduced the global protein surface survey, a searchable library of functionally annotated protein sites. the surfacescreen methodology was benchmarked against binding pockets from hiv- <dig> protease, heme, and atp and used to further analyze the relationship between surface similarity, biochemical function and ligand conformation.

limitations and outlook of surfacescreen
our results have shown that two components, shape and physicochemical texture, define well the functional competence of surfaces. surface geometry allows accessibility and proximity for interaction and accurate residue positioning make available specific functional groups for biochemical function. a notable limitation to our current method is our spatial residue model, which does not afford for amino acid substitutions during spatial alignments. previous studies have shown that the substitution rates for localized surfaces differ from those of the whole sequences <cit>  and that these differences can provide better discrimination in surface sequence comparisons. one option would be to exclude residues less likely to be involved in function. for example, in the study of general enzyme function, ysteng et al <cit>  studied  <dig>  functional surfaces to discover his, asp, glu, ser, and cys residues account for more than 80% of active site residues in functional pockets. this is similar to previously published reports  <cit> . defining a minimum residue set describing different functions is plausible, but would reintroduce difficulties arising from global versus local surfaces characteristics and properties. this would also naively assume that some of the residues excluded in a scheme are not contributing in some way, either mechanistically or structurally, to the function. many proteins also show high promiscuity and can bind several different ligands into this same functional site <cit> , solvent mediated interactions add complexity to the surface comparisons <cit>  and electrostatic potential also plays important role in conformational changes and attracting or rejecting ligands <cit> . it is clear that in the future analysis of protein surfaces properties will need to include contribution from electrostatic potential, side chain dynamics, and chemical propensities to better describe functional sites.

authors' contributions
aj and tab conceived of the study and performed analysis on provided examples. tab designed the methodologies and implemented the software. all authors read and approved of the final manuscript.

