BACKGROUND
knowledge of the tertiary  protein structure is vital when addressing the problems in protein folding and function. the commonly accepted hypothesis that protein sequence uniquely determines protein structure  <cit>  enables development of methods for prediction of 3d structure from sequence. such methods are of substantial value due to the large and exponentially growing sequence-structure gap. currently, the sequence based 3d structure prediction is still a challenging task  <cit> . therefore, a set of intermediate, more tractable predictions that target various structural aspects, such as solvent-accessible surface area , secondary structure , contact number or order, etc., were researched and applied to predict protein structure and function.

the residues that constitute a protein could be divided into surface residues and the remaining residues that are buried in the protein's interior. since surface residues are directly involved in the interaction with other biological molecules, they have been widely studied  <cit>  and used for identifying protein function and stability  <cit>  and to aid fold recognition  <cit> . the prediction of the relative solvent accessibility , which is defined as the asa of each residue in the protein divided by that observed in an extended  conformation and which can be used to identify surface residues, was addressed by a number of methods  <cit> . at the same time, the buried residues, which were shown to have similar local packing arrangements irrespective of protein size  <cit>  also play important roles including formation of a hydrophobic core that helps maintaining protein folding conformation  <cit>  and maintaining of the structural integrity of the protein due to their high degree of conservation that is also shown to have impact on formation of enzyme active sites  <cit> , among others. however, asa values that can be accurately predicted from protein sequence, e.g. wang and colleagues reported  <dig>  correlation between the predicted and the actual rsa values  <cit> , cannot provide sufficient information to characterize buried residues, i.e. the asa values of the buried residues are zero or near zero.

as an alternative, the depth of an atom or residue in the protein has been proposed to characterize spatial arrangement of protein structures  <cit> . several definitions of atom depth have been proposed, including those distance  or volume dependant  <cit> . the residue depth  is the average atom depth of all atoms composing this residue. this descriptor has been shown to have higher correlation with residue conservation when compared with asa. it was also found to be useful for analysis of amide hydrogen/deuterium exchange rates in nuclear magnetic resonance  experiments  <cit> , for analysis of local packing arrangements in the protein core  <cit> , for analysis and prediction of function sites, such as catalytic sites of enzyme  <cit>  and phosphorylation sites  <cit> , and for protein fold recognition  <cit> . recently, it has been suggested that the most deeply buried residues in the native protein fold might be the first to fold  <cit> , which signifies their importance with respect to folding predictions and simulations. based on the above, an accurate methodology to predict residue depth from the sequence would provide a useful input for analysis and designing methods for the protein folding.

to date, only one method for prediction of the residue depth based on the protein sequence was developed  <cit> . this method, which utilizes information encoded in the psi-blast scoring matrix and a support vector regression  predictor  <cit> , was designed and tested using a large dataset of  <dig> chains . this method is characterized by the correlation coefficient between the predicted and the actual depth and the mean absolute error of the depth prediction equal  <dig>  and  <dig> , respectively. the authors considered the position-specific scoring matrix generated by psi-blast and protein size as the only inputs, although other information could be used to further improve the predictions. in our work, we focus on adding additional inputs  that are based on the predicted secondary structure, position in sequence and information per position from psi-blast to provide higher quality residue depth predictions. our careful design of the proposed method, which is based on performing feature selection and parameterization of the svr predictor, is also shown to contribute to the improvements. we show that the proposed method provides statistically significantly better predictions when compared with the competing method by yuan and wang  <cit> . we also analyze the selected features to discuss factors related to the residue depth, and we show that the application of the proposed method to prediction of surface/buried residues also shows improvements when compared with the competing method.

methods
the sequence based prediction methods work in two steps:  a fixed-length feature vector is computed based on the sequence and sequence-derived information;  the vector is inputted into the prediction model to generate the outcome. the design of the prediction method usually requires a training dataset that is used to construct the model and parameterize the algorithm used to generate the model. in our case we choose svr to construct the model due to its extensive prior use in bioinformatics application that perform real-valued prediction  <cit> , including the existing sequence based depth prediction  <cit> . more specifically, given a sequence, the features were extracted from the sequence itself, and from the sequence-derived psi-blast scoring matrix  <cit>  and secondary structure predicted with psipred  <cit> , see figure  <dig> 

datasets
we prepared four datasets to test and design the proposed method. the first is the original dataset, yw <dig>  used to design and test method proposed by yuan and wang  <cit> . this dataset is composed of  <dig> protein chains including x-ray and nmr structures culled using pdb-prerdb  <cit>  with 25% sequence identity threshold. the included structures were solved by x-ray crystallography with resolution ≤  <dig>  Å and r-factor ≤  <dig> . all nmr structures for those datasets are selected from the first model in pdb files.

following the test procedure performed in  <cit> , we adopted three-fold cross-validation in our design and tests with yw <dig> dataset. due to the large size of the dataset, which imposes time consuming parameterization of svr, we created a subset of the original dataset that includes randomly chosen  <dig> sequences from each fold created from the yw <dig>  this dataset, which is composed of  <dig> chains, is referred to as yw <dig>  the yw <dig> is used to parameterize svr and to perform feature selection .

we also prepared two new datasets from the sequences that are deposited in the protein data bank   <cit>  between jan  <dig> and aug  <dig>  which were filtered to have low identity with the sequences deposited before  <dig>  more specifically, the sequences deposited before  <dig> were filtered using cd-hit program  <cit>  with 90% identity threshold . the sequences deposited between jan  <dig> and aug  <dig> were filtered with cd-hit with global 40% identity threshold . although cd-hit is a computationally efficient application, it is limited to the minimal threshold of 40%, and thus we used needleman-wunsch alignment algorithm  <cit>  to filter out sequences deposited in  <dig> that share above 25% identity to sequences from 90pdb. as a result, the first new dataset, called pdb <dig>  includes  <dig> sequences that share at most 40% identity with each other, and at most 25% identity with sequences published in pdb before  <dig>  to reduce local sequence similarity that could be included when global alignment is used , ncbi's blastclust program  <cit>  was applied to the union set of 90pdb, yw <dig> and 40pdb, with the local identity threshold of 25%  and default minimal length coverage of 90% . the second new dataset was constructed by selecting one chain from each of the clusters that contained no sequences from 90pdb and yw <dig> datasets. this set, called pdb <dig>  includes  <dig> sequences that, as a result, have local 25% identity with each other and also with both 90pdb and yw <dig>  we note that both pdb <dig> and pdb <dig> share low identity  with the yw <dig> dataset that was created before  <dig>  and also with the training set used by psipred version  <dig>   that we applied to compute the predicted secondary structure. this allows us to perform tests on a dataset that is independent of the sequences used to design this method and other methods  that were used to provide our inputs. the pdb ids of the sequences from both new datasets  are included in the additional file  <dig> 

calculation of residue depth
we computed the residue depths for all above datasets following the procedure that had been used in  <cit> . first, msms program  <cit>  was executed with a probe radius of  <dig>  Å to obtain a list of vertices that represent protein surface. the atom depth of an atom, which is defined as the distance between the atom and the nearest vertex  <cit> , was calculated. finally, the average depth of all atoms except the hydrogen atoms in an amino acid defines the residue depth. all residue depth values in abovementioned datasets were normalized using the same mean depth  and its standard deviation  as follows

 xnorm=x−x¯σ 

where x¯ =  <dig>  Å and σ =  <dig>  Å were derived from yw <dig> dataset as shown in  <cit> . for the new datasets, the corresponding mean depths and standard deviations are x¯ =  <dig>  Å and σ =  <dig>  Å for pdb <dig> and x¯ =  <dig>  Å and σ =  <dig>  Å for pdb <dig>  respectively, which are similar to those values of yw <dig> dataset. only the former values  were used to normalize the actual depths of all four datasets in order to assure consistency when performing independent  tests on pdb <dig> and pdb <dig> datasets.

in  <cit> , only the abovementioned msms-based depth index has been considered. in order to analyze differences in prediction performance between distance and volume dependant depth indices, we also computed two other depth indices, dpx  <cit>  and sadic  <cit> , for the yw <dig> dataset. to calculate dpx values, first, naccess program  <cit>  was applied to obtain the solvent-accessible surface areas  for all atoms. then the atom depth was calculated as the distance between a given atom and the nearest solvent accessible atom that had positive asa. similarly to msms-based depth calculation, the dpx value of a residue is the average atom depth of all its atoms except the hydrogen atoms. to compute sadic-based index, given an atom i of a molecule and a sampling radius r, a depth index di, r is defined as di, r = 2vi, r/v <dig>  r, where vi, r is the exposed volume of a sphere of radius r centered on atom i and v <dig>  r is the exposed volume of the same sphere when centered on an isolated atom. following  <cit> , we computed this index values for cα atoms as the residue depths with a sampling radius of  <dig> Å. similarly as in the case of the msms-based depth, the residue depth values for two other indices in yw <dig> dataset were normalized according to their mean depths and standard deviations with x¯ =  <dig>  Å and σ =  <dig>  Å for dpx and with x¯ =  <dig>  and σ =  <dig>  for sadic algorithm  using the above formula.

feature vector
the feature vector used by the proposed method was encoded based on global and local information that was obtained from three sources: sequence , multiple alignment , and predicted secondary structure .

sequence-based features
earlier contributions  <cit>  have shown that protein size is correlated with both maximum and average residue depths, and this relationship could be represented by a linear or nearly linear function. yuan and wang also showed the beneficial effect of the protein size on the accuracy of depth prediction  <cit> . hence, our method also includes this feature. we normalized this features by dividing the sequence length by  <dig> 

additionally, we observe that the residues at the termini  are usually on the surface or close to the surface. we define the position of the ith residue in the sequence as

 position=|i−/2|l/ <dig> 

where l is the sequence length. this value represents the sequence distance to the center of the chain. these two features  constitute our sequence-based features.

psi-blast-based features
similarly as in psipred  <cit> , psi-blast was used to perform multiple alignment of the input sequence with the e-value equal 10- <dig> and three-iterations against the ncbi nonredundant protein sequence database ; this database was filtered to remove low-complexity regions, transmembrane regions, and coiled-coil segments. psi-blast's output includes position-specific scoring matrix  and information per position . the pssm is a l ×  <dig> matrix, where  <dig> is the number of amino acid types. the score values are first normalized by using standard logistic function

 11+exp⁡. 

the information per position provides a quantitative measure of sequence conservation among the homologous sequences used to construct the pssm for each position  <cit> . this value, which is stored in the second last column in psi-blast profiles, is provided directly by psi-blast.

next, in our coding scheme, a sliding window of  <dig> neighboring residues was used to represent the evolutionary information of a sequence, where each position of the window had  <dig> possible values with  <dig> from pssm and one from ipp. the selection of the window size is motivated by the size used in  <cit> . we denote the psi-blast based features by pssmαh and ipph for each residue, where α represents a type of  <dig> amino acids and h = {- <dig>  - <dig> .., + <dig>  +7} represents a position in the sliding window  corresponds to positions towards n-terminus  with distance of h from the central residue. as a result, there are  <dig> ×  <dig> features generated from the psi-blast's output.

psipred-based features
the secondary structure prediction was performed using psipred due to the following:  psipred was recently shown to provide superior accuracy when compared with other state-of-the-art secondary structure prediction methods <cit> ;  this method is frequently used to support a variety of other predictions tasks such as solvent accessibility  <cit> , fold prediction  <cit> , folding rate prediction  <cit> , predictions of beta-turns  <cit> , alpha-turns  <cit> , contact order  <cit> , to name just a few. the motivation to include secondary structure came from the differences in distributions of the residue depth values within to three secondary structures i.e. helix , strand , and coil   <cit> . while yuan and wang considered the actual secondary structure to analyze the distributions  <cit> , we apply the secondary structures predicted from sequences. we note that the psipred predictions include the secondary structure state for each residue that is accompanied by the corresponding probability. based on the insights provided in  <cit> , we investigate whether these probabilities could be used to address residue depth prediction.

we designed several feature sets based on the outputs from the psipred, which include local and global information. the local information is composed of  <dig> ×  <dig> features that concern probabilities in a window of  <dig> neighboring residues, where the secondary structure of each residue is represented by a 3-dimensional probability vector, i.e., probability of coil, strand, and helix prediction. these secondary structure probability profiles  for each residue are denoted by sspαh, h = {- <dig>  - <dig> .., + <dig>  +7} comprising  <dig> features. the global information is coded by the secondary structure content and the frequency of secondary structure segments as follows:

 contentα=#α#h+#e+#cfsegα=#segα#segh+#sege+#segc 

where α = {h, e, c}, #α is the number of secondary structures of type α in the sequence, and #segα is the number of segments that only contain one type of consecutive secondary structures α. we note that since one or two consecutive predicted helical residues could not form a helix segment, they are replaced by coils when computing the frequency of secondary structure segments. hence, we obtain  <dig> ×  <dig> +  <dig> +  <dig> =  <dig> psipred-based features.

overall, we produced  <dig> features that serve as the input vector for the proposed prediction model, see table  <dig>  in contrast, yuan and wang used  <dig> ×  <dig> features based on the pssm matrix and  <dig> feature based on the protein size   <cit> . for the sake of comparison with the results of yuan and wang's  method  <cit> , we combine the position and ipp features together . this way, we define four sets of features that include pssm , ss , ps , and pi .

prediction method
support vector regression
svr is a regression model based on the support vector machine   <cit> . the motivation behind the choice of svr comes from wide-spread applications of svrs in real-value predictions concerning various bioinformatics problems, such as prediction of accessible surface areas  <cit> , contact numbers  <cit> , protein b-factors  <cit> , gene expression levels  <cit> , contact orders  <cit> , and finally the application in the existing method for residue depth prediction  <cit> .

svr predictor maps feature vectors into multi-dimensional space by using kernel function k, ε-insensitive loss function and regulatory parameter c. in our case, we use guassian kernel function k = exp . the choice of the kernel function is motivated by its competitive performance for solving nonlinear problems when compared with other kernel functions  <cit>  and prior use for the residue depth prediction  <cit> . similarly as in  <cit>  the error tube parameter ε is set to equal  <dig> , while we optimize the kernel parameter γ and regulatory parameter c through a grid search on yw <dig> dataset . a detailed description of svr could be found in  <cit> .

evaluation of prediction performance
the performance of the proposed method was evaluated based on n-fold cross validation performed on yw <dig>  pdb <dig>  and pdb <dig> datasets. the protein chains were randomly divided into n subsets to create cross validation folds. we performed three-fold cross validation  to maintain consistency with results reported in  <cit>  and ten-fold cross validation . furthermore, we also performed blind tests by training the prediction model on the yw <dig> dataset and testing on two new datasets, pdb <dig> and pdb <dig> 

we adopted three indices to validate and compare quality of the proposed method: pearson correlation coefficient , mean absolute error  and mean relative error  between predicted and observed depths, which are defined as

 pcc=∑i=1n,mae=1n∑i=1n|xi−yi|,mre=1n∑i=1n|xi−yixi|, 

where xi and yi are the observed and predicted depth values of the ith residue in sequence, respectively, and x¯ and y¯ are the corresponding mean values, respectively. the pcc is also used to rank individual features with respect to their relation with the depth values. we emphasize that the prediction quality was reported at the residue level, i.e. all residues in a given dataset were collected together and one pcc value across all residues was computed, while the mae and mre values are computed as the average over all residues. based on our observations, both absolute errors and relative errors between the actual and the predicted depth values have skewed distributions . therefore, as suggested in  <cit> , we report two outer centiles, i.e., the 10th and 90th centiles, to strengthen the analysis of the prediction performance. they show differences between the actual and the predicted depth values for errors with low and high magnitudes . similarly as in  <cit>  we also estimate the quality of the prediction at the fold level. the pcc, mae, and mre are computed for each test fold and next they are averaged over all folds. in this case we also report standard deviations to estimate the spread of the prediction performance.

parameterization of svr
the parameterization of svr was performed through a grid search over γ and c values based on three-fold cross-validation on yw <dig> dataset for the msms based depth. we considered γ and c values drawn from { <dig> ,  <dig> ,  <dig> ,...,  <dig> } × { <dig> ,  <dig> ,  <dig> ,...,  <dig> } grid. two parameterizations were performed:  using the pssm and ps features, which corresponds to the design of yuan and wang  <cit> , we parameterized svr used to perform feature selection ; and  using the features selected by the feature selection from the set of all  <dig> features considered in this study. the first parameterization resulted in γ =  <dig>  and c =  <dig> , while the second gave γ =  <dig>  and c =  <dig> . the latter set of parameters is applied to build the proposed prediction model.

feature selection
to address high dimensionality of the feature set, we processed it to remove irrelevant features. this may lead to more compact prediction model, ability to interpret the selected features, and potentially better prediction quality. we applied a correlation-based feature selection  <cit> , which utilizes the pearson correlation coefficient  values measured between each feature and the target values, to select best-performing subset of the original  <dig> features. in case when the correlation coefficient is close to zero, the corresponding feature is not correlated with the prediction outcome, and thus it could be considered irrelevant. more specifically, we computed the pcc between each feature and the target depth values in two steps. first, the pcc values were computed for each of the three folds in yw <dig> dataset. second, the average pccs over the three folds was calculated and the absolute values were used to rank the original set of  <dig> features. this cross-validation based selection allows for maintaining consistency with the experimental evaluation of the depth prediction quality. next, we tested the quality of the depth prediction using svr with γ =  <dig>  and c =  <dig>  based on three-fold cross-validation on yw <dig> dataset with top  <dig>   <dig>   <dig>   <dig> ...,  <dig> features. the best results, i.e., pcc =  <dig> , mae =  <dig>  Å, and mre =  <dig> %, were obtained with a set of  <dig> features, thus reducing the size of the original feature set by 66%.

RESULTS
prediction performance for the msms based depth
the proposed prediction method was implemented using libsvm library  <cit> . the three-fold and ten-fold cross-validations were used to estimate the out-of-sample prediction quality on yw <dig>  pdb <dig>  and pdb <dig> datasets for msms based depth index . the proposed prediction method, referred to as rdpred, uses  <dig> features and gaussian-kernel based svr with γ =  <dig>  and c =  <dig> .

athe svr parameters are ε =  <dig> , γ =  <dig> , and c =  <dig> .

bthe svr parameters are ε =  <dig> , γ =  <dig> , and c =  <dig> ;  <dig> features were used.

cdue to extensive computational cost, in the case of the 10-fold cross validation only the results for pssm+ps and rdpred methods were reported. the results on the yw <dig> dataset were not reported since this dataset was only used to perform parameterization on the proposed method.

the two values in the brackets are the 10th centile and the 90th centile of the absolute and relative errors.

for the three-fold cross validation the experiments show that rdpred consistently provides better predictions, i.e., it obtains the lowest mae and mre as well as the lowest 10th centile values for the absolute error and the lowest 10th and 90th centiles values for the relative error. for the yw <dig> dataset, when compared to yw method, rdpred improved the mae to  <dig>  , the pcc to  <dig>  , and mre to 17% . although the pcc has decreased and the 90th centile of the absolute error has increased after the feature selection for yw <dig> dataset , both mae and mre as well as the 10th centile of the absolute error and the 10th and 90th centiles of the relative error have improved justifying the need for the feature selection.

most importantly, the same differences are observed for the two new datasets, pdb <dig> and pdb <dig>  table  <dig> shows that rdpred is better than predictions based on pssm and ps features , i.e., for pdb <dig> dataset, the pcc was improved from  <dig>  to  <dig> , mae from  <dig>  to  <dig> , and mre from 20% to  <dig> %, and for pdb <dig> dataset, the pcc was improved from  <dig>  to  <dig> , mae from  <dig>  to  <dig> , and mre from  <dig> % to  <dig> %. this shows that the performed parameterization and feature selection did not overfit the yw <dig> dataset.

the  distributions of the absolute errors and the relative errors on yw <dig> dataset are shown in figure  <dig>  these distributions and the centile values from table  <dig> show that rdpred generates more predictions with low error values and fewer predictions with high error values when compared with the other three methods. the skewness of errors is due to the skewed depth distribution, which is given in figure  <dig> 

we also performed a detailed, i.e., based on the predictions derived using three-fold cross validation for individual sequences in yw <dig> dataset, comparison between rdpred and yw method. since the individual prediction were not available for yw method, we simulated their prediction by using pssm and ps features with our svr model . these results allow evaluation of the value added of performing feature selection, adding ss  and pi  features, and performing the svr parameterization. figure  <dig> shows the relations of mae and pcc values between the rdpred and the simulation of yw method. in case of mae, see figure 5a, we observe that rdpred provides lower errors for majority of the predicted sequences, i.e., for  <dig> out of  <dig> proteins the rdpred predictions are below the diagonal which denotes points where both methods obtain equal errors. similarly, for  <dig> out of  <dig> sequences, the rdpred gives higher pcc values; in this case the points are located above the diagonal, see figure 5b. furthermore, a paired t-test was applied to investigate statistical significance of these differences. the paired t-test performed at 95% significance level, which compared pairs of mae values  for the same sequences predicted by rdpred and the simulation of the yw method, shows that in both cases, i.e., mae and pcc, the rdpred provided statistically significantly better predictions. the corresponding p-values were smaller than  <dig>  for both pcc and mae and t-values were equal  <dig>  for pcc and  <dig>  for mae.

we also report and compare predictions of rdpred and the simulation of yw method that are binned with respect to the actual depth values, see table  <dig>  rdpred obtained better results for residue depth rd <  <dig>  Å and rd ≥  <dig>  Å, similar results for  <dig>  Å ≤ rd <  <dig>  Å and  <dig>  Å ≤ rd <  <dig>  Å, and slightly worse predictions for  <dig>  Å = rd <  <dig>  Å when compared with the method based on pssm+ps features. we observe relatively large improvement for shallow residues characterized by depth of below  <dig>  Å, which constitute 61% of all residues. similar degree of improvement is also observed for the deepest residue, i.e. those with depth above  <dig>  Å. the 10th centile values show that rdpred produces more predictions with smaller errors , while the 90th centile shows that the proposed method obtains fewer larger errors .

the values in the brackets correspond to the 10th and 90th centiles of the absolute and relative errors.

the improvements are attributed to the use of psipred based features and the pi features . we note that yw <dig>  pdb <dig>  and pdb <dig> datasets are characterized by similar q <dig>  values for secondary structures predicted with psipred , which equal  <dig> %,  <dig> % and  <dig> % respectively. this shows that the improvements are due to the use of the proposed features rather than differences in the quality of input data .

to further strengthen the evaluation, we performed blind tests by training both pssm+ps feature  and rdpred with yw <dig> dataset and testing with pdb <dig> and pdb <dig> datasets. the corresponding results are listed in table  <dig>  we observe an improvement due to the use of the proposed method, i.e., the mae and mre values together with the corresponding 10th centile values are lower for both datasets in the case of rdpred, which is consistent with the results obtained based on the three fold cross validations shown in table  <dig> 

the prediction model was trained on yw <dig> dataset.

the values in the brackets correspond to the 10th and 90th centiles of the absolute and relative errors

the paired t-test performed at 95% significance level, which compares pairs of mae values  for the same sequences predicted by rdpred and the simulation of the yw method, for the predictions from both blind tests shows that the differences are significant. more specifically, for the pdb <dig> dataset, p-values for both pcc and mae were below  <dig>  while t-values were equal  <dig>  and  <dig>  for pcc and mae, respectively. similarly, for pdb <dig>  the p-values were again below  <dig>  and t-values were equal  <dig>  for pcc and  <dig>  for mae.

when comparing the results between the two datasets , higher mae obtained for the pdb <dig> dataset shows that this datasets is more difficult . one potential reason is that the pdb <dig> dataset is characterized by larger mean depth than that of yw <dig> . this is also supported by smaller values of mae for pdb <dig> dataset when compared with results on pdb <dig> dataset  because of the lower mean depth of the former dataset . as shown in , buried residues are more difficult to predict than the exposed residues. furthermore, pdb <dig> includes  <dig> multimer chains and  <dig> monomers while yw <dig> includes  <dig> multimer chains and  <dig> monomers. this shows that pdb <dig> has higher ratio of multimer chains, while these chains include larger number of buried residues. the poorer results on the yw <dig> dataset are due to the small size of this dataset.

the table also includes hydrophobic index, charge, and flexibility index values for the  <dig> aas.

predictions for different depth definitions
we computed the residue depths with dpx and sadic algorithms on yw <dig> dataset and their correlations with each other and the msms based depth values are shown in table  <dig>  dpx is shown to be highly correlated with the msms-based values, while in the case of the sadic algorithm, the correlation is lower but still relatively high.

the matrix is symmetrical and thus the values in the upper triangle were left empty.

we applied the same features and parameterization as in the original rdpred method  and performed three-fold and ten-fold cross validations on the yw <dig> dataset using the other two depth indices. we tested two sets of features, pssm+ps  and rdpred's features. the prediction quality measured with pcc and mae at the residue level is summarized in table  <dig> while the pcc and mae values at the fold level are visualized in figure  <dig>  we did not compute the mre values because the two other depth indices include values of zero. the mae values and the corresponding centiles shown in the table  <dig> should not be compared across different depth indices due to large differences in the range of values for the three depth indices.

the results are based on three-fold and ten-fold cross validations on yw <dig> dataset. the values in the brackets correspond to the 10th and 90th centiles of the absolute errors.

in general, the results suggest that all considered depth indices can be accurately predicted from the sequence. the pcc values for the dpx index are similar to values obtained for the msms based depth, which is due to high correlation between these two depths values and the fact that both definitions are based on the distance. as shown in figure  <dig>  msms based depth has bigger error bars for both pcc and mae values when compared with the other two depth indices. this is likely due to the fact that msms index is characterized by the largest standard deviation of the depth values, i.e., the standard deviation equals  <dig> ,  <dig> , and  <dig>  for msms, dpx, and sadic indices, respectively. we performed the paired t-test for pcc and mae values at the fold level for each depth index that compares pssm+ps method and rdpred. these t-tests were based on ten-fold cross validations on the yw <dig> dataset. for the msms, dpx, and sadic based depth definitions the corresponding p-values equal  <dig> ,  <dig> e- <dig>  and  <dig> e- <dig> for pcc, and  <dig> e- <dig>   <dig> e- <dig>  and  <dig> e- <dig> for mae, respectively. we observe that statistically significantly better pcc values were obtained for the dpx and sadic indices, while the difference for the msms index is not significant. at the same time, using the proposed method to predict each of the three depth indices results in statistically significant improvements of the mae values.

following we analyze why the depth defined with sadic algorithm yields higher quality predictions. the reason for the differences in the prediction performance between sadic and the other two depth indices is due to the fact that sadic is a volume based depth, while the other two are distance-based. the volume based depth is negatively correlated with the other two distance based depth indices. as shown in figure  <dig>  the maximal and mean distance based depth values  show larger variability with the increasing size of the protein chain, while the maximal and mean volume based depth values are independent of the chain size. the definitions of the three depth indices imply that the volume based depth has an upper bound of  <dig> while both distance based indices have no upper bound. the prediction of the indices that are characterized by larger variability and wider range of values is more challenging. the wider range of values implies that the corresponding mae values  are higher. the reason for the improved pcc values in the case of the sadic depth index is that these depth values along the protein sequence  are smoother. on the other hand, the other two indices are characterized by larger number of high spikes, see figure  <dig>  in which case it is harder to generate highly correlated values. to show that, we counted the number of spike points for each depth index for sequences from the yw <dig> dataset. residue i is called an ε-spike point if its depth satisfies

  or  

where rdi is the distance or volume based depth of the ith residue in the sequence and ε measures the magnitude of the spike with respect to the adjacent residues.

although we observe improvements for all three depth indices when comparing predictions of the proposed rdpred and when using pssm+ps features, we emphasize that the results for the dpx and sadic depth indices could be potentially further improved if a separate feature set and svr parameterization would be performed . we also stress that this discussion should not be used to evaluate which of the indices is the best measure of the residue depth.

analysis of sequence representation
in this and the next sections, the analysis focuses on the msms based depth index. table  <dig> shows that feature selection performed to design rdpred provided improvements with respect to the depth predictions. when comparing "all features" and rdpred rows, we observe that the corresponding mae and mre values are lower when reduced feature set was used. at the same time, feature selection also allows analysis of the significant factors that influence prediction of the residue depth. table  <dig> shows the number of original features and the number of selected features  organized by feature types .

we divide our discussion of the selected features into four parts: pssm-based features, ps , ss features , and pi features . first, we investigate the values added of each of these sets by comparing prediction quality of rdpred on the yw <dig> dataset when using all features with removing one of the above four sets at the time, see table  <dig> 

the tests were performed on the yw <dig> dataset using three-fold cross validation. the values in the brackets correspond to the 10th and 90th centiles of the absolute and relative errors.

as shown in table  <dig>  the largest decrease by  <dig>  for pcc and the largest increases by  <dig>  and  <dig>  for mae and mre, respectively, result from removing pssm features. this suggests that the multiple alignments computed with psi-blast that reflect evolutionary information provide the highest quality input for regression-based prediction of residue depth. on the other hand, the prediction quality remains relatively high when pssm features are removed, which implies that the remaining features computed based on the predicted secondary structure and sequence also provide substantial amount of useful information. moreover, comparable values of mae and mre are obtained in case of removing the ps and ss features. this shows that protein size and predicted secondary structure provide similar amounts of improvement. large improvements related to adding the protein size to the pssm features that were reported in  <cit>  support the claim that our design constitutes a step towards providing an accurate sequence-based depth prediction method. finally, the smallest improvements are associated with pi features.

the majority of rdpred's features  correspond to pssm values. at the same time, only  <dig> out of the total of  <dig> pssm values were selected. figure  <dig> visualizes the distribution of the selected pssm features with respect to their positions in the window. each cell in the figure corresponds to one pssm based feature and the shades of gray represents the absolute average pcc values , i.e., darker color corresponds to stronger correlation, while white color shows which features were not selected. we also computed the mean pcc values for each row and column in figure  <dig>  as expected, the distribution of pcc values is relatively symmetric with respect to the central position in the window, which implies that the residues at the n-termini and c-termini in the local window have similar impact on the prediction performed for the central residue. the central residue  has the largest mean pcc, while other positions are characterized by lower mean pcc values. in general, the mean pcc values decline with the increasing distance from the central position. one exception are positions - <dig> and  <dig>  in which case the mean pcc is smaller than that for positions +/-  <dig> and +/-  <dig>  while it is obvious that the positions immediately adjacent to the predicted residue should have large impact on the prediction, we hypothesize that the low average pcc value for the +/-  <dig> positions is due to limited interactions between these residues and the central residue. for instance, in case of helical structure, the residues at +/-  <dig> or +/-  <dig> positions would form hydrogen bond with the central aas, in contrast to the residues at +/-  <dig> position. the strongest pcc values for +/-  <dig> or +/-  <dig> positions are observed for glu , gln , and lys , and these residues were shown to be strongly associated with the formation of helices  <cit> , which further substantiates our hypothesis.

the features corresponding to glu , lys , asp , and ile  for the central residue have the largest pcc values. moreover, the mean pcc values averaged over the window for different aas show variations. as presented in figure  <dig>  glu , lys , and asp  have the largest mean pcc. according to table  <dig>  these three aas are charged, hydrophilic, and the most flexible. we observe that in general, pssm values of hydrophilic aas are more strongly correlated with the residue depth than hydrophobic aas, aliphatic amino acids , ile , and leu ) have greater mean pcc values than aromatic aas , ser , trp , and tyr ), and finally the tiny aas , ser , and tyr ) are also characterized by small mean pcc values.

a the rank of a given feature among the selected  <dig> features; this excludes the features based on pssm.

prediction accuracy for buried and exposed residues
one of the applications of the predicted residue depth is to distinguish between buried and exposed residues. we used receiver operating characteristic   <cit>  analysis to investigate and compare the accuracy of the two-state  prediction computed based on predicted residue depth. we choose a series of depth thresholds to classify the residues into the two classes and we compare the quality of the two-state prediction between the rdpred and the simulation of yw method . figure  <dig> shows roc plot of the tp rate  on y-axis against the fp rate  on the x-axis. the sensitivity is defined as the ratio of the number of correct predictions for buried residues to the total number of actual buried residues. specificity is the ratio of the number of correctly predicted exposed residues to the total number of actual exposed residues. we observe that the rdpred provides on average better predictions when compared with the simulation of yw method. the improvements concern predictions with sensitivity of above  <dig>  and specificity of below  <dig> , i.e., the roc curve for rdpred is above the roc curve of the simulation of the yw method for these values.

both, the pioneering work in sequence-based prediction of residue depths of yuan and wang  <cit>  and our analysis show that it is more difficult to predict buried residues than the exposed residues when using predicted residue depth as the input. the main reason is that most of the residues are exposed , see figure  <dig>  and thus the prediction methods are biased to improve these predictions, in contrast to less frequently occurring depth values for buried residues. yuan and wang suggested using the relative depth rank in the entire sequence to interpret the depth values, since this would allow finding deeply buried residues, which in turn would help when modeling structure of novel proteins  <cit> . to this end, the msms based depth values of a protein sequence were sorted in ascending order; this was applied to both the predicted and the observed depth values. when selecting the top 10% buried residues in each chain in yw <dig> dataset using both observed and predicted values, the resulting overlap  for the predictions with rdpred equals  <dig> %. this ratio is better than the ratio reported for the yw method, i.e.,  <dig> %. table  <dig> shows the ratios for increasing values of the top percentages. the table shows that rdpred is characterized by improved sensitivity when compared with yw method and the simulation of the yw method. the improvements gradually decrease as the threshold values increase, which is due to inclusion of exposed residues for the larger thresholds. we repeated this analysis but when considering the sensitivity of predicting the most exposed residues, see table  <dig>  we used a wider range of thresholds since majority of the residues are exposed, see figure  <dig>  the results again shows that the proposed rdpred method provide higher sensitivity of prediction of the exposed residues when compared with the simulation of the yw method. we conclude that the improvements in the residue depth prediction performed with rppred result in improved ability to predict both the most buried and the most exposed residues.

CONCLUSIONS
we propose an accurate method for sequence-based real-value prediction of residue depth. when compared with the recently proposed method by yuan and wang that utilized pssm matrix and protein size as the input  <cit> , the proposed rdpred method applies several new sources of information including predicted secondary structure, residue position, and information per position in the psi-blast profile. we also perform feature selection that reduces the dimensionality of the input vector and allows for investigation into the relations between the input features and the predicted depth values. our analysis shows that:  the most important new features, except the pssm and protein size that have been studied in  <cit> , are the features based on the predicted secondary structure;  hydrophilic and flexible residues are easier to predict than hydrophobic and rigid residues;  charged residues that include lys, glu, asp, and arg are the most accurately predicted;  the evolutionary information encoded using pssm is characterized by stronger correlation with the depth for hydrophilic aas and aliphatic aas when compared with hydrophobic aas and aromatic aas; and  secondary structure of coils and strands is useful in depth prediction, in contrast to helices that are characterized by a more uniform distribution over their depth in the protein.

we investigated the quality of the prediction when considering two distance based, msms and dpx, and one volume based, sadic, depth indices. the proposed rdpred method obtained  <dig> / <dig>  pcc at the residue level based on three-fold/ten-fold cross validation when predicting sadic defined depth values, which is better than the correlations obtained for the other two depth indices, i.e.,  <dig> / <dig>  and  <dig> / <dig> , respectively. this is likely due to the fact that the depth defined using a sadic index is easier to predict since the corresponding depth profile along the protein chain is smother and it contains smaller number of spikes than the profiles of the other two indices. in general, our results suggest that all considered depth indices can be accurately predicted from the sequence.

the proposed method provides statistically significantly better predictions of msms based residue depth, i.e., the mre and mae values predicted by rdpred are significantly lower than the corresponding values predicted with the method by yuan and wang. similar conclusions are drawn for the two other depth indices. we show that the predicted depth can be used to provide improved prediction of both buried and exposed residues when compared with the competing method. the prediction of exposed residues has implications in characterization/prediction of interactions with ligands and other proteins, while the prediction of buried residues could be used in the context of folding predictions and simulations. both, the proposed and the competing method are characterized by higher quality of prediction for the exposed residues.

in conclusion, rdpred method constitutes a step towards providing an accurate sequence-based residue depth prediction method.

list of abbreviations
yw method: yuan and wang method; rdpred: residue depth prediction method; pssm: position-specific scoring matrix; ipp: information per position; ssp: secondary structure probability profiles; ps: protein size; pi: position and information per position; pcc: pearson correlation coefficient; mae: mean absolute error; mre: mean relative error; cv: cross validation; rsa: relative solvent accessibility; svr: support vector regression; roc: receiver operating characteristic; pdb: protein data bank.

authors' contributions
hz contributed to the conception and design of the prediction method, designed and computed the features, performed feature selection and experimental comparison, and helped with evaluation of the results. tz contributed to the conception and design of the prediction method and helped with the evaluation of the results. kc helped with the preparation of the datasets and the experimental study. ss and jr contributed to the conception and design of the prediction method. lk contributed to the conception and design of the prediction method, helped with design of the experimental study and evaluation of the results, and coordinated the project. all authors have drafted, corrected and approved the manuscript.

supplementary material
additional file 1
supplementary table  <dig>  list of pdb ids  of sequences from the pdb <dig> dataset

click here for file

 acknowledgements
this research was funded in part by nserc canada and asrip . hz and tz would like to acknowledge financial support provided by national education committee of china. ss and jr were supported by nsfc , liuhui center for applied mathematics, and the joint program of tianjin and nankai universities. we would like to extend our thanks to dr. kui wang, dr. gang hu, and dr. bing xiang for help in performing experiments on the computer cluster at the nankai university. we are grateful to the anonymous reviewers for their valuable comments and suggestions.
