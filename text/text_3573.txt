BACKGROUND
exploration of homology between chromosomes facilitates the understanding of the structure, function and evolution of genomes. extensive synteny and colinearity have been detected between chromosomes in different species of cereals  <cit> , mammals  <cit>  and yeasts  <cit>  providing a deep insight into the evolution of ancient chromosomes. between chromosomes of the same species, large-scale homologous segments exist caused by whole genome or segmental duplication  <cit> . it has been reported that nearly 80% of the arabidopsis thaliana genome and 45–60% of the rice genome are in large duplicated regions  <cit> .

special care should be taken to reveal chromosomal homology due to numerous genomic changes such as chromosomal rearrangements, gene inversions and gene loss  <cit> . many approaches have been developed to identify chromosomal homologues  <cit>  based on genetic maps  <cit> , sequence alignment  <cit> , gene synteny  <cit>  and gene colinearity  <cit> . by detecting the density and order of homologous gene pairs between chromosomes, colinearity approach can reveal reliable homologous regions and requires less computational resources. this approach also enables us to develop reasonable statistical tests to evaluate the significance of predicted homologous regions.

the typical implementations of the colinearity strategy are adhore  <cit> , fish  <cit>  and diaghunter  <cit> . the implementations of these approaches have limitations in some aspects, though they have been widely adopted. firstly, the gap size between neighboring homologous genes which is essential to define and detect true colinearity needs further evaluation  <cit> . secondly, statistical tests to assess predicted homologous regions are mainly based on a prerequisite of balanced gene loss rates between homologous regions. finally, compositional and structural differences, especially gene density and repetition in genome-wide and local chromosomal regions, have not been fully addressed.

here we describe a new colinearity approach characterized by improved statistical inference, flexibility and computational efficiency. firstly, the selection of parameter values is theoretically explored, especially that of the gap length between neighboring genes. secondly, the statistical test has been substantially strengthened with a mathematical deduction to evaluate the significance of the predicted homologous regions. finally, the compositional and structural heterogeneity of chromosomes has been considered.

using a dynamic programming algorithm, we developed colinearscan and scanned the arabidopsis and rice genomes to detect duplicated regions in each species and homologous chromosomal regions between these two species. we found  <dig> % of arabidopsis genes and  <dig> % of rice genes were in duplicated regions. moreover, we identified homologous fragments between these two species, in  <dig> % of arabidopsis and  <dig> % of rice. nearly all homologous segments were shorter than  <dig>  mb, indicating massive chromosomal rearrangements after the monocot-dicot divergence  <cit> .

RESULTS
algorithm
gene homology matrix
the first step in our colinearity approach is the construction of the gene homology matrix. to find homologous gene pairs between two chromosomes denoted as a and b, protein sequences encoded by genetically or physically positioned genes are used to perform an all-against-all blast search  <cit> . a gene homology matrix  is then constructed using the homology information from blast results. chromosome a and b, represented by the positioned genes are arranged along h horizontally and vertically . a cell of h is filled with "1" if the corresponding genes on chromosome a and chromosome b are homologous, otherwise with "0". tandem and other repetitive genes are widely distributed in chromosomes showing many "1"s in horizontal or vertical straight lines in the dot matrix map  and causing problems in revealing true homology. therefore, we used a general approach, masking the genes appearing more than  <dig> times in both chromosomes.

dynamic programming algorithm
to reveal the homologous genes in colinearity between two chromosomes, we implemented a dynamic programming approach based on the well-known smith-waterman algorithm  <cit> . using this approach, we can discover the longest putative sister regions represented by several proximal points of colinear homologous gene pairs in nearly diagonal orientations. the points may not be in close proximity due to large-scale gene loss, insertion and translocation. the extent of the proximity of the points is essential to reveal and evaluate the colinear sister segments. lines forming by the points corresponding to the true colinear segments are either nearly parallel to the main diagonal line or the anti-diagonal line due to dna segmental inversion. homologous genes in colinear segments should all have the same or inverse transcriptional directions if no single gene inversions occur. we scan h in two directions, starting from the upper-left and upper-right. here, we describe the procedure starting from the upper-left, which also applies in the other direction. transcriptional orientations of the genes are recorded but not used when performing the colinearity search.

to reveal the colinearity represented by the proximal points in h, we introduce a parameter mg  between two neighboring points. then we define another matrix s  with the same size as h . a cell in matrix s represents the extension of a colinearity path, i.e., the value of each cell is the number of collinear gene pairs in the path accumulated from its starting point. the path extends and the value of the cell increases by  <dig> if there is a "1" in lower-right neighborhood, and both vertical and horizontal distances are less than mg.

initially, s is identical to h. we rebuild the matrix s recursively using a dynamic programming procedure:

s=max{s+h,if dist, p)<mg and s>s)s)+h,if dist, pre) <mg and  s=s)s,if dist, p)<mg and  s>s)s),if dist, pre)<mg and  s=s)s,if dist, p)<mg and s>s)s),if dist, pre)<mg and s=s)h,or else
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqqgtbwucqqgoaakcqqgpbqacqqgsaalcqqgqbgacqqgpaqkcqgh9aqpcqqgtbqbcqqghbqycqqg4baedagabeqaauaabaqahiaaaaqaaiabbofatjabbicaoiabbmgapjabb2catiabbgdaxiabbycasiabbqgaqjabb2catiabbgdaxiabbmcapiabgucariabbieaijabbicaoiabbmgapjabbycasiabbqgaqjabbmcapiabbycasaqaaiabbmgapjabbagamjabbccagiabbsgakjabbmgapjabbohazjabbsha0jabbicaoiabbchawjabbicaoiabbmgapjabbycasiabbqgaqjabbmcapiabbycasiabbccagiabbchawjabbicaoiabbmgapjabb2catiabbgdaxiabbycasiabbqgaqjabb2catiabbgdaxiabbmcapiabbmcapiabgyda8iabb2gatjabbeganjabbccagiabbggahjabb6gaujabbsgakjabbccagiabbofatjabbicaoiabbmgapjabb2catiabbgdaxiabbycasiabbqgaqjabb2catiabbgdaxiabbmcapiabg6da+iabbofatjabbicaoiabbchawjabbkhayjabbwgaljabbicaoiabbmgapjabb2catiabbgdaxiabbycasiabbqgaqjabb2catiabbgdaxiabbmcapiabbmcapaqaaiabbofatjabbicaoiabbchawjabbkhayjabbwgaljabbicaoiabbmgapjabb2catiabbgdaxiabbycasiabbqgaqjabb2catiabbgdaxiabbmcapiabbmcapiabgucariabbieaijabbicaoiabbmgapjabbycasiabbqgaqjabbmcapiabbycasaqaaiabbmgapjabbagamjabbccagiabbsgakjabbmgapjabbohazjabbsha0jabbicaoiabbchawjabbicaoiabbmgapjabbycasiabbqgaqjabbmcapiabbycasiabbccagiabbchawjabbkhayjabbwgaljabbicaoiabbmgapjabb2catiabbgdaxiabbycasiabbqgaqjabb2catiabbgdaxiabbmcapiabbmcapiabbccagiabgyda8iabb2gatjabbeganjabbccagiabbggahjabb6gaujabbsgakjabbccagiabbccagiabbofatjabbicaoiabbmgapjabb2catiabbgdaxiabbycasiabbqgaqjabb2catiabbgdaxiabbmcapiabg2da9iabbofatjabbicaoiabbchawjabbkhayjabbwgaljabbicaoiabbmgapjabb2catiabbgdaxiabbycasiabbqgaqjabb2catiabbgdaxiabbmcapiabbmcapaqaaiabbofatjabbicaoiabbmgapjabb2catiabbgdaxiabbycasiabbqgaqjabbmcapiabbycasaqaaiabbmgapjabbagamjabbccagiabbsgakjabbmgapjabbohazjabbsha0jabbicaoiabbchawjabbicaoiabbmgapjabbycasiabbqgaqjabbmcapiabbycasiabbccagiabbchawjabbicaoiabbmgapjabb2catiabbgdaxiabbycasiabbqgaqjabbmcapiabbmcapiabgyda8iabb2gatjabbeganjabbccagiabbggahjabb6gaujabbsgakjabbccagiabbccagiabbofatjabbicaoiabbmgapjabb2catiabbgdaxiabbycasiabbqgaqjabbmcapiabg6da+iabbofatjabbicaoiabbchawjabbkhayjabbwgaljabbicaoiabbmgapjabb2catiabbgdaxiabbycasiabbqgaqjabbmcapiabbmcapaqaaiabbofatjabbicaoiabbchawjabbkhayjabbwgaljabbicaoiabbmgapjabb2catiabbgdaxiabbycasiabbqgaqjabbmcapiabbmcapiabbycasaqaaiabbmgapjabbagamjabbccagiabbsgakjabbmgapjabbohazjabbsha0jabbicaoiabbchawjabbicaoiabbmgapjabbycasiabbqgaqjabbmcapiabbycasiabbccagiabbchawjabbkhayjabbwgaljabbicaoiabbmgapjabb2catiabbgdaxiabbycasiabbqgaqjabbmcapiabbmcapiabgyda8iabb2gatjabbeganjabbccagiabbggahjabb6gaujabbsgakjabbccagiabbccagiabbofatjabbicaoiabbmgapjabb2catiabbgdaxiabbycasiabbqgaqjabbmcapiabg2da9iabbofatjabbicaoiabbchawjabbkhayjabbwgaljabbicaoiabbmgapjabb2catiabbgdaxiabbycasiabbqgaqjabbmcapiabbmcapaqaaiabbofatjabbicaoiabbmgapjabbycasiabbqgaqjabb2catiabbgdaxiabbmcapiabbycasaqaaiabbmgapjabbagamjabbccagiabbsgakjabbmgapjabbohazjabbsha0jabbicaoiabbchawjabbicaoiabbmgapjabbycasiabbqgaqjabbmcapiabbycasiabbccagiabbchawjabbicaoiabbmgapjabbycasiabbqgaqjabb2catiabbgdaxiabbmcapiabbmcapiabgyda8iabb2gatjabbeganjabbccagiabbggahjabb6gaujabbsgakjabbccagiabbofatjabbicaoiabbmgapjabbycasiabbqgaqjabb2catiabbgdaxiabbmcapiabg6da+iabbofatjabbicaoiabbchawjabbkhayjabbwgaljabbicaoiabbmgapjabbycasiabbqgaqjabb2catiabbgdaxiabbmcapiabbmcapaqaaiabbofatjabbicaoiabbchawjabbkhayjabbwgaljabbicaoiabbmgapjabbycasiabbqgaqjabb2catiabbgdaxiabbmcapiabbmcapiabbycasaqaaiabbmgapjabbagamjabbccagiabbsgakjabbmgapjabbohazjabbsha0jabbicaoiabbchawjabbicaoiabbmgapjabbycasiabbqgaqjabbmcapiabbycasiabbccagiabbchawjabbkhayjabbwgaljabbicaoiabbmgapjabbycasiabbqgaqjabb2catiabbgdaxiabbmcapiabbmcapiabgyda8iabb2gatjabbeganjabbccagiabbggahjabb6gaujabbsgakjabbccagiabbofatjabbicaoiabbmgapjabbycasiabbqgaqjabb2catiabbgdaxiabbmcapiabg2da9iabbofatjabbicaoiabbchawjabbkhayjabbwgaljabbicaoiabbmgapjabbycasiabbqgaqjabb2catiabbgdaxiabbmcapiabbmcapaqaaiabbieaijabbicaoiabbmgapjabbycasiabbqgaqjabbmcapiabbycasaqaaiabb+gavjabbkhayjabbccagiabbwgaljabbygasjabbohazjabbwgalbaaaiaawuhaaaaa@21c9@

where s is the score computed, h is the homology information, pre is the cell leading to the maximum score at the cell p, and a pointer  is created from the cell p to pre, dist, p) is the distance between the cells p and p. eventually, the maximum score in s corresponds to the longest putative collinear segments. the longest colinearity path formed by dots of the homologous gene pairs is revealed by a trace-back procedure according to the pointers created. after the homologous genes in putative colinearity are recorded, we mask these putative colinear segments by setting h to  <dig>  rebuild the matrix s, and scan for other putative colinear segments till no sister regions containing more colinear genes than a threshold r could be found.

maximum gap length
in colinearity methods, mg is the most important parameter which determines the length, quality and extensiveness of the predicated colinearity. the frequency of gene deletion in duplicated chromosomal segments is high and only a small fraction of homologous genes remains in colinearity. a small value of mg will result in finding many small colinear segments, and increase the difficulty of interpreting possible evolutionary events. on the other hand, a large mg value will surely result in high false positives. in fact, mg is dependent on the density of homologous gene pairs between the chromosomes. when the two chromosomes a and b are from the same species, homologous genes between them are mainly distributed at a similar density. on the other hand, when we compare two chromosomes from different species, the density of homologous genes may more divergent. therefore we adopt two parameters to define the maximum distance between the neighboring dots, the maximum gap between genes in chromosome a  and the maximum gap between genes in chromosome b . when the chromosomes are from the same species, we set mga = mgb.

under the assumption that homologous genes are uniformly distributed in chromosomes, we explore the possibility of finding sister segments containing equal to or more than r genes by chance. however, this uniform distribution assumption is not very strict since we only need reasonable rather than optimal values of mg. suppose the length of chromosome a and b are lena and lenb, and the number of homologous gene pairs between two chromosomes is pnum. the location of a gene is a random variable with a probability density 1lena
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabigdaxaqaaiabdygasjabdwgaljabd6gaujabdgeabbaaaaa@32d0@, the joint probability density of the locations of r genes on chromosome a is 1⥄r
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabigdaxaqaamaadmaabagaemibawmaemyzaumaemoba4maemyqaeeacaglbbgaayzxaawaawbaasqabeaacaamcsuaemocaihaaaaaaaa@37e3@, and the joint probability density of the locations on chromosome a and b of r homologous pairs is 1⥄r
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabigdaxaqaamaadmaabagaemibawmaemyzaumaemoba4maemyqaekaeyyxictaemibawmaemyzaumaemoba4maemoqaieacaglbbgaayzxaawaawbaasqabeaacaamcsuaemocaihaaaaaaaa@3f53@. therefore, the probability p that r homologous gene pairs are in colinearity by chance can be evaluated by

ppnumr•rdx1dx2⋯dxrdy1dy2⋯dyr],
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgqbaudaqhaawcbagaemicaanaemoba4maemydaunaemyba0gabagaemocaihaaogaeyoigcraei4was1aa8quaeaadawcaaqaaiabigdaxaqaaiabcufabjabdygasjabdwgaljabd6gaujabdgeabjabgwsixlabdygasjabdwgaljabd6gaujabdkeacjabc2fadnaacaaaleqabagaemocaihaaaaaaeaacqwgebaraeqaniabguiiydgccqwgkbazcqwg4baedawgaawcbagaegymaedabeaakiabdsgakjabdiha4naabaaaleaacqaiyagmaeqaaogaes47iwkaemizaqmaemieag3aasbaasqaaiabdkhaybqabagccqwgkbazcqwg5bqedawgaawcbagaegymaedabeaakiabdsgakjabdmha5naabaaaleaacqaiyagmaeqaaogaes47iwkaemizaqmaemyeak3aasbaasqaaiabdkhaybqabagccqggdbqxcqggsaalaaa@6b8a@

where the multiple integral field d is

∩{xi|0<xi<lena}∩∩{yi|0<yi<lenb}
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqggbbwwdaafwbqaaiabcuha7jabdiha4naabaaaleaacqwgpbqaaeqaaogaeiifawnaegimaajaeyipawjaemieag3aasbaasqaaiabdmgapbqabagccqghsislcqwg4baedawgaawcbagaemyaakmaeyoei0iaegymaedabeaakiabgyda8iabd2gatjabdeganjabdgeabjaaykw6cqgg9bqfcqggdbqxasqaaiabdmgapjabg2da9iabikdayaqaaiabdkhaybqdcqwipissaogaesykikkaei4easnaemieag3aasbaasqaaiabdmgapbqabagccqgg8bafcqaiwaamcqgh8aapcqwg4baedawgaawcbagaemyaakgabeaakiabgyda8iabdygasjabdwgaljabd6gaujabdgeabjabc2ha9jablmiijjabcufabnaauahabagaei4easnaemyeak3aasbaasqaaiabdmgapbqabagccqgg8bafcqaiwaamcqgh8aapcqwg5bqedawgaawcbagaemyaakgabeaakiabgkhitiabdmha5naabaaaleaacqwgpbqacqghsislcqaixaqmaeqaaogaeyipawjaemyba0maem4zacmaemoqaikaagparlabc2ha9jabc2fadbwcbagaemyaakmaeyypa0jaegomaidabagaemocaihaniablmiijbgccqwipisscqgg7bwecqwg5bqedawgaawcbagaemyaakgabeaakiabcyha8jabicdawiabgyda8iabdmha5naabaaaleaacqwgpbqaaeqaaogaeyipawjaemibawmaemyzaumaemoba4maemoqaikaeiyfa0haaa@98fb@

and x <dig> x <dig> ...,xr;y <dig> y <dig> ...,yr are the positions of the genes on the chromosomes, ppnumr
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgqbaudaqhaawcbagaemicaanaemoba4maemydaunaemyba0gabagaemocaihaaaaa@3513@ is the number of permutations of homologous genes: pnum!!
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabdchawjabd6gaujabdwha1jabd2gatjabcgcahaqaaiabcicaoiabdchawjabd6gaujabdwha1jabd2gatjabgkhitiabdkhayjabcmcapiabcgcahaaaaaa@3da4@. when mga <<lena and mgb <<lenb, the integral in the above formula can be approximated by

1⥄r
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabigdaxaqaamaadmaabagaemibawmaemyzaumaemoba4maemyqaekaeyyxictaemibawmaemyzaumaemoba4maemoqaieacaglbbgaayzxaawaawbaasqabeaacaamcsuaemocaihaaaaakiabcicaomaapedabagaemizaqmaemieag3aasbaasqaaiabigdaxaqabaaabagaegimaadabagaemibawmaemyzaumaemoba4maemyqaekaeyoei0iaemyba0maem4zacmaemyqaeeaniabguiiydgcdawdxaqaaiabdsgakjabdiha4naabaaaleaacqaiyagmaeqaaaqaaiabdiha4naabaaameaacqaixaqmaeqaaawcbagaemieag3aasbaawqaaiabigdaxaqabawccqghrawkcqwgtbqbcqwgnbwzcqwgbbqqa0gaey4kiipakiabl+uimnaapedabagaemizaqmaemieag3aasbaasqaaiabdkhaybqabagccqggpaqkcqggoaakdawdxaqaaiabdsgakjabdmha5naabaaaleaacqaixaqmaeqaaaqaaiabicdawaqaaiabdygasjabdwgaljabd6gaujabdkeacjabgkhitiabd2gatjabdeganjabdkeacbqdcqghrii8aawcbagaemieag3aasbaawqaaiabdkhayjabgkhitiabigdaxaqabaaaleaacqwg4baedawgaaadbagaemocainaeyoei0iaegymaedabeaaliabgucariabd2gatjabdeganjabdgeabbqdcqghrii8aowaa8qmaeaacqwgkbazcqwg5bqedawgaawcbagaegomaidabeaaaeaacqwg5bqedawgaaadbagaegymaedabeaaasqaaiabdmha5naabaaameaacqaixaqmaeqaasgaey4kasiaemyba0maem4zacmaemoqaieaniabguiiydgccqwivlctdawdxaqaaiabdsgakjabdmha5naabaaaleaacqwgybgcaeqaaaqaaiabdmha5naabaaameaacqwgybgccqghsislcqaixaqmaeqaaawcbagaemyeak3aasbaawqaaiabdkhayjabgkhitiabigdaxaqabawccqghrawkcqwgtbqbcqwgnbwzcqwgcbgqa0gaey4kiipakiabcmcapaaa@b2a4@

then we can estimate p by

ppnumrr− <dig> 
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgqbaudaqhaawcbagaemicaanaemoba4maemydaunaemyba0gabagaemocaihaaogaeiikagyaasaaaeaacqwgtbqbcqwgnbwzcqwgbbqqcqghfly1cqwgtbqbcqwgnbwzcqwgcbgqaeaacqwgsbabcqwglbqzcqwgubgbcqwgbbqqcqghfly1cqwgsbabcqwglbqzcqwgubgbcqwgcbgqaagaeiykakyaawbaasqabeaacqwgybgccqghsislcqaixaqmaagccqgguaglaaa@51ae@

if we set the significance level of colinearity to α, then we have

ppnumrr−1<α.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgqbaudaqhaawcbagaemicaanaemoba4maemydaunaemyba0gabagaemocaihaaogaeiikagyaasaaaeaacqwgtbqbcqwgnbwzcqwgbbqqcqghfly1cqwgtbqbcqwgnbwzcqwgcbgqaeaacqwgsbabcqwglbqzcqwgubgbcqwgbbqqcqghfly1cqwgsbabcqwglbqzcqwgubgbcqwgcbgqaagaeiykakyaawbaasqabeaacqwgybgccqghsislcqaixaqmaagccqgh8aapiigacqwfxoqycqgguaglaaa@5458@

when the two chromosomes are from the same species, we assume mga = mgb and denote them as mg, and the value of mg can be evaluated by

mg< <dig> 
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgtbqbcqwgnbwzcqgh8aapdawadaqaaiabcicaomaalaaabaaccigae8xsdegabagaemiuaa1aa0baasqaaiabdchawjabd6gaujabdwha1jabd2gatbqaaiabdkhaybaaaagccqggpaqkdaahaawcbeqaamaalaaabagaegymaedabagaemocainaeyoei0iaegymaedaaaaakiabcicaoiabdygasjabdwgaljabd6gaujabdgeabjabgwsixlabdygasjabdwgaljabd6gaujabdkeacjabcmcapagaay5waiaaw2faamaacaaaleqabawaasaaaeaacqaixaqmaeaacqaiyagmaaaaaogaeiola4caaa@5409@

when the two chromosomes are from different species, the gene densities are often different and thus we adopt different values for the parameters mga and mgb. the length of gaps between neighboring homologous genes is inversely proportional to the density of homologous genes, let

mgamgb=pnumlenb⋅lenapnum=lenalenb.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabd2gatjabdeganjabdgeabbqaaiabd2gatjabdeganjabdkeacbaacqgh9aqpdawcaaqaaiabdchawjabd6gaujabdwha1jabd2gatbqaaiabdygasjabdwgaljabd6gaujabdkeacbaacqghfly1dawcaaqaaiabdygasjabdwgaljabd6gaujabdgeabbqaaiabdchawjabd6gaujabdwha1jabd2gatbaacqgh9aqpdawcaaqaaiabdygasjabdwgaljabd6gaujabdgeabbqaaiabdygasjabdwgaljabd6gaujabdkeacbaacqgguaglaaa@598e@

thus, we can estimate the value of mga and mgb

mga<12lena,
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgtbqbcqwgnbwzcqwgbbqqcqgh8aapcqggoaakdawcaaqaaggaciab=f7ahbqaaiabdcfaqnaadaaaleaacqwgwbaccqwgubgbcqwg1bqdcqwgtbqbaeaacqwgybgcaaaaaogaeiykakyaawbaasqabeaadawcaaqaaiabigdaxaqaaiabikdayiabcicaoiabdkhayjabgkhitiabigdaxiabcmcapaaaaagccqwgsbabcqwglbqzcqwgubgbcqwgbbqqcqggsaalaaa@4a77@

mgb<12lenb.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgtbqbcqwgnbwzcqwgcbgqcqgh8aapcqggoaakdawcaaqaaggaciab=f7ahbqaaiabdcfaqnaadaaaleaacqwgwbaccqwgubgbcqwg1bqdcqwgtbqbaeaacqwgybgcaaaaaogaeiykakyaawbaasqabeaadawcaaqaaiabigdaxaqaaiabikdayiabcicaoiabdkhayjabgkhitiabigdaxiabcmcapaaaaagccqwgsbabcqwglbqzcqwgubgbcqwgcbgqcqgguaglaaa@4a7f@

colinearity shadow
many genes have homologues in their neighborhood as indicated by the distance distribution of homologous genes . neighboring homologues may result in many colinear segments parallel to each other in sister regions within the same chromosome, or between the different chromosomes . if for convenience we call the longer ones the 'true' colinearity, then the shorter ones are the 'shadows'. the colinearity shadows may also reflect colinearity, but they do not provide further information and greatly increase the computational time. thus after a putative colinearity in certain sister regions is found, we mask the neighboring homologous pairs within the corresponding the entire rectangular regions to avoid possible colinearity shadows.

when candidate colinearity is found in a specific region of ghm from upper-left to lower-right, colinear shadows perpendicular to this path might also be found in the same region scanning from upper-right to lower-left. these shadows may also reflect actual homology between two sister chromosomal segments, and they may occur when gene rearrangements are frequent in specific regions. a large amount of perpendicular shadows may affect efficiency of the algorithm. however, they do not occur very often so we do not mask these shadows.

statistical test
many genes are in multi-gene families and repetitive genes are extensively found in plant genomes. putative colinear regions might be a reflection of extensive occurrences of single gene duplication or translocation. therefore, it is critical to correctly detect the colinearity pattern by evaluating the significance of the putative colinear regions generated by the above approach, and to develop an effective statistical method to assess whether the putative colinearity represents true homology or is produced by chance. moreover, the distribution of homologous gene pairs is far from uniform. we use a statistical test considering divergent distribution of homologous gene pairs in different regions, rather than assuming a uniform distribution throughout the genome.

given that a dna segment resides in chromosome b, a corresponding colinear segment in chromosome a is generated due to many independent single-gene duplication events. under the assumption of a uniform distribution of collinearly paired genes in the local chromosomal regions, we obtain the probability epva to display the significance of the homology,

epva=ra1⋅∏i=2mωai⋅raipssa,
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwglbqzcqwgwbaccqwg2bgdcqwgbbqqcqgh9aqpcqwgsbgudaqhaawcbagaemyqaeeabagaegymaedaaogaeyyxic9aaebcaeaadawcaaqaaggaciab=l8a3naadaaaleaacqwgbbqqaeaacqwgpbqaaagccqghfly1cqwgsbgudaqhaawcbagaemyqaeeabagaemyaakgaaagcbagaemicaanaem4camnaem4camnaemyqaeeaaawcbagaemyaakmaeyypa0jaegomaidabagaemyba0ganiabg+givdgccqggsaalaaa@504f@

where m is the number of collinear gene pairs, ωai
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfjpwddaqhaawcbagaemyqaeeabagaemyaakgaaaaa@3113@ is the gap length between paired gene i and gene i- <dig>  rai
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgsbgudaqhaawcbagaemyqaeeabagaemyaakgaaaaa@306c@ is the number of occurrences of the i-th paired gene and its homologues in the putative sister segment in chromosome a, pssa is the length of the sister segment in chromosome a. the above formula can be deduced by extending the colinearity point by point taking repetitive homologues in consideration. the possibility of finding such colinearity under this assumption will be increased by rai
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgsbgudaqhaawcbagaemyqaeeabagaemyaakgaaaaa@306c@ times if rai
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgsbgudaqhaawcbagaemyqaeeabagaemyaakgaaaaa@306c@ homologous genes of the i-th colinear gene exist in this segment. similarly, we can define the probability epvb

epvb=rb1⋅∏i=2mωbi⋅rbipssb.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwglbqzcqwgwbaccqwg2bgdcqwgcbgqcqgh9aqpcqwgsbgudaqhaawcbagaemoqaieabagaegymaedaaogaeyyxic9aaebcaeaadawcaaqaaggaciab=l8a3naadaaaleaacqwgcbgqaeaacqwgpbqaaagccqghfly1cqwgsbgudaqhaawcbagaemoqaieabagaemyaakgaaagcbagaemicaanaem4camnaem4camnaemoqaieaaawcbagaemyaakmaeyypa0jaegomaidabagaemyba0ganiabg+givdgccqgguaglaaa@505d@

then we define

epv = max

to measure the possibility of the colinearity appearing by chance in the sister regions. if it is below a threshold, we take the putative colinearity as significant.

however, if we apply the above test directly to the putative different homologous regions, we cannot distinguish between patterns with similar numbers of homologous gene pairs in segments of different size. for example, the putative colinear regions found in small sister segments  more likely indicate true segmental homology than that in large sister segments . dense colinearity possibly generated by recent duplications should be evaluated as significant.

rather than using pssa and pssb, we try to estimate epv on expected scales of the sister regions  determined by the numbers of colinear genes and all homologous genes. assuming that paired genes are uniformly distributed throughout the chromosomes, we estimate the expected sizes for each pair of sister segments as follows

essa=λ⋅cnumpnum⋅lena,
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwglbqzcqwgzbwccqwgzbwccqwgbbqqcqgh9aqpiigacqwf7oabcqghfly1dawcaaqaaiabdogajjabd6gaujabdwha1jabd2gatbqaaiabdchawjabd6gaujabdwha1jabd2gatbaacqghfly1cqwgsbabcqwglbqzcqwgubgbcqwgbbqqcqggsaalaaa@4a7f@

essb=λ⋅cnumpnum⋅lenb,
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwglbqzcqwgzbwccqwgzbwccqwgcbgqcqgh9aqpiigacqwf7oabcqghfly1dawcaaqaaiabdogajjabd6gaujabdwha1jabd2gatbqaaiabdchawjabd6gaujabdwha1jabd2gatbaacqghfly1cqwgsbabcqwglbqzcqwgubgbcqwgcbgqcqggsaalaaa@4a83@

where cnum is the number of colinearly paired genes in the putative sister segments, pnum is the number of all homologous gene pairs between chromosome a and chromosome b, λ is a coefficient to normalize the size of different putative colinear segments. for each pair of putative sister regions we calculate a preliminary coefficient number λi by ⋅ <dig> 
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqggoaakdawcaaqaaiabdchawjabdohazjabdohazjabdgeabjabgwsixlabdchawjabd6gaujabdwha1jabd2gatbqaaiabdygasjabdwgaljabd6gaujabdgeabjabgwsixlabdogajjabd6gaujabdwha1jabd2gatbaacqghrawkdawcaaqaaiabdchawjabdohazjabdohazjabdkeacjabgwsixlabdchawjabd6gaujabdwha1jabd2gatbqaaiabdygasjabdwgaljabd6gaujabdkeacjabgwsixlabdogajjabd6gaujabdwha1jabd2gatbaacqggpaqkcqghfly1dawcaaqaaiabigdaxaqaaiabikdayaaacqgguaglaaa@68f4@.

where pssa and pssb are the original sizes of the putative i-th sister segments. these preliminary coefficients are averaged throughout the putative homologous sister pairs to obtain the estimate of λ. finally, we redefine epva=ra1⋅∏i=2mωai⋅raiessa
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwglbqzcqwgwbaccqwg2bgdcqwgbbqqcqgh9aqpcqwgsbgudaqhaawcbagaemyqaeeabagaegymaedaaogaeyyxic9aaebcaeaadawcaaqaaggaciab=l8a3naadaaaleaacqwgbbqqaeaacqwgpbqaaagccqghfly1cqwgsbgudaqhaawcbagaemyqaeeabagaemyaakgaaagcbagaemyzaumaem4camnaem4camnaemyqaeeaaawcbagaemyaakmaeyypa0jaegomaidabagaemyba0ganiabg+givdaaaa@4f4f@ and epvb=rb1⋅∏i=2mωbi⋅rbiessb
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwglbqzcqwgwbaccqwg2bgdcqwgcbgqcqgh9aqpcqwgsbgudaqhaawcbagaemoqaieabagaegymaedaaogaeyyxic9aaebcaeaadawcaaqaaggaciab=l8a3naadaaaleaacqwgcbgqaeaacqwgpbqaaagccqghfly1cqwgsbgudaqhaawcbagaemoqaieabagaemyaakgaaagcbagaemyzaumaem4camnaem4camnaemoqaieaaawcbagaemyaakmaeyypa0jaegomaidabagaemyba0ganiabg+givdaaaa@4f59@

by substituting the original size pssa and pssb with the expected size essa and essb. thus, we assign different significance to the two patterns in fig.  <dig>  the sister regions with denser collinear genes have a smaller epv value.

assessment of mg estimation
to test the applicability of the criteria defining mg, we performed a computational simulation test on rice chromosome  <dig> and arabidopsis chromosome  <dig> 

first, using the integral formula , we calculated the maximum gap length in both chromosomes: mga =  <dig> kb, and mgb =  <dig> kb. the parameters r and α mean that using such gap length to scan the homologous segments between the chromosomes, the probability of finding sister segments containing  <dig> or more collinear genes should be <=  <dig>  under the assumption of uniform distribution.

second, we shuffled the positions of the homologous gene pairs on both chromosomes and scanned the longest homologous segments occurring by chance, then checked whether it had  <dig> or more collinear genes. we repeated this process  <dig> times and found collinear segment with  <dig> or more collinear genes  <dig> times.

we calculated mga and mgb between every pair of chromosomes of rice and arabidopsis, and applied the largest values  to all chromosome pairs. the candidate homologous segments can be verified by a statistical test. to check how it affects the scanning process between rice chromosome  <dig> and arabidopsis chromosome  <dig> when using larger mga and mgb, we found colinear segments with  <dig> or more collinear gene pairs in  <dig>  out of  <dig>  simulations.

application to rice and arabidopsis
we explored the colinear segments within and between the chromosomes in arabidopsis and rice. the genomic sequences of arabidopsis thaliana were from genbank   <cit> . oryza sativa l. ssp. indica genomic sequences were downloaded from ricegd  <cit>  and the rice genes were predicted using the software bgf  <cit>  from the beijing genome institute. by performing all-against-all blastp, we revealed homologous gene pairs within and between arabidopsis and rice .

for arabidopsis, we searched for the duplication regions with the parameter value r =  <dig>  mg =  <dig> kb  and λ =  <dig> . we used the maximal mg values estimated between each pairs of arabidopsis chromosomes. at the significant level of epv <=  <dig> , we discovered  <dig> duplicated sister segments out of  <dig> candidates, among them  <dig> were possible perpendicular shadows . about  <dig> % of the genome is in duplicated segments and  <dig> %,  <dig> % of the genes are in segments with a multiplication level >  <dig> and >  <dig>  respectively . the detected coverage of duplicated regions is a little more than that  found by blanc et al.  <cit> , less than that  reported by bowers et al.  <cit> . the longest sister segments contain  <dig> colinear genes and extend more than  <dig>  mb in chromosome  <dig> and  <dig>  mb in chromosome  <dig> . in the longest  <dig> duplicated segments, 88–100% of the colinear genes are of the same relative transcriptional orientation, indicating a low inversion rate.

 <dig>  multiplication level of a gene displays that it is in a duplicated segment that appears for how many times in a genome. 

 <dig>  the percentage is the ratio of genes in multiplication levels >= a specific number.

* the gene names  reflect the chromosome and the gene order, e.g. '2_3518' represents the 3518th gene on chromosome  <dig> 

as for rice, we used another set of parameter values r =  <dig>  mg =  <dig> kb  and λ =  <dig> . at the same significance level as in arabidopsis, we revealed  <dig> duplicated segments out of  <dig> candidates in rice, among them  <dig> are possible perpendicular shadows . in our study we found that  <dig> % of the genes were in duplicated regions, significantly higher than  <dig> % reported by simillion et al.  <cit> , also higher than those reported by paterson et al.  <cit>   and guyot and keller  <cit>  . the longest colinear sister regions contain  <dig> homologous genes and extend more than  <dig>  and  <dig>  mb in chromosomes  <dig> and  <dig> , corresponding a segmental duplication event duplicated ~5– <dig> mya  <cit> . about  <dig> %,  <dig> % of the genome sequences are in a multiplication level of > <dig> and > <dig>  respectively . the transcriptional orientation of colinear genes is in high consistency, similar to that in arabidopsis. the colinear sister segments at different levels of multiplication are distributed throughout the rice genome.

using parameter values r =  <dig>  mga =  <dig> kb in arabidopsis, mgb =  <dig> kb in rice and λ =  <dig> , we found  <dig> colinear sister segments out of  <dig> candidates between the chromosomes of two species , accounting for  <dig> % and  <dig> % of the arabidopsis and rice genes, respectively. the longest sister segments are ~ <dig>  mb in length and contain ~ <dig> colinear genes, but most segments are much shorter, indicating extensive independent chromosomal rearrangements and gene loss or gain in each genome. the sister copy in rice is always 1– <dig> times longer than that in arabidopsis, implying a possible chromosomal expansion in the rice genome .

discussion
identification of the duplicated segments, especially their distribution pattern in a genome, is essential for further inference on when and how the duplication or species divergence occurred, and whether or not recurrent duplication events happened. the selection of parameter values, in particular the maximum gap length between the neighboring genes, is critical to detect chromosomal homology. however, the selection of maximum gap length in previous reported studies was mainly empirical, which might fail to detect authentic duplicated segments  <cit> . many fewer and shorter duplicated segments are discovered when a smaller gap length is adopted, such as in the case of rice  <cit> , whereas more and longer duplicated regions can be found if a larger gap length is adopted. moreover, different gap length should be used in different genomes such as arabidopsis and rice, since the density of colinear genes varies due to dna loss and insertion. by considering the difference in gene density, especially the density of homologous genes in different genomes, we determined the maximum gap length based on statistical analysis. for example, when the duplicated regions in arabidopsis and rice are detected, the maximum gap lengths were estimated to be  <dig> kb and  <dig> kb, respectively.

the input data of our approach can be any type of genetic markers such as sequences, genetic markers. various measurements can be used to represent the distance between markers, such as physical or genetic distances, or gene numbers. in most previous studies, the significance of the predicted colinear regions was evaluated by a permutation test, which is rather time-consuming  <cit> . we estimate the significance of the predicted colinear segments through statistical inference. the statistical inference has the advantage over the permutation test in terms of computational efficiency. it takes only  <dig> minutes to calculate the epv to evaluate their significance on a personal computer  while running a permutation test takes several hours on the same machine. the massive gene duplications and translocations in its proximal regions will lead to many colinearity shadows, decreasing the computational efficiency. we include a neighborhood masking procedure in colinearscan to remove colinearity shadows in our algorithm, which dramatically improves the efficiency of detecting duplicated segments in the rice genome.

adhore adopts linear regression analysis to infer duplicated chromosomal segments  <cit> . the underlying assumption is that gene loss rates have been balanced between sister segments, resulting in a straight line in the dot map. the colinear homologues in a chromosomal segment might be interspersed by individual genes that have no homologues at the corresponding position in its sister segment. at the very beginning of divergence of the sister segments, there should be one-to-one gene homology. thereafter, massive gene deletions, translocations and chromosomal rearrangements occur and the initial pattern eventually becomes obscured  <cit> . the homologues with the conservative orders would appear in a straight line in the dot map if gene deletion or insertion had been balanced in different regions of the sister segments, otherwise in a curvy line. wang et al.  <cit>  explore the gene loss rates in the sister segments in rice and find that nearly straight lines are obtained for some sister segments, e.g., in chromosomes  <dig> and  <dig>  and in chromosomes  <dig> and  <dig>  however, curvy lines are also found for some sister segments, e.g., in chromosomes  <dig> and  <dig>  and in chromosomes  <dig> and  <dig>  a linearity assumption might fail to detect true duplicated segments. in fish, calabrese et al.  <cit>  also adopt a colinearity strategy and develop a different statistical approach to evaluate the extension of collinear points, referred as clump in ghm. however, the value of key parameter p, reflecting the probability that a point occurs in the neighborhood of the former point, is artificially defined, and the maximal gap is deduced from p in their approach. diaghunter  <cit>  adopts a colinearity method similar to our approach, and the maximal length of the path is predefined. the program stops extending the current path until it reaches the maximal length threshold, or other neighboring points cannot be found.

polyploidy has been supposed to be prevalent in plants. recently, genome-wide studies further suggest the ubiquity of polyploidy, even in genomes which have not been considered to undergo genomic duplication  <cit> . the small genome of arabidopsis has been reported to have undergone at least one round of duplication by different groups  <cit> . here using a different method, we discover that  <dig> % of the arabidopsis genome sequences are in duplicated regions and a significant portion of sequences have multiple copies. the previous studies in the rice genome have been focused on the large obvious duplicated segments, produced by the relatively recent duplication events  <cit> . here, we detect  <dig> % of rice sequences in duplicated regions, and  <dig> % have multiple copies.

the possibility of constructing the monocot-dicot comparative genetic map has been discussed  <cit>  based on the comparison of arabidopsis and rice sequences  <cit> . however, a comprehensive detection of homologous regions between these two genomes has not been available. based on gene colinearity, we detected homologous regions between arabidopsis and rice, accounting for  <dig> % and  <dig> % of each genome. all homologous segments were shorter than  <dig>  mb in length, indicating the massive genome rearrangements in both genomes after the monocot-dicot divergence. though the short homologous segments make it difficult to construct the comparative genetic map between monocot and dicot, the homologues in colinearity found in this study may provide clues for further work in comparative genomics.

CONCLUSIONS
we develop an algorithm to detect homologous chromosomal segments with conserved gene order, and we propose a statistical approach to estimate parameters and evaluate the significance of potential homology. we apply this approach to rice and arabidopsis with high efficiency to detect potential colinear regions and evaluate their significance. we find many more homologous chromosomal segments in rice genomes than previously reported, which consolidated the inference that a polyploidy had occurred in the common ancestor of grasses. we also find many small colinear segments between rice and arabidopsis genomes, providing clues to the evolutionary history of monocots and dicots.

authors' contributions
xw and xs developed the algorithm and the statistical models under the supervision of jl. xw, xs and zl implemented the programs in rice and arabidopsis, qz and sg contributed to this work on plant biology and evolution, zl and lk developed the online web server, wt provided technical support to the project. all the authors contributed to the refinement of the manuscript drafted by xw.

availability and requirements
• project name: colinearscan

• project home page: 

• operating systems: linux, unix

• programming languages: c++, perl

• other requirements: standard c++ library, bioperl and other perl modules including getopt::long and pod::usage

• license: gpl

supplementary material
additional file 1
colinear blocks in arabidopsis. a list of all collinear blocks in arabidopsis

click here for file

 additional file 2
colinear blocks in rice. a list of all collinear blocks in rice

click here for file

 additional file 3
colinear blocks between rice and arabidopsis. a list of all collinear blocks between rice and arabidopsis

click here for file

 acknowledgements
we thank manyuan long, wentian li, liping wei, min zhao, ge gao, di liu for helpful discussions. this study was supported by the national key basic research program of china , natural science foundation of china  and the china high-tech program, the china high technology platform and the program of introducing talents of discipline to universities, no. b <dig> 
