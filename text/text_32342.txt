BACKGROUND
transcriptional and translational processes are fundamental cell mechanisms, involving three main molecular species: messenger rna  and their associated proteins, as well as micrornas .

the mirnas are small non-coding rnas of roughly  <dig> nucleotides in length, which can bind with and inhibit protein coding mrnas through complementary base pairing. a given mirna can potentially bind and silence hundreds of mrnas across a number of signaling pathways. these repressive mirna-mrna interactions occur in multiple cellular processes  <cit> , and involve two distinct modalities: they may directly degrade their target mrnas, or more often inhibit their translation  <cit> .

the best characterized features determining the targets of a specific mirna are the conserved watson-crick pairing to the 5’ region  of the mirna, which are the so-called “seed pairing rules”  <cit> . since seed pairing rules are neither sufficient nor necessary for mirna-target functions  <cit> , they have usually been combined with microarray or proteomic analysis to find potential mirna-target pairs <cit> . classical microarray data analysis relies mostly on massive application of correlation analysis and linear statistical techniques to simultaneously acquired gene expression profiles. combined with profile thresholding and heat map displays, these techniques provide commonly used clues for qualitative inference.

in  <cit> , principal component analysis and linear correlation had been linked with comparative sequence analysis to study microarray data recorded during mouse stem cells differentiation, and to broadly predict potential mirna-mrna interactions.

to go beyond the results of the linear microarray analysis applied on time-course microarray data in  <cit> , we have formalized two basic architectures for repressive mirna-mrna interactions: “transcription degradation”  and “translation inhibition” .

traditional chemical kinetics equations had been proposed to model the transcriptional and translational processes without involving the interaction of mirnas  <cit> .

we have derived chemical kinetics equations  to model the dynamics of td and ti motifs, in the spirit of  <cit> . the equations are algebraically invariant under affine transformation and allow data condensation to reduce computational cost. we have implemented “minimal net” clustering method, which can control the maximum diameter of the clusters, to condense large data sets of gene expression.

modeling by nonlinear ckes involves complicated parameter estimation problems to fit the very large set of expression profiles recorded by microarrays. we have developed innovative fast algorithms dedicated to cke parameter estimation, by optimization of the quality of fit between model and data.

we validate only the parameterized motifs having a high quality of fit to data. to reach robust conclusions we apply a “parameter parsimony” principle, favoring the models having the smallest number of parameters. and we have also evaluated the robustness of our parameter estimation algorithm by algorithm by direct testing on simulated data. these tests did validate our parameter estimation method is quite robust. this nonlinear approach goes further than well-established analysis based on correlation techniques combined with heat map displays.

methods
basic interaction architectures
to validate if an mirna m does indeed repress a given gene g, we model the chemical interactions of m and g within a small network containing the pair . we now sketch two basic interaction architectures and their cke models.

transcription degradation motifs 
we call “td-motif” any interaction architecture, as sketched in figure  <dig>  involving a single mirna-mrna pair  where g is in target, and m degrades the transcription of g. the td motif includes also two sets of proteins rep and act, namely the transcriptional “repressors” and “activators” of g, denoted by 

 rep={r <dig> …rk}andact={a <dig> a <dig> …,aq} 

 let g,p,m,r
i
,a
j
, be the expression levels at time t for the chemical species g,p,m,r
i
,a
j
. we model the transcription process by a cke similar to ckes proposed in  <cit> , but with a complementary term encoding the repressive impact of mirna m on its target mrna g: 

  dgdt=-βg-vgm+κrep 

where β> <dig> is the degradation rate of g, v> <dig> is the reaction rate between g and m, κ> <dig> is the product of the transcription rate by the concentration c of dna templates, concentration which we assume to be some constant not depending on time .

the percentage 0≤f=rep≤1% is the fraction of existing dna templates which are committed at time t to transcription of the mrna gene g. here the percentages rep and act are modeled by the following products, 

  rep=rep1×…×repqact=act1×…×actk 

where 

  repi=1)sriactj=1)saj 

the parameters sr
i
> <dig> u
i
> <dig> and sa
j
> <dig> w
j
> <dig> are the number of binding sites and the affinity constant for the transcriptional factors r
i
 and a
j
.

note that the transcription repressors r
i
 combine multiplicatively their individual impacts rep
i
 in rep, and that the rep
i
 are analogous to hill function ; similar remarks apply to the transcription activators. the multiplicative expressions of rep and act are typical of a so-called “cis-regulatory” function and have been derived by j. goutsias  <cit> .

the term κrepdt is the concentration of new g molecules synthesized by transcription during the small time interval , while the repressive interactions of m and g eliminates vgmdt molecules of g, and natural decay destructs βgdt molecules of g.

translation-inhibition motifs 
we call “ti-motif” any interaction architecture, as sketched in figure  <dig>  involving a set m <dig> …,m
r
 of mirnas inhibiting the translation of mrna gene g, by repressing the expression of the protein p generated by g. let ,m
i
,g) be the concentrations at time t of protein p, mirna m
i
, and mrna g. in the spirit of  <cit> , we model the translation inhibition dynamics by the cke 

  dpdt=-γp+λgh 

where γ> <dig> and λ> <dig> are the degradation rate and the translation rate for protein p and where h is the percentage of g molecules committed at time t to the translation of g. thus h encodes the inhibiting impact of the mirnas m <dig> …,m
k
 on the translation of g, and is modeled as a product of terms similar to rep: 

  h=h1×…×hkwherehi=1)smi 

the parameters sm
i
> <dig> and u
i
> <dig> are resp. the number of binding sites and the affinity constant controlling the inhibiting impact of mirna m
i
 on the translation of gene g. note that h decreases when the mirna concentrations m
i
 increase.

our model for ti motif has been inspired by j. goutsias  <cit> , and we present below the hypotheses and arguments justifying the expression of h. there is a key difference between the ckes modeling td and ti motifs. for ti motifs, the concentration of g-molecules committed to translation is gh, where g is the concentration of g-molecules and h<100%.

for td motifs, the concentration of g-molecules synthesized by transcription is κf=αcf with f<100%, where α and c are respectively the transcription rate and the concentration of dna templates, assumed to be constant in time.

derivation of chemical kinetics equations
our derivation of the regulation equation for ti motif is quite similar to presentation given for td motifs in  <cit> , but has several changes in assumptions and formulations. to derive the ckes  and , we propose a few hypotheses. 

• hyp. 1:  the molecules of the mirna repressor of gene g can strongly bind only at one unique specific site of g- molecules, and once a single such strong bind occurs, the corresponding g molecule degrades extremely fast.

• hyp. 2:  each mirna m
j
 in the set rep of translation inhibitors of g can weakly bind with g but only at specific binding sites constituting a set bind
j
 of size s
j
. the sets bind <dig> bind <dig> … are pairwise disjoint. once a g molecule thus binds with one inhibitor m
j
, then this g molecule will fail to translate.

• hyp. 3: for any given g-molecule, call x
j
 the random number of sites in bind
j
 which actually bind with one “ m
j
”-molecule. we assume that the random variables x <dig> x <dig> …. are independent.

hyp. <dig> is based on the fact that only a small fraction of all messenger rnas have more than a single mirna binding site and mirna bound with an mrna gene g has a limited effect on the mrna g, but affects more substantially the protein p generated by g ={m <dig> m <dig> …m
k
} of k translation inhibitors. we now derive the cke  for this ti motif. call p,g,m
j
 the concentrations of p,g,m
j
 and let h be at time t the percentage of existing g molecules committed to the translation of g into p. the basic cke driving translation of g into p is then, as seen in  <cit> , 

  dpdt=-γp+λgh 

where γ,λ, are the degradation and translation rates of p.

the main point is to compute h.

for k= <dig>  there are no translation inhibitors, and hence h=100%. for k= <dig>  let q be the set of g molecules with exactly s binding sites bound to m <dig> molecules, where 0≤s≤s <dig>  let q be the concentration of q molecules. we have the forward and backward reactions 

  q+m1⇀qandq⇀q+m <dig> 

by molecular collision theory  <cit> , the concentration ρ of free m <dig> molecules which bind at time t on q-molecules to produce q-molecules by forward reaction  <dig>  is proportional to the product of m1q by the number  of vacant binding sites. hence, for some constant c, 

  ρ=cm1q 

similarly the concentration τ of m <dig> molecules freed by backward reaction  <dig> is given by 

  τ=c~q 

for some constant c~. at chemical equilibrium, we have τ=ρ, and hence 

 q=um1s1-ss+1q 

 where u is a new constant. by recurrence on s, this implies 

  q=cs1ssqwherecs1s=!s!! 

this entails 

  g=∑s=0s1q=q∑s=0s1cs1ss=s1q 

the set of g-molecules committed to translation into p at time t is identical to q. thus h=q/g, and  yields h=1/s <dig> 

using hypothesis hyp  <dig>  a recurrence on k extends the argument just given for k= <dig>  to prove that for k≥ <dig>  the percentage h of g molecules committed to translation into p is given by: 

  h=1s1×…×1sk 

which proves cke  for ti motifs.

for td motifs, the cis-regulation function f in cke  has been derived in  <cit> . by using hypothesis  <dig> and molecular collision theory, we directly deduce that the concentration the concentration of mrna g degraded by mirna m is proportional to the product of both concentrations of g and m. thus we justify the mirna degradation term -vgm.

invariance by affine profile transformations
affine profile transformations
call Γ⊂r
q
 the set of all possible expression level profiles r indexed by time t <dig> …,t
q
. to any pair t= of real numbers, we associate an affine profile transformation

 r→trdefined byr→+b) 

 for all time dates t. let  be the set of all such affine profile transformations.

in microarray data sets, expression levels of genes are recorded via optical analysis of fluorescence intensities, and hence depend strongly on experimental acquisition modalities. so relative expression levels between pairs of recorded chemical species are more meaningful quantities, and graphic displays of microarray data by “heat maps” often involve logarithms of raw data.

our microarray data record expression levels which as a first approximation can be viewed as unknown affine transformations of concentrations. since our ckes ,  were derived for concentrations, we need to check how these ckes and their parameters change under generic affine profile transformations.

affine invariance of cke models
consider first a td-motif involving an mrna gene g, a protein p, an mirna m, transcription repressive proteins r <dig> r <dig> …, and transcription activating proteins a <dig> a <dig> …. the cke model  links the concentrations g,p,m,r
i
,a
j
 of g,m,p,r
i
,a
j
. let ĝ,p^,m^,r^i,âj be the corresponding recorded expression profiles. assume that each such recorded profiles r^ is linked to the concentration profile  <dig> by some unknown affine profile transformation t
r
.

from cke , one directly deduces that ĝ,p^,m^,r^i,âj verify a new cke having an algebraic form completely similar to cke , but where the original parameters β,v,κ,u
i
,w
j
 are replaced by new parameters β^,v^,κ^,ûi,ŵj, and where the integers sr <dig> sr <dig> …, and sa <dig> sa <dig> …, remain unchanged.

the new parameters are easily expressed in terms of the original ones and of the coefficients of the affine transformations, but this is irrelevant practically since we will use microarray data to directly compute the new parameters for a cke of type  linking recorded expression levels.

similar computations for ti-motifs show that this affine invariance property also holds for cke . hence to model a td or a ti motif, we can fit a cke model of type  or  to recorded expression profiles, even though the theoretical model justification involved true concentrations, which are not directly measured by microarrays.

the key assumption is that, for each chemical species c, the expression levels ĉ of c recorded by microarray are approximately linked to the concentration c of c by some affine relation ĉ=ac+b, where the unknown coefficients a and b may depend on the species c.

the preceding algebraic model invariance under multiple affine profile transformations strongly suggests that adequate distances between dynamic profiles of recorded expression levels should be invariant under affine profiles transformations, as developed in the next section.

condensation of expression levels profiles
microarray data typically record several tens of thousands gene expression profiles. so computational costs to fit microarray data to all potential td-motifs and ti-motifs would of course be prohibitive. a natural option to reduce combinatorial explosion is to cluster the observed profiles.

since our goal is to model expression profiles by odes of type  and , we need to control the diameters of all clusters of expression profiles. this led us to reject hierarchical clustering as well as k-means clustering, and to implement in the space of expression profiles a “minimal-net” clustering technique, inspired by an innovative technique for automatic generation of prototypes in shape spaces . in view of the preceding section, the diameters of clusters in the space of profiles should be measured by a distance invariant under affine profiles transformations.

affine invariant distance between profiles
recall that Γ⊂r
q
 is the set of all profiles r indexed by time dates t <dig> …,t
q
. the mean and variance of a profile r are denoted by 

 r¯=1q;var=1q 

define normalized profiles nor and profiles correlations corr by 

 nor=r-r¯var;corr=<nor,nor> 

where <·,·> is the usual scalar product in r
p
.

we then define a distanced between profiles r <dig> and r <dig> by 

 d=2-2corr) 

for any affine profile transformation t in , one has nor=nor, and hence d=d,nor. thus for any affine profile transformations t <dig> t <dig>  and any profiles r <dig> r <dig> one has 

 d=d 

so the profile distance d is invariant by affine profile transformations

minimal net clustering
the set Γ of all profiles is now endowed with a distance d invariant by affine profile transformations. call mpr the large set of mirna profiles recorded at time t <dig> …,t
q
 by our microarrays. we fix a maximum radius ε for profiles clusters. we seek to partition mpr into disjoint clusters cl <dig> …,cl
r
 such that each cl
j
 has diameter inferior to 2ε, and we also want the number nn of clusters to be as small as possible. we have implemented an iterative algorithm to generate this type of minimal net clustering, in the spirit of  <cit> .

define a distance function d, where x,y represent the observations of the data. denote by d the distance between an observation x and a set y, where d= miny∈yd. let let  denote the cluster containing single point x, and Γ be the set of all observations, the minimal net algorithm is as follows: 

 <dig>  step  <dig>  let =argmax
x,y
d. then let x <dig> and y <dig> become the representatives of two initial clusters. let cl1= ,cl2= , c1={cl <dig> cl2} and r1=Γ∖c <dig> representing the remaining points in Γ excluding the  <dig> clusters.

 <dig>  after step n- <dig>  we obtain c
n-1={cl <dig> cl <dig> …cl
n
} and r
n-1=Γ∖c
n- <dig>  where cl
j
 is a cluster that has single point, j= <dig> …,n+ <dig> 

in step n, let hd=maxx∈rn-1d, representing the maximum distance between observation x in r
n- <dig> and set c
n- <dig>  if hd>ε, find xhd=argmaxx∈rn-1d. let c
n
={c
n- <dig> x
h
d
}, r
n
=Γ∖c
n
. repeat until hd≤ε.

 <dig>  assume the loop stop at step nn, we have c
n
n
={cl <dig> cl <dig> …cl
n
n+1}. for an observation x, find the point yclk, belonging to cluster cl
k
 in c
n
n
, that is closest to x, i.e. yclk=argminy∈cnn), then assign x to the cluster cl
k
.

we apply this minimal net clustering algorithm to the set of all mirna profiles recorded by our microarrays. we define the cluster diameter diam of cluster cl as the maximum distance of any two observations in the cluster, i.e. diam= maxx,y∈cld, where. compared with the commonly used clustering method such as k-means and hierarchical clustering, the minimal net algorithm allows us to control the diameter of all clusters by setting the threshold ε representing the supremum radius of the cluster, while the k-means and hierarchical clustering is often used to determine the number of of clusters but not their diameters. if we select a very small threshold ε, the expression levels of genes in the same cluster can be considered almost identical.

parameter estimation for the cke models
parameters estimation strategy
a generic strategy for parameter estimation in ckes systems is to minimize a cost function evaluating the discrepancy between model predictions and experimental data. each one of our cke models has a single output variable, namely the expression level g of mrna gene g for a td motif, and the expression level p of protein p for a ti motif. the output variable g or p of a cke model can be estimated by a function ĝ or p^ once one knows the profiles of all other molecular species involved in the model. the estimators ĝ or p^ are respectively determined by cke  or cke .

each cke models is parameterized by a parameter vector w of dimension n
p
a
r
. the quality of fit of this model with recorded profiles data is quantified by the size err of the estimation error defined as follows 

 err=maxt|f-f^| 

 where the output variable f is equal to g for td motifs and to p for ti motifs. the concrete goal is to find the best parameter vector w by minimization of the lack of fit err over all possible values of w.

there are no magic solutions for such non linear minimization problems. moreover fast computing was essential here, since we usually have to solve a very large number of similar “quality of fit maximization” problems when dealing with large microarray datasets.

we have tested several generic cost minimization approaches  such as “genetic algorithms”, as well as “gradient descent” to minimize a sum of squared modeling residuals. these two techniques turned out to require far too much computing time and were often unreliable due to their high dependence on initialization values.

we hence developed our own fast cke parametrization algorithms to optimize the quality of fit between cke models and microarray profiles data. this optimized quality of fit, adequately balanced by a systematic emphasis on parsimoniously parameterized models, becomes an essential clue to decide which potential interactions one should validate between mirnas, mrnas, and associated proteins.

parameters parsimony requirement
robustness of cke parametrization is the main motivation for our parameter parsimony requirements. consider cke  modeling a td-motif tdm involving n
a
c
t
 activators and n
r
e
p
 repressors for the transcription of mrna gene g, and one mirna m degrading the transcription of g. then the number n
p
a
r
 of unknown parameters is n
p
a
r
=3+ <dig>  each profile g,m,a
i
,r
j
 is recorded at t=t <dig> …,t
p
. the cke outputs for tdm are g,…,g. hence each microarray data set provides  equations linking the n
p
a
r
 unknown parameters, since the recorded g should be very close to the predicted values ĝ obtained by solving the ode  with initial value g.

vapnik’s results on model fitting  show that robust accuracy of parameter estimates requires fairly high values of the ratio of /n
p
a
r
. so n
p
a
r
<< is a necessary constraint, and we will impose the parameter parsimony requirementn
p
a
r
≤/ <dig>  indeed when n
p
a
r
>, cke models are overfitted and parameters are poorly estimated.

cke parameter estimation
ti-motifs: plausible ranges for parameters
consider a generic ti motif tim involving an mrna gene g, its associated protein p, and k translation inhibiting mirnas [ m <dig> …,m
k
]. let p,g,m
i
 be the expression levels of p,g,m
i
. we want to model tim by cke .

parametrized by the vector 

 w= 

 which involves ≤ <dig> parameters.

the degradation and translation rates γ and λ of protein p were unknown for most proteins.

according to results from  <cit> , only a small percentage 2% of our  <dig>  mrnas have more than  <dig> potential binding sites for mirnas, and only  <dig> % mrnas have as many as  <dig> such binding sites. so in our parameter estimations it is reasonable to restrict the number of binding sites s
j
 for mirna m
j
 to be at most  <dig> 

ti-motifs: optimizing the quality of fit
the inputs of cke  are the initial value p and the expression levels g,m <dig> …,m
k
 recorded at time dates t <dig> …,t
q
.

discretizing the ode  at time t <dig> …,t
q
, we get 

  p-p=-γp+λgh 

where the percentage h is as recalled above. by summation this implies, for j= <dig> ,.…,q- <dig>  the relation 

  p-p=-γq+λl 

where 

 qtj=∑n=1jgtn;ltj=sumn=1jgtnhtn 

 in view of equation , when all expression profiles involved have been recorded until time t
j
, one can predict the still unknown value of p by the following natural estimator p^, 

  p^=p-γq+λl 

the quality of fit of this cke model with recorded profiles data will be quantified by the sizeerr of the estimation error numerically computed as follows 

  err=maxj= <dig> …,q|p-p^| 

which in view of  can be reformulated as 

  err=maxj= <dig> …,t|πj+μjγ-νjλ| 

where for j= <dig> …,q we have set 

  πj=p-pμj=qνj=l 

we seek a parameter vector w minimizing the cost function err in the parametric domain defined by 

 γ>0;λ>0;ui>0;1≤si≤ <dig> 

ti-motif: parameter estimation algorithm
for each i=1…k, fix an arbitrary integer 1≤s
i
≤ <dig>  call m¯i and h¯i the respective medians over time t of the functions m
i
 and h
i
. since the function hi=1/si is monotonous in m
i
, we have 

  h¯i=1/si 

the assumption 0<h
i
< <dig> yields 0<h¯i< <dig>  we will discretize the possible values of h¯i by constraining them to belong to a grid h <dig> …,h
s
 of 1≤s≤ <dig> percentage values equally spaced in . since m¯i is known, we invert equation  to compute a corresponding grid grd
i
 of s potential values for ui=1m¯i1/si-1).

now for 1≤i≤k, select and fix arbitrary values u
i
 in the grid grd
i
. after selecting as restrictive above the set of parameter vector u= [ u <dig> s <dig> …u
k
,s
k
], the function h is then completely determined for all t.

note that the set  of all possible such choices for u is of cardinal inferior to n=
k
. since we do explore each one of these possibilities separately, we need to keep the number n at a reasonable level, so we selected s= <dig> for k= <dig>  s= <dig> for k= <dig>  s= <dig> for k= <dig> etc.

fix any u in . since all recorded profiles involved in the td motif are available at time t <dig> …,t
q
, we can use the u value to directly compute all the values h, and then all the numbers π
j
,μ
j
,ν
j
 defined by . we want to find values of the two last parameters γ> <dig> and λ> <dig> which will minimize 

 err=maxj= <dig> …,q|πj+μjγ-νjλ| 

 this problem is equivalent to minimizing the linear objective function: 

 Ψ=z 

 under the  linear inequality constraints 

 γ>0;λ>0;z>0z-≥0forj= <dig> …,qz+≥0forj= <dig> …,q 

this is a classical constrained linear programming problem, which can be solved by well known fast linear programming algorithms  <cit> , to provide the optimal values γ∗,λ∗,z∗. then z∗=err is the minimal value of err.

these optimal values are functions γ∗,λ∗,z∗ of the partial vector of parameters u in . we then select the optimal u∗ in  as the value of u which minimizes z∗ over . the optimal parametrization w∗ of our td motif is then given by w∗= . this new parametrization algorithm is fairly fast and has good accuracy. on a current laptop pc, our non-optimized matlab code implementation required less than  <dig> minutes of cpu time for the parametrization of a typical ti-model with  <dig> time points and  <dig> parameters  <cit> . after code optimization and a re-implementation in c, we expect this cpu time to be reduced to  <dig> minutes. the algorithm does not require any knowledge of the parameters ranges except for the number of binding sites s, which is an advantage for the range of reaction rates of of many molecules of interest are usually unknown.

td-motifs: parameter estimation algorithm
the parametrization algorithms just presented also apply to td models, as we now sketch. the output variable is now the expression level g of mrna gene g.

discretize the ode  at time dates t <dig> …,t
q
, to get 

  g-g=-βg-vgm+κf 

where f is defined in . by summation this implies the relations 

  g-g=-βb-vv+κk 

where 

 b=∑n=1jg;v=∑n=1jgm;k=sumn=1jf 

when all expression profiles involved have been recorded until time t
j
, one can predict the unknown value of g by the estimator ĝ, 

  ĝ=g-βb-vv+κk 

the quality of fit of this cke model with the recorded profiles data is quantified by the size of the prediction error which is a function err of the parameter vector w

 errw=maxj= <dig> …,q|gtj-g^tj| 

 so that 

  errw=maxj= <dig> …,q|τj+ρjβ+ηjv-θjκ| 

where we have set 

 τj=g-gρj=bηj=vθj=k 

 the td model parameters sr
i
> <dig> u
i
> <dig> and sa
j
> <dig> w
j
> <dig> are the number of binding sites and the affinity constants for the transcriptional factors r
i
 and a
j
. they constitute a partial parameter vector u which we restrict as above by first imposing a moderate upper bound s
m
a
x
 on all the integers sr
i
,sa
j
. and by selecting, also as done above, adequate finite grids for the values of the u
i
 and the w
j
. this constrains u to belong to a finite set . the cardinal n of  is forced to remain at most of order  <dig>  by adequate constraints on s
m
a
x
 and on the coarseness of the u
i
 grids and the v
j
 grids.

to minimize err, we fix as above an arbitrary u in . we can then compute all the numbers τ
j
,ρ
j
,η
j
,θ
j
. since u is fixed, the error size err becomes a function e of the last  <dig> positive parameters , still given by equation . as above the minimization of e is equivalent to a constraint linear programming problem where we want to minimize the linear function Φ=z over the following set of  linear inequalities 

 β>0;v>0;κ>0;z>0z-≥0forj= <dig> …,qz+≥0forj= <dig> …,q 

solving this constraint linear programming problem generates optimal parameters  and a minimal error z∗, which are all functions of u. one concludes as above by selecting an optimal u∗ minimizing z∗ over all u in .

quality of fit for cke models
consider any td motif or ti motif . we have seen how to compute a parameter vector w∗ optimizing the quality of fit between microarray data and our cke model for . this was done by minimizing err=maxt|f-f^|, where f is the main output variable of , and f^ is the estimation of f based on the cke parametrized by 
w
.

for the optimal cke parametrization w∗, the lack of fit to data can then be evaluated by err. however we have seen in section ‘invariance by affine profile transformations’ that when comparing two expression profiles recorded by microarray, natural distances between profiles should be roughly invariant by changes of scale for these profiles. it would then be tempting to replace the absolute error of estimation |f-f^| at time t by the relative error of estimation |f-f^|f. but relative errors become quite large whenever the output profile f is close to zero. to avoid such spuriously large error values, while still preserving scale invariance whenever f is not close to zero, we define the smoothed relative error of estimation sre at time t by the following formula, where f¯ denotes the mean value of the profile f, 

  sre=|f-f^|fwhenf> <dig> f¯ 

  sre=|f-f^|f¯whenf≤ <dig> f¯ 

we finally quantify the modeling errormoder for the optimally parametrized cke model of motif  by 

 moder=maxtsre 

RESULTS
examples of application
we implemented our model of ti on microarray data of mouse stem cells undergoing ra-induced differentiation, as provided by lc science inc, and previously analyzed by classical techniques in  <cit> . we took the recorded expression profiles for proteins/mrnas gcnf, oct <dig>  nanog and sox <dig> at time points / and expression levels for  <dig> mirnas on days  <dig>   <dig>   <dig>   <dig> from  <cit>  during es cell differentiation. these profile data were interpolated at  <dig> intermediary time points, by piecewise cubic hermite interpolation  and the number of parameters were limited to be  <dig>  i.e. only  <dig> upstream mirna was selected for the model, to satisfy the parameter parsimony requirement.

for mirna m
i
, the following linear transformation, which could be viewed as normalization, was done: 

 mi^t=mit-mi¯tσmi+ <dig> 

 where σ=∑t-mi¯) <dig>  t= <dig> / <dig> …, <dig>  since ∥mi-mi¯σ∥≤ <dig>  mi^ is positive for t= <dig> / <dig> …, <dig>  taking ε= <dig> , we applied minimal net clustering  to the transformed data of mirnas, mi^,i= <dig> ,…, <dig>  and obtained  <dig> clusters, in which the maximum cluster contains  <dig> mirnas. we consider that the mirnas belonging to the same cluster share the same normalized expression level within a negligibly small error. for each cluster cl
j
, j= <dig> …, <dig>  we determine the mirna mc
j
 which is the representative of the cluster cl
j
 for the distance d, and we let mc
j
 be the expression level of mc
j
 at time t. we call mc
j
 is the expression level of cluster cl
j
.

we successively implemented the ti model with only one repressor mirna . after parametric modeling of our pre-selected  <dig> ti motifs, and evaluation of their quality of fit, we have validated only  <dig> clusters of mirnas as translational inhibitors repressing protein oct <dig>  if an mirna in cl
j
 is validated by modeling as a potential repressor, all other mirnas belonging to cl
j
 are also potential repressors and can be validated numerically as well by the form invariability of the model under affine transformation. here we present one of these three validated mirnas of oct <dig> , where the centroid of the cluster is mirna mmu-mir-10a, while the other  <dig> mirnas in the cluster are mmu-mir- <dig>   <dig>   <dig>   <dig> and 99b. we used tarbase  <cit>  to search all the experimentally validated mirnas targeting oct <dig>  in mus musculus. by tarbase, only mmu-mir- <dig> has been experimentally validated and it is also numerically validated by our ti model.

for protein gcnf, only two mirnas, mmu-let-7b and mmu-let-181a, have been experimentally validated by tarbase and both of them belong to the list of the  <dig> mirnas numerically validated by our ti modeling . our modeling approach did not validate any mirna repressing both proteins nanog and sox <dig>  while there are  <dig> mirnas and  <dig> mirna experimentally validated as separate repressors of nanog and sox <dig> respectively.

we here also present one example of td motif for downstream factor mrna sox <dig> . with the assumption that the transcription factors are proteins oct <dig> and nanog  <cit> , we validated cluster mmu-mir- <dig>  30a-3p, 30b,  <dig>   <dig>  433-3p, 434-3p, and 487b as degraders. although  is also an experimentally tested pair, we will not discuss deep in detail the validation results of the td motifs in this paper. the main reason is that the validation results of td motifs depends much on our knowledge of the transcription factors. more discussion is in the subsection below.

discussion
in  <cit> , we pre-selected the potential mirnas for each gene/protein by targetscan  <dig>  and miranda before applying the two models. the pre-selection of mirna candidates were not necessary though it greatly reduced the computational cost. however, the application of the cke modeling was dependant on the target prediction algorithm, such as targetscan or miranda. therefore, we introduced minimal net clustering in this paper so that the data was condensed and the computational cost could be reduced by a purely numerical method without biological bias.

since the results of td model depend on information of transcription factors, the modeling validates not only mirnas acting as mrna degraders but also upstream transcription factors simultaneously. in  <cit>  we numerically validated proteins gcnf, oct <dig> and nanog as transcription factors for mrnas oct <dig> and nanog, while marson et al. and boyer et al.  <cit>  claimed that oct <dig> and sox <dig> are bounded and act together with nanog as transcription factors. considering the impact of the transcription factors, the td modeling may be less convincing unless the transcription factors are fixed as experimentally validated. in this paper we presented more details on the implementation and validation results of the ti model in order to focus on the validation of mirnas and avoid the influence of assumptions of transcription factors.

tarbase shows that, for protein gcnf the experimentally validated mirnas are mmu-let-7b and mmu-mir-181a; for protein oct <dig> the experimentally validated mirna is mmu-mir-470; for protein nanog the experimentally validated mirnas are mmu-mir- <dig>  mmu-mir- <dig>  and mmu-mir-296; for protein sox <dig> the experimentally validated mirna is mmu-mir- <dig>  in this paper, we have validated by ti modeling and minimal net clustering all the experimentally tested mirna repressors of gcnf and oct <dig>  in our previous work  <cit> , actually none of these mirna repressors had yet been studied for modeling for the four proteins because of the restriction of pre-selection. and only the pair  was validated by the classical correlation analysis done in gu et al.  <cit>  for the  <dig> proteins gcnf, oct <dig>  nanog, sox <dig>  therefore, the ti modeling combined with data condensation not only reduced computational cost but also clearly extended the set of mirna inhibitors validated by model fitting to microarray data.

since each numerically validated mirna cluster may contain two or more mirnas, the mirnas in the same cluster could also be considered as potential candidate inhibitors for further experiments to validate. for instance, as figure  <dig> shows, mmu-mir- <dig>   <dig>   <dig>  10a and 99b are potential candidates for protein oct <dig> for they are in the same cluster as mmu-mir- <dig>  which is validated by both the numerical modeling and experiments.

after the pair  was well validated by our cke model, we found that the cluster  containing mmu-mir-181a also includes mmu-mir- <dig> and mmu-mir- <dig>  which are two known mirnas that have the same roles in regulating insulin sensitivity and promoting metastasis of colorectal cancer  <cit> . we also checked that mir- <dig> and mir- <dig> have almost the same mature sequences: 

• mmu-mir-103: agcagcauuguacagggcuauga

• mmu-mir-107: agcagcauuguacagggcuauca

after the pair  was well validated by our cke model, we observed mmu-let-7g, and mmu-let-7i are in the same cluster as mmu-let-7b . it was claimed that let-7b and 7g reduce tumor growth in mouse models of lung cancer  <cit> . we then checked that indeed these three mirnas have very similar mature sequences, namely 

• mmu-let-7b: ugagguaguagguugugugguu

• mmu-let-7g: ugagguaguaguuuguacagu

• mmu-let-7i: ugagguaguaguuugugcugu

to evaluate the correlation between mature sequence and expression profile of our set of  <dig> mirnas, we systematically explored all the 266×265/2= <dig>  pairs  of distinct mirnas in this set, i≠j,i,j= <dig> …, <dig>  for each such pair we then computed the euclidean distance between the expression level profiles  and the needleman-wunsch alignment score  between the mature sequences of each mirna pair. we then divided the  <dig>  mirna pairs into two groups: grouphigh includes the pairs with high alignment score , i.e. grouphigh includes mirna pairs with similar mature sequences, and grouplow includes the pairs with low alignment score . we then compared the distribution of expression distances for all mirna pairs in grouphigh with the distribution of these distances for mirna pairs in grouplow. as seen in figure  <dig> , the quantiles of these distances in grouplow are consistently larger than the corresponding quantiles in grouphigh. this is fully confirmed by kolmogorov-smirnov test which yielded the very significant p-value 7×10- <dig>  the result still holds when we change the alignment score threshold nwa= <dig> used to define grouphigh and grouplow . we conclude that mirnas having similar mature sequences tend, with high probability, to have similar expression levels. the above analysis and examples indicate that mirnas belonging to the same cluster are good candidates to have similar mature sequence. since the match between mirna mature sequence and target sites is the main determinant for mirna targets, mirnas belonging to same cluster may hence also have similar regulatory roles.

robustness of parameter estimation
estimation algorithms for nonlinear models may yield parameter estimates that are dependent on the particular set of data or on initial estimates of parameters. since our parameter estimation algorithm is independent from initial estimates of parameters, we now focus on on the measurements errors affecting microarray data and on their impact for parameter estimation. considering that the noises of the microarray data are not negligible, we have analyzed the robustness of our parameters estimators when one perturbs randomly the observed expression levels of mirnas. we have selected an arbitrary validated model md, where the corresponding downstream factor is denoted as d, and has expression levels d. denote mirnas m <dig> …,m
j
 pertaining to model md and call their expression levels m <dig> …,m
j
. then we have perturbed the expression levels of the mirnas by independent random noises having the recorded standard deviation σ <dig> …,σ
j
 and obtained simulated expression levels sm <dig> …,sm
j
. after injecting the perturbed expression levels sm <dig> …,sm
j
 into the model md and get the predicted expression level pd of d. with pd,m <dig> …,m
j
 and expression levels of other upstream factors, we then applied our parameter estimation algorithm to re-estimate the model parameters. this procedure was repeated  <dig> times. then for each model parameter, we plotted the histograms of those  <dig> re-estimated parameter values and compared them with the parameter values estimated from unperturbed data of model md. this analysis showed that our parameter estimation algorithm is quite robust. here we present the histograms of perturbed estimates of model parameters for one td motif  and one ti motif .

CONCLUSIONS
we have separately modeled by chemical kinetics equations the  <dig> distinct modalities of the repressive actions of mirnas on post-transcriptional processes of mrna genes and the associated proteins. this was achieved by first defining the formal structure of two types of interaction architectures  linking mirnas to subgroups of mrna genes. the plausibility of each one of these potential td motifs or ti-motifs was then evaluated by computerized parametric modeling, based on microarray data, of adequate formal chemical kinetics equations .

we have sketched the formal derivation of  <dig> specific ckes modeling by dynamic odes the interactions between concentrations of different species of molecules involved in each architecture. this led to a motif validation strategy based on the quantified quality of fit between our optimally parametrized models and the corresponding microarray data.

our computerized parameter estimation is implemented by an innovative fast algorithm that does not require knowledge of range of molecular reaction rates. on a current standard laptop pc, our implementation of parameter estimation for a typical 9-parameters cke model requires about  <dig> minutes of computing time.

our parameter estimation algorithm also provides relatively high-quality optimization for the fit between model and microarray data, by integrating both global and local cost minimization techniques, in contexts where plausible ranges of values for most of the unknown parameters are not available in the literature. by perturbing the expression levels of mirnas and re-estimating the parameters, we showed that our parameter algorithm has a satisfactory level of robustness. we believe that our parameter estimation technique with associated evaluation of quality of fit would be quite applicable as a generic algorithm to similar problems in chemical kinetics modeling of molecular interactions.

modeling very large microarray data is computationally quite expensive. we have hence sketched clustering methods to condense large microarray data. this approach has of course been attempted before our work, but the main point is that we have carefully studied the mathematical compatibility of our cke models with condensation of the profiles data. since we have proved that the abstract form of our cke models is invariant by arbitrary multiple affine transformations of profiles data, we have made sure to constrain the distance of two expression levels profiles to be invariant by these types of affine transformations.

we have implemented a minimal net clustering algorithm based on this distance, which allows us to control the radius of the clusters. the number of ckes to parameterize can be strongly reduced after condensation of the large data sets, and the affine invariance of our ckes show that the condensed genes network can then still be modeled by similar ckes.

by applying our ti modeling to multiple proteins such as gcnf, oct <dig>  nanog, sox <dig>  we showed that  <dig> mirna-target pairs experimentally validated can be also validated by the ti model.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
zl developed the chemical kinetics equations and the parameter estimation algorithm; ra proposed the transformation invariance of chemical kinetics equations and data condensation method; yz did the computation work. zl and ra wrote the paper. all authors read and approved the final manuscript.

supplementary material
additional file 1
codes-minimal net clustering.

click here for file

 additional file 2
codes-parameter algorithm.

click here for file

 acknowledgements
we would like to thank drs p. gunaratne, a. j. cooney, d. lonard, x. xu for multiple discussions concerning their experimental data and results on mirna-mrna interactions. these discussions led us to a joint publication.
