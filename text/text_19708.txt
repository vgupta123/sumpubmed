BACKGROUND
small rna analysis by massively parallel sequencing  represents an increasingly popular method to address different questions concerning the biological role of mirnas and other regulatory small transcripts, such as piwi-interacting , small inhibitory , transcription initiation , transfer  and other small non-coding  rnas, including also extra-cellular small rnas . among sncrnas, mirnas and pirnas are emerging as key regulators in multiple cellular functions and for this reason are widely studied by direct sequencing. mirnas, the best know and studied class of sncrnas, are interesting to investigate due to their ability to control gene expression in eukaryotes by fine tuning mrna translation  <cit> . they represent a class of short  rna molecules that play pivotal roles in a variety of molecular processes, such as immune response  <cit> , differentiation  <cit> , development  <cit> , infection  <cit>  and carcinogenesis  <cit> . mirna genes are synthesized as long precursor rna molecules , usually by rna polymerase ii  <cit> , that are rapidly processed in the nucleus by drosha rnase iii to release approximately  <dig> nucleotides long mirna precursor stem loop   <cit>  that in turn are exported to the cytoplasm by exportin  <dig>  <cit> . in the cytoplasm, mature mirnas are produced through the action of dicer rnase  <cit> . these small rnas regulate gene expression by binding to targets sites generally in the 3′ untraslated region  of target mrnas, resulting in mrna degradation or translation inhibition  <cit> . mirnas recognition of the 3′ utr of their target mrna is mediated by hybridization between nucleotides 2– <dig> at 5′ end of the small rna  and the complementary sequences present in the 3′ utr of the mrna  <cit> . on the other hand, small non-coding rnas that interact with piwi proteins, called pirnas, are emerging as regulatory transcripts able to control a broad range of biological processes. the main roles of these molecules has been investigated mainly in germline stem cells, where they are involved in:  regulation of transposone activity;  modulation of genome epigenetic state,  development and  spermatogenesis  <cit> . however pirnas have been also identified in somatic cells, including human cancer cells  <cit> , suggesting their possible involvement in tumors. this aspect highlights the need for sensitive and efficient bioinformatics tools to study these novel class of sncrnas in smallrna-seq datasets. smallrna-seq allows detection of rnas with a high dynamic range and reliably measures small differences in rna concentration between samples, enabling also to discover novel rna molecules not annotated in databases. generally, data analysis is performed by combining multiple statistical and bioinformatics tools available from different sources. many useful programs for processing these data exist nowadays, such as randa  <cit> , shortran  <cit> , uea srna workbench  <cit> , dsap  <cit> , mirtools  <dig>   <cit>  and mirexpress  <cit> . two main issues hamper diffusion and implementation of such programs:  web-based tools have some restriction on data upload;  stand-alone programs often lack one or more analysis steps, such as for example prediction of novel sncrnas. as main consequence, the analytical workflow is slowed down by the need for the continuous interventions by the operator, a critical factor when a large number of samples need to be analyzed at once. a main challenge in bioinformatics is thus to create comprehensive computational tools for handling and analyzing, in an automated manner, the huge amount of data generated by these experiments.

we describe here a modular analysis pipeline, imir, for comprehensive analyses of smallrna-seq data integrating multiple open source modules and resources linked together in automated way. the pipeline allows identification of mirnas and other sncrnas, such as pirnas, to perform differential expression analysis and, for mirnas, to predict the corresponding mrna targets. in addition, imir provides the possibility to perform hierarchical clustering and to apply different statistical approaches to the analysis, improving discrimination of expressed sncrnas and allows to identify those more likely to be biologically relevant. the pipeline output includes graphics and text files that are useful for a better interpretation of the results. imir is well suited for the analysis of smallrna-seq data obtained from animal samples. moreover, it can be used to investigate the role of sncrnas in plants adding the appropriate reference tracks in imir database.

implementation
one of the main problems when dealing with the large datasets generated with the currently available next generation sequencing  technologies are represented by the difficulties in their management and analysis. analysis of smallrna-seq data, for example, requires implementation of different bioinformatics tools and the possibility to perform multiple, subsequent file format conversions that slows-down and makes cumbersome the analytical procedure. the need of a bioinformatics instrument that may help solve these problems in a user-friendly and handy way led us to devise a tool, called imir, that integrates various open source modules and resources and, in addition, implementing different statistical approaches for sncrnas expression analyses allows users to select the most performing and relevant method for analysis of their data. the analytical modules included in imir, selected among the best available, have been made more performant thanks to home-made scripts that allows the user to create self-defined analytical flows. indeed, the resources integrated in imir were selected after careful comparison and throughout evaluation of the performance of software widely used in smallrna-seq data analysis, according also to what recently reported by cordero et al.  <cit>  and williamson et al.  <cit> . imir was implemented using an object-oriented programming language, python, and comprises also a graphical user interface  that makes it easier the use of command line tools, so that the pipeline is particularly suited for biologist and early stage bioinformaticians, also because it simplify the way how projects are created, parameters are specified for each of several steps of the analysis and the different algorithms are run on project data . in addition, terminal display window  can be used to follow the flow of analysis. imir provides stepwise planning that allows user to select the desired combination of analytical tools in the workflow. some modules are mandatory while others are, instead, optional. a schematic representation of the imir workflow is shown in figure 2a-f. the pipeline takes in input the deeply sequenced reads in fastq format. as mentioned above, imir offers the possibility to run different modules independently and this can be considered one of its main advantages. indeed, in some cases user can work using pre-analyzed datasets , or may need to perform only a specific analytical step, such as adapter cleavage from input reads, detection of known and/or novel mirnas, or to map sequence reads against other sncrna libraries and then to perform differential expression analysis. in all cases, it is possible to start the analytical flow at that step simply by using the input file specific for it. the initial analytical step described in module  <dig>  allows to perform a pre-process analysis of the input files by setting user-defined options for performing adapter cleavage with cutadapt tool  <cit> , as well as quality filtering and analysis of the length distribution of reads. cutadapt is used for adapter trimming and differs from other adapter trimming tools because it provides several useful option, e.g. error rate assessment in adapter cleavage or search and removal of multiple adapter sequences, essential to get rid of adapter duplications occurring during sequencing library preparation. module  <dig>  allows detection of known mirnas. to this aim, imir integrates in its pipeline miranalyzer stand-alone tool  <cit> , that in its last version  was improved in speed and features, including a comprehensive analysis of sequences corresponding to isomir  <cit> . at this step it is possible to perform also cluster analyses, carrying out pca analysis and/or applying different hierarchical clustering algorithms. this feature, in fact, is useful when dealing with a very large number of samples to assess similarities and differences among them, such as for example when analyzing results from large cohorts of tumor biopsies. one main advantage of small non-coding rna sequencing is the possibility to predict novel mirnas not annotated in databases. this procedure  is performed in imir with miranalyzer stand-alone tool  <cit>  and mirdeep <dig>  <cit> . with this process it is possible to achieve a dual purpose:  to obtain more accurate results on novel mirnas, that can then be experimentally validated and  to evaluate presence and concentration of reads relative to other sncrnas in the same datasets. we included in imir the possibility to implement an intermediate step , before proceeding to differential expression analysis step , to remove the noise and less informative reads, e.g. mirnas or sncrnas expressed with very low read counts, that is based on the following statistics:  cumulative distribution function and  arbitrary value approaches. furthermore, low read counts might not reveal a real biological information, being due to sequencing errors or inaccuracy during the procedure of read alignment to the reference genome, such as cross mapping artefacts. to account for this problem, a minimum read count value can be used to filter out reads detected below the cutoff . in addition, after known mirnas detection , we included statistical approaches to evaluate the cumulative distribution function, such as quartile or percentile values that are computed considering the whole reads-counts to exclude from the list of expressed mirnas in a given sample those showing read count below that value. this approach can be used also with any sncrna libraries. the other statistical approach implemented in imir addresses a common problem encountered when calculating fold-change values  for rnas present in the samples at very low levels. considering a fold-change threshold of ± <dig>  and p-value < <dig> , when read counts for a given sncrna are very low this setting can generate biologically irrelevant results. for example, considering a case where  <dig> tags are assigned to a given rna in the test sample and  <dig> in the control, both derived for large cell populations, the resulting fold-change  may be statistically significant but of doubtful biological relevance  <cit> , contrary to what occurs for sncrnas showing in the same conditions high read counts. to overcome this problem, we included in imir the possibility to add in such cases a correction factor. this, computed automatically by the tool as the median of the read count distribution relative to the sncrna datasets of interest, can be added to the actual read counts of all entries in the datasets. in the case described above, considering a calculated correction factor of  <dig> the fold-change value calculated for such low-expressed sncrna will be  <dig> , and thus below the threshold set, while for an rna of the same dataset that shows  <dig>  read counts in the sample and  <dig>  in the control this adjustment will be irrelevant . of note, the user can either disregard this function or use at will an alternative value for this parameter, calculated by any other means desired. these approaches are useful to reduce the number of false-positives detected by differential expression analysis, as these most likely occur among rnas expressed at a very low level.

identification and analysis of differentially expressed sncrnas using digital data is implemented in imir with two different methods . the first one, based on the deseq bioconductor package  <cit> , is particularly suited when biological or technical replicates are available  <cit> . the second, based on quantile normalization and fisher’s exact test to assess the statistical relevance, is specially designed for use when no replicates are available  <cit> . the last imir module  is designed to perform mrna targets prediction of expressed, or differentially expressed, mirnas. mrna targets are predicted by using miranda  <cit> , that includes current knowledge on target rules and uses a compendium of mammalian mirnas, and targetscan  <cit> , that computes mrna targets by searching for the presence of 8mer and 7mer sites matching the seed region of each mirna. imir includes in its databases different sncrnas, such as mirnas, pirnas, trnas, mrnas and data from rfam for human, rat and mouse . performance of imir was compared with that of the individual bioinformatics tools considered by williamson et al.  <cit> , selected on the basis of their popularity highlighted by number of citations in the literature. furthermore, the number of known  and of novel  mirnas detected and the time required to carry to completion the whole analytical flow were evaluated on multiple datasets generated in our laboratory and available from public data repositories and then taken as indicators of imir performance. the results obtained are in line with what previously reported  <cit> , suggesting reliability of this new tool.

RESULTS
as an example of the performance of the imir pipeline, the tool was applied to analyze patterns of sncrna expression and changes in human breast cancer mcf- <dig> cells maintained in two different culture conditions affecting cell cycle progression, e.g. growth-arrest and exponential growth  <cit>  . for each experimental condition, three sequencing replicates were analyzed to gather a correct estimation also of the technical variability occurring during differential expression analyses. a comprehensive smallrna-seq data analysis was performed running all imir functions with default parameters and the performances of the tool are summarized in figure  <dig>  to detect classes of sncrnas other than mirnas, the raw reads not mapping to known mature mirnas were aligned against trna and mrna sequences from ucsc genome browser, rrna and pirna sequences from nucleotide ncbi database and other sncrna sequences from rfam  <cit>  . one of the main advantages when applying this procedure is the possibility to reduce false-positive rate in novel mirnas prediction, while at the same time allowing to search for and analyze other classes of sncrnas in the datasets. for each sncrna library sequenced, ~ <dig>  m raw reads/sample for exponentially growing and ~ <dig>  m reads/sample for growth arrested cells were obtained . after the pre-process analysis, a small percentage of reads, all <15nt-long, is discarded as the algorithm is unable at present to manage them. the read-length distribution after adapter cleavage in all samples is reported to the right of module  <dig> in figure  <dig>  to show how the majority of reads obtained after this first step are ~22nt long, suggesting that they are mainly due to mirnas. this observation is further confirmed by the number of reads that actually match known mirnas , computed to account for more than 50% of the entire dataset in each case. the remaining reads, showing a length distribution between  <dig> and 31nt could include pirnas, while those 36nt-long could result from longer rna degradation products. the heatmap reported in figure  <dig> to the right of module  <dig> highlights the high degree of similarity of mirna profiles in the three replicates for each sample sequenced . a similar results was obtained for pirnas . after that, the imir module that computes differential expression analysis  was run. mirna analysis led to the identification of about 460– <dig> mirnas per sample , some of which differentially expressed. the pie-charts in figure  <dig> summarizes the results of mirna differential expression analysis performed with deseq  <cit> , expressed as percentage of detected rnas showing statistically significant differences in concentration between samples beyond a standard threshold  or not . these results, when compared with previously published data relative to mirna modulation in the same cell line  <cit> , confirm that imir is useful to rapidly and efficiently perform differential analysis for these sncrnas.

replicate 1
replicate 2
replicate 3
replicate 1
replicate 2
replicate 3
recently, an increasing number of studies highlighted the role of pirnas in breast cancer  <cit> . since the average length of these rnas is ~30nt , smallrna-seq represents an efficient analytical approach to assess also absolute and relative expression of these molecules. based on this assumption, we searched for and analyzed pirnas in the datasets selected to test imir performance. to reduce cross-mapping artifacts, reads corresponding to other rnas, in particular mirnas, trnas, rrnas and mrnas, were first filtered out with imir mapping them against the selected transcribed rna libraries. this allowed at once to start from a set of more reliable data and to gather information concerning other small rnas detected by sequencing . this analysis led to the identification of  <dig> and  <dig> pirnas expressed in growth-arrested and exponentially growing mcf- <dig> cells, respectively. differential pirna expression analysis and statistical significance testing performed with imir revealed  <dig> downregulated and  <dig> upregulated pirnas in growing cells, when compared to quiescent ones . we do not have a ready explanation for these relatively low numbers of pirnas identified in breast cancer cells, except for the fact that pirnas know to date have been identified in germ cells  <cit>  and it is thus possible that the majority of them is expressed only in these cell types. furthermore, most pirnas identified so far associate with the pirna biogenesis factor piwil <dig>   <cit> , that is not detectable in mcf- <dig> cells, where only piwil  <dig>  and piwil <dig>  are detected . as new validated pirna datasets will become available, for example those identified by association to piwil  <dig> and  <dig>  the possibility built into imir to customize its database will allow to include these in the analysis. the decision to focus here on individual pirnas instead of considering their genomic organization in clusters is based on the observation that in somatic cells pirnas deriving from a given cluster show different levels of steady-state expression, possibly due to a specific mechanism of precursor rna maturation active in these cells or to differences in their half-life. in addition, recent results suggest that individual pirnas could play important roles in tumor cells  <cit> .

we then tested another function of imir by performing differential mirnas expression analysis in two different ways:  starting directly from the number of raw read-counts obtained with miranalyzer  <cit>  or  by adding to each of these counts a correction factor , computed as the median of the whole read dataset . once compared, the results obtained with the two approaches showed slight but substantial differences, since ~10% of the mirnas identified with the first method  were excluded by the second one . this is explained by the fact that the rnas expressed at a very low level under both experimental conditions, and thus of uncertain biological significance, were filtered out when using this correction. imir offers the possibility to choose this method, when needed, also to other classes of sncrnas.

with respect to the possibility to perform target prediction for selected mirnas using miranda and targetscan databases, another useful function of the tool, it is worth mentioning the possibility for the user to update when required these and the other databases associated to the pipeline, such as those of mirnas from mirbase,  <cit> , of other sncrnas from different sources and of mrna targets from targetscan  <cit>  and miranda  <cit> .

CONCLUSIONS
we designed, built and describe here imir, a pipeline that integrates multiple open source modules/resources and implements statistical approaches, combined in an automated flow for high-throughput smallrna-seq data analysis. imir is rapid, accurate and efficient, allowing to examine multiple samples at once and thereby addressing a critical factor for high-throughtput analysis of sncrna sequencing data, represented by the need for continuous interventions by an operator skilled in informatics and programming. the graphical user interface of imir, allows a simplified use of the many tools integrated in the pipeline and to customize data analysis according to different needs. in addition, the implementation of different statistical approaches provides the possibility to analyze data according to standard, widely used, as well as to specific needs. finally, imir works on linux and mac operative systems, user-friendly for biologists with limited skills in informatics. in the future, following the evolution of ngs technologies and recommendations by the scientific community, we plan to keep improving imir features, including for example tools for sequence variants detection, evolutionary sncrnas analysis across multiple species and adding specific functions for analysis of emerging classes of small rnas .

availability and requirements
project name: imir.

project home page:http://www.labmedmolge.unisa.it/inglese/research/imir.

operating system: unix/linux based.

other requirements: python, java, perl, r, deseq, bowtie, vienna rna secondary structure package.

license: gnu gpl v <dig> 

any restrictions to use by non-academics: specified by gnu gpl v <dig> 

abbreviations
sncrna: small non-coding rna; mirna: microrna; ngs: next generation sequencing.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
gg and mrdf lead in the conception and design of the software, performed the statistical analyses and coordinated manuscript drafting and revision. ar participated in conception and development of the software. ah and fr contributed to software conception and design and to manuscript drafting. gn, mr and rt carried out smallrna-seq analyses, manuscript drafting and contributed to software conception. aw coordinated the project, participated in conception of the software and participated in drafting and finalization of the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
user manual.

click here for file

 additional file 2: table s1
summary of annotated small non-coding rnas included in imir database.

click here for file

 additional file 3
additional materials and methods and additional figure legend.

click here for file

 additional file 4: table s2
list of mirnas differentially expressed in exponentially growing vs growth-arrested mcf- <dig> human breast cancer cells .

click here for file

 acknowledgements
work supported by: italian ministry for education, university and research , italian association for cancer research , fondazione umberto veronesi’ , eu seqahead cost action , cnr epigen flagship project , university of salerno . gn is supported by a ‘mario e valeria rindi’ fellowship of the italian foundation for cancer research, mr is supported by a ‘vladimir ashkenazy’ fellowship of italian association for cancer research, fr is supported by a “young investigator programme” fellowship of the fondazione ‘umberto veronesi’, university of napoli ‘federico ii’ and ah is a phd student in “experimental physiopathology and neurosciences”, second university of napoli.
