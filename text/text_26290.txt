BACKGROUND
comparative analysis of multiple genomes has become a very important research method as more genome sequences become available. biological pathway analysis is also typically performed in comparison with multiple genomes of choice, using a number of computational tools and databases. a biological pathway involves a number of enzymes and its substrates and products. in addition, pathways interact with each other. thus comparative analysis of pathways is quite complicated and can hardly be done without well designed pathway analysis software systems. a number of automated pathway comparison systems have been developed: the seed  <cit> , pathway tools  <cit> , kaas   <cit> , kobas   <cit> , path-a   <cit> , tigr comprehensive microbial resources  <cit> , and jgi integrated microbial genomes  <cit> .

the seed provides a web-based comparative genome annotation environment based on 'subsystems.' subsystems are a set of functional roles found in any common biological process including metabolic pathways, phenotypes, or multi-subunit complex structures. subsystems in multiple genomes are conveniently represented in a table format: functional roles  are represented in columns, genomes represented in rows, and cells are populated with the genes having corresponding function. a populated subsystem in the table specifies which genomes include gene variants of the subsystem. this populated subsystem approach is an intuitive way to visualize pathway components of multiple genomes. detection of subsystems in a large number of genomes is not trivial, thus a computational method is developed to detect subsystems automatically  <cit> .

pathway tools uses the pathologic algorithm to determine enzymatic reactions catalyzed by each gene product in a query genome and then match detected reaction list against all available pathways from a reference database. pathologic accepts sequences of a fully annotated genome from genbank  <cit>  and metacyc  <cit>  is used as a reference pathway database. pathologic uses the annotation information from genbank, as opposed to sequence similarity information used in other systems, and the ec assignment as evidence for the presence of each pathway in the reference database for the genome of interest. once the matching step is complete, pathologic infers a set of reactions expected to occur in the target genome and determines which of those pathways are likely to exist in the target genome.

kaas and kobas are systems to annotate input protein sequences with ko . kaas provides functional annotation of genes by blast comparisons, single best hit  and bidirectional best hits , against the manually curated kegg/genes database  <cit> . ko assignments to genes and predicted kegg pathways are generated as output. kobas provides statistical significance tests for predicted pathways. ko terms are assigned based either on sequence similarity to entries in kegg/genes or on cross-database links in kegg/genes when a list of sequence identifiers is available in the databases. after ko assignment, frequently occurring or statistically significantly enriched pathways of the query sequences are identified in comparison with the background model.

path-a  takes a set of query protein sequences from a genome and identifies which sequences are likely to exist in any of its supported model pathways using several sequence analysis techniques . the model pathway approach enables the pathway prediction algorithm to predict instances of a pathway with variations in pathway structure that were never observed in the training pathway set. path-a currently provides abstract models for  <dig> pathways, spanning  <dig> genome-specific pathway instances.

comprehensive microbial resources  at tigr allows users to access all bacterial genome sequences completed to date. cmr provides two types of annotation resources: primary annotation from the genome sequencing center and tigr annotation that is generated by an automated annotation process at tigr. the cmr pathway tool kit consists of three categories of pathway analysis tools: "genome properties" provides information on the characteristics of organisms derived from genomic data and literature sources; "genome properties detailed comparison" provides detailed step information for a set of genomes users select; and "kegg pathway display" highlights kegg's pathway steps based on the presence or absence of ec evidence in the cmr.

integrated microbial genomes  at jgi provides comparative analysis of microbial genomes in an integrated genome context. the data model underlying the img system incorporates primary genomic sequence information, computationally predicted and curated gene models, pre-computed sequence similarity data, functional annotation, and pathway information. microbial genome data analysis in img is performed in the comparative context of multiple microbial genomes where a number of tools can be used to compare genomes in terms of organism-specific statistics, genes and sequence conservation.

since pathway analysis is quite complicated involving a number of tools and databases, no single system is better than others. users should choose a system that fits to their research interests. in this paper, we introduce a new web-based comparative pathway workbench system, compath, where users can conveniently perform various analyses for common biological pathways among multiple genomes of their choice. table  <dig> provides comparison of compath and five existing systems. below we emphasize following features of our system in comparison with existing systems.

▪ easy-to-use interface: compath provides an easy-to-use, interactive pathway analysis and annotation environment/workbench by integrating multiple data sources and analysis tools into a single framework. compath represents biological pathways on a spreadsheet-style interface as the seed system does, but our spreadsheet is designed to be more interactive so that users can directly perform sequence, motif, and context analyses on this spreadsheet.

▪ flexible pathway assignment: compath provides a total of  <dig> model pathways combining both kegg and the seed:  <dig> pathways from kegg database and  <dig> subsystems from the seed.

▪ sequence/motif analysis-oriented: compath uses structural domain and context information for pathway reconstruction, in addition to sequence homology information.

▪ prediction and evaluation: compath, kaas and kobas allow annotation of a whole genome in the pathway context. compath provides a suite of computational methods that can be used to verify predicted pathway components using sequence/motif/phylogeny analysis tools while kaas and kobas allow use of standard sequence alignment method  only.

▪ genome context analysis: compath provides tools for gene cluster detection and visualization based on sequence similarity and position information.

▪ pathway context analysis: users can explore enzyme relationships in terms of global pathway networks of ec, go , and rxid , not just in terms of predefined pathways such as those in kegg. this allows users to explore relationships among different predefined pathways with respect to an enzyme of choice.

implementation
system overview
the compath system architecture is described in figure  <dig>  compath uses the kegg database suite as a primary data resource: pathway, genes, ligand, and brite, for pathways, sequences, compounds/reactions and functional classification, respectively. in addition, sequence, structure, and domain databases are integrated into the system. motif and structural domain information are retrieved from pfam  <cit> , prosite  <cit> , scop  <cit> , scopec  <cit> , superfamily  <cit> , and pdb database  <cit> . scopec is used to map ec classification to structural domain information from scop. full-length sequence information comes from swiss-prot and kegg/genes database. mapping information of go to ec, pfam, and prosite are downloaded from the gene ontology site  <cit> . all these databases are internally integrated and url links to cdd  <cit> , genbank  <cit> , and uniprot  <cit>  are provided on an interactive spreadsheet. in addition, a number of computational tools are integrated with data resources in a single unified framework.

upon selection of a biological pathway and a set of genomes, users can perform the following tasks using the interactive enzyme-genome spreadsheet:

 <dig>  enzyme sequences with the same ec category can be compared using various sequence- and structure-based computational tools.

 <dig>  candidates for missing enzymes in particular genomes can be predicted and they can be further verified using computational tools. in this way, pathway holes may be filled in.

 <dig>  un-annotated genomes can be easily compared against enzyme sequences in already well-annotated genomes in terms of a pathway of choice.

detailed description of each step can be found in "the workflow" section. below, we summarize important features of compath.

feature 1: interactive spreadsheet for pathway data manipulation and analysis 
users interact with the compath system using a spreadsheet style interface called "table data type"  <cit> . unlike many other systems, users are able to perform various sequence and network analyses on the web simply by manipulating the interactive spreadsheet . computational analysis functions are grouped into five categories, denoted by buttons on the web:  "enzyme prediction" for predicting de novo enzymes,  "enzyme analysis" for comparing/verifying enzyme predictions,  "genome context" for searching and visualizing genomic context of a selected enzyme  "pathway context" for visualizing network context of enzymes, reactions, and go terms and  "annotation" for automatically annotating genes in a newly uploaded genome in terms of kegg pathways. users can either download the current spreadsheet  into a local computer or store it into a mysql server at any time by clicking "table download" or "my account" buttons. tables that are stored or downloaded can be uploaded to the server anytime to resume pathway analysis. each function will be explained in "workflow" section in detail.

feature 2: use of multiple enzyme prediction methods 
one major goal of compath is to provide biologists with an exploratory computational environment/workbench to search for missing enzymes involved in a given biological pathway. to fill in pathway-holes, biologists can use sophisticated analysis methods in addition to standard sequence similarity methods such as blast  <cit>  and fasta  <cit> . sequence similarity-based comparison methods  generally work well, but they may detect many false positives and often fail to determine functions for many genes. as a result, 20–60% of the proteins in most sequenced genomes still remain as "hypothetical"  <cit> .

to handle this problem, it is necessary to use computational tools other than sequence similarity-based methods. compath provides motif- and structural-domain-based search tools in addition to standard similarity-based gene search. enzyme search methods used in compath are  whole-hmm search,  csr-hmm search, a novel method of our own,  pdb-domain search, and  fasta search. the whole-hmm method builds a profile hmm model using "whole" enzyme sequences that belong to the same ec group and searches query genomes with the hmm model. in contrast, the csr-hmm method uses "common shared region" that is automatically computed by the bag clustering algorithm  <cit>  to build profile hmm models. the pdb-domain search method first searches scopec database to retrieve scop-to-ec mapping information. scopec is a database of catalytic domains that combines structural domain information from scop, full-length sequence information from swissprot, and verified functional information from the enzyme classification  database. once scop ids are collected, the second step is searching astral scop domain sequence database  or superfamily sequences . superfamily sequences are those with longer than  <dig> residues  and shorter sequences that are parts of other sequences are removed when filtering on sequence identity. if multiple sequences are collected, csr-hmm search is done against target genome. if only one sequence is retrieved, fasta search is performed instead. the fasta search with whole enzyme sequences is also available, but this is not recommended for enzyme search due to its low specificity; see "empirical evaluation of enzyme prediction methods" section.

users can evaluate predicted enzyme candidates . this step is necessary since predicted candidates are often false positives. for example, inspection on the existence of common cdd  <cit>  domains or prosite  <cit>  patterns of a given ec group can be used as an evidence to suspect enzyme candidates as false positives. this type of dynamic analysis can be performed easily in compath.

feature 3: physical context/gene neighborhoods analysis 
compath provides two tools for visualizing gene neighborhood: an in-house physical context viewer  and cgview for detecting and visualizing gene neighborhoods. the gene neighborhood, or physical context, is defined by setting a sequence similarity score cutoff for matching genes in different genomes and intergenic distance as a constraint. in a visualization of gene context using physical context viewer, genes are visualized with color scheme according to the ec category. only two genomes can be compared in the current implementation. in addition, users can use the cgview genome browser  <cit>  to navigate/visualize all enzymes in a genome and their positions. physical context analysis is currently available only for prokaryotic genomes.

feature 4: global pathway context/network neighborhood analysis 
the kegg pathway map that we are utilizing in compath is a useful and convenient dissect of complex biological networks. however, there are two limitations in the pathway representation. first, each kegg pathway is a union of all enzymes from all species participating in a given pathway theme  rather than "pathway" in a specific genome. because of this, many reactions are often not coupled or connected in kegg maps of a given genome. in addition, each kegg pathway map is only a subset of global pathway network where numerous cross-talks among sub-networks exist. when the relationship is visualized, we can observe genes involved in the same functional theme are grouped as a module in a network of genes  <cit> . in general, these modules are not consistent with pre-defined pathways maps  and enzymes are often involved in more than one pathway.

the table-type pathway representation in compath that is based on kegg map is not very effective in showing pathway interactions in the global network. thus compath dynamically generates a genome-specific directed/undirected graph of a given biological network by parsing kegg/kgml database that provides catalytic reaction information including substrate, product, reaction id, and directionality  of a enzyme reaction. the original representation of a given catalytic network in kegg/kgml is a "directed metabolite graph." its nodes are metabolites and edges are reaction ids . starting from this metabolite graph, compath creates rx graph, ec graph, and go graph, where nodes are reaction ids, ec numbers, and go terms, respectively. the conversion from the metabolite graph to the rx graph is the same as described in a recent paper  <cit> . ec graph is generated based on the rx graph and rxid-ec relationship in kegg/ligand database and the go graph is derived from the ec graph by referring to ec2go database. due to the limitation of computational resources, compath visualizes only a sub-network of a given radius, a parameter the user can set a value to, from an enzyme which users are interested in. we recommend users to use pajek  <cit>  for detailed and faster global network analysis. compath generates pajek input files of directed/undirected graph. in the current implementation, this feature only focuses on metabolic networks, but will be expanded to other biological networks.

feature 5: genome annotation
compath can be used to automatically generate a tentative annotation of a whole genome in terms of model pathways. candidate enzymes in a new genome that are not in the kegg database are matched to enzymes in model pathways and a new table is created by filling entries corresponding to known enzymes in the model pathway context. in this way, the new table can help users understand how likely the pathway or subsystem exists in the new genome since known kegg pathways or subsystems in seed provide meaningful context for potential gene matches. users can use three different ways to define pathways and subsystems: kegg pathways, seed subsystems, and user-defined ec sets.

when an un-annotated or poorly annotated genome in fasta format is uploaded onto the interactive spreadsheet, compath performs automatic enzyme candidate searches using fasta or csr-hmm methods. once cells in the spreadsheet are populated with candidate enzymes, users can start to perform enzyme comparison analyses as described in the previous sections and the result can be used as evidence for gene function determination. users should carefully select reference genomes that are phylogenetically close to the genome being annotated. in the current web implementation, only one genome is accepted for genome annotation.

feature 6: data management
the table can be easily edited, updated, and reloaded. at any time of pathway analysis, the table can be saved into either a local computer by downloading it or the mysql data management server by clicking "my account" button. to use the mysql server, users need to register and get a user id and password. stored tables can be easily uploaded to the compath server and then the table at the time of the previous analysis can be re-generated by a single click on the web. in addition to the table, fasta-format protein sequences can be stored in the mysql database and retrieved later for annotation.

the workflow
step 1: ec-based pathway reconstruction 
first, users need to select a pathway  from the pre-defined kegg pathway list or subsystems in the seed and then select genomes from the genome taxonomy tree  from  <dig> prokaryotic and eukaryotic genomes in kegg. a union of ec categories that belong to a given biological pathway was pre-compiled from kegg database. users are recommended to select phylogenetically-close species for annotation purpose unless the goal is to trace the evolution of a metabolic pathway among relatively distantly-related genomes.

in case a new genome that is not among the genomes in kegg is uploaded, compath searches the genome for candidate enzyme matches against selected genomes and fills in entries in the table with matches found. this step is called "ec-based pathway reconstruction." detected genes are considered as candidates for pathway components. these candidates may need to be further verified . upon selection of a pathway and genomes, an interactive enzyme-genome spreadsheet, i.e. a table, is created on the web.

step 2: identification of missing enzyme candidates
users can perform the missing gene search as follows.  select an ec number, a genome, and query genes in the table based on bag clustering  or other prior knowledge,  select computational methods for enzyme search , and  select which candidate matches from the search result will be added to the table . figure 5i/j/k/l show prediction refinement step using gibbs motif sampler , bag clustering , and phylogenetic tree analysis .

although the ec system effectively describes biochemical functions for most of known enzymes, it has several problems. for example, a simple ec-based pathway reconstruction tends to miss true enzymes because the number of "hypothetical" proteins without ec assignment continues to increase. in addition, the ec system was developed before sequence and structural information of enzymes was available, so it is not designed to match catalytic function to enzyme structure in terms of family and superfamily of homologous proteins  <cit> . thus, decisions on the pathway reconstruction and enzyme prediction using selected query sequences should be often guided by experts. we found that bag clustering or other sequence classification methods  play an important role as shown in figure 5d and the following two cases.

case 1: multi-subunits of enzyme complex
the enzyme subunits of a multi-subunit complex require more careful handling because they are grouped into the same ec category but do not have sequence similarity between different subunits. for example, tryptophan synthase , catalyzing the last step in the biosynthesis of tryptophan, needs two separate subunits  to perform the catalytic function. each of the two subunits exists as separate genes in bacteria and plants . the alpha chain is for the aldol cleavage of indoleglycerol phosphate to indole and glyceraldehyde 3-phosphate and the beta chain is for the synthesis of tryptophan from indole and serine. in figure  <dig>  initial pathway reconstruction only detects alpha subunits in shewanella frigidimarina and chromohalobacter salexigens and the bag clustering result shows that alpha subunits and beta subunits can be separated into two clusters. after csr-hmm search using beta subunit proteins as queries, two beta subunit proteins are detected . again, bag clustering shows that they are tryptophan synthase beta subunits.

case 2: isozymes
isozymes are enzymes with the same catalytic activity, but they are distant in terms of sequence similarity. for example, phosphofructokinase , existing as a homotetramer in bacteria and mammals, has two isozymes in escherichia coli and related species . pfkb is a minor phosphofructokinase which is not evolutionary related to the major isozyme . in figure  <dig>  shigella flexneri  <dig> has no phophofructokinase gene and bag clustering clearly divides class i and class ii isozymes. to detect two isozymes classes in shigella flexneri  <dig>  two sequential csr-hmm searches detect sfv_ <dig>  and sfv_ <dig> .

step 3: evaluation of enzyme classification
candidate enzymes predicted by sequence similarity often need to be examined further. compath provides several computational methods for further evaluation of candidate matches. phylogenetic tree analysis is probably the most powerful method that visualizes the relationship among candidates and known enzyme sequences. compath uses phylip package  <cit>  to generate a phylogenetic tree by using the neighbor-joining algorithm. the phylogenetic tree can be viewed by a web browser  or atv trees viewer program   <cit> . multiple sequence alignment is also available to users while generating the phylogenetic tree. bag sequence clustering program  <cit>  is used for both the enzyme match and refinement step. finally, gibbs motif sampler  <cit>  and igibbs  <cit> , our in-house motif detection algorithm, can be used to predict conserved regions and motifs in a set of enzyme sequences. motif information from cdd  <cit>  and prosite  <cit>  are also provided.

context-based sequence analysis techniques generally improve accuracy of gene function prediction made by using traditional sequence similarity-based search methods. the context involves a group of genes physically  or functionally  related to the gene being analyzed. in particular, there is growing evidence that evolutionary relationships of multiple genomes can be understood better when metabolic pathways and functional context can be enforced by detailed reconstruction of relevant metabolic or other cellular pathways  <cit> .

RESULTS
empirical evaluation of enzyme prediction methods
then, three well-annotated query genomes , vibrio cholerae o <dig> biovar eltor str. n <dig> chromosome ii , and yersinia pestis co <dig>  were selected as query genomes to test how correctly each search method detects metabolic pathway components  using the "enzyme profile" of reference genomes. sensitivity and specificity of each method were calculated after the enzyme profiles of each ec group were searched against these genomes.

if the ec number of a detected enzyme is the same as that of the enzyme profile, this enzyme was considered "true positive ". "false positive " was the case that the ec numbers of the enzyme profile and detected enzyme were different . if an enzyme has a correct ec identifier, but was not detected, this enzyme was considered "false negative ". finally an enzyme is considered "true negative   <cit>  if an enzyme was not detected and also has different  ec number from the enzyme profile. sensitivity ) and specificity ) were calculated and the results plotted using gnuplot  <dig> .

according to our experiment, fasta and csr-hmm searches outperformed whole-hmm and pdb-domain searches in terms of sensitivity, but fasta search showed poor performance in terms of specificity, detecting more false positive as e-value increases. overall, our csr-hmm search method performed best in terms of sensitivity and specificity.

CONCLUSIONS
we have developed a web-based comparative pathway analysis workbench for biologists or medical scientists. using the spreadsheet-style interface, users can freely compare pathways in multiple genomes, predict new enzyme candidates using various sequence analysis techniques including our own csr-hmm method, and refine the prediction result. in case a given pathway/subsystem is unique only to the query genome, comparative and pathway/subsystems-based genome annotation may not work. fortunately, pathways/subsystems are partially or fully conserved among close species in general, so pathway/subsystems-based genome annotation can take advantage of co-evolution, co-occurrence, and co-regulation relationship of pathway/subsystem component genes of query and reference genomes. once a 'model' pathway/subsystem can be correctly defined, it is relatively easy to reconstruct it in query genome by referring to reference genomes. it worth noting that 'model' pathway representation  is artificially defined. it is always possible that several alternative pathways or hidden hierarchical networks can be found when we see the whole network from many different viewpoints and this is why the global pathway network analysis is also required for pathway analysis. compath plans to include more resources and computational tools. among them are structure-function linkage database   <cit>  and prorule  <cit> . we will include more genome context search methods, including in-house tools such as mcgs  <cit>  and operonviz  <cit> . these tools will be useful to explore which enzymes in a pathway appear in a physically clustered form  <cit> .

availability and requirements
project home page: 

operating system: platform independent.

other requirements: mozilla-based web browser and java runtime environment  are recommended.

licence: compath is freely available to academic and non-academic users

any restrictions to use by non-academics: none

authors' contributions
kc and sk participated in system and database design and drafted the manuscript. kc prepared the figures and performed system comparison and evaluation test. all authors have read and approved the final manuscript.

