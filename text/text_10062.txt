BACKGROUND
the development of multicellular organisms is highly organized in a complex spatio-temporal manner that enables an enormous number of cells to form a single individual autonomously. these programmed processes seem miraculous, considering that they occur in an extremely reproducible manner that extends beyond individuals and generations. interestingly, certain patterns that are at least reminiscent of morphogenesis are known to be recapitulated in reaggregation cultures of dissociated cells from embryonic tissues. for example, embryonic cells dissociated from two different tissues will sort into two separate regions when cultured as a randomly mixed aggregate of cells. this rearrangement of the cells proceeds according to the cell's tissue origins and is reminiscent of the original embryonic structures  <cit> . that is, randomly mixed cells seem to reconstruct their original cellular arrangement in response to their surroundings. thus, cell-sorting may provide insights into the mechanism by which embryonic cells undergo self-organization.

to clarify which cell characteristics are important for the highly reproducible self-organization of cells into tissues, we focused here on a certain cell-sorting in a simple heterogeneous population of two cell types – namely, the accumulation of one cell type in the central region of a randomly mixed aggregate of two different embryonic cell types and the accumulation of the second cell type in the area surrounding the first cell type . the "inside and outside" pattern is important because this pattern reflects an original embryonic structure  <cit> .

for the process of cell-sorting within the aggregate, adhesion properties of cells are considered as an important factor. so far, two major hypotheses have been proposed: the "specific adhesion hypothesis " and the "differential adhesion hypothesis ". the sah explains cell-sorting using the concept of selective affinity of cell adhesion; in other words, cells of the same type gather by adhering to each other and, conversely, the population of a specific type of cells excludes different cell types by not adhering to them well  <cit> . this adhesive relationship predicts that homophilic adhesions of both cell types are stronger than heterophilic adhesions, as observed in many experiments  <cit> . however, the sah could not reasonably explain the "inside and outside" configuration of cell-sorting  <cit> .

the dah defines adhesion energy as a physical quantity and explains cell-sorting using a physical law involving the free energy minimum or adhesion energy maximum; that is, the most energetically stable structure is formed over time  <cit> . based on the dah, several theoretical models have been proposed. although the dah predicts the "inside and outside" pattern in a certain adhesive relationship , some models did not reproduce the "inside and outside" pattern  <cit>  and other models required additional assumptions, such as remote interactions among cells  <cit>  because of the existence of cellular configurations that had local maximums in the total adhesion energy. cell rearrangements were halted at a local maximum in the energy landscape.

remote cellular interactions are essential for certain types of cell-sorting. in the slime mold dictyostelium discoideum, excitable cells move in response to a diffusive chemoattractant camp emanated from pacemaker cells; that is, the pacemaker cells operate remote excitable cells via diffusive signals. cell-sorting in the slime mold d. discoideum has been vigorously studied. in model systems for the pattern formation in d. discoideum, not only cell-sorting but also collective cell movements have been successfully described in computational experiments  <cit>  and mathematical analysis  <cit> . on the other hand, remote cellular interactions during the process of cell-sorting within the randomly mixed aggregates of embryonic cells remains unknown. thus, we did not assume remote cellular interactions in this study.

the above models of cell-sorting for randomly mixed aggregates of embryonic cells were lattice models in which a cell occupies one lattice in a finite lattice space and moves by changing its position to a neighboring lattice. thus, the cell movements were discrete. glazer and graner  successfully reproduced the "inside and outside" configuration of cell-sorting by constructing a model in which cell movement was quasi-continuous  <cit> . models of cell-sorting with continuous cell movement have also been proposed  <cit> .

however, when the cellular events in developing tissues are observed in vivo, the involvement of other aspects of cellular behavior in pattern formation becomes apparent. during sea urchin gastrulation, for example, the primary mesenchymal cells migrate to prospective ventrolateral regions of the blastocoel and fuse into syncytial cables  <cit> . convergent extension is a cooperative cellular behavior that is necessary for archenteron invagination  <cit> . in addition to this cooperative behavior, secondary mesenchymal cells also assist during archenteron invagination  <cit> . in avian embryos, the trunk neural crest cells journey long distances to their final destinations via different pathways, depending on their region of origin in the neural crest, and differentiate into appropriate cell types at their final destinations  <cit> . in mammals, the cerebral cortex arises from the migration of huge numbers of neurons. these neurons form distinct cortical layers, depending on their birthdates  <cit> , and function in a layer-specific manner. these examples indicate that each cell behaves individually during development, receiving signals from its surroundings and varying its inner state according to those signals, thereby exerting an effect on its surroundings either individually or cooperatively or moving autonomously or en masse. in this manner, the cell finally arrives at its proper position and begins to function in an appropriate manner. such cellular behaviors are essential for development.

based on these observations and consideration, we constructed an in silico cell model with a flexible shape, directional motility, and sensitivity to parameters like autonomous cellular behaviors; we then used this model to examine what differences in cellular behavior parameters would lead to the reproducible generation of an "inside and outside" pattern of cell-sorting. in this manner, we successfully recapitulated the specific rearrangement of cells observed during "inside and outside" cell-sorting by inputting data reflecting a randomly mixed aggregate of two different cell types. the results of these computer simulations suggested that the directional movement of the cells and the cell's mobility were important for this specific rearrangement.

RESULTS
outline of in silico cell model
we explain our model briefly here and give a full and particular account of the model in methods section. our model is on two-dimensional hexagonal lattice space. each cell occupies multiple hexagons in the lattice space , with the number of hexagons occupied by a single cell representing the cell's size. for dynamic change in the cell's shape in response to its simulated surroundings, cell size is variable about its standard size that is set in a simulation. each cell contains one hexagon that the cell never loses; this hexagon represents the cell's "core position." that is regarded as the position at which a cell tries to remain in place at any given time point. this core position is used for modeling purpose only and does not represent a specific biological entity.

if a cell is smaller than the standard cell size, the cell attempts to occupy a hexagon nearest to its core position. if a cell is larger than the standard size, the cell abandons the hexagon furthest from its core position. iteration of these procedures makes a single cell in a free space round . when cells are put as a cluster, an expanding cell in the cluster causes positional conflict between its neighboring cell, and a contracting cell pulls its neighboring cell via cell adhesion . because of these spatial interactions, each cell is often distorted, and the core position of the cell is not always at its center. if the cell shape is far from round, the core position is shifted to an adjacent hexagon closer to the cell's center . this shift represents a cell being pushed away from its desired position.

in addition to the spatial mechanical interaction between cells, each cell receives signals from neighboring cells. here, we postulate the signals trigger autonomous directional cell movement. each cell has two states, in stay and in move, for cell movement. a cell in stay receives signals from neighboring cells . the signals from different cell types increase an inner state of the cell in stay, while those from the same cell type as the cell in question do not . if the inner state of the cell exceeds a threshold, the cell in stay becomes activated and then begins to move, changing its in stay-state into in move-state. the cell in move continues to move for short periods without receiving signals from neighboring cells. after the short periods, the cell in move ceases from moving and returns to in stay.

parameters regulating cellular behaviors
five parameters that regulate cell behaviors were defined in this cell model. we briefly explain these parameters here and give more details in methods section.  maximal distortion score means what extent each cell resist pressure by neighboring cells. if a cell has a large value of maximal distortion score, the cell resists mechanical conflict from neighboring cells.  activation threshold means insensitivity to signals from neighboring cells. if a cell has a small value of activation threshold, the cell is easily activated by the signals from different cell types, and start moving.  dragging time means period in which cell is in move-state after a single activation by signals from neighboring cells.  single moving distance means change in position in a single activation.  gap preference means orders of preferred penetrable gaps for cell movement. cell movement is possible only for penetrating a gap between neighboring cells. here, we consider three gaps as follows: gaps between 1) the same cell types, 2) the same cell type and different cell type, and 3) the same cell type and cavity . two different orders of preferred penetrable gaps are postulated. in the first situation , the preferred gaps are selected in the following order:  gaps between a cell of the same type as the cell in question and a cavity,  gaps between a cell of same cell type as the cell in question and a cell of a different cell type, and  gaps between two cells of the same cell type as the cell in question. in the second situation , the preferred gaps are selected in the following order:  gaps between a cell of the same cell type as the cell in question and a cavity,  gaps between two cells of the same cell type as the cell in question, and  gaps between a cell of the same cell type as the cell in question and a cell of a different cell type. when gaps with the same priority are present, a gap to be penetrated is randomly selected. it is to note that the above-mentioned idea of activation mechanism  and both the htr and hm gap preferences commonly include specific adhesion properties.

simulation results of cell sorting
the maximal distortion score was set at  <dig> . several parameter sets in which activation threshold, dragging time, single moving distance, and gap preference were varied were then explored. to classify the aggregation patterns, we defined two indexes: cell distribution ratio  and perimeter ratio. the definitions of them are described in methods section. the "inside and outside" patterns in the following results were determined using these two indexes.

in the first series of simulations, the two cell types were given different activation threshold values but dragging time, single moving distance and gap preference parameters were kept the same. under these conditions, the two cell types segregated from each other within the aggregates during each simulation, but the "inside and outside" configuration – where one cell type forms a central cluster and the other cell type surrounds that cluster – was not reproducibly generated . when the activation threshold and dragging time parameters were set at relatively small values for either cell type, the cell type in question moved extensively and its cluster tended to detach temporarily from the cluster of the other cell type, generating a huge inner cavity within the aggregate. once the cells reached their final configuration, the cell movements became relatively modest and the huge inner cavity tended to diminish and often vanished. the detachment of the two cell types from each other was inappropriate for the analysis of the cell-sorting mechanism that we wished to examine in this study. thus, we defined this type of process as a "separated sorting process"   and decided to exclude all cases with an ssp pattern from further quantitative analysis. to objectively determine whether ssp had occurred during a simulation, we measured the area of the inner cavity in the final configuration and set the threshold for the area of an inner cavity as  <dig> . as shown in table  <dig>  ssp was observed for several parameter combinations in this study.

fig. 2f:  or .
fig. 2g:  or .
fig. 2h:  or .
fig. 2i:  or .
fig. 2j:  or .
fig. 3c:  or .
fig. 3d:  or .
fig. 3f:  or .
fig. 3g:  or .
fig. 3h:  or .
fig. 3i:  or .
fig. 3j:  or .
fig. 4e:  or .
fig. 4f:  or .
fig. 4j:  or .
fig. 4k:  or .
fig. 4l:  or .
fig. 5g:  or .
* see methods for the criteria used to define of each pattern. ** parentheses show , n =  <dig>  the former parentheses are for the light cell type and the latter are for the dark cell type.

in our next series of simulations, the two cell types were given different dragging time values and the other parameters were kept the same. when gap preference of both cell types was set at htr, the "inside and outside" pattern of cell sorting was reproducibly attained using certain parameter sets ; however, an "inside and outside" configuration was not obtained when the gap preference of both cell types was set at hm . in the "inside and outside" configurations, the cell type with a shorter dragging time  always surrounded the cell type with a longer dragging time . when an activation threshold =  <dig>  was used, all the results contained ssps .

when the cells were given different single moving distance values and the other parameters were kept the same, "inside and outside" cell-sorting was attained using certain parameter sets in which both cell types had their gap preference set at htr . the cell type with a larger single moving distance  always surrounded the cell type with a shorter single moving distance . when a dragging time =  <dig> or a single moving distance =  <dig> was used, an ssp occurred .

although the hm preference did not seem to contribute to the "inside and outside" configuration under the above-mentioned conditions, "inside and outside" cell sorting occurred when one cell type had an hm preference and the other cell type had an htr preference . the cell type with the htr preference  was always located near the center of the aggregate and was surrounded by the cell type with the hm preference . when an activation threshold =  <dig>  and a dragging time ≤  <dig> were used, an ssp occurred .

discussion
in this study, we implemented several parameters to the cell model, but varied only one of the four parameters, activation threshold, dragging time, single moving distance, and gap preference, for each cell type in each simulation; all other parameters were kept the same for all cells in the simulation.

in our first series of simulations, the activation threshold parameter was varied . the parameter activation threshold reflects a threshold dividing the two distinct modes of cellular behavior, in stay and in move. recent fine quantifications of cell spreading and other motile activities have illustrated multiple phases of cellular behavior and thresholds for phase transitions  <cit> . therefore, our assumption of a threshold for cell-cell interactions is not inappropriate; although the thresholds for the phase transitions observed in these previous reports were also correlated with cell-matrix interactions.

when several parameter sets with different values of activation threshold for each cell type were examined, the "inside and outside" configuration of cell-sorting could not be reproduced. since the high/low levels of activation threshold reflect the low/high sensitivities to external signals, resulting in the low/high frequencies of the onset of cell movement, respectively, the frequency of the onset of cell movement may not be essential for the "inside and outside" configuration of cell-sorting. these results appeared to be inconsistent with previous findings that differences in the activation threshold caused the "inside and outside" configuration of cell-sorting  <cit> . in this previous study, however, a cell was regarded as occupying a single lattice on a hexagonal lattice space. when a cell became in move, the cell always had to change position with a neighboring cell. in other words, the cell movement was discrete, and the distance of one cell movement was equal to the diameter of the cell causing the opposite cell movement of the neighboring cell. on the other hand, the present model in this study simulates quasi-continuous cell movement, which resembles the cellular behaviors in vivo more than those in the previous model. thus, even when a cell became in move, the cell might not actually have been able to move, depending on its surroundings. although the primary cause of the discrepancies between these two studies remains unclear, the above-mentioned difference in the method of cell movement may have been a critical factor.

when the dragging time of the light cell type was ≤  <dig> and that of the dark cell type was equal to  <dig>  the "inside and outside" configuration of cell-sorting occurred when the activation threshold equaled to  <dig> , the single moving distance equaled to  <dig>  and the gap preference was htr . when this pattern of cell sorting occurred, the light cells with the shorter dragging time always surrounded a cluster of the dark cells with the longer dragging time. therefore, the cell type with the higher mobility "covered" the cell type with the lower mobility. in terms of molecular cell biology, the dragging time parameter might correspond to the time required to reconstruct the cell body at a new core position through, for example, remodeling of the actin cytoskeleton  <cit>  and the microtubule cytoskeleton  <cit>  in a coordinated manner  <cit>  and rear cytoskeletal contractility  <cit>  during cell migration.

when the single moving distance values of the light cell type and the dark cell type were set at  <dig> and  <dig>  respectively, the dark cells became localized near the center of the aggregate and the light cells surrounded the cluster of dark cells when the activation threshold equaled to  <dig> , the dragging time equaled to  <dig>  and the gap preference was htr . this result is consistent with the results of the simulations in which the dragging time parameter was varied , since single moving distance reflects the change in position of a cell during a single activation and thus should be negatively correlated with dragging time. indeed, the migration speed is known to be correlated with the retraction of the rear cell body in some cell types  <cit> .

dragging time and single moving distance exert direct influences on the way cells move, although activation threshold provides only opportunities for cell movement. thus, differences in mobility are important for the "inside and outside" configuration of cell-sorting, while differences in the frequency of the onset of cell movement may not be critically involved, as mentioned in the third paragraph of this section. therefore, the current model was capable of distinguishing the processes of cell migration more finely than our previous model  <cit> .

while the three parameters mentioned above are related to cellular motility, the fourth parameter – gap preference – determines the direction of cell movement  <cit> . when the light and dark cell types had htr and hm preferences, respectively, the "inside and outside" configuration of cell sorting was attained when activation threshold equaled to  <dig> , dragging time equaled to  <dig>  and single moving distance equaled to  <dig> . interestingly, the light cells became localized in the central region and the dark cells surrounded the cluster of the light cells.

these results suggest that 1) when two cell types with the htr preference have different mobility from each other, or 2) when one cell type has the hm preference and the other has the htr preference, the "inside and outside" pattern of cell sorting arises. cells with the htr preference move so that they push the different cell type away, keeping the contact with the same cell type. cells with the hm preference move so that they penetrate between the same cell types as themselves. within the aggregate, both cell types gathered compactly in a mutually exclusive manner. this cell "packing" reflects, as mentioned above, that both the htr and hm gap preferences commonly included specific adhesion properties.

although the "inside and outside" pattern is important, as it is reminiscent of the original embryonic structures, the sah model could not reasonably explain the "inside and outside" pattern as described in the background section  <cit> . this has been the major weakness of the sah model. our present model overcomes this weakness in the sah because it successfully recapitulated the "inside and outside" pattern based on the sah.

on the other hand, the dah model can also explain the "inside and outside" pattern. when one homophilic adhesive relationship  is strongest, the other homophilic adhesive relationship  is weakest, and a heterophilic adhesion  is intermediate, the dah predicts that these conditions are sufficient to generate the "inside and outside" configuration of cell-sorting  <cit> . although early versions of the dah model could not reproduce the "inside and outside" pattern, the glaizer's model, at last, reproduced the "inside and outside" pattern excellently based on the dah  <cit> . however, when both homophilic adhesions are stronger than the heterophilic adhesion, which corresponds to the "specific adhesive relationship", the dah model predicts that the "inside and outside" configuration of cell-sorting does not occur. in the above glazer's study , this "specific adhesive relationship" was not examined. thus, we reproduced their model , examined the final configurations of cell-sorting, and confirmed that the "inside and outside" configuration was not attained under the "specific adhesive relationship" with the dah model .

although our model illustrated that the "inside and outside" pattern of cell-sorting is generated under a specific adhesive relationship, vectorial cellular movement in response to a cell's surroundings is indispensable and reflects a part of the characteristics of specific adhesion. we assumed that practically all the cells in multicellular organisms utilize this autonomous cell motility for morphogenesis during development. morphogenesis is so dynamic that passive mechanisms such as static affinities and surface tension, are likely to be insufficient. autonomous cell movement is common in the modeling of the slime mold dictyostelium discoideum, since chemotaxis seen in d. discoideum is obvious as autonomous cell movement. in the theoretical study of d. discoideum, a diffusive signal is important and intercellular signaling is generally neglected. on the contrary, our model includes intercellular signaling and excludes diffusive signaling. thus, our model and the models of d. discoideum are complementary for the modeling of morphogenesis during development.

then, what molecular mechanisms could play an important role in the autonomous cell movement in our model? members of the cadherin family are well known as specific cell-cell adhesion molecules  <cit>  and may be the candidates supporting the cell behavior that was predicted in this study. cadherins are known to play important roles in various developmental processes  <cit> . one of the functions of cadherins is the control of cell motility  <cit> , which may be consistent with the findings obtained in this study. moreover, cells with different exogenous cadherin expression patterns undergo cell-sorting  <cit> . takeichi  proposed a mechanism of intercellular signaling via the activity of cadherins during morphogenesis  <cit> . niessen and gumbiner  showed that neither the static affinities of the extracellular domains of cadherins nor the adhesion of cells expressing one type of cadherin to sheets of extracellular domains of each cadherin determined cadherin-mediated cell sorting. rather, the interactions between cells expressing each type of cadherin were important for the cell sorting  <cit> . recently, several studies have shown that cadherin-mediated cell adhesion regulates actin assembly  <cit>  and microtubule assembly  <cit>  via rho family molecules, which are major small gtpases important for cytoskeletal dynamics  <cit> . conversely, the rho family regulates cadherin-mediated cell adhesion  <cit> . iqgap <dig>  an effector of the rho family, mediates rho gtpases' regulation of cadherin-mediated cell adhesion  <cit> . these findings suggest a dynamic feedback loop between cell-cell adhesion and the cytoskeletons through the activities of rho gtpases and their associated proteins, such as iqgap <dig>  moreover, p <dig> catenin, which associates with the cytoplasmic domain of cadherins, might play an important role in regulating cadherin flow at the cell surface via microtubules  <cit>  and endocytosis  <cit> . the endocytosis of cadherins is also regulated by rho gtpases through iqgap <dig>  <cit> , and p <dig> regulates the activity of the rho family  <cit> . taken together, these observations suggest that cadherin-mediated cell adhesion and cytoskeletal remodeling compose a dynamic regulatory circuit for cell migration upon cell-cell contact. this conjecture resembles the molecular mechanism of integrin-mediated cell migration that depends on cell-cell matrix contacts  <cit>  and may also fit our model. although the molecular and cellular bases of the htr and hm preferences will need to be clarified in the future to eventually explain the mechanism underlying the 'inside and outside' pattern of cell sorting, the sufficient conditions predicted in this study may give new insight into the process of cell sorting.

recently, constructing a comprehensive model of the intracellular dynamics using genome, proteome, and metabolome information is a trend in systems biology, because the high-throughput experiments enabled us to accumulate large amount of experimental data. since our model is described as motile cellular automata, their inner states can easily be superimposed with the intracellular dynamics models like e-cell <cit> . by combining our model with the comprehensive models of intracellular dynamics, the systems biology approach may be expanded into inter- and multi-cellular level.

CONCLUSIONS
this study suggests that the "inside and outside" configuration of cell-sorting can be successfully explained based on the concept of directional cell movement and the sah. in addition, our results strongly suggest that the cell type which would ultimately be located near the center of the aggregate might be determined by the manner of directional movement and the mobility assigned to each cell type. these results can bridge findings at molecular or cellular level and mechanisms of morphogenesis during development. since our model embodies various cellular behaviors that should be important for pattern formation, this model may also be applicable to other developmental processes beyond cell sorting.

