BACKGROUND
a normal human cell has  <dig> pairs of chromosomes. for each of the autosomal chromosomes , there are two copies of homologous chromosomes inherited respectively from the father and mother of an individual. however, in a tumor cell, the copy number may be different from two at certain chromosomal regions due to deletion and amplification events. loss of the contribution of one parent in selected chromosome regions can also happen due to hemizygous deletion or mitotic gene conversion . when such alterations affect tumor-suppressor genes  or oncogenes and confer growth advantage to cells, they will be selected in descendant cells and contribute to cancer formation  <cit> . identifying such abnormal copy number and loh regions in tumor samples may thus help to identify cancer-related genes and provide clues about cancer initiation or growth  <cit> .

single nucleotide polymorphisms  are the most common genetic variations in the human genome. oligonucleotide snp microarrays have been developed for high-throughput genotyping of up to  <dig>  human snps  <cit> . they contain probe sequences complementary to the dna sequences surrounding the interrogated snps. the genomic dna is amplified, fragmented and labeled, and then hybridized to a snp array. the scanned array images are analyzed to obtain the genotype calls of all the interrogated snps at a high accuracy   <cit> . compared with other experimental techniques, snp arrays have high throughput and high marker resolution, and they require small amount of dna per sample . they have been utilized in linkage and association studies to identify disease genes  <cit>  and in genomics studies to identify loh and copy number alterations in cancer samples and copy number variation in normal samples  <cit> .

the initial methods for analyzing cancer samples using snp arrays perform copy number and loh analysis separately  <cit> , so each analysis yields genomic alteration information that another analysis may not provide. recently, allele-specific and parent-specific copy numbers have been developed to utilize allele-specific signals obtained from snp arrays  <cit> . allele-specific copy numbers  can be estimated from allelic signals at heterozygous snps. however, a pair of copy numbers is not straightforward to summarize across multiple samples into a single statistic indicating the excess of genomic alterations. in addition, hidden markov models  that can successfully smooth total copy number or loh do not work as efficiently on allele-specific copy numbers due to large number of ascn states for a pair of copy numbers. in this paper, we defined major copy proportion as a quantity that contains the information difference between the total copy number and ascn at a locus, and used a hmm algorithm to estimate it from allelic signals. we used  <dig> k,  <dig> k and  <dig> k snp datasets to demonstrate the method performance and compare it to loh and copy number analysis.

RESULTS
definition of major copy proportion
the major copy proportion  of a snp is defined as c2/, where c <dig> and c <dig> are the parental copy numbers at this snp in a sample and c <dig> ≤ c <dig>  the value of mcp is between  <dig>  and  <dig> by definition, with various values corresponding to different relative proportions of parental copy numbers. the mcp is  <dig>  for normal loci or balanced copy alterations,  <dig> for loh, and a value between  <dig>  and  <dig> for allelic imbalanced copy number alterations. mcp therefore quantifies allelic imbalance and is a natural extension of loh analysis. mcp and total copy number  together provide the same amount of information as allele-specific copy numbers, while each of them is a scalar quantity that can be more efficiently estimated and conveniently used in downstream analysis.

we describe here two examples that can benefit from estimating mcp values. first, normal sample contamination in tumors often leads to conservative "no call" genotypes and intervening loh or retention calls . mcp can better quantify the proportion of normal sample contamination while still identify allelic-imbalanced regions due to loh. second, tumors with hyperploidy often contain allelic-imbalanced regions with both parental alleles kept. if the total copy number in such regions is close to the cell ploidy, copy number analysis will reveal a normal relative copy and loh analysis will show retention. however ascn or mcp analysis can discover allelic-imbalance as genomic alteration in such regions.

hidden markov model for estimating mcp
snp-based loh or copy number data along a chromosome are locally correlated and hmm is an effective analytic method for such data structure. hmms have been utilized to analyze array-based copy number changes  <cit>  and to infer loh from unpaired tumor samples  <cit> . here we used a similar hmm for the mcp inference.

the normalized probe intensity values  were used to compute allele-specific snp signals and raw copy numbers . we then used hmm to model the mcp correlation of neighboring snps on a chromosome. the mcp values to be inferred are between the range of  <dig>  to  <dig> and have  <dig> states under the default increasing step of  <dig>  . the observed data is the raw allele a proportion , defined as ra/, where ra and rb are the raw allelic copy numbers of the two genotype alleles  at a snp. for a heterozygous snp in a sample, rap should vary by a certain noise level around the unobserved mcp  or  <dig> – mcp ; for a homozygous snp, rap is close to  <dig> for genotype aa and close to  <dig> for genotype bb, since one of ra and rb is close to  <dig>  these considerations motivate the function form of the hmm emission distribution .

the hmm with emission and transition distributions specify the joint probability of the unobserved mcp and the observed rap of all snps in a chromosome of a sample. the viterbi algorithm  <cit>  was then used to obtain the most probable mcp state path as the inferred mcp values. the procedure was run separately for all chromosomes and all samples in a dataset.

datasets used
we used several snp array datasets to illustrate the analysis and visualization methods and to compare the results.   <dig> k snp dataset. zhao et al.  <cit>  generated early access  <dig> k snp array data for  <dig> breast and lung carcinoma cell lines and their paired normal cell lines, as well as  <dig> primary lung carcinomas and their paired normals. the array contains  <dig>  snps with an average resolution of  <dig> kb. this work is one of the first demonstrations of combined copy number and loh analysis using snp arrays.   <dig> k snp dataset. zhao et al.  <cit>  generated  <dig> k snp array data for  <dig> primary human lung carcinoma specimens and  <dig> cell lines derived from human lung carcinomas.  <dig> unpaired normal samples were used as reference in copy number analysis. the array contains  <dig>  snp with an average resolution of  <dig> kb. laframboise et al.  <cit>  further analyzed this dataset to develop allele-specific copy number analysis and generated allele-specific quantitative pcr  measurements for selected loci to compare allele-specific copy numbers from q-pcr and snp arrays.   <dig> k cell line dataset. affymetrix has made freely available a  <dig> k  snp dataset consisting of  <dig> tumor/normal pairs derived from breast and lung cancer cell line  <cit> . the average marker resolution is  <dig>  kb and 85% of the human genome is within  <dig> kb of a snp. in this work we used the subset of the  <dig> k sty array data.   <dig> k lung tumor dataset. weir et al.  <cit>  generated  <dig> k sty snp array data for  <dig> primary lung adenocarcinomas and  <dig> matched normal samples. we used a subset of  <dig> pairs of normal and tumor samples that are publicly available  <cit> .

visualizing mcp
the dchip software  <cit>  was used to implement the methods and visualize the analysis results. figure  <dig> compares the observed loh view in dchip with the new mcp view using the chromosome  <dig> of the  <dig> k snp dataset. in the mcp view , different shades of gray correspond to mcp values greater than  <dig> , highlighting allelic imbalanced regions. comparing to the raw loh calls on the left, mcp discovers more allelic-imbalanced regions that could cause excessive no calls  or intervening loh and retention calls  in genotype-based loh analysis.

in another example, we compared different snp data views of a lung cancer cell line with paired normal . the most interesting region in chromosome  <dig> is indicated by braces in figure  <dig>  the tumor sample contains many no call genotypes in this region , and the paired loh analysis yields intervening retention, loh and no calls . the raw copy numbers of this region center around ploidy or the relative copy number  <dig> . the raw major allele proportion curve in figure 3c reveals that most values are either close to  <dig>  or between  <dig>  and  <dig> . a likely explanation for these data is that this chromosome region has three copies and the whole genome is near triploid, which is confirmed by spectral karyotyping data  <cit> . two copies of this region are from one parent and one copy is from another, creating underlying mcp of two thirds , close to the inferred mcp value of  <dig>  . interestingly, the chromosome region below this region has retention of heterozygosity, a mcp of  <dig> , but copy numbers below ploidy . this region most likely has one copy of each parental chromosome, creating copy number decrease from ploidy while retaining the heterozygosity.

therefore, genotype-based loh analysis suggests the middle region in figure  <dig> to be unusual, but the mcp analysis helps to pinpoint the underlying cause of the abnormality. the mcp result also reveals that the heterozygous snps in this region have real genotype aab or abb. the standard genotyping algorithm are trained by normal samples  <cit> , thus making conservative no call or incorrect ab or aa/bb call for these complex genotypes and leading to intervening loh, retention or no calls in genotype-based loh analysis. combining mcp and total copy number, we can thus obtain a more complete understanding of the genomic structure of tumor samples.

comparing mcp and loh
we then used  <dig> pairs of normal and tumor samples in the  <dig> k dataset to compare the paired loh and mcp analysis.  <dig> of these pairs are normal and tumor cell line samples. snps were classified as loh or retention snps based on paired loh analysis  and then compared with their mcp values. figure 4a orders these tumor samples by their increasing sample-wise loh rates . in all the samples, more than 90% loh snps have mcp ≥  <dig>  ; in all but two samples, more than 80% loh snps have mcp ≥  <dig>  . the two samples  <dig> and  <dig> both have loh rate below 20% and most of their loh snps are in the intervening loh and retention regions . mcp values between  <dig>  and  <dig>  correctly identified these regions as allelic imbalance rather than loh. in fact, these two samples are primary tumor samples and could contain normal sample contamination  <cit> , which likely cause most loh areas in pure tumor cells to become allelic imbalance in the normal-contaminated tumor samples. in contrast to the loh snps, the retention snps seldom have mcp value ≥  <dig>  in all the samples , although in many samples more than 20% of the retention snps have mcp value ≥  <dig>  . these regions often have copy number alterations that cause allelic imbalance but not loh, leading to intervening retention and loh calls .

we also made similar comparison using the two  <dig> k datasets. figure 4b shows the same percentages as figure 4a for the  <dig> k cell line dataset of  <dig> sample pairs. all percentages have similar performance as the  <dig> k data. the percent of mcp ≥  <dig>  at paired loh calls  is low at the sample crl-2338d. inspecting the paired loh calls in this sample reveals that most loh in them are intervened with retention calls , indicating allelic-imbalance rather than loh. in contrast, the mcp analysis inferred smooth and moderate mcp values in this sample , better discovering the underlying genomic alterations. figure 4c shows the same comparison percentages for the  <dig> k lung primary tumor dataset of  <dig> sample pairs. all samples except one have paired loh call percentage below 20% . this can be due that the loh events are at a lower frequency in these primary tumors or that the homozygous genotypes in loh regions of tumor cells are masked by normal sample contamination up to 30%  <cit> . the portions of mcp ≥  <dig>  among paired loh or retention calls both drop as paired loh percentage drops , while the portions of mcp ≥  <dig>  among paired loh are near zero for all samples , supporting the existence of normal sample contamination in most samples.

in summary, mcp analysis is able to discover real loh and retention events. it also discriminates allelic-imbalanced regions from loh through intermediate mcp values between  <dig>  and  <dig>  instead of yielding intervening loh and retention calls.

comparing mcp and copy numbers
it is of interest in cancer research whether copy number gains or amplifications are allelic-balanced or imbalanced events, since the genes in the imbalanced events could have a variant or mutant form preferentially amplified  <cit> . snp arrays have the advantage of providing both allelic-imbalance and copy number information. we have previously used the  <dig> k dataset to show that the loh events can involve copy number deletion, copy-neutral or amplification events, while retention mostly occur at copy-neutral or amplification events  <cit> . with the inferred mcp as the extension of loh calls, we now ask how allelic imbalanced events correlate with copy numbers. a visual comparison of loh, mcp and copy number using the  <dig> k cell line dataset is in figure  <dig>  in the p-arm of sample crl-2324d, loh events correspond to both copy number amplifications and deletions.

we then stratified snps by copy number bins and computed the distribution of mcp values at various copy numbers. in the  <dig> k data  and the  <dig> k cell line data , the copy numbers below  <dig>  mostly correspond to mcp values ≥  <dig>  . as copy number increases, the percent of "mcp ≥  <dig> " decreases while the percent of "mcp ≤  <dig> "  increases, indicating that larger copy number gains or amplifications involve less frequently with loh and more frequently with allelic balanced and imbalanced events. in both  <dig> k and  <dig> k cell line data, there is a noticeable drop of allelic-balanced events  around copy number of  <dig>  the fact that  <dig> copies can have balanced amplifications is due to that the copy numbers from snp arrays are not absolute copy numbers but relative to the ploidy of tumor cells . similarly, there are snps with mcp values close to  <dig>  but copy number below  <dig>  since in hyper-diploid samples the real copy number  <dig> has array-based relative copy number below  <dig>  the peak at copy number  <dig>  in figure 6a is likely due to the small sample variation  or inaccurately inferred mcp values.

in contrast, different patterns emerge from the  <dig> k tumor dataset . the percent of "mcp ≥  <dig> " is nearly zero at all copy numbers, and the portion of allelic-balanced events has a single peak around copy number of  <dig> and drops rapidly as copy number goes lower or higher. these could be explained by potentially prevalent normal sample contamination in these primary tumors, which could cause the attenuation of aberrant copy number values toward the normal copy of  <dig>  as well as make the loh or allelic-imbalanced amplification events in tumor cells to appear less allelic-imbalanced in contaminated tumor, leading to high percent of mcp values between  <dig>  and  <dig> .

next we used the  <dig> k snp array dataset with allele-specific copy numbers measured by quantitative pcr  to compare the mcp based on snp arrays and q-pcr. we used the same snps to design the primers for q-pcr and to obtain their array-based signals for comparison. since q-pcr measures allele-specific copy numbers rather than parent-specific copy numbers, we defined major allele proportion  as max/ and used it in the comparison, where a and b are q-pcr or array-based allelic copy numbers. table  <dig> shows that most array-based mcp and the q-pcr-based map values agree within a difference of  <dig>  . the largest difference of  <dig>   occurs at snp  <dig> in sample s0515t. this snp has homozygous genotype in the sample , but its multiple neighboring snps have heterozygous genotypes and map values close to  <dig>  , which contributes to the final inference of mcp  <dig>  at the snp  <dig>  together with an amplified total copy number, we conclude that the dna at the snp is about equally amplified for both parental alleles.

both snp arrays and q-pcr yield allelic-specific copy numbers relative to sample ploidy. "array copy" is the array-based total copy number by median smoothing of raw copy numbers with a window size of  <dig> snps. the chromosome positions are based on the ucsc hg <dig> genome assembly.

mcp analysis of normal contaminated samples
we next checked how well mcp can address two challenges of applying snp arrays in cancer genomics: tumor samples frequently lack paired normal samples to perform paired loh or mcp analysis, and tumor tissue samples often contain normal stromal cell contamination. the hmm emission distributions can flexibly use either paired normal genotypes in paired mcp analysis or population-based normal genotype distribution in tumor-only analysis . we checked how well the mcp estimated using paired normal and tumor samples agree with the mcp estimated using only tumor samples. in the  <dig> k dataset, the sample-wise absolute mcp differences between the two methods in the  <dig> samples range from  <dig>  to  <dig> , and the sample-wise standard deviations of the mcp differences range from  <dig>  to  <dig> . in the  <dig> k lung tumor dataset, these two differences measures are larger across the  <dig> tumors, ranging from  <dig>  to  <dig>  and  <dig>  to  <dig>  respectively. visual inspection of the mcp inferred from the  <dig> k data reveals many small regions that have mcp value ≥  <dig>  in tumor-only analysis but have mcp value of  <dig>  in paired analysis. they are caused by stretches of homozygous genotypes that are in linkage disequilibrium, in a similar way as the false positives in tumor-only loh analysis  <cit> . by utilizing the genotype dependence of neighboring  <dig> snps in the hmm emission probabilities of tumor-only mcp analysis , the two differences measures are smaller . overall the differences between paired and tumor-only mcp inferences are fairly small compared to the values that mcp can take .

we next asked how much the tumor-only mcp method is tolerant to normal contamination. the  <dig> k dataset contains a mixing experiment of paired normal and tumor samples  <cit> . a tumor cell line  was mixed with its paired normal cell line  at various proportions and then hybridized to  <dig> k snp arrays. in figure  <dig>  sample hcc38m <dig> to hcc38m <dig> are mixture samples with tumor content of 90%, 80%, 70% and 60% respectively. the loh regions in the pure tumor sample should become allelic-imbalanced regions in the mixture samples. figure  <dig> shows a typical example of inferred loh and mcp data using unpaired analysis . compared to the loh data , mcp analysis better identified the boundaries of the allelic-imbalanced regions in all the mixture samples . the values of estimated mcp for the loh regions are less than  <dig> in the mixture samples , corresponding to allelic-imbalance created by normal sample contamination. interestingly, both loh and mcp analysis performs better for the bottom loh region than the top loh region in the mixture samples, due to copy-neutral loh in the bottom region and hemizygous deletion in the top region .

major and minor copy alleles
one feature of the mcp algorithm is that it also infers the major and minor copy alleles for snps that are heterozygous in normal sample and undergo loh or allele-imbalance in tumor . in figure 7b, a snp is colored in red or blue for major copy allele a or b if its major copy allele  can be inferred and is different from the minor copy allele, which is not displayed. in the paired mcp analysis , the mca is inferred to be different from minor copy allele for many snps since the normal sample contains information on heterozygous snps and loh in the tumor sample provides information on the kept allele as mca. in contrast, in the tumor-only mcp analysis , we can infer two regions of loh  as well as mca, but there is no information on minor copy allele, so no snp is colored. however, as normal contamination increases from sample hcc38m <dig> to hcc38m <dig>  the minor copy allele of more and more snps can be estimated from the mixing normal sample, so more snps are colored to indicate mca is different from minor copy allele . these results show that allelic-imbalances  can help to distinguish major and minor copy alleles, while loh or allelic-balanced events can not.

therefore in tumor-only mcp analysis, normal contamination at low percentage  can be turned beneficial through mcp analysis. the normal contaminated samples contain the information of both normal sample genotypes and tumor genome alterations . in the tumor-only mcp analysis, the normal genotype information is utilized in the form of allele-specific raw copy numbers in the hmm emission distributions . as the result, the allele-imbalanced regions are identified in a similar way to paired loh analysis via normal-tumor genotype comparison rather than tumor-only loh inference, which resorts to unrelated reference normal genotypes to distinguish between loh and homozygous haplotype blocks  <cit> . the normal contaminated samples also help to provide information on both major and minor copy allele at allelic-imbalanced regions, which can be useful in downstream analysis. if the contamination percentage can be estimated by other experimental measures, the inferred mcp or copy number from normal contaminated samples can be adjusted proportionally to obtain the mcp/loh and copy number values of the unavailable pure tumor samples. however, efforts should be made to obtain pure tumor samples and their paired normals for separate hybridization whenever possible, as paired mcp analysis can better recover allele-imbalance information than tumor-only mcp analysis of contaminated samples .

downstream analysis and related analysis methods
mcp is an extension of loh and contains complementary information to total copy numbers. similar to loh and copy number analysis of a set of tumor samples, a mcp summary score for each snp may be computed across samples, such as the average mcp value across all samples. then the chromosome regions can be permuted within samples, and the mcp scores computed from the permuted data can be compared to the original mcp scores to assess the significance of the latter  <cit> . a composite alteration score using both mcp and total copy number may also be used, such as the proportion of samples with copy >  <dig> and mcp >  <dig>  to capture only allelic imbalanced amplifications.

there are several allele-specific copy number  analysis methods for snp arrays  <cit> . while total copy number plus mcp provide the same amount of information as allele-specific copy numbers, mcp extends the loh analysis in a natural way and offers a univariate statistic to capture both loh and allele-imbalance events. such univariate quantity is more efficiently estimated and easily used in downstream analyses than a pair of allelic copy numbers. if needed, the total copy number and mcp can be combined to be equal to the analysis using allelic-specific copy numbers. the mcp analysis also reports major and minor copy alleles for allelic comparisons in allele-imbalanced regions. several of the above ascn methods also use probe sequence and restriction fragment length to adjust for probe signals to improve signal to noise ratios. such adjusted raw allelic copy numbers can be conveniently used as the input of the mcp analysis through the dchip software.

similar to all copy number analysis of snp arrays, ideally we need paired normal samples for mcp analysis. when such paired samples are not available and an independent set of normal samples are used for reference signals, copy number variations  in normal samples may confound tumor copy number analysis  <cit> . to address this issue, we have implemented a trimming method. specifically, we assumed that in reference normal samples, for any snp at most a certain percent  of the samples have abnormal copy numbers. then for each snp, 5% of samples with extreme signals are trimmed from the high and low end of the raw signal distribution and the rest samples are used to compute the signal mean and standard deviations of normal copy numbers at the snp. this trimming method is designed to accommodate a small amount of cnvs in reference normal samples and has proven useful in copy number analysis with unpaired or limited number of normal samples. the same trimming method can be used to obtain raw allele-specific copy numbers in the mcp analysis.

CONCLUSIONS
in this paper, we have focused on allelic imbalance analysis of tumor samples using snp arrays. we proposed to estimate major copy proportion, which is an extension of loh analysis and complements total copy number analysis. hmm is used to bridge unobserved states  and observed data  through emission and transition distributions. we compared the inferred mcp with loh and copy number analysis and demonstrated that mcp performs better than loh analysis in allelic-imbalanced regions and normal contaminated samples. the major and minor copy alleles can also be inferred at allelic-imbalanced regions by mcp analysis. the described analysis and visualization methods are readily available in the dchip software.

