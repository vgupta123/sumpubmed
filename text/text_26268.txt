BACKGROUND
expressed sequence tags are single strand reads of transcribed sequence generated from cdna clones  <cit> . est sequencing typically originates in the vector, and can include either 5'- or 3'-terminal sequence of the cdna clone. ests have historically provided data for gene discovery  <cit> , tissue- or stage-specific gene expression  <cit> , alternative splicing  <cit> , and alternative polyadenylation  <cit> .

while est-based gene discovery can be quite successful, the wide dynamic range of mrna abundance and the cost of est creation led to the development of procedures such as normalization and subtraction  <cit> , which increase the likelihood of sampling rare or tissue-specific transcripts, at the cost of lost quantitative relationships between different transcripts in a library. normalization and subtraction utilize a common mechanism, which can be briefly described as heat dehybridization of cdna, rapid re-hybridization in the presence of a 'driver' sample, extraction of the double-stranded portion of the sample, and finally sequencing of a sampling of the remaining single-stranded sequences. the rapid re-hybridization step favors duplex formation of abundant species, therefore the remaining single-stranded sample is enriched for rare transcripts. the difference between normalization and subtraction lies in the choice of driver sequences. in normalization, the drivers come from the same sample, whereas in subtraction, the driver comes from a separate sample .

since cdna clones are created from mrna sequences, the distribution of ests in a non-normalized library is presumably reflective of the population of mrna sequences in the originating tissue. audic and claverie  <cit>  demonstrated how non-normalized est libraries could be analyzed to generate "transcript profiles" or "digital northerns," and further developed rigorous statistical tests for significant variation between tissue or cell types. several methods have been subsequently developed to enable studies of cdna libraries to elucidate targets and mechanisms of tissue- and/or stage-specific gene expression  <cit> . bioinformatic tools, such as tissuelnfo  <cit> , bodymap  <cit>  and exquest  <cit>  utilize counts of ests in libraries for high-throughput identification of tissue expression profiles and specificity, in spite of the known limitations on their fidelity of representation of gene expression on the originating tissue  <cit> .

cdna library generation is dependent on several steps, including selection and preparation of tissue, rna purification, rna to cdna conversion, and cloning and transformation of the cdna  <cit> . procedures such as reverse transcription and selection of cdna clones for sequencing can introduce systematic biases in any quantitative analysis using cdna libraries. confounding matters further, the depth of annotation among est libraries is not uniform and often incomplete. it is worth noting that differences in transcript sampling between disparate laboratories and research groups are not unexpected, given the varied motivations and resources of the library creators.

we present here a method and means to identify and compensate for the biases in transcript sampling and enable quantitative comparisons between libraries. we analyzed and quantized over  <dig> mouse est libraries with at least  <dig> entries, estimating the length distributions of cdna inserts and their originating mrna transcripts through alignment to a reference set of transcripts.  the cdna insert length distribution provides information about the efficiency and/or goals of the reverse transcription reaction, while the transcript length distribution evaluates the variety of transcripts sampled in the library. our results show that the combined steps of reverse transcription and selection of clones  for sequencing can introduce significant biases into transcript sampling in est libraries, but that through identification and characterization of these biases, quantitative comparisons can be enabled. we identified the systematic biases as a part of a study of alternative 3'-processing in mouse spermatogenesis , and therefore present our analysis with examples related to 3'-processing. the biases we describe are equally applicable, however, to any quantitative comparative analysis between distinct est libraries, including assessment of tissue specificity of gene expression or processing.

RESULTS
comparative studies of est libraries, such as those to estimate tissue- or stage-specificity of expression, typically avoid the use of normalized or subtractive libraries. we find, however, that even non-normalized libraries are subject to systematic biases  that can distort quantitative studies. to quantify these biases, we aligned all ests from each library to a reference transcript set, and used the results to estimate the length distributions of the cdna inserts and sampled transcripts. a typical result is shown in figure  <dig>  a significant fraction of the libraries examined show the roughly lognormal distribution of both cdna insert and transcript lengths, as shown in figure  <dig>  comparison of the cdna insert and transcript length distributions for a given library can give insights into the goals or parameters of the library generation. similar distributions are indicative of an attempt to generate full length transcripts. a tight , short, distribution of cdna insert lengths indicates a fixed, relatively short reverse transcription reaction that results in cdna insert lengths essentially independent of the transcript length. . a tight distribution of cdna insert lengths longer than a few hundred nucleotides indicates a size selection step of either mrna or cdna sequences prior to sequencing.

we examined several groups of libraries generated from a common tissue sample  <cit> , described in table  <dig>  these specific libraries were generated in the nih brain molecular anatomy project   <cit> , the goal of which was generation of a large number of full-length transcripts from the mouse nervous system. together these libraries represent a broad sampling of mrna transcripts between  <dig> and  <dig> nucleotides in length, with different libraries putatively selected to contain a specific size range. figure  <dig> displays our estimates of the length distributions for the transcripts  and cdna inserts  for these libraries. as expected, the modes of the cdna insert and transcript length distributions correlate quite well with the targeted ranges of the est libraries. the attempt at creation of full-length transcripts in these libraries is apparent in comparison of the two panels in figure  <dig>  and also in the fourth column of table  <dig>  which shows the l-divergence measurement between cdna insert and transcript distributions for each library.

interestingly, for the libraries with the shorter targeted lengths , our analysis indicates that the majority of the cdna inserts and sampled transcripts come from the targeted range, however, as the targeted range increases, this specificity decreases, and a significant number of transcripts with length apparently outside the targeted range are found. this increasing discrepancy could arise from a number of effects. electrophoretic separation is imprecise, including imperfections in the gels used for size selection and anomalous migration times for specific transcripts. such unpredictable behavior will more significantly affect measurements of large molecules. large molecules are also comparatively more prone to breakage. our method for assignment of est to transcripts is also a likely source of some ambiguity, as it is designed to give a reasonable picture of the characteristics of the complete library, but is certainly not guaranteed to give exact results for any specific est or transcript.

mrna 3'-processing  and the corresponding specification of 3'-utr in eukaryotes play an important role for mrna localization, translational efficiency, and stability  <cit> . we use est-to-genome alignments to identify and characterize 3'-processing sites and 3'-utrs  <cit> . our studies of alternative 3'-processing during mouse spermatogenesis  indicated that the distribution of 3'-utr lengths can systematically change as a function of tissue type or growth conditions. our analysis of pacdb  <cit>  makes it clear that 3'-utr length is dependent on transcript length , therefore accurate characterization of these changes requires that we identify and compensate for the variation that arises due to differences in transcript sampling, as described above. as described in methods, we generate an expected distribution of 3'-utr lengths for any given library based on random sampling of  the transcript length distribution of the library, and  the distribution of 3'-utr lengths as a function of transcript length. in figure  <dig>  we compare the measured and expected median 3'-utr lengths  for two additional groups of est libraries, generated as size selected ranges from a common tissue in the brain molecular anatomy project  <cit> . the fx <dig> set, generated in a pool of brain tissues, includes libraries nih-bmap-fv <dig>  nih-bmap-fx <dig>  nih-bmap-fr <dig>  nih-bmap-fw <dig>  nih-bmap-fy <dig> and nih-bmap-gi <dig>  while the ha <dig> set, generated from eye tissues, consists of libraries nih-bmap-hc <dig>  nih-bmap-ha <dig>  nih-bmap-gz <dig>  nih-bmap-hd <dig>  nih-bmap-hb <dig> and nih-bmap-he <dig>  the agreement is quite good, with measured-expected correlations calculated at  <dig>  and  <dig>  for the fx <dig> and ha <dig> sets, respectively. interestingly, the difference between measured and expected 3'-utr lengths is greatest in library nih-bmap-gi <dig>  which represents the longest transcripts in the sample of pooled brain tissues. in preliminary studies, we have found  that brain tissues may, in fact, be subject to a selection for longer 3'-utr sequences.

from the analysis presented in figure  <dig>  we conclude that with care, quantitative comparisons between est libraries can be used for the identification of tissue- or stage-specific phenomena, however, systematic variations in transcript sampling must be controlled. we explicitly identify est libraries that can be safely compared without this bias by using the l-divergence  to compare the estimated transcript length distributions of all pairs of libraries. quantitative comparison can be made between pairs of est libraries whose divergence is less than an empirically determined threshold value. to facilitate such analyses by other investigators, we have made available our tools, data, and results on a web server  <cit> . included in this package is a tool that will take as input a single est library identifier and return a list of other libraries for which quantitative comparisons can safely be made.

while our examples have come from studies of mrna 3'-processing, the systematic issues we have identified can bias similar analyses of phenomena such as tissue-specific changes in either global transcription patterns of many genes or processing of a specific gene. as long as the measured quantity has a dependence on  the transcript size, the effects we describe here can result in a false positive identification of a statistically significant, but biologically meaningless change. as a simple example, consider a gene with a 5000-nucleotide long transcript. if the relative expression level for this gene was compared between two est libraries whose transcript size sampling resembled libraries nih-bmap-fa <dig> and nih-bmap-fo <dig>  respectively, we would expect a large discrepancy favoring the latter library, even if the true expression level in the two tissues was identical.

to further investigate the effect on measurement of gene expression, we examined the est libraries originally generated by okubo et al.  <cit>  and later used as examples by audic and claverie  <cit> . these libraries consist only of 3'-ests, so we can assess the sampled transcript length distribution but not the insert length distribution. briefly, these include three libraries, one generated from an hl <dig> human promyelocytic cell line, and two derived cell lines, a dmso-induced granulocytoid cell line and a tpa-induced monocytoid cell line. in both the original and subsequent analyses, a number of genes were identified as differentially expressed between the cell types. using the human refseq cdna collection  <cit>  as a reference, we generated transcript length distributions . intriguingly, the dmso-induced granulocytoid library appears to have sampled transcripts with a significantly longer length distribution than either of the other two libraries, which, in contrast, follow distributions quite similar to each other. our analysis indicates the possibility that a portion of the genes identified as differentially expressed are false positives. okubo et al. experimentally verified a number of genes as differentially expressed  <cit> , however their measurements were on double-stranded cdna saved at an intermediate stage of library construction. this brings up two distinct possibilities: either the list of differentially expressed genes includes a non-zero number of false positives due to differences in sampling of the transcripts during library construction, or the change in expression pattern upon dmso-induced differentiation includes a systematic shift to significantly longer transcripts. our analysis does not question the computational approaches of either the original  <cit>  or subsequent manuscript  <cit> , but rather the required assumption that the two originating samples are identical in preparation.

it is clear from our analysis that the common practice of computationally pooling est libraries from a common tissue type or developmental stage, while increasing the gene coverage, is not likely to accurately reproduce relative expression levels of the original tissue sample. to see this, consider that our results indicate that in nearly all unbiased samples, the underlying transcript length distribution follows a roughly lognormal distribution, similar to the pacdb transcript, in figure  <dig>  as we have shown, distinct est libraries will sample from this underlying distribution in a manner determined by preparation of the library. simply combining disparate samples together will almost certainly distort the relative contributions of the different size transcripts. for example, the three groups of brain map libraries shown in table  <dig> and figure  <dig> represent roughly equal size samples from six different size ranges of transcripts, which if pooled, would oversample long  transcripts at the expense of shorter ones.

CONCLUSIONS
est libraries contain a wealth of data regarding gene expression and specifics of transcript processing across a broad range of tissue- and cell-types and developmental stages. these data have been collected, however, by a wide range of researchers with varied procedures and goals, making large-scale comparative studies using these sequences problematic. the level of detail in the annotation regarding preparation techniques is not uniform, and in many cases incomplete . even in libraries prepared without the two best understood systematics, normalization and subtraction, we find systematic variations in the sampling of transcripts. we have shown that estimates of the cdna insert and originating transcript length distributions can be used to assess and compensate for systematics of library generation and enable quantitative analysis. our tools and analyses are available via a web server  <cit>  to help other researchers separate truly biologically meaningful changes in gene expression or processing from those that arise due to systematic biases.

