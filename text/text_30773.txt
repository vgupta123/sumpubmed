BACKGROUND
dna microarray analysis has emerged as a leading technology to enhance our understanding of gene regulation and function in cellular mechanism controls on a genomic scale. this technology has advanced to unravel the genetic machinery of biological rhythms by collecting massive gene-expression data in a time course. time-course gene expression data such as yeast cell cycle data  <cit>  appear to be periodically expressed. to associate the profile of gene expression with a physiological function of interest, it is crucial to cluster the types of gene expression on the basis of their periodic patterns. the identification of co-expressed genes also facilitates the prediction of response to treatment or toxic compounds  <cit> . statistical modelling and algorithms play a central role in cataloguing dynamic gene-expression profiles.

various computational models have been developed for gene clustering based on cross-sectional microarray data  <cit> . also, considerable attention has been paid to methodological derivations for detecting temporal patterns of gene expression in a time course based on functional principal component analysis or mixture model analysis  <cit> , including the applications to identify differentially expressed genes over time  <cit> .

finite mixture models  <cit>  have been widely used to model the distributions of a variety of random phenomena. multivariate normality is generally assumed for multivariate data of a continuous nature. the multivariate normal mixture model is employed to detect different patterns in gene-expression profiles. however, when the two assumptions that are commonly adopted in practice, namely, 

 there are no replications on any particular entity specifically identified as such and

 all the observations on the entities are independent of one another,

are violated, multivariate normal mixture models may not be adequate. for example, condition  will not hold for the clustering of gene profiles, since not all the genes are independently distributed, and condition  will generally not hold either as the gene profiles may be measured over time or on technical replicates. while this correlated structure can be incorporated into the normal mixture model by appropriate specification of the component-covariance matrices, it is difficult to fit the model under such specifications. for example, the m-step may not exist in closed form  <cit> .

accordingly, ng et al.  <cit>  have developed the procedure called emmix-wire  to handle the clustering of correlated data that may be replicated. they adopted a mixture of linear mixed models to specify the correlation structure between the variables and to allow for correlations among the observations. it also enables covariate information to be incorporated into the clustering process  <cit> . proceeding conditionally on the tissue-specific random effects as formulated in  <cit> , the e- and m-steps can be implemented in closed form. in particular, an approximation to the e-step by carrying out time-consuming monte carlo methods is not required. a probabilistic or an outright clustering of the genes into g components can be obtained, based on the estimated posterior probabilities of component membership given the profile vectors and the estimated tissue-specific random effects; see  <cit> .

fourier series approximations have been used to model periodic gene expression, leading to the detection of periodic signals in various organisms including yeast and human cells  <cit> . if the genes studied are periodically regulated, their time-dependent expression can be accurately approximated by a fourier series approximation  <cit> . a general form of the kth order fourier series expansion is given as 

  gk=a0+∑j=1k[ajcos+bjsin. the other coefficients akand bk are the amplitude coefficients that determine the times at which the gene achieves peak and trough expression levels, respectively, and ω is the period of the signal of gene expression. while the time-dependent expression value of a gene can be adequately modelled by a fourier series approximation of the first three orders  <cit> , recent results  <cit>  demonstrate that the first-order fourier series approximation is sufficient to provide good results in terms of clustering the time-course data into meaningful functional groups. alternatively, the likelihood ratio test may be used to determine the order of the fourier series approximation within the nested regression models.

the emmix-wire procedure of ng et al.  <cit>  is developed primarily for clustering genes from general microarray experimental designs. on the other hand, kim et al.  <cit>  focus specifically on clustering periodic gene profiles and propose a special covariance structure to incorporate the correlation between observations at different time points. they also review current methods and compare their method with that of ng et al.  <cit> . more recently, scharl et al.  <cit>  use integrated autoregressive  models to create cluster centers in their simulation study of mixtures of regression models for time-course gene expression data through the new version of software flexmix in leisch  <cit> . wang and fan  <cit>  propose mixtures of multivariate linear mixed models with autoregressive errors to analyse longitudinal data. in this paper, we propose a new emmix-wire normal mixture regression model with ar random effects for the clustering of time-course data. in particular, the model accounts for the correlation among gene profiles and models the dependence between expressions over time via ar random effects.

the paper is organized as follow: we first present the development of the extension of the emmix-wire model to incorporate ar random effects which are fitted under the em framework. then in the following section, we conduct a simulation study and the data analysis with three real yeast cell datasets. in the last section some discussion is provided. the technical details of the derivations are provided in the additional file  <dig> 

methods
emmix-wire model with ar random effects
we let x denote the design matrix and βthe associated vector of regression coefficients for the fixed effects. in the specification of the mixture of mixed linear components as adopted by ng et al.  <cit> , the vector yj for the jth gene conditional on its membership of the hth component of the mixture is expressed as 

  yj=xβh+z1ujh+z2vh+εjh, 

where βh is a  vector containing unknown parameters a0a <dig> …,akb <dig> …,bk; see , ujh=tand vh=tare the random effects, where m is the number of time points. in , z <dig> and z <dig> are m×m identity matrices. without loss of generality, we assume εjhand vh to be independent and normally distributed, n and n, independent of ujh. to further account for the time dependent random gene effects, a first-order autoregressive correlation structure is adopted for the gene profiles, so that ujhfollows a n) distribution, where 

  a=11−ρ21ρ…ρm−1ρ1…ρm−2⋮⋮⋮⋮ρm−1ρm−2… <dig>  

the inverse of a can be expressed as 

  a−1=i−ρj−ρ2k, 

and 

  trace∂a−1∂ρaρ=−2ρ/, 

where i, j, and k are all m×mmatrices. specifically, i is the identity matrix; j has its sub-diagonal entries ones and zeros elsewhere, and k takes on the value  <dig> at the first and last element of its principal diagonal and zeros elsewhere. the expressions  and  are needed in the derivation of the maximum likelihood estimates of the parameters.

the assumptions  and  imply that our new model assumes an autocorrelation covariance structure under which measurements at each time point have a larger variance compared to the model of kim et al.  <cit>  under an ar autocorrelation residual structure.

in the context of mixture models, we consider the g-component mixture with probability density function  as 

  f=∑h=1gphfh, 

where fhis the component-pdf of the multivariate normal distribution with mean vector xhβh and covariance matrix 

  θh2z1ahz1t+z2dhz2t+Ωh. 

the vector of unknown parameters is denoted by Ψand can be estimated by maximum likelihood via the em algorithm.

maximum likelihood via the em algorithm
in the em framework adopted here, the observed data vector y=t is augmented by the unobservable component labels, z <dig> z <dig> …,znof y <dig> y <dig> …,yn, where zj is the g-dimensional vector with hth element zjh, which is equal to  <dig> if yjcomes from the hth component of the mixture, and is zero otherwise. these unobservable values are considered to be missing data and are included in the so-called complete-data vector. finally, we take the random effect vectors ujh and vh, to be missing and include them too in the complete-data vector. now the so-called complete-data log-likelihood lc is the sum of four terms lc=l <dig> + l <dig> + l <dig> + l <dig>  where 

  l1=∑h=1g∑j=1nzjhlog 

is the logarithm of the probability of the component labels zjh, and where l <dig> is the logarithm of the density function of y conditional on ujh,vh, and zjh= <dig>  and l <dig> and l4is the logarithm of the density function of u and v, respectively, given zjh= <dig>  

  l2=−12∑h=1g∑j=1nzjhmlog2Π+log|Ωh|+εjhtΩh−1εjh, 

  l3=−12∑h=1g∑j=1nzjhmlog2Πθh2+log|ah|+θh−2ujhtah−1ujh, 

  l4=−12∑h=1gmlog2Π+log|dh|+vhtdh−1vh, 

where 

  εjh=yj−xβh−z1ujh−z2vh. 

to maximize the complete-data log likelihood lc, the above decomposition implies that each of l <dig> l <dig> l <dig>  and l <dig> can be maximized separately. the em algorithm proceeds iteratively until the difference between successive values of the log likelihood is less than some specified threshold. all major derivations are given in the additional file  <dig> 

RESULTS
simulation study
to illustrate the performance of the proposed model, we present a simulation study based on synthetic time-course data. in the following simulation, we consider an autocorrelation dependence for the periodic expressions and compare our model to that of kim et al.  <cit> . synthetic time-course data from three different parametric models , assuming a first-order fourier series of periodicity, are considered in the simulation study. within each model, we consider two different settings of θ2corresponding to low and high autocorrelation among the periodic gene expressions. we also assume that Ωand d are diagonal matrices, where the common diagonal elements are represented by σ <dig> and d <dig>  respectively.

there are three clusters of genes. the periods for each cluster are  <dig>   <dig>  and  <dig>  respectively. there are  <dig> measurements at time points  <dig>   <dig>  …,  <dig>  and the first order fourier expansion is adopted in the simulation models. parameters and simulation results are listed in tables  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>  in each table, we summarize the results from  <dig> simulated sets of data. the true values of the parameters and the biases of their estimates are given in these tables, along with the root mean square errors  in parentheses. we terminated the em algorithm iterations when the absolute values of the relative changes in all estimates between consecutive iterations were smaller than  <dig> , with the maximum iteration of  <dig>  for our model, we started from the true partition; for the model of kim et al.  <cit> , we started from the true values of the parameters. alternatively, initialization procedures have been considered for mixtures of regression models with and without random effects  <cit> . for the comparison, we consider the misclassified error rate, the rand index, and the adjusted rand index  <cit> , where the latter two assess the degree of agreement between the partition and the true clusters of genes. a larger  rand index indicates a higher level of agreement.

specifically, we first investigate the performance of our new extended emmix-wire model and that of kim et al.  <cit>  when the data are generated from the extended emmix-wire model, in which gene expressions within a cluster are correlated. as listed in tables  <dig> and  <dig>  the estimates of the parameters pa0a1b1θ2ρ, and σ <dig> in the proposed model are approximately unbiased, except for d <dig>  which is slightly underestimated. in contrast, the model of kim et al.  <cit>  fails to capture the contributions from gene-specific and tissue-specific effects on the autocorrelation among periodic gene expressions at each time point, and thus overestimates the correlation between different time points for each gene. their method therefore leads to an inferior clustering performance in terms of higher error rates and smaller rand indices. from tables  <dig> and  <dig>  our proposed method performs better in more than 98% out of  <dig> simulated datasets. it also has smaller rmses  and the difference in performance is significant based on the standard deviation  of the error rates and rand indices.

we now compare our model with that of kim et al.  <cit> , using the data from the extended model of qin and self  <cit> , which is a special case of our emmix-wire model , where gene expressions are independent. the results are presented in tables  <dig> and  <dig>  where it can be seen that our method provides essentially unbiased estimates of all the parameters. on the other hand, the model of kim et al.  <cit>  still overestimates the residual variance at different time points and underestimates the correlation between different time points for each gene, as it fails to capture the contribution from gene-specific effects to the autocorrelation among periodic gene expressions at each time point. their method again produces slightly larger error rates and smaller rand indices, though the difference is not significant. from tables  <dig> and  <dig>  the proposed method indeed performs better with slightly larger rand indices in more than 80% of  <dig> simulated datasets.

lastly, we generate the data from the model of kim et al.  <cit>  and provide comparative results in tables  <dig> and  <dig>  it is observed from tables  <dig> and  <dig> that the clustering performances are comparable between the two models, as the difference is not significant. out of  <dig> simulated datasets, the proposed method is not worse in more than 35%.

our model again provides unbiased estimates for all parameters. in contrast to the model of kim et al.  <cit> , our model accounts for the correlation among gene profiles via the linear effects modelling. as presented in tables  <dig> to  <dig>  our model outperforms the model of kim et al.  <cit>  when the genetic profiles are correlated. when the genetic profiles are generated independently, our model has slightly better performance in cases where the variability in gene expressions at each time point is large. in cases where the residual covariance structure follows an ar model as in kim et al.  <cit> , our model still provides comparative results and unbiased estimates as with kim et al. the model of  <cit> . the advantage of our model to provide more reliable and robust clustering of time-course data is apparent. with microarray experiments including those time-course studies, gene expression levels measured from the same tissue sample  are correlated  <cit> , clustering methods which assume independently distributed gene profiles, such as the model of kim et al.  <cit> , may overlook important sources of variability in the experiments, resulting in the consequent possibility of misleading inferences being made  <cit> .

applications: yeast cell cycle datasets
yeast cell cycle dataset 1
the first example considers the yeast cell cycle data analysed recently by wong et al.  <cit> . this dataset  is available from yeung et al.  <cit> . it contains  <dig> genes and  <dig> samples. these genes are categorized with respect to the four categories in the mips database . these categories are assumed to represent the true clusters. in this illustration, we fit our new extended emmix-wire model and the model of kim et al.  <cit>  to the yeast cell cycle data, with the period of  <dig> in the fourier extension  <cit> .

in table  <dig> of wong et al.  <cit> , it shows that the rand and adjusted rand indices for their two-stage method are  <dig>  and  <dig> , respectively, and these indices are higher than other methods considered in their paper. using the model of kim et al.  <cit> , the rand indices are  <dig>  and  <dig> , respectively. with the emmix-wire model of ng et al.  <cit> , we have the rand and adjusted rand indices  <dig>  and  <dig> , respectively. using the proposed new model, the rand and adjusted rand indices are  <dig>  and  <dig> , respectively, and are the best matches  compared with the aforementioned models. the four clusters of genes time-course profiles are presented in figure  <dig>  it can be seen that the genes have very similar expression patterns within each cluster, except in cluster  <dig>  where there is greater individual variation by some of the genes. the estimation using the proposed model is listed in table  <dig>  it can be seen that the correlations in the first three components are from  <dig>  to  <dig> , indicating a significant correlation among gene expressions at different time points. ignoring this correlation may therefore lead to a lower rand index, that is, a worse clustering. we can see the estimates of d2in clusters  <dig> and  <dig> are large and are greater than the corresponding estimates of θ <dig>  indicating coregulation in these two clusters. if we ignore such within-cluster coregulation, we will have rand indices similar to those for the model of kim et al.  <cit> . our model considers both autocorrelation and coregulation, and thus obtains the best clustering performance.

yeast cell cycle dataset 2
the second example is the subset of  <dig> genes from the yeast cell cycle data in cho et al.  <cit> , corresponding to five functional groups  <cit> .

each of gene is assigned a “phase”. we call each “phase” a “main group”. there are five “main groups” in this dataset, namely, early g <dig>  late g <dig>  s, g <dig>  and m. we now compare and assess the cluster quality with the external criterion . the raw data are log transformed and normalized by columns and rows. figure  <dig> presents the five clusters of genes profiles obtained using the proposed model. it can be seen that the genes have very similar expression patterns within each cluster. the estimations are listed in table  <dig>  the rand and adjusted rand indices are  <dig>  and  <dig> , respectively. they are  <dig>  and  <dig>  for the model of kim et al.  <cit> . the error rates are the same  for the two models. the performances of the two models are very similar because the correlation among gene profiles is weak in this dataset. as indicated in table  <dig>  the estimates of d <dig> are all very small compared to the estimates of θ <dig> 

a complete yeast dataset
with this third example, we demonstrate how the proposed method can be adopted to cluster a large amount of yeast genes of which only a small proportion shows periodicity. the original dataset consists of more than  <dig> genes, where the yeast cells were sampled at  <dig> min intervals for  <dig> min with a total of  <dig> time points after synchronization  <cit> . by comparing the ‘aggregate’ numerical score  for each gene relative to a threshold score,  <dig> genes were identified as periodically regulated  <cit> . the threshold score was determined empirically, where 91% of previously known cell cycle-regulated genes have a higher score than the threshold. the number of false positives among these  <dig> cell cycle regulated genes was estimated to be between 3% and 10%  <cit> . in this study, we worked with  <dig> genes that have no missing expression levels across any of the  <dig> time points. of these  <dig> genes,  <dig> are periodically regulated and  <dig> are not periodic.

the new mixture model with ar random effects and fourier series approximations was fitted to the periodic gene expression data with the number of clusters g= <dig> to g= <dig>  where the cell cycle period ω= <dig> was determined using a global grid search method described in the discussion section. the optimal number of clusters was determined using the bayesian information criterion  of schwarz  <cit> . the use of bic for model selection has been considered in the analysis of gene expression data including  <cit> . based on the bic, there are eight clusters of periodically regulated genes. with the  <dig> non-periodic genes, we adopted the same mixture model with ar random effects, but replacing the fourier series approximations  by a time-series regression form with b-splines  <cit> . model selection via bic indicated that there are thirteen clusters of non-periodic genes. figure  <dig> presents the expression profiles of genes in each of the twenty-one clusters. from figure  <dig>  it can be seen that the genes have very similar expression patterns within each cluster, except in clusters  <dig> and  <dig>  where there is greater individual variation by some of the genes. in table  <dig>  we give the composition of the eight clusters with respect to the five phases of peak expression. our clusters  <dig> and  <dig> consist mainly of those genes with typical g <dig> peak expression, while most genes in cluster  <dig> show g2/m or s/g <dig> phases of peak expression. on the other hand, a majority of genes in cluster  <dig> has a typical m/g <dig> phase and those in cluster  <dig> have a g2/m phase.

with reference to the findings by spellman et al.  <cit> , a majority of genes in our identified clusters are coregulated. for example, cluster  <dig> contains genes previously classified to the “clb2” cluster of spellman et al. these genes, including ace <dig>  bud <dig>  cdc <dig>  and clb <dig>  are regulated by the mcm <dig> and sff transcription factors that induce genes during mitosis  <cit> . cluster  <dig> contain genes described by spellman et al. as the “met” cluster. these genes, such as six met genes and ecm <dig>  are likely to be involved in methionine metabolism  <cit> . in addition, genes in our clusters  <dig> and  <dig> are the major members of the “cln2” and “sic1” clusters described in spellman et al., respectively. the former cluster includes cln <dig>  cdc <dig>  cdc <dig>  rnr <dig>  pol <dig>  pol <dig>  and are involved in dna replication and repair. cluster  <dig> contains genes that are strongly cell cycle regulated, such as sic <dig>  tec <dig>  ash <dig>  pir <dig>  and pir <dig>  <cit> .

discussion
we have presented a new mixture model with ar random effects for the clustering of time-course gene expression profiles. our new model involves three elements taking important role in modelling time-course periodic expression data, namely,  fourier expansion which models the periodic patterns;  autocorrelation variance structure that accounts for the autocorrelation among the observations at different time points; and  the cluster-specific aandom effects which incorporate the coregulation within the clusters. in particular, the latter two elements corresponding to the correlations between time-points and between genes are crucial for reliable and accurate clustering of time-course data. we have demonstrated in the simulation and real examples that the accuracy of clustering is improved if the autocorrelation among the time dependent gene expression profiles has been accounted for along the time points; this is also demonstrated in kim et al.  <cit> . furthermore, better results are obtained if the coregulation within the clusters is modelled appropriately. to justify whether an autoregressive correlation structure for the gene expression profiles is appropriate, besides reporting the sample correlation as suggested by one of the reviewers, one can also compare the estimated random components and residual variance with each other. when the correlation between genetic profiles is not small, which is the case for typical time-course data, ignorance of this dependency may lead to less accurate clustering results. to further illustrate this, we generated  <dig> gene expression profiles for each of the three clusters from the three parametric models presented in tables  <dig>   <dig>  and  <dig>  respectively. the simulated profiles displayed in figure  <dig> highlight the differences between the three models we considered in this paper. the results indicate that the proposed time dependent random gene effects are able to capture different degrees of correlation between gene expression profiles within a cluster. our method performs better when the degree of correlation is large  and 4) and provides comparable results when the degree of correlation is small ). this finding is also pronounced in the analyses of the real datasets, where yeast cell cycle dataset  <dig>  shows a high degree of correlation between profiles and yeast cell cycle dataset  <dig>  shows a relatively small degree of correlation between profiles.

as an additional empirical comparison, we applied a simple k-means clustering procedure to all the simulated and real datasets considered in the paper. we found that the k-means procedure gave higher error rate and smaller adjusted rand index , especially when the correlation between genetic profiles is not small. for example, the mean  of the error rate and adjusted rand index obtained for the k-means procedure for the model in table  <dig> are  <dig>   and  <dig>  , rsepectively. for the model in table  <dig>  they are  <dig>   and  <dig>  , respectively. with the model in table  <dig>  they are  <dig>   and  <dig>  , respectively, while they are  <dig>   and  <dig>  , respectively, for the model in table  <dig>  with the models in tables  <dig> and  <dig>  where the degree of correlation is small, the mean  of the error rate and adjusted rand index obtained for the k-means procedure are  <dig>   and  <dig>  , respectively, in table  <dig>  while they are  <dig>   and  <dig>  , respectively, in table  <dig>  for the yeast  <dig> real dataset, the adjusted rand index is  <dig>  for the k-means procedure, which is smaller than the two methods that are based on the emmix-wire model. using the k-means procedure, the error rate and adjusted rand index are  <dig>  and  <dig> , respectively, for the yeast  <dig> dataset. this error rate is the highest among the methods considered in the paper, while the adjusted rand index is comparable to the other methods. with the complete yeast dataset, the results obtained using the k-means procedure are somewhat different from those for our method. for example, we have identified a majority of yeast genes  in cluster  <dig> which show a typical m/g <dig> phase, while the cluster obtained by the k-means procedure contains only 69% of genes with a m/g <dig> phase. moreover, the clusters obtained by the k-means procedure for the non-periodic genes are very different from those presented in figure  <dig> using our method. these findings indicate that a more complex method is generally required for the clustering of time-course data, especially when the correlation between the expression levels is not weak.

for the purpose of comparison, the periods of the signal of gene expression are assumed to be known in the simulation study and applications to real data. in practice, there are several ways to estimate the periods for each cluster  <cit> . for example, in kim et al.  <cit> , the periods are estimated using simplex algorithm at the m-step during the em algorithm. however, when the periods are estimated during the em iterations, we find that the periods depend also on other parameters. in addition, when we start from an initial period and get the design matrix x, then with higher possibility the best period will be the initial periods. so we change the strategy to a slow one, and we call it global grid search method, which guarantees the highest maximum log likelihood at the best periods. it is implemented as follows. let s be the space with typical element  t, representing the component periods, where ωhcan take all possible values . for example, for the yeast cell cycle data, the possible periods are  <dig> , …,  <dig>  then for each fixed t, we estimate the parameters as if the periods for each component were known. finally, we compare the log likelihood and choose the one with the highest log likelihood as the final result. since it is very slow if there are too many elements in s when we have no prior information about the periods, we recommend using other methods to obtain the periods in such cases, such as the weighted least-squares estimation approach considered in  <cit> . in all the calculations in this paper, we assume the periods are fixed.

the proposed model is very flexible through the different specifications of design matrices or model options as originally available in ng et al.  <cit> . for example, besides the full model, it enables us to incorporate the model of qin and self  <cit>  as a special case. specifically, we can obtain their model by assuming zero cluster effects  and that random effects u be autocorrelated for each gene. furthermore, when both random effects u and v are assumed to be zero, then we have normal mixture of regression models. in the program we have developed, there are many options and parameters for users to specify the models they want to use in addition to the models we list in our paper. for example, the developed program is applicable to cluster time-course gene expression profiles that are not periodic ). when periodicity is not obvious, fourier seris approximations ) can be replaced by a time-series regression form  to model the conditional mean expression profiles for each component. with reference to equation , the proposed mixture model framework with time dependent ar random gene effects is again desriable to capture the dependence between the expression measurements over time. the program is written in an r package and is available in additional file  <dig>  which also contains the data.

CONCLUSIONS
our new extended emmix-wire model is more reliable and robust for clustering time-course data because it postulates gene-specific random effects with an autocorrelation variance structure that models coregulation within the clusters. the developed r package is flexible in its specification of the random effects through user-input parameters that enables improved modelling and consequent clustering of time-course data.

availability
an r-program is available on request from the corresponding author.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
all authors contributed to the production of the manuscript. skn and gjm directed the research. kw wrote the r-program and analysed the simulated and real data. all authors read and approved the final manuscript.

supplementary material
additional file 1
supplementary file bmcbioinf-supp- <dig> pdf

click here for file

 additional file 2
supplementary file for code and data supp <dig> zip

click here for file

 acknowledgements
this research was supported by a grant from the australian research council.
