BACKGROUND
the concerted actions of genes, proteins, and metabolites are often conceptualized as pathway diagrams. pathways represent a familiar concept in biological research, and software designed to work with pathways can help the researcher to organize information related to research questions. here we present pathvisio, a visualization tool for managing biological pathways, and show several ways in which this tool can facilitate the process of doing research.

it is often said that an image is worth a thousand words, and this is especially true for describing complex interactions among biomolecules. pathways are commonly used with great effect as teaching aides in textbooks, as notes in lab journals, and as explanatory slides in research presentations. however, a pathway that is drawn in a notebook or presentation software is just a static image. the usefulness of a pathway could be increased dramatically if the software knows something about the biological entities it represents. for example, one could click on entities of a pathway to view the ensembl page of a relevant gene in a browser window. ideally, textbook pathways could be combined or compared with other versions of the pathway and stored in an online repository. new pathway information could be compiled from the latest experiments and discoveries. large experimental datasets would be more understandable through pathways. clearly, user-friendly software would be helpful for dealing with biological pathways.

a new program, pathvisio, is based on many design principles derived from genmapp <cit> , a popular software suite among bench biologists . pathvisio is designed to augment genmapp, replacing some but not all aspects of the software by using more flexible technologies such as xml and java that allow for completely new features and increase the possibilities for future extension. pathvisio is suitable for the creation and exploration of pathways, while relying on genmapp for visualization of experimental data and mappfinder for statistical analysis.

pathvisio improves genmapp in four separate areas. first, pathvisio is written in the java programming language as opposed to visual basic. thus, pathvisio is cross-platform, easier to integrate with other scientific software , and works with web technologies such as java applets and java webstart. pathvisio already integrates well with some other java-based scientific tools such as cytoscape <cit>  for network analysis and eu.gene  <cit>  for pathway statistics. second, pathvisio uses a newly designed file format for storing pathway information that is extensible  yet at the same time backwards compatible with the mapp format used by genmapp. this means that the existing genmapp pathway archive can be used in pathvisio and other gpml-compliant programs. gpml has already been extended with new shapes and the capability to define relationships between nodes, allowing a network view of the pathway. because of the novel features of gpml, it is preferable to use this format for pathway storage even if the mapp format is used in later analysis steps. third, the structure of the application is such that the pathway view and the data model are separated in different code modules. this enables the implementation of "copy," "paste," and "undo" commands, which are expected in modern user interfaces, yet are absent in genmapp. separation of the data model also makes it easier to support different pathway file formats and image formats. pathvisio can be used to prepare illustrations suitable for publications with its vector graphics export feature. finally, pathvisio re-implements genmapp's underlying gene databases with a new database schema that can be accessed more efficiently with fewer queries. these four technical improvements make the software more flexible, and open the possibility of new functionality and better integration with other tools.

the most important aspect of genmapp that has been mimicked in pathvisio is that the software places the biologist at the center. pathvisio works best in the hands of experimental biologists with a high level of domain knowledge. we aimed to avoid the situation where the software is so difficult to use that a specialized bioinformatician is needed. we want to gather pathway knowledge directly from the biologists who conceptualize pathways when designing and performing their experiments. this was our main guideline during the software design process. for example, we chose to use manual instead of automatic layout, to emulate presentation software that may be already familiar to the user. we chose locally installable synonym databases to make cross-referencing gene identifiers quick and automatic.

implementation
as noted above, the data model of pathvisio is completely separated from the rest of the application. it consists of two parts: the pathway data model and the synonym database model.

in the pathway data model , there are three main types of objects in a pathway: datanode objects represent biological entities, line objects represent various types of interactions, and shape objects serve as graphical annotation. the term datanode is similar to the genmapp term geneproduct, but we chose to use the former to show that it can be used to refer to any type of biological entity, not just genes and proteins. datanodes can be grouped to show that they are biologically related .

to store this pathway model, we developed gpml or genmapp pathway markup language. gpml is backwards compatible with the genmapp mapp format, meaning that all information stored in mapp format can be stored in gpml as well, and pathways can be readily converted. gpml has a set of extensions on top of the initial requirement of compatibility. it allows storing relations among different elements, so that a graph can be derived from a pathway. a pathway using this facility can be converted into a network, something that is impossible with the mapp format. the utility of this feature will be discussed below. it also can link to biopax  <cit> . biopax is an emerging pathway standard for exchange of pathway data. the current version of biopax  lacks the ability to store coordinates and graphical annotations that are part of the genmapp format. by linking gpml elements to biopax elements, both are extended in xml fashion. in this way, gpml could be used as a presentation layer on top of biopax. to handle various pathway file formats, pathvisio makes use of a generic import/export interface.

the second part of the model used in pathvisio is the synonym database model. a variety of online genome databases are available to the bioinformatics community, leading to multiple identifiers for the same gene. one solution to this problem would have been to standardize on a specific database and let users make use of external services such as david  <cit>  to translate between id types. this extra step for the user can be cumbersome and prone to errors. pathvisio uses another solution also implemented by genmapp, letting the software handle the translation through synonym databases.

synonym databases  can be downloaded from the website pathvisio.org. because this type of database is potentially used intensively, we chose to create locally installable versions rather than relying on a slow web-service. the synonym database schema  consists of three tables: "info", "datanode" and "link". info provides meta-data on the database. datanode provides per-gene information, including a short description. link provides a many-to-many relation between entries in the datanode table that is used to store cross-references.

synonym databases that we produce are based on ensembl  <cit>  and can in principle be made for any species that is annotated in that database. they are produced based on the derby relational database system  <cit> , because derby can be packaged with the pathvisio software making installation easier. however, pathvisio is not tied to a specific database back-end. depending on speed, usability and cost requirements, a different embedded or client-server database system could be used through the java database connectivity  layer. the use of synonym databases is not restricted to gene information; metabolites can be used as well to unify pubchem <cit> , chebi <cit>  and hmdb <cit> .

for viewing pathways, we chose an implementation based on the java graphics2d api, which makes it possible to output to screen as well as various file types. the flexibility of this api makes it trivial to add shape types in the future. the batik svg toolkit  <cit>  is used for exporting to graphic formats, including those suitable for publication.

RESULTS
we envision three ways in which pathvisio could aid biologists doing research.

1: organization of biological information
many research questions are related to biological pathways in some way. for example, which receptor is responsible for carrying a stress signal across the nuclear membrane? which proteins need to be activated to lead to a choice between two possible differentiated cell types? in these cases, a question is asked about a certain unknown component of a biological pathway. experimental results could lead to a conclusion in terms of adding new elements to a pathway, clarifying the role of an element in a pathway, or proving the existence of an interaction between two elements. in all cases, biological knowledge is increased, and since pathways are a representation of this knowledge, the pathway itself is improved as a direct result of research. expressing biological knowledge visually as a pathway can be a very powerful tool to organize disparate bits of information.

what is the best way to represent biological concepts graphically? there are certain conventions for this, as well as several published formalized symbolic languages  <cit> . the style used by genmapp and many textbook pathways does not pose many restrictions .

molecular interaction maps   <cit>  is one attempt to codify biological knowledge in schematics. the advantage of mims is that they store a large amount of information in a single diagram, and a knowledgeable person can retrieve all this information from the diagram with certainty.

the current version of pathvisio  has some support for mims; many of the needed graphical elements can be drawn. work is underway to make this support complete, including making complex aspects of mims, such as contingency arrows, available in a user-friendly manner . pathvisio is the first graphical editor with support for the mim style. we hope other editors will support mims in the future, so that they will be established as a standard.

kitano  <cit>  proposed that a pathway schematic must be semantically and visually unambiguous. the requirement of unambiguously defining a pathway is necessary for computational simulation, but in our opinion this is simply impossible for most biological pathways. the complexity of these data can be confusing to the biologist or teacher who is attempting to convey fundamental aspects of the pathway. for example, the combinatorial explosion that arises when dealing with a protein that can be in different phosphorylation states can increase the complexity of the diagram. a trade-off exists between clarity and completeness. at the same time, the requirement for unambiguity hampers the iterative process by which a pathway can be compiled while research is ongoing. many components of a pathway are unknown and unspecified as long as research has not yet provided a full mechanistic explanation of the subject. kitano resolves this by proposing a reduced notation; similarly, kohn  <cit>  has added a distinction between heuristic and explicit maps. gpml allows ambiguity, and doesn't enforce a particular style of notation. by being flexible, gpml allows a pathway to progress seamlessly from a rough conceptualization to a well established pathway that can be modelled. as increasing levels of complexity are understood, any of the aforementioned styles can be used depending on the intended use of the pathway.

biological knowledge stored in a collection of pathways is most useful if it is available online and frequently updated. an applet version of pathvisio is used for the wikipathways  <cit>  resource, where the research community can collaborate in the task of curating and updating pathway content.

2: data analysis and pathway statistics
data from high-throughput experiments such as microarrays can be combined with pathways to achieve new insights. using pathways one can view data in its biological context rather than in an arbitrarily ordered table. once a set of pathways have been collected in a repository, the possibility to do pathway statistics becomes available.

pathvisio supports this workflow in combination with the genmapp software suite. pathways created with pathvisio can be exported to mapp format. subsequently, high-throughput experimental data can be loaded into genmapp, and user-defined color criteria established. datanodes on pathways in genmapp can then be colored accordingly, putting relevant parts of the expression dataset together in a single view.

mappfinder  <cit> , another tool in the genmapp software suite, can be used to search for pathways that are significantly regulated under experimental conditions. mappfinder counts how many genes on each pathway meet user-defined criteria and compares this to the expected number of genes that meet the criteria to calculate a z-score. these z-scores can then be used to rank a set of pathways, which is very useful in hypothesis-generating experiments to identify which biological processes are affected.

eu.gene can provide an alternative to mappfinder in circumstances where something other than z-scores is required. pathvisio can export pathways to the eu.gene gene list format. eu.gene can employ gene set enrichment analysis  or fisher exact tests for pathway statistics. we also assisted the eu.gene development team to allow direct import of gpml and visualization of pathways. these features will be available in the next eu.gene release

3: network analysis and augmentation
compilation of pathway information is necessarily a manual process, but it would be very useful to augment pathway information with computational tools, including text mining, data mining and interaction information from high-throughput datasets, such as yeast-two-hybrid data.

as an improvement on genmapp, gpml has been extended to store node-edge relations, making it possible to store true interactions. pathvisio allows the user to define interactions by joining two items with a connector line. fore ease of use, the connector moves together with the element to which it is connected.

the user-interface of pathvisio is optimized for the pathway model, meaning that pathvisio does not treat pathways as networks. the two concepts are closely related however, and network analysis of pathways can be useful. other software, such as cytoscape  <cit> , is better suited to handle networks. ideally, one would be able to use both programs together. cytoscape supports a large set of plug-ins  <cit> . we created a gpml plug-in for cytoscape that enables the user to transfer pathways between pathvisio and cytoscape with copy and paste commands. this is the first step of a workflow for enhancing pathway information:  <dig>  create a pathway in pathvisio based on experimental results or literature research.  <dig>  copy the pathway to cytoscape.  <dig>  enhance the pathway using one of the many sources of interaction information available within cytoscape. for example, the agilent literature search plug-in could be used to obtain interactions from literature. the pathwaycommons plug-in makes various other sources of interaction information available. once such interaction information is obtained, the network can be further enhanced, for example by grouping nodes by the cellular component they occur in using the bubblerouter plug-in.  <dig>  copy the enhanced network back to pathvisio.  <dig>  re-arrange the network manually in pathvisio for presentation or publication. see figure  <dig> for a schematic overview of this workflow. all plug-ins mentioned in this workflow, including the gpml plug-in, can be downloaded directly using the cytoscape plug-in manager.

future
for a specialized tool such as pathvisio to be relevant, it must be tightly integrated with other bioinformatics tools and standards. pathvisio can already be used in combination with cytoscape through the gpml plug-in, and it is compatible with genmapp mapp format and mappfinder for statistical analysis.

there currently exists a set of partly overlapping pathway format standards  <cit> , and in our view, it is better to improve existing standards than to add new ones. as long as no pathway format completely solves all problems, the second best solution is to maximize compatibility and interoperability, and a move from a binary format to an xml-based format is a step in the right direction. gpml is intended to be a backwards compatible extension of the older, less flexible mapp format. this step makes an older format easier to convert and more interoperable with other standards.

to clarify the role of gpml, we can compare it to other existing standards related to pathway definitions. biopax is a standard designed for exchanging data between pathway databases. gpml can embed elements from a biopax document and add visual annotations to it. this capability could facilitate integration of pathvisio with other pathway sources, such as reactome, in the future. gpml is not suitable for computational modelling. systems biology markup language  is designed specifically for that purpose, and the overlap in scope of gpml and sbml is small. in the context of applications like celldesigner  <cit> , sbml defines reactions and parameters necessary for computational modelling. celldesigner is a pathway drawing tool similar to pathvisio, but focused on creating graphical representations of sbml models. pathvisio and gpml instead emphasize flexibility and links to online databases, as these are valuable for human interpretation.

CONCLUSIONS
pathvisio is fully open source, and gpml is an open format. we see open source as a necessity for this type of bioinformatics tool. open source makes it possible for other tools to adapt to pathvisio and vice versa. with closed-source tools , this adaptation can only go one way, which is a strong disincentive to collaborate. in a field where integration is of utmost importance, open-source software provides an optimal solution. to further encourage cooperative development, pathviso supports the addition of plug-ins, something that is facilitated by the java programming language.

with pathvisio and gpml we have developed a framework for visual pathway analysis. this framework is very flexible with future extensions in mind. development of pathvisio is ongoing. we wish to continue in the direction of increased flexibility and tighter integration with other bioinformatics standards and applications. this should ensure that pathway analysis and visualization can be done efficiently to improve biological research.

availability & requirements
project name: pathvisio

project home page: 

operating system: cross-platform. pathvisio has been tested on windows xp, ubuntu linux  <dig>  and mac os x  <dig> .

programming language: java

other requirements: java  <dig> or higher

license: free and open source under the apache  <dig>  license. there are no restrictions to use by non-academics. the source code is available at 

authors' contributions
all authors have read and agreed upon the content of this article. the pathvisio software was designed and written by mvi, tk, ap and kh. sc performed invaluable beta testing. ap and bc created the gpml concept, ce the pathvisio concept. mvi and sc drafted the paper.

supplementary material
additional file 1
krebs cycle pathway in gpml format. rendering of the krebs cycle in gpml format, derived from the genmapp archive. this pathway is shown in figure  <dig>  this file can be opened from within the pathvisio application.

click here for file

 additional file 2
dna replication pathway in mim style in gpml format. rendering of the dna replication pathway using the mim style, derived from aladjem et al <cit>  part of this pathway is shown in figure  <dig>  this file can be opened from within the pathvisio application.

click here for file

 acknowledgements
we thank lynn ferrante for the first work on the xml schema definition of gpml, gontran zepeda for work on mapp import/export, and rene besseling, sjoerd crijns, margriet palm, erik pelgrim and hakim achterberg for help in pathvisio development. this work was supported by grants from the nih , the biorange  <dig> . <dig> research program of the netherlands bioinformatics centre and funding from transnational university limburg .
