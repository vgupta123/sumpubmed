BACKGROUND
extensive research efforts have demonstrated the emergence and central role of dna copy number amplifications in a wide variety of cancerous tissues  <cit> . amplification multiplies the dna copy number of a specific genomic region in a cancer cell and activates oncogenes by increasing their functionality by providing excess gene copies. amplifications are clinically relevant genomic anomalies.

amplification-activated oncogenes are frequently used as biomarkers of poor prognosis and, as amplified genes are attractive therapeutic targets, drugs inhibiting the function of amplified genes have been developed  <cit> . for example, trastuzumab is a monoclonal antibody that inhibits the kinase activity of erbb <dig> tyrosine kinase receptor, which is frequently overexpressed in breast cancer due to an amplification of the erbb <dig> gene. amplifications are relatively prevalent in different types of cancers and large amounts of genome-wide data are publicly available. specific amplifications have been shown to associate with specific cancer types that share a similar etiological background. for example, cancers of the gastrointestinal tract clustered together according to their genome-wide amplification frequency profiles  <cit> . similarly, using a machine learning approach, gastrointestinal tumors were shown to associate with amplifications at 2q <dig>  3q <dig> -q <dig>  3p26-q <dig>  5p <dig> -p <dig>  13q11-q <dig>  17q12-q <dig> and 17p13-q <dig>  <cit> . due to their high prevalence, clinical value and the cell lineage-specificity, dna copy number amplification patterns are feasible in characterizing cancer subtypes.

various statistical approaches to profiling of tissue samples with respect to the patterns of gene amplification have been earlier exploited in the literature. purely algorithmic techniques, such as independent and principal component analysis, as well as hierarchical and k-means clustering, have often been proposed for the purpose of extracting interesting and relevant patterns from high-dimensional and noisy data. such methods are widely available in generic software packages and are typically fairly easily applicable by non-experts. however, despite their seemingly casual applicability, difficult methodological questions often arise in the context of such methods, of which the statistical uncertainty related to the derived solutions, and the choice of an appropriate number of clusters or dimensions are the most prominent ones. therefore, an extensive statistical and computer scientific literature exists, where the advantages of model-based methods to solving pattern recognition problems compared to more ad hoc strategies in general are discussed  <cit> .

recently,  <cit>  utilized a model-based clustering approach to statistical profiling of human cancers. in their method, clusters are inferred with maximum likelihood estimation utilizing the em-algorithm and an appropriate number of clusters is chosen through cross-validation. from theoretical point of view the em-algorithm is related to the gibbs sampling markov chain monte carlo  algorithm , as in both the algorithms the parameters for the different clusters are updated in an iterative fashion, based on the conditional distributions of the cluster labels for the samples. although these types of algorithms are generally applied to model-fitting problems, the theoretical and practical limitations for situations involving a large number of underlying clusters are acknowledged in the statistical literature  <cit> . to avoid such problems,  <cit>  performed their analyses separately for each chromosome. although such an approach was relatively well motivated for the particular data set on human cancers analyzed by them, it would in general be statistically more coherent to consider all amplification data in a single joint framework. in particular, when tissue subgroups are associated with dna copy number amplifications over multiple chromosomes, their reliable detection may require joint consideration of all data.

here we introduce a bayesian model-based approach to simultaneous identification of underlying tissue groups and informative dna copy number amplifications. the model-based approach provides the possibility of using formal inference to determine the number of groups from the data, in contrast to the ad hoc methods often exploited for similar purposes. the model also automatically recognizes the chromosomal areas that are relevant for the clustering. the model is utilized in conjuction with a fast greedy stochastic algorithm, whose superior performance compared to an optimized version of gibbs sampling mcmc algorithm is illustrated with a simulation study. a large number of simulated data sets are analyzed to determine the accuracy and sensitivity of the inferences derived using our method. we illustrate further the potential of the approach by analyzing jointly the large database of human neoplasms considered earlier by  <cit> , who investigated each chromosome separately. we compare the performance of our method with that of a standard mixture modeling approach with no feature selection, and show for both the simulated and real data that the latter generally fails to discover biologically important patterns when the level of complexity in the data is moderate to high. our software implementation basta for performing bayesian statistical tissue profling is freely available for academic purposes at 

methods
bayesian clustering model for tissue samples
here we consider a set of n tissue samples, which are profiled using dna copy number amplifications, as described previously. the data are assumed to represent d binarized signals, where zeros and ones correspond to non-amplified and amplified chromosome bands, respectively. the observed binary vector for sample i is denoted by xi, i =  <dig> ..., n, which takes values in the binary hypercube { <dig>  1}d. the set of n such binary vectors will be jointly denoted as x.

by modifying suitably the approach of  <cit>  to amino acid sequence clustering, we obtain a statistical representation of the learning problem of simultaneously assigning the tissue samples into homogeneous subgroups and identifying informative chromosome sub-bands, as well as group-specific amplifications. these goals can be united by defining a family of probability models with a space of parameter configurations corresponding to the biological target. on one hand, this requires the identification of a suitable integer k and a corresponding clustering of the tissue samples into non-overlapping classes s <dig>  s <dig> ..., sk, which can be represented by a partition s of the data set. on the other hand, the model structure should capture a division of the sub-bands into biologically meaningful subgroups, which are here defined as noninformative and informative, depending on whether they provide information about the clustering. furthermore, the model structure should identify for each cluster a subgroup of informative sub-bands amplified in the particular cluster. the considered model structure is analogous to that introduced by  <cit> , apart from the fact that the amplification data is intrinsically binary, whereas  <cit>  utilized a transformation of multinomial data vectors to develop a clustering model for binary quantities. given the completely different biological purposes of the protein sequence analysis and pattern recognition for dna copy number amplifications, we will re-formulate the original model here for the current context to provide better understanding for which type of signals the model aims to discover.

biological relevance of the model configuration is ensured by imposing probabilistic assumptions on the observed binary data under the various specified categories. firstly, when the sub-bands are such that the probability of observing them as amplified is invariant with respect to the underlying classes of samples, they are considered noninformative. that is, from the statistical perspective, such features of data contain no information for classifying tissue samples into relevant groups. secondly, when the probability of observing a particular sub-band as amplified differs over the classes, it is considered informative for the present purposes. given the set of noninformative sub-bands, the latter group equals simply the complement set among all d data features. thirdly, we allow the model to specify subsets of informative sub-bands which are group-specific, such that the probability of observing a particular sub-band as amplified is very high in a specific class of tissue samples, whereas it is relatively low outside this class. we denote by d⊆{ <dig> ...,d} all the informative sub-bands, and by t= the subsets of d corresponding to the group-specific amplifications.

as the categorization of the amplifications into the three specific types is statistically intimately connected to the clustering s of the samples, it is instructive to define the model structure as a triplet m=. any instance of such a triplet can be combined with a predictive probability distribution for the observed data analogously to the learning rules developed from generalized exchangeability in  <cit>  in a different biological context. in particular, the work by  <cit>  shows how an unsupervised bayesian classification scheme arises for gene marker data under a random urn model and certain conditions regarding the stochastic process by which the data are assumed to have been generated. it should be noted that, unlike in the present context, in their work all observed features are considered relevant for classification by the model. let the model space ℳ contain all the triplets of the type specified above. the predictive bayesian learning then proceeds by converting the joint distribution

  p  = p  p , 

where p  represents the a priori uncertainty about the model structure, into the posterior distribution

  p=pp∑m∈ℳpp, 

which is utilized as the basis for identifying model structures that efficiently and parsimoniously capture features of the data in an information-theoretic manner. our biological target is to identify the model structure m that maximizes the posterior probability , and to find representations of the amplification informativeness over the considered chromosomal bands using the features of m. in concrete terms, our learning algorithm described below alternates between the two operators targeting to maximize  with respect to either the partition or the configurations of the sub-bands. the maximization of either one of these structural parameters is always performed conditional on the current value of the other parameter. to concretize the predictive component p  of the learning model, we employ exchangeability assumptions concerning the observation of particular amplifications under the elements of the triplet m= analogously to  <cit> . these lead to the following predictive likelihood

  p=∫Θ*pdθ, 

which involves three distinct types of conditional probabilities. firstly, pcjl, c =  <dig> ..., k, j ∈ j∈d∩tc,l= <dig>  represents the probability that sub-band j is amplified among the tissues allocated in class c, given that j is a group-specific amplification for class c. similarly, pcjl, l =  <dig>  represents the probability of the absence of amplification. secondly, qcjl, c =  <dig> ..., k, j ∈ j∈d\tc,l= <dig> , are the corresponding probabilities for the sub-bands that are not group-specific for the class c. finally, wjl, j∉d, l =  <dig>  is the probability of an amplification in any noninformative sub-band, and wjl, l =  <dig>  the probability of absence of amplification, which both are equal for all classes of tissue samples. in , the parameter θ represents jointly all probabilities pcjl, qcjl and wjl. the observed counts of presence and absence of an amplification are given by the sufficient statistics ncjl, njl, c =  <dig> ..., k, j =  <dig> ..., d, l =  <dig>   <dig> 

under the following conjugate beta priors  for the probabilities in :

  pcj1~beta,pcj0=1−pcj <dig> qcj1~beta,qcj0=1−qcj <dig> wj1~beta,wj0=1−wj <dig>  

the predictive probability is available analytically as

  p=∏i=1k∏j∈d∩tiΓΓ∏l=01ΓΓ*∏i=1k∏j∈d∖tiΓΓ∏l=01ΓΓ∗∏j∉dΓΓ∏l=01ΓΓ. 

here λl, μl, νl, l =  <dig>   <dig> are hyperparameters whose values represent beliefs concerning the expectation of the observable amplification prevalence under the three distinct categories.

the statistical learning model still requires the assignment of a prior distribution to values of the triplets  to describe the uncertainty about the presence of homogeneous hidden subgroups of tissue samples and the identities of the informative amplifications. this distribution is determined by

  p=pp, 

where we set the probability p  as

  p = c* i , 

where c is a constant, and i  is an indicator function which equals unity, if the partition s has at most k clusters, and zero otherwise. k denotes here a user-specified upper bound for the number of clusters, considered to be suitable for the problem at hand. thus,  assigns equal probability to all partitions which have at most k clusters. the conditional prior for the categorization of the amplifications is then specified according to

  p∝ξ∑c=1k|d∩tc|∑c=1k|d\tc|, 

where ξ is the probability that a particular amplification is group-specific for some class, and |·| denotes the cardinality of a set. the prior can be derived by considering the status of the informative amplifications in an arbitrary class. let ξ be the probability of a bernoulli event that an amplification is group-specific in some class, and thus,  is the product probability of such bernoulli random variables over all classes and the informative amplications. such a prior is therefore characterized by a penalty for complex models with an increasing number of classes and informative amplifications.

bayesian model learning algorithm
here we provide brief details for a stochastic search algorithm that is used to identify the optimal bayesian solution to the classification problem, i.e. the triplet  maximizing the posterior probability

  m^=arg⁡max⁡mp. 

the various intelligent search operators used in the algorithm are inspired by the novel non-reversible metropolis-hastings approach to bayesian model learning introduced in  <cit> , modifications of which have been applied by  <cit>  and by  <cit> , the latter work considering semi-supervised classification of fish samples based on gene marker data. the non-reversible algorithm of  <cit>  can be considered as a generic bayesian learning tool for models for which predictive likelihoods can be analytically calculated given any particular configuration of the structural layer of a model.

as in  <cit> , the model optimization consists here of two primary elements, the search for an optimal partition and the optimal categorization of the sub-bands into the three groups . our algorithm proceeds by repeatedly applying a variety of transition operators to the current state corresponding to a particular configuration of m. the changes that lead to an improvement in the posterior probability are accepted. in particular, after each proposed change to the partition s, the optimal groups of informative  sub-bands and group-specific  amplifications are identified, and using these, the putative partition is evaluated in terms of p  p . the search for m^ is terminated when no improvement in the model is accessible. the different search operators utilized to search the partition space are as follows:

 <dig>  move a tissue sample from one class to another.

 <dig>  join two classes.

 <dig>  split a class using complete linkage clustering  with some specified distance measure.

due to the complexity of the posterior distribution with respect to the model space topology, entirely local perturbations to the model structure, such as step  <dig> above and those employed in generic gibbs sampler algorithms  <cit> , would easily converge to a local maximum of the posterior. therefore, it is of importance to utilize intelligent operators enabling successful large jumps in the search space, as in the last step. the variety of hamming distance measures that we utilize in the splitting step are analogous to those considered in  <cit> . to facilitate the identification of the global optimum it is advisable to perform the search multiple times using alternative initial configurations. in cases where the algorithm identifies separate maxima on different runs, the obtained solutions can be coherently compared using the predictive likelihoods and prior probabilities p  p .

to actually operationalize the model learning, it is still necessary to explicitly specify the prior hyperparameters in  and . as demonstrated in  <cit> , the stochastic partition model with feature filtering is not sensitive to the specific choices of the hyperparameter values, given that they are within a biologically meaningful range. the value for the prior probability ξ that an arbitrary informative sub-band contains a group-specific amplification for some class is needed in the definition of the joint prior  for the qualitative layer of the model. in our default software implementation ξ is chosen to be equal to  <dig> . this choice prevents efficiently the emergence of spurious singleton classes, when the data contains a limited amount of information in terms of the number of informative chromosomal bands. as the amount of data increases, the effect of this prior becomes negligible, and in general, the exact value of ξ is of no crucial importance.

we also need to specify the prior distributions for the model parameters pij <dig>  qij <dig>  and wj <dig>  that define probabilities for an amplification being present when the corresponding sub-band is categorized as noninformative or informative . here we apply the findings of  <cit> , to scale the hyperparameters in an automatic fashion with respect to the amount of information in any given data set. the priors are specified according to:

 pij1~betaϕi)qij1~beta∗ϕi)wj1~beta∗n). 

where n is the total number of samples and f is the overall frequency of observed amplifications in the data. the term φi is a scaling factor that depends on the number of samples assigned in class i, such that

 φi = max {|si|, 10}, 

where |si| is the cardinality of class i. the hyperparameter α ∈  <cit>  determines the expected number of amplifications at a specific sub-band to be observed among the samples in a class, if the particular amplification is group-specific according to the model. thus, the value given to α should be fairly high to restrict the attention to strong signals of group-specificity. in our default software implementation we have used the value α = . <dig>  as this choice allows for some flexibility for the observed counts of zeros and ones, while preventing contradictory behavior of the model. however, in the validatory experiments reported below a range of different values of α was used to assess the sensitivity of the model with respect to this hyperparameter.

assessing model uncertainty
to provide a statistical measure for the model certainty in the vicinity of the estimated posterior mode, and to detect hot-spots over the considered chromosomal areas, where the amplifications yield an indication of being group-specific, or just informative, against being unrelated to the presence of heterogeneity among the tissue samples, we use posterior odds, which in the current situation allow conveniently the comparison of the relative plausibilities of any two models. posterior odds for model m <dig> compared to m <dig> is given by

  r12=pppp. 

with a sufficient amount of data the ratio of the marginal likelihoods ) dominates the odds and consequently, the odds will be closely related to bayes factors  <cit> , especially under the utilized fairly non-informative prior choices for the models. posterior uncertainty related to the assignment of any particular tissue sample i to the class in the optimal solution can now be characterized using .

assume that in the optimal model m^=m1=, the tissue sample i belongs to the estimated class c and we seek to compare this to an alternative classification where the classes are kept otherwise similar, except that the sample i is re-assigned to another class, say c*. let the new partition be denoted by s <dig>  a competing model m2= may thus be obtained by optimizing d <dig> and t <dig> with respect to the partition s <dig>  in this manner, the posterior odds  in favor of m <dig>  and against m <dig>  can be used as a measure of plausibility of the assignment of the samples into any of the alternative classes, which provides a statistical measure for the strength of the evidence for the estimated optimum solution. notice that conditional posterior distribution over the alternative assignments of the tissue sample may also be easily obtained through a normalization of the terms involved in  by summing over the classes. to explore the evidence in the data over the considered chromosomal bands in order to screen for amplification hot-spots, posterior odds can be analogously computed sub-band-wise. in this case, a natural comparison is between the model claiming a particular sub-band to be informative, e.g. group-specific, against the alternative hypothesis that the sub-band is noninformative. thereby, the values of the posterior odds can be used to screen for interesting areas over the chromosomes. these values, as well as the above mentioned types of posterior odds are automatically provided by our software implementation.

real database of dna copy number amplifications
the collection of  <dig> dna copy number amplifications in human neoplasms was obtained from  <cit> . these data were collected from  <dig> publications that report results of comparative genomic hybridization experiments on cancer samples. the data are reported in chromosome sub-band resolution . amplifications are recorded in binary vectors where  <dig> and  <dig> denote non-amplified and amplified chromosome sub-bands, respectively. there are  <dig> different neoplasm types in the database.

simulation design for validatory experiments
to investigate the performance of the model discussed above, we generated a large number of synthetic data sets and analyzed them using the described learning algorithm.

two basic simulation scenarios were used, with  <dig> and  <dig> underlying clusters of samples, respectively. for each scenario, three ranges of cluster sizes were considered, such that the number of samples in a cluster was distributed according to one of the following distributions: uniform, uniform, uniform. for each of these six combinations of the number of clusters and their size distribution,  <dig> data sets were generated under each of three different random levels of noise in the data . the parameter configuration used to generate a single data set was determined as follows. firstly, the number of group-specific amplifications was sampled for each cluster from uniform distribution. to mimic the properties of real amplification data, the total number of binary attributes included was set to  <dig>  the average total number of group-specific amplifications represented thus a bit over 50% of all attributes for the case with  <dig> clusters. for each cluster and amplification, the group-specific probability of observing an amplification was independently simulated from the uniform distribution. to regulate the amount of noise in the data, we chose the probability of observing a group-specific amplification outside its group to be at one of three distinct levels, . <dig>  . <dig>  . <dig>  independently for all clusters and group-specific amplifications. out of the remaining attributes, 25% were randomly chosen as informative, and their generating probabilities were sampled from the uniform distribution independently for each cluster and attribute. the other 75% of the remaining attributes were chosen to represent noise, such that the generating probability was for each attribute sampled from the uniform distribution, and the same value was used for each cluster. given the realizations of cluster size variables and of the generating probabilities for each cluster and attribute, a binary data set was sampled using them. an average data set with  <dig> clusters would thus have 375– <dig> observed samples under the three different distributions on cluster sizes. an analogous simulation scheme was used for the case with  <dig> clusters. for these data sets, the average proportion of noise attributes decreased to around 10%, because a considerably larger part of the  <dig> amplifications were modeled as group-specific. in total, there were thus  <dig> distinct sampling configurations, under each of which  <dig> parameter realizations and corresponding data sets were simulated, leading to  <dig> data sets.

each simulated data set was analyzed using four distinct values of the hyperparameter α, equal to . <dig>  . <dig>  . <dig>  . <dig>  respectively, to investigate the sensitivity of the inferences with respect to the choice of the prior specification. due to computational restrictions, stochastic optimization of the model was done only once for each data set. thus, the results may be considered as somewhat conservative with respect to the performance, because the learning algorithm would be applied multiple times in any real data analysis situation, which increases the chance of identifying the globally posterior optimal model structure. in the stochastic optimization we used the upper limit for number of clusters k equal to  <dig> , when the number of generated clusters was  <dig> . for comparison, each data set was also analyzed using an alternative method based on clustering without feature selection .

alternative methods
an extensive methodological literature exists for unsupervised clustering and feature selection. however, a majority of the articles in this area are concerned with the analysis of continuous data, often based on the use of gaussian mixture models combined with the em-algorithm for learning, e.g.  <cit> . several interesting alternative bayesian approaches to clustering discrete data with naive bayes -type models and various generalizations of them exist, e.g.  <cit> . however, for most such methods, software implementations are not publicly available. restricted by the availability of suitable software, we performed comparative analyses of the real amplification data using the em-algorithm based latent class mixture modeling method implemented in autoclass software  <cit>  and the stochastic partition model implemented in baps software, e.g.  <cit>  or  <cit> . due to the very large number of performed analyses, we used only baps software in the comparison for the simulated data. to test an algorithmic alternative method, we considered the standard k-means algorithm, see for example  <cit> . as k-means does not provide a coherent way for estimating the number of clusters, the number of clusters was specified in this analysis to be the same as the number of clusters inferred by the method described above. although the beta-binomial clustering model arising under the theory developed in  <cit> , and the latent class mixture model for binary data discussed in  <cit>  are conceptually derived under different theoretical frameworks, the resulting likelihood expressions are rather similar. thus, it is expected that the two methods will yield similar inferences, if the differences in the computational strategies adopted in the methods do not dominate for a particular analysis. the beta-binomial clustering model specifies the likelihood of the data x as

 p=∫Θ∏c=1k∏j=1d∏l=01pcjlncjlpdθ, 

including now only one type of parameters pcjl, with a noninformative jeffreys' prior :

 pcj <dig> ~ beta , pcj <dig> =  <dig> - pcj <dig>  

these specifications lead to the following form of the marginal likelihood:

 p=∏i=1k∏j=1d1Γ∏l=01ΓΓ. 

thus, in this simpler model the features are not divided into informative and noninformative, and further, no group-specific features are specified.

to illustate the potential of the stochastic greedy search algorithm for learning of complex models, we perform also a comparison with an optimized version of the gibbs sampling algorithm. both algorithms are used to cluster a group of artificial data sets, in order to compare their performances in solving an unsupervised classification task. the optimization refers here to the use of analytical integration to derive an expression for the conditional posterior probabilities of cluster labels for data items, where the parameters of class-conditional distributions are integrated out. in the standard version of the gibbs sampling algorithm this integration is typically performed via additional simulation steps, where values for the parameters of the class-conditional distributions are generated, which increases the computational complexity and makes the algorithm less efficient.

the gibbs sampling algorithm used in the comparison can be described as follows. let the state of the markov chain consist of ci, i =  <dig> ..., n, the cluster labels for the data items, i.e. ci ∈ { <dig> ..., k } for all i, where k is the specified upper bound for the number of clusters. the cluster labels have no meaning beyond specifying which data items belong to the same cluster. let c-i denote the cluster labels of other data items except i. the conditional distribution for the cluster label ci can be written as

  p ∝ p * p, 

where p  is the marginal likelihood of the data conditional on the partition specified by the cluster labels, and p  is the prior distribution for ci, conditional on the cluster labels of the other data items. by assuming that all partitions are a priori equally likely, it follows that

  p = d, 

where d is a constant. thus, the probabilities are the same for all clusters which are represented in c-i, and, in addition, one arbitrarily chosen empty cluster, while the probability of the rest of the empty clusters is zero . then, the gibbs sampling algorithm simply consists of iterations, each of which updates in a random order the cluster labels for the data items, drawing the new values from the conditional distributions . notice that the specified algorithm can be considered as a standard algorithm for sampling from dirichlet process mixture models  <cit> , apart from the different prior specification for the cluster labels.

to illustrate how the presented stochastic greedy optimization and the gibbs sampling mcmc strategies behave in practice, we employ a series of artificial data sets. we analyze each such data with both the described algorithms. due to computational simplicity, we employ in this comparison the algorithms with the simple beta-binomial model described above. because in this comparison both algorithms are used to optimize the structure of the same model, the results can be considered illustrative also for the relative time complexities in the case where the feature selection is included in the learning problem. both algorithms are executed twice, by starting the algorithms from two different initial setups. in the first initial setup all data items are assigned into a single cluster. for the second setup, the complete linkage clustering algorithm is utilized to create k <dig> +  <dig> initial clusters, where k <dig> is the correct underlying number of clusters. the number of iterations in the mcmc is specified to be  <dig> . we consider data sets of seven different degrees of complexity. the simplest data sets consist of  <dig> clusters, whereafter the number of clusters is increased up to  <dig> clusters using an equal spacing of  <dig> clusters. for each data set size, we generate five different data sets. the numbers of the data items are drawn independently for the different clusters from a uniform distribution over the set { <dig>   <dig> ..., 20}. each data item is characterized by a binary vector xi ∈ { <dig>  1}d, where we use value d =  <dig> for the length of the vector. we draw the frequency parameters θij for different clusters i and features j independently from

 θij~beta, 

thus following the assumptions of the simple beta-binomial model. the value d =  <dig> was selected because in preliminary experiments we found it to be suitable for the comparison. with higher values  both the algorithms were able to find exactly the correct partition in a short time, while with lower values  the data was not informative enough for a proper learning of the partition, and consequently both algorithms, especially the gibbs sampler, ended up far away from the optimal model. for reporting the results, we record for each run of the greedy algorithm the running time and the marginal likelihood of the model with the highest value. because the total running time of the mcmc algorithm is largely determined by the pre-specified number of iterations, it provides an unsatisfactory basis for the comparison of the efficiencies of the algorithms. a more reasonable estimate of the running time of the mcmc algorithm is obtained by recording the time to reach a model with an equal or higher marginal likelihood than the highest value found by the greedy algorithm. if the mcmc never reaches a model with such a value during the  <dig> iterations, we record the time needed to reach the model with the highest value in that run. to compare the goodness of the solutions found by the alternative algorithms, we select for both algorithms the model with the maximum marginal likelihood found in the two separate runs. we then use bayes factors to compare these top-scoring models .

RESULTS
comparison of algorithms with synthetic data
first, we present results from the validatory simulation experiments, and thereafter, comparison of the stochastic optimization and gibbs sampling algorithms is shown. the results from the validatory analyses are summarized in additional file  <dig>  exact results from the alternative clustering method without feature selection are not shown in additional file  <dig>  because they are uniformly inferior compared to the method proposed here. on average, the alternative method detected only 6– <dig> clusters and the adjusted rand index of the resulting partition was at best approximately 50% of the corresponding value for the proposed method. in most cases, the alternative method yielded an adjusted rand index value that was in the range of 1–10% of the corresponding value reported in additional file  <dig>  thus, without feature selection, mixture models are not expected to perform feasibly for pattern recognition of this type of data.

additional file  <dig> reveals that the penalties for increasing model complexity included in the adopted bayesian formulation are highly efficient, as there is no tendency to overestimate the number of clusters. comparison of the four distinct values of hyperparameter α highlights that there exists a trade-off between the accuracy in the inferences about the number of clusters and about discovering the group-specific amplifications. increasing the value of α brings in general the average number of inferred clusters closer to the generating model setup, however, simultaneously, there is a slight decrease in the proportion of correctly inferred group-specific amplifications. this is entirely expected, as a value of α closer to unity favors a very small fraction of zeroes to be observed for attributes that are considered by the model to be group-specific. however, the magnitude of differences between the different values of α suggests that the inferences are in general not very sensitive to the exact value chosen, as long as it is sufficiently large. therefore, our default implementation with α = . <dig> would seem appropriate.

values in additional file  <dig> reflect well the effect of the level of noise present in the generated data. when the proportion of uniformative attributes is small , the inferences are very accurate for all levels of noise, i.e. the level of the presence of group-specific amplifications outside their groups. when the amount of uninformative attributes is very large , the accuracy of inferences depends on the cluster sizes. under such circumstances, it is not expected that a model may reliably estimate underlying generating probabilities for a very small cluster with size in the range 5– <dig> samples, unless the probabilities are either close to zero or unity. even for the noisiest data sets, the estimation accuracy is remarkably high when cluster sizes are in the range 15– <dig> 

the results of the comparison of the two alternative algorithms, gibbs sampling and the suggested stochastic greedy optimization, to learn the optimal partition for artificial data are shown in figures  <dig> and  <dig>  figure  <dig> shows the average running times of the different algorithms. the results of the comparison of the optimal models found by the two algorithms are shown in figure  <dig> 

as can be seen from figure  <dig>  the running time of the mcmc algorithm increases rapidly as the complexity of the data set increases. in contrast, the greedy algorithm is considerably faster for all the data set sizes. for example, the execution times are approximately  <dig> times longer for the mcmc algorithm started from k <dig> +  <dig> as compared to the greedy search, when the most complex data sets are considered. a first look to figure  <dig> would surprisingly suggest that the mcmc started from a single cluster is performing faster than the mcmc initialized with k <dig> +  <dig> clusters. a closer inspection  shows, however, that this is not the case. recall that the time shown in figure  <dig> is the time required to reach a model with an equal value to that found by the greedy algorithm or, if no such model is found, a time required to reach the model with the highest marginal likelihood value in that run. as can be seen from figure  <dig>  neither of the mcmc runs found a model with equal predictive value to that found by the greedy algorithm for the data sets with k <dig> =  <dig>  moreover, for these data sets, the mcmc started with a single cluster never found a model of equal or higher value than the mcmc started with k <dig> +  <dig> clusters. the surprisingly low running times  in figure  <dig> for the mcmc started with one cluster are therefore explained by the fact the algorithm got faster stuck to a local mode in the model space than the mcmc started with k <dig> +  <dig> initial clusters.

dna copy number amplification data
the dna copy number amplification data described previously were analyzed using the default implementation of our method in the basta software. in particular, four runs of the estimation algorithm were performed using the user-specified upper bound k for the number of clusters equal to  <dig>   <dig>   <dig> and  <dig>  for the first two runs the algorithm converged to a solution with number of clusters equal to the initial number of clusters k, indicating that the posterior optimum contains presumably a larger number of underlying tissue groups. in the latter two runs, the algorithm converged to exactly the same solution, consisting of  <dig> clusters of samples.

a graphical image of the optimal clustering is shown in figures  <dig>   <dig> and  <dig>  such that figure  <dig> contains clusters with size ≥  <dig>  figure  <dig> clusters with size in the interval  <cit> , and figure  <dig> clusters with size <  <dig>  given the large number of tissue samples in the data, this categorization of the cluster sizes facilitates extraction of features from the images. an interesting characteristic of the clustering results is that several classes of tissue samples emerge, such that the members have amplifications in more than a single chromosome . this finding motivates further the treatment of all chromosomal bands simultaneously within the model, instead of splitting the cluster analyses over the distinct chromosomes. the analysis with k-means using  <dig> clusters identified a clustering which was relatively similar to the model-based clustering, with adjusted rand-index  <cit>  between the two partitions being  <dig> . however, although k-means discovered mostly coherent clusters, some of the identified clusters also contained samples which had few features in common. for example, the largest cluster identified in the k-means analysis seems to contain samples which are more or less randomly assigned together. the fifteen largest clusters from the k-means analysis are graphically presented in figure  <dig> 

when the copy number amplification data were analyzed using the simple beta-binomial model with baps software, the algorithm converged to a solution with  <dig> clusters only. these results are presented graphically in figure  <dig>  a highly similar clustering result was obtained with autoclass, which yielded  <dig> clusters. the adjusted rand index between these two results was . <dig>  which is a high value given the large size of the data base. we abstain from presenting the autoclass results visually, as the clustering image is nearly identical to figure  <dig>  the observed inability of a standard mixture model without feature selection to detect majority of the biologically interesting patterns is in harmony with the corresponding results from the analyses of synthetic data reported above. in figure  <dig>  we illustrate the behavior of the log posterior odds for the sub-bands being informative against them being uniformative, over the chromosomes. the relatively high information contents of certain chromosomal areas compared to others is clearly visible in the curve.

the bayesian clustering approach allowed us to determine cancer subtypes that were associated with a specific dna copy number amplification pattern. a cross-reference table between the obtained clustering and the known cancer types as well as the details of the clustering, including the amplification patterns for the clusters, are presented in the additional files  <dig> and  <dig>  the results illustrate the fact that subtypes of same cancer type may differ in their genetic make-up. identified amplification patterns represent specific subtypes of given cancer types. for example, five main subtypes of colorectal adenocarcinoma are characterized by amplification patterns of 13q11-13q <dig> , 20q <dig> -20q <dig>  , 20q <dig>  , 8q <dig> -8q <dig>   and 20p13-20q <dig>  . these subtypes may have different clinical behaviour and treatment requirements.

there is a new category of drugs that target receptor tyrosine kinases   <cit> . rtks are membrane proteins that are involved in signal transduction and are often implicated in cancer. in addition to mutations and protein over-expression, gene amplification is one of the main mechanisms that incur the oncogenic activity of the rtks. novel small molecule or antibody drugs have been developed to treat cancers that manifest ill-activated rtks and inhibit the enzymatic activity of the kinase domain or receptor binding of these proteins. there are approved cancer therapies that target receptor tyrosine kinases: trastuzumab inhibits erbb <dig> , imatinib targets abl , kit  and pdgfr , gefitinib and cetuximab interact with egfr , and bevecizumab hinders vegf  activity  <cit> . in addition to the approved use in treatment of metastatic breast cancer , cml and gist , non-small cell lung cancer  and colorectal cancer   <cit>  these tyrosine kinase targeting drugs could be used to treat other malignancies that have amplifications of the specific drug target genes.

generally, the bayesian method yielded similar results as the previous probabilistic modeling study  <cit> , where data from distinct chromosomes were treated separately. figures  <dig>   <dig>   <dig> suggest that this is due to the relatively low level of noise in these data. however, our experiments with the standard mixture modeling approach similar to that used by  <cit> , show that a completely different pattern emerges when the joint database over all chromosomes is considered, leading to very poor resolution under the standard model. clear advantage in using the bayesian approach is that the genome-wide modeling method facilitated the identification of amplification patterns, which encompassed areas from multiple chromosomes. there were  <dig> amplification patters that formed clusters of  <dig> to  <dig> cases: 1q and 3q ; 5p14-p <dig> and 8q11-8q <dig>  ; 17q and 20q12-q <dig>  ; 1q and 6p ; 1q and 8q ; 12q <dig> and 20q12-q <dig> ; 3q26-q <dig> and 7q21-q <dig> ; 19q11-q <dig> and 20q11-q <dig>  ;  <dig> and  <dig> ; 1q, 16p and 19q ; 11q and xq21-q <dig> ; 16p, 20p, 21p and 22q . because most of the multichromosomal amplification patterns encompassed large genomic regions and only few local amplification sites were identified, the site specificity and mechanisms of multichromosomal amplifications remains unclear. q-arm of chromosome  <dig> and 20q12-q <dig> regions seemed to be frequently present in the disjoined amplification patterns.

multichromosomal amplification patterns seemed to be randomly distributed among the cancer types and were not associated with any group of specific malignancies. the few numbers of cases in the clusters did not allow further inferences about the mechanisms or cancer type specificity of multichromosomal dna copy number amplifications.

CONCLUSIONS
in this work, we applied a bayesian model-learning approach to sub-classify human cancers based on dna copy number amplifications. an inherent part of the model structure was the division of the considered chromosomal sub-bands into informative and noninformative subsets, and further the specification of group-specific amplifications for each detected cluster. thus, both the clustering and the interesting amplification patterns are immediately available from our approach. another advantage offered by the bayesian paradigm is that it constitutes a firm basis for inferring the number of distint components  in the model. furthermore, the results illustrate the importance of considering jointly all the chromosomes, as several clusters having group-specific amplifications in different chromosomes were identified.

rather than looking at the appearance or behavior of a tumor, categorizing cancers according to their underlying genetic properties is likely to improve cancer management. tumors that arise in the same part of the body may appear histologically similar but still have totally different molecular changes. conversely, cancers from different origins and morphology could be addicted to same disturbed genes and protein pathways. understanding the genetic underpinnings of cancers and reclassification in molecular-level will help to develop new cancer treatments and apply currently available treatments to seemingly unrelated cancers.

the presented analyses illustrate the potential residing in machine learning and pattern recognition approaches as a tool for discovering biologically vital information from large databases, even when the measurements are relatively noisy. however, they also highlight the usefulness of tailoring the data mining methods to take into account particular biological features of the available measurements. in contrast, blind use of standard methods ignoring such features may yield poor insights about the underlying biological reality.

authors' contributions
pm and jc developed the bayesian modeling approach and the algorithms. pm implemented the learning methods. pm and jc carried out the analyses. sm participated in the design of the study and evaluated the results for the cancer data. all authors contributed to the writing of the final manuscript.

supplementary material
additional file 1
click here for file

 additional file 2
clusters and cancer types. a cross-reference table between the obtained clustering and the known cancer types for the dna copy number amplification data.

click here for file

 additional file 3
clustering details. details of the clustering results for the dna copy number amplification data, including the amplification patterns for different clusters

click here for file

 acknowledgements
this work was financially supported by the academy of finland grant no.  <dig> to jc, and by funding from commit  to pm. we would like to thank an anonymous reviewer for comments and suggestions that significantly improved the original version of the article.
