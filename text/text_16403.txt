BACKGROUND
alternative splicing generates different rna molecules from identical primary transcripts, affecting protein diversity by creating diverse mrna isoforms and modulating regulatory information in non-coding and untranslated regions in mrnas
 <cit> . the advance of next-generation sequencing technologies has allowed the high-throughput analysis of whole transcriptomes by rna-seq. in a typical rna-seq experiment, poly-a+ transcripts are enriched from a pool of rna, from which cdna is generated, amplified, and sequenced
 <cit> . analysis of rna-seq data entails inferring the transcript molecule corresponding to each read, along with estimation of relative abundances of transcribed and processed features
 <cit> . thus, rna-seq experiments have the potential to produce novel discoveries and facilitate tremendous progress on understanding mrna diversity generated by splicing.

despite the promise, there are important sources of ambiguity, bias, and noise in rna-seq data that have made accurate estimation of splicing differences difficult in practice. these problems arise at multiple steps in an rna-seq experiment. at the library preparation stage, sequence-dependent variation in amplification generates heterogeneous coverage artifacts
 <cit>  that lead to differences in exon read counts even in constitutively spliced genes. at the sequencing stage, cluster generation allows sequencing of only a portion of the library, leading to sampling biases and variation between technical replicates
 <cit> . at the alignment stage, reads with sequencing errors derived from paralogs and low sequence complexity regions confound abundance differences due to the preference for alignability over gap introduction
 <cit> . these problems have complicated the analysis of splicing by rna-seq. while performing simulations of rna-seq data generation is a common approach to benchmarking tool performance and characterizing errors, and several tools exist that perform simulations , flux simulator
 <cit> , and art
 <cit> ), these tools do not provide reporting that can easily be used to understand how aligner error affects downstream inferences on splicing, limiting utility.

current strategies for quantifying splicing differences from rna-seq data employ isoform abundance estimations , exon counts , and counts to pre-defined local regions . intron-centric splicing quantification has been proposed
 <cit> , and splice junctions alone have been shown to accurately quantify alternative splicing in cassette exons
 <cit> . in addition to this variety of measurements, there are multiple units of comparison used to identify splicing differences. classification of splicing differences between isoforms is non-trivial for complex gene models, and incomplete identification of these differences leads to ascertainment bias.

we developed a suite of tools called the splicing analysis kit  to model, analyze, and improve junction detection, and to enable a complete splice-junction centric analysis of rna-seq data . this software is available at http://www.cbcb.umd.edu/software/spanki and https://github.com/dsturg/spanki.


feature
1tophat offers criteria for filtering what is reported after the alignment stage. spanki provides additional criteria that can be applied after reporting.

2cufflinks assembles transcripts and merges with annotated genes.

3cuffdiff reports differential splicing by tss group, without specifiying the differential splicing event.

4dexseq provides results for exon-level abundance differences.

spanki analyzes and mitigates error profiles, based on simulations that closely mimic real data. uniquely, the spanki read simulator combines robust empirical modeling with detailed reporting that is geared toward evaluating splicing detection performance. this allows the production of simulations that approximate real experimental error profiles; and that, which can be applied to help develop an analysis pipeline or to generate a custom error profile for every sample. our modeling based on real rna-seq sequencing errors, coupled with simulations, reveals multiple sources of false positive junctions. spanki calculates and reports junction alignment diagnostics for post hoc alignment filtering methods to ensure accurate junction quantification.

we show that splice junctions provide a more direct and less ambiguous measurement of splicing than exon read counts of full length isoform abundance measurements. to address the problem of splicing event classification, we apply standardized and exhaustive splicing event ontologies with astalavista
 <cit>  and show that mutually exclusive splicing differences are effectively interrogated using junctions. the spanki software therefore demonstrates a complete set of routines for splice-junction centric analysis of rna-seq data.

as a test case, we examined splicing in drosophila melanogaster female and male heads. we chose these samples for two reasons. first, the central nervous system of many species is highly complex in architecture and is a rich source of alternative transcripts
 <cit> . additionally, the drosophila sex determination hierarchy is a classical model of regulated alternative splicing
 <cit> . three members of this hierarchy, sex-lethal , transformer , and male specific lethal  <dig>  encode broadly expressed alternatively spliced mrnas. the two terminal members of the hierarchy doublesex  and fruitless  are also alternatively spliced and are expressed in a restricted set of neurons, in addition to other non-neuronal tissues. we demonstrate that our approach produces alternative splicing measurements that are consistent with the literature and quantitative pcr  results, and provides superior detection of sex-differential splicing than other methods. in benchmarking tests with a null dataset, we show a lower false positive rate for differential splicing calls than commonly used tools and a moderate false negative rate.

RESULTS
analysis overview
analysis of alternative splicing with rna-seq data involves multiple interdependent components including mapping reads, identifying pairwise splicing differences, and quantifying alternative splicing. a variety of tools perform individual tasks, and null models are critical tools for evaluating how well these tools perform. we built a suite of tools called the splicing analysis kit  to generate null models from simulations, evaluate aligner performance, and quantify splicing differences. this toolkit is modular in design and can be used as a complete analysis pipeline, to evaluate exisiting pipelines, or to make informed decisions on parameters .

we used these methods to show that reads that directly detect intron removal  provide a basis for a complete analysis of splicing with advantages in specificity and low type i and type ii error rates. we demonstrated these advantages with simulated datasets and real biological data.

approach to error modeling
a common approach to examining splicing is to determine read coverage of alternative exons, assemble full length isoform models, and generate probabilistic abundance estimates of the alternative forms
 <cit> . the inherent problem with this type of approach is that reads mapping to exon space may originate from multiple alternative exons with different exon boundaries 
 <cit> . additionally, both read coverage heterogeneity and intron retention makes calling alternative splicing from exon counts problematic. in contrast, reads that span splice junctions derive from a true splicing event and unambiguously join exons, making this a much more useful measurement
 <cit> . however, mapping these reads is more difficult than alignment to a contiguous genomic reference, making high quality junction alignments critical for downstream analyses
 <cit> . since junction detection is the foundation of our analysis, we undertook simulations to quantitatively assess splice junction detection performance so that we could characterize and then filter out dubious junctions. we built simulated datasets in two steps: modeling and read generation .
 <cit>  alignment. these error models are used by the simulator to generate reads.  flowcharts of quantification and comparison methods. the first step is junction quantification , where alignments are performed, junction alignments are curated, and junction coverages are calculated. splicing event quantification , where a set of transcript models , are used to characterize pairwise splicing differences . these events are merged with junction coverage data to quantify the mutually exclusive paths defined for each event. splicing event comparison  uses these tabulated event-level quantifications to compare between replicates, and between pooled results for each sample, by fisher’s exact test on inclusion and exclusion junction counts.

the first step in the analysis of junction-based splicing detection is to identify and quantify the junction spanning reads . we performed this analysis using an annotation  or without. we then merged junction coverage data and estimated the relative abundance of the alternative forms . in the next step we classified splicing events from annotated transcript models to obtain sets of junctions that define mutually exclusive “paths”  that interrogate each path specifically. this allows us quantify alternative splicing using the percent spliced in  metric
 <cit> , which is simply the abundance of the inclusion form divided by the sum of the inclusion and exclusion forms. to find the number of genes alternatively spliced, we selected events for which junction coverage was detected over the inclusion path in either sample, and over the exclusion path in either sample and performed statistical testing .

error models and simulations
we aligned rna-seq reads with permissive parameters  using bowtie
 <cit>  in order to estimate total mismatch profiles along the full length of the reads. as has been previously reported, we observed increased mismatch rates extending through the 3′ end of the read and a slight increase in mismatch rates in the first  <dig> bases
 <cit>  . we determined nucleotide mismatch frequencies by position in the read and by substitution type. these frequencies are used by the spanki read simulator as weights in a weighted-random selection, to choose the total number of mismatches in a read, mismatch positions, and base substitution. we supplied these error models to the spanki read simulator to generate a defined known input sample generated in silico from annotated transcript models, with error profiles matching these empirical models.

to generate simulated reads, we extracted transcript sequence from each d. melanogaster annotated gene model and generated  <dig> pools of simulated 76 bp paired-end reads at 1-30x coverage where the error profiles matched our real data. this produced pools where transcript coverage is equalized, allowing us to examine the coverage-dependent effects on detection. to model retained introns, due to either regulation or incomplete processing, we generated 20% of the reads from transcript models with introns included. we applied this elevated rate of intron retention  intentionally to increase aligner error. modeled error frequencies were applied as weights for mismatch number, position, and substitution. to enable the tracking of aligner errors, we incorporated the genomic coordinates of origin for each read into a unique read identifier. we then uniquely aligned the reads using tophat
 <cit> , and compared alignment results to the known input to explore splice site detection parameters. this two-step process generated a simulated data set that mirrors the experimental dataset, except that the true input was known, providing us a platform for testing rna-seq junction alignment. results that follow provide evaluation results for the tophat aligner
 <cit> , although the same approach can be applied to any aligner output.

we compared junction coverage with known input abundance for all junctions in the 10x transcript coverage pool . since multiple transcripts at a locus may share a given junction, individual junction coverage was 1-400x  reflecting both the random sampling of read positions and overlapping d. melanogaster transcript models at a given locus. our junction coverage measurements had high concordance with simulated input  demonstrating that junction coverage closely tracks known input.

junction spanning reads are a small portion of the total reads in an rna-seq experiment  raising the possibility that sufficient coverage for calling junctions would be problematic. to test for the effects of read depth on the false negative rate, we generated pools of simulated reads for each annotated reference transcript at multiple fixed coverage levels  and aligned these simulated reads with a reference annotation  or without , and compared detection results with known input . we detected >90% of junctions with 3x simulated transcript coverage when we provided an annotation. without the benefit of annotation, we found that 6x coverage was required to reach this level of sensitivity. reaching this level of coverage for each annotated transcript  required  <dig>  million read pairs . to put this in context of experimental data, we typically detect >  <dig>  transcripts at ≥ 6x coverage with  <dig> million mapped reads in drosophila rna-seq experiments.

we simulated sequencing depths by sampling in  <dig> million read increments from one high-depth experiment by random selection , and evaluated the relationship of read depth, detection of junctions, and detection of annotated transcripts in each pool. this enables us to evaluate detection in which relative transcript abundances match the biological sample. in this analysis, we define “new” detections as features that are not detected in a lower-depth pool. we found that >  <dig>  junctions  were detected in the first  <dig> million reads and that a 10-fold greater read depth added ~ <dig>  more junctions . at depths of >  <dig> million mapped reads, the number of cumulative false positive detections exceeded the cumulative number of new junction detections , as well as the number of new junctions detected robustly , and the number of new annotated transcripts detected with at least 6x coverage began to level off . additionally, the contribution to detected isoform complexity diminished with added depth, as new detections were increasingly from single exon and constitutively spliced genes. we did not observe over-representation of any splicing event type with increased depth. we generated normalized transcript abundance estimates in units of fragments per kilobase per million mapped reads , and found that we obtained 6x coverage of 95% of the transcripts reliably detected at fpkm ≥  <dig> in the full dataset . we examined the false positive rate at multiple transcript coverage levels  and found that the rate increased with greater transcript coverage due to cumulative errors in alignment. these data indicate that greater read depth provides more opportunities to call false positives. however, the majority of the false positives can be filtered post hoc  as we explain later.

false negative junction detection
junction detection is a function of sampling within a sequenced transcript, aligner performance, and multiple isoforms sharing a junction . to separate these factors, we analyzed junction detection false negative rates in constitutively spliced genes .

we removed the effect of sampling by analyzing detection when at least one junction spanning read is generated in the simulation. this effectively gives us the false negative rate of generating an alignment when at least one junction spanning read is present . when the aligner was provided with the annotation, the false negative rate of alignment was 1% at 1x transcript coverage. without an annotation, the false negative rate was 40%, but declined to < 10% at 7x coverage. these results show that coverage requirements are modest when working with genomes with well-defined transcript models. without an annotation, islands of read density are required to generate a reference of putative junctions; so false negative rates at low coverage are high. at high transcript coverage, the false negative rate of junction alignment was modest. we estimated the false negative rate of alignment using the detection deficit at 30x transcript coverage observed in figure 
2b. we divided total detected junction spanning reads by total simulated input, and obtained a false negative rate of  <dig> %. we also examined junctions that differ in a small number of nucleotides from other junctions . we found higher false negative rates for this class of junctions . these overlapping junctions pose more difficulty for the aligner to detect, but they represent a small fraction of annotated donors  and acceptors .

when we removed the requirement that a junction spanning read was generated, we found false negative rates to be driven primarily by sampling . false negative rates were 48%-68% at 1x transcript coverage. if we apply the entropy cutoff criterion, we find much higher false negative rates, since at least four unique alignment offsets are required to meet this entropy ≥  <dig> threshold. false negative rates did not decline below 50% until 6x transcript coverage, illustrating that quantitative filtering is overly stringent for the detection of rare variants.

the qualitative criteria we described are not sequencing-depth dependent, and hence have no relationship to transcript coverage. one criterion  can be applied without an annotation, and we estimate the false negative rate of applying this criterion at the 80% threshold is  <dig> % .

false positive junctions
rna-seq experiments can reveal splice junctions that are not yet annotated. distinguishing novel detection from experimental error in this class of junctions is a major challenge. even though the false positive rate was <  <dig> %, with tens of thousands of junctions detected, even these low error rates generated hundreds of false positives that would be counted as novel splice junctions in experimental data sets. junction detection errors have far-reaching downstream effects such as calls incorrectly supporting gene merges, antisense transcripts, and alternative splicing events.

while there are multiple sources of error in junction calling , the dominant error source was due to the aligner introducing junctions to reduce mismatch rates. this can be illustrated by examining extended motifs in introns. the most common donor/acceptor motif pattern is gt-ag, and these major forms have additional well-defined motifs within the intron sequence whether they are from annotated or un-annotated junctions . however, in low sequence complexity regions with either very high or very low % gc , mismatches induced a more optimal alignment when the read was split and joined to another segment up or downstream. this type of error can be clearly seen by the absence of an extended motif , and over representation of the motif “aggt” on both ends of the junction . we performed additional simulations consisting only of contiguous genomic sequence to estimate the frequency of this error class.  <dig> million simulated reads from contiguous genome sequence resulted in  <dig> false positive junctions. thus, in an rna-seq experiment with, for example, contamination from genomic dna, repeat-induced errors will be generated at a rate of  <dig> per  <dig>  contaminating reads. given that an intron is often used as evidence for a transcript and not contaminating dna
 <cit> , these errors can lead to false calls of intergenic transcription when accompanied with artifactual coverage islands in intergenic space. confidence in junction calls in intergenic space is therefore critical in resolving the existence of pervasive transcription
 <cit> .

1
2

total defined errors:
total removed errors:
1false positives removed by spanki’s qualitative filtering.

2false positives removed by filtering on entropy score , calculated by spanki.

to lower the false positive rate, it is important to understand the nature of the errors. we examined sources of alignment error leading to false positives at 30x coverage and classified them . one major source of error was false detection of junctions from rare “minor-form”  introns, which represent a small fraction of introns in d. melanogaster annotation
 <cit> , and less than  <dig> % of introns across metazoan lineages
 <cit> . although at-ac introns are > 100x rarer than gt-ag introns in the annotation , tophat chose the more optimal alignment, resulting in the false placement of a gt-ag spliced alignment on a proximal at-ac site because of an alignment with fewer mismatches at a proximal at-ac site than to the correct gt-ag site. introns with the at-ac dinucleotide are similarly rare in other species . the preference for optimal alignment with fewer mismatches also led to false positive alignments on incorrect strands. in rna-seq data from non-strand-specific protocols, the strand is inferred from the sequence of the interior donor/acceptor motif. for example, a shift in the 3′ end of the alignment causes a  strand gt-ag intron to be read as a  strand minor form gt-at intron. if uncorrected, errors of this type lead to the false prediction of antisense transcripts. mismatches resulted in alignment to the wrong site in the gene model. within this class of errors, 33% correctly place one end of the alignment , 12% of them incorrectly join annotated donors and acceptors from different transcripts of the same gene, and the remainder place neither donor or acceptor correctly. these pernicious errors result in the false appearance of alternative isoforms. similarly, the joining of paralog exons, which reside proximally in the genome, occurred when a splice junction originating from one paralog was aligned as a join between separate paralogous genes, falsely merging distinct genes into a single model. this class of error may be more prominent with aligners that allow indels or gene fusions. for example, we found paralog joining in 24% of false positives called by tophat2
 <cit> .

filters
after characterizing error sources, we sought to remove as many as reasonably achievable . we first examined the effectiveness of a simple quantitative cutoff on the alignment shannon’s entropy score
 <cit> , a metric that quantifies alignment complexity based on diversity of alignment offsets. requiring an entropy score ≥  <dig> for each junction removed  <dig> % of false positives. however, since quantitative filtering criteria are overly stringent in the case of rare transcripts, we developed a series of qualitative criteria that removed  <dig> % of false positives while allowing analysis of low abundance junctions.

to prevent strand switches and gene merges at paralogs, we identified the most likely gene of origin of each donor and acceptor based on genomic overlap and strand, and required agreement. junctions were flagged as “ambiguous” if each edge was assigned to a different gene or if either end was assigned to no gene, allowing us to filter them out. we found that filtering on this simple criterion was effective in removing all false positive junctions in simulated data where a junction was called on the wrong strand or if paralogs were incorrectly joined .

to filter repeat sequence induced errors, we used the edit distance between exon shoulder sequence and intron sequence. for each junction, spanki compared 10 bp upstream of the donor to 10 bp upstream of the acceptor, and 10 bp downstream of the donor to 10 bp downstream of the acceptor, and reported the percent identity. using a threshold of 80%, this comparison revealed cases where similarity between putative exon and intron sequence generated false gapped alignments. we found that filtering junctions where introns were > 80% identical to up or downstream exon sequence removed all these errors . to remove cases where mismatches induced alignment to a minor form intron, we removed introns of this minor class when they were not annotated .

applying the qualitative filtering criteria above removed  <dig> % of false positive junctions in our simulated data. the remaining  <dig> % of false positives were qualitatively identical to true positives and could not be filtered. these false positives are consistent with the strand of the gene model and are adjacent to canonical donor and acceptor dinucleotides. while we do not evaluate them here, machine learning methods that evaluate extended sequence motifs
 <cit>  hold promise for filtering these errors. nevertheless, qualitative criteria removed  <dig> % more false positives than using entropy scores alone. importantly, we achieved this reduction in false positives without requiring junctions to be detected with high coverage. our abundance independent qualitative filtering led to an overall false positive rate of <  <dig> % across all simulated read depths.

junction filtering is critical for accurately defining the splicing event landscape of the transcriptome, as each false positive can incorrectly define alternative donors, acceptors, and cassettes. studies in organisms with incompletely annotated genomes rely heavily on empirically detected junctions. spanki’s design allows the flexible application of these filters, which is critical to accommodate different sample types and alignment strategies. for example, aberrant splicing may be a feature of interest in mutant or cancer samples, rather than an artifact to filter out
 <cit> . although we present results using the first generation tophat aligner, other tools allow searching for fusion transcripts , or non-canonical splicing variants . in these cases, simulation allows for assessment of error rates and selective application of filters.

differential splicing detection
to identify cases of differential splicing between samples, it is essential to find where splicing patterns diverge to define a unit of comparison. basic categories of alternative splicing incompletely describe complex splicing patterns, which can lead to under-reporting of differences. we applied standardized and exhaustive splicing event ontologies with astalavista
 <cit>  to ensure that pairwise splicing differences are interrogated completely. spanki parses astalavista output to obtain sets of junctions that define mutually exclusive “paths” , to identify junctions that interrogate each path specifically. we use the detection of coverage over these junctions to calculate psi.

to analyze false positive calls of differential splicing, we generated a spanki null model for splicing differences by simulating four read pools, each of which contained reads from all annotated transcripts in equal abundances of  <dig> reads per kilobase . we then analyzed this null dataset, applying junction filtering and spanki junction-based event definitions, and also compared technical and biological replicates of real rna-seq data to each other. we performed a systematic categorization of all pairwise relationships using astalavista
 <cit> , which constructs graphs from transcript models and outputs complete and non-redundant sets of splicing differences identified through graph alignment . we used these pairwise definitions to make comparisons on the psi metric calculated by spanki. we found minor variation due to sampling alone and technical replication , but biological replication was a much greater source of variability . low total abundance events showed the most disagreement between replicates .

next we compared the number of differential splicing calls made in our simulated null dataset by spanki and by several other methods. spanki correctly called zero events differentially spliced in this dataset . we counted reads that map within exons using the script provided with dexseq
 <cit> , and performed an exon-level differential analysis. dexseq also called zero exons differentially expressed, however, with a reduced sensitivity to real alternative events in other data sets . next we performed an isoform-centric analysis using miso
 <cit> , which called differential splicing in transcripts of  <dig> genes. analysis with cuffdiff
 <cit> , with default parameters except for specifying upper quartile normalization, called  <dig> loci as differentially spliced, and  <dig> isoforms were called differentially expressed in our null input dataset with no true differences in splicing.

to analyze the false negative rate of differential splicing detection, we generated two simulated datasets with a known psi splicing difference. to prevent cross-talk, we selected splicing events where both the inclusion and exclusion forms were composed of transcripts that were not part of any other splicing event , and simulated one pool so that psi =  <dig>  for all events, and a second pool with  <dig>  psi for all events, so that comparing the two would yield - <dig> Δpsi. after processing these data with spanki, the Δpsi values clustered at - <dig> Δpsi  . spanki failed to call significant differences in  <dig> events  with fdr correction . cufflinks with the jensen-shannon divergence  metric had a 29% false negative rate, but performed better when comparing isoform abundances, failing to find differential isoform expression in only 5% of isoforms where an abundance difference was simulated. at the exon level, dexseq had a false negative rate of 19%, but with false positive differences in  <dig> genes. miso performed the best at this task, which did not detect a splicing difference in  <dig> genes . these results show that this simulation was a challenge for these tools and produced high false negative rates, but spanki performed comparably to other tools at the same task.

this junction-based calculation of splicing differences is a more balanced and less biased measure than exon counts. although exon counts yield more data, ambiguity of assignment , coverage heterogeneity
 <cit> , and unprocessed transcripts
 <cit>  make these data unreliable. exon counts are also a more imbalanced measurement of alternative forms. for example, in the case of skipped exons, the cassette inclusion form can be interrogated by reads within the cassette, but the exclusion form has zero exonic space that can be uniquely interrogated. this imbalance can be extreme, as in the case of multiple large coordinate cassette exons. this means that exon counts provide an inaccurate measurement, and to only one side of a comparison of proportions, further compounding the bias.

splicing detection in d. melanogaster heads
to test the performance of post hoc filtering and alternative splicing detection, we generated rna-seq data on sexed d. melanogaster heads . spanki quantified  <dig>  filtered junctions arising from  <dig>  genes in our d. melanogaster head rna-seq data . to analyze the full repertoire of splicing complexity, we analyzed all pairwise relationships defined by astalavista
 <cit> . this analysis yielded  <dig>  pairwise-defined alternative splicing events . of these,  <dig>  were internal events  and the remaining  <dig>  were alternative promoter events. while alternative promoter use is not alternative splicing per se, we included these in our analysis since isoforms from alternative promoters are biologically relevant. our method discriminates alternative first exons that differ in their splicing, and excludes overlapping first exons that differ only in their five-prime ends. the majority of splicing events were cassette exons, mutually exclusive exons, alternative donors, alternative acceptors, alternative first and last exons, and retained introns. however,  <dig>  internal events  did not fit into the seven basic categories. of this class, “skip two exons”  was the largest category, followed by “alternative donor and acceptor” . this latter category is an example of a structure overlooked by classifications into basic categories
 <cit> . an additional  <dig> events  are termed “unclassified” because they have no concise verbal description, but these do receive a code describing the graph pattern. the top five occurring structures in the “unclassified” category comprise  <dig> % of these events, each of which represent a variant of a skipped exon event.

we then used spanki to merge junction coverage data and estimate the relative abundance of the alternative forms. we found that  <dig>  splicing events in transcripts from  <dig>  genes were alternatively spliced in head samples  . we found  <dig> events with significant differences between female and male heads . to conservatively adjust the sex-biased expression calls for rare events and biological variability as outlined previously, we demanded > <dig> junction reads in each path, and that the unadjusted p-value for the between-sexes comparison was less than the unadjusted p-value between biological replicates. in light of the variance we observed in our null dataset  and between biological replicates , we also set a conservative threshold on the difference between samples at >  <dig>  psi. this filtering yielded  <dig> events in  <dig> genes significantly different between the sexes , including members of the sex-determination cascade. strikingly, the genes showing sex-biased transcription profiles at the gene level are not the same genes that show sex-biased splicing  suggesting that targets for sexually dimorphic expression are regulated by transcriptional or post-transcriptional mechanisms, but less so by both. like sex-biased splicing, we find that sex-biased gene expression is modest in heads , compared with the large amount of differential expression in the whole adults with gonad tissue
 <cit> . these splicing events were validated by quantiative pcr in independent biological samples . we found stronger agreement when either the inclusion or exclusion forms were dominant, than when proportions were more equal . this suggests that much more extensive biological replication is needed to resolve any regulated small differences in splicing from biological noise.

1
2
3
1psi in females – psi in males. table is sorted by Δpsi absolute value.

2p-value from fisher’s exact test, fdr corrected by benjamini-hochberg.

3selected terms , extracted from the “summary information” section of each gene’s flybase entry
 <cit> .

many of the sex-biased splicing events we observed may be important for sexual behavior based on known gene functions. reticulon-like  <dig> had significant differences at several pairwise defined alternative first exons. rtnl <dig> encodes a membrane protein localized to the endoplasmic reticulum
 <cit>  and has a role in inter-male aggressive behavior
 <cit> , olfactory response
 <cit> , and motor axon development
 <cit> . another gene with sex-differential skipped exons, multiplexin, is involved in motor axon guidance
 <cit> , although without a known link to behavior. we detected sex-differential regulation in transcripts encoded by the found in neurons  gene, which encodes a member of the embryonic- lethal abnormal vision  gene family of rna-binding proteins
 <cit> . wildtype fne is required for robust male courtship behavior
 <cit> .

our splicing calls for the sex determination transcripts were more sex-biased than in previous rna-seq experiments
 <cit>  on whole adult flies. to help determine if this was due to methodology, we also quantified splicing events using measurements of exon coverage and normalized isoform abundance estimates , to see if these approaches yielded similar results. these metrics predicted results that were much less sex-specific; for example in the case of dsx sex- specificity was  <dig> -  <dig> % by exon counts or fpkm, and  <dig> - <dig> % by spanki . there are possible technical explanations for the non-sex-specific exon read results, including the sequencing of transcripts that are polyadenylated before splicing is complete . inefficient poly-a selection due to oligo  priming in unprocessed transcripts may also play a role
 <cit> . our measurements using splice junctions better reflect processed transcriptional output. these results show that using junction coverage with spanki results in more switch-like splicing difference calls. similarly, we found highly sex-biased splicing of other members of the sex determination cascade, except for the tra locus where incomplete splicing to the female form is known to occur
 <cit>  . none of the other splice detection methods called sex-biased splicing for each of the sex determination gene transcripts , clearly highlighting the improvements made with filtered spanki output.
 <cit> , which relies only on exon-level counts, detected significant differences in fru, sxl, and dsx, but not in msl- <dig> or tra. similarly, a bayesian analysis with miso
 <cit>  failed to detect differential splicing of msl- <dig> transcripts. for cuffdiff
 <cit> , we examined results for the splicing difference test , and also for isoform abundance differences.

as expected for any expression study based on sampling, we did see greater variability at low abundance, but when abundance was high, results were stable. at high simulation coverage, psi quantification was also accurate . the results for dsx and the other sex determination targets greatly exceeded the  <dig> junction counts threshold. although higher counts do indeed give more stable measures of proportions, the effect we are observing in this case is sex-specificity, for which junction counts are a superior measurement.

CONCLUSIONS
junction-based splice calling is an important method for analysis of alternative splicing. our results highlight many of the junction-read errors that can occur in these rna-seq datasets and outline simulation strategies for modeling these errors, either while developing an analysis pipeline, or tailored for each experiment. we have implemented tuneable filters in spanki to remove false positives without sacrificing specificity, and clearly show that developing error models from real rna-seq data and applying these post hoc filters improves splicing detection in d. melanogaster heads. failing to filter for sequencer and aligner error, to account for mapping ambiguity in transcriptome space, and to under-estimate the null distribution of splicing differences, results in inaccurate estimation of splicing differences in rna-seq studies.

