BACKGROUND
a fundamental task in evolutionary biology and comparative genomics is to quantify the similarity between biological sequences and then assess their evolutionary relationships. the challenge is in particular to distinguish between homologous  and unrelated sequences. dna and protein sequences similarities are usually assessed through an alignment of sequences. the scoring function is crucial in the alignment process: not only it enables to choose the best pairing between the sequences among all possible, but also it is often at the heart of the evaluation of the alignment significance. indeed, a p-value or e-value is usually derived from the score of the alignment to assess if it is statistically different from one that can arise by chance . substitution matrices are therefore key parameters in the alignment process since they assign an elementary score to each match and mismatch between any two letters of the alphabet. this is particularly relevant in the case of protein alignment. as the protein alphabet contains  <dig> amino acids with different frequencies in biological sequences and different biochemical properties that may impact the protein structure, matches and mismatches between amino acids are not equipropable. it is thus crucial to take into account these differences in order to estimate accurately the similarity between sequences.

the most widely used matrices are the blosum  <cit>  and pam  <cit>  series. they were both derived from real sequences where the substitution frequencies between amino acids were observed. the two approaches differ in the way they derive several matrices, each of them reflecting a given level of sequence divergence. whereas the pam approach uses a model of evolution to derive new matrices at a given amount of evolutionary time starting from an inferred matrix scaled for a unit of time, the blosum one is purely empirical and infer substitution frequencies for each matrix from observations on sequences with the given level of divergence.

these matrices are typically expressed in log-odds scores: the score of the pairing of two amino acids is the logarithm of the ratio of the likelihoods of this pairing under two hypotheses: homology versus chance. it reflects thus how likely two aligned residues are descendants of a common ancestral residue with respect to random pairing: if the pairing of two residues is more likely to arise by chance than by homology the score will be negative, in the opposite situation it will be positive. consequently, two probabilities need to be computed: the one of observing the two residues aligned in an alignment of homologous sequences and the probability of observing the two residues aligned in unrelated sequences. the latter can be easily computed when assuming independence between the sequences, that is the probability of drawing at random these two residues among all residues present in the sequences, it is thus the product of their frequencies in the sequences, also called the background frequencies. the first probability, also called the target frequency, is inferred by counting the amount of each kind of substitutions in homologous sequence alignments.

for both approaches, the reference set of homologous sequences used to estimate the substitution frequencies is therefore essential and the resulting matrices will reflect both the composition and the evolutionary characteristics of these sequences. for both matrix series, this reference set was composed of "classical" sequences and together with the large size of the datasets, this gave matrices with an "average" amino acid composition. however, sequence compositions can vary drastically, and one can find groups of sequences with atypical compositions: certain types of proteins have a composition directly correlated to their function, such as transmembrane proteins which include tracts of hydrophobic residues. additionally, at the scale of the whole genome, some species show extreme nucleotide compositions that affect their amino acid composition, one of the most extreme example being the malaria agent, plasmodium falciparum, with a 80%- a+t genome  <cit> .

keeping the rationale of log-odds scores in mind, we can easily figure out that the classical matrices will not perfectly fit sequences with biased amino acid composition. basically, the likelihood of each match and mismatch under the null hypothesis of unrelated sequences will vary according to the differences in the background frequencies. for instance, for amino acids which are rare in classical sequences but much more abundant in the sequences of interest, the probability of observing their pairing just by chance would be greatly underestimated in the classical matrices and therefore their log-odds score will not reflect a "true" likelyhood ratio. as a consequence of these discrepancies the resulting alignment can be wrong  and also mis-evaluated, both leading possibly to mis-interpretation of the similarity. this issue has already been pointed out from a theoretical point of view by yu et al.  <cit>  and several studies have highlighted the negative impacts of using classical matrices in homology and database searches in atypical compositional contexts  <cit> . these papers proposed several methods to modify the matrices and derive new ones fitted to some compositional biases. two different approaches can be noticed. the first one is called matrix adjustment and consists in transforming the classical matrices by applying some mathematical formulas on its elements, taking into account the old and new amino acids background frequencies. the first adjustment was proposed by yu et al. and further implemented in the well-known  program blast  <cit> . later, coronado et al. deviced a similar method for low complexity sequences and showed an improvement over classical masking strategies  <cit> . the main advantage of these methods is their speed and usability on any sequence. however, their main drawback is that they only take into account the differences in the background frequencies, assuming the target frequencies are the same. therefore they do not reflect specifities of mutation or selection biases in the substitutions, still leading to inaccurate likelihood ratio. moreover the composition is estimated independently for each aligned sequence and consequently may not reflect the overall composition of the genome or group of proteins of interest. since each protein is aligned with a different scoring function, comparisons of scores are not straightforward and may not be pertinent in the case of genome-scale comparative analyses. the second approach addresses these issues, and consists in building new matrices from scratch in a similar way to the blosum or pam approaches but using an initial dataset of sequences with the desired compositional bias. in this manner, two groups proposed simultaneously two similar methods based on the blosum approach in order to compare the proteins of the plasmodium genus  <cit> . bastien et al. also used this approach to build asymetric matrices enabling to compare proteins with an atypical amino acid composition  against "classical" proteins   <cit> . these previous works have shown the feasibility and the benefits of such approaches, at least in the extreme case of plasmodium. however these have not been shown for less extreme cases of compositional bias, nor for the comparison of a large number of genomes at diverse levels of divergence.

in this paper, we address the problem of designing new substitution matrices fitted to the compositional bias of mollicute proteins. mollicutes are a particular class of bacteria derived from gram-positive bacteria, including for instance the well-known mycoplasma genitalium species. mollicutes share several atypical features such as a small cell size, the absence of a cell wall, a dramatically reduced genome with simplified metabolic pathways, and of particular interest here, a nucleotide composition biased toward a and t . they exhibit a wide variety of phenotypes with diverse host environments ranging from plants, arthropods to vertebrates, and also with various pathogenic or non-pathogenic impacts  <cit> . with the advent of new sequencing technologies, the number of mollicute genomes fully sequenced has greatly increased in the last couple of years, making the comparative genomics analyses more challenging. currently  <dig> whole genomes from  <dig> distinct species are publicly available in the reference database molligen , some of which diverged up to  <dig> million years ago  <cit> . this constitutes therefore a large set of genomes with a similar compositional bias, and with high comparative interests at various evolutionary scales. the objective of this work is to increase the sensibility and specificity of homologous and orthologous predictions among this large number of genomes. we present in this paper the methodology developped to build a new matrix, molli <dig>  specially fitted to mollicute proteins, and we show that it enables better performance in predicting orthologs and homologs with respect to the use of the classical matrix blosum <dig>  finally, we argue that the methodology could be easily generalized to other cases of compositional bias and could be useful in numerous comparative studies, given the recent and massive increase in genomic resources.

RESULTS
compositional bias of mollicute proteins
the nucleotide composition of mollicute genomes is strongly biased towards a and t, with a g+c content that varies from  <dig>  to  <dig> % with a median value of  <dig> %. mycoplasma pneumoniae appears as an exception among the mollicutes, with a g+c content almost "normal" of 40%, wheras all the other sequenced mollicutes have their g+c content less than 32%. as a consequence, the composition of their protein sequences is also biased towards certain amino acids. strong differences between frequencies can be observed in figure  <dig>  where the average amino acid frequencies of the coding sequences of  <dig> mollicute genomes are plotted against the ones derived from the usual blosum <dig> matrix. for instance isoleucine, asparagine and lysine are more numerous in mollicute proteins, whereas alanine, arginine and glycine are depleted. as expected the former are encoded by at-rich codons, and the latter by gc-rich codons, suggesting that these frequency differences stem from the genomic nucleotide compositional bias. we confirmed this relationship by performing the so-called garp-vs-fymink analysis  <cit>  where we can observe, in mollicute coding sequences, a strong positive correlation between the proportion of garp amino acids  and the gc content, and conversely a negative correlation with fymink amino acids  . given such differences in amino acid frequencies, we hypothesized that blosum <dig> may not be well fitted for the purpose of aligning mollicute protein sequences.

molli60: the new substitution matrix
the main result of this paper is the generation of a new substitution matrix, called molli <dig>  which is better fitted to the compositional bias of mollicute protein sequences. we generated this matrix with an approach similar to the one used to generate the well-known blosum matrices  <cit> . this consists in learning the amino acid substitution frequencies from the alignments of real sequences. whereas the blosum matrices were built from sequences originated from a variety of organisms, we selected here sequences only from mollicutes to get frequencies representative of the compositional bias of these genomes. a curated set of  <dig> protein families from  <dig> mycoplasma genomes was used as learning set . sequences in each family were aligned with t-coffee  <cit>  and from these multiple alignments conserved gap-free blocks were extracted. this gave a set of  <dig> blocks containing overall  <dig> columns and  <dig> total amino acids. this is the same order of magnitude of the the amount of data used to build the blosum matrices, which was constituted of  <dig> blocks and a total of  <dig> amino acids. to estimate the substitution frequencies, highly similar sequences were clustered to obtain a matrix reflecting to a certain amount of divergence between the sequences to align. thus, to compare with blosum <dig> we used a similar clustering coefficient of  <dig> and scaled the matrix similarly as blosum <dig> to obtain half-bit scores . the matrix, molli <dig>  and the scripts to compute it are provided as supplementary material .

global features of the matrix were then investigated, such as the entropy and expected values. these are commonly computed for substitution matrices and reflect the level of stringency of the matrix. typically, a matrix with a lower entropy and a greater expected value will reflect more diverged sequences. we reported also, in table  <dig>  the average scores for mismatches and matches. overall, we obtained very similar values between molli <dig> and blosum <dig>  as compared with blosum <dig> , suggesting that both matrices have the same global properties.

however, when looking more closely at each individual element, we can see in figure  <dig> that the two matrices are quite different with almost half the positions with different values . some substitutions show high score differences and logically the greatest differences are observed for amino acids with the greatest overall frequency differences , such as arginine and glycine. we can notice that for these two residues, which are under-represented in mollicute proteins, their match score is increased  whereas their mismatch scores are globally decreased, indicating their depletion also in substitutions in mollicute proteins. an interesting difference is observed for the tryptophan : whereas its frequencies are very close between mollicutes and blosum , this amino acid shows strong differences in the new matrix. this can be explained by a specificity of the genetic code of mollicutes: they can encode tryptophan with the additional codon uga, which is usually a stop codon. therefore molli <dig> can take into account differences not only in the background frequencies, but also in the evolutionary dynamics of the substitutions.

the robustness of molli <dig> with respect to the learning set composition was evaluated, using a re-sampling approach . if we removed randomly 10% of the initial mutliple alignments, the resulting matrix was slightly modified with  <dig> to 8% of the positions with different values and when removing half of the data only 15% of the matrix positions were changed. noteworthy, these changes are minor compared to the differences with blosum <dig> 

since the initial alignments used to infer the substitutions were obtained using blosum <dig> , the impact of this first step was evaluated by iterating the matrix construction with molli <dig>  actually, this recursive step appeared not necessary since the resulting matrix was very similar to the first one, showing only  <dig> elements over  <dig> with a - <dig> or + <dig> difference . the amount of differences is thus similar to the one obtained when removing 10% of the data.

application of molli <dig> in homology predictions
we used the matrix molli <dig> to align mollicute protein sequences and to predict homology and orthology relationships based on these alignments.

orthology predictions
the standard method of bi-directional best hit  was used to predict orthologous genes between two genomes and proteic sequence alignments were obtained using the program ssearch, using either molli <dig> or the standard blosum <dig> as substitution matrix .

we focused on  <dig> mycoplasma genomes for which we dispose of a reference set of orthologous relationships: mycoplasma genitalium, mycoplasma hominis and ureaplasma parvum. this reference set contains  <dig> pairwise relationships which were manually curated by biologists . it enables to evaluate orthology predictions and to compare the influences of different substitution matrices, by classifying the predictions as true positive, false positive or false negative.

when comparing orthologous predictions obtained using the standard blosum <dig> matrix versus our matrix molli <dig>  we first noticed that alignments obtained with molli <dig> have overall smaller e-values than the ones obtained with blosum62: the median e-value of bdbh proteins obtained with blosum <dig> is  <dig> e- <dig> against  <dig> e- <dig> for molli <dig>  if we consider only common pairwise relationships between the two sets, the median pairwise ratio of e-values is of  <dig> in favor of the alignments obtained with molli60: half of the common alignments have e-values obtained with blosum <dig> more than  <dig> larger than the ones obtained with molli <dig>  however, having better e-values does not necessarily mean that the alignments are better and enable to infer better biological information. what is important is to get scores or e-values that improve the discrimination between biologically meaningfull similarity and random similarity. if we consider now all the alignments obtained between all proteins , meaning that this set contains surely a large portion of non-homologous relationships , we still get better e-values with the molli <dig> alignments than the ones with blosum <dig>  however, the difference is significantly smaller than previously with a median ratio of only  <dig> . thus this suggests that the observed differences in e-values between the two matrices are not systematic and depends on the significance of the alignments.

to evaluate the discriminative power of the e-values, we plotted in figure  <dig> the distributions of e-values between true positive and false positive predictions obtained by bdbh. we can clearly see that the alignments obtained with molli <dig> show a distribution with more disciminated e-values between these two categories compared to blosum <dig>  indeed, the median e-value of molli <dig> true positive alignments is smaller than the blosum62's one  and it is the contrary for false positive alignments . overall the mean ratio of e-values between false and true positives is of  <dig> for molli <dig> against  <dig> for blosum <dig>  thus the discrimination between true and false positive e-values is significantly improved when using molli <dig> .

for both matrices, we computed also their sensitivity and specificity . as the two matrices give different e-values even for the same alignment, it is not pertinent to compare their sensitivity and specificity when using a fixed e-value cut-off to predict orthologs. therefore we represented them using the receiver operating characteristic  curves  <cit> . this type of curve enables to visualise how sensitivity and specificity simultaneously vary over the whole range of cut-off values. when plotting the sensitivity as a function of the false positive rate, the best method is assessed as the one whose curve is closest to the top-left corner . we plotted roc curves in figure  <dig> for the bdbh obtained with the two matrices. we can see that molli <dig> and blosum <dig> have very similar curves with the molli <dig> one slighlty "over" the blosum <dig>  if the difference between roc curves is not statistically significant when using evalues to call the best-hits , the difference is greater and significant when using raw scores . this indicates that blosum <dig> scores are less meaningfull than molli <dig> ones. additionally, we can also notice that, regardless of the matrix, the raw score is less meaningfull than the e-value for the purpose of predicting orthologous relationships. finally, the same analysis was performed using the program blast and showed that using the same substitution matrix, blosum <dig>  the strategy with ssearch performs better than blast to predict bdbh orthologs, even when correcting for the compositional bias with blast -c <dig> option . in particular, we observed that the adjustment process improves the specifity of the predictions but with the cost of an important loss in sensitivity: without any filtering of the bdbh pairs ,  <dig> and  <dig> relationships are definitely lost with blast using repectively -c <dig> and default parameter compared to at most  <dig> with ssearch. this may be due to the gap penalties no longer adapted to the adjusted matrix since we observed that alignments were on average 10% smaller with the adjustment option.

importantly, we verified that these results were not due to the fact that the training dataset used to build the matrix had common sequences with the test dataset. to do so, we built a second matrix without using any sequence of the genomes of the test dataset  and re-did these analyses. we obtained a very similar matrix and same results of comparison with blosum <dig> on bdbh relationships .

homologous family predictions
we applied our matrix also to predict homologous protein families among  <dig> mollicute genomes. the prediction of homologous relationships is more challenging that predicting orthologous ones , since we can not rely anymore on the best hit criterion. instead, we have to use a cut-off to decide if two proteins are homologous and a clustering approach to build groups where each member is assumed to be homologous to any other member of the group. the construction of homologous clusters was performed using a naive approach based on an e-value cut-off: any two proteins with their alignment e-value lower than the cut-off are grouped in the same cluster . this implies that two proteins can belong to the same cluster even if they do not share enough similarity, for instance they only need to be both related to a third protein. this transitivity property is justified by the definition of homology of a common ancestor, which implies that if a and b are homologous and so are a and c, then b and c are also homologous.

considering such process, and as the best hit criterion is no more usefull, we guess that the impact of the substitution matrix on these predictions may be more significant than for bdbh predictions. however in the absence of a reference dataset, the estimation of sensitivity and specificity scores is not applicable. instead, we can compare the number of clusters, their size and their phylogenetic profile . we call the pan genome the number of distinct clusters  among the set of genomes, and the core genome the number of distinct clusters containing at least one member of each species. assuming that each cluster represents a distinct funtion, the pan genome may be seen as the set of functions one can find in the community of genomes and the core genome the set of functions shared by all genomes. the number and size of clusters depend naturally on the e-value threshold: the more stringent is the threshold the more numerous and the smaller the clusters are, in other words the larger both the pan and the core genomes are. we can expect that a good clustering would give the fewest singletons , and consequently the smallest pan genome. on the other hand, a clustering with too many large clusters may group together several distinct families and thus reduce the core genome. therefore when comparing several clustering we should prefer the one with the largest core genome and the smallest pan genome.

since the core and pan genomes depend on the e-value threshold, and we have seen previously that e-values are not directly comparable between the two matrices, we built several clustering for each matrix by varying the e-value cut-off and computed for each their core and pan genomes. the results are presented in figure  <dig> where the sizes of the core and pan genomes are plotted as a function of the threshold, or alternatively of the number of pairwise alignments retained with a given cut-off. we can clearly see that for the same number of pairwise alignments, the clustering obtained with molli <dig> gives at the same time a larger core genome and a smaller pan one than the clustering obtained with blosum <dig>  thus the clustering with molli <dig> is better on both fronts and seems to give more pertinent clusters from a parsimonious evolutionary standpoint .

as a complementary view, we evaluated the homogeneity of the families in terms of domain compositions of their protein members. assuming domain architecture is conserved inside families, we expect that a good clustering will have a common domain architecture inside each family and different ones between families. for 14% of the proteins we could predict a domain architecture based on the pfam-a database . for a given clustering, we computed two metrics of domain homogeneity: intra - discrepancy as the number of families with more than one domain architecture weighted by the number of different architectures, and inter - discrepancy as the number of pairs of families sharing at least one domain architecture. we compared these metrics for the clusterings obtained with molli <dig> versus blosum <dig> giving the largest core genomes . for both metrics the clustering obtained with molli <dig> showed a better agreement with domain predictions: its intra - discrepancy value being of  <dig> versus  <dig> for blosum <dig>  and  <dig> for inter - discrepancy versus  <dig>  this result holds also for other evalue thresholds .

based on these results, the matrix molli <dig> was applied for the generation of comparative data in the reference database molligen  and it is proposed as an optional parameter for the alignment tools provided to query the database.

discussion
we want to emphasize that, although our results are focused on a specific group of species, the mollicutes, the method for building the matrix and the analyses of its impacts can be easily generalized to any group of species with an atypical composition.

methodology to build the matrix
to build this new matrix, we followed the approach initially proposed by henikoff and henikoff to build the blosum series  <cit> . the main difference lies in the building of the block database. henikoff and henikoff used the motif finder protomat  <cit>  to avoid relying on an initial substitution matrix. instead we used a multiple alignment program and, as dicussed below, we showed that the initial matrix used for the alignments of the block database had little impact on the resulting matrix. concerning the more recent methods developped especially for plasmodium falciparum, our method differs mainly with respect to the learning sets of proteins. the sets of bastien et al and paila et al, included few sequences from genomes with the bias and more sequences with no bias, in particular to build non-symetrical matrices  <cit> , and in brick et al the learning set was not composed of sequences from the genomes of interest but by selecting blocks from the blosum database showing a similar compositional bias. having at our disposal a large set of genomes sharing the same compositional bias, we could stick to the blosum strategy and take full advantage of it.

as for the global approach, we chose to follow the blosum strategy rather than the pam one mainly because it has been shown to perform better in homology search context  <cit> . furthermore the substitution frequencies are learned directly from the data and are not extrapolated with an evolutionary model which may not reflect the evolution of our proteins. additionally, the method has few parameters to adjust, with an intuitive biological meaning . more importantly, the major drawback of the pam strategy is the restriction on the input sequences: it requires highly similar sequences  which would have considerably reduced the size of our learning set. this is clearly a limiting factor when dealing with a small number of genomes or non model organisms with a limited reference data set.

actually, the major hurdle of our strategy is its reliance on a reference set of orthologous proteins, as opposed to methods that only adjust the standard matrices to the bias with theoritical formulas  <cit> . one needs thus to have already a certain expertise on the genomes of interest. moreover, this set has to be representative of all the genomes and proteins one wants to apply the matrix on. in our case, we used orthologous proteins conserved among  <dig> mollicute genomes, for which there was no ambiguity in their orthologous relationships. we assumed that the wide distribution of these species in the phylogenetic tree of mollicutes, along with the protein set covering diverse biological functions , prevented our model to be over-fitted to a specific genome or protein family. note that since these proteins are probably shared among all or most mollicutes, they may evolve more slowly than the remaining proteins. however, even if the substitutions are expected to be less frequent, we assumed that the relative rates between the different amino acids are representative of mollicute protein evolution, and thus this sampling bias would have little impact on the matrix.

as concerns this learning dataset, we also verified that the final matrix was not too dependant on some individual parts of this set, by a re-sampling approach. this suggested that our learning set was homogeneous enough to estimate correct substitution rates. we also noticed that a recursive step where multiple alignments would be obtained with the new matrix instead of the standard blosum <dig> had few impacts on the resulting matrix. this suggests that substitution matrices may be less important in multiple alignment than pairwise alignment and especially for well conserved proteins. indeed, the signal of conservation, if it exists, is easier to detect when we deal not only with two sequences but with a large set of sequences. moreover, we used a multiple aligner, t-coffee, which is based on consistency scores rather than substitution scores and may thus be less sensitive to differences in substitution matrices. additionally, in multiple alignments, we align sequences already known as homologous and we do not need nor use the scoring of the alignment. in the context of pairwise alignment for homology search, substitution matrices may have more impact on the evaluation of the alignment rather than on the alignment itself .

finally, the last but non negligible step of the method is the optimisation of the gap parameters to the new matrix. in gapped alignments, gap penalties have a strong impact on the alignments and especially their length. indeed, the score of a gap has to be fixed relatively to the scores of matches and mismatches. the task of adjusting the gap penalties to the matrix is not trivial and there exists no theoretical formula to relate them to some features of the matrix  <cit> . we thus followed an empirical approach, testing numerous combinations of gap penalties and choosing the one maximizing the performances of bdbh predictions. notably, we observed that small changes in the parameters of the matrix construction, such as the clustering coefficient and the normalisation parameter λ, could change dramatically the optimal gap penalties. this approach turned out to give the same penalties for both matrices, and this may be related to the similar entropy and expected values of both matrices. nevertheless we want to stress out here on the importance of parameterisation of the gap penalties in pairwise alignments and database searches.

evaluation of the matrix
pairwise alignments and similarity searches in databases are the basis of numerous comparative genomics analyses. what is important in this step is to be able to discriminate between biologically meaningfull similarities and random ones. we showed in this paper that this can be improved by using well fitted substitution matrices. we demonstrated that molli <dig> enabled to better evaluate pairwise alignments with raw-score, as well as e-values. the difference with blosum <dig> was particularly significant for the raw score , enhancing the matrix influence since it is directly derived from it. the difference was smaller for e-values and this suggests that the mis-evaluation of the scores can be compensated by the statistical analysis of their distribution which is performed by ssearch when estimating e-values. nevertheless, we could still see an effect with e-values especially in homology clustering.

in this paper, we also compared two alignment programs: ssearch  <cit>  and blast  <cit> . we showed that ssearch performs better to predict one-to-one orthologs than blast with the same parameters, at least in this context of compositional bias. noteworthy, ssearch still outperforms blast with its compositional adjustment option. this result is to relate to two major differences between the programs. first, ssearch performs exact local alignments  and thus garantees to find the best scoring alignment between two sequences, contrary to blast which is a heuristic. note that, even if smith and waterman algorithm has worse theoretical time and spatial complexities ), its implementation in ssearch as multi-threaded and vectorized greatly improves the runtime, which is no longer a limiting factor. secondly, they differ in the way they evaluate alignments. blast computes e-values using a formula with pre-computed statistical parameters  <cit> , whereas ssearch estimates the e-value of a given alignment using the distribution of scores obtained from aligning the same query sequence against all the sequences in the database. therefore, ssearch's approach does not rely on simulations with artificial sequences to estimate parameters, as in blast, and it takes fully into account the compositional bias of the database and the query sequences. these two differences also guided us to favor ssearch for the comparison of the matrices, since they ensure that the observed performance differences are only due to the matrices and not partly linked to the heuristic approach or the simulations performed to estimate the statistical parameters which could also depend on the matrix. this is also the reason why we chose simple methods with few parameters to predict orthologous and homologous relationships, such as bdbh and single linkage clustering, even if we are aware of numerous other methods which are more sophisticated and surely more efficient for the only purpose of homologous relationship predictions .

the evaluation of the performances and impacts of the substitution matrices in homology search is a difficult task especially due to the lack of benchmarks or reference datasets, that is the knowledge of the true homologous relationships. whereas such datasets may exist for model organisms, they lack crucially for many specific groups of species, such as mollicutes. we first used a personal manually curated dataset of one-to-one orthologs. as the human expertise can not infer with certainty all evolutionary relationships between proteins of distant species, this set may contain errors and missing orthologs. these errors could bias our estimators of performance such as sensitivities and specificities. however, we can assume that these errors are independent of the compositional bias and will impact the results of both matrices the same way. moreover, the initial set of orthologs which was further curated was obtained with classical predictions using blosum <dig>  therefore, potential errors in the reference dataset will tend to favor the blosum <dig> matrix rather than molli <dig>  and we may only underestimate the benefits of our new matrix. indeed, if molli <dig> did improve the ortholog predictions, the benefits were slight. this is due in part to the small size of the benchmark and also to the nature of the predictions: one-to-one orthologs are the easiest homology relationships to predict and the criterion of best hit reciprocity is very strong. the additionable value of molli <dig> can only be shown for a small subset of the results and its impact is consequently minimized with respect to the large number of obvious one-to-one orthologs.

concerning the homologous families analysis, to cope with the lack of "true" relationships, we used the phylogenetic profiles of the clusters as an evaluation criterion. we thus took full advantage of the large number of genomes at our disposal and their wide distribution in the evolutionary tree of mollicutes. the computation of the core and pan genomes enables to have a first glance at the clustering properties in terms of biological considerations. the evaluation of the clustering is however based on two assumptions: that the orphan genes  are rare and must be minimized and that the number of distinct clusters shared by all genomes must be maximized. these assumptions are guided by the parsimony principle. indeed, in the last common ancestor of the considered species the core and pan genomes were equal and they diverged by gene gains and losses: the pan genome increased by gene gain and the core genome decreased by gene loss. therefore a clustering resulting in a smaller pan genome and a larger core genome may invoke less gain and loss and be more parsimonious. it is however important to note that this hypothesis is strong and may not reflect the reality of mollicute gene set evolution, that is the real evolutionary scenario may not be the most parsimonious. this is the reason why we performed a second evaluation based on the domain composition in and between families. this relies also on an hypothesis, that domain architectures are conserved inside the families and are specific to families.

moreover, it concerns only a small portion of the genes, those for which the function is the best known and represented in studied organisms and this may bias the results towards more conserved genes. as the two evaluation methods relied on different assumptions and may have different biases, we argue that they complement each other and the fact that they gave the same trends strengthen our conclusion.

CONCLUSIONS
in conclusion, we showed in this paper that we can improve orthology and homology predictions of mollicute proteins by using a well-fitted substitution matrix, rather than the standard blosum <dig>  we argue that this result can be generalized to other groups of species with a marked compositional bias. the methodology we propose to construct such well-fitted matrices is very simple to carry out and could be useful in an increasing number of studies especially in the current context of massive growth of genomic data: the new sequencing technologies enable from now on to study specific groups of genomes with their specific and atypical nucleotide or amino acid compositions, notably for sequences coming from metagenomic studies.

