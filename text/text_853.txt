BACKGROUND
immunoprecipitated dna fragments enriched by chromatin immunoprecipitation can be analysed genome-wide by microarray hybridization , or by dna sequencing . chip-seq confers a number of advantages  <cit> , so is now the method of choice  <cit> . although the use of sequencing as a readout for chip was first demonstrated using sanger sequencing  <cit> , the advent of high-throughput sequencing  has made widespread adoption of chip-seq possible .

in order to study the epigenome of specific cell types and small biopsy samples, epigenetic techniques are particularly driven to utilize low amounts of input dna. improvements to the chip immunoprecipitation itself allow locus-specific assays to be performed with as few as  <dig> cells , but genome-wide analysis requires more starting material. chip-chip protocols operating down to 1000-cell input amounts have been in use for the last decade  <cit> , employing amplification of the isolated chip dna to microgram quantities to allow microarray hybridization. to use sequencing as a readout instead of arrays, less amplified material is required - typically tens of nanograms. paradoxically, despite this lower final amount requirement, it has been more challenging to prepare small input amounts for sequencing. due to multiple inefficient enzymatic steps and purifications required to ligate adapter sequences prior to sequencing, standard procedures for chip-seq sample preparation typically require 1–10 ng input dna, limiting studies to the use of relatively large cell numbers .

to meet the need for low-input library preparation for chip-seq, several techniques have been developed and refined , allowing inputs down to 10 pg. the underlying principles vary, and include random-priming, adapter ligation, in vitro transcription and reverse transcription, extension of templates by terminal transferase and amplification from complementary homopolymer primers. however, pcr amplification is employed in all cases at some point during the procedure. it is not clear how comparable datasets generated by these different methods are, and to what extent they introduce bias in the results.table  <dig> low-input library preparation methods tested in this study




in this study we compared the performance of seven diverse methods capable of handling dna amounts down to ≤100 pg input . each procedure was performed on replicate dna samples derived from a single large-scale h3k4me <dig> chip. to maximize the possibility that each technique was performed under optimum conditions by experienced laboratories, we distributed samples to the developers of the methods. following preparation in the developer’s laboratories, sequencing libraries were returned to the norwegian sequencing centre for sequencing and data analysis. in parallel, replicate datasets were generated by pcr-free sample preparation from the same chip sample, which created a reference with minimum possible bias. the methods were compared with respect to their generation of unmappable reads, duplicate reads, reproducibility, sensitivity  and specificity  relative to the reference dataset.

RESULTS
chip, library preparation and sequencing
starting with  <dig> million hela cells, multiple chip reactions were performed using anti-h3k4me <dig> antibody. material from all reactions was combined, yielding a single pool totalling 450 ng chip dna on which all subsequent experiments were performed . to produce a reference dataset with the least possible technical bias, three replicate pcr-free libraries were prepared with 100 ng chip dna apiece. the remaining chip dna was divided into five lots, four of which were spiked with low amounts of dna from other species  to control that replicate samples were processed separately through library preparation and not combined into a single pool to increase reproducibility. chip dna  was then shipped to participating laboratories for library preparation. upon return of amplified libraries, the yield and size of the dna was checked before samples were diluted and pooled for sequencing. samples amplified by the seqplex method were at this point prepared for sequencing by performing pcr-free library prep, to avoid introducing additional amplification bias. the yield of each library produced, and the corresponding number of sequencing reads generated , is detailed in additional file 1: table s <dig>  library sizes are documented in additional file 1: figure s <dig> fig.  <dig> experimental design and sequencing read mapping. a experimental design overview. b genomic mapping of sequence reads. the proportion of reads that were unmapped , those mapping to single genomic positions , and those mapping to multiple locations  are illustrated. reads mapping to single genomic positions are broken down into reads present as a unique copy, and those present in two or more identical copies . results shown are the mean of  <dig> replicates for each method, using  <dig> million reads per replicate. error bars show the standard deviation from the mean




genomic read mapping
to compare the proportion of reads mapping uniquely, present in duplicate copies, and unmapped reads, all datasets were randomly down-sampled to  <dig> million reads . as expected, the highest proportion of uniquely mapping non-duplicate reads was seen in the pcr-free reference dataset. amongst the amplified chip libraries, the accel-2s samples had the highest proportion of unique reads at both  <dig> and  <dig>  ng input levels. broadly speaking, the different methods performed similarly on 1 ng input, but in several cases the number of unique reads dropped considerably with  <dig>  ng input. the html samples had high levels of duplicate reads and unmappable reads. attempts to improve mapping of html samples by trimming terminal bases that may have derived from the homopolymer tail added during preparation made little difference. html samples were therefore excluded from further analyses at this point.

analysis of library complexity and chip enrichment qc
to further examine library complexity, we employed the preseq package  <cit> . complexity curves for each library type are presented in fig. 2a. the reference libraries showed the greatest complexity and least variation. at 1 ng input, all methods produced libraries of high complexity, with only minor differences in complexity and variation visible. all samples showed reduced complexity and greater variation at  <dig>  ng input, with the greatest complexity retained by the accel-2s, seqplex and telp libraries.fig.  <dig> library complexity and h3k4me <dig> chip signals intensity. a library complexity curves generated using preseq. yield of uniquely mapping reads based on down-sampled data of  <dig> million reads. pcr-free  method from 100 ng input is shown in black. red and blue lines represent the five replicates used in 1 ng and  <dig>  ng input across six low-input methods. actual and extrapolated values are shaded in white and grey, respectively. x-axis is represented in log <dig> scale. b read depth in a 4 kb window centered on known tss. colours as in 




in addition, we used ngs-qc  <cit>  to assess the robustness of chip signal:noise to down-sampling of read depth. the qc-stamp and underlying qc-indicator scores for all samples are presented in additional file 1: table s <dig>  in comparison to  <dig>  h3k4me <dig> profiles held in the ngs-qc database, qc-stamp scores showed that all samples resembled closely existing h3k4me <dig> datasets, with accel-2s showing the most consistent high scores at both 1 ng and  <dig>  ng input levels.

to confirm the expected enrichment of h3k4me <dig> signals at promoters  <cit> , we plotted read depth surrounding known transcription start sites . all methods showed the expected strong h3k4me <dig> enrichment surrounding tss , with the characteristic drop in signal at the tss itself caused by nucleosome eviction.

visual inspection  confirmed that h3k4me <dig> binding can primarily be found at promoters, as expected from the literature  <cit>  and fig. 2b. in an ideal case, chip profiles amplified from low input amounts would closely resemble those produced from the pcr-free reference datasets. in all cases, the amplification of low input amounts can be seen to increase the signal at some genomic locations and lose signal at others, in relation to the pcr-free sample, with the effect most obvious on the samples amplified from  <dig>  ng. these observations were confirmed in the full datasets . nonetheless, the profiles generally matched the pcr-free dataset extremely well. the profiles most visibly distinct from the reference dataset were those generated by the seqplex method, which appear to have more background noise and less even coverage over h3k4me <dig> peaks, as supported by genome-wide sensitivity and specificity of peak calling .fig.  <dig> data visualized in the integrative genomics viewer  <cit> . a h3k4me <dig> distribution in an 80 kb genomic region. a single example pcr-free library is shown in black at the top, and libraries derived from 1 ng and  <dig>  ng are shown in grey and light grey respectively.b data for all libraries shown as heat maps of the same genomic region. y-axis scale in all cases is read depth 0–28




peak calling, sensitivity and specificity
to quantitatively assess the similarity of the various methods, peak calling was performed with macs  <cit> , using only uniquely-mapping, non-duplicate reads. to make the comparison between the methods as similar as possible, the same number of reads  was used for all samples. critically, despite using lower read numbers than available for most samples, peak calling approached saturation for all methods except seqplex . peak calling data is summarized in table  <dig>  over  <dig>  peaks were detected in each of the pcr-free datasets, and overlapping peaks  present in all three were chosen to define a set of  <dig>  peaks as the reference to which all other methods were compared to measure sensitivity  and specificity . similar numbers of peaks  were called for all methods, with the exception of seqplex at  <dig>  ng input, where >  <dig>  peaks were called. the methods recorded sensitivity over 90 %, with the exception of seqplex, which had a lower sensitivity of 80 %. specificity  rates showed a greater range of values. the highest sensitivity and specificity values were recorded for accel-2s and thruplex.table  <dig> peak calling, sensitivity and specificity

peaks were called using macs, using only  <dig>  million uniquely mapping non-duplicate reads per sample. peak regions present in all three pcr-free datasets  were used as the reference dataset to which all other samples were compared to measure sensitivity and specificity. data presented are mean +/− standard deviation




when examining peak overlaps under the most stringent conditions , it is evident that no two methods completely overlap . the majority of peaks  were detected by all methods. a number of peaks  were only found in the pcr-free datasets. the seqplex method stands out in failing to detect a significant number of peaks detected by all other methods .fig.  <dig> correlation of peak calling and reproducibility of datasets. a number of overlapping peaks found in all  <dig> replicates for the 1 ng and  <dig>  ng input methods, and all three pcr-free replicates. b 2d density estimation of number of read bases within pcr-free peaks  against the number of reads bases within the same regions for all replicates of other methods. data calculated using  <dig>  million uniquely mapping non-duplicate reads for all methods, with 1 ng and  <dig>  ng input level. only reads mapping to peaks found in the pcr-free datasets were analyzed and included in correlation calculations. spearman correlation coefficients for each method are given. black line represents slope  <dig> and is provided for reference. c irreproducible discovery rate  at different numbers of selected peaks, plotted at various idr cutoffs for all methods. idr for pcr-free  method is shown in both 1 ng and  <dig>  ng input panels for illustration




to confirm that these observations held true with higher read numbers, we repeated peak calling on the 1 ng input datasets, which had a higher proportion of uniquely mapping reads, therefore allowing peak calling with  <dig> million uniquely mapping reads per sample . in this case, proportionally more peaks were called from the pcr-free dataset, resulting in a drop in sensitivity by a few percent for most techniques. using this higher number of reads, the sensitivity of the accel-2s, bowman and thruplex techniques was equal . the specificity of most methods was slightly increased relative to the peak calls made with  <dig>  million reads, but their relative performance was unchanged.

to examine the consistency of results obtained by each method when performed with  <dig> or  <dig>  ng input, we also examined the overlap between peaks called at both input amounts , a metric that reflects the scalability of each method, independent of the reference dataset. all methods except seqplex scored well, with accel-2s showing the highest overlap of peak calls at the two input amounts.

because the pcr-free reference dataset was prepared using accel-2s reagents, it was of concern that this might bias peak calling on the low-input samples in favour of the accel-2s method. we therefore compared peak calls to an independent, previously-published h3k4me <dig> dataset from hela cells, obtained using the same antibody used here, generated by the encode consortium  <cit>  . however, no significant changes in the relative performance of the low-input methods were seen, with accel-2s and thruplex retaining the highest sensitivity and specificity scores.

the above analyses of peak overlap do not take into account peak height. to assess the extent to which peak heights were correlated across the different methods, we counted the number of bases in mapped reads, and correlated these to the pcr-free reference dataset. the data  reveal, under both  <dig> and  <dig>  ng input levels, strong correlations in all cases. correlation coefficients rank  in the following order: accel-2s, thruplex, smart, telp, bowman and seqplex. it is worth noting the consistency of the correlations between the 1 ng and  <dig>  ng datasets within each method, suggesting that input amount  has less impact on results than the choice of library preparation method.

sources of variation
of the peak calling metrics compared, the greatest differences were seen between methods when comparing specificity relative to the reference dataset. this suggested that the greatest source of variation between methods was in generation of noise/off-target amplification. to identify possible sources of this variation, we further examined the read depth, gc-content, width and macs score of peaks called for each method . these analyses suggested that seqplex in particular suffered from spurious amplification and preferential amplification of dna with lower gc content. unfortunately, none of the analyses illuminated a cut-off that could distinguish false-positive from genuine peaks to increase specificity, without drastically compromising sensitivity.

three methods  can also amplify single-stranded dna, which may be generated by the high temperatures used during de-crosslinking of chip material  <cit> , sonication, or in some cases by the protein of interest. it is possible that these methods can detect loci that would be missed by other techniques, including the pcr-free method. this would unfairly classify genuine h3k4me <dig> binding sites detected by these methods as false positive peaks. however, attempts to identify possible ssdna peaks in our data did not yield convincing evidence of reproducibly detectable peaks . it should be noted that the h3k4me <dig> chip performed for this study was not expected to produce significant amounts of ssdna to fully test this scenario, and we cannot exclude the possibility that ssdna fragments amplified by seqplex, smart and telp methods contributed to peak calls in addition to dsdna fragments from the same locations. nonetheless, their failure to detect all pcr-free reference peaks suggests that overall they are not more sensitive, and may suffer from higher noise, which is also suggested by the fraction of reads found in peaks   <cit>  .

reproducibility
irreproducible discovery rate   <cit>  analysis was applied at the level of peak calling, to produce a curve that quantitatively evaluates consistency across replicates. high reproducibility produces a curve with a late transition to high idr values. the number of significant peaks across the replicates for different idr rates  was calculated . all  <dig>  peaks common to the three pcr-free reference replicates were identified as significant with only 4 % idr. as can be expected, the idr was higher for all other samples. at 1 ng input, accel-2s and thruplex are clearly superior to the other methods . smart and bowman had intermediate performance  and seqplex and telp the poorest scores . a similar picture is seen at  <dig>  ng input, but notably the smart procedure performed poorly at the lower input amount .

discussion
to the best of our knowledge this is the first thorough study of low-input hts library construction techniques, comparing seven methods. a major strength of the current study was generation of sufficient chip material to allow the use of a pcr-free library preparation method, to which all other methods were compared. pcr has been identified as a major source of bias during sequencing library preparation  <cit> , and can lead to the accumulation of duplicate and unmapped reads  <cit> . generally, the lower the number cycles of amplification employed by the techniques studied here , the better their performance. this simple observation may both help direct future method development, and alert users of all methods to reduce amplification cycles to the minimum necessary to obtain sufficient dna for sequencing.

the accel-2s reagents from swift biosciences were chosen to construct the pcr-free libraries because they allow the lowest input amount  currently possible without the use of pcr. the same accel-2s reagents consistently produced the best results by all metrics in the current study. it must be borne in mind that the reference pcr-free dataset, to which all methods were compared throughout, was created with the same reagents, which may bias results in favour of accel-2s. nonetheless, when evaluating read mapping, library complexity and in comparison to previously published h3k4me <dig> datasets , accel-ngs 2s ranked highest, underscoring the quality of these reagents.

the thruplex reagents from rubicon genomics scored a close second on the critical metrics of peak calling, peak strength correlation, and idr. notably, the efficient and single-tube protocol for these reagents also makes them an attractive choice.

the smart reagents from takara bio usa, also an efficient single-tube protocol, do not appear to be as sensitive and specific as those discussed above, particularly at the lowest input amount used. however, they may offer additional sensitivity if single-stranded dna molecules are also present in the chip material. the telp protocol may offer similar benefits of sensitivity regarding ssdna, although the current study was not designed to thoroughly test this possibility. it is worth noting that modifications to the relatively new telp and smart procedures, currently undergoing additional development, may further improve performance.

the bowman method, representing a highly optimized version of the standard illumina library preparation method, also performed extremely well. when considering that many labs using the standard reagents struggle to obtain good quality libraries with 1 ng input dna, the recommended minimum, labs that wish to continue using standard reagents and protocols may consider implementing the modifications contained within the bowman method.

the seqplex method from sigma aldrich did not perform as well as the other methods, demonstrating a relatively low sensitivity and high false positive rate with  <dig>  ng input. nonetheless, it is the only low-input method tested that is sequencing platform agnostic.

with the exception of the html protocol, all the methods studied herein achieved good or extremely good metrics on the parameters examined given the challenging input amounts. the html method was not developed for chip samples but has been applied to sequence microbial genomes from low input amounts. further development of the method may improve its performance with chip samples.

importantly, it should be noted that, by this study´s design, library preparations were performed by different researchers, which may have influenced the results obtained. effects of reagent age may also affect the results reported. further optimization of each method for the particular dna sample , or customization of data analysis, may potentially narrow performance differences observed here. furthermore, input control dna  was not employed in this study, to emphasise differences between the methods. however, such input controls may compensate for amplification artefacts that result in false positive peaks, and could potentially make the results of the different techniques more comparable.

it should also be noted that this study was not exhaustive, as the originators of two methods  that met inclusion criteria did not participate. the recent adaptation of transposase-based tagmentation for use in chip may provide an additional alternative method, although library preparation in this case is performed prior to cross-link reversal  <cit> . there have been a further slew of methodological improvements demonstrating chip-seq even down to single cells. these advances entail library construction on chromatin before immunoprecipitation  <cit> , the use of carrier proteins or rna  <cit> , optimized lysis and fragmentation conditions  <cit> , and microfluidics  <cit> . however, these studies all employed reagents and methods equivalent to those tested here for sequencing library amplification. the choice of library preparation reagents therefore remains of paramount importance for data consistency and quality.

CONCLUSIONS
we compared the performance of seven low-input library preparation methods on 1– <dig>  ng chip material with regard to amplification fidelity, reproducibility, sensitivity and specificity relative to an unamplified “gold standard”. the accel-ngs 2s reagents consistently achieved top ranking, but several other reagents also performed well. that several reagents achieved similar results is reassuring, as it suggests that many existing datasets  may be largely comparable. we nonetheless observed stronger differences in results between reagent types, than was seen when comparing data derived from the same reagents prepared with  <dig> or  <dig>  ng input. whilst we consider using equal input amounts of samples an important criterion to obtain optimum results, we urge researchers to choose their library preparation reagents carefully, optimise amplification conditions, and as a minimum use the same reagents within a study to maximise consistency.

