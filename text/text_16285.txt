BACKGROUND
cancer is the common term for all malignant tumors, and neuroblastoma is an infant cancerous tumor of the sympathetic nervous system  <cit> . neuroblastoma tumor  is one of the most aggressive types of infant cancer and is the second most deadly cancer of infants. it has the lowest survival rate of all paediatric cancers  <cit> . one of the most important criteria in determining treatment for neuroblastoma tumors  is the quantitative analysis of neuroblast cells.

to determine a treatment for cancers, pathologists take a small tissue sample from the tumor, fix and stain it on a glass slide, then examine it under the microscope. analyzing an enormous number of cells under the microscope is a tedious task, and the subject of inter- and intra-observer variability  <cit> . there is an urgent demand from pathologists for automated and robust systems to read the slides and perform cellular quantitative analysis  <cit> .

the major difficulty in developing such automated systems is distinguishing between overlapping cells and single cells. this is becuase the histological slides are derived from 2-d sectioning of a 3-d tumor, which alters the morphology of cells. for example, two neighbouring cells in a 3-d space may appear as two overlapping cells in 2-d space. an enormous number of overlapping cell in the slides and the inability of the system to distinguish between different types of cells significantly reduces the accuracy of automated cell counting  <cit> .

to count and split the overlapping cells, different algorithms and systems have been proposed  <cit> . however, we identified three main issues with those systems: 1) over-segmentation, 2) sensitivity to image quality, and 3) sensitivity to noise at the contour of the cells. for example, splitting algorithms based on the watershed technique  <cit>  are widely used in different systems , but intensive over-segmentation is a well known drawback of these techniques.

intensity analysis approach is another type of algorithm for splitting the overlapping cells. proposed systems in  follow the intensity analysis approach, and they identify splitting points based on higher intensity values in the overlap area. the main drawback of these methods is the sensitivity to the staining quality of tissue slides. for example, hematoxylin and eosin  is a staining method with low quality in revealing detail of cellular components. this reduces the performance of intensity based analysis methods in splitting overlapping cells, because these systems rely on the differences between the intensity of overlapping regions and non-overlapping regions.

active contour method  <cit>  is another approach that is used to analyze the contour of the overlapping cells. active contour models are energy-minimizing curves which deform to fit image features. they determine the overlapping cells by detecting the regions that lie deeply inside the body of the cells. active contour model developed by  detect and split overlapping cells, but the main drawback of these systems is their sensitivity to the false fluctuating and sharp corners at the cell contours.

morphological-based analysis methods such as  <cit>  use the geometry of the cells in the images to find the cellular regions. the main problem with these systems is finding the correct markers of overlapping regions and neglecting the fluctuations in cells which falsely indicate overlapping regions. many of the proposed systems consequently show sensitivity in detecting overlapping points.

template matching  <cit>  is another technique for segmenting cells and splitting overlapping cells. overlapping cells in tumor images are of different sizes and orientation, thus, the system neglects overlapping cells which have a high level of discrepancy from the defined template, as is the case with neuroblastoma.

to address the above issues, this paper introduces a novel automated cellular quantitative analysis in handling overlapping neuroblast cells. we propose new approaches and algorithms for identifying the overlapping regions based on the concave regions at the cell contours with low sensitivity to the image staining quality, and the false concave regions. we also develop an algorithm for splitting overlapping cells with low over-segmentation rate by associating the cell splitting operation to numbers of concave regions in overlapping cells. to develop the system, we first implement our previously proposed method  <cit>  to distinguish overlapping cells from single cells using the differences in their morphological properties. we then develop novel overlapping cell splitting algorithms. our system deploys dominant concave regions of the cells as markers to identify the overlap region. dominant concave regions are identified by analyzing the convex-hull and area of the cells. the system then finds the initial splitting points at the critical points of the concave regions. to do this, the obtained concave regions are decomposed into their components such as arcs, chords and edges, and the distances between the components are analyzed using our seed growing technique. finally, to determine the optimum splitting route between two candidate initial splitting points, we develop a shortest path determination approach. moreover, the proposed algorithm has potential to be extended to other types of cancerous tumors with similar morphological characteristics in their cellular regions to nts.

to test the system, we apply our algorithms to images of hematoxylin & eosin  stained slides. h&e is a widely used method for pathology labs  <cit>  in which nuclei components are stained blue. we compare the results acquired by our system with those of a pathologist as the ground truth. we also evaluate our system by comparing it with state-of-the-art cell splitting systems such as the systems proposed by kong et al.  <cit> , zhou et al.  <cit> , and fang et al.  <cit> . moreover, the proposed algorithm has the potential to be extended to other types of cancerous tumors with similar morphological characteristics in their cellular regions to nts such as follicular lymphoma. to validate the generalizability of our algorithm to the other types of cancer, we applied our algorithm and the above state-of-the-art algorithms to the h&e images of follicular lymphoma. cellular regions within follicular lymphoma tumours have similar morphological characteristics to nts such as dark blue and round nuclei with indiscernible cytoplasm. the results indicate that our proposed algorithm achieves high performance in splitting the overlapping cells for different datasets and cancer types.

methods
biological domain
neuroblastoma tumors are embryonal malignancies of the sympathetic nervous system which originate from the neural crest. the prognosis of nt is related to several factors: 1) age of the patient, 2) location of the tumor, 3) surgical staging, and 4) microscopic grading  <cit> . the first three factors can usually be determined accurately and easily by pathologists; however determining microscopic grading requires extensive analysis of different histological regions and histological structures within tumor tissue under the microscope. several microscopic grading schemes have been proposed for nt, among which the shimada grading is the newest, most comprehensive, and widely used. according to the shimada scheme, the level of tumor differentiation indicates the level of aggressiveness of the tumor. one of the most important criteria in determining the differentiation level is the number of neuroblast cells in the tumor tissue, which is the subject of this paper. a neuroblast cell is small to medium in size, with indiscernible to thin cytoplasm and vaguely defined cytoplasmic borders  <cit> .

image acquisition, software and hardware
to test and train our system, we used five nt datasets. we used one dataset for training and the other four datasets for testing the system. each dataset is a digital tissue array containing  <dig> h&e stained tissue spots from different tumors at different neuroblastoma stages, as shown in figure 1a. the images were scanned under  <dig> × magnification , in rgb color-space, as shown in figure 1b. we cropped each of the tissue spots to an image of size 512× <dig> pixel regions with jpeg format and compression rate of 13: <dig>  as demonstrated in figure 1c. thus each dataset contains  <dig> images of neuroblastoma samples from different tumors and in total our dataset contains  <dig> different images of nt tissue spots. the digital tissue arrays were provided by the tumor bank of the kid’s research institute at the children’s hospital at westmead , sydney. the tumor bank is compliant with the local policy, national legislation and ethical mandates for the use of human tissue in research, in keeping with the declaration of helsinki. all samples were de-identified by the tumor bank. to demonstrate the generalizability of our developed algorithm, we also test our algorithm using histological images of follicular lymphoma which were deposited by  <cit>  in a publicly accessible data repository at “http://web.mit.edu/huikong/www/projects.html” in the histopathological image analysis section. the dataset contains  <dig> h&e stained images of size 800× <dig> pixels which we cropped to size 512× <dig> figure  <dig> 
a sample of tissue array. a) an example of a tissue array taken from our dataset with 1× magnification, b) a random example of a tumor tissue with 20× magnification, and c) the cropped image of size 512× <dig> 



we developed our algorithm using matlab  and all experiments were run on a computer with  <dig> × <dig>  ghz cpu and 48gb of ram.

segmentation of cellular regions
the main focus of this paper is the analysis of the cellular regions and splitting the overlapping cells, but prior to this taking place, the cellular regions must be segmented from other histological regions. the performance of the proposed algorithm for splitting overlapping cells depends on the quality of the cell segmentation. low accuracy of cell segmentation reduces the performance of our proposed algorithm in distinguishing overlapping cells from single cells and splitting the overlapping cells. in this paper, we segment the cellular regions using our previously proposed hybrid algorithm  <cit> . the algorithm partitions images into many tiles and filters the constituent tiles of the cellular regions using a novel color analysis approach. the result is a foreground/background image, in which the foreground is made up of the constituent pixels of the cellular regions, and the background is  <dig>  the intensity values of the cellular regions in the image of h&e stained tissues are not uniform and do not provide detailed information of the cellular components. the contours of most of the overlapping cells at the overlapping points are not clear because of the low quality of h&e staining as shown in figure  <dig>  this means that analyzing the h&e stained color images does not provide significant information for splitting overlapping cells, thus, to reduce the computational complexity and processing time, we transform the images of the segmented cells to binary images. the value of the pixels in the foreground of the binary images is  <dig> and in the background is  <dig>  figure  <dig> illustrates the original image, the image after segmentation, and the binary image.figure  <dig> 
quality of h&e staining method. four different images from four different h&e stained tumor tissues. yellow arrows indicate overlapping cells with unclear borders at the points of overlap.
the segmented cellular regions. a) image of h&e stained tissue, b) segmented cellular regions, c) binary image of the segmented cellular region.



algorithm description
our system analyzes the cells in two stages: 1) distinguishing overlapping cells from single cells, and 2) splitting overlapped cells into single cells. stage  <dig> is addressed by applying the algorithm we developed in  <cit>  which robustly discriminates the overlapping cells from the single cells. in stage  <dig>  we develop a novel algorithm to split the overlapping cells distinguished in stage  <dig>  figure  <dig> gives an overview of our algorithms.figure  <dig> 
overview of our two stage algorithm. in stage  <dig>  different morphological properties of cells are analyzed for distinguishing between overlapping cells and single cells. in stage  <dig> the overlapping cells distinguished are split into single cells using our developed algorithm.



stage 1: distinguishing types of cells
to distinguish overlapping cells from single cells, pathologists consider certain morphological criteria of the cells such as size, diameter, and degree of cell concavity, as shown in figure  <dig>  in computerized analysis, the system does not comprehend the types of cell in the segmented cellular region, and thus considers both overlapping cells and single cells as the same object. we therefore develop an algorithm to assign one of the overlapping or single labels to each of the corresponding objects as follows.figure  <dig> 
different morphology of overlapping cells and single cells. the gray objects are overlapped cells, and the white objects are single cells. a) bigger area for overlapped cells. b) overlapped cells with unequal diameters. c) higher concavity for overlapped cells.



pre-processing
in the segmented cellular regions, cells might appear with holes or the segmented image might contain noisy artifacts, as shown in figure 3b. thus, prior to analyzing the segmented cells, a series of morphological operators, namely region filling, opening and closing operations are applied to the images. the size of the structuring element for the opening operation is  <dig>  tuned empirically on  <dig> images from our training dataset. more details about the morphological operations can be found in  <cit> . these operations remove all the small holes within the body of cells and small noisy artifacts in the segmented image.

area of the cells
the size of an overlapped cell is usually greater than the size of a single cell because an overlapped cell is formed by two or more cells. to distinguish overlapping cells from single cells, we must evaluate the area of each of the objects, and the average size of the objects in the image. the area of each cell is determined by counting the total number of constituent pixels within the cell, which is denoted as ai, ∀i∈{ <dig> …,n} where i is the object number, and n is the total number of objects in the image. we then compute the average size of the objects in each image by .

diameter equality
a single neuroblast cell is defined as having an approximately round shape  <cit> . this means that the major and minor diameters of a single cell are approximately equal in length. the major diameter is the longest straight line inside the cell and is the cell’s length. the minor diameter is a line perpendicular to the major diameter and is the cell width. we denote the ratio of the minor diameter to the major diameter of object i as dei. if dei is bigger than a threshold γ, then object i is circular in shape. we obtain γ= <dig>  empirically by tuning on  <dig> images from our training set. we analyze the performance of the algorithm using f-measure metric in discriminating overlapping cells from single cells.

concavity dominance
the morphology of overlapping cells has greater concavity than a single cell. we use the following expression to calculate the concavity of the objects using,
  <dig>  

where  is the area of convex hull for object i, and cxi indicates the object concavity. let us consider  as the average object concavity in the image.

labeling the cells
to determine whether objects are overlapping or single, we assign a label to each of them. to do this, we first check the area of the cells using the following expression,
  <dig>  

where po and ps are potentially overlapping and potentially single labels respectively. in the next step, the ratio of minor to major diameters for each object is computed, and we assign new labels to the objects with respect to ζi using,
  <dig>  

where sc is single cell label. the final step is to analyze the concavity of the objects with respect to  and change the labels as follows:
  <dig>  

where oc is overlapping cell label. ultimately, those objects with label  are considered as overlapping cells and the system stores them in a binary foreground/background image, where the foreground consists of the overlapping cells with a pixel value of  <dig>  and the background is  <dig>  as shown by figure  <dig> figure  <dig> 
the output of stage  <dig>  a) indicates images of segmented cellular region with mixture of overlapping and single cells, b) demonstrates the binary images of the segmented cellular images without, and c) illustrates the segmented overlapping cells after applying the developed algorithm. some of the artifacts and holes in b) do not exist in c), which is due to the applied preprocessing operations in stage  <dig> 



stage 2: splitting overlapped cells
the main markers that enable pathologists to identify the number of single cells in an overlapped cell are those areas which cut deep into the main body of the cell. these areas form concave shapes in the body of the cells. to decompose an overlapped cell into its constituent single cells, pathologists draw an imaginary line from one concave region to the counterpart concave region to split the overlapped cells.

to automate this process, our system first determines the concave regions of the cells. it then identifies initial splitting points on the concave regions, and selects the closest initial splitting points as the candidate pair of initial splitting points. lastly, it determines the splitting routes using the shortest path between the selected candidate pairs.

determining concave regions
to find the concave regions, we assume r and  are the entire region and the convex hull region of overlapping cells respectively. then, we determine the regions between  and r using,
  <dig>  

where o is the total number of overlapping cells that we obtained from stage  <dig>  most often these regions have similar morphology to triangles and we call those regions splitting triangles , as shown in figure  <dig> by the hatched regions. thus, ϕj={stk}, where k={ <dig> …,c} and c is the total number of sts for overlapping cell j. for example in this figure c= <dig> because the overlapping cell contains three sts.figure  <dig> 
an overlapping cell, and the morphological properties that are used in our splitting algorithm. the dashed line indicates the convex hull, the white regions are the area of the cell, the shaded regions are sts, the rings show the critical points on the arcs of the concave regions, the circles present critical points on the chords of sts, and the arrows point to the chords of sts.



initial splitting points
to split overlapping cells, we must first define the peak points of the regions which cut deep into the body of the cells as illustrated by the circles in figure  <dig>  we call the above-peak points the initial splitting points, because our algorithm initiates the splitting process from those points. these peak points are the critical points on the arcs of sts. thus, the first step is to determine the critical points of sts.

for each st, three critical points are identifiable: two critical points are on the chord of st and are presented by circles and arrows in figure  <dig>  and one point is on the arc with maximum distance from the chord. to split the cells, we must consider the critical point on the arc only, and exclude the other two points from the analysis. to this end, we introduce an algorithm based on st decomposition, seed growing techniques and critical point acquisition.

stdecomposition
we decompose each of the sts into its edge, arc and chord. to determine the edge of the st, canny edge detection  <cit>  is employed, and we denote the edge of st by e as shown by the blue dashed line in figure 8b. the next step is to find the chord of the st. the chord is the only part of the st which is tangent to the contour of the cell convex hull, as shown by the red rectangle in figure 8b. to determine the chord, we therefore use the intersection between the edge of convex hull  of the cell and the edge of the st using . lastly, to identify the arc of st as shown by the white dashed line in figure 8b, we subtract the edge of st from the chord by arcj=ej−chordj. the pixels on arcs and chords of all sts are stored in two matrices ea and ec each with size h×w where h and w are equal to the height and the width of the original image respectively, which is 512× <dig> in our experiments. in each of the matrices, the pixels in the arc and the chord of overlapping cell j are set to j, and all other elements are set to  <dig> figure  <dig> 
overlapping cell decomposition. a) an example of three overlapping cells in which the white areas are the regions of the cells and the blue area is the convex hill of the overlapping cells. b) illustrates the edge of the convex hull with blue dashed line, chords of sts with a red rectangle, and arcs with white dashed lines, which are lie deeply in the body of the cell.



seed growing
we develop the seed growing algorithm to find the initial splitting point of the identified sts. the initial splitting point is located at the peak point of the arc with the maximum distance from the chord, as shown in figure 9a by the circle. to identify the constituent pixels of an initial splitting point, we must compute the distance between pixels on the arc and the chord and our developed seed growing algorithm computes this distance. note that the initial splitting point might be constructed by multiple pixels. this means that more than one pixel might be located at the peak point with the maximum distance from the chord. the algorithm creates two distance matrices da and dc with size h×w based on matrices ea and ec for arcs and chords respectively. in these matrices those elements which have the same row and column numbers to the non-zero elements in ea and ec are considered  <dig>  and we call them ‘seeds’, while all other elements are called ‘neighbors’. we assign the value of the neighbors by growing from the seeds to the neighbors. that is, the distance between each neighbor and its nearest seed is calculated by the chessboard distance, max  <cit> , where  and  are the coordinates of a neighbor element and seed element respectively. according to  the advantage of using chessboard distance over euclidean distance in morphology analysis is that, whilst chessboard distance is computationally less expensive, it provides the same performance as euclidean distance. figures 9b and figure 9c indicate matrices da and dc with zero elements as the seeds and non-zero elements as the neighbors.figure  <dig> 
determining the critical point of a
st
. a) a and c represent the constituent pixels of an arc and a chord of an example st, and the ring indicates the initial splitting point. b) indicates da where all zero elements in blue are seeds and all other elements are neighbors whose values are set based on the chessboard distance to their nearest seed. c) illustrates dc with zero elements as seeds and neighbor elements. d)
dm, which is obtained by adding the matrix in b) to the matrix in c).



critical point acquisition
the critical point of an arc is located at the maximum distance from the chord. we determine this using,
  <dig>  

those elements in dm having maximum values and aligned with the coordinates of the non-zero elements in ea are considered to be critical point of stk, and the initial splitting points. each stk in cell j has an initial splitting point. figure 9d indicates dm.

candidate pairs of initial splitting points
we split an overlapping cell by connecting its nearest initial splitting points to each other. thus, we must calculate the distance between the initial splitting points, and take two initial splitting points as a pair if they are located nearest to each other. we consider the two possible scenarios:

scenario 1: overlapping cells with more than one st: figure  <dig> indicates an overlapping cell with more than one st. in this scenario, each of the obtained initial splitting points is considered as an object, although an initial splitting point in an image might consist of more than one pixel. then for each object, we create a border distance matrix dp with size h×w, where p={ <dig> …,sp} and sp is the total number of objects  for the overlapping cell j. we use our seed growing technique to set the elements of the matrix by considering the constituent pixels of the object as the seeds which are set to  <dig>  and the value of the neighbors is set based on their chessboard distance to the nearest seed. figure  <dig> is an example which indicates matrix dp for each of the identified initial splitting points. to determine the shortest paths between two objects, the following four steps are developed: for a selected object p, we introduce a set of matrices   <dig>  
scenario  <dig>  an example of overlapping cells with four sts, which are shown by gray regions.
distance of each initial splitting point from the image borders. an example of overlapping cell with three initial splitting points , matrix distances d
 <dig> for p
 <dig>  d
 <dig> for p
 <dig>  and d
 <dig> for p
 <dig>  and 0s are the constituent pixels of p <dig>  p <dig> and p <dig> in the cell. .



where Θp is a set of sp− <dig> matrices which indicates the distance between object p from the sp− <dig> other objects in an overlapping cell j as shown by the example in figure 12a.figure  <dig> 
determining splitting pair by finding two closest critical points. a) d
 <dig> d
 <dig> and d
 <dig> are from figure  <dig>  the underlined elements represent p
 <dig>  p
 <dig> and p
 <dig>  and the gray elements indicate the shortest distances between the two objects. b)
f
 <dig> shows the shortest path between the objects, and c)
j
 <dig> indicates that p <dig> and p <dig> in the example of figure  <dig> are the closest objects.



 <dig>  to obtain the shortest paths between object p and object v, we create a matrix mp,v with size h×w in which all of its elements are  <dig> except those elements which have the same row and column numbers as the elements in bp,v with minimum value.

 <dig>  fp is a set of sp− <dig> matrices that have the smallest elements of the matrices in Θp as illustrated in figure 12b,   <dig>  

 <dig>  we determine the nearest object v to object p by finding mp,v in set fp which has the minimum value greater than zero among the other matrices. we store the results in jp as shown in figure 12c.



scenario 2: overlapping cells with one st: figure  <dig> indicates an overlapping cell with one st. sometimes an overlapping cell might have only one concave region. in this case, the system considers that the other initial splitting point for making the splitting pair is among those pixels which are located at the contour of the cell closest to the first initial splitting point. for this, we develop an algorithm in two stages: determine the edge of the overlapping cells. canny edge detection is used to acquire the edge of the overlapping cells, which we denote as ej where j={ <dig> …,o} and o is the total number of overlapping cells. we then use  to obtain all the edges of the overlapping cell except the edges which are in common to the concave region of the overlapping cell as shown by a solid line in figure  <dig> 
scenario  <dig>  an example of overlapping cells with one st. the red arrows show the distance from the initial splitting point to the center of the overlapping cell.



 <dig>  identifying the shortest path between the initial splitting point of st <dig> and the constituent pixels of ej′ using the four steps from scenario  <dig> 



splitting route determination
jp contains all the possible shortest paths between two splitting points for overlapping cell j. to pick one shortest path from them, we consider all the pixels in the determined shortest path region as one object. then, the thinning operation  <cit>  is applied to the object for selecting a single shortest path. the thinning operation shrinks the object into a single line. the deployed thinning operation has two main stages  <cit> : 1) remove pixel x from the object if conditions  <dig>   <dig> and  <dig> are all satisfied; and 2) remove pixel x if conditions  <dig>   <dig> and  <dig> are all satisfied. conditions  <dig> through  <dig>  following  <cit>  are given by

● condition 1:  

where
  

where bi is obtained by
  

and vx <dig>  vx <dig> …,vx <dig> are the values of the eight neighboring pixels of pixel x. we start from the east neighbor continuing counter clockwise.

● condition 2:      

● condition 3:  

● condition 4:  

we repeat the above two stage operations until we obtain an object with the width of a single pixel. the thinning algorithm always performs over the width of an object and it does not reduce the length of the object. the splitting points are always located at the longitudinal end points of an object. this means that the thinning operation automatically starts from one splitting point, reduces the width of the object and ends at the other splitting point. the results are stored in a matrix j∗ with size h×w. figure  <dig> indicates jp after the application of thinning operation. lastly, we replace all the pixels in the original image with x and y coordinates equal to those non-zero elements in matrix  to  <dig>  as a result, overlapping cells are split from their concave regions. figure  <dig> shows an example of our algorithm outputs. the algorithm does not predict the initial shapes of the cells at the time of overlap, and it determines the number of constituent cells in a clump of overlapping cells only. this means that the system does not perform morphological restoration for the cells, and the system fragments the overlapping cells into the associated number of single cells. this is appropriate because the aim is to count the cells rather than to restore the morphology of the cells.figure  <dig> 
thinning operation. a) is matrix j
 <dig> in figure  <dig>  and b) is j
∗
 <dig> 
output of the developed algorithm for splitting overlapping cells.
a) shows the segmented cellular images that are used as the input for the algorithm, b) illustrates the binarized format of the segmented cellular regions, and c) indicates the output of the proposed algorithm.



validation and comparisons
to validate the performance of our algorithm, we collaborated with a pathologist from chw, sydney as the ground truth. a recent audit of chw shows that the historical misclassification for nts in the department of histopathology from  <dig> to  <dig> is 0%, which guarantees the accuracy of our ground truth. we compare the cell counting results obtained by our system with those conducted manually by the pathologist.

a correctly segmented cell is a true positive . a cell that has been detected by our system but rejected by the pathologist is a false positive  or over-segmented, and a cell that has not been detected by our system but has been detected by the pathologist is a false negative  or under-segmented. to measure the performance of the system, we use precision, recall and f-measure  <cit> . we apply methods proposed by kong et al.  <cit> , zhou et al.  <cit> , and the watershed technique  <cit>  to the four test datasets to evaluate the performance of our system compared to other systems. the system proposed by kong et al. splits the overlapping cells by smoothing the boundary of the cells using fourier shape descriptors  <cit> . it splits overlapped cells from their dominant concave region by choosing a point pg on the contour of the cell. it then finds pg+h and pg−h points on the cell contour which are h-points  ahead of and behind of pg. according to kong et al.  <cit> , if more than 60% of the line  linking pg+h and pg−h is outside the overlapped cell, then pg is considered to be a concave point  <cit> . the system splits the clump by cutting along the two detected concave points. this means that to split the overlapping cells, the system finds the concave regions by analyzing the contour of the cells and the angle between the line , while our system determines the convex hull and the peak point of the convex hulls. in the experiment, we show that relying on the contour of the cells increases the standard deviation and reduces the performance of the system in terms of splitting the overlapping cells. the system proposed by zhou et al. applies the watershed transform to the overlapped cells, and uses a novel hybrid merging algorithm to reduce the negative effects of high over-segmentation derived by watershed technique. this algorithm combines the compactness score with the probability distribution function score to merge the fragmented cells produced by the watershed technique. watershed technique finds seeds of the objects by identifying the innermost regions of the objects. each of the seeds receives a unique identification label and the area around each of the seeds is grown. the pixels within the area receive an identical label as their corresponding seed. the area around each seed grows until it meets an area around another seed with a different identification label. those pixels at the collision points form the watershed line. qi et al.  <cit>  developed a two step system for identifying and splitting the overlapping cells. in the first step, the system determines the geometric center of each cell by integrating a shifted gaussian kernel with mean shift algorithm  <cit> . the shifted gaussian kernel gives the highest votes to the pixels located at the maximum distance from the contour of the cell. this means that the pixels located at the center of the cell receive the maximum vote. for the overlapping cells, the shifted gaussian kernel considers the overlapping regions as those with the higher gradient intensity and gives higher votes to the regions outside the overlapping regions. for example, if two cells overlap, the pixels on both sides of the overlapping region receive the higher votes. this means that the algorithm finds the seeds of all the constituent cells of an overlapping cell. the system then applies mean shift algorithm to the constituent pixels of the identified seeds to calculate the center of cells and discriminates the overlapping cells from single cells. the seeds obtained in stage  <dig> are used to detect the initial position of the segmentation of the overlapping cells. in the second step, the algorithm extracts the contour of the cells using a level set function to detect the overlapping cells.

RESULTS
each row of table  <dig> indicates the average tp, fp, fn, precision, recall and f-measure of our system for each dataset after comparison with the results of the pathologist. table  <dig> indicates that our system has the best average f-measure, followed by kong et al. with an average f-measure of  <dig> %, which is the best result of the state-of-the-art methods, but which is approximately 4% lower than the f-measure obtained by our system. the system proposed by qi et al. obtains the lowest f-measure of  <dig> %.table  <dig> 
the results obtained by our system






according to table  <dig>  the system proposed by kong et al. has the highest standard deviation. the main reason for this is that the system relies on cell contour for splitting overlapping cells. tables  <dig> and  <dig> indicate that our system obtains the best precision and recall, while the system proposed by qi et al. achieves the lowest precision and recall among the state-of-the-art methods. the proposed system by zhou et al. addresses the over-segmentation drawback of the watershed technique by merging the fragmented cells. although the system developed by zhou et al. improves the performance of the watershed technique, the lower precision results compared to kong et al. and our system is an indication of the higher over-segmentation rate for the system proposed by zhou et al.table  <dig> 
the average precision obtained by state-of-the-art systems






lastly table  <dig> provides the results of the holm statistical tests  <cit> . holm is used for rigorous statistical tests  <cit>  and is a well-known method in reporting biological results with multiple hypotheses  <cit> . we choose holm test to be consistent with the approaches which are used by the health researchers in reporting their statistical results. the null hypothesis of the tests is given as the similarity between the precision, recall and f-measure of our proposed algorithm and those of the algorithm proposed by kong et al. the statistical test indicates that the improvement in performance of our system compared to the above state-of-the-art algorithms is statistically significant. the algorithm proposed by kong et al. is chosen for the statistical tests, because it obtained the best performance among other state-of-the-art algorithms in tables  <dig>   <dig> and  <dig>  table  <dig> shows that p-values for precision, recall and f-measure for each of the four test datasets are less than the level of significance , and consequently the hypothesis is rejected. these results conclude that the improvement in performance of our algorithm compared to the algorithm proposed by kong et al. is statistically significant.table  <dig> 
holm statistical tests for precision, recall and f-measure of the algorithm proposed in this thesis and the algorithm proposed by kong et al. in splitting overlapping cells with
α
=0
.
 <dig> and the obtained standard scores 


z
0

dataset 1

dataset 2

dataset 3

dataset 4


algorithm generalizability
to demonstrate the generalizability of our algorithm for new datasets with different types of cancer, we evaluate our algorithm with the follicular lymphoma dataset that was used by  <cit> . table  <dig> indicates the f-measure of our algorithm and the state-of-the-art algorithms. the results show that our algorithm obtains the highest performance in this dataset with an average f-measure of  <dig> % compared to the other algorithms. the algorithm proposed by kong et al. obtains the best performance among other state-of-the-art algorithms but its performance is approximately 1% lower than the f-measure obtained by our algorithm. the main reason for the higher f-measures obtained by all of the algorithms in the follicular lymphoma dataset compared to the nt dataset is the higher contrast between the different types of histological region as a result of the better image quality.table  <dig> 
the average f-measure and precision and recall for our system and state-of-the-art system by applying them to the follicular cancer dataset provided by kong et al




CONCLUSIONS
to address the issue of overlapping cells in cellular quantitative analysis, this paper has proposed a novel system in two stages: 1) distinguishing overlapping cells from single cells based on their morphological differences, and 2) splitting overlapping cells into single cells using our splitting triangle decomposition, seed growing and shortest path determination techniques. to measure the accuracy, we compared the results of our system with those of a pathologist as a ground truth using f-measure. we also evaluated the system by comparing with systems proposed by kong et al.  <cit> , zhou et al.  <cit> , and the watershed technique  <cit>  using histological images derived from different tissue arrays and different types of cancer. the highest precision and recall obtained by our system compared to these systems show the lowest over-segmentation and under-segmentation respectively for our system. the system proposed by qi et al. obtains the lowest f-measure, precision and recall compared to the other methods tested. the system is an intensity-based method which discriminates overlapping cells from single cells by relying on the higher grading intensity of the overlapping region, while the h&e staining methods in most of the cases is incapable of revealing those details. the system proposed by zhou et al. significantly reduces the over-segmentation drawback of the watershed-based by almost 8% in neuroblastoma and more than 7% in follicular lymphoma datasets, but the low overall f-measure of the system compared to ours and that of kong et al.  <cit>  indicates, that watershed-based techniques, in comparison to those based on morphological analysis, do not provide optimum performance in splitting the overlapping cells. moreover, the standard deviation obtained by our system was the lowest compared to other systems. the watershed technique and the method proposed by kong et al. obtains the highest standard deviation which demonstrates their fluctuating performance on different datasets. our system cannot accurately identify and split highly overlapped cells with very low numbers of convexities on their contours. discriminating and splitting those cells is a challenging task which even pathologists, as a gold standard, cannot manage. this paper proposes a novel overlapping cell splitting approach by introducing a two step algorithm which distinguishes overlapping cells from single cells by exploiting their morphological differences, and splitting those overlapping cells by proposing an approach which determines the initial splitting points at the critical points of the concave regions of overlapping cells. the algorithm proposed in this paper obtains the highest performance in quantitative analysis of cellular regions within nts among the tested state-of-the-art algorithms. the high accuracy obtained by our algorithm in cell counting of nts enhances the process of making prognosis for pathology laboratories, and reduces the inter- and intra- observer variability. moreover, the high performance obtained by our algorithm in the quantitative analysis of the images of follicular lymphoma guarantees the robustness and generalizability of the proposed algorithm in the quantitative analysis of cellular regions with similar morphological characteristics to nts.

authors’ information
st has research expertise in medical image processing and in designing computer aided diagnosis systems, and this project was part of his st phd program. st currently works as a postdoctoral research on a grant provided by cancer institute nsw. dc throughout his career has focused on the molecular basis of paediatric malignancies. his scientific achievements and publications have concentrated on the assessment of childhood tumors with specific attention given to neuroblastoma and leukaemia. pk has research expertise in health and medical data analytics. he has huge practical data analytic and software development experience both in industry since  <dig>  and in academic projects since  <dig>  he is director of the knowledge infrastructure laboratory  in the centre for quantum computation and intelligent systems.

competing interests

the authors declare that they have no competing interests.

authors’ contributions

st carried out designing and developing the proposed algorithm, and drafting the manuscript. dc participated by providing the dataset and orchestrating the collaboration between the department of histopathology at chw and centre for qcis in the faculty of engineering and information engineering at uts. pk was involved in interpreting the data, revising the manuscript critically and coordinating the research team. pk and dc have given final approval of the version to be published. pk and dc are agreed about the accuracy and integrity of any part of the work. all authors read and approved the final manuscript.

