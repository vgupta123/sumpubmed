BACKGROUND
multiplex ligation-dependent probe amplification  has proven to be an efficient and reliable technique for gene dosage analysis. this technique was first introduced in  <dig>  <cit> , and has been widely applied in a variety of clinical and research situations. in this method, two sequence-tagged half probes are annealed to adjacent sites on the genomic target sequence and ligated using a thermostable dna ligase. the ligated probes are subsequently amplified with universal pcr primers  and quantified using electrophoresis  . a typical, capillary-based mlpa assay allows for the quantification of up to  <dig> distinct sequences. in a more recent development, flexmap bead-coupled mlpa has been described, which allows for the simultaneous detection of  <dig> distinct sequences per reaction   <cit>  .

compared to other gene dosage detection methods, including, for example, southern blot analysis and fish , mlpa is high throughput, requires only small amounts of starting dna , does not require cells for chromosome spreads  and can be used to target any genomic sequences for copy number analysis, irrespective of their size or proximity to each other. quantitative pcr  is a potential alternative, but its use in a multiplex assay is limited by the spectral overlap of the fluorescent dyes used  <cit> , and detecting 2: <dig> or 3: <dig> copy number change is challenging.

however, while kits covering multiple regions/genes of interest are available from mrc-holland, for those regions not yet commercially available as kits, there are significant challenges in designing custom assays for mlpa. in the original description, mlpa probe sets were generated by cloning the target specific sequence into a family of m <dig> derived vectors that already contained the variable length fragments. with improvements in oligonucleotide synthesis, completely synthetic probe sets have been successfully used for mlpa reactions, obviating the need for the implementation of the m <dig> method  <cit> . the current major obstacle to successful mlpa probe design is the long list of criteria that need to be simultaneously satisfied to improve the likelihood of a successful assay. these criteria include probe length, tm, secondary structure, gc content, nucleotide composition at the ligation site, sequence uniqueness, avoidance of known snps, etc. manual probe design is time consuming and error prone. our software automates this tedious mlpa probe design process.

implementation and 
RESULTS
input
h-mapd accepts one or more nucleotide sequences in fasta format. due to technical limitations, electrophoresis-based mlpa supports up to  <dig> assays per reaction , while bead-coupled mlpa currently supports up to  <dig> assays per reaction. the software sets a maximum limit of  <dig> and  <dig> sequences for electrophoresis-based and bead-coupled mlpa, respectively. to prevent server overloading, aggregate sequence lengths up to  <dig>  bases are allowed . two platforms are provided, depending on the available technology: one for traditional electrophoresis-based and one for flexmap bead-coupled mlpa.

probe generation
for the electrophoresis-based mlpa platform, the probe length is increased by  <dig> bases for each input sequence, starting with the minimum length of ligation product specified by the user. if the user chooses to use stuffer sequences , the probe length increment is achieved by adding stuffer sequences between primer and hybridizing sequences in both the left  and right probe oligos . otherwise, the increment is achieved by extending the length of the hybridizing sequences. for bead-coupled mlpa, all probes have the same length. the tag sequences included in the probe for each bead are provided in additional file 4: flexmap bead tag sequences .

for each input sequence, the length of the hybridizing sequence  is calculated by subtracting the length of primers, stuffers or bead tag sequence from the total probe length. a series of hybridizing sequences are generated by walking along the input sequence at  <dig> base steps, and extracting fragments of the desired length. the hybridizing sequences are split in the middle: the left hybridizing sequence  becomes the 3' end of the lpo and the right hybridizing sequence  becomes the 5' end of the rpo.

probe screening
mrc-holland has the most experience in mlpa probe design. h-mapd adopted most of the criteria described in mrc-holland's probe design guidelines  <cit> . the workflow of probe selection is outlined in figure  <dig>  it has been observed that the first nucleotide following the left primer sequence affects probe signal strength  <cit> , and it is suggested that adenosine should be avoided at this position  <cit> . h-mapd has followed this suggestion and excludes adenosine at the first position following the left primer in the lpo. empirically, the ideal gc content of hybridizing sequence is around 50%  <cit> , however a gc content of 28% has been successfully applied in mlpa  <cit> . our software allows users to specify different ranges of gc content for the lhs and rhs, but ranges close to 50%, for example, 40–60% and 35–65% are recommended. the tm is very important when considering how hybridizing sequences anneal to template dna. accurate tm prediction for oligonucleotides is complicated and different algorithms result in different tm values. mrc-holland uses raw for tm prediction. while raw runs only on the windows operating system, h-mapd calculates tm using unafold software that supports various operating systems  <cit> . additional file 5: comparison of tm calculated by raw and unafold, compares melting temperatures calculated using raw and unafold for the reference sequences mentioned in the mrc-holland mlpa probe design guidelines  <cit> . tm calculated by raw is on average  <dig> °c higher than that calculated by unafold with a standard deviation of  <dig> °c. mrc-holland recommends a minimum tm  of 8°c above hybridization temperature. h-mapd ensures both the lhs and rhs should have a tm  of  <dig> °c above hybridization temperature. secondary structure prediction is performed on the lpo and rpo, also using unafold software. both lpo and rpo should pass a minimum threshold for Δg. although a Δg ≥  <dig> is preferred, many probes having a negative Δg actually work  <cit> , therefore the software allows the user to choose a negative Δg. finally, to ensure efficient ligation, it is recommended that the sequences immediately adjacent to the ligation site should contain no more than three g and/or c  <cit> . h-mapd favours low gc content at the ligation site by assigning a low ligation site score to high gc occurrence. the final score calculation for a probe set is shown in figure  <dig> 

probe sets that meet all physical-chemical criteria  are subject to uniqueness screening. homology search is performed for lpo and rpo using our local partial mirror of the ucsc blat server  <cit> . since hybridizing sequence is from genomic dna, in order to avoid interference from pseudogenes or closely related genes, both lhs and rhs should have one and only one perfect match in the same region of the genomic dna. however, it is conceivable that a user would try to design mlpa probes for a region which has multiple copies in the reference genome assembly. in order to allow this possibility, users can specify the maximum number perfect matches for the full hybridizing sequence  in the reference genome. the tm is calculated for all other non-specific  matches. if the tm is above °c, the probe set is dropped. this ensures that the tm of lhs and rhs is at least  <dig> °c above any non-specific matches. next, a snp search is performed using the latest snp database  included in the ucsc blat server. in the stuffer and bead protocols, lhs and rhs are usually not long. in the no-stuffer protocol, lhs and rhs can often reach more than  <dig> nucleotides in length. for short lhs/rhs , if any snp is detected anywhere in the lhs or rhs, the probe set is dropped. for lhs/rhs longer than  <dig> nucleotides, only the adjacent  <dig> nucleotides on each side of the ligation site are tested for snp occurrence. snp that are located  <dig> nucleotides away from the ligation site should not affect annealing and ligation of hybridizing sequences. finally, repeat sequences are more prone to cause non-specific binding due to their abundance in the genome. therefore, if either lhs or rhs overlaps with regions defined in the ucsc genome browser repeatmasker track, an extra criterion  is applied.

output
probe sets passing all criteria will be sorted by their scores and returned online . depending on the size of the input sequence, results will be returned in minutes or hours.

discussion
our software applies to human genomic mlpa probe design only but will be generalized in the future to deal with other genomes. in addition, h-mapd is currently only for the design of mlpa copy number assays, but may be generalized in the future to deal with the design of mlpa assays for other applications, such as snp detection and methylation changes. for multiple input sequences, the stuffer and bead tag modifications will be applied to the input sequences sequentially. for example, in bead-coupled mlpa, the first bead tag will be inserted into the first input sequence and so on.

the software takes into consideration most factors predicted to affect mlpa probe performance. however, there are likely to be unexpected factors that might cause problems. these factors include secondary structure of genomic dna at the hybridization site, the presence of un-described snp at the hybridization site, sequence errors in the reference genome assembly, etc. the software performs sequence homology searches using blat due to its speed and excellent programming interface. another popular sequence search tool is blast. because they are implemented using different algorithms, blat and blast may not return identical results. the authors strongly recommend that users verify h-mapd results with blast for independent validation.

two platforms are available for mlpa assays. the electrophoresis-based platform requires the use of capillary electrophoresis systems which are available in most institutions; however long oligonucleotides  in high quality are difficult to synthesize currently. the bead-coupled platform works with half probes  less than  <dig> nucleotides in length, but requires the use of a luminex system. for the electrophoresis-based platform, probe length increase is achieved either by inserting stuffer sequences between the pcr primer and hybridizing sequences, or by extending the length of hybridizing sequences. by using stuffer sequences, hybridizing sequences have identical length and therefore have a more unified tm. since the hybridizing sequences are short, the use of stuffer provides the potential for detecting mutations/polymorphisms that are in close proximity to each other. however, designing stuffer sequences takes time. the stuffer sequences in additional file  <dig> have been verified in advance so that the union of default pcr primer  and stuffer sequences  are free of secondary structure or significant homology in the human genome. some workers prefer extending hybridizing sequences to the use of stuffer sequences. however, longer hybridizing sequences are not suitable for short target regions and tend to result in more non-specific binding to the target genome. for the bead-coupled platform, the tag sequence can theoretically be incorporated in either the lpo or rpo. currently, since anti-tags are linked at their 5' end to the commercially available flexmap beads, we recommend inserting the tag sequences in the rpo as illustrated in additional file  <dig>  thus, only the right pcr primer is in physical proximity to the bead, minimizing any steric hindrance between the pcr product and the bead. another reason favouring inserting the tag in the rpo is that quite a few tag sequences start with adenosine . these tags will affect probe signal strength if inserted between the left primer and lhs. the commercial flexmap tag sequences were not designed specifically for mlpa assays, and some tag sequences, when attached to the default right primer, will form significant secondary structure on their own. for example, the tags corresponding to bead  <dig> and  <dig>  when attached to the default right primer, have secondary structures that are significant: Δg = - <dig>  and - <dig>  respectively . to avoid the use of these tags, the user can insert a short dummy sequence  in the input sequence corresponding to that tag . future development of h-mapd should allow users to use their own stuffer sequences or bead tag sequences. h-mapd allows users to specify custom pcr primers. however, users should be careful that the union of custom primers to the stuffer/tag sequences may result in secondary structures or significant homology to the human genome, even before specific hybridizing sequences are appended.

it is a challenge to design mlpa probes that can distinguish closely related sequences in the genome. for highly similar but non-identical sequences, h-mapd will treat them as non-specific matches and is likely to fail the probe set. one can design mlpa probes for highly related sequences by allowing multiple perfect matches to amplify the common identical fragments. of course the result represents multiple targets, and can not be used to distinguish the highly related but different sequences. a practical solution, as indicated in the mrc-holland probe design guidelines  <cit> , is to find the exact difference between the sequence of interest and its related sequences, and place the difference at the end of lpo or rpo. a branch of h-mapd specifically designed for this purpose will be implemented in the future.

CONCLUSIONS
h-mapd is a web-based mlpa probe design program implemented in perl-cgi, and hosted on a linux server. with the increasing application of mlpa in biomedical research and the lack of free probe design software, we hope that h-mapd will become a valuable tool for automatic mlpa probe generation and selection.

availability and requirements
h-mapd is freely available to non-commercial users at url . commercial users should contact the authors. since the software utilizes the ucsc genome browser and unafold, commercial users also need to obtain a license for those programs.

abbreviations
mlpa: multiplex ligation-dependent probe amplification; fish: fluorescent in situ hybridization; ucsc: university of california at santa cruz; snp: single nucleotide polymorphism; lpo: left probe oligo; rpo: right probe oligo; lhs: left hybridizing sequence; rhs: right hybridizing sequence; tm: melting temperature; Δg: minimum free energy change; qpcr: quantitative polymerase chain reaction; nt: nucleotide.

authors' contributions
jz implemented the software and web interface, defined score calculation equations, and drafted the manuscript. eh initiated the project, specified the probe design requirements, and modified the manuscript.

supplementary material
additional file 1
diagram of electrophoresis-base mlpa. two sequence-tagged half probes are annealed to adjacent sites on the genomic target sequence and ligated using a thermostable dna ligase. the ligated probes are subsequently amplified with universal primers  and quantified using electrophoresis. by inserting different-sized stuffer sequence between hybridizing sequence and primer sequence, or by extending the length of the hybridizing sequences, each product has a distinct size, which allows for identification by electrophoresis. the default left and right primers used in h-mapd are gggttccctaagggttgga and tctagattggatcttgctggcac, respectively. these are the same primers included in the commercial mrc-holland mlpa kits.

click here for file

 additional file 2
diagram of bead-coupled mlpa. similar to electrophoresis-based mlpa, except that the stuffer sequence is replaced by a fixed-length bead tag. identification of distinct sequences is based on association with a distinct bead. bead tags can be inserted either between the left primer and the lhs or between the rhs and the right primer. the default left and right primers used in h-mapd are gggttccctaagggttgga and tctagattggatcttgctggcac, respectively. these are the same primers included in the commercial mrc-holland mlpa kits.

click here for file

 additional file 3
stuffer sequences. the stuffer sequences  are from different locations of the lambda genomic sequence with minor modifications. to ensure that the union of primer and stuffer sequence itself does not fail any of the criteria, firstly all  sequences and  sequences were verified to be free of secondary structure at 60°c and  <dig>  m sodium concentration; secondly the maximum tm of primer and stuffer union sequences to the human genome is verified to be less than 55°c; thirdly no self or inter-probe annealing is detected for all  and  sequences.

click here for file

 additional file 4
flexmap bead tag sequences. flexmap bead tag sequences  are commercially available. Δg and maximum tm to the human genome was calculated for  and  union sequences. some of the tag sequences are not suitable for certain mlpa assays. for example, the tag corresponding to bead  <dig> or bead  <dig>  when attached to the right primer, has a secondary structure that is significant .

click here for file

 additional file 5
comparison of tm calculated by raw and unafold. melting temperatures of reference sequences mentioned in the mrc-holland mlpa probe design guidelines, were calculated using two different software, raw and unafold , at  <dig>  m sodium concentration. tm calculated by raw is on average  <dig> °c higher than that calculated by unafold with a standard deviation of  <dig> °c.

click here for file

 acknowledgements
the authors thank the office of scientific affairs, school of medicine, stony brook university for financial support.
