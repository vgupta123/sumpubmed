BACKGROUND
predicting the outcome of a disease or some disease related phenotype based on microarrays or other high-throughput data is an important application of genomic data. one particular instance of this problem is the prediction of the time to some disease specific event like death or relapse, often referred to by the technical term survival time or failure time. the most widely used model for survival data is the cox proportional hazards model  <cit>  which describes the instantaneous risk of failure at time t by the hazard rate   

here x = t is a set of genomic variables, e.g. gene expression or snp measurements, β = t is a vector of regression coefficients describing the effects of each variable, and h <dig> is the baseline hazard giving the hazard rate of an individual with all xj equal to zero. in the sequel we will refer to  as the genomic model.

a major challenge of high-dimensional genomic data, where the number p of predictors is much larger than the number of individuals n , is the problem of overfitting. by using complex enough models, there are infinitely many parameter combinations that fit the data perfectly, but these will make use of random predictor-response correlations, resulting in poor predictions on external data sets. the solution is to use some form of dimension reduction, or regularization, on the variable space to obtain a more parsimonious model. in the classical case of ordinary linear regression there are many methods for such high-dimensional data, including variable subset selection methods, principal components regression , partial least squares , ridge regression, and the lasso; see e.g.  <cit>  for a review. all these high-dimensional prediction methods have been adapted to the cox regression setting for censored survival data, e.g.  <cit>  and  <cit>  combining univariate selection and pcr,  <cit>  applying pls,  <cit>  using ridge regression, and  <cit>  and  <cit>  applying the lasso. in bøvelstad et al.  <cit>  a thorough comparison of the prediction performance of these methods was performed using three well known high-dimensional microarray gene expression data sets.

together with the genomic data, information on demographic and clinical variables  often exists. examples of such variables are age, stage, grade, tumor thickness, and lymph node status. the clinical covariates may be important predictors known to be correlated to survival. also, there exist many established prognostic indices that are combinations of such classical clinical covariates and that are widely used, like e.g. the nottingham prognostic index   <cit>  used for predictions in breast cancer or the international prognostic index   <cit>  for predicting survival of patients with non-hodgkin's lymphoma. specifically, assume that we have a vector z = t of demographic and clinical covariates. a prediction model using only these covariates can be obtained using the cox model   

where γ = t is a vector of regression coefficients for the demographic and clinical variables. we will in the sequel refer to  as the clinical model.

even though clinical and demographic variables have a prognostic value, predictions based on such covariates may not be accurate enough. for this reason, an immense effort has been put into finding genomic variables that can contribute to better predictions and hence more tailored treatment schemes, e.g.  <cit> . the hope has been that the genomic variables would fully replace the information obtained from the clinical and demographic variables. as a consequence, clinical and demographic variables with known predictive value have not been taken into consideration when building prediction models from genomic data. however, some studies  have shown that established clinical predictors are not outperformed by genomic variables as prediction tools. it may hence be useful to also consider established clinical covariates when building prediction models.

recently many authors have started focusing on combining clinical and demographic variables with genomic data forming what has been called clinico-genomic models. this has been done mostly for classification of patients, e.g. into high-risk and low-risk groups  <cit> . clinico-genomic models for survival prediction using the cox model  <cit>  or bayesian weibull tree models  <cit>  have also been proposed. common to these papers is that they find that the clinico-genomic models seem to outperform the models using either clinical covariates alone or genomic covariates alone. combining such data in a cox model would yield a clinico-genomic model given by   

where z are the clinical and demographic covariates and x the genomic variables. assuming that the established low-dimensional clinical and demographic covariates are known to have effect on survival, it is natural to perform dimension reduction only on the high-dimensional genomic covariates. combining clinical information and high-dimensional genomic data in a cox model is, however, not straightforward. in this paper we show how this can be done for seven well-known prediction methods based on the cox model, namely univariate selection, unsupervised and supervised principal components regression and partial least squares regression, ridge regression, and the lasso. many of these methods have been used with success when predicting survival using only genomic data, but have to our knowledge not been systematically studied for the combined clinical and genomic data.

the objectives of this paper are  to make a systematic comparison of the performance of the seven prediction methods when using both clinical covariates and genomic variables, and  to compare the overall prediction performance of the clinical model , the genomic model , and the clinico-genomic model . the comparison will be performed using three survival data sets containing both clinical information and microarray gene expression data.

methods
we assume that the demographic and clinical covariates z are known to have an effect on survival . thus, for the model  with only clinical covariates no variable selection or dimension reduction will be done. we simply fit an ordinary cox model to the data to obtain parameter estimates.

bøvelstad et al.  <cit>  described how univariate selection, pcr, supervised pcr, pls, ridge regression, and the lasso can be applied to model  using the genomic variables as the only covariates. the same is described for supervised pls in nygård et al.  <cit> . the methods are similar to the corresponding ones described below for the clinico-genomic setting.

when we have both clinical covariates and genomic variables, we will treat the clinical model  as a starting model. the additional effects of the genomic variables x are found by simultaneously estimating the effects of x and z using , but where the dimension reduction is applied only to x. in the next subsections we describe in more detail how this can be done for the prediction methods under study. all seven methods assume a given model complexity, represented by a parameter λ. the optimal value of λ can be found using cross-validation, which will be described later.

prediction methods for clinico-genomic models
univariate selection
we start out with the clinical model , i.e. a cox regression model including only the demographic/clinical covariates z. for each gene g, we test this model versus a cox model including the gene together with the clinical variables, i.e. we test h = h <dig> exp versus h = h <dig> exp. these tests are performed using a local score test . the λ top ranked genes from the models with the smallest p-values are picked out and included along with the clinical covariates z in a multivariate cox regression model.

principal components regression 
principal components analysis  finds linear combinations of the genomic variables, where each new linear combination has maximal variance under the constraint of being orthogonal to the first ones. we find the λ first principal components using pca on the genomic variables x. we then include the principal components together with the demographic and clinical covariates z in a multivariate cox regression model.

supervised principal components regression
since the principal components are constructed without considering the response, there is no guarantee that the components are associated with patient survival. with this argument,  <cit>  and  <cit>  proposed a supervised pcr, where a pre-selection of genes significantly correlated to survival is included before the pca is applied. following this approach, we first pick out λ <dig> percent of the top ranked genes using univariate selection as described above. we then apply pca to this subset of genes and include λ <dig> of the first components together with z in a multivariate cox model.

partial least squares  regression
like pcr, partial least squares regression is based on linear combinations of the genomic variables. however, pls uses combinations that are correlated with survival. there are many suggestions on how to perform pls for the cox regression setting. we will use the method of nygård et al.  <cit>  that allows for inclusion of demographic and clinical covariates together with the genomic variables, but only performs dimension reduction on the latter.

supervised partial least squares regression
pls finds linear combinations in the space of the genomic variables, which have the property of maximizing the covariance between the components and the response . the covariance is the product of the variance of the components and the correlation between the components and the response. it is often experienced that the variance part is dominating, causing pls to behave very much the same way as pcr. as for pcr, it can therefore be argued that also pls may benefit from a preselection step finding the genes most correlated to patient survival. in our supervised pls cox method for both genomic and demographic/clinical variables we use the same algorithm as in the supervised pcr method described above, except that the pcr step on the pre-selected genes is replaced by the pls algorithm given in  <cit> .

ridge regression
ridge regression  <cit>  shrinks the regression coefficients by imposing a penalty on their squared values. van houwelingen et al.  <cit>  showed how ridge regression can be applied to the cox regression setting with high-dimensional genomic data by maximizing a penalized log-likelihood. we may extend the approach in  <cit>  by including lower-dimensional covariates z in the log-likelihood, but performing penalization only on the high-dimensional covariates x. this gives us the following penalized log-likelihood:  

where lfull  is the full log-likelihood given by  <cit>   

here, ti denotes the possibly censored survival time of individual i, and di indicates whether this survival time is observed  or censored . further, h <dig>  is the cumulative baseline hazard and Δh <dig> is its increment at time ti.

to reduce the computational burden, we use the approach of van houwelingen et al.  <cit>  to obtain parameter estimates. they noted that the estimating equation ∂lpen/∂β =  <dig> implies that the resulting estimate for β lies in the space spanned by the columns of x, where x is the n × p matrix whose ith row is the vector  of genomic variables for patient i. therefore, we may write β = xtψ , for some ψ . the dimension of the problem is thus reduced from p to n. in terms of ψ , we have  

where ui is the ith row of u = xxt.

lasso
the lasso  <cit>  shrinks the regression coefficients in a similar manner as ridge regression, but uses the absolute values instead of the squared values. penalizing the absolute values has the effect that a number of the estimated coefficients will become exactly zero, which means that the lasso is also a variable selection method. like ridge regression, the lasso can be modified to include clinical and demographic covariates with penalization only of the high-dimensional genomic variables. more precisely, the cox regression coefficients in the clinico-genomic model  can be found by maximizing l - . here, l is the logarithm of the cox partial likelihood for model  given by  

where r is the risk set of time ti. we have used the lasso implementation of cox regression due to park and hastie  <cit> , available through the r package glmpath. the clinical covariates were specified using the "nopenalty.subset" argument.

cross-validation
all methods described in the previous subsections depend on a parameter λ, representing the complexity of the genomic part of the model: the number of genomic variables for univariate selection, the number of linear components for pcr and pls, and the penalty parameter for ridge regression and the lasso. for supervised pcr and supervised pls the model complexity depends on both the number of genomic variables and the number of pcr/pls components, i.e. λ =  is two-dimensional for these two methods.

the value of λ must be estimated, and finding the optimal model complexity is a difficult but crucial task when analyzing high-dimensional data. the method of cross-validation  can be used to find the optimal model complexity λ. we will use 10-fold cv together with verweij and van houwelingen's  <cit>  cv criterion, which is based on the cox log partial likelihood. after having found the optimal λ for the genomic part of the model, this value is used in a prediction method as described in the previous subsections to find estimates of β for the genomic model , and estimates of γ and β for the clinico-genomic model .

prediction performance
thus far we have described how to find estimates of β for the genomic model  and estimates of γ and β for the clinico-genomic model . to evaluate how good these estimates are for prediction, we will follow the evaluation scheme proposed in bøvelstad et al.  <cit> . more precisely, we will compare the prediction performance of the seven methods using the following approach: the data are randomly split into training and test sets, where the training set is about twice as large as the test set. then 10-fold cv is used on the training set to find an estimate  of the optimal model complexity for the genomic part of the model. given , we use the whole training set to obtain an estimate  for the effects of the genomic covariates in model , and similarly for model  the estimates  and  for the effects of the demographic/clinical and genomic covariates, respectively. for the clinical model ,  is estimated directly by ordinary cox regression using the whole training set since no variable selection or dimension reduction is performed on these covariates. note that the test data are set aside in the whole model building procedure, and are only used to evaluate the final prediction model. this is done in order to ensure a completely independent evaluation.

as a measure of how well a prediction model performs on the test data set, we will use the difference in deviance between a fitted model and the null model containing no covariates. specifically, for the clinico-genomic model this difference in deviance is given by   

where l () and l  are the cox log partial likelihood for the test data evaluated at ()t and  <dig>  respectively. the difference in deviances for the clinical model and the genomic model can also be found using , but where l () is replaced by l () and l (), respectively. note that  <dig> - , where m is the number of subjects in the test data set, may be interpreted as a measure of the variation in the test data explained by the prediction model  <cit> . the performance of a model is good when the difference in deviance is small.

bøvelstad et al.  <cit>  showed that the relative performance between the prediction methods could depend on the particular training/test splits. to ensure a fair comparison, we therefore follow their approach and generate  <dig> random splits of the data into 2: <dig> training and test sets. the performance of the methods are then evaluated by the median and the spread of the difference in deviance over the  <dig> splits.

RESULTS
three different data sets will be used in order to compare the performance of the prediction methods described in the methods section, as well as the performance of the clinical models, the genomic models, and the clinico-genomic models. the data sets are described below, along with the results.

breast cancer data
the first data set is from the paper of van houwelingen et al.  <cit>  and contains  <dig> gene expression measurements, clinical covariates, and censored survival times from  <dig> dutch women diagnosed with breast cancer. the data have been visited in a number of papers, and is a modified version of the data introduced in the papers of van't veer et al.  <cit>  and van de vijver et al.  <cit> . the median follow-up time is  <dig>  years, and out of the  <dig> patients 27% experienced breast cancer death. as clinical covariates, we use tumor diameter , lymph node status , and grade , which are classical clinical covariates used for prediction of breast cancer survival. also, the classification rule that defines the nottingham prognostic index   <cit>  is based on these three covariates. for more information on the data, see  <cit> .

the results when applying the described methods to the data are summarized in the boxplots of figure  <dig>  the data are divided  <dig> times at random into training and test sets containing  <dig> and  <dig> patients, respectively. as in the paper of bøvelstad et al.  <cit>  we will for each method consider the median of the  <dig> values of difference in deviance as the measure of main interest. for all three boxplots, the horizontal black line at zero indicates the null model , and is displayed for reference.

the left-hand boxplot of figure  <dig> shows the difference in deviance obtained from applying the clinical model to the  <dig> training/test splits. the median of these  <dig> values is further displayed, for easy comparison, by a dashed magenta line in the other two boxplots.

the center boxplot of figure  <dig> displays the predictions made from the seven methods when using the microarray gene expression data as covariates. from the plot we see that univariate selection has the poorest performance, and that many of its  <dig> predictions are worse than what can be obtained using a prediction model with no covariate information. from the plot we also see that pls, supervised pls, supervised pcr, and the lasso give poorer predictions than the clinical model. pcr has on the median a similar performance as the clinical model, but predictions using pcr yields larger variation. ridge regression is the method with the best prediction performance according to our definition, and also the method with the smallest variation. also, ridge regression is the only method able to improve predictions using genomic information compared to using the clinical model .

finally, the right-hand boxplot of figure  <dig> displays the results when using both types of data for prediction. for comparison purposes, we have indicated the median of each of the seven methods when applied to the microarray gene expression data by a green star. studying the plot, we see that the methods have a more similar performance and are less variable than the corresponding results from the genomic model. again, univariate selection has the poorest performance, and ridge regression is the only method able to make predictions that are better than when using clinical data alone. compared to the genomic model, all methods except pcr and ridge regression have improved prediction when using both clinical and genomic covariates.

dlbcl data
the second data set, introduced in rosenwald et al.  <cit> , consists of censored survival times and  <dig> microarray gene expression measurements for  <dig> patients with diffuse large-b-cell lymphoma . the median follow-up time is  <dig>  years, and 57% of the patients died during follow-up. for  <dig> of these patients, we also have information on the international prognostic index , which is a well-established prognostic score derived from five clinical covariates . the ipi has levels low, medium, and high. since we want to compare models containing both types of data, we will restrict our attention to the smaller set of patients. for more information on the data, see  <cit> .

neuroblastoma data
the last data set is from oberthür et al.  <cit>  and consists of  <dig> patients suffering from neuroblastoma. for each patient, we have information on their risk group according to the current german neuroblastoma trial  as well as  <dig> microarray gene expression values and its  censored survival time. median follow-up time for the patients are  <dig>  years, and out of the  <dig> patients 21% died from the disease. the patients were introduced in  <cit>  as two different sets; one "training set" of  <dig> patients and one "test set" of  <dig> patients. we merged the two, and the  <dig> microarray gene expression measurements are from probes shared by both sets. due to few events in the two lower nb <dig> risk groups, we chose to combine them into one group. also,  <dig> patients were omitted from our study due to missing clinical information. for more information on the data, consult  <cit> .

we generated  <dig> random splits of training  and test  sets from the data, and formed boxplots from the results which are displayed in figure  <dig>  from the center plot, we observe that when using microarray gene expression data, only ridge regression is able to make predictions that are better than if using only the nb <dig> stratification index. this is in accordance with the observations made for the breast cancer data. as seen for the dlbcl data, combining the clinical covariate and the microarray gene expression data resulted in a large improvement in prediction ability for all prediction methods. in fact, all methods but univariate selection are able to make better predictions than the clinical model using the nb <dig> strata alone. for the clinico-genomic models, supervised pls has the best median performance, whereas ridge regression has the second best performance.

results summary
observing each boxplot in figures  <dig>   <dig>   <dig>  there is a fairly large spread in the difference in deviance over the  <dig> splits. this is partly due to variation caused by splitting the data at random into training and test sets, and partly due to variation in the performance of the prediction methods for the various splits. in order to explore how much of the variation that is due to the latter when using the combined data in a clinico-genomic model, we use ridge regression as a benchmark and, for each of the splits, compute the difference between the deviance of the six other methods and the deviance of ridge regression. figure  <dig> shows boxplots of these differences for the  <dig> splits, and represents a pairwise comparison between ridge regression and the other methods when applied to the combined data. the figure shows that for a majority of the splits, ridge regression has a better prediction performance than all the other methods on all three data sets. note that this also applies for the neuroblastoma data where supervised pls had better median performance than ridge regression .

discussion and 
CONCLUSIONS
in treatment of patients with cancer and other fatal diseases, obtaining accurate survival predictions is a crucial step for better treatment decisions and prolonged survival. several recent studies  <cit>  have suggested that combining clinical information and genomic data may lead to better predictions than when using such data separately. however, for the well-known cox regression model, combining low-dimensional clinical data with high-dimensional genomic data is not straightforward. we have shown how this can be done for seven well-known prediction methods used for high-dimensional data. in addition, we have performed a systematic study in order to  study the behavior of these seven methods when applied to the combined data, and  compare the survival predictions obtained when using only clinical data, only genomic data, or a combination of the two.

to compare the prediction methods, we used the comparison scheme of bøvelstad et al.  <cit> . the scheme was applied to three survival data sets containing both clinical information and microarray gene expression measurements for patients diagnosed with breast cancer  <cit> , diffuse large-b-cell lymphoma   <cit> , and neuroblastoma  <cit> . in our study, we have assumed that the clinical covariates are known to have an effect on survival, so no selection or dimension reduction have been applied to these covariates. for multiple pairs of training/test sets we employed cross-validation on the training sets to find the optimal complexity of the genomic part of the models, and evaluated the models on the independent test sets. doing this, we did not risk the danger of getting overly optimistic results for the genomic predictor, which some earlier studies have shown. in van't veer et al.  <cit> , for example, the genomic predictor was both derived and evaluated on the same data, leading to a heavily overestimated prediction strength for this predictor. this was criticized by tibshirani and efron  <cit> , who proposed the method of k-fold pre-validation , where the prediction for each individual i is based on a rule made with fold g, i ∈ g, left out. the pre-validation procedure is especially suited when data are sparse, as it also uses the training data in the evaluation procedure. bøvelstad et al.'s  <cit>  procedure of fitting and evaluating the methods on multiple random splits into training and test sets is an alternative way of utilizing the whole data set in the evaluation procedure.

we find that ridge regression has the best median prediction performance for the breast cancer data and the dlbcl data, and has the second best performance for the neuroblastoma data . however, in the pairwise comparison , ridge regression performs better on all three data sets than all the other methods for more than half of the  <dig> splits studied. for the breast cancer data and the dlbcl data, comparing the unsupervised versions of pcr/pls with the supervised versions for the clinico-genomic models indicate that pre-selection of genes is not improving predictions, and rather giving more unstable results. the lasso, which can be thought of as a selection method, has a rather poor performance in two out of three data sets. simple univariate selection has the poorest performance of the methods studied. this is evident in all three data sets. its performance is fairly good on the combined data, but this is simply because it for most of the  <dig> splits selects no genes, and thus behaves more or less as the clinical model.

the second goal of our comparative study was to investigate the prediction performance of models that utilize only clinical data, only genomic data, or a combination of the two. based on the three data sets, our comparison study indicated that using genomic data alone may lead to poorer predictions than what can be obtained from established clinical predictors. in the cases where the genomic models were better than the clinical ones, ridge regression was used for dimension reduction. we also found that the clinico-genomic models tend to outperform the models based on genomic data alone. however, the improvement of using combined data varied among different diseases. in our study there was a difference between the breast cancer data on one hand, and the dlbcl and neuroblastoma data on the other. for the breast cancer data set, the clinical covariates and the genomic covariates seemed to contain much of the same information for the purpose of prediction. thus, the predictions made using microarray gene expression data alone did not differ much from the predictions made when using both the clinical data and the microarray gene expression measurements, as observed in figure  <dig>  this is in agreement with the results found in  <cit> . for the dlbcl and the neuroblastoma data sets, the information was more orthogonal and large improvements were made when combining the data into clinico-genomic models .

we conclude that combining traditional clinical covariates with high-dimensional genomic data may lead to better predictions than what can be achieved using the data separately. also, the results from the three data sets studied indicate that the choice of high-dimensional prediction method may be important. ridge regression seems to be the method that most often achieves the best predictions when applied to both the genomic model and the clinico-genomic model. however, we emphasize that additional studies investigating more data sets, as was done in  <cit> , should be carried out in order to confirm our findings and draw final conclusions.

finally we want to point out that the purpose of this paper has been to perform a methodological study comparing the seven methods for building prediction models using clinical and genomic data. this is different from finding a prediction model for a given data set. in order to build a clinico-genomic prediction model using a given dimension reduction method, one should use the whole data set  and proceed as described for a single set of training data in the methods section.

authors' contributions
the project idea emerged from our study of prediction methods based on genomic data  <cit> . hmb and sn developed and implemented the matlab code for the various prediction methods. hmb organized the data sets and performed the computations. hmb and sn drafted the paper. Øb discussed the project with hmb and sn as it progressed and commented on various drafts of the manuscript. all authors have read and approved this manuscript.

