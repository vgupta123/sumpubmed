BACKGROUND
intrinsically disordered, or natively unfolded, proteins or protein regions do not fold into stable three dimensional  structures under physiological conditions; they instead exist as ensembles of non-cooperatively interchanging conformations in which the atom coordinates and backbone ramachandran angles vary significantly over time with no specific equilibrium values  <cit> . although lacking specific 3-d structures, many intrinsically disordered proteins/regions have been identified to carry out important biological functions  <cit> . it was further suggested that these functions indeed require disordered regions of flexible, dynamic conformations instead of rigid ordered regions  <cit> . based on these findings, the protein trinity  <cit>  or quartet  <cit>  model was proposed as an alternative to the commonly accepted protein sequence-to-structure-to-function paradigm  <cit> . that is, native proteins or functional regions may exist in up to four forms – ordered, molten globule , pre-molten globule , and random coil-like  – and functions may arise from any of these forms or from the transitions between them  <cit> .

while the distinction between the molten globule and the two extended forms is fairly clear, the distinction between the pre-molten globule and the random coil-like forms is less certain. that is, several pre-molten globules have been observed to convert to molten globules by all-or-none transitions, suggesting that these partially folded conformations likely represent discrete forms  <cit> . on the other hand, in comparison to the random coil-like form, the pre-molten globule form is less extended, contains more  secondary structure and also exhibits more evidence for hydrophobic clusters  <cit> . furthermore, the pre-molten globule to random coil-like transition is featureless  <cit> , suggesting that these two forms lie on a continuum with regard to the degree of backbone extension.

due to their functional importance, it is essential to be able to reliably detect intrinsically disordered regions and such ability could have significant impact on a wide range of biomedical research. although many experimental techniques exist  <cit> , detecting intrinsic disorder might still be costly and time-consuming. furthermore, it is often helpful to use more than one technique to completely characterize a disordered region since different methods could reveal different aspects of intrinsic disorder  <cit> . alternatively, various computational algorithms have been developed for predicting intrinsically disordered regions from amino acid sequence  <cit> . the success of these predictors strongly supports the hypothesis that intrinsic disorder, like globular structure, is also encoded by the amino acid sequence  <cit> . although not perfect, these predictors have been successfully used in many real-life applications, e.g. designing protein structure-function experiments  <cit> , understanding the roles of disorder in cell-signalling and cancer-related proteins  <cit> , improving prediction of protein phosphorylation sites  <cit> , and improving the throughput of structural genomics pipelines  <cit> . indeed, recent nmr experiments suggest that intrinsic disorder is a significant bottleneck in structural genomics efforts  <cit> .

most existing disorder predictors use a sliding window to map individual residues into a certain feature space, where a binary classifier can then be built to classify the residues as disorder or order using various machine learning algorithms. the features are usually extracted from the partial amino acid sequence within the window that directly reflects the compositional bias and unique properties that characterize intrinsic disorder. in some recent approaches, e.g. vl3-p  <cit>  and disopred <dig>  <cit> , features are also derived from psi-blast  <cit>  generated profiles to incorporate evolutionary information. the improved performance of these approaches was consistent with the findings that intrinsically disordered regions have distinct evolutionary characteristics  <cit> . recently, several novel algorithms have been proposed that do not require representing sequence with fixed number of features. for example, dosztanyi et al. used the pairwise energy content estimated from amino acid composition to distinguish between folded and unfolded proteins/regions  <cit> . yang et al. applied the regional order neural network  to estimate the disorder probability of a given sequence region based on its distances from a set of "prototype" disordered/ordered regions  <cit> . in another study  <cit> , coeytaux and poupon developed a rule-based predictor for unfolded regions based on the amino acid propensity of being disordered and the distance to the nearest hydrophobic cluster.

like the structural classification of ordered proteins, e.g. α-helix and β-sheet at the secondary structure level, and all α, all β, α/β and α+β classes at the tertiary structure level, we suggest that there are also several subtypes  of intrinsic disorder distinguished by amino acid compositions and sequence properties. it was first illustrated that long disordered regions characterized by different methods – x-ray diffraction, nmr, and circular dichroism  – exhibited observable difference in amino acid compositions  <cit> . using a supervised clustering procedure, it was discovered that there were at least three flavors  of long disorder, and three flavor-specific disorder predictors outperformed a global predictor  on the corresponding flavors  <cit> . on the other hand, amino acid compositions and sequence properties might also vary among disordered regions of different lengths, as indicated in our initial study of intrinsic disorder prediction  <cit> . this observation was further confirmed in a recent study  <cit>  using much larger datasets, which clearly illustrated the significant differences between a set of disordered regions shorter than  <dig> residues and another set of disordered regions longer than  <dig> residues. however, due to difficulties in collecting disorder data, we did not pursue this issue further but instead focused on developing predictors specific for long disordered regions .

as revealed in the casp <dig> experiment  <cit> , most of the predictors that we tested were significantly less accurate on short disordered regions  than on long disordered regions , with accuracies of 25–66% versus 75–95%, for short versus long regions of disorder, respectively. given the length-dependent heterogeneity in amino acid composition, such a discrepancy is not surprising because these predictors were trained exclusively on long disordered regions. another contributing factor might be the use of large sliding windows for feature construction  and output smoothing . in the first case, a large window could make residues from short disordered regions indistinguishable from those from ordered regions in the feature space, since most features were based on the local amino acid statistics within the window. in the second case, a large window would inevitably filter out many predicted short regions while improving prediction on long disordered and ordered regions.

based on these findings, we developed a composite predictor called vsl <dig>  <cit>  to address this length-dependent heterogeneity problem in disorder data. it consisted of three component predictors in a two-level architecture: at the first level there are two specialized predictors optimized for long  and short  disordered regions, respectively; at the second level is a meta predictor for integrating the specialized predictors' outputs. as blind-test results in the latest casp <dig> experiment showed, vsl <dig> significantly improved the prediction performance on short disordered regions, while retaining high accuracy on long disordered regions comparable to our previous long disorder predictors  <cit> . it also achieved the best prediction performance in almost all evaluation criteria used by the independent assessor  <cit> .

in this report we describe two new predictors that are similar to vsl <dig>  although vsl2-m <dig> has identical architecture to vsl <dig>  vsl2-m <dig> adopted a different approach  to integrate the specialized predictors. another difference is that vsl <dig> component predictors were built as linear support vector machine   <cit>  instead of logistic regression models  <cit>  in vsl <dig>  finally, the training dataset for vsl <dig> is slightly different from vsl <dig> by removing  <dig> mislabelled sequences. as the 10-fold cross-validation results showed, both vsl <dig> predictors achieved well-balanced prediction accuracies of about 81% on the two types of disordered regions, and were clearly superior to using either one of the specialized predictors alone. comparisons over vsl <dig> training dataset via 10-fold cross-validation and a blind-test set of unrelated recent pdb chains indicated that vsl <dig> predictors were significantly more accurate than several existing predictors of intrinsic protein disorder. the results also showed that vsl <dig> had improved sensitivity over vsl <dig> but at the cost of reduced specificity.

implementation
datasets
training dataset
a total of  <dig>  non-redundant protein sequences, with pairwise sequence identity ≤25%, were used for vsl <dig> predictor training. these proteins were assembled from four other datasets:  <dig> sequences from disprot   <cit>  with  <dig> long  and  <dig> short  disordered regions,  <dig> pdb chains with  <dig> long and  <dig> short disordered regions  <cit> ,  <dig> completely folded pdb chains  <cit> , and  <dig> recent pdb chains  with  <dig> long and  <dig> short disordered regions. his-tags and initial methionines were removed for further consideration from any applicable sequence.

in total there were  <dig>  disordered regions with  <dig>  residues and their length distribution is shown in table  <dig>  of these disordered residues, about 72% came from  <dig> long disordered regions. while these long disordered regions were determined and validated by literature searches, the  <dig>  short disordered regions were primarily identified as regions of missing electron density map in x-ray structures. in this study, we did not include the  <dig> very short disordered regions of 1– <dig> residues in either predictor training or accuracy estimation. such short disordered regions are probably as likely to result from non-fitting structural environments as from their intrinsic sequences. of the remaining  <dig> short disordered regions of 4– <dig> residues,  <dig> and  <dig> were at n- and c- termini, and contained  <dig>  and  <dig>  residues, respectively.

the training dataset contained a total of  <dig>  ordered residues from the  <dig>  sequences. for  <dig>  of them we were able to extract their cα b-factors from pdb. these b-factors were first normalized to zero mean and unit variance after removing outliers, chain by chain, using a procedure by smith et al.  <cit>  the ordered residues were then assigned to two sets as high-b-factor  and low-b-factor  depending on whether their normalized b-factor values were higher than  <dig> . the high-b-factor ordered residues were shown to have amino acid compositions and sequence properties similar to short disordered regions  <cit> . we therefore excluded high-b-factor ordered residues from predictor training since they might affect the training process. however, they were included in accuracy estimation.

blind-test dataset
to facilitate performance comparison to other protein disorder predictors, we also constructed a blind-test dataset  of  <dig>  recent pdb chains based on  <dig>  pdb entries deposited between september  <dig>   <dig> and december  <dig>   <dig>  all these structures  were determined by x-ray diffraction with resolution ≤ <dig> Å and r-value ≤ <dig> . for each chain in an entry, the sequence segments extracted from structural data, e.g. remark  <dig> , atom, hetatm, and ter  records, were aligned to the corresponding seqres sequence. if any inconsistency or error was detected, the whole entry was discarded. in total  <dig>  of the initial  <dig>  entries were successfully processed, resulting in  <dig>  chains of ≥ <dig> residues. after removing his-tags or leading/trailing segments, disordered regions were then identified as residues of missing electron density based on the remark  <dig> record.

we then performed clustering analysis to remove redundant chains and chains similar to training sequences. the ncbi blastclust program  <cit>  was applied to the union set of the new chains and the training sequences, with identity threshold of 25% , minimal length coverage of 100%  on only one sequence of a pair . if two chains fall into different clusters, they should have pairwise sequence identity <25%. thus, the blind-test dataset was constructed by selecting one representative chain from each of the clusters that contained no training sequences, with the criteria as  highest resolution,  lowest r-value, and  most disordered residues. in total, the blind-test dataset contained  <dig>  chains with  <dig>  disordered residues and  <dig>  ordered residues. the length distribution of these disordered regions is shown in table  <dig>  in this blind-test dataset about 19% of all disordered residues came from  <dig> long disordered regions, while in the vsl <dig> training dataset this proportion was about 72%.

vsl <dig> architecture
both vsl2-m <dig> and vsl2-m <dig> consist of three component predictors in two-level architectures . at the first level, there are two specialized predictors: a short disorder predictor, vsl2-s, for disordered regions of ≤ <dig> residues, and a long disorder predictor, vsl2-l, for disordered regions of > <dig> residues. at the second level, there is a meta predictor that combines outputs of the two specialized predictors into the final prediction. all component predictors are built as binary classifiers that approximate the posterior class probability p, where x is the feature  vector and c is the class label. for the two specialized predictors, class  <dig> data corresponds to short disorder or long disorder, while class  <dig> data corresponds to order. similar to previous disorder predictors, a set of features are extracted from the amino acid sequence and other related data using the standard sliding window approach.

meta predictor m <dig> is trained independently of the two specialized predictors . its class 1/ <dig> data corresponds to residues that are either within or at most / <dig> positions away from a long/short disordered region, where win is an odd number. if the output om is close to  <dig> , the current residue is more likely to be within or close to a long  disordered region, and thus the specialized predictor vsl2-l  should be given greater importance. if om is close to  <dig> , the current residue is more likely to be in an ordered region and both specialized predictors should contribute equally. therefore, the final prediction can be calculated as ol × om + os × , where ol and os are outputs of vsl2-l and vsl2-s. for meta predictor m <dig> , the inputs are  <dig> × win predictions by vsl2-s and vsl2-l for residues within a symmetric window of length win. its output is the final disorder prediction.

feature construction
for the two specialized predictors and meta predictor m <dig>  features were constructed for each residue based on an input  window of length win  centred at the residue, where the value of win is selected to maximize the prediction accuracy. the window was extended outside the n-/c- terminus by padding it with / <dig> special spacer characters. this approach is equivalent to the extra input per residue used in other protein structure predictors to indicate when the window spans the termini . in total, four sets of  <dig> features were calculated from amino acid sequences, sequence profiles, and secondary structure predictions.

the first set  of  <dig> features was derived from local amino acid composition of the partial sequence within the input window, including the  <dig> amino acid frequencies, the spacer character frequency, the k2-entropy measure of local sequence complexity  <cit> , the average net charge, the average hydrophobicity  <cit> , the charge-hydrophobicity ratio  <cit> , and the average flexibility index  <cit> . to incorporate evolutionary information, sequence profiles were generated by psi-blast  <cit>  searches  against the uniref <dig> database  <cit> . as in the vl3-p predictor  <cit> , the 20-column position-specific scoring matrix  and the last  <dig> columns from the profile  were averaged over the input window, resulting in the second set  of  <dig> features. in addition, three secondary structure prediction scores by the phdsec predictor  <cit>  and another three by the psipred predictor  <cit>  were also included. while the phdsec predictions were made without using multiple sequence alignment , psi-blast profiles were used for psipred predictions. the prediction scores were then averaged over the input window to obtain another  <dig> features .

we applied feature selection using a permutation-test-based feature filter  <cit>  and several other algorithms implemented in the weka data mining package  <cit> . principal component analysis  was then performed to de-correlate the selected features and further reduce the sample dimensionality by keeping the variance at 95%.

predictor model
the component predictors were built as linear support vector machines  using the inner-product kernel  <cit> . a hyperplane in the feature space is learned from the training data to separate examples from the two classes . by choosing the hyperplane that maximizes the margin, the resulting predictor could often achieve better generalization performance on out-of-sample data  <cit> . if the two classes cannot be well separated by a hyperplane in the original feature space, non-linear kernels  can be used to map the data into a higher dimensional space where the two classes become separable. due to its ability to handle complex, high-dimensional and noisy data, svm has been widely used in various computational biology problems .

in this study we used the svmlight  <cit>  implementation for building svm predictors, since it is scalable and can handle very large datasets efficiently. in addition, a single-input logistic regression model was trained to calibrate the svm output into posterior probability p  <cit> . given a set of training sequences, an embedded 5-fold cross-validation was performed to select the optimal parameter c which represents the trade-off between training error and margin  <cit> . a final svm predictor can then be built with available sequences using the selected c. note that the available training sequences here are not necessarily all  <dig>  sequences in the training dataset, but could be 9/ <dig> of them as in the 10-fold cross-validation procedure for accuracy estimation . to train the predictors, balanced datasets were always used by randomly sampling from available training sequences.

we also examined several other popular learning algorithms such as logistic regression models  <cit> , feed-forward neural networks  <cit> , neural network ensembles  <cit> , and non-linear svms  <cit> . however, our results showed that none of them significantly outperformed linear svms.

output smoothing
as in our previous studies , a moving-average approach was applied to smooth the raw predictions to remove occasional misclassifications, based on the assumption that neighbouring residues often share the same structural property. in this approach, the final prediction for a given residue is calculated as the average of raw predictions for neighbouring residues within an output window of length wout  centred at that residue. like the input window length win, wout is also subject to optimization to maximize the prediction accuracy.

performance evaluation
a 10-fold cross-validation procedure was used to estimate the out-of-sample prediction accuracies. first, the training dataset d of  <dig>  sequences were randomly divided into  <dig> disjoint subsets d <dig>  d <dig>  ..., d <dig> of roughly equal sizes. second, in the i-th fold, i =  <dig> ,..., <dig>  a vsl <dig> predictor was built with sequences in d – di only and then applied to the sequences in di. after the procedure is complete, predictions for all sequences from d can be obtained. in this way, the prediction for any sequence is always made using a predictor trained without that sequence. finally, prediction accuracies  can be estimated using predictions for all  <dig>  sequences to evaluate the performance.

in the i-th fold, i =  <dig> ,..., <dig>  component predictors were first trained with all applicable sequences in d – di only. the optimal svm parameter c for each component predictor was selected using "embedded" 5-fold cross-validation as described above . for specialized predictors vsl2-s and vsl2-l, class  <dig> examples were drawn from short and long disordered regions respectively, and class  <dig> examples were drawn from low-b-factor ordered regions . the training data for meta predictor was constructed as described above , also using sequences from d – di only. once the component predictors were built, the vsl <dig> predictor was assembled and applied to sequences from di.

for a given predictor, the overall accuracy  is measured as the average of sensitivity  and specificity , where the sensitivity, or true positive rate, is the percentage of class  <dig> examples correctly predicted, and the specificity, or true negative rate, is the percentage of class  <dig> examples correctly predicted, using a certain decision threshold . compared to other performance measures, such as q <dig> score   <cit>  and matthews' correlation coefficient  <cit> , the acc measure is more suitable for datasets of imbalanced class proportions. in such a case, a random predictor or a trivial predictor that assigns all examples to one class will have an overall accuracy of 50%.

for both specialized predictors and the final predictors, three sensitivities – sns, snl and sn – are reported for short, long and all disordered regions, respectively. accordingly, the overall accuracies were calculated as accl = / <dig> for vsl2-l, acc = / <dig> for vsl2-s, and acc = / <dig> for the final predictors. for meta predictors, we did not explicitly estimate their accuracies but instead used the accuracies of the corresponding final predictors for performance evaluation.

unless explicitly specified, the accuracies reported are per-chain accuracies, i.e. sns, snl, sn and sp were first calculated on each individual chain  and then averaged over chains. since about 72% of the disordered residues in our training data came from long disordered regions, per-residue accuracies  could be dominated by the performance on long disordered regions. even for the long disorder predictor vsl2-l, its per-residue accuracy  could be biased toward certain extremely long disordered regions. therefore, we chose per-chain accuracies for model selection and predictor comparison but also reported per-residue accuracies. note that among the per-chain accuracies, sn could be higher than both sns and snl because some chains may have both short and long disordered regions and the three sensitivities were averaged over different subsets of chains.

in addition to the accuracies calculated with the default threshold  <dig> , we also plotted the receiver operating characteristic  curve and calculated the area under the roc curve   <cit> . the roc curve is a plot of sensitivity against , usually calculated at different decision thresholds. that is, each point on the roc curve corresponds to a specific threshold used. the area under the roc curve  is known to be a useful measure of overall predictor quality, with a value of  <dig> for a perfect predictor and  <dig> for a random predictor. note that roc curves could also be per-chain or per-residue version, depending on the type of sensitivity and specificity used.

finally, a bootstrap  <cit>  procedure was used to estimate the standard error for each accuracy measure discussed above. more specifically,  <dig>  bootstrap replicated samples were drawn from of the  <dig>  sequences with replacement, and the accuracies were calculated on each bootstrap sample. the standard errors were then reported as one standard deviation of the results obtained over the  <dig>  runs.

RESULTS
length dependent amino acid compositions
the amino acid compositions of short  and long  disordered regions were compared to the composition of a reference ordered dataset, globular-3d  <cit> . as shown in figure  <dig>  both types of disordered regions exhibit similar overall compositional bias that characterizes intrinsic protein disorder  <cit> , i.e. depletion of the typically buried w, c, f, i, y, v and l and enrichment of the typically exposed k, e, p, s, q and r. however, there were also some significant differences. short disordered regions are more depleted in c, i, v and l, while long disordered regions are more enriched in k, e and p but are less enriched in q and s. in addition, long disordered regions are depleted in g and n, while short disordered regions are enriched in g and d.

specialized predictors – window lengths
the optimal win/wout combination was selected from all  <dig> possible pairs of win ∈ { <dig>   <dig>   <dig>   <dig>  ..., 71} and wout ∈ { <dig>   <dig>   <dig>   <dig>  ...,61}, to maximize the overall accuracy, i.e. the average of sensitivity and specificity. using all  <dig> features, the two predictors were built as linear svms with parameter c, which represents the trade-off between training error and margin  <cit> , set to  <dig>  and  <dig>  respectively. in this way, the optimal win/wout combination for the short disorder predictor vsl2-s was selected as 15/ <dig>  considerably smaller than 41/ <dig> for the long disorder predictor vsl2-l. as shown in table  <dig>  with the selected win/wout values, vsl2-s achieved much higher accuracy on short disordered regions than on long ones , while vsl2-l was significantly more accurate on long disordered regions but with a smaller difference . on ordered regions, vsl2-l was more accurate than vsl2-s .

also shown in table  <dig> are prediction accuracies for several non-optimal win/wout values. a general conclusion from these results is that smaller windows are necessary for predicting short disorder. using a large input window , it might be more difficult to distinguish short disorder residues from order residues in the feature space, since most features were based on the local amino acid composition within the window. in such a case, too many neighbouring order residues may be included in the window and the compositional bias information necessary for predicting short disorder would be weakened. similarly, a large output window  would inevitably filter out many predicted short regions while improving prediction on long disordered and ordered regions.

specialized predictors – feature selection
once the optimal window lengths were selected, we performed feature selection for both specialized predictors using a permutation-test-based feature filter  <cit>  and several other algorithms implemented in the weka data mining package  <cit> . however, no improvements in prediction accuracy were observed for either of the predictors. if removing about half  of the features, the prediction accuracies of both predictors would decrease by 1–2%. such phenomenon might be explained by the relatively high correlations among features. since the principal component analysis  was always performed  before predictor training, such correlations would be removed and are unlikely to cause problems. furthermore, the number of available training examples  is sufficiently large compared to the number of features  and the overfitting problem might be less likely to occur. therefore, we did not exclude any features but used pca only to reduce the dimensionality.

in table  <dig> we list the  <dig> features ranked on top according to their permutation test z-scores  <cit> . the absolute value of such a z-score reflects the relevance of a given feature, while the sign indicates if the feature is positively/negatively correlated with the target variable . the top feature for vsl2-s is the spacer frequency , which indicates if a residue is close to a terminus . its high positive z-score is consistent with the fact that many short disordered regions in our dataset were at termini. another observation from table  <dig> is that many of the features were psi-blast profile based  but only few were amino acid frequencies . this suggests that the profile based features with evolutionary information indeed have higher discriminative power in prediction of both short and long disorder. note that hydrophilic residues were more conserved in both short and long disordered regions as compared to ordered, while hydrophobic residues were more conserved in ordered regions.

in total there are  <dig> features in common between the two subsets selected for vsl2-s and vsl2-l, but they typically had different ranks. among these features, k2-entropy   <cit> , flexibility  <cit>  and hydrophobicity  <cit>  are known indicators of protein disorder, pssm_d, pssm_e, pssm_k, pssm_p, pssm_q and pssm_s correspond to disorder-promoting residues  <cit> , and pssm_i corresponds to an order-promoting residue  <cit> . another two shared features are psi_c and phd_l derived from the secondary structure predictions for coils  by the phdsec and psipred predictors, respectively. the different ranks for vsl2-s and vsl2-l of certain features might be directly connected with the compositional difference between short and long disorder , e.g. pssm_p and pssm_k.

specialized predictors – choice of learning algorithm
we also examined other learning algorithms for component predictors, including a logistic regression model  <cit> , a feed-forward neural network of single hidden layer   <cit> , a bagging ensemble of  <dig> neural networks  <cit> , and a non-linear svm with radius-based-function  kernel  <cit> . the accuracies reported in table  <dig> were estimated using the 10-fold cross-validation procedure . the optimal model parameters, e.g. c for linear svm and c and gamma for rbf svm, were selected using embedded 5-fold cross-validation  independently for each fold of the 10-fold cross-validation procedure. we examined c from {2- <dig>  2- <dig>   <dig>   <dig>   <dig>  8} for linear svms, and c and gamma from {2- <dig>  2- <dig>   <dig>   <dig>   <dig>  8} × {2- <dig>  2- <dig>  2- <dig>  2- <dig>  2- <dig>  2- <dig>  1} for rbf svms. it turned out that identical parameters were selected in most of the  <dig> folds for accuracy estimation . these parameters were reported in table  <dig> and used for building the final vsl <dig> predictors for blind-test comparison with other predictors.

as shown in table  <dig>  the algorithms examined had similar prediction accuracies as linear svm but none of them outperformed it significantly. the small differences between linear and nonlinear models are consistent with the observations in our previous studies  <cit> , which reflected the linear nature of the disorder prediction problem. since it has been shown that svm often have better generalization performance than other learning algorithms, in the subsequent analyses we report results for linear svm only.

combining specialized predictors
the vsl2-s and vsl2-l predictors were then integrated into the composite vsl2-m <dig> and vsl2-m <dig> predictors using two different meta predictors, m <dig> and m <dig>  respectively. meta predictor m <dig> was trained independently of vsl2-s and vsl2-l using the same set of  <dig> features. inputs of meta predictor m <dig> were win neighbouring predictions from both vsl2-s and vsl2-l, and its output was the final prediction of vsl2-m <dig>  both m <dig> and m <dig> were built as linear svm . using the 10-fold cross-validation procedure , the optimal win/wout values were selected as 61/ <dig> and 31/ <dig> for m <dig> and m <dig>  respectively.

in table  <dig> we show prediction accuracies of the two composite vsl <dig> predictors, as well as the two specialized predictors. among the four predictors, vsl2-m <dig> achieved the highest sensitivity  of  <dig>  ±  <dig> % and overall accuracy  of  <dig>  ±  <dig> %, and vsl-m <dig> had very similar performance. although the short disorder predictor vsl2-s also had relatively high sn of  <dig>  ±  <dig> % and acc of  <dig>  ±  <dig> %, it was significantly less accurate  on long disordered regions. on the other hand, both vsl2-m <dig> and vsl2-m <dig> had well-balanced per-chain accuracies  of >81% on short and long disordered regions, which are comparable to the accuracies by the corresponding specialized predictors. on ordered regions, both vsl2-m <dig> and vsl2-m <dig> were significantly less accurate than vsl2-l but still comparable to vsl2-s.

length-dependent prediction accuracy
to better characterize the predictor performance, we further divided the disordered regions into five length groups of 1– <dig>  4– <dig>  16– <dig>  30– <dig>  and > <dig> residues and examined the per-residue accuracy  on each group separately. note that short disordered regions of 1– <dig> residues were not used in predictor training or accuracy estimation. as shown in figure  <dig>  vsl2-l performed poorly on very short disordered regions, and exhibited a monotonic increase in accuracy as the disordered region length increases. vsl2-s had the highest accuracies on short disordered regions of 1– <dig> and 4-  <dig> residues, but was significantly less accurate on long disordered regions than vsl2-l. on the other hand, both vsl2-m <dig> and vsl2-m <dig> achieved almost uniform prediction accuracies over different length groups. in every length group the two composite predictors achieved similar or even higher accuracies than the corresponding specialized predictor.

another observation from figure  <dig> is that vsl2-m <dig> and vsl2-m <dig> were less successful on disordered regions of 16– <dig> residues than on those from the other length groups. one possible explanation is that the threshold of  <dig> for partitioning disordered regions into short and long is artificial  <cit> , and therefore is not necessarily optimal. it is also likely that the amino acid compositions of disordered regions of different lengths form a continuum. therefore, partitioning disordered regions into short and long by a single length threshold might not be the most appropriate approach. however, it could be helpful to introduce a third length group of medium disordered regions, but a larger dataset would be necessary. a better approach might be applying a competition procedure developed previously  <cit>  to further improve the initial partitioning obtained by the length threshold.

since vsl2-m <dig> was slightly more accurate than vsl2-m <dig>  it was used exclusively in the following analyses. for brevity, we will refer to it as "vsl2".

importance of computationally expensive features
as shown in table  <dig>  most of the top-ranked features for the specialized predictors were based on psi-blast profiles  or secondary structure predictions . however, obtaining the psi-blast profile and/or psipred prediction is time-consuming due to the need for searching against large sequence databases. on a workstation with a 3ghz pentium®  <dig> processor and 2gb memory, it took  <dig>  minutes on average for a single psi-blast search consisting of  <dig> iterations against the uniref <dig> database  <cit>  . clearly, this may result in a computational bottleneck if vsl <dig> is used in genomic-scale studies. therefore, it is important to examine the accuracy tradeoffs if these computational expensive features are not included.

although the baseline predictor vsl2b was 3% and  <dig> % inferior to vsl <dig> and vsl2p, respectively, in the overall accuracy , it also achieved relatively balanced accuracies on short and long disordered regions, and was more accurate than several previous disorder predictors . therefore it may still be useful in some genome-scale studies. for example, vsl2b can be applied first to a whole proteome to identify a smaller sequence subset of interest, and then the more accurate but time-consuming vsl <dig>  can be used to further improve the results.

prediction on high-b-factor ordered regions
as shown by radivojac et al.  <cit> , high-b-factor ordered regions were similar to, but also had some significant differences from, short disordered regions in terms of amino acid compositions and sequence properties. in addition, they could be predicted fairly accurately from amino acid sequence using features similar to those for disorder prediction. we therefore excluded high-b-factor ordered regions from vsl <dig> predictor training and examined the prediction accuracy on these regions. indeed, vsl <dig> had a much higher false positive error rate on the high-b-factor residues than on the low-b-factor residues . on the outliers  the false positive rate was even higher . however, due to the small proportion  of high-b-factor residues, the overall false positive rate was only slightly higher  than on low-b-factor residues. note that the predictions used were obtained using the 10-fold cross-validation procedure ; the prediction for any sequence was made using a predictor trained without this sequence.

representative predictions
in figure  <dig> we show representative predictions on two pdb chains:  1rep:c with four short disordered regions at residues 1– <dig>  50– <dig>  98– <dig>  and 247–251;  1b70:a with a long disordered region at residues 1– <dig>  the short disorder predictor vsl2-s successfully detected all four short disordered regions in  <dig> rep:c, while the long disorder predictor vsl2-l predicted only part of the two terminal regions and completely missed the two internal regions . on the other hand, vsl2-l correctly identified the whole long disordered region from 1b70:a, while vsl2-s predicted only  <dig> of the  <dig> residues as disordered .

it can be observed from figure  <dig> that the final vsl <dig> prediction is more similar to vsl2-s over short disordered and ordered regions, while it is more similar to vsl2-l over long disordered regions. in figure 4a, vsl <dig> prediction was almost indiscernible from vsl2-s prediction along the whole sequence. in figure 4b, vsl <dig> prediction was similar to vsl2-l prediction over the first  <dig> long disordered residues, and then started resembling vsl2-s prediction over the remaining region. this illustrates the effectiveness of the meta predictor. it also partly explains the relatively low specificity  of vsl <dig> , since vsl2-s tends to predict many false short disordered regions over ordered regions .

comparison to a global predictor
for comparison, we also built a global disorder predictor as a single binary classifier. it was trained in the same way as the two specialized predictors, but with disorder residues equally sampled from all disordered regions. the optimal win/wout values were determined as win/wout= 21/ <dig>  right between the optimal values for vsl2-s and vsl2-l . its accuracies were estimated as sns=  <dig>  ±  <dig> %, snl=  <dig>  ±  <dig> % and sp =  <dig>  ±  <dig> % on short disorder, long disorder and order, respectively. although having well-balanced performance on the two types of disorder, the global predictor was significantly less accurate than vsl <dig> .

comparison to previous disorder predictors
in this section we compare three vsl <dig> predictors  to six previously developed protein disorder predictors over both vsl <dig> training dataset via 10-fold cross-validation and a blind-test set of  <dig>  unrelated recent pdb chains. these predictors included three of our previous long disorder predictors, vl-xt  <cit> , vl3-e  <cit>  and vsl <dig>  <cit> , as well as three predictors developed by other groups, i.e. disembl   <cit> , ronn  <cit>  and disopred <dig>  <cit> . there are several other disorder predictors were not included for different reasons. for example, prelink  <cit>  does not provide numeric predictions, foldlndex©  <cit>  and globplot  <cit>  do not provide predictions for all residues, while iupred predictor  <cit>  provides separate predictions for short disordered, long disordered, and structured  regions, thus makes it difficult to compare.

comparison over vsl <dig> training dataset via 10-fold cross-validation
predictions by the three vsl <dig> predictors were made via the 10-fold cross-validation procedure, i.e. the prediction for any sequence was made with a predictor trained without that sequence, while all other predictors were applied to the  <dig>  sequences directly. ronn predictions were obtained from its website, while disembl and disopred <dig> were downloaded and run locally. figure  <dig> compares both per-chain and per-residue roc curves plotted by varying the decision threshold in increments of  <dig> . the corresponding auc values were approximated using the trapezoid rule and reported in table  <dig>  also shown in table  <dig> are prediction accuracies calculated with default thresholds. a threshold of  <dig>  was used for all six predictors from our group.

as in figure 5a and table 7a, vsl2p, vsl <dig> and vsl <dig> had very close per-chain roc curves with similar auc values of  <dig>  ±  <dig> ,  <dig>  ±  <dig>  and  <dig>  ±  <dig> , which were significantly higher than those of other predictors. overall vsl <dig> was slightly less accurate than vsl <dig>  with acc of  <dig>  ±  <dig> % versus  <dig>  ±  <dig> %. however, vsl <dig> had significantly higher sensitivities on disordered regions with differences >3%, while its specificity was  <dig> % lower . disembl and disopred <dig> exhibited very high specificity coupled with low sensitivity, which is not surprising since they were tuned to generate very few false positives. as the roc curves  suggested, vsl <dig> could also achieve similar trade-off between specificity and sensitivity by adjusting its decision threshold.

vl3-e was the most accurate on long disordered regions with a per-chain sensitivity  of  <dig>  ±  <dig> %  and a per-residue sensitivity of  <dig>  ±  <dig> % . although vsl <dig> also achieved similar accuracy on long disordered regions, its specificities sp were more than 10% lower than vl3-e. on the other hand, vl3-e was the least accurate on short disordered regions. since about 72% of the disordered residues in our dataset came from long disordered regions, it is not surprising that per-residue sn of vl3-e was much higher than its per-chain sn . furthermore, vl3-e had the highest auc value of  <dig>  ±  <dig>  among the per-residue roc curves, but it was just slightly higher than those of vsl <dig> and vsl <dig> . ronn also exhibited much higher accuracy on long disordered regions, possibly due to the exclusive use of disordered regions longer than  <dig> residues in training  <cit> .

comparison over a blind-test set
the non-redundant blind-test set  consisted of  <dig>  recent pdb chains that were unrelated to any sequence for vsl <dig> training. in table  <dig> we show both prediction accuracies and areas under roc curves  for the nine predictors. note that the three vsl <dig> predictors were re-trained using all  <dig>  training sequences for this comparison. we did not use the  <dig> very short disordered regions of 1– <dig> residues in estimating accuracies  since such short regions of disorder could result from many causes other than intrinsic sequence features. however, vsl <dig> predicted a higher proportion of residues as disordered in these regions than in those longer than  <dig> residues .

comparing table  <dig> and table  <dig>  the predictor rankings by per-chain acc/auc were very similar, with vsl <dig>  vsl <dig> and vsl2p constantly ranked on top. the main difference is that based on per-residue acc/auc vl3-e moved from the top in table 7b to the  <dig> th/7th place in table 8b. it is evident from table  <dig> and table  <dig> that snl, accuracy of all predictors dropped significantly with differences ranging from  <dig> %  to  <dig> % , while sns accuracy on short disordered regions and sp accuracy on ordered regions were less affected for most predictors. overall, vl3-e and ronn were the two most affected predictors, with performance drops of  <dig> % and  <dig> % in per-residue acc, and  <dig>  and  <dig>  in per-residue auc, respectively.

by examining vsl <dig> prediction on the  <dig> long disordered regions, we observed that the prediction accuracy was >80% for  <dig> regions, 60–80% for  <dig> regions, and <45% for the remaining  <dig> regions. we attempted to obtain further information regarding these  <dig> regions with low prediction accuracies. however, at the time of this writing only five of them had been published as indicated by their pdb records and literature search. based on the available publications, we examined three regions in more detail, namely 2a6t:b   <cit> , 1y44:a   <cit> , and 1yyh:b   <cit> . the results demonstrate the uncertainties in labelling of long regions of missing electron density and may help explain the low prediction accuracies on some of these regions.

pdb entry 2a6t contains crystal structure of the 266-residue n-terminal of dcp <dig> protein from s. pombe  <cit> . it forms a dimer of two identical chains in the asymmetric unit. however, the regions of missing electron density are not exactly the same for the two chains. residues 1– <dig> are missing in chain b but are visible with ordered structure in chain a. as she et al.  <cit>  suggested, this missing region might be caused by crystal packing. in addition, visible parts of the n-terminal domain of chain b seem to be superimposed well with the equivalent parts of chain a. similarly, pdb entry 1y <dig> also contains a dimer of two identical chains but with different missing regions  <cit> . residues 159– <dig> missing in chain a correspond to the long "flexible arm" which is clearly folded in chain b. thus, these two regions might be intrinsically ordered but missing in the electron density maps due to other reasons, which explains the low prediction accuracies on them. on the other hand, it is also possible that a sequence region that is intrinsically disordered as a monomer might undergo disorder-to-order transition upon multimer formation  <cit> . clearly, both scenarios raise a unique question in data labelling.

we also examined pdb entry 1yyh  which contains crystal structure of the human notch  <dig> ankyrin domain  <cit> . this domain consists of seven ank  repeats and also forms a dimer of two identical chains, with almost identical missing density region . this region is considered to be a putative ank repeat, i.e. the 1st repeat in the domain, which is comprised of two predicted a-helices connected by an unusually long loop of  <dig> residues  <cit>  . it was further suggested that the whole repeat is only partially folded due to the large number of charged or polar residues in the long loop  <cit> .

in figure  <dig>  we plot vsl <dig> prediction score  on 1yyh:b. in the missing density region , vsl <dig> predicted two ordered regions  that roughly correspond to the two predicted α-helices. it also predicted one short disordered region  that covers most of the loop region between the two predicted α-helices. in total,  <dig>  of the  <dig> residues of this missing density region were predicted to be disordered. in the same figure we also marked the  <dig> pairs of α-helices of the other  <dig> ank repeats in the human notch  <dig> ankyrin domain  <cit> . interestingly, there are  <dig> peaks  corresponding to the  <dig> beta turn regions between each pair of neighbouring ank repeats.

in summary, just as in the two recent casp experiments  <cit> , disordered regions in our blind-test dataset were identified from missing electron densities in x-ray structures using an automatic procedure. as we discuss above, some of these regions are likely to be incorrectly labelled since missing density regions can be caused by reasons other than intrinsic disorder. for example, crystal packing irregularities can lead to missing electron density. also, long regions of missing density can be structured, "wobbly domains"  <cit>  that move as rigid bodies and thus fail to scatter x-rays coherently. further experiments  as well as computational analysis can be used to identify such cases. another situation is that a long missing density region is partially folded ; as in the case of pdb:1yyh <cit> , labelling the whole region as disordered resulted in poor accuracy even though the predictor actually predicts the real situation. finally, as in the case of pdb:2a6t <cit>  and pdb:1y <dig> <cit> , protein complexation can result in ambiguity in labelling, i.e. identical chains may have different missing density regions. from the beginning we have been aware of the possibility of mislabelling when disorder is identified only from missing coordinates in x-ray structures  <cit> , and for this reason we have tried to corroborate our main findings with disorder identified by other methods such as cd and nmr  <cit> .

CONCLUSIONS
in this study we addressed the length-dependency problem in prediction of intrinsic protein disorder, i.e. that the amino acid compositions and sequence properties may vary among disordered regions of different lengths. as already observed in several previous studies, such length-dependency could result in inferior predictions if it is not taken into account explicitly. therefore, we proposed two new predictor models, vsl2-m <dig> and vsl2-m <dig>  in which specialized predictors were built for short disordered regions  and long disordered regions  and then integrated via the meta predictor. the results suggested that the proposed vsl <dig> predictors achieved well-balanced accuracies on both short and long disordered regions and were significantly more accurate than several previous intrinsic protein disorder predictors.

the success of vsl <dig> predictors can be attributed to  the enlarged training data containing both long disordered regions  and short disordered regions , and  the architecture for explicitly exploiting the data heterogeneity, or length dependency in the amino acid compositions and sequence properties of disordered regions. under the two-level architecture, the specialized predictors, vsl2-s and vsl2-l, could be optimized separately on more homogeneous data. both meta predictors proved effective in combining the two specialized predictors with comparable or even improved performance on both short and long disordered regions. these results further confirmed the previously observed differences between short and long disordered regions and justified our approach to model them separately.

there are several directions for further improving the vsl <dig> predictors. while the prediction performance of the long disorder predictor vsl2-l seems to be approaching its limit, there might be room for improving the short disorder predictor vsl2-s, e.g., by reducing its false positive rate. to achieve this, we will examine the relationships between short disordered regions and high b-factor ordered regions, oligomer interfaces and crystal contacts in more detail. special treatment of terminal disordered regions needs to be developed, while techniques for denoising the training data and improving data representation should also be employed. finally, new approaches that incorporate long-range interactions and other information should also be investigated.

availability and requirements
the vsl <dig>  predictors are freely accessible for non-commercial use via the web site at . this site provides web interface to two vsl <dig> variants, vsl2b and vsl2p . due to available computational resources, the number of predictions that can be provided per ip address per day is limited.

one can also download the vsl <dig> predictor package  from the same website at . note that the secondary structure predictors , psi-blast and sequence database are not included in this package, but should be downloaded separately from related websites. for detailed installation instructions, please refer to the readme file in the package or a web page at .

authors' contributions
kp carried out the predictor and website development and drafted the manuscript. pr prepared the dataset for predictor training. pr and sv participated in predictor development and evaluation. zo and akd conceived and supervised the project. all authors have read and approved the final manuscript.

supplementary material
additional file 1
disordered regions are marked as "#<starting position>-<ending position>" in fasta headers. if a chain has no disordered region, its fasta header will contain the pdb entry and chain id only.

click here for file

 acknowledgements
this work was supported by nih grant r <dig> lm007688- <dig> al to a.k. dunker and z. obradovic. we are grateful to dr. vladimir uversky for very helpful discussion regarding the distinction between pre-molten globule and random-coil like disorder. we thank the anonymous reviewers for their helpful comments and suggestions. we also thank matthew badura for proofreading the manuscript.

figures and tables
                              w
                           
                              
                                 in
                              
                              w
                           
                              
                                 out
                              
                              sn
                           
                              
                                 s
                              
                              sn
                           
                              
                                 l
                              
                              sp
                              5
                              sn
                           
                              
                                 s
                              
                              sn
                           
                              
                                 l
                              
                              sp
                              sn
                              sp
                              acc
                              sn
                              
                                 s
                              
                              sn
                              
                                 l
                              
                              sn
                              sp
                              acc
                              sn
                           
                              
                                 s
                              
                              sn
                           
                              
                                 l
                              
                              sn
                              sp
                              acc
                              sn
                              
                                 s
                              
                              sn
                              
                                 l
                              
                                 sn
                                 sp
                                 acc
                                 sn
                              
                                 
                                    s
                                 
                                 sn
                              
                                 
                                    l
                                 
                                 auc
                                 sn
                                 sp
                                 acc
                                 sn
                              
                                 
                                    s
                                 
                                 sn
                              
                                 
                                    l
                                 
                                 auc
                                 
                                    sn
                                 
                                 sp
                                 acc
                                 sn
                              
                                 s
                                 sn
                              
                                 l
                                 auc
                                 sn
                                 sp
                                 acc
                                 sn
                              
                                 
                                    s
                                 
                                 sn
                              
                                 l
                                 auc
 per-residue
