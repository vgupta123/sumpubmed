BACKGROUND
recent studies show that the abundance of single nucleotide polymorphisms  and haplotypes can provide the most complete information for genome-wide association studies. through the analysis of snps and haplotypes, most of the genetic variations among different people can be discovered. however, due to the excessive snps, which are about  <dig> million in the human genome  <cit> , it is costly to genotyping and studying all snps in a candidate region for a large number of individuals. thus the snp selecting strategy is proposed to find only a subset of snps, which are called tagsnps or tagging snps, to represent the whole snp set. these tagsnps have high linkage disequilibrium  values with the rest snps  <cit> , and the genetic variation information they have are enough to support the further study, such like disease association gene identification and population variation finding  <cit> .

several computational methods have been proposed to solve the tagsnp selecting problem. one common approach is based on the haplotype blocks partitions. these methods delimit the human genome into a set of discrete blocks, where only a small set of common haplotypes exist. these methods search the minimum subsets of tagsnps from each block. the selected tagsnps can distinguish each pair of common haplotypes in the block  <cit> , or at least most of them  <cit> . however, there is no general solution on how the blocks are formed. and the lack of the inter-block association degrades the selection accuracy. the ld based methods use the pairwise associations of snps. tagsnps are selected from the site clusters which consist of snps with strong ld association  between each other  <cit> . these tagsnps can represent associated snps in long distance without the block restriction, but may lose some important information contained in the rest snps and fail to distinguish all haplotypes in a ld cluster. bafna. et al. <cit>  proposed a somewhat different approach, which assumes tagsnps can reconstruct the remaining snps of an unknown sample with high accuracy. tagsnps are selected by the measure called informativeness, which quantifies how well the unselected snps are predicted and the complete haplotypes are reconstructed through the selected snps  <cit> . these methods do not need prior block partitioning or limited haplotype diversity, but their performances are limited by the restrictions such as the fixed number of tagsnps and the definitions of the informativeness.

in this paper, we present a new method based on clustering and graph, which is called cgts, to select tagsnps. unlike the previous methods, our method integrates the information of the ld association and the genotype diversity using the site graphs without the information loss and the limit of block partition. graph based algorithm uses the genotype information to discard the redundant snps, and does not need to define block or fix on the tagsnp number. to avoid high computational complexity of graph algorithm for large data, the clustering algorithm is proposed to process the genotype data. compared to three existing popular methods, our method can give better performance in the experiments.

RESULTS
implementation and data
we implemented our clustering and graph based tagsnp selection algorithm  in c ++ and run the program on a pc with a  <dig>  ghz cpu and  <dig> mb memory. a genotype phasing algorithm: phase  <cit>  is used on the genotype data to obtain the haplotypes for other methods such as hapblock and stampa compared in experiments.

five public biological data were used for evaluation. these data include: the hapmap data set of human chromosome  <dig> which has  <dig> snps for  <dig> european persons  <cit> ; the ibd 5q <dig> data set which have genotypes for  <dig> snps  <cit>  from an inflammatory bowel disease study of father-mother-child trios, and we only used the children's data; three encode regions enm <dig>  enr <dig> and enr <dig> from hapmap  <cit> , the number of snps genotyped in each region is  <dig>   <dig> and  <dig>  all missing and ambiguous alleles are deleted from the test data.

evaluation method
the evaluation method is based on the accuracy of non-tagging snp prediction by the tagsnps. the prediction accuracy is determined by cross-validation  <cit> . the data set is divided into ten subsets. the algorithm is run on the nine subsets to select a minimum set of tagsnps. the nine subsets and the tagsnps in the remaining set are used to predict the non-tagging snps in the remaining set.

the prediction of non-tagging snps is based on the assumption that given the genotype values of two snps, the probabilities of the values at any intermediate snps do not change by knowing the values of additional distal ones  <cit> . it means that for each non-tagging snp p, the value of p in given genotype sequence can be identified by the value of two closest tagsnps in the same sequence. formally, this assumption can be stated as:

  ∀p:a<p<b,∀q:q<a or q>b,∀v∈{ <dig> ,2},∀i:     pr⁡≈pr⁡  

for an unidentified p:

  gi,p=arg⁡max⁡v∈{ <dig> ,2}pr⁡ 

where a, b are the two closest tagsnps of p. gi, x is the allele value of snp x in genotype i. q is the tagsnp which is different from a, b.

the prediction precision of one subset is calculated by following equation:

  pi = nc/na  

nc is the number of correctly predicted alleles and na is the number of all predicted alleles.

the accuracy of the algorithm can be computed as:

  p=∑i=1dpi/d 

experimental results for trade-off test
in this subsection, we discuss the trade-off between efficiency and solutions of cgts. cgts uses a k nearest neighbour  clustering algorithm to partition the large snp set and improve the efficiency of tagsnp selection. different values of clustering size k result in different accuracy of the tagsnp selection. by increasing k, the solutions of cgts can be improved but the efficiency may be sacrificed. the efficiency of cgts is measured by the running time of cgts with different k. the solution improved by different k is measured by the improved ratio of algorithm. the improved ratio is calculated by /n50*100%, where nk is the number of tagsnps found by cgts with clustering size k and  <dig> is the minimum value of k in cgts. when k <  <dig>  the information of snp cluster is insufficient to find real tagsnps.

the trade-off tests use the data of human chromosome  <dig>  the  <dig> snps are firstly divided into four subsets according to their physical distances. each subset contains  <dig> snps . cgts run on four subsets separately and the final tagsnps are the union of all results on these subsets.

it can be observed that the improved ratio grows rapidly following the increase of k until k =  <dig>  after that a more slow improvement is observed. it can be explained by the reduced ld association between snps and the stability of information contained by snp cluster. the elapsed time also increases as k becomes large. it is because the sites in the graph increase and more sites need to be investigated with the selecting algorithm to obtain the tagsnps. on the other hand, the accuracy of cgts decreases as k becomes large. one intuitive reason is that the cgts discards some real tagsnps in the selecting step. following the increase of k, the graphs in selecting step become larger and noisy sites also become more in the graph. these noisy sites decrease the ld associations in the graphs and the genotype diversity information they have may interfere with the tagsnp selection. some real tagsnps are discarded due to this interference and pseudo-tagsnps may be put into the result.

as a result, the parameter k of cgts is best set to around  <dig> to obtain the best improvement in solutions, which still keeps the running time and accuracy within a reasonable period.

experimental results on biological data
we compare our algorithm with three recent algorithms for tagsnp selection that are widely used: hapblock  <cit> , mlr-tagging  <cit> , stampa  <cit>  these three softwares represent three common methods for tagsnp selection. hapblock bases on the block-partition, uses dynamic programming and em subroutine to get the tagsnps for each blocks. mlr-tagging uses a multiple linear regression approach and selects tagsnps based on ld associations. stampa uses the snp prediction accuracy for other snps to select tagsnps. hapblock and the training step of stampa use the haplotype data as input. mlr-tagging and stampa need to fix on the tagsnp number. therefore, to compare the performance of our method to these methods, the tagsnp number of mlr and stampa are same as the tagsnp number obtained by our algorithm.

the comparison results of the three methods on the enm <dig>  enr <dig>  enr <dig> and 5q <dig> are shown in table  <dig> and figure  <dig>  hapblock gave no solution for enr <dig> due to the memory overload.

cgts can perform better than hapblock in prediction accuracy, get smaller tagsnp sets and use shorter times. it is because that there is no need to conduct block partition and the ld associations among snps are taken into consideration. cgts is more accurate than mlr-tagging and stampa with the same number of selected tagsnps. when the snp size of the input data is increasing, stampa is asymptotically faster but cgts is more accurate with an acceptable running time. it is due to the increasing iteration number of cgts. appropriate choosing of k can reduce the running time of cgts. and we chose the k =  <dig> because the cgts can obtain better improvement in solutions but still keep the running time and accuracy within a reasonable period on the given biological data.

CONCLUSIONS
we investigate a novel hybrid method for snp-tagging, which is called cgts. the efficiency and solutions of snp-tagging are improved by the combination of graph algorithm and site clustering in cgts. as shown in the experimental results, our algorithm is able to get higher prediction accuracy than other approaches with the same size of tagsnps, and outperforms these approaches in terms of the tagsnp size. computational time required by cgts is quite reasonable and can be tailored to available computing resources as needed. the key component of cgts is the snp graph model which integrates the information of the ld association and the genotype diversity. this model makes the snp-tagging problem transform to a graph pruning problem. using this model can avoid the information loss of snps. our method does no need to fix the tagsnp number. the tagsnps are not restricted to any bounded location, and can easily be applied to cover the whole chromosome. in the algorithm, multiple tagsnps are used to represent each untagged snps, which further reduce the number of selected tagsnps. another advantage of cgts is that it is amenable to further computational improvements. for example, parallel programming could be used to search tagsnps in separate precincts, and further speed up the computation. in addition, cgts can also be used on multi-allelic genotype data and haplotype data.

