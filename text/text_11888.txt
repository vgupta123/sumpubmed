BACKGROUND
microarrays are widely used to profile gene expression patterns in samples of biological material. affymetrix genechips are a popular oligonucleotide microarray platform, using probe sets formed by 11- <dig> pairs of  <dig> mer probes. the probe pairs include a perfect match probe  and a single base mismatch  probe targeting the gene transcripts. these probes were originally selected from the consensus sequence alignments of expressed sequence tag  sequences. over the past  <dig> years, the sequences and annotations of the main genomes have changed significantly. one consequence has been that some of the est sequences were re-annotated or even removed from the databases. thus, probes targeting these ests are no longer accurate  <cit> . this problem has created a need to remap the probes using information from the most up to date genome sequence databases. since the genechips were introduced, the importance of alternative splicing, especially in vertebrates, has become more and more apparent. the annotation of these transcripts has changed considerably over recent years and this has also increased the importance of using the latest and most comprehensive genome annotation databases to map probes to specific transcripts.

several probe-remapping protocols have been developed, generally by regrouping the probes to the target genes or transcripts according to the current version of genome annotation  <cit> . a crucial consideration in probe remapping is the annotation database usage. dai et al. provided several probe remappings, each using a different database, e.g. unigene, refseq and ensembl  <cit> . however, this may lead to difficulty and confusion when interpreting microarray results. the problems come from i) genes annotated in one database but not in the other databases; ii) genes having longer transcripts or more transcripts in one database, but shorter or smaller in another. this usually means that the expression level or alternative splicing events of the gene can only be detected using one database but not using the other. the remapping results from lu et al., lee et al., and moll et al. either used the refseq and aceview databases, or the ensembl database  <cit> . the results may be very different if the database is changed.

refseq and ensembl are two widely used genome annotation databases  <cit> . though the data are regularly transferred between these databases, incompatible transcripts or genes are discarded during the transfer thus leading to discrepancies. aceview provides comprehensive genome annotation by integrating data from refseq, dbest and genbank  <cit> . however, only five species were annotated in aceview, which means that aceview annotation cannot be easily used in other species. zfin is a highly accurate, manually corrected zebrafish genome annotation database, integrating refseq and genbank transcripts  <cit> . its strict criteria, however, may result in the loss of a certain amount of transcript data. furthermore, zfin does not provide cross-referenced transcript information to ensembl transcript data. these variations in the genome annotation may lead to difficulties in interpreting gene expression results. thus, there is a need for a comprehensive and unbiased genome annotation. the ucsc genome browser provides a comprehensive genome annotation for more than  <dig> species  <cit> . the data from the ucsc genome browser can be easily accessed and used to provide customized genome annotations.

a well established remapping method is used in affyprobeminer and several other protocols  <cit> , which regroup the probes into a probe set if they all match the same set of transcripts. this transcript level probe remapping provides the possibility to detect alternatively spliced transcripts. however, it does not provide an appropriate method to measure the levels of alternative splicing events. mainly due to the recent development of exon arrays, algorithms predicting alternative splicing have been developed . the exon array algorithms should be carefully used for 3' gene expression microarray data, however. the oligo-dt based amplification method used in 3' gene expression microarray has a strong position effect rendering a signal bias towards the probes targeting the 3' ends of genes. a normalized intensity based method, such as splicing index  <cit> , is more appropriate to avoid this signal bias.

here we report a new probe remapping protocol and demonstrate its use with the zebrafish genome. it is based on a combined zebrafish genome annotation by integrating transcripts from the ensembl, refseq and genbank databases using information downloaded from the ucsc genome browser. a transcript level probe remapping is applied by aligning the probes to the genome, removing the nonspecific probes, and grouping the probes according to the set of transcripts they map to. we explore the impact of using different databases for gene and transcript annotations. we also used the splicing index  <cit>  as an indicator of alternative splicing events. the advantage of using a comprehensive database in the probe remapping was demonstrated as more genes and more alternative splicing events are detected. using two different zebrafish gene expression experiments, we show the benefits of using the more comprehensive remapping and confirm the improvement using real-time pcr validation.

RESULTS
probe remapping of the zebrafish genome array
the probe remapping procedure is outlined in figure  <dig>  firstly problematic probes were removed. this included probes with genome location issues where probes have no match to the current genome or have multiple matches. it also included probes with unique matches to the genome but which match multiple genes. then the probes were regrouped into new probe sets according to the set of transcripts which they match. this step is clearly, highly dependent on the annotation database that is used and this is the major focus of this paper. we illustrate this process in detail with the zebrafish genome and a commonly used gene expression platform from affymetrix.

mapping probes to the genome
to identify probes that have genome location issues, we aligned all  <dig>  probes from the affymetrix zebrafish genome array to the genome of the zebrafish ) using exonerate  <cit> .  <dig>  of the probes were identified with multiple matches and about  <dig>  probes were identified with no match to the current genome. further details and analysis of probes matching multiple genome locations is provided in additional file  <dig>  thus, about 24% of probes were nonspecific for the genome. by removing these problematic probes, we are left with about  <dig>  genome specific probes. the number of probes having genome location issues is strikingly high. the reason is mainly because affymetrix originally designed the probes based on expressed sequence tags  from a number of databases e.g. unigene, genbank, dbest  <cit> . some of these est sequences were erroneous and their removal from updated databases results in the loss of the probes. we regard the removal of probes having genome location issues as an acceptable loss of signal in order to avoid erroneous mapping of the probes to unannotated exons or genes.

alignment of transcripts to the genome
in order to group the probes into transcript level probe sets, we identify those genome positions corresponding to coding regions. this is done by aligning transcripts from different databases onto the genome. we used six databases that define zebrafish genes based on collections of transcripts. these are are the single source databases: genbank, refseq, ensembl, and three multiple source databases: biomart, zfin and ucsc. the latter three integrate transcripts from the three single source databases. these databases differ in their collections of transcripts. transcripts which did not properly align to the genome are usually due to mistakes in earlier versions of the genome assembly and/or est collections. for example in genbank,  <dig>  transcripts are included in the database, while only  <dig>  can be aligned to the current genome. importantly, in our remapping, affymetrix probes originally designed from erroneous transcripts are removed. as demonstrated in table  <dig>  databases that use multiple sources encompass more transcripts. the ucsc genome browser has the largest collection of zebrafish transcripts with  <dig>  alignable transcripts, while refseq only has  <dig>  transcripts alignable to the current genome. we organized transcripts from the ucsc genome browser into  <dig>  genes by clustering transcripts overlapping in coding exons. genes defined in other databases were according to cross reference files as describe in the methods section.

1: these databases integrate transcripts from ensembl, refseq and genbank databases.

2: genes are defined by clustering transcripts overlapping in coding exons

assignment of probes to gene specific transcript level probe sets
about  <dig>  genome specific probes were mapped to gene transcripts annotated from the  <dig> different databases. we explored the impact of database usage on the number of probes retained during probe remapping . the number of probes with no gene annotations is strongly affected by the gene annotation database that is used. these contain probes which matched either intergenic regions or gene introns. the removal of these probes results in huge differences among databases, ranging from  <dig>  to  <dig>  in total. other problematic probes accounted for a minor percentage of all the probes . this includes probes matching multiple genes, and probes that fail to meet the minimum criterion of  <dig> probes to form a probe set. multiple source databases usually included more probes by providing a more comprehensive annotation of the genome. approximately  <dig> % of the probes were retained after probe remapping using the ucsc database, which was the largest percentage. only  <dig> % of probes were retained using ensembl.

probe remapping using the ucsc database allowed the highest number of probes to be retained, mainly because it integrates the genbank database. the affymetrix zebrafish genome array was originally designed from genbank  <cit> . this shows the necessity of integrating genbank in the probe remappings, which has been neglected by some probe remapping protocols  <cit> .

genes annotated by remapped probe sets using different databases
using multiple source databases results in retaining more probes and therefore, more transcripts and genes representative of the genome. using ucsc,  <dig> genes are detected. this is about 27% of the genes in the zebrafish genome .  <dig>  genes were represented by more than  <dig> probe sets. with these genes we also have the possibility to measure alternative splicing patterns. the average number of probe sets per gene indicates the ability to detect alternative splicing events using the remapped probe sets. the largest number was obtained using ucsc with  <dig>  probe sets per gene. in contrast, using ensembl, only  <dig>  genes are covered by the probes, with  <dig>  probe sets per gene.

pairwise comparison of probe remapping using different databases
differences in the probe remapping results will affect the interpretation of results from microarray data analysis. this can be seen in lists of differentially expressed genes. for genes to have the same probe annotation using different databases we require the probes targeting this gene to be the same and to be clustered into identical probe sets. genes have different probe annotations using different databases, either because genes in a subset of databases have more probes in the probe set, or the original probe set is split into separate probe sets to represent alternative splicing transcripts.

we compared the gene probe sets obtained using the three single source databases to the probe remapping using ucsc . only half of the genes were mapped by the same probe sets using different databases. the largest agreement was between genbank and ucsc with  <dig>  genes sharing the same probe set content. the number of genes having a probe set annotation in ucsc but not in the other databases is quite large, accounting for about  <dig>  genes. these genes can only be detected using ucsc gene annotation. large differences between databases may lead to the difficulties in interpreting microarray data.

same: number of genes having the same probe sets in a and b.

diff: number of genes having different probe sets in a and b.

uniquea: number of genes having probe sets in a but not in b.

uniqueb: number of genes having probe sets in b but not in a.

impact of gene definitions on probe remapping
the differences between the gene annotation databases are due to the different transcript collections and gene definition methods used. gene definition methods generally decide how different transcripts are clustered into genes. in order to investigate how gene definition alone affects microarray data analysis results, four different gene definition methods were applied to the transcript collection from ucsc and the probe remapping results were compared. gene transcript clustering is either performed by comparing transcript intron/exon boundary locations  or overlap region in the exon sequences . exlink is the default gene definition method used here, which clusters transcripts overlapping in coding exons. the other methods are compared with it . the largest difference was identified with exbd. exbd is the most stringent definition which requires both exon boundaries of at least one exon to match. it makes exbd an outlier in the number of genes defined and number of probes retained after remapping. although the number of probes retained using exbd can be up to 3% fewer than with exlink, the genes represented by the remapped probe sets were very similar. more than 91% of genes were represented by the same probe sets between exlink and exbd. thus gene definition methods contribute only a small amount to the differences in probe remapping results and microarray data interpretation.

same: number of genes having the same probe sets in a and b.

diff: number of genes having different probe sets in a and b.

uniquea: number of genes having probe sets in a but not in b.

uniqueb: number of genes having probe sets in b but not in a.

impact of probe remapping on two biological data sets
we examined how database usage influences the interpretation of gene expression data from real microarray experiment data. two biological data sets were used. first we analyzed a published gene expression dataset  <cit>  comparing whole zebrafish embryos at  <dig> and  <dig> hours post fertilisation . a second, in-house, data set analysed gene expression in zebrafish eyes at  <dig> and  <dig> days post fertilisation . probe remapping using the single source database, ensembl, and the multiple source database, ucsc, were applied. microarray data analysis was performed using these two customized probe definitions. the ebayes t-test and splicing index were used to select differentially expressed genes, and genes showing alternative splicing patterns, respectively, as describe in the methods section. probe remapping using these two databases generated significantly different gene lists .

the differentially expressed genes that were identified using ensembl were mostly included in the gene list generated using ucsc. this shows that probe remapping using ucsc gives more extensive gene lists when searching for differentially expressed genes. a further benefit of using the multiple source database, ucsc, is the ability to predict more alternative splicing events. exclusively more genes were identified showing alternative splicing patterns using ucsc than using ensembl.

a few genes which were interpreted differently using these two databases in the  <dig> versus  <dig> dpf eyes gene lists were selected for experimental validation using real-time pcr. four genes show significant differential expression in the  <dig> versus  <dig> dpf eyes, but are only detected using the multiple source database, ucsc . the real-time pcr results prove that all these transcripts are expressed and not an artefact of our analysis. three out of the four genes were validated as significantly differentially expressed by real-time pcr analyses.

the gene cry1b is illustrated as an example in figure  <dig>  cry1b encodes the cryptochrome 1b protein which is reported to regulate circadian rhythms  <cit> . five transcripts were annotated for cry1b gene in the ucsc genome browser, two from ensembl, one from refseq and two from genbank. affymetrix probes only targeted two cry1b transcripts, nm_ <dig> and bc <dig>  from refseq and genbank respectively. the cry1b gene was identified in the microarray as having - <dig>  log <dig> fold change  and verified using real-time pcr as - <dig>  log <dig> fold change .

we use tpm <dig> as an example for the verification of alternative splicing . tpm <dig> encodes a tropomyosin family actin-binding protein involved in muscle contraction  <cit> . one of the probe sets for tpm <dig>  dre03301_ <dig>  can only be mapped using the refseq and genbank databases. the log <dig> fold changes for the tpm <dig> probe sets in the microarray results were  <dig>  and  <dig>  , and verified as  <dig>  and  <dig>   in the real-time pcr results. the real-time pcr result confirmed that the tpm <dig> transcripts annotated in refseq and genbank are expressed, and are true splice variants of the transcript annotated in ensembl.

discussion
gene specific transcript level probe remapping protocol
several protocols have been published to improve probe remapping of affymetrix microarrays. the general protocol is to remove the problematic probes and group the remainder by the gene or transcript that they target. the protocol that we implement here has been optimised to use a combination of features from existing protocols  <cit> . casneuf et al. reported that expression of nonspecific probes was highly correlated with off-target genes  <cit> . thus, we removed the genome-nonspecific probes in order to minimize the off-target probe pairing. this is more stringent than previous published methods. affyprobeminer has provided transcript consistent and gene consistent probe sets by clustering probes matching the same set of transcripts and genes  <cit> . however, probes matching multiple genes should be avoided. moll et al. aligned the probes to the transcriptome  <cit> . yet this may include probes that match unannotated transcripts, or transcripts which are non-alignable to the current genome.

how to group the probes into probe sets is a further concern in probe remapping. the transcript level probe remapping should reveal differences in gene splice isoforms. dai et al. provided transcript targeted probe sets by grouping probes targeting individual transcripts  <cit>  but this generated redundant probes in the remapping. the transcript level probe remapping used in this study is more appropriate as it clusters probes when they match the same set of transcripts  <cit> . moll et al. applied a similar method and validated the splice variants by real time pcr  <cit> . lu et al. also reported that this transcript level remapping reduced the platform variance between microarrays  <cit> . none of them, however, provided any method to measure the expression variation of gene splice isoforms.

li et al. developed an anova model based method to calculate the variance of the sibling affymetrix probe sets  <cit> . this model is widely used with affymetrix exon microarrays to detect splice isoform variation  <cit> . however, 3' gene expression microarrays have a strong signal bias towards probes targeting the 3' ends of genes. the probe hybridization efficiency with targeting genes may also affect the signal strength. these signal biases may affect the anova model by giving false positive p-values. the splicing index calculates the tissue specific expression by pair-wise comparison of the normalized intensities  <cit>  and therefore, is more appropriate for 3' gene expression microarrays. thus, in this work, we used the splicing index to measure the alternative splicing patterns in 3' gene expression microarrays.

impact of database usage on microarray analysis
database usage is a major concern in microarray data analysis. as shown by dai et al., the difference in probe set content using different databases caused a 30-50% difference in differentially expressed gene lists  <cit> . moll et al. compared their remapping results for hg-u133a with the affyprobeminer mapping  <cit> . affyprobeminer defined  <dig>  probe sets using refseq, whereas moll et al. yielded  <dig>  probe sets using ensembl. only  <dig>  probe sets were identical between the two approaches. our study reported a similar result. the number of genes having the same probe sets across databases ranged from  <dig>  to  <dig>  when compared between single source databases and the multiple source database ucsc . however, none of the previous protocols provided any appropriate method to reconcile the large differences between the databases. dai et al. provided downloadable remapping results using each individual database  <cit> . affyprobeminer reported that using refseq and genbank together may improve the mapping of the probes  <cit> . unfortunately, the database integration method used by affyprobeminer was computationally intensive using blat alignments of genbank transcripts to the genome sequences. furthermore, they did not integrate transcript information from ensembl.

here, we provide a more practical genome annotation method by downloading transcript information from ucsc, and clustering the transcripts by overlapping coding exons . this protocol was implemented in a perl script and the genome reannotation can be finished within minutes. this protocol can be applied to any of the more than  <dig> species deposited in the ucsc genome browser to rebuild the genome annotation  <cit> . exlink provides a biologically meaningful annotation, and can easily be applied to all species with published genome sequences. it should be pointed out, however, that the gene definition methods compared in this manuscript, exbd, itbd and exlink, from refseq, aceview and ensembl respectively, all involve manual correction. thus it is impossible to fully repeat their work in our study.

the issues described here become even more serious during the analysis of data from next-generation rna sequencing  <cit> . in these analyses, 20-25% of the good quality reads with unique matches to the genome cannot be mapped to annotated genes in ensembl or eldorado. it suggests our knowledge of the genomes is still limited and much work still needs to be done to improve the genome annotation. the annotation provided in this study is a combination of the information from three databases. this is easily applied and is essential in fully interpreting such large-scale data sets.

CONCLUSIONS
we developed an improved probe remapping protocol based on mapping probes to the genome sequence, removing nonspecific probes and grouping the probes into transcript level probe sets. the protocol is based on a combined zebrafish genome annotation by integrating the ensembl, refseq and genbank databases together. this integrated genome annotation will reduce database variation bias in large scale gene expression studies. the data analysis protocol used in this study improves the interpretation of gene expression data. this approach could easily be applied to other species and gene expression measurement platforms such as exon microarrays or rna seq.

