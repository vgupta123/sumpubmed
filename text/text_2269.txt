BACKGROUND
measuring genetic variation is fundamental in population genetics. molecular genetic variation  could be measured as the product of mutation rate  and population size  and the theoretical relationship is θ = 4neμ . empirically θ could be estimated by the watterson’s estimator θw  <cit>  , which is based on the number of segregating sites  or by the tajima’s estimator θπ  <cit>  , which uses the mean pair-wise differences between sequences. the estimation of θ is based on population coalescent theory and its popularity is due to its simplicity. hence it is widely used in theoretical and empirical population genetic analyses. for instance θ or s is used to model the expected number of mutations, which is fundamental in molecular evolutionary biology  <cit> . θ is an unbiased estimator when the assumptions such as neutrality and constant population sizes are met  <cit> . however, θ is downwardly biased for an exponentially growing population. similarly, estimates of θ are biased for sequences under purifying selection, which results in an excess of low frequency variants. this is because the theoretical relationship  assumes that all mutations neutral , which is not true in reality. therefore this relationship can be written as θ = 4neμf, where f is the fraction of neutral mutations and f =  <dig> and f <  <dig> for neutral and for selectively constrained sites respectively  <cit> .

although the factors influencing θ are well known, the effects of sample size in modulating the bias in θ estimation is not clear. in the pre-genomic era the sample sizes used in population genetics and molecular evolutionary analyses were modest. therefore, the effects of sample size on fundamental parameters were not well appreciated as the magnitude of these effects were not obvious due to the small differences between the sample sizes used in various studies. however, in the post-genomic period the use of thousands of samples compared to the few dozens of the past will indeed make a huge impact on the estimates . recent studies based on several thousand human exomes identified a huge difference in the θ estimates. nelson et al.  <cit>  studied this issue and compared the θ estimated using different sample sizes. they reported that θ estimated using the protein-coding genes from  <dig>  humans was  <dig>  times higher than that estimated using  <dig> humans . in contrast π estimated for the two datasets were identical . similarly, another study using exomes from > <dig>  americans showed a negative correlation between sample size and tajima d estimates and up to fourfold difference between the estimates obtained using various sample sizes  <cit> . since tajima d is based on the difference between θ and π the fourfold difference observed in this study was due to the difference in the θ estimated for various sample sizes. similar discrepancies owing to sample size bias were also reported in other organisms such as plants  <cit> . these studies attributed this phenomenon to the exponential growth of the populations  <cit> . however, a proper simulation study is needed to confirm this.

another important factor that is known to bias θ estimation is purifying selection. however, whether sample size will modulate the magnitude of this bias is not known. this is an important issue because every gene  consists of regions under selection as well as under neutral evolution and most of the population genetic parameters are estimated for both regions. if sample size differentially influences the θ estimates of neutral regions and selected regions, then the estimates obtained for these regions are not comparable. this has serious implications for the tests of neutrality such as tajima d  <cit> , fu and li d  <cit>  and the statistics based on mcdonald and krietman test  <cit>  namely the neutrality index   <cit>  and the proportion of adaptive substitutions   <cit> .

to examine the differential effects of sample size bias in neutral and constrained sites we assembled a large dataset consisting over  <dig> exomes [obtained from the  <dig> genomes project  <cit>  and estimated various population genetic parameters. we also examined how and to what extent sample size effects influence the tests of neutrality. finally, we conducted robust simulations to further elucidate the magnitude of sample size effects on the estimation of θ and to determine the probable cause for this pattern.

RESULTS
differential effects of sample size on neutral and selected sites
to examine the effect of sample size on the estimation of θ we used  <dig> human exomes and grouped them into six categories, each containing non-overlapping  <dig>   <dig>   <dig>   <dig>   <dig> and  <dig> exomes respectively. we then estimated θ at synonymous  and nonsynonymous  sites of > <dig> protein-coding genes. figure 1a clearly shows that θ estimates significantly correlate  and systematically increase with the sample size for both neutral and constrained sites. however, the rate of increase is much higher for constrained than that of neutral sites. this is evident since the slope of the regression line of the former was 44 % higher than that of the latter . to further confirm this we estimated the ratio of θn/θs, which showed a highly significant positive correlation  with the sample size . the θn/θs estimated for the sample size of  <dig> was  <dig> , which was 32 % higher than that estimated for the size of  <dig> . the above results suggest that increase in the sample size lead to the identification of more nonsynonymous variants compared to synonymous snvs. to confirm this, we estimated the proportion of nonsynonymous snvs  in each dataset and found positive correlation with the sample size . we also repeated our analysis by creating the non-overlapping six-category dataset multiple times through randomly choosing the sequences and obtained consistent results. this was to avoid any bias due to a specific set of exomes in a sample size category.fig.  <dig> differential effects of sample size on the estimation of θ using the number of synonymous  and nonsynonymous  segregating sites. a relationship between the sample size and θ. the relationships were significant  based on the pearson correlation as well as the non-parametric kendal rank correlation using the log-transformed values of x and y data points. best fitting regression lines are shown. x and y axes are in log-log scales . b correlation between the number of exomes and the ratio of θ
s/θ
n. the relationship was statistically significant . c the fraction of nonsynonymous variants observed using various sample sizes of human exomes. the error bars denote the standard error estimated using the binomial variance



magnitude of purifying selection and the extent of sample size bias
the above results indicate that the purifying selection on constrained sites could inflate the sample size bias in estimating θ. to investigate this further, we grouped the genes based on the magnitude of selection pressure on them. for this purpose, we estimated the dn/ds ratio for each protein-coding gene and used this as a proxy for the magnitude of selective constraint on them. we then estimated θn for the sets of genes with different dn/ds ratios . fig. 2a shows that with the rate of increase in the estimation of θn  was much higher for the constrained genes compared to those under relaxed selective constraints. for example, the slope of the regression line for the genes with dn/ds <  <dig>  was  <dig> , which is 79 % higher than that observed for the genes with dn/ds >  <dig>  . note that the slope of the latter was close that observed for the neutral synonymous sites . to further support these results we computed the ratio between θn estimated using  <dig> exomes and that estimated using  <dig> exomes /θn) . we show that these ratios perfectly correspond with the magnitude of selective constraints  on the genes .fig.  <dig> the magnitude of selection pressure and the extent of bias in estimating θ. a relationship between sample size and θ estimates using the nonsynonymous sites  of genes under different magnitude of selection. the ratio of nonsynonymous to synonymous substitutions  was used as a proxy for selection intensity on genes. all relationships were significant . b correlation between the extent of purifying selection  and the ratio of θ
n estimated using small  and large  sample sizes. the relationship was statistically significant 



sample size effects on tajima d  and fu-li d 
apart from the number of segregating sites another popular measure for the extent of variation is nucleotide diversity . unlike θ this measure is not affected by population growth or purifying selection. hence we compared these two measures when they are estimated with various samples sizes. this reveals that π is not affected by sample sizes not only for neutral sites  but also for constrained sites  . the popular tajima d  statistic uses the properties of π and θ to test a genomic region for any deviation from neutral evolution. as we have shown that sample size influences only one of these two measures  we examined the extent of its effect on dt. as expected, we observed negative correlation  between dt and sample size for neutral and constrained sites . however, the extent of this overestimation was much higher for constrained than neutral sites. this is evident from the widening of the dt estimates of constrained  and neutral sites  with increasing sample size. for instance, the difference between dtn and dts was only  <dig>  for a sample size of  <dig>  but this value was  <dig>  for a sample size of  <dig>  which is more than two fold higher than the former. we also examined the relationship between the magnitude of selection and extent of bias in estimating dtn. for this purpose, we estimated dtn using the genes under varying levels of selection pressures. we computed dtn for the synonymous and nonsynonymous sites of these genes. we then measured the difference  between the dtn value obtained for the lowest  and highest  sample sizes. this measure δdtn was computed for  <dig> gene sets with dn/ds ranging between 0– <dig> with an interval of  <dig>  . we observed a significant positive correlation  between dn/ds and δdtn for the nonsynoymous sites of protein-coding gene sets. in contrast this relationship was not observed for the synonymous sites of the same gene sets . this suggests that the level of selective constraint significantly influences the estimation dtn of different genes. on the contrary the bias in the estimation of dts is similar across the genes under various levels of selection pressures.fig.  <dig> sample size effects on tajima d
t statistics. a
θ and π were estimated for synonymous  and nonsynonymous sites  using different sample sizes. while relationships between sample size and θ was significant  those between sample size and θ were not . b scatter plot shows the tajima d
t estimated for nonsynonymous  and synonymous sites  using different sample sizes of human exomes. the relationships were significant at the 1 % level. c relationship between the magnitude of selection pressure on protein-coding genes  and the difference  in tajima d
t estimated using large  and small  number of exomes. the plot shows the comparative patterns of the significant relationships observed for neutral  and constrained  sites. each data point indicates the δ
dts or δ
dtn estimated using the genes belong to a selection intensity category . the correlation involving constrained sites was significant  but that of neutral sites was not 



we then examined the effect of sample size on the other popular test of neutrality, the fu-li d test - without using an outgroup . this test uses the difference between the total number of mutations  and the singleton  mutations . we computed the difference  for synonymous and nonsynonymous sites of protein-coding genes using different sample sizes. while the difference for neutral sites  only slightly varied with sample sizes that  for constrained sites significantly increased with sample size . the slope of the regression line for the latter was  higher than that observed for the former . this result clearly predicts differential effects of sample size on dfl as well. to confirm this, we estimated dfl for synonymous  and nonsynonymous sites  using different sample sizes. we found a positive relationship between dfl and sample size  and the bias in the estimation of dfl was more pronounced for the constrained sites  than neutral sites. the dfln estimates obtained using a sample sizes of  <dig> was  <dig> times higher than that estimated using the sample size of  <dig>  in contrast this difference was only  <dig> times for dfls. we also observed a positive relationship between dn/ds and δdfln for constrained sites . however, there was no significant relationship between sample size and δdfls for the neutral sites  . hence the patterns observed for fu-li dfl were similar to those detected for tajima dt, which clearly emphasize the significance of sample size-mediated bias in estimating these parameters.fig.  <dig> influence of sample size on the estimation of fu-li d
fl. a the difference between the total number of mutations  and singleton mutations  estimated for neutral  and constrained  sites using various numbers of human exomes. b scatter plot shows fu and li d estimated for nonsynonymous  and synonymous sites  using different sample sizes. the relationships were significant at the 1 % level. c relationship between the magnitude of selection pressure on protein-coding genes  and the difference  in fu-li d
fl estimated using large  and small  number of exomes. the plot shows the comparative patterns of the relationships observed for neutral  and constrained  sites. each data point indicates the δ
dfls or δ
dfln estimated using the genes belong to a selection intensity category . the correlation involving constrained sites was significant  but that of neutral sites was not 



influence of sample size on mk-test based measures
two routinely used population genetic measures that are based on the principles of mcdonald and kreitman test are the neutrality index and the fraction of adaptive nonsynonymous substitutions . both these measures use polymorphisms and substitutions in synonymous and nonsynonymous positions. to examine the effect of sample size on these parameters we computed them using different numbers of human exomes. we observed a highly significant positive relationship  between sample size and neutrality index  . the values of ni for the sample sizes of  <dig> and  <dig> were  <dig>  and  <dig>  respectively showing a 36 % difference. since ni is the measure of purifying selection using a smaller sample size significantly underestimates the selection pressure on human exomes.fig.  <dig> effect of sample size on the mcdonlad and kreitman test based statistics. a correlation between neutrality index and the number of exomes used to estimate this measure. b the proportion of adaptive nonsynonymous substitution estimated using different sample sizes. both the relationships were statistically significant at the 1 % level



finally, we quantified the proportion of adaptive nonsynonymous substitutions  using different sample sizes. our result produced a strong negative correlation  between the sample size and α . interestingly using a small number of exomes suggested that 24 % of the nonsynonymous mutations were fixed by adaptive evolution. however, using a much larger sample size of  <dig> exomes this number reduced  <dig>  fold and only 10 % of the nonsynonymous substitutions were estimated to be under positive selection.

results from simulation analysis
to investigate whether θ estimated for exponentially growing populations and for selectively constrained genomic regions is seriously influenced by sample size we conducted a simulation study using the program sfs_code  <cit> . we modelled two populations that undergo a similar initial growth phases, but one was later allowed to grow exponentially and the other remained under constant population growth . we also repeated this model for neutrally evolving sequences as well as for those under different levels of selection pressures. both simulations were conducted for varying sample sizes of  <dig>   <dig>   <dig>   <dig>   <dig> and  <dig>  the results from the sequences simulated under neutrality clearly show that the θ estimated for the population under constant population growth did not vary with sample sizes  . on the contrary θ estimated for the sequences simulated under exponential growth significantly correlated with sample size  and these estimates varied up to 84 % between the samples sizes of  <dig> and  <dig>  however, the estimates of π were not affected by sample sizes and this is true for the populations under constant as well as exponential growth .fig.  <dig> results from the simulation study. a estimation of θ and π using different number of genome sequences simulated under neutral evolution and constant as well as exponential growth models. only the relationship between sample size and θ estimated for the exponential growth model was significant  and other three were not . b the estimates of θ obtained for the sequences simulated under neutral and under different levels of purifying selection using constant population growth model. the relationship between sample size and θ estimated for the sequences simulated under neutral evolution was not significant . all other relationships were significant . c
θ estimates for the sequences simulated under neutral and under different levels of purifying selection using exponential population growth model. the figure shows the correlation between θ estimates and the number of simulated sequences used for the estimation. all relationships were significant at the 1 % level



the results from the sequences simulated under varying levels of selective constraints are shown in figs. 6b and c for constant and exponential growth models respectively. figure 6b shows that even under constant population growth conditions the estimation of θ varied with sample sizes. the rate of variation was much higher for sequences under high selective constraints  than those under relaxed selective pressures . the slope of the regression line of the former was  <dig>  times higher than that of the latter . however, θ estimated for neutrally evolving sequences did not vary with the sample size as there was no significant correlation between the two variables . these results suggest that for populations under constant growth, purifying selection alone modulate the sample size bias in estimating θ.

our simulation results for exponentially growing population shows that the sample size bias in estimating θ is much higher compared to that under constant growth. for instance, the slopes of the regression lines shown in fig. 6c are much higher  than the corresponding lines shown in fig. 6b . furthermore, the difference in θ estimates obtained for large  and small  sample sizes are also much higher for exponentially growing populations than those under constant growth. for instance, this difference was  <dig>  times for the highly constrained  exponentially growing populations  and this was only  <dig>  times for those under constant growth . the overall results from our simulation study were qualitatively identical to those observed using the  <dig> genome human data.

discussion
in this study we showed that there is an effect of sample size in estimating the fundamental population genetic parameter, θ. previous studies based on human exome data reported the sample size effect on the estimation of θ and attributed this to the exponential mode of growth in human populations . in this study we showed that the sample size effect could also be significantly modulated by purifying selection. the results from the simulation study clearly highlighted the independent contributions of demography  and selection in influencing θ estimation for different sample sizes. the patterns of our observed and simulated results could be explained based on the fact that the resolution in identifying low frequency variants increases with the increase in the sample size. when a population undergoes constant growth phase, the distribution of snvs  follows standard coalescence model and watterson’s θ clearly captures this. however, when a population grows exponentially, a higher proportion of low frequency variants are created due to faster coalescence events near the tip of the genealogies. this is shown in fig.  <dig> and the hypothetical population tree based on large sample size has more branches in the tips suggesting more observable mutations when the sample size is large  <cit> . hence for an exponentially growing population a higher θ is expected. however, to observe or to identify the vast majority of low frequency variants a larger sample size is required. in the context of mutations, small sample size underestimates the overall mutations in a population as it misses rare mutations and a higher sample size is needed to observe all of them.fig.  <dig> hypothetical trees show the effects of sample size. large sample size increases the resolution that lead to the detection of rare and personal variants shown in the tips of the tree



the role of selection could be explained by comparing the regions under neutrality to those under selective constraints. since purifying selection prevents deleterious mutations reaching high frequencies, constrained genomic regions are typically abundant in low frequency snvs  <cit> . therefore, large sample sizes are required to properly identify these rare snvs. hence the estimation of θ for the constrained regions of exponentially growing populations is much more severely biased by sample sizes because they are modulated by both demographic and selective forces. since the human population is known to be under exponential growth, the sample size effects on the estimation of θ for neutral synonymous sites are influenced by the demographic factor alone but estimates for the nonsynonymous sites are modulated by both demographic and selective forces. this is clear in the simulation study, which showed that the sample size bias is influenced only by purifying selection in constant populations. therefore, the extent of sample size bias for the constrained regions of exponentially growing populations was much higher than that observed for the constrained regions of populations under constant growth. furthermore, humans have a unique demographic history and it is well known that human populations have undergone an explosive population growth, which resulted in much higher fraction of rare deleterious variants  <cit> . this is evident from the unusually high ratio of θn/θs  observed for large sample sizes .

apart from neutrality and constant growth, the estimation of θ is also based on the assumption that individual sites/mutations in a genome are inherited and evolve independently. however, this is not true in reality as the genomic regions along with the mutations are inherited as large blocks of ibd segments. therefore, the equation used for θ estimation does not account for this and therefore the results shown in this study might have the influence of this bias.

in this study we have used the data  <dig> genome project, which consists of genomes from a number of populations all over the world. hence this sample composition is from a continuous population, which is a unique and unusual characteristic of this dataset. therefore, to examine the generality of the patterns observed in this study for specific populations we examined the sample size issue using single populations. for this purpose, we used the subset of  <dig> exomes belonging to the ceu  population and divided the data into two groups, one with small  and another with large  sample sizes . for neutral genomic regions  the θ estimate obtained for the large sample size was 9 % higher than that observed for small sample sizes and the difference was highly significant . in contrast for constrained regions this difference was 26 % . as expected, π estimates were similar between large and small sample sizes and this was true for neutral  as well as constrained sites . similar results were observed for african  and asian  populations . although we could perform the population specific analyses using only a small number of available exomes the results were highly significant and qualitatively similar to the main results reported in this study.

CONCLUSIONS
the results of this study highlight the significance of sample size in estimating some of the fundamental parameters of population genetics. importantly we showed that for small sample sizes the underestimation of θ is higher for constrained regions than that for neutral regions of the same set of exomes. hence the different θ estimated for the two regions using same population genomic data are not comparable especially when the sample size is small. therefore, this bias affects all neutrality tests and the estimates based on them. for instance, fig.  <dig> shows that the difference in tajima’s d estimated for neutral and constrained sites widens with the increase in sample size. in fact, the  true values will only be obtained for very large sample sizes. when sample size is small tajima’s d of the two types of sites are apparently similar. hence use of small number of samples in this analysis will produce erroneous results due to severe underestimation of θ for constrained sites. this also is true for the results of fu-li d test .

in the case of mk test based statistics, the proportion of adaptive nonsynonymous substitutions , use of large number of samples results in identifying more deleterious  nonsynonymous snvs, which increases pn in eqn  <dig> and thus the value of α is reduced. in contrast, small sample sizes identify fewer nonsynonymous snvs, which leads to an overestimation of the proportion of adaptive substitutions. the other measure based on mk-test, the neutrality index, is underestimated using a small number of samples due to the failure to precisely identify some of the low frequency nonsynonymous snvs.

