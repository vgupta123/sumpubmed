BACKGROUND
although the genomes of several organisms have been sequenced, the functions of the genes' products are often unknown. the most important gene products are probably proteins. they are virtually involved in performing every kind of biological function – for instance, catalysis, cell motility and signal transduction. furthermore, proteins are the most abundant class of macromolecules in living cells. hence, the analysis of an organism's complete set of proteins, which is referred to as the proteome, is a crucial aim of biological sciences. one tool for achieving this goal is provided by location proteomics; i.e. the subcellular localisation of the complete set of proteins. depending on the cell compartments that a protein occurs in, conclusions about its function can be drawn. moreover, proteomic changes, for example those caused by the cell cycle or chemical agents, can be exploited for the diagnosis of diseases or the development of innovative therapies. since the amino acid sequences of numerous proteins are known or can be derived from sequenced genomes, these amino acid sequences have been exploited to predict the proteins' locations. in order to accomplish this task, features such as targeting signals, which control the transportation, specific structural elements as well as information on homologous proteins are analysed. a comprehensive summary of prediction methods has been published by chou and shen  <cit> .

unfortunately, dynamic changes and differences between cell types are very difficult to predict based on a protein's amino acid sequence  <cit> . therefore, it is beneficial to determine protein locations in intact, living cells. here, even proteins with unknown targeting signals can be observed and associated with visible cell organelles.

in order to visualise the proteins, they are fused with fluorescent proteins. afterwards they can be observed by means of a fluorescence microscope  <cit> . the proteins' spatial distribution leads to characteristic location patterns or rather protein distribution patterns, which correspond to the cell compartments that enclose the proteins. the tagging itself can be performed in a way which is amenable to high-throughput processing  <cit> . furthermore, it is not necessary to know the proteins' amino acid sequences in advance. as in complex organisms, for instance mammals, the number of expressed proteins surpasses the number of genes considerably, methods allowing for the fast analysis of a large number of proteins are required. nowadays, biologists frequently perform the subcellular localisation of proteins by hand  <cit> . in several experiments, the investigation is supported by auxiliary microscope images  <cit>  or image-editing software  <cit> . but such manual evaluations of protein distribution patterns can barely account for the large number of existing proteins. furthermore, they are subject to the experimenters' training and experience. therefore, automated techniques which are amenable to high-throughput processing are required. in the literature, several aspects of such techniques have been considered:

classification of protein locations
the classification of protein distribution patterns into a set of pre-defined locations is the most common approach to determine protein locations. here, the research has been dominated by murphy and his group. they have experimented with a multitude of different methods – in particular, microscopy techniques  <cit> , numerical features  <cit> , feature reduction methods  <cit>  and classifiers  <cit> . they usually consider ten different cell compartments  <cit>  if two-dimensional images are applied. using three-dimensional images, up to eleven different protein locations  <cit>  have been examined. an elaborate summary of their approaches and the current progress in the field of automated location determination is given in  <cit> .

in recent years, the interest in developing automated methods for the subcellular localisation of proteins has increased. conrad and his colleagues proposed a feature-based machine learning approach to the analysis of twelve protein locations in single-cell images of live human cells  <cit> . here, two locations  were recognised with an accuracy of less than 50%. as an alternative to using numerical features, danckaert and her colleagues suggested the usage of a neural network structure, which enables the recognition of six protein locations using down-scaled images of single cells  <cit> .

other researchers have employed techniques tailored to specific locations: kasson and his co-researchers proposed a technique for the classification of proteins localised at the plasma membrane  <cit> . schiffmann and his colleagues used counterstaining in order to measure the protein concentration in the kinetochores   <cit> . a similar method has recently been applied by raman and his co-researchers  <cit> . they have analysed abnormalities of nuclear compartments called centrosomes by means of counterstaining the nucleus and exploiting radial symmetries. liebel suggested a simple image-processing-based technique enabling large-scale screens of proteins localised in the golgi apparatus  <cit> . logg and her colleagues investigated proteins located in the nucleus  <cit> .

in contrast to subcellular location prediction based on amino acid sequences , the classification of observed protein distribution patterns does not require a differentiation between proteins simultaneously occurring in a single location or at multiple locations. rather, appropriate classes representing double locations have to be defined. furthermore, moving proteins can be captured by observing the protein distribution over time and repeating the classification.

identification and grouping of new locations
in addition to assigning protein distribution patterns to a fixed set of locations, the interest in automatically identifying and grouping distinct location patterns has risen. it has been particularly pushed forward by murphy's group  <cit> . here, the applied techniques differ considerably from the ones used for protein localisation so far: supervised learning mechanisms have been replaced by unsupervised ones, which do not incorporate prior knowledge about the data processed. these unsupervised learning methods summarise similar location patterns into so-called clusters. in comparison to classifiers, the number of clusters typically exceeds the number of classes or rather the number of actual protein locations. in principle, the whole process is controlled by a similarity criterion, which reflects the similarity of the regarded images in the feature space and determines the outcome.

in order to find relevant location patterns, murphy's group proposed a method, which distinguishes between all proteins under analysis, even if they share a common location  <cit> . they use the k-means algorithm to cluster the images independently of the proteins shown. then all images showing a specific protein are analysed. a protein is associated with the cluster containing the majority  of the corresponding images. all other images  are dropped. if no cluster comprises more than  <dig> % of a protein's images, the respective location patterns are discarded completely. so, stable connections between created clusters and proteins are established. in addition to the k-means algorithm, they apply hierarchical clustering to the location patterns that have not been dropped before. here, it is assumed that the clusters yielded by the systems with the highest agreement reflect the real structure of the data. information on known protein locations is not incorporated.

recognition of the surrounding cells
the analysis of tagged proteins in live cells is a difficult task. a fluorescence image typically contains multiple or even numerous cells. these cells may be in various states resulting in different locations of the proteins. furthermore, the cells themselves are not necessarily visible. thus, a corresponding fluorescence micrograph contains bright spots corresponding to accumulations of tagged proteins. these spots vary in size and shape. but they cannot be associated with specific cells and locations therein. a trained biologist might be able to estimate the position of the surrounding cells. however, in an automatic context, additional information is necessitated. this knowledge is usually acquired by considering additional images, e.g. fluorescence images of stained nuclei, cell membranes or cytoplasms  <cit> . unfortunately, if such dyes are utilised with living cells, they may interfere with examined proteins or even kill the cells. furthermore, additional fluorescence channels are occupied. in order to circumvent these drawbacks, we have developed a cell recognition approach based on bright-field images  <cit> . provided that a cell has been recognised in such a bright-field image, the corresponding image region of the fluorescence micrograph can be examined concerning protein distribution patterns. a similar approach has recently been proposed by logg and her colleagues and exemplified for two proteins located in the nucleus  <cit> .

our approach
a combination of exploiting available biological knowledge and enabling the incorporation of new information would be more suitable with respect to large-scale analyses than the approaches discussed above. in such large-scale experiments unknown locations are likely to show up and must be processed. otherwise, they result in errors. therefore, in this article, a technique is introduced, which does not distinguish between the classification of known protein locations and the identification and grouping of new ones; for example, if it is trained to recognise proteins situated in the lysosomes, it will reject images of proteins located in the mitochondria as unknown. these unknown distribution patterns can be grouped according to their similarities or labelled by an expert and incorporated into the running system. in order to ensure that the created classes have a biological meaning, we favour the approach based on manual labelling. therefore, we do not have to drop a large fraction of the available data as proposed by murphy's group  <cit> . in addition, such techniques which are solely based on the usage of a similarity criterion in the feature space cannot guarantee the biological significance.

besides fusing two different approaches to protein localisation, the proposed protein localisation technique has been adapted to the automated cell recognition method we have published in  <cit> . so, a completely automatic processing of microscope images becomes possible: the cells of interest are found, known protein locations are recognised and unknown locations are sorted out for a further analysis. however, the labelling of unknown protein distribution patterns has to be performed by experts. but this labelling does not need to take place during the application of our protein localisation method. rather, all unknown images, which have been sorted out, are collected and can be examined off-line after an experiment has finished.

methods
the applied cell line
the cells, the microscope images of which are analysed within the scope of this paper, stem from the fall army worm spodoptera frugiperda – a moth inhabiting the northern hemisphere. in  <dig> a cell line called iplb-sf- <dig> was extracted from immature ovaries of spodoptera frugiperda pupae  <cit> . it served as a basis for the derivation of the utilised cell line termed sf <dig>  <cit> .

insect cells have been proven to be beneficial for the high-level expression of foreign proteins  <cit> . here, the proteins are often correctly modified and localised. genetic engineering enables the proper processing of additional proteins  <cit> . besides their application to protein expression, insect cells have been studied with respect to insect pest management  <cit> . as a result, a large number of cell lines originating from several insect species are available  <cit> .

sf <dig> cells have several beneficial features, which make them amenable to high-throughput investigations. first of all, they are robust and not very demanding; for example, they grow at room temperature and in serum-free medium without any added growth factors  <cit> . in addition, sf <dig> cells exhibit a round shape with diameters between about  <dig> μm and  <dig> μm, which is relatively large. cells from the budding yeast saccharomyces cerevisiae, for example, reach only diameters of about  <dig> μm  <cit> . so the differentiation between protein localisation patterns is alleviated if sf <dig> cells are employed. in contrast to mammalian cells, the cell growth is independent from carbon dioxide. as a result, no special devices are required. finally, they are adherent, i.e. they form a single layer attached to a surface. through this, the application of automatic techniques such as auto-focus or image analysis procedures is facilitated.

as known protein localisation approaches have been applied to alternative cell types , the methods used for analysing the protein distribution patterns had to be modified. but the proposed usage of sf <dig> cells alleviates the automatic analysis considerably.

image acquisition
since fusion proteins obtained using fluorescent proteins such as green fluorescent proteins  and yellow fluorescent proteins  were only available for a subset of the considered locations, conventional organelle probes had to be applied so as to simulate further locations. otherwise, a reasonable variety of protein distribution patterns could not have been collected. but as the resulting fluorescence micrographs are assumed to be very similar to the corresponding protein distribution patterns, the negative influence of this procedure is limited. table  <dig> lists the protein locations and the respective dyes.

the images depicting several protein localisations were obtained by constructing fusion proteins, while others were acquired using conventional dyes.

all organelle stains were obtained from molecular probes. before staining or transfection, the cells were plated in 24-well glass-bottom plates. for all stains except for the plasma membrane stain the cells were incubated for  <dig> minutes with the appropriate dye concentration and washed three times with medium. for the fm dye the images were taken 5– <dig> minutes after the addition of the dye without washing steps. in order to visualise the cytoplasm including the nucleus, a gfp was used directly, without creating a fusion protein. the cytoplasm excluding the nucleus was depicted by means of expressing a gfp fused to cytoplasmic proteins. the peroxisomes were marked by a gfp with a peroxisomal targeting sequence consisting of the carboxy-terminal-fused amino acids serine, lysine and leucine  <cit> . the resulting gfp-skl as well as the gfps themselves were amplified from pegfp-tub  with the primers ggatccatggtgagcaagggcga, ctcgagttacttgtacagctcgtccatgc and ctcgagttaaagcttgctcttgtacagctcgtccatgc. after amplification the constructs were cloned into pgem-t easy. the genes were then cut by nco <dig> and xho <dig> and ligated into the insect expression vector piex <dig> . the nucleoli were visualised with a yfp fusion to the medicago truncatula homologue of the nop <dig> protein. nop <dig> is a nucleolar protein required for ribosomal subunit synthesis  <cit> . it was amplified from medicago truncatula rna by rt-pcr with the primers attctcgagtaatggcactctttctccc and actaggatccttattcagcatccttctttt and cloned via xho <dig> and bamh <dig> in frame with the yfp open reading frame into peyfp-c <dig> . the fusion construct was then cut with nco <dig> and bamh <dig> and ligated into piex <dig> 

the sf <dig> cells were obtained from novagen and maintained in serum-free bacvector® insect cell medium at 25°c. their transfection was performed using the constructed expression vectors and insect gene juice  in 24-well glass-bottom plates according to the manufacturer's protocol. the fluorescence patterns were visualised directly after staining or  <dig> hours after transfection with an olympus ix <dig> microscope equipped with appropriate filters. in addition to the fluorescence images showing protein distribution patterns, bright-field images were taken in parallel. these bright-field images can be applied to find the surrounding cells. all images were captured with a  <dig> × objective  by the scanr software .

representation of protein distribution patterns
observed protein distribution patterns can be represented in several ways. in comparison to the direct application of pixel intensities, the usage of numerical features has proven particularly advantageous for the classification of fluorescence images showing tagged proteins  <cit> . from the literature, a multitude of different feature sets is known  <cit> : morphological features, histogram-based features, edge-related features, convex hull features, moment-based features, features based on co-occurrence matrices and wavelet features. here, usually several types of features are required to allow for a correct classification of protein location patterns. so, if a new cell line, such as sf <dig>  is to be analysed, the problem consists in defining a set of feature types which reflects the location patterns adequately. selecting only an individual feature type most probably does not surface. since from the resulting set several features may be irrelevant or redundant, a feature reduction step has been shown to be beneficial  <cit> . here, the application of feature reduction methods requires the availability of appropriate datasets. these datasets are further necessary for the classification of the protein distribution patterns; that is, their association with a distinct set of protein locations.

features
in the literature, subcellular location features are either computed from images of single cells or multi-cell images. single-cell images usually have been cropped manually  <cit>  or determined automatically using counterstaining  <cit> . in contrast, multi-cell images  <cit>  are evaluated as a whole and do not rely on any kind of segmentation or cropping. but they require homogeneous location patterns for all cells, which cannot be guaranteed for numerous biological experiments. furthermore, image properties different from protein locations, e.g. the cell distribution, might influence the outcome of the analyses. therefore, we propose the usage of a mask image, called a cell mask, for each cell. these cell masks depict all pixels belonging to a specific cell in white and all other pixels in black. so, the protein distribution patterns of all cells can be analysed individually, even if the cells lie in cell clusters. but since only pixels within the considered cells are regarded, feature sets that are based on rectangular image regions cannot be transferred easily.

since the applied cell line as well as the proposed mask images have not been applied within the frame of an automated protein localisation technique before, the known feature sets are only of limited use, although individual features are transferable. consequently, we have chosen an own feature set. we have selected the corresponding features in such a way as to enable a comprehensive description of all protein distribution patterns which might appear in sf <dig> cells: firstly, features enabling a consideration of the positions of tagged proteins relative to the surrounding cells are employed. they comprise the well-known zernike moments  <cit>  and region-dependent texture features, which were developed by us. while zernike moments quantitate the positions of bright image structures by means of complex radial polynomials, the region-dependent texture features employ simple grey-level statistics to ring-shaped image regions: the mean, the variance, the skewness, the uniformity, the smoothness, the entropy and the median. using polar coordinates, the rings can be determined easily .

secondly, morphological features are employed, in particular pattern spectra  <cit> , which allow for an evaluation of the shape and the size of protein accumulations. in contrast to alternative morphological features, e.g. the features proposed in  <cit>  and  <cit> , a prior binarisation or segmentation of intracellular structures is not required. pattern spectra are particularly useful for the description of small nearly circular cell organelles such as lysosomes or peroxisomes.

finally, general properties of the protein distributions are examined by means of fractal features  <cit>  and histogram-based statistical features which are applied to the whole cell. so, characteristics less obvious than shape, size and location of protein accumulations are incorporated into the localisation procedure, for example, the heterogeneity and roughness of the image at different scales.

all of these features have been applied in such a way that an incorporation of the respective cell mask is enabled. using zernike moments and region-dependent texture features, each cell is mapped to a circle, which resembles the shape of the sf <dig> cells. using the other types of features, pixels not contained in the respective mask are explicitly neglected.

basic datasets
as a basis for all further investigations, basic datasets containing feature vectors of images showing ten major protein locations were generated. these locations correspond to specific cell compartments or combinations thereof. exemplary micrographs are shown in figure  <dig>  the respective numbers of cell masks, which had been manually extracted from corresponding bright-field images by a biological expert, are summarised in table  <dig>  these cell masks were associated with protein distribution patterns from corresponding fluorescence micrographs. as the number of feature vectors equals the number of cell masks, a total of  <dig>   <dig> samples were available.

for each cell compartment a certain number of cell masks was extracted from bright-field images. but in order to realise a protein localisation, an analysis of fluorescence micrographs must be performed. therefore, each cell mask has been associated with a corresponding region in a fluorescence micrograph that depicts a protein distribution pattern characteristic for this compartment.

in order to characterise the protein distribution patterns, we compiled two different feature sets. they are referred to as feature set a and feature set ℬ, respectively. using each feature set, an individual basic dataset was created. both feature sets comprise pattern spectra, fractal features and histogram-based features. in addition, feature set a encompasses zernike moments and feature set ℬ region-dependent texture features resulting in a total of  <dig> basic features each. as the size of both feature sets is equal, a comparison of the established but computationally intensive zernike moments  <cit>  with our simpler region-dependent texture features becomes possible. using an amd athlon™  <dig> processor , the mean time for computing feature set a and ℬ for one of the  <dig>   <dig> cell masks amounts to  <dig>  s and  <dig>  s, respectively. so, the suggested region-dependent texture features are a promising alternative to zernike moments.

automatic data generation
the  <dig>   <dig> manually extracted cell masks may differ from cell masks, which are automatically determined using a cell recognition approach. in particular, the cell boundaries are likely to vary slightly, which might influence the outcome of the protein localisation. but in an automated context, proteins have to be localised in such automatically acquired cell masks. in order to analyse and solve this problem, we propose the application of a procedure enabling the automatic generation of additional training data. it was successfully applied within the scope of a cell recognition approach before  and works as follows: the cells which are described by manually determined cell masks are automatically segmented in the respective bright-field images. the resulting segments are associated with these cell masks; i.e., the segments constitute variations of the masks. provided that the difference between a segment's contour and the respective cell mask's contour is less than 10% of the manually segmented cell's diameter, the automatically determined image region is accepted as an additional cell mask. if the resulting, automatically determined cell masks are superimposed onto the corresponding fluorescence micrographs, variations of the original protein distribution patterns can be acquired. so we generated an additional  <dig>   <dig> samples. these segments are more likely to occur than the manually determined cell masks if the proposed protein localisation technique is applied in conjunction with the considered cell recognition procedure. as a result, the automatic generation of training data alleviates the cooperation of both procedures. in addition, the number of samples was increased, which facilitates the classification task. otherwise, the number of training samples might not have been sufficient.

feature reduction
suitable features were selected by means of the stepwise discriminant analysis . it chooses a set of features depending on statistical properties of the data. the used classifier is not taken into account. however, from the literature it is known that the stepwise discriminant analysis is very well-suited for selecting features in the context of protein localisation  <cit> . in order to achieve comparable results, the procedure stepdisc of the software package sas/stat  <cit>  was applied here.

classification of known locations
the actual protein localisation is performed by classifying observed protein distribution patterns in classes corresponding to protein locations; that is, observed protein distribution patterns are assigned to one of the ten locations depicted in figure  <dig>  here, we propose the application of an extended version of the simplified fuzzy artmap  originally introduced in  <cit>  as a classifier. the sfam has several advantages in comparison to alternative classifiers such as multilayer perceptrons  <cit>  and support vector machines  <cit> , which are usually applied within the scope of protein localisation: it is very well-suited to fast and stable on-line learning, and enables the detection, clustering and incremental learning of unknown samples, which is crucial with respect to the desired ability of incorporating new protein location patterns into the trained system. moreover, it is directly applicable to multi-class classification problems. eventually, the sfam's classification accuracy is comparable to other state-of-the-art methods  <cit> .

the sfam has a three-layered architecture . the first layer f <dig> performs an encoding of the input vector x called complement coding. the resulting vector xf <dig> constitutes the input vector of the subsequent layer f <dig>  the nodes of the output layer f <dig> are linked to all nodes of the f <dig> layer. the corresponding weights w¯if <dig> define hyper-rectangular subspaces of the input space – the categories. the categories' sizes are limited by means of the vigilance parameter ρ. moreover, each f <dig> neuron is associated with a class label. as the sfam is an incremental network, there are neurons, which are not in use but required for an extension of the network – the uncommitted nodes. during the training process, they are incorporated if the available nodes are not able to represent an input vector.

in order to classify a presented feature vector, all m outputs are initialised by - <dig> first. afterwards, the activation of all f <dig> nodes is computed and the output of the best-matching node yjf <dig> is set to its class label. the other nodes remain unchanged. thus, a classification result c can be determined by:

  c=max⁡i= <dig> ...,myif <dig>  

as the presented approach is not only intended to localise a fixed set of proteins, a measure specifying whether an input vector is known or unknown is required. so, previously unknown locations can be recognised and incorporated into the system. furthermore, it would be beneficial to have information on the degree of knowledge so as to find related or similar protein locations. unfortunately, the original activation zif <dig> proposed by carpenter  <cit>  cannot fulfil this task, since it varies depending on the size of a category i represented by |w¯if2| <dig> 

  zif2=|x¯f1∧w¯if2|1α+|w¯if2| <dig> 

here, |·| <dig> denotes the city block norm and and ∧ symbolises an element-wise minimum operation. the choice parameter α is usually set slightly higher than zero, which increases the influence of the category size even more: for α>  <dig>  small categories are preferred to large ones.

in order to determine an activation of the f <dig> neurons, which is independent of the categories' sizes, we decided to employ the alternative measure z˜if <dig> if an input vector is to be classified  <cit> . z˜if <dig> corresponds to the distance from an input vector to category i according to the city block norm.

  z˜if2=|∧w¯if2)−w¯if2| <dig> 

the minimum value z˜min⁡f <dig> of z˜if <dig> over all f <dig> nodes i indicates the degree of knowledge about an input vector. assuming z˜min⁡f <dig> =  <dig>  the input vector lies within a category; i.e., it is known completely. higher values correspond to less knowledge. however, an input vector which is close to a category is likely to be representable by it. therefore, we introduced a threshold τ, which denotes the maximum distance up to which an input vector is considered as being known . in the case that z˜min⁡f <dig> is larger than τ, the output yjf <dig> of the best-matching neuron remains unchanged after the initialisation. as a result, c yields a class label for known input vectors and - <dig> otherwise .

if τ equals zero, our extended sfam is identical to the original sfam. in principle, τ constitutes an additional degree of freedom, which is to be optimised in conjunction with the vigilance parameter ρ in order to reach high classification accuracies. but in addition, τ is essential to parametrise the rejection of unknown inputs.

detection and incorporation of new locations
in principle, the sfam is able to incorporate new data . provided that the distribution patterns are presented in random order, there is no decrease in accuracy. but as the proposed approach aims at creating a method which is amenable to high-throughput processing, user interactions cannot be performed when a new input occurs; only post-processing would be possible. thus, unknown protein distribution patterns have to be sorted out for a future inspection by an expert. without such a manually assigned class label, these patterns might not have any biological meaning. dissimilarity in the feature space is a necessary but not sufficient criterion to create new classes, since it depends on the employed features and similarity measures rather than biological knowledge. furthermore, a manual association of clusters with specific protein locations would necessarily be biased by the applied protein localisation technique and the expectations of its users. only pre-labelled data, which are used to analyse the proposed technique, ensure an objective evaluation.

using the sfam, an unknown location is characterised by a minimum activation z˜min⁡f <dig> higher than a threshold τ. the corresponding feature vector has a distance larger than τ to the closest category. however, if τ is chosen in such a way as to maximise the classification accuracy, the vast majority of fluorescence images showing the protein locations used for training are considered as known and classified accordingly. so, if a new location resembles a known one, the corresponding feature vectors are likely to be regarded as known and classified incorrectly. in order to circumvent this problem, we introduced a second threshold τ <dig> with respect to z˜min⁡f <dig>  it is smaller than τ and defines the minimum distance to the closest category that a pattern must have in order to be recognised as potentially unknown, or rather as a possibly new protein location. in this case, an expert could be asked for advice.

τ <dig> must be selected in such a way that a compromise between correctly classifying the known locations and detecting potentially unknown locations is reached. in particular, the amount of required manual assignments should be minimal, although the user interventions occur after the actual experiment. with respect to the unknown locations, the fraction of inputs recognised as potentially unknown  should be high. so, the new locations can be detected. on the other hand, images of already known classes should not be regarded as potentially unknown. the corresponding results are symbolised by fk. due to these considerations, an optimal value τ2opt for τ <dig> can be determined by maximising the difference between fu and fk:

  τ2opt=max⁡τ <dig> 

in addition, τ is still usable for the classification. so, even if z˜min⁡f <dig> for a specific feature vector is higher than τ <dig>  a suggestion for a likely protein location can be made unless z˜min⁡f <dig> is higher than τ as well.

evaluation methods
this section introduces all of the methods that were applied so as to evaluate our approach. firstly, several accuracy measures are discussed, concerning the quantitative evaluation. afterwards, we describe the methods for analysing our protein localisation approach with respect to both tasks which we aim to solve: the classification into a pre-trained set of locations as well as the identification and incorporation of new protein locations.

accuracy
in order to contrast the classification results, the total accuracy acc, is utilised. it has been applied by numerous researchers to this task before and constitutes a standard measure . the total accuracy reflects the amount of correctly classified patterns. in terms of location-specific accuracies acci, it can be written as follows:

  acc=1n∑i=1nniacci 

here, n denotes the total number of available test patterns, n the number of regarded locations and ni the number of images showing location i. equation  <dig> illustrates that acc has a crucial drawback regarding the evaluation of classifiers: insufficient results with respect to some protein locations might be balanced by others. so especially locations for which only a few training samples are available  can be incorrectly classified without a significant impact on acc. this is impressively shown in  <cit>  where a total accuracy of 81% is reported but from  <dig> of  <dig> locations not even one image was recognised and for  <dig> other locations only results below 50% were reached. here, the arithmetic mean acc¯am of the location-specific accuracies, which amounts to  <dig> %, reflects the classification accuracy more appropriately.

  acc¯am=1n∑i=1nacci 

however, acc¯am, which has been applied as an alternative to acc  <cit> , does not completely solve the balancing problem. assuming that all distribution patterns of  <dig> out of  <dig> locations would be correctly recognised , the minimum of acc¯am equals 90%, even if the images showing the tenth location were misclassified completely . so, if the arithmetic mean was used for parameter optimisation, for example for the parameters of the employed classifier, an equally correct recognition of all locations could not be guaranteed. in order to circumvent this problem, here we propose to employ the mean accuracy acc¯hm in addition to the total accuracy. it denotes the harmonic mean of the location-specific accuracies acci.

  acc¯hm=n∑i=1n1acci 

the harmonic mean is always smaller than or equal to the arithmetic mean: the larger the difference between individual accuracies acci, the more it decreases in comparison to the arithmetic mean. in principle, other measures, such as the geometric mean, would have been possible as well. but, we decided to use the harmonic mean, as it punishes unbalanced results more strongly. this is particularly important, since we perform the optimisation of the sfam's parameters based on acc¯hm in order to ensure that the differences in accuracy between all locations are as small as possible. in comparison to using the arithmetic mean, the resulting classifiers' performances are easier to assess, as the given overall accuracies  reflect the location-specific accuracies acci more precisely. in order to simplify the mathematical notation, acc¯hm is written acc¯ in the following.

evaluation of the classification task
the training was performed without distinguishing between manually and automatically acquired protein distribution patterns. but the results concerning both types of sample were computed independently, so as to enable an evaluation of the cooperation of our protein localisation technique with the applied cell recognition method.

in order to assess the proposed protein localisation approach with respect to the classification of the protein distribution patterns in the ten regarded locations, the basic datasets were randomly mixed and split into ten subsets. no dataset contains masks of cells which are part of another dataset. using these subsets, five groups of eight training and two test datasets each were created. here, the selection of the test datasets occurred in such a way that they were disjoint. so, it became possible to apply eight-fold cross-validation to the optimisation of the classifiers' parameters  and five-fold cross-validation to test the localisation results.

evaluation of the retraining task
according to the evaluation of the classification task, manually and automatically determined protein distribution patterns were not distinguished with respect to the classifiers' retraining. but the evaluations concerning the quality of the protein localisation were carried out considering only the manually acquired samples to simplify the following discussions.

in order to simulate the occurrence of protein distribution patterns showing new locations during a biological experiment, we partitioned the available data according to the respective cell compartments: eight protein locations were considered as known and utilised for training a classifier as explained in the previous section. the remaining two locations served as unknown locations for the evaluation. in principle, the application of a single unknown cell compartment would have been possible as well. but the employed method is more realistic, since more than one single untrained location can be expected to exist. in total, there are  <dig> different possibilities of dividing ten classes into two groups of eight and two classes, respectively. they are denoted by ci.

the datasets of each combination ci of known and unknown locations were divided into five subsets  so as to enable an evaluation and parameter optimisation using cross-validation. the individual datasets are referred to as kij and uij respectively. this partitioning resulted in ten datasets regarding each combination and enables cross-validation concerning the known as well as the new cell compartments.

the training of the networks with respect to the known cell compartments was performed using four of the five available datasets associated with a specific combination ci: three datasets were used for training and the fourth one for validation. by iterating ρ and τ, a parameter optimisation was performed. here, the respective fifth dataset served as an independent test set for the chosen parameter settings. this procedure was repeated for all possible groups of four datasets. on the whole, it is a simplification of the cross-validation scheme introduced in the previous section.

after finishing the training procedure, the networks' abilities to recognise unknown protein locations were evaluated. here, the threshold τ <dig> was iterated from  <dig> to τ and the samples contained in ui <dig> to ui <dig> were presented to the sfams. then, the fractions of unknown samples from the known  and the new unknown protein locations  were measured.

once unknown protein locations have been detected, they can be incorporated in the sfam. but, since the proposed approach is intended to be applied as a high-throughput system, no user interactions are possible during the protein localisation. however, samples recognised as an unknown location could be automatically sorted out for further assessment. after they have been associated with a protein location by a biological expert, the sfam can be retrained. the evaluation of the retraining capabilities was performed similar to the analysis of the classification accuracies with respect to the eight previously known protein locations; i.e., four of five datasets were utilised. the remaining one was used as a test dataset. an optimisation of ρ and τ had not been necessary here, as their values were already known. the whole process was repeated for every test dataset possible. so, it constitutes five-fold cross-validation.

besides the features themselves, the size of the feature set might affect the retraining process. therefore, experiments based on reduced feature sets were conducted as well. however, it is virtually impossible to select a set of features, which accounts for a number of classes that are not known in advance. therefore, this kind of feature reduction would only be of limited use with respect to the detection and learning of new cell compartments.

RESULTS
classification task
                              acc¯
                              acc¯

                           ℬ

                           ℬ
although the sfams were trained using both manually and automatically obtained protein distribution patterns, the evaluation is performed separately. here, i denotes the accuracies regarding the manually acquired patterns and ii the results with respect to the automatically generated samples. the results indicate an advantage of feature set ℬ in comparison to feature set a. moreover, the feature reduction leads to a significant improvement of the protein localisation, independent from the feature set applied.

a comparison of the accuracies regarding the manually and automatically obtained samples reveals that our protein localisation technique can be successfully applied based on cell masks yielded by the automatic cell recognition approach. the results regarding the automatically generated patterns are even slightly better, which might be a consequence of their noticeably higher number.

the feature reduction led to a significant improvement of the classification results. feature set ℬ, which employs the region-dependent texture features, seems to be more appropriate than feature set a, which is based on zernike moments. since the computation of feature set ℬ is significantly faster as well, it should be preferred.

in order to demonstrate the classifiers' abilities to discriminate between the ten chosen protein locations, table  <dig> shows the confusion matrix of the system using feature set ℬ and feature reduction by sda.

each row shows the classification results for a specific protein location. therefore, a single entry denotes the fraction of images from a specific protein location , which were associated with a specific class label . in the case of a correct classification, the row index and the column index are equal. the column marked by  shows the fraction of protein distribution patterns which were considered as unknown.

retraining task
besides the experiments concerning a fixed set of protein locations, we analysed the ability of the proposed protein localisation technique to detect and incorporate new protein locations after training. since feature set ℬ produced the best results with respect to the classification task, feature set a was neglected in all following experiments.

first, the fractions of patterns classified as potentially unknown were analysed . using τ2opt,  <dig> % of the unknown patterns were correctly recognised as potentially unknown . so, a sufficient number of training samples was available for the following retraining step. on the other hand,  <dig> % of the images showing known protein locations were considered as potentially unknown as well . this means that a biological expert would have to label about one third of all images depicting known location patterns, which might be too high a number for some experiments.

in principle, alternative methods for determining an appropriate value of τ <dig> are possible. so, fk could be diminished more strongly, if required. however, such a reduction entails a decline of fu as well . nevertheless, modifications of τ <dig> might enable an adaptation of the proposed approach to a greater variety of tasks and users.

besides the fraction of feature vectors classified as potentially unknown, the accuracy of the classifiers is critical. here, the accuracies regarding different subsets of the considered data have to be distinguished. acc¯testu denotes the mean accuracy with respect to the new protein locations after one epoch of retraining. in contrast, acc¯incorrectu symbolises the fraction of images showing new location patterns that were part of the training sets and incorrectly classified as known rather than being considered as potentially unknown. hence, these images could not contribute to the retraining. nevertheless, a certain fraction of them is classified correctly after other feature vectors of the corresponding class have been learnt. finally, acc¯beforek and acc¯afterk denote the mean accuracies of the known cell compartments before and after retraining, respectively.

the values of acc¯testu indicate that the sfam is able to incorporate new location patterns . even difficult patterns, which closely resemble the old cell compartments , are classified with acceptable mean accuracies acc¯incorrectu. here, the choice of τ2opt has proven beneficial again, since it enables a good compromise between the level of classification accuracy regarding the new protein locations  and the additional need for user interaction symbolised by fk =  <dig> % . the accuracies regarding the old, known locations are barely affected by the retraining, and resemble the results known from the evaluation regarding the original classification task.

since the number of available features has a strong impact on the classification accuracy of the sfam, we assumed that it might affect the retraining process as well. therefore, we arranged a reduced feature set based on the systems using a fixed set of protein locations. such a reduced feature set was expected to reveal important information regarding the retraining process, even though it is of limited use for real applications, since no information about the unknown classes is available. unfortunately, all results regarding the fixed set of protein locations were computed by means of five-fold cross-validation; that is, five runs using different classifiers were performed to determine mean values for the classification results. consequently, five reduced feature sets resulted from the complete feature set. so, a single reduced feature set needed to be compiled first. here, we exploited the fact that the reduced feature sets for a specific parameter setting are very similar, in particular, if the sda is employed. the final features were therefore selected by a set union of the five sets yielded by the cross-validation runs. the size of these feature sets was chosen so as to maximise the mean accuracy. due to the strong overlap of the five sets provided by the sda, which comprise  <dig> features each, the resulting set encompasses only  <dig> features in total.

again, the feature reduction proved beneficial. fk decreased from  <dig> % to  <dig> % and the mean accuracies rose by approximately 4%, which confirms the results concerning the application of feature reduction methods known from the classification task. only acc¯incorrectu declined by about 5%, which indicates that the classification of the new protein locations is impeded in favour of the old known locations. this conclusion is, in particular, supported by the decrease of fk.

the preference of the old, known cell protein locations is caused by the training procedure: the networks were trained with the old cell compartments until their weights did not change between two subsequent epochs. so, conflicts resulting from overlapping categories belonging to different classes could be solved. afterwards, the input vectors of the new locations were presented once. therefore, the new locations are not as well integrated into the classifier as the old ones. this could be circumvented if samples for the known cell compartments were presented during retraining. then, there would be no difference between batch and on-line learning. in principle, the fraction of samples measured by fk could be employed for training the classifier to recognise the old classes. so, it constitutes no drawback if fk does not equal zero.

automatic data generation
the influence of the procedure used for generating additional training data was measured by repeating the experiments introduced in the section concerning the classification task. but here only manually acquired protein distribution patterns were used for the training. table  <dig> contrasts the resulting mean accuracies with the original results regarding the classification task . here, the focus is on the accuracies concerning the automatically generated samples, as only these samples are biased by the cell recognition method.

                              acc¯
                              acc¯

                           ℬ

                           ℬ
these results were obtained using only manually acquired protein distribution patterns  and both manually and automatically obtained patterns  for training. they correspond to column ii of table  <dig> 

although the impact of the automatic data generation on the mean accuracies is not significant, the results from table  <dig> indicate a positive influence on the recognition of automatically determined protein distribution patterns. the total accuracies are barely affected.

discussion
the given results demonstrate that our approach is able to classify protein distribution patterns with a sufficient accuracy. the distribution patterns may either be obtained manually or yielded by a cell recognition approach. although the total accuracy seems to be slightly lower than the one of related protein localisation techniques developed by murphy's group which reach values up to  <dig> % , it must be taken into account that the proposed techniques neither rely on single-cell images nor analyse multi-cell images as a whole. rather it is possible to analyse clustered cells individually. so, if one micrograph contains only three cells and the majority vote is chosen as the correct protein localisation, the total accuracy of the system using feature set ℬ and feature reduction by sda would amount to  <dig> %. as typical images contain more than ten cells, accuracies higher than  <dig> % may be reached easily.

furthermore, here the optimisation of relevant parameters is performed based on a different measure – the mean accuracy acc¯ – which, in contrast to well-known approaches, fosters an equally accurate recognition of all protein locations. but it may lead to a small decrease of the classification accuracy, since the additional constraint of similar location-specific accuracies is imposed on the classifier.

besides analysing the classification of protein distribution patterns in a set of fixed locations, we have demonstrated that using our approach an incremental learning of new protein locations can be performed: at first, patterns from these new locations are detected as unknown and sorted out for future inspection. after the biological experiment has finished, an expert is able to examine these patterns and associate them with appropriate locations. then, they can be incorporated into our system and used in further experiments. even if a protein distribution pattern is sorted out, the classifier can provide information about its similarity to the known locations, which might support potential users. as an alternative to the proposed semi-automated procedure, a clustering of the unknown inputs as suggested by murphy's group  <cit>  could be performed. since our classifier is based on a fuzzy art  <cit>  clusterer itself, clustering information could be exploited directly. but the resulting mixture of user-annotated and automatically generated classes would lead to classifiers whose results are very difficult to interpret.

CONCLUSIONS
we have introduced a technique, which unifies several approaches that are usually investigated separately: besides performing a feature-based protein localisation, it is adapted to a cell recognition method and enables the detection and incorporation of new protein locations, if required. although almost the complete system can be applied in a fully-automated way, a semi-automated approach is preferred regarding the retraining with new locations in order to ensure the biological relevance of created classes. but even then, no user interaction is required during the actual analysis.

our approach can be considered as being incremental due to two different facts: firstly, an increasing number of cells that are visible in a fluorescence microscope image increases the accuracy of the protein localisation. secondly, additional locations can be incorporated into the pre-trained system. both aspects constitute an innovative contribution to the ongoing research into the subcellular localisation of proteins in living cells.

the proposed technique does not necessitate demanding microscopy or image-enhancing methods such as digital deconvolution, which facilitates its application in high-throughput experiments. furthermore, since no fluorescence channels are employed for cell recognition or to acquire auxiliary images, they are free for co-localisation experiments that could refine the set of recognisable protein locations in close analogy to manual protein localisation procedures  <cit> .

data availability
the microscope images as well as the  <dig>  cell masks that were used for evaluating the proposed protein localisation technique have been summarised to the 2d sf <dig> dataset, which is available from .

authors' contributions
mt drafted the manuscript and played the major role in developing the proposed protein localisation approach. nj conducted the underlying biological experiments, provided the required microscope images and cell masks, and was involved in writing the manuscript. fk conceived of the study and edited the manuscript.

