BACKGROUND
phylogenetic profiling is an established and widely known technique for inferring biological roles for unknown proteins  <cit> . the technique capitalizes on the propensity of proteins that work together in the same cellular system to have traveled together in evolutionary processes of speciation, gene loss, and lateral transfer. such systems may consist of biochemical pathways, multi-subunit protein complexes, protein-modifying enzymes with their targets, etc. for a given protein, the evolutionary history of its family is reflected in its present day taxonomic distribution  <cit> . therefore, examining protein family co-occurrence across large numbers of genomes may reveal evidence linking one protein to others that cooperate in the same system.

a phylogenetic profile in its simplest form is a series of binary characters  <cit> , 1's or 0's that show the presence or absence of a given protein family or of some other marker across a defined set of taxonomic groups  <cit> . this profile is then scored against profiles generated from other protein families in order to find statistical evidence that the families they represent cooperate in some way. since its inception, the technique has undergone extensive refinements  <cit> . some of these improvements are: a) use of information such as logic relationships amongst proteins  <cit> ; b) use of domains  <cit> , single amino acid  <cit> , or even peptides  <cit>  instead of proteins for comparison of profiles; c) refinements in selection of reference organisms  <cit> ; d) incorporation of evolutionary relationships of the species into the comparison of profiles  <cit> ; and e) use of information such as copy numbers of domains within genomes  <cit> . in spite of these refinements, the technique still depends heavily on some method for approximating the boundaries of a protein family such that its members are functionally equivalent, which is a notably difficult problem to solve.

nonetheless, phylogenetic profiling can be very successful in identifying cohorts of protein families likely to cooperate in the same cellular processes, and for making strong predictions of biological roles or molecular functions on unknown proteins when combined with other types of evidence. the technique has been used for various genetic and phenotypic traits that can be coded as binary characters  <cit> . some examples are: prediction of subcellular localization of proteins  <cit> ; identification of virulence associated genes in human pathogens  <cit> ; prediction of protein domains and their interactions  <cit> ; prediction of protein-sorting enzymes from the taxonomic ranges of their target sequences  <cit> , prediction of restriction sites  <cit> , etc. a few online databases now provide search and display capabilities using co-occurrence data computed through phylogenetic profiling, although the method for scoring co-occurrence is not user-adjustable. examples include microbesonline  <cit> , string  <cit> , etc. .

the success of phylogenetic profiling is affected by considerations in four components of the method, presented here in the order in which they are applied. the first is the selection of target species. although the effect of species selection in the success of phylogenetic profile methods is largely unexplored, it is now generally believed that the prediction accuracy increases with increasing numbers of species  <cit>  while limiting taxonomic redundancy  <cit> . second is the ability to find the appropriate set of homologs to a particular protein sequence in a set of genomes. this step typically relies either on prebuilt protein families, or on some methods for using sequence similarity results  to identify members of a protein family. third is the method of representing the phylogenetic distribution of a protein family as a profile. although a binary vector is typical, a profile sometimes is represented by real or transformed values of raw blast scores  <cit> . fourth, and finally, is the identification of a suitable method for scoring the match between profiles. such methods include simple distance measures such as hamming distances  <cit> , mutual information content  <cit> , jaccard coefficients  <cit> ; statistical measures such as pearson's correlation coefficient  <cit> , fisher's exact test  <cit> , rank correlation  <cit> , etc. there are also methods that go beyond naïve measures and take into consideration evolution of protein families, such as tree-kernel based method  <cit> , parsimony-based methods  <cit> , and maximum likelihood methods  <cit> . such methods, instead of considering only the distribution of protein homologs amongst the extant species, take into account the ancestors of such species and how gene gain and loss events have affected the current distribution of a protein family.

it appears that the most leverage for improvement of the method is found in the second of these: phylogenetic profiling works best when the working definition for each protein family comes as close as possible to the full set of homologs among which some specific function is conserved. typically, however, molecular function varies within protein superfamilies, and a particular function is shared only within a narrow subset. automated protein clustering methods or fixed sequence similarity cutoffs used for sequence homology searches cannot reliably achieve granularities that represent protein family sizes optimally. this shortfall can limit the effectiveness of available profiling methods, especially when they need to evaluate subgroups found within larger superfamilies.

we describe here prophylo, a distributable software framework for performing phylogenetic profiling studies. it includes the first distributable tool for performing partial phylogenetic profiling , an algorithm that overcomes such limitations by optimizing protein family size simultaneously with scoring co-occurrence. since first introducing the principle  <cit> , we have been using ppp extensively to find key protein components of novel biological systems, and to guide construction of their corresponding protein family definitions  <cit> . we introduce as well a variation on ppp called double partial phylogenetic profiling . dppp starts with a single query sequence, and then optimizes protein family sizes around both the query protein and the collection of target proteins. prophylo provides, in addition, utilities for constructing and manipulating taxonomic profiles and for using pre-computed blast results to perform ppp and dppp.

prophylo is a framework written in perl and designed to perform high-performance phylogenetic profile searches using arbitrary profiles on a desktop computer. a version is also available to run on computer clusters . the software comes with a database of pre-built blast searches of ~ <dig> selected prokaryotic reference genomes for immediate phylogenetic profile search. users additionally have the option to create their own databases. the software comes with tools for the creation and manipulation of phylogenetic profiles. at present, the software is configured to run profile searches using our own ppp algorithm, but it is designed in such a way that any scoring function can be used as a plug-in. we have plans to include several other scoring functions with future versions of the software. the software and the associated databases are freely available under the open source perl artistic license from ftp://ftp.jcvi.org/pub/data/ppp/.

implementation
databases
for a phylogenetic profile search, prophylo requires two databases: the cross-genome all vs. all blast search results , and the ncbi taxonomy database. the pre-formatted, ready-to-use databases can be downloaded from the prophylo distribution site, ftp://ftp.jcvi.org/pub/data/ppp/. the current version provides all vs. all blast result data for ~ <dig> complete prokaryotic genomes. these genomes were manually selected to remove excessive strain-level redundancy, while keeping the maximum possible taxonomic breadth. the peptide files for these genomes were downloaded from ncbi and an all vs. all search using ncbi blast was performed. results were processed using a script supplied with prophylo to produce files suitable for reading by prophylo. these parsed blast result files are stored separately for each genome. blast results for a user-selected target genome, therefore, can be downloaded separately from other genomes, keeping the download size small.

prophylo depends on the ncbi taxonomy tree for extraction of phylogenetic information. thus, a local installation of the ncbi taxonomy tree is essential to run the software. a pre-formatted sqlite  database of the ncbi taxonomic tree can be downloaded from the prophylo software distribution site. alternatively, scripts supplied with the package can automatically download the ncbi taxonomic tree from the ncbi website and create the necessary sqlite database on the user's desktop machine.

as an alternative to using the supplied databases, users can create custom databases. an extensive collection of scripts are supplied with software package, including scripts for performing blast searches and parsing blast result files, to create the databases suitable for use with prophylo.

profile creation
prophylo at present uses profiles in binary form, as a tab-delimited text file containing two columns: a taxonomic id as defined by ncbi taxonomy database followed by a  <dig> and  <dig> to indicate the presence or absence of a trait in the corresponding genome. a user can create such a profile file from several sources. scripts supplied with the package can create a query profile from blast, from hmm search results, or even from a collection of sequence identifiers. a user also has the option of supplying a manually created or modified profile file; taxa may be toggled between  <dig> and  <dig>  or may be removed entirely from influence on ppp results by omission from the query profile.

creation of profiles used in this study
tigrfams  <cit>  model tigr <dig> describes the dptd  protein that is one of the four trustworthy markers for the presence of the dna phosphorothioation  system  <cit> . examination of the  <dig> proteins  that score > =  <dig> to this model using hmmer <dig>  <cit>  identifies  <dig> different sporadically distributed genomes from the  <dig> genomes searched  and was used to create the dpt profile. the methanogenesis profile was created manually to agree with the scientific literature.

utility scripts
for effective use of the phylogenetic profile methods, providing only the method to compare profiles is not enough. the software package comes with a set of programs  to effectively manage and manipulate profiles. the programs allow the user to perform the following operations on profiles:

 <dig>  the user can use scripts to manipulate profiles and perform several operations on profile files, such as boolean and set operations on pairs of profiles to create new profiles. the operations make it possible to define profiles for working with orphan markers, or with recurring pathway holes.

 <dig>  the user can create a profile directly from the ncbi taxonomic database. these profiles can be used to query for proteins most universally conserved within a lineage. they can also be used, through boolean operations, to perform taxonomic restrictions on other profiles. for example, using a profile based on a marker for pathway x, the following question is easy to ask: what proteins occur only in the proteobacteria, and only when pathway x is present?

 <dig>  the user can perform masking operations that remove genomes whose assignments of the query trait are uncertain or irrelevant and a possible source of noise. this masking makes it possible to contrast species with all three markers a, b, and c for some system against species with none of the three, while ignoring species whose incomplete systems reconstructions may represent decaying systems, faulty classifiers, pathway variants, or other confounding situations.

profile search
at present, the prophylo package only supports comparison using the partial phylogenetic profile  algorithm  <cit> . the algorithm is called "partial" because it does not score two full profiles  against each other. instead, at each step in an optimization procedure it examines the partial profile that consists only of genomes encountered so far while descending a list of best blast hits. it assigns all of these genomes the value  <dig>  and scores each such partial profile for consistent agreement with the query profile, which contains both matching  and mismatching  values. in order to compare different proteins in a genome by their relative ability to match the query profile, each protein is scored based on the depth in its list of best blast hits where its match to the query profile shows the greatest statistical significance.

algorithms
a profile p =  ∈ { <dig> }n is defined over a collection of taxonomic identifiers t = {t <dig> ...,tn}, with negative examples being t <dig> = {ti:pi = 0} and positive examples being t <dig> = {ti:pi = 1}. we iterate through each gene in a genome. for each gene  we get its blast result , which is a collection of tuples  for j =  <dig> ...,m, where gj is a genbank identifier  and sj is a measure of significance, where only the most significant match from each taxon is considered. for each such r, we iterate through the gis sorted in decreasing order of significance. for each gj we get its taxonomic id, uj∈t while iterating over j =  <dig> ...,m the algorithm calculates,

 pj= ∑k=hjjjkpkk, 

where, hj = |{u <dig> ...,uj}∩t1|, i.e., the number of profile's positive genome seen up to index j. the value pj is, therefore, simply the probability, according to the binomial distribution, of finding at least hj hits  after j distinct taxa have been encountered in the blast hits list. the parameter p is the prior probability either provided by the user or calculated as the relative frequency of positive taxa in the input profile: p = |t1|/

the score of a particular gene g is then reported as p* = minpj, that is, the most significant probability computed for any depth in the blast hists list. for a genome, the results are presented as a sorted order of scores for each gene along with the values of p*, and its corresponding j and hj.

a variation of the algorithm is double partial phylogenetic profiling . this allows iterative searching starting with only a single given sequence. the algorithm iteratively goes down the blast hit list of a given protein, creating a new version of the taxonomic profile each time it finds a new taxon. these sets of query profiles are then searched using the ppp algorithm described above. the significant hits for each search are then collected and a sorted list of hits is generated as output. dppp automates the generation of the optimized ppp data sets needed to guide systems biology discovery and protein family construction. however, presently we do not provide any post processing tools to automate building protein families according to dppp results.

to accelerate the speed of the search we developed several heuristics, such as pre-calculation of the maximum binominal probability given a particular profile. a read-ahead mechanism determines whether it is possible to improve on the existing best score, given the remainder of the hit list, and stops the search if there is no chance of such improvement.

the sensitivity of the algorithm can also be modulated at the user's discretion. one such mechanism is collapsing terminal branches of the taxonomic tree. the software fully understands the ncbi taxonomic tree; a search can be performed using higher taxonomic levels such as genus or family rather than the strain-level identifier from ncbi taxonomy tree. the algorithm will walk up the taxonomic tree to the level specified by the user and count that node only once for scoring. another user option is to override the default calculation of p; increasing this value increases the penalty for mismatches to the query profile and thus helps to find only-if relationships even for proteins that are relatively rare.

software details
prophylo is written in the perl computer language and, therefore, theoretically can run on any platform where perl is available, however at present we support only macosx and linux officially. the software runs searches in parallel taking full advantage of multi-core processors frequently available in modern desktops. the software also comes in a flavor that runs on compute clusters .

in addition to a collection of scripts for various tasks related to phylogenetic profile comparison, prophylo contains an object-oriented perl library. components of the search mechanism, such as blast results, phylogenetic profiles, algorithms for comparison of profiles, are represented as software classes and thus are extensible and readily modifiable. one advantage of such a design is apparent in the case of the implementation of the algorithm modules, with each algorithm being a plug-in. any new algorithm, currently not supported by prophylo, can be easily supplied by inheriting from an interface and providing the concrete implementation of a few virtual methods.

the user can download the software and the required databases from the distribution site. detailed documentation is provided with the package for correct installation of the package and the database. the user also has the option to either create the databases on local machine or to use the pre-made databases available on the ftp site.

RESULTS
ppp method overview
the workflow of phylogenetic profile searching using prophylo with the ppp algorithm is shown in figure  <dig>  a profile search begins with blast or hmm results, or even from a collection of gis . a script then determines the taxonomic distribution of the gis in the hits list file and creates a query profile . a user can also provide a profile directly for the search. the user may also optionally provide a value to override the calculated binomial probability factor, p , and/or specify a taxonomic level at which to filter the profile. then, given a target genome to search and the query profile, the software iterates through every protein in the target genome, finding that protein's optimal correlation to the query profile. it orders its results by the statistical significance of each individually optimized score, and reports the numbers of matches and mismatches to the profile for each protein where its optimum was found .

finding molecular markers of methanogenesis - a large-scale test
an example that illustrates the use and utility of ppp is the identification of universal molecular markers of methanogenesis. methanogenesis requires a number of unusual cofactors that are rare or unknown outside the methanogens. all methanogens belong to the archaea, but they are quite divergent. furthermore, additional non-methanogenic lineages such as archaeoglobus and ferroglobus, rather than methanogens exclusively, descend from the presumed last common ancestor to all methanogens. finally, methanogens are metabolically varied. some are able to convert only methanol, and not carbon dioxide, into methane, and the group includes both thermophiles and mesophiles.

in the tigrfams collection of protein family definitions  <cit> , we have been able to construct thirty-three manually reviewed hmms serving to identify protein families whose membership is universal in, yet limited to the archaeal methanogens among the current available set of prokaryotic reference genomes. this is a large set of proteins to associate with a single biological process; it serves as a positive control set while demonstrating how widely sequence similarity cutoffs must be varied to choose protein family boundaries correctly. the method was performed on a test genome, that of methanohalophilus mahii dsm  <dig>  using a literature-based methanogenesis query profile in which 28/ <dig> genomes were marked  <dig>  rather than  <dig> .

in the ppp results, the top-scoring twenty-nine proteins  were those found to occur universally in and yet restricted to the methanogens: the first  <dig> species encountered in the blast lists were the  <dig> methanogens in the profile. this allows an appropriate cutoff score for blast results to be selected to define the families. the table shows in the second column how high  the e-value had to become to bring in the last methanogen genome, and in the third column the e-value of the first hit outside the set of archaeal methanogens. the list includes proteins from seven consecutive genes for subunits of tetrahydromethanopterin s-methyltransferase, and eight consecutive genes from the methyl-coenzyme m reductase region. the list contains another long gene cluster, encoding six different uncharacterized proteins  and the methyl coenzyme m reductase system component a <dig>  conspicuously absent from the list are proteins of essential processes such as protein translation, whose presumed high barriers to gene loss and lateral transfer make them popular choices for computing species phylogenies. the ~ <dig> sequences ranked highest by ppp score  is highly enriched in proteins whose functions are linked to methanogenesis, although not necessarily exclusively or universally. no ribosomal proteins, trna ligases, translation factors, cell division proteins, etc., occur until the 84th best hit by ppp to the methanogenesis profile.

in table  <dig> two of the proteins found are subunits a and d of formylmethanofuran dehydrogenase , part of a c <dig> transfer pathway required by methanogens but not absolutely restricted to them. these two are, from one perspective, false-positives, in the sense that a complete family of functionally equivalent fmd proteins would include members from more species than just the methanogens. on the other hand, within the methanogens these proteins do act in methanogenesis, and ppp is accurately identifying that branch of the family as a universal marker of methanogenesis.

ppp performs an excellent enrichment for proteins directly involved in methanogenesis in the set of proteins earning top score. thirty-four of the top forty genes returned by ppp are members of previously identified methanogenesis marker families built in tigrfams and identified within genome properties  <cit> . these are mixed with six genes whose blast lists generate patterns deviating from the methanogenesis profile by the absence of only one genome or the presence of one extra genome. five representatives of the tigrfams/genome properties marker set have similar off-by-one patterns, one of which can be explained by a missed gene call, and another by a truncated gene that may be a sequencing or assembly error. including the remaining three off-by-one cases, a total of eight of the marker genes have imperfect profiles. this is by no means unexpected as the use of raw blast lists as input is undoubtedly noisy . it is clear, however, that using a query profile based on a phenotypic trait, or a molecular marker used to signify such a trait, can provide a highly significant enrichment of proteins directly involved in the process in the set of proteins with the best scores by ppp.

from blast to hmm: prophylo to guide protein family construction
the core computational function in ppp picks a score cutoff for a sorted list of blast hits in order to optimize a working definition of a protein family, based on which the family's match to the query profile can assessed. blast, however, suffers certain limitations. first, there is a limit in sensitivity. second, in any protein family, both heterogeneity in the rates of evolution in different lineages and regions of unusual sequence composition can interfere with the ability of the evolutionarily most closely related proteins to outscore more distantly related proteins. limitations of blast explain the absence of the mtrf protein, tetrahydromethanopterin s-methyltransferase f subunit  from the list of proteins in table  <dig> that perfectly match the methanogenesis query profile. two archaeal methanogens have mtrf proteins divergent enough not to show up in the blast hits list for gi: <dig>  letting that protein rank only the 42nd best hit by ppp.

hmms based on protein multiple sequence alignments regularly outperform blast, both in sensitivity and in the discrimination of protein family members from non-members. an hmm  made from the alignment of just three mtrf sequences, for example, finds the complete mtrf family without a false positive. constructing tools such as model tigr <dig> that cleanly identify molecular markers in large data sets often is a goal when phylogenetic profiling is performed. the prophylo software package, therefore, provides the utility ppp_hmmer.pl for analyzing hmmer <dig> search results files. it uses the compute engine of ppp, reading gi numbers ordered by hmm score rather than blast score. it finds and reports an optimal depth in an hmm hits list for matching a query profile, which aids in setting proper score cutoffs. this utility should be useful in workflows that begin with ppp search results and aim to develop new hmm-based protein family identification rules.

ppp with user-controlled scoring behaviors - discovering novel dna phosphorothioation-dependent proteins
ppp results show candidate protein families whose correlations to the query profile outscore the background from uninteresting correlations, as from similar taxonomy  or from similar environmental pressures . a rare protein meaningfully correlated  to another can outscore the background if an appropriate scoring system is used. ppp scoring depends on the binomial distribution; changing its parameter p will determine which scores better,  <dig> "yes" genomes out of  <dig>  or  <dig> out of  <dig>  a command line switch that forces use of a different probability p from what is calculated naively from the query profile can steer a ppp search toward better detection of certain types of relationships. using a larger value of p increases the effective penalty for each mismatch, and makes it easier to detect even rare proteins that approximate an "only if" relationship to the query profile. figure  <dig> shows an example of using a binomial distribution probability parameter raised from  <dig>  to  <dig>  to achieve a low background in ppp results based on the methanogenesis query profile. 

the dna phosphorothioation  system presents a challenge to phylogenetic profiling that can be addressed by application of this technique. the dpt system catalyzes a post-replication sulfur modification of the phosphate backbone of dna, first identified in streptomyces lividans  <cit> . the proteins dptf, dptg, and dpth are now known to represent the first restriction enzyme system specific for dpt modification sites  <cit> . there is no particular reason why all organisms with the dpt system should necessarily encode this particular restriction system, and in fact, dptfgh are only observed in a strict subset of those genomes. for example, a dpt profile based on the dptd gene  yields a profile with  <dig> % "yes" genomes . artificially raising p approximately 5-fold to  <dig>  and running ppp on the genome of pseudoalteromonas haloplanktis tac <dig> yields the dptfgh genes as the top hits after the components of the dpt system itself. this is despite the dptfgh genes being present in roughly 1/ <dig> of the genomes encoding the dpt system. additional, yet-uncharacterized dpt-dependent systems should be expected having distinct subset distributions, and some of these may be relatively rare. ppp can be used with a raised value of p to enrich its results for protein families that are subsets of the dpt profile and likely candidates for such systems.

a ppp search of serratia odorifera 4rx <dig>  using the dpt profile with p set to  <dig>  yields, in addition to the dpt system components and the dptfgh genes, the protein gi: <dig> despite its occurring in only seven genomes . with the naïve value of p at  <dig>  it is only the 34th best hit. the seven homologs of this protein are invariably found adjacent to the elements of the dpt system; sometimes the dptfgh genes are present, sometimes not. it would appear that the homologs of protein gi: <dig>  do represent a novel dpt satellite protein family, analogous to dptfgh. this family is now represented by the tigrfams model tigr <dig>  guided by ppp similar results generated with elevated p values, we have constructed tigrfams definitions for several additional strictly dpt-dependent families. tigr <dig> describes an uncharacterized protein , while tigr <dig> describes a subfamily of pf <dig>  "type iii restriction enzyme res subunit," , apparently the second discovery of a dpt-dependent restriction enzyme. both of these families include members located adjacent to dpt system genes.

1ncbi gi. 2the number of unique taxa common to the query profile and the target blast hit list. 3the total number of unique taxa in encountered where ppp found the optimal depth. 4score reported by ppp as the negative logarithm of the p-value at the optimal depth, which is lowest that can be obtained from the binomial distribution for any depth.

double-partial phylogenetic profiling 
in the tigrfams collection of protein families, models that describe equivalogs  can vary in sizes, ranging from universal  to less than 1% in coverage of prokaryotic reference genomes. when building a protein family to represent one component of a new and previously unknown complex system, the proper protein family size cannot be known in advance. dppp addresses this limitation by taking a query protein and systematically varying the numbers of its closest matches by blast as the basis for constructing query profiles for use in ppp . if a protein participates in a multicomponent system, then for the query protein, the blast hits list depth that comes closest to matching the list of genomes that actually have the system should generate the best query profile. for the other proteins in the system, that query profile should provide their best ppp scores.

the  hydrogenase h-cluster maturation gtpase hydf  <cit> , gi: <dig> from shewanella sp. mr- <dig>  was selected as an example. dppp searched a range of depths in the hits list to the query protein, from  <dig> genomes to  <dig> and the best score for any protein other than itself occurred when the blast score cutoff gave a query profile with  <dig> "yes" genomes of the  <dig> in prophylo . results for the top ten proteins using this depth are presented in table 3; proteins proposed to belong to the system of  hydrogenase maturation are in boldface. the maturase proteins hydefg perform best followed at a somewhat lower score by the hydrogenase large and small subunits .

proteins related to -hydrogenase are marked in boldface.

1ncbi gi. 2"yes" denotes number of unique taxa common to query profile and the target blast hit list. 3the total number of unique taxa found in the target blast list at the level that gives the best ppp score. 4the depth in the target blast list that give the best ppp score, which may reflect multiple hits in some genomes. 5score reported by ppp as the negative logarithm of p-value. 6tigrfams and pfam models were used because existing genbank annotations were out of date.

the sixth protein listed in table  <dig> is thih, a radical sam protein for thiamin biosynthesis. its ppp score,  <dig> , is well above background , but this is misleading. thih is closely related to hydg. at a depth of  <dig> proteins in its blast results, the mix of thif and hydg proteins represents  <dig> genomes, of which  <dig> have the gtp-binding protein hydf. this illustrates that ppp results should be read with additional caution for any protein that is homologous to a better-scoring protein from the same genome.

prophylo offers the user a flexible environment for performing phylogenetic profiling. it not only supports the discovery of cohorts of proteins that work in concert, but also guides initial steps in protein family construction by reporting a meaningful suggested protein family size. its computation is based on the principle that the correct granularity for defining individual protein families may not be known in advance. in fact, we have shown here that the "right" blast score e-value cutoff can vary over  <dig> orders of magnitude , depending greatly on protein length and the degree of conservation in the families in question. the search strategy is analogous to that of blast, which ranks all proteins in a target database on the basis of each protein's best possible pairwise alignment to the query. ppp scores every protein in a genome against the query profile by first finding that protein's best possible family size, and therefore best score.

investigators using ppp may choose runtime parameters, or design query profiles, to favor particular avenues of inquiry. query profiles can represent not only phenotypes or protein families, but various other possible starting points for research investigations: pathway holes, short motifs found on proteins in some genomes but not others, genomes with known molecular markers in unexpected contexts, etc. the flexibility in the way a query profile can be defined and how it is used, combined with the software's ability to base its searches on optimized working definitions for protein families, makes the prophylo package a powerful investigational tool in comparative genomics.

the examples presented here illustrate the potential of profiling analysis using ppp and dppp and some of the intrinsic limitations of the method. results are very much dependent on the nature of the phylogenetic profile under study. the methanogenesis profile is very similar to a "taxonomic" profile, one capturing every organism in the test set descendant from a common ancestor. such an information-poor profile can generate an enriched list of marker genes, but inhomogeneities in similarity scoring by blast, and infrequent data errors, serve to blur the separation between genes whose function is directly linked to the process represented by the profile, and those matching by chance or indirect relationships. however, given sporadic, information-rich profiles that are characterized by a greater degree of gene loss and lateral gene transfer , significant signal-to-noise can be realized. for instance, the high information content of the dna phosphorothiolation profile enables the identification of real relationships even when the overlap between profiles is very small, by using prophylo's ability to modulate the expected probability factor, p. even in cases such as the hydf example, where the distribution of a functionally homogeneous protein family is not posited in advance, the use of dppp can extract both the correct family scope and the identities of process-linked partners given sufficient information in these patterns.

CONCLUSIONS
prophylo is a software package for high-performance phylogenetic profile searches on desktop computers. the package implements partial phylogenetic profiling  and double partial phylogenetic profiling , algorithms to facilitate protein family construction using phylogenetic profiles. the computational advances represented by the ppp and dppp algorithms have the potential to take phylogenetic profiling beyond the limited correlation of pre-formed protein families, and to remove much of the insensitivity of previous methods due to the vagaries of protein cluster calculations. with prophylo, users will be able to generate and modify custom profiles, iterate and refine hypotheses, and tune parameters to perform real-time profiling research in a manner distinctly more powerful than is currently available.

availability and requirements
project name: prophylo; project home page: ftp://ftp.jcvi.org/pub/data/ppp/; operating system: platform independent; programming language: perl; licence: open source perl artistic license.

authors' contributions
mkb created the prophylo software and the associated databases. js implemented prototype versions of ppp algorithms. dh performed the biological investigations. all authors made contributions in improving the algorithms, writing the manuscript and read and approved the final manuscript.

supplementary material
additional file 1
supplementary table  <dig>  table of the utility scripts and their uses, supplied with prophylo software.

click here for file

 acknowledgements
funding: this work was supported by nih grant r <dig> hgo <dig> 
