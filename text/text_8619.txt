BACKGROUND
genetic variation in the human genome takes many forms ranging from large chromosome anomalies to single nucleotide polymorphisms . deletion, insertion and duplication events giving rise to copy number variations  are found genome-wide in humans  <cit>  and other species  <cit> . genomic variants can impact both somatic and germ-line genetics. the link between cnvs and inherited diseases is now solidly established , and copy number plasticity is typical of cancer cells  <cit> . such genomic variability, which was identified more than a decade ago using array-based comparative hybridization  <cit> , was known for much longer from cytogenetic studies or southern blots. it has been demonstrated that cnvs near oncogenes or tumor suppressor genes can affect gene expression levels or result in the expression of chimeric fusion genes  <cit> . however, the number and positions of rare cnvs in the human genome are still likely to be underestimated and their contribution to common complex diseases such as diabetes or obesity is unclear. very recent results demonstrate that rare variants can have very high penetrance in the etiology of morbid obesity  <cit> .

the colaus  study is a population-based survey started in  <dig> to study risk factors for hypertension and cardiovascular diseases  <cit> .  <dig> caucasian individuals  from the lausanne area in switzerland participated in the study.  <dig> individuals were genotyped on affymetrix 500k snp chips, and a fraction of these were also genotyped on the illumina 550 k snp chips  <cit> . a number of snp-based genome-wide association studies  that employed the colaus data have already been reported  <cit> . although many other large cohorts including thousands of individuals have been genotyped for snps  <cit> , very few have reported cnv maps  <cit> .

it is important to emphasize that most snp arrays used so far in gwas of clinical cohorts were not designed for cnv  detection, but only to call the three possible genotypes of snps. nevertheless, by combining the intensities of the two alleles for a given snp, it is possible to obtain information also on the copy number state of the snp locus. however, this is challenging for several reasons: first, when analyzing very large datasets , it is likely that experiments were conducted at different times and/or by different laboratories, which often introduces strong batch effects for the raw intensities. thus the first challenge in cnv calling is to ensure proper normalization of these raw data. second, due to the large noise in the snp probe intensities in these arrays , the estimates of copy numbers for a given locus  are not very reliable. thus more reliable prediction can only be made by integration of intensities from several neighboring loci, a strategy that is employed by many different cnv detection methods  <cit> . however, this approach makes cnv detection difficult  in regions with low snp density. to overcome this limitation, the illumina  and affymetrix arrays  include more snp markers and non-polymorphic probes to cover cnv-rich regions. these arrays also received considerable attention from the community and now benefit from a variety of freely available and efficient cnv detection methods  <cit> . these methods also make use of the ratio of allelic intensities which can improve cnv prediction  <cit> . until very recently  <cit> , little has been done for affymetrix 500 k arrays, which were analyzed with software such as dchip  <cit> , cnag  <cit> , gemca  <cit>  and cnat  <cit> . all but cnat are restricted to the windows operating system and thus are inappropriate for the analysis of large cohorts and for distributed computing on unix-based clusters. software initially developed for illumina arrays  <cit>  were modified to allow the analysis of affymetrix arrays . however the performance of these software on affymetrix 500 k data has not been intensively tested and for some the software implementation is tedious to use. for example, penncnv  <cit>  is considered as a very efficient software for cnv analysis. however to analyse affymetrix 500 k data, several pre-processing steps are needed. these steps rely on external applications  which in their current release do not longer support the pre-processing. while supporting dependencies is a very challenging work in any software development project, it makes it difficult to the user to decide which software to use. in addition, whilst there are now several performance benchmarks for the newest array generation  <cit> , assessment of the affymetrix 500k arrays in large cohorts is still needed.

finally, while some methods take advantage of the signals from a single or a group of snps across the population to predict cnv regions for each individual  <cit> , there are very few methods to merge individual cnv predictions into regions at the population level: redon et al.  <cit>  merged cnvs based on the extent of their overlap, whereas itsara et al. <cit>  manually annotated complex regions.

in the current study we followed two main goals: first, we performed an extensive survey of candidate cnvs in the colaus study as detected by snp genotyping microarrays. we provide a large dataset that can serve as a resource for other studies elucidating human structural variants, and for future association studies of cnvs with the clinical phenotypes measured in colaus. second, since the methods for detecting individual cnv profiles and merging those into consensus regions have not yet been well established, we developed new algorithms for cnv calling and merging, and devised novel techniques to evaluate and compare them with existing methods. specifically, we compared three existing cnv detection methods with our new method  that uses a gaussian mixture model to estimate the copy number dosage at each snp of each individual. gmm models the signal intensity at each snp across the entire population  which differs from hmm approaches like cnat  <cit> , cnag  <cit> , dchip  <cit> , penncnv  <cit>  and quantisnp  <cit>  that model the signal sample by sample along each chromosome. other gmm implementations have been successfully used in the past for bac and cgh array analyses  <cit> , but all these different methods  provide a discrete copy number value . it was also proposed to integrate in a single statistical model both the cnv classification and the association with binary traits  <cit> . their em algorithm estimates the copy number state probabilities, but only to use them internally for the association testing. similar to their approach, our gmm implementation produces  copy number dosage values that account for uncertainty in the prediction . however, our algorithm couples the calling with cnv merging and focuses explicitly on the copy number region  calls.

our gmm was successfully applied to both affymetrix and illumina arrays; and is not restricted to snp array analysis . we also developed two merging strategies, which were applied to create a map of cnv regions for each of the four cnv detection methods. we studied how cnvs predicted by the various algorithms coincided with previously reported variants. we also investigated the concordance in predicting cnvs in a subsample of individuals that were additionally genotyped on the illumina 550k snp chips. finally we compared the sensitivity and specificity of the different approaches using related colaus individuals which are expected to share more cnvs than unrelated individuals. based on these criteria, we demonstrate that our new method outperforms two established cnv detection algorithms and has higher sensitivity than a third method.

RESULTS
identification of copy number variants in colaus
detection
to detect cnvs in colaus, we applied four different cnv detection algorithms to the data from  <dig> caucasians generated with affymetrix 500 k microarrays: two implementations of the copy number analysis tool  that integrate the snp intensities by summing their raw  or log-transformed  values; circular binary segmentation  and our own algorithm based on a gaussian mixture model, to which we refer subsequently as gmm. we restricted our analysis to autosomes allowing us to use a mixture of males and females as the reference panel. using these four methods, we assigned copy number values to each probe and each colaus individual.  or above  a certain threshold, see methods for more details.)

merging
in the second step we attempted to reduce the complexity of these cnv profiles by merging adjacent snps that contained highly redundant information into cnv regions. the first method  joins neighboring snps  that have identical copy number values across all colaus participants . this simple approach already significantly reduced the number of snps . however, by nature, this simple scheme leaves the boundaries of cnvs fragmented. i.e. if two adjacent snps differ in copy number for at least one subject, they will not be merged together . thus we devised a refined method, which is based on a principal component analysis  and self-organizing maps . the pca identifies orthogonal components explaining a significant  fraction of the variance. including these components in clustering or multivariate analyses allows us to remove components that are likely driven by noise and to concentrate on those which, individually, explain a significant fraction of the data variability . we then used self-organizing maps  to cluster snps with similar ‘eigen-value profiles’ in cnv regions . for convenience, we refer to this approach as the ‘pca merge’.

post processing
next, we excluded any cnv regions found in fewer than five individuals, which roughly correspond to  <dig> % frequency. in this study, we considered all remaining cnvs  and we also distinguished between copy number polymorphisms  and the remaining ones  to which we refer as copy number variant regions . the numbers of cnps and cnvrs predicted by the four different methods and the two merging methods are shown in figure  <dig> . cnat.total and cbs are conservative methods that generate significantly fewer regions than cnat.allelic and gmm. the simple merging procedure produces many small regions  which are commonly integrated into fewer larger regions with the pca-based method . the pca-based merging method is able to reduce the total number of regions by 35%, 53%, 67% and 70% for gmm, cnat.total, cnat.allelic and, cbs, respectively.

the fraction of the  genome effectively covered by these regions is reported in additional file 1: table s <dig> . although gmm produces many more cnps than the other methods, they only cover about  <dig> % of the autosomes. cnat.allelic predictions for cnps cover  <dig> % of the autosomes, while cbs and cnat.total cover only  <dig> % and  <dig> % respectively. we also checked the coverage with rare variants , gmm had the lowest autosomal coverage of only  <dig> %, whereas cbs had the highest with  <dig> %. cbs predictions for cnps are rather conservative in the sense that cnps found with other methods are found for fewer individuals when using cbs . additional file 1: figure s <dig> shows the cnv profile on chromosome  <dig> as predicted by the different methods. this illustrates the dramatic differences between methods and the limited ability of cbs to detect cnps .

to further investigate at the differences between the four methods, we computed the intersection using cn prediction from 60k independent autosomal snps . only  <dig> % of the snps composing cnps were validated with at least three methods  . by contrast,  <dig> % of the snps in cnvrs were found in at least three methods and this number reached  <dig> % for at least two methods. next, we checked pair-wise comparison between the cnv methods . the maximal intersection between two methods is 47% and corresponds to the comparison between all cnvs from gmm and cbs. such relatively low overlaps are not uncommon with cnv analysis from snp genotyping arrays and underline the need for proper replication of any cnv predictions  <cit> .

in order to evaluate the different detection and merging algorithms, we used three different approaches:  a comparison with known cnvs from a public database,  a cross-platform validation using a subset of samples that were also genotyped on the illumina platform, and  similarity of related individuals with respect to their cnv profiles.

comparison with known cnvs
the database of genomic variants  is a curated catalogue of structural variation in the human genome. we downloaded its content  and kept only cnvs discovered from snp or cgh arrays . we complemented this dataset with predictions from itsara et al.  <cit>  and predictions from the high resolution cnv project  <cit> . this dataset of “known” cnvs included  <dig> autosomal cnvs, whose size ranged from 1 kb to 3 mb.

we then computed the overlap between this reference dataset and all cnvs  generated by each prediction method . the overlap is reported as the jaccard coefficient, which is the ratio between the the intersection and the union of two cnvs. a ratio close to one implies that the two cnvs have very similar boundaries; a ratio close to zero indicates a negligible overlap  and intermediate values correspond to partial overlap . since dgv contains cnvs from much fewer individuals than the colaus dataset, it was important to compare the distribution of overlaps with the cnvs generated by the different methods in a controlled setting. therefore we computed for each method the expected overlap using reshuffled data from  <dig> permutations. estimated p-values for observing more or less than expected cnvs with a given overlap are shown in figure 2a , and the relative excess of observed or expected counts is shown in figure 2b. we observed that all prediction methods were enriched with respect to the controls for known cnvs  and depleted for novel cnvs . analyses were also performed for cnps and cnvrs independently . except for cnat.allelic, all methods showed significant depletion in novel cnps. all methods showed significant depletion in novel cnvrs and significant enriched in known cnps and cnvrs.

validation with illumina arrays
dna from a subset of  <dig> colaus individuals was assayed on the illumina snp platform. in order to obtain a validation set of cnvs, we applied gmm and the pca-based merging algorithm to these data. note that cnat is specifically designed for affymetrix data so it could not be used here. to validate our cnv datasets as predicted from the affymetrix arrays, we selected those cnvs containing at least one individual that had been assayed on the illumina arrays. next, we computed for the overlap between those selected affymetrix cnvs and the validation cnv collection from the illumina arrays .

from our overlap analysis, we found that cnat.allelic predictions were not significantly different from random predictions . this indicates that cnat.allelic is too permissive and that the vast majority of its predictions are likely to be false positives. in contrast, cnat.total had a better specificity than cnat.allelic but identified much fewer cnvs compared to other methods . both cbs and gmm performed well . interestingly, gmm predicted many more cnvs than cbs and the bias with respect to predictions from reshuffled data was much stronger than for all the other methods . we also performed the above analyses independently for cnps and cnvrs  and arrived at the same conclusions.

predicting relatedness between individuals based on their cnv profile
pairwise ibs analysis  of the colaus genotypes revealed that five individuals had been genotyped twice and the study also included  <dig> pairs of first-degree relatives . using this information, we investigated whether predicting the relationship between these individuals would be feasible using exclusively their inferred cnp profiles. to this end we computed the euclidean distance between the cnv profiles individuals belonging to  <dig> related pairs and between individuals in  <dig> randomly selected pairs. knowing the true relationship status, we computed precision-recall  curves for each cnv prediction method and for each merging approach . to evaluate the robustness of these pr curves we reiterated the analysis  <dig> times with randomly chosen pairs of unrelated individuals.

all methods had significant prediction power with precision-recall area under the curve  values > <dig> . only the relaxed cnv detection method cnat.allelic did not show a significant difference between the pca-based and the simple merging approach . interestingly, for all other methods, there was a clear performance advantage of the pca-based over the simple merging method. also, these three cnv detection methods, post-processed with the pca merge, performed better than cnat.allelic. interestingly, gmm and cnat.total had the best pr-aucs . rank sum analyses did not identify significant difference between gmm and cnat.total pr-aucs. . we checked whether changing the cnv frequency filter and excluding small regions  would improve the performance . for all methods, there was no significant difference when excluding or keeping such small regions. for cnat.allelic, there was some small improvement when increasing the filter on the cnv frequency, whereas there was no significant change for cnat.total and cbs. apparently, the rather few cnv predictions by cnat.total are of good quality for predicting relatedness as reflected by the high pr-aucs . indeed, gmm, which is less conservative, profits from using a filter on cnv frequency significantly, improving its auc. this improvement is particularly strong in combination with the pca merge.

discussion
in this work, we analyzed cnps and rare cnv regions within the colaus population using four different copy number detection methods and applying two different merging procedures. we also devised various validation strategies to compare the performance of these methods.

properties of the pca merging technique
the simple merging approach is able to concatenate about half a million snps into a few thousands regions. yet, this naïve technique requires discrete copy number predictions and leaves cnv edges fragmented into regions of few or even single snps. therefore we developed a novel merging method, based on a pca and som which, provides a strong improvement over the simple approach as it significantly reduces the number of single snps by re-attributing them to larger regions. also, small regions  were extended either by incorporating single snps or by merging them with other small regions.

this new method provides a powerful alternative to the so-called “merge by overlap” method , commonly used in cnv studies. an inherent limitation of the mbo method is when the underlying cnv is predicted as two distinct regions . also the mbo requires to discretize cnv predictions , which results in a significant loss of information . our pca-merging method allows 1) reconciliation of ‘disrupted’ cnvs, 2) to consider the predicted copy number value without loss of information due to subsequent discretization  and 3) to ignore  variation likely induced by noise in the measurement. our pca-merge can thus be useful to process the copy number dosage data matrix  and obtain a smaller matrix  for subsequent association studies with a given clinical trait.

comparison of the different cnv prediction methods
we demonstrated that cnat.allelic predicts a large number of cnvs. yet only a relatively small fraction of these could be replicated, indicating that most of the predicted cnvs are likely to be false positives. this is also supported by the fact that cnv profiles generated by cnat.allelic performed worse in predicting kinship. in contrast, cnat.total appears to be overly conservative and is likely to miss subtle, but real cnv events. hmms are very popular for cnv analysis but our findings underline the difficulty of using parameters that are applicable to different datasets. ideally, the hmm parameters would need re-evaluation with each novel dataset, which can become tedious in the absence of a ground truth. an obvious improvement of cnat would include refining hmm transition parameters with bayesian methods and to co-analyse multiple samples thus improving parameter estimation by combining data across individuals. in addition, summing allelic intensities in the log space  is adding considerable noise to the cn ratios and thus should be avoided.

based on our comparative analyses we find that cbs is a robust segmentation algorithm, confirming reports by several independent studies  <cit> . although our gmm method, does not explicitly account for probe auto-correlation or allelic intensity ratios, it performs much better than the two cnat implementations: it recalls more illumina cnvs  while being depleted in ‘novel cnvs’ with respect to the shuffled controls. gmm and cnat.total also perform equally well at predicting relatedness between individuals. in addition, gmm does not need pre-estimated parameters; the mean and variance of each mixture component  are updated from the data using constrained nonlinear optimization  <cit> . finally, we observed that our model was able to detect many more cnps than cbs, suggesting higher sensitivity.

currently our model only considers deletion, copy neutral, single copy or multiple copies. since very few homozygous deletions were observed with other applied algorithms, we did not use such a dedicated component in our analysis. nevertheless, our gmm implementation allows for such an extension.

validation of cnvs in a large clinical cohort
validation is an essential part of any cnv discovery project. pcr, southern blot and many other targeted techniques are useful to predict accurately the copy number at a given locus, but low throughput is a severe limitation when large numbers of cnvs need to be validated. the database of genomic variants is a valuable resource and is useful to compare the ‘known’  cnvs that can be recalled in a large cohort using different methods. however due to the high heterogeneity between studies  and to the absence of medical ascertainment of the subjects, dgv cannot be used to ‘validate’ cnvs  and must not be used to assess the clinical impact of a given cnv. instead, for large-scale cnv discovery studies, replicating a number of individuals  on an independent array platform is a viable option. with the recent reduction in the cost of microarrays, such large-scale replication now becomes affordable. in the context of cnv association with clinical traits, further validations are necessary and would include replication of the association signal in independent cohort  as well as cnv validation  in probands. as a complement to replication experiments, one can take advantage of the relatedness between individuals. deciphering relatedness  can easily be achieved by applying simple method-of-moments approaches  <cit>  to the snp genotypes. we show that assessing how well the relatedness can be predicted based on the cnv profiles is a powerful technique to gauge the quality of a cnv calling and merging method.

CONCLUSIONS
the combination of our gmm and pca merging algorithms is a useful tool to identify cnvs. they have been successfully applied to a large clinical cohort. the techniques involved here are not limited to data from snp arrays, they require as input only a matrix of hybridization ratios  or copy number values . thus they can be applied to data from other platforms such as cgh arrays. although gmm-like approaches are simplified versions of hmms, these are simpler to optimize  and remain powerful tools for the analysis of both large cohort  and complex dataset, as we recently demonstrated with melanoma  <cit> .

despite significant improvements in cnv detection and analysis when using the most recent snp arrays , there are still many large medical cohorts where snp data have been collected but cnv analysis has not been reported. this concerns both complex diseases  and cancer . hundreds of thousands of individuals have already been genotyped on 500k affymetrix or 550k illumina snp chips, but the corresponding data have not been used for cnv analysis, simply because it is a much more challenging task due to the lack of well-established algorithms and protocols. we hope that the present work will make it easier for researchers to make better use of their data for cnv calling.

gwas have demonstrated that the genetic variance cannot fully be attributed to snps. for example, for highly heritable traits such as height , snps only explain 10% of the variance  <cit> . it has also been shown that, for common traits, the large fraction of heritability cannot be accounted for by cnps  <cit> . thus the identification of rare cnvs with stronger clinical impact, as we recently demonstrated for obesity  <cit> , can open up new avenues to explore. meta-analysis of existing cohorts for cnvs gives more power to detect rare cnvs because unique cnvs in a single cohort can then be supported by different cohorts. but such meta-analyses cannot be used to identify small variants due to the poor snp density. in such cases, individuals with rare variants should be investigated further with higher density arrays or with genomic sequencing.

with the recent cost reduction in next generation sequencing , full-genome and exome sequencing become possible even for large cohorts . already data from several large studies can be retrieved  <cit>  and many different algorithms have been developed to mine indels and cnvs  <cit> . although our gmm method might be applied to predict copy number from sequencing read-depth, it was not developed to this aim. the current matlab implementation may not be optimal  and the gaussian modeling may not be the best option for such analysis . nevertheless, our pca merge could be useful for ngs data analyses. these analyses generate massive amount of variants, among which there can be a high number of false positives. also the predicted variants differ greatly in size  and their boundaries  change between subjects. to some extent, this is similar to the different challenges that occurred in our colaus analyses. therefore our pca-merge method that is designed to identify consensus cnv regions in large and complex dataset could be of use in the post-processing of ngs structural variants.

