BACKGROUND
the t cell, a specialized type of immune cell, continuously searches out proteins originating from pathogenic organisms, such as viruses, bacteria, fungi, or parasites. the t cell surface is enriched in a particular receptor protein: the t cell receptor or tcr, which binds to major histocompatibility complex proteins  expressed on the surfaces of other cells. mhcs bind small peptide fragments derived from both host and pathogen proteins. it is the recognition of such complexes that lies at the heart of the cellular immune response. these short peptides are known as epitopes. although the significance of non-peptide epitopes, such as lipids and carbohydrates, is now understood increasingly well, peptidic b cell and t cell epitopes  remain the primary tools by which the intricate complexity of the immune response might be examined. while the prediction of b-cell epitopes remains primitive  <cit> , a multiplicity of sophisticated methods for the prediction of t-cell epitopes has developed  <cit> .

the earliest efforts in predicting the binding of short peptides to mhc molecules focused on identifying peptide sequence motifs that were characteristic of binding to mhc  <cit> . this motif approach assumed that the presence of certain residues at specific positions  critically defined the binding ability of the peptide to the mhc. this somewhat simplistic assumption rendered the motif approach prone to false predictions. later methods adopted more informative representations of peptide binding and more sophisticated modeling strategies such as position-specific scoring matrices   <cit> , artificial neural networks   <cit> , hidden markov model   <cit>  and support vector machine  classification  <cit> . with increasing amounts of mhc-peptide binding data available to facilitate their optimization, these methods have become increasingly effective in making predictions about whether a given peptide binds to a particular mhc molecule, and – when it does bind – whether the binding is strong or weak.

recently, the modeling of mhc-peptide binding has come to emphasize quantitative predictions: instead of categorizing peptides as "binders" or "non-binders" or as "strong binders" and "weak binders", several new methods make predictions about the precise binding affinities . the additive method developed by doytchinova et al. is a representative example of this trend. in this method, the binding affinity of the mhc-peptide interaction is modeled as the sum of peptide background contribution , the amino acid contributions at each position, and  the adjacent peptide side-chain interaction  <cit> . the additive method has been shown to be effective in modeling mhc-peptide binding for a range of human and mouse class i mhc molecules, and, using an iterative extension, also a set of human and mouse class ii alleles  <cit> . additive method models not only provide more precise information about the binding reactions, but also demonstrated enhanced accuracy in the prediction of untested peptides compared to other prediction methods such as syfpeithi, bimas and rankpep  <cit> .

in this paper, we shall explore how potential improvements might be made in quantitative immunoinformatic techniques, such as the additive method. first, utilizing non-linearity, since properly chosen non-linear models can, in describing complex systems, often out-perform linear models. second, the use of a more informative scheme for encoding amino acids since most immunoinformatic methods encode amino acids by their identities using indicator variables, information concerning similarities in physicochemical properties between the  <dig> amino acids is typically neglected.

support vector machines  are a class of learning based non-linear modeling techniques with proven performance in a wide range of practical applications  <cit> . originally, svms were developed for classification or qualitative modeling problems. with the introduction of an ε-insensitive loss function, svms have been extended to solve nonlinear regression  problems. in this study, we employed the svm regression  technique to model mhc-peptide binding affinities for three mouse class i mhc alleles . we name this new modeling method svrmhc. in svrmhc models, peptides were described using a new 11-factor encoding scheme. this takes into account a number of important physicochemical parameters of the  <dig> amino acids . these svrmhc models demonstrated consistently better performance than linear methods in terms of describing power, self-consistency, and prediction accuracy. moreover, comparisons between our svr models and several other popular prediction tools indicated that the svrmhc models performed best in identifying strong binders to mouse class i mhc molecules.

the datasets used in this study, and the online implementation of the svrmhc models for the three mouse class i alleles, can be accessed on the supplementary web site  <cit> .

RESULTS
svr model parameter optimization
for the training of the svr models, one kernel parameter , and two kernel-independent parameters  need to be determined ). there are no commonly agreed methods for determining optimal svr model parameters. in most published svr studies we have examined, these model parameters were determined one at a time, by first fixing all other parameters, then letting the parameter take a range of different values, and thus identifying the value that corresponds to the best model performance assessed by cross-validation  <cit> . this method, though efficient in terms of execution time, disregards potential interactions between different model parameters. cherkassky and ma  <cit>  advocated picking two of the three svr model parameters  from training data based on characterizations of the data, such as noise level and sample number. this method, though theoretically sound, did not, in our hands, always find the best set of parameters. in this study, we adopted a parameter selection procedure that combines the method of cherkassky and ma's with a grid-search. for ε and c, we first calculated the "recommended value" using cherkassky and ma's formulas, then searched a parameter range from 1/10th of the recommended value to  <dig> times the recommended value. the kernel parameterγ does not depend on the datasets. we picked a search range for γ as , which safely covered the γ ranges commonly used in the literature  <cit> . after setting search ranges for the three parameters, we undertook a grid-search through the three-dimensional parameter space. for each parameter, four, six or eight equal-sized steps  were taken in the grid-search.

the h2-kk dataset includes a large number of peptides , and five-fold cross-validation was performed to find the optimal parameters for the h2-kk model . the other two datasets – h2-db and h2-kb – contain fewer peptides , thus a finer grained  loo cross-validation was used to search for optimal parameters for the models of these two mhc molecules. this loo cross-validation is part of the model parameter search, and it should not be confused with the loo cross-validation used in assessing the model performance . the combination of the three parameters, γ, ε and c that leads to the smallest root mean square  error was taken as the optimal parameter combination. the rms error is calculated as the following:

rms=∑i=1n2n,     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgsbgucqwgnbqtcqwgtbwucqgh9aqpdagcaaqaamaalaaabawaaabcaeaacqggoaakcqwgwbaccqwgjbqscqwgdbwqcqai1aqncqaiwaamdawgaawcbagaemyaakgabeaakiabgkhitiabdchawjabdmeajjabdoeadjabiwda1iabicdawmaadaaaleaacqwgpbqaaeaacqggqagkaagccqggpaqkdaahaawcbeqaaiabikdayaaaaeaacqwgpbqacqgh9aqpcqaixaqmaeaacqwgubgba0gaeyyeiuoaaoqaaiabd6gaubaaasqabagccqggsaalcawljagaaczcamaabmaabagaegymaedacagloagaayzkaaaaaa@510e@

where n is the number of peptides in the dataset, pic50i and pic50i*
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgwbaccqwgjbqscqwgdbwqcqai1aqncqaiwaamdaqhaawcbagaemyaakgabagaeiokaocaaaaa@3489@ are the predicted and experimentally measured pic <dig> values for the ith peptide, respectively. the final model parameters for the three mhc molecules were determined via voting among the set of optimal parameters during cross-validated model training. these parameters are presented in table  <dig> 

svrmhc models performed better than linear models in quantitative predictions
the svrmhc models constructed for the three mhc molecules demonstrated consistently better performance than linear models built from the same datasets.

the h2-db dataset consisted of  <dig> nonamer peptides and associated binding affinities. we compared the svrmhc method to the additive model, taken as typical of linear methods, as shown in table  <dig>  following a step-wise outlier exclusion procedure, the svrmhc method determined and removed  <dig> outliers at a  <dig>  log unit residual cut-off , while the additive method removed  <dig>  the smaller number of outliers determined by the svrmhc method suggests that this method has more "descriptive power" than the additive method. the self-testing model constructed using the svrmhc method resulted in an r <dig> of  <dig>  when the entire dataset was considered , and an r <dig> of  <dig>  was obtained after the outliers were removed, compared to additive model r <dig> values of  <dig>  and  <dig> , respectively. the ar values of the svrmhc model with and without outliers were  <dig>  and  <dig>  respectively, smaller than the corresponding additive ar values of  <dig>  and  <dig> . the most interesting performance metric is perhaps the loo cross-validated q <dig>  as it is more indicative of prediction performance when tested on unseen data. q <dig> for the svrmhc method was  <dig> . this is higher than the additive loo cross-validated q <dig> value of  <dig> .

the h2-kb dataset consisted of  <dig> octamer peptides and associated binding affinities . with svrmhc, the step-wise outlier exclusion procedure determined and excluded  <dig> outliers, compared to  <dig> outliers removed by the additive method. the self-testing model constructed using the svrmhc method produced an r <dig> of  <dig>  for the entire dataset , in contrast to the r <dig> of  <dig>  produced by the additive model. an r <dig> of  <dig>  was obtained with svrmhc after the  <dig> outliers were excluded, which was lower than the r <dig> obtained by the additive model  after the exclusion of  <dig> outliers. the ar of the svrmhc model for the entire dataset  was  <dig>  and the ar of the additive method was  <dig> . however, the ar of the svm model after the  <dig> outliers were removed  was higher than the ar of the additive model after  <dig> outliers were removed . the loo cross-validated q <dig> of the model constructed with svrmhc was  <dig> , slightly higher than the additive loo cross-validated q <dig> of  <dig> . these results indicated that for the h2-kb dataset, svrmhc produced models that had higher descriptive power and prediction accuracy, though the self-testing model exhibited lower level of self-consistency after the outliers were removed.

the h2-kk dataset is the largest of the three datasets, consisting of  <dig> octamers and associated binding affinities. no outliers were excluded compared to  <dig> outliers using the additive method. this, again, suggests that the svrmhc method has higher "descriptive power" than linear methods. the self-testing additive model produced an r <dig> of  <dig>   and  <dig>  . the self-testing svrmhc model gave an r <dig> of  <dig> . since no outlier was determined, there is only one r <dig> calculated. the ar for the svrhmc model was  <dig> , compared to the additive model, which gave  <dig>  for the entire dataset and  <dig>  after the outliers were removed. the loo cross-validated q <dig> for svrmhc was  <dig> , compared to an additive loo cross-validated q <dig> of  <dig> .

svrmhc models out-performed other methods in identifying strong binders
we compared the performance of svrmhc to that of existing prediction tools for mhc-peptide binding: the additive method, syfpeithi  <cit> , bimas  <cit> , rankpep  <cit> , and svmhc  <cit> . at first, we attempted a strategy described in  <cit> : trying to find recent literature reports of new peptide binding experiments for the three mouse class i mhc molecules. the hope was that predictions could be made for these binding experiments using both the svrmhc model and the other methods, and a concomitant comparison in prediction accuracy could be made. however, this strategy was not successful, because in most recently-published binding experiments pre-screening with prediction tools was used. this was most often syfpeithi and sometimes bimas  <cit> . only the peptides predicted to be strong binders were tested experimentally, and peptides not predicted to be strong binders were disregarded. moreover, false predictions  were sometimes not reported  <cit> . it is not surprising that prediction tools used in pre-screening  always performed better in identifying good binders in these published studies .

thus, we applied another scheme for making comparisons between the svrmhc method and other prediction methods – by using receiver operating characteristic  analysis  <cit> . the prediction performance of any classification-type model can be assessed using the combination of two properties – specificity and sensitivity. the sensitivity vs.  relationship is referred to as the roc relationship . in a roc curve, the two axes both have a range of  <cit> , therefore the area under a roc curve  also takes a range of  <cit> . a purely "random guess" prediction model would have an aroc of  <dig> . for better models, aroc would be higher than  <dig> . the closer aroc is to  <dig>  the better the performance is for the predicting model.

in the mhc ligand database mhcbn  <cit> , we downloaded all nomamer ligands for the h2-db molecule and all octamer ligands for h2-kb and h2-kk. these peptides were grouped into two groups: "strong binders" and "weak binders" . for h2-db, there were  <dig> strong binders and  <dig> weak binders, and for h2-kb, there were  <dig> strong binders and  <dig> weak binders. no weak binders were retrieved for the h2-kk, thus no roc analysis was conducted for this allele. the scores generated by these different prediction methods have very different meanings. the scores produced by the svrmhc models and the additive models are predicted pic <dig> values, while scores from bimas are predicted half lives. rankpep outputs scores calculated from a pssm  profile. the scores produced by syfpeithi are nominal scores. they are generated by differentially scoring matches, within an individual peptide, to primary and secondary anchors within the target motif. thus, they represent how close a particular peptide is to the expected pattern of a motif. the scores produced by svmhc, on the other hand, are the distances between the peptides and the separating hyperplane defined by the svm model. despite the different meanings of these scores, they all roughly approximate increasing functions of predicted binding strength, therefore the areas under the roc curves can be used as an objective measure of prediction performance.

predictions were made for each peptide sequence using the corresponding svrmhc model, the corresponding additive model, as well as the four online predicting tools syfpeithi, bimas, rankpep and svmhc, and the scores were used to make the roc plots . the svrmhc models for the h2-kb and h2-db molecules rendered aroc of  <dig>  and  <dig> , respectively, higher than the aroc of any of the other predicting methods, indicating that, in this test, the svrmhc models performed best compared to the other four prediction methods in identifying strong binding peptides for the mouse class i mhc molecules.

discussion
accurately predicting the binding between short peptides and mhc molecules remains a major task for immunoinformatics. quantitative prediction of exact peptide binding affinity represents the most recent development in the field. quantitative prediction is a finer-scale description of binding, and the ability to construct effective quantitative models manifests an improved understanding of the mechanism of mhc-peptide interactions. there have been two reported approaches to quantitative prediction of mhc-peptide binding. the first approach makes use of 3d qsar  techniques, and models the interaction between the peptide and the mhc molecule using cosmsia   <cit> . this approach, though accurate, requires structural knowledge about how the peptide and the mhc molecule interact with each other in 3d space. the second approach to quantitative modeling is the bioinformatics approach, including the additive method and the svrmhc method presented here. in contrast to 3d-qsar, this approach uses only peptide sequences as their input, and does not require any 3d structural information. this property makes the bioinformatics methods more straightforward and generally applicable. particularly, they are more suitable for modeling the binding of less studied mhc molecules for which no 3d structural information is available.

linear models, as exemplified here by the additive method, has previously demonstrated impressive performance in modeling a variety of mhc-peptide binding systems: the human class i allele hla-a* <dig>  <cit> , the mouse class i mhc alleles  <cit>  and the human class ii allele drb1* <dig>  <cit> . however, as is generally known, properly chosen non-linear models can often out-perform linear models in describing complex systems, although linear models can often be more intuitive and easily understood. also, in many immunoinformatic techniques, including the additive method, amino acid residues are encoded by their identities, and the physicochemical properties of the amino acids are ignored. in this study, we have addressed both problems. the use of a non-linear svr technique leads to an enhancement in predictivity. meanwhile, the adoption of an 11-factor encoding of amino acids renders the resultant models sensitive to similarities in important physicochemical properties among the residues in the peptides being modeled.

support vector machines  are a new class of learning machines motivated by statistical learning theory  <cit> , and they are gaining popularity because of their theoretically attractive features and profound empirical performance. several reports have been seen in the literature where svm classification models were developed to analyze peptide binding profiles qualitatively  <cit> ; yet, to our knowledge, the current report is the first reported quantitative modeling study in which the svr technique has been applied to model peptide binding.

in this study, we constructed svrmhc models using the binding data of three mouse class i alleles , and compared the resulting models to a linear models, built using the additive method, constructed using the same datasets. the models constructed with svrmhc have been shown to be superior to those constructed with linear methods, in terms of descriptive power , prediction accuracy , self-consistency , and overall precision in prediction . although an improved performance was seen in all three svrmhc models, the levels of improvement differed between the models constructed for the three mhc alleles. there seems to be a positive correlation between the amount of improvement achieved by the svrmhc models and dataset size. with the largest of the three datasets – the h2-kk dataset , the svrmhc method demonstrated the greatest level of improvement. the loo cross-validated q <dig> increased from  <dig>  to  <dig> . with the two smaller datasets – the h2-db dataset  and the h2-dk dataset  – the loo cross-validated q <dig> increased from  <dig>  and  <dig>  for the additive models to  <dig>  and  <dig>  for the svrmhc models, respectively, marking a smaller improvement than for h2-kk. when we looked at the self-consistency measure, with the two larger datasets , the svrmhc models consistently demonstrated higher levels of self-consistency than the linear models for the entire datasets as well as for the datasets after removal of outliers. for the smallest dataset, h2-dk, although the svrmhc model produced a higher r <dig> than the corresponding linear model for the entire dataset ; after outliers were removed, the svrmhc model produced a lower r <dig> than the additive model did . the same trend is true for the ar measurement. for the two larger datasets , the svrmhc models consistently produced lower ar values than the additive models for both the entire datasets and for the datasets after removal of outliers. however, for the smallest dataset , the svrmhc model produced a lower ar than the additive model for the entire dataset , but a higher ar than the additive model after the removal of outliers . these observations suggest that the svrmhc approach may become more accurate as datasets grow.

in constructing the svrmhc models, we applied the same step-wise outlier determination and exclusion scheme as used in  <cit>  to ease the comparison between the svrmhc and the additive methods. there are disagreements in the outliers determined by the two methods following the same step-wise outlier determining procedure :  <dig> out of the  <dig> "outliers" determined by svrmhc were also identified as "outliers" by the additive method for h2-kb; only  <dig> out of the  <dig> "outliers" determined by svrmhc was classified as an "outlier" by the additive method for h2-db. these disagreements suggest that this outlier detection procedure may not be most accurate in identifying "true outliers" that reflect experimental errors. however, the main focus of this study is to demonstrate the performance of the svrmhc method in comparison with other methods, therefore, it is justifiable to follow the same data pre-processing procedure as for the additive method for the sake of performance comparison. it is worth noting that after the model construction, the performance of the models was also examined on the whole dataset with the "outliers" added back, and svrmhc consistently demonstrated higher accuracy than the linear method in the models constructed for all three alleles , table 2).

it is interesting to investigate whether the performance improvement of svrmhc over the additive method is primarily due to the svr modeling technique, or it is primarily attributed to the 11-factor encoding scheme for the peptide sequences. we constructed svr models with the "sparse encoding" scheme following the same outlier exclusion procedure as used in the additive models and the svrmhc models, and compared the three in their performance. as shown in table  <dig>  the "svr + sparse encoding" method showed prediction performance that is between those of the additive and the svrmhc methods for two of the three alleles – h2-db and h2-kk. for h2-db, "svr + sparse encoding" achieved a similar loo cross-validated q <dig>  to that of svrmhc , but it excluded a larger number of outliers than svrmhc . for h2-kk, "svr + sparse encoding" achieved a loo cross-validated q <dig> of  <dig> , which is between the loo cross-validated q <dig> values of the additive  and svrmhc method ; and it excluded  <dig> outlier, also between the additive method  and svrmhc . this seems to suggest that both the svr modeling technique and the 11-factor encoding scheme contributed to the superior performance of svrmhc. however, we were surprised to see that the "svr + sparse encoding" model for h2-kb performed worse than both the svrmhc model and the additive model , which is difficult to interpret. in order to be conclusive on this issue, models for a larger number of alleles need to be constructed and used in comparison; and this we intend to do in the near future.

the roc analysis allows us to compare of several prediction tools for mhc-peptide binding: svrmhc, the additive method, syfpeithi, bimas, rankpep and svmhc. our roc analysis indicated that the svrmhc method, with an average aroc of  <dig> , was the most accurate in identifying strong binders for the two mouse mhc molecules h2-db and h2-kb. it is followed by syfpeithi and the additive method . svmhc , bimas  and rankpep  were less accurate than the other three methods we compared. we need to stress, though, that this comparison is based on the models constructed for only two mhc molecules, and this rank order may not be true in the general case.

questions may be raised about the fairness of the roc-based comparison, because there are overlaps between the mhcbn data used in the roc analysis and the data used in model construction for all five methods we compared. ideally, a comparison based on a totally independent dataset, one with no overlaps with the data used in the model construction of any of the five methods, would be desirable. however, without information about what peptides were used in the model construction of the syfpeithi, bimas, rankpep and svmhc methods, we believe it likely that there are higher levels of overlaps between the datasets used in model construction of the three qualitative models than those used for the two quantitative methods – additive and svrmhc – because qualitative data are much more abundant than quantitative binding data. nevertheless, we removed all peptides in the test datasets that overlapped with the datasets used in the construction of the additive and svrmhc models  and conducted a roc-based comparison using the remaining data . this is a very "unfair" comparison, because overlapped peptides for the additive and svrmhc models were removed, but those for the other methods were not. yet, the results indicated that the svrmhc model for h2-kb  still out-performed the models for all other methods; and the svrmhc model for h2-db, though did not achieve as high aroc as bimas  or rankpep , but was still close to them .

despite their encouraging performance, svr-based models reported here also exhibit some disadvantages. most notably, these models are "black box" models, and are poorly interpretable. we cannot infer, for example, which peptide positions are the most important in determining the strength of the mhc-peptide binding. not that this necessarily obviates the utility of svrmhc models as an immunological tool.

currently, we are working to improve further svr-based modeling methods, focusing on testing different combinations of physicochemical properties in the feature encoding scheme. we also plan to construct mhc-peptide binding models for other mhc molecules hosted in the antijen database  <cit>  and to make these prediction models available online. in the next phase of this project, we will adapt the svr-based methodology to the more challenging task of predicting the mhc-peptide binding of class ii mhcs.

CONCLUSIONS
in this paper, we demonstrated svrmhc, a svr-based quantitative modeling approach to model peptide-mhc binding affinities, and showed that svrmhc is a promising immunoinformatics tool with not inconsiderable future potential. with the ongoing, rapid development of high-throughput functional proteomics technologies, such as peptide microarray technology, the svr modeling approach is expected to see broader use in modeling mhc-peptide binding, and protein-peptide binding reactions in general.

