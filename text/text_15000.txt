BACKGROUND
dna microarray technology is a key application in pharmaco- and toxicogenomics, a field identified in the u.s. food and drug administration  critical path initiative  as a major opportunity for advancing medical product development and personalized medicine. it is expected that the review of microarray-based medical devices and microarray data will become an essential regulatory responsibility for the fda. a single microarray experiment generates a large volume of data and the management, analysis and interpretation of this data challenge both sponsors and regulatory reviewers. realizing that the integration of these three essential components into one single application will help to realize the full value of this exciting technology, fda's national center for toxicological research developed arraytrack <cit> , a fda free bioinformatics resource providing an integrated solution to manage, analyze, and interpret microarray data and the extension to systems biology data. arraytrack has been utilized by fda for the review of genomic data submissions .

the primary emphasis of arraytrack is the direct linking of analysis results with functional information for facilitating the interaction between the choice of analysis methods and the biological relevance of analysis results. by selecting one of the analysis methods, the arraytrack user can directly link analysis results with functional information such as biological pathways and gene ontology. goffa  is the primary biological interpretation tool using gene ontology   <cit>  in arraytrack.

go contains a complex and rich information, posing a challenge in developing statistical and visualization tools to effectively/efficiently utilize and present the information. many approaches have been investigated to facilitate interpretation of gene expression data using the go resource  <cit> . most freely available go tools are documented on the go website . these tools are useful to browse and view the go context when interpreting genomic and proteomic data. however, some do not provide text-annotated go tree structures , or do not retain the fundamental go hierarchical tree structure , or are only microarray specific , or has operating system dependency limitation . khatri et al  <cit> , zeeberg et al  <cit>  and zhang et al  <cit>  did extensive comparisons of various go-based tools.

statistical analysis and visualization capabilities are the most important components of any go tool. statistical analysis is focused on determining the significant or enriched go terms. the hypergeometric distribution  <cit> , chi-square  <cit>  and fisher's exact test  <cit>  are three most commonly used enrichment methods. recently, the relative enrichment factor is also introduced by zeeberg et al  <cit> . reducing go information to a comprehendible subset based only on statistics alone is unsatisfactory without the aid of visualization. thus, visualization of the go hierarchy becomes another important part of the functionality for a useful go tool. it is highly desirable that a complex query can be directly made to the visually displayed tree to fully integrate statistics and visualization for efficiently mining the go data.

here we report the goffa software that is designed to further the ability of utilizing go for interpreting microarray data. goffa provides most commonly used statistical functions in an interactive and user-friendly environment. two effective functions in particular, go path and go treeprune, were implemented in goffa. unlike other statistical methods that consider each go term separately by ignoring the hierarchical nature of go in the enrichment analysis, go path identifies the significant terms based on the go hierarchical tree path using the fisher's inverse chi-squared method  <cit> . go treeprune is an interactive tool providing statistical means to adjust and reduce the complexity of go hierarchical tree information in the form of the node-like visualization. as an integrated component of arraytrack, goffa has been used in the fda to interpret both genomic and proteomic data submitted by the sponsors through the voluntary genomics data submission  mechanism .

methods
goffa's core programming is based on the client-server model. the client is written in java, runs on platforms with the java run-time environment  <dig>  or higher. the server is oracle. goffa is an integrated component of arraytrack, but also can be operated as an independent tool. figure  <dig> shows the program logical structure.

goffa database
goffa uses an oracle database containing the go project data together with gene identifiers for human, mouse and rat from the ncbi entrez gene database . the database currently contains  <dig>  mouse,  <dig>  human and  <dig>  rat genes. the genes from these three species can also be combined in analyses using the "cross-products" feature, where the same gene symbols from human, mouse and rat  are considered to share the same functional annotation in go; in this case, the goffa database contains  <dig>  unique gene symbols for cross species annotation.

goffa tree
data from the go website are downloaded in a structure called a directed acyclic graph , a name that denotes an unclosed structure where a particular child node associated with a go term can have multiple parent nodes. goffa converts the dag structure to a tree structure by constructing distinct paths from the highest parent node , successively down through progeny to the lowest  child node. in converting the data, goffa maintains the go database's so-called true path rule by assuring that a gene product go term applicable to a child node also applies to all parent terms. thus, during the conversion to a tree structure, the dag structure for each go term can become many separate traversals from highest parent to lowest child. each such traversal in goffa is called a goffa tree path, and each node along a goffa tree path is assigned a unique identification called a goffa id. consequently, the same go term occurring in different goffa tree paths has a distinct goffa id in each path. the restructuring of go information in the goffa tree path format not only markedly speed up database queries but, most importantly, enable developing two unique utilities, go path and go treeprune .

statistical analysis
a fundamental step in analyzing dna microarray data is to determine the differentially expressed genes  for subsequent biological interpretation. goffa applies three statistical approaches to determine the significant go terms for a given list of degs, two previously reported methods and one novel approach:

• fisher's exact test – a right-sided fisher's exact test  is used to estimate the statistical significance of go term i. four lists of genes are needed to calculate the significance : the number of inputted genes   <cit> , the subset of m genes that belong to go term i , the set of reference genes  and the subset of n genes that belong to go term i . the accuracy of p-value is largely dependent on the choice of the set of reference genes. there are two options in goffa to determine n, depending on whether the genes derived from a known gene or not. for a known microarray chip, n is the total number of genes on the chip; in this case, p-value less than  <dig>  normally is indicative of a statistically significant finding. goffa provides information associated with most commercial array platforms, including most genechip platforms from affymetrix, most one- and two-channel array platforms from agilent, as well as numerous other array platforms such as those from ge healthcare codelink, illumina beadarray, and applied biosystems arrays, etc. if the microarray chip's genes are unknown, the total number of genes in the goffa database is assigned as n. in this case, the choice of n is dependent on the selected species, currently,  <dig>  genes for mouse,  <dig>  for human,  <dig>  for rat, and  <dig>  if combining all three species. thus, the selection of n is an important factor to interpret p-value.

• relative enrichment factor – goffa also calculates the relative enrichment factor  for assessing the significance of go term i for a given list of degs  <cit> . the e-value is calculated as:

e = /     

where mi, m, ni and n are defined the same as for fisher's exact test described in the preceding paragraph. e provides a direct measure of the prevalence of a go term i among the m significant genes compared to the prevalence of the same go term i among n total genes. accordingly, e =  <dig>  corresponds to go term i occurring among the degs at the same prevalence as among the n total genes. e =  <dig>  indicates that go term i occurring in the degs two times more than occurring in the n total genes, indicating significant findings.

• goffa tree path ranking – criteria based on fisher's exact test and/or relative enrichment factor sometimes fail to sufficiently condense and clarify results for effective interpretation, especially for large lists of significant genes. this provided the motivation of developing this unique function in goffa. the method applied the fisher's inverse chi-squared method  <cit>  to sort goffa tree paths in accordance with their likely significance, and then renders an interactive graphic display for visualization and interpretation. the fisher's inverse chi-square method uses the fact that given a uniform distributed p-value, -2log has a chi-square distribution with two degrees of freedom, and hence the statistic



follows a chi-square distribution with 2k degrees of freedom when the joint null is true. in our case, pk is the fisher's exact test probability value of go term k and k is a total number of go terms within the traverse of the goffa tree path from the upper level of the tree down to go term i. thus, ri is a relative metric of the prevalence of a goffa tree path from the upper level to the level go term i belongs, given that the pk values are known for each go term on the path. the greater the value of ri, the less likely it is that the significance of a goffa tree path is a chance occurrence.

availability
goffa is available through arraytrack software .

RESULTS
goffa features
the goffa's software gui, shown in figure  <dig>  has three panels with different functions that are designed for intuitive and interactive use. the left panel  is for queries, the center panel  for tabular and/or graphical displays of and for interaction with the go information, and the right panel  lists the individual genes associated with the go information presented in the center panel.

queries are initiated in the left panel by pasting deg id's into the query window, one gene per line. the input gene id's must correspond to the "select data type" option chosen by the user. currently, goffa supports four types of gene identifiers:  genbank accession number,  unigene id,  locuslink id  and  gene name. in addition, goffa supports two protein identifiers, ipi id  and swiss-prot accession number for proteomics data analysis. the goffa database currently contains go annotation data for  <dig> microarray platforms that, with the "select array type" option, is coupled with the go analysis and available for display. query results are displayed in the center panel in five interactive viewing windows, tree, terms, genes, go path and go treeprune, that are activated with tabs at the top of the panel. these five windows provide the means for applying and iteratively re-applying statistical operators to the inputted  gene list, viewing statistical results, and viewing the results of goffa's tree, go path, and go prunetree analysis. the data and results within both tables and plots are synchronized components, enabling mouse-click toggling between window views. for example, genes associated with go terms that are selected through mouse clicks in the goffa tree  are displayed as a list in the right panel .

the user can toggle between the center panel's five windows , providing another level of iterative interactivity. each window either displays information differently, or displays different information related to the inputted genes:

• tree window – the tree window is the default viewer that is launched after a search, and appears in the center panel. as shown in figure  <dig>  the tree window displays go terms in an outline-like hierarchical tree format . the number of associated genes, the relative enrichment factor , and the p-value from the fisher's exact test are displayed for each go term at each go hierarchical level. since query results can form an extensive list, a flexible search capability is provided below the tree display. the user can search the tree by go term, gene name/symbol, p-value, e-value, and their combination, and search results are then highlighted in blue within the display for easy location with associated gene  listed in the right panel.

• terms and genes windows – these two windows provide alternative, tabular presentations of the information contained in the tree window . whereas the tree window combines the three categories of go path information, both the terms window  and genes window  separately display molecular function, biological process and cellular component category information, as chosen with a tab, and presents it in an excel-like spreadsheet format. as indicated by their names, the terms window aggregates information by individual go term, whereas the genes window aggregates information by individual gene. both windows display results of statistical operators . the terms window displays the number of significant genes associated with each go term, as well as the average hierarchical level at which the gene appears in the go term. tables in both windows can be sorted in either ascending or descending order of any column, and can be cut and pasted or exported to external software for further analysis.

• go path window – the goffa go path plot  visually presents the goffa tree paths estimated as the most relevant by equation  <dig>  the goffa algorithm first rank-orders all goffa tree paths using equation  <dig> values, and then plots the  <dig> paths with the highest values, with the x-axis corresponding to descending hierarchical tree level, and the y-axis corresponding to the log p value at each hierarchical level . double clicking any goffa tree path in the graph or its color key located below the graph will launch a tree window view  with the go terms corresponding to the goffa tree path highlighted in blue for easy recognition. the go path visualization could be considered as a condensed rendering of the most salient go information associated with the deg's data.

• go treeprune – this visualization tool display the go terms in a node-like hierarchical tree structure, as shown in the figure  <dig> example. note that the plot is annotated with the p-value, e-value, and number of associated genes at each node of the tree. the number of genes associated with each node is also depicted in the pie chart as a fraction of the genes associated with the root node. the go treeprune plots can be very large and complex; as a result, goffa provides a tool for pruning the tree by assigning arbitrary and simultaneous cutoffs for p-value, e-value, and number of genes. nodes below the cutoff values specified by the user are removed from the plot.

goffa application
a dataset from a toxicogenomics study was used to demonstrate the utility of goffa. in this study, the renal toxicity and carcinogenicity associated with the treatment of aristolochic acid  in rats was studied using dna microarray. aa is an active component of herbal drugs derived from some plants that has been used for medicinal purposes since ancient time  <cit> . the compound is a nephrotoxin and carcinogen in human and rodents. to investigate the effect of aa exposure on gene expression in rat kidney, a toxicogenomics study is conducted; the experimental protocol is described by chen et al. in an accompanying paper of the same issue. briefly, six-week old big blue rats were treated with aa and control vehicle for  <dig> month. one day after the last treatment, the animals were sacrificed and the kidneys were removed for microarray analysis using the applied biosystems rat genome survey microarray. both treated and control samples had six biological replicates . the data normalization and analysis were conducted using arraytrack. the deg list was determined based on p <  <dig>  and fold change >  <dig>  since goffa is fully integrated with arraytrack, the degs from arraytrack were directly passed to goffa for functional analysis. of  <dig> identified genes,  <dig> genes had go information for analysis  <cit> . the goffa results are summarized in figures  <dig>   <dig>   <dig>   <dig> 

the statistics based on a combination of fisher's exact test  and relevant enrichment factor  identified  <dig> enriched go terms in the go biological process. the majority of the terms are related to four functional categories, induction of apoptosis, defense response, response to stress, and amino acid metabolism. these four functional categories reflect the known biological and pharmacological responses of kidney to the aa treatment  <cit> . out of these four functional categories, go path ranked "defense response" as an important mechanism associated with the aa treatment , and similar results were obtained from go treeprune as well . this finding is consistent with the general understanding that defense response, which includes immune response, is a complex network response of a tissue to toxins and carcinogens  for defending the body. figure  <dig> gives the go path results in the tree window, where the majority of genes involved in the defense response are up-regulated to oppose damage by aa. for example, the inhba gene  is a growth factor with  <dig> -fold increase in expression in kidney. this is a tumor-suppressor gene and it produces protein that increases arrest in the g <dig> phase of tumor cells  <cit> . therefore, its induction inhibits tumorigenesis in kidney treated with aa.

discussion
a fundamental step in analyzing dna microarray data is to determine the differentially expressed genes  that are presumably relevant to the biological phenomena under study. however, in microarray experiments using chips with thousands of genes where a small subset of degs is determined for a disease or toxicity, the potential for both type  <dig> and type  <dig> errors could be large. both types of errors suggest the need for the biologists to intervene in the data reduction and analysis process beyond the application of statistics. the goffa software was designed with the biologist in mind. the platform provides a means to analyze and scrutinize the complex data from genomics and proteomics experiments in the context of the existing knowledge of gene function as embodied by the go database. it provides the biologist alternate ways to summarize data, statistically select the most relevant data, or examine in fine detail the biological phenomena associated with selected data.

goffa is a client-server application, written in java language for portability, and has a gui designed with the assistance of biologists for their own intuitive ease of use. the gui is logically divided into three panels , for queries , analysis and results , and gene lists , respectively. the go analysis, results tables, graphs, and visualization tools are accessed from the analysis and results panel  that maintains data linkage assuring ease in examining selected data in different ways.

goffa's efficiency and effectiveness for data interpretation results from treating go data as a set of distinct hierarchical goffa tree paths. application of statistical tests to the goffa tree paths enables two unique interpretive functions, go path and go treeprune. go path provides the rank ordered estimates of the statistically important goffa tree paths. go treeprune provides the ability to prune go trees by removing the go terms according to their p- and e-values in conjunction of the user-defined number of genes the terms contain. these two functions apply the different statistical approaches to rank and/or narrow down the go terms for further analysis/interpretation. when used together, the functions enable the biologist to reduce complexity of data to that which is most relevant, select that information, and then drill down to examine it further at a more refined level of detail.

the statistical estimators used in goffa  should be interpreted as heuristic metrics of the potential biological significance of go terms, rather than formal inferences of biological relevance. they are most reliable for problem solving when all genes from an experiment are known, since the prevalent go terms in deg's are compared to the prevalent go terms in the set of reference genes. for example, the absolute p-value from the fisher's exact test has little value unless the total number of genes on the chip is used as the set of reference genes. this is equally applied to the e-value. goffa currently provides gene lists for over  <dig> commercial array types , for which the go terms are pre-mapped and stored in the database for quick retrieval and analysis. with this information, goffa's statistical estimators can provide more meaningful significance assessment for interpretation of the go results. if the inputted gene list is not associated with an array type, the total numbers of genes in the goffa database is for statistical estimates; while this will, for example, unrealistically skew p-values, p-values across the go terms will still retain meaning in a relative sense.

while goffa itself is a powerful analysis tool, its full utility derives from its integration as a module of the arraytrack software. arraytrack is a comprehensive software platform for microarray data management, analysis and interpretation  <cit> . the integration of goffa with arraytrack enables the microarray data to be easily processed in the arraytrack environment and the resultant deg list immediately interpret with goffa. importantly, arraytrack has been interfaced with various commercial pathway software, providing an additional means to investigate the validity of goffa findings with respect to relevant gene ontologies.

CONCLUSIONS
a common characteristic of high-throughput omics technologies, such as dna microarray, is the generation of huge datasets that provide the ability to examine differential expression between corresponding genes in treatment and control groups. goffa enhances the capability to interpret data generated from these technologies. goffa applies statistical analysis in conjunction with intuitive visual display to present go terms, trees and paths in a manner to facilitate biological interpretation. there are two unique tools available in goffa, go path and go treeprune, both enabling fast and interactive interrogation of significant gene and protein lists through statistical assessment and visual inspection. goffa is a module of arraytrack that is fda's microarray data management, analysis and interpretation software.

authors' contributions
hs has developed goffa and finished the first draft of the manuscript. wt conceived the concept of the go path function and finalized the manuscript. hf was involved in the goffa interface design and testing and contributed significantly on finishing the first draft of the manuscript. tc helped preparing the section for the real-world application of goffa. all authors were involved with the design of the goffa functions and user interface. all authors participated in preparation of the manuscript, and approved its final form.

