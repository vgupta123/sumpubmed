BACKGROUND
the next few years are expected to bring a significant increase in the number of available genomes, driven by advances in sequencing technologies  <cit> . as genome sequencing projects outpace the generation of native mrna and protein sequences, gene annotation projects for these genomes will need to rely instead on cdna information from other species. while existing alignment programs align cdna and the corresponding genomic sequences accurately, they are inadequate for cross-species comparisons  <cit> . beginning with blast  <cit> , most alignment programs have used a seed-and-extend technique to produce local alignments, starting from exact or near-exact word matches  between the two sequences and extending them to a local alignment in several stages. blast uses an exact match of  <dig> contiguous positions, represented by a vector of 1s . such a seed is called continuous. more recently, spaced seeds have been introduced, which allow wildcard positions in the seed pattern, marked with 0s. for instance, kent and zahler  <cit>  used a seed that allowed for mismatches at the wobble codon position  to increase the sensitivity of cdna-genomic sequence alignment. for the same weight, or number of  <dig> positions, spaced seeds were shown to perform better than continuous seeds in most cases  <cit> .

recently, ma et al.  <cit>  introduced a framework for predicting the sensitivity of a spaced seed given a model of alignment, and showed how to determine the theoretical seed sensitivity with an efficient dynamic programming method  <cit> . given a bernoulli model of alignments with the parameter p  estimated from the average sequence identity, they determined optimal seeds for human-mouse genomic sequence alignment. these seeds were later implemented in the programs patternhunter and blastz  <cit> . subsequent studies used increasingly complex alignment models, such as the order  <dig> inhomogeneous 3-periodic markov models in  <cit>  or the higher order  inhomogeneous markov models of  <cit> , often in the specialized context of coding sequences. extensions of the seed models were proposed to further improve sensitivity or extend the range of applicability to non-nucleotide sequences, for instance multiple spaced seeds  <cit> , or vector seeds  <cit> . in the latter, each position in the seed pattern is a real value representing the weight of a match or substitution at that position in the total match score, and a seed match is declared when the total score exceeds an a priori fixed threshold. however, these methods increase the memory and running time of searches, both of which are critical for practical high-throughput applications.

while early alignment and seed models used the traditional { <dig>  1} alphabet, to further improve the seed sensitivity transition-only wildcards were introduced to differentiate between transitions and transversions, first implemented in blastz  <cit> . later, noé and kucherov  <cit>  formalized the concept and showed that spaced seeds with transitions extend the sensitivity range of { <dig>  1} seeds, and zhou and florea  <cit>  additionally provided a framework for specificity calculation, and showed that they offer better sensitivity-specificity tradeoffs than { <dig>  1} seeds in practice.

when comparing coding sequences, such as in cdna-to-genome alignments, the codon organization, higher-order position dependencies  <cit>  and specific transition-transversion biases  <cit>  inherent in the gene sequences are likely to be reflected in the alignment patterns. in  <cit> , a three-state markov model of order  <dig> is used to simulate the three codon positions, while brejová et al.  <cit>  introduce two models, the first a three-state markov model of order  <dig>  and the second a more complex bernoulli formulation in which each codon is modeled independently. recently, we proposed to use higher order  inhomogeneous markov models with transitions  <cit>  to capture both transition-transversion biases and sequence compositional patterns.

as the number of sequenced organisms increases, the range of possible pairwise species comparisons will grow quadratically with the number of species. for practical reasons it becomes desirable to identify a small number of seeds that would perform well for a wide range of comparisons, at varying evolutionary distances. earlier, choi et al.  <cit>  determined and analyzed best seeds for genomic sequence comparisons for several sequence identity levels under a bernoulli model of alignment, in a greatly simplified model of evolutionary distance. at low weights , seeds performed optimally or near-optimally across a wide range of sequence similarity levels. at higher weights, however, there was significant fluctuation in seed sensitivity, which led them to the hypothesis that different seeds will be needed for each type of comparison. this simple p-level representation of evolutionary sequence divergence is likely inadequate for coding sequences, which are under a more diverse set of evolutionary pressures. we approach the question of designing universal good seeds for cdna-to-genome comparisons, i.e. seeds that perform well for a large number of comparisons, starting from a complex representation of alignment as a high order 3-periodic inhomogeneous markov model incorporating transitions  <cit> . using comparisons between human and four others species  to sample a wide range of evolutionary distances, we analyze the distributions of seed sensitivities statistically to characterize and identify universal good seeds. in the remainder of this section, we provide a brief introduction to the problem of designing optimal spaced seeds.

spaced seeds
{ <dig> } spaced seeds
alignment programs typically use short exact or approximate matches of an a priori specified pattern  to detect local alignments between two sequences. a continuous seed, such as the one used in blast  <cit> , requires an exact match of a fixed length k between the sequences, and is represented as a vector of 1s . in contrast, spaced seeds  <cit>  allow for approximate matches by including wildcard positions in the pattern, marked with 0s . the number of  <dig> positions in the pattern is called the weight of the seed, and the length of the pattern is called the span. conventionally, seeds must start with a  <dig> position. in keeping with previous studies, we will use a fixed seed span k =  <dig>  <cit> .

an alignment is represented as a string of 0s  and 1s  generated from a model m, for instance a bernoulli or a markov model. a seed s = s <dig> ... sk, s <dig> =  <dig>  is said to detect the alignment w = w <dig> ... wl ∈ { <dig>  1}l if there is an approximate match for the pattern in the alignment string such that all  <dig> positions in the seed pattern map to  <dig> positions in the alignment, i.e. there exists i =  <dig> .l - k +  <dig> such that wi+l- <dig> =  <dig> for all l with sl =  <dig>  if such an i exists, the seed is said to occur in the alignment w at position i. the theoretical sensitivity of a seed is then defined as the probability that it will detect a random alignment of length l generated from the model m, or equivalently:
sn = p  <cit> . traditionally, the alignment length l is  <dig>  determined as the average length of a gap-free alignment in human-mouse comparisons. by definition, an optimal seed is a seed with the highest sensitivity. for a given seed, its sensitivity can be computed exactly using dynamic programming  <cit> . optimal seeds can then be produced by exhaustively searching the seed space  <cit> , while close approximations can be obtained with fast heuristics, such as hill-climbing  <cit>  or exploiting the seed structure to reduce the search space  <cit> .

{ <dig>   <dig>  x} spaced seeds for cdna-to-genome alignment
unlike genomic sequences, gene sequences exhibit higher order dependencies between positions  <cit> , more pronounced transition-transversion biases  <cit> , and distinct manifestations at the three codon positions, which are likely to translate into alignment patterns. to account for these characteristics, in previous work  <cit>  we proposed a framework that differentiated between transitions and transversions, by using an additional alphabet symbol x, as well as among the three codon positions, using a third order inhomogeneous 3-periodic markov model of cdna-to-genome alignments. in the seed pattern, x marks a position that allows transitions but not transversions, while in the alignment model it simply represents a transition. the weight of the new symbol is  <dig> . we denote  the class of seed patterns with n <dig>  n <dig> and nx symbols of  <dig>   <dig> and x, respectively, n <dig> + n <dig> + nx = k. for a given weight w, there may be multiple  combinations with n <dig> +  <dig> ·nx = w . for instance, for the weight w =  <dig> and span k =  <dig>  the following combinations are possible: , , ..., .

in the following sections, we investigate the behavior of seeds, and in particular best seeds, among four comparisons or cdna-to-genome alignment models  to obtain a robust characterization of universal good seeds.

RESULTS
the repertoire of species to be sequenced is expected to increase dramatically over the next few years, driven by new, more effective and increasingly reliable sequencing technologies. as the number and phylogenetic diversity of genomes increases, designing optimized seeds for each pair of compared species quickly becomes impractical. it becomes desirable to identify a limited number of seeds that perform well, if not optimally, for a large number of comparisons. we call these universal good seeds. we examine seeds for four comparisons between species with significantly different evolutionary distances and mutation patterns . for simplicity, we will refer to each comparison by the name of the second organism . by analyzing the distribution of seed sensitivities between models statistically, we identify strategies for designing universal good seeds.

universal good seeds
we address two questions: first, are there groups of comparisons, or equivalently alignment models, that produce similar behavior of all seeds? we call such models seed-equivalent, and one optimal seed would then satisfy all comparisons in a seed-equivalence group. second, are there universal good seeds, i.e. seeds that are optimal or near-optimal for a large range of comparisons and evolutionary distances?

to answer these questions, we started by calculating seed sensitivities exhaustively in the four models for three weights, w =  <dig>   <dig>   <dig>  for the ,  and  combinations. we then compared the distributions of values between any two models using statistical regression methods to determine seed trends, by measuring the 95% confidence interval for a seed when projected via the regression curve, and to identify outliers, or seeds that have significantly different behavior  between the two models. although linear and non-linear regression models showed similar goodness of fit, an order  <dig> non-linear method was chosen because it provided a more conservative estimate of predicted values among the top scoring seeds, which are particularly relevant to this study. the scatter plot of seed values between the chk and dog distributions and the two regression curves, linear and non-linear, produced with the r statistical analysis package  <cit>  are shown in figure  <dig>  scatterplots for all pairwise comparisons are shown in .

determining seed-equivalent models
for most pairs of models, the 95% confidence interval for the predicted seed values  is less than or close to  <dig> , meaning that with high probability the observed seed sensitivity in the second model is within close vicinity  of the predicted value, y^. when seed values can be so closely predicted between both  and , the two models x and y can be deemed seed-equivalent. in our case, dog and mus, and chk and zfs, respectively, are seed-equivalent despite the difference in their sensitivity ranges. interestingly, seed values appear to also be accurately projected from a reference model x describing a more distant evolutionary relationship, to a compared model y representing a closer comparison, but not conversely. we explore this observation below.

                                 max
                                 max
                                 min
                                 y
determining universal seeds
with the same argument as above, when the margin of error tα/2σy is small, with high confidence high-scoring seeds in the reference model are expected to lie at the top of the sensitivity range in the compared model. hence, good seeds will largely be shared between the models. to measure how closely the predicted value of the optimal seed in the reference model  approaches the optimal  seed in the compared model , we used the statistical lower bound of the predicted interval for xmax, as a worst case scenario, and compared it with ymax. these ratios are shown as t  in table  <dig>  as expected, the values are consistently above  <dig>  between the seed-equivalent models, but also when a seed in a more distant model is projected onto a closer model, and the trends are more pronounced with the larger seed weights. this level of accuracy in predicting near-optimal seeds by regression projection, albeit statistical, is comparable with that obtained with the heuristic algorithm proposed in  <cit> . to rule out the effects of outliers among the top-scoring candidates, we identified those seeds that fall significantly outside of the 95% confidence range . although roughly 1–2% of seeds are expected to place outside the predicted range, they are scattered along the sensitivity range for the model.

collectively, these findings suggest that simply selecting top scoring seeds in the most distant model, in our case zfs, would lead to good seeds for all other models, and therefore gives a simple strategy for determining universal good seeds.

evaluation
to probe the universality of seeds, we evaluate seeds optimized for one comparison on the three others. for each comparison, we determine best seeds for most weights of practical interest, w =  <dig> . <dig>  for all  combinations. table  <dig> lists the optimal seed under our fixed span model  for each weight for the four comparisons, and the complete list including all combinations is in . figure  <dig> shows the sensitivity maxima that can be achieved by seeds for each combination. for each comparison  the maximum overall sensitivity declines steadily as the seed weight increases, at a rate roughly proportional to the percentage of matches in the alignment . within each weight group, the sensitivity maxima vary, sometimes dramatically, between  combinations: seeds with the largest number of transitions consistently score the lowest, and seeds with a small number of transitions, depending on the species , perform the best. we hypothesize that the optimal number of seed transitions for each comparison is determined by the transition-transversion ratio  in the alignment model, and that more transition positions are expected in the optimal seeds as the ratio increases. thus, dog  and mus  are the most likely to see the effects of transitions, while the effects on chk  and zfs  will be smaller. this ratio also determines the gain in sensitivity that can be obtained by seeds incorporating transitions compared to { <dig> } seeds.

                              x
to validate the universal seeds, we measured the performance of seeds optimized for one comparison on each of the other three, both theoretically and on real data. for empirical evaluations, we tested the ability of each seed to detect orthologous exons between human and each of the other species. table  <dig> lists the theoretical  and empirical  seed sensitivity values, calculated as described in methods, averaged over each weight group. theoretical values show very similar sensitivities for all four groups of seeds on all four comparisons. empirical values are somewhat more varied, but they also indicate that all seeds perform optimally or near-optimally for multiple comparisons. in all cases, seeds designed for the more distant comparisons have near optimal performance for the closer ones. in particular, zfs and chk optimal seeds are widely applicable, and thus are good candidates for universal good seeds.

                              co
                              do
                              mo
                              zo
                              co
                              do
                              mo
                              zo
                              co
                              do
                              mo
                              zo
                              co
                              do
                              mo
                              zo
discussion
while significant effort has gone in designing optimal seeds for comparing human and mouse sequences, a remarkably few other comparisons received any attention at all. with more species being sequenced over the next few years, identifying a small number of seeds that would perform optimally or near-optimally for a large range of comparisons is becoming essential. for genomic sequences, the sequence identity level has been used as a simple measure of evolutionary distance. since the sequence composition of genes is significantly more complex, best seeds for comparing coding sequences are expected to depend not only on the sequence identity level, but also on the pattern of mutations, in particular transition-transversion biases. intuitively, similar alignment models should produce similar behavior of seeds. thus, one solution to seed proliferation is to group comparisons that exhibit similar behavior of seeds into seed-equivalent classes, such that all comparisons in one class are well served by the same optimal seed. furthermore, it would be even more desirable to identify one or a small set of seeds suitable for a wide variety of evolutionary distances and mutation patterns, herein called universal seeds.

our statistical regression analyses of seed sensitivities among four comparisons, chosen at various evolutionary distances, showed that for some pairs of comparisons seed behavior can be predicted closely with high-confidence. in particular, it was possible to identify two sets of models that have relatively different sensitivity ranges but very similar seed behavior, and therefore can be deemed seed-equivalent. moreover, even at larger evolutionary distances more distant comparisons are predictive of closer ones. this conclusion is corroborated by several factors, including the length of the prediction interval, the pattern of outliers, and the ratio of predicted to optimal sensitivity . for instance, at  <dig> σ regression error, all but a few of the outliers perform better than predicted in the distant model compared to the closer one. in other words, distant comparisons contain more information than closer ones. one outstanding question is how to determine whether two models are close enough to be seed-equivalent. while we have not yet found a theoretical formulation, we investigated the relationship between alignment markov models using a conventional distance measure between their probability distributions. the kullback-leibler divergence   <cit>  can be applied on the space of alignment words x = { <dig>   <dig>  x} <dig> to produce a distance between the two models :

 kld=∑w∈xplog⁡pq 

kld represents the relative entropy of p over q, or the information gain about x when p is used instead of q. the kld measure is non-symmetrical, i.e. kld ≠ kld, and therefore can capture unidirectional relationships. in table  <dig>  the more distant comparisons contain consistently more information than closer ones.  is closer than mus .) the table also suggests that a possible cutoff for deciding seed-equivalence may be set between  <dig>  and  <dig> . additional models and analyses will be needed, however, to validate and fine tune this criterion.

lastly, one natural question that arises is whether universal seeds exist for other types of comparisons, such as between genomic sequences. our preliminary experiments using a { <dig>  1} bernoulli model of alignment  <cit>  and four different sequence similarity levels to represent different evolutionary distances  indicate that, again, good seeds for the more distant comparisons will perform well on the closer ones . moreover, for weight  <dig>  p =  <dig> ,  <dig> ,  <dig>  form a seed-equivalent cluster and the optimal seed is shared among the four models, whereas for the larger weights  the seed-equivalent groups are sparser and no one seed is optimal for all comparisons. these findings are consistent with the observations in  <cit> . thus, although more analyses are needed to test it on various models, our simple strategy for selecting universal good seeds may be more widely applicable to a variety of sequence comparison problems.

CONCLUSIONS
we performed a statistical analysis of seed sensitivities for four species-to-species cdna-to-genome comparisons, spanning a wide range of evolutionary distances and mutation patterns, with the goal to determine criteria for selecting a small set of seeds that would perform well on a wide range of comparisons. in particular, grouping models that exhibit similar behavior of seeds into seed-equivalence classes could significantly reduce the number of optimal seeds. most important for practical applications, the analyses showed that with high probability optimal and near-optimal seeds for the most distant available comparison will translate into good seeds for a wide range of comparisons. these insights, and the sets of optimal seeds predicted for the four comparisons and for a wide array of weights, represent a useful resource in guiding the selection of seeds for developing practical applications.

availability
material referenced in the paper can be found in the additional files below and at our website  <cit> .

