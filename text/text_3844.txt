BACKGROUND
mutations in a genome consist of not only base pair level changes but also events that alter the chromosome structure, such as inversions, duplications or deletions  <cit> . ancestral gene sequence inference has led to significant predictions of protein functional shift and positive selection  <cit> . for example, comparisons of orthologous chromosomal segments showed heterogeneous rates of evolution of the x chromosome in human, mouse and rat  <cit> . however, on the genome level, the evolutionary change of genome structure is poorly understood. inference of ancestral genomes was mainly achieved at the dna level, but limited to closely related organisms where rearrangements were negligible, partly because of the complexity in assigning genes in duplicated segments to orthologous groups  <cit> . in this paper, we take a simple, alternative data set of chloroplast genomes to study the phylogeny and genome structural changes. chloroplasts are the green, photosynthetic organelles that originated from a free-living cyanobacteria-like ancestor  <cit> . chloroplasts maintained a reduced genome through over one billion years of endosymbiosis  <cit> . typical chloroplast genomes are circular single chromosomes with  <dig> —  <dig> genes, which encode proteins, trnas, rrnas and hypothetical open reading frames. most chloroplast genomes consist of four distinct parts: two duplicated regions  separated by a large single copy  and a small single copy  region. figure  <dig> shows the four regions  of gossypium hirsutum chloroplast  <cit> . one common characteristic of the chloroplast ir is the presence of three rrna genes , which are homologous to genes of the cyanobacterial rrn operon. the structure of chloroplast genomes of land plants is highly conserved, with almost collinear gene order, except for elevated level of rearrangements in specific lineages including green algae  <cit> , conifers and members of a few flowering plant families including campanulaceae  <cit> , geraniaceae <cit>  and fabaceae <cit> . the gene content of chloroplast irs vary greatly, largely due to the expansion and contraction of the ir at the ir-sc boundaries; this "ebb and flow" of ir boundary has been observed even within a genus  <cit> . chloroplast genomes of green algae  also contain more variations of gene order and some are highly rearranged  <cit> , with some evidence that rearrangements may be adaptive in nature  <cit> . because of their compact size and the availability of conserved dna probes, many chloroplast genomes have been mapped  <cit> , and  <dig> have been completely sequenced to date. thus, chloroplast genomes provide an ideal example for modeling genome rearrangements over a broad evolutionary time scale.

genome rearrangements
we assume a reference set of n genes {g <dig>  g <dig>  • • •, gn}, thus a genome can be represented as a signed ordering of these genes, and each gene is given an orientation that is either positive, written gi, or negative, written —gi. genomes can evolve through events such as inversions, transpositions and transversion, as well as other events such as deletions, insertions and duplications of fragments. let g be the genome with signed ordering of g <dig>  g <dig> …, gn. an inversion  between indices i and j , transforms g to a new genome with linear ordering

  g <dig>  g <dig> ⋯, gi− <dig> −gj,−gj− <dig> ⋯,−gj,gj+ <dig>  ⋯, gn 

a transposition on genome g acts on three indices i,j,k, with i ≤ j and k &owm; , picking up the interval gi,gi+ <dig>  … ,gj and inserting it immediately after gk. thus genome g is replaced by :

  g <dig> ⋯gi− <dig> gj+ <dig> ⋯gk,gi,gi+ <dig> ⋯,gj,gk+ <dig>  ⋯,gn 

because gene rearrangements are rare genomic events <cit> , gene-order data enable the reconstruction of evolutionary events far back in time, thus many biologists have embraced this new source of data in their phylogenetic work  <cit> .

genome rearrangement analysis
given two genomes g <dig> and g <dig>  we define the edit distance d as the minimum number of events required to transform one genome into the other. the breakpoint distance  <cit>  is not a direct evolutionary distance measurement. a breakpoint in g <dig> is defined as an ordered pair of genes  such that gi and gj are adjacent in g <dig> but not in g <dig>  the breakpoint distance is simply the number of breakpoints in g <dig> relative to g <dig>  when only inversions are allowed, the edit distance is the inversion distance. hannenhalli and pevzner  <cit>  developed a mathematical and computational framework for signed gene-orders and provided a polynomial-time algorithm to compute the edit distance between two signed gene-orders under inversions; bader et al.  <cit>  later showed that this edit distance can be computed in linear time. however, computing the inversion distance is np-hard in the unsigned case  <cit> .

gene rearrangement phylogeny was first proposed by sankoff and an algorithm using break-point distance was implemented in bpanalysis  <cit> . the inversion phylogeny was introduced to improve the accuracy and was implemented in grappa. extensive simulations showed that inversion median were superior to breakpoint median  <cit>  and the trees returned were more accurate than using either distance-based or parsimony methods  <cit> . the current version of grappa  is able to estimate the phylogeny and inversion medians using genomes with equal gene content   <cit> . a scaled-up version, dcm-grappa, is able to estimate the gene-order phylogeny with very high accuracy for thousands of genomes, thus greatly increasing the power of genome phylogeny using large datasets  <cit> . we extended grappa  <cit>  so that it is able to analyze data sets with a limited number of deletions, but no duplication is allowed. to remedy this problem, we develop a new algorithm  for chloroplast genomes that take into account the unique quadripartite structure , which is common to not only the chloroplast genomes, but also some other ir-containing dnas. the assumption of our new approach is that inversions do not occur across inverted repeats, because the genome structure will be disrupted by such inversions that "flip" the repeats from inverted to the same orientation. according to the model, a change of gene content within the ir region is mainly due to growth or shrinkage of the ir at the ir-sc boundaries. this approach is in agreement with the observation that in most ir-containing chloroplasts, the gene content in the whole genome is conserved, but ir length and ir gene contents can be varied.

RESULTS
we assess the new grappa-ir through both biological and simulated datasets.

analysis of six chloroplast genomes
we select a test case of six chloroplast genomes representing major lineages of land plants and green algae, all of which share the quadripartite structure . the organisms include nicotiana tobacum , psilotum nudum , marchantia polymorpha , chaetosphaeridium globosum , nephroselmis olivacea , and mesostigma uiride .

a reference phylogenetic tree was constructed using the maximum parsimony method with  <dig> concatenated proteins. cyanophora proteins were used to root the tree. the reference phylogeny of these six chloroplast genomes is shown in figure  <dig>  the reference tree is the same as the phylogeny by lemieux et al.  <cit>  in which mesostigma is basal to other green plants and algae. an alternative phylogeny was published by karol et al. based on maximum likelihood analysis of four chloroplast genes and including many more algal taxa, in which mesostigma is basal to charophyte green algae and sister to chlorophyte green algae  <cit> . we extracted  <dig> unique genes from the six genomes. actual number of genes included in each genome ranges from  <dig> to  <dig> due to duplicated genes in air. the gene set includes  <dig> characterized protein-coding genes,  <dig> rrnas,  <dig> trnas  and a hypothetical conserved open reading frame . the encoding reflects the order and orientation of genes in the genome. location of multi-exon genes was determined by the starting position of the first exon. in one case, the order of overlapping genes  was determined by the position of the start codon. we evaluate all possible trees for the six genomes using the grappa-ir. after  <dig> min of computation on a piv  <dig> ghz workstation, grappa-air returned a best tree with  <dig> inversions, with a topology agrees with the reference tree, which is shown in figure  <dig> 

we tested this data set with the original grappa by ignoring the region boundaries and removing the irb region. the inference allows inversions to occur across the ir and single copy regions. the best tree obtained requires  <dig> inversions, yet the topology  is very different from the reference trees and is in conflict with the biological relationship of these organisms. although grappa is a heuristic, extensive testing on simulated and biological data confirmed its high accuracy, thus its failure in this test suggests that the ir-boundary do perform a unique role in the evolution of chloroplast genomes, and a better method as grappa-ir should be preferred.

we examined the reconstructed ancestral gene orders on the best tree returned by grappa-ir. this six-genome dataset contains chloroplast genomes of land plants, green algae and a flagellate protist, which were separated by at least  <dig> million years of evolution  <cit> . the ancestral chloroplast genomes of land plants and algae contain inverted repeats, which is consistent with the hypothesis that ir is a feature derived early in the chloroplast endosymbiosis  <cit> . although the sequenced cyanobacteria nostoc and synechococcus do not maintain rrn-containing irs, if other cyanobacteria are identified with structures similar to the chloroplast ir, then it would suggest an even earlier origin for this structure. in addition, the ancestral ir contains the same gene content to that of mesostigma, which agrees with the observation that mesostigma chloroplast genome encodes several ancestral gene clusters  <cit> . by comparison of ancestral gene orders to the extant genomes, it is possible to test formally the evolutionary force of gene order changes. for example, ancestral gene clusters may be more likely to be maintained if they share related function and are under constraints in the face of genome rearrangements.

simulations to assess accuracy
phylogenetic analysis methods deal with lost historic information, thus their accuracy should also be assessed through simulations, where the true evolutionary history is known.

we first define our measure for the accuracy of reconstructed trees. given an inferred tree, we compare its "topological accuracy" by computing "false negatives" and "false positives" with respect to the "true tree"  <cit> . for every tree there is a natural association between every edge and the bipartition on the leaf set induced by deleting the edge from the tree.

let t be the true tree and let t' be the inferred tree. an edge e in t is "missing" in t' if t' does not contain an edge defining the same bipartition; such an edge is called a false negative . note that the external edges  are trivial in the sense that they are present in every tree with the same set of leaves. the false negative rate is the number of false negative edges in t' with respect to t divided by the number of internal edges in t. the false positive  rate is defined similarly, by swapping t and t'. the robinson-foulds  rate is defined as the average of the fn and fp rates.

in this study, we generated datasets of  <dig> and  <dig> genomes, each with  <dig> genes , roughly in the range of our dataset described in the paper. we used a large range of evolutionary rates: let r denote the expected number of evolutionary events along an edge of the model tree, we used values of r in the range of 4— <dig>  the actual number of inversions along each edge is sampled from a uniform distribution on the set { <dig> ,…, 2r}. given the model tree, we assigned the identity gene order to the root, and randomly generated gene order for each node based on the edge length and the gene order of its parent, with the assumption that inversions can not cross the ir boundaries. for each combination of parameter settings, we simulated  <dig> datasets and averaged the results.

we compared grappa-ir to the original grappa. we considered all trees with the minimum score given by both methods and took their strict consensus . therefore, the trees returned by both methods need not to be fully resolved and they tend to have somewhat better rates for false positives than for false negatives. as a result, we only report fn rates rather than fp rates or a single robinson-foulds score  <cit> . figure  <dig> and figure  <dig> show the results. this simulation indicates that grappa-ir is clearly more accurate than the original grappa for datasets with r <  <dig>  which is in accordance with results on the six-genome dataset.

since the inferred ancestral genomes have direct impact on the tree scores, we can examine the quality of the inferred ancestral genomes by comparing the best tree score returned by grappa-ir with the known true tree score. averagely speaking, scores of the best trees returned by grappa-ir was only about 7% less than the true scores, which strongly indicates that the inferred ancestral gene orders should be very close to the true ancestral genomes.

discussion
mechanisms of ir expansion
the gene content of the ir varies across land plants, even in a single genus or family  <cit> . it is known that homologous recombination is frequent between the two copies of ir  <cit> . in a single chloroplast, hundreds of copies of chloroplast dna co-exist as circular monomer, dimer and linear chromosomes. in the cellular endosymbiosis environment, the selection on accuracy of replication may have been relaxed to the degree that unequal recombination and replication slippage contribute to the expansion or shrinkage of irs. short repeat motifs may facilitate inter-molecular recombination and create diversity of chloroplast genomes in a population  <cit> . on the other hand, the intra-molecular recombination process should homogenize the sequences of the two irs and thus the particular ir size and the gene content are maintained. the two counteracting phenomena may have played important roles in shaping the current diversity of chloroplast genome gene orders.

duplications and genome stability
we found that incorrect gene order phylogenies were recovered without considering the ir boundary information. this suggests that maintenance of the ir is necessary in the evolution of chloroplast genomes in most of the cases. we propose that ir provides an insulation mechanism that stabilizes the genome structure, and the genes in single copy regions do not commute across the ir. this agrees with the observation that gene rearrangements are more frequent in chloroplast genomes without ir  <cit> . however, some genomes with residual irs but infrequent gene movements between single copy regions compared to related lineages do not conform to the hypothesis  <cit> . future experimental studies on highly rearranged chloroplast genomes, for example, in the green alga chlamydomonas lineage  <cit> , may shed light on the maintenance of ir and genome rearrangements.

comparison to other methods
a similar approach used for human and mouse genome comparison showed the optimal sorting of x chromosomes by at least  <dig> inversions  <cit> . this is a moderate amount of change compared to the level we observe in many chloroplast genomes. if duplications and deletions are considered in a finer scale, the process will be much complex, as suggested by the reconstruction of one  <dig>  mb region in the eutherian mammal ancestor  <cit> . all methods proposed in this paper could be applied to mgr and other method, which will result in a whole new set of tools for botanists interested in genome level evolution.

CONCLUSIONS
we implement a new method to infer phylogeny and ancestral gene orders with inverted repeats. tests on a biological and simulated dataset show grappa-ir can accurately recover the genome phylogeny as well as ancestral gene orders. close analysis of the ancestral genome structure suggests that genome rearrangement in chloroplasts is probably limited by inverted repeats with a conserved core region. in addition, the boundaries of inverted repeats are hot spots for gene duplications or deletions. this analysis provides new insight into the genome evolutionary process.

