BACKGROUND
differentiation of pcr products using dna melting curve analysis was first demonstrated by ririe et al  <cit>  with the double-stranded dna-specific dye sybr green i and has since seen widespread adoption in real-time pcr applications  <cit> . melting curve analysis provides immediate practical benefits in real-time pcr, obviating the need for gel electrophoresis by providing a reproducible signature of the amplified dna sequence that may be used for typing pcr products  <cit> . typing is typically achieved by examining the first derivative of the melting curve and identifying the characteristic "melt peak" , which is the temperature at which the rate of fluorescence change  is highest and is observed in the raw data as a sudden decrease in fluorescence  <cit> .

relatively few melting curve assays are based on the melting profile of the entire pcr product, with many measuring the melting of specific probes from the region of interest, typically targeting single nucleotide polymorphisms  probes  <cit> ). whole product melting curve analysis with sybr green i has been used to a lesser degree in diagnostic assays for cancer treatment monitoring  <cit>  and pathogens  <cit> . almost without exception, these assays produce simple melting curves which result in a single peak  <cit> ; however, melting curve analysis need not be limited to product differentiation on the basis of a single peak and associated tm. wittwer et al  <cit>  identified two melting domains in a  <dig> bp amplicon of the hydroxytryptamine receptor 2a gene and amplicons with multiple melting domains have been used to differentiate species of giardia   <cit>  and naegleria   <cit> .

the idea that large double-stranded dna fragments of several kilobases may contain several melting domains is not new  <cit> , and was pursued for many years by poland  <cit>  and others  <cit> . this body of work has provided several important insights into the process of dna melting: that it is co-operative  <cit> ; that it is both sequence and nucleotide position dependent  <cit> ; and that it is also subject to smaller local effects  <cit> . the possibility that multiple melting domains existed in dna fragments less than a single kilobase does not appear to have been examined in these studies.

two publicly available bioinformatic resources have been developed to model dna melting: poland  <cit>  and meltsim  <cit> . we evaluate the ability of these programs to simulate melting curves for the intergenic spacer region from three species of the waterborne protozoan naegleria and a segment of 18s rdna from two species of cryptosporidium. we also describe the use of these resources to design an informative melting curve assay for two different species of toxic cyanobacteria in silico and then physically test the assay in the laboratory to confirm assay performance with real samples.

RESULTS
comparison of simulated and experimental melting curves for protozoa
the syto <dig> melting curves of amplicons from the intergenic spacer region of n. australiensis, n. fowleri and n. lovaniensis were very distinct as previously reported  <cit> , with multiple peaks differing in shape and height: the n. australiensis amplicon melted with a single sharp peak ; the n. fowleri amplicon melted with three peaks all at different heights ; and the n. lovaniensis amplicon melted with two peaks, the first approximately double the amplitude of the second . when the sequence of each naegleria amplicon was subjected to a melting simulation using the poland  and meltsim  programs, the predicted melting curves were similar to the profiles obtained using syto <dig>  the number of melt peaks and the separation of these peaks were consistent between the simulation programs and the physical data resulting from real-time pcr melting curve analysis. the the predicted relative peak heights  for n. fowleri and n. lovaniensis did not exactly match the physical data , although the meltsim profiles  appeared to be a closer prediction compared to poland . the values of the tms predicted by either program did not match the tms obtained by dna melting curve analysis using syto <dig>  the melting maps  versus base position) were similar for the poland first order reaction  and meltsim  predictions for n. fowleri and n. lovaniensis, but slightly different for n. australiensis, particularly in the region at around  <dig> bp. in the case of meltsim, the melting map did not cover the entire amplicon and appeared to be truncated at  <dig> bp for n. fowleri and  <dig> bp for n. lovaniensis and n. australiensis.

a segment of 18s rdna from cryptosporidium parvum and cryptosporidium muris, approximately  <dig> bp, was amplified and melted in the presence of syto <dig>  the differentiated melting curves resulted in complex profiles that allowed the ready differentiation of these two species, with c. muris producing  <dig> peaks with tms of  <dig> °c and  <dig> °c  and c. parvum producing a peak at  <dig> °c and a peak with a shoulder at  <dig> °c and  <dig> °c respectively . the standard deviation in tm observed between replicates  was less than  <dig> °c . in the case of the c. parvum sequence there was a subtle difference between the poland  and meltsim  predictions, with a difference between the position and height of the second peak and its shoulder. the meltsim profile more closely matched the observed profile . the melting profiles predicted c. muris by meltsim  and poland  were the same as each other and similar to the observed profile  in terms of the number of peaks and spacing between peaks. in both cases the peak heights and absolute values tms differed between the in vitro and in silico profiles. the melt maps predicted by each program were similar to each other for c. parvum  and c. muris ; however, the meltsim maps were again truncated, here at  <dig> bp.

to establish that the observed similarity in predicted and actual meting curves was not a "dye-specific" phenomenon, n. australiensis, n. fowleri and n. lovaniensis amplicons were purified and added in equal amounts  to a solution containing pcr buffer, mgcl <dig> and one of four different double-strand dna-specific binding dyes: syto <dig>  <cit> , sybr green i  <cit> , lc green  <cit>  and syto <dig> . whilst each of the dyes was used at an optimum concentration, analysing the melting curves under otherwise standard conditions limited any variability that may be contributed by differing reaction conditions or pcr amplification. the comparison of melting curves for each of the naegleria test amplicons using the four dyes  with melting curve simulations generated by poland and meltsim showed good agreement in the number of peaks and the peak separation for each of the dyes. the shape of the peaks and peak height were somewhat variable when different dyes were compared, qualitatively most different in the sybr green i melting curve .

when comparing the melting curves for purified naegleria amplicons with post-purification syto <dig> addition  and for naegleria template amplified in the presence of syto <dig>  the number of peaks, peak shape and peak separation were similar. peak heights were also similar with the exception of the first and second peaks in the melting curve for the n. fowleri amplicon. the tm of the peaks differed only slightly.

use of simulation software to identify diagnostic profiles for delineation of cyanobacterial species and comparison with experimental melting curves
to test the utility of the melting simulation programs for the design of diagnostic melting curve assays, poland and meltsim were used to screen the dna sequences of the cynd/aoab gene, a part of the gene cluster implicated in the production of the toxin cylindrospermopsin in the cyanobacteria cylindrospermopsis raciborskii  <cit>  and aphanizomenon ovalisporum  <cit> , respectively. in screening the cynd/aoab gene sequences, a  <dig> bp segment that was predicted to differentiate the two species was identified and resulted in different melting curve simulations for poland  and meltsim . the poland algorithm generated two peaks for the c. raciborskii sequence  and one for the a. ovalisporum sequence , whilst the meltsim program generated one peak with a shoulder on the right hand side for a. ovalisporum  and a single major peak with a minor peak and extended shoulder on the right hand side for c. raciborskii . as observed with the previous simulations the melt maps generated by meltsim and poland were similar but the meltsim map appeared to stop at  <dig> bp.

flanking primers were designed for the 5' and 3' ends of this segment, where the sequences were identical between the two different cyanobacterial species. the primers were used to amplify template dna from these species in the presence of syto <dig>  and the resulting  <dig> bp amplicons were analyzed by melting curve analysis , producing profiles matching the poland melting simulations in terms of the number and separation of melt peaks and relative peak heights. the values of the tms predicted by either program did not match the tms obtained by dna melting curve analysis using syto <dig> 

the syto <dig> melting curve assay for the cynd/aoab gene was used to type a set of  <dig> cylindrospermopsin-producing and non-toxin producing cyanobacterial dna extracts . a total of  <dig> of the  <dig> extracts contained the putative toxin gene and were rapidly genotyped into two groups on the basis of the melting curve analysis.

typing of cylindrospermopsin-producing and non-producing cyanobacterial strains using a syto <dig> melting curve assay for the cynd/aoab gene designed in silico using the poland software. the tm for each melt peak observed in cynd/aoab positive samples is reported to one decimal place. all cynd/aoab negative samples are indicated by "-". toxin production confirmed by lc-ms with a detection limit of  <dig>  μg/l .

discussion
complex melting profiles resulting in multiple melting peaks provide a superior tool for identification of species or characterization of amplicons compared with simple profiles that result in only a single peak. in addition to tm, both the number of peaks and relative peak heights can be used as additional diagnostic characters to facilitate identification. until this study, a systematic method for developing such assays had not been reported. the ability to simply submit a dna sequence to melting simulation software and generate a useful prediction of the likely real-time pcr melting curve profile in silico was an interesting possibility that we firstly explored using existing syto <dig> melting curve assays that resulted in complex melt profiles. melting curves for the intergenic spacer region from each of the three naegleria species had clearly distinct profiles  and in each case the number of peaks and the separation of the peaks were predicted by the poland  <cit>  and meltsim  <cit>  programs, with the meltsim simulations providing a more accurate predictor of relative peak heights for the naegleria amplicons. similarly, melting curves of a segment of 18s rdna from c. parvum and c. muris resulted in distinct profiles that were predicted by the simulation programs, with meltsim providing a better prediction of the c. parvum melting curve. in both cases the actual tms determined using syto <dig> melting curve analysis were generally  <dig> – 5°c higher than the predicted tms.

the difference observed between the experimental and predicted tms is expected considering that the thermodynamic values used in the simulations for base pair stabilities or base stacking are based on empirical data determined for specific salt concentrations in the absence of any intercalating dyes . considering the nature of the interaction between intercalating dyes and dsdna  <cit>  it would be expected that intercalating dyes are likely to increase the tm, and this is what is observed for the experimental data compared with the melting simulations. while it would be useful for the simulations to more accurately predict the tm under real-time pcr conditions , in practice this will be difficult considering that different dyes might interact with dna differently and that the interaction might be affected by the ratio of dye:dna molecules.

the close agreement in the naegleria syto <dig> melting curve profiles and melting simulations generated using poland or meltsim was not limited to the use of syto <dig>  three other double-stranded dna-specific dyes were combined with purified naegleria test amplicons, in addition to syto9; and resulted in melting curves with the same number of peaks and similar peak separation to simulations generated by poland and meltsim. between-dye comparisons demonstrated that relative peak height varied slightly between dyes, most obviously for the n. fowleri melting curve, whilst the shape of the peaks was most obviously different when sybr green i was used. the melt map of the n. fowleri sequence suggests that the first  <dig> base-pairs of the sequence represent the melt domain contributing to the first peak. this region is at-rich  which, considering the gc-preference of sybr green i  <cit> , may explain the loss of this peak for the sybr green i melting curve.

to test the utility of the poland and meltsim programs for in silico melt curve assay design we chose a target gene of more than  <dig> kb, cynd/aoab, implicated in the biosynthesis of the cyanotoxin cylindrospermopsin  <cit> . the program interface for both melt simulation algorithms permits submission and analysis of only one sequence at a time. this limitation meant that sequences could only be screened by visually identifying regions of sequence polymorphism in a multiple alignment of the cynd/aoab gene homologues, then manually submitting individual polymorphic regions to melt simulation. screening sequences firstly with poland, we identified a  <dig> bp sequence segment that generated distinctly different melt profiles depending on the origin of the sequence: two melt peaks for cynd from c. raciborskii and one peak for aoab from a. ovalisporum. when these two sequences were submitted to meltsim the simulation likewise predicted one melt peak for aoab sequence; however, only one melt peak was predicted for cynd sequence, although the tm was different to the aoab sequence and there was a sub-peak/shoulder that was not present in the aoab profile. the substantial differences in the simulated melting curves for the cynd sequence were surprising when compared to the melting simulations for the naegleria and cryptosporidium amplicons, where poland and meltsim predictions were similar except for fine scale changes. comparison between these simulations and actual syto <dig> melting curve analysis of the cynd amplicon leaves no doubt that the poland program is clearly better enabled to model the melting in this case.

the underlying basis for the differences observed between meltsim and poland are likely embedded in the way the two programs implement the poland algorithm and incorporate the thermodynamic parameters used for base stacking, loop opening and closing and so on. a difference between meltsim and poland is the base pair stability parameters that they use, with poland using the values determined by blake and delcourt in  <dig>  <cit> , whereas the windows release of meltsim uses parameters determined by the authors of the software in  <dig>  preliminary comparisons using linux compilations of meltsim  <cit>  incorporating either the  <dig> or  <dig> stability parameters suggest that there is little difference between predictions using either set of parameters on cynd and aoab sequences, with the same major peak identified and only minor differences in other regions of the profile .

examination of the melt maps generated by meltsim show that the predicted melt peaks correlate with sequence domains comprising runs of  <dig> or more base pairs with the same or similar tm, resulting in a peak with a height proportional to the relative size of the domain. in contrast, the poland melt peaks appear to correspond with domains identified from the melt map generated using second order reaction probabilities. this causes poland to overestimate peak heights in some instances  but ironically also appears to be why poland was able to predict two peaks for the cynd amplicon.

interestingly, the melt profile of c. parvum has a similar overall shape to the predicted profile for cynd. a difference between these two sequences is that the lower tm domain in c. parvum is at the 3' end whereas it is at the 5' end in cynd. analysis of the reverse complement of cynd  yielded a different melt profile to the original with a much more obvious second peak half the height of the first peak , more similar to the observed profile. this finding is surprising, especially considering that the melt map of the reverse complement appeared to be similar to the original except for the orientation and for the fact that the entire reverse complemented 3' end was included in the melt map . this raises the possibility that some data might be missing from the meltsim simulation, resulting in the loss of part of the domain and the subsequent failure to detect the second peak. analysis of the reverse complementary sequences of c. parvum and n. fowleri resulted in no change to the profiles, although the tm of the main c. parvum peak shifted slightly to the right by approximately 1°c .

the truncation of the meltsim melt map appears to be caused by rounding during the calculation of domain sizes. the maximum number of domains per block  is  <dig>  and it appears that meltsim calculates block size by dividing the sequence length by the number of domains per block and rounding the resulting number down to the nearest whole number. the melt map only allows plotting of  <dig> domains, which in the case of the sequences used in this study meant that sequences were truncated at approximately  <dig>   <dig> or  <dig> bp. preliminary experiments conducted using a linux compilation of meltsim  <cit> , modified to use the  <dig> parameters and to allow > <dig> domains, allowed the melt map to be corrected by setting the number of domains to be one less than the sequence length , providing the melt map for the entire sequence . this modification did not appear to have any effect on the predicted melting profile for cynb, suggesting that meltsim does not use the melt map output directly in the prediction of the melting curve.

the differences in the melting curves for the cynd/aoab amplicons, initially identified by melting curve simulation, were exploited in a diagnostic assay to type known strains of cyanobacteria that produce the cyanotoxin cylindrospermopsin. actual amplification of the expected  <dig> bp amplicon indicated that the strain was potentially toxic and the melting curve analysis confirmed that the correct product had been amplified and also typed the strain according to its genus. the tm for each of the melt peaks observed was very uniform and divided the strains into two distinct groups. the melting curve analyses for c. raciborskii and a. ovalisporum were completely concordant with taxonomic classification. notably, two anabaena bergii strains were observed to bear sequences similar to the aoab gene on the basis of the syto <dig> melting curve analysis. later phylogenetic investigation of these strains using several highly conserved sequences confirmed that these were initially misidentified and were actually a. ovalisporum . whilst the assay proved to be highly informative for isolated cyanobacterial strains, it may also be used for routine testing of environmental samples, since cases of algal blooms that contain more than one species of cylindrospermopsin-producing cyanobacteria are rare . the possibility also remains open that single filaments of cyanobacteria may be taken from a live environmental sample, extracted and the dna amplified by real-time pcr.

sampling extant sequence polymorphism by melting curve analysis of whole products and using the melting curve "signatures" for biotyping may be less discrete than melting curve analysis of single nucleotide polymorphisms  . however, for some applications, such as species identification, the use of whole product melting curve analysis may be preferred because it is more tolerant to any small sequence differences that might result due to intraspecific variation. in addition, identification using whole product melting curve profiles is likely to be more robust than a snp because by its nature a snp is relying on only a single character difference for identification, whereas multiple character differences are usually required to change the melting curve profile of a larger fragment. the poland or meltsim programs will in their present form be useful as a guide to melt curve assay design but with some further refinement might be adapted into dedicated melting curve assay design software that provides access to the full richness of informative sequence polymorphism already present in sequence databases.

CONCLUSIONS
multiple melting domains in a melting curve provide a rich source of information for typing samples. computer-aided melting simulation provides a gateway to the exploitation of this information. the demonstration that melting curve assays can be designed reliably in silico may stimulate more widespread use of whole product melting curve analysis and ultimately lead to dedicated melting curve assay design software.

