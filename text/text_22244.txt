BACKGROUND
the doors to new horizons in genome-scale synthetic biology have been opened by the recent and rapid development of technologies allowing the synthesis of novel genomes and their introduction into hosts with inactivated or deleted wild-type chromosomes  <cit> . the de novo design of cells with synthetic genomes that are viable in a well-defined environment might require only the constitutive expression of the minimal set of genes required for life  <cit> . this engineering approach, however, has several drawbacks, including the absence of all necessary blocks , the absence of a good definition of the minimal set of genes required, and a poor understanding of the pleiotropic negative effects that these genes may have when put together. in contrast, the re-engineering of an existing genome to change its regulation network would not require adding new genes to the genome but only their rearrangement with respect to promoter sequences. previous work has considered the rearrangement of genomic sequences. for example, chan et al.  successfully modified the t <dig> genome to remove overlapping translational frames  <cit> . this approach was inspired by the engineering practice called refactoring, in which the internal structure of an already existing system is rearranged while its external function is maintained. based on the same refactoring principle, and considering cell behavior as the “external function”, we have created a system for the design of a novel genome sequence with a refactored transcriptional regulatory network  that maintains its original behavior.

we ask whether is it possible to design cells with the same biochemical composition but different genetic information stored in the dna. because of our limitations in predicting phenotype from a genome, we restrict ourselves to the problem of rewiring transcriptional regulatory network to generate the same phenotype that the wild-type cell already has. given the large number of gene regulations, it is not evident that such simplified question could be answered even based on theoretical considerations. although the ultimate answer lies in the experimental verification, the development of a genomic-scale model showing the desired behavior is a necessary condition for such enterprise. in the context of synthetic biology  <cit> , the design of an organism that can respond in a directed way to variations in its environment has been a particularly interesting and challenging problem. this design would require the reengineering of suitable signal transduction and regulation systems  <cit> . because transcriptional regulation is the most well studied regulatory system in bacteria, it may be a good starting point for those interested in the design of such systems  <cit> . in fact, the recent experimental evolution of e. coli under changing environments has provided evidence of regulatory network rearrangements that allow anticipatory behavior  <cit> . however, the de novo design of a genome that can adapt to changing environments may be very challenging. a simpler alternative is to alter a pre-existing genome by reshuffling its genes in such a way that its behavior is maintained. in particular, this problem can be treated computationally if restricted to the re-design of the global transcriptional network for an organism for which sufficient transcriptomic information is available.

to evolve new genomes in silico, a necessary first condition is to define a biologically meaningful fitness function that allows changes that are introduced during the evolution process to be evaluated. how can such a fitness function be defined? we will assume that a given transcriptomic expression profile would determine the protein and metabolite concentrations of the cell, thus the biomass composition would ultimately result from the transcriptome. this can also be rationalized by arguing that natural selection results in nearly optimal biomass production by favoring regulation pathways that confer optimal levels of gene expression in a given environment. consequently, we will construct a fitness function that will enforce the maintenance of the wild-type transcriptomic response. like that, we would obtain the similar molecular composition in the cell under a given environment, while having a refactored genome. interestingly, it has recently been shown that the transcriptomic expression profile is a good predictor of instantaneous cell growth in saccharomyces cerevisiae <cit> . assuming that this relationship is true for other organisms, it can be hypothesized that the expression profile of a given system determines cell growth.

we can evaluate the validity of this hypothesis by analyzing the effect of mutations on the growth of a wild-type strain. notably, this evaluation still requires the accurate prediction of a genome-scale expression profile. more modifications to the genome will lead to less growth and more differences in the expression profile. therefore, we have used an automated methodology for designing a genome based on an in silico evolution process; the methodology uses similarity to a wild-type transcriptional profile as its fitness function, which provides the variation of cell growth. furthermore, it is possible to construct regulatory network models that accurately predict the global transcriptional profile for some organisms  <cit> . these regulatory network models can be used to predict the growth of cells with modified transcriptional networks, thereby providing the fitness function required to evaluate their performance under diverse environmental conditions  <cit> .

in this paper, we describe a methodology for generating nucleotide sequences of a genome that produce cells with targeted physiological responses to a set of environments. for this, we firstly use our previous integration of current known transcriptomic and signaling data into a global model consisting of differential equations, allowing the assignment of parameters to promoter and transcription factor  coding sequences  <cit> . we begin the results section by examining the outcome of this model construction and its corresponding properties. next, we perform the computational design of the trn with the aim of refactoring the e. coli regulation to simplify its internal structure by reducing the number of operons. contrary to previous work  <cit> , the rewiring of the trn is done by ensuring the generation of a suitable nucleotide sequence. we found that we could dramatically reduce the number of operons while maintaining the organism’s response to fluctuating environments. we also analyzed other properties of the synthetic trn, such as its topology and adaptation to varying environments. we then generated a genome sequence for the trn. finally, in the discussion section, we examine some design principles that can be inferred from our results and future experimental applications of this work.

RESULTS
our methodology to generate a refactorized genome sequence consists on three steps: i) reverse engineering the genomic transcriptional regulation network  of wild-type e. coli, ii) the design of a rewired gtrn with the targeted behavior by evolutionary computation, and iii) the design of a nucleotide sequence for a genome implementing the gtrn. for the first step, we inferred the wild-type gtrn by using extensive transcriptomic and signaling data. for the second step, we use an evolutionary algorithm with a fitness function that would create a selection for transcriptomic profiles behaving as much as possible to the wild-type under selected environmental changes. finally, we will create some rules that would allow choosing the appropriate genetic elements.

gtrn of e. coli
we used a recent genome-wide model of e. coli gene transcription in response to selected external signals to predict changes in cell growth after genome modification  <cit> . such model was inferred from experimental data and the, infergene inference methodology  <cit> , which is used to obtain kinetic parameters from experimental steady-state data. the model contains  <dig>  non-redundant genes,  <dig> of which are putative tfs. as detailed in the methods, this model is described by ordinary differential equations for the transcription level of each gene and its transcription regulation. this model allows the assignment of mathematical parameters to promoters and tf sequences, which we have assumed to be independent of genomic context . in our previous work  <cit> , we showed that we could predict experimental growth rates by assigning transcriptional parameters to genome regulatory sequences. such assignment allows us to predict the trn model after reshuffling genetic elements .

evolutionary design of a rewired gtrn
instead of trying to solve the challenging problem of evolving a genome for better growth, which would require a greater degree of accuracy for our fitness function, we attempted to reorganize the genome of e. coli while maintaining its functionality wild-type. we rearranged the trn in terms of regulatory complexity and modularity. we applied our automatic design methodology  <cit>  to perform the genome refactoring in a way that we could later provide a corresponding nucleotide sequence. this entails the rearrangement of the operon structure while maintaining the organism’s original behavior. we modify the gtrn by modifying the placement of genes and altering the promoter regulation, but we do it without loosing the connection with a nucleotide sequence. for instance, the operator sites of many promoter sequences are known, and their mutation to neutral sequences would presumably eliminate the regulation of the promoter. this genetic modification could be implemented in such a way that, once the optimal gtrn is found, we could design the suitable nucleotide sequence of such promoters . the algorithm proceeds in successive rounds of genetic modifications and selection of a collection of independent gtrns , a general strategy in evolutionary computation. genetic modifications consist of the rearrangement of the certain genome regions of the nucleotide sequence of the wild-type genome, and selection is based on two criteria that determine the cellular growth rate and the modularity of the gtrn. alternate phases of genetic modifications and selection are performed to evolve the gtrns and obtain networks achieving the specified function. the mutation operator is conceived such that we could later produce the corresponding nucleotide sequence. according to the genome regions to be rearranged, some rules are described in figure  <dig> to determine the rearranged nucleotide sequences .

methodology for producing a genome sequence for a gtrn
we will design now a genome sequence associated to a given gtrn  by following an iterative procedure. we will start with the wild-type genome sequence, where a given base pair could belong to two possible types of genomic regions: the ones that will be kept fixed and those that could be rearranged . for the former, we defined an intergenic spacer as a genome region that comprises three biological parts: i) a promoter region of a given operon, ii) a ribosome binding site  for the first cistron, and iii) the terminator region of the upstream operon. we choose to keep fixed the rbs sequence of the first gene of each operon because the 5’utr sequence may not be well characterized and it may overlap with the promoter. to infer the rbs sequence, we considered the sequence fragment from the + <dig> position  to the start codon. in some cases, the starting transcription is unknown and, consequently, we defined the rbs taking  <dig> base pairs  from the 5’ utr upstream the start codon. in addition, we also found 5’ utrs in which the size of the nucleotide sequence was less than 15 bp and, to enlarge the rbs sequence, we included an additional 60 bp. although leaderless translation is known to occur in e. coli <cit> , we still consider such 5’utr. although it is well known that the sequence and structure of the 5’utr has a strong influence in translation initiation, we assume that the natural sequence upstream the start codon is already optimized for expression. when open reading frames  move to other operons, they will loose their original rbs. as new rbs, we choose to add the same rbs sequence to any orf arriving to the same destination operon. for this, we could either use a standardized rbs sequence or we could choose another sequence, such as the rbs from first orf contained in that operon. in this later case, we append the inferred rbs sequence for the first orf to each orf of the subsequent cistrons . any other automated protocol to produce rbs sequences will also be limited in accuracy because we did not model the translation rates for our orfs. by using the same rbs for every orf in the destination operon, we better match our model assumptions . this is limited by the fact that i) orfs downstream an operon will have lower translation levels and ii) we did not consider post-transcriptional regulation elements. our algorithm could be extended to remove post-transcriptional elements by codon re-optimizing the orfs and by using rbs without regulatory elements. in addition, we could extend our model by using high-throughput protein copy number data.

then, we collected nucleotide sequences of all orfs of e. coli genome by identifying their start and end from regulondb   <cit> . we systematically added a stop codon  at the end of each orf to define that genome region as a part of the genome susceptible to be rearranged, as a module, in another part of the genome . in regulondb, we identified some overlaps between orfs and promoter regions from operons located in different strands . for those cases, we separated both operons to be rearranged considering that certain orf sequences include small portions of promoter regions.

figure  <dig> lists the possible genetic modifications, which consist of gene rearrangement  and addition/deletion/replacement of tandem promoters, and their translation into the equations. a gene can move to another operon , downstream  orfs that did not move. this changes the equation for such gene to a new one with the regulatory function corresponding to the promoter of the arriving operon. this type of moves do not change very much the regulatory network and we added a genetic move that would construct a combinatorial promoter by appending two promoters in tandem . this allows creating a much complex combinatorial regulation, without having a precise knowledge of the operator sites. we assume that it could always be possible to further optimize a suitable spacer to minimize promoter interference while having a 5’utr for the transcript of the first promoter with similar translation initiation rates than the 5’utr of the second promoter. tandem promoter engineering has been used recently to design nor gates  <cit> . we can also delete  or replace  a tandem promoter.

prediction of a refactored e. coli genome sequence with wild-type behavior in changing environments
we used the implemented evolutionary process to design refactored genomes containing only genetic building blocks that exist within the wild-type e. coli genome. the transcriptional regulation landscape that we explored contained all possible genome reconfigurations that could result from regrouping a set of genes under the control of a wild-type promoter. in figure 5a, we observed a large reduction in the complexity of the refactored trn quantified in terms of the ratio between the number of regulatory interactions  and the number of operons  for the refactored and wild-type trn, using a design function based on scoring the expression of stress genes . the nucleotide sequence of a refactored genome using this design function is provided in additional file  <dig>  analogously, we found that limiting only the expression of genes coding for enzymes or genes related to defense and adaptation in the design produced larger reductions in complexity .

to enlarge the genome design landscape, we allowed the addition of a maximum of three promoters in tandem to modify the regulation of a given operon . we determined a set of e. coli promoters that were potential candidates to operate in tandem . we selected the entire promoter library  used by isalan et al.  to exhaustively explore the effect of multiple genome rewirings on growth rate  <cit> . we also included all e. coli promoters that are regulated by fewer than two master regulator tfs, as defined by isalan et al. . consequently, we considered  <dig> promoters susceptible to tandem incorporation. figure 5a shows that the largest reductions in complexity were achieved using designs that consider stress genes in the objective function . surprisingly, as shown in figure 5b, few operons from the refactored genomes needed a promoter to be added in tandem to modify the gene expression provided by their wild-type promoter. only  <dig> operons within the refactored genomes required the addition of two tandem promoters to guarantee that gene expression could adapt to changes in the environment. such refactored genomes were characterized by operons that captured genes with similar functionality .

analysis of biochemical adaptation to varying environments of the refactored genome sequences
two sets of environments were simulated to explore single environmental perturbations:  a set of  <dig> random perturbations that varied oxygen availability from a fully anaerobic environment to an environment with a rate that was 4-fold greater than the optimal flux value  and  a set of  <dig> perturbations that changed the availability of glucose as the carbon source, ranging from the negative value of the optimal uptake flux to the positive value .

we tested adaptation in refactored genomes by considering the previous four types of selective pressure in the expression score. interestingly, genomes that incorporated tandem promoters achieved low adaptation errors under single environmental perturbations   and over-optimality was even achieved by genomes designed with selection pressure based on genes with enzymatic activity  or related to defense processes . by contrast, genomes that were refactored without the design specification of tandem promoter addition had high error adaptation , except for those refactored considering stress genes. furthermore, we tested the adaptation of genomes designed under multiple perturbations and concluded that evolved genomes that included tandem promoters exhibited over-optimality independent of the objective function imposed in the design. by contrast, genomes refactored by only re-organizing wild-type genes had adaptation errors as large as 〈ξ〉 =  <dig> % .

CONCLUSIONS
biological consequences of computational genome refactorization
genome organization can be simplified without disrupting the response of the genome to environmental changes
in this study, we have developed a computational framework for the design of bacterial genomes that are able to respond to changes in environmental conditions. we used transcriptomic data to infer a continuous model for the transcription of all e. coli genes  <cit> , which we then used to assign appropriate parameters to promoter and tf coding sequences. by assuming that these parameters do not depend on genomic context in most cases, we proposed our first methodology for the automatic design of genome rearrangements under changing environments. our results demonstrate that it is possible to refactorize the genome of e. coli, achieving an 86% reduction in the number of regulatory interactions and operons, while maintaining the ability to physiologically adapt to environmental changes. we found that the refactored genomes contain operons that encode several genes with similar functionality. this is an important result, given that the fitness function imposed to evaluate genome performance did not consider gene function. this agrees with the experimental observation that genes within an operon have similar functions  <cit> . moreover, these genomes acquired the ability to adapt more rapidly to environmental changes, probably as a direct consequence of the reduced number of regulatory elements.

the refactored genomes satisfied the main design specification, which was to maintain the global physiological response under both optimal and changing environments. in addition, we found that there was an increase in the complexity of the internal structure related to the signal transduction for all refactored genomes. more specifically, genomes that evolved under the most extreme environ-ments required a greater re-organization of critical genes under promoters that could sense greater numbers of environmental interactions. interestingly, genomes that were refactored under stressful environments showed higher clustering coefficients than those that evolved under more permissive environments. an intuitive explanation for this observation relies on the differences in the selective pressures imposed by both types of environments. survival and replication in a stressful environment represents hard selection, requiring the coordinated expression of all genes involved in survival. by contrast, replicating in a permissive environment may be equated to soft selection and therefore does not require the coordination of expression because the cells remain able to exploit some components of their environment.

one important application of our results is the ability to infer some principles of genome design. in particular, we studied the refactored genomes that had achieved over-optimality or lost optimality. we tested the anticipatory ability of our refactored genomes by computing their optimality using transcriptomic fitness with the same set of genes used in the refactorization process. interestingly, we found that refactored genomes achieved greater optimality degrees than those of wild-type genomes for both single and multiple environmental perturbations.

extension of this methodology to other organisms
the methodology presented here could be extended to other organisms for which quantitative trn and signal transduction models can be inferred   <cit> . the models should be able to predict genomic transcriptional profiles under several external conditions in order to construct a transcriptomic fitness function. the computational refactorization of the genome of a given organism requires the following information:  genome annotation,  a high-throughput gene expression data capturing genetic and environmental diversity,  datasets of transcriptional interactions  and two-component signal transduction pathways  that have been experimentally verified. further extensions would have to consider the influence of other factors such as 3d localization  <cit> , post-transcriptional regulation  <cit>  and post-translational regulation in prokaryotes  <cit> , or chromatin regulation  <cit>  in eukaryotes. with growing availability of quantitative proteomics data  <cit> , it will be pivotal to include variables representing protein copy number of the tfs into these models.

experimentally testable predictions
proposition of a testable refactored e. coli genome sequence
this work also provides a generic procedure to generate a gene sequence for a synthetic e. coli genome with a targeted transcriptomic response, which we exemplify by proposing a genome that could be engineered by assembling known elements . for this quantitative prediction of a designed genome, we propose combining known promoter regions and transcriptional regulators such that the transcriptional profile could reasonably be predicted. to create more complex promoters, we propose taking advantage of their modularity and fusing some of them in tandem, and choosing a set of promoters for which transcriptional interference  <cit>  would be minimized. notice that the e. coli genome contains  <dig> non-overlapping tandem promoter pairs  <cit> . as sequence repetition could create ectopic recombination events, some care will have to be taken in experimental testing. in addition, wild-type transcription terminators are not completely efficient and are sometimes even absent; therefore, some terminators may have to be replaced by stronger ones . the neglect of non-transcriptional regulation may produce unexpected behavior in certain environments, but this could be remedied by selecting alternative conditions. other undesired behaviors could be alleviated by suitable randomization of the nucleotide sequence with the restriction of maintaining the desired functionality .

application to experimental genome engineering
our computational procedure could also be adapted to the particular needs of experimentalists who are willing to create major gene rearrangements in genomes using in vivo techniques. the recent advances in genome engineering  may enable synthetic biologists to produce large insertions, deletions or inversions in the genome  <cit> . usually, targeted random mutagenesis followed by screening is used  <cit> , but this methodology is tedious when a specific locus is to be targeted, and only a small number of successive modifications  would be practical. therefore, it would be particularly useful for the genome engineer to know in advance the most suitable sequence of experiments to introduce genome modifications. in e. coli, this could be readily done by appropriately adapting the “mutational” moves used by our in silico evolution methodology. such moves should be restricted to their genome rearrangement technologies available at the laboratory. then, one could computationally explore all possible evolutionary paths of n moves that would give the highest fitness under specific dynamic environments. the experimentalist could then engineer the genome by implementing the n consecutive experiments suggested by the algorithm. this computational procedure could also incorporate the constraint that each intermediate genome should be viable.

