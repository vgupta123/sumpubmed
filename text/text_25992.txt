BACKGROUND
the many ongoing environmental changes, such as global climate change, use of agrochemicals and invasion of new species, result in stressful conditions, which challenge the persistence of natural populations and reduce biological diversity . however, environmental stress, an environment that lies outside the range of preferred conditions of an individual and challenges an organism's ability to maintain function  <cit> , can also be a powerful evolutionary force . for instance, stressful environments can cause selection either directly on organismal stress tolerance, or indirectly - and interactively - through correlated ecological changes  on organismal growth and development rates  <cit> . in line with geographic variation in local environmental conditions causing divergent natural selection, and facilitating local adaptation  <cit> , empirical work has found evidence for local adaptation to environmental stress, such as salinity, acidity, heavy metals or temperature  <cit> . however, what are the drivers of divergence along environmental stress gradients in natural populations remains little studied.

chemical environmental changes are an obvious source of environmental stress, and increasingly impact natural populations . one of these is natural and human induced acidification, which has strong lethal and sub-lethal  effects on individuals in a broad range of taxa  <cit> , and may cause strong natural selection . accordingly, there is some evidence for evolution of increased acid stress tolerance and adaptive divergence from zooplankton , fish  and amphibians .

we here studied phenotypic divergence of the moor frog, rana arvalis, along an acidification gradient in sweden. in amphibians, environmental acidity increases embryonic mortality and slows down larval growth and development, resulting in delayed metamorphosis at smaller size . as both embryonic survival and metamorphic traits are important fitness components in amphibians , acidity should cause strong divergent selection on these traits. in accordance, in r. arvalis, evidence for adaptive divergence has been found in embryonic acid tolerance  <cit> , and a recent study on two populations suggested that acidity may select for faster growth, slower development and larger metamorphic size  <cit> . however, to what extent larval trait divergence reflects a general pattern in response to ph mediated selection, and to what extent adaptive divergence occurs in larval stress tolerance  interactions  <cit> ) is not known. we therefore conducted common garden laboratory experiments to study the extent of divergence in embryonic and larval acid stress tolerance, and larval life-history traits among eight r. arvalis populations along an acidity gradient .

many putative selective agents can co-vary in nature, either as a result of correlated changes in response to a main driver, or due to interactions with existing locally varying environmental differences. these then create local variation in combinations of different selective factors. for instance, in addition to declines in ph, environmental acidification leads to several abiotic and biotic changes - such as leaching of metals, reduced humic compounds, increased uv-b radiation, changed population densities and species composition  <cit> . to test for indirect evidence of selection using phenotype-environment correlations, we measured ph and a range of abiotic and biotic environmental variables at each site. in addition to inferences about putative agents of selection along environmental gradients, these measurements allow hypotheses about variation in the strength of divergent selection among natural populations - where estimating the strength of divergent selection is otherwise difficult . in particular, the strength of divergent selection is expected to correlate with the magnitude of environmental differences .

we predicted that 1) if populations have diverged in acid stress tolerance, acid origin populations should show higher acid stress tolerance  than populations from more neutral sites, 2) if populations have diverged in larval life histories, we should see contrasting patterns between acid and neutral origin populations in growth and development rates and metamorphic size, and 3) if environmental acidity  reflects the agent and strength of selection, phenotypic trait values should correlate with breeding pond ph. any deviations from these patterns would suggest that acidity per se is not the most important selective force along this acidity gradient, or that there are constraints  to adaptation.

methods
study species and populations
r. arvalis is a ranid frog that occurs in the western palaearctic in a wide range of habitats and acidity levels  <cit> . breeding occurs in early spring, at higher latitudes soon after spring snow melt, hence coinciding with peak acidity in acidified areas.

eight populations occurring along a ca.  <dig> km transect in southwestern sweden were used in this study . all study sites are permanent ponds or small lakes in forested areas . breeding pond ph among these sites ranges from ph  <dig>  to  <dig> . the exact acidification history of these ponds is not currently known, but is likely influenced by a mix of anthropogenic  and natural acidification , which may have been counteracted in some locations with artificial liming  <cit> . the two most neutral sites  are buffered naturally due to limestone bedrock  <cit> .

the a) approximate numbers of breeding r. arvalis females, b) number of full-sib families used per population, c) coordinates , d) altitude , e) forest canopy closure , f) mean ± sd pond ph, g) likely acidification history, h) average temperature  during march - july  <dig>  i) predator density , j) amphibian larval density , and k) pond size . number of breeding females is based on clutch counts in 2007- <dig>  *study site was only used for environmental information. pond ph is based on averages of three sites within each pond in april  <dig> and april, may and june in  <dig> 

quantification of the selective environment
to characterize environmental differences among breeding ponds, ph and several abiotic and biotic variables known to change as a result of acidification, or to be ecologically important for amphibians, were measured . the abiotic environment was characterized as ph, latitude and altitude, water temperature, pond size and canopy cover. the biotic environment was characterized as predator abundance and tadpole density. these variables were chosen because seasonal time constraints and temperature can have strong effects on larval life history traits in amphibians  <cit> , canopy cover and pond size may affect amphibian growth and development  <cit> , and community composition typically shifts towards more insect dominated predator communities and reduced amphibian densities as a result of acidification  <cit> . to increase sample size for environmental inferences, habitat variables were also measured in one additional population, which was, however, not included in the experimental work .

ph was measured annually since  <dig>  whereas the other environmental variables were quantified in  <dig>  ph was measured in april  <dig> to  <dig>  and may and june  <dig> with an orion 9109wl electrode  attached to a portable field ph-meter . at each pond, ph was measured at three different sites  during one to three visits/year. ph for each pond was calculated based on ph averages of april 2007- <dig>  and april  <dig> and  <dig> , may and june  <dig> .

latitude and altitude were gained from google earth http://earth.google.com/ and used as indicators of large-scale climatic variation. local temperature was measured with ibutton data loggers  in  <dig> from april  <dig>  until june  <dig> . the loggers were set at measuring interval of three hours and placed just below water surface in sealed plastic bottles , near r. arvalis breeding sites. due to technical fault, data from only one logger could be retrieved from two of the ponds . for each pond, the mean temperature was calculated over the whole recording period and across sites.

to get an estimate of pond size, pond area was estimated by multiplying pond length × pond width . shoreline depth at each pond was measured in may and june  <dig>  at three randomly chosen, approximately equidistant, sites . the average of may and june measurements/pond was used as pond depth. pond size  was then calculated by multiplying pond area  with pond depth  and log-transformed for the statistical analyses. the percentage of forest canopy closure was estimated as the proportion of non-visible sky within an angle of 40°- 45° by the same person  in 10% categories  <cit> .

predator and tadpole densities were estimated at each pond in mid may and mid june  <dig> with dip net  sweeps. within each pond, five sweeps at a depth of  <dig> - <dig>  m over a 2- <dig> m distance along the shoreline were made at three equidistantly distributed sites at each sampling occasion . all tadpoles  and all invertebrate  and vertebrate taxa  considered as potential predators were placed in a white square plastic box and photographed for later counts of predator and tadpole numbers. all animals were subsequently released. the total number of predators and tadpoles over the five sweeps/site was counted from the photographs. the average numbers over the three sampling sites per pond in may and june were taken as predator and competitor abundance in each pond.

experimental design and rearing of embryos and tadpoles
five to  <dig> pairs of males and females in breeding condition were collected from each of the eight populations  in spring  <dig>  and transported to the laboratory at uppsala university . the adults were kept in a climate chamber at + <dig> to 4°c until artificial crosses were made a few days later. artificial mating prevented any bias due to differences in exposure in the early environment and assured that the offspring in each family were full sibs. the crosses were performed at +16°c according to  <cit>  with some modifications. sperm production was stimulated by injecting males with ca.  <dig> μg/ <dig> g body mass of the fish hormone lhrh . females were not treated with hormones, as they had already ovulated. sperm from males was collected by rinsing their cloacae with sterile physiological salt solution into  <dig>  l plastic vials containing 10% amphibian ringer solution  <cit> . sperm motility of each male was checked under a microscope. eggs from the females were subsequently stripped into the sperm solution  <cit>  and treated using standard procedures  <cit> . the fertilized eggs were divided to the treatments two hours after fertilization but before the first cell cleavage.

the embryonic experiment consisted of five to  <dig> families/population  with three ph treatments  and three replicates/family/treatment. the larval experiment consisted of four to  <dig> families/population with two ph treatments  and nine replicates/family/treatment. these treatments were chosen as they reflect ph levels at our most extreme sites in the wild and are known to reduce embryonic survival and/or cause sub-lethal effects  in the larvae  <cit> . during both experiments, the experimental vials were randomly distributed over three blocks  according to a known temperature gradient within the room. this design resulted in a total of  <dig> experimental units for the embryonic and a total of  <dig> experimental units for the larval experiment.

embryos and tadpoles were reared in reconstituted soft water , as described in räsänen et al.  <cit> . untreated rsw was used for the neutral  treatment. rsw in the acid  treatment was adjusted with  <dig> m h2so <dig> over two days before use. to maintain appropriate ph and water quality, water was changed every three days in the embryonic and every two days in the larval part of the experiment. prior to each water change, ph was measured in randomly selected experimental vials  with a ross sure-flow electrode  and a thermo orion  <dig> star ph-meter . ph drift between the water changes was low during the embryonic experiment . it was also relatively low during the first half of the larval experiment . during the second half of the larval experiment, ph deviated more strongly due to increasing tadpole biomass and food . however, the low ph treatment always remained clearly acid  and the two treatments never overlapped.

the experiments were conducted in a walk in climate room  with a 17l: 7d photoperiod. during the embryonic experiment, 30- <dig> embryos per replicate were reared in  <dig>  l plastic vials containing  <dig>  l treatment water. embryos were reared from fertilization  to day  <dig>  i.e. when the larvae had hatched and reached the free-swimming stage upon leaving the egg capsule . survival of embryos was recorded during each water change .

for the larval experiment, a randomly selected subset of tadpoles from each family was selected from the neutral embryonic treatment as soon as they had reached gosner stage  <dig> , which occurred  <dig> -  <dig> days after fertilization. we used larvae from the neutral treatment because of high mortality in the acid treatments, which constrained the availability of healthy larvae and might have biased results due to selective mortality. carry over effects from embryonic to larval stages have been shown to be small  <cit> , suggesting that hatchlings transferred from ph  <dig>   to ph  <dig>   are little affected by the change in ph. the tadpoles were randomly assigned to the two ph treatments and reared singly in  <dig>  l opaque plastic containers containing  <dig>  l treatment water. tadpoles were fed ad libitum with finely chopped and parboiled spinach every second day. the amount of food was increased with increasing age of the tadpoles. when the tadpoles approached metamorphosis  the vials were checked daily.

response variables
embryonic survival was recorded by visual inspection at each water change, but eggs were left untouched and only final survival  was used in the statistical analyses. any unfertilized eggs were determined in conjunction to first water change  and were excluded from the analyses of survival. embryos were considered dead if they did not hatch  or were abnormal at hatching , as survival of abnormal hatchlings is very low  <cit> . embryonic survival was therefore estimated as healthy hatched larvae at day 12/total number of fertilized eggs in each experimental unit.

in the larval experiment, survival was monitored at each water change, but only final survival was used in the statistical analyses. at metamorphosis, mass, larval period and average growth rate was estimated for each individual. individuals were dry blotted and their wet mass measured with an electronic balance . larval period was estimated as the number of days from gosner stage  <dig>  to metamorphosis. average daily growth rate  was defined as the ratio of mass at metamorphosis/larval period.

because maternal investment can differ among acid and neutral r. arvalis populations  <cit> , and because egg size/initial size mediated maternal effects can affect larval performance of r. arvalis in a ph dependent way  <cit> , average egg size of each parental female, as well as initial size  of each experimental tadpole, was measured from digital images. for egg size, 20- <dig> eggs/female, and for initial size the individual stage  <dig> tadpole, were placed in a small petri dish, illuminated from below and photographed with a digital camera . for photographing, eggs were covered with water and tadpoles placed in a thin layer of water to avoid dehydration whilst preventing movement. egg size was measured as area  and initial size of tadpoles as total length from tip of the nose to tip of the tail  using the public domain program imagej, version  <dig>  u http://rsbweb.nih.gov/ij/.

statistical analyses
phenotypic divergence
both the embryonic and the larval experiment were performed as a nested randomized block design, where families  were used as random factors, and pond ph , ph treatment  and block  as fixed factors. for pond ph, average pond ph during the embryonic period was used in the embryonic analyses and average pond ph during the larval period in the larval analyses. as it is possible that the lowest ph  experienced by eggs or tadpoles in nature is a better predictor of acidity mediated selection, the same analyses were also run using minimum pond ph . however, as mean and minimum pond ph are highly correlated  and the results in both analyses were very similar , only analyses using mean pond ph are shown here.

all statistical analyses were conducted in sas  <dig>  . embryonic and larval survival were analyzed with generalized linear mixed models with binomial errors and logit link function in the glimmix procedure  <cit> . metamorphic mass, larval period and growth rate were log-transformed to homogenize variances and analyzed with mixed model analyses of  variance using the mixed procedure  <cit> .

egg size and initial size were log-transformed to homogenize variances and analyzed using mixed models with pond ph as a fixed factor, and family as a random factor. the models for embryonic and larval traits were subsequently run with and without egg size  or initial size  as a covariate to control for potential contribution of egg size mediated maternal effects on offspring performance. as none of the interactions between fixed factors and the covariates were significant , the final models only included the covariate main effects and not their interactions. kenward-roger degrees of freedom  <cit>  were used in all analyses. to test whether breeding pond ph is linearly related to phenotypic trait values, linear orthogonal polynomials  <cit>  were used to test for a linear relationship between pond ph and embryonic survival, larval life-history traits, egg size and initial size.

taken together, a significant breeding pond ph main effect would indicate phenotypic divergence in trait means among populations, a significant ph treatment × pond ph interaction would indicate among population variation in ph tolerance , and significant family and ph treatment × family interactions would indicate within population maternal/genetic variation. any effects of egg or initial size would indicate that the responses might be modified by maternal effects. linear effects of breeding pond ph on trait values would indicate a linear increase/decrease in the trait means along the acidity gradient, and that larger phenotypic differences correlate with larger environmental differences . interactions between linear effects of pond ph and ph treatment would indicate a linear increase/decrease in acid tolerance along the acidity gradient.

putative agents of natural selection
in order to explore the relative contribution of pond ph  versus other habitat characteristics using phenotype-environment correlations, both environmental indices and individual variables were used. calculation and results of the environmental indices are shown in additional files  <dig>   <dig> and  <dig>  all habitat variables  pond size, canopy cover, predator density and tadpole density) were first tested for correlations among them . to test for the relative importance of the different environmental variables, a set of models was produced where one environmental variable at a time was included as a covariate. these analyses were performed separately within each ph treatment and larval trait. alternate models were conducted with either an environmental index  or a relevant single environmental measure . as all models were identical in other respects and contained only a single changing covariate, they were compared using f statistics  <cit> . in addition, aic values were used to compare the different models  <cit> . the covariate with the highest f value  was considered to be most strongly correlated with a given larval trait. population and family  were both included as random effects to account for non-independence of experimental units and block as a fixed effect to account for a known temperature gradient within the laboratory.

RESULTS
phenotypic divergence
embryonic survival - low ph severely reduced embryonic survival, as indicated by a significant ph treatment effect . however, populations differed strongly in their responses to ph, as indicated by a highly significant pond ph × ph treatment interaction . contrast results revealed that embryonic survival and pond ph were strongly negatively correlated at ph  <dig>  , not significantly correlated at ph  <dig>  , and significantly positively correlated at ph  <dig>   - indicating that populations with highest embryonic survival in the acid treatment had slightly reduced survival in the neutral treatment. embryonic acid tolerance  was significantly correlated with latitude , most probably because of the strong spatial correlation between pond ph and latitude . using latitude instead of pond ph for the contrast analysis revealed that embryonic survival and latitude were strongly negatively correlated at ph  <dig>   but not significantly correlated at ph  <dig>   or ph  <dig>  .

results are shown for eight r. arvalis populations occurring along a ph gradient. significant effects are highlighted in bold

significant family and family × ph treatment interactions indicated within population maternal effect/genetic variation in embryonic survival and ph tolerance . egg size differed significantly among populations , but was not significantly correlated with pond ph . there was no significant egg size or ph treatment × egg size interaction in embryonic survival, and its inclusion as a covariate did not qualitatively change the results . this indicates that family effects in embryonic survival are independent of egg size.

larval traits - across all populations and treatments, larval survival was generally very high . there were no significant pond ph, ph treatment or their interaction effects on larval survival  and the data were therefore not further analyzed.

metamorphic mass and growth rate decreased, and larval period increased at ph  <dig>  compared to ph  <dig>  , as indicated by significant ph treatment main effects . this indicates sub-lethal acid stress effects on tadpoles. furthermore, populations have diverged in all three larval traits, as indicated by the significant pond ph main effects . significant linear contrasts further showed that metamorphic mass, larval period and growth rate increased with decreasing breeding pond ph . there was no significant pond ph × ph treatment effect on metamorphic mass or growth rate . in contrast, larval period was more negatively affected by the acid treatment in neutral than in acid origin populations , giving rise to a significant pond ph × ph treatment interaction . this suggests that acid origin populations have higher larval acid stress tolerance. the ph treatment dependent phenotypic divergence was also reflected in the relationship between pond ph and larval period: the correlation was stronger at ph  <dig>   than at ph  <dig>  .

results are shown for  a) metamorphic mass, b) larval period and c) growth rate in eight r. arvalis populations occurring along a ph gradient. significant effects are highlighted in bold.

significant family main effects indicated within population maternal effect/genetic variation in all three larval traits . in addition, a significant ph treatment × family effect in larval period suggested within population maternal effect/genetic variation in ph tolerance for this trait. populations  and families within populations  differed significantly in initial size, but initial size was not significantly correlated with pond ph . when initial size was included in the models of larval life-history trait variation as a covariate, it was significantly positively related to metamorphic mass  and growth rate , and significantly negatively related to larval period . these results indicate that initially large larvae grew and developed faster, but these effects were independent of ph treatment . moreover, the results remained qualitatively unchanged when initial size was included as a covariate , indicating that family or population level responses were independent of initial size.

putative agents of natural selection
the analyses comparing effects of all single habitat variables  or habitat indices  found that the main correlates of phenotypic divergence were ph, latitude and predator density. in both treatments, metamorphic mass was most strongly, and negatively, related to pond ph , and negatively, but more weakly, to latitude . the pattern was different for larval period: larval period was most strongly, and negatively, related to latitude in both treatments , and negatively, but more weakly, related to pond ph, and only in the high ph treatment . these effects suggest that acidity may select for an increase in metamorphic size and climatic selection for a shorter larval period in the north. in contrast, larval growth was most strongly  related to one of the habitat indices  and to predator density, and marginally  to pond ph . however, these relationships were apparent only at ph  <dig> . these results suggest that predators, possibly together with canopy cover and/or pond ph, may be the most important selective factors behind divergence in growth rate.

results are shown for a) metamorphic mass, b) larval period and c) growth rate. significant effects  are highlighted in bold. the variable with the highest f value  is considered most important.

discussion
we found clear phenotypic divergence among r. arvalis populations along the acidification gradient: acid origin populations have higher embryonic acid tolerance , faster larval growth rates, longer larval periods, metamorphose at a larger size, and tend to have higher acid tolerance in terms of larval period than neutral origin populations. our findings are in accordance with our previous studies on a smaller set of populations  <cit> . phenotype-environment correlations further indicated that the extent of trait divergence correlates with the magnitude of environmental differences - and therefore presumably with strength of divergent selection . however, a range of selective factors may be drivers of the observed phenotypic divergence. we next discuss evidence for adaptive divergence and the putative agents of selection along this acidification gradient, as well as the general implications of our findings for studies along environmental stress gradients.

evidence for adaptive divergence
adaptive divergence along environmental gradients has been mainly studied in the context of adaptation to metal pollution  and climate , whereas studies along other stress gradients are rare. our study adds to these studies, and provides further evidence for adaptation to acidification . field transplant experiments suggest that the patterns for embryonic survival observed here under simple laboratory conditions also hold in the wild  <cit> . the reasons for this "asymmetric" adaptation are not clear, but could arise if fitness trade-offs become apparent only at extreme conditions  or in other contexts or traits . although the fitness consequences of the observed divergence in larval traits are less clear, large metamorphic size and short larval period are generally assumed to have a positive effect on fitness in amphibians . larval traits show evidence for trade-offs along the acidification gradient . selection seems to favor different local optima along this acidification gradient, which suggests the potential for local adaptation in this system. although more detailed studies and direct fitness estimates are needed to confirm local adaptation, the patterns observed here for embryonic and larval traits are strongly indicative of adaptive divergence and emphasize the importance of early life-history stages for adaptation .

in order for trait divergence to be an adaptation to divergent selection, it is necessary to confirm a heritable basis to the phenotypic traits  <cit> . we here used full-sib crosses on wild caught adults and reared embryos and larvae under laboratory common garden conditions, which does not allow to infer the genetic basis. however, several lines of evidence suggest that the observed patterns indeed reflect adaptive divergence. first, quantitative genetic crosses indicate that variation in embryonic acid tolerance is driven by maternal effects  <cit> , which are clearly adaptive . whether these maternal effects have a genetic rather than environmental basis is work in progress. second, divergence in larval traits is primarily due to direct genetic effects  <cit> . reciprocal crosses between three population pairs  <cit> , and within-population breeding experiments with half-sib  designs in a subset of four of the present populations , find evidence for direct genetic effects, negligible maternal effects and moderate to high heritability  in larval traits. furthermore, when we statistically controlled for initial larval size - indicative of maternal effects - the among population differences in trait divergence were maintained . third, correlations between the extent of phenotypic and environmental differences suggest that variation in trait divergence might reflect variation in the strength of divergent selection . qst-fst comparisons along this gradient  <cit>  further indicate that the patterns of phenotypic divergence observed here are most likely a result of divergent natural selection rather than neutral processes, such as drift and gene flow  <cit> . we next turn to the discussion of the putative selective pressures along this acidification gradient.

agents of selection along the acidification gradient
our phenotype-environment correlations, using several different abiotic and biotic environmental variables, found that trait divergence most strongly correlated with pond ph, latitude and predator density. although we found a correlation between latitude and embryonic acid tolerance, we have no reason to expect increased selection or environmental influence for higher embryonic acid tolerance at lower latitudes. moreover, divergence in embryonic acid tolerance is also seen between populations at similar latitudes  <cit> . instead, we argue that this correlation most likely arose due to spatial autocorrelation between acidity and latitude, and that divergence in embryonic acid tolerance is most obviously driven by pond ph. this is also supported by the parallel patterns between laboratory and transplant experiments  <cit> .

complex life-history traits - such as larval growth and development - are likely under simultaneous selection from different sources  <cit> . in this vein, it is not surprising that our phenotype-environment correlations found that divergence in metamorphic mass is most closely related to pond ph, whereas divergence in larval period is most closely related to latitude, and larval growth to predator density, respectively.

stressful  environments may also cause various forms of selection on stress tolerance and/or trait means , such as organismal growth and development rates . several hypotheses relating to larval life-history trait divergence on the acid-neutral axis were discussed in detail in  <cit>  and we do not repeat them all here. for metamorphic mass, we suggest that large size may be more strongly selected for in acid environments to counteract the negative effects of acidic ph. large size might be selected for due to increased fitness of large juveniles or adults during the terrestrial phase .

for larval period, we found that development rate increased at higher latitudes, which is in accordance with countergradient selection  <cit> . however, in contrast to the commonly observed pattern in other scandinavian rana populations , we found no significant relationship between latitude and growth. we propose that in our study system, seasonal time constraints in the north favor faster development, whereas selection by predators  may drive divergence in growth rates. however, the relative contribution of climatic  and ph mediated selection on larval development is difficult to disentangle here as acidity and latitude were closely spatially correlated. interestingly, populations with higher predator densities had higher growth rates, particularly in the low ph treatment. this could indicate selection for higher growth rates through gape limited predators , such as libellullid dragonflies, which are one of the most common predators of r. arvalis tadpoles in acidic ponds . to shed light on this hypothesis, direct tests of predator mediated effects on larval performance are under way in our laboratory  <cit> .

a few additional points need to be considered. first, our study provides correlative evidence for different selective agents acting on different fitness traits, and that different larval traits respond in part independently. as larval life-history traits can be phenotypically and genetically highly correlated , it would be interesting to study to what extent the different traits indeed respond independently to the different selective agents along environmental stress gradients  <cit> . second, although we find strong correlations between some of our environmental variables and the extent of phenotypic divergence among local populations, there clearly is potential for several other factors to influence the extent of phenotypic divergence. these include variation in the extent of gene flow , the amount and type of genetic variation , as well genetic  and ecological trade-offs  among interacting selective forces. our study was not designed to directly test for effects of individual habitat variables or other constraining factors to adaptation to acidity. additional studies are therefore needed to better understand the relative importance of different selective or constraining factors to adaptive divergence in this system.

CONCLUSIONS
we found evidence for phenotypic divergence among r. arvalis populations inhabiting an acidification gradient. as natural and anthropogenic environmental changes, such as acidification, result in a broad range of abiotic and biotic changes and interact with other geographically varying environmental factors , it is important to investigate a range of putative selective factors. in line with this, acidity per se is the most likely direct selective factor behind divergence in embryonic acid tolerance, whereas divergence in larval life-history traits may be modified by interactions between pond ph, predator densities and climatic conditions - or factors closely correlated with them. this suggests that acidification interacts with local geographic variation in other selective factors in driving adaptive divergence of r. arvalis. as organisms need to optimize fitness in complex environments when faced with simultaneous selection by several abiotic and biotic factors , our findings emphasize the need to consider multiple interacting selective forces to understand the determinants of phenotypic divergence in natural populations and their responses to environmental change.

authors' contributions
sh, al and kr designed the experiments. sh and kr collected the data and sh analyzed the data. sh wrote the manuscript and al and kr corrected and revised earlier drafts. all authors read and approved the final draft of the manuscript.

supplementary material
additional file 1
calculation of habitat indices.

click here for file

 additional file 2
details on the two principal component analyses and the resulting factor loadings. eigenvalues >  <dig> and factor loadings > | <dig> | are highlighted in bold.

click here for file

 additional file 3
f tests and aic values for larval traits from mixed model analyses of variance including habitat indices as a covariate. results are shown for  a) metamorphic mass, b) larval period and c) growth rate. significant effects  are highlighted in bold. the variable with the highest f value  is considered most important. see additional file  <dig> and  <dig> for description of habitat indices.

click here for file

 additional file 4
correlation matrix for habitat variables, embryonic survival and larval traits. significant pearson r values  are highlighted in bold. the correlations are based on population means .

click here for file

 additional file 5
mixed model analysis of variance for larval traits including  initial size as a covariate. results are shown for  a) metamorphic mass, b) larval period and c) growth rate in eight r. arvalis populations occurring along a ph gradient. significant effects are highlighted in bold.

click here for file

 acknowledgements
we thank andrés egea-serrano, nicole hatt, claudio brunold and tove nielson for invaluable help with the field and laboratory work, as well as all landowners for permission to use their sites. the experiments were conducted under the permissions from the county boards in halland and västra götaland counties and from the ethical committee for animal experiments in uppsala county. this study was supported by grants from swiss national science foundation  and swedish research council formas .
