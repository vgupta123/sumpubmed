BACKGROUND
recent advances in high-throughput structural determination techniques and structural genomics initiatives have produced an increase in volume of structural data for proteins prior to knowledge of their functions. with these advances has come the need to rapidly predict functions for proteins based on their structures.

comparison of the overall folds of proteins by programs such as ce  <cit>  or dali  <cit>  can be complemented by focusing on local structural comparisons centred on sites of functional importance such as ligand binding sites or catalytic sites  <cit> . these methods have largely arisen in response to the discovery of proteins sharing similar functions without similarity in their overall folds  <cit>  or proteins adopting the same superfold  <cit>  without functional similarity. local structural comparison methods are based on the idea that geometrically similar sites are likely to have similar functions since their amino acids are conserved in precise orientations in order to perform their chemistry or their similar shapes and physico-chemical properties may be selective for similar small molecules such as substrates, inhibitors or co-factors. hence, finding structural similarity to functional sites of known and characterised proteins may facilitate function prediction for newly determined protein structures even in the absence of overall fold or sequence similarity.

functional site comparison methods essentially fall into one of two categories. the first category provides known templates of specific motifs of conserved amino acids or atoms often involved in enzyme catalysis  <cit> . these are knowledge-based methods which aim to discover new proteins with the same catalytic function. the second category consists of similarity searching algorithms  <cit>  where prior knowledge of motifs is not required and site similarity is assessed by how closely the sites align and/or the proportion of overlap. partial similarity between sites can be detected and hence much larger sites such as ligand binding sites can be compared. methods addressing this problem generally represent functional sites or functional site surfaces as mathematical graphs for graph-theoretic or geometric hashing comparisons where graph vertex positions are placed using a variety of methods. cavbase  <cit> , siteengine  <cit>  and pints  <cit>  for example use positions of pseudo-centres whereas ef-site  <cit>  uses electrostatic potentials and surface curvature. sitesbase  <cit>  and pvsoar  <cit>  use α-shapes and an all-atom model respectively. recently, a statistical approach using bayesian modelling was proposed  <cit> .

the bayesian method gives a complete distribution of probable matches and hence an opportunity to explore several other solutions near the "optimal" solution. in addition, this approach automatically adapts to the level of noise in functional site atomic positions. the bayesian method can also flexibly incorporate concomitant information like amino acid types and their different physico-chemistry classifications in matching biding sites. in principle, the bayesian method could also incorporate all types of prior information on specific binding sites, which is nearly impossible with simple combinatorial approaches like graph matching.

in  <cit>  each "site" consists of a single location, such as a cα atom in an amino acid. but for each cα atom there is also a neighbouring cβ atom which can be paired to it. thus the matching criterion need to be extended to require a close match not only for cα atoms in different configurations but also for the edges connecting cα atoms to their cβ atoms.

in this paper, two substantial advances over  <cit>  are matching of pairs of atoms  by a bayesian method and refining the graph method in matching functional sites. we propose bayesian modelling of graph matches using cα and cβ atoms. this is done by adding a markov chain monte carlo  refinement step to the graph matching method  <cit> .

actually mcmc refinement procedure can be used to refine a match generated by any method. however for illustration purposes, here the graph theoretic method is chosen because it is a well tested method in a variety of geometrical matching problems for protein structure, see for example  <cit> .

the sitesdb database
throughout this work we compared the local structural and physico-chemical environment of protein functional sites taken from a database of known sites   <cit> . sitesdb entries were automatically formed from the pdb  <cit>  by locating the local protein environment  around bound ligands  and author annotated active sites . a protein may contain multiple functional sites so unique identifiers for sitesdb entries were generated from the four letter pdb identifier with an extra integer to distinguish sites from the same protein. for example, the identifiers 1hdx_ <dig> and 1hdx_ <dig> are separate sites from the protein with pdb identifier 1hdx.

the automatic extraction of sites results in multiple and incomplete representations of functional sites containing more than one bound ligand, or sites that are both annotated with site records and contain bound ligands. in these cases a better biochemical description of the site was obtained by merging component sites without duplication of their amino acid contents. sites were merged if ligand atoms occurred within 5Å of atoms in a second ligand. in the absence of bound ligands, sites were merged if they were found to contain common amino acid residues.

representation and matching
we denote two functional sites to be matched by x and y . let the number of amino acids be m and n for x and y respectively and we shall simply use xj, j =  <dig>   <dig>  ..., m and yk, k =  <dig>   <dig>  ..., n to refer to the jth and kth amino acids in functional sites x and y. thus xj and yk are simply the labels for amino acid with no coordinate system. further, let x1j and y1k denote coordinates for cα atoms for the jth and kth amino acids in the two functional sites x and y, respectively. we denote cβ coordinates for the jth and kth amino acids in the two functional sites by x2j and y2k. further, let x <dig> = {x1j : j =  <dig> ..., m}, x <dig> = {x2j : j =  <dig> ..., m} and y <dig> = {y1k : k =  <dig> ..., n}, y <dig> = {y2k : k =  <dig> ..., n}.

we consider matching at the level of amino acid residues. a match between two sites is a mapping between subsets of the residues in each site such that matched residues can be superimposed in three-dimensional space. thus the problem is finding correspondence between amino acids of the two functional sites and the geometrical transformation to bring the corresponding atoms into registration. knowing correspondence, solving for transformation is trivial and vice versa, but both are not known before hand.

we denote the matching between amino acids in x and y using a matrix m:

 mjk={1if the jth amino acid corresponds to the kth amino acid,0otherwise.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgnbqtdawgaawcbagaemoaaomaem4aasgabeaakiabg2da9maaceqabaqbaeaabigaaaqaaiabigdaxaqaaiabbmgapjabbagamjabbccagiabbsha0jabbigaojabbwgaljabbccagiabdqgaqjabdsha0jabdigaojabbccagiabbggahjabb2gatjabbmgapjabb6gaujabb+gavjabbccagiabbggahjabbogajjabbmgapjabbsgakjabbccagiabbogajjabb+gavjabbkhayjabbkhayjabbwgaljabbohazjabbchawjabb+gavjabb6gaujabbsgakjabbohazjabbccagiabbsha0jabb+gavjabbccagiabbsha0jabbigaojabbwgaljabbccagiabdugarjabdsha0jabdigaojabbccagiabbggahjabb2gatjabbmgapjabb6gaujabb+gavjabbccagiabbggahjabbogajjabbmgapjabbsgakjabcycasaqaaiabicdawaqaaiabb+gavjabbsha0jabbigaojabbwgaljabbkhayjabbeha3jabbmgapjabbohazjabbwgaljabc6cauaaaaiaawuhaaaaa@880d@ 

we denote the transformation to bring the configurations into alignment to be xij = ayik + τ for mjk =  <dig>  i =  <dig>   <dig> where a is a rotation matrix and τ is a translation vector.

our matching considers cα and cβ atoms of each residue . note that since there are several examples of similarities in protein functional sites from evolutionarily unrelated proteins, which do not preserve the amino to carboxy terminal order of the matching residues, methods in this paper take no account of the sequential ordering of residues.

at the least restricted level, any residue was allowed to match any other, thus producing matches considering only the form or shape of the sites, in terms of the spatial arrangement of their constituent residues, irrespective of residues' identities and physico-chemical properties. a more restricted scheme was also considered where residues were only allowed to match within the same physico-chemical class: hydrophobic , polar , charged  or glycine .

it should be emphasised that this scheme was chosen to illustrate the value of the mcmc procedure, and that the procedure would be equally applicable to other possible atom matching schemes  or other physico-chemical groupings.

graph theoretic approach
principles of graph theory have been applied to matching biomolecular configurations for some time  <cit> . these techniques are also used in computer vision research  <cit> . in this study each functional site is represented by a mathematical graph where vertices are placed at amino acid positions. each vertex is connected by an edge to every other vertex in the same graph and each edge is labelled with the inter-residue distance  <cit> . finding matching parts of the functional sites is equivalent to searching for maximum similarity between the graphs.

combinatorial algorithms inherently require exhaustive search of the solution space. for example in graph matching an exhaustive search for solutions with various matching distance thresholds in a suitable range would be required to guarantee globally optimum solutions. in our applications case  <dig> requires a different threshold to cases 1– <dig> in order to give optimal matching. case  <dig> requires a distance threshold of  <dig> Å while cases 1– <dig> require a distance threshold of  <dig> Å. stochastic approaches are the obvious candidate for consideration to avoid exhaustively searching the solution space.

the bayesian model
the bayesian framework is particularly appealing in specialised problem domains since the "objective"  is a product of the "prior" and the "likelihood". the likelihood gives an indication of how well the observed data is consistent with parameters of the model and the prior can be used to incorporate expert knowledge of the problem.

the likelihood in  <cit>  can be interpreted on considering that some amino acids in the two functional sites are related  under rigid body motion transformation subject to gaussian, n errors in the coordinates of the atoms. these errors could be due to crystallographic imprecision or protein phylogeny differences. the prior consists of the distribution on the transformation parameters. the joint posterior distribution  is derived. the bayesian method simultaneously estimates the matching and transformation parameters. thus the whole posterior distribution is available to extract the statistical information on the parameters. here we use a loss function to obtain point estimates of the matches being of the main interest. in the methods section we show the connection between the bayesian method and minimising the rmsd when matches are known. minimising rmsd is an appropriate criterion for optimising the geometrical transformation, given the matching. however, in no way does that logically imply that rmsd is an appropriate measure of quality of the matching itself – indeed one can trivially make the rmsd equal to  <dig> by matching just one pair of points, and in general minimised rmsd will increase with the number of points matched. rmsd can only be used as a measure for quality of match given the same number of matched points hence some other measures e.g. p-values  <cit>  are required to assess the quality of a match.

we have also incorporated the expert knowledge on amino acid types through a prior on the matches.

assessing the quality of matches
a number of parameters are used to assess pair-wise matching solutions. we first consider the number of matched residues and the root mean square deviation  between matched atoms. it is intuitively clear that matches of lower rmsd over larger numbers of matching residues are more statistically significant. a measure of this significance has recently been suggested  <cit> , and was modified in this work to correct for the number of amino acids in functional sites being matched. the null hypothesis considers that we are matching random configurations. however for matching more than two atoms  in a single amino acid the null hypothesis is still matching random configurations but with some dependency  for atoms within the same amino acid.

the formula proposed is based on the geometry of a match with a given rmsd level, taking into account the abundance of different amino acid types and the different geometry that applies when various number of atoms are used to represent each amino acid. an extreme value distribution was fitted to the number of matches with an observed rmsd or better. thus p-values formula is:

 p =  <dig> - e-e 

where e is the expected number of matches with an observed rmsd or better. we calculated e-values with a correction for the number of amino acids in the functional sites. the formula for expected number of matches with an rmsd value rm or better is found to be

 e=cabqpΦrm <dig> q− <dig> st,q≥3
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqabeqacaaabagaemyraukaeyypa0jaem4qamkaeiikagiaemyba0maeiilawiaemoba4maeiykakiaemyyaemaemoyai2aawbaasqabeaacqwgxbqcaagccqwgqbaucqqhmogrcqwgsbgudaqhaawcbagaemyta0eabagaegomaijaeiola4iaegyoakjaeg4mamjaemycaenaeyoei0iaegynaujaeiola4iaegioagjaegioagdaaowaamwaaeaacqwg5bqecqwgsbgudaqhaawcbagaemyta0eabagaegomaidaaagccaglbbgaayzxaawaawbaasqabeaacqwgtbwuaagcdawadaqaaiabdqha6jabdkfasnaadaaaleaacqwgnbqtaeaacqaizawmaaaakiaawufacagldbaadaahaawcbeqaaiabdsfaubaakiabcycasaqaaiabdghaxjabgwmizkabiodazaaaaaa@5e3c@ 

where p, the number of binding sites that were matched corrects for database size  <cit> . Φ is the product of percentage abundances of all matched amino acids, q is the number of matched amino acids, s is the number of amino acids with two atoms matched, t is the number of amino acids with more than two atoms matched. our application uses dataset similar to previous studies  <cit>  hence we use the same empirically derived constants: a =  <dig>  ×  <dig>  b =  <dig>  × 10- <dig>  y =  <dig>  and z =  <dig> . in our applications, t =  <dig>  c=3!
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgdbwqcqggoaakcqwgtbqbcqggsaalcqwgubgbcqggpaqkcqgh9aqpcqaizawmcqgghaqidaqadaqaauaabeqaceaaaeaacqwgubgbaeaacqaizawmaaaacagloagaayzkaawaaewaaeaafaqabegabaaabagaemyba0gabagaeg4mamdaaagaayjkaiaawmcaaaaa@3db5@ is a correction factor for the number of amino acids, m and n in the functional sites. the correction factor is derived by considering that matching  <dig> points exhausts all degrees of freedom in optimal matching of rigid bodies  <cit> . indeed, the first exponent of rm :  <dig> q -  <dig>  ≃ 3q -  <dig> which is expected from the mardia-dryden distribution of size-and-shape  <cit>  so there is some theoretical support to the fitted formula, partly because for q matches in three-dimensions, the degrees of freedom are 3q -  <dig> since we loose  <dig> degrees of freedom for translation and  <dig> for rotation.

RESULTS
we considered two binding sites, the nad binding site from an alcohol dehydrogenase structure , and a larger nadp binding site from a  <dig> – β hydroxysteroid dehydrogenase  which includes both the co-factor and substrate binding regions. for these binding sites we performed the following matching studies

1) a functional site of alcohol dehydrogenase against nad binding sites from proteins in the same scop family as alcohol dehydrogenase .

2) a functional site of  <dig> – β hydroxysteroid dehydrogenase against nad binding sites from proteins in the same scop family as  <dig> – β hydroxysteroid dehydrogenase .

3) the alcohol dehydrogenase functional site in  against nad binding sites from proteins in the same scop superfamily as alcohol dehydrogenase but different families .

4) the alcohol dehydrogenase functional site against

fad/nad binding sites from proteins in fad/nad-binding domain .

the first of these test cases is the most straightforward, involving matching the nad binding site against similar sites in closely related proteins. the second is similar, but more challenging in matching, because the larger 1a27_ <dig> site also incorporates the substrate  binding region. the associated family  is functionally broad and members catalyse reactions on a variety of diverse substrate molecules leading to variations in functional site shapes. matching methods therefore need to identify matches in the related co-factor binding region and ignore local site dissimilarities owing to substrate variation. the third test case considers similarities in sites with more distant evolutionary relationships . the fourth test case examines the ability of the method to locate site similarities between different folds that bind the same or related ligands.

case 1: site 1hdx_ <dig> matching against its own scop family
in the case of matching without property information, most sites in the family show a match with 1hdx_ <dig> with a low rmsd  and a significant number of corresponding residues . however, this is not the case when amino acid property information is taken account of, and a minority of the matches show relatively high rmsds , over generally lower numbers of matching residues. thus it appears that lower quality matches can result from the use of amino acid property information, perhaps because these close relatives have conserved the shape of the binding site but not the physico-chemical characteristics. this may happen in binding site regions whose properties are not crucial to ligand binding; it is interesting here because with our use of very broadly defined physico-chemical groups it implies significant changes of physico-chemical properties.

figures 1b and  <dig> show the effect of the mcmc refinement on the graph only matches of figure 1a. the same basic conclusions can be drawn from figure 1b as from figure 1a. however, from figures 1b and  <dig> it is clear that in a number of cases when matches with amino acid property information are considered, the mcmc refinement procedure produced significant improvements in the rmsds . thus the refinement procedure is able to improve some matches, even in this case of closely related sites.

the overall effect of the refinement procedure within this family can be considered in terms of the statistical significance of the matches obtained. this information is summarised in table  <dig>  when taking physico-chemical properties into account, 125/ <dig> sites produced significant matches before refinement, and this increased to 131/ <dig> after. we use the p-value  <dig>  for the significance level. without taking physico-chemical properties into account, 142/ <dig> sites produced significant matches  before mcmc refinement step; this increased to 143/ <dig> sites after the refinement.

the improvement was a functional site from  <dig> -dienoyl-coa reductase  which before refinement matched with an rmsd of  <dig> Å, a number of corresponding amino acids equal to  <dig>  and a p-value of  <dig> ; after mcmc refinement step the rmsd was  <dig> Å, the number of corresponding amino acids was  <dig> and p-value was  <dig> .

some examples where the mcmc refinement step produced improvements with obvious biochemical relevance are the sites in quinone oxidoreductase  and hypothetical protein yhdh . the proteins in this family share a well known glycine rich motif  in the binding site. for 1qor_ <dig>  before mcmc refinement step,  <dig> glycines in dinucleotide binding motif glggvg were matched by graph matching alone and this increased to  <dig> glycines after mcmc refinement. in the case of 1o8c the motif includes  <dig> glycines, of which  <dig> were matched before mcmc refinement step and all  <dig> after. the full matches with these motifs highlighted are shown in figures  <dig> and  <dig> 

case 2:  <dig> – β hydroxysteroid dehydrogenase and family
the effect of mcmc refinement on graph matches for the functional site of  <dig> – β hydroxysteroid dehydrogenase  matching against nad binding sites within the same scop family  are shown in figure  <dig> and table  <dig>  in the case of this more complex site the effect of mcmc refinement is greater, increasing the number of sites producing statistically significant matches from  <dig> to  <dig> of  <dig> sites. figure  <dig> shows that most of these improvements are associated with an increased number of matching residues at a similar rmsd, but in a minority of sites rmsd also improved. although this family catalyses reactions on a diverse range of substrates, the members have a clear evolutionary relationship, and statistically significant matches at least in the co-factor binding region should be expected. these results show that mcmc refinement of the initial match is often required for these to be detected. when comparing matching with and without amino-acid physico-chemical property information similar results to those of case  <dig> were obtained .

case 3: alcohol dehydrogenase and superfamily
in the case of the more distant evolutionary relationships probed by matching the site from alcohol dehydrogenase  against members of the same scop superfamily but from different families, mcmc refinement also produced a large increase in the number of statistically significant matches. of  <dig> sites,  <dig> produced significant matches using graph matching alone, and this was increased to  <dig> by mcmc refinement . as in case  <dig> above, it is common with these more distantly related nad binding sites that significant matches involve the well-known glycine rich motif. an example of a match with the site 3dbv_ <dig> in the glyceraldehyde-3-phosphate dehydrogenase structure is shown in figure  <dig>  in which this motif is highlighted.

case 4: alcohol dehydrogenase and fad/nad-binding domain
the fad/nad-binding domain is classified as a different fold in scop to the cases considered hitherto. nevertheless, as its name suggests it binds ligands of interest in this work, nad and more commonly fad. the latter dinucleotide ligand is related to nad: approximately half of the molecule  is identical to nadp while the other half differs substantially, with a flavin group replacing nicotinamide. it is known however that the ligand binding sites of this fold and the rossmann fold are related, and both include glycine rich motifs associated with binding the shared phosphate groups. thus some significant matches between these binding sites might be expected on biochemical grounds.

in this case, we consider matching without physico-chemical group information with the initial graph theory match using a matching tolerance of 1Å. as shown in table  <dig>   <dig> of the  <dig> site matches showed statistical significance with graph matching only, and a further  <dig> attained this with mcmc refinement.

performance of mcmc
in addition to using rmsd as a diagnostic tool for monitoring convergence and using p-values as an objective function to compare the performance of graphical and mcmc methods, we also consider diagnostic plots and quantities for the bayesian model stability and mcmc convergence.

we can see  that the number of matches, l=∑jkmjk
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgmbatcqgh9aqpdaaeqbqaaiabd2eannaabaaaleaacqwgqbgacqwgrbwaaeqaaaqaaiabdqgaqjabdugarbqab0gaeyyeiuoaaaa@37b2@ at each iteration for most cases converged i.e. variance for l is very small. there are very few exceptions where convergence was not reached e.g. 1a71_ <dig>  3hud_ <dig> and 1pl8_ <dig> in case  <dig> when not using amino acid properties. here variances for l are very big which suggest non-convergence of the mcmc.

discussion
since the connection between statistical and biological significance is not straightforward example applications above were carefully chosen to be well understood cases where matches can be interpreted relatively easily in biochemical terms. for structural and evolutionary relationships scop  <cit>  was used. it has been seen that mcmc refinement step can provide significant improvement over graph-matching techniques.

in this paper the method uses matching schemes that are relatively unrestricted in terms of amino acid identity . as currently formulated it is therefore better suited to the study of larger ligand binding sites, than smaller sites associated, for example, with enzymatic catalysis. the former are more likely to be defined by shape and physico-chemical properties, while the latter depend critically on precise amino acid residue identities. for our example applications we have therefore chosen sites for the binding of some very common biochemical ligands related to nad ) and fad . these ligands are bound as co-factors by a large variety of enzyme domains, many of which come from the rossmann family of protein folds. importantly, there are many proteins of known structure that bind these related co-factors ranging from close evolutionary relatives, through very distant relatives to proteins of different fold and likely independent evolutionary origin.

the examples given above make a clear case that mcmc refinement can improve ligand binding site matches generated by graph matching, in terms of both the statistical and biological significance of the match. we attribute this success to the lack of dependence on strict distance matching criteria, which are rigidly enforced in graph matching. statistical modelling in refinement of matches appears to have been successful in automatically adapting to shape variations in ligand binding sites, which might be due to different noise levels in atomic positions or protein phylogeny differences, among other factors. refined matches usually retain a similar rmsd, and achieve greater significance through expansion of the number of matching residues from the core graph match. we have noted however that in some cases significant reductions in the match rmsd are also achieved by refinement.

dependence on a strict matching tolerance is not limited to graph matching, but is also a feature of other matching methods commonly used in the field . it is important to note that the mcmc refinement procedure can be applied to a starting match generated by any method; and that the graph procedure chosen here was simply intended as an example. equally mcmc procedure can be applied to matching with no previously generated starting match, for example by starting from randomly generated matches. that is, the mcmc method provides a stand-alone algorithm for matching. however, we find that obtaining good matches by this method is very expensive in terms of computational time. while methods such as graph matching can be applied to database searching, where a site is matched against all members of a large database of sites, this would be impractical for matching by mcmc alone with modest computing facilities. there is also a need for closely monitoring convergence diagnostics. we suggest therefore that the mcmc procedure would be most advantageous when applied to the best hits from a database search using a faster method, and that in many cases it would increase the number of significant hits. thus this method is aimed at refining matches and complementing other methods e.g. graph matching as used here. furthermore, the method provides the full joint posterior distribution so that we have for example, the posterior distribution for the matching matrix  as well as the parameters of the transformation simultaneously. there is flexibility in bayesian approach due to the ability to specify distributions on matching coordinates and relative probabilities on the orientation of matching residues as opposed to using matching distance threshold as in combinatorial methods.

from our experiments, matching both cα and cβ atoms in our extended model gives solutions with smaller rmsd values  than when matching using cα atoms only.

our approach using mcmc with detailed balance update and drawing from the posterior of all parameters in principle help escape local maxima for the model better than alternative methods using for example an annealing schedule.

furthermore, quantifying the quality of the solution by rmsd in addition to the number of matches ensures that reported improvements over graph matching  really occur in one single mode for the match matrix m. thus a smaller rmsd guarantees that we have a proper summary for m as opposed to having a point estimate of the match matrix invalidly summarising two or several solutions that the markov chain visited separately, each with a particular probability.

CONCLUSIONS
we have made only a very basic study of the effect of including amino-acid residue physico-chemical property information in matching, contrasting matches obtained without restriction  with slightly more restrictive matching . it is interesting that even with very broadly defined groups, fewer statistically significant matches are generally obtained than when matching is without restriction. this could suggest that the physico-chemical properties of sites binding the same or similar ligands can change significantly in evolution. it is however most likely to reflect increased flexibility to change in peripheral residues that are less important for binding, and needs further investigation. the main point of this work is that mcmc refinement can improve matches under either matching regime. indeed in a few cases of matching with/out physico-chemical groups, we showed that some graph matches without statistical significance were converted to significant matches by the mcmc procedure, revealing that using graph matching alone could lead to some erroneous conclusions in this respect.

