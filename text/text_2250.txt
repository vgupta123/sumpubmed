BACKGROUND
microarray and other high throughput  technologies have exponentially increased in popularity in recent years and consequently have generated tremendous amounts of data. this data provides great opportunities for systems-level understanding of the underlying biological themes of complex experiments. as a result, a wide range of software tools that process and analyze the data using different approaches and algorithms have been developed including clustering methods  methods, pattern extraction method  <cit> , identifying differential gene lists from two or more classes contrasts  related methods  <cit> ). in order to place these patterned or differential genes into their biological contexts, they can be mapped into pathways or networks for further analysis of biological associations and relationships among them as well as other documented relevant genes curated from the literature  <cit> . alternatively, functional group or gene set overrepresentation analysis  methods  <cit>  or gene set-based enrichment analysis  can be used to identify the significantly affected pathways or gene sets that are enriched or over-represented within a list of patterned or differential genes.

the enormous increase in availability of data from studies using similar biological systems, independent samplings, and/or technical platforms  allows an integrative and comparative analysis to be performed. this provides for a deeper understanding of the underlying biology and consolidation of initial observations made from individual studies. furthermore, the systems-oriented approach allows for additional insights from combined datasets. for example, diseases such as prostate cancer have been studied by many different groups. these data from different platforms and independent samplings provide the opportunity not only to assess the consensus of these studies and the variation levels of the patient population, but also to perform integrative analysis for signatures at both gene and pathway level.

a conventional way to integrate and compare multiple experiments derived from independent research groups or even different technologies for common or unique underlying biological themes is to derive common genes amongst them before subjecting them to enrichment analysis to reveal the underlying biology. however, such an approach often encounters limitations caused by the diversity of technologies and the complexity of the biological system itself.

many of the available software tools primarily retrieve expression patterns at the individual gene level and generate a list of genes that are differentially expressed or have certain expression patterns across samples. even the software tools that employ ora or gsea methods  <cit> , usually consider only one or very limited number of gene lists at a time. although a great deal of attention was placed on gene-level expression patterns initially, there is an urgent need for capturing the pathway-level patterns that may represent the common or unique biological themes, which are embedded in multiple genes lists or multiple datasets from different, but related studies.

it has become more and more evident that gene level signatures or classifiers that can consistently characterize different tumor types are relatively hard to validate across different studies due to the complexity of the underlying biology , experimental variation, and even the choice of data processing  and analysis methods/algorithms. this observation likely results from the fact that many complex diseases including cancers, heart disease and hypertension have been shown to be caused by mutations in multiple genes in the same or related pathways  <cit> . while biologically relevant genes may consistently behave in correlation with an associated phenotype across a population, it is more likely that common pathways can be impacted through distinct gene events that are not reflected at the individual gene level. this seems particularly relevant considering the stochastic nature of many epigenetic events that lead to disease states. for example, evidence derived from the studies on multiple prostate datasets of different research groups has shown that many pathway/gene set enrichment analysis or group testing methods identified the same or related pathways/gene sets that were either experimentally validated or believed to be more likely involved in the pathogenesis of prostate cancer. furthermore, these pathways/gene sets appear to be more consistent and reproducible than simple gene signatures between these datasets  <cit> . these, and similar observations have fueled efforts to evolve from gene-level signatures into pathway-level signatures. similarly, elevation of gene-based classification methods into pathway-based classification methods is now being actively pursued in the field. the gene-by-gene approach or gene-level paradigm failed to put single genes in an overall functional context, and consequently ignored other relevant genes that were known to have biological relevance or showed similar expression profiles or correlation with the phenotypes under study. now that independent studies of the same or similar subjects produced gene lists with very low levels of overlap  <cit> , it makes more sense to compare these gene lists at the pathway-level for common and unique biological significance.

using this rationale as our motivation, we developed a high-throughput pathway pattern extraction pipeline  within the existing pathway analysis tool wps  <cit> , to specifically address the need for pathway-level comparative analysis using pathway-level enrichment patterns. the method can explore the biological commonality or uniqueness at the level of a pathway or biological process from different but relevant biological systems. with the help of ppep, we can intuitively visualize the patterns of pathway-enrichment across the multiple gene lists or datasets the method also reveals the relationships and data behavior of the involved genes from the gene lists or datasets that are associated with these pathways.

as a proof of concept of this exploratory tool, we have used ppep to analyze both public microarray datasets and datasets from our collaborators. in summary, we found that this new analysis pipeline dramatically enhanced the ability of research investigators to uncover the underlying biological themes that are shared or unique among different but related systems represented by these genes lists or datasets through pathway-level comparative analysis.

implementation
pathway pattern extraction pipeline dissects pathway-level enrichment patterns for biological themes
the first version of wholepathwayscope or wps provides a platform for pattern extraction at the gene-level and also allows generation of gene-term association networks   <cit> . in this newly developed high-throughput pathway pattern extraction pipeline , we extended that capacity into a pathway-level pattern extraction method that retrieves the patterned pathways based on enrichment levels of pathways across gene lists or datasets. from the patterned pathways, the associated genes can be retrieved and displayed in the context of gtans  <cit> . the objective of such a method is to combine pathway-level enrichment analysis, heatmap/clustering analysis, and pattern extraction to look for pathway-level enrichment patterns as underlying biological themes.

ppep is implemented within the existing wps software platform and runs in the wps environment. it utilizes an enhanced wps internal database with more species coverage  and more functional categories including gsea gene sets, predicted transcription factor target genes, and mirna target genes for human and mouse. the goal of ppep is to perform pathway-level comparative analysis of underlying biology represented by multiple lists of signature genes, differential genes, or patterned genes derived from different studies, different groups, and/or even different technologies and platforms. in our current release of wps, ppep works side by side with our newly developed pathway-ranking method-slepr  <cit>  forming the main pathway-level analysis core utilities in wps. although our current version of wps is a window-specific application, we are currently planning to port this application to java so that the operating system restriction will be removed.

as illustrated in figure  <dig>  ppep consists of several functional interfaces that allow a designated analysis procedure to be executed in a step-by-step fashion. the modular design through multiple interfaces allows the user to assess results at each stage and then proceed as desired.

the generic step-by-step procedure for ppep is described as follows . first, multiple gene lists from different sources are subjected to batch computation for enrichment analysis for selected functional categories . the enrichment analysis is performed using fisher's exact test, as described previously  <cit> . the result for each list is written into an individual file. next, the p-values of each list for each term in these result files can be transformed and merged together as a matrix of enrichment scores  in a single stanford format file  <cit> , in which each row is a term and each column is a gene list. alternatively, fdr and listhits can be merged together in a similar way. for step  <dig>  the matrix of ess can be subjected to clustering analysis using many existing common clustering analysis tools  <cit> , ptm-based pattern extraction using tm <dig> from tigr  <cit> , or pathway pattern extraction within ppep . then at step  <dig>  the associated genes can be retrieved from the patterned pathways  . finally, the retrieved genes can be displayed in the context of gtans, as described previously  <cit>  . the more detailed description on the features and implementation of ppep is included into the additional file  <dig> .

data analysis using ppep
the ppep in wps provides an opportunity to study the underlying common or unique biological themes among multiple gene lists derived from related but different systems or class comparisons. it can also be used to assess different datasets with the same or even different microarray platforms or htp datasets using other technologies that measure different aspects of the biological systems. for example, one could ask what can be found in common between different studies of the same disease, since it has been found in many cases that only a few common genes are found for similar studies or for the same study but with different analysis methods  <cit> . however, the levels of consistency could be higher and more obvious when evaluated at the pathway level. the result section of this manuscript illustrates case studies with the ppep using real data examples to describe some analysis schemes to seek common or unique biological themes embedded in different studies.

RESULTS
the major features and functionalities of the newly developed pathway pattern extraction pipeline  in wps are illustrated using example data in the following section. although only microarray data is utilized here as examples, any source of htp data would be equally suitable for the analysis with ppep. more examples are also provided as supplementary files.

seeking common biological themes from different studies on the same subjects
one of the major advantages of ppep is the ability to compare the biological themes for multiple gene lists derived from different studies at the pathway-level. to provide examples of such an analysis scheme, we chose to use the prostate cancer datasets derived from different research groups and collected in the oncomine database  <cit> . this allows different studies on the same subjects to be compared at both the gene and pathway levels. the reason we chose prostate cancer is that this type of cancer has been well studied and there are many microarray datasets available on different platforms and from different research groups. our analysis goal is to compare the differential genes derived from the different studies and to seek the common biological themes as the consensus  that are embedded in these differential gene lists.

from the oncomine database, we downloaded a total of  <dig> microarray datasets that all specifically studied prostate cancer  <cit>  but with different microarray platforms . the oncomine database  <cit>  has done gene-level analysis on each of these datasets and reported the differential gene lists  between prostate tumor and normal or benign tissues. we can immediately subject these lists to analysis with ppep. since the same type of analysis was applied to all of the datasets in the oncomine database, it is reasonable to assume that the statistical criteria to generate the differential genes are consistent for all of the datasets such that the derived differential gene lists can be compared at pathway-level directly.

conventionally, to identify the common elements between datasets from different studies, the shared differential genes can be obtained, from which the biological themes can be deduced using enrichment analysis methods  <cit> . it has also been reported that analysis at the pathway level can improve the comparability of different datasets  <cit> . our ppep method is intended to improve the comparability of different datasets by simply extracting pathway enrichment patterns.

to compare the conventional gene-level analysis method with our pathway-level pattern extraction method implemented in the ppep, we first used wps gene pattern extraction feature to retrieve  <dig> genes, which are differentially expressed between prostate tumor and normal tissues and are commonly shared among all of the  <dig> datasets . then we subjected the list of these  <dig> genes  to enrichment analysis in wps from both go  biological processes  and gsea annotation. conventionally, the enriched terms from the 52-gene common gene list would be treated as the common biological themes among the  <dig> independent datasets. to compare results with the conventional method, we directly used our ppep to do pathway pattern extraction using the differential gene lists from all of the  <dig> datasets for gobp and gsea annotations. for gsea annotations, our pathway pattern extraction method obtained  <dig> terms that are significantly enriched  consistently in differential gene lists of all  <dig> datasets . when the 52-gene common gene list was used in the conventional enrichment analysis for gsea annotations, only  <dig> terms are significantly enriched . furthermore, among the commonly enriched  <dig> terms that we obtained by pathway pattern extraction, there are  <dig> terms directly involved in cancer-related processes, which are shown in the heatmap . among these  <dig> cancer-related terms, only  <dig> are significantly enriched in the 52-gene common gene list . similarly, there are only  <dig> go terms that are significantly enriched in the 52-gene common gene list, while there are  <dig> gobp terms derived from pathway pattern extraction that are enriched consistently in the differential gene lists . after taking a close look at these gobp terms, although there were many apoptosis-related gobp terms repeatly appearing in the patterned term lists obtained from the ppep , there were no apoptosis or cell death related terms enriched in the 52-gene common gene list . perturbation of apoptosis-related processes is well known to play critical role in carcinogenesis. these observations suggested that our pathway pattern extraction method provided by the ppep was able to uncover many of the significant terms, which were missed by the conventional gene-level based enrichment approach. the pathway pattern extraction method may be much more powerful than conventional gene-level based approach at revealing the embedded biological themes. importantly, by identifying additional terms, the ppep method provides the researcher with more information to consider with their own biological domain expertise.

in order to evaluate how useful pathway pattern extraction would be from a generic perspective, we also used ppep to look for higher level enrichment patterns for transcription factor targets, mirnas targets and kegg pathways. we extracted  <dig> potential transcription factors with binding sites enriched consistently in each of the differential gene lists from all  <dig> datasets . among these transcription factors, ap- <dig>  <cit> , sp <dig>  <cit> , and nf-kb  <cit>  are either well known or implicated by many studies to be associated with cancer progression. interestingly, only sp <dig> was also enriched within the 52-gene common gene list derived from gene-level method . we then extracted  <dig> mirnas with their predicted targets enriched within the differential gene lists from at least  <dig> of the  <dig> total datasets . among these mirnas, there are quite a few that have been previously reported to be aberrantly expressed in cancer or related to carcinogenesis, and have been proposed to function as a novel class of oncogenes or tumor suppressor genes  <cit> . interestingly, some of them were also enriched within the 52-gene common gene list derived from gene-level method, although many of them were missed from the enrichment result of 52-gene common gene list . even for kegg pathways  <cit> , we extracted  <dig> kegg pathways enriched within the differential gene lists from at least  <dig> out of the total  <dig> datasets . many of these pathways such as integrin-mediated cell adhesion  <cit> , mapk signaling pathway  <cit> , tgf-beta signaling pathway  <cit> , and wnt signaling pathway  <cit>  have been implicated in tumor progression and carcinogenesis. however, none of these significant kegg pathways were enriched within the 52-gene common gene list derived from gene-level method .

these observations suggested that ppep can not only identify additional terms or wider biological themes that may be missed by conventional gene-level based methods, but also may provide a way to cross-validate the results derived from the gene-level based methods since it should also include any such terms.

seeking unique biological themes specific for tissue types
ppep can not only help identify common biological themes among different datasets or studies as described in the above case study, but also can help uncover uniqueness of a subset that is distinct from the rest of a dataset or study. here, we describe a case study that looks for tissue-specific biological processes from the well known public microarray dataset derived from  <dig> human tissues from the genomic institute of the novartis research foundation  described previously  <cit> .

we first preprocessed the data by z-score transformation of the data and then sorted the genes into individual gene lists as highly expressed genes for each corresponding sample with the criteria that the z-score was no less than  <dig>  finally, we subjected these gene lists to the ppep. the goal of this analysis is to look for those biological processes that are uniquely but consistently enriched in highly expressed genes within certain types of tissues. we chose to examine those biological processes that are shared amongst in the testis-related tissues but distinct from the rest of the tissues in the dataset. we chose the subset, since there are only  <dig> testis-related tissues  in the dataset and testis-related biological processes are relatively unique and specific compared to other tissues. the analysis result should be easily interpreted based on their biological expectations.

we set up the pathway pattern extraction template exactly as illustrated in figure  <dig> for annotations of go biological processes, which allowed us to find the go terms that are enriched in at least  <dig> of the  <dig> testis-related tissues but not enriched in at least  <dig> of  <dig> other tissues. we used slightly relaxed criteria for pathway pattern extraction in this case to avoid the possible situation where one sample may have some experimental noise, such as contamination, causing some relevant terms to be missed in our extracted patterned term lists as a result of the errors in one  or two  samples. another reason for the relaxed criteria is the fact that these  <dig> related tissues are not exactly the same tissues. thus, our relaxed criteria may help overcome the diversity among these testis-related tissues but differentiate them as a group from other types of tissues. the pathway pattern extraction generated a list of  <dig> terms, which were visualized in a heatmap using the enrichment scores of each term for each sample . many of these  <dig> go terms appeared to be quite specific to testis-related functions such as development of primary male sexual characteristics, fusion of sperm to egg plasma membrane, male gamete generation, male sex differentiation, spermatogenesis, which obviously are exactly what were expected from the analysis. some non-testis tissue samples also had relatively high enrichment scores, possibly due to multiple or redundant functions of some genes that may work in other tissues or resulting from possible accidental enrichment due to the relatively relaxed selection criteria for genes  . furthermore, most of these samples were only enriched in one or two terms except for ciliary_ganglion, which are enriched in  <dig> testis-related functional terms . however, as described in a separate manuscript, our newly developed method slepr may help rank these terms to position the most relevant terms at the top of the ranked list  <cit> . we feel that combining slepr and ppep within the same application gives biologists access to a much richer breadth of information to use for exploratory hypothesis testing.

to compare the gene-level analysis with the ppep method, we also obtained the common genes from the highly expressed gene lists of the  <dig> testis-related tissues and subjected them to enrichment analysis on gobp terms. we retrieved the top  <dig> enriched go terms and compared them with those  <dig> go terms that were identified using ppep. interestingly, many of these top ranked  <dig> terms derived from common gene list-based approach in fact were also widely enriched in many non-testis tissues , which is in contrast to the behavior of the  <dig> terms derived from the ppep. this observation indicated that ppep method showed a much more specific enrichment pattern in testis-related tissues than the common gene list-based approach. similar to the case study with prostate cancer dataset described earlier, this observation indicates that the gene-level method appeared to have more difficulty to uncover the unique biological processes specific for testis-related tissues at the pathway-level compared to the ppep method.

to explore what genes are associated with the extracted testis-specific go terms, we used the interface shown in figure  <dig> to retrieve the genes for some selected terms in a format of pairwise relations with the selected go terms . we can then display the gene-term relationships in the context of gtans shown in figure  <dig>  although many associated genes are consistently expressed in all of the  <dig> testis-related tissues at a relatively higher level, there are other genes that are expressed only in some testis-related tissues .

we also used our ppep to seek common and unique biological themes in two-class comparison in another case study ), which also showed great flexibility and capacity of the ppep in such circumstances.

discussion and 
CONCLUSIONS
many software tools begin with a gene list, either as differential genes, or genes with certain biological features or defined properties, and subject the list to enrichment analyses   <cit>  or gsea  <cit> ). such analysis usually focuses on uncovering embedded biological implications in one gene list or a single data set.

our high-throughput ppep is designed to extend this analysis scheme into a comparative analysis scheme at the pathway-level for multiple gene lists or multiple htp datasets. it is based on the assertion that it has the potential to integrate data from different, but related studies or even from different platforms. the advantage of the method was illustrated by the case study that used  <dig> prostate cancer datasets from the oncomine database described in the result section. recently, a meta-analysis method has made great progress trying to integrate data from different platforms by means of a summary statistics-based method in combination with fdr analysis and cross-validation  <cit> . however, it is still a gene-level based approach that primarily looks at the consistency of gene behavior across datasets. in contrast, our high-throughput ppep is designed to compare genes of defined gene lists at the pathway-level to determine the enrichment levels of defined pathways or gene sets. the idea is to integrate data at the pathway-level for multiple gene lists or multiple htp datasets without regard to the types of the platforms, technologies, and statistical methods that were applied to generate these datasets or gene lists. thus, our results indicate that common or unique biological themes can effectively be captured at the pathway-level by means of conducting pattern analysis of the enrichment levels of functional terms, pathways, or gene sets across the datasets or gene lists. the genes associated with these patterned pathways or terms can then be retrieved, and the data behavior, as well as relationships with the terms, can be analyzed in the context of gtans within the wps environment  <cit> . the wps environment allows for visualization of data behavior of multiple gene lists together  <cit> .

as shown in the first case study in the results section, our analysis scheme with ppep effectively uncovers many common pathway-level signatures from the  <dig> prostate cancer datasets. from the analysis done within each individual gene list or dataset, some of these common pathway-level signatures may not be seen as significant, since they were not ranked at the very top in the enrichment results of each individual gene list of these independent studies. however, the consistencies and patterns of pathway-level enrichment that ppep relies on adds weight to these terms and promotes their significance so that they become significant underlying biological themes across the independent studies. in contrast, using the common differential genes of these independent studies based on gene-level consistency as the sole-source for enrichment analysis, the derived pathway-level signatures may not be able to get significant enrichment scores. this observation illustrates the advantage of ppep compared to conventional gene-level based enrichment methods in rationale. our other case studies described in the results section further substantiated the increased ability of ppep to identify meaningful biological terms associated with input sets of gene lists derived from different sources, or with different technologies.

in comparison with many other gene-set based software tools, our ppep has many unique features not found in a single application . some of the features such as pathway pattern extraction are only found in our pipeline as far as we have been able to determine. in a typical ora method  <cit>  and fcs method  <cit> , the ranking of the "significant" over-represented terms can be misleading due to the fact that the real biologically relevant terms may not be necessarily ranked at the very top. this results from the fact that the ranking is purely based on the p-values or enrichment scores, which in some cases may largely be influenced by the numbers of genes annotated in the terms or the size of the gene list. our pathway-level comparative analysis method looks at the patterns of enrichment status  that persistently exist across the gene lists. by design, it ignores the enrichment magnitude , which is more susceptible to the changes in the numbers of genes annotated in the terms or the size of the gene list, as long as the terms are enriched at significant level . in other words, our method pays more attention to the terms that are consistently enriched across gene lists compared to which terms are mostly enriched in individual lists usually reported by individual ora analysis .

pathways; go;
mirna targets;
tf targets;
pathways,
go terms
the pathway pattern extraction pipeline  in wps has many unique features not found in a single similar application. five related tools  were selected for comparison of major features  with ppep in wps. the other  <dig> tools for comparison include: babelomics   <cit> ; htp gominer  <cit> ; ease/david  <cit> ; gsea  <cit> .

ora: over-representation analysis  <cit> ; fcs: functional class scoring  <cit> ; *es: enrichment score.

we also have evidence that our pathway pattern extraction method is more effective than the ptm-based  clustering method   <cit>  in uncovering patterned pathways or terms when measured by completeness and intuitiveness of resulting terms. our pathway pattern extraction method can easily extract the complete set of patterned terms, whereas the ptm clustering method may have to test different p-values before reaching the best match . the main distinction is that the ptm clustering method is based on the actual values  are related to each other) and our pathway pattern extraction is based on the categorized calls . in other words, our pathway pattern extraction looks for the patterned enrichment status  rather than the enrichment magnitude . thus, our method may be more effective in picking up the patterns and more realistic in considering the enrichment status rather than the enrichment scores that may be influenced by many factors.

as demonstrated by our case studies using our ppep, many commonly shared biological themes can be easily captured from multiple gene lists derived from related, but different studies. the same themes are not obvious when simply looking at the common genes shared by these lists at both the gene and pathway-level. in addition, the unique biological themes, which are specific to one or more gene lists, but not to others, can be uncovered as list-specific biological processes at the pathway-level. for example, for closely related tissues such as the  <dig> testis-related tissues  in the case study using the gnf dataset  <cit> , since they are, in fact, different tissues, it may be more appropriate to expect higher similarity in biological processes at pathway-level than at gene-level. thus, the difference between testis-related tissues would be less profound at the pathway-level than that at gene-level. this notion has been extended to a novel approach that can be also applied to common class comparison analysis in our newly developed slepr method described in a separate manuscript  <cit> , which considers sample-level variations of individual genes.

many efforts have been made to look for biological themes using networks of associated genes. these are largely based on curated gene-gene relationships from the literature  <cit> . the pure pathway/network approach often encounters issues of complexity of networks that are generated from a relatively large list of statistically significant genes. without considering the major trends for biological themes embedded in the gene list, it would be rather hard to derive biological insights from these networks. in a more complicated situation where there are multiple gene lists from different studies and one wishes to compare the embedded biological themes from them, directly applying these gene lists into the networks would be rather difficult to sort out the underlying biological themes. this stems from a lack of an accepted and robust method for comparing the derived network of each list. until such a method can be tested, it would be a better choice to use our pathway pattern extraction approach looking for common and unique biological themes first, before subjecting the associated genes of the selected terms to network analysis. this would not only simplify the size of the gene list used for the network analysis, but also may use more relevant genes to create a more meaningful network that may provide better insights into the underlying biological themes.

before describing ppep in this manuscript, it has been widely used for analysis of many of our collaborators' data including microarray datasets, mass spectrometry data, data from a genetic screening for functional impact study of virus insertion sites in the genome, lists of genes with specific features embedded in their sequences . it has successfully uncovered many underlying biological themes that gene-level methods might have missed or failed to reveal. the analysis results have been included in many published studies with our collaborators using different biological systems including breast cancer  <cit> , prostate cancer  <cit> , yeast genetics  <cit> , malaria drug-resistance studies  <cit> , colorectal cancer  <cit>  and parkinson disease  <cit>  where it helped uncover underlying biological themes. given the insights derived from the analysis using the ppep, we believe that the new analysis scheme provided by this pipeline will be very helpful in compensating for some of the limitations of gene-level based analysis, and provide a valuable perspective of data sets from a pathway point of view. with a better coverage of associated genes for desired pathways and biological processes, our method yields a better chance to envision a more complete picture of biological themes  despite individual variations in gene lists or from datasets derived from independent studies with different rationales, technology platforms, and/or sampling populations.

availability and requirements
project name: pathway pattern extraction pipeline  in wps

project home page: wps with ppep and corresponding databases  can be downloaded from wps homepage  <cit> . the demo movies for ppep can be accessed through the demo page of the wps homepage.

operating system: microsoft window  <dig> or xp

programming language: microsoft visual basic 6

other requirements: built on the platform of wps  <cit> .

license: free to academics; distributed through license agreement

any restrictions to use by non-academics: commercial license needed

list of abbreviations used
wps: wholepathwayscope; es: enrichment score; gtan: gene-term association network; http: high throughput; kegg: kyoto encyclopedia of genes and genomes; go: gene ontology; gobp: gene ontology: biological processes category; ppep: pathway pattern extraction pipeline; ora: over-representation analysis; fcs: functional class scoring; gsea: gene set enrichment analysis.

authors' contributions
my carried out the design and implementation of the ppep in initially developed wps  <cit>  and drafted the manuscript. um participated in collect and assembly of wps database. ac participated in collect and assembly of wps database. rms helped the design and funding for ppep in abcc, and drafted the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
more details of ppep. more technical details, features, and implementations of ppep.

click here for file

 additional file 2
the gene-term pairwise relation table. the gene-term pairwise relation table that was retrieved using an interface as illustrated in figure  <dig>  such a file content can be used in wps to create the gtan .

click here for file

 additional file 3
the interface of data manipulation utilities. the image file showing the interface of data manipulation utilities in wps.

click here for file

 additional file 4
the interface for data scoring and lists sorting. the image file showing the interface for data scoring and lists sorting for slepr method  <cit>  available in ppep.

click here for file

 additional file 5
common differential genes among all datasets. list of  <dig> genes that were obtained as common differential genes among all of the  <dig> datasets using gene pattern extraction feature in wps in the prostate cancer case study.

click here for file

 additional file 6
common gsea annotation terms among all datasets. list of  <dig> terms that were obtained as common gsea annotation terms among all of the  <dig> datasets using pathway pattern extraction feature in ppep of wps in the prostate cancer case study.

click here for file

 additional file 7
enrichment result of gsea annotations for the  <dig> common differential genes. the full enrichment result of gsea annotations for the  <dig> genes that were obtained as common differential genes among all of the  <dig> datasets in prostate cancer case study.

click here for file

 additional file 8
pathway-level enrichment patterns of commonly enriched gsea terms. the heatmap of pathway-level enrichment patterns of the  <dig> commonly enriched gsea terms among the differential genes of  <dig> datasets in prostate cancer case study that are directly involved in cancer-related processes.

click here for file

 additional file 9
comparison of results of ppep and gene-level method for cancer-related terms. the merged table in between the  <dig> cancer-related terms enriched commonly in  <dig> datasets of prostate cancer case study and the terms that have at least one gene out of the 52-gene common gene list, which shows that only  <dig> of the  <dig> terms are enriched in 52-gene list.

click here for file

 additional file 10
terms that are enriched consistently in all datasets. list of the  <dig> go terms derived from ppep that are enriched consistently in the differential genes of all  <dig> datasets in prostate cancer case study.

click here for file

 additional file 11
full enrichment result of gobp annotations for the  <dig> common differential genes. the full enrichment result of gobp annotations for the  <dig> genes that were obtained as common differential genes among all of the  <dig> datasets in prostate cancer case study.

click here for file

 additional file 12
pathway-level enrichment patterns of the commonly enriched gobp terms. the heatmap of pathway-level enrichment patterns of the  <dig> commonly enriched gobp terms among the differential genes of  <dig> datasets in prostate cancer case study. many of these terms are apoptosis-related.

click here for file

 additional file 13
transcription factor target enrichment patterns among the differential genes. the heatmap of transcription factor target enrichment patterns among the differential genes of  <dig> datasets in prostate cancer case study. the  <dig> gene lists are enriched consistently with predicted targets of the corresponding transcription factors.

click here for file

 additional file 14
mirna target enrichment patterns among the differential genes. the heatmap of mirna target enrichment patterns among the differential genes of  <dig> datasets in prostate cancer case study. the  <dig> gene lists are enriched consistently with predicted targets of the corresponding mirnas.

click here for file

 additional file 15
kegg pathway enrichment patterns among the differential genes. the heatmap of kegg pathway enrichment patterns among the differential genes of  <dig> datasets in prostate cancer case study. at least  <dig> out of the  <dig> gene lists are enriched for the corresponding kegg pathways in heatmap.

click here for file

 additional file 16
data details of heatmap in figure  <dig>  the data matrix for the heatmap shown in figure  <dig> 

click here for file

 additional file 17
details of a case study in two-class comparison. detailed description of a case study of the ppep to seek common and unique biological themes in two-class comparison.

click here for file

 additional file 18
gobp term enrichment patterns in class comparison of muscle vs. testis. the heatmap of gobp term enrichment patterns in class comparison case study. the  <dig> gobp terms are commonly enriched in all  <dig> muscle-related tissues but not in any of the testis-related tissues.

click here for file

 additional file 19
gobp term enrichment patterns in class comparison of testis vs. muscle. the heatmap of gobp term enrichment patterns in class comparison case study. these gobp terms are commonly enriched in all  <dig> testis-related tissues but not in any of the muscle-related tissues.

click here for file

 additional file 20
advantage of ppep method over the ptm method in tm <dig>  slides showing the advantage of ppep method compared to ptm clustering method in tm <dig>  <cit> .

click here for file

 acknowledgements
we thank david liu, jigui shan for technical assistance. we also thank dr. richard lempicki's group from niaid for providing comprehensively curated protein-protein interaction database. we thank dr. tim harris for critical reading of this manuscript. we would like to thank the editor and two referees for helpful comments that led to improvements in this paper. this project has been funded in whole or in part with federal funds from the national cancer institute, national institutes of health, under contract no. hhsn261200800001e. the content of this publication does not necessarily reflect the views or policies of the department of health and human services, nor does mention of trade names, commercial products, or organizations imply endorsement by the u.s. government.
