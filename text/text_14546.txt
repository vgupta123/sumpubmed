BACKGROUND
gene expression microarrays provide a snapshot of the expression levels of thousands of genes within a cell or tissue sample. a persistent challenge is to interpret this data: to identify key genes or patterns of expression associated with some condition and so to gain valuable clues about the biological processes related to that condition.

while a variety of methods have been developed to identify significant changes in the expression of individual genes  <cit> , another useful perspective can be gained by viewing expression data at the level of groups of related genes. one approach along these lines identifies similarities, such as shared pathways or go annotations  <cit> , between genes previously identified in an individual gene analysis  <cit> . a potential problem is that this approach relies on the individual genes within a category of interest to stand out. modest but consistent changes in the expression of a group of related genes could be missed if relatively few of the individual genes appear significant.

a promising alternative focuses at the outset on identifying significantly differently expressed groups of genes from a collection of predefined sets of genes   <cit> . the usefulness of such an approach was strikingly demonstrated by mootha et al.  <cit>  in a study of gene expression profiles of muscle in type  <dig> diabetics . as reported by them, no single gene showed up as significant in a comparison between dm2s and subjects with normal glucose tolerance . their 'gene-set enrichment analysis' , however, uncovered a set of genes involved in oxidative phosphorylation as being significantly downregulated in dm <dig> vs. ngt.

in this article we present a new pathway based approach to the analysis of gene expression that, while similar in spirit to gsea, has a number of potential advantages. briefly, gsea involves ranking all the genes  and then calculating an 'enrichment score'  for each pathway that depends on the rankings of its member genes. our method instead begins by translating gene expression levels into pathway 'activity' levels, which are derived from singular value decompositions . the activity levels are used for making comparisons and in general can be used in the same kinds of applications as gene expression levels.

we demonstrate the approach using the same expression data analyzed by mootha et al.  <cit>  in their study of type  <dig> diabetes, and also with expression data from airway epithelia of smokers and non-smokers  <cit> . our analysis leads us to conclusions similar to those obtained using gsea in the diabetes set, but overall appears to perform better in identifying differentially expressed pathways in comparisons between smokers and non-smokers.

the results presented in this article, including statistics for pathways and colormaps of expression profiles, were obtained using a web program we have developed called plage   <cit> .

RESULTS
outline of the method
in the next two sections we analyze gene expression data from skeletal muscle of type  <dig> diabetics and airway epithelia of different types of smokers. here we give a brief overview of our approach. a more detailed description is given in the methods section.

the method is outlined in fig.  <dig>  the analysis is based on a predefined collection of pathways . we use a collection of about  <dig> pathways obtained from the kegg  and biocarta websites  <cit> .

the main goal is to determine, based on the gene expression data, which  of the pathways are associated with some variable of interest such as disease status. to address this, we start by calculating activity levels for each pathway within the samples .

we define the activity level in terms of the first eigenvector, 'metagene', in the singular value decomposition  of the matrix of expression levels y . the expression matrix is restricted, however, to include only those genes within one predefined pathway at a time. this restriction is one of the main differences from previous applications of svd  to gene expression analysis.

as a gene expression value represents the level of expression of a gene in some sample, the activity level represents the 'level' of the first metagene in a sample. the first metagene is simply a vector of weights, one weight for each gene, and a positive activity level indicates the relatively high  expression of genes with positive  weight; a negative activity level indicates the reverse. the activity level in a given sample can be thought of as specifying the position of an expression profile  in a range of possible profiles as shown in fig. 2c.

the main motivation for using the first metagene from svd to define the activity level is that the weights  and associated activity levels together capture the main component of the variation in the full expression matrix y . generally, the higher metagenes may also contain meaningful structure but in this article we focus only on the first component of the variation. it may be useful in the future to devise a scheme for extending the analysis to higher metagenes.

once the activity levels are determined, they can be used in the same kinds of applications as gene expression levels. for example, we might ask which pathways have activity levels that are significantly higher in samples from a case group  than those from a control group. in this article, we mainly perform simple two-group comparisons using t statistics  but, in principle, any statistical model for the level of expression of individual genes is adaptable to one for activity levels.

type  <dig> diabetes
the data set analyzed by mootha et al.  <cit>  contains gene expression profiles in muscle tissue for each of  <dig> type  <dig> diabetics ,  <dig> subjects with normal glucose tolerance , and  <dig> with impaired glucose tolerance . the gene expression data is available at the whitehead institute center for genome research website  <cit>  along with phenotype data including, for example, ages, body size measurements, blood glucose levels after oral glucose tolerance test , and other information. more details can be found in ref.  <cit> .

the calculations of activity levels were done using all  <dig> gene expression profiles. using the t statistic to compare mean activity levels identified no pathways showing apparently different expression between any of the groups dm <dig>  igt, and ngt. specifically, the pathway with the highest significance level, 'activation of camp-dependent protein kinase, pka '  was found in comparing dm <dig> and ngt ; the significance level, however, was calculated to be only p =  <dig> .

we then looked for correlation between activity levels and potentially more informative variables including blood glucose levels after oral glucose tolerance test  and vo2max . the most significant pathway identified here was oxidative phosphorylation ; the oxidative phosphorylation activity level was found to be significantly negatively correlated with blood glucose concentration  <dig> hour after ogtt . other pathways found to be correlated with glucose levels  <dig> hour after ogtt include, in order of significance, biocarta 'activation of camp-dependent protein kinase, pka ' , and kegg 'atp synthesis' . the genes in the atp synthesis pathway, however, are entirely contained within the genes of the kegg oxidative phosphorylation pathway. the results from these comparisons are summarized in table  <dig>  a more detailed statistical analysis of the relationship between glucose levels, oxidative phosphorylation, and diabetic status is presented in fig.  <dig> and refines the result obtained from the initial analysis.

the connection between blood glucose levels and oxidative phosphorylation  seems biologically reasonable. oxidative phosphorylation makes up the last few steps in the series of reactions leading to the synthesis of atp from the oxidation of glucose. unusually high blood glucose levels imply a relatively low activity of this pathway. protein kinase a  facilitates the breakdown of glycogen into glucose in skeletal muscle cells  <cit> ; an elevated pka pathway in skeletal muscle of subjects exhibiting a type  <dig> diabetic phenotype may then possibly be interpreted as a cellular reaction to glucose starvation.

we note that our results differ slightly from those of mootha et al.  <cit>  who, using gsea, found a significant  downregulation of oxidative phosphorylation genes in diabetics compared to non. in contrast, we find reasonable significance only in the level of correlation with blood glucose levels after ogtt. this and other differences with gsea are discussed in a comparison below.

effects of smoking on airway epithelia
a recent study examined the effects of smoking on gene expression in airway epithelia  <cit> . expression data were obtained from a large number of subjects including former and current smokers, and those who have never smoked. the study identified genes differentially expressed between the different groups and some of the general functional categories represented by these genes. a pathway based analysis can be complementary to the kind already given by drawing attention to groups of genes involved in more specific cellular processes.

we obtained the gene expression data for the smoking study from the airway gene expression database   <cit> . the data consist of gene expression profiles from  <dig> subjects including  <dig> current smokers,  <dig> former smokers, and  <dig> subjects who have never been smokers. the data set has undergone some preprocessing steps including normalization and filtering for genes detected on the microarrays. more details can be found at the aged website  <cit>  and in ref.  <cit> .

we identified pathways most differentially expressed in two-group comparisons using t statistics . table  <dig> shows the top ranking pathways from these comparisons and p-values. the top of fig.  <dig> shows a colormap of the activity levels for these pathways in the different samples. the bottom of fig.  <dig> shows a colormap for the expression levels of the genes in the kegg glutathione metabolism pathway; colormaps for the other pathways can be viewed at the plage website  <cit> .

we also performed one-way anova using pathway activity levels and found the top pathways from this analysis  to be virtually the same as those identified using t statistics.

the pathway most significantly differentially expressed in both current and former smokers as compared to never smokers is 'gamma-hexachlorocyclohexane degradation' . genes in this pathway and corresponding weights from svd are given in table  <dig>  gamma-hexachlorocyclohexane, also known as lindane, is a toxic insecticide and the connection with smoking is not at first clear. several genes in the gamma-hexachlorocyclohexane degradation pathway, however, have known associations with smoking. the gene with the highest absolute weight, cyp2a <dig>  plays a key role in the metabolism of nicotine and a number of studies have indicated an important relationship between cyp2a <dig> and smoking  <cit> . for example, individuals with inactive cyp2a <dig> alleles have been reported to be at lower risk for becoming dependent on cigarettes  <cit> . our analysis highlights the potential importance of a cellular process in connection with smoking and further, by the high absolute weight assigned to cyp2a <dig>  points to the key role played by cyp2a <dig> in this process.

other pathways upregulated in current vs. never smokers include metabolism of prostaglandins and leukotrienes , o-glycans biosynthesis, and glutathione metabolism.

genes from the o-glycans pathway are listed in table  <dig>  several of these are also within the list of genes identified by spira et al.  <cit>  the present analysis, however, reveals more directly the functional relationship shared by the genes and draws special attention to the role of this pathway in the physiological response to smoking. o-linked glycosylation plays an important role in the production of proteoglycans, some of which are constituents of mucus  <cit> . in particular, one of the o-glycans genes galnt <dig> initiates mucin-type o-glycosylation  <cit> . it therefore seems plausible that the elevated activity of the o-glycans pathway is linked to the increased sputum production observed in smokers  <cit> .

glutathione is an important antioxidant known to be increased in the lungs of smokers  <cit> . a colormap of the expression levels of the genes in the glutathione metabolism pathway is shown in fig. 4; the higher expression of many of these genes in the current smokers is clear. the increased expression of glutathione metabolism genes in smokers was also noted by spira et al.  <cit> . interestingly, the two genes with the highest weights are gclm and gclc; these genes encode the subunits of glutamate cysteine ligase , which is the rate-limiting enzyme in the synthesis of glutathione  <cit> .

comparison with gene-set enrichment analysis
we used gsea to identify significant pathways in comparisons between the different groups of smokers. the ranking of genes required to evaluate enrichment scores was done, following ref.  <cit> , using the signal to noise ratio . for this analysis we used our collection of pathways and complexes. in comparing current and never smokers, the gene-set with the highest enrichment score  was determined to be the kegg ribosome genes with an es of  <dig>  however, using  <dig> random permutations as described in ref.  <cit>  to evaluate the significance of this es yielded a p-value of only  <dig> . comparing former and never smokers, gsea also finds the ribosome gene-set to have the highest es  and with a reasonably high significance level of p =  <dig>  . finally, the comparison between current and former smokers identifies 'lectin induced complement pathway'  as the pathway with the highest es  but the significance level is very low .

we also used gsea with our collection of gene-sets to compare dm <dig> and ngt in the diabetes data discussed above. here the ribosome gene-set is found to have the highest es  and p =  <dig>  . oxidative phosphorylation has the next highest es  with p =  <dig> .

it is interesting that in three of our four comparisons, the ribosome gene-set is found to have the highest es. we noticed that the expression levels for the ribosome genes are very strongly correlated. this can be seen very clearly in colormaps of the expression levels in both the diabetes and smoking data sets  and is also implied by an unusually large first eigenvalue. for example, in the smoking data set the first metagene for ribosome accounts for over fifty percent of the total variation,  =  <dig> . in comparison, this fraction is only  <dig>  for oxidative phosphorylation  and  <dig>  for uncorrelated gaussian noise obtained from averaging over  <dig> simulated data sets of the same size as the ribosome. these observations lead us to speculate that gsea may not effectively distinguish between gene sets that show a consistent difference between groups of samples and sets with genes that are merely strongly coordinately expressed. in the method we have proposed, correlated expression patterns influence the form of the first metagene and the pathway activity levels, but this is treated separately from the question of whether there is a consistent difference between groups.

to summarize, our approach suggests a number of potentially interesting pathways and hypotheses from comparisons between smokers and non-smokers. the results of our analysis seem biologically reasonable and are more consistent with the findings of spira et al.  <cit>  than those obtained by gsea. as a specific example, we identified glutathione metabolism genes as having significantly  higher expression levels in current vs. never smokers. this feature was also noted by spira et al.  <cit>  in their original analysis and seems evident in the colormap shown in fig.  <dig>  gsea, however, does not find this or any other pathway to be differentially expressed below p =  <dig>  between current and never smokers.

CONCLUSIONS
we have introduced a method for analyzing gene expression data in terms of a collection of predefined pathways and complexes. in summary, the approach quantifies the level of activity of each pathway within each sample and uses the activity levels as the basis for making comparisons. mootha et al.  <cit>  previously demonstrated that looking at expression data in terms of predefined pathways can provide valuable insights not easily attainable by methods more focused on individual genes and we feel that the results in this article reinforce their view.

the main applications we have presented are simple two-group comparisons. we suggest that pathway activity levels may also be useful in other areas, for example, as variables in models for gene regulation , for clustering and classification  <cit> , and in computational efforts to discover novel gene-pathway associations. one possibility is to use svd on the activity levels themselves to determine 'metapathway' signatures for the status of some disease following the approach described in ref.  <cit> . there are a number of potential advantages to be gained in these and other cases. for one, features defined by groups of genes will tend to be more robust in the face of variation at the level of individual genes. in addition, the features here  are based on a large amount of prior biological knowledge and so are potentially more directly biologically meaningful.

