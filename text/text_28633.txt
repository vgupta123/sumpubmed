BACKGROUND
construction of signalling pathways is a major endeavour in biology. signalling cascades, starting at the receptor level, orchestrate a variety of normal or pathological responses via a complex network of kinases, adaptor molecules, and other signalling proteins  <cit> . several gene- and protein-based approaches have emerged for elucidating the complex intracellular signalling activity. gene-based analysis has the advantage of whole genome exploration  <cit>  whereas proteomic approaches are applicable on small pathways but with a more reliable view of pathway function, since proteins are the ultimate reporters of cellular activity  <cit> . both approaches aim at a holistic understanding of cellular actions; that is how to link the environmental cues to the intracellular signalling activity and then to cellular response  <cit> .

several types of computational models have been proposed to elucidate the complex intracellular signalling network and are commonly classified as data- or topology- driven methods  <cit> . their main conceptual difference is their methodology for identifying intracellular connectivity: data-driven models are highly abstract and can identify molecular dependencies within experimental data based on regression analysis, i.e., principal component analysis-, partial least square regression , multi-linear regression , bayesian or other probabilistic models  <cit> . on the other side, topology-driven models rely on a-priori knowledge of the signalling connectivity and depending on their signal-propagation assumption are classified as physicochemical, fuzzy, or logical. in physicochemical models signalling events are modeled via chemical reactions using ordinary or partial differential equations  depending on their ability to model spatial gradients of signalling molecules  <cit> . despite their detailed representation of the transduction mechanisms, ode or pde -based approaches require a large number of parameters, i.e. reaction rate constants and initial conditions, that makes them practical to very small pathways such as the egfr pathway  <cit> . to overcome that limitation, fuzzy models have suggested a simplified -but continuous- representation of the transduction mechanism, which can be applicable to medium-to-large topologies  <cit> . on the other side of the topology-driven spectrum, logical models are based on a simplified  representation of the signalling transduction mechanism and thus, are applicable to very large topologies  <cit> . logical models derived from canonical pathways have several mismatches with phosphoproteomic measurements  <cit>  and thus, a genetic algorithm or an integer linear programming formulation have been developed to construct cell-specific topologies and identify drug-induced pathways alterations  <cit> .

even though most experimental data conform on a cue-signal-response  paradigm  <cit>  most of models -apart from limited cases  <cit> - are capable of representing events from either cue-to-signals or from signals-to-responses: topology-driven models are applicable on cue-to-signal datasets where a significant body of literature allows the construction of canonical maps, where data-driven models are applicable on signal-to-response datasets where the flow of information is not fully understandable. thus, currently there is a lack of models that can answer how stimuli via their signalling mechanisms orchestrate diverse cellular responses such as gene expression, migration, growth, death, metabolic activity, or cytokine release.

in this paper we present the construction of "extended" pathway models that aims to explain cellular responses based on pathway activity. the main idea behind the computational approach is a hybrid boolean/data-driven model where a logical model is used whenever a priori knowledge is accessible and a data-driven approach is used for adding non-canonical edges to reach out to cellular responses. a previously developed integer linear programming  framework  <cit>  is modified to incorporate non-canonical edges with weights that correspond to regression coefficients and used to optimise the connectivity of the hybrid pathway. the resulting pathway is capable of linking signalling pathways to any type of quantifiable readout such as measurements of cell growth, necrosis, apoptosis, cytokine secretion, or transcriptional activity, as long as these data are available under the same experimental conditions as the phosphoproteomic dataset. as a case study, we construct extended pathways for studying hepatocellular carcinoma , a liver cancer disease that is the third leading cause of cancer death with inadequate therapeutic interventions  <cit> . as cellular response we choose the release of  <dig> cytokines and we ask what signalling activity downstream of  <dig> receptors, and  <dig> signalling molecules can explain the complex profiles of cytokine releases. our computational approach is able to uncover well-known secretion pathways and identify significant differences between non-hcc and hcc cells. our approach highlights the importance for construction of integrated csr pathways that given a specific stimulus, can predict the intracellular activity that drives responses such as growth, death, differentiation, gene expression, or cytokine secretion.

RESULTS
construction of csr datasets
for the construction of the extended pathways, a csr dataset is created using the beads-based elisa assays of xmap technology  as described in the experimental setup  and shown in figure  <dig>  our experimental data consists of the signalling subset  and the response subset  that were measured via multi-combinatorial treatments on two cell types: primary hepatocytes and a hepatocellular carcinoma cell type known as huh <dig>  <cit> . approximately  <dig> different perturbations are imposed to primary and hcc cells created by the combinatorial treatment of  <dig> diverse stimuli  and  <dig> inhibitors . as pro-growth stimuli, tumor growth factor alpha , hepatocyte growth factor  and heregulin  have been chosen based on the response yielded on liver cells in previous experiments  <cit> . interleukin  <dig> , il1b and tumor necrosis factor alpha  have been chosen as inflammatory ligands. in addition, the insulin  pathway has been included because of its major role in liver homeostasis  <cit> . to better constrain the optimisation of pathways we impose additional perturbations using stimuli in combination of selective and potent inhibitors for mek, pi3k, cmet, and egfr/erbb <dig> lapatinib and erlotinib  <cit> . for each combination of stimulus and inhibitor, the phosphorylation state of  <dig> key intracellular proteins and the release of  <dig> cytokines were measured as detailed in materials and methods section and presented in additional files  <dig> and  <dig>  among the cytokines,  <dig> showed a significant activity in either primary or huh <dig> hepatocytes. these are plotted in figure  <dig> using the datarail software  <cit> .

several interesting signalling features can be observed simply by inspection of the data. as positive control observations, all inhibitors block their nominal downstream targets proving their potency and indicating an error-free execution of the multi-combinatorial pipetting procedure . in addition, significant differences can be observed between the two cell types: huh <dig> cells respond stronger to insulin stimulus by activating the pro-growth signal akt and their receptor irβ compared to primary cells that remain unaffected . furthermore, the basal and il1b -induced phosphorylation activity of the pro-stress protein hsp <dig> is higher in hepatocytes . with respect to cytokine data, primary cells appear to respond stronger under inflammatory stimuli by releasing the inflammatory cytokines mip1α and mip1β under tnfa and il1b treatment, an observation that has been seen before as a mechanisms for hcc cells for evasion of immune surveillance . even though significant differences can be observed simply by visual inspection of the data, the main question remains on how the cytokine release profile  can be explained by the pathway activity . an answer to this question is the presented methodology for construction of extended pathways that incorporates the pathway activity as well as the cytokine release outcome.

computational framework
the construction of extended signalling pathways can be divided into three main steps:  the construction of canonical pathways,  the identification of new edges between signals and response from data-driven algorithms, and  the optimisation of the extended pathway using an integer linear programming  formulation.

the canonical pathway map  is created around the  <dig> stimuli and the  <dig> key phosphoproteins using ingenuity software  and manual curation based on literature search  <cit> . non-canonical edges  from key phosphoproteins to cytokine releases are then added to the generic topology and incorporated into the ilp objective function using stoichiometric representation with weights  that equal to the regression coefficients obtained from a multi linear regression  algorithm . this strategy allows us to enhance the canonical topology with response nodes using non-canonical edges from data-driven algorithms that have as dependent values  the cellular response and as independent values  the key phosphoproteins nodes. with this strategy, any type of data-driven approach can be merged with canonical pathways. herein, mlr was chosen because of its simplicity to connect signals to response in an intuitive way and without the need of intermediate nodes .

once the extended topology is created with canonical and non-canonical edges, an optimisation formulation with binary variables and linear constraints is employed to identify a pool of pathway solutions that best describes the proteomic data. the main concept behind the ilp optimisation is the minimization of an objective function that represents the deviation between the experimental measurements and the signalling and response values inferred from the network topology, penalized by a function of the map's size. raw data were normalized to  <cit>  as described previously  <cit>  by taking into account the experimental noise, the saturation limits of the assay, and the basal level at time zero . there are three main terms in the ilp objective function as detailed in materials and methods:   

the first term penalizes the measurement-prediction mismatch of the key phosphoproteins and removes all edges that contradict the "signalling" dataset. the second term penalizes the measurement-prediction mismatch of the response measurements and prunes non-canonical edges that contradict the response dataset. the third term removes all edges that have no effect on the measurement-prediction error and thus penalizes the map size.

the ilp formulation is solved with the state-of-the-art commercial code cplex through gams  <cit> . this solver guarantees minimal error between experimental data and the boolean topology eliminating uncertainty associated with heuristic methods such as genetic algorithms. to overcome the existence of multiple near-optimal solutions, in the present work the ilp solver furnishes  <dig> distinct solutions within a 10% difference in the objective value. the resulting pathways are presented in figure 3b where the width of each edge corresponds to its frequency in the pool of near-optimal solutions.

model validation
to evaluate the performance of our hybrid model, several in-silico tests were performed including comparison with a data-driven  model  and assessment of model sensitivity to i) optimisation parameters, ii) experimental design, iii) data deterioration, iii) generic topology. detailed validation data can be found in the additional file  <dig>  but key points are highlighted in the following section.

construction of a 2-step multiple linear regression  model and comparison to our approach 
the performance of our hybrid ilp-mlr approach is compared against a data-driven 2-step mlr approach  <cit>  that correlates i) stimuli and inhibitors to the measured phosphoproteins and ii) phosphoprotein activities to cytokine releases. the two methods are compared quantitatively for data fitting and qualitatively for capturing biological insight. quantitatively, the 2-step mlr is an unconstrained approach and as such, fits the experimental data better than the ilp approach as indicated by the measurement - prediction mismatch . qualitatively, the ilp approach predicts the optimal topology based on the canonical pathway and as such, is better in uncovering protein connectivity that is supported by the literature. in contrast the mlr approach can uncover correlations that lack biological interpretation, such as lapatinib induced irb, mek <dig>  hsp <dig> and p70s <dig> activation .

overall, most differences in the performance of the two methods come from the different perspectives they adopt in constructing signalling pathway. 2-step mlr is a data driven approach  <cit>  aiming at correlating inputs to outputs ignoring any a-priori knowledge of protein connectivity. on the other hand, the ilp approach attempts to take advantage of the a-priori knowledge in the literature and make a canonical topology to comply with the proteomic data.

assessment of model sensitivity to changes in experimental design 
it is apparent that the optimised topology is based on the experiments performed, the number of signals that were measured, and the number of perturbations imposed in the network. more specifically, a single stimulus experiment with only one measured signal can provide information for a very small subset of the generic topology, and as such the optimised map will be very small. on the other hand, an extensive experiment with all different combinations of stimuli and inhibitors is not possible due to time and cost limitations. in this study, we created a dataset that is experimentally feasible and includes all possible combinations of single stimulus with single inhibitor. removal of 50% of these treatments randomly shows a significant deterioration of the constructed pathway and 35% increase of the fitness error . finding an optimal experimental design for maximally constraining a generic topology is a very important aspect in the field of pathway optimisation that can include pathway controllability, pathway observability, experimental limitations, and definitely several other experimental constraints imposed by how the assays are performed.

assessment of model sensitivity to changes in generic topology 
despite the wealth of information found for pathway construction mainly from pathway databases, conflicting reports in pathway connectivity makes the construction of the generic topology a non-trivial task with significant manual curation and with no guaranteed for the "right" generic topology. in order to assess the sensitivity of our hybrid model to changes in the generic topology, we substitute up to 10% of our generic reactions with random reactions. as expected, the optimised pathways are highly dependent on the generic topologies and with errors that can go up to ~90% when 10% of reactions are substituted. a possible way to reduce the sensitivity to the generic topology is to allow the addition of less known or conflicting reactions with weight based on literature findings. however, such a method should be coupled to a text mining approach and a pathway database which is beyond the scope of this study.

calibrating the weights of the three objective terms 
the two prediction mismatch terms were given equal weights. in contrast, for the map-size reduction term a significantly smaller weight was selected . this weight was chosen based on the longest chain of consecutive reactions, namely  <dig>  with the purpose to force the optimiser not to remove edges if they are essential for satisfying experimental results. for example, consider a chain reaction r1→ r2→...→ r <dig> that should be kept because experimentally we found the relation "r <dig> =  <dig> implies r <dig> = 1". the reward for the optimiser to satisfy this chain reaction should be more than the penalty that it has to pay for keeping all  <dig> reactions. therefore, if by keeping all reactions the map size reduction term increases the objective function by  <dig> units, then the reward for satisfying a chain of  <dig> reactions  should be higher than  <dig>  the maximum chain in our pathway is  <dig> reactions but we choose  <dig> in case that further refinements in the generic topology increase the maximum chain.

construction of signals-to-response pathways
the generic map includes a total of  <dig> receptors,  <dig> signalling molecules connected with  <dig> canonical edges, and  <dig> non-canonical edges that connect the  <dig> key phosphoproteins to the  <dig> cytokines. from the  <dig> non-canonical edges, a large percentage of those have correlation weights close to zero. to minimize the computational cost of the ilp solution, we choose to retain 60% of those weights as explained in the additional file  <dig>  s <dig> . extended topologies were created for non-hcc and hcc  hepatocytes. the mismatch between generic pathways and non-hcc or hcc datasets is  <dig> % and  <dig> % respectively . after optimisation, a total of  <dig> canonical and non-canonical edges remained in huh <dig> and  <dig> in non-hcc hepatocytes. the error of the cell-specific pathways drops to 18% in huh <dig> and 17% in non-hcc hepatocytes. several edges are removed due to conflict with the data. one example is the removal of tnfr → pi3k edge in both cell types in order to isolate the akt and mek activity from the tnfa stimuli . in a similar manner the akt→ cot→ ikk→ ikb edges are removed because the measured akt and ikb signals are not co-regulated as suggested by the boolean logic  . furthermore, the links for activating p70s <dig> on a pi3k independent manner remain only on the primary hepatocytes as suggested by the dataset .

the presence of cellular response data significantly enhances the optimisation of the signalling topology in two different ways. firstly, non-canonical edges provide additional pathway information to the ilp formulation. in other words, the optimiser is forced to conserve edges that lead to cytokine nodes but do not affect measured phosphoproteomic signals . secondly, edges with marginal activations of intracellular signals that otherwise would be considered insignificant  are retained in the topology if they correlate well with cellular response. an example of this case is the il <dig> pathway: although il <dig> activation of stat <dig> in huh <dig> is seemingly undetectable , the il6→ ...→ stat <dig> pathway is conserved because even small chances in the stat <dig> activation levels correlate well to the il6-induced release of various cytokines  . taken together, when the ilp formulation uses both the phosphorylation and response data, it conserves pathways with barely detectable signalling activity as long as they correlate to cellular response.

the non-canonical edges in figure  <dig> show that major pathways for the release of inflammatory cytokines are the il6→ stat <dig>  il1b→ nfkb/p <dig>  and tnfa→ nfkb/p <dig> pathways  <cit> . just three key phosphoprotein signals  are responsible for the release of most inflammatory cytokines including tnfa, groa, rantes, mcp <dig>  ilb, and eotaxin , an observation that is in accordance to a large body of literature  <cit> . it is less known how many different pathways can lead to the release of a particular cytokine. a simple enumeration of paths that lead to cytokines for primary hepatocytes , shows that more than 50% of the cytokines are induced by  <dig> or  <dig> edges that can be activated by up to  <dig> different stimuli following at most  <dig> different routes of activation. since the constructed pathways are small subsets of the actual pathways, it is obvious that the mechanisms for a single cytokine secretion are numerous and complex. to tackle such complexity, graph theory analysis of the extended pathways  can identify central nodes or group of nodes for inhibiting cytokine secretion, and thus, increase the efficacy of pharmaceutical interventions. this is in particular applicable for multi-targeting of stat <dig>  nfkb, or p <dig> pathways to achieve anti-inflammatory effects, a major endeavour of pharmaceutical industry with significant investments on mono-targeted approaches for stat <dig>  nfkb, or p <dig> on several diverse diseases including p <dig> for rheumatoid arthritis  <cit> , iκb for airway inflammation  <cit> , or stat <dig> and nfkb for hcc  <cit> .

independent experimental validation of the model
in order to evaluate the predictive power of our hybrid model, we asked how well the huh <dig> model shown in figure 3b captures the correlation of cellular response to phosphoprotein activity. to achieve that, we choose the pathways il1b/tnfa to p38/ikb that play major role in cytokine secretion, we block them with potent and selective ikb and p <dig> inhibitors, and we ask how well our model can predict the ip <dig> and rantes, two major players for cytokine release. figure  <dig> shows the experimental results and the mismatches with the hybrid model. our hybrid model was able to recapitulate the ip <dig> release upon introducing il1b, tnfa or both in an ikk dependant but p38/hsp <dig> independent manner. on the other hand, the hybrid model did not fit the induction of rantes upon il1b or tnfa stimulation probably not because there was no induction  but because the induction does not pass the  <dig>  threshold so the logic model to consider it an "on" event. this issue highlights the importance of data normalisation: currently data are normalised to the maximum cytokine value among all treatments. in the follow up experiments, one treatment is the combination of il1b and tnfa where huh <dig> cells show a super-induction of rantes and makes all other rantes values to be considered low. logic models cannot handle such non-linear behavior and lead to predictive errors. when huh <dig> treated with the combination of il1b and tnfa then the hybrid model was able to perfectly recapitulate the rantes release in an ikk dependent and p38/hsp <dig> dependent manner.

CONCLUSIONS
in the present work, we developed a method for linking signalling data to cellular response. as a case study, we compare extended signalling topologies of primary hepatocytes and huh <dig>  the two pathway maps are significantly different. huh <dig> are not as responsive as primary cells since only  <dig> non-canonical edges exists in huh <dig> compared to  <dig> in primary hepatocytes . these findings are in agreement with recently published data that shows hcc cell types are less responsive to toll like receptor  stimuli than primary hepatocytes  <cit> , presumably to avoid detection and clearance by the innate immune system  <cit> . major pathway differences related to a survival advantage for hcc can also be observed at the intracellular level: a closer look into the insulin pathway shows that ins→ irβ and ins→ igfr edges are removed in hepatocytes but the ins→ irβ is retained in huh <dig> . a closer look into the raw data  shows that insulin barely induces irβ and akt in primary cells. this is in accordance to recent findings that shows increased akt activation correlates well with the formation of liver tumours  <cit> . however, in that study, the authors pinpoint the mechanisms of akt overactivation to the reduced expression of p85α - a regulatory subunit of pi3k. herein, we show that -at least for the huh <dig> case- diminished akt activation levels can be due to receptor's lower activation as shown from the phosphorylation of irβ.

here we presented a method for constructing extended pathways that start at the receptor level and via a complex intracellular signalling pathway identify those mechanisms that drive cellular response. because of the nature of response data - where detailed mechanisms are sparse and not easily searchable via text mining approaches- we used a data-driven approach to link intracellular activity to cellular responses via non-canonical edges. those edges, together with well-defined intracellular pathways, were used for the construction of the "generic map" which is finally optimised to match high-throughput protein data. the resulting extended pathways revealed intracellular mechanisms that are responsible for the release of  <dig> cytokines and correlate well with a large body of literature that pinpoint at stats and nfκb as major drivers of inflammatory stimuli. more importantly, comparison between cell types shows significant differences that lead to survival advantages of the hcc cells. our results constitute a proof-of-principle for construction of "extended pathways" that are capable of linking pathway activity to diverse responses such as growth, apoptosis, differentiation, gene expression, or cytokine secretion.

