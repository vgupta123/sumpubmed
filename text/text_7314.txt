BACKGROUND
expression microarrays are powerful tools for human disease diagnosis, prognosis and treatment  <cit>  offering unparalleled insight into the function of the entire genome and the dynamic interactions among genes. the ability of microarrays to identify gene expression signatures, specific subsets of genes that respond to particular stimuli, make them valuable tools for characterizing organisms' response to environmental conditions and host-parasite interactions. this method relies on organisms as sentinel markers of environmental changes. since aquaculture marine species are easy to keep in a captive environment, they can be used as convenient sentinels by profiling their physiological responses. an efficient and economic method to quantify their physiological responses is to collect the expressed sequence tags  with the purpose of constructing cdna microarrays, which can be used to screen their transcriptomes. therefore, several pilot studies have been initiated in economically important marine species to generate genomically enabled tools for the purpose of elucidating the role of biological and environmental factors in ultimately determining the difference between survival, morbidity and mortality  <cit> . the growing need for a marine functional genomics approach using microarrays bespeaks a general-purpose cdna microarray probe selection tool to identify which ests to spot on the microarray from large collections of ests with unknown functions and variable redundancies.

the two most widely used expression microarray systems are oligonucleotide and cdna microarrays. oligonucleotide microarrays are generated by chemically synthesizing short oligo probes  onto the slides  <cit> . in contrast, cdna microarrays are created by spotting long strands of amplified cdna sequences   <cit> . in this paper, the sequences spotted on the arrays are referred to as "probes." although many algorithms have been developed for selection of oligonucleotide  <cit>  or gene-specific probes  <cit> , only one application was found by the authors for cdna microarray probe selection  <cit> . however, this algorithm was designed specifically for organisms with extensive genomic data, not for the organisms with limited genomic information.

in the absence of cdna microarray probe selection algorithms, est selection for spotting on microarrays has been approached using various informal methods. these methods included spotting ests without sequencing information, spotting only sequenced ests with annotations, or forcing the selection on gene-oriented clusters  <cit> . the choice of method typically reflects cost/benefit ratios and the stage of development of the est collection. a comprehensive review of microarray probe selection can be found in tomiuk and hofmann  <cit> . gene or transcript oriented clusters are generally formed by gene indexing projects, such as tigr  <cit> , stack  <cit> , or unigene  <cit> . gene indexing projects involve three general steps. first, the quality control step filters out contaminating sequences such as vector or bacterial sequences. second, ests are partitioned into smaller clusters, often using the hierarchical single-linkage method with an arbitrarily chosen cut-off threshold  <cit> . finally, although not all projects include a assemblage step, sequences are often assembled into contigs using existing software, such as cap <dig>  <cit>  or phrap  <cit> .

in this study, we propose a probe selection procedure for cdna microarray that tracks both sequence redundancies and functional representativeness of the selected probes in an integrated sequence diversity plot . sdp includes a sequence diversity index  to measure the sequence similarities within est clusters quantitatively. the issue of how many probes are sufficiently representative for all collected ests is approached in a manner similar to the choice of dimensions to retain in principle component analysis . this approach reflects the fact that there is no definitive right answer to the question  <cit> ; the number of "clusters" of ests may vary as the stringency of microarray hybridization condition changes. all collected ests are automatically annotated using gene ontology  <cit>  terms, and then a unique probe go index , a functional index, was devised to access functionally how representative the selected probes are. this integrated and flexible method using sdp allows users to decide which clustering method and stringency to use when designing a cdna microarray for organisms with limited genomic information based on their logistical constraint and experimental purposes. a small data set of ests was used to test this algorithm so that the detailed results of this algorithm could be examined.

RESULTS
a small data set of  <dig> ests from atlantic white shrimp  from the marine genomics website  <cit>  was analyzed. after pre-processing,  <dig> sequences longer than  <dig> bp were further used in the analysis . the ests were progressively grouped using different hierarchical linkage methods from  <dig> to n  clusters . the sequence diversity plot  summarizes sequence properties within clusters and the functional representativeness of the selected probes using three indexes: the sequence diversity index , the contiguity index , and the unique probe go index  .

sequence diversity index  measures within-cluster sequence dissimilarity
this index is the ratio of within-cluster sequence dissimilarities to the total sequence dissimilarity when m clusters are formed :



where dmi is the distance , the e-value from blast result , between the ith pair of sequences for a total km pairs of within-cluster comparisons when m clusters are formed. d is defined as , the average distance of the total n pair-wise distances among all n sequences .

contiguity index  measures the sequence contiguity within clusters
the within-cluster sequence contiguity is evaluated using cap <dig>  <cit> , commonly used sequence assembly software . the number of putative unique genes, denoted as pgm, is the sum of the number of assembled contigs and singlets  when m clusters  are formed. the contiguity index  at a given number of clusters  is defined as the inverse of the average number of putative genes per cluster, which equals the number of clusters per gene:



this index reflects how contiguous the sequence members are within a cluster. maximum value of ci is  <dig> when all the members are contiguous .

unique probe gene ontology  index  measures functionally how representative the selected probes are
the unique probe go index  when m clusters of ests are formed is defined as the number of unique go terms associated with all m probes  divided by the number of the go terms associated with all n sequences .



where probegomj is the number of unique go terms associated with the probe representing the jth cluster when m clusters are formed and sequencegoi is the number of go terms of the ith sequence. this index measures functionally how representative the selected probes are among all functionally unique sequences in the entire est collection. three upgis are calculated for three go domains, respectively: molecular function , biological process , and cellular components  .

sequence diversity plot  used as an aid to decide how many probes to spot on microarray
the dissimilarities among sequences within a cluster, measured by sdi, decrease as total number of the clusters increases; sequences within a cluster share higher similarity as the number of clusters formed increases .

from the collection of  <dig> litopenaeus setiferus ests, the first break point of sdi using single linkage method was  <dig> clusters . an elbow  in sdi, analogous to an elbow of scree plot of the principle component analysis , indicates that the remaining within-cluster diversity is very low after this number of clusters formed  <cit> . the selected probes presented 93% unique molecular functions, 94% unique biological processes, and 96% unique cellular components when  <dig> clusters were formed using single linkage method .

other amalgamation algorithms produced clusterings with different properties. the average and complete linkage methods reduced the sequence dimensionality more efficiently than that by using the single linkage method . for the complete linkage method, the break point was observed at  <dig> clusters, at which, the selected probes represented only 50% of unique molecular functions while the selected probes represented 71% of unique molecular functions using single linkage, and 56% using average linkage . the probes selected using single linkage were functionally more unique in all three domains  than the ones selected using average or complete linkage methods . exceptions to this rule were found when very small  or large  numbers of probes were selected. the functional representativeness of the probes at very high or low ends  was comparable using any of the three linkage methods. when  <dig> probes were selected,  <dig> â€“ 95% unique biological process, ~92% within-cluster biological process, and ~96% unique cellular component was represented by the selected probes . although fewer annotated est clusters  were formed using single linkage method compared to those selected using the other two linkage methods given a fixed number of cluster within the middle range , more functionally unique probes were selected among the formed clusters by single linkage method .

contig assemblage using cap <dig> yields a similar result as that of cluster analysis using the single linkage method . a total of  <dig> putative genes was generated using sequence assembly software cap <dig> without partitioning the sequences into subgroups . these putative unique genes included  <dig> singlets  and  <dig> assembled contigs. this result followed closely the result of cluster analysis with single linkage method, which indicated  <dig> clusters. the est members in each putative gene were in general agreement with the result of single-linkage cluster analysis with some exceptions. for example, sequence  <dig> , sequence  <dig> , and sequences  <dig>  were not assembled into any contigs using cap <dig>  but they were clustered together when  <dig> clusters were formed using single linkage method. these sequences share high similarities and high percent identities , and they are likely to hybridize with each other. probes selected using clustering methods reflect the hybridization potential compared to the assembly approach. some sequences, on the other hand, were not clustered into a group although they could be assembled into one putative contig. for instance, sequences  <dig> and  <dig> were not clustered in a group because the overlapping segment is marginally short  and this segment is composed of low-complexity sequences . the different characteristics of three linkage methods could be further illustrated by local sequence percent identity and the lengths of high scoring pair segments  . sequences within a cluster formed using single linkage method do not always have to overlap with each other as long as the distances between some of the "linking sequences" are short . that is, the fragmented ests could be "linked" by fragmented  ests and the average within-cluster percent identity is not necessary high when using the single linkage method . the sequences within same clusters using the average linkage methods, as expected, have the highest average percent identity .

sequence contiguity assessed by cap <dig> ) has shown similar results observed using the probe functional index, upgi ; figure 2). clusters formed using the single linkage method contained slightly more contiguous est members while the other two linkage methods generated fewer contiguous sequences in the mid range . similarly, when the number of clusters was either very low or high, the results were comparable.

ests were annotated based on gene ontology  terms . three types of functionally unassigned sequences were generated through the go annotation process: the first type was the sequences having no similar sequences found in the go database. the majority of ests  belonged to this category . the second type was similar sequences found in the go database with the function of those sequences annotated as "unknown." the last type of "unknown" was similar sequences found in the go database, but only certain domains of go annotation were complete. for example, it could only have molecular functional annotation associated with the sequence but biological process and cellular components are unknown. the last two types of sequences were combined into one "unknown category" in that particular functional domain . twenty five percent of sequences was annotated in molecular function while 12% was unknown; 27% was annotated in biological process while 10% was unknown; and 27% was annotated in cellular components with 11% unknown. among the annotated sequences, 36%, 49%, and 22% of annotated sequences were associated with unique go terms in each of the three domains , respectively .

both functional and sequence indexes for the three clustering methods converge around the threshold of  <dig> clusters. when the user-defined number of probes is fewer than this threshold value , the functional uniqueness of the selected probes using single linkage method is superior than that of the other two methods while average linkage is the most effective method for dimension reduction .

discussion
cdna microarray is one of the most common microarray platforms, but it is also known to have cross-hybridization potentials. the hybridization potentials between sequences may also vary as the experimental condition changes. this changing nature and the potential of cross-hybridization could be depicted by the index developed in this study, the sequence diversity index . the magnitude of sdi decreases as the number of clusters increases; sequences are more similar within clusters as the number of clusters increases. sdi is analogous to the f-statistics. that is, sdi is the "within" variation divided by the "total" variation while the f-statistics is "within" variation divided by "between" variation. two ancillary indexes  and a sequence contiguity index ) were designed to evaluate the functional representativeness of the selected probes and identify the numbers of putative genes each probe potentially would cross-hybridize. these indexes aid the probe selection processes by bringing in the functional annotations of ests as the main goal of the microarray experiments is generally to interpret the biological significances and interactions of genes of interest. a common goal of microarray experiments is to identify co-regulated genes. this is based on the assumption that if two genes are co-expressed, they are likely to be co-regulated through the same mechanism  <cit> . it has been shown experimentally, at least in yeast, that combining expression data and sequence functional annotation information results in a better predictive model than using microarray expression data alone  <cit> . the integrated procedure in our study including both probe sequence and functional annotation allows a user-defined flexibility based on the purpose of experiments and the limitation or experimental conditions, such as different hybridization stringencies, budget limitations for numbers of probes to spot on the array, or physical size constraint of the array.

different clustering processes mimic different scenarios of cross hybridization between sequences. sequences from the same transcript will hybridize with each other, and this is reflected in the clusters formed using the single linkage method. in contrast, some of the sequences in the clusters formed by the complete or average linkage methods could be paralogs or alternative splicing variants of the same gene. it might be argued that if a sequence, for example penaeidin  <dig>  was chosen as a probe from the cluster of sequences containing different subtypes to spot on the microarray, this sequence will likely hybridize to the sequences in the same cluster, for example, penaeidin 3a and penaeidin 3c. the contiguity index and probe functional index developed in our study will identify the cross hybridization potential for the users. potential cross-hybridization has become a more apparent problem for the transcriptomics community. a tool was developed to identify potential cross-hybridized probes lately  <cit> , however, this tool is designed for species with rich genomic information. our method provides an integrated approach for cdna microarray design for any organisms, especially for projects with very limited genomic information.

cross-hybridization potential between long cdna seqeuences is harder to model than that between short  sequences. although several studies have shown that local sequence percent identity seem to be a reasonable predictor for cross hybridization for cdna microarray experiments  <cit> , the cross-reactivity varies in a wide range  even when percent identity is high and within a similar range  for sequences in different gene families  <cit> . currently, there is  no good predictor to model the cross-hybridization on cdna microarray. the similarity measurement between sequences in our study  could be easily replaced in the future by any good cross-hybridization predicting parameter developed for long cdna sequence hybridization. the design procedure we described here will work in the exact same fashion. in a similar manner, although the traditional hierarchical clustering algorithm with three linkage methods was used in our study, any bottom-up clustering algorithm  or top-down approach  could be easily performed, and the corresponding sdis, upgis and cis will be generated in the same way and summarized in the sdp. the performances of these different bottom-up or top-down algorithms  could be compared using the sdp. in brief, other distance matrix and clustering algorithms other than what we used in this study could be easily applied using our algorithm, and their performances could be evaluated quantitatively using the suite of indexes in sdp.

annotation of functionally unknown sequences is not a trivial task itself. gene ontology has become a standard ontology to annotate unknown sequences. sequence similarity search against the go database using blast was used in this study. the completeness of the go database and sensitivity/selectivity of the blast procedure would dictate the annotation capability. several different approaches could potentially improve the annotation in the future. one example found in this study was penaeidin family, a unique family of antimicrobial peptides with both proline and cysteine-rich domains that were first identified and characterized as peptides in the hemolymph of the pacific white shrimp, litopenaeus vannamei  <cit> . no homologous proteins are found in go database. future research could emphasize how to integrate other sources of knowledge  to enrich the functional annotation process, especially as very limited knowledge is available for marine organisms in the public domain. different approaches to annotate the est sequences could also be adapted. for instance, position-dependent method  could be used to search the existing database. this may increase the chance to annotate sequences with lower sequence homologies with the sequences stored in the database. the current functional representativeness of the selected probes was quantified using the unique go terms associated with the probes among all sequences. the quantification of how representative the probes are could be modified in the future to include the hierarchical nature of the go terms.

the integration of this cdna probe selection procedure with the database through marine genomics web-based interface  <cit>  is currently in progress, and the marine genomics community will be directly benefited, and it will be equally applicable to any organisms with limited genomic information.

CONCLUSIONS
the sequence diversity index  was developed in this study to select probes using ests for designing cdna microarrays. two ancillary mathematic indexes  were used to identify potential cross-hybridization between different transcripts  and to quantify biologically how representative the probes were. these three indexes were summarized in a sequence diversity plot  and were used to assist cdna microarray probe selections for organisms without any genomic information. this method allows the user-defined number of probes to be selected for the cdna microarray experiments. different clustering methods balance the representativeness of the probe functional annotations and minimization of the sequence redundancies. accordingly, different linkage methods can be used to decide between microarray designs for biomarker discovery or for functional genomics.

it is clear that sequence assembly into contigs is not necessary for microarray probe selection although it is informative to identify the relationship among sequence members within clusters based on the ci. the microarray design procedure described here could also be used for multi-species or cross-species microarray design in a scenario where the sequences with high similarity from different species cross hybridize to each other  <cit> , but not necessary be assembled into contigs.

this method is not limited to the ests collected from single or multiple marine organisms. furthermore, this method can be applied to any organisms without the complete sequenced genomes.

