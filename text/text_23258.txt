BACKGROUND
feature selection presents an important statistical challenge in the analysis of omic data . it is most often encountered in the context of supervised analyses where one wishes to find features that are informative of differences between two phenotypes of interest . the standard paradigm is to identify features for which the average level of the molecular mark of interest  is significantly different between two poi, using well-known tests such as student’s t-test, its regularized/moderated versions , or non-parametric equivalents such as the wilcoxon rank sum  test  <cit> . however, an often overlooked problem when applying t-tests, or their non-parametric equivalents, to omic data, is that these tests are underpowered to detect biological outliers, i.e. infrequent  changes of considerable magnitude, which occur mainly, if not exclusively, within one phenotype. a number of recent studies have highlighted the potential importance of such heterogeneous, stochastic, outlier events in disease aetiology . for instance, one study measured dna methylation in precursor cervical cancer samples and showed that dna methylation outliers in these cytologically normal lesions were predictive of progression to neoplasia  <cit> . it is therefore entirely plausible that such dna methylation outliers may, in general, define epigenetic cancer field defects , i.e. molecular alterations in normal cells which later undergo neoplastic transformation.

given that t-tests and other standard statistical tests are unsuitable for identifying epigenetic outliers, we proposed a novel feature selection paradigm based on the concept of differential variability   <cit> . a growing concern however is that outliers could in principle also reflect genetic and technical factors  <cit> . because of this, a number of dv tests have emerged, with improved statistical properties, notably with an improved control of the type- <dig> error rate . as pointed out by these studies, if differentially variable outliers were technical artefacts, then certain dv tests such as bartlett’s test  would suffer from a very high type- <dig> error rate. on the other hand, given that cancer studies profiling precursor lesions are generally limited by sample size, dv tests which exhibit good control of the type- <dig> error rate, may also be seriously underpowered to detect the biologically interesting outliers.

henceforth, we here conduct a detailed comparison of five different dv algorithms on a total of five dna methylation data sets, encompassing over  <dig> samples, including two of the largest studies profiling precursor cancer lesions  <cit> . we demonstrate marked variation in the ability of dv algorithms to identify true positives, with deep and far-reaching implications for studies seeking to identify epigenetic field defects in cancer and possibly also in other complex diseases.

methods
dna methylation datasets
we analysed a total of  <dig> dna methylation data sets .

precursor and cancer dna methylation datasets
our primary dna methylation data sets focused on the profiling of precursor cancer lesions and are available from the geo website  under accession numbers gse <dig> and gse <dig> 

dataset gse <dig> consists of  <dig> cytologically normal cervical smear samples, representing prospectively collected samples within the artistic trial, with  <dig> of the women who provided a sample developing a cervical intraepithelial neoplasia of grade  <dig> or higher  three years after sample collection  <cit> . in order to test whether cpgs identified from gse <dig>  i.e. cpgs that correlate with the risk of cin2+, show more progressive changes in cin2+ and cervical cancer we used three other data sets  profiling normal cervical and cin2+ or cervical cancer samples . all of these datasets were generated using illumina infinium 27 k beadarrays and we used the normalized data, as described by us previously  <cit> .

dataset gse <dig> was generated using illumina infinium 450 k beadarrays and consists of  <dig> normal breast tissue samples from healthy women, a set of  <dig> matched normal-adjacent breast cancer pairs , and a further  <dig> unmatched breast cancers. raw data was processed with minfi  <cit>  using the preprocessraw function, the illumina definition for methylation signal in getbeta and estimating p-values of detection with detectionp using total intensity “m + u”. type- <dig> probe bias was corrected using bmiq  <cit> . subsequently, we tested for batch effects by performing a svd on the intra-sample normalized data matrix, and checking which factors  the top components of variation were correlating with. the top components of variation in this data matrix correlated with biological factors, notably normal-cancer status.

statistical algorithms for differential variability 
we compared a total of  <dig> algorithms/statistical tests, aimed at identifying differentially variable features. the five dv algorithms/tests are  bartlett’s test  <cit> ,  a novel dv algorithm, which we call “ievora” ,  a joint test for differential means and differential variance in dna methylation   <cit> ,  an empirical bayes levene-type test   <cit>  and  a test based on a generalized additive model for location and scale   <cit> . with the exception of ievora, which we present here for the first time, all other dv algorithms  have been previously used in cancer epigenome or ewas studies  <cit> .

bt & ievora
briefly, bartlett’s test  is similar to an f-test for testing homoscedasticity, and is well-known to be sensitive to single outliers. because of this, we also consider a regularized version of it, which we call ievora, whereby features deemed significant by bartlett’s test are re-ranked according to an ordinary differential methylation statistic . to clarify this further, p-values from bartlett’s test are used to estimate corresponding false discovery rate  values using the q-value method  <cit>  and a threshold  used to select significantly dv features. these significantly dv features are then re-ranked according to their differential methylation statistic. thus, in ievora, significance is assessed at the level of differential variability, using bartlett’s test, but significant dv features with larger changes in the average dna methylation are favored over those with smaller shifts in average dna methylation. this re-ranking strategy therefore ensures that dv features driven by single, or a few, outliers are only ranked highly if there are no features which are differentially methylated in terms of mean dnam levels.

j-dmdv, diffvar and gamlss
the third algorithm , proposed by wang and ahn  <cit> , works in the m-value ] basis and uses a joint score test for mean and variance within a linear regression framework. p-values from this test are converted into q-values  and features selected  according to a fdr <  <dig>  threshold. the fourth algorithm  is based on an empirical bayes extension of the levene-test  <cit> . briefly, this algorithm first computes the square  deviations of samples within a phenotype from the corresponding group  mean using the m-value basis. it then uses the framework of moderated t-tests  <cit> , to compare the distribution of deviations between the two phenotypes. p-values from this test are converted into q-values  and features selected  according to a fdr <  <dig>  threshold. the final algorithm  was developed by wahl et al.  <cit>  within the gamlss  framework. this algorithm also works in the m-value basis, and here we adapt it to run on  <dig> separate generalized linear additive models within a nested framework: a null model without mean and variance, a regression model for the mean only and a model for the mean and variance. two likelihood ratio tests are then constructed by comparing the log-likelihoods of the mean-only model to the null, and the mean + variance model to the mean-only model. this yields two p-values for each feature, and features are deemed significant if at least one of these two p-values is less than a nominal threshold . thus, gamlss will yield significant hits if there are differences in terms of mean dnam. we also note that our implementation of gamlss does not compare a variance-only model to the null, since the algorithm aims to identify additional features where variance “adds predictive value” over a model which only includes the mean.

software availability 
the ievora algorithm is freely available as an executable r-script, and can be found as a supplementary software file as part of the accompanying publication, see  <cit> .

evaluation of dv algorithms to detect true dvcs on simulated data
in order to compare the dv algorithms to each other, we devised a simulation framework allowing also for different types of differential variability. in each simulation run we generated an artificial dna methylation data matrix consisting of  <dig> cpgs and  <dig> samples. samples were subdivided into two phenotypes, a “normal” and a “disease state”, each comprising  <dig> samples. we declared  <dig> cpgs to be truly differentially variable, allowing for  <dig> different types of dv, with  <dig> cpgs in each type. the remaining  <dig> cpgs are not differentially variable. these are modelled from a beta-value distribution b with a1 =  <dig> and b1 =  <dig>  i.e. we assume that these cpgs are generally unmethylated with a mean beta value of  <dig> , with a standard deviation of approximately +/−  <dig> . for the  <dig> true positives, a proportion of the samples in the “disease” phenotype are modelled from a beta-value distribution b with a2 =  <dig> and b2 =  <dig>  i.e. a distribution with mean value  <dig>  and a standard deviation of approximately +/−  <dig> . we note that although in this simulation we consider all cpgs to be unmethylated in the normal state, that there is no loss of generality, since mathematically, there is a complete symmetry between unmethylated and methylated cpgs. thus, for the  <dig> true dvcs and for a number of samples in the disease phenotype, there will be an average increase in dnam of ~ <dig> . the  <dig> true dvcs however fall into  <dig> categories of dv. for  <dig> of these cpgs, we model all samples in the disease phenotype from b. thus, these dvcs will typically also differ in terms of the mean level of dna methylation and in fact, will exhibit stronger differences in terms of the mean dnam than in terms of differential variance. hence, these  <dig> dvcs are of “type-1a” dv. for another  <dig> cpgs, we only allow  <dig> of the  <dig> disease phenotype samples to be modelled from b, with rest of the samples being modelled from b. thus, for these dvcs, half of the disease samples exhibit increases in dnam, with the rest being indistinguishable from the normal phenotype. for these cpgs, differential variance is the key discriminatory characteristic, although they will still exhibit significant differences in terms of mean dnam since a reasonable fraction of the disease samples exhibit deviations from the normal state. these dvcs are of “type-1b” differential variability. finally, for the last set of  <dig> true positives, we only allow  <dig> disease samples to differ from the normal state. for these dvcs, there is therefore no significant difference in terms of the average dna methylation between the two phenotypes. however, the variance will differ owing to the outliers in the disease phenotype. these dvcs are defined as being of “type-2”.

we performed a total of  <dig> monte carlo runs, in each run recording  <dig> performance measures for each of the five dv algorithms:  the overall sensitivity of the dv algorithm using a fdr  corrected threshold of  <dig> , defined as the fraction of true dvcs identified by the dv algorithm,  the true fdr at the estimated fdr <  <dig>  threshold where the fdr estimate was obtained using q-values  <cit> ,  the sensitivities to detect type-1a, type-1b and type- <dig> differentially variable cpgs. we focused on the fdr and not the fpr , since it is the fdr which gives us the confidence level that a given positive is a true positive, i.e. the fdr is related to the positive predictive value  through the relation fdr = 1-ppv.

evaluation of dv algorithms on real dna methylation data
initially, we compared the algorithms in their ability to detect dvcs between normal samples from healthy women and normal samples from women who developed neoplasia or who had cancer , without considering the likelihood of these dvcs being true positives. thus, for each of the dv algorithms and each cpg site, we estimated p-values, and from these, q-values   <cit> . in the case of bt and ievora, p-values came from bartlett’s test. in the case of diffvar and j-dmdv, both tests provide p-values, as described in the respective publications. features were deemed significant if q <  <dig> . in the case of gamlss, we obtained two p-values, one assessing whether the mean is associated with the phenotype, and another assessing whether the variance adds predictive value over the mean. both sets of p-values were transformed into q-values and features with at least one of these q-values being less than  <dig> , were selected and deemed statistically significant.

to enable a more formal comparison of the dv algorithms, we devised a strategy that would allow us to estimate the positive predictive value  of the test. the key insight or hypothesis is that dvcs obtained in the discovery set are more likely to be biological true positives if they exhibit progressive changes in dna methylation in either neoplastic or invasive cancer tissue. a feature detected in pre-neoplastic lesions  that is biological relevant is more likely to mark cells which become neoplastic and therefore one would expect enrichment of these marks in neoplasia and invasive cancer. this means that if a given “true positive” cpg site exhibits higher dnam levels  in precursor cancer lesions, that this same site will undergo larger and more frequent dnam changes in cells that are neoplastic or invasive. thus, the ppv refers to the fraction of cpgs identified in the discovery set , which exhibit progression in the independent data sets representing the more advanced stage in cancer development. statistically, this “progression” can be measured using t-statistics from a t-test, since the t-statistic is proportional to the average deviation in dnam from the normal state. a similar argument can be applied to the case of cpg sites that undergo marginal hypomethylation in precursor cancer lesions.

in the context of cervical carcinogenesis, we thus applied the dv algorithms to identify dvcs hypervariable in the  <dig> normal samples which 3 years later progressed to cin2+ status compared to the  <dig> normal samples from women who remained healthy . the dnam data for this set were generated on illumina 27 k beadarrays, and so, because of the design of the 27 k array, we only focused on dvcs which exhibited increases in dnam in the precursor lesions. we considered the top ranked  <dig>   <dig> and  <dig> dvcs . in the case of gamlss, which provides two p-values per feature, we ranked the selected features according to the significance of the dv statistic. for each dv algorithm, we then computed and compared t-statistics of these top ranked dvcs in two independent illumina 27 k data sets profiling normal and cin2+ samples, and another 27 k dataset of normal cervix and cervical cancers &” and “cc” in additional file 1: table s1). the fraction of dvcs attaining t-statistics larger than  <dig>   and preserving the same directionality of change in the independent data was used as the ppv estimate. we note that although using a p <  <dig>  in the independent data set does not correct for multiple-testing of  <dig>   <dig> or  <dig> features, that in this context it is more important to control the false negative rate . in other words, using an overly stringent significance threshold in the independent data would lead to an unnecessarily large fnr. moreover, the same criterion is used for each method.

in the context of breast carcinogenesis, we applied the dv algorithms to identify dvcs hypervariable in the  <dig> normal-adjacent samples compared to the  <dig> normal samples from healthy women. because of the design of the 450 k array, we now considered dvcs which exhibited either increases or decreases in dnam in the normal-adjacent samples. we considered the top ranked  <dig>   <dig> and  <dig> dvcs in each category . in each case, we then computed t-statistics of these top ranked cpgs, as derived from comparing the  <dig> normal breast tissue samples to  <dig> breast cancers. the fraction of dvcs attaining t-statistics larger  than  <dig>    and preserving the same directionality of change in the independent data, was used as the ppv estimate. as before, this threshold ensures a reasonable compromise between the fdr and fnr.

RESULTS
dv algorithms that have strong control for the type- <dig> error rate do not identify differentially variable cpgs  in studies profiling precursor cancer lesions
our overall strategy is summarized in fig.  <dig>  briefly, we select two dna methylation data sets comparing normal cells from healthy individuals to normal cells which either become neoplastic a few years later , or which were collected adjacent to a breast cancer . we compare dv algorithms in their ability to identify dvcs between these two normal phenotypes . to assess whether the dvcs are biological, i.e. whether they define putative field defects, we ask if these dvcs exhibit progression/enrichment within established neoplastic tissues . this strategy allows us to compare dv algorithms in their ability to detect field defects.fig.  <dig> overall strategy for comparing dv algorithms in their ability to identify field defects in cancer: a in a discovery step, we apply five dv algorithms  to identify differentially variable cpgs  between two normal phenotypes, in two tissue types, as shown. the dv algorithms differ in their sensitivity and control of type- <dig> error rate, with some dv algorithms not identifying stochastic outlier profiles , whilst others are sensitive to them. b in the validation step, we assess the identified dvcs  of each dv algorithm in terms of whether they exhibit progression/enrichment within established neoplastic cells or invasive cancers. this allows an objective comparison of the dv algorithms and helps assess whether stochastic epigenetic outliers identified in step-a using algorithms such as ievora are biological or not



we decided to compare a total of  <dig> dv algorithms, with four of these having been proposed recently:  bartlett’s test   <cit> ,  a joint test for differential means and differential variance in dna methylation   <cit> ,  an empirical bayes levene-type test   <cit>  and  a test based on a generalized additive model for location and scale   <cit> . as previously shown, bartlett’s test is highly sensitive to single outliers , and assuming that single outliers are not of biological interest, this translates into a poor control of the type- <dig> error rate. thus, the recently proposed j-dmdv, gamlss and diffvar algorithms offer improved control of the type- <dig> error rate . in addition to these  <dig> tests, we here devised a novel dv algorithm, which we call “ievora” , similar to the original evora  algorithm  <cit> , and which can be thought of as providing a regularized version of bartlett’s test.

we first applied each of these five dv algorithms, as well as moderated t-tests, to a data set  which had profiled  <dig> cytologically normal cervical smear samples with illumina 27 k dna methylation beadarrays, with  <dig> of these  <dig> samples being from women who three years after sample collection developed a high grade cervical intraepithelial neoplasia   <cit> . we note that there were no genome-wide significant differentially methylated cpgs  between the normal samples from women who remained disease-free and the normal samples which progressed to cin2+, as assessed using moderated t-tests , in agreement with our previous observation  <cit> . we next compared all five dv algorithms in their ability to detect differentially variable cpgs  between the same two phenotypes. we observed marked differences, with j-dmdv and diffvar not identifying any dvcs at genome-wide significance, in stark contrast to ievora and gamlss which could identify many dvcs . on the other hand, if we compared normal to cin2+ samples, or normal samples to cervical cancer, we observed many dmcs and all dv algorithms had enough sensitivity to identify dvcs .table  <dig> comparison of differential variability  and t-test feature selection algorithms on dnam data

 <dig> 
 <dig> 
 <dig> 
 <dig> 
the rows label the name of the feature selection algorithm, the number of identified features associated with different phenotypes at an fdr <  <dig> . the phenotypes considered are prospective risk of cin2+ , cin2+ , cc , normal breast tissue adjacent to a breast cancer , and breast cancer . in the context of the cervix, the reference phenotype were normal cervical samples profiled in each study . in the context of breast, the reference were  <dig> normal breast tissue samples from healthy women. we note that since bartlett’s-test and ievora only differ in the ranking order of significant features, that their values here are identical. in boldface we indicate the algorithm identifying most dvcs in each of the two normal-to-normal comparisons

fig.  <dig> sensitivity to detect field defects in cancer: a histograms of p-values of five feature selection methods  in the artistic data set comparing  <dig> cytologically normal samples which do not progress to cin2+ and  <dig> cytologically normal cells which do progress to cin2+ within 3 years. b as  but now for the pre-bc data set comparing  <dig> normal breast samples from healthy women to  <dig> normal-adjacent samples from age-matched breast cancer patients



the algorithms performed similarly in a second data set, measuring dna methylation  in over  <dig> samples, including  <dig> normal breast tissue samples from healthy women,  <dig> normal-adjacent breast tumor matched pairs and an additional  <dig> unmatched breast cancers . in this independent set we could also not detect any dmcs between the normal cells from healthy women and the normal cells adjacent to breast cancers . the two dv algorithms which in the cervical smear analysis could not identify any dvcs, could also not identify any dvcs in this set , or in the case of diffvar, not as many as galmss or ievora . in agreement with the cervical study, if we compared the normal samples from healthy women to breast cancers, we observed that most sites in the genome constituted dmcs, as well as dvcs, and that any dv algorithm could identify dvcs .

dvcs pinpoint epigenetic field defects which progress to invasive cancer
the increased sensitivity of ievora and gamlss to detect dvcs in pre-neoplastic lesions does not necessarily mean that these dvcs are biological features of relevance to the carcinogenic process. however, if dvcs detected between normal and pre-neoplastic lesions exhibit progressive changes in neoplasia and invasive cancer, then this would support their biological relevance. thus, we compared all the algorithms in their ability to detect cpg sites in pre-neoplastic lesions, which later progress in neoplasia and/or invasive cancer . in the context of cervical carcinogenesis, progression was assessed using two independent data sets profiling normal and cin2+ samples, as well as a data set profiling normals and invasive cervical cancers  <cit> . we observed that dvcs selected and ranked using ievora, bartlett’s test  or gamlss were more likely to undergo further significant dnam changes  in cin2+ and cervical cancer compared to features selected using t-tests, or one of the other dv algorithms  . ievora was more robust than bt and gamlss, attaining positive predictive values  for cin2+ of over 25 % and for cervical cancer of over 60 % across a larger range of top ranked dvcs .fig.  <dig> positive predictive values  of dvcs identified from pre-neoplastic lesions in cervical neoplasia and invasive cervical cancer. a ppvs of differentially variable cpgs  selected by each of five different dv algorithms from the artistic data set , with the ppv values estimated in an independent illumina 27 k set profiling  <dig> normal cervical smears  and  <dig> cin2+ samples. the number of top-ranked selected dvcs increases along the panels from left to right. the ppv was estimated as the fraction of hypermethylated dvcs attaining a t-statistic larger than  <dig>   in the independent set. only hypermethylation was considered due to the design of the 27 k beadarray which is overrepresented for probes in gene promoters. b as , but now for an independent illumina 27 k set profiling  <dig> normal cervical tissue  and  <dig> invasive cervical cancers 



ievora also outperformed all other dv algorithms in the context of breast carcinogenesis, where progression was assessed by comparing the  <dig> normal breast samples from healthy women to the  <dig> breast cancers. in most cases, ievora achieved ppvs for breast cancer of around 80 % or over, in stark contrast to bt or gamlss, whose ppvs never exceeded 40 % .fig.  <dig> positive predictive values  and progression of dvcs from normal-adjacent tissue in invasive breast cancer. a ppvs of differentially variable cpgs  selected by each of five different dv algorithms from comparing  <dig> normal breast samples from cancer-free women to  <dig> normal samples adjacent to breast cancers, with the ppvs estimated in  <dig> invasive breast cancers . the number of top-ranked selected dvcs increases along the panels from left to right. ppvs were estimated for hyper-and-hypomethylated dvcs separately: in the case of hypermethylated  dvcs, ppv was estimated as the fraction of these cpgs attaining a t-statistic larger  than  <dig>   when comparing invasive cancer to normal. b left panel: for the top  <dig> dvcs selected using ievora , scatterplots compare the dna methylation values of these sites in the  <dig> normal adjacent samples  to the corresponding dna methylation values in the matched breast cancers . observe how hypermethylated dvcs tend to exhibit further increases in dnam in the breast cancers that are matched to their corresponding normal-adjacent tissue, whereas the opposite is true for hypomethylated dvcs. right panel: as left panel, but now plotting the difference in dnam between the normal-adjacent sample and normals  to the corresponding difference in dnam between the matched breast cancer and normals . we note that because each data point corresponds to  <dig> cpg site in one patient who provided a normal-adjacent and breast cancer sample, that some of the hypermethylated  dvcs may exhibit lower  methylation in some of the normal-adjacent samples compared to the normal state



to further demonstrate the biological relevance of dvcs in breast cancer progression, we selected the top ranked  <dig> dvcs  between the  <dig> normal breast samples and the  <dig> normals adjacent to breast cancers and further compared their dna methylation values in the  <dig> matched breast cancers. this showed that approximately  <dig> to 86 % of the dvcs which were hypermethylated in normal-adjacent tissue , exhibited additional dnam increases in the matched breast cancers . a similar pattern was observed for the case of dvcs that were hypomethylated in normal-adjacent tissue, although the association was less striking . together, these results demonstrate that ievora is able to identify epigenetic field defects which exhibit further progressive changes in breast cancer.

types of dv in dna methylation and their dynamics in carcinogenesis
next, we sought to understand why there are such marked differences among dv algorithms to detect dvcs in the earliest stages of carcinogenesis, whilst differences are less marked in later stages . based on extensive data analysis of dna methylation datasets  <cit> , we first categorized dv into  <dig> broad classes . we define “type- <dig> dvcs” as those which also differ significantly in terms of average dna methylation levels , with a further subdivision into “type-1a” and “type-1b” depending on whether the dvcs exhibit stronger differences in the mean or variance . in contrast to type- <dig> dvcs, type- <dig> and type- <dig> dvcs only show differences at the level of dnam variance, with average levels of dnam in each phenotype being statistically indistinguishable . the key difference between type- <dig> and type- <dig> dvcs is that in the type- <dig> case, the increased variance is driven by few outliers exhibiting coordinated changes , whereas in the type- <dig> case, the increased variance is potentially due to more outliers but with a larger level of discoordination, with outliers exhibiting both hyper and hypomethylation . real data examples confirm the existence of these different types of dv , and although most of these focus on hypermethylation, analogous types of dv exhibiting hypomethylation are also observed .fig.  <dig> types of differential variability. a simulated examples of different types of dv arising in dnam studies, with y-axis labelling the dnam fraction. the horizontal dashed lines indicate the mean in each phenotype. phenotype is labelled by a different color. p-values from a t-test , a wilcoxon rank sum test  and bartlett’s test  are given. bartlett’s test is a test for differential variance. b real data examples of the types of dv shown in . the horizontal dashed lines indicate the mean in each phenotype. phenotype is labelled by a different color. n = normal, cin2 + =cervical intraepithelial neoplasia of grade  <dig> or higher , cc = cervical cancer . p-values from a t-test , a wilcoxon rank sum test  and bartlett’s test  are given. bartlett’s test is a test for differential variance



demonstrating that this taxonomy of dv is of biological relevance, we observed that dvcs typically exhibited progressive changes in dna methylation in carcinogenesis, evolving from being type- <dig> dvcs in the earliest stages of cancer to being type- <dig> dvcs in neoplasia . confirming this dynamics of dv on a global scale, we observed that type- <dig> and type- <dig> dv exhibited widely different frequencies depending on disease stage, with type- <dig> dv being very infrequent in pre-neoplastic lesions but much more prominent in neoplasia and invasive cancer .fig.  <dig> the dynamics of dv in carcinogenesis and operating characteristics of dv algorithms. a progression of dv in cervical carcinogenesis. left panel depicts the dnam beta-value of a specific cpg  across different disease stages in cervical carcinogenesis, including cytologically normal cells which remain normal 3 years later , cytologically normal cells which progress to cin2+ 3 years later , cervical intraepithelial neoplasia of grade  <dig> or higher  and cervical cancer. right panel is a boxplot representation, indicating the p-values from a t-test , wilcoxon rank sum test  and bartlett’s test  between the normal state  and each of the other  <dig> stages. b relative fractions of type-1a, type-1b and type- <dig> dvcs in cervical and breast carcinogenesis. dvcs were selected using an fdr threshold of  <dig>  on the bartlett’s test p-value. they were defined to be of type- <dig> if the t-test p-value was not significant . they were defined to be of type- <dig> if the t-test p-value <  <dig> , and of type-1a if the t-test p-value was more significant than the one from the bartlett’s test, otherwise defined as type1-b. in the context of the cervix, the reference samples were normal cervical samples from the corresponding study. in the context of breast, the reference samples were normal breast tissue samples from healthy women. c left panel: barplots of estimated sensitivity  values averaged over  <dig> simulated runs for a number of different dv algorithms . dvcs were selected at an estimated fdr <  <dig> . shown are the overall sensitivities to detect any dvc, and the corresponding sensitivities to detect particular types of dv. right panel: boxplots of the true fdrs for each dv algorithm. green dashed line indicates the line fdr =  <dig> 



thus, we posited that the variable performance of dv algorithms and the critical dependence on disease stage, could be explained by their varying sensitivities to detect different types of dv. to this end, we conducted a simulation study, where we simulated dvcs from the type-1a, type-1b and type- <dig> subtypes, and then compared the sensitivity of the different algorithms to detect them . we observed that bartlett’s test, ievora and gamlss were able to retrieve all types of true dvcs with equal power without losing much control of the false discovery rate  . in contrast, although j-dmdv and diffvar could achieve much better control of the fdr, their power to detect type- <dig> dv was clearly compromised .

outlier dvcs are not markers of immune or stromal cells, but are enriched for transcription factor binding sites and prc2/bivalent target genes
in principle, one could argue that outlier dvcs are the result of alterations in tissue composition caused by changes in stromal or immune-cell infiltrates. if so, we reasoned that a gene set enrichment analysis  would reveal enrichment of biological terms related to stromal or immune cell-types . performing a gsea using an expanded molecular signatures database   <cit> , which included sets of transcription factor binding sites, as implemented by us previously  <cit> , we did not observe however any evidence for enrichment of stromal or immune-cell type terms among hypervariable dvcs . in fact, hypervariable dvcs only exhibited a strong enrichment for bivalently marked genes and binding sites of transcription factors specifying chromatin architecture, including prc <dig>  rad <dig> and ctcf . thus, together, these results support the view that changes in the stromal/immune cell composition of the normal tissues are not driving the specific outlier dvcs as identified using ievora.

outlier dvcs are underenriched for cross-reactive and polymorphic probes
if outlier dvcs are biological features, marking cancer field defects, we reasoned that these dvcs would also be underenriched for probes that have been deemed to be cross-reactive or polymorphic  <cit> . indeed, focusing on the  <dig> dvcs identified using ievora in the breast tissue study , we observed an overlap of  <dig> cpgs with the  <dig> cross-reactive and polymorphic probes of chen et al.  <cit> , representing an odds ratio  overlap of  <dig> , representing a significant underenrichment . equivalently, by random chance, the overlap should have been around  <dig> . restricting to the top  <dig> hypervariable and hypermethylated dvcs of ievora, the overlap was  <dig> with an associated or of  <dig> , when by random chance the expected overlap should have been around  <dig>  representing again a massive underenrichment .

discussion
the data presented here strongly supports the view that dna methylation alterations in pre-neoplastic cells are of an infrequent and hence stochastic nature, posing a statistical challenge to their identification. the epigenetic field defects were characterized by relatively few “outlier” samples exhibiting significant deviations in dna methylation  from a normal ground state. because of this, average levels in dnam were not significantly changed, which is why ordinary t-tests or their non-parametric equivalents are underpowered to detect them. this problem is only exacerbated by the inherent difficulty to acquire sufficiently large numbers of normal tissue specimens from healthy and cancer patients. thus, since increasing sample size is unrealistic, statistical methodologies which can increase the sensitivity of the assay offer the best hope to identify epigenetic field defects.

in light of this, the results presented here have deep and far-reaching implications: using two of the largest available dna methylation data sets profiling precursor cancer lesions in two different cancer types, we have here shown that epigenetic field defects can only be identified if we adopt a feature selection paradigm based on differential variability. this substantially strengthens our previous observations  <cit>  and marks a paradigm shift for feature selection in the context of epigenetic field defect studies in cancer.

there are a number of other important observations that support, directly or indirectly, the statistical and biological significance of dvcs. first, we have seen that many of the dvcs defining epigenetic field defects progress to exhibit more frequent and therefore more homogeneous deviations in dna methylation in samples that are neoplastic or invasive. thus, the stochastic heterogeneity of dnam deviations seen in pre-neoplastic lesions gives way to a much more homogeneous and deterministic pattern characteristic of neoplasia and cancer  <cit> . this is also the reason why ordinary t-tests, which largely assume homogeneous phenotypes, are perfectly adequate to identify cancer diagnostic markers  <cit> . second, dvcs are not enriched for stromal or immune cell type go-terms, instead exhibiting enrichment for binding sites of non cell-type specific tfs, strongly supporting the view that they do not reflect mean shifts in stromal or immune cell-type composition. such mean shifts in stromal or immune cell-type composition, which could well be present in the tissues studied here, could be picked out by algorithms such as cam or isva  <cit> , since these algorithms are designed to identify average shifts. however, given the complexity of epithelial tissue types  <cit> , we can’t discard that outlier dvcs may mark relatively large shifts in the epithelial cell subtype composition of the tissue. indeed, the enrichment of dvcs in the matched breast cancers, may well reflect the proportional increase of the epithelial cell of origin of the tumour  <cit> . third, and related to the previous point, we have demonstrated that dvcs exhibit a non-random genomic distribution, mapping preferentially to binding sites of key transcription factors specifying chromatin architecture. fourth, dvcs identified using ievora are strongly underenriched for cross-reactive and polymorphic probes identified by chen et al.  <cit> . this shows that such problematic probes are unlikely to give rise to dvcs, consistent with the view that dv between phenotypes is a biological feature. finally, we have shown elsewhere that dvcs in normal breast tissue correlate with clinical features such as tumor size and clinical outcome  <cit> .

importantly, our statistical analysis also demonstrated that not all existing dv algorithms are able to identify epigenetic field defects. indeed, we have seen that different dv algorithms exhibit widely different operating characteristics , largely dependent on the type of dv that is prominent within the carcinogenic stage under consideration. thus, dv algorithms which can recognize heterogeneous dna methylation outliers , have the sensitivity to detect epigenetic field defects, whereas dv algorithms which only aim to control the type- <dig> error rate  do not.

of note, the better performance of ievora over the other dv algorithms was not just restricted to power, but also applied to the ppv. this is particularly noteworthy, because in theory, one main limitation of the bartlett’s test implemented in ievora is the potentially large type- <dig> error rate. this explains why in some instances the ppvs were relatively low, e.g. as in the case of comparing normal to cin2+ , yet importantly the ppvs obtained from the other dv algorithms were generally even lower . we stress again that although the increased sensitivity afforded by ievora comes at the expense of a high fdr , that this is nevertheless preferable over using tests that yield zero sensitivity.

with regard to the ppv evaluation framework used in this manuscript, it is important to clarify a key and subtle point: the t-statistic computed in the independent data sets  to assess progression, has nothing to do with the t-statistic used in the ievora algorithm, which is only used to re-rank dvcs. it is important to realize that the use of a t-statistic to re-rank significant dvcs in the discovery set does not bias the ppv performance of ievora in the independent data sets. indeed, we already previously showed that selecting and ranking features according to a t-test in the discovery set would yield worse ppvs in the independent data sets compared to the ppvs obtained using bartlett’s test  <cit> . this indicates that cpgs exhibiting the most homogeneous changes  in the discovery set, are either not true positives , or they reflect other biological effects which do not exhibit progression in more advanced cancer stages.

it is also worth emphasizing again the scenarios where we would expect ievora to be a useful feature selection tool. ievora is aimed at cancer studies where one is comparing two normal cellular phenotypes, with one of the phenotypes representing normal tissue at risk of neoplastic transformation. the two most common scenarios would include normal samples collected in a prospective setting, with a subset of the normal samples becoming cancerous at a later stage, or a comparison of normal tissue from healthy individuals to normal tissue found adjacent to the cancer. such normal-adjacent tissue is “at risk” of neoplastic transformation, given that nearby tissue has already undergone transformation. we stress that ievora is not required and may even be counterproductive in scenarios where one wishes to identify diagnostic markers between normal and neoplasia or between normal and cancer tissue. the tissue being considered is also an important consideration, since our data only provides evidence for the biological importance of dnam outliers in the actual tissue of origin for the cancer. prospective or case–control cancer ewas studies conducted in a surrogate tissue such as blood are scenarios where dnam outliers are probably not of direct biological relevance to cancer development, and therefore represent situations where ievora is not appropriate, an observation we already made previously  <cit> . indeed, we stress again that ievora has not been validated in general ewas conducted in tissues such as blood, and therefore we advise the reader against its use in such studies, unless ample independent replication sets are available which would allow the biological and statistical significance of dvcs to be established. even in the context of cancer field defect studies, given that the fdr and type- <dig> error rate can be high, application of a tool such as ievora is only advisable if independent data is available. this is a critical point, because dv can be driven by a whole plethora of factors, including genetic variation or exposure to unknown environmental factors. only by testing dvcs in independent data, can one firmly establish their biological and statistical significance.

finally, it is important to contrast the novel statistical methodology presented here to the feature selection method used in gwas: there, one compares allelic frequencies between cases and controls. the direct analogue of this in ewas is to search for loci that are altered as frequently as possible in cases compared to controls, i.e. to identify genomic sites where the mean level of dnam differs as much as possible between the two phenotypes  <cit> . as we have seen however, such an approach is seriously underpowered in cancer studies where tissue availability is a major obstacle. the novel feature selection paradigm of dv offers a new dimension in the context of ewas, where, in addition to allelic frequency, we also need to take the magnitude of the alteration into consideration. as shown here, infrequent but bigger changes in dnam  are more likely to define cancer field defects, than more frequent yet smaller dnam changes.

CONCLUSIONS
in summary, we have here demonstrated that dna methylation outliers in pre-neoplastic lesions define epigenetic field defects, marking cells which become enriched in invasive disease and which may therefore contribute casually to cancer progression. we recommend that studies aiming to identify epigenetic field defects in pre-neoplastic cells, and which for cost or logistical reasons may be underpowered, make use of dv algorithms like ievora, which improve the sensitivity, since this may be preferable over using algorithms which only provide strong control of the type- <dig> error rate and which therefore lack sensitivity.

ethical statement
all data analysed in this study is in the public domain and have been analysed in previous studies.

additional files
additional file 1: document containing all supplementary figures and tables. 

additional file 2: gsea result tables of hypervariable dvcs, as identified using ievora, in the normal breast study comparing normal breast from healthy women to normal breast adjacent to breast cancer. there are  <dig> tables, corresponding to hypervariable dvcs mapping to tss <dig>  tss <dig> or 1st exon regions, and which are hypermethylated  or hypomethylated  in normal-adjacent tissue, as well as hypervariable dvcs mapping to gene-body or 5′utr regions, which are hypermethylated  or hypomethylated  in normal-adjacent tissue. in each case, the columns label the number of genes in the msigdb database list , the number present prior to ievora analysis , the corresponding fraction , the number of genes overlapping with the ievora selected list , the corresponding odds ratio  and one-tailed fisher test p-value , the adjusted p-value using benjamini-hochberg correction, and the gene symbols of the genes present in the overlap. 



abbreviations
dmcdifferentially methylated cpg

dnamdna methylation

dvdifferential variability

dvcdifferentially variable cpg

ewasepigenome-wide-association study

fdrfalse discovery rate

poiphenotype of interest

competing interests

the authors declare that they have no competing interests.

authors’ contributions

study design was done by aet and mw. statistical analysis and writing of manuscript was done by aet. aj contributed to the generation of data. all authors read and approved the final manuscript.

