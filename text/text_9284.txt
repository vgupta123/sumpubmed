BACKGROUND
coreference can be defined as the relation between textual mentions that refer to the same real-world entity  <cit> . coreference resolution is the natural language processing  task that is concerned with identifying such mentions and linking them to form coreference chains . while a key task in natural language understanding, coreference resolution remains far from being solved. without reliable coreference resolution, nlp systems focusing on advanced semantic tasks such as relation extraction, automatic summarization, and question answering are likely to suffer. consider the fragments of a medline abstract  in example . the first two sentences begin the abstract and the third sentence concludes it. 
 pulmonary arterial hypertension  is a rare and progressive disease of the pulmonary arterial circulation ….

 there are currently  <dig> classes of drugs approvedfor the treatment of pah:prostacyclinanalogues, endothelin receptor antagonists, andphosphodiesterase type  <dig> inhibitors. …

 although definitive evidence will require randomized and properly controlled long-term trials, the current evidence supports the long-term use of these drugs for the treatment of patients with pah.





the underlined mentions form a coreference cluster: { <dig> classes of drugs approved for the treatment of pah, {prostacyclin analogues, endothelin receptor antagonists, and phosphodiesterase type  <dig> inhibitors}, these drugs}. pairwise relation representation  can also be used to represent coreference. in the absence of coreference resolution, a relation extraction system could extract the following, not very informative, relation from the concluding sentence in example  above: 
drugs-treats-pah



on the other hand, with successful coreference resolution, the system would be able to extract the following relations, which are more specific and informative. 
prostacyclin analogues-treats-pah

endothelin receptor antagonists-treats-pah

phosphodiesterase type  <dig> inhibitors-treats-pah



in doing so, the system would also be able to move beyond sentence level processing to discourse level processing, bringing us closer to discourse understanding, the ultimate goal in nlp.

several types of coreference are often distinguished. for example, anaphora is a coreference relation in which a coreferential mention , such as these drugs above, refers to a previously mentioned entity  in text. cataphora refers to a relation in which the coreferential expression  refers to an entity subsequent to the expression in text . broader views of coreference also consider relation types such as bridging and appositive. different types of coreference can be indicated with mentions of varying types. for example, a major type of anaphora  is indicated by pronouns, such as it, their, itself. in example , the anaphor these drugs is a demonstrative noun phrase, therefore the anaphora relation can be referred to as nominal anaphora. nominal anaphora is sometimes also referred to as sortal anaphora since such anaphors carry semantic type  information, in contrast to pronominal expressions. for instance, in example , the antecedents of these drugs can only be drug or drug class instances. in the studies focusing on coreference resolution in biomedical literature, sortal anaphors have attracted most attention, since they occur more frequently than other types. castaño and pustejovsky  <cit>  found that approximately  <dig> % of anaphora instances in their corpus of medline abstracts were sortal. this was confirmed by gasperin and briscoe  <cit> , who found that the majority of anaphora instances involved definite and demonstrative noun phrases in their corpus of full-text articles about drosophila melanogaster.

semrep semantic interpreter
semrep  <cit>  is a natural language processing tool that extracts semantic relations, also referred to as predications, from biomedical literature. each predication is a logical subject-predicate-logical object triple, whose elements are drawn from the umls knowledge sources  <cit> ; the subject and object are concepts from the umls metathesaurus and the predicate is a relation type from an expanded version of the umls semantic network. semrep extracts a wide range of predicates regarding clinical medicine , substance interactions , genetic basis of disease , and pharmacogenomics . from the input sentence in example , semrep generates the three predications in example . mentions corresponding to the predication arguments are underlined and those corresponding to the predicates are in bold. 
  the antiviral agentamantadine has been used to manageparkinson’s disease or levodopa-induced dyskinesias for nearly  <dig> decades.

 amantadine-isa-antiviral agents

amantadine-treats-parkinson disease

amantadine-treats-levodopa-induced dyskinesias





semrep processing relies on the umls specialist lexicon  <cit> , medpost part-of-speech tagger  <cit> , and underspecified syntactic analysis, and it is supported by metamap  <cit>  for normalizing noun phrases to umls metathesaurus concepts. entrez gene  <cit>  serves as a supplementary source to the umls metathesaurus with respect to gene/protein terms. indicator rules are used to map lexical and syntactic phenomena to predicates. indicators include lexical categories, such as verbs, nominalizations, and prepositions, and syntactic constructions, such as appositives or modifier-head structure in the simple noun phrase. for instance, in example , the isa predicate is indicated by the fact that its arguments are in a restrictive appositive construction , while treats is lexically indicated by the verb manage. using an ontology engineering approach  <cit> , semrep has been extended to domains that are outside the scope of the umls, such as disaster information management and public health. it has also been the basis for the semantic medline web application  <cit>  and semmeddb, a pubmed-scale repository of semantic predications  <cit> .

overview
in the current study, our goal has been to extend semantic interpretation capabilities of semrep through anaphora resolution. based on the observed prominence of sortal anaphora in biomedical literature  <cit> , we focused specifically on sortal anaphora resolution. our rule-based methodology has a linguistic orientation and makes heavy use of umls semantic knowledge. a major contribution of our work is that our approach is not restricted to certain entity types, in contrast to other biomedical coreference resolution studies that focus on certain types of biomedical entities . our study is also distinct in its focus on the impact of anaphora resolution on relation extraction at a large scale.

to refine and evaluate our approach, we annotated a set of  <dig> medline citations  for sortal anaphora. we evaluated our approach in several ways: 
evaluation of sortal anaphora resolution on our annotated corpus

partial evaluation of sortal anaphora resolution on the protein coreference dataset used in the bionlp  <dig> shared task  <cit> 

evaluation of the impact of anaphora resolution on semrep predications, for which we compared semrep results with and without anaphora resolution on a separate set of  <dig> sentences

estimation of the quantitative effect of anaphora resolution at a larger scale, for which we compared the number of predications and relation types extracted by semrep using anaphora resolution with that extracted without anaphora resolution on  <dig> million medline citations



the results show that our semantic approach is effective in recognizing sortal anaphora relations and that its incorporation into semrep allows it to replace generic and uninformative relations with more specific and informative ones. we have incorporated our resolution approach into semrep, making it an option in semantic processing. the annotated corpus of medline citations is available at http://skr <dig> nlm.nih.gov/sortalanaphora/.

related work
pioneering work in coreference resolution in general english focused on the interaction of pronominal anaphora with syntactic structure and discourse constraints . availability of corpora annotated for coreference, such as muc <dig>  <cit> , led to the prominence of supervised learning approaches for this task . more recently, haghighi and klein  <cit>  presented a deterministic algorithm that relies on syntactic, semantic, and discourse constraints and demonstrated good performance on several corpora. lee et al.  <cit>  extended this approach to propose a sieve architecture, which applies a set of deterministic coreference models  one at a time from highest to lowest precision, each sieve using the output of the previous one. sieves include various string matching algorithms as well as speaker identification and pronoun resolution models. their approach yielded state-of-the-art performance on the ontonotes corpus  <cit> , the current standard for evaluating coreference resolution systems for general english. the sieve architecture has been made part of the stanford corenlp toolkit  <cit>  and has been extended for multilingual coreference resolution by systems participating in the conll  <dig> shared task  <cit> . in addition to such end-to-end coreference resolution approaches, much effort has also been devoted to specific coreference resolution subtasks, such as recognizing non-referential mentions   <cit>  and anaphoricity detection   <cit> .

in the biomedical domain, most coreference resolution research has involved biomedical literature. castaño and pustejovsky  <cit>  focused on pronominal and sortal anaphora resolution of bio-entities, using semantic information from umls. they achieved  <dig>  % f <dig> score on a small set of medline abstracts. their algorithm is based on scoring potential antecedents according to their compatibility with the anaphor . the candidate with the highest score is taken as the antecedent. a similar approach is taken by kim et al.  <cit> , who additionally investigated the role of centering theory  <cit> , syntactic parallelism between the anaphor and the antecedent, coordinate noun phrases, and appositive constructions. their approach yielded a f <dig> score of  <dig> % on a different set of medline abstracts. yang et al.  <cit>  and torii and vijay-shanker  <cit> , on the other hand, used supervised machine learning techniques for anaphora resolution. taking a noun phrase clustering approach and casting the problem as a binary classification task, yang et al.  <cit>  achieved an f <dig> score of  <dig>  % on a small set of medline abstracts. focusing on sortal anaphora only, torii and vijay-shanker  <cit>  reported  <dig>  % precision and  <dig> % recall in cross-validation experiments. diverging from this line of research that focused on anaphora resolution in medline abstracts, gasperin and briscoe  <cit>  annotated a corpus of five full-text molecular biology articles with sortal anaphora as well as with types of domain-specific associative coreference, such as homology and related biotype . their annotation also included set-membership relations. the bayesian probabilistic model they used achieved an f <dig> score of  <dig> % for coreference, although it performed poorly on associative relations. in line with the observation that coreference resolution could improve event extraction pipelines, a supporting task was proposed in the bionlp  <dig> shared task on biological event extraction  <cit> . a corpus of medline citations annotated for sortal and pronominal anaphora were provided to participants . the best system was an adaptation of an existing coreference resolution system for newswire text and achieved an f <dig> score of  <dig> %  <cit> , a significant performance loss from its performance on news text. using stanford corenlp sieve-based coreference resolution  <cit> , choi et al.  <cit>  also obtained very poor results, confirming a trend of performance degradation of systems developed for the general domain. underutilization of semantic information seems to be a factor for this trend  <cit> . conversely, using domain-specific semantic information, nguyen et al.  <cit>  achieved an f <dig> score of  <dig>  % on the same corpus. with a hybrid approach, d’souza and ng  <cit>  reported an f <dig> score of  <dig>  %. improvements of varying degrees in event/relation extraction have been reported with the incorporation of coreference resolution . a common feature of all these studies is that they focus on a pairwise relation representation of coreference and on specific entity types. in contrast, in the craft corpus  <cit> , full coreference chains are annotated in the spirit of the ontonotes corpus, and all semantic types are considered . in addition, full-text articles are annotated, rather than abstracts. we are not aware of any resolution studies based on this recent corpus.

in the biomedical domain, coreference resolution has also been addressed in clinical narratives, drug labels, and consumer health texts. the  <dig> i2b2/va shared task was concerned with coreference resolution in clinical reports  <cit> . training and evalution corpora annotated with coreference mention clusters were provided. entity types considered for coreference included problem, person, test, treatment, and anatomical site. rule-based, supervised learning, and hybrid approaches were proposed; a supervised learning approach which incorporated world knowledge and document structure  <cit>  obtained the best results in one corpus, while a rule-based system  <cit>  performed best in the other. segura-bedmar et al.  <cit>  developed a corpus of drug interaction documents annotated with anaphora  and obtained an f <dig> score of  <dig> % using centering theory constraints, semantic knowledge obtained with metamap  <cit> , and drug class information for resolution. névéol and lu  <cit>  improved the specificity of semrep predications by using simple anaphora resolution heuristics in consumer medication texts and mesh scope notes. focusing on consumer health questions, kilicoglu et al.  <cit>  incorporated resolution of anaphora and ellipsis  to their question frame extraction pipeline and reported an  <dig> point improvement in f <dig> score in this task thanks to anaphora resolution.

methods
in this section, we first discuss our data and the annotation study. next, we describe the algorithm that we developed for anaphora resolution. we conclude the section by describing our evaluation of the algorithm.

data and annotation
in order to develop, refine, and evaluate a sortal anaphora resolution module, we annotated a corpus of  <dig> medline citations with pairwise anaphora relations. since we aimed at a general approach that takes into account all semantic types and consequently supports semrep, we collected medline abstracts on a range of topics, including molecular biology and clinical medicine. most molecular biology citations were previously used for evaluating some specific aspect of semrep, such as nominalization processing  <cit> , or were annotated for semrep benchmarking  <cit> . citations on clinical medicine were identified by issuing a semmeddb query for the predicate types treats/prevents and process_of in the period from  <dig> to  <dig> and retrieving a random subset of the query results.

one hundred forty-nine citations were double-annotated by two of the authors of this paper  to develop and refine annotation guidelines as well as to calculate inter-annotator agreement. once a satisfactory inter-annotator agreement was achieved, the rest of the corpus  was annotated by one of the authors only . we used the double-annotated portion of the corpus for training and refining the algorithm, and the other portion for testing. the corpus was pre-annotated with entities extracted by semrep  to assist the annotators and simplify the task. annotators were instructed to annotate the named entities missed by semrep, if relevant for the sortal anaphora annotation task; however, we did not require them to annotate a specific semantic type for these entities and simply used span as a generic type. for example, from the phrase the flamenco gene, semrep only extracts a concept for the phrase head gene , as there is no specific concept for flamenco gene in the umls. this is clearly an inadequate mapping for the phrase. therefore, the full phrase was annotated as span since it acts as the antecedent in an anaphora relation.

the annotation task consisted of two steps: a) identifying the anaphoric mentions in text and b) linking them to their antecedent. some basic definitions and annotation guidelines were provided to the annotators, and these were refined in the course of the annotation study based on feedback and questions from the annotators. the annotation guidelines are provided as additional file  <dig>  the brat annotation tool  <cit>  was used for the annotation task. a sample sortal anaphora annotation is provided in fig.  <dig>  the anaphoric mentions are abbreviated as sortal and the links between the anaphoric mentions and the antecedents are abbreviated as coref.
fig.  <dig> a sample annotation. anaphora annotation in brat interface 



in the first phase of annotation, each annotator annotated  <dig> abstracts to familiarize themselves with the task. they discussed their annotations with the primary author, who adjudicated their differences. in the next step, each annotator independently annotated batches of approximately  <dig> abstracts at a time. after each batch, we calculated inter-annotator agreement to assess their progress, and the annotators reconciled their differences to create the gold standard reference for the batch. we calculated inter-annotator agreement for both the anaphoric mentions and the anaphora relations. as the inter-annotator agreement measure, we used the f <dig> score of one set of the annotations, with the other set taken as the gold standard, a measure often used for inter-annotator agreement in biomedical relation annotation  <cit> . it has been shown that κ statistic  <cit> , more typically used to calculate inter-annotator agreement, approximates f <dig> score in cases that lack a well-defined number of negative instances, which makes chance agreement close to zero  <cit> . after a satisfactory inter-annotator agreement was reached, one of the annotators  annotated the rest of the corpus  on her own.

algorithm
the anaphora resolution pipeline developed using the training set annotations is illustrated in fig.  <dig> 
fig.  <dig> the sortal anaphora resolution pipeline. the high-level view of the sortal anaphora resolution pipeline and and its incorporation into semrep



the algorithm consists of two main phases: anaphor detection and anaphor-antecedent linking. the first phase is concerned with recognizing the noun phrases that are sortal anaphors and marking them as such. the second phase of the algorithm inspects these sortal anaphors and attempts to link them to their corresponding antecedents. both phases of the algorithm presuppose a variety of linguistic information , made available by the core machinery of semrep. lexical and morphological information include individual tokens, their lemmas, part-of-speech tags, and inflection status  provided, to a large extent, by the specialist lexicon  <cit> . syntactic information includes noun phrases as well as their heads and modifiers, identified with a shallow syntactic parser. some syntactic constructions, such as appositives and coordinate noun phrases, are relevant to anaphora resolution and are identified as well. semantic information is provided by metamap and includes mappings from noun phrases to umls metathesaurus concepts with their cuis and semantic types. the algorithm also relies on taxonomic relations encoded in the umls metathesaurus, such as the one between amantadine and antiviral agents. such relations are already extracted as part of semrep’s hypernymy processing   <cit> . anaphora resolution requires that the entire previous discourse, not just the sentence with the anaphor, be available to identify antecedents. to facilitate this, we extended semrep to take into account all linguistic information from previous sentences in addition to the current sentence, taking the first step toward discourse-level processing.

anaphor detection
anaphor detection is performed after the noun phrases in the text are mapped to umls metathesaurus concepts by metamap. to recognize anaphors, we first identify noun phrases with particular determiners and adjectives that are used in sortal expressions. these include the definite article , demonstrative determiners , distributive determiners  and a demonstrative adjective . the next steps are concerned with anaphoricity and filter out the noun phrases that are unlikely to be anaphors, based on morpho-syntactic features. such noun phrases satisfy one of the following conditions: 
the noun phrase is in an appositive construction with the noun phrase that immediately follows it. for example, the definite noun phrase the gene in …the gene, brca <dig>  … is not anaphoric.

the noun phrase has a modifier that is mapped to the umls separately from the head; in other words, the modifier is an example of a rigid designator  <cit> . this precludes the src family from being considered a potential anaphor, since src is a rigid designator. a similar condition applies to noun phrases which are followed by a prepositional phrase cued by of. for example, the symptoms in the symptoms of lupus erythematosus is ruled out as an anaphor.

the noun phrase is cataphoric. we distinguish cataphoric phrases as those that contain the word following, as in the following signs.

the number feature of the noun phrase head is incompatible with that of the determiner. for example, in the fragment both short-term dynamic psychotherapy and cognitive therapy have a place …, both short-term dynamic psychotherapy is chunked as an individual noun phrase and this constraint rules it out as a potential anaphor, since the determiner both is plural and the head psychotherapy is singular. this step is applied mainly to address a shortcoming of noun phrase chunking, even though the number agreement principle between the head and the determiner is general.

the head of the noun phrase is not associated with a umls metathesaurus concept. these are excluded due to lack of semantic information to use in subsequent steps.



anaphor-antecedent linking
in the semrep pipeline, anaphor-antecedent linking is performed before indicator rules and argument identification rules are applied to generate semantic predications, so that argument identification rules can take the results of anaphora resolution into account when determining the arguments of predicates.

as preparation for this phase, we combine the linguistic analyses from the sentences prior to the sentence containing the sortal anaphor under consideration, including coordination information. anaphora resolution needs to take into consideration the entire discourse preceding the anaphor, especially in the context of medline abstracts, which are often relatively short.

the next step in anaphor-antecedent linking is selection of antecedents consonant with the sortal anaphor. to select these antecedents, we process the noun phrases  that precede the sortal anaphor. two consonance criteria are applied: semantic consonance and number agreement.

semantic consonance is concerned with the semantic compatibility of the sortal anaphor and the candidate antecedent noun phrase and is defined in terms of hypernymy. we use the term hypernymy in a broader sense than previous work  <cit>  where it was defined as a umls metathesaurus-based hierarchical relationship. we consider a word or a multi-word expression a to be a hypernym of another, b, if one of the following holds: 
the umls concept corresponding to a is an ancestor of the umls concept corresponding to b and they are not in a meronymic  relationship 

b belongs to a umls semantic group  <cit> , which has as one of its associated headwords the headword of a 

a and b have the same headword but map to different umls metathesaurus concepts and the number of tokens in b is greater than that in a 



the taxonomy constraint is similar to the definition of hypernymy in rindflesch and fiszman  <cit> . meronymy is assumed between a and b if their umls concepts both belong to anatomy semantic group and they do not have cell semantic type; in other words, if they both correspond to biological units higher than the cell. this constraint is necessary since the umls concept hierarchy encodes meronymic as well as taxonomic relationships. while meronymy may be useful for associative coreference  <cit> , we did not find it useful for sortal anaphora. the taxonomy constraint predicts semantic compatibility between cetirizine and the drug, while it finds that right ventricle and heart are incompatible, since the relationship between them is one of meronymy.

for the headword constraint, we developed a headword list for several semantic groups based on our training set. for example, disorder headwords include condition, ailment, abnormality, and problem, while the therapeutic modality headwords include medication, intervention, and agent. such word lists are useful to compensate for the fact that umls concepts corresponding to such general terms are often not in the expected taxonomic relation with specific instances of these semantic classes. the headword constraint predicts compatibility between the illness and immune reconstitution inflammatory syndrome, which are not in a taxonomic relationship in the umls, for example. on the other hand, the shared headword constraint predicts compatibility between the reaction and anaphylactoid reaction, because reaction and anaphylactoid reaction are mapped to different umls metathesaurus concepts and they share the same headword. finally, we stipulate that neither the sortal anaphor nor the antecedent candidate belong to the semantic group concept, which includes semantic types such as idea or concept, conceptual entity, and functional concept, and is too broad and heterogenous to be useful in anaphora resolution. for candidates that are coordinate noun phrases, the semantic consonance constraints are applied between the sortal anaphor and each of the conjuncts in the coordinate noun phrase.

the other consonance measure, number agreement, is a commonly used feature in coreference resolution. our implementation uses the number feature provided by the specialist lexicon. the sortal anaphor and an antecedent candidate are taken as compatible with respect to number if their heads agree on this feature . the number feature for unknown words is taken as singular. number agreement also takes into account coordinate noun phrases: a plural sortal anaphor is taken to be consonant with an antecedent candidate that is a coordinate noun phrase.

the anaphora resolution process is terminated if candidate antecedent selection results in no compatible antecedents or in a single compatible antecedent. in the former case, the anaphor may be a universal anaphor , which can refer to clauses, full sentences, or even the full discourse; resolution of such phenomena is beyond the scope of this study. in the latter case, we simply take the only compatible antecedent as the true antecedent and generate an anaphora link between the anaphor and the antecedent. on the other hand, if there are multiple compatible antecedent candidates, we predict the best antecedent based on its salience. the following steps are taken to identify the most salient of the antecedent candidates: 
if there are antecedent candidates in the same sentence, the one closest to the anaphor is taken as the antecedent.

else, we move to the closest preceding sentence with compatible antecedent candidates and the leftmost compatible candidate in that sentence is chosen as the antecedent.



these steps seek to predict discourse salience of entities, in a sense similar to prediction of the preferred center in centering theory  <cit> .

integrating anaphora resolution with relation generation
after generating anaphora links with the steps outlined above, semrep attempts to use these links in relation generation, if appropriate. for an anaphora link to be used in relation generation, we require that the sortal anaphor noun phrase serve as the subject or object argument of a predicate. in such cases, rather than using the sortal anaphor in the predication, we simply substitute it with its antecedent as the relevant argument. the rest of the relation generation procedure remains the same. in cases where sortal anaphor does not serve as an argument of a predicate, the corresponding anaphora link simply remains unused. for instance, in example , the anaphor these drugs was recognized as the subject of the predicate treatment, which indicates a treats relation. with no anaphora resolution, relation generation would simply generate the predication drugs-treats-pah. with anaphora resolution, the subject argument in this predication  is replaced by the umls concepts corresponding to the antecedents , resulting in three informative predications instead of the less informative drugs-treats-pah.

evaluation
in this study, we evaluated both anaphora resolution and its contribution to relation extraction. additionally, we assessed the quantitative impact of anaphora resolution on the pubmed scale repository of biomedical relations supported by semrep, semmeddb  <cit> .

as a baseline method for anaphora resolution, we considered a noun phrase containing one of the determiners or adjectives of interest  as a sortal anaphor and took the closest preceding noun phrase whose head word and number match those of the sortal anaphor as its antecedent. this baseline method is a more informed one than the one used by segura-bedmar et al.  <cit>  and kilicoglu and demner-fushman  <cit> , who simply considered the closest preceding noun phrase as the antecedent.

to evaluate anaphora resolution, we used the test set portion of the annotated corpus and calculated precision, recall, and f <dig> score. in calculating these metrics, we used relaxed matching criteria, due to the fact that semrep normalizes arguments of all relations  from text mentions to umls metathesaurus concepts. three matching criteria are defined. an anaphora relation generated by semrep is considered a true positive if: 
the character offsets of its arguments  overlap with those of a relation in the reference standard and the semantic types of the arguments match .

or one or both of its arguments are subsumed by a span annotation in the reference standard .

or the concept corresponding to the antecedent matches that of the antecedent in the relation in the reference standard .



to illustrate why the second criterion is necessary, consider the following example: 
 an adult male bullmastiff dog was treated for paraparesis and ataxia due to discospondylitis and disc herniation. at this time, the dog had a nonhealing ulcer between the pads of the left hindfoot.



in this example, the first phrase an adult male bullmastiff dog was annotated as the antecedent , which cannot be fully mapped to a umls concept. the algorithm identifies this noun phrase as the antecedent; however, it uses the concept corresponding to its head dog as the argument of the anaphora. using the second evaluation criterion, we consider such cases true positives.

the third criterion is probably the most relevant evaluation criterion for semrep, since semrep is specifically concerned with this ontological semantic level. consider the example below: 
 a radioaerosol technique was used to assess the effects on mucus clearance of  <dig> days treatment with formoterol or tiotropium, as well as single doses of these drugs. results: the  <dig> h whole lung retention of radioaerosol was significantly higher after  <dig> days treatment with tiotropium , but not after  <dig> days treatment with formoterol. however, patients bronchodilated after  <dig> days treatment with both drugs, so that the deposited radioaerosol may have had an increased distance to travel in order to be cleared by mucociliary action.



in this example, the anaphor both drugs refers to the drugs tiotropium and formoterol. following annotation guidelines, the annotators annotated the closest mentions to the anaphor in the sentence preceding the one with the anaphor. the algorithm, on the other hand, identified as the antecedent the coordinate noun phrase formoterol or tiotropium in the first sentence. at the ontological semantic level, this is equivalent to the annotated antecedents, although the corresponding mentions do not overlap with those in the reference standard. using the third criterion, we consider such cases true positives, as well.

for comparison with other anaphora resolution approaches and corpora, we also evaluated our approach against the bionlp protein coreference dataset  <cit> , the most widely used coreference resolution corpus focusing on biomedical literature. we limited our evaluation on this dataset to sortal anaphora instances and did not consider the cases of pronominal anaphora. sortal anaphora instances constitute  <dig>  % of all the coreference relations in this corpus . these instances were identified by removing the anaphora relations indicated by pronominal anaphors from the dataset.

to assess the contribution of anaphora resolution to relation extraction, we processed with semrep a set of  <dig> million medline citations that included abstracts, dated from april  <dig> to june  <dig>  two sets of output were generated: one set was generated without anaphora resolution and the other with anaphora resolution. we report results concerning the quantitative impact of anaphora resolution on this set. from the  <dig> million citation set, we also selected  <dig> sentences, for which anaphora resolution resulted in additional semantic predications. one of the authors  manually examined the predications in these sets and evaluated their correctness. in the absence of a predication reference standard for these sentences, we only calculated precision. in this study, we recognize that categorizing predications as simply true positive or false positive does not adequately elucidate the contribution of anaphora resolution to relation extraction, because in some cases, anaphora resolution increases the specificity and informativeness of an existing predication, rather than generating a new additional predication. for instance, in example , drugs-treats-pha is a somewhat uninformative  predication and, if anaphora resolution succeeds, it would be substituted by the predication prostacyclin analogues-treats-pah, which is correct and more informative. to accommodate such positive changes, we marked predications like drugs-treats-pha as partially correct in this evaluation.

RESULTS
in this section, we present results pertaining to inter-annotator agreement as well as the evaluation results and discuss these results in detail. we conclude the section by providing an error analysis.

inter-annotator agreement
the results of inter-annotator agreement calculation are provided in table  <dig> 


the inter-annotator agreement showed a clear improvement trend over three iterations, indicating that with sufficient guidelines and practice, good agreement can be achieved for this task. discussing the annotation differences and reconciling them before moving on to the next batch also seem beneficial.

annotation statistics
the distribution of anaphoric mentions and anaphora relations in the double-annotated set and the single-annotated set is shown in table  <dig>  the average numbers of tokens, mentions, and relations are given in parentheses. we also show the number of additional entity annotations  added to the corpus, corresponding to named entities missed by semrep  that were found to be relevant for anaphora resolution task.


the average numbers of anaphoric mentions and relations are higher in the test set than in the training set. in creating the training set, we did not filter citations based on the presence of anaphoric expressions . we did, however, perform this filtering step in the test set, which led to a higher proportion of citations with anaphora relations .

it is noteworthy that there are about  <dig> % more anaphora relations than anaphoric mentions, providing further evidence regarding the prevalence of set-membership relations in biomedical corpora  <cit> . the set-membership relations involved up to  <dig> members. the distribution of member counts for set-membership relations is given in table  <dig>  the average number of antecedents for an anaphor indicating set-membership anaphora is  <dig> .


it should also be noted that more than one span annotation was created per citation , which indicates that the antecedents often involve entities that do not map to umls concepts in a straightforward manner . we also found that approximately  <dig> % of all anaphora relations were inter-sentential, showing that coreference resolution is highly important for discourse-level text understanding.

anaphora resolution
the evaluation results of anaphora relations are given in table  <dig>  the baseline method, perhaps unsurprisingly, performs poorly. it yields better precision than recall, indicating that while simple head word match is a simple and useful criterion for detecting anaphora, it needs to be augmented with other semantic constraints for reasonable performance. anaphora resolution in semrep provides a 4-fold increase in f <dig> score compared to the baseline method. interestingly, while semrep favors precision over recall in relation extraction, precision and recall figures for the anaphora resolution algorithm are relatively close.


to measure the effect of various anaphora resolution components on the overall performance, we also performed an ablation study in which we removed these components and recalculated evaluation metrics. the results of this study are provided in table  <dig> 


the anaphoricity filter improved performance significantly , in contrast to previous studies in which such filtering often resulted in poorer results  <cit> . among the semantic compatibility measures, the taxonomy constraint had the greatest impact on performance . the effects of the headword and shared headword constraints were much smaller . the number agreement yielded a noticeable, positive improvement . these results show that a strong semantic constraint coupled with number agreement can successfully identify antecedent candidates. the effect of removing the set-membership recognition component was close to that of removing the taxonomy constraint, lowering the f <dig> score to half, another indication of the importance of set-membership anaphora in biomedical literature.

comparing intra-sentential to inter-sentential resolution results revealed the interesting phenomenon that the system, perhaps counter-intuitively, performs better on anaphora relations crossing sentence boundaries . analyzing the results, we noted that the majority of intra-sentential antecedents are in structures of coordination, and that the lower performance of the system on sentence-bound anaphora relations can be partly attributed to the difficulty of resolving coordination.


our evaluation on sortal anaphora relations in the development portion of the bionlp protein coreference dataset yielded the results given in table  <dig>  this dataset incorporates both sortal and pronominal anaphora relations, and not all studies conducted on this dataset have reported sortal anaphora resolution performance separately. among those that did, the best results were reported by d’souza and ng  <cit> , who also reported the best overall performance. on this dataset, our methodology performs slightly better than theirs with respect to f <dig> score, with higher recall than theirs at the expense of lower precision. our low precision is mostly due to the fact that we did not provide gold protein entities as input to the system and did not limit ourselves to resolution of protein/gene-related anaphora only. it is reasonable to assume that we could increase precision on this dataset by adding a few, simple post-processing rules.


effect on semantic interpretation
processing  <dig> sentences from medline with semrep with and without the anaphora resolution option, we found that there was an increase of approximately  <dig> % in the number of predications solely due to anaphora resolution . the increase may seem minor; however, this number does not fully capture the effect of anaphora resolution. we found that  <dig> predications remained unchanged with and without anaphora resolution, indicating that  <dig>  % of the predications generated without anaphora resolution  were changed to some extent with anaphora resolution. we analyzed the changes with respect to these  <dig> predications to assess whether they were positive changes or not. the results, shown in table  <dig>  indicate that the effect of sortal anaphora resolution is positive overall; half of the changes  involve uninformative predications being replaced by more specific and informative ones .


in  <dig> % of the cases, anaphora resolution may have generated a correct relation; however, this did not lead to improvement because the original predication was a precision error in the first place . consider the example below: 
  the cyst fluids were shown to be a rich source for acidic glycoproteins. the study of these proteins can potentially lead to the identification of more effective biomarkers for ovarian cancer.

 ∗proteins-predisposes-ovarian carcinoma1

 glycoproteins-predisposes-ovarian carcinoma





although the anaphora relation between these proteins and acidic glycoproteins is captured correctly by the algorithm, the resulting predication in example  is a precision error, because the original predication that it is based on ) is incorrect, due to misidentification of the subject as proteins, instead of the correct subject biomarkers.

negative changes constitute  <dig>  % of the changes . an example of such a negative change is given below: 
  nash is a distinct entity from nafld, and is characterized by the presence of inflammation with hepatocytes damage, with or without fibrosis. while several therapeutic strategies have been proposed to improve this condition, the present review aims to discuss nonmedicinal interventions used to reduce liver involvement or to preventthe disease altogether.

 interventions-prevents-disease

 ∗interventions-prevents-inflammation





without anaphora resolution, semrep generates the predication in example , which, while correct, is uninformative, and therefore, considered partially correct. because the acronym nash cannot be resolved to nonalcoholic steatohepatitis, anaphora resolution algorithm does not recognize it as an antecedent candidate, identifying inflammation instead as the antecedent for the anaphora the disease. this leads to the incorrect predication in example .

our analysis also revealed that set-membership anaphora relations can amplify both the positive and negative impact of anaphora resolution on semantic interpretation. example  illustrates the amplification of positive impact, in which one uninformative predication is replaced with three informative ones thanks to a single anaphora relation. example  shows an instance where the effect is negative, with one partially correct  predication being replaced by four incorrect ones, due to misidentification of antecedents. the antecedent for the anaphor the genes was found to be bad, bid, fas, and tnf, instead of api <dig>  aifm <dig>  and nfkappab <dig>  however, note that the negative effect could have been even more pronounced if the terms coordinated with bad, bid, fas, and tnf  satisfied the semantic consonance constraints, which would lead to two additional precision errors. 
  meanwhile, three genes  showed changes of expression in the hippocampus of ts65dn mice compared with normal mice…however, some well-known genes related to cell apoptosis, such as the caspase family, bcl- <dig>  bad, bid, fas, and tnf, did not show changes in expression levels. the genes we found which were differentially expressed in the hippocampus of ts65dn mice may be closely related to cell apoptosis.

 genes-part_of-entire hippocampus

 ∗bad gene-part_of-entire hippocampus

∗tnf gene-part_of-entire hippocampus

∗fas gene-part_of-entire hippocampus

∗bid gene-part_of-entire hippocampus





finally, we compared overall semrep performance with and without anaphora resolution. in previous work, we developed a reference standard dataset for semrep benchmarking  <cit> ; however, predications were annotated at the sentence level, ignoring anaphora completely. therefore, it is not suitable for assessing overall semrep performance in the context of the current study. instead, we performed a post hoc evaluation of predications generated by semrep with and without anaphora resolution on  <dig> sentences, calculating precision only. calculating recall, and by the same token f <dig> score, would require a non-trivial, labor-intensive annotation study, especially considering that it would have to involve document-level conceptual annotation. precision calculation is complicated by partially correct predications that we referred to earlier. if they are considered true positives, the impact of anaphora resolution may not be evident at all. on the other hand, if they are considered false positives, the impact of anaphora resolution may be overestimated. considering this complexity, we report precision in two ways: a) excluding partially correct predications from calculation, b) awarding them  <dig>  points. the results, given in table  <dig>  clearly show the positive impact of anaphora resolution on the precision of semrep predications; in both calculations, precision is improved . given that anaphora resolution is mainly a recall improvement strategy for relation extraction, this indicates that overall f <dig> score is improved, as well.

partially correct predications ignored

partially correct predications awarded  <dig>  points


effect of sortal anaphora resolution at pubmed scale
the final evaluation concerned the effect of anaphora resolution on semrep results at pubmed scale. to assess this effect, we considered anaphora relations and predications extracted from a randomly selected set of  <dig> million abstracts . we found that our algorithm extracted a total of  <dig>  anaphora relations from this set of abstracts, indicating an average of about  <dig>  anaphora relation per abstract. we also found that the number of predications increased from  <dig> , <dig> to  <dig> , <dig> including duplicates, an increase of approximately  <dig>  %. this is about one-tenth of the increase in the set of  <dig> medline sentences we discussed above. however, this comparatively small increase is not surprising; for that set, we specifically analyzed sentences in which anaphora resolution led to changes in semantic interpretation. extrapolating from the increase in the overall number of predications due to anaphora resolution in that smaller set versus the larger  <dig> million abstract set  and the ratio of predications affected by anaphora resolution on that smaller set , we can estimate that anaphora resolution triggers a change in about  <dig>  % of the predications in the larger set of  <dig> million abstracts. considering that our pubmed scale database of semantic predications, semmeddb  <cit> , contains more than  <dig> million predications in its latest release , these seemingly small increases are still likely to constitute a significant enhancement in the amount of knowledge mined from the literature and the specificity of that knowledge. finally, we analyzed the proportional change in the number of predicate types. we found that  <dig> % of the predicate types had an increased number of relations after anaphora resolution. using paired sample t-test, we found that changes in the number of predications per predicate type were statistically significant . the rates of change for the top  <dig> most common predicate types are provided in table  <dig>  the largest increase involved predicates concerning molecular level relations, such as gene-gene and gene-drug relations. the highest increase was in stimulates and inhibits relations  followed by associated_with , a gene-disease relation. on the other hand, several minor clinical relations exhibited fewer relations . this finding illustrates the prevalence of anaphora relations in molecular biology literature and highlights the importance of resolving them for biological curation tasks.


error analysis
we analyzed the errors made by the anaphora resolution component of semrep, categorizing them by the underlying cause of the error. the distribution of error types is illustrated in fig.  <dig>  note that an error can be due to multiple causes; therefore, the total number of errors in fig.  <dig> exceeds the total number of actual precision/recall error instances.
fig.  <dig> distribution of error types. distribution of precision and recall errors



three major error types were caused by coordination processing, anaphoricity filtering and semantic consonance measures. while coordination processing errors predominantly led to recall errors , precision vs. recall errors due to anaphoricity filtering and semantic constraints were more evenly distributed . among the less prevalent error types, number constraint errors were almost exclusively recall errors , while salience rules and umls mappings caused a higher number of precision errors .

anaphoricity filtering errors constituted  <dig> % of all errors. some of these errors had to do with misidentification of rigid designators, leading the system to ignore legitimate anaphors. in the following example, the underlined phrase was not considered an anaphor, since its modifier pah is taken as a rigid designator, because it is mapped to a umls metathesaurus concept. 
 therefore, data that support the long-term therapeutic benefits of these long-termpah therapies are limited and derived primarily from uncontrolled, observational studies …



we also found precision errors due to the shortcomings of the anaphoricity filter. in the following example, the appositive construction between sildenafil and the first phosphodiesterase inhibitor was not recognized. the algorithm, therefore, considered the latter a sortal anaphor and linked it to the phrase revatio. 
 this paper …provides an overview of clinically available phosphodiesterase inhibitors and discusses tadalafil in relationship to sildenafil ), thefirst phosphodiesterase inhibitor approved for pah.



as discussed above, removing the anaphoricity filter lowered the f <dig> score by  <dig> %, lowering precision while increasing recall, showing that its overall effect was positive, although a more nuanced constraint could further improve results.

despite the fact that coordination processing benefitted anaphora resolution significantly by addressing set-membership anaphora, as shown in table  <dig>  still a significant number of errors were caused by issues in coordination processing . in the following example, the serial coordination between oxidative stress, inflammation, and impaired nrf <dig> activation was not identified by semrep’s coordination processing, because impaired nrf <dig> activation was not mapped to a umls concept in the disorder semantic group. this led the algorithm to miss three anaphora relations, between these abnormalities and the underlined coordinate noun phrases. 
 …progressive focal glomerulosclerosis in the imai rats is associated with oxidative stress, inflammation, and impaired nrf <dig> activation. these abnormalities are accompanied by activation of …



in addition to recall errors such as the aforementioned, coordination processing may also trigger precision errors. in the example that follows, insulin glargine was erroneously found to be coordinated with nateglinide and acarbose, which led to three anaphora relations, instead of two correct relations identified by the system . this error could also be prevented by stipulating that an anaphor involving the determiner both can only have two antecedents. the incremental nature of semrep allows implementing such a rule easily. 
 after fasting glucose was optimized by insulin glargine, nateglinide or acarbose was initiated and then crossed over after second wash out period. …both drugs …



coordination resolution in semrep is particularly poor in identifying serial coordination; enhancements made in processing this linguistic phenomenon can have a positive effect on anaphora resolution as well. however, coordination processing is likely to remain one of the main challenges with anaphora resolution, since coordinate constructions can get very complex in biomedical text. in the example below, seven anaphora relations were missed, since the appropriate coordination structure cannot be recognized due to the intervening percentage values. 
 the percentage of patients discontinued treatment within  <dig> months was  <dig>  % for chlorpromazine,  <dig>  % for sulpiride,  <dig>  % for clozapine,  <dig>  % for risperidone,  <dig>  % for olanzapine,  <dig>  % for quetiapine, and  <dig>  % for aripiprazole, a nonsignificant difference ; there were no significant differences among these seven treatments on discontinuation due to relapse, …



errors due to one of the semantic consonance measures led to  <dig> % of all errors. in the following example, the anaphor the chemotherapy regimen and the antecedent adjuvant chemotherapy are not found to be semantically consonant, since there is no taxonomic relation between the corresponding concepts in the umls, and their headwords do not match. 
 from january  <dig> to march  <dig>   <dig> patients were randomized to adjuvant chemotherapy  or surgery alone . all patients underwent gastrectomy with d <dig> or greater lymph node dissection. the chemotherapy regimenconsisted …



on the other hand, lack of a full umls mapping for impaired nrf <dig> activation in example  above led to an error in coordination processing, which also relies on such information, and it resulted in a negative effect on anaphora resolution.

number agreement caused some anaphor-antecedent linking errors, although not many . in the following example, the anaphor the drug and the antecedent neuroleptics do not agree in number, leading to a recall error. 
 stereotypies and orobuccolingual dyskinesias are the most frequently observed tardive disorders, particularly in the elderly population exposed to neuroleptics, …. the development of these disorders is dependent on the potency of the drug, duration of exposure, and …



shortcomings of the salience-based best antecedent selection also triggered anaphor-antecedent linking errors . consider the example below: 
 we report a case of pulmonary infection caused by a rare nocardia species, nocardia beijingensis, in a 48-year-old man who received multiple immunosuppressive therapy after renal transplantation. this pathogen was isolated from a bronchoscopic protected specimen brush ….



in this example, the salience-based selection prefers nocardia species over nocardia beijingensis as antecedent because it is the leftmost compatible antecedent candidate in the sentence. this leads to both a precision and a recall error.

a small number of precision errors  were due to exemplification instances, which annotators were instructed not to annotate. in the following example, the antecedent for the anaphor these drugs was annotated as ion channel modulators. the algorithm, on the other hand, identifies pregabalin, gabapentin, and carbamazepine as the antecedents, leading to three precision errors. 
 among the substances which are commonly used are ion channel modulators . the aim of this study was to investigate the use of these drugs in clinical practice in a larger patient cohort.



these errors can be considered soft errors, since the extracted anaphora relations can still be useful for the downstream relation generation step.

CONCLUSIONS
we presented a general, linguistically-oriented methodology that relies heavily on umls semantic knowledge to recognize sortal anaphora relations in biomedical literature. in contrast to previous studies on this topic, we did not focus on specific entity types. our semantic approach resulted in a 4-fold increase in f <dig> score over the baseline. the methodology has been incorporated into a general biomedical semantic relation extraction tool, semrep, and we showed that its overall effect on relation extraction is positive. since semrep supports a literature-based biomedical knowledge management tool, semantic medline  <cit> , and a pubmed-scale repository of semantic relations, semmeddb  <cit> , which in turn support tasks such as literature-based discovery  <cit>  and question answering  <cit> , we believe that enhancing semrep with anaphora resolution will benefit such downstream applications. while our study focused on medline citations, the methodology makes few assumptions regarding the type of input text. therefore, we believe it would be largely applicable to full-text articles, although discourse-based constraints  would probably need to be taken into account. with relatively short length of medline citations, such constraints were not needed. anaphora resolution is made available as an option in the web-based semrep tool <dig>  the annotated corpus used for training and evaluation is publicly available at http://skr <dig> nlm.nih.gov/sortalanaphora. a umls license is required.

while the overall effect of anaphora resolution is positive and renders more informative predications, the evaluation and error analysis revealed areas for potential improvement. these include a more nuanced approach to salience-based best antecedent selection for intra-sentential anaphora relations, an improved method to detect rigid designators, and an improved coordination processing, which would enhance not only anaphora resolution but also the core semantic interpretation capability of semrep. future work also involves pronominal anaphora resolution, which we have not attempted in this study due to its relative sparsity in biomedical literature.

endnotes
 <dig> the asterisk  indicates an incorrect predication.

2http://ii.nlm.nih.gov/interactive/uts_required/semrep.shtml

additional file
additional file  <dig> sortal anaphora annotation guidelines. the sortal anaphora annotation guidelines provided to the annotators and refined/expanded in several iterations. 



competing interests

the authors declare that they have no competing interests.

authors’ contributions

hk conceived of the study, participated in algorithm development, performed the analyses, programming, and evaluation, and drafted the manuscript. gr performed data analysis and annotation, participated in the algorithm development and evaluation design, and helped draft the manuscript. mf participated in the annotation study. tcr participated in the design of the study, participated in the algorithm development, and helped draft the manuscript. all authors read and approved the final manuscript.

