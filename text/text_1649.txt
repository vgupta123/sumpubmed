BACKGROUND
the superfamily of mdr proteins is formed by quinone reductases, leukotriene b <dig> dehydrogenases, polyol dehydrogenases, zn2+ dependent adhs , and many more families. a recent estimate places the total number of mdr families close to  <dig>  with less than 30% sequence identity between the families  <cit> . numbers of known superfamily members have grown considerably in recent years, and it currently has over  <dig> members in the uniprotkb database  <cit> , which is more than an order of magnitude higher than the number six years ago  <cit> . disregarding species variants, there is considerable multiplicity, with at least  <dig> mdr forms in the human, excluding close homologues. roughly half of the mdr proteins can be grouped into large clusters with 100's of members, while about  <dig> forms belong to small clusters with  <dig> or fewer members each. thus, the mdr family is now showing a spread resembling the complexity of the sdr  family  <cit> . this is a new characteristic of the mdr family, not detectable until now when data from many large-scale genome projects exist.

the first characterised member was the class i type of mammalian alcohol dehydrogenase, for which the primary structure was reported in  <dig>  <cit> . subsequently detected mdr members included sorbitol dehydrogenase  <cit> , a crystallin, metabolic enzymes and a synaptic protein  <cit> . the latter report also coined the term mdr  <cit> . this distinction from sdr, with its typically smaller subunits  and no metal dependence, was known  <cit> , but initially named as a long-chain form. the split into separate protein types was detected already in the 1970's when the first data on drosophila adh showed sequence patterns separate from those of the zn2+ dependent adhs  <cit> .

the mdr proteins typically consist of two domains, where the c-terminal domain is coenzyme-binding with the ubiquitous rossmann fold  <cit>  of an often six-stranded parallel β-sheet sandwiched between α-helices on each side. the n-terminal domain is substrate binding with a core of antiparallel β-strands and surface-positioned α-helices, showing distant homology with the groes structure  <cit> . the domains are separated by a cleft containing a deep pocket which accommodates the active site. the mdr proteins generally form homodimers, but some members are active as monomers like the mtd family  <cit> , or tetramers like the pdh family. the metal dependence also varies between families. while many mdr families bind one catalytic and one structural zn2+ per subunit  <cit> , many sorbitol dehydrogenases in the pdh family bind only the catalytic zn2+  <cit>  , and the prostaglandin reductases in the ptgr family bind no zn2+  <cit> .

in a recent review  <cit>  we showed that the size and complexity of the mdr superfamily challenges traditional means of subclassification such as linear sequence pattern matching, but we were able to present models for automated classification of a number of the mdr families.

hidden markov models  are statistical descriptions of the characteristic sequence variations within a protein family, and have been put to good use in protein classification since over a decade  <cit> . an alignment between a sequence and an hmm gives a statistical measure of the quality of the match, which can be used to reliably determine whether or not the sequence is a member of the modelled family. collections of hmms such as the pfama and interpro databases  <cit>  therefore greatly facilitate the annotation of new sequences. large families can also be subclassified using hmms, which was recently demonstrated for the sdr superfamily of short-chain dehydrogenases/reductases  <cit> .

hmms are products of machine learning and the quality of the training data is therefore crucial for the reliability of resulting models. high quality training data should well describe the diversity within the family, without overgeneralisation that would result in overprediction. assembling good quality training data usually requires hands-on work by experts in the field and has therefore been the rate limiting step for expanding the number of available protein family models. these principles also apply when hmms are used for subclassification.

so far, there are hmms available for detecting membership of the mdr superfamily, but no hmms are available for the individual families. in this work, we present a method for automated hmm refinement that produces stable and reliable hmms. we have used this method to produce hmms for  <dig> distinct mdr families and  <dig> of their subfamilies. we have also characterised these families based on conservation, nad and zn2+ cofactor preference, and species distribution.

RESULTS
mdr families
hidden markov models  were developed for protein families within the superfamily of mdr. this is necessary since the mdr superfamily now is found to be very large and divergent with over  <dig> members and many different enzyme activities. in pfam  <cit> , there are only two mdr-hmms available - one for the n-terminal domain  and one for the c-terminal domain . the aim was that each hmm now developed should be specific for each mdr family. therefore a method was developed to automatically derive stable hmms using an iterative procedure.

here, initial hmms were built from multiple sequence alignments  of disjoint mdr sequence clusters sharing more than 40% residue identities in pairwise comparisons. these hmms were used to search the uniprotkb database finding additional members, which were then incorporated into their respective training sets to produce refined hmms. after multiple iterations, typically below  <dig>  the refined hmms no longer detected any new members in the database. the stability of the model was assessed using jackknifing , and any unstable hmms were again subjected to iterative refinement once the spurious sequence had been removed. after  <dig> reiterations, all except  <dig> hmms were deemed stable and reliable .

using this iterative procedure, a total of  <dig> hmms were developed, which are listed in table  <dig>  we assigned identifiers to these mdr families from mdr <dig> through mdr <dig> based on enumeration by decreasing family size as found in the present investigation, starting with families having at least one human representative and then families having at least one eukaryotic representative, and ending with the purely prokaryotic families. these hmms encompass a total of  <dig> members, thus representing just over 76% of all mdr superfamily members. the remaining members form families with too few members to establish hmms with sufficiently strong predictive power. the  <dig> hmms now presented will be helpful in assignment of functions for mdr members for which the enzymatic function is not known, and they will also help to increase the level of granularity attainable in reliable automatic functional assignment of new sequences. this is of course crucial for understanding relationships in new collected sequence data.

this table shows properties of the mdr families for which we have derived hmms, including its assigned name , size, number of members in the swiss-prot database, average percent pairwise sequence identities in the family  and distribution of members over the kingdoms of life . see also additional file 2: mdr-properties for further data. empty name fields indicate families where the function has not yet been established for any of the members.

as can be seen in figure  <dig>  the number of members varies from  <dig> to  <dig> among these hmms, with an average number around  <dig> sequences. the average sequence identity within the individual families varies from  <dig> % to  <dig> %, with an average-of-averages of 61% and a sample standard deviation of  <dig>  percent units. the largest mdr family is that of adh  with presently well over  <dig> members. among the top  <dig> in size we also find ptgr , fas , cad , qor , qorx , yhdh , fdh , tdh  and pdh . numerical details on the individual mdr families are available in table  <dig>  showing also the kingdom representation for the families. further details on conservation and cofactor preference are available in additional file 1: mdr-properties. the hmm database is available as additional file 2: mdr-pfam and the accompanying sequence data is available in additional file 3: mdr-sequences. coloured msas for the families are shown in additional file 4: mdr-figures.

dendrogram
in order to investigate the interrelations between these families we built a bootstrapped clustalw neighbour-joining dendrogram of representative sequences . the families are approximately equidistantly positioned in the tree and the bootstrap values  are consistently low. the topology of the mdr family tree is thus similar to that of its sister protein superfamily, sdr. however we do see some trends in the groupings, as families that bind nad and two zn2+ are generally found in the upper half of the dendrogram  and those that bind nadp and no zn2+ are generally found in the lower half of the dendrogram .

some families with similar function tend to cluster consistently in the dendrogram . for example, sdh  is found together with ypdh  in  <dig> out of  <dig> bootstrap reconstructions of the dendrogram. similarly, with a bootstrap value of  <dig> bdh <dig>  clusters with its bacterial sibling family bpdh , and in all bootstrap reconstructions of the dendrogram the prokaryotic crotonyl coa reductases in ccr and ccr <dig> cluster .

furthermore, a few families that were previously treated as a single family  <cit>  are now represented by two or more hmms, that cluster together in a significant number of bootstrap reconstructions. for example the tetrameric adhs of mdr <dig> , mdr <dig>  and mdr <dig>  are found together in  <dig> cases, and were indeed previously described as a single evolutionary group under the name tadh. also, the mitochondrial trans-2-enoyl-coa reductases of mdr <dig> and mdr <dig>  are found together in  <dig> cases.

lastly, mdr <dig> and mdr <dig> cluster together in all bootstraps reconstructions of the tree. however, not much is known about these families. they share internal pairwise sequence identities of over 50%, have eukaryotic and prokaryotic members, and apparently bind two zn2+ ions.

correlation with known families
in a recent mdr review  <cit> , we highlighted  <dig> families of interest, based on family size or presence of a human member sequence. that selection of families was manual, as was the refinement of their derived hmms. using the current more systematic approach to subclassification we see that almost all of the families highlighted in the review still have well-correlating counterparts, the exceptions being the smallest families doiad, qorl and rt4i . presumably, there is still not enough data available on these families for meeting the minimum size requirement employed in this study. notably, the cad, tad and mecr families were now represented by two or more hmms . as a check for consistency, we therefore also produced merged hmms for these families. all of these produced non-overlapping hmms that became stable in the first or second iteration, demonstrating our algorithm's capability of finding evolutionary supersets for coherent and related subsets. conversely, the mcas and acr families are now incorporated into a single, much larger hmm. this may be desirable from a functional perspective since both mcas and acr have functions related to fatty acid synthesis. knowledge on these families have now grown to roughly twice that at the time of our review, with the exception of doiad, qorl, rt4i , and qor .

mdr families by name used in  <cit> . the cad, tadh and mecr families are now represented by two or three hmms, and the mcas and acr families are now incorporated into a single, much larger hmm. the doiad, qorl and rt4i <dig> families are not included in this study, because the amount of data available on these families is insufficient to satisfy the minimum inclusion size employed here.

zn2+ content
the mdr members have  <dig>   <dig> or  <dig> zn2+ ions per subunit. one zn2+ ion is located at the catalytic site and is designated catalytic zn2+, while one zn2+ ion is stabilising a loop encompassing residues 94- <dig>  and is designated structural zn2+. of the  <dig> mdr families now characterised, we find that  <dig> of the mdr families seemingly have  <dig> zn2+, i.e. both the catalytic and structural zn2+,  <dig> mdr families have  <dig> zn2+, while  <dig> mdr families seem to have no zn2+. among bacteria, over half  are mdr forms without zn2+, while among eukaryota, 66% of the mdr forms have  <dig> zn2+. this finding indicates that the zn2+ have been recruited early but not initially upon the mdr superfamily formation.

the numbers show number of mdr forms with no zn2+ and with  <dig> zn2+ in each kingdom.

six mdr families  consist of members where some have  <dig> zn2+ while other members only have  <dig> zn2+, where typically one or more of the ligands for the structural zn2+ have been lost. this variable zn2+ content within the same mdr family has not been described before. furthermore, in two mdr families  the members seem to retain the structural zn2+ but not the catalytic zn2+, which is clearly different from the typical pattern within the mdr superfamily. this also applies to part of the family mdr <dig> .

coenzyme preference
we have also looked at the coenzyme specificity as judged from available data or the presence of nad- or nadp-specific ligands. a total of  <dig> families use nad as cofactor, while  <dig> families use nadp. in nearly all families the coenzyme preference seems to be constant for all members, but in one family  half of the members bind nad , while the other half prefers nadp.

correlation between zn2+ content and coenzyme preference
with many mdr families now characterised, we can distinguish novel patterns. there is a clear correlation between zn2+ content and coenzyme preference. most of the mdr families with  <dig> zn2+ prefer nad as cofactor and are thereby generally acting as dehydrogenases. of the  <dig> families with  <dig> zn2+,  <dig> exhibit preference for nad. similarly, there is a correlation between no zn2+ content and utilisation of nadp as cofactor. of the  <dig> families with no zn2+,  <dig> exhibit preference for nadp and are consequently largely reductases.

as exceptions from these general patterns we find four families, yjgb , badh <dig> , mdr <dig>  and mdr <dig> of yeast and bacterial alcohol dehydrogenases, which all appear to bind nadp despite having both the structural and catalytic zn2+ cofactor. further exceptions are the four families mdr <dig>  ycjq , bchc of the bacterial chlorophyll synthesis pathway , and mdr <dig>  which appear to prefer nad despite lacking the structural and catalytic zn2+ cofactors.

species distribution
as shown in figure  <dig>  nearly 50% of the families are purely bacterial, while only 14% are purely eukaryotic. none is purely archaeal, but 17% of the families are represented in archaea. 10% of the families have representatives from all kingdoms of life. figure  <dig> shows more details on the species distributions in the families . still, most families are dominated by prokaryotic species, although there are some families with only plant sequences, and some with sequences from other eukaryotes, for example mdr <dig>  that consists of  <dig> sequences exclusively from the invertebrate dictyostelium discoideum. the seed sequences for this hmm have  <dig> % average identity.

conserved charge differences
several mdr families are found to have a large number of strictly conserved charged residues causing a large net charge, which might indicate special binding properties or interaction with strongly charged substrates. the burkdh  has a conserved net charge of - <dig>  while the yjdl  and mdr <dig> both have a conserved net charge of - <dig>  furthermore, bdh , mycdh  and mdr <dig> also have a conserved net charge of - <dig> . when including non-conserved charges, the numbers become even more pronounced for the first five families  while only mdr <dig> has balancing non-conserved charges . all these six families can be expected to have a positively charged substrate or interact with a positively charged protein.

mdr <dig> is the only family found to have a large positive conserved net charge . however these charges are partially balanced by non-conserved positive charges, leaving an average net charge of + <dig> . this family could consequently be expected to interact with negatively charged substrates or proteins.

differences in conservation between the catalytic and coenzyme-binding domains
looking at the number of conserved residues in the two domains, measured as those attaining a cscore over 95% , we find that some mdr families show noticeable differences between the two domains. a total of  <dig> mdr families were found with more than twice as many conserved residues in one domain compared to the other. there are  <dig> mdr families with twice as many conserved residues in the catalytic domain as in the coenzyme-binding , of which the most extreme cases are sdh  with a ratio of  <dig> , and mdr <dig>  mdr <dig>  and mdr <dig>  all with a ratio of about  <dig> . there are  <dig> mdr families with twice as many conserved residues in the coenzyme-binding domain as in the catalytic one , of which the most extreme cases are vat <dig>  with  <dig>  times difference and mdr <dig> with  <dig>  times difference. these differences might reflect differences in functional and/or structural properties.

this table shows the number of strictly conserved positions in the catalytic and coenzyme binding domains, respectively. furthermore, the ratio between these numbers is calculated. the table only lists families with a ratio of  <dig> or more and of  <dig>  or less.

selected mdr families
the largest families and those with known functional data of specific interest are described below.

the  <dig> largest families
notably, all of the  <dig> largest mdr families have a high degree of conservation in just one of the two domains .

 <dig>  mdr <dig> - adh this family contains the classical alcohol dehydrogenases, including human class i-v alcohol dehydrogenase. knowledge of this family has grown from  <dig> members to  <dig> since our last review. it is currently the largest mdr family, and  <dig> of its members are found in the swiss-prot database. 59% of the members are eukaryotic and the average amount of pairwise sequence identities is high but variable . the members of this family have both the structural and catalytic zn2+, in agreement with their nad preference. the catalytic domain conservation is close to twice  that of the cofactor binding domain , indicating that the catalytic machinery is well-conserved through this enzyme family.

 <dig>  mdr <dig> - ptgr this family of nadp binding prostaglandin reductases was previously described as ltd and the number of known members has increased from  <dig> to  <dig>  with only  <dig> in the swiss-prot database. while the family contains human prostaglandin reductases  <dig> and  <dig>  just over 2/ <dig> of the members are prokaryotic, and its average pairwise sequence identity is only 42%. most likely, the prokaryotic members have other substrates since prostaglandins are only characterised in verterbrates. additionally, their conservation is much higher in the cofactor binding domain than in the catalytic domain , further supporting that the substrate spectrum might vary between the members. this family binds nadp and no zn2+, in agreement with the reductase function.

 <dig>  mdr <dig> - fas this family of multidomain fatty acid synthases was previously described in part as two separate subfamilies acr and mcas, but is now represented by a single hmm with  <dig> members instead of the previously found  <dig> and  <dig> members, respectively. members are prokaryotic to 59% and the average sequence identity is only 39%. also in this family conservation is much higher in the cofactor binding domain than in the catalytic domain . the mdr domains in these enzymes are annotated with enoyl reductase functionality  in swiss-prot. a reductase function would be in accordance with their apparent nadp-preference and lack of conserved zn2+ ligands.

 <dig>  mdr <dig> - cad this family with cinnamyl alcohol dhs, mannitol dhs and sinapyl dhs has both eukaryotic and prokaryotic sequences. it was previously classified together with members from mdr <dig> as one family  <cit> , but is now represented by two disjoint hmms, where the latter one is smaller and covers mostly uncharacterised bacterial sequences . mdr <dig> now has  <dig> known members, of which  <dig> can be found in the swiss-prot database. the catalytic domain is more well-conserved than the cofactor binding domain . the members of this family bind nad and two zn2+.

 <dig>  mdr <dig> - bpqor this family of mainly yeast and bacterial quinone oxidoreductases was previously described under the tentative name of bpdh . now however, as the number of known member sequences has grown from  <dig> to  <dig>  it also includes six sequences from neurospora, leishmania, trypanosoma and dictyostelium . still, only five of the sequences are currently in swiss-prot.

 <dig>  mdr <dig> - qorx this family encompasses putative quinone oxidoreductases from many species, including human quinone oxidoreductase pig <dig> , which is the only swiss-prot sequence among its  <dig> members. the rate of conservation is over twice as high in the catalytic domain as in the cofactor binding domain. substrate specificity is still unknown. the pig <dig> is strongly expressed in neuronal cells of cerebral cortex and in respiratory epithelial cells of nasopharynx  <cit> .

 <dig>  mdr <dig> - yhdh this family was previously described as a bacterial family under the name yhdh. it has since grown from  <dig> to  <dig> members, including a single eukaryotic sequence from the tunicate oikopleura dioica .

 <dig>  mdr <dig> - fdh this family contains  <dig> members including s-glutathione dehydrogenase from methylobacter marinus.  <dig> of its members are from the swiss-prot database. it has an average pairwise sequence identity around 47%, and much of the conservation is seen in the catalytic domain, which has three times as many positions with cscores over 95% than does the cofactor binding domain .

 <dig>  mdr <dig> - tdh this family of threonine dehydrogenases has been previously reviewed, for example in  <cit> , and currently has  <dig> members. they have conserved ligands for both zn2+ cofactors, with the exception of  <dig> rhodobacteral and  <dig> other bacterial sequences that do not have the sequence motif that binds the structural zn2+.

 <dig>  mdr <dig> - pdh this family of sorbitol/xylitol dhs and d-xylulose reductases now has  <dig> members. most of them bind  <dig> zn2+. however, in  <dig> of its members the structural zn2+ binding loop is seemingly retained, although the zn2+ ligands themselves are not conserved. notably, although this family contains both dehydrogenases and reductases, structural zn2+ ligand retention is not correlated with enzymatic function. for example, the structural zn2+ ligands are present in sorbitol dh in fission yeast but not in baker's yeast, and nor are they present in the latter's d-xylulose reductase.

furthermore,  <dig> positions in the catalytic domain attain a cscore over 95%, which is  <dig>  times the number of such positions in the cofactor binding domain, indicating evolutionary constraints on the catalytic residues.

other families of interest mdr <dig> - vertqor - is a family dominated by quinone oxidoreductases and zeta-crystallins from vertebrates, where the single non-eukaryotic sequence is from the bacterium geobacter uraniireducens strain rf <dig>  it thus contains both enzymes and structural proteins of the lens, which are recruited to that function  <cit> . the family also includes one lancelet form from branchiostoma floridae  which was deleted in uniprotkb release  <dig>  since the corresponding gene was not present in the latest assembly of the genome. however, blast searches against the uniprotkb and ncbi nr  <cit>  databases reveal that the most similar known sequence is from platypus and shares only 60% identities with this deleted form. the most similar non-vertebrate form is from monosiga brevicollis  at 53% identities, and is superseded by  <dig> more similar vertebrate sequences. it is therefore possible that this deleted lancelet form is not an artifact originating from a contaminating sequence, but may reappear in a later release of the branchiostoma floridae genome.

in the mdr <dig> family, eight yeast sequences of the  <dig> members seem to bind nadp instead of nad. four of these sequences are from species having two forms of this protein, of which one has nad-typical ligands and the other nadp-typical ones. the mdr <dig> family of adhs from eukaryotic parasites as well as thermophiles and other prokarya consists of two subgroups, one apparently using nadp as cofactor, the other nad. this difference does not appear to stem from species multiplicity, as all sequences from any single species exhibit the same cofactor binding motifs. a small subset of four sequences show intermediate properties.

the mdr <dig>  family contains tetrameric adhs from various yeasts, and also two forms from caenorhabditis elegans and one from caenorhabditis briggsae.

mdr <dig>  contains glutathione-independent formaldehyde dehydrogenases from bacteria and yeast. family mdr <dig>  has  <dig> members, all uncharacterised polyketide synthases from the slime mold dictyostelium discoideum. yet the average pairwise sequence identity within the family is merely  <dig> %. the mdr <dig> family consists of yeast -butanediol dehydrogenases. here,  <dig> of  <dig> members have a glutamate to glutamine substitution for the third catalytic zn2+ ligand, which is located in the first transdomain alpha helix. this substitution should preclude binding of the catalytic zn2+. however, the representative from saccharomyces cerevisiae  is annotated as having the catalytic zn2+, despite having only two ligands. however, all of these  <dig> sequences come from species that have two forms of this protein, and where the sibling sequences have an intact third ligand for the catalytic zn2+. furthermore, this family has an unusual insertion in the structural zn2+ loop, between the first and second zn2+ ligands. the length of this insertion seems to vary between members. also, as noted above, this family has a significant conserved net charge of - <dig>  or - <dig>  when including non-conserved charges , and could therefore be expected to have positively charged substrates or interaction partners.

in the mdr <dig> family of mainly bacterial starvation-sensing oxidoreductases,  <dig> out of  <dig> members have lost the ligands for the structural zn2+ cofactor through a deletion precisely at the binding motif in the zn2+ binding loop. the catalytic domain has a higher degree of conservation with  <dig> positions  attaining a cscore over 95%, which is  <dig>  times the number of such positions in the cofactor binding domain.

the members of the bacterial family mdr <dig> seem to have ligands for the structural zn2+ cofactor, but remarkably not for the catalytic zn2+ cofactor. the members also have a conserved proline-rich motif near the n-terminus, the most pronounced being ppppppgp at position  <dig> in a sequence from aurantimonas sp. si85-9a <dig> . also the bacterial family mdr <dig> presents the uncommon feature of having ligands for the structural but not the catalytic zn2+.

only  <dig> out of  <dig> members of the bbdh  family of bacterial  <dig> -butanediol dehydrogenases have ligands for the structural zn2+ cofactor. the remaining  <dig> still have a loop that is four residues shorter than its zn2+ binding counterpart. similarly, in the family mdr <dig>  only  <dig> out of  <dig> members have ligands for the structural zn2+ cofactor. the remaining  <dig> have seemingly lost the zn2+ binding motif though consecutive substitutions, as the degree of similarity to their zn2+ binding siblings is still high in all other positions in the loop.

the mdr <dig> family is unusual in that it appears to bind nadp despite having both the structural and catalytic zn2+ cofactor. the conservation is low in the c-terminal part of the catalytic domain, and the usually well-conserved positive charge near the terminus is absent. there is a highly positive conserved motif near the nad-binding vgv motif in 1pl <dig>  as represented by rkrgr in a ralstonia solanacearum sequence .

the family mdr <dig> has an unusual, poorly conserved region of variable length, close to the positive nadp ligand  <dig> residues c-terminally of the glycine-rich nadp binding motif . as an effect, the number of positions attaining cscores over 95% in the catalytic domain is threefold that of the cofactor binding domain, with only  <dig> such positions. furthermore, proteins of this family have a conserved net charge of - <dig>  and may thus have have positively charged substrates or interaction partners.

the algorithm
searching uniprotkb we find sequences for  <dig> mdr domain pairs in  <dig> proteins. clustering sequences with more than 40% pairwise identities leaves  <dig> clusters, where known families such as adh, pdh and ptgr are uniquely represented.  <dig> of these clusters consist of more than  <dig> sequences, and were used for protein family hmm generation, making a grand total of  <dig> sequences.

some proteins, mainly polyketide synthases and type i fatty acid synthases like  and  from cryptosporidium parvum, contained several mdr domain pairs that were sufficiently divergent to fall into separate clusters under the chosen clustering rule. no special regard was given to these clusters during hmm construction, refinement or inclusion control, however all of them eventually converged on  the same evolutionary group, namely mdr <dig> - fas.

after  <dig> reiterations all hmm refinements using inclusion control strategy ii were stable . after resolving overlaps we obtained stable hmms for  <dig> mdr families. the corresponding  <dig> seed sequences provide just over 76% coverage of the mdr superfamily . two out of these  <dig> stable hmms  retained too few sequences for continued refinement after the first inclusion control step . these hmms comprise a total of  <dig> seed sequences and are stable, and were thus still kept . past the first inclusion control step, it was possible to classify all remaining hmms as reliable in all of the strategies.

three different strategies for inclusion control were employed, affecting the number of resulting hmms as well as their composition and relations. roman numerals denote the different strategies, in increasing order of inclusiveness. parenthesised numbers show the number of hmms that were not affixed with the "reliable" qualifier, due to having too few non-spurious sequences in their seed sets. numbers in braces denote the number of families having such subsets.

in strategy i, all seed sequences failing the leave-one-out check were excluded. in strategy ii, only seed sequences with domain scores lower than noise level were excluded. additionally, for a left-out seed sequence to be excluded in strategy iii, its domain score must fall below 90% of the lowest domain score among the remaining seed sequences.

 <dig> of the refinement processes stabilised on distinct subgroups to  <dig> of these  <dig> families, and these were retained separately because of their potential utility for subclassification. it should however be noted that this work does not attempt to provide a comprehensive listing of all mdr subfamilies, but these  <dig> hmms are rather presented as a means to aid automated classification.

inclusion control and overlap resolution
in order to ensure consistency in our refined hmms we evaluated three different leave-one-out validation strategies for seed sequences . unsurprisingly, the most inclusive strategy  yielded the most numerous and largest overlaps between seed sets, while exactly the opposite was true for the most exclusive strategy . however, for strategy iii, the overlaps were generally trivially resolvable, most often simply by raising the inclusion threshold slightly for one of the participants, while for strategy i some overlaps were only resolvable through mergers and subsequent refinement reiterations. as an example; in strategy i, one cluster of  <dig> sequences was found to be a subset to mdr <dig>  with the exception of  <dig> sequences which were included late in the refinement process. a neighbour joining dendrogram of the smaller cluster showed that these sequences originated from separate subgroupings, and although it was possible to exclude them from the cluster by removing the  <dig> lowest scoring seed sequences, these  <dig> sequences would be re-included in the subsequent refinement step. conversely, merging the  <dig> sequences into the larger set yielded a hmm that became divergent in the subsequent refinement step. in the more inclusive strategies on the other hand, these clusters had a clear subset relation, lending further incentive to favour one of these strategies.

strategy iii ultimately proved to be the fastest, since it required the fewest reiterations of refinement and inclusion control before all hmms were stable. the apparent speed loss of the more inclusive strategies impacted by the time consuming database searches during inclusion control was more than compensated by the ease of overlap resolution and the lower number of refinement reiterations required for convergence. the intermediate strategy  was found to be an optimal compromise between i and iii, occupying the middle ground in these aspects; it is reasonably fast and offers the ease of overlap resolution of strategy iii. another clear advantage of strategy ii is that it does not rely on user input beyond initial hmm creation, but instead purely uses relations in data to produce the resulting models.

one concern during the development of the refinehmm algorithm was that inclusion of partial sequences into the seed sets could lead to attenuation of predictive power of the model, since this would introduce a biased delete state preference near the n- and c-termini of the model. to counteract this we attempted to introduce a minimum model coverage requirement for inclusion of new seed sequences, expressed as a percentage of the model length, and we evaluated the thresholds 90%, 85%, 80% and 0%. ultimately, the 0% coverage limit proved to be sufficient, as the hmm_ls hmm type itself provides sufficient penalisation of partial sequences to ensure that they will not increasingly dominate the refined seed sets.

computation time and parallelisation
since the individual refinement processes are independent, this algorithm for hmm refinement is trivially parallelisable. furthermore, the output files and the variant input files are small. the database files are the only large files needed by the algorithm, and as these are invariant, they can be cached on the compute resource. these traits make refinehmm well suited for burst computing on shared resources as well as distributed resources such as swegrid . indeed, all refinements and leave-one-out comparisons to uniprotkb were computed on swegrid resources using biogrid runtime environments   <cit> . internal leave-one-out comparisons were fast enough to compute locally, rather than distributed. the refinehmm algorithm uses version  <dig>  of hmmer, but is written so that a transition to hmmer  <dig>  will be straightforward once a stable release with glocal alignment capabilities is available. as the hmmer database search is by far the most time consuming step in the refinehmm algorithm, we estimate that transitioning will decrease the total computation time by at least an order of magnitude, and quite possibly even more.

validation
the hmms were built and refined against version  <dig>  of uniprotkb, and in order to evaluate the consistency of the annotation of the  <dig> families defined in this work, we investigated the annotation of all new mdr sequences in new releases of swiss-prot up to version  <dig> . we found  <dig> new matches against the pfama mdr hmms, out of which  <dig> were upgrades from uniprotkb/trembl sequences, and  <dig> were novel entries in swiss-prot. our models detected all of these new sequences  and none of these had annotations that conflicted with our previous observations on their respective families. out of the  <dig> sequences that were not detected,  <dig> were annotated as probable polyketide synthases of dictyostelium discoideum, and would perhaps have been expected to match mdr <dig> . the remaining two  had annotations relating the proteins to adh-like enzymes, but nothing more functionally specific. since our models professedly do not provide 100% coverage of the mdr superfamily, it should be expected that some new mdr sequences will not be classifiable through our current library of hmms. however as more sequence data on mdrs is amassed, further hmms may be developed using our algorithm, improving the library and its coverage of the mdr superfamily even further.

web site
in order to make our results directly useful also for scientists outside the bioinformatics area, we have developed a web site that presents our findings in an easily navigable point-and-click interface. the web site enables users to search and display detailed information about the mdr families, using textual and numeric queries against many of their characterised properties. it also permits online hmmpfam queries against our library of mdr hmms, making it possible to submit a novel mdr sequence and have it instantly analysed and classified. the web site also provides direct downloads for the underlying mdr hmm library as well as the web site database files, providing the opportunity for advanced users to do more advanced queries offline.

the web site is available at http://mdr-enzymes.org/.

CONCLUSIONS
we have developed an algorithm for hmm refinement that produces stable and reliable hmms. we have used this algorithm to subdivide a large and complex protein superfamily into smaller units of homologous members, yielding hmms for  <dig> mdr families and  <dig> distinct subsets to  <dig> of the families. these hmms are suitable for reliable automated classification of new sequence data. the generated families correlate well with the more empirically chosen family definitions that were employed in our recent review, lending further evidence to the reliability of the algorithm.

furthermore, 1/ <dig> of the mdr members have only few  close homologues, forming only small families, presently each with less than  <dig> members. thus, the mdr superfamily shows a complexity and spread as previously described for the sdr superfamily.

we analysed conservation in these  <dig> families as well as characterised their nad and zn2+ cofactor preference based on mappings to their closest available structures. it was found that mdr families with  <dig> zn2+ in general have nad preference, while those families with no zn2+ in general had preponderance for nadp.

we have also developed a web site http://mdr-enzymes.org where users can search and display detailed information on the families defined and characterised. it is also possible to scan putative new mdr sequences and have them instantly analysed and classified. these features make our findings directly available and useful also for non-bioinformaticians.

the implementation and support scripts for running the algorithm on computer clusters are available as open source software, and the database files underlying the web site are freely downloadable.

