BACKGROUND
since their first use nearly fifteen years ago  <cit> , microarray gene expression profiling experiments have become a ubiquitous tool in the study of disease. the vast number of gene transcripts assayed by modern microarrays  has driven forward our understanding of biological processes tremendously, elucidating the genes and regulatory mechanisms that drive specific phenotypes. however, the high-dimensional data produced in these experiments--often comprising many more variables than samples and subject to noise--also presents analytical challenges.

the analysis of gene expression data can be broadly grouped into two categories: the identification of differentially expressed genes  between two or more known conditions, and the unsupervised identification  of samples or genes that exhibit similar profiles across the data set. in the former case, each gene is tested individually for association with the phenotype of interest, adjusting at the end for the vast number of genes probed. pre-identified gene sets, such as those fulfilling a common biological function, may then be tested for an overabundance of differentially expressed genes ; this approach aids biological interpretability and improves the reproducibility of findings between microarray studies. in clustering, the hypothesis that functionally related genes and/or phenotypically similar samples will display correlated gene expression patterns motivates the search for groups of genes or samples with similar expression patterns. the most commonly used algorithms are hierarchical clustering  <cit> , k-means clustering  <cit>  and self organizing maps  <cit> ; a brief overview may be found in  <cit> . of these, k-means appears to perform the best  <cit> . relatedly, gene shaving  <cit>  searches for clusters of genes showing both high variation across the samples and correlation across the genes, and several biclustering algorithms  search for class-conditional clusters of correlated genes. these methods are simple, visually appealing, and have identified a number of co-regulated genes and phenotype classes.

while these approaches have been fruitful, they also have the potential to miss causative mechanisms that can be deleteriously affected in several ways  as well as those which are only deleteriously affected through a combination of particular alterations . it is well known that complex diseases, such as cancers, exhibit considerable molecular heterogeneity for these reasons  <cit> . as a result, individual genes may fail to reach significance, and lists of differentially expressed genes or gene signatures may have poor concordance across studies. additionally, pathway analyses that rely on single-gene association statistics  may fail to identify causative mechanisms. for the same reasons, clustering algorithms that rely on linearly-separable clusters  may fail to partition the samples in a manner that reflects the true underlying biology.

as an example of how causative genes can be missed in gene-centric analyses, consider a recent study in which gene expression profiles in the wagyu cattle are compared to those of the double-muscled piedmontese cattle  <cit> . the piedmontese cattle's muscular hypertrophy is attributable to a nonfunctional mutation of the myostatin gene , but because mstn itself is not differentially expressed between the two bovine models, its biological role cannot be inferred using traditional analyses of gene expression data. on the other hand,  <cit>  showed that the functional mstn variant was co-expressed with its regulatory target myl <dig> in wagyu cattle, whereas the nonfunctional variant in the piedmontese cattle did not exhibit co-expression with myl <dig>  the correct identification of this system, in the absence of differential expression at the gene level in mstn or myl <dig>  is crucial to understanding the molecular determinants of the double-muscled phenotype. this example serves to underscore the pressing need for analysis methods that can reveal systems-level differences in cases and controls even when the constituent genes do not exhibit differential expression.

as an alternative approach, we propose here an analysis technique that is designed to reveal relationships between samples based on multi-gene expression profiles without requiring that the genes be differentially expressed , and that has the power to reveal relationships between samples at various scales, permitting the identification of phenotypic subtypes. our approach adapts a new unsupervised machine-learning technique, the partition decoupling method   <cit> , to gene expression data. the pdm consists of two iterated components: a spectral clustering step, in which the correlations between samples in the high-dimensional feature space are used to partition samples into clusters, followed by a scrubbing step, in which a projection of the data onto the cluster centroids is removed so that the residuals may be clustered. as part of the spectral clustering procedure, a low-dimensional nonlinear embedding of the data is used; as we will show in the methods section, this both reduces the effect of noisy features and permits the partitioning of clusters with non-convex boundaries. the clustering and scrubbing steps are iterated until the residuals are indistinguishable from noise, as determined by comparison to a resampled null model. this procedure yields "layers" of clusters that articulate relationships between samples at progressively finer scales, and distinguishes the pdm from other clustering algorithms.

the pdm has a number of satisfying features. the use of spectral clustering allows identification of clusters that are not necessarily separable by linear surfaces, permitting the identification of complex relationships between samples. this means that clusters of samples can be identified even in situations where the genes do not exhibit differential expression, a trait that makes it particularly well-suited to examining gene expression profiles of complex diseases. the pdm employs a low-dimensional embedding of the feature space, reducing the effect of noise in microarray studies. because the data itself is used to determine both the optimal number of clusters and the optimal dimensionality in which the feature space is represented, the pdm provides an entirely unsupervised method for classification without relying upon heuristics. importantly, the use of a resampled null model to determine the optimal dimensionality and number of clusters prevents clustering when the geometric structure of the data is indistinguishable from chance. by scrubbing the data and repeating the clustering on the residuals, the pdm permits the resolution of relationships between samples at various scales; this is a particularly useful feature in the context of gene-expression analysis, as it permits the discovery of distinct sample subtypes. by applying the pdm to gene subsets defined by common pathways, we can use the pdm to identify gene subsets in which biologically meaningful topological structures exist, and infer that those pathways are related to the clinical characteristics of the samples . this pathway-based approach has the benefit of incorporating existing knowledge and being interpretable from a biological standpoint in a way that searching for sets of highly significant but mechanistically unrelated genes does not.

a number of other operationally similar, yet functionally distinct, methods have been considered in the literature. first, simple spectral clustering has been applied to gene expression data in  <cit> , with mixed success. the pdm improves upon this both through the use of the resampled null model to provide a data-driven  choice of the clustering parameters, and by its ability to articulate independent partitions of the data  where such structure is present. as we will show, these aspects make the pdm more powerful than standard spectral clustering, yielding improved accuracy as well as the potential to identify sample subtypes that are not already known.

another novel clustering method is proposed in  <cit> , where an adaptive distance norm is used that can be shown to identify clusters of different shapes. the algorithm iteratively assigns clusters and refines the distance metric scaling parameter in a cluster-conditional fashion based on each cluster's geometry. this approach is able to identify clusters of mixed sizes and shapes that cannot be discriminated using fixed euclidean or mahalanobis distance metrics, and thus is a considerable improvement over k-means clustering. however, the method as described in  <cit>  is computationally expensive and cannot identify non-convex clusters as spectral clustering, and hence the pdm, can.

alternatively, spacc  <cit>  uses the same type of non-linear embedding of the data as is used in the pdm, which permits the articulation of non-convex boundaries. in spacc  <cit> , a single dimension of this embedding is used to recursively partition the data into two clusters. the partitioning is carried out until each cluster is solely comprised of one class of samples, yielding a classification tree. in this way, spacc may also in some cases permit partitioning of known sample classes into subcategories. however, spacc differs from the pdm in two crucial ways. first, the pdm's use of a data-determined number of informative dimensions permits more accurate clusterings than those obtained from a single dimension in spacc. second, spacc is a semi-supervised algorithm that uses the known class labels to set a stopping threshold. because there is no comparison to a null model, as in the pdm, spacc will partition the data until the clusters are pure with respect to the class labels. this means that groups of samples with distinct molecular subtypes but identical class labels will remain unpartitioned  and that groups of samples with differing class labels but indistinguishable molecular characteristics will be artificially divided until the purity threshold is reached. by contrast, the clustering in the pdm does not impose assumptions about the number of classes or the relationship of the class labels to the clusters in the molecular data.

a fourth approach, qubic  <cit>  is a graph theoretic algorithm that identifies sets of genes with similar class-conditional coexpression patterns  by employing a network representation of the gene expression data and agglomeratively finding heavy subgraphs of co-expressed genes. in contrast to the unsupervised clustering of the pdm, qubic is a supervised method that is designed to find gene subsets with coexpression patterns that differ between pre-defined sample classes. in  <cit>  it is shown that qubic is able to identify functionally related gene subsets with greater accuracy than competing biclustering methods; still, qubic is only able to identify biclusters in which the genes show strict correlation or anticorrelation coexpression patterns, which means that gene sets with more complex coexpression dynamics cannot be identified.

the pdm is thus unique in a number of ways: not only is it able to partition clusters with nonlinear and nonconvex boundaries, it does so in an unsupervised manner  and in the context of comparison to a null distribution that both prevents clustering by chance and reduces the influence of noisy features. moreover, the pdm's iterated clustering and scrubbing steps permit the identification of independent  partitions in the data.

in this manuscript, we describe the pdm algorithm and demonstrate its application to several publicly-available gene-expression data sets. to illustrate the pdm's ability to articulate independent partitions of samples, we apply it to genome-wide expression data from a four phenotype, three exposure radiation response study  <cit> . the pdm partitions the samples by exposure and then by phenotype, yielding higher accuracy for predictions of radiation sensitivity than previously reported  <cit> . we also compare the pdm results to those obtained in a recent  <cit>  comparison of clustering techniques, demonstrating the pdm's ability to identify cancer subtypes from global patterns in the gene expression data. next, we apply the pdm using gene subsets defined by pathways rather than the global gene expression data, demonstrating how the pdm can be used to find biological mechanisms that relate to the phenotype of interest. we demonstrate pathway-pdm in both the radiation response data  <cit>  as well as a larger prostate cancer data set  <cit> . our results suggest that the pdm is a powerful tool for articulating relationships between samples and for identifying pathways containing multi-gene expression patterns that distinguish phenotypes.

RESULTS
the partition decoupling algorithm
the partition decoupling method  was first described in  <cit> . we summarize it here, and discuss its application to gene-expression data. the pdm consists of two iterated submethods: the first, spectral clustering, finds the dominant structures within the system, while the second "scrubbing" step removes this structure such that the next clustering iteration can distinguish finer-scale relationships within the residual data. the two steps are repeated until the residuals are indistinguishable from noise. by performing successive clustering steps, factors contributing to the partitioning of the data at different scales may be revealed.

spectral clustering
the first step, spectral clustering, serves to identify clusters of samples in high-dimensional gene-expression space. the motivation is simple: given a set of samples and a measure of pairwise similarity sij between each pair, we wish to partition data in such a way that the samples within one cluster are significantly more similar to each other than they are to the remainder of the samples. a summary of the spectral clustering algorithm is given in table  <dig> 

spectral clustering offers several advantages over traditional clustering algorithms such as those reviewed in  <cit> . most importantly, no constraint is placed on the geometry of the data, in contrast to the tree-like structure imposed by hierarchical clustering  <cit>  or the necessity of convexity of the clusters for detection via distance-based k-means clustering as used in  <cit> , and in self organizing maps  <cit> . spectral clustering also uses a low-dimensional embedding of the data, thus excluding the noisy, high-frequency components.

in spectral clustering, the data are represented as a complete graph in which nodes correspond to samples and edge weights sij correspond to some measure of similarity between a pair of nodes i and j. spectral graph theory  is brought to bear to find groups of connected, high-weight edges that define clusters of samples. this problem may be reformulated as a form of the min-cut problem: cutting the graph across edges with low weights, so as to generate several subgraphs for which the similarity between nodes is high and the cluster sizes preserve some form of balance in the network. it has been demonstrated  <cit>  that solutions to relaxations of these kinds of combinatorial problems  can be framed as an eigendecomposition of a graph laplacian matrix l. the laplacian is derived from the similarity matrix s  and the diagonal degree matrix d , normalized according to the formula

  l = l-d-1∕2sd-1∕ <dig>  

in spectral clustering, the similarity measure sij is computed from the pairwise distances rij between samples i and j using a gaussian kernel  <cit>  to model local neighborhoods,

  sij= exp-rij22σ <dig>  

where scaling the parameter σ controls the width of the gaussian neighborhood, i.e., the scale at which distances are deemed to be similar.  following  <cit> , we use a correlation-based distance metric in which the correlation ρij between samples i and j is converted to a chord distance on the unit sphere,

  rij=2sin∕2). 

the use of the signed correlation coefficient implies that samples with strongly anticorrelated gene expression profiles will be dissimilar  and is motivated by the desire to distinguish between samples that positively activate a pathway from those that down-regulate it.

eigendecomposition of the normalized laplacian l given in eq.  <dig> yields a spectrum containing information regarding the graph connectivity. specifically, the number of zero eigenvalues corresponds to the number of connected components. in the case of a single connected component , the eigenvector for the second smallest  eigenvalue  encodes a coarse geometry of the data, in which the coordinates of the normalized fiedler vector provide a one-dimensional embedding of the network. this is a "best" embedding in the sense that it solves a relaxation of an optimization problem that seeks to determine an optimal partitioning of the data . this one-dimensional summary provides the greatest dimension reduction--but optimal with respect to the dimensionality--of the data. finer resolution is provided by the dimension reductions obtained by increasing the dimensionality via the use of additional eigenvectors .

by embedding the data into a smaller-dimensional space defined by the low-frequency eigenvectors and clustering the embedded data using k-means  <cit> , the geometry of the data may be revealed. because k-means clustering is by nature stochastic  <cit> , multiple k-means runs are performed and the clustering yielding the smallest within-cluster sum of squares is chosen. in order to use k-means on the embedded data, two parameters need to be chosen: the number of eigenvectors l to use  and the number of clusters k into which the data will be clustered.

optimization of l
the optimal dimensionality of the embedded data is obtained by comparing the eigenvalues of the laplacian to the distribution of fiedler values expected from null data. the motivation of this approach follows from the observation that the size of eigenvalues corresponds to the degree of structure , with smaller eigenvalues corresponding to greater structure. specifically, we wish to construct a distribution of null fiedler values--eigenvalues encoding the coarsest geometry of randomly organized data--and select the eigenvalues from the true data that are significantly small with respect to this distribution . in doing so, we select the eigenvalues that indicate greater structure than would be expected by chance alone. the idea is that the distribution of random fiedler values give a sense of how much structure we could expect of a comparable random network. we thus take a collection of perpendicular axes, onto each of which the projection of the data would reveal more structure than we would expect at random.

the null distribution of fiedler values is obtained through resampling sij . this process may be thought of as "rewiring" the network while retaining the same distribution of edge weights. this has the effect of destroying structure by dispersing clusters  and creating new clusters by random chance. because the raw data itself is not resampled, the resulting resampled network is one which has the same marginal gene expression distributions and gene-gene correlations as the original data, and is thus a biologically comparable network to that in the true data. note that the resampling-based  construction of the reference distribution here differs from the previous description of the pdm  <cit>  that employed a gaussian ensemble null model.

eigenvectors whose eigenvalues are significantly small with respect to the resampled null model are retained as the coordinates that describe the geometry of the system that distinguishable from noise, yielding a low-dimensional embedding of the significant geometry. if none of the eigenvalues are significant with respect to the resampled null reference distribution, we conclude that no coordinate encodes more significant cluster structure than would be obtained by chance, and halt the process.

optimization of k
the development of methods for obtaining the number of clusters k suitable for partitioning a data set is an area of active research . our approach exploits the property  <cit>  that clustering the entries in the fiedler vector yields the best decomposition of the network components. consequently, one can use the number peaks in the density of the fiedler vector--that is, the number of values about which the elements of v <dig> are clustered--as the number of clusters.  to obtain this value, we fit a gaussian mixture model  <cit>  with 2- <dig> components , compute the bayesian information criterion  for each mixture model, and choose the optimum number of components .

once k and l have been assigned, the data embedded via the coordinates given by the eigenvectors of the smallest l nonzero eigenvalues is clustered using k-means  <cit> . the spectral clustering procedure offers several advantages over simple clustering of the original data using k-means: first, the fiedler vector provides a natural means to estimate the number of clusters; and second, because spectral clustering operates on similarity of the samples, rather than planar cuts of the high-dimensional feature space, complex correlation structures can be identified. a complete discussion of the advantages of spectral clustering is given in  <cit> .

to illustrate the power of this method, consider a toy data set called "two_circles" in which  <dig> data points are placed in two-dimensional space in two concentric circles, as depicted in figure  <dig>  because k-means alone can only identify clusters with convex hulls, k-means clustering using k =  <dig> produces an arbitrary, linear division of the data as shown in figure  <dig>  in contrast, spectral clustering identifies the two rings as individual clusters, as seen in figure  <dig>  while k-means took k =  <dig> as an input from the user, the spectral clustering example determined k =  <dig> from the data, as shown in figure 1; the rug plot depicts the distribution of the fiedler vector coordinates, in which two peaks are readily visible and chosen as indicative of two clusters, as described above.

while the two_circles data is simulated, we note that patterns of this type will arise when out-of-phase oscillatory genes, such as those involved in circadian rhythms or cell cycle processes, are sampled; the radii of the co-expression circles will be dictated by the amplitude of the gene oscillations. an illustration of such patterns in nature is provided in figure  <dig>  which depicts the co-expression pattern of three cell-cycle related genes in cdc- <dig> and elutriation synchronized yeast cells from  <cit> . the elutriation synchronized cells exhibit much smaller amplitude oscillations than do the cdc- <dig> synchronized cells; while the cdc- <dig> and elutriation synchronized cells cannot be distinguished using k-means, the distinction is readily made via spectral clustering. the biological relevance of patterns such as those depicted in figures  <dig> and  <dig> has been noted in mammalian systems as well; in  <cit>  it is found that the majority of mammalian genes oscillate and that the amplitude of oscillatory genes differs between tissue types and is associated with the gene's function. these observations led to the conclusion in  <cit>  that pathways should be considered as dynamic systems of genes oscillating in coordination with each other, and underscores the need to detect amplitude differences in co-oscillatory genes as depicted in figures  <dig> and  <dig> 

the benefit of spectral clustering for pathway-based analysis in comparison to over-representation analyses such as gsea  <cit>  is also evident from the two_circles example in figure  <dig>  let us consider a situation in which the x-axis represents the expression level of one gene, and the y-axis represents another; let us further assume that the inner ring is known to correspond to samples of one phenotype, and the outer ring to another. a situation of this type may arise from differential misregulation of the x and y axis genes. however, while the variance in the x-axis gene differs between the "inner" and "outer" phenotype, the means are the same ; likewise for the y-axis gene. in the typical single-gene t-test analysis of this example data, we would conclude that neither the x-axis nor the y-axis gene was differentially expressed; if our gene set consisted of the x-axis and y-axis gene together, it would not appear as significant in gsea  <cit> , which measures an abundance of single-gene associations. yet, unsupervised spectral clustering of the data would produce categories that correlate exactly with the phenotype, and from this we would conclude that a gene set consisting of the x-axis and y-axis genes plays a role in the phenotypes of interest. we exploit this property in applying the pdm by pathway to discover gene sets that permit the accurate classification of samples.

scrubbing
after the clustering step has been performed and each data point assigned to a cluster, we wish to "scrub out" the portion of the data explained by those clusters and consider the remaining variation. this is done by computing first the cluster centroids , and then subtracting the data's projection onto each of the centroids from the data itself, yielding the residuals. the clustering step may then be repeated on the residual data, revealing structure that may exist at multiple levels, until either a) no eigenvalues of the laplacian in the scrubbed data are significant with resepct to those obtained from the resampled graphs as described above; or b) the cluster centroids are linearly dependent. 

application to microarray data
we apply the pdm to several cancer gene expression data sets to demonstrate how it may be used to reveal multiple layers of structure. in the first data set  <cit> , the pdm articulates two independent partitions corresponding to cell type and cell exposure, respectively. analysis of the second data  <cit>  set demonstrates how successive partitioning by the pdm can reveal disease and tissue subtypes in an unsupervised way. we then show how the pdm can be used to identify the biological mechanisms that drive phenotype-associated partitions, an approach that we call "pathway-pdm." in addition to applying it to the radiation response data set mentioned above  <cit> , we also apply pathway-pdm to a prostate cancer data set  <cit> , and briefly discuss how the pathway-pdm results show improved concordance of significant pathways identified in the singh data  <cit>  with those previously identified in several other prostate cancer data sets  <cit> .

partition decoupling in cancer gene expression data
radiation response data
we begin by applying the pdm to the radiation response data  <cit>  to illustrate how it may be used to reveal multiple layers of structure that, in this case, correspond to radiation exposure and sensitivity. in the first layer, spectral clustering classifies the samples into three groups that correspond precisely to the treatment type. the number of clusters was obtained using the bic optimization method as described above. resampling of the correlation coefficients was used to determine the dimension of the embedding l using  <dig> permutations ;  <dig> k-means runs were performed and the clustering yielding the smallest within-cluster sum of squares was chosen. classification results are given in table  <dig> and figure  <dig>  the unsupervised algorithm correctly identifies that three clusters are present in the data, and assigns samples to clusters in a manner consistent with their exposure.

in order to compare the performance of spectral clustering to that of k-means, we ran k-means on the original data using k =  <dig> and k =  <dig>  corresponding to the number of treatment groups and number of cell type groups respectively. as with the spectral clustering,  <dig> random k means starts were used, and the smallest within-cluster sum of squares was chosen. the results, given in tables  <dig> and  <dig>  show substantially noisier classification than the results obtained via spectral clustering. it should also be noted that the number of clusters k used here was not derived from the characteristics of the data, but rather is assigned in a supervised way based on additional knowledge of the probable number of categories . while the pure k-means results are noisy, the k =  <dig> classification yields a cluster that is dominated by the highly radiation-sensitive cells . membership in this cluster versus all others identifies highly radiation-sensitive cells with 62% sensitivity and 96% specificity; if we restrict the analysis to the clinically-relevant comparison between the last two cell types--that is, cells from cancer patients who show little to no radiation sensitivity and those from cancer patients who show high radiation sensitivity--the classification identifies radiation-sensitive cells with 62% sensitivity and 82% specificity.

the result from the k =  <dig> k-means classification suggest that there exist cell-type specific differences in gene expression between the high radiation sensitivity cells and the others. to investigate this, we perform the "scrubbing" step of the pdm, taking only the residuals of the data after projecting onto the clusters obtained in the first pass. as in the first layer, we use the bic optimization method to determine the number of clusters k and resampling of the correlations to determine the dimension of the embedding l using  <dig> permutations. the second layer of structure revealed by the pdm partitioned the high-sensitivity samples from the others into two clusters. classification results are given in table  <dig> and figure  <dig>  and it can be seen that the partitioning of the radiation-sensitive samples is highly accurate .

further pdm iterations resulted in residuals that were indistinguishable from noise ; we thus conclude that there are only two layers of structure present in the data: the first corresponding to exposure, and the second to radiation sensitivity. that is, there exist patterns in the gene expression space that distinguish uv- and ionizing radiation exposed cells from mock-treated cells , and that there exist further patterns that distinguish high-sensitivity cells from the rest. together, these independent  sets of clusters describe six categories, as shown in figure  <dig>  wherein the second layer partitions the radiation sensitive cells from the others in each exposure-related partition. the fact that the mock-exposure as well as the uv- and ir-exposure partitions are further divided by radiation sensitivity in the second layer suggests that there exist constitutive differences in the radiation sensitive cells that distinguish them from the other groups even in the absence of exposure. importantly, the data-driven methodology of the pdm identifies only phenotypic clusters, corresponding to the high-sensitivity cells and the three control groups combined, without further subpartitioning the combined controls. this suggests that the three control groups do not exhibit significant differences in their global gene-expression profiles.

in the original analysis of this data  <cit> , the authors used a linear, supervised algorithm  to develop a predictor for the high-sensitivity samples. this approach obtained  <dig> % sensitivity and 100% specificity  <cit> , yielding a clinically useful predictor. the pdm's unsupervised detection of the high sensitivity sample cluster suggests that the accuracy in  <cit>  was not a result of overfitting to training data; moreover, the pdm's ability to identify those samples with higher sensitivity than in  <cit>  indicates that there exist patterns of gene expression distinct to the radiation-sensitive patients which were not identified in the sam analysis, but are detectable using the pdm.

desouto multi-study benchmark data
having observed the pdm's ability to decouple independent partitions in the four-phenotype, three-exposure radiation response data, we next consider the pdm's ability to articulate disease subtypes. because cancers can be molecularly heterogeneous, it is often important to articulate differences between subtypes--a distinction that may be more subtle than than the differences caused by radiation exposure. here, we apply the pdm to the suite of  <dig> affymetrix data sets previously considered in  <cit> . the use of these sets is motivated by their diversity and by the ability to compare the pdm performance to that of the methods reported in  <cit> .

in  <cit> , the authors applied several widely used clustering algorithms--spectral clustering, hierarchical clustering, k-means, finite mixture of gaussians , and shared nearest-neighbor clustering--to the data using various linkage and distance metrics as available for each. in  <cit> , the number of clusters k was set manually, ranging over , where kc is the known number of sample classes and n is the number of samples; in the spectral clustering implementation, l was set equal to the value chosen for k. note that the pdm differs in several crucial ways from basic spectral clustering as applied in  <cit> . first, the choices of k and l in the pdm are data-driven . second, the successive partitioning carried out in the pdm layers can disambiguate mixed clusters. notably, the pdm partitions are obtained without relying on prior knowledge of the number of clusters. this is an important feature when the data may contain un-identified disease subtypes.

to illustrate this, we focus on a handful of the benchmark data sets.  the partitions are shown in figure  <dig>  in figure  <dig> and  <dig>  pdm reveals a single layer of three clusters in two versions of the golub- <dig> leukemia data  <cit> . the two data sets as provided contained identical gene expression measurements and differed only in the sample status labels, with golub-1999-v <dig> only distinguishing aml from all, but golub-1999-v <dig> further distinguishing between b- and t-cell all. as can be seen from figure  <dig>  the pdm articulates a single layer of three clusters, based on the gene expression data. in figure  <dig> , we see that the aml samples are segregated into cluster  <dig>  while the all samples are divided amongst clusters  <dig> and 3; that is, the pdm partition indicates that there exists structure, distinct from noise , that distinguishes the all samples as two subtypes. if we repeat this analysis with golub-1999-v <dig>  we obtain the partitions shown in figure  <dig>  since the actual gene expression data is identical, the pdm partitioning of samples is the same; however, we now can see that the division of the all samples between clusters  <dig> and  <dig> corresponds to the b- and t-cell subtypes. one can readily find--particularly in the context of cancers--situations in which unknown sample subclasses exist that could be detected via pdm ); at the same time, the pdm's comparison to the resampled null model prevents artificial partitions of the data.

in figures  <dig> and  <dig>  we see how the first layer of clustering is refined in the second layer; for example, in figure  <dig>  the e2a-pbx <dig> and t-all leukemias are distinguished in the first layer, while the second serves to separate the mll and majority of the tel-aml subtypes from the mixture of b-cell alls in the first cluster of layer  <dig>  as in figures  <dig> and  <dig>  the pdm identifies clusters of subtypes that may not be known a priori , by several subtypes). in figure  <dig>  second layer cluster assignment in figure  <dig> distinguishes the ovarian  and kidney  samples from the others in the mixed cluster  <dig> in the first layer.

results for the complete set of affymetrix benchmark data are given in additional files  <dig> and  <dig>  a t-test comparison of adjusted rand indices obtained from the pdm suggests that it is comparable to those obtained with the best method, fmg, in  <cit> . however, it is important to note that this is achieved by the pdm in an entirely unsupervised way . this is a considerable advantage. we also note that the pdm performance remained high regardless of the distance metric used , and we did not observe the large decrease in accuracy noted by  <cit>  when using a euclidean metric in spectral clustering. we attribute this largely to the aforemented improvements  of the pdm over standard spectral clustering.

pathway-pdm analysis
the above applications of the pdm illustrate its ability to detect clusters of samples with common exposures and phenotypes based on genome-wide expression patterns, without advance knowledge of the number of sample categories. however, it is often of greater interest to identify a set of genes that govern the distinction between samples. pathway-based application of the pdm permits this by systematically subsetting the genes in known pathways , and partitioning the samples. pathways yielding cluster assignments that correspond to sample characteristics can then be inferred to be associated with that characteristic. we call this approach the "pathway-pdm."

we applied pathway-pdm as described above to the radiation response data from  <cit> , testing the clustering results obtained for inhomogeneity with respect to the phenotype . because some pathways contain a fairly large number of probes, it is reasonable to ask whether the pathways that permitted clusterings corresponding to tumor status were simply sampling the overall gene expression space. in order to assess this, we also constructed artificial pathways of the same size as each real pathway by randomly selecting the appropriate number of probes, and recomputing the clustering and χ <dig> p-value as described above.  <dig> such random pathways were created for each unique pathway length, and the fraction frand of pathways that yielded a χ <dig> p-value smaller than that observed in the "true" pathway is used as an additional measure of the pathway significance. six pathways distinguished the radiation-sensitive samples with frand < <dig>  as shown in figure 5; several also articulated exposure-associated partitions in addition to the phenotype-associated partition. interestingly, all of the high-scoring pathways separated the high-rs case samples, but did not subdivide the three control sample classes; this finding, as well as the exposure-independent clustering assignments in several pathways in figure  <dig>  suggests that there are systematic gene expression differences between the radiation-sensitive patients and all others. several other pathways  yield exposure-associated partitions without distinguishing between phenotypes; unsurprisingly, these are the cell cycle, p <dig> signaling, base excision repair, purine metabolism, map kinase, and apoptosis pathways.

to further illustrate pathway-pdm, we apply it to the singh prostate gene expression data  <cit>  . first, we observe that in the complete gene expression space, the clustering of samples corresponds to the tumor status in the second pdm layer . this is consistent with the molecular heterogeneity of prostate cancer, and suggests that the first layer describes individual variation that is scrubbed out and then revealed in the second layer. next, we apply pathway-pdm as described above, testing each layer of clustering for inhomogeneity with respect to the known tumor/normal labels .

of the  <dig> pathways considered, those that yielded significant frand in any layer of clustering is given in table  <dig>  no pathway yielded more than two layers of structure. a total of  <dig> of  <dig> pathways exhibited significant clustering inhomogeneity in any layer; amongst the significant pathways, the misclassification rate--the fraction of tumor samples that are placed in a cluster that is majority non-tumor and vice-versa--is approximately 20%. plots of the six most discriminative pathways in layers  <dig> and  <dig> are given in figure  <dig> 

the lp column lists the size of the pathway. χ <dig> test p-values for tumor status versus cluster assignment in pdm layer  <dig> and layer  <dig> are given. the frand columns show the fraction of randomly-generated pathways with smaller χ <dig> p-values in either pdm layer. the final column lists the data sets for which  <cit>  identified the pathway as significant  in kegg between this analysis and the time of  <cit>  publication).

a number of known prostate cancer-related pathways appear at the top of this list. the urea acid cycle pathway, prion disease pathway, and bile acid synthesis pathways have previously been noted in relationship to prostate cancer  <cit> . the coagulation cascade is known to be involved in tumorigenesis through its role in angiogenesis  <cit> , and portions of this pathway have been implicated in prostate metastasis  <cit> . cytochrome p <dig>  which is part of the inflammatory response, has been implicated in many cancers  <cit> , including prostate  <cit> , with the additional finding that it may play a role in estrogen metabolism   <cit> . many amino acid metabolism pathways  and known cancer-associated signaling pathways  are also identified.

because pathway-pdm does not rely upon single-gene associations and employs a "scrubbing" step to reveal progressively finer relationships, we expect that we will be able to identify pathways missed by other methods. it is of interest to compare the results obtained by pathway-pdm to those obtained by other pathway analysis techniques. in  <cit> , the authors applied several established pathway analyses  to a suite of three prostate cancer gene expression data sets, including the singh data considered here. fifty-five kegg pathways were identified in at least one data set by at least one method  <cit> , but with poor concordance:  <dig> of these were found solely in the singh data, and  <dig> were found in both the singh data and at least one of the other two data sets  using any method. a comparison of the pathway-pdm identified pathways to those reported in  <cit>  is given by the final column of table  <dig>  which lists the data sets for which that pathway was found to be significant using at least one method  reported in  <cit> . of the  <dig> pathway-pdm identified pathways,  <dig> had been identified by  <cit>  in either the welsh or ernst data . the pdm-identified pathways show improved concordance with the pathways identified in  <cit> ; while only  <dig> of the  <dig> pathways identified in the welsh or ernst data were corroborated by the singh data using any method in  <cit> , the addition of the pathway-pdm singh results brings this to 22/ <dig>  of the  <dig> pathways newly introduced in table  <dig>  several are already known to play a role in prostate cancer but were not detected using the methods in  <cit>  ; several also constitute entries in kegg that were either not present at the time that  <cit>  was published or have had over 30% of genes added/removed, making them incomparable to the kegg annotations used in  <cit> . this improved concordance supports the inferred role of the pdm-identified pathways in prostate cancer, and, as applied to the singh data, suggests that the pathway-pdm is able to detect pathway-based gene expression patterns missed by other methods.

CONCLUSIONS
we have presented here a new application of the partition decoupling method  <cit>  to gene expression profiling data, demonstrating how it can be used to identify multi-scale relationships amongst samples using both the entire gene expression profiles and biologically-relevant gene subsets . by comparing the unsupervised groupings of samples to their phenotype, we use the pdm to infer pathways that play a role in disease.

the pdm has a number of features that make it preferable to existing microarray analysis techniques. first, the use of spectral clustering allows identification of clusters that are not necessarily separable by linear surfaces, enabling the identification of complex relationships between samples. as this relates to microarray data, this corresponds to the ability to identify clusters of samples even in situations where the genes do not exhibit differential expression. this is particularly useful when examining gene expression profiles of complex diseases, where single-gene etiologies are rare. we observe the benefit of this feature in the example of figure  <dig>  where the two separate yeast cell groups could not be separated using k-means clustering but could be correctly clustered using spectral clustering. we note that, like the genes in figure  <dig>  the oscillatory nature of many genes  <cit>  makes detecting such patterns crucial.

second, the pdm employs not only a low-dimensional embedding of the feature space, thus reducing noise , but also the optimal dimensionality and number of clusters is data-driven rather than heuristically set. this makes the pdm an entirely unsupervised method. because those parameters are obtained with reference to a resampled null model, the pdm prevents samples from being clustered when the relationships amongst them are indistinguishable from noise. we observed the benefit of this feature in the radiation response data  <cit>  shown in figure  <dig>  where two  phenotype-related clusters were articulated by the pdm: the first corresponding to the high-rs cases, and the second corresponding to a combination of the three control groups.

third, the independent "layers" of clusters  obtained in the pdm provide a natural means of teasing out variation due to experimental conditions, phenotypes, molecular subtypes, and non-clinically relevant heterogeneity. we observed this in the radiation response data  <cit> , where the pdm identified the exposure groups with 100% accuracy in the first layer  followed by highly accurate classification of the high-rs samples in the second layer . the improved sensitivity to classify high-rs samples over linear methods  suggests that there may exist strong patterns, previously undetected, of gene expression that correlate with radiation exposure and cell type. this was also observed in the benchmark data sets  <cit> , shown in figure  <dig> and supplementary figs. s- <dig>  s- <dig> , where the pdm automatically detected subtypes in an unsupervised manner without forcing the cluster number. the results from the pdm in the radiation response data and benchmark data sets were at least as and generally more accurate than those reported using other algorithms in  <cit> , were obtained without assumptions regarding the sample classes, and reflect statistically significant  relationships between samples in the data.

the accuracy of the pdm can be used, in the context of gene subsets defined by pathways, to identify mechanisms that permit the partitioning of phenotypes. in pathway-pdm, we subset the genes by pathway, apply the pdm, and then test whether the pdm cluster assignments reflect the known sample classes. pathways that permit accurate partitioning by sample class contain genes with expression patterns that distinguish the classes, and may be inferred to play a role in the biological characteristics that distinguish the classes. this is a novel approach to pathway analysis that improves upon enrichment approaches in that does not require that the pathway's constituent genes be differentially expressed. that is, we expect that pathway-pdm will identify both the pathways that would be identified in enrichment analyses  as well as those whose constituent genes would not yield high measures of differential expression . this makes pathway-pdm a promising tool for identifying mechanisms that show systems-level differences in their regulation that could be missed by methods that rely on single-gene association statistics.

to illustrate pathway-pdm, we applied the pathway-pdm to both the radiation response data  <cit>  and a prostate cancer data set  <cit> . in the radiation response data  <cit> , we identified pathways that partitioned the samples by phenotype and both by phenotype and exposure  as well as pathways that only partitioned the samples by exposure without distinguishing the phenotypes . in the prostate cancer data  <cit> , we identified  <dig> pathways that partitioned the samples by tumor/normal status . of these,  <dig> revealed the significant tumor/normal partition in the second layer rather than the first , and  <dig> of the  <dig> pathways with significant tumor/normal partitions in the first layer contained additional structure in the second. prostate cancer is known to be molecularly diverse  <cit> , and these partitions may reflect unidentified subcategories of cancer or some other heterogeneity amongst the patients. by applying the pathway-pdm to the singh data, we were able to improve upon the pathway-level concordance reported in  <cit> , which applied pathway enrichment analyses  to data from the singh, welsh, and ernst prostate cancer studies. we find not only that pathway-pdm identifies pathways in the singh prostate data that were identified in  <cit> , but in addition identifies several other pathways from the singh data that were reported by  <cit>  in the welsh and ernst data, but not in the singh data. that is, despite the fact that these pathways were not identified in the singh data using gsea, there do exist patterns of gene expression that are detected by pathway-pdm; their identification in the other two data sets corroborates their relevance and supports their further investigation.

while our application of pathway-pdm was such that the clusters found by the pdm for each pathway were compared against known sample class labels, we can just as easily compare them to labels from the cluster assignment from full-genome pdm. hence, for example, in a situation such as the golub-1999-v <dig> data shown in figure  <dig>  we could use the 3-cluster assignment, rather than the 2-class sample labels, to find the pathways that permit the separation of cluster- <dig> alls from the cluster- <dig> alls. in a case like this, where full-genome pdm analysis suggests the existence of disease subtypes, applying pathway-pdm may help identify the molecular mechanisms that distinguish those samples.  such an analysis would enable a refined understanding of the molecular differences between the subtypes and suggest alternative mechanisms to investigate for diagnostic and therapeutic potential.

despite these benefits, the pdm as applied here has two potential drawbacks. first, while we obtained accurate results from the pdm when setting σ =  <dig>  the dependence upon this scaling parameter in eq.  <dig> is a known issue in kernel-based methods, including spectral clustering and kpca  <cit> . methods to optimally select σ are actively being developed, and several adaptive procedures have been suggested  that may allow for refined tuning of σ. second, the low-dimensional nonlinear embedding of the data that makes spectral clustering and the pdm powerful also complicates the biological interpretation of the findings . pathway-pdm serves to address this issue by leveraging expert knowledge to identify mechanisms associated with the phenotypes. additionally, the nature of the embedding, which relies upon the geometric structure of all the samples, makes the classification of a new sample challenging. these issues might be addressed in several ways: experimentally, by investigation of the pathway-pdm identified pathways  to yield a better biological understanding of the dynamics of the system that were "snapshot" in the gene expression data; statistically, by modeling the pathway genes using an approach such as  <cit>  that explicitly accounts for oscillatory patterns  or such as  <cit>  that accounts for the interaction structure of the pathway; or geometrically, by implementing an out-of-sample extension for the embedding as described in  <cit>  that would allow a new sample to be classified against the pdm results of the known samples.

in sum, our findings illustrate the utility of the pdm in gene expression analysis and establish a new technique for pathway-based analysis of gene expression data that is able to articulate phenotype distinctions that arise from systems-level  differences. we expect this approach to be of use in future analysis of microarray data as a complement to existing techniques.

