BACKGROUND
with the advancement of microarray technology, commercial high-density oligonucleotide microarrays can hold millions of probes on a single microscopic glass slide. microarray technology can currently print up to five million features per microarray slide using the in situ oligo synthesis method  <cit> . maskless array synthesis  technology  <cit>  makes it possible to synthesize oligonucleotides of any sequence. this great capacity can be used for designing probe sequences covering an entire small genome or chromosome or a continuous portion of larger genomes. probes can be designed to closely 'tile' along the genomic sequence so that any two neighboring probes are immediately adjacent to or overlapping each other.

the hybridization signals detected by the tiling designed probes can be plotted on the genomic coordinates to form a comprehensive transcription profile. the profile reveals all the rna transcripts in the cells comprising both protein and non-protein coding rnas including those that are not predicted by computational annotation. genomic tiling arrays are thus useful in both confirming the computer-predicted genes and discovering novel rnas. they have been used to study whole genome or chromosome transcription for various organisms including humans  <cit> . for small genomes such as those of prokaryotes, the capacity of the high-density tiling arrays often allows for studies of the comprehensive transcriptome  <cit> .

compared to eukaryotes, prokaryotes  generally have smaller genomes and the genes are more densely packed. the majority of prokaryotic genomes are smaller than  <dig> mbp  <cit>  with an average non-protein coding portion of only 12%  <cit> . higher eukaryotes have a much larger portion non-protein to protein coding sequences, e.g. the human genome with only ~ <dig> % exonic dna  <cit> . most of the eukaryotic non-protein coding sequences are low complexity sequences, such as repetitive elements  <cit> . interestingly many of the non-protein coding sequences are functionally active and have been found to play important regulatory roles both in eukaryotes  <cit>  and prokaryotes  <cit> . thus in terms of studying transcriptome profiles, these regions should not be masked or neglected when designing probes for genomic tiling arrays as this may result in overlooking novel and active transcripts with important functions.

the most straightforward method for designing genomic tiling arrays simply selects a probe at fixed intervals across the entire genome without considering any factors affecting the hybridization. this is called naïve tiling and has been used in transcriptome studies for organisms such as escherichia coli  <cit>  and thalassiosira pseudonana  <cit> . more sophisticated tiling design algorithms were later developed and have been reviewed by schliep and krause  <cit>  and by lemoine et al.  <cit> . in general, probe sets can be selected by generating a tile path  <cit>  or by selecting probes from either fixed  <cit>  or more dynamic selection windows  <cit> . gräf et al.  <cit>  used an algorithm calculating and sorting all potential probes according to a uniqueness score. within a defined selection window the probe candidate with the highest uniqueness score is identified. however, gräf's algorithm may reject all probe candidates in a window leaving an area on the genome without complete probe coverage. similarly lipson et al.  <cit>  used an approach to select the best probes of high local quality within predefined limits for both quality and distance. more recently schliep and krause  <cit>  reported an optimal tile path algorithm for designing tiling probe sets. this algorithm was designed in particular for selecting non-overlapping probes with dynamic distances between adjacent probes to allow highest quality of probe sequences. another approach for non-equidistant tiling used by thomassen et al.  <cit> , divided the genomic sequence into regions according to different levels of interest .

the aim of this paper is to describe a probe selection computational pipeline for designing tiling probe sets, originally developed to study transcriptome profiles of prokaryotes. all possible probe sequences of the target genome are evaluated and optimal probes are then dynamically selected in two stages - sequential and gap-filling. in the first sequential stage, probes are selected from fixed sized sequence windows tiled alongside the genome. by gap-filling additional probes are selected from the largest gaps between existing already selected probes. compared to eukaryotic genomes, which tend to have larger areas of repetitive sequences giving uninformative hybridization signals due to cross-hybridization, the gap-filling increases the probe coverage generating valuable information when applied to the smaller and compact microbial genomes. combining the two different methods provides the opportunity to emphasize either sequential or gap selection. the gap-filling also allows for the selection of additional probes until a desired number of total probes is reached, making it possible to utilize every probe spot on any microarray platform. unlike most probe design applications, no cut-off limits are applied to ensure that one best probe representative always is selected from every window, and consequently all areas of the genome are covered. the uniqueness of the pipeline is the generation of a probe set holding an exact number of non-redundant oligonucleotide sequences that are evenly tiled along the target microbial genome. overall, this pipeline provides a fine balance between probe coverage and quality for designing genomic tiling array probe sets to study microbial transcriptome profiles.

implementation
algorithm overview
the algorithm described is a pipeline of several computer scripts specifically developed for selecting a set of tiling probes from the genomic sequence. the pipeline input is the whole genomic sequence of the target genome. the final output is a probe set of non-redundant oligonucleotide sequences dynamically and evenly distributed across the entire input sequence. the pipeline consists of six major steps , described as follows:

step 1: compilation of all possible probe sequences from a genome
as many genomes contain multiple circular and/or linear sequences, all genomic molecules of the target organism are included in the probe sequence compilation. for circular sequences, a portion of the sequence from the first base of the 5'-end, with a length equal to that of the probe minus one, is appended to the 3'-end of the sequence so that probe sequences crossing the start-end junction are accounted for. all the genomic sequences are concatenated to form a single pseudo-molecule with spacer sequences. the script will then compile all the possible probe sequences of desired length starting from the first base of the pseudo-molecule moving forward one base at a time. the reverse-complement sequence is saved at the same time. sequences containing any non-atcg code are omitted which makes it possible to process both pre-masked and spacer sequences.

step 2: adjustment of probe sequence length by synthesis cycles and melting temperature
the sequence length of each probe is adjusted according to two parameters:

oligonucleotide synthesis cycles
our custom microarrays were printed by roche nimblegen, inc.  using the maskless array synthesizer  technology with a preset maximal number of synthesis cycles. the number of synthesis cycles for each probe sequence is calculated and when needed the probe is shortened from the 3'-end of the sequence until the number of synthesis cycles is smaller or equal to the maximal limit.

melting temperature
the melting temperature  of a probe sequence affects the hybridization efficiency with its complementary target  <cit> . an isothermal probe design facilitates similar binding kinetics between probes and targets in the hybridization solution and thereby comparable signal intensities. adjustment of probe sequence length is applied to obtain the best isothemality possible. due to multiple tm calculations for various lengths of every single probe sequence we implemented a less computational time consuming salt adjusted method, even though the nearest-neighbor method is reported to be more accurate  <cit> . for longer probe sequences  a salt and optional formamide adjusted equation is used  <cit> :  

a slightly different salt adjusted equation is applied for shorter probe sequences  <cit> :  

in both formulas, n is the total number of nucleotides in the probe sequence, g and c the number of respective nucleotides,  the monovalent salt molar concentration, and f the formamide percent concentration. melting temperatures of all probe sequences are calculated and the median tm value recorded. probe sequences with a tm different from the median tm are truncated one base at the 3'-end and the tm is then recalculated. truncation and recalculation is repeated until the tm is equal to the median tm or a preset minimal probe sequence length is reached and the probe sequence with tm closest to the median tm will then be used.

the output of this step is the comprehensive collection of all possible non-redundant probe sequences including the genomic position. for repeated sequences multiple positions are recorded.

step 3: assessment of cross-hybridization
sequence complementarities between a probe and any unintended target  can cause cross-hybridization and thereby generate false positive signals that interfere with the identification of true ones. every probe sequence generated in step  <dig> is subjected to a blast  <cit>  search against the pseudo-molecule made in step  <dig>  cross-hybridization is evaluated by observing the percentage of sequence identity  between the probe sequence and non-target sequences and by the length of continuous complementary sequence stretch with non-target sequences, referred to as identity stretch. many studies have used sequence percentage identity as either the single parameter or in combination with identity stretch to evaluate cross-hybridization  <cit> . based on results from these studies we find it feasible to sort the probe sequences according to levels of expected cross-hybridization potential and the default level limits were selected as follows, where pi is the percent identity and is the identity stretch :

level  <dig> - pi < 50%

level  <dig> - 50% ≤ pi < 75% and is < 30%

level  <dig> - 75% ≤ pi < 90% and 30% ≤ is < 40%

level  <dig> - pi ≥ 90% and is ≥ 40%

level  <dig> and  <dig> reflect virtually no cross-hybridization potential and the predefined default limits were based on results reported by kane et al.  <cit> . the default limits for level  <dig> and  <dig> were primarily based on results reported by liebich et al.  <cit>  and rhee et al.  <cit> . level  <dig> probe sequences have low cross-hybridization potential and at level  <dig> the cross-hybridization potential is expected to be significant. the cross-hybridization level assignment described will be considered later in steps  <dig> and  <dig> for selecting optimal probes. in summary, at every consecutive selection window or gap all probe sequences are sorted in the order of least potential cross-hybridization first and assigned to the corresponding level. probe sequences from the most stringent level are collected for further evaluation while less specific probes are excluded.

step 4: estimation of probe self-annealing potential
stable secondary structure imposed by the probe sequence itself can affect the binding efficiency with the intended target sequence. the self-annealing potential of a probe can be calculated as the minimum free energy folding of the probe sequence. in this step each probe sequence is subjected to a minimum free energy calculation using the hybrid-ss-min program contained in the unafold software developed by markham and zuker  <cit> . unafold computes the free energy using nearest-neighbor coefficients intended for dna as the 'unified' parameters defined by santalucia  <cit> . the lower the minimum free energy , the more stable the secondary structure of the probe. thus, a higher free energy value  indicates a better probe candidate.

step 5: probe selection at fixed intervals
this step is to select a representative probe candidate within preset nucleotide intervals, referred to as selection windows. from each window, an optimal probe candidate is selected to represent all the probe sequences that start within the same window. the window size  can either be set by users or calculated based on the combined length of all the genomic sequences  and the total number of probe spots available on the microarray :  

in the calculation, gs is doubled to include both strands. the reason for truncating the result  is because a selected probe of repeated sequence will often represent multiple selection windows. most genomes contain significant portions of repeated sequences and using the truncated ws as the initial window size will likely result in a number of selected non-redundant probes below ms. if the number of selected probes exceeds ms, the probe selection will be repeated with a one base larger window size . for all probe sequences that start within the same selection window, multiple screening criteria are considered to identify and select the best probe candidate .

to ensure a probe set more evenly distributed across the target genome, a minimal distance  is kept between any two adjacent selected probes. the minimal distance can either be defined by users or calculated based on the window size. since the probe selection is performed in a linear manner from the beginning of a genomic sequence, any probe candidate of the next selection window that is too close  to the previously selected probe is automatically rejected. as repeated probe sequences selected from one window also appear in other windows the script will exclude probes that fall within the minimal probe distance to any existing selected probes elsewhere in the genome. similarly, if the current window already contains an existing selected probe candidate due to a repeated probe sequence selected from a previous window, no additional probe will be selected.

to select the highest quality probe from all probe sequences occurring in the same window, candidates are grouped based on four levels of cross-hybridization assessed in step  <dig>  the screening process starts in the order of cross-hybridization level  <dig> through  <dig>  all probe sequences within the first and most stringent level holding any probes are collected for further evaluation, while the probe sequences not qualifying at this specificity level are excluded. the best probe candidate is then identified in the order of least deviation from median tm, least probe self-annealing potential, shortest blast continuous identity stretch, lowest blast percent identity, and longest probe length. if there is more than one best probe candidate , the first probe encounter will be selected, as this maximizes the distance to the next selection window.

once a probe is selected, the script will record the genomic coordinates of the probe. for repeated probe sequences multiple positions are recorded. the output generated is a set of probes optimally selected from selection windows tiled along the genomic sequences in both forward and reverse-complement directions.

step 6: additional probe selection from the larger gaps
the total number of probes selected from fixed sized selection windows is always smaller than the number of probe spots available on the microarray. the remaining spots are filled with additional probe candidates by selecting the highest quality probes from the largest gaps between any two adjacent existing selected probes . the minimal distance between any two adjacent probes is maintained by excluding probe sequences to close to probes that have already been selected. the best probe is then collected from each gap using the same selection criteria as in step  <dig>  next, the best probes from all gaps are first ranked by gap size and then by other probe quality criteria . the top ranked probe is finally selected. when a gap is filled with an additional probe, two new gaps are generated. the best probe from each of the new gaps is identified and subjected to the ranking process. the gap-filling is repeated until all probe spots on the microarray are used.

the output of this step, also the final output of the pipeline, is a tiling probe set with exactly the same number of non-redundant probe sequences as there are probe spots on the target microarray.

program parameters
the pipeline was implemented with several adjustable parameters both to fit different microarray platforms and to allow for flexibility in the probe set design. a short description of the most important parameters follows:

maximum and minimum probe sequence length
maximum probe length is the initial desired probe length while providing a shorter minimum probe length allows for isothermal probe design by sequence length adjustment.

total number of probes
the algorithm can design any exact number of probes.

blast level limits
blast limits for defining different levels of expected cross-hybridization is described in the implementation section , using the default level limits. these level limits are user adjustable.

probe selection window size
default window size is determined by the genome size and by the number of probe spots on the microarray, as described in the implementation section . the pipeline also accepts a user-defined window size.

minimal distance between adjacent probes
minimal distance between adjacent selected probes is determined by the window size or predefined by the user.

RESULTS
we have applied the described pipeline to design genomic tiling array probe sets for several microbial genomes that are currently available in the ncbi database  <cit> . table  <dig> shows the statistics of the probe sets designed for various sizes of genomes. the number of probes was preset according to the genome size in order to fit current microarray formats available from roche nimblegen, inc. default settings were used for all probe set designs. the window size was determined based on the genome size and the number of probe spots on the microarray. most often the total number of non-redundant probes will be less than the combined number of start positions on both strands. this is because of repeated sequences that are only represented by a single element on the microarray but has more than one position in the genome. note that for candidatus carsonella ruddii pv the combined number of start positions is equal to the number of probes, thus none of the selected probes are repeated sequences. these probe sets can be downloaded at our project web site  <cit> . additional probe sets for other microbial genomes will be gradually added to the pipeline and sequences made downloadable upon completion.

program execution
due to the comprehensive testing of all the possible probe sequences, the pipeline was implemented on a computer cluster containing multiple nodes and cpu cores. the pipeline was written as a series of multiple perl scripts for each of the major steps described in the implementation section. the perl scripts were executed on a single computer node and when needed the calculations were batched and queued to multiple cpus in the cluster. depending on the genome size, a significant amount of time may be required for the blast search and the blast jobs were submitted to the multi-node multi-core computer cluster using the torque resource manager in combination with the maui scheduler downloaded from the custer resources web site  <cit> .

bench marking
the time limiting step of the pipeline is the millions of blast search jobs for estimating the cross-hybridization. final run time is dependent both on the genome size and on the portion of low complexity sequence. the sizes of the current completed microbial genomes available from ncbi  <cit>  range from ~ <dig>  mbp to ~ <dig> mbp in length. table  <dig> shows the pipeline run time for microbial genomes of different sizes.

*run in parallel, only most time consuming step is included in the total run time. word size  <dig> is used for blastn.

availability
the computational algorithms described were not intended to be implemented as standalone software because of extensive compilation and comprehensive testing for all the possible probe sequences of the target genome. however, we welcome requests from researchers to custom design tilling microarray probe sets. requests can be sent to the corresponding author or posted via our submission form available at the project web site  <cit> .

discussion
to optimize for comprehensive transcriptional mapping of microbial organisms the pipeline described intends to achieve a high probe coverage resolution across the entire genome while maintaining the best possible probe quality. the pipeline ensures an even distribution of probes by maintaining a fixed probe selection window size. an optimal probe sequence is dynamically selected from each window even if all probe candidates within the same window possess poor thermodynamics or strong cross-hybridization potential. probe position inside the window is less important; hence, the probe sequences selected have an uneven spacing within the limits of the window size. using a tile path design program, like oligotiler  <cit>  most probes selected will have consistent spacing  except when the probe sequence is of low quality, the algorithm will then select a better probe near by. other dynamic probe selection methods for tiling designs using quality threshold limits tend to leave larger gaps in the low complexity regions, resulting in a less even probe coverage in these areas. while it is true that lower quality probes may distort the resulting hybridization signal intensity, this drawback can be rectified by the use of probe quality-to-signal correction methods like dna reference arrays  <cit> .

in the pipeline we use minimum free energy of folding for evaluating the probe self-annealing potential. minimum free energy of folding can also be estimated for the duplex of a probe and its intended or unintended targets. the minimum binding free energy of a probe and its perfectly matched target should be as negative as possible to ensure a stable duplex formation and high hybridization efficiency. increased signal intensity has been observed with a more negative minimum binding free energy of the perfect match duplex formation  <cit> . on the other hand, the minimum binding free energy of a probe and any non-targets should be as positive as possible  to avoid stable duplex formations that may contribute to unspecific signals  <cit> . it has been reported that the cross-hybridization can be minimized extensively by designing probe sequences with minimum binding free energy between the probe and non-targets less than ca. 50% of the minimum binding free energy between the probe and intended target   <cit> . calculation of the exact minimum binding free energy between a probe and a potential non-target, however, requires comparison of all alignments with high identities  <cit> . algorithms estimating target and non-target properties, such as target secondary structure  <cit>  and duplex formations  <cit> , generally involve multiple calculations for each probe sequence. these calculations are complex due to the multiple potential non-targets to each probe sequence and because of unpredictable target and non-target fragment lengths. due to these complications, minimum binding free energy is not evaluated in the current pipeline. however, melting temperature is correlated to annealing temperature and is an alternative estimate for the stability of the duplex formation. this probe design pipeline evaluates and uses melting temperature as an alternative approach to achieve isothermality for selected probes.

as discussed above target lengths may vary and precise calculations for minimum energy of folding are challenging. compared to the probe sequence, longer target molecules tend to have stronger intra-molecular structures inhibiting the hybridization of the probe to its target. it has been reported that fragmentation of target molecules improves the probe-target binding efficiency by destabilizing the intra-molecular secondary structure  <cit> . similarly shorter probe sequences are less likely to form stable secondary structures than longer ones. although secondary structures may rarely affect the hybridization signal intensity  <cit>  strong self-annealing can still render a probe non-functioning  <cit> . a more recent study by wei et al.  <cit>  comparing multiple properties of oligonucleotide probes also reported secondary structure to be of high importance to hybridization signal intensity. methods based on unafold  for estimation of probe self-annealing have been used in several probe design applications  <cit>  and were included in the pipeline to avoid less functional probes.

for the cross-hybridization assessment, probe candidates within the same window or gap were sorted into four levels based on specificity . selecting the best probe from ranked cross-hybridization levels ensures that the probe sequences with no or the least cross-hybridization will always be considered first albeit less ideal thermodynamic properties. evaluation of other criteria for probes within the same level and thus with similar cross-hybridization potentials is also more meaningful. this tiered specificity categorization is more robust than a straightforward multiple sorting method for identifying a better probe candidate.

unique to other tile design applications we added an iterative second selection step, selecting probes from the larger gaps generated between existing selected probes. adjusting the window size in the first selection step will emphasize either window or gap selection. a larger initial window size results in more and larger gaps for the gap-filling step. although larger window size provides more sequences for probe selection, hence better probe quality, the trade-off is a less even probe coverage on the genome. consequently, the adjustment of the window size for better probe quality must be balanced with the probe coverage. the pipeline also provides the opportunity to preset the minimal allowed distance to neighboring probes. the minimal distance directly determines the smallest spacing between selected probes and will also influence the number of available probe sequences to choose from in each window and gap. our intention by combining the two selection steps together with optional settings of both minimal distance and window size, was to allow for a more flexible probe design.

CONCLUSIONS
we have described a working computational pipeline consisting of multiple algorithms, specifically developed for designing tiling array probe sets to study microbial transcriptomes. the pipeline evaluates several probe properties in multiple steps and dynamically selects the best probe candidates from fixed size selection windows that are tiled along the target genome in both forward and reverse-complement directions. the pipeline is capable of designing a probe set with an exact number of non-redundant probe sequences to utilize every probe spot that can be printed on a microarray. this is achieved in two iterations of probe selection - sequential and gap-filling. due to the high computational power needed for the extensive calculation of probe qualities, the pipeline was not designed to be executed on personal computers. free services for academic researchers are available upon request and custom tiling probe sets can be designed with the computer cluster in our laboratory.

we have successfully designed genomic tiling arrays using this pipeline, e.g. to study the transcriptome of the oral pathogen porphyromonas gingivalis. preliminary transcriptome data can be viewed at our project web site  <cit> .

availability and requirements
project name: dynamic probe selection for studying microbial transcriptome with high-density genomic tiling microarrays

project home page: http://bioinformatics.forsyth.org/mtd

operating system: web-based application based on linux os

programming language: perl

other requirements: none

license: gnu gpl

any restrictions to use by non-academics: fee-based service

authors' contributions
hh and tc contributed equally to all parts of this project. both authors have read and approved the final manuscript.

