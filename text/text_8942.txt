BACKGROUND
gene expression microarray  <cit>  and other multiplex data  contain a wealth of information, and thereby hold promise for addressing the challenge of cellular complexity and deriving advances in medical sciences  <cit> . considering the volume of the data and the complexity of the phenomena to be understood, it is evident that the interpretation of such multiplex data must be facilitated by automation. recently we proposed an approach to the analysis of multiplex bioanalytical data based on the integration of these data with cell modeling through information theory  <cit> . here we show how this approach can be extended to the analysis of gene expression microarray time series data.

kinetic cell models have been used for predicting cell behavior  <cit> . unfortunately there is a lack of information about many of the rate and equilibrium constants for the reaction and transport processes involved  <cit> . furthermore, we are presented with the challenge of calibrating and using an incomplete model since key aspects of biochemical networks have yet to be resolved. in contrast, gene expression microarray, protein spectroscopy, nmr, chip-on-chip and other multiplex data acquisition techniques yield many simultaneous measurements but they are often only indirectly related to the quantities we seek such as protein and mrna production and degradation rate coefficients, and tf/gene binding constants, and the stoichiometry of posttranslational processes.

time series experiments commonly involve monitoring a sample of cells over their cycle or during response to time-varying conditions in the extra-cellular medium such as due to heat shock, transitions to aerobic to anaerobic conditions, from enriched to minimal growth media, or exposure to hormones or drugs. other dynamical phenomena of interest involve behaviors in response to nuclear transplantation, fertilization or viral infection, as well as the time course of normal development, radiation, transitions to abnormality or drug resistance. predicting these phenomena, and analyzing of time series data on them can be facilitated using kinetic approaches if the associated dynamic variability is to be explored. in contrast, steady-state approaches can only yield ratios of rate coefficients and not all coefficients independently. nor can a steady-state approach capture autonomous oscillatory dynamics such as observed during transcription  <cit> .

to quantitatively understand the cell, we must account for the omnipresent uncertainty in observed data and in the structure of a cell model. thus, a probabilistic framework is needed. we suggest that the probability of interest is a function of the rate parameters and initial concentrations and a functional of the time course of the frontier variables for which we do not know the governing equations or experimental measurements. since we know the time course of gene expression microarray data, in principle, some of the rate parameters, equilibrium constants, initial concentrations as well as the time profile of the frontier variables are more likely to be consistent with it than others. a new approach to the construction and quantification of trns is presented here that integrates gene expression microarray time series data and cell modeling through information theory. given a partial trn and time series data, a probability density is constructed that is a functional of the time course of tf thermodynamic activities at the site of gene control, and is a function of mrna degradation and transcription rate coefficients, and equilibrium constants for tf/gene binding.

in attempt to reduce the effect of measurement errors, gene expression microarray data is usually preprocessed via image analysis, statistical approaches and channel normalization before any biochemically viable information is derived  <cit> . a number of methods have been proposed for extracting information and overcoming systematic errors from gene expression microarray data after preprocessing it. among them are boolean network models  <cit> , bayesian network models  <cit> , bayesian statistics  <cit> , cluster analysis  <cit> , independent component analysis   <cit> , principal component analysis   <cit>  and network component analysis   <cit> . these techniques are based on the assumption that the system is at steady-state.

the goal of boolean model analysis is to infer gene regulatory network structure. however, boolean network models oversimplify gene expression by using a binary approximation wherein genes are considered either active or inactive. the interaction between genes is then represented by boolean functions , and hence the state of a gene  is calculated using the state of the controlling genes. a regulatory network is then constructed by searching all possible boolean functions until a network that best fits all the data is obtained. while such approaches miss the subtler variation in the degree of gene activity, their computational efficiency allows them to be applied to large networks.

in bayesian networks, the expression level of every gene is specified by a random variable. starting form an a priori gene regulatory network, gene expression data and using bayesian statistics, one can construct the conditional probability of the level of expression for each gene given the expression level of another gene that is assumed to regulate it. this conditional probability is then used to build a bayesian network by keeping all edges  that have a conditional probability higher than a threshold.

cluster analysis, bayesian statistics, ica and pca classify genes into groups; genes that have similar expression profiles are assumed to be similarly regulated or share the same biochemical functionality. however, they cannot uniquely predict the trn as they do not address the role of tfs mediating gene-gene interactions or the effect of external factors . cluster analysis is based on statistical techniques wherein correlations are sought between the responses of genes. however, the coordination can be extremely complex and circuitous. thus genes may be part of a multi-branch feedback loop involving several tfs made or activated/deactivated by proteins translated from other genes via a series of kinetic steps that can introduce time delays which can easily mask some interactions or introduce spurious ones. such effects are even more pronounced in light of noise in the observed expression profiles. furthermore, for a given gene, there is no established correlation between mrna expression and the level of protein it translates  <cit> . these time-delayed, complex relationships are revealed by our method which explicitly accounts for the role and time course of the tfs.

nca differs from other techniques in that the structure of the trn is assumed to be known. a number of assumptions are made in nca to arrive at the final steady-state model. the approach presented here requires at least a part of the trn. however, we place no restrictions on the structure of this network, use a kinetic model, construct synthetic gene expression microarray time series, apply a physically motivated regularization constraint for the time-dependence of tf activities that enhances robustness, places the entire computation in an information theory context so that the uncertainty can be assessed, and then analyzes trn structure and the associated physicochemical parameters. the latter include mrna production and degradation rates and tf/gene binding constants. the use of a kinetic model also allows us to generalize our approach to proteomic and metabolic data either by themselves or with gene expression microarray data.

our method is significantly different from the approach proposed by gardener et al.  <cit>  whose objective is to construct the gene control network using gene expression microarray data and limiting the number of interactions per gene. however, even when there are just a few interactions per gene, there can be thousands of networks that can explain the same gene expression microarray data with a given accuracy. a variety of other methods has been also proposed for trn construction and augmentation; these include gene ontology, phylogenetic profiles  <cit>  and promoter sequence analysis  <cit> . the methodology presented here is meant to compliment other approaches and act as a filter for spurious networks by contrasting predictions with observed expression and predicting tf time courses. the later provides an important framework for tf/gene interactions or a self-consistency check on predictions of the other methods. furthermore, as other methods suggest that there could be tf/gene interaction, our methodology compliments this by providing the specific nature  of the regulation.

in this paper, we present our approach and apply it to e. coli. our analysis is based on a simplified approach wherein only trn structure is obtained. next the resulting trn is used with the kinetic/information theory approach presented here to calibrate the physicochemical parameters and refine the network structure.

methods
schematically, our approach to the incomplete-model challenge is as follows. the state of a cell is specified by a set of variables Ψ for which we know the governing equations and a set t, which is at the frontier of our understanding . the challenge is that the dynamics of Ψ is given by a cell model, e.g.

dΨ¯dt=g¯,     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabdsgakjqbfi6azzaadaaabagaemizaqmaemidaqhaaiabg2da9iqbdeeahzaadagaeiikagiafuiqdklba0bacqggsaalcuwgubavgaqhaiabcycasiqbfu5amzaadagaeiykakiaeiilawiaaczcaiaaxmaadaqadaqaaiabigdaxagaayjkaiaawmcaaaaa@4173@

in which the rate g depends not only on many rate and equilibrium constants Λ, but also on the time-dependent frontier variables t. the descriptive variables, Ψ, can only be determined as a functional of the unknown time courses t. thus the model cannot be simulated.

gene expression microarray time series data, m, reflects the evolving state of the genome and hence one can compare it with a model predicted synthetic time series, msyn, to derive a measure of the accuracy and completeness of the model. solving eq.  <dig>  yields the time-course of Ψ over the duration of the experiment as a function of Λ, the initial state Ψ, and as a functional of t ; thus the gene expression microarray data constructed, msyn, when compared with m, yields a measure of the accuracy of t, Λ and Ψ <dig>  in the present application, Ψ represents intracellular mrna levels, Λ is the aforementioned set of rate and binding constants, and t is the time course of tf activities at the site of gene control.

to quantitatively understand the cell, we must account for the omnipresent uncertainty in observed data and in the structure of a cell model. thus, a probabilistic framework is needed. we suggest that the probability of interest  is a function of Λ and Ψ <dig> and a functional of the time course of the frontier variables t. since we know m, in principle, some Λ, t and Ψ <dig> are more likely to be consistent with it than others. we develop a model  and use time series gene expression microarray data with information theory to construct ρ.

in the present approach the physics and chemistry of the mechanisms built into a kinetic cell model puts constraints on the relationship between Ψ and t, Λ and Ψ0; this facilitates the determination of these variables from time series data. in a sense, physics and chemistry of biochemical reaction/transport processes enhance the solvability of the inverse problem for the determination of t,Λ and Ψ <dig> given the time series gene expression microarray data. since we know m, in principle, some Λ,t and Ψ <dig> are more likely to be consistent with it than others. we develop a model  and use time series gene expression microarray data with information theory to construct ρ.

a transcription model
gene expression is a multi-step process that is mainly regulated by proteins that activate or repress transcription. in prokaryotic genes, transcription initiation is controlled by promoters which are dna sequence elements recognized by rna polymerase. the activity of rna polymerase is regulated through the interaction of the dna-binding proteins known as transcription factors with short, specific dna sequences. these sequences are normally located close to the promoter of the regulated gene. dna-binding proteins alter the binding affinity of rna polymerase, consequently affecting the rna transcription rate  <cit> . it is evident that the physiological function of a dna-binding protein is driven by its binding affinity with a gene promoter or adjacent dna sequence. in particular, repressor proteins bind to the promoter site thus competing with rna polymerase for the same binding site while activator proteins usually bind adjacent to the promoter site and hence enhancing the binding affinity of rna polymerase.

in our approach, we no longer require a comprehensive cell model to make quantitative predictions even though processes within and among the genome, proteome and metabolome are all strongly coupled. rather our approach only requires an incomplete model wherein governing equations for the variables Ψ of eq.  <dig> are to be set forth and the model must contain those variables with which one may construct synthetic data of the type available. thus the following model is based on equations for mrna levels so that synthetic gene expression microarray data can be constructed. but to do so one must know the time course of tfs as they up/down regulate genes. specifically, to implement our approach the tf intra-nuclear thermodynamic activities are identified as the frontier variables t of . closure is obtained by using time series data to generate functional differential equations for the t. thus one need not make oversimplified assumptions on t to compute Ψ  are strongly coupled to t).

we first develop a forward model in which given a set of time courses of tf thermodynamic activities, t, the time course of intra-cellular mrna populations r is predicted. due to the dense environment within the nucleus, tf thermodynamic activities are preferred over concentrations. with such a model and time series gene expression microarray data, we now show how transcription rate and other parameters, the most probable t can be obtained, and the gene control network can be quantitatively characterized. finally, note that the following model is rather simple. while more complete models could be used  <cit> , our purpose here is to demonstrate the approach and not to address the supercomputer challenge of a very detailed approach.

given a trn with ntf tfs and ng genes, the i-th gene , i =  <dig> ⋯ng, is assumed to have ns
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgobgtdaqhaawcbagaem4camhabagaeiikagiaemyaakmaeiykakcaaaaa@327a@ uncompetitive tf binding sites labeled j =  <dig> ⋯ns
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgobgtdaqhaawcbagaem4camhabagaeiikagiaemyaakmaeiykakcaaaaa@327a@. assume the binding at any site is independent of the state of others and that only one type of tfs can bind to each site. while the latter two assumptions are not inherent restrictions of our approach, they are made here for simplicity. let nij label the tf that can bind to site j on gene i. let bij be minus one or plus one indicate the nature of regulation  of tf type nij on gi. at tf/gene equilibrium, the probability hi that gi is available for rna polymerase  complexing is taken to be given by an equilibrium langmuir uncompetitive adsorption isotherm  <cit> 

hi=∏j=1ns/,     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgibasdawgaawcbagaemyaakgabeaakiabg2da9maalyaabawaaebcaeaadaqadaqaaiabdgfarnaabaaaleaacqwgpbqacqwgqbgaaeqaaogaemivaq1aasbaasqaaiabd6gaunaabaaameaacqwgpbqacqwgqbgaaeqaaawcbeaaaogaayjkaiaawmcaamaacaaaleqabawaaewaaeaadawcaaqaaiabigdaxiabgucariabdkgainaabaaameaacqwgpbqacqwgqbgaaeqaaawcbagaegomaidaaagaayjkaiaawmcaaaaaaeaacqwgqbgacqgh9aqpcqaixaqmaeaacqwgobgtdaqhaaadbagaem4camhabagaeiikagiaemyaakmaeiykakcaaaqdcqghpis1aagcbawaaewaaeaacqaixaqmcqghrawkcqwgrbqudawgaawcbagaemyaakmaemoaaogabeaakiabdsfaunaabaaaleaacqwgubgbdawgaaadbagaemyaakmaemoaaogabeaaasqabaaakiaawicacaglpaaaaagaeiilawiaaczcaiaaxmaadaqadaqaaiabikdayagaayjkaiaawmcaaaaa@61b8@

for binding constant qij  and intra-nuclear activity tnij
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgubavdawgaawcbagaemoba42aasbaawqaaiabdmgapjabdqgaqbqabaaaleqaaaaa@325e@ of the nij-th tf. the rate of rna transcription initiation is written

ki=kimax⁡hi,     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgrbwadawgaawcbagaemyaakgabeaakiabg2da9iabdugarnaadaaaleaacqwgpbqaaeaacyggtbqbcqgghbqycqgg4baeaagccqwgibasdawgaawcbagaemyaakgabeaakmaabmaabagafmyuaelba0hba0bacqggsaalcuwgibgygaqhgaqhaiabcycasiqbdsfauzaadaaacagloagaayzkaagaeiilawiaaczcaiaaxmaadaqadaqaaiabiodazagaayjkaiaawmcaaaaa@46a8@

where kimax⁡
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgrbwadaqhaawcbagaemyaakgabagagiyba0maeiyyaemaeiieaghaaaaa@33b9@ is a saturation rate coefficient that we suggest is diffusion-limited. this assumption is reasonable because it take into account that on one hand, for tf/dna and rp/dna binding, electrostatic interactions tend to lead to higher limiting rate coefficient than the diffusion limited one. on the other hand, the need for having a specific orientation in order for a tf or rp to bind to the dna tends to lower the limiting rate coefficient than the diffusion limited one  <cit> . the two aforementioned processes in addition to electrostatic screening due to presence of salt in vivo are assumed to balance each other. after rp binds to a gene mrna elongation commences. if nucleotide concentrations are roughly steady during transcription and the rp advancement velocity ui , then the transcription polymerization rate ai is taken to be

1ai=1ki+nnuciui.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabigdaxaqaaiabdgeabnaabaaaleaacqwgpbqaaeqaaaaakiabg2da9maalaaabagaegymaedabagaem4aas2aasbaasqaaiabdmgapbqabagccqggbbwwcqwgsbgucqwgqbaucqggdbqxaagaey4kasyaasaaaeaacqwgobgtdaqhaawcbagaemoba4maemydaunaem4yamgabagaemyaakgaaagcbagaemydau3aasbaasqaaiabdmgapbqabaaaaogaeiola4iaaczcaiaaxmaadaqadaqaaiabisda0agaayjkaiaawmcaaaaa@498f@

a form which captures the rate limiting step of the two serial processes . with this, the governing equation for the mrna populations is written as

dridt=ai−λiri,     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabdsgakjabdkfasnaabaaaleaacqwgpbqaaeqaaagcbagaemizaqmaemidaqhaaiabg2da9iabdgeabnaabaaaleaacqwgpbqaaeqaaogaeyoei0cccigae83udw2aasbaasqaaiabdmgapbqabagccqwgsbgudawgaawcbagaemyaakgabeaakiabcycasiaaxmaacawljawaaewaaeaacqai1aqnaiaawicacaglpaaaaaa@42cb@

where nnuci
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgobgtdaqhaawcbagaemoba4maemydaunaem4yamgabagaemyaakgaaaaa@3380@ is the total length of the gene gi, and λi is the decay constant. however, for a more detailed model, mrna degradation could depend on mrna protein binding factors as well as the level of some hormones or metabolites such as iron  <cit> . if the rate limiting step for transcription is rna polymerase binding to the gene  <cit> , then the second term in eq.  <dig> may be dropped. finally,  is the activity of free rna polymerase and is assumed to be constant and henceforth is subsumed in kimax⁡
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgrbwadaqhaawcbagaemyaakgabagagiyba0maeiyyaemaeiieaghaaaaa@33b9@. the governing equation for mrna levels evolution becomes

dridt=kimax⁡hi−λiri.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabdsgakjabdkfasnaabaaaleaacqwgpbqaaeqaaagcbagaemizaqmaemidaqhaaiabg2da9iabdugarnaadaaaleaacqwgpbqaaeaacyggtbqbcqgghbqycqgg4baeaagccqwgibasdawgaawcbagaemyaakgabeaakmaabmaabagafmyuaelba0hba0bacqggsaalcuwgibgygaqhgaqhaiabcycasiqbdsfauzaadaaacagloagaayzkaagaeyoei0cccigae83udw2aasbaasqaaiabdmgapbqabagccqwgsbgudawgaawcbagaemyaakgabeaakiabc6cauiaaxmaacawljawaaewaaeaacqai2agnaiaawicacaglpaaaaaa@519a@

finally, our methodology can be generalized by relaxing any of the above assumptions. for example, hi, can be changed such that competitive binding and tf complexing are accounted for explicitly which in effect will allow for or logic. although the extension of our transcription model to include competitive binding is crucial to accurately recover tf activity time courses, this level of description is out of the scope of this study. further research is needed to obtain specific data on the molecular level about which tf binds to which binding site of a given gene.

information theory model/data integration
general formulation
gene expression microarray data is fraught with inaccuracies. much attention has been placed on minimizing systematic and random errors via quality screening, multi-spot/multi-slide analysis and averaging. software carrying out these functions yields confidence intervals which are quantitative measures of errors in the experimental data. information theory was introduced as a method for assessing the uncertainty in the state of a system via an entropy measure  <cit> . in a series of papers  <cit> , we have shown how information theory can be used to calibrate model parameters, use an incomplete model and estimate the associated uncertainties based on the inaccuracies in the observed data and the model used. the probability density ρ for the values of the set Λ of model parameters and the time-dependence of t  is obtained through entropy maximization.

the development starts with the introduction of the entropy s,

s=−sΛ¯,t¯ρln⁡ρ,     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaacqwgtbwucqgh9aqpcqghsisldawfqaqaagwabiab=jr8tbwcbagafu4mdwkba0bacqggsaalcuwgubavgaqhaaqabaaccigccqgfbpgccyggsbabcqggubgbcqgfbpgccqggsaalcawljagaaczcamaabmaabagaeg4nacdacagloagaayzkaaaaaa@4a68@

where s
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaaimqacqwfse=uaaa@3846@ is an integration over all Λ and a functional integration over all time courses t is indicated. the experimental data and model are introduced via a set of error measures labeled l =  <dig> ,..., each of whose average e¯l
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgfbqrgaqeamaacaaaleqabagaemibawgaaaaa@2f65@ is assumed known and are given in terms of ρ via

sΛ¯,t¯ρel=e¯l.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaadawfqaqaagwabiab=jr8tbwcbagafu4mdwkba0bacqggsaalcuwgubavgaqhaaqabaaccigccqgfbpgccqwgfbqrdaahaawcbeqaaiabdygasbaakiabg2da9iqbdweafzaarawaawbaasqabeaacqwgsbabaagccqgguaglcawljagaaczcamaabmaabagaegioagdacagloagaayzkaaaaaa@4940@

for cdna microarray data, e¯cdna
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgfbqrgaqeamaacaaaleqabagaem4yammaemiraqkaemota4kaemyqaeeaaaaa@3294@ can be estimated from confidence intervals provided by statistical data analysis. according to the information theory prescription we construct ρ,Λ) by maximizing s subject to the constraints , normalization of ρ, qualitative information on the timescale over which t can evolve, and other factors reflecting one's expertise. the result is a form for ρ which implies that the Λ, t which are most probable yield the lowest error. also the t obtained has no time dependence that is unphysically short. other constraints could be introduced that allow one to assign higher probability to the range of parameter values Λ that are near those one expects from experience. given the inherently subjective nature of probability  are equally likely), the information theory prescription yields a ρ that is to be consistent with the level of our knowledge of the system. in our procedure, the resulting ρ is then maximized with respect to Λ and t to determine their most probable values. cell parameters that must be calibrated to attain a predictive model using our approach are those introduced in the previous section.

implementation for cdna microarray data
our analysis starts with preprocessed data, thus the predictions of our method as other genome wide microarray analysis methods depend on the choice of the preprocessing procedure . analysis of preprocessed microarray data can be placed in our framework by introducing an associated error ecdna. let miℓ be the microarray expression level for the i-th of ng genes in the ℓ-th of nmicro experiments . then

ecdna=∑ℓ=1nmicro∑i=1ng <dig>      
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgfbqrdaahaawcbeqaaiabdogajjabdseaejabd6eaojabdgeabbaakiabg2da9maaqahabawaaabcaeaadaqadaqaaigbcygasjabc6gaujabd2gatnaadaaaleaacqwgpbqacqwitecbaeaacqwgzbwccqwg5bqecqwgubgbaagccqghsislcyggsbabcqggubgbcqwgtbqbdaqhaawcbagaemyaakmaes4ehwgabagaem4ba8maemoyaimaem4camhaaagccagloagaayzkaawaawbaasqabeaacqaiyagmaaaabagaemyaakmaeyypa0jaegymaedabagaemota40aasbaawqaaiabdeganbqabaaaniabgghildaaleaacqwitecbcqgh9aqpcqaixaqmaeaacqwgobgtdawgaaadbagaemyba0maemyaakmaem4yammaemocainaem4ba8gabeaaa0gaeyyeiuoakiabcycasiaaxmaacawljawaaewaaeaacqai5aqoaiaawicacaglpaaaaaa@67ef@

where miℓ = miℓ/mia with a being the initial time or the standard condition. here, miℓsyn
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgtbqbdaqhaawcbagaemyaakmaes4ehwgabagaem4camnaemyeaknaemoba4gaaaaa@3517@ is the synthetic microarray data constructed from mrna levels predicted from a cell model , while obs indicates an observed value. thus ecdna is a function of the set of model parameters Λ as contained in a cell model . similarly ecdna is a functional of the time course t of intra-nuclear tf activities. following the above information theory formulation we introduce the probability ρ = ρ , Λ), a functional of the time course t and a function of Λ. we construct ρ by maximizing the entropy subject to estimates of the average error measures  and other information.

the number of time points is restricted due to cost. this fact and the high level of uncertainty in microarray data suggest that the probability functional method cannot yield a meaningful t unless more information is known. in our formulation this is introduced via a homogenization constraint that eliminates unphysically short timescale variations in t that the sparseness of the time series data would otherwise allow. in particular, we impose the constraint

sΛ¯,t¯ρ∫0tf2dt=tf/q¯2tc <dig>      
mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbamrthrhal1wy0l2yhvtyaehbnfgdovwbhrxajfwnaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabawaaegaeaaakeaadawfqaqaagwabiab=jr8tbwcbagafu4mdwkba0bacqggsaalcuwgubavgaqhaaqabaaccigccqgfbpgcdawdxbqaamaabmaabawaasaaaeaacqwgkbazcqwgubavdawgaawcbagaemoba4gabeaaaoqaaiabdsgakjabdsha0baaaiaawicacaglpaaadaahaawcbeqaaiabikdayaaaaeaacqaiwaamaeaacqwg0baddawgaaadbagaemozaygabeaaa0gaey4kiipakmaalyaabagaemizaqmaemidaqnaeyypa0jaemidaq3aasbaasqaaiabdagambqabaaakeaacuwgrbqugaqeamaacaaaleqabagaegomaidaaogaemidaq3aa0baasqaaiabdogajbqaaiabikdayaaaaagccqggsaalcawljagaaczcamaabmaabagaegymaejaegimaadacagloagaayzkaaaaaa@60b7@

for a time series run over the interval from  <dig> to tf;tc is the shortest characteristic time over which we expect that t can change appreciably and we assume q¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgrbqugaqeaaaa@2def@  is the inverse of the typical variation of t.

one can also use a steady-state approximation for information available about post-translational reactions to further constrain s. if a subnetwork of genes with stoichiometric matrix of processes dn is responsible for the production of tn, then the associated error measure for these processes is

etf=∑n=1ntf∑k=1ntimes−αn∏j=1znmdnjobs) <dig>      
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgfbqrdaahaawcbeqaaiabdsfaujabdaeagbaakiabg2da9maaqahabawaaabcaeaadaqadaqaaiabdsfaunaabaaaleaacqwgubgbaeqaaowaaewaaeaacqwg0baddawgaawcbagaem4aasgabeaaaogaayjkaiaawmcaaiabgkhitggaciab=f7ahnaabaaaleaacqwgubgbaeqaaowaaebcaeaacqwgtbqbdaqhaawcbagaemizaq2aasbaawqaaiabd6gaujabdqgaqbqabaaaleaacqwgvbwbcqwgibgycqwgzbwcaagcdaqadaqaaiabdsha0naabaaaleaacqwgrbwaaeqaaagccagloagaayzkaaaaleaacqwgqbgacqgh9aqpcqaixaqmaeaacqwg6bgedawgaaadbagaemoba4gabeaaa0gaey4diunaaogaayjkaiaawmcaamaacaaaleqabagaegomaidaaaqaaiabdugarjabg2da9iabigdaxaqaaiabd6eaonaabaaameaacqwg0badcqwgpbqacqwgtbqbcqwglbqzcqwgzbwcaeqaaaqdcqghris5aawcbagaemoba4maeyypa0jaegymaedabagaemota40aasbaawqaaiabdsfaujabdaeagbqabaaaniabgghildgccqggsaalcawljagaaczcamaabmaabagaegymaejaegymaedacagloagaayzkaaaaaa@7342@

where ntimes is the number of discretized times at which the tf activity is computed, zn is the number of genes involved in the production of tn, and αn is an equilibrium constant. mdnjobs
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgtbqbdaqhaawcbagaemizaq2aasbaawqaaiabd6gaujabdqgaqbqabaaaleaacqwgvbwbcqwgibgycqwgzbwcaaaaaa@36aa@ is the observed microarray for the j-th gene responsible for the creation of the n-th tf.

maximization of the entropy with respect to ρ gives

ln⁡ρ=ln⁡Ξ−β1ecdna−β2etf−ω∑n=1ntf∫0tfdt <dig>      
mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacyggsbabcqggubgbiigacqwfbpgccqgh9aqpcyggsbabcqggubgbcqqheoawcqghsislcqwfyogydawgaawcbagaegymaedabeaakiabdweafnaacaaaleqabagaem4yammaemiraqkaemota4kaemyqaeeaaogaeyoei0iae8nsdi2aasbaasqaaiabikdayaqabagccqwgfbqrdaahaawcbeqaaiabdsfaujabdaeagbaakiabgkhitiab=l8a3naaqahabawaa8qcaeaacqwgkbazcqwg0badasqaaiabicdawaqaaiabdsha0naabaaameaacqwgmbgzaeqaaaqdcqghrii8aawcbagaemoba4maeyypa0jaegymaedabagaemota40aasbaawqaaiabdsfaujabdaeagbqabaaaniabgghildgcdaqadaqaamaalaaabagaemizaqmaemivaq1aasbaasqaaiabd6gaubqabaaakeaacqwgkbazcqwg0badaaaacagloagaayzkaawaawbaasqabeaacqaiyagmaagccqggsaalcawljagaaczcamaabmaabagaegymaejaegomaidacagloagaayzkaaaaaa@6b83@

where Ξ is a normalization constant and β <dig>  β <dig>  ω are lagrange multipliers. the multipliers are determined by insuring that the constraints are satisfied. with this the most probable values of Λ, t, given the microarray data, are obtained by solving ∂ρ/∂Λ =  <dig> coupled to δρ/δ t=  <dig>  a functional differential equation for t that we solve numerically . a discussion of a symmetry rule that applies to the invertibility of microarray data is given in appendix b and implies the need for a minimal amount of regulatory information in order to obtain a unique network. figure  <dig> illustrates our approach where microarray and a priori trn is used to infer tf activity time courses and tf/gene binding constants.

RESULTS
synthetic example
to test our implementation of the approach described above, and to find its practical limitations, we used a model network that consists of  <dig> genes and  <dig> tfs. none of the  <dig> genes is assumed to code for any of the  <dig> tfs. the trn is shown in table  <dig> where ±  <dig> implies up/down regulation. we took all binding constants and initial mrna concentrations to be unity and 10- <dig> m, respectively.

columns indicate the tfs whereas the rows indicate the genes that they affect 

we generated tf time courses according to the following

tn =  <dig> -  <dig> sin,     

where υn, ϕn are randomly chosen period and phases. then we created the synthetic time series microarray data using our transcription model, selecting  <dig> "data points" that are  <dig> seconds apart. in the following, we demonstrate the robustness of our approach in reconstructing t despite mistakes in the regulatory network and noise in the microarray data, conditions commonly encountered in practice.

uncertain regulatory network information
promoter sequence analysis can be used to determine the structure of the trn based on likely binding sites. however, this approach is likely to suggest a large number of false positive interactions in the trn. it is of interest to test whether our approach can filter the redundant nonzero entries in the control network. in our approach, if a tf is assumed to upregulate a gene, large binding constants, i.e. qt >>  <dig>  imply that this interaction is unlikely  as qt/ ≈  <dig>  a similar argument hold for wrongly assumed down regulation as indicated by small binding constants  ≈ 1). therefore, our methodology filters out incorrect interactions by assigning large/small binding constants for up/down regulation. to check the vulnerability of our approach to such redundant interactions, we added random nonzero factors in the regulatory network, and obtained the "conjectured full regulatory network" as shown in table  <dig>  as this network is full , the nca method fails. in our approach, the match between the predicted and know tf time courses is remarkable even when the "conjectured" full network was used. figure  <dig> illustrates the effect of the number of redundant interactions on the mismatch between the predicted and actual tf time courses. the mismatch  does not exceed  <dig> even when the full interaction network is used as a starting point. thus, our approach effectively filters the gene control network of unnecessary interactions.

in the original matrix, there are  <dig> nonzero elements whereas in the augmented full matrix there are  <dig> nonzero elements. the challenge is to identify the actual operating trn.

robustness to microarray error levels
despite advances in the technology, microarray data has considerable levels of error. there have been few systematic analyses of microarray accuracy due to the many technology platforms available. these platforms have many technological variations which affect the accuracy and reproducibility of the measured expression levels of genes. such variations are due to multiple techniques of making labeled material, various hybridization conditions, different microarray scanners and settings, etc  <cit> . other factors that affect reproducibility of microarray experiments are variations in physiological conditions as well as the number of measurements made to improve the signal to noise ratio. yeu et al.  <cit>  estimated the coefficient of variation for non differentially expressed genes to be 12%–14%, and up to 25% for differentially expressed genes across the entire signal range using  <dig> element e. coli cdna microarray. yuen et al.  <cit>  reported a median coefficient of variation of  <dig> % when they used cdna triplicate measurements of  <dig> genes of e. coli. novak et al. carried out an extensive study of affymetrix gene chip oligonucleotide arrays using either identical rna samples or rna from replicate cultures under similar biological conditions  <cit> . they reported an overall coefficient of variation of  <dig> % for  <dig> genes of the imr <dig> human cell line when they used  <dig> measurements on the same mrna mixture sample. however, the overall coefficient of variation was  <dig> % when they used  <dig> measurement of mrna obtained from replicate cultures.

in our implementation, we input raw microarray channel data, perform standard channel normalization . the resulting confidence intervals constitute prior information about the level of noise in the microarray response. in this test, we investigate the vulnerability of our approach to error in microarray data. we added random noise to the synthetic microarray data that was obtained using the assumed tf time courses, and the transcription regulatory network  as follows

miobs
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgtbqbdaqhaawcbagaemyaakgabagaem4ba8maemoyaimaem4camhaaaaa@33ba@  = mi × ),     

where r is a random number between  <dig> and  <dig>  noise ×100% represents the coefficient of variation or the percentage noise level in the microarray data. figure  <dig> shows the mismatch  as a function of added noise level with and without the regularization constraint . the regularization constraint yields a better match at noise levels higher than 30%, providing robustness to the solution of the inverse problem when noisy data is used. more generally, the lagrange multiplier for the regularization constraint, eq.  <dig>  should decrease with the width of the confidence interval. it should be noted that these results were obtained with a fixed lagrange multiplier for the regularization constraint. if error level is believed to be very small, a smaller lagrange multiplier should be used. we believe that error levels 30% and higher are to be expected in expression data, in particular for low concentration rnas. this example also illustrates one of the advantages of time series over steady-state data in that the former is less vulnerable to noise due to the use of our regularization constraint.

healing mistakes in a proposed regulatory network
often we rely on tf-gene interactions obtained from questionable quality resources. therefore, it is important that our algorithm is robust to potential sign mistakes in the trn due to regulatory differences between the cell line of interest and that for which the network was constructed. in this case, we run our code in a discovery mode that searches for network mistakes. we first rank genes based on the mismatch between the predicted and observed microarray response, highest ranked having the greatest mismatch. then, we rank the tfs based on the rank and number of genes that they regulate. as calculation progresses, we periodically check the genes whose mismatch is greater than eaverage + aσ where eaverage is the average mismatch and σ is the standard deviation of gene mismatch and a is an empirical parameter. once the genes satisfying this criterion are identified, we change the sign of the regulatory interaction for each of the highest ranked tf . we also consider additional input that the user provides regarding confidence in each element of the trn. at a given step in this process, we only change one sign per column of the trn. after a few iterations, we monitor the mismatch behavior; if the sign change failed to improve the mismatch, we change the sign back. to test this algorithm, we took the trn of table  <dig> and introduced four mistakes by changing the sign of the diagonal elements of genes 1– <dig>  our algorithm successfully corrected the network after only  <dig> iterations. figure  <dig> shows the predicted and observed microarray data. the triangle markers represent the best fit to the microarray data when the trn with four mistakes is assumed, whereas the square markers represent the best fit after our algorithm corrected the mistakes. this demonstrates another aspect of our methodology, correcting a user-supplied trn via microarray data. for large, real systems, we believe that many iterations will be necessary to arrive at an accurate network. the methodology will recommend changes in the trn based on the microarray data and a user-suggested network. the rankings supplied with the improved network can be used to guide literature searches or carry out sequence analysis that can be used to further refine the network.

application to e. coli
to test our methodology we used the e. coli microarray data obtained for carbon source transition from glucose to acetate media. details on the experimental conditions and the microarray procedure are provided in ref.  <cit> . the data included expression levels  of  <dig> genes at  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig> and  <dig> seconds. the trn used is based on regulondb <cit>  as modified by kao et al. . we made additional changes based on ecocyc  <cit> . the final transcriptional regulatory network used is shown in table  <dig>  figure  <dig> shows the time courses of  <dig> representative tf activities . kao et al.  applied nca to the same problem. however, the biologically relevant regulatory network that consists of  <dig> genes and  <dig> tfs does not satisfy the nca column rank requirement. furthermore, the transcription kinetics in our approach differs from the seady-state assumption and binding formulation used in nca. despite these differences,  <dig> out of  <dig> tf activity time courses  are in qualitative agreement. as shown in figure  <dig>  phob increases as a result of response to acetate enrichment of the medium in contrast to the decreasing activity predicted by nca. therefore one would expect the phob activity to increase as well. as a verification of our results, consider the arca gene which makes arca tf that upregulates arca itself. one would expect a correlation between the expression of arca and tf activity of arca. to have an unbiased test, we took the expression of arca from the microarray data and calculated the time course of arca activity based on the other  <dig> genes in the network that it regulates. the resultant arca time course was indistinguishable from the one obtained by including arca in the microarray expression data. a comparison of predicted arca activity  and expression of arca figure  <dig> shows a similar trend. figure  <dig> also shows a comparison between the predicted and observed microarray expression data for nuoj, nuoa, arca, livk, ppsa, pykf, pstc and psts. in a second study, we added up to 30% noise to the e. coli. microarray data, our approach is still found to be robust.

+ indicates up-regulation

 – indicates down-regulation

brown and callan  <cit>  have predicted many binding sites for the two tf crp and arca. among the genes included in our model, they predicted that two genes  in our data set to be regulated by arca. also they predicted that two genes sera, cyoa and arop are predicted to be regulated by crp. to further examine the consistency of our approach with promoter sequence analysis, we performed another simulation after adding these interactions to the trn obtained form ecocyc and assuming the nature of these interactions  to be unknown. figure  <dig> shows improvements in the results obtained for xtha, livj and sera. our algorithm predicts that xtha and livj are down regulated by arca. it also predicts that sera and cyoa are down regulated by crp. however, no improvement is observed for arop .

regularization is important for discriminating between noise/data sparsity-related spurious oscillations and that arising from the nonlinear dynamics of transcription chemical kinetics  <cit> . to demonstrate the effect of regularization, we added 25% noise the observed microarray data. figure  <dig>  as an illustration, shows that arca microarray response exhibit oscillatory behavior when no regularization constraint is used. these oscillations are not physical, but rather it is an artifact of using sparse noisy data.

trn discovery and limitations
a number of issues must be addressed in developing a trn discovery strategy as follows. discovering the structure and quantifying the physical chemistry of the gene regulatory network and the underlying mechanism has the challenges that arise in any chemical kinetics problem. for example, the simple process a+b+c→abc can occur through the mechanism a+b→ab, ab+c→abc or the other two permutations; to identify the actual mechanism, one must provide intermediate measurements on the dimers ab, bc and ca, rather than simply a measurement of the net rate of abc production. clearly, in a system with thousands of participating genes and hundreds of tfs, the resolution of the network and the detection of spurious ones, is a grand challenge of combinatorial magnitude. essentially, all present network discovery methods suffer from this uniqueness difficulty due to the sparsity of available information. in this paper, we demonstrate how our method provides a way to augment an incomplete trn and to identify inconsistencies in a proposed network based on microarray data.

processes such as acetylation, methylation and phosphorylation, and the associated enzymes, play important roles in the wider set of pathways  <cit> . thus the paradigm genes→ mrnas→ proteins → tfs → genes .... is an oversimplification. while these processes could readily be added to our formulation, it is clear that data in addition to gene expression microarray observations would be required to resolve them. thus we take the perspective that the simple paradigm cited above can be adopted as a starting point if it is recognized that other processes are somehow mediating the network we quantify. for example, if some genes are repressed in one mammalian cell line by methylation this will be reflected as a small transcriptional rate constant our approach reveals. when predicted levels for a given gene expression are found to be in poor agreement with observations and assuming that the probability that other tfs could be regulating that gene has already been explored, we consider this to imply that the simple paradigm has broken down and the other processes must be acting in a dynamical way to affect the gene expression time series. in light of the above, it is evident that network structure, physicochemical parameters and tf activity time courses can not all be extracted from a single approach.

CONCLUSIONS
multiplex time series data  holds a great promise for the construction of the network of cellular processes and the calibration of the many associated physical chemical parameters. we have demonstrated these concepts in the context of transcription regulation understood through the analysis of microarray time series data. casting the approach in a probabilistic framework has allowed us to address the uncertainties in microarray data. our approach was found to be robust to error in the microarray data and mistakes in a proposed regulatory network. our approach compliments other methods  when used as a part of a wider network discovery/quantification algorithm. given its robustness, its capacity to refine and quantify complex networks of cellular processes, and the potential for extension to other multiplex bioanalytical data, we believe that our approach has great potential in the pure and applied life sciences.

availability and requirements
project name: karyote gene analyzer 

project home page: 

operating system: windows  or linux

programming languages: f <dig>  php

licence: a web interface that allows users to simulate their own data is available from the above site .

restrictions to non-academics: none

authors' contributions
as, kt and pjo formulated the problem; and developed the theoretical model framework. as and kt carried out the development, and implementation of the numerical algorithms. all authors participated in the writing of the manuscript, and have read and approved the manuscript.

appendices
a. numerical methods
the numerical methods used for simulating time evolution of mrna populations, solving the calibration inverse problem by determining of tf time courses and model parameters are as follows. the latter parameters are sets of tf binding constants q¯¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgrbqugaqhgaqhaaaa@2e1e@ and saturation limiting transcription rate coefficients kmax and mrna degradation rate constants λ.

fast and accurate solution of the ode model is crucial to construct thousands of gene expression levels to find the optimum model parameters in a practical time. for the i-th gene, mrna population, ri, time evolution is computed using an implicit euler method

ri=ri+Δtn+1ki1+λi.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgsbgudawgaawcbagaemyaakgabeaakmaabmaabagaemidaq3aasbaasqaaiabd6gaujabgucariabigdaxaqabaaakiaawicacaglpaaacqgh9aqpdawcaaqaaiabdkfasnaabaaaleaacqwgpbqaaeqaaowaaewaaeaacqwg0baddawgaawcbagaemoba4gabeaaaogaayjkaiaawmcaaiabgucariabfs5aejabdsha0naabaaaleaacqwgubgbcqghrawkcqaixaqmaeqaaogaem4aas2aasbaasqaaiabdmgapbqabagcdaqadaqaaiabdsha0naabaaaleaacqwgubgbaeqaaagccagloagaayzkaaaabagaegymaejaey4kascccigae83udw2aasbaasqaaiabdmgapbqabaaaaogaeiola4iaaczcaiaaxmaadaqadaqaaiabbgeabjabc6cauiabigdaxagaayjkaiaawmcaaaaa@5891@

the time step Δtn+ <dig> used is adaptive and depends on the maximum component of the rate vector k. the microarray expression level at a given experimental time is predicted as the relative abundance of mrna populations to their reference state at initial time

miℓ=mi=riri,ℓ= <dig> ⋯nmicro.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqabeqacaaabagaemyba02aasbaasqaaiabdmgapjablorisbqabagccqgh9aqpcqwgtbqbdawgaawcbagaemyaakgabeaakmaabmaabagaemidaq3aasbaasqaaiablorisbqabaaakiaawicacaglpaaacqgh9aqpdawcaaqaaiabdkfasnaabaaaleaacqwgpbqaaeqaaowaaewaaeaacqwg0baddawgaawcbagaes4ehwgabeaaaogaayjkaiaawmcaaaqaaiabdkfasnaabaaaleaacqwgpbqaaeqaaowaaewaaeaacqwg0baddawgaawcbagaegimaadabeaaaogaayjkaiaawmcaaaaacqggsaalaeaacqwitecbcqgh9aqpcqaixaqmcqggsaalcqwivlctcqwgobgtdawgaawcbagaemyba0maemyaakmaem4yammaemocainaem4ba8gabeaaaagccqgguaglcawljawaaewaaeaacqqgbbqqcqgguaglcqaiyagmaiaawicacaglpaaaaaa@5d49@

in solving ∂ρ/∂Λ =  <dig>  a gradient steepest descent approach suffers from slow convergence. we overcome this via a combined steepest descent/simulated annealing approach. the key to efficiently solve the inverse problem cited above is to use an iterative alternating parameter approach. the calibration starts by minimization of the microarray error ecdna with respect to tf binding constants q¯¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgrbqugaqhgaqhaaaa@2e1e@. to reduce the computational cost, we utilize the exact solution of   <cit> ,

r0miexp⁡−r0=∫0tkiexp⁡dt′.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgsbgudawgaawcbagaegimaadabeaakiabd2gatnaabaaaleaacqwgpbqaaeqaaowaaewaaeaacqwg0badaiaawicacaglpaaacygglbqzcqgg4baecqggwbacdaqadaqaaggaciab=t7asnaabaaaleaacqwgpbqaaeqaaogaemidaqhacagloagaayzkaagaeyoei0iaemouai1aasbaasqaaiabicdawaqabagccqgh9aqpdawdxaqaaiabdugarnaabaaaleaacqwgpbqaaeqaaaqaaiabicdawaqaaiabdsha0bqdcqghrii8aowaaewaaeaacuwg0badgaqbaagaayjkaiaawmcaaigbcwgaljabciha4jabcchawnaabmaabagae83udw2aasbaasqaaiabdmgapbqabagccuwg0badgaqbaagaayjkaiaawmcaaiabdsgakjqbdsha0zaafagaeiola4iaaczcaiaaxmaadaqadaqaaiabbgeabjabc6cauiabiodazagaayjkaiaawmcaaaaa@61f6@

the latter establishes an integral equation for ki. solving for ki at the given experimental microarray times yields a computationally efficient algebraic approach that allows the use of a simulated annealing algorithm  <cit>  to find the optimum values for binding constants. the solution is achieved by discretizing the time profile of ki over a grid of microarray experimental times and then interpolating it as a continuous piecewise linear function,

ki=kil+1−kiltl+1−tl+kil,tl<t<tl+ <dig> l= <dig> ⋯nmicro.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqabeqadaaabagaem4aas2aasbaasqaaiabdmgapbqabagcdaqadaqaaiabdsha0bgaayjkaiaawmcaaiabg2da9maalaaabagaem4aas2aa0baasqaaiabdmgapbqaaiabdygasjabgucariabigdaxaaakiabgkhitiabdugarnaadaaaleaacqwgpbqaaeaacqwgsbabaaaakeaacqwg0baddawgaawcbagaemibawmaey4kasiaegymaedabeaakiabgkhitiabdsha0naabaaaleaacqwgsbabaeqaaaaakmaabmaabagaemidaqnaeyoei0iaemidaq3aasbaasqaaiabdygasbqabaaakiaawicacaglpaaacqghrawkcqwgrbwadaqhaawcbagaemyaakgabagaemibawgaaogaeiilawcabagaemidaq3aasbaasqaaiabdygasbqabagccqgh8aapcqwg0badcqgh8aapcqwg0baddawgaawcbagaemibawmaey4kasiaegymaedabeaakiabcycasaqaaiabdygasjabg2da9iabicdawiabcycasiabl+uimjabd6eaonaabaaaleaacqwgtbqbcqwgpbqacqwgjbwycqwgybgccqwgvbwbaeqaaaaakiabc6cauiaaxmaacawljawaaewaaeaacqqgbbqqcqgguaglcqai0aanaiaawicacaglpaaaaaa@761e@

with  we can evaluate the above integral analytically

r0milobsexp⁡−r0=∑s=0l−1−exp⁡+λiexp⁡λi2}+kis+1{exp⁡−exp⁡+λiexp⁡λi2}).     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgsbgudawgaawcbagaegimaadabeaakiabd2gatnaadaaaleaacqwgpbqacqwgsbabaeaacqwgvbwbcqwgibgycqwgzbwcaagccygglbqzcqgg4baecqggwbacdaqadaqaaggaciab=t7asnaabaaaleaacqwgpbqaaeqaaogaemidaq3aasbaasqaaiabdygasbqabaaakiaawicacaglpaaacqghsislcqwgsbgudawgaawcbagaegimaadabeaakiabg2da9maaqahabawaaewaaeaafaqaaegabaaabagaem4aas2aa0baasqaaiabdmgapbqaaiabdohazbaakmaacmqabawaasaaaeaacygglbqzcqgg4baecqggwbacdaqadaqaaiab=t7asnaabaaaleaacqwgpbqaaeqaaogaemidaq3aasbaasqaaiabdohazjabgucariabigdaxaqabaaakiaawicacaglpaaacqghsislcygglbqzcqgg4baecqggwbacdaqadaqaaiab=t7asnaabaaaleaacqwgpbqaaeqaaogaemidaq3aasbaasqaaiabdohazbqabaaakiaawicacaglpaaacqghrawkcqwf7oabdawgaawcbagaemyaakgabeaakigbcwgaljabciha4jabcchawnaabmaabagae83udw2aasbaasqaaiabdmgapbqabagccqwg0baddawgaawcbagaem4camhabeaaaogaayjkaiaawmcaamaabmaabagaemidaq3aasbaasqaaiabdohazjabgucariabigdaxaqabagccqghsislcqwg0baddawgaawcbagaem4camhabeaaaogaayjkaiaawmcaaaqaaiab=t7asnaadaaaleaacqwgpbqaaeaacqaiyagmaagcdaqadaqaaiabdsha0naabaaaleaacqwgzbwccqghrawkcqaixaqmaeqaaogaeyoei0iaemidaq3aasbaasqaaiabdohazbqabaaakiaawicacaglpaaaaaaacagl7bgaayzfaaaabagaey4kasiaem4aas2aa0baasqaaiabdmgapbqaaiabdohazjabgucariabigdaxaaakmaacmqabawaasaaaeaacygglbqzcqgg4baecqggwbacdaqadaqaaiab=t7asnaabaaaleaacqwgpbqaaeqaaogaemidaq3aasbaasqaaiabdohazbqabaaakiaawicacaglpaaacqghsislcygglbqzcqgg4baecqggwbacdaqadaqaaiab=t7asnaabaaaleaacqwgpbqaaeqaaogaemidaq3aasbaasqaaiabdohazjabgucariabigdaxaqabaaakiaawicacaglpaaacqghrawkcqwf7oabdawgaawcbagaemyaakgabeaakigbcwgaljabciha4jabcchawnaabmaabagae83udw2aasbaasqaaiabdmgapbqabagccqwg0baddawgaawcbagaem4camnaey4kasiaegymaedabeaaaogaayjkaiaawmcaamaabmaabagaemidaq3aasbaasqaaiabdohazjabgucariabigdaxaqabagccqghsislcqwg0baddawgaawcbagaem4camhabeaaaogaayjkaiaawmcaaaqaaiab=t7asnaadaaaleaacqwgpbqaaeaacqaiyagmaagcdaqadaqaaiabdsha0naabaaaleaacqwgzbwccqghrawkcqaixaqmaeqaaogaeyoei0iaemidaq3aasbaasqaaiabdohazbqabaaakiaawicacaglpaaaaaaacagl7bgaayzfaaaaaagaayjkaiaawmcaaawcbagaem4camnaeyypa0jaegimaadabagaemibawmaeyoei0iaegymaedaniabgghildgccqgguaglcawljagaaczcamaabmaabagaeeyqaekaeiola4iaegynaudacagloagaayzkaaaaaa@f317@

our lack of knowledge about the initial value of ki , gives us one less equation than the number of unknowns. the simplest way to overcome this difficulty is via a linear extrapolation between the points at t <dig> and t <dig> to the point at t <dig>  higher order extrapolations were tested and proven not to be very advantageous in this case, especially if we have frequent microarray measurements for early times. with this,

ki0=ki2−ki1t2−t1+ki <dig>      
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgrbwadaqhaawcbagaemyaakgabagaegimaadaaogaeyypa0zaasaaaeaacqwgrbwadaqhaawcbagaemyaakgabagaegomaidaaogaeyoei0iaem4aas2aa0baasqaaiabdmgapbqaaiabigdaxaaaaoqaaiabdsha0naabaaaleaacqaiyagmaeqaaogaeyoei0iaemidaq3aasbaasqaaiabigdaxaqabaaaaowaaewaaeaacqwg0baddawgaawcbagaegimaadabeaakiabgkhitiabdsha0naabaaaleaacqaixaqmaeqaaagccagloagaayzkaagaey4kasiaem4aas2aa0baasqaaiabdmgapbqaaiabigdaxaaakiabc6cauiaaxmaacawljawaaewaaeaacqqgbbqqcqgguaglcqai2agnaiaawicacaglpaaaaaa@536c@

 and  give us a linear system that can be solved for kil
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgrbwadaqhaawcbagaemyaakgabagaemibawgaaaaa@30f4@, l =  <dig> ⋯nmicro. we use the resulting kil
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgrbwadaqhaawcbagaemyaakgabagaemibawgaaaaa@30f4@ to construct a new error measure e˜
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgfbqrgaacaaaa@2dce@,

e˜i=∑l=1nmicro∑j=1ns)1+bij21+qijtnij)−ln⁡kil) <dig>      
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgfbqrgaacamaabaaaleaacqwgpbqaaeqaaogaeyypa0zaaabcaeaadaaewbqaamaabmaabagagiibawmaeioba42aaewaaeaadawcaaqaamaabmaabagaemyuae1aasbaasqaaiabdmgapjabdqgaqbqabagccqwgubavdawgaawcbagaemoba42aasbaawqaaiabdmgapjabdqgaqbqabaaaleqaaowaaewaaeaacqwg0baddawgaawcbagaemibawgabeaaaogaayjkaiaawmcaaagaayjkaiaawmcaamaacaaaleqabawaasaaaeaacqaixaqmcqghrawkcqwgibgydawgaaadbagaemyaakmaemoaaogabeaaasqaaiabikdayaaaaaaakeaacqaixaqmcqghrawkcqwgrbqudawgaawcbagaemyaakmaemoaaogabeaakiabdsfaunaabaaaleaacqwgubgbdawgaaadbagaemyaakmaemoaaogabeaaasqabagcdaqadaqaaiabdsha0naabaaaleaacqwgsbabaeqaaagccagloagaayzkaaaaaagaayjkaiaawmcaaiabgkhitigbcygasjabc6gaujabdugarnaadaaaleaacqwgpbqaaeaacqwgsbabaaaakiaawicacaglpaaadaahaawcbeqaaiabikdayaaaaeaacqwgqbgacqgh9aqpcqaixaqmaeaacqwgobgtdaqhaaadbagaem4camhabagaeiikagiaemyaakmaeiykakcaaaqdcqghris5aogaeiilawiaaczcaiaaxmaadaqadaqaaiabbgeabjabc6cauiabieda3agaayjkaiaawmcaaawcbagaemibawmaeyypa0jaegymaedabagaemota40aasbaawqaaiabd2gatjabdmgapjabdogajjabdkhayjabd+gavbqabaaaniabgghildaaaa@86a5@

where nij is the type of tf that binds to the j-th site on gene i. we find that, if the rate integral equation is accurately solved, then minimizing this error is equivalent to minimizing the microarray error. applying simulated annealing enhance the likelihood that we get as close as needed to the global minimum of e˜
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgfbqrgaacaaaa@2dce@i. when the resulting solution fails by increasing the error due to numerical instability, we switch to a steepest descent scheme.

for the tf activities we solve the discretized temporal regularization functional differential equations, ∂ρ/∂ t =  <dig>  with no flux boundary conditions  <cit>  for its activity time course implicitly. for the j-th tf at the -th iteration, one obtains

−ωΔsΔtf+tjn+1)+tjn+1=−Δs∂e∂tjn+tjn,     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabgkhitggaciab=l8a3jabfs5aejabdohazbqaaiabfs5aejabdsha0naabaaaleaacqwgmbgzaeqaaaaakmaabmaabagaemivaq1aa0baasqaaiabdqgaqbqaaiabd6gaujabgucariabigdaxaaakmaabmaabagaemidaq3aasbaasqaaiabdygasjabgkhitiabigdaxaqabaaakiaawicacaglpaaacqghrawkcqwgubavdaqhaawcbagaemoaaogabagaemoba4maey4kasiaegymaedaaowaaewaaeaacqwg0baddawgaawcbagaemibawmaey4kasiaegymaedabeaaaogaayjkaiaawmcaaagaayjkaiaawmcaaiabgucarmaabmaabagaegymaejaey4kasyaasaaaeaacqaiyagmcqwfjpwdcqqhuoarcqwgzbwcaeaacqqhuoarcqwg0baddawgaawcbagaemozaygabeaaaaaakiaawicacaglpaaacqwgubavdaqhaawcbagaemoaaogabagaemoba4maey4kasiaegymaedaaowaaewaaeaacqwg0baddawgaawcbagaemibawgabeaaaogaayjkaiaawmcaaiabg2da9iabgkhitiabfs5aejabdohaznaalaaabagaeyoaiyraemyraueabagaeyoaiyraemivaq1aa0baasqaaiabdqgaqbqaaiabd6gaubaakmaabmaabagaemidaq3aasbaasqaaiabdygasbqabaaakiaawicacaglpaaaaagaey4kasiaemivaq1aa0baasqaaiabdqgaqbqaaiabd6gaubaakmaabmaabagaemidaq3aasbaasqaaiabdygasbqabaaakiaawicacaglpaaacqggsaalcawljagaaczcamaabmaabagaeeyqaekaeiola4iaegioagdacagloagaayzkaaaaaa@8c5a@

tjn+1−ωΔsΔtftjn+1=−Δs∂e∂tjn+tjn,     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqadaqaaiabigdaxiabgucarmaalaaabaaccigae8xydcnaeuildqkaem4camhabagaeuildqkaemidaq3aasbaasqaaiabdagambqabaaaaagccagloagaayzkaagaemivaq1aa0baasqaaiabdqgaqbqaaiabd6gaujabgucariabigdaxaaakmaabmaabagaemidaq3aasbaasqaaiabigdaxaqabaaakiaawicacaglpaaacqghsisldawcaaqaaiab=l8a3jabfs5aejabdohazbqaaiabfs5aejabdsha0naabaaaleaacqwgmbgzaeqaaaaakiabdsfaunaadaaaleaacqwgqbgaaeaacqwgubgbcqghrawkcqaixaqmaagcdaqadaqaaiabdsha0naabaaaleaacqaiyagmaeqaaagccagloagaayzkaagaeyypa0jaeyoei0iaeuildqkaem4cam3aasaaaeaacqghciitcqwgfbqraeaacqghciitcqwgubavdaqhaawcbagaemoaaogabagaemoba4gaaowaaewaaeaacqwg0baddawgaawcbagaegymaedabeaaaogaayjkaiaawmcaaaaacqghrawkcqwgubavdaqhaawcbagaemoaaogabagaemoba4gaaowaaewaaeaacqwg0baddawgaawcbagaegymaedabeaaaogaayjkaiaawmcaaiabcycasiaaxmaacawljawaaewaaeaacqqgbbqqcqgguaglcqai5aqoaiaawicacaglpaaaaaa@781f@

and

tjn+1−ωΔsΔtftjn+1=−Δs∂e∂tjn+tjn.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqadaqaaiabigdaxiabgucarmaalaaabaaccigae8xydcnaeuildqkaem4camhabagaeuildqkaemidaq3aasbaasqaaiabdagambqabaaaaagccagloagaayzkaagaemivaq1aa0baasqaaiabdqgaqbqaaiabd6gaujabgucariabigdaxaaakmaabmaabagaemidaq3aasbaasqaaiabd6eaonaabaaameaacqwg0badcqwgpbqacqwgtbqbcqwglbqzcqwgzbwcaeqaaawcbeaaaogaayjkaiaawmcaaiabgkhitmaalaaabagae8xydcnaeuildqkaem4camhabagaeuildqkaemidaq3aasbaasqaaiabdagambqabaaaaogaemivaq1aa0baasqaaiabdqgaqbqaaiabd6gaujabgucariabigdaxaaakmaabmaabagaemidaq3aasbaasqaaiabd6eaonaabaaameaacqwg0badcqwgpbqacqwgtbqbcqwglbqzcqwgzbwcaeqaasgaeyoei0iaegymaedabeaaaogaayjkaiaawmcaaiabg2da9iabgkhitiabfs5aejabdohaznaalaaabagaeyoaiyraemyraueabagaeyoaiyraemivaq1aa0baasqaaiabdqgaqbqaaiabd6gaubaakmaabmaabagaemidaq3aasbaasqaaiabd6eaonaabaaameaacqwg0badcqwgpbqacqwgtbqbcqwglbqzcqwgzbwcaeqaaawcbeaaaogaayjkaiaawmcaaaaacqghrawkcqwgubavdaqhaawcbagaemoaaogabagaemoba4gaaowaaewaaeaacqwg0baddawgaawcbagaemota40aasbaawqaaiabdsfaujabdaeagbqabaaaleqaaagccagloagaayzkaagaeiola4iaaczcaiaaxmaadaqadaqaaiabbgeabjabc6cauiabigdaxiabicdawagaayjkaiaawmcaaaaa@93a9@

where l =  <dig> ⋯, ω is the regularization coefficient and Δs is chosen small enough by line search to assure that ecdna is minimized. for the j-th set of equations, one must restrict the analysis to those genes regulated by that tf. the above linear system is efficiently solved using the thomas algorithm for tridiagonal linear systems  <cit> . the remaining parameters  are found by a steepest descent based on ecdna.

if only the microarray data was provided, and in absence of direct information and physical measurements on the binding constants and tf activities, it is clear that there is a degeneracy in the solution for this problem. this means that there are many states in the parameter space that have the similar ecdna. for example if qij, tnij
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgubavdawgaawcbagaemoba42aasbaawqaaiabdmgapjabdqgaqbqabaaaleqaaaaa@325e@ satisfy the error minimization criterion, then for all ε >  <dig> also q˜ij
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgrbqugaacamaabaaaleaacqwgpbqacqwgqbgaaeqaaaaa@30ca@ = εqij, t˜nij=1εtnij
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgubavgaacamaabaaaleaacqwgubgbdawgaaadbagaemyaakmaemoaaogabeaaasqabagccqgh9aqpdawcaaqaaiabigdaxaqaaggaciab=v7albaacqwgubavdawgaawcbagaemoba42aasbaawqaaiabdmgapjabdqgaqbqabaaaleqaaaaa@3bdd@ satisfy the same criterion. a normalization procedure is imposed on the solution at every step in the iterative inversion by assuming knowledge of the temporal average of each tf to be t¯nij
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgubavgaqeamaabaaaleaacqwgubgbdawgaaadbagaemyaakmaemoaaogabeaaasqabaaaaa@3276@ as follows

tnijnorm=tnijnmicrot¯nij∑l=1nmicrotnij,     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgubavdaqhaawcbagaemoba42aasbaawqaaiabdmgapjabdqgaqbqabaaaleaacqwgubgbcqwgvbwbcqwgybgccqwgtbqbaagcdaqadaqaaiabdsha0bgaayjkaiaawmcaaiabg2da9maalaaabagaemivaq1aasbaasqaaiabd6gaunaabaaameaacqwgpbqacqwgqbgaaeqaaawcbeaakmaabmaabagaemidaqhacagloagaayzkaagaemota40aasbaasqaaiabd2gatjabdmgapjabdogajjabdkhayjabd+gavbqabagccuwgubavgaqeamaabaaaleaacqwgubgbdawgaaadbagaemyaakmaemoaaogabeaaasqabaaakeaadaaewbqaaiabdsfaunaabaaaleaacqwgubgbdawgaaadbagaemyaakmaemoaaogabeaaasqabagcdaqadaqaaiabdsha0naabaaaleaacqwgsbabaeqaaagccagloagaayzkaaaaleaacqwgsbabcqgh9aqpcqaixaqmaeaacqwgobgtdawgaaadbagaemyba0maemyaakmaem4yammaemocainaem4ba8gabeaaa0gaeyyeiuoaaagccqggsaalcawljagaaczcamaabmaabagaeeyqaekaeiola4iaegymaejaegymaedacagloagaayzkaaaaaa@7278@

and

qijnorm=qij∑l=1nmicrotnijnmicrot¯nij.     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgrbqudaqhaawcbagaemyaakmaemoaaogabagaemoba4maem4ba8maemocainaemyba0gaaogaeyypa0zaasaaaeaacqwgrbqudawgaawcbagaemyaakmaemoaaogabeaakmaaqahabagaemivaq1aasbaasqaaiabd6gaunaabaaameaacqwgpbqacqwgqbgaaeqaaawcbeaakmaabmaabagaemidaq3aasbaasqaaiabdygasbqabaaakiaawicacaglpaaaasqaaiabdygasjabg2da9iabigdaxaqaaiabd6eaonaabaaameaacqwgtbqbcqwgpbqacqwgjbwycqwgybgccqwgvbwbaeqaaaqdcqghris5aagcbagaemota40aasbaasqaaiabd2gatjabdmgapjabdogajjabdkhayjabd+gavbqabagccuwgubavgaqeamaabaaaleaacqwgubgbdawgaaadbagaemyaakmaemoaaogabeaaasqabaaaaogaeiola4iaaczcaiaaxmaadaqadaqaaiabbgeabjabc6cauiabigdaxiabikdayagaayjkaiaawmcaaaaa@6944@

this is self-consistent since it eliminates the cited above qt degeneracy.

b. symmetry rule and microarray inversion
for a general class of models used here, there is a tf up/down regulation symmetry that leads to a multiplicity in the determination of t. notably there are 2ntf
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqaiyagmdaahaawcbeqaaiabd6eaonaabaaameaacqwgubavcqwggbgraeqaaaaaaaa@3163@ solutions of the microarray inversion problem that are equally viable unless some knowledge of b¯¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgibgygaqhgaqhaaaa@2e40@ is provided. this is proved for our model as follows. the control function h  contains factors of the form xb/ where b is / <dig> and x is qij tnij
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgubavdawgaawcbagaemoba42aasbaawqaaiabdmgapjabdqgaqbqabaaaleqaaaaa@325e@. note that x/ = 1/. thus an up regulation with qij tnij
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgubavdawgaawcbagaemoba42aasbaawqaaiabdmgapjabdqgaqbqabaaaleqaaaaa@325e@ is equivalent to a down regulation with 1/. this suggests that unless for each tf we know bij for at least one gene the inversion will allow two equally probable answers corresponding to bij = ±  <dig> . this implies that for each tf type n we must find at least one gene for which the nature of the regulation  is known. this means that if b¯¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgibgygaqhgaqhaaaa@2e40@ is written in a sparse form as a ng row by ntf column matrix, then at least one entry in each column must be known. .

