BACKGROUND
self-incompatibility  is a biological mechanism to avoid inbreeding in allogamous plants that can be triggered before, during, or after pollination  <cit> . there are two si systems differing mainly in their genetic control. pollen compatibility determined by the diploid genotype of the pollen parent is referred to as sporophytic si   <cit> . in contrast, si determined by the haploid pollen genotype is referred to as gametophytic si   <cit> . in the latter system, the male gamete does not display any dominance in diploid species because it is haploid. thus, every allele is functional. si can be controlled by either a single locus or few loci depending on the species. for example, in brassicaceae and solanaceae, si is controlled by a single s gene, whereas for self-incompatible grasses, si is controlled by a two-locus  system. these two independent loci have among others been described for rye  <cit> , perennial ryegrass  <cit> , and italian ryegrass  <cit> . the s-z si system results in low selfing rates and is functional even in polyploid grasses such as switchgrass, where tetraploid plants showed  <dig> % self-compatibility, whereas octoploids reached  <dig> %  <cit> .

the proposed mechanism of si in diploid grasses suggests that, if at least one allele at s or z in the pollen differs from the recipient s-z alleles, the pollen will be compatible with the stigma  <cit> . fifty percent of the pollen produced by a genotype is compatible to pollen receptor genotype, if the pollen donor has one different allele at each s and z, then the 75% of the pollen is compatible with the pollen receptor genotype  <cit> . if the pollen donor has one different allele at each s and z, then the 75% of the pollen is compatible with the pollen receptor genotype. finally, if the pollen donor has two different alleles at one of the two loci, then pollen is 100% compatible. the gsi system in diploid species with an s-z system might lead to differences in reciprocal crosses  <cit> .

in polyploid species the interaction between pollen and stigma alleles is more complicated due to the presence of more than two alleles at a locus. throughout the manuscript, letters are used to identify alleles at s locus and numbers are used to identify alleles at z. here we propose two possible modes of interaction, named model i and model ii. if any allele at either s or z in the pollen differs from the alleles for s or z on the pistil, pollen is compatible   <cit> . if at least one allele at s and one allele at z locus present in the pollen grain matches the pistil, then pollen is incompatible   <cit> . for example pollen grain with genotype ab <dig> will be compatible under model i because it has one different allele compared to the abcd <dig> female. in contrast, if model ii is true, pollen ab <dig> is incompatible with the female abcd <dig> because it shares one allele at s  and another at z  . in addition to pollen-stigma interactions, the estimation of pollen compatibility percentages can be even more complex in polyploids due to inheritance patterns that can result in a high number of gametic haplotypes. polyploidization is a common mechanism that occurred during evolution and it is the result of the fusion between unreduced gametes of different species  or of the same species . genome analysis demonstrated that many plant genomes such as maize and soybean are ancient polyploids that went through diploidization events  <cit> . the nature of gamete fusion determines the behavior of chromosomes during meiosis. allopolyploids show mostly preferential pairing of chromosomes in structures called bivalents , whereas autotetraploids pair with their respective homologous forming quadrivalentes . in disomic inheritance there is no pairing between homeologues and, therefore, homologous chromosomes do not end up together in a gamete. thus, for a given locus with genotype abcd and preferential pairing between ab/cd, only four gametes  are possible. in contrast, tetrasomic inheritance results in all six possible combinations for pairs of alleles . normal chromosome segregation implies that the two sister chromatids are distributed to different gametes. however, during quadrivalent formation in autotetraploids, crossing over between non-sister chromatids can occur. the probability that two sister chromatids end up in the same gamete is known as α. this gamete carries the alleles which are identical by descent  <cit>  due to chromatid segregation and double reduction. for example, a plant with genotype abcd for the s locus can produce ab, ac, ad, bc, bd, cd gametes under tetrasomic inheritance and aa, bb, cc and dd gametes if chromatid segregation and double reduction occur.

consequently, it is possible in a tetraploid species to find gametes with alleles that are identical by descent , which results in a total of  <dig> possible different allele combinations in a gamete. when considering both si loci, s and z, respectively,  <dig> different gametes are possible. thirty six gametes have the genotypes expected under meiosis with no crossing over,  <dig> are the result of crossing over between two non-sister chromatids and double reduction at either locus, and  <dig> gametes result from a double reduction at both loci. chromatid segregation and double reduction increase the number of possible pollen genotypes and, therefore, increase the probability of cross-pollination between individuals with similar s and z genotypes.

a software for numerical estimation and prediction of allelic and genotypic frequencies calculation for sporophytic si systems has been published  <cit> . however, this model do not apply to gametophytic si systems that do not display dominance. segregation models for disomic and tetrasomic inheritance  <cit>  as well as models for estimation of allele frequencies in polyploids  <cit>  have also been published. however, this model lacks computerization of calculation. in addition, these models are generic for any locus, but do not deal with self-incompatibility or calculate pollen compatibility.

the program that we present here has the objective to support hypothesis testing under the different scenarios described above, especially for uncharacterized species. it can serve four different purposes: i) determine the number of progeny needed to differentiate between allo- and autotetraploidy; ii) obtain expected values of pollen compatibility for a pair-cross to maximize seed yield; iii) determine the si mechanism  in tetraploids; and iv) display information regarding s and z distortion that can provide useful knowledge about segregation distortion of markers at these loci or linked markers for linkage mapping and population genetic studies.

implementation
the program was written in the c++ programming language using the freely available qt compiler  and compiled for the windows™ operating system. a version for mac osx and linux is under development.

calculator parameters for meiosis
the calculator is based on estimable meiotic parameters that influence chromosome segregation during meiosis of autotetraploids. for instance, parameter β determines, whether or not there is preferential pairing  between chromosomes. β is restricted to have values of  <dig> or  <dig>  in case of tetrasomic inheritance or no preferential pairing β =  <dig>  with four alleles per locus  six gamete combinations are possible  under random pairing. in case of preferential pairing of homologues, β =  <dig>  furthermore, preferential pairing between genomes results in only four gamete combinations. to illustrate this further we named each genome jklm and alleles at a locus correspond to each genome in that order. for example, a genotype abcd with preferential pairing between jk/lm has gametes with haplotypes ac, ad, bc, bd. in case of preferential pairing, only one out of the three possible pairing scenarios jk/lm, jl/km, or jm/kl can be true. this has been implemented in our calculations by defining a Δ value to test all three possible scenarios sequentially. technically, if the Δ value is equal to  <dig> for one scenario, it is  <dig> for the other. usually, the values for β and Δ do not differ for s and z.

calculator frequencies estimation for segregation of s and z
s and z are independent loci. therefore, normal chromosome segregation of a genotype with four different alleles for s or z and with no preferential pairing between chromosomes jk, jl, jm, kl, km, and lm will produce six possible pollen haplotype combinations for each locus. thus, the probability of a haplotype is 1/ <dig>  it is possible that recombination during multivalent formation in meiosis followed by double reduction can cause sister chromatids to segregate together during meiosis. therefore, there is a chance of two identical alleles to end up in the same gamete by double reduction  <cit> . if we consider a single chromatid, only  <dig> out of the seven remaining is its corresponding sister chromatid. therefore, the probability  of two sister chromatids to end up in the same gamete ranges from  <dig> to 1/ <dig>  the value of α is species-specific, and depends on the distance between the locus and the centromere  <cit> . for the jklm genotype, there are four possible gamete combinations that have two identical by descent alleles  i.e., jj, kk, ll, mm. therefore, the frequency of each of these pollen genotypes is α/ <dig>  the closer s and z are linked with the centromere, the smaller is the α value  <cit> .

the input form of the program has a cell to enter α values to calculate gamete frequencies that can be different for each locus. for example, phalaris coerulescens is a diploid species for which s and z have been mapped. the s locus is located in a subcentromeric region of chromosome  <dig>  and the z locus is located on the long arm at the end of chromosome  <dig>  <cit> . in p. coerulescens, the α value for s will, therefore, be close to  <dig>  whereas the one for z should be larger. if the α value is unknown a default value such as 1/ <dig>  could be used.

calculator input and settings
the input window  has boxes for meiotic parameters for both loci  as described above and for a given pair of genotypes. the default setting is disomic inheritance and preferential pairing between jl/km for both loci, which can be used as a null hypothesis. the parameters settings have some restrictions. for example, if β =  <dig>  all Δ values are set to  <dig>  if an α value is given, then β =  <dig>  it is possible to enter the genotype for a pair of individuals. to our knowledge there is no information about allelic diversity for s and z loci since the determinants have not been identified yet. however, we developed the software assuming that the maximum difference between two genotypes is eight different alleles at each locus. therefore, the program accepts values for s defined by letters from a-h and numbers from 1- <dig> for z. settings will be summarized in words once input parameters are set. all the input settings will be summarized in words once input parameters are set.

calculator output
the initial output  obtained is a summary table of the input values. after the analysis is performed, the pollen haplotypes for each genotype and each locus are displayed. pollen haplotypes are calculated based on the formulas in table  <dig>  stift  published formulas to calculate pollen haplotypes, which differ from ours in nomenclature. the second output contains tables for pollen genotypes and frequencies as well as pollen compatibility in reciprocal crosses between genotypes  <dig> and  <dig> . for example for a genotype abcd <dig>  the matrix for pollen compatibility has the 10x <dig> possible pollen haplotypes. pollen haplotypes are arranged in column  <dig>  in the column header of columns 2- <dig> and 6- <dig>  the four female alleles for both, s and z are displayed. under each female allele, the numbers of identical alleles in the pollen are counted. since pollen genotypes have only two alleles for each locus, the number of alleles it can possibly share with a female genotype at the s or z locus, respectively, has to be  <dig>   <dig>  or  <dig> alleles .

genomes are named generically jklm. therefore, alleles for s  correspond to genomes jklm respectively; and alleles for z  also correspond to genome jklm respectively. α is the probability of double reduction and ranges from 0-  <dig> . β is a parameter for chromosome pairing during meiosis and can have values of  <dig>  or  <dig> . Δ is a parameter that defines which chromosomes show preferential pairing.

for each possible pollen-stigma combination the number of shared alleles at the s and z locus are given and summarized independently for s and z. Σs and Σz reflect the sum of shared alleles at s and z, respectively . in autotetraploids, for a given allele a locus can be monoallelic , biallelic  or triallelic   <cit> . therefore, the program is designed to avoid double counting of alleles.

pollen compatibility  is calculated for each pollen- stigma combination for the two models described above. mathematically, the model i algorithm states that if Σs or Σz <  <dig>  the pollen is compatible, therefore c = 1; otherwise c =  <dig>  for model ii, the algorithm states that if Σs or Σz =  <dig> then pollen is compatible and c = 1; otherwise c =  <dig>  thereafter, each c value is multiplied with the respective pollen haplotype frequency. the percentage of compatible pollen for a particular pollen-stigma genotype combination is the sum of the products between c values and pollen frequencies .

our program allows the user to continue the analysis with similar meiotic parameters. thus, the final output  is a summary table containing meiotic parameters used, genotype of individuals and the compatibility percentages under both models.

RESULTS
difference between preferential and non-preferential pairing
a male with genotype abcd <dig> will produce gametes with different haplotypes depending on the mode of pairing during meiosis. tables  <dig> & <dig> show possible pollen haplotypes, where shaded pollen haplotypes were produced under the assigned pairing and meiotic parameters. if such a male is crossed onto a female with different alleles at s and z , it is possible to determine the meiotic behavior based on the progeny. based on output information, it is also possible to determine the number of progeny needed, to screen to find a certain haplotype.

possible pollen haplotypes produced under the designed preferential pairing are in bold .

pure tetrasomic inheritance produces all  <dig> possible genotypes are shown in regular format. haplotypes in bold are the ones formed by chromatid segregation and haplotypes in italic are formed by double reduction. the probabilities of each s or z allele combination are given; the gamete frequency can be calculated as joined probability of the frequency at each locus.

assuming that markers are available to distinguish alleles for s and z, the stepwise procedure to determine meiotic behavior for s and z loci would be as follows: first, distinguish between disomic and tetrasomic inheritance. if disomic inheritance occurs, under any type of preferential pairing only  <dig> pollen haplotypes are possible. in contrast, if tetrasomic inheritance occurs,  <dig> pollen haplotypes are possible. to distinguish between both, it is necessary to evaluate the presence or absence of any of the  <dig>  haplotypes, that are indicative of tetrasomic inheritance.

if disomic inheritance is true, it can be determined, which genomes are pairing during meiosis. one haplotype that distinguishes between jk/lm, jl/km or jm/kl needs to be identified. in the example presented in table  <dig>  ab <dig> is a haplotype that can differentiate between jk/lm and jl/km. the probability of occurrence of these haplotypes in the progeny is  <dig> , to find at least one progeny we use the formula described by sedcole   <cit> : carrying a specific pollen haplotype,

  n=2r− <dig> +z21−q+zz21−q2+41−qr− <dig> q 

where n = total number of plants to be screened

r- required number of plants with the desired genotype

q = frequency of plants with the desired genotype

p = probability of recovering the required number of plants with the desired genotype

z- probability based on a z distribution

therefore, we need to screen at least  <dig> plants in this example to be 95% confident to find one offspring carrying the ab <dig> haplotype. if Δ <dig> is true, it is necessary to select a haplotype to distinguish it from Δ <dig> . using the same calculation as above,  <dig> individuals need to be screened to find at least one genotype carrying the ad <dig> haplotype with a 95% probability.

on the other hand, if tetrasomic inheritance is true for our species, it is necessary to determine, whether chromosome segregation or double reduction occurs. the probability of finding one haplotype produced by chromatid segregation is  <dig>  . using the same formula as above, to find at least one of these haplotypes in the progeny with a 95% confidence, a total of  <dig> individuals need to be analyzed. furthermore, if we want to assess the occurrence of double reduction, which occurs with a frequency of  <dig>  , a total of  <dig> individuals need to be screened.

model testing
our program can be used to determine the most likely model underlying pollen compatibility. for example, in a cross between abcd <dig> and abce <dig>  these genotypes have one different allele at each locus. under model i, reciprocal crosses between these genotypes reaches 75% pollen compatibility. in contrast, under model ii, this cross is completely incompatible. multivalent formation, chromatid segregation and double reduction during meiosis have an effect on pollen compatibility. a similar cross, in an autotetraploid species  with chromatid segregation and double reduction , will have  <dig> % pollen compatibility under model i or  <dig> % under model ii . in general, model ii is more restrictive than model i. model i ranges from 0% to 50% compatibility, when one different allele is present at either s or z. in contrast, model ii has values lower than 50%, if there are fewer than three different alleles at any locus .

allele composition
if meiotic parameters are known or can be calculated, but no markers are available for genotyping s and z, it is possible to infer the number of alleles segregating in a population of a pair cross. in a plant species with tetrasomic inheritance  and chromatid segregation/double reduction , the number of segregating alleles between the pollen donor and female plays an important role on the pollen compatibility in reciprocal crosses. for instance, if the number of total segregating alleles is four or more for at least one locus , pollen compatibility is higher than 90% under model i but only 63% for model ii . however, the distribution of these alleles in the two genotypes is important for the pollen compatibility in reciprocal crosses. if abcd <dig> is used as the pollen donor it has two and three alleles for s and z, respectively, which differ from the female aaab <dig>  in contrast, when aaab <dig> is used as the pollen donor, it has zero and one allele for s and z, respectively, that differ from the female abcd <dig>  resulting in a pollen compatibility of 47% under model i, or 4% under model ii . in addition, if the number of segregating alleles between genotypes drops to two, pollen compatibility is significantly reduced. for instance, a cross between aaab <dig> x aabb <dig> will result in no pollen compatibility under any model. however, if aabb <dig> is used as male the single different allele at z will cause an increase of pollen compatibility to 47% under model i, or 4% under model ii .

alleles that are ibd are in bold and underlined, first column  is the number of different alleles between s or z across genotypes. the columns that follow count the number of different alleles between males and females.

the information provided by pollencalc can be used to design experiments in order to test hypotheses related to the pairing and segregation of chromosomes during meiosis in tetraploid species with a gametophytic s-z si system. the program can be used if linked or functional markers for s and z are available or not.

the genetic mechanism of si is still unknown for some self-incompatible tetraploid grasses. also, there are no markers available for s and z which makes it difficult to understand and predict pollen compatibility. as described above, there are two possible models for pollen compatibility. in vitro or in vivo pollinations can be performed to determine, which of the two models most likely applies. as demonstrated, only few different alleles are required for model i. furthermore, under model i, if only one different allele is found at either s or z, pollen compatibility reaches 50%, whereas for model ii values below 50% are common when the number of different alleles is below three for any locus. “both in vitro and in vivo pollination test provide bias estimates of pollen compatibility. for instance, current in vitro pollination tests rely on imaging and counting to provide estimates of pollen compatibility. in vivo pollination analyzed as seed set can be affected by pollen death due to environmental condition and pre or post zygotic abortion. nevertheless, pollencalc can be used to design experiments in order to identify genotypes that are most informative to distinguish the two models i.e. genotypes with extreme pollen compatibilities. eventually the use of s and z linked markers are required for confirmation.”

there are other applications for this program when markers are available. for example, genome-wide markers are used in several studies to determine preferential pairing in polyploids. in species with si, segregation of markers linked or in linkage disequilibrium with s and z are distorted, which can result in biased interpretation of marker segregation data  <cit> . pollencalc can help to identify genotypes that can distinguish between types of pairing. knowledge about pairing and inheritance in a given species makes it possible to correct mapping distances for segregation distortion due to si in mapping experiments.

also, pollencalc calculates pollen haplotype frequencies of individuals in pair crosses and can be used to calculate pollen compatibility between those genotypes in reciprocal crosses. this information can also be used to maximize seed yield in hybrid breeding programs  <cit> . if markers for s and z are available, they can be used in combination with our software in breeding programs. for instance in a hybrid seed production programs, pollencalc can be used to select genotypes with specific s-z genotypes within one heterotic group that contrast with the s-z genotype from the individuals in the other heterotic group. if alleles are different between groups, seed yield will be maximized. also, it is possible to determine potential progeny genotype and frequencies by combining haplotypes and frequencies. in the longer run, this program can be used to simulate allele and genotypes frequencies for s, z, and loci genetically linked to s and z over multiple generations. thus, pollencalc is a useful tool for plant geneticists and plant breeders working with tetraploid species.

CONCLUSIONS
pollencalc is the only program that we are aware of that is able to calculate gamete haplotypes and pollen compatibility for tetraploid species with a gametophytic s-z si. the frequencies obtained can be used to determine the number of individuals needed to test different models for gsi, to optimize experimental designs, and to take segregation distortion of linked markers into account, indicating linkage disequilibrium with si loci.

availability and requirements
project name: pollencalc

project home page: https://github.com/berndwollenweber/pollencalc/downloads

operating system: tested under windows xp, windows vista, windows 7

programming language: c++

other requirements: none.

license: free non-commercial research-use license.

any restrictions to use by non-academics: none.

abbreviations
si: self-incompatibility; gsi: gametophytic self-incompatibility; ssi: sporophytic self-incompatibility.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
aaa has developed the algorithms and carried out initial design for the calculation and estimation of pollen compatibility under the two proposed models. bw conceived the software, carried out its design and participated in writing the draft of the manuscript. uks and tl have participated in writing the draft of the manuscript. all authors have read and approved the final manuscript.

supplementary material
additional file  <dig> 
pollen compatibility calculator user manual.

click here for file

 acknowledgements
we are grateful to rf baker center for plant breeding  that supports andrea arias aguirre.
