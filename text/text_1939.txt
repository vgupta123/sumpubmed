BACKGROUND
genome-wide rna expression analysis with microarrays has become a standard technology for screening for genes that are differentially expressed between different entities of tissues. in the clinical context, a frequent goal is the separation of patient groups with respect to prognosis or therapy outcome. the search for single genes as well as gene signatures with both prognostic power and corresponding biologically plausible interpretation remains a major challenge  <cit> .

identifying genes with discriminatory power using logistic regression type models often yields soft decision boundaries. however, the ideal situation for personalized medicine would be a sharp decision boundary, which corresponds to a clear separation of the expression values of a specific gene into two groups. this is particularly relevant for clinical routine, where usually not fresh frozen but formalin-fixed and paraffin-embedded tumor tissue is available. since rna from paraffin-embedded tissue is of lower quality than that of fresh frozen tissue the limited precision of quantitative analysis may add a further difficulty in classifying patients into low and high expression groups when genes with unimodal distributions are applied. in this situation bimodally distributed genes with a clear distinguishability between patients belonging to a high and a low expression group would mean an important practical advantage.

bimodal distributions of rna expression levels in tumor tissue may be caused by somatic mutations or by germline polymorphisms. a well-known example of a somatic or de novo mutation occurring during tumor development is amplification of the receptor tyrosine kinase proto-oncogene erbb <dig> which leads to increased rna expression levels  <cit> . on the other hand also single nucleotide polymorphisms  in the germ line have been shown to correlate with rna expression in tumor tissue and may result in bimodal distribution curves  <cit> . because of the clear distinguishability of high and low expression groups it could be an advantage to preferentially include bimodally distributed prognostic genes in prognostic signatures. in the literature various methods for the identification of genes with bimodal distributions have been introduced  <cit> . several authors suggest approaches based on clustering the expression values of a gene into two groups and constructing scores for bimodality from the clustering result. ertel and tozeren   <cit>  use the likelihood ratio of a normal model with one component and a normal mixture model with two components fitted to the expression values. the bimodality index suggested by wang et al.   <cit>  is based on the standardized difference of the cluster means. in this paper we introduce two further methods based on the comparison of the within cluster variance with the total variance.

the bimodality of a gene expression profile can be evaluated using the dip test of unimodality suggested by hartigan and hartigan   <cit> . other scores directly measure properties of the distribution, for example the kurtosis. in the case of two approximately equally sized groups the kurtosis is negative, distributions with many outliers have positive kurtosis. this approach was suggested by teschendorff et al.   <cit> .

an interesting alternative are outlier detection methods that search for genes with marked overexpression in a subset of cases  <cit> . the outlier-sum statistic explicitly identifies genes with extremely high or low expression values in a subset of the samples.

in this paper we present statistical methods for identifying prognostic genes whose expression values are clearly separated into two groups. our approach is unsupervised in the sense that we first screen for genes with bimodal gene expression distributions and then evaluate their prognostic power. the resulting gene lists contain promising candidates for prognostic or predictive signatures. the clear separation into two groups makes the classification of future samples more reliable.

we first describe all measures and tests for the detection of bimodal distributions. then we apply these measures to a microarray data set consisting of  <dig> breast cancer patients with corresponding whole genome rna expression data. for each measure, we obtain a list of ranked genes. we evaluate the prognostic power of all genes with respect to disease-free survival using the logrank test for survival data. we discuss the results from two perspectives. first, we present a global assessment of the ability of the measures to identify prognostic genes. in an enrichment type analysis we quantify if significantly many genes with prognostic power are ranked high according to the bimodality measures. second, we analyze the top-ranked genes in detail from a biological viewpoint, identifying concrete interesting new candidates.

methods
we first briefly present the k-means algorithm as a standard algorithm for clustering numerical values into two groups. we also describe a model-based clustering approach. then we introduce different measures for assessing if the shape of a distribution supports the assumption that two clear subgroups can be identified. in other words, we present measures for testing bimodality of distributions. we briefly describe the logrank test for quantifying the statistical significance of survival time differences between two groups of patients, and we present the kolmogorov-smirnov test for the enrichment analysis comparing the prognostic genes with the genes with bimodal distributions.

cluster algorithms
k-means
a straightforward method to assign patients to two groups based on their gene expression values is to use a clustering algorithm. one popular method is the k-means algorithm.

in the univariate case, let x <dig> ..., xn be a set of observations. given k <n initial distinct cluster centers the k-means algorithm partitions the set into k groups by minimizing the within cluster sum of squares , where cj, j =  <dig> ..., k, is the jth cluster, nj is the number of elements in cluster cj and  is the cluster center. the algorithm is an iterative process that alternates between assigning data points to clusters based on their distances to cluster prototypes and updating the prototypes based on new cluster assignments.

k-means is sensitive to the initially randomly selected cluster centers  <cit> . as we want to discriminate a group with low expression values from a group with high expression values we choose for each gene its minimum and its maximum observed expression value as initial centers.

model-based clustering
the assumption for this approach is that the distribution y of a gene with bimodal expression can be expressed as a mixture of two gaussian distributions y <dig> and y <dig> with parameters μ <dig>   and μ <dig>  , respectively.   

where Δ ∈ { <dig>  1} with p = π. π is the probability of belonging to y <dig>  let ϕθ denote the normal density with parameters θ = . then the density of y is given by   

the parameters of the mixture model are determined using the em-algorithm.

to fit the models to our data we make use of the r package mclust <cit> . typically equality of variances is not assumed and we fit models with unequal variances. however, in cases with only one outlier in the expression distribution a model with unequal variances is not suitable since one component has variance  <dig>  in this case we fit a two component model with equal variances.

tests for bimodality
the first two scores for testing bimodality quantify whether the partitioning of the expression values into two groups is adequate. we want to quantify whether assuming two clusters is more appropriate than assuming one cluster. the tests are based on the decomposition of the total sum of squares  as   

where bss is the between cluster sum of squares and wss the within cluster sum of squares.

variance reduction score
the variance reduction score  is defined as the ratio of wss and tss:   

vrs measures the proportion of variance reduction when splitting the data into two clusters. the value of this score lies in the interval , and a low score indicates an informative split.

weighted variance reduction score
the weighted variance reduction score  measures the variance reduction independent of the cluster sizes. in the numerator we calculate the mean of the two within cluster variances. the denominator is the sample variance as above for the vrs. we define   

in this case the variance of a cluster with few observations has the same influence as the variance of a large cluster. the value of this score can be larger than  <dig>  again, a low score reflects bimodality. wvrs has the ability to also identify splits into two clusters with extremely unequal sample sizes.

dip test of unimodality
the dip test of unimodality was suggested by hartigan and hartigan   <cit> . the dip statistic is defined as the maximum difference between an empirical distribution function and the unimodal distribution function that minimizes that maximum difference.

for two arbitrary bounded functions f and g define ρ:= supx|f-g|. define  for a class  of bounded functions. let  denote the class of unimodal distribution functions. then the dip of a distribution function f is defined by . to test the null hypothesis that f has a unimodal density hartigan and hartigan proposed the statistic d, where fn is the empirical distribution function of a random sample of size n. the distribution of d is compared with the distribution of d, where f is the uniform distribution on . hartigan and hartigan  <cit>  showed that the dip is asymptotically larger for the uniform distribution than for any other unimodal distribution.

to calculate the dip statistic we make use of the r package diptest  <cit> , which also provides a table of empirical percentage points of the dip statistic d for some specified sample sizes n. this distribution can be used to calculate p-values for the dip test, where the null hypothesis is a unimodal distribution.

kurtosis
teschendorff et al.   <cit>  proposed an approach to identify genes with bimodal density based on model-based clustering and kurtosis. the general approach is based on two steps. to select the optimal number of clusters and to find bimodal expression profiles a clustering algorithm is used together with a model selection criterion. then the kurtosis can be used to rank the bimodal genes according to if they define major subgroups or outlier subgroups. kurtosis is related to the fourth central moment and can be defined by   

given a gene's expression values x =  an unbiased estimate for the kurtosis is given by   

a gaussian distribution has kurtosis k =  <dig>  whereas most non-gaussian distributions have either k >  <dig> or k <  <dig>  specifically, a mixture of two approximately equal mass normal distributions must have negative kurtosis since the two modes on either side of the center of mass effectively flatten out the distribution. a mixture of two normal distributions with highly unequal mass must have positive kurtosis since the smaller distribution lengthens the tail of the more dominant normal distribution  <cit> . if there is an 80%-20% split of the samples into two groups, then the kurtosis is close to  <dig>  <cit> . therefore biologically interesting genes might be missed.

we calculate the kurtosis for all genes without a prior feature selection step.

likelihood ratio
using the likelihood ratio of a normal model and a mixture normal model to identify bimodal distributions was suggested by ertel and tozeren   <cit> . we fit a normal model and a mixture normal model to the expression values for each gene using the mclust package and calculate the likelihood ratio   

where l <dig> is the likelihood of the normal model with one component and l <dig> is the likelihood of a normal mixture model with two components with unequal variance.

small ratios indicate that the distribution is unimodal, whereas large ratios suggest that the expression values are bimodally distributed.

bimodality index
the bimodality index introduced by wang et al.   <cit>  is a criterion to identify and rank bimodal signatures from gene expression data. it is assumed that the distribution of a gene with bimodal expression can be expressed as a mixture of two normal distributions with means μ <dig> and μ <dig> and equal standard deviation σ. the standardized distance δ between the two populations is given by   

for identifying genes with bimodal distribution the null hypothesis is δ =  <dig>  then the bimodality index  is defined by   

where π is the proportion of observations in the first component.

for a given data set δ and π can be estimated using mclust. then bi can be calculated using the estimated values. larger values of bi correspond to bimodal distributions where the two components are easier to distinguish. wang et al. recommend bi =  <dig>  as a cutoff to select bimodally distributed genes.

outlier-sum statistic
another approach to group genes by expression values is based on the calculation of outlier sums as proposed by tibshirani and hastie   <cit> . this method is able to detect genes with unusually high or low expression in some but not all samples. tibshirani and hastie assume that the samples fall into a reference and a disease group. however, as we only consider tumor samples we modified the method for our purpose.

let medi and madi be the median and the median absolute deviation of the expression values of gene i. first, the expression values xij of each gene are standardized as follows:   

let qr be the rth percentile of the  values and iqr = q <dig> - q <dig> the interquartile range. all values smaller than iqr - q <dig> or greater than iqr + q <dig> are defined to be outliers. the outlier-sum statistic for positive outliers is defined as   

wi is large if there are many outliers in the data or few extreme outliers with high values, and wi is zero if there are no outliers. analogously the outlier-statistic for negative outliers is defined as   

the outlier-sum statistic is the maximum of wi and w'i in absolute value.

for the survival analysis we need to split patients into two groups. we consider the outliers that are used to calculate the outlier sum as one group and all other observations as the other group.

testing for prognostic relevance
for each gene we compare the hazard rates of two patient subgroups obtained by the different methods. the goal is to determine whether the survival in the two groups differs. we test the hypothesis h0: h <dig> = h <dig>  for all t ≤ τ, against the alternative that the hazard rates differ for some t ≤ τ. τ is the largest time at which both groups have at least one subject at risk. we make use of the logrank test which is a nonparametric test for right-censored data first proposed by mantel   <cit> .

let t <dig> <t <dig> < ... <td be the distinct death times in the pooled sample. then dij is the number of events in the jth sample out of yij individuals at risk at time ti, j =  <dig>   <dig>  i =  <dig> ..., d. let di = di <dig> + di <dig> and yi = yi <dig> + yi <dig> be the number of events and the number at risk in the combined sample at time ti. the test statistic z of the logrank test is given by   

when the null hypothesis is true and the sample sizes in the two groups are similar, asymptotically z has a standard normal distribution. in the case of highly unequal sample sizes, especially if one group contains less than five patients, the asymptotic distribution under the null hypothesis is not appropriate anymore  <cit> . thus we do not make use of the normal distribution for obtaining significance values. instead, we use a permutation test. we calculate the test statistic for  <dig>  random permutations of the patients and determine the percentage of values more extreme than the observed value of the test statistic. using k-means we always get two groups of patients. however, using the model-based clustering approach and the outlier sum approach it is possible that for some genes all patients are in the same group so that the logrank test can not be applied. as these genes rather have unimodal expression profiles we decided to set the corresponding p-value  <dig> 

adjustment for multiple testing
we use the logrank test described in the previous section to test for prognostic relevance for each of the genes. here, we have to take the multiple testing problem into account. the significance level α of a hypothesis test controls the type i error, i.e. the probability of rejecting a true null hypothesis. if m independent true hypotheses are tested simultaneously one would expect m · α p-values p <α. therefore one has to adjust for multiple testing.

there are different correction methods. the bonferroni-holm method  <cit>  controls the familywise error rate , i.e. the probability of rejecting at least one true null hypothesis.

the method suggested by benjamini and hochberg   <cit>  controls the false discovery rate , which is the expected proportion of falsely rejected hypotheses among all rejected hypotheses. this procedure is less conservative than the bonferroni-holm method and often more appropriate for high-dimensional microarray data.

let p, . . ., p denote the ordered p-values of m hypothesis tests, i.e. p ≤ p. then the adjusted p-values, also referred to as q-values, can be calculated iteratively as follows   

where q = p.

analyzing gene lists for enrichment with prognostic genes
to determine whether there is an enrichment of the top-scoring bimodality genes with prognostic genes, we rank the genes based on the different bimodality scores. we then select the  <dig> genes with smallest p-values of the logrank test. these genes differ for the different approaches . in this context, we call these genes prognostic genes.

an enrichment of the top-scoring bimodality genes with prognostic genes corresponds to small ranks of prognostic genes in the ranked list. we test the null hypothesis that the ranks of the prognostic genes are uniformly distributed among the bimodality-ranked genes with a one-sample kolmogorov-smirnov test, which is a nonparametric test of equality with a given one-dimensional reference function. the kolmogorov-smirnov statistic quantifies a distance between the empirical distribution function of the sample and the cumulative distribution function of the reference distribution.

we perform the one-sided kolmogorov-smirnov test for testing the hypothesis that the cumulative distribution function of the ranks of the prognostic genes is not greater than the distribution function of a uniform distribution. let fn denote the empirical distribution function of the sample and f the distribution function of the reference distribution, then the test statistic is given by   

the null distribution of this statistic is calculated under the null hypothesis that the sample is drawn from the reference distribution. if f is continuous the distribution of  does not depend on f but just on the sample size n. for n >  <dig> approximative p-values can be derived from the asymptotical distribution of  <cit> .

patients and gene array analysis
the mainz study cohort consists of  <dig> node-negative breast cancer patients who were treated at the department of obstetrics and gynecology of the johannes gutenberg university mainz between the years  <dig> and  <dig>  <cit> . all patients underwent surgery and did not receive any systemic therapy in the adjuvant setting. gene expression profiling of the patients' rna was performed using the affymetrix hg-u133a array, containing  <dig> probe sets, and the genechip system  <cit> . the normalization of the raw data was done using rma  <cit>  from the bioconductor  <cit>  package affy <cit> . the raw .cel files are deposited at the ncbi geo data repository  <cit>  with accession number gse <dig> 

RESULTS
we analyze and compare distributions of bimodality measures. all methods presented in the methodology section are applied to the mainz cohort study. for all bimodality measures we present the top-scoring genes and we analyze their ability to detect prognostic genes. we discuss and interpret commonalities and differences in the conclusions section.

correlation between bimodality scores
we calculated the seven scores for quantifying bimodality for all  <dig> genes measured in the mainz study. first, we analyze the global correlations between the measures. the results show that indeed a clear group structure exists which enables a classification of the measures for our application.

we point out that only the dip score is directly connected to a significance value since it is based on a test statistic with corresponding null distribution. the null distribution provides p-values for rejecting the hypothesis of unimodality. the empirical percentage point for sample size n =  <dig> and test level α =  <dig>  is  <dig> . for  <dig> genes the dip statistic is larger than  <dig>  such that the null hypothesis of a unimodal density can be rejected. for the other bimodality scores no direct significance calculation resulting in p-values is available. for the bimodality index wang et al. recommend the cutoff  <dig>  which is exceeded by  <dig> genes. in table  <dig> and  <dig> we present the pairwise pearson and spearman correlation for the seven scores applied to all genes. both methods show similar results. here, the likelihood ratio is transformed to the logarithmic scale, which increases the pearson correlation to other scores considerably due to the removal of outlier effects. considerable correlation can be observed for various pairs of scores. the log-likelihood ratio and the outlier sum have the largest correlation . the only other correlations larger than  <dig>  are observed pairwise between log-likelihood ratio, wvrs, and kurtosis. in table  <dig> we present the same analysis replacing the pearson correlation with the spearman rank correlation. the correlation coefficient of wvrs and kurtosis is now the largest , and the measures log-likelihood ratio, wvrs, kurtosis, and outlier sum all have pairwise high rank correlations.

in summary, the outlier-sum statistic and the log-likelihood ratio have the highest correlation . in both dendrograms these scores are thus very close. wvrs and kurtosis also belong to this group, whereas vrs, dip statistic, and bimodality index seem to measure different distributional features, at least according to the overall correlation.

distributional shapes of genes with extreme bimodality scores
in order to obtain an impression of types of distributions detected by the different bimodality scores we present histograms of the expression values for the top  <dig> genes identified by each score, respectively . the most striking differences can be observed between the shapes detected by the correlated measures log-likelihood ratio, wvrs, kurtosis and outlier-sum statistic on the one side and all other scores on the other side. the former scores all identify genes with a main unimodal expression distribution and few additional outliers. the other scores detect mainly genes whose expression values can be grouped into two separated groups.

this difference can be exemplified with the clustering approaches resulting in the vrs and wvrs scores. the histograms for the top genes of vrs all indicate a large group and a smaller group ). except for foxa <dig>  the smaller group has larger expression values. on the other hand, the expression values of the top genes according to wvrs show a unimodal density with one or two outliers. typically, most expression values of these genes are low, often in a range that could be regarded as noise, whereas the outliers have high expression values. this different behavior between vrs and wvrs is due to the larger impact of a subset with few samples when using wvrs, since then the variance reduction is calculated by averaging the variances of the two resulting subsets.

similarly, the density of the genes with the largest positive kurtosis is unimodal with a small outlier group with high expression values ), whereas the top  <dig> genes according to negative kurtosis show bimodal densities with almost equal size groups or a flat density . for the top genes according to the likelihood ratio one can see a large group and an outlier group with large variance. also the outlier-sum statistic detects genes with densities with heavy tails in the higher intensities. for the dip statistic the top genes have clearly visible bimodal densities ). the genes with the largest bimodality index show bimodal densities, where the two groups can have unequal sizes ). there is not much overlap between the top six genes of all scores, except for the gene hla-dqa <dig> with a clear bimodal histogram. the gene is among the top list for the scores detecting bimodal shapes, i.e. vrs, dip, negative kurtosis, and bimodality index, and additionally for wvrs.

in conclusion, all considered scores are applicable for the identification of genes with characteristic distributions. however, the distribution curves differ particularly with respect to the number of patients  constituting the high expression group.

prognostic relevance of genes with extreme bimodality scores
for the top genes presented in the previous section, we plot in figure  <dig>  figure  <dig> and figure  <dig> kaplan-meier curves for the top-scoring genes and corresponding p-values of the logrank test when discriminating patients according to low or high expression values. as described in the methodology section we use different methods to assign patients to a low and a high expression group. for vrs and wvrs we use the k-means algorithm, for the kurtosis based approach, the likelihood ratio, and the bimodality index we use the results of the model-based clustering, and for the outlier-sum statistic we use the main group and the outlier group. we argue that the k-means approach is also appropriate for the results of the dip test as we see that the k-means algorithm is able to separate the groups adequately at least for the top ranked genes.

for three of the top genes detected by vrs the survival in the two groups differs considerably. for magea <dig> and zic <dig>  the survival prediction is worse for the group with high expression values, for foxa <dig> for the group with low expression values. the only patient in the high value group for ugt1a@ and ctnna <dig> drops out at an early point, resulting in a small p-value ). this patient is the same for both genes. among the top  <dig> genes for the dip statistic there are two with p-values smaller than  <dig> , namely tfap2b and erap <dig>  for both genes the survival in the group with lower expression values is worse. for two of the  <dig> genes with largest positive kurtosis, ugt1a@ and myh <dig>  the survival in the patient subgroups differs significantly. patients with high expression values have worse prognosis ). among the top  <dig> genes for negative kurtosis, there is just one  that splits the samples in two groups with significantly different prognosis. magea <dig> and magea <dig> are the two genes identified as bimodal by the likelihood ratio score whose p-values of the logrank test are small. here, the p-value for magea <dig> is highly significant . among the  <dig> top-scoring genes based on the bimodality index the two genes foxa <dig> and zic <dig> lead to a prognostic split. among the top  <dig> genes according to the outlier-sum statistic only vgll <dig> generates a p-value smaller than  <dig> .

prognostic relevance of bimodality scores on a genome-wide scale
in a next step we systematically analyzed the overlap between two different gene sets, namely genes identified by a score and genes associated with prognosis. the goal is to find out if among the bimodal genes identified by the different scores genes associated with prognosis are overrepresented. table  <dig> shows the top  <dig> genes for each of the scores with corresponding p-values of the logrank test and the associated q-values.

for each of the scores the table contains the  <dig> top-scoring genes. also the p-values obtained by the logrank test and the corresponding q-values are given.

for the genome-wide evaluation, we first sorted the genes based on the bimodality scores. for vrs and wvrs we generated gene lists with smallest scores at the top. for the dip statistic, the bimodality index, the likelihood ratio and the outlier-sum statistic we generated decreasing lists. for the kurtosis we look at both the increasing as well as the decreasing list. we then selected the  <dig> genes with smallest p-values for survival differences. these gene lists are different for the different approaches.

the results of fisher tests and kolmogorov-smirnov tests for the scores are displayed in table  <dig>  plots corresponding to a kolmogorov-smirnov type test are shown in additional file 1: supplemental figure  <dig>  for vrs, among the top  <dig> genes there is just one of the  <dig> prognostic genes, but among the top  <dig> genes there are  <dig>  this number is significantly larger than expected under the null hypothesis of independence between bimodality score and prognostic relevance . the kolmogorov-smirnov test rejects the null hypothesis that the ranks of the prognostic genes are uniformly distributed . thus there is a clear enrichment with prognostic genes in the top-scoring genes.

for wvrs, among the  <dig> top-scoring genes there are just  <dig> of the  <dig> prognostic genes . apparently there is no enrichment with prognostic genes on top of the list and the global kolmogorov-smirnov test can not reject . however, many of the prognostic genes have large wvrs values . these genes have expression distributions with a main unimodal distribution and an additional outlier group with large variance. for the list based on the dip statistic just two of the prognostic genes are among the top  <dig> and  <dig> among the top  <dig> genes. here, the null hypothesis of the kolmogorov-smirnov test can not be rejected .

among the first  <dig> genes on the list with decreasing kurtosis values there are  <dig> highly prognostic genes , whereas on the increasing list there are  <dig> genes . the result of the kolmogorov-smirnov test for the decreasing kurtosis list is borderline significant . the prognostic genes are overrepresented among the first half of the ranked gene list . for the likelihood ratio the ranks of the prognostic genes are significantly not uniformly distributed , and among the top  <dig> genes we find  <dig> prognostic genes . for the bimodality index the global enrichment is also highly significant . there is a significant enrichment for the top-ranked genes.  <dig> of the  <dig> prognostic genes are among the first  <dig> genes according to the bimodality index .

lastly, for the outlier-sum statistic a highly significant overrepresentation of the prognostic genes among the top-scored genes can be observed . among the first  <dig> genes are  <dig> highly prognostic genes .

this shows that on a global level the likelihood ratio, the bimodality index and the outlier-sum statistic work best for the identification of prognostic genes with bimodal density, many prognostic genes have densities with heavy tails. the clustering based approaches vrs is better suited to detect prognostic genes than the dip statistic.

it is important to note that we found that the threshold  <dig> for determining the prognostic genes is not critical. we tried various other cutoffs. using  <dig> prognostic genes, no significant results are obtained. in the range from  <dig> to  <dig> genes we found that the results for vrs, bimodality index, likelihood ratio and the outlier-sum statistic are similar.

validation on other data sets
to validate our results we repeated our analysis on an other free available data set. the raw .cel files and clinical parameters of the rotterdam cohort  <cit>  were downloaded from the ncbi geo data repository with accession number gse <dig> . here, the outlier-sum statistic and the likelihood ratio also have the smallest p-values of the logrank test . for the bimodality index there is also a significant enrichment . however, we do not observe a significant overrepresentation of the prognostic genes among the top-scoring genes according to vrs. for the gene list based on decreasing kurtosis the we also find a significant enrichment .

to determine whether our results also hold for known prognostic subgroups we used a pooled cohort of  <dig> patients from different free available data sets: gse <dig> , gse <dig> , gse <dig>   <cit>  and gse <dig>   <cit> . we look at three subgroups defined by the expression of the two genes esr <dig> and erbb <dig>  namely esr1+/erbb2- , erbb2+  and esr1-/erbb2- . in this analysis the variable for assessing prognostic power of the genes is the distant metastasis free interval .

in the esr1+/erbb2- subgroup of the pooled cohort the bimodality index has the smallest p-value of the logrank test . a significant enrichment of the top scoring genes with prognostic genes can also be observed for the likelihood ratio  and for the outlier-sum statistic . for the kurtosis score the prognostic genes have mainly negative values. there are also many genes with large positive kurtosis but these are not the top genes for positive kurtosis. for vrs the result of the kolmogorov-smirnov test is borderline significant .

in the erbb2+ subgroup of the pooled cohort the kolmogorov-smirnov test significantly rejects the null hypothesis for various measures . some of the prognostic genes are at the top of the ranked gene lists based on vrs, wvrs, increasing kurtosis, the bimodality index and the likelihood ratio. the smallest p-value can be observed for the negative kurtosis . here, for the outlier-sum statistic no significant result is obtained . in the esr1-/erbb2- subgroup the only considerable enrichment can be observed for negative kurtosis .

it is important to note that the pooling of data sets can be problematical since in some cases bimodal expression distributions are an artifact of the pooling of experiments .

analysis of established genes with bimodal distribution
techniques for the identification of bimodally expressed genes should be able to identify genes, whose bimodal distribution is already known. the best established genes with bimodal frequency distributions in breast cancer are the estrogen receptor  and erbb <dig>  <cit> . histograms of the expression profiles of these genes in our data set are shown in figure  <dig> and clearly indicate subgroups.

the ranks of these two genes based on the different bimodality scores are presented in table  <dig>  for many scores, the genes obtain small ranks. esr <dig> is ranked by the bimodality index and vrs at position  <dig> and  <dig>  respectively, and also has small ranks for wvrs, the outlier-sum statistic, and the likelihood ratio. only for the dip statistic and for the kurtosis esr <dig> obtains medium ranks.

the ranks of the known bimodal genes erbb <dig> and esr <dig> based on the seven scores.

erbb <dig> also has the smallest rank when using the bimodality index  and has small ranks for vrs, the outlier-sum statistic, and the likelihood ratio. the only extreme difference can be observed for wvrs, where erbb <dig> has rank  <dig>  the large value of wvrs is due to the large variance in the smaller group. dip finds groups with almost equal sizes and thus fails to identify the groups with unequal sizes generated by esr <dig> and erbb <dig> in our data set.

discussion and 
CONCLUSIONS
genome-wide identification of genes with bimodal expression distributions is relevant since distinguishability of high and low expression groups is easier compared to genes with unimodal gene expression distributions. in addition, such methods may be helpful for the identification of candidate genes that are targets of somatic or germ-line mutations.

in the present study, we compared seven scores for the genome-wide identification of bimodal genes. interestingly, the expression distributions of genes identified by the different scores showed characteristic differences. in general, two different concepts can be distinguished, namely the splitting of observations into two separated groups and the identification of a mixture of a reference group and outlier observations. the splitting approaches are the following: the dip test is a nonparametric test of unimodality. in our context, it identifies genes with approximately similar sizes of low and high expression groups. genes with negative kurtosis values also show bimodal densities with almost equal mass of the groups or with flat distributions. the top genes according to the bimodality index mostly have bimodal distributions with unequal group sizes.

the outlier approaches are the correlated measures log-likelihood ratio, wvrs, kurtosis, and the outlier-sum statistic. genes with large positive kurtosis have densities with a large group and a small group containing only a few patients. the likelihood ratio and the outlier-sum statistic both find genes with heavy tails in their expression profiles. in our evaluation, usually the smaller group showed higher expression values.

the clustering-based approach vrs seems to be a compromise, see figure  <dig>  both genes identified by the splitting methods and by the outlier methods are ranked top. vrs is also suitable for detecting splits with corresponding noticeable different group sizes.

the second result of our analysis is which measures are best suited for finding prognostic genes. genome-wide analysis of all genes in the mainz cohort study demonstrates that the prognostic genes are clearly overrepresented among the genes identified by various measures. the smallest p-values of the kolmogorov-smirnov test that evaluates the entire bimodality ranking at once were obtained for the likelihood ratio, the outlier-sum statistic and the bimodality index. the outlier-sum approach produces a gene list in which prognostic genes have small ranks . there is a strong pearson correlation between the log-likelihood ratio and the outlier-sum statistic  and the p-value of the kolmogorov-smirnov test for the likelihood ratio is also very small . both methods identify similar types of distributions. many of the prognostic genes have densities with heavy tails. the bimodality index finds genes with bimodal densities where the group sizes can be unequal. the prognostic genes are clearly overrepresented among the top-scoring genes according to the bimodality index . the next best measure is vrs . this means that both splitting methods  and outlier methods  can be useful for finding interesting prognostic genes. for the weighted cluster score wvrs, the overall overrepresentation of the prognostic genes among the top-scoring genes is not significant . however, many of the genes with large wvrs values obtain very small p-values according to the logrank test. the expression profiles of these genes show a unimodal distribution and a smaller group with large variance. the validation of our results using the rotterdam cohort showed that the prognostic genes were also clearly overrepresented among the top-genes according to the likelihood ratio and the outlier-sum statistic.

another insight is that, in concordance with previous findings, only small groups of patients who strongly overexpress certain prognostic factors show worse prognosis, whereas dichotomization of the same factors at the median results in no or a worse prognostic power  <cit> . often, rna expression levels in the high expression groups are so high above those of the low expression groups that the overlap is virtually zero. therefore, outlier scores like the kurtosis may be particularly valuable for screening for genes to be used subsequently in prognostic signatures. for this type of genes, often, the number of patients in the high expression group is very small. however, combination of several such bimodal genes may nevertheless allow the identification of a high risk group of an adequate size.

the dip is certainly not a technique of first choice for preselecting genes for prognostic signatures. however, dip may be ideal for the identification of genes whose bimodal expression may be caused by genetic polymorphisms with frequent alleles which is of interest in drug metabolism and other fields of toxicological research  <cit> .

among the identified genes several have not yet been recognized to be prognostic and bimodally expressed in breast cancer. an extensive overview over the top identified genes in our study regarding their gene function and the role of polymorphisms in tumor development is presented in additional file 7: supplemental table  <dig>  important examples are the genes magea <dig> and magea <dig> that play central roles in immune response. both have not yet been reported to be prognostic in breast cancer nor to show bimodal distributions. further examples are desmoglein  <dig>  which is involved in intercellular junction of epithelial cells, the phase ii metabolizing enzyme ugt1a@, the cadherin-binding protein ctnna <dig>  and myosin heavy chain  <dig> , which so far has been associated with heart disease but not with cancer. examples where the polymorphism or its prognostic relevance have already been reported are the transcription factor foxa <dig> and hapln <dig>  foxa <dig> has already been shown to be a predictor of good outcome in breast cancer, in agreement with the result of the present study. hapln <dig> conveys tumorigenic properties when overexpressed in mesothelioma cells, but snps of the hapln <dig> locus were not found to be associated with response to interferon beta and a prognostic role in breast cancer has not been reported yet .

in summary, we have established efficient techniques for the genome-wide identification of genes with bimodal expression distributions and we have analyzed their ability to generate patient splits with prognostic relevance. future research includes the analysis of multivariate bimodality measures and the construction of prognostic signatures by combining several genes with bimodal expression distributions.

availability
r code for measures of bimodality and linking them to survival data is available at http://www.statistik.tu-dortmund.de/genetik-publikationen-bimodality.html.

authors' contributions
bh, jgh and jr developed the ideas for the manuscript, bh performed the statistical analyses, ms, mcg, ws and jgh generated and provided the data, jgh compiled the supplemental table, bh and jr drafted the manuscript, all authors read and approved the manuscript.

supplementary material
additional file 1
supplemental figure  <dig>  plots of the kolmogorov-smirnov type test for the  <dig> scores in the mainz cohort using  <dig> prognostic genes. the genes are ordered according to the bimodality measures. we define a set of n <dig> prognostic genes by choosing the genes with the smallest p-values of the logrank test. we define n <dig> = n - n <dig> where n is the total number of genes. for the kolmogorov-smirnov type test a running-sum statistic is calculated by going through the ranked gene list. if a gene belongs to the set of prognostic genes n <dig> is added, if it does not belong to this set n <dig> is subtracted. the statistic is constructed such that the total sum is always  <dig>  the maximal deviation from  <dig> is calculated which is large if there is an enrichment of the top-scoring genes with prognostic genes. on the x-axis of this plot the genes are ranked according to the particular score. on the y-axis is the running-sum statistic. the marks at the zero line indicate the positions of the prognostic genes in the ranked gene list.

click here for file

 additional file 2
supplemental figure  <dig>  plots of the kolmogorov-smirnov type test for the  <dig> scores in the rotterdam cohort using  <dig> prognostic genes.

click here for file

 additional file 3
supplemental figure  <dig>  plots of the kolmogorov-smirnov type test for the  <dig> scores in the esr1+/erbb2- subgroup of the pooled cohort using  <dig> prognostic genes. in the esr1+/erbb2- subgroup of the pooled cohort the bimodality index has the smallest p-value of the logrank test . the prognostic genes are clearly overrepresented among the first  <dig> genes. a significant enrichment of the top scoring genes with prognostic genes can also be observed for the likelihood ratio  and for the outlier-sum statistic . for the kurtosis score the prognostic genes have mainly negative values. there are also many genes with large positive kurtosis but these are not the top genes for positive kurtosis. for vrs the result of the kolmogorov-smirnov test is borderline significant . for the other scores the null hypothesis of uniformly distributed ranks of the prognostic genes can not be rejected.

click here for file

 additional file 4
supplemental figure  <dig>  plots of the kolmogorov-smirnov type test for the  <dig> scores in the erbb2+ subgroup of the pooled cohort using  <dig> prognostic genes. in the erbb2+ subgroup of the pooled cohort the kolmogorov-smirnov test significantly rejects the null hypothesis for various measures. in the corresponding plots one can see that some of the prognostic genes are at the top of the ranked gene lists based on vrs, wvrs, increasing kurtosis, the bimodality index and the likelihood ratio. the smallest p-value can be observed for the negative kurtosis . the prognostic genes mostly have expression distributions with two major subgroups. here, for the outlier-sum statistic no significant result is obtained .

click here for file

 additional file 5
supplemental figure  <dig>  plots of the kolmogorov-smirnov type test for the  <dig> scores in the esr1-/erbb2- subgroup of the pooled cohort using  <dig> prognostic genes. in the esr1-/erbb2- subgroup of the pooled cohort the only considerable enrichment can be observed for negative kurtosis . for wvrs the p-value is also smaller than 5% , but in the corresponding plot no overrepresentation of prognostic genes among the top-scoring genes is visible.

click here for file

 additional file 6
supplemental figure  <dig>  scatterplots of the expression values of the  <dig> top genes according to negative kurtosis in the esr1+/erbb2- subgroup of the pooled cohort. the colors indicate the two groups obtained by model-based clustering, the vertical lines separate the  <dig> data sets. this plot shows that in some cases bimodal expression distributions are an artifact of the pooling of experiments. for example, for the second gene  the first and third data set contain only high expression values, the second almost only low values. therefore, pooling is dangerous. however, for some cases the different data sets yield consistent results, see, e.g., the genes tfap2b and hla-dqa <dig> 

click here for file

 additional file 7
supplemental table  <dig>  overview over function and polymorphisms of the genes with bimodal expression distribution. special care was given to identify publications reporting about polymorphisms of the genes of interest in tumor tissue or a possible role in tumor development. for most of the genes identified as bimodal in the present study no evidence for functional polymorphisms in tumor tissue has been published.

click here for file

 acknowledgements
this project was funded by the bmbf .
