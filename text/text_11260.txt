BACKGROUND
until a few years ago, studies of positive selection have been limited to sequence data from a single gene covering only a few thousand nucleotides. now that detailed genetic maps of human variability are available in many populations, it is possible to measure the signature of positive selection on a genomic scale  <cit> . traditional tools for detecting selection are not applicable to these large snp datasets, as most traditional tests require sequence data with no ascertainment bias. however, with dense snp coverage across the genome, it is now possible to accurately measure the decay of linkage disequilibrium  over long genomic distances, opening the door for new tests that can detect the fingerprint of selection across hundreds of thousands of nucleotide positions. most of the tests that measure this signal of selection have been constructed using one of two basic statistics, extended haplotype homozogosity  and fraction of recombinant chromosomes   <cit> . variants of both statistics have been used in multiple whole genome scans to provide a global view of recent positive selection in humans.

most of the discussion surrounding these genome scans has focused on the similarities of their results, since all indicate that positive selection has been a surprisingly important force in recent human evolution  <cit> . however, beneath the broad picture lie curious differences in the results of the two approaches. in  <dig>  wang et al. identified  <dig> candidate genes as potential targets of recent positive selection in a scan of the human genome based on the frc statistic. later that year, voight et al.  <cit>  identified  <dig> candidate genes in a similar genome scan using the ihs statistic, which is based on ehh. both groups calculated a summary statistic at each site that measured the ld associated with that site, and then aggregated those statistics to identify candidate loci from the outliers of the empirical distribution, with voight et al. including 1% of the distribution and wang et al. including  <dig> %. so although the wang et al. study was only slightly less restrictive, it identified over four times the number of candidate loci. one possible explanation is that frc is a more powerful statistic for detecting recent positive selection. however, voight et al. estimated that the power of ihs to detect recent positive selection was approximately 33% for the range of allele frequencies considered in wang et al. if their estimate is accurate, even if the power of the frc test is 100%, the discrepancy between the two tests cannot fully explained. additional genome scans have demonstrated that the differences in these results are not artifacts, and instead represent stable differences between the two statistics  <cit> .

while several studies have estimated the power of ehh statistics to infer positive selection, the statistical power of frc has not yet been explored. to address this gap, we use simulated data to compare the properties of frc and ehh statistics. we first examine the power of the single-site statistics of each method under explicit null models of neutrality and alternative models of selection. we then estimate the false positive rate, power, and false discovery rate of each test when applied to an empirical distribution of its respective statistic based on a combination of neutral and selected loci.

the available computational methods for simulating genealogies cannot easily model complex demographic scenarios combined with the presence of positive selection. most methods require a single population of constant size. this is problematic when evaluating the statistical power of ld-based tests in the presence of positive selection, as population bottlenecks and subdivision can create ld that mimics that generated by selection. here, we introduce a new approach for simulating positive selection in complex population histories with subdivision, migration, bottlenecks, and expansions in a coalescent framework. with this approach, we first generate a set of potential allele trajectories for the favored allele using forward-in-time simulations. then for each backwards-in-time simulation, we select an allele trajectory at random and condition the coalescent simulation on the population sizes and migration history of the favored allele as specified by the allele trajectory .

RESULTS
in our analysis, we considered one test derived from the frc statistic, alnlh, and two tests derived from the ehh statistic, lrh and ihs  <cit> . to evaluate the effects of population history on the power of each of these statistics, we considered four demographic models: constant population size, expansion, expansion with migration, and bottleneck with migration. for the final three models, we obtained parameter values from the best fitting model in  <cit> . from this model, we used africa to represent the expanding population and europe to represent the bottlenecked population. for histories with migration, we allowed low levels of migration between europe, asia, and africa as specified in their model  <cit> . for selection models, we used the estimate for the average strength of recent positive selection in humans of s =  <dig>  from  <cit> . we set the origin generation of the favored allele for each model to produce an average allele frequency of approximately  <dig> , which met our goal of providing coverage for allele frequencies between  <dig>  and  <dig> .

throughout the analysis, we calculated two versions of the frc statistic. as originally presented by wang et al., frc is calculated from unphased data using the individuals homozygous for each allele at the focal site  <cit> . however, the two ehh tests we evaluated, lrh and ihs, are calculated from phased data  <cit> . this introduces a complication when directly comparing the statistics with simulated data, since alnlh will have lower power than it would otherwise because it ignores information about phase that is available to the other two tests. to account for this, we calculated both a phased and unphased version of the statistic, alnlhp and alnlhu, with the phased statistic using information from both homozygotes and heterozygotes to infer frc. as shown in figure 1a, the power of the unphased statistic was much lower than the phased statistic when one of the alleles is relatively rare, but as the allele frequency approaches  <dig>  the two statistics were essentially equivalent. throughout our analysis, we make the simplifying assumption that gametic phase is known, when in practice it can only be estimated. while this assumption may bias our evaluation of alnlhu, the effect should be small given the accuracy of current phase estimation technology and that alnlhu ignores information from all heterozygote comparisons  <cit> .

in general, the properties of ihs and alnlhp were similar when the recombination rate was constant . the power of both tests increased substantially with the size of the simulated region out to  <dig> kb, beyond which there was little improvement, as shown in figure 1b. both statistics performed very well even at low critical levels, with an average power of over  <dig>  at the  <dig>  level . the statistics also perform well across the range of allele frequencies we tested, with an average power of over  <dig>  at the  <dig>  level for allele frequencies between  <dig>  and  <dig>  . both statistics maintained high power across all of our demographic models, though ihs was more sensitive to expansions, bottlenecks, and migration . the performance of the statistics diverged when we introduced variable recombination rates to the models. while both tests were negatively impacted, the effect on alnlhp was much greater, as shown in figure  <dig>  on average, the power of alnlhp dropped by 46%, while ihs dropped by only 8% for . this directly reflects the strength of the internal controls for local recombination rates within each test. for ihs, there is no measure of global recombination rate, and the measurement of ld is based solely on the relative difference in ld between the two alleles at each site  <cit> . for alnlhp, the global recombination rate is based on the observed decay of ld at g6pd and the genome deviation from the g6pd model  <cit> . the test controls for local recombination rate by ignoring all sites where the observed ld is greater than  <dig> standard deviation above the mean for both alleles. therefore, positive selection is difficult to detect in regions with high recombination rates, as discussed by wang et al. <cit>  in their analysis of positive selection at the drd <dig> gene.

for the results presented above, we calculated a statistic for each snp and evaluated the power to detect selection, with the null hypothesis of neutrality and the alternative hypothesis of strong positive selection acting on the snp in question. this is an appropriate test for positive selection when the investigator has a prior hypothesis about the potential influence of natural selection and when there are a small number of candidate loci. however, as we demonstrate below, when this simple strategy is applied to an uninformed scan across the genome, it introduces a multiple testing problem that heavily weights the significant results toward false positives. the testing methodology that voight et al.  <cit>  employed for ihs addresses this problem by binning the genome into  <dig> kb segments, and then calculating the fraction of snps in each segment with |ihs| greater than  <dig>  as their test statistic. this approach takes advantage of the tight linkage of genetic hitchhikers near the favored locus to reduce the number of tests from the number of snps in the study to the number of  <dig> kb regions in the genome. their candidate genes were those in regions with the highest fraction of significant ihs scores, taking the top 1% of the empirical distribution. by lowering the criteria for a significant ihs score and considering the total fraction of significant results, they were able to test each  <dig> kb region one time at the  <dig>  level. in contrast, wang et al. set a higher threshold for a significant result and tested each snp individually, taking the top  <dig> % of the distribution. all genes within  <dig> kb of a significant result were included as candidate genes, which resulted in potentially hundreds of tests at the  <dig>  level for each  <dig> kb region  <cit> .

discussion
from our evaluation of false discovery rates, we can estimate the number of false discoveries for each genomic scan. of the  <dig> candidate genes identified by wang et al.  <cit> , we estimate that  <dig> to  <dig> of those were false discoveries. for voight et al.  <cit> , we estimate that there were  <dig> to  <dig> false discoveries over  <dig> candidate genes. the estimates for true discoveries are then  <dig> to  <dig> for wang et al.  <cit> , and  <dig> to  <dig> for voight et al.  <cit> . so after adjusting for false discoveries, the two studies are in close agreement. given our true discovery and power estimates for ihs, we estimate that there are between  <dig> and  <dig> variants with an allele frequency of at least  <dig>  that have been influenced by strong recent positive selection in the hapmap phase  <dig> populations.

while the single-site statistics used in these studies perform equally well under simulations with constant recombination rates, several factors inhibited the performance of alnlh. these factors primarily involve implementation details of the test and not the properties of the frc statistic itself. since both alnlh and ihs methods measure the long range ld for each allele at each focal site, it may be possible to design a test based on the frc statistic that matches or exceeds the performance of ihs using the voight et al. implementation as a template  <cit> . five features that should be included in such a test are local controls for recombination rate, standardization for allele frequency, population specific critical regions, external inference of gametic phase, and the aggregation of results at nearby loci to mitigate multiple testing problems. while a future frc test may prove more valuable, the false positive and false discovery rates are too high in the current alnlh implementation to provide a useful set of candidate genes in genomic scans.

throughout our analysis of ehh statistics, ihs consistently outperformed lrh. since specific guidelines are not available for determining the core haplotype region and level of ehh decay for lrh, we may have underestimated the power of lrh. however, we tested  <dig> sets of parameter values using examples in sabeti et al. as a guide  <cit> , and none of the tests were able to match the performance of ihs in any of our scenarios.

our estimates for the power of the ihs test were consistently higher than those reported in voight et al.  <cit> , but it is important to distinguish between our single-site analysis vs. our site-aggregation analysis when comparing the two results. figures  <dig>   <dig>  and  <dig> report the power of the single-site statistic, which is based on one ihs value measuring the decay of ld surrounding one snp. this is not directly comparable to the power analysis in voight et al., which was based on the aggregation of  <dig> ihs scores for snps near the favored allele  <cit> . this aggregation strategy successfully mitigates the multiple testing problem inherit in a full genome scan by incorporating information from potential genetic hitchhikers near the favored allele. however, as demonstrated in the comparisons between figures  <dig> and  <dig>  the power of the site-aggregation test is appreciably lower than the single-site test. this tradeoff is worthwhile for uniformed genome scans involving large numbers of snps, since it reduces the number of tests by one or more orders of magnitude. however, candidate gene studies that involve only a few potential targets of selection do not suffer from the same multiple testing problems as full genome scans. for these studies, the single-site ihs test is a better choice, providing an average power of  <dig>  at the  <dig>  level according to our estimates .

there are two other considerations when comparing the power analysis from voight et al.  <cit>  with the results from this study. first, voight et al.  <cit>  established critical values from null models with histories of population bottlenecks, but tested those values against selection models where the population size was constant. because population bottlenecks also introduce ld, this resulted in conservative critical regions and lower power. second, our strategy for simulating ascertainment bias resulted in higher snp density and more low frequency alleles compared to voight et al.  <cit> , which probably elevated the power of the test in our analysis when the favored allele was relatively rare.

as pointed out by przeworski et al., empirical scans for selection will miss many selection events when they are applied to genomes that have been heavily influenced by recent positive selection  <cit> . this is evident in figure 4a, where the power of ihs is  <dig>  when selective sweeps are very rare,  <dig>  when 1% of the genome is influenced by positive selection, and drops to  <dig>  when just 5% of the genome influenced by selection. this effect could be mitigated by choosing critical values from a subset of the genome that has a smaller proportion of recent selection events. we expect a priori that nongenic regions are less likely to be targeted by selection. this expectation is supported in voight et al.  <cit> , where they demonstrated a highly significant enrichment for genic regions within the group of loci identified as potential targets of positive selection . by establishing critical regions from nongenic regions, it may be possible to substantially improve the power of genome scans for recent positive selection with only a small increase in false positives.

CONCLUSIONS
in agreement with previous findings, our results demonstrate that the multi-site ihs test is an excellent test for detecting incomplete selective sweeps in full genome scans, with power between  <dig>  and  <dig>  and false discovery rate between  <dig> and  <dig>  at the  <dig>  level. in comparison, the power of the alnlh test in full genome scans was approximately 25% lower with a false discovery rate between  <dig>  and  <dig> . however, the statistical properties of the two statistics are quite similar when applied to a single site in a candidate gene test, with power of over  <dig>  at the  <dig>  level, demonstrating the importance differences in the adjustments made for multiple tests in full genome scans. our results highlight the need for careful consideration of multiple comparison problems when evaluating and interpreting the results of full genome scans for positive selection. the algorithm we present for simulating genealogies influenced by positive selection will allow for more thorough exploration of complex demographic scenarios when evaluating methods for detecting positive selection.

