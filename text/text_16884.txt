BACKGROUND
the promise of comparative genomics among the nematodes has motivated sequencing in caenorhabditis elegans, c. briggsae, c. brenneri, c. remanei, and c. japonica  <cit> . while the c. elegans genome has been extensively annotated, relatively little information is available for the other caenorhabditis genomes  <cit> . in addition, the genome of the distantly related nematode brugia malayi was recently published  <cit> , and those of many other nematodes are currently being sequenced such as pristionchus, haemonchus, meloidogyne, and trichinella. an essential step in the analysis of these genomes will be to identify and annotate their protein-coding genes, but it is not known which gene prediction systems perform best on nematode genomes. to address this issue, the nematode genome annotation assessment project  was launched to assess the accuracy of protein-coding gene prediction software in c. elegans, and then to apply this knowledge to annotating other caenorhabditis genomes.

the ngasp project parallels recent computational prediction initiatives including casp for protein structure prediction  <cit> , gasp for drosophila gene prediction  <cit> , and egasp for human gene prediction  <cit> . scientists working in the field of computational gene prediction were invited to participate in ngasp. participants were provided with training and test sets, each comprising ten non-overlapping 1-mb genomic sequence regions, representing ~10% of the c. elegans genome. we also provided auxiliary data to the participants to use for training their gene-finders. the auxiliary data included multi-genome alignments between c. elegans, c. briggsae and c. remanei, and alignments of ests, mrnas and proteins to the c. elegans genome.

ngasp was conducted in two phases. the first phase of the competition was open to all gene prediction programs and was divided into three categories: category  <dig> predictions were based on genomic sequence alone ; category  <dig> was open to gene-finders that use nucleotide level multi-genome alignments; and category  <dig> predictions encompassed gene-finders that take advantage of alignments of expressed sequences such as proteins, ests, and assembled mrnas. after the first phase of the competition was complete, we posted the output of each of the predictors to the ngasp web site . we then began phase two of the competition, which was open to 'combiners' , defined as gene prediction systems that use gene models created by other annotation software, and any of the data used as input for the phase one gene-finders. to assess the accuracy of the submitted predicted gene sets, we quantified their sensitivity and specificity in predicting coding regions by using the metrics from gasp  <cit>  and egasp  <cit> . here, we describe the performance of the most accurate gene-finders in c. elegans, identify some common features of c. elegans genes that the majority of gene-finders find hard to predict correctly, and discuss the choice of gene predictors for the annotation of the newly sequenced genomes of other nematode species.

RESULTS
submitted gene sets
seventeen groups worldwide participated in ngasp, and submitted  <dig> prediction sets for  <dig> mb of the c. elegans genome . several groups submitted predicted gene sets for more than one category, or more than one entry per category generated by running their programs under different parameter sets. the submitted gene sets, and the details of the parameters used to make them, are available on the ngasp ftp site .

1the geneid gene set was submitted after the ngasp deadline. the research groups that participated in ngasp, the names of the software used to produce gene prediction sets, and the number of gene sets submitted in each of the ngasp categories by a research group, are given. there were four ngasp categories: category  <dig> predictions were made by ab initio gene-finders; category  <dig> predictions by gene-finders that use multi-genome alignments; category  <dig> predictions by gene-finders that take advantage of est/mrna or protein alignments; and category  <dig> predictions by gene prediction systems that use gene models created by other annotation software, and any of the data used as input for gene-finders in the other three categories. here 'cat3:2' means that  <dig> gene sets in category  <dig> were submitted. in some cases a group submitted two gene sets produced by using different parameters of their software to the same ngasp category.

procedure for evaluation of gene-finding accuracy
the 10-mb of test dna sequence consisted of ten non-overlapping 1-mb genomic regions of the c. elegans genome . the gene predictions submitted to ngasp were evaluated using two reference gene sets drawn from wormbase :  ref <dig>  a 'sensitivity/accuracy' set consisting of genes from the test regions that were supported by full-length cdnas across their entire coding region, and  ref <dig>  a 'full set' that contained all manually curated genes from the test regions . the ref <dig> set includes both confirmed and unconfirmed gene models. most of the unconfirmed gene models were initially based on predictions from the genefinder software , but most of these have since been changed by manual curators on the basis of experimental data. ngasp differed from the drosophila gasp  <cit>  and human egasp  <cit> , in that curated gene structures for c. elegans were already publicly available, but participants were requested to not consult wormbase, genbank or other databases for the curated gene models in the test regions.

the ten 1-mb regions of the c. elegans genome provided to the ngasp participants for training their gene-finders, and ten 1-mb test regions in which they were asked to make gene predictions for the ngasp assessment.

we assessed sensitivity  using the ref <dig> reference and specificity  using the ref <dig> reference. here sensitivity is defined as the proportion of real features  that have been correctly predicted in a particular gene set, while specificity is the proportion of predicted features in that gene set that correspond to real features. note that the metric sp is referred to as the positive predictive value or precision by statisticians, but consistent with previous work in the gene prediction field  <cit>  we use the term 'specificity'. for each submitted gene set, we assessed its ability to accurately predict protein coding regions at the base, exon, isoform and gene levels, following the sensitivity and specificity definitions above, which were also used by egasp  <cit> . the least stringent metrics were base level sensitivity and specificity, which measure whether a gene predictor is able to correctly classify a base as coding. exon level metrics measure the ability of a gene prediction system to identify the exact left and right borders of the protein-coding regions of exons in the reference sets. by 'exon', we mean the protein-coding part of an exon . isoform level accuracy is the most stringent test. one c. elegans gene can produce several alternative spliced transcripts. for the purposes of ngasp we considered only the protein-coding portion of a transcriptional isoform, and scored a correctly predicted isoform if the protein-coding portions of all its exons were predicted accurately and no extra full or partially protein-coding exons were predicted. the gene level assessment of accuracy was intermediate in stringency between the exon and isoform levels. to be scored correct at the gene level, a gene predictor had to call at least one of the gene's isoforms correctly.

results from evaluation of gene-finding accuracy
the best submitted gene prediction sets had base level sensitivity in excess of 99% and specificity of more than 93% . this means that the best gene predictors are able to identify almost all the protein-coding bases in the c. elegans genome and only occasionally predict that a non-coding base is coding. at the exon level, the best submitted gene sets had sensitivities of more than 91% and specificities of more then 83%. thus, although most gene-finders identify most true coding bases correctly, they often do misidentify the boundaries of protein-coding exons. at the base and exon levels, specificities were lower than sensitivities. this may reflect a number of inaccurate gene models in the ref <dig> gene set, which included gene models not fully supported by transcript evidence, and perhaps also reflects exons that are missing from the ref <dig> gene set.

1after the evaluations were complete, the gramene developers discovered an error in their pipeline which incorrectly moved the end of the coding region by  <dig> bp in a significant fraction of their gene predictions, and this negatively affected the overall performance of gramene.

the accuracy of the submitted gene sets evaluated using the reference gene sets ref <dig> and ref <dig>  the sensitivity  results are given for reference set ref <dig>  and the specificity  results are given for set ref <dig>  the gene sets are divided according to ngasp category, where category  <dig> is ab initio gene-finders,  <dig> is gene-finders that used multi-genome alignments,  <dig> is gene-finders that used alignments of ests, mrnas and proteins, and  <dig> is combiners.

the ultimate goal of a gene predictor is to predict entire genes correctly, including every alternative isoform. however, in practice gene-finders do not predict alternative isoforms of a gene very well. at the isoform level, the best gene sets had sensitivities of about 66% and specificities of about 56%. that is, the best gene-finders each missed about 34% of true c. elegans isoforms, indicating that gene-finders still need improvements in predicting alternative splice forms. at the gene level, the best submitted gene sets had sensitivities and specificities in excess of 80% and 58% respectively. that is, for 80% of genes in the ref <dig> reference set, the best gene predictors called at least one splicing isoform correctly across the entire length of its protein-coding region.

the isoform level is the most stringent level of assessment. however, given the low success of most gene-finders for predicting alternative splicing, gene level accuracy is generally considered more important for the purpose of annotating a newly sequenced genome such as that of caenorhabditis remanei. that is, it is considered more important to predict at least one isoform of each gene correctly, rather than to predict all isoforms of one gene correctly and no isoforms of a second gene correctly. at the gene level, the most accurate gene-finders were combiners . gene predictors that use alignments of ests, mrnas and proteins came in second place. combiners had higher sensitivity than algorithms that used expressed sequence alignments at the gene level . however, in terms of specificity, there was no significant difference in gene level accuracy between combiners and gene predictors that used transcript and protein alignments . thus, by using diverse data such as expressed sequence alignments, multi-genome alignments and gene sets from different gene-finders, combiners improved the sensitivity of their predictions above those based on expressed sequence alignments alone. this agrees with egasp  <cit> , which reported that combiners had higher gene level sensitivities for human genes compared to gene-finders that used expressed sequence alignments alone   <cit> .

at the gene level, prediction algorithms that used expressed sequence alignments had higher sensitivity than ab initio gene predictors , as well as higher specificity . this demonstrates that use of expressed sequence data leads to considerable improvements in the accuracy of gene-finders for c. elegans. this mirrors the findings of egasp, which also reported higher gene-sensitivities for gene-finders that used transcript or protein alignments compared to ab initio gene-finders , as well as higher gene-specificities   <cit> .

there was a tie for third place between gene prediction algorithms that used multi-genome alignments and ab initio gene-finders. the addition of multi-genome alignments to c. briggsae and c. remanei gave no statistically significant improvement in accuracy over ab initio predictions. this was surprising, as the egasp project reported that gene-finders that used multi-genome alignments were more accurate than ab initio gene-finders for predicting human genes, in terms of both gene level sensitivities  and specificities . this may reflect the relatively high gene level accuracy of ab initio gene-finders in c. elegans , compared to human   <cit> , probably due to the compact nature of the c. elegans genome. in addition, it is possible that the evolutionary distances separating c. elegans, c. briggsae and c. remanei are less suited for inference of protein coding genes from multi-genome alignments than the corresponding set of vertebrate genomes used in the egasp study. furthermore, a difference in the way that the reference sets were defined for ngasp and egasp could contribute to the observed difference in accuracy. for example, ngasp's use of different reference sets to estimate sensitivity and specificity might lead to different results compared to egasp, which relied on a single set of reference genes to calculate both sensitivity and specificity.

in both ngasp and egasp, the best gene-finders were combiners. however, in ngasp the median gene level sensitivity of combiners was 78% and specificity was 42%, while in egasp the median gene level sensitivity of combiners was 70% and specificity was 52%  <cit> . in c. elegans, about 8% more of the true genes are predicted correctly, but 10% fewer of the gene predictions made are structurally correct. the lower specificity in c. elegans suggests that there are more real isoforms and/or real genes missing from the c. elegans curated gene set, compared to the human curated gene set. this could be due to the far smaller amount of transcript data available for c. elegans or more conservative manual curation of weakly supported isoforms or genes by the wormbase staff. using the average of the sensitivity and specificity as an overall metric of accuracy, the c. elegans combiner gene sets were slightly less accurate  than the human combiner gene sets . however, it should be noted that some of the difference in accuracy between ngasp and egasp may be due to the different test sets used.

in the results shown in table  <dig>  we calculated the accuracy of the phase  <dig> gene sets  in the 3' halves of the phase  <dig> test regions, while we calculated the accuracy of the phase  <dig> gene sets in the entire phase  <dig> test regions. to investigate whether this introduced a bias, we also calculated the accuracy of the phase  <dig> gene sets in the 3' halves of the phase  <dig> test regions. the sensitivity and specificity of the phase  <dig> gene sets were  <dig> % and  <dig> % lower on average in the 3' halves than in the entire phase  <dig> test regions . the source of this difference is not clear. however, as a result, when we look only at the 3' halves of the phase  <dig> test regions, the difference in accuracy between combiners and phase  <dig> gene sets is slightly greater than that shown in table  <dig> 

factors affecting gene-finding accuracy
to understand which factors affect the accuracy of gene-finders in c. elegans, we identified features of genes that were not predicted correctly by the ab initio gene-finders, gene-finders that used multi-genome alignments, and gene-finders that used expressed sequence alignments. the percentage of gene sets in which a true gene was predicted correctly  was found to be correlated with nine features of genes :

 the lowest 'hexamer score' of any of the exons in the gene , using the score based on the frequency of 6-bp words from genefeatures in the acedb software  <cit> ,

 the number of exons in the gene ,

 the length of the shortest exon in the gene ,

 the length of the longest intron in the gene ,

 the strength of the translation start signal , as measured by genefeatures,

 the lowest score of any of splice sites in the gene , as measured by genefeatures,

 the percent identity with the c. briggsae ortholog at the amino acid level , based on an alignment from the treefam database of gene families  <cit> ,

 the maximum distance to a neighbouring gene , and

 the number of isoforms in the gene .

that is, the c. elegans genes that are hardest for gene-finders to predict correctly are those with an exon of unusual hexamer content, lots of exons, a very short exon, a very long intron, a weak translation start signal, a weak splice site, a poorly conserved ortholog, as well as those that are far from their nearest neighbours, and those with many isoforms. we suggest that developers of gene-finding programs should concentrate on improving accuracy on these types of genes. the correlation with these features tended to be stronger for ab initio gene-finders than expressed sequence-based gene-finders . for example, the correlation with the lowest hexamer score for the exons in a gene was higher for ab initio gene-finders than for expressed sequence-based gene-finders . we observed weak or nonexistent correlations with other features that we examined, such as the length of the longest exon in a gene , length of the shortest intron , whether the adjacent genes are on the same strand , existence of embedded genes with a gene's introns , whether a gene is member of an operon , whether neighbouring genes are paralogs , and whether the gene overlaps a simple repeat or transposable element .

there were  <dig> genes that were missed in all of the category  <dig>   <dig> and  <dig> gene sets, which must be the most difficult-to-predict: c06g <dig>  , c08g <dig> , c33h <dig>  , c55f <dig> , d <dig> , f18e <dig> , r04e <dig> , r04e <dig> , t07d <dig> , t07f <dig> , y105e8a. <dig> , y43h11al. <dig>  y48g8al. <dig>  y54e5b. <dig> , y55f3br. <dig>  zc <dig> , zc <dig>  , and zc <dig>  . several of these genes have unusually long introns of >  <dig> bp , unusually short exons of <  <dig> bp , poorly conserved orthologs , lots of exons , or are very far from one of their neighbours .

new gene sets for c. remanei, c. brenneri, c. japonica and brugia malayi
to judge which gene-finders in each category performed best, we used the average of the gene level sensitivity and specificity for a gene set as a metric of overall accuracy. in collaboration with several of the ngasp contributors, we are assembling new gene sets for c. elegans, c. briggsae, c. brenneri, c. remanei, c. japonica and brugia malayi using the three best performing of the gene-finders that used transcript/protein alignments: mgene , augustus <cit>  and fgenesh <cit> . the best performing combiner, jigsaw <cit> , is being used to combine the mgene, augustus and fgenesh predictions into a single ngasp gene set for each species that will form the basis of curated gene sets for the new genomes and will be used to improve curated gene models in c. elegans. all gene sets will be available from  and will also be displayed in the genome browsers for these species at .

CONCLUSIONS
this experiment establishes a baseline of gene prediction accuracy in caenorhabditis genomes, and is guiding the choice of gene prediction systems for the annotation of newly sequenced genomes for caenorhabditis and other nematode species. at present, combiners are more accurate than other classes of gene prediction algorithms in c. elegans. however, the accuracy of the combiners would presumably benefit by increasing the accuracy of the component gene prediction sets that they are given. we have also identified features of c. elegans genes that are difficult to predict for ab initio gene-finders and gene-finders that use transcript-, protein- and multi-genome alignments, and hope that leaders in the gene prediction field will rise to the challenge of improving accuracy on such genes.

