BACKGROUND
jacob
 <cit>  stated that "nature is a tinkerer and not an inventor". we still use a similar thought relating protein evolution, since domains are accepted as the protein evolutionary modules, and its modular reuse has been demonstrated in all domains of life
 <cit> . this modularity gives protein structures enhanced flexibility
 <cit>  and might influence its ability to respond to selection. this ability is of main concern for evolutionary biology and is related to the robustness of a system
 <cit> . robustness is the ability of a system to maintain its function under perturbations. a robust system neither increases nor decreases heritable phenotypic variation
 <cit> . in the protein world, the phenotype is the structure and the phenotypic variance is given by slight variations in protein structure shape.

in organismal biology, the coordination of subunits within a whole  has long been known as morphological integration
 <cit> , which was renamed by evolutionary developmental biologists as modularity . the modularity of a system is a property that is closely related with both evolvability and robustness
 <cit> . such a property allows a system to increase its evolvability by diminishing adaptative constraints as well as giving the system the possibility for plasticity and the emergence of novel functions by rearranging the modules
 <cit> . as stated in
 <cit> , integration and modularity concern the degree of covariation between parts of a structure. it is important, from an evolutionary viewpoint, to determine whether a structure is a single unit or consists of several modules. in molecular biology, the modularity of systems has been used to an extent, but more work has been done in systems biology
 <cit>  including analyses of metabolic networks
 <cit> , cell signaling networks
 <cit> , and protein interaction networks
 <cit> . in the context of protein architecture, modularity has been used to refer to modules of exon shuffling
 <cit> , and complexes of enzymatic machineries
 <cit> . some approaches to protein structure modularity have also been explored
 <cit>  showing modules as domains
 <cit>  and also as sub-domain components
 <cit> . however, the criterion to define protein modules depend on the definition of a proper quantitative treatment, which is not a trivial problem
 <cit> .

there have been different attempts to identify modules in protein structures
 <cit>  such as highly conserved close loops
 <cit> , foldons, and autonomous folding units
 <cit> . some of the aforementioned modules can only be identified experimentally and/or in single proteins. another way, particularly robust, to perform modular decomposition is by using community detection algorithms
 <cit>  which have been applied extensively in system biology
 <cit>  as well as to the protein structure modularity identification problem
 <cit> . however, most of these attempts only consider the contact matrix
 <cit> . this approach bears no evolutionary information and depends exclusively in the definition of contact between residues
 <cit> . we postulate that correlation information across a group of homologous structures  is more relevant than molecular contact alone.

the analysis of graphs has become crucial to understand the features of different systems
 <cit>  such as community structure
 <cit> . several clustering algorithms have been developed  and applied successfully to different kinds of networks, such as networks of email messages
 <cit> , biological, and social networks
 <cit> . however, all clustering techniques including the graph-based ones, lack a statistical framework to determine the significance of the inferred clusters. this may lead to results that may not be biologically meaningful. in this paper we present a graph theory-based clustering method that includes a test of statistical significance, a power test, and a test for the accuracy the estimates giving the sample size . to do this, we propose a permutation-based t-test to assess statistical significance, and power test based on
 <cit>  to assess the reliability of the estimates. we also propose a bootstrap test and a power analysis to infer cluster robustness. these tests are applied to coordinate data, but can be generalized to other applications. here a module is defined as any group of residues that has significant correlation within the group  and such correlation within is significantly higher than the one obtained when correlating this residues with residues of other groups in the dataset. to assess performance and illustrate the method, a simulation with one correlating module against background noise and one with two modules were performed. we also analyzed two different kinds of protein structure data sets: dynamic modularity from a molecular dynamics simulation of the niemann-pick c <dig>  protein, and evolutionary modularity from the α-amylase homologs. the former protein is part of a complex of two proteins  required for the cholesterol to exit the lysosomes
 <cit> . the npc <dig> n-terminal domain binds to the cholesterol in an orientation opposite to npc <dig>  mutations of npc <dig> n-terminal domain are involved in the development of the npc <dig> disease, an inherited disorder associated with lipid metabolism
 <cit> . therefore, it is important to know its dynamics in solution and identify probable sub-domain architecture that can be related with function. the latter dataset  is a digestive enzyme that, by acting at random locations along the starch chain, hydrolyses the α- <dig>  bonds of larger polysaccharides yielding glucose and maltose
 <cit> . it is a phylogenetically widespread type of hydrolases with multiple industrial uses
 <cit> . these enzymes are multidomain proteins, but share a common catalytic domain in the form of a 8-barrel
 <cit>  which might give insight into fold evolution of the tim-barrel, and the rise of its catalytic activity.

methods
here we develop a method to explore the sub-domain architecture. to do so we proceeded as follows: 

 <dig>  create test datasets: the input data  are cartesian coordinates of simulated data  or coordinates of residues in the protein datasets .

 <dig>  align the structures when needed: in the case of the simulations  there is no need to align, since they all share the same plane, and absolute rotation .

 <dig>  extract the information as landmarks  and residues contact matrix .

 <dig>  create a graph where each landmark is a node and they are connected if significant correlation is found .

 <dig>  test if the partition of the data  is statistically significant .

 <dig>  test for statistical power of each partition .

 <dig>  test for the stability of the partition to sample size: bootstrapping .

input data
multivariate normal simulation
to test the method in known modular entities, two simulations were performed using cholesky decomposition. first a multivariate normal random vector was generated as ly, where y was a vector of independent n variates. a matrix of correlated variables llt was created by cholesky decomposition of the correlation matrix of the form:

 1⋯ρ0⋯0⋮⋱⋮⋮⋱⋮ρ⋯10⋯00⋯01⋯0⋮⋱⋮⋮⋱⋮0⋯00⋯ <dig> 

the result is a matrix with a set of correlated variables , surrounded by random  variables. cluster intracorrelations ranged from  <dig> to  <dig> in increments of  <dig> . the first  <dig> entries  had a given correlation, while  <dig> entries  where uncorrelated.

a simulation was also performed to evaluate the effectiveness in solving the boundaries of two modules. in that case, the correlation matrix was:

 1⋯ρ10⋯0⋮⋱⋮⋮⋱⋮ρ1⋯10⋯00⋯01⋯ρ2⋮⋱⋮⋮⋱⋮0⋯0ρ2⋯ <dig> 

the resulting matrix contains two cluster which intracorrelations ranged from  <dig> to  <dig> in increments of  <dig> .

the output of the simulation is a set of coordinates for a given number of samples to which the method  will be applied.

molecular dynamic simulation of npc1
the niemann-pick, type c <dig>  n-terminal domain was simulated in solution with the ligand , using the software gromacs 4
 <cit> . the force fields modes used for the simulations were opls-aa/l for the protein, and the tip3p for the water molecules. the data was collected every two picoseconds for  <dig> nanoseconds discarding the first  <dig> nanoseconds of simulation. all other parameters where left as default. this process was performed using  <dig> cpu cores on a computer cluster, in triplicates. four thousand samples where gathered and analyzed. the data includes the coordinates for each atom of each residue for the npc <dig> protein simulated across snapshots of the simulation. this dataset was ensemble to test the method  in dynamic data. that is, to find correlating residues for a protein in solution.

α-amylase catalytic domain homologs
in homstrad database, the structures are manually curated guaranteeing the homology between them, and avoiding redundant structures
 <cit> . however, the sample size is reduced with this curation . here we used the structures in the homstrad data set to fetch other structures with over 80% sequence identity available at the protein data bank . with this procedure we increased our sampling, gathering  <dig> structures which pdb codes and species can be seen in table
 <dig> 
α 
-amylase homologs and the species from it was crystallized

only the chain a, corresponding to the catalytic domain, was used.

structural alignment
the flexible structure aligner matt with default parameters was used to align the structures and therefore deals with rotation, translation and natural deformations. this method allows local geometric flexibility for protein structures producing alignments with low root-mean-square deviations , and estimating a p-value expressing the likelihood that a given alignment score can be generated by the alignment of unrelated proteins
 <cit> . the multiple structure alignment outputted by matt is then processed and analyzed as explain in the subsequent sections.

landmark definition
a landmark is a point, vertex, site or control point in a shape object  that can be found repeatedly  in a group of such objects
 <cit> . here we define a landmark as the centroid of homologous residues in a multiple structure alignment. the residue centroid is used to include both sequence  and geometry, as opposed to only the geometry of the backbone. to do this the coordinates of all heavy atoms  are taken into account.

inter-residue contact definition
inter-residue contact maps are a widely used approach to analyze protein structures
 <cit> . they are also important to understand protein folding and stability
 <cit> , and to identify residues playing structural and/or functional roles
 <cit> . despite this and the advances in the contact definition , accurate contact map predictions are still mainly unsolved. there are some proposed tests
 <cit>  and software
 <cit>  but they are mainly using cα-cα or cβ-cβ distances with a threshold of about  <dig> to  <dig> Å
 <cit> . however, these types of contacts are a mere approximation to true contacts. here we defined a contact between any two residues if the distance between them is equal or less than  <dig>  Å in an all-atom  contact analysis. the all-atom approach is more accurate since it takes into account the distance between each possible pair of atoms in two side chains.

graph construction
assume that we have a dataset made of n observed protein structures . for each of these structures, the input data matrix is composed of k landmarks. here a landmark is defined as the cartesian coordinates in three dimensions of the centroid of a residue. this centroid is calculated using the residue’s side-chains . to deal with dimensionality, the original data matrix is split into its components  and, for each dimension, a correlation matrix between landmarks is computed. for each entry in each dimension, we test the significance of the correlation coefficient. this coefficient is set to  <dig> if it meets the following criteria:

  12log1+r1-r<zα 

where the left-hand side of the equation  <dig> is the fisher transformation of the estimated correlation r. the right-hand side of the equation  <dig> is the critical value for an alpha-level test of the null hypothesis that the correlation is  <dig>  there, the zα is the standard score which allows us to calculate the probability of a value occurring within our normal distribution and compare scores from different distributions.

this step is done to simplify the graph building process such that insignificant correlations are ignored.

the overall magnitude of the correlation vector is calculated as:

  Ξ=∑i3pi <dig> 

where the value for the ith dimension, pi, is either r or  <dig> depending on the result in . the Ξ are obtained for each pair of landmarks and assign the edges of an undirected graph s, using the python-igraph library
 <cit> .

the summation in equation  <dig> is performed to agglomerate the dimensions . since r is not additive and r <dig> is, the sum of r <dig> is the appropriate way to add the correlations without violating non-additivity. also, Ξ is the correlation vector magnitude that guarantees that if there is any correlation in any of the dimensions, Ξ will include it, regardless of the vector direction. let us assume that a given residue is highly and significantly correlated in the x axis, but poorly and/or not significantly correlated in y or z axes. Ξ will reflect such correlation since the residues must behave completely independent for Ξ to be zero or close to zero.

graph abstraction
let s =  be an undirected graph, where n is a list of nodes , and f is a function
f:n×n→k that assigns an edge weight to each landmark pair. an edge eij is assigned only if Ξij >  <dig>  and if the residues are in contact. the edge weight value is set to Ξij.

community structure or clustering optimization
with the defined graph, the community structure is assessed using a fast-greedy approach, since it is an efficient way to detect clusters
 <cit> . clusters are defined by finding the partition of landmarks that maximizes the modularity index 
 <cit> :

  q=12m∑vwavw-∑wavw∑vavw2mδ 

where m is the number of edges in the graph, avw represents the weight of the edge between vertices v and w,
∑wavw and
∑vavw are the weighted degree of a vertex , defined to be the sum of the edge weights of the adjacent edges for each vertex. cv and cw are communities to which the vectors v and w belong to, and the δ is a binary function where δ is  <dig> if cv = cw and  <dig> otherwise.

the modularity index  is then the proportion of edges shared within groups minus the expected proportion if edges were distributed at random. for a given partition, q indicates the density of nodes within groups when compared against a random distribution of connections regardless the partition. q ranges between - <dig> and  <dig>  if positive, there are more connections inside the module than expected by chance and therefore a possible community structure
 <cit>  . in our case, a partition made by the optimization of q is a group of residues that correlate in space  given the sample. if the sample is across homologous proteins, the cluster or partition represents a concerted movement in the evolution of the protein. sampling across molecular dynamic simulation snapshots represents parts of the protein that are moving together in solution.

the output is a membership vector that corresponds to the community structure  in the graph of landmarks. it is interpreted as a set of clusters which number is given by the optimization procedure and therefore there is no need for an a priori determination of the number of clusters to be obtained. each cluster is assumed to be a putative module but this membership vector provides no support or information about its statistical robustness and significance.

statistical significance test of clusters: controlling the false positives
despite the usefulness and ubiquity of tests using similar algorithms, the question of significance of clusters is critical since there is no support for the obtained clusters, and therefore its validity is questionable. to test if each cluster is significant, a permutation t-test
 <cit>   is applied.

the rationale for the test is based on the definition of cluster as an entity where the distribution of correlation of the elements inside the cluster  is significantly distinct from the distribution of correlation with elements from other clusters . this test is applied for each possible pair of clusters defined by a membership vector. for a given pair of clusters, we compare the distribution of the intracorrelation for that cluster with the distribution of intercorrelations for this pair. if one cluster is artificially broken down by the clustering algorithm, there should be no significant differences between the distribution of intra and inter-correlations.

because the test is performed for a number of pairs, multiple comparisons are made. let m and m be the mean intracorrelations for two clusters a and b, found by the community detection algorithm. let m be the mean intercorrelation. the null hypothesis we test is h0 : m = m. with more than two clusters the number of comparisons  will be k, k being the number of clusters. if a single-inference procedure is used, this can result in an false increased significance which we correct for using the benjamini-hochberg false discovery rate correction  procedure
 <cit> .

for example, a given set of homologous proteins is analyzed with our method and a possible partition is obtained. this will give us different pieces of the protein that correspond to groups of residues that are correlating  more within each cluster than among clusters. we use the correlations inside a given group and test against the correlation that exist between that group and other groups. if there is no significant difference, both entities are moving together and therefore should be merged.

refinement of the membership vector
the results of the significance testing are summarized into a new graph. let graph s =  be a directed graph, where c is a list of inferred clusters, and e a list of assigned edges. there will be a directed edge from cluster cu to cluster cv if the hypothesis that m is distinct from m cannot be rejected. if cu and cv are connected by a bi-directional edge, they are merged into a single cluster. the process is iterated until no clusters can be merged.

following the example in the previous section, let’s assume that the protein dataset analyzed was partitioned into  <dig> groups of residues . each of those groups will be the vertices  in a new graph. we will draw an arrow if there is no significant differences between a given group and other . if this is reciprocal , both groups of residues are merged.

statistical power test of clusters: acknowledging the false negatives probability
the above statistical test assesses false positives . it is important as well to assess the strength of association between members of a cluster. to determine the minimum resolvable correlation for a given sample size, and for a given significance and power, let ρres be the correlation that can be resolved with a power of 1-β, and a significance level of α given the number of observations n, as suggested by
 <cit>  and implemented in the r package "pwr"
 <cit> . let γ be a function of i and j:

  γ=1ifrij≥ρres0otherwise 

where ri,j is the correlation coefficient between landmarks i and j. to assess the power of a candidate cluster c with c elements, we estimate the proportion of correlation values between landmarks of c that are larger than ρres. for each c the proportion of variables with enough power  is thus:

  pvpc=2∑1pγ 

where p is the number of pairs i,j in cluster c.

here pv pc is the estimated pvp which should be distinguished from the true pvp, that arises when the estimated rij in equation  <dig> are replaced by the actual ρij. pv pc provides a qualitative information to help interpret the results given the used sample size. figure
 <dig> shows the behavior of the pvp in the intracorrelations evaluated for  <dig> ,  <dig> , and  <dig>  observations. even in simulated data, pvp deviates from the possible values of  <dig>  and  <dig>  when the number of observations is small.

for instance, take a cluster  a that contains  <dig> elements, and  <dig> entries in the upper triangle of its correlation matrix. assume that a was inferred with  <dig> observations . with that sample size, ρres will be approximately  <dig>  with a power of  <dig>  and a significance level of  <dig> . if two thirds of the entries in the upper triangle of the correlation matrix of a are below ρres, pvpa will be equal to  <dig> . in other words, for  <dig> entries of the correlation matrix we estimate that there was a power of  <dig>  or greater. if there are clusters created by optimizing the modularity score using weakly correlated landmarks, this cluster’s pvps will tend to be close to  <dig>  this test is post-hoc, and is only to inform about the robustness of the partition created.

bootstrapping: measuring the accuracy of sample estimates
the previous tests evaluate the probability of false positives  and false negatives . however, the sensitivity to sampling error in each estimated cluster can be tested using bootstrapping techniques. the clusters for any set of n samples can be represented as a set of k bipartitions,
b <dig> …,bk, where bji =  <dig> or  <dig> according to whether the ith landmark was in the j cluster or not. the bootstrap approach repeatedly generates sets of n samples with replacement from the original data. for each of these sets of n samples, we obtain a membership vector as with the original data. all of the bipartitions from all bootstrap sets are then aggregated. the bootstrap percentage for an inferred cluster in the original dataset is calculated as the proportion of bipartitions in the aggregate set showing no conflicts with that cluster. this proportion is reported as the bootstrap value which evaluates the cluster’s robustness . from the example,  <dig> protein structures correspond to the original data from which we have the bipartitions . we create n new replicates by sampling the original data. in some occasions, the same protein structure will be picked. the bootstrap resampling evaluates the effect of possible missing data.

all methods described here were performed with original python scripts , available upon request to the authors and licensed under a gpl agreement.

RESULTS
in this section we present the outcome of two simulations to validate the method. the parameters for the simulations can be found in the methods section. we also present two real datasets. first a set of snapshots from a molecular dynamics simulation  of the npc <dig> n-terminal domain are analyzed to provide insights into the modular architecture of dynamic data. that is, group of residues that move together in solution.

then a set of homologous structures of the alpha-amylase catalytic domain are use to test the sub-domain architecture at the evolutionary level. a module here  refers to a group of residues that are moving together in the evolution of the structure.

most biological data are typically highly multivariate and multidimensional in nature. many tools have been developed to deal with such dimensionality . however, the variable selection and dimensionality reduction used in such methods  may compromise information conservation
 <cit> , or require a larger sample size than is possible for protein data. to overcome these drawbacks, we introduce a community detection-based clustering method. community detection-based approaches do not need a priori knowledge of the number of clusters
 <cit> , are not heavily parametrized, and can handle multivariate and multidimensional data without dimensionality reduction. here we propose a graph based method to explore protein structure modularity, where: 

 <dig>  a graph is built where the vertices are the centroids of residues. the correlation between coordinates is set as edge weight if it is significant , and if the two residues are in contact .

 <dig>  the community structure in the graph is inferred by fast-greedy  optimization of a modularity score .

 <dig>  the statistical support for each cluster is obtained.

 <dig>  the solution is refined based on this statistical support.

 <dig>  the statistical power to resolve each partition with respect to the size of the dataset is estimated .

 <dig>  the stability of the estimates with respect to the sampling error is measured using bootstrapping .

finally, we present the results of the analysis of two protein data sets: a molecular dynamics simulation of the npc <dig> protein, and a multiple structure alignment of the α-amylase catalytic domain homologs.

simulations
correlated landmark data was simulated using a multivariate normal simulation. intracorrelations ranged from  <dig> to  <dig> in  <dig>  increments. the parameters to make the simulations are explained in the methods section.

estimated correlations: precision of the simulations
accurate estimates of correlations were gathered for the simulation performed. however, precision varied substantially with sample size. despite this, even with low sample sizes the median correlations were close to the true values . as can be seen, some variance was allowed to make the simulation more realistic.

precision of the simulation of one module on background noise with  <dig>   <dig>  and  <dig> samples. the quantiles describe the distribution of values in the lower triangle of the correlation matrix for the full simulated data set. the background quantiles represent the distribution of values in the rest of the matrix as background noise.

precision of the simulation of two modules with  <dig>   <dig> and  <dig> samples. the quantiles describe the distribution of values in the lower triangle of the correlation matrix for the full simulated data set. the intercorrelation quantiles represent the distribution of the sub-matrix corresponding to the correlation between the two modules.

performance of the the method
in noisy data, our method is able to correctly identify and assign the membership vector at very low modular intracorrelations  when the sample size is sufficient. even for intracorrelations as low as  <dig> , if provided with more than  <dig> observations the method identifies the true cluster.

table
 <dig> shows the results of the significance tests, power analysis, and bootstrapping. the significance test controls the type i error and therefore the false positives. here it is reported for an α  of  <dig> . however, the permutation test is not able to deal with the false negatives or type ii error .

the proportion of pairs that were judged not to be in the same cluster after the permutation test , the estimated pvp for the simulated data set and the bootstrap value in the simulated datasets with  <dig>  intracorrelation and  <dig> observations. pvp is the proportion of variables in the cluster with enough power  to be resolved. the significance test critical value was corrected using the false discovery rate correction.

in simulations with correlations of  <dig> , the method was able to identify the "true" cluster  with a relatively low number of observations , and the power analysis gives an estimation of robustness. in the simulation, only cluster a has enough power  to resolve almost two thirds of the components of the cluster. the other "module" is a collection of singletons which has an estimated pvp close to zero. similarly, the bootstrap value highly supports the "true" cluster, while the group of singletons is ruled out. here we show that the significance test efficiently deals with false positives, the pvp gives information about the strength of clustering, and the bootstrap gives information about the repeatability of the clusters when re-sampling.

protein data sets
the coordinate data was collected using two different strategies. the structure of a protein was simulated using molecular dynamics  to produce molecular motion over time. from these simulations, snapshots of atomic coordinates were captured. sites that move together over time are expected to have correlating centroid coordinates. therefore any module inferred from this kind of data indicates the mechanistic component of the protein structure in solution. the niemann-pick, type c <dig>  n-terminal domain was simulated in solution, using the software gromacs 4
 <cit> . all the parameters for the md simulation are explained in the methods section.

the second type of data is based on homology. in this case, homologous structures are aligned. the centroid coordinates of sites that are packed together and interacting across the evolutionary samples are expected to correlate. a module inferred from this type of data indicates that a defined subset of the protein structure is evolving as a unit. the α-amylase catalytic domain dataset from the homstrad database
 <cit>  was used to assess clustering in an evolutionary perspective. the structures used, the sampling strategy, and the alignment method used are explained further in the methods section.

dynamic modules of the niemann pick c <dig> protein n-terminal domain
the niemann-pick disease type c  is an autosomal recessive disease, expressed when there is an error in the exogenous cholesterol trafficking and as result a lysosomal accumulation of it
 <cit> . this disease is caused by a mutation in either of the two npc proteins 
 <cit> . the niemann-pick c <dig>  protein regulates the lysosomal cholesterol transport to other intracellular compartments
 <cit> . npc <dig> contains  <dig>  membrane domains and  <dig> other domains that are in the lumen of the lysosomes
 <cit> . one of these luminal domains is the n-terminal domain which bears the cholesterol binding site
 <cit> , and has eight α-helices flanked by three β-sheets  and its sequence is highly conserved
 <cit> . npc <dig> n-terminal domain  can bind with the oxygenated derivatives of the cholesterol
 <cit>  making it an interesting domain to study dynamic properties.
 <cit> . the list of the equivalences of residues in each module can be seen in additional file
 <dig> . the images were rendered using vmd
 <cit>  and povray . panels a-f show the individual modules inferred.

figure
 <dig> shows the modules gathered when the module identification is applied to the molecular dynamics simulation of the npc <dig> n-terminal domain snapshots. all these modules showed a bootstrap above  <dig> % and a pvp over  <dig> . interestingly, all modules are related with the binding pocket, surrounding the cholesterol molecule.

the first module  encloses three cholesterol binding residues, and another binding residue to the n-acetyl-d-glucosamine . it also spans a residue associated with the development of the npc <dig> disease in adulthood
 <cit> . all other residues correlating with these seem to give structural support to the back of the cholesterol binding pocket, as well as serving as receptacles for both ligands. this region also encompasses four residues containing single nucleotide polymorphisms  for the human gene
 <cit> .

in figure
4b, a module that comprises more than half of the residues that make the sterol pocket is shown. from these residues, this module is the only one that includes the non-hydrophobic ones, being of importance in the direct protein -  <dig> β-hydroxyl interactions, as well as the water-mediated interaction with such groups. this helps in the stabilization of the bounded sterols and giving a particular stereo-specificity
 <cit> . this module is located in the bottom part of the binding pocket and can be seen as a "glue" for the secondary structures in contact with such pockets, and therefore maintaining the shape of the structure in its less movable part. this also supports the model in
 <cit> , where the sterol opening needs to move in order to uptake the cholesterol from npc <dig>  this module also contains three snps found in the human gene
 <cit> .

the module shown in figure
4c, shows the residues responsible for the water  and sterol  openings described in
 <cit>  as being of functional importance to the cholesterol uptake and the retention of it in the binding site. if some residues within this module are mutated, the cholesterol might not be taken by the protein and the niemann-pick disease is expressed
 <cit> . this module also includes two cholesterol binding sites, a residue shown to be related to the development of the disease in infantile stages
 <cit> , and a snp
 <cit> .

the module in figure
4d shows a small module that coincides with functionally important residues involved in the affinity for cholesterol binding
 <cit> . these thus may be related to the expression of the npc disease. giving that these modules are analyzed in the light of dynamics, the module in figure
4d shows that the affinity for the cholesterol mediated by these residues is given by geometric constraints induced by cholesterol binding.

figure
4e shows a module that encloses two binding residues to nag. it has also been shown that two residues are important in the development of a late infantile npc <dig> disease
 <cit> , and one snp is also enclosed. it seems to be also of structural support for the cholesterol binding pocket in the top, creating a pocket that receives the ligand.

the module shown in figure
4f encloses the α-helices  <dig>   <dig> and  <dig>  that have been shown to play an important role in the access and release of cholesterol, since its movement controls the enlargement of the sterol opening
 <cit> . this module also contains some of the residues that decrease the cholesterol transfer to the liposomes if mutated
 <cit> , as well as four snps
 <cit> . the module shown in figure
4f is therefore of functional importance for the intake and outtake of cholesterol.

since there are disease-related mutations in all of the modules, it would be important to further study the relationship between modules and protein function. the correlation within modules is large enough to think of them as units, and therefore it is probable that the residues exposed in
 <cit>  are not the only major contributors to the disease. further confirmation of the effects of mutations within these modules is needed.

evolutionary modules in the α-amylase catalytic domain
starch is the main storage of carbohydrates in plants. processing it and discovering novel poly and oligosaccharides is important for biotechnological and chemo industrial applications
 <cit> . most starch-related enzymes are classified within the α-amylase family. this family catalyzes the hydrolysis of α- glycosidic bonds of polysaccharides, and therefore is classified as glycoside hydrolases
 <cit> . this a multi-reaction catalytic family, since its members can catalyze different reactions 
 <cit> . industrially, some α-amylases are used in the production of ethanol
 <cit> , high-fructose corn syrup
 <cit> , and other oligosaccharides. it is therefore of industrial and biological importance. it has a highly symmetrical tim-barrel 8) catalytic domain
 <cit> . this fold is highly versatile and widespread among the structurally characterized enzymes, being present in almost 10% of them
 <cit> . there has been a debate about the type of evolution that this fold has been through: convergent, divergent, or both
 <cit> . however, there is evidence supporting the divergent evolution hypothesis
 <cit> . the catalytic activity and substrate binding residues occur at the c-termini of β-strands and in loops that extend from these strands
 <cit> .

four modules are identified in the α-amylase sub-domain architecture . in figure
 <dig>  most of the modules span the surface to the tim-barrel . this behavior is due to the interaction of the protein and its catalytic pocket, with the ions calcium and sodium received by this structure mainly on its surface. modules shown in figures
5b, d and e span regions where these ions are frequently found among the homologs, and the residues in charge of the ligation of the three metal ions
 <cit>  as co-factors for the hydrolysis. the module in figure
5b also comprises two residues that mutational studies have shown as important for the cleavage site
 <cit>  and have been reported as substrate binding and catalytic residues. the module shown in figure
5d also spans important catalytic residues. this includes a proton donor, a catalytic nucleophile
 <cit> , and five substrate binding residues
 <cit> . the module in figure
5c comprises a substrate binding residue
 <cit> . furthermore, module 5c seem to span most of the smallest active sub-domain of a tim-barrel fold, as shown by
 <cit>  in bacillus stearothermophilus, comprising almost all of the β2α <dig> domain . no known catalytic residue was found in this module, however
 <cit>  showed that this module retains its catalytic activity. the second domain showed by
 <cit>  , was not homologous throughout our sampling , and therefore, no information was available about this domain.
α
-amylase data set

the proportion of pairs that were judged not to be in the same cluster after the permutation test , the estimated pvp and the bootstrap value in the α-amylase. the significance test critical value was corrected using the false discovery rate correction.
 <dig>  the list of the equivalences of residues in each module in each structure can be seen in additional file
 <dig> .the images were rendered using vmd
 <cit>  and povray . the structure used to visualize the modules is the pdb 1bf <dig> a from p. amyloderamosa.
 <cit>  . the images were rendered using vmd
 <cit>  and povray .

putative meaning of the sub-domain architecture
so far we have shown the significant partitions of a domain. but what is the probable meaning of such modules? one might think that this modules can represent autonomous folding units , however our data show discontinuous amino acid sequences  per module. also, comparative analysis with the dataset analyzed by
 <cit>  showed no relationship with our grouping . another plausible hypothesis could be assign modules to close loops, but the same continuity argument can be brought upon. furthermore, the α-amylase subdomains identified by our method span several of the tim-barrel close loops exposed by
 <cit>  with no particular pattern. this discrepancies are expected, since the definition of foldons, aufs and close loops have little or no meaning in an evolutionary perspective. these concepts are derived from the analysis of single structures and their internal interactions  and therefore the non-evolutionary approaches for sub-domain determination will identify a different kind of module than an evolutionary approach.

on a more related framework,
 <cit>  developed a method to test co-evolving sites. when tested on the α-amylase dataset used in this article, no pattern correlating the two methods were found . moreover, the largest significant grouping of co-evolving residues with
 <cit>  method span only  <dig> residues of the protein. this discrepancy can be attributed to the fact that
 <cit>  are testing co-evolution in a sequence based perspective. that is, giving a phylogenetic tree and its source alignment, which residues have significant mutual information. this method disregard completely the geometry of protein structures, therefore answering a different question than our approach.

so what is the possible meaning of our sub-domains? despite more work  is needed to clearly address this question, the sub-domain architecture here represented is probably co-evolving geometric units  and semi-rigid components  of proteins.

CONCLUSIONS
protein structures have a modular architecture. such modularity can be seen as hierarchical because there are different degrees of integration among its modules. the domain architecture has been shown to harbor evolutionary and structural coherence
 <cit> . however, there is also evidence of a sub-domain architecture of protein structures that can drive protein structure evolution. here we introduced a robust and significant way to identify such sub-domain architecture, giving information about the result’s power with a finite sample size number, providing ways of assessing the significance for clustering and the strength of correlations within clusters. with enough sampling the method correctly and confidently identifies modules with an intracorrelation as low as  <dig>   for simulated data. in real datasets our method is able to capture functional, structural, and evolutionary information, returning sensible results.

the npc <dig> n-terminal domain depicted a sub-domain architecture when tested in dynamic data, showing a correlation between its modularity and its proposed function. further analysis of these modules, and experimental tests  in these modules might provide important insights in the protein function and evolution, as well as important information for possible treatments of the npc <dig> related diseases.

evolutionarily, the α-amylase family displayed a clear sub-domain architecture. all its modules were tightly connected with its catalytic capabilities. these results give some insights into the evolution of a common fold, the tim barrel, that have been of wide interest
 <cit> . it can also provide guidance for new improvements of thermal stability, substrate plasticity, and in bioengineering of the amylase’s function.

a drawback of the sub-domain modularity identification for homologous aligned proteins presented here, is the relative low power and support for them. however, the support values can be improved by using a bigger dataset . we are exploring the use of homology modeling to enrich the available data for a given protein system, and the mixture of md simulations and evolutionary sampling.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
jsh and cb conceived of the study. jsh carry out the experiments and test the method. jsh, es, and cb checked the statistical models, wrote and reviewed the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
supporting tables.

click here for file

 acknowledgements
the authors thank professor n. zeh, professor r. beiko, conor mehan, and the members of dr. beiko’s lab in dalhousie university for some helpful suggestions and comments on the manuscript. to wilson chan for some of the molecular dynamic simulations, alex safatli and kyle nguyen for the collaboration in some of the code. we also thank liz mackay and johanna zaglauer for editing the manuscript. this study was funded by nserc through the grant no.  <dig>  this work was partially supported by the departamento administrativo de ciencia y tecnología - colciencias  through the caldas scholarship.
