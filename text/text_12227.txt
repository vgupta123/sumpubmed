BACKGROUND
scientists regularly face multiple testing of a large number of hypotheses nowadays. typically in microarray data, one performs hypothesis testing for each gene and the number of genes is usually more than thousands. in this situation, direct application of single hypothesis testing thousands times produces a large number of false discoveries. hence, alternative testing criterions for controlling errors of false discoveries have been introduced.

it is widely recognized that dependencies are omnipresent in many high-throughput studies. such dependencies may be regulatory or functional as in gene pathways, but also spatial such as in snp or dna copy number arrays because of the genomic order. although attempts to infer such interactions from data have been made, it is a notoriously difficult problem. usually solutions focus on some modules with relatively few elements and many samples, in particular for model organisms . with this in mind, one prefers multiple testing methods that are robust to several degrees of dependency in these network-type data. therefore, we set out to develop a simulation program that allows us testing any multiple testing method for its robustness with respect to dependency parameters using realistic nested network structures.

one of the most widely used multiple testing criterions for controlling errors of false discoveries is false discovery rate . fdr is introduced in benjamini et al.  <cit>  and is defined as the expected proportion of the number of falsely rejected hypotheses among total number of rejected hypotheses. since in most cases, underlying distributions of data are unknown, there are several implementations of fdr under different assumptions.

benjamini et al.  <cit>  first suggest an implementation of fdr by a linear step up approach. for an m hypotheses multiple testing problem with m <dig> true null hypotheses, the benjamini-hochberg  procedure finds maximal k such that p ≤ γ where k =  <dig> ..., m, p's are observed ordered p-values and γ is prespecified level of significance. the bh procedure is known to control

  fdr≤m0mγ=π0γ≤γ. 

under independence assumption of test statistics. later, bejamini and yekutieli  <cit>  prove the bh procedure controls under positive regression dependency condition and they introduce a modification of the above procedure to control arbitrary dependence circumstances . storey  <cit>  introduces the positive false discovery rate  and the q-value. pfdr is known to control error rate under the clumpy dependency condition  <cit> . significance analysis of microarray  is developed on the purpose of statistical analysis of microarray data  <cit> . sam fdr is known to estimate the expected number of false discoveries over the observed number of total rejections under the complete null hypothesis  <cit> .

in , there still remains some space of improvement for tighter control if we know π <dig>  adaptive procedures are developed to gain more power by estimating π <dig> in this sense. to estimate π <dig>  storey et al.  <cit>  use the fact that independent null p-values are distributed uniformly on  <cit>  and then plug the estimator π^ <dig> into the fdr-estimator. benjamini et al.  <cit>  estimate m <dig> in a two-stage adaptive control of fdr . under the assumption of independence of test statistics, they show the abh procedure controls nominal significance level. careful simulation studies on the comparison of performance of π <dig> estimation methods are done by black  <cit>  and langaas et al.  <cit> . black  <cit>  notes that the violation of uniformity of p-values due to the presence of non-null cases could bias estimates of π <dig> upward.

recently, several works incorporates correlations among test statistics to estimate fdr. resampling based approaches are immediate in utilizing sample correlation structure  <cit> . however, since it is difficult to resample from the true null and the false null distributions separately, it is common to assume the complete null hypothesis and set the number of true discoveries fixed in order to estimate fdr conservatively, as is shown in the resampling based method of yekutieli and his coworkers  <cit> . since the procedures mentioned above are often used, we would like to study validity of those procedures under fairly general dependence circumstances and how correlations among test statistics affect results of fdr multiple testings. also, we would like to examine effects of violation of independence of p-values on π <dig> estimations. hence, designing general dependence conditions is our main concern. in previous works, for convenience of simulations, data are often assumed multivariate normally distributed. typically in microarray data analysis, equi-correlated normal structures such as single pairwise correlation matrices or block diagonal matrices with a single pairwise correlation in each block are considered  <cit> .

equi-correlated structures are easy to understand and implement. moreover, control of dependence conditions is easy by increasing or decreasing single correlations. but they are hardly regarded to represent reality. random correlation matrices are more realistic candidates, because they reflect heterogeneity between the correlations. however, since the class of random correlation matrices is too large, multiple testing results generated from two arbitrary random correlation matrices are difficult to compare.

therefore, we propose constrained random correlation matrices to reflect the generality of random correlations and the comparability like equi-correlation models to simulation studies. for simulation studies, we generate a sequence of random correlation matrices and as constraints we impose conditional independence structures on the random correlation matrices in a 'nested' way. then the sequence of random correlation matrices is ordered in terms of a dependence parameter and we control the strength of dependence by the dependence parameter. an alternative, non-nested, approach is discussed by jung et al.  <cit>  who simulate multivariate normal test statistics while conserving the correlation structure as present in the data in an asymptotic sense.

in our simulation results, we show how the dependence parameter can serve as a measure of fdr behavior under correlation-based dependence conditions. we prove that this dependence parameter is in fact strongly related to the variance of pairwise correlations. using this structural simulation setting, we compare the performance of several fdr estimating methods.

RESULTS
we illustrate simulation results. here, we consider two cases for the proportion of true null hypotheses: π <dig> =  <dig>  and π <dig> =  <dig> . both cases show similar results, so we focus on the first case. for π <dig> =  <dig> , we refer to figure s12-s <dig> . we do not take into account for small π0's because in high-dimensional data with thousands hypotheses one is usually interested in the case when only small portions of total hypotheses are truly significant. we generate  <dig> correlation matrices Σ based on  <dig> edge densities, which are the proportions of non-zero partial correlations over all possible pairs of partial correlations,  <dig>   <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig>  note for a nested sequence of random correlation matrices, we use one initial z matrix  for each π <dig>  the total number of hypotheses is set to m =  <dig> and sample sizes for x and y are  <dig> each. the number of resamples to compute average fdr in  are b =  <dig>  the fixed true difference is chosen to have 80% power for individual two group t-statistic when fdr significance level is  <dig>  under independence assumption.

surprisingly, the point rbh estimates seem to perform better under dependence than the reference fdr. figure  <dig> shows that those estimates are even close to the nominal level  <dig>  while the upper limit rbh estimates in both figures remain conservative. the difference between the two estimates is small under independence, but becomes larger as the edge density increases. the reason behind these phenomena is hard to explain because the implementation of fdr-ame is modified from the algorithms of yekutieli et al.  <cit> . but, we may infer the following two points. first, as in yekutieli et al.  <cit> , both estimators are assumed to be less than or equal to the true fdr under the complete null hypothesis with the assumption of independence of the number of false discoveries, v and the number of true discoveries, s and the subset pivotality condition, which can be easily violated in our setting. second, more importantly, the two estimators of s^ take into account of dependence conditions differently and the s^ estimator of the point rbh procedure is downward biased as explained in  <cit>  so that the resampled fdr is estimated upward. in both figure  <dig> and figure  <dig>  the by procedure shows too conservative results because when m =  <dig>  ∑i=11000i−1≈ <dig> , which causes the by adjusted p-values to be larger than bh adjusted p-values by a factor of  <dig> .

it is hard to decide that which one is recommended in practice when apparent dependence is observed. however, in this simulation, if most weight is given on adhering strict control level and gaining more power is a secondary goal, the abh seems to be most robust and desirable under dependence cases.

besides the edge density, the strength of the present correlations also influences fdr. the variance of pairwise correlations was previously described as an important parameter in fdr estimation  <cit> . we show that our parameter m, the number of rows of the initial z matrix, may be used to control it, which is suggested by the asymptotic relation, as given in equation . figure  <dig> shows the relation between variance of correlations and fdr for m =  <dig>  up to around  <dig>  of edge density, variance of correlations and fdr behave exactly opposite and then both quantities flatten.

in figure  <dig>  we compare the effect of five different m values,  <dig>   <dig>   <dig>   <dig> and  <dig> on fdr results ). using , approximate standard deviations of correlations ρij for the five m values are 1/ <dig>  1/, 1/, 1/ and 1/. we observe that the fdr results for small m are more variable than that for large m. from , we expect variability almost disappears as m - m becomes large.

an illustration with real data
in this section, we address an example on how to apply biological information such as pathways using random correlation matrices. basically, we use estimated marginal mean and variance from data and apply pathway information such as gene sets to correlation structures. algorithm  <dig> shows the detailed procedure. it uses algorithms  <dig> and  <dig>  which are discussed in the methods section.

algorithm  <dig>  application to random correlation structures to real two sample data.

 <dig>  compute m-dimensional sample mean and sample variance vectors, μ^x,μ^y,σ^x <dig> σ^y <dig> from data x <dig> ...,xn <dig> and y <dig> ...,yn <dig> 

 <dig>  prepare interested gene sets gs <dig> ..., gsk and make a sequence of nested gene sets n <dig> ..., nk by iterative merging. that is, for each j =  <dig> ..., k, nj = gs <dig> ∪ ... ∪ gsj.

 <dig>  generate a sequence of binary adjacency matrices a <dig> ..., ak from n <dig> ..., nk. components of adjacency matrices are encoded as  <dig> for presence of edge and  <dig> for absence of edge. for example, i, j =  <dig> means both i-th and j-th gene are in nl.

 <dig>  according to a <dig> ..., ak, generate a sequence of random correlation matrices, r <dig> ..., rk, using algorithms  <dig> and  <dig> 

 <dig>  generate sample from x1∗b,...,xn1∗b~nrjdiag) and y1∗b,...,yn1∗b~nrjdiag) for b =  <dig> ..., b.

 <dig>  do multiple testing b times and estimate average fdr from .

we applied the above algorithm to the "two class" example data of excel add-in of sam which consists of  <dig> genes with  <dig> control and  <dig> treatment experiments. along with the data provided, we used gene sets file, "c <dig> v <dig> symbols.gmt" for pathway information from msigdb  <cit> . there are  <dig> gene sets in the file and we chose those  <dig> gene sets  which overlap more than  <dig> genes with the gene list of the "two class" data.

for b =  <dig>  we applied the bh fdr method with significance level  <dig>  to find differentially expressed genes for each random correlation matrices. the number of detected genes and the gene lists had few variation. the median number of detected genes decreases as the edge density increases and around  <dig> genes were always detected regardless of the edge density, see table  <dig> 

we illustrated the different  <dig> genes and significance for  <dig> correlation structures in table  <dig>  in table  <dig>  rows represent genes and columns represent correlation matrices. the table is read as for example, ranks of frequencies of significance declaration for ssr <dig> were less than median detected number  <dig> for r <dig> ..., r <dig>   <dig> for r <dig> and  <dig> for r <dig>  r <dig> 

interpretation on the results of table  <dig> depends on the specific correlation structures given in r <dig> ..., r <dig> and there does not seem clear trends in rejections for  <dig> genes. since marginal distributions of single genes do not change when we apply various correlation structures to correlation matrices of the multivariate normal distribution, the result that almost all detected genes were the same confirms our expectation.

discussion and 
CONCLUSIONS
we considered effects of dependence on fdr multiple testing results using multivariate normal samples. we found that in all our simulations, the simple adaptive benjamini-hochberg procedure  <cit>  is most optimal under dependence, since it achieves relatively high power while remaining conservative. by definition, fdr is the expected value of a nonlinear function of indicator random variables of rejection. hence, for computations of fdr, we need to take into account of the joint distribution of the indicator random variables. to focus on joint distributional properties of fdr, we have designed to observe variations of fdr in terms of variations of correlation structures and we have fixed other parameters such as marginal distributions and probabilities of rejections for true null and false null hypotheses. therefore, our results could be additional useful guideline to fdr estimation methods which have been developed based on marginal distributional assumptions.

nowadays, explaining high-dimensional data with conditional independence structures is quite active especially in microarray data analysis  <cit> . such methods focus on testing on partial correlation coefficients. the necessary and sufficient condition of zero partial correlation is the same as . the results of testings on partial correlations is a network which can be used directly in our simulation framework when, for example, testing on difference of means between two groups of samples. then, our simulation set-up can be regarded as a data-guided simulation to study whether a particular multiple testing method is useful for the data at hand. as a data-guided simulation using known gene sets  <cit> , we introduce an algorithm for using real data in the results section. although a very slight downward trend for the number of discoveries with respect to increasing edge density  is found, we observe that the bh fdr method is very robust in this setting as well.

in our simulation study, we did not categorize test statistics. most of the fdr methods in the results section are based on simple gene specific t-statistic, while sam uses its own statistic using the fudge factor which stabilize estimates of gene-wise variances. the effects of using such modified t-statistic are not clear but we can reflect those effects from the viewpoint of sample sizes. as sample sizes increase, the fudge factor of sam shows a convergence feature, although it does not improve sam's anti-conservative bias under dependence conditions. as an alternative to the fudge factor, the random variance model  by  <cit>  can be used and simple replacement of the pooled variance of t-statistic by the rvm variance results in close control of the fdr to the nominal level under dependence in moderate to large sample size conditions. for the effects of various sample sizes on the fudge factor and π <dig> estimates of sam and the rvm fdr, see figure s1-s <dig> of additional file  <dig> 

effect size may be another important factor in evaluating fdr methods. we consider the cases for multiple small effect sizes or very small proportion of fixed effect size, for example π <dig> =  <dig> . in both cases, we observe overall similar patterns of the fdr estimates shown in the results section .

generally in high-dimensional situation, we doubt that the permutational based approach to estimate joint distributional properties of test statistics always give a correct answer. in a further simulation study, the estimated spread of ordered sam statistics under permutational null hypothesis shows to be narrower than that of the true distribution. note that the difference becomes wider as edge density increases. this seems to cause the anti-conservative feature of sam under dependence. for more detail on the effect of sample size and the performance of sam and rvm, see appendix  <dig> of additional file  <dig> 

efron  <cit>  notices that variance of pairwise correlations plays an important role in characterizing fdr, defined somewhat differently as the expected number of false rejections over the observed number of rejections, e/r. we confirm this finding, but in our network-based simulation set-up, we found it natural to characterize fdr using two parameters: first, edge density to decide the proportion of interactions present and second the variance of pairwise correlations. this allows to study multiple testing methods for a given prior network.

other interesting works on the effects of dependence on the number of false discoveries rather than fdr are owen  <cit>  and korn et al.  <cit>  who discuss that large positive correlations may result in high variation on the number of false discoveries. under simple correlation structures, qiu et al.  <cit>  investigate the vulnerability of application of empirical bayes theory under strong correlations.

one can extend our simulation framework by considering the distribution of the z matrix. until now, we have considered the constrained random correlation matrices depending on the fixed single z matrix and given nested structures. taking into account the distributional properties of z as a prior, one may attain explicit posterior distribution of covariance matrices Σ <dig> ...,Σd. a family of covariance matrices as a gaussian ensemble can also be considered as described in  <cit> . however, both approaches require very complicated mathematical computations so we remain these as future works.

our simulation set-up is also useful for testing a potentially new method on π <dig> or fdr estimation in a dependency context. one may not have designed the procedure for the multivariate normal setting in particular; however, it seems reasonable that the new method should perform well under these conditions to be of general use. or one may at least sketch the boundaries of the usefulness of the method in terms of type of network, edge density, and correlation strength.

