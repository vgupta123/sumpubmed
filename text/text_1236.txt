BACKGROUND
several microarray platforms and various statistical methods have been applied in a large number of association studies to identify candidate genes with causative potential. however, only a few studies have provided insight into the functional variant or mechanism underlying these diseases. single nucleotide polymorphisms  are the most common genetic inter-individual differences in the human genome, and through various mechanisms, they can alter the amount of mrna produced  <cit> . when individuals are subjected to both dna sequence polymorphism array genotyping and microarray-based gene expression  profiling, genome-wide joint analysis for identification of expression quantitative trait loci  becomes feasible  <cit> . several recent investigations have surveyed eqtl using human lymphoblastoid cell lines derived from healthy individuals in single or multiple ethnic populations to generate global regulatory networks in humans  <cit> . in addition, eqtl may have an impact on complex diseases and clinical phenotypes such as obesity and diabetes  <cit> .

data collection for eqtl studies is two dimensional. one dimension examines gene expression levels, which are believed to contribute to phenotypic differences between individuals  <cit> . the second dimension examines snp genotypes in which variation in a given population is correlated with disease; most of these variations underlying complex traits are found in regulatory elements of the genome  <cit> . therefore, understanding the relationships between transcript abundance and specific genomic markers will likely uncover the molecular basis of phenotypic diversity and improve interpretation of patterns of expression variation in disease  <cit> .

recent studies of hapmap populations have identified numerous eqtl  <cit> . however, only a fraction of these eqtl is reproducible across populations; diversity of snp density between populations represents one probable explanation for the lack of reproducibility  <cit> . combining samples across populations may increase sample size and enhance both genetic dissimilarity and the range of variation of ge, thereby increase the statistical significance of identified eqtl  <cit> .

spielman et al.  used an independent approach in which gene expression levels were regressed on snp genotypes for unrelated ceu , and chb + jpt  samples  <cit> . common eqtl were identified when the snp-ge association was significant in both populations  <cit> . this procedure may only afford limited detection of common eqtl because the two tests are carried out simultaneously. to increase detection, stranger et al.  combined the data among populations and used conditional permutations to assess the significance of the snp-ge associations  <cit> . although conditional permutation can be used to manage inflation of the association p-value that is generated from population-level difference, snp-ge associations in the combining data require appropriate adjustments for possible dissimilar population structure in the model. veyrieras et al.  combined samples from several populations using the normal quantile transformation  method to avoid spurious eqtls arising from differences in population structure  <cit> . unfortunately, this technique may alter snp-ge associations and mislead conclusions because expression values in each population are forced to have the same distribution. for instance, when gene expression is directly and additively modified by a biallelic snp , those individuals homozygous for the g allele will have high expression levels in comparison with those homozygous for the a allele. if a population has a higher frequency of genotype aa, then the mean expression level of individuals with genotype aa will approach zero after normal quantile transformation. similarly, if the other population has a higher frequency of genotype gg, the mean expression level of individuals carrying the genotype will also move toward zero. therefore, the snp effect will be diminished if the analysis combines the transformed expression values to examine snp-ge associations. indeed, the mean expression differences between genotypes will be minimized owing to differences in allele frequency. although many studies have focused on multi-marker analyses, hot spot identification, and type i errors, the most suitable statistical method for microarray-based eqtl studies comprised of data from more than one population remains unclear.

to address this question, we employ the meta-analysis concept  <cit> , a statistical implementation to synthesize and integrate information across a number of independent studies to estimate the associations between genotype and ge of a sample containing two populations. meta-analysis detects modest associations and has been used extensively in genome-wide association studies   <cit> . in the present study, we use a constrained two-way model , in which different populations and different genotypes represent the two-way variables, to jointly assess snp-ge associations in individuals from two populations. this model assumes that the mechanisms of snp regulation of ge are similar and allows for heterogeneous non-genetic effects on expression between populations. the word "constrained" refers to the constraint that there is no interaction between the two variables in the ctwm. in other words, the snp effect sizes on ge in populations would be regarded as identical in the ctwm. in addition, we extend the ctwm to divide ethnic ge differences into two parts. the first part represents baseline expression differences, which can be affected by non-genetic factors such as different environmental conditions across populations, and is termed baseline difference . the second part represents quantification of ge differences between populations resulting from genotype frequency differences , and is termed genetic score . this allows us to examine whether differentially expressed genes between populations are caused by genetic markers or non-genetic factors. this information is unattainable if associations between snps and ge are estimated separately for each population.

in the following sections, we briefly describe how common eqtl are identified between two populations using the independent group  method, in which two one-way anova are performed independently. then, we describe the ctwm for combining two independent unbalanced one-way models to identify eqtl. using this model, the magnitude of ge differences between populations resulting from genotype frequency diversity can be directly estimated. furthermore, we use the gs obtained from ctwm to identify putative functional snps, and is termed ctwm-gs method. in the simulation study, we control allele frequency differences between populations to compare the power of different methods for identifying eqtl. finally, we apply our method to some authentic datasets to identify gene regulation mechanisms, examine the assumptions of homogeneous regulation mechanisms, and identify additive inheritance patterns and snps that induce ge differences between ceu and asian  cohorts.

methods
in the present study, we use conventional gene-base mapping, such as the common technique of mapping eqtl to determine gene expression traits one gene at a time. consider n unrelated individuals observed from two different ethnic populations, i =  <dig>   <dig>  log2-transformed gene expression values for the kth replication on the jth genotype in the ith population, denoted by y
ijk 
 are used to reduce the impact of outliers and to ensure normality. the gene expression values, y
ijk 
, are assumed to be independently distributed as n. although the additive model has been frequently used in eqtl studies, many variations in transcription levels cannot be explained by this model  <cit> . in comparison, co-dominant genetic models, in which three genotype effects are estimated, have good overall performance for identification of any simple inheritance patterns in qtl mapping  <cit> , and is therefore being employed in the following analysis.

the independent group  method
because of possible heterogeneity between populations, many studies analyze snp-ge associations independently for each ethnic population and summarize their results to identify common eqtl  <cit> . without loss of generality, we assume that three genotypes are observed for a biallelic snp in each population. in addition, we assign a common genotype c  between populations.

the cell mean model has been used extensively for unbalanced data in which the number of observations varies from one genotype to another. based on the cell means, within the ith population, the n
i 
signals in a given gene are decomposed into:

y
ijk 
= μ
ij 
+ e
ijk
, where μ
ij 
is the cell mean, and e
ijk 
is assumed to be independently distributed as n. if the common genotype c is assumed to be  <dig>  this model can be rewritten using another parameterization as y
ijk 
= μ
i <dig> + τ
ij 
+ e
ijk
, where μ
i <dig> is the expression baseline in the ith population; τ
ij 
= μ
ij 
- μ
i <dig> when j ≠  <dig>  which represents the ge difference between individuals with genotype j and genotype  <dig>  this reparameterization model is used in the subsequent analysis.

the goal of the ig analysis is to test the null hypothesis h0: τ
i <dig> = τ
i <dig> =  <dig> in each population. it is straightforward to observe maximum likelihood estimators through a normal equation. the estimators of μ
i <dig> and τ
ij 
are  and ,

where , and the f-statistic calculated from anova can be used to test the null hypothesis. in the ig analysis, the parameters are estimated separately in each population. this approach is free of model assumption and allows for heterogeneity of snp effects  between populations. a common eqt locus is then identified if the two hypotheses h0: τ <dig> = τ <dig> =  <dig> and h0: τ <dig> = τ <dig> =  <dig> are simultaneously rejected.

the qt method
although the power of eqtl identification is influenced by the magnitude of the snp effect on gene expression, it is clear that magnitude of test statistics may vary as a function of sample size and allele frequency, even if the snp effects in the two populations are identical. on the other hand, merging data set with proper adjustment before statistical testing may enrich data variation and is more effective for detection of common eqtls compared with the previous method. to avoid spurious eqtls in the data combined from multiple populations due to population structure, veyrieras et al.  applied a normal quantile transformation  to each gene, within each population before combining data  <cit>  .

the constrained two-way model  method
we use a ctwm strategy to identify common eqtls between populations. because the results from the ig method are to be compared with those obtained from combined data, we consider c =  <dig> as the baseline genotype, and individuals with the common genotype  in each population are assigned a different ge mean value, μ
i <dig> for i =  <dig>   <dig>  to allow for heterogeneity of ge baseline. we assume homogeneity of snp regulatory mechanisms across ethnicity by defining e = τ•j 
for all j =  <dig>   <dig> and i =  <dig>   <dig>  consequently, the n  signals can be expressed as y
ijk 
= μ
i <dig> + τ•j 
+ e
ijk
, where the e
ijk
's are assumed to be independently distributed as n. because the two independent unbalanced one-way models in the ig approach are combined into a ctwm, the analysis of snp-ge associations can be performed by testing the null hypothesis h0: τ• <dig> = τ• <dig> =  <dig> using the partial f-statistic:

, where b is in the matrix form , q is the rank of the matrix b, x is the design matrix, sse represents the error sum of squares, and v represents the degree of freedom for the sse .

the ctwm-gs method
the ultimate goal in the present genetic genomic study, which incorporates data based on two phenotypes, is to identify not only the association between snps and ge but also the relationship between snps and phenotypes. in general, investigators aim to identify snps that are associated with particular ge profiles and discern whether the difference of allelic frequency of a particular snp induces a gene expression difference between populations, termed esnp  <cit> . using the ctwm described above, the gene expression differences between populations can be directly partitioned into two parts  and independently tested.

bd, by previous definition, is the ge baseline difference between populations that could be parameterized as μ <dig> - μ <dig>  similarly, gs, which is the ge difference resulted by the genotype frequency differences between two populations could be represented as  τ• <dig> +  τ• <dig>  we solve the normal equation of the ctwm by maximum likelihood estimation and express the estimators using the cell mean . consequently, the estimators of gs and bd can be expressed as follows:  

where m
j 
= n0j 
n
ij
; a
j 
= noj 
+ n1j
; ; s = { <dig> }\{i}, which means s is an element in { <dig> } but not in {i}, and r = { <dig> ,2}\{ j, t}, which means r is an element in { <dig> ,2} but not in {j, t}.

these two estimators indicate that bd and gs are invariant with respect to the baseline genotype chosen, since they are free of index j. because we observe a unique solution for both bd and gs, these estimates can be tested using the null hypotheses h0: μ <dig> = μ <dig> and h0:  τ• <dig> +  τ• <dig> =  <dig> via the partial f-statistic described in the ctwm method with b =  when testing bd and b = , )when testing gs, respectively. if the null hypothesis for gs is rejected, then the snp-ge association will be claimed as an esnp.

in addition, these two quantities can be represented as two non-overlapping scores and separated from the arithmetic mean difference between populations as below:  

simulations
to demonstrate the performance of the models for common eqtl identification, we carried out simulations using varied parameters consisting of allele frequency of population  <dig> , baseline  and allele frequency  differences between two populations and the magnitude of the snp effect on ge . in these simulations, we compared both the type i error rate and power of eqtl identification among three different common eqtl identification methods including ig, ctwm and qt. an additional ctwm-gs in identifying esnps was compared for various allele frequency differences. we further examined the precision and accuracy of the estimates  for the ctwm and qt method, and bd and gs for the ctwm-gs. in scenario  <dig>  gene expression data were simulated with differential expression resulting only from allele frequency differences between two populations. in scenario  <dig>  the simulation was performed with differential expression resulting from both population-level and genetic-level differences to determine whether genetic factors can be examined independent of non-genetic factors .

ethnic population data: hapmap
to validate the performance of eqtl identification models for gwas data, we reanalyzed the gene expression dataset from gene expression omnibus  using  <dig> unrelated ceu and  <dig> chb + jpt individuals. recent studies have demonstrated that probe sequences including snps would influence the hybridization on microarrays and cause false cis eqtl  <cit> . the rationale for this effect is that the mrna with an identical sequence as the probe designed would hybridize better. to avoid false positives of such eqtl, the subset of  <dig>  expression traits excluding probes that had polymorphisms in the probe-target sequence, as was reported in stranger et al.'s study  <cit> , was thus used in the analysis. remapping of traits was performed using bioconductor software  <cit>  with the illuminahumanv <dig> db package  <cit> ;  <dig>  expression traits lost their chromosome position information and were excluded in the subsequent analysis. the corresponding affymetrix  <dig> k genotype expression data were downloaded from the affymetrix website http://www.affymetrix.com and snp genotypes of each individual were called based on the affymetrix brlmm algorithm. the established imputation method 'beagle' was used to impute missing genotypes  <cit> .

for each expression trait, snp-ge associations were examined by each of the ig, ctwm and ctwm-gs methods, provided that both the snp and the gene were on the same chromosome. our previous results showed that the qt method was highly influenced by allele frequency differences between populations, the comparisons between the qt method and others would thus be difficult to interpret. therefore the qt method was not included in the subsequent real data analysis. in the following analysis, a conservative threshold with a p-value < 10- <dig> was used to identify the eqt locus for each trait. this threshold yielded a false discovery rate   <cit>  of  <dig> % and 1% for the ctwm and the ctwm-gs method, respectively, when  <dig>  expression traits were analyzed. for expression traits having more than one significant eqt locus, the snp with the smallest association p-value was selected as the putative eqt locus. in the following analysis, local is defined as the segment of the chromosome spanning from  <dig> kb upstream to  <dig> kb downstream of the gene sequence of interest, and distant is defined as the region outside of local on the same chromosome.

for significant eqtl identified by the ctwm, full- and reduced-model strategies were performed to evaluate the heterogeneous expression baseline, homogeneous snp effects between populations, and the assumption of non-additive. after examining the applicability of the ctwm, we used the ctwm-gs method to investigate whether differential gene expression between populations is affected by genetic or non-genetic factors. furthermore, we evaluated the contributions of functional snps identified by the ctwm-gs method, to ge differences between the ceu and asian cohorts using the hierarchical clustering method. the analyses were performed on the r package http://www.r-project.org.

RESULTS
simulations: comparing the probabilities of rejecting null hypotheses
we compared the observed type i error rate () among three eqtl identification methods  with different d values by setting e equal to zero . because two tests are carried out simultaneously in the ig method, it comes as no surprise that this method yielded the lowest  for each simulation. at a fixed type i error rate of  <dig> ,  for the qt method conforms to this restriction only in the case of d =  <dig> . for other cases,  of the qt method was affected by the allele frequency difference between populations; e.g.,  decreased as the d value increased under the same p
 <dig> 
. for both d =  <dig>  and  <dig> , the lowest error rate was observed when p
 <dig> 
was less than  <dig> . this implicates that qt method is unsatisfactory when simulating snps that are polymorphic only in one population. in contrast, using the ctwm,  was stable for all cases simulated.

for the ctwm-gs method, which incorporated allele frequency differences between populations to identify esnps,  was stable for all cases simulated except for the case of d =  <dig> . because for each snp simulated, the genotype frequencies were assumed to follow hardy-weinberg equilibrium, it was possible that simulated genotype frequency differences drifted a bit away from zero even with a fixed d =  <dig>  if the genotype frequency differences were to be fixed at zero, the estimates of gs would equal to zero and  of the ctwm-gs method would therefore equal to zero simultaneously.

the following describes simulations in which differential gene expression was allowed only as a result of allele frequency differences between two populations. for all methods, we compared the power of eqtl identification with e equal to  <dig>  and  <dig>  and d varying as  <dig>   <dig> , or  <dig>  with each e value. as above, the ig method yielded the lowest power to detect common eqtl, and its utility was limited by the population with the lowest allele frequency; the curves representing the power of eqtl identification were very similar in the cases of d =  <dig>   <dig> , and  <dig>  under the same e value . when allele frequency was the same in two populations, the qt and ctwm methods had the same ability to detect significant associations at e =  <dig>  or  <dig>  . when d value varied from zero, however, ctwm outperformed the qt method, and the differences of power in eqtl identification between these two methods increased as a function of d under the same e value . when ctwm-gs was used to detect esnp, the power of esnps identification was a function of the allele frequency differences between populations  under same e and p
 <dig> 
; i.e., when the magnitude of the snp effect and allele frequency of population  <dig> are fixed, snp-ge associations having a larger difference in allele frequency between populations were easier to be detected by the ctwm-gs method.

simulations were also performed with d =  <dig>  and results showed that  and power curves of eqtl and esnps identification were very similar to those obtained when d =  <dig> .

simulations: comparing the estimates
we examined precision and accuracy of the estimates  for the ctwm and qt methods under the null  and alternative  hypotheses. the simulation results showed that, under the null hypothesis, both of these two methods could estimate τ• <dig> accurately; i.e., average of the estimates fit the expected value given the simulation . the qt method provided slightly higher precision than ctwm when p
 <dig> 
was larger than p
0
, especially when allele frequencies were small . under the alternative hypothesis, however, the estimates of the qt method were influenced by the d value; e.g., if d and e were fixed at  <dig>  and  <dig>  respectively, the qt method somewhat underestimated e value . in contrast, the ctwm could accurately estimate e value and was not influenced by allele frequency differences between populations for all scenarios.

we also explored the estimates of gs and bd in ctwm-gs method with d =  <dig>  under the null hypothesis, estimations of the gs and bd parameters were reliable despite the fact that gs variations were affected by the allele frequency. similar results were observed under the alternative hypothesis .

analysis of hapmap populations using the ig method
using a pair of hapmap population data sets,  <dig>  expression traits were mapped to significant eqtl either in the ceu or asian population by the ig method; however, only  <dig> expression traits with  <dig> eqtl were common between the two populations . when examining the effects of ethnic-genotype interactions on gene expression among the  <dig> traits with common eqtl by both the full and reduced two-way anova models , only  <dig>  putative eqtl showed significant interaction effect at a threshold of q-value <  <dig>   <cit> . further investigation of the positions of the  <dig> putative eqtl revealed that  <dig> resided in the local region. these results indicated that the ig method was able to identify common eqtl near or in the target genes of interest and that for most eqtl the snp effects on gene expression levels were similar in populations. to clarify, in the subsequent analysis, all of the fdr calculations were based on storey's q-value approach  <cit> , which is considered to be more powerful than other fdr approaches. however, in the whole eqtl study across all snp-ge association tests, the prodigious number of p-values  made it computationally prohibitive to run storey's q-value, so benjamini and hochberg's fdr approach  <cit>  was used instead.

analysis of hapmap populations using the ctwm method
using ctwm,  <dig>  expression traits had at least one snp with a statistically significant snp-ge association . notably, except for six ig-specific common eqtl, all  <dig> significant snp-ge associations identified by the ig method were also identified by ctwm , although the ig method allowed for heterogeneous snp effects between groups. for the six ig-specific eqtl, the p-values of the ethnic-genotype interactions evaluated using the f-statistic ranged from  <dig>  × 10- <dig> to  <dig>  × 10-9; the ctwm was therefore not able to detect significant associations for these six eqtl. one of the possible reasons is that, when there are differences in the magnitude of the snp effect on ge, particularly for snps that have opposite effects in the two populations, ctwm may fail to detect snp-ge associations. nevertheless, for two of the expression traits with ig-specific eqtl, ctwm identified other snps with strong snp-ge associations. for example, gene s100a <dig>  detected using expression probe gi_21614543-s, was mapped to the putative eqtl rs <dig> with an association p-value of  <dig> × 10- <dig>  thus, the set of  <dig> expression traits with at least one eqt locus detected by the ig method was a subset of the  <dig> expression traits detected by ctwm.

analysis of hapmap populations: local and distant effects
among the  <dig> putative eqtl identified by the ctwm,  <dig>  were identified as local eqtl and  <dig>  were distant eqtl. in addition, average of the -log <dig> association p-values were  <dig>  and  <dig>  for the local and distant putative eqtl, respectively, and the difference between these two means was significant  . this result suggests that eqtl near target genes have smaller p-values than those further away from genes as identified by ctwm. examination of the minor allele frequency  for eqtl with respect to chromosomal position showed that the maf for local and distant putative eqtl in the combined population were  <dig>  and  <dig> , respectively. the difference of these two frequencies was significant  .

analysis of hapmap populations: justification of model assumptions
we used full- and reduced-model strategies to justify the assumption that the magnitude of the snp effect is homogeneous by examining the genotype-ethnic interaction term in the model. of the  <dig> snp-ge pairs identified by the ctwm, only  <dig>  putative eqtl had significant genotype-ethnic interaction following the fdr correction . in contrast, when we investigated the heterozygous non-genetic snp effect assumption using full- and reduced-model strategies  for each of the  <dig> snp-ge pairs, there were  <dig>  traits with a q-value <  <dig> .

for genome-wide identification of eqtl, researchers often employ the additive genetic model as a basic inheritance pattern to assess the association between snp genotype and ge. using the full- and reduced-model strategies again ,  <dig>  out of  <dig> putative eqtl were significantly associated with co-dominant assumption . among the  <dig> eqtl, only  <dig> were in local regions. the result suggests that the additive genetic model assumption is applicable to most local eqtl, and co-dominant genetic model assumption seems to be more suitable to distant eqtl. further research is needed to confirm these results.

analysis of hapmap populations using the ctwm-gs method
the ultimate goal of microarray studies is to generate a list of gene variants for further investigation. such studies generally involve comparisons of two conditions within a single population or of two clinically distinct populations. we incorporated snp diversity information from two ethnic cohorts to identify regions of the genome where genetic diversity is associated with gene expression differences between populations.

we have demonstrated the applicability of ctwm for combined populations. thus, under ctwm, gs was substituted for snp-ge associations to incorporate snp diversity information into the analysis. this generated  <dig>  expression traits that included at least one snp with a significant gs  . out of these  <dig> putative esnps,  <dig>  were included in the set of  <dig> putative eqtl identified by ctwm. a high number of intersecting eqtl was expected because both methods explored the random aspect of the snp effect.

analysis of hapmap populations: genetic and non-genetic effects
because the ctwm method can partition mean expression differences, this allows for investigation on whether differentially expressed genes are affected by genetic or non-genetic factors. to avoid unnecessary cancellation, we calculated the proportion of genetic factor by |gs|/. if the denominator was considered as the total expression bias for a particular snp-gs pair, figure  <dig> showed that most of the esnps resulted in less than 40% expression biases of their target genes between the ceu and asian cohorts . furthermore, we examined the association between these proportions and the maf differences using a locally weighted scatterplot smoothing   <cit> . these results showed that the snps with higher proportions were those with greater allele frequency differences . although the ctwm-gs method still requires the ctwm to test the associations, it provides immediate insight into snp effects on the variation of ge among populations.

among the  <dig> putative esnps detected using the ctwm-gs method, there were  <dig> snp-ge pairs represented by  <dig> unique gene symbols and  <dig> unique snps selected using a gs threshold of  <dig>   . these esnps contribute to more than 40% of the expression bias and have greater maf differences between populations, except those genes with higher bd values. most of the  <dig> pairs had significant snp-ge association in at least one population tested by using ig method; the non-significant associations are likely to result from a low maf. for instance, the snps rs <dig>  rs <dig> and rs <dig> have minor allele frequencies ranging from  <dig>  to  <dig> , and their corresponding snp-ge association p-values range from  <dig>  to  <dig>  in the asian cohort . moreover, the genes c3orf <dig> and c8orf <dig> lacked sufficient evidence to be considered as differentially expressed in the case where we compared their expression levels directly and omitted the esnp information . however, these seemingly similar expression levels are due to opposing effects of genetic and non-genetic factors on these genes in the ctwm. therefore, it is highly important that differences in allele frequency between populations be included in analyses of inter-population differential gene expression.

analysis of hapmap populations: applying the gs to population studies
to evaluate the genetic contributions to the observed differences in gene expression between the ceu and asian populations, we first clustered all individuals by genotype relative to the  <dig> unique esnps identified using a gs threshold of  <dig>  . for each esnp, individuals homozygous or heterozygous for the upregulated allele or homozygous for the downregulated allele were assigned values of  <dig>   <dig> or  <dig> respectively. when the spearman rank correlation coefficient was used to measure the similarity between individuals, the ceu and asian cohorts were separated into two distinct groups . the cluster also divided snps into two groups, where group  <dig> was comprised of seven snps from alleles associated with upregulated expression that are mostly found in the ceu cohort in contrast to the asian cohort. group  <dig> consisted of  <dig> snps from alleles associated with upregulated expression that are mostly found in the asian cohort compared to the ceu cohort. when the cluster order was fixed, the corresponding expression pattern was visualized using an expression heatmap. to avoid bias from non-genetic factor differences, we adjusted the population-level expression by adding the estimated bd score to each ceu individual for each expression trait. similar to genotype clustering, the expression pattern was generally divided into two groups corresponding to regulatory snps, and the majority of the individuals with genotype assignments of  <dig> or  <dig> had higher gene expression levels .

discussion
taken together, our simulation studies demonstrate that the ig method is unsatisfactory for identifying common eqtl. although this method is robust and does not require model assumptions, the power of this method is poor even when the magnitude of the snp effect is large. on the other hand, we demonstrate that if two population data are combined prior to statistical testing, ctwm outperforms the qt method and can manage the bias arising from allele frequency differences. in particular, if a study is focused on investigating genetic differences between groups, ctwm-gs method can be used regardless any possible population-level differences. these results indicate that the ctwm and ctwm-gs methods are effective for eqtl and esnp identification, respectively, regardless of baseline differences between groups, and that these methods have the potential to distinguish population-level and genetic-level differences between groups. note that although the nominal level of significance is fixed , the empirical type i error rates do not always remained fixed. in the simulations, the type i error rate could be inflated as the trade-off for higher power. therefore, when comparing different methods, type i error and power should be considered simultaneously.

in current eqtl studies, ig method is a conventional technique to identify the significant eqtl commonly presented in two populations  <cit> . the composite hypothesis is a union of  <dig> sub-hypotheses in each population, and it will be rejected only if both  <dig> sub-hypotheses are rejected simultaneously. the low type i error and power are expected. in addition, we have used ig method with the hypothesis composed of the intersection of  <dig> sub-hypotheses. the hypothesis would therefore be rejected if either of the sub-hypotheses is rejected. our simulation results showed that the power of this method is still lower  than that obtained from ctwm . possible reasons of these results include the smaller sample size due to splitting data, the higher significant threshold due to multiple test adjustment, etc. in addition to ctwm, a two-way anova with an interaction term is a comprehensive model that allows for different snp effects in each population. the simulation results based on this method still showed lower power in detecting snp effects on gene expressions compared to ctwm, except when p
 <dig> 
was zero . that is because the number of parameters used in the two-way anova with interactions was the same with that in ctwm when p
 <dig> 
was zero.

using the f distribution to test gs directly, our simulations showed that if the null hypothesis  was under the assumption of e =  <dig>  then the probabilities of rejecting the h <dig> were properly controlled around  <dig>  given level α =  <dig>  . when a more general null hypothesis for gs =  <dig> was considered as the condition of e =  <dig> or d =  <dig>  however, the rejection probability under d =  <dig> was inflated as e increased; e.g. the rejection probability reached  <dig>  given level α =  <dig> , when e =  <dig>  and d =  <dig> . this deviation was possibly due to the fact that the simulated difference of genotype frequency might be drifted away from zero even when d was fixed at  <dig>  these estimated differences of genotype frequency between populations had been regarded as constants in the test statistic and therefore higher e values produced higher rejection probabilities for h <dig>  additional permutation tests were performed to generate empirical null distributions of the test statistic and compare the rejection probabilities with those observed from using the f distribution directly. the results showed that permutation approach could partially decrease the rejection probabilities, but the probabilities would still be inflated as e value increased given that d =  <dig> . since those p
ij
's in the vector b = , ) for testing gs need to be estimated from the data, a further study is needed to discuss the impact of non-constant issue of b.

using ctwm, we identified  <dig>  common eqtl with  <dig>  expression traits with the underlying fdr less than 1%, and these traits included all the  <dig> traits identified by the ig method. these results suggest that ctwm has greater power to identify common eqtl and empirically supports the assumption of homogeneous snp effects between populations for common eqtl. however, one concern with these reports is that, the use of all snps on the array to model eqtl might inflate the number of eqtl and reduce fdr due to redundancy in the snps that were not taken into account. we therefore performed a data analysis on the  <dig>  tag snps obtained from affymetrix  <dig> k array using hapblock program  <cit> . results showed that the number of the expression traits with at least one significant eqtl  was similar compared to that obtained from using all snps on the affymetrix  <dig> k array . however, the number of eqtl identified and snp mapped were sharply decreased . we noted that the number of tag snps was only a third of the number of snps on the  <dig> k array and about a third of the eqtl were identified . these results suggested that the influence of redundancy in the snps was minor in this study.

further investigation of the mapping positions of the  <dig>  putative eqtl revealed that most of the putative eqtl in local regions had smaller p-values than those in distant regions. this is because local eqtl are highly heritable  <cit>  and impact genes more directly in the regulatory sequences. this finding is in concordance with previous cis eqtl studies  <cit> , however, the majority of the gene expression traits were most significantly associated with eqtl in distant regions. this phenomenon could be explained partially by the criterion that we defined as 'most significant'; that is, for a ge trait with multiple significant eqtl, only the snp with the smallest snp-ge association p-value was selected into the analysis. in addition, this may also have arisen because gene correlations are inherent in the same biochemical pathway  <cit>  or because of genes that are tightly regulated by hotspots  <cit> . these possibilities should be investigated further.

dissecting allele frequencies of the putative eqtl showed that the eqtl at greater distances from the target genes had smaller allele frequencies than those in or near the genes. a number of genetical genomic studies have shown that cis eqtl were more reproducible and were usually mapped with higher statistical significance than those in trans eqtl  <cit> . diversified factors underlying the complexity of gene regulation could contribute to this phenomenon, such as polygenic regulation, environmental input and possibly interactions among loci  <cit> . for example, in yeast studies, it has been observed that distinct trans-acting loci could exert contrasting effects on gene expression and highly heritable transcripts could exhibit transgressive segregation or epistatic effects  <cit> . therefore, our finding does not necessarily imply causality between the allele frequencies and the type of eqtl. however, rare minor alleles may partially account for the incapability of the ig method to identify common distant eqtl. that is, because the samples were separated into two independent studies, common distant eqtl would then be difficult to be detected and reproduced in two populations with small sample size and/or small allele frequency. these results suggest that proper combination of different ethnic datasets to increase the sample size can overcome statistical barriers inherent in unbalanced genotype data and might result in an association mapping that is more precise for identification of eqtl.

in the analysis presented, we limited the number of association tests by only considering snps on the same chromosome with the gene transcripts, so that only within-chromosome associations were tested. the reason was two fold. first, computation time was extremely long if all chromosomes were considered. second, a higher threshold was needed given a huge number of association tests performed and would cause lower power in the study with a small sample size. although the trans-acting eqtl could locate on a different chromosome from where the gene is located  <cit> , recent studies have demonstrated that most of the intense significant signals appeared in the cis region by using a loose definition  <cit> . therefore, we only considered mapping the associations by a chromosome-wide strategy. the implications of our results are therefore limited to the same chromosome. however, it provides a crude picture about the characteristics of local- and distant-acting eqtl.

as many other methods, ctwm also assumes that snp effects are similar between populations in the combined data. this assumption presumably can largely reduce the complexity of the model and the number of parameters needed. after comparing the associations found among all populations, veyrieras et al.  suggested that significant snp-ge associations were usually shared in different populations  <cit> . however, whether the magnitude of the snp effect on ge was similar for any particular snp-ge association in different populations remained unclear. our results indicate that, for the  <dig>  putative common eqtl identified by ctwm, only  <dig> % had significant interaction effects following fdr correction . this proportion was probably underestimated due to the rigorous inclusion criterion on the  <dig>  putative eqtl. therefore, similar analyses were performed using all  <dig>  significant eqtl, and results showed that  <dig>   eqtl had significant signals  for interaction terms. the discrepancy between the two results could be due to high false positives or violations of homogenous snp effect sizes. because we restricted our attention to only eqtl identified by ctwm, our results did not imply that all snp effects were necessarily homogeneous in the eqtl study in multiple populations. our results exhibited the characters of putative eqtl identified by the model. that is, population-level differences in ge substantially affected eqtl identification, and snp effects were similar between populations. these results may form a basis for further studies in which different datasets are to be combined to increase the statistical power for identifying common eqtl with similar effects.

in microarray-based gwas, mapping regulatory variations on gene expression data is more promising than mapping regulatory variations on complex clinical phenotypes  <cit> . by using combined data and ctwm-gs, our goal is to detect associations between snp and ge and further explore whether the discrepancy between allele frequencies causes the different levels of ge in different populations. it is possible to compare allelic frequencies of snps between populations and then test the association of these snps with ge data. however, the association between ge and populations can not be directly implied given associations between populations and snps which are correlated with ge  <cit> . for example, a transcript c8orf <dig> was associated with a putative eqtl 'rs998683'  and showed high discrepancy in allelic frequencies  between ceu and asian cohorts. however, the overall expression level of that transcript was non-differentially expressed between the two cohorts as shown in the additional file  <dig>  this phenomenon was in agreement with the previous genetic genomic study of the childhood asthma, where moffatt et al.  found the expression level of ormdl <dig> to be strongly associated with a disease-associated marker 'rs7216389'. however, the overall ge difference between non-asthmatics and asthmatics cohorts was not significant. the advantage of using ctwm-gs is that gene expression differences between populations can be partitioned into two parts--genetic differences  and non-genetic differences --and both are tested independently.

we have demonstrated that genetic effects on gene expression between populations can be calculated by the gs from data with three dimensions: ge level, snp genotype, and ethnicity. the gs combines two effects of a particular snp-ge combination--the genotype frequency differences between populations and the differences in the gene expression levels directed by genotypes. thus, a smaller gs p-value does not necessarily imply a greater allele frequency difference or a substantial snp effect. to prioritize candidate esnps, it is more advantageous to rank the gs among a significant esnp set rather than to rank their p-values directly. using this strategy, we demonstrated that a large set of esnps contributes to a significant gs, and identified a small subset of  <dig> unique esnps that generated significant absolute gs values  between ceu and asian cohorts. using this subset of esnps, the ceu and asian cohorts can be easily distinguished. these results indicated that gs not only assisted in filtering functional snps but also improved identification of those snps with causal potential.

CONCLUSIONS
we investigated the statistical issues associated with common eqtl identification using data combined from different populations. because differentially expressed genes and snps with divergent allele frequencies are common among ethnic populations  <cit> , it is believed that combining genetic genomic datasets across populations improves identification of common eqtl. we have demonstrated the impact of mafs on identification of common eqtl using either separate or combined population data. quantile transformation to a standard normal distribution is a useful strategy for normalizing gene expression data derived from different populations; however, it did not explicitly take into account the diversity of mafs among populations and may result in misled statistical conclusions in eqtl study. instead of transforming ethnic expression data, we showed that application of ctwm to model snp-ge associations directly onto the original expression data might correct the expression bias arouse from genetic diversity among populations.

we further explored the applicability of ctwm to hapmap populations. as a result, ctwm was shown to be comprehensive and was highly effective in identifying common eqtl in either local or distant regions with similar snp effects on ge levels between populations. further extension of the ctwm to estimate the gs between populations provided an additional statistical test  for identifying esnps. this method can also be used to examine genetic genomic data containing both case and control individuals. such studies can provide new insights into disease etiology by identifying potential esnps with allele frequency differences or that are associated with different gene expression levels in the populations.

authors' contributions
clh designed the study, analyzed the data and drafted the paper. ibl helped to develop the methods. arh participated in the statistical analysis of the results. csjf provided analytic support and supervised the project. all authors read and approved the final manuscript.

supplementary material
additional file 1
supplementary material. this pdf contains the details of methods for qt, ctwm, ctwm-gs and simulations.

click here for file

 additional file 2
simulations with baseline differences. this pdf contains the graphs of simulation results at d =  <dig>   depicts type i error  and power  versus different allele frequency of group  <dig> . the three color bars are as explained in the legend of figure  <dig>   depicts type i error rate  and power  versus different allele frequency of group  <dig> for ctwm-gs. the three color bars are as explained in the legend of figure  <dig> 

click here for file

 additional file 3
estimates of bd and gs. this pdf summarizes the estimates of bd and gs under the null  and alternative  hypotheses, respectively, in the simulation studies. the dots are means of the baseline difference  and genetic score  estimated by ctwm-gs. arrows of each dot represent the 95% confidence interval calculated from  <dig>  simulations. dash lines are the true values of bd  and gs  derived from parameters used in the simulations.

click here for file

 additional file 4
summary of putative eqtl generated using ctwm. this pdf summarizes  -log <dig> p-values or  allele frequencies with respect to local  and distant  eqtl by histogram and boxplot underlying the  <dig>  putative eqtl identified by ctwm. the histogram is a representation of probability densities .

click here for file

 additional file 5
supplementary table. this pdf summarizes the  <dig> esnps selected using a gs threshold of  <dig> .

click here for file

 additional file 6
supplementary simulation results. this pdf contains the graphs of simulation results as explained in the legend to figure  <dig> with three different testing methods as follows: blue, ctwm; yellow, ig method with hypothesis composed of the intersection of  <dig> sub-hypothesis; brown, two-way anova with interaction term.

click here for file

 additional file 7
comparing f test with permutation test. this pdf describes methods and results for comparing f test with permutation test.

click here for file

 additional file 8
results from using tag snps. this pdf summarizes the eqtl data generated by ic and ctwm method, and esnps identified by ctwm-gs method underlying  <dig>  tag snps.

click here for file

 acknowledgements
we would like to thank the reviewers, for their variable and constructive comments and suggestions which have help to improve the manuscript. we were additionally grateful to dr. c.h. lin  for acquisition of data, and to dr. h.c. kuo  for suggestions on data analysis. this research was supported by national science council grants  of taiwan.
