BACKGROUND
marine cyanobacteria prochlorococcus and synechococcus constitute the main prokaryotic fraction of oceanic phytoplankton  <cit> . their photosynthetic membrane contains two reaction centers, of which photosystem ii  mediates the transfer of electrons and protons from water, the terminal electron donor, to the plastoquinone pool. the d <dig> and d <dig> proteins form the reaction center of psii, which binds the primary electron donors and acceptors. the genes coding for the d <dig> and d <dig> proteins, psba and psbd, were found recently in the genomes of cyanophages from the myoviridae and podoviridae families  <cit>  and were readily detected in recent marine metagenomics projects  <cit> 

recently, a possible exchange and reshuffling of psba genes between synechococcus and prochlorococcus bacteria by horizontal gene transfer  via phage intermediates was proposed  <cit> . furthermore, observations based on data extracted from the global ocean sampling  expedition  <cit>  suggested that the phage genes undergo an independent selection for distinct d <dig> proteins  <cit> . the d <dig> pest-like domain  in the loop between helices d and e was identified as the target for this viral selection, having specific viral motifs. the d <dig> protein has a rapid turnover and must be replaced continuously in order to enable the sustained functioning of psii . the fact that viruses invest in modifying the d <dig> proteins led to the hypothesis that an adaptive role for this function is involved, facilitating adaptation to harsh light conditions or modifying the d <dig> role for their selfish benefits . in addition, viral specific psba transcripts were detected directly in one marine sample, implicating that these viral photosynthetic proteins are expressed in the marine environment  <cit> . these novel observations requires further investigation with much more samples taken at different locations and times, with both genomic dna and rna transcripts sampled.

based on early genomic studies, it was concluded that different species have a unique sequence composition, which has been named 'genomic signature'  <cit> . the existence of specific genomic compositions has been demonstrated for short oligonucleotides, such as dinucleotides, trinucleotides and tetranucleotides  <cit> . based on differences in the genomic composition of bacterial and eukaryotic genomes, supervised and unsupervised classification methods have been developed, such as the naïve bayesian classifier  <cit>  and the neural network self-organizing maps   <cit> . characterization and classification of species based on the genomic composition of longer oligonucleotides, such as the chaos game representation   <cit> , has also been demonstrated. several of these approaches have been developed and applied to specifically identify hgt events based on genomic signatures  <cit> .

the number of unknown taxonomic origin fragments coming directly from the environment has grown rapidly in the past few years  <cit> . hence, tools that couple such fragments to their taxonomic origin are extremely valuable for metagenomics research  <cit> . to better describe and understand the phenomenon of marine viral 'photosynthesis' and to further study the hgt of core photosystem-ii genes between phages and bacteria, we studied psba genes and transcripts obtained directly from the environment. for rapid classification, we employed a powerful approach that combines genomic composition and position-specific codon usage to identify the specific taxonomic origin of the fragments . overall, for binary classification our method achieved very high accuracy when tested on annotated psba fragments from the gos . to further verify the accuracy of the multi-group classification method and its applicability to similar classification problems, we tested it on an independent dataset of viral psba sequences from a recent study by chenard and suttle   <cit>  that included freshwater samples, as well as on annotated psbd gene fragments from the gos. overall, our results were highly consistent with original annotations . finally, we applied the method to a large set of psba clones, including dna and transcribed rna sequences from the mediterranean sea. we found that the distribution of bacterial taxa  was highly correlated when examining the genes versus the transcripts, whereas no such correlation was observed for the phages.

RESULTS
in order to shed light on the diversity and dynamics of marine cyanobacteria and their phages, we examined the spatial and seasonal distribution of psba genes and transcripts in the eastern mediterranean sea. we sampled two locations: a coastal station  and a pelagic station  during the years  <dig> and  <dig>  psba genes and transcripts from mixed picoplankton assemblages were pcr amplified directly from dna or rna extracts using newly designed psba primers  <cit> . although these primers are general and amplify psba from picoeukarya, cyanobacteria and cyanophages, they are not biased against high gc environmental synechococcus psbas . it should be noted that the amplified pcr products reported in this study are unique only to this primer set.

a total of  <dig>  randomly picked clones containing psba inserts  were sequenced;  <dig> were dna-derived clones and  <dig> were retrieved from rna. as a first step in sorting phage and cyanobacterial psba genes and transcripts, picoeukaryal psbas were removed based on phylogenetic trees and top blast hits. interestingly, while almost undetectable in the dna extracts, eukaryal psba transcripts dominated in several stations and could reach up to 88% of the total psba rna . this observation is in good agreement with longstanding observations that different samples numerically dominated by cyanobacteria  are in fact dominated  by picoeukaryotes  <cit> .

classifying psba fragments based on genomic composition using svm
the d <dig> protein sequence is very well conserved amongst bacteria and viruses except for two regions  <cit> . the first variable region lies within the pest-like domain located in the loop between transmembrane helices d and e. the second variable region is the viral d <dig>  which differs from the cyanobacterial sequences at the end of transmembrane helix e and precedes the c-terminal residues of mature cyanobacterial d <dig>  these regions possess different sequence motifs that distinguish between the phages and their hosts  <cit> . however, since the vast majority of the protein sequence is highly conserved, taxonomic classifications that rely solely on these motifs are prone to error. based on the hypothesis that psba has undergone horizontal transfer events between the bacteria to the phages, its sequence composition may reflect two major processes acting at both the protein  and the dna level. at the protein level, adaptive changes could make viral d <dig> proteins less susceptible to photo-damage and could influence its turnover. additionally, transferred genes are prone to amelioration processes that cause them to reflect the dna composition of the received genome over time  <cit> .

previous studies have attempted to distinguish bacterial from viral psba genes based on gc content  <cit> . in synechococcus, the gc composition differs significantly between the host and its phage: for example, synechococcus phage psba sequences have a noticeably lower percentage of gc  <cit> . such differences in gc content were not observed in prochlorococcus phages and their host psba sequences, therefore these differences are not sufficient to unambiguously assign sequences to the phage or the host. to uniquely identify the psba origin based on nucleotide composition information, we chose to employ a machine learning technique called support vector machine   <cit> . svm has been shown to be a very successful classification tool for biological problems  <cit>  including phylogenetic characterization  <cit> . in this study, the input vectors for the svm were combined from nucleotide composition information  of each psba fragment.

our svm training set was derived from  <dig> and  <dig> cultured prochlorococcus host and phage psba sequences, respectively. in addition,  <dig> and  <dig> synechococcus host and phage sequences were extracted from cultured data . as a first step, we tested the method on an independent set of  <dig> psba fragments from the gos dataset  <cit> . applying the svm classifier based on nucleotide composition, each fragment in the testing set was labeled as prochlorococcus bacteria, prochlorococcus-like phage synechococcus bacteria and synechococcus-like phage. to evaluate the accuracy  of the svm, we compared our results to the original classification derived from phylogenetic analysis, based on dna trees <cit> , and neighboring genes  <cit>  . overall, when combining the frequency of mono-, di-, tri- and tetranucleotides in our feature vector, we correctly classified 93% and 100% of the prochlorococcus and synechococcus sequences, respectively. detailed results for prochlorococcus classifications are given in table  <dig> and illustrated in figure  <dig> 

given the differences in gc content between synechoccoccus and synechoccoccus-like phages, a high performance of the classification was expected. nevertheless, the extremely high prediction accuracy for classifying prochlorococcus vs. prochlorococcus-like phages was not anticipated. in order to better understand which of the oligonucleotide features contribute to the classification, we performed a simple feature selection analysis, each time training and testing the svm on a different set of oligonucleotide composition . the results of the svm tests are illustrated in figure  <dig> . as expected, the mononucleotide frequencies were least informative, achieving an overall accuracy of 75% with 0% sensitivity due to no true positive results . as previously demonstrated for genomic sequences  <cit> , the tetranucleotide frequencies differentiated best between host and phage psba sequences with a prediction accuracy of 97%. when including all oligonucleotide frequencies in the feature vectors , classification performance decreased, giving very similar results as when including only dinucleotide frequencies . overall, the svm results tested on psba gene fragments from the gos data were very promising. as most of the psba fragments from gos were of full length , we were interested to test how well the svm performed on shorter fragments anticipated from metagenomics studies. to examine this, we tested the svm including only the tetranucleotide frequencies on randomly selected short psba fragments from the gos data of length  <dig>   <dig> and  <dig> bp. as shown in table  <dig>  the average prediction accuracy for classifying prochlorococcus vs. prochlorococcus-like phages was extremely high for short fragments of length  <dig> bp and  <dig> bp. a considerable reduction in performance was observed for the short sequences of length  <dig> bp. it is important to note that svm is a supervised approach that requires the existence of trustworthy data for training. thus, this method could not be applicable for the taxonomic classification of any random short sequences that are not homologues to the training dataset. this result is consistent with a recent study for classifying short fragments based on blast hits  <cit> . nevertheless, given a set of training data for a specific gene, use of the svm is possible for automatically defining whether a random short sequence fits the gene model and subsequently classifying it as a viral or bacterial origin.

* the analysis of randomly chosen fragments for sequences of lengths  <dig>   <dig> and  <dig> bp was repeated  <dig>   <dig> and  <dig> times, respectively.

classifying psba fragments based on codon usage using cupssm
another common technique for genome classification is based on codon usage frequencies  <cit> . to test whether differences in codon usage at each position of the d <dig> proteins can be applied to the taxonomic classification of short fragments of highly conserved genes, we constructed a codon usage position specific scoring matrix  for each set of training data . for comparison, we derived a standard pssm based solely on amino acid frequency. in a standard pssm, each column in the matrix corresponds to a single residue in the aligned d <dig> protein, and each line represents the frequency of an amino acid at each position. notably, we found that classification based on codon usage information was significantly more accurate  than classification based on amino acid information alone . overall, the results obtained using the cupssm for full fragments were comparable to the svm results based on overall nucleotide composition when ignoring the position information. in order to examine whether the prediction depends on variable regions, such as the pest-like domain and the end of transmembrane helix e in the c-terminal, we reproduced the same tests excluding these regions. while the pest-like domain was found to be obligatory for classifying d <dig> proteins at the amino acid level, it was not required for classification when depending on either the codon usage or the nucleotide signature of the gene. further, as shown in table  <dig>  when applying the cupssm to randomly chosen partial sequences, a very high accuracy was achieved even for short sequences of  <dig> bp. these results reinforce that both the svm and the cupssm methods are applicable for classifying the viral or bacterial origin of short psba fragments. however, the main disadvantage of these approaches is that they can only be applied to genes for which training data are available; they cannot be used for the classification of any random fragment obtained from metagenomics studies. in comparison to svm, the cupssm approach depends greatly on the quality of the alignment of the query sequence to the training data and thus can only be applicable for highly conserved genes.

a combined approach for fragment classification
to study the distribution of psba genes and transcripts in the marine environment, we sought a method that could further subclassify the fragments into their explicit taxonomic origins: synechococcus, synechococcus-like myovirus, synechococcus-like podovirus, high-light adapted prochlorococcus , low-light adapted prochlorococcus , prochlorococcus-like myovirus and prochlorococcus-like podovirus. to date, only a small number of genomes from cultured marine synechococcus and prochlorococcus and their phages are available for training. specifically, synechococcus podovirus psba sequences and ll-prochlorococcus are underrepresented in culture. to broaden the psba representation, we included in the training set fragments from the gos expedition that were annotated based on dna trees  and on neighboring genes  . to first examine whether the psba genes in the training set clustered into distinct groups based on their nucleotide composition, we applied an unsupervised clustering method, principle component analysis   <cit>  , to the gos data representing each sequence by the oligonucleotide frequencies vector. as illustrated in figure 2a, of the seven groups, six clearly showed distinct clusters . the only sequences that did not cluster in the pca were the ll-prochlorococcus , presumably due to their under-representation in the data.

although the pca clustering clearly indicates that psba fragments can be grouped based on their oligonucleotide frequencies, it is not a practical method for the automatic and accurate classification of large amounts of data. thus, we expanded our binary prediction described above to a multi-class problem. to this end, we built seven new svm classifiers, one for each taxonomic group. in each classifier, we trained an svm to separate one of the seven groups from all the other groups using the oligonucleotide frequencies as a feature vector. subsequently, each fragment was tested on each of the classifiers and was given a discriminate value, denoting the confidence that the fragment belongs to the specific group. further, the discriminate values produced by each classifier were ranked, and the tested fragment was labeled based on the classifier in which it received the highest positive value. independently, we built seven cupssms based on the codon usage of the training data. the tested sequences were then aligned to a template psba gene, scored against seven different cupssms  and given a label based on the cupssm for which it achieved the highest score. to assure an accurate prediction of the testing data, each fragment was examined against the two classifiers independently, and a final label was acquired only when the results of the two classifiers converged. a summary of our classification methodology is illustrated in figure  <dig>  as illustrated, when given a sequence, it is independently tested by two classifiers:  multi-class svm and  cupssm. further, the results of the two approaches are combined and compared. sequences for which the two independent classifiers converged are classified according to the common sub-classification . in cases where there is no agreement between the two classifiers , sequences are considered "un predicted" and are subjected to a manual decision.

to evaluate the performance of the classifier on an independent dataset, we tested it on a recent dataset of cultured and uncultured viral psba fragments from freshwater and marine environments  <cit> . as shown in table s <dig> , there was a 92% agreement for the full-length fragment  between our predictions  and the phylogenetic-based annotation  <cit> . notably, all  <dig> sequences originated from culture were predicted correctly by our classifier. interestingly, the classifier was able to detect two synechococcus podoviruses containing psba genes. these two may be added to the only two currently known cultured synechococcus podovirus  <cit> . notably, when applied to the multi-class problem, our method still achieved a relative high performance for a partial length sequence of  <dig> bp, however, as shown, shorter fragments could not be predicted with high accuracy .

we further tested the applicability of the method for the taxonomic classification of the psbd gene, which codes for the d <dig> proteins. in this case, we trained the algorithm on a set of annotated psbd genes from culture and tested it on the psbd fragments from the gos. here again, the prediction of our automatic classifier was compared to independent annotations based on phylogenetics analysis <cit>  and neighboring genes <cit>  . as shown in table s <dig>  out of the  <dig> annotated sequences, we correctly predicted  <dig> . of the  <dig> missed annotations, in  <dig> the method did not converge , while only two synechococcus bacterial sequences were predicted incorrectly as synechococcus viral sequences.

studying psba dynamics in the mediterranean sea based on supervised classification
confident with the test results on psba and psbd gene fragments, we applied our classifier to dna sequences from the mediterranean sea. the prediction results for the sequences extracted from all stations at different times of the year are summarized in table  <dig>  as shown, in  <dig> of the  <dig> psba fragments , the classifications to one of seven taxonomic groups based on the svm and the cupssm were identical. for validation, we again applied a pca analysis to the test data from the mediterranean and superimposed it on the fully informed training data . figure 2b illustrates the test results for station tb <dig> from the mediterranean sea  plotted on the background of the gos training data. as shown, samples from the test data in the majority of cases  fell within the corresponding clusters from the training set, i.e., sequences from the training set that were classified by our prediction method as being synechococcus-like podo viruses  fell within the cluster of the same subclass from the gos data. interestingly, the seven sequences for which there was no classification agreement in our classifier  did not coincide with a specific cluster, and rather appeared to be located between the bacterial and viral branches.

# – location, station; $ – sequence; &– no decision; * – total ph – prochlorococcus hl- bacteria; pl – prochlorococcus ll- bacteria; s – synechococcus bacteria; pm – prochlorococcus myovirus; pp – prochlorococcus podovirus; sm – synechococcus myovirus; sp – synechococcus podovirus

estimation of sampling efficiency
in order to evaluate if our pcr samplings approximated the natural psba diversity in our samples, we performed a naïve rarefaction analysis of both the rna and dna sequences. the analysis suggested that each sampling was performed more thoroughly on the dna population than on the rna sequences, yet both were sampled very thoroughly. sampling of translated sequences was saturated  at distances of  <dig>  for the rna samples  and  <dig>  for the dna samples. separating the collection not by the collection method  but instead into pools of predicted bacterial and viral origins  demonstrates that the bacterial sampling is saturated at an amino acid distance of  <dig>  and the viral at  <dig> .

psba dynamics at the dna level
based on our predictions, we found that the pelagic station  dcm  depth  was dominated by one bacterial group , while viral sequences belonged to two groups  . a similar trend was observed at the surface water of station tb <dig> in january  <dig>  with synechococcus-like phages and only prochlorococcus-like hosts . in addition, in surface water at station tb <dig> in may  <dig>  prochlorococcus-like phages sequences were detected, while no prochlorococcus-like hosts were observed. our observations from station tb <dig>  were also confirmed when compared to flow cytometry results applied to the same samples. these results again indicated that only one bacterial group is present while the phages carry psba genes from both bacterial groups. usually, cyanobacterial host genes tend to be acquired by host-like phages   <cit> . however, rare events in which phage psba did not cluster with their hosts and did not have psba isoforms consistent with that of their hosts were also observed . this phenomenon was hypothesized to be the result of gene swapping when two or more different viruses infect the same host  <cit> . our observations further support the hypothesis that these swapping events occur when different viruses  infect the same host  <cit> .

psba dynamics at the rna level
among all rna-derived clones, only a single psba sequence was classified as a synechococcus-like podovirus while an additional seven sequences  gave conflicting scores . these sequences had very low identity  to prochlorococcus. in order to examine these sequences, we tested several features:  psba gc content;  d <dig> protein signature motif;  pca topologies; and  psba tree topologies. a simple analysis of their nucleotide contents showed that the gc content is 47–48%, which is consistent with the gc content of synechococcus-like phages  . when applying a phylogenic analysis, all seven sequences were clustered with synechococcus-like podoviruses, but had a common branch with prochlorococcus mit <dig> in the psba tree . taken together, we suspect that the seven clones are synechococcus-like phages. however, the deposition of additional future psba sequences in the genbank could modify our predictions and classify these sequences into another group.

psba dynamics at both rna and dna levels
when comparing psbas genes and transcripts, we observed that rna and dna levels correlated for different predicted bacterial groups, whereas no such correlation was observed in phages . figure  <dig> illustrates the distribution of dna  and rna  samples among the seven subclasses in station tb <dig> from surface water  and d1-p ) plotted on the background of the clusters from the gos training data. as shown, while synechococcus-like podoviruses  are most abundant in the dna samples, only one was predicted in the rna samples. nevertheless, the bacteria sequences were distributed similarly in the rna and dna samples from the same station. interestingly, in both dna and rna samples, we observe a relatively large cluster of ll-prochlorococcus sequences . as discussed above, the latter group was underrepresented in the training data and did not generate a distinct cluster. other cases where host genes were predicted only in the rna could be explained by a high expression of these psba genes, along with a low cell abundance. the opposite phenomenon  could possibly result from low expression of psba at the time of sampling. overall, 73% of the dna-derived clones were classified as cyanophages, whereas less than  <dig> % of the rna-derived clones were classified as phages.

d <dig> viral/bacterial motif search
amino acid variations in the variable loop between helices d and e  were observed recently in the viral fraction of the gos data  <cit> . this d <dig> pest-like domain is implicated as the site of initial cleavage in the d <dig> protein and is assumed to be important for d <dig> turnover rate. as our classification method does not rely on this variable region, we were interested in examining this phenomenon in the mediterranean sea data. as previously observed, d1s assigned to bacteria mainly contained the known ese and eae cyanobacterial motifs while the viral sequences contained  <dig> different motif variants , most of which were the same viral motifs previously observed in the gos data  <cit> . several different new viral motifs were observed only in the mediterranean samples . interestingly, one viral motif  completely deviated from the canonical r/kettxxxsq/h cyanobacterial motif and included changes throughout the entire loop . it is important to note that our classifier not only does not rely on loop sequence, but achieves identical classifications when these sequences are removed from the data. to better understand the nature of these unique d1s, we searched the database for similar psba sequences. one gos sequence  had a 100% match to rna d <dig> clone p_e <dig> and also included two predicted hypothetical cyanophage orfs , further confirming our viral affiliation predictions.

CONCLUSIONS
in this paper we employed two independent classification methods for identifying the origin of psba genes: 1) cupssm, based on position specific codon usage; and 2) a machine learning approach  trained on oligonucleotide  composition. combining the two approaches, we built a classifier for rapid and accurate annotation of core photosystem-ii genes and transcripts to seven taxonomic classes of cyanobacteria and cyanophages. when tested on independent datasets from culture and from the environment, the method demonstrated a very high accuracy, ranging from 92–100% true predictions for psba and psbd gene fragments. when tested specifically on short sequences, we showed that for binary classification, the method can accurately predict very short partial gene fragments  while the multi-class classifier achieved a high performance for partial fragments of  <dig> bp and longer. the great advantage of this classification method is that it does not rely on having the whole gene and can be applied to partial sequences that could be derived in the future from rapid sequencing methods without the need for assembly processes. however, as a supervised approach, accurate classification requires the availability of reliable annotated training data for the gene of interest, and cannot be applied for annotating any random sequence extracted from the environment.

finally, we applied the method to rapidly classified psba dna and rna sequences extracted from the mediterranean sea, and studied the spatial distribution of the host and viral genes and transcripts from different depths and at different seasons. our results show that bacterial psba gene and transcript levels were highly correlated, whereas no such correlation was observed in phages, which were observed mainly on the gene level and rarely as transcripts.

