BACKGROUND
transmembrane channel and transporter proteins are found in the membranes of virtually all organisms and play crucial roles in facilitating the passage of ions and molecules across lipid bilayers. they are essential in maintaining the cross-membrane electrochemical gradient that is essential for a wide variety of fundamental biological processes, from oxidative phosphorylation to signal transduction. for example, voltage-gated ion channels are a class of channel protein that are especially critical for neuron and muscle function. they are activated  by local changes in electrical potential difference causing an influx of cations, typically sodium or potassium, which induces rapid and coordinated membrane potential depolarisation in response to voltage change, therefore propagating the electrical signal between cells  <cit> . voltage-gated calcium channels behave similarly but have high permeability to calcium ions when depolarised and are involved in additional pathways including neurotransmitter release at pre-synaptic nerve endings  <cit> . aquaporins, members of the major intrinsic protein  family, are channel proteins that selectively conduct water and small uncharged molecules, such as glycerol, across the membrane  <cit> . they are however completely impermeable to charged species, a property critical for the conservation of the membrane’s electrochemical potential. in mammals, aquaporins are frequently located in the kidney where they play an essential role in water reabsorption. also found in the kidney is the urea transporter, a specialised channel capable of rapid and selective urea permeation. the crystal structure bears many similarities to ion channels although the presence of a constricted selectivity filter that can accommodate several dehydrated urea molecules in single file confers selectivity for urea  <cit> . aside from ions and small molecules, other channels and transporters mediate the transfer of a range of larger biological molecules across the membrane including proteins by the general secretory pathway  translocase family  <cit> , double-stranded dna by the septal dna translocator  family  <cit>  and mrna via interactions between the nuclear mrna exporter  family and the nuclear pore to facilitate transport into the cytoplasm  <cit> . channel and transporter proteins are thus found in a diverse range of cell types and occur as large families of related genes with cell and tissue specific expression patterns. as can be expected, due to their extensive functional diversity, many common diseases including diabetes, hypertension, cardiac arrhythmias, angina pectoris and epilepsy have been related to channel protein dysfunction, therefore transmembrane channels represent one of the most important classes of protein for pharmaceutical intervention  <cit> .

typically, channel proteins contain a cavity  which spans the entire molecule with an opening on each side of the membrane. the pore often runs parallel to transmembrane helices, forming the path along which ions or molecules travel, with adjacent structural or compositional features determining pore specificity. in many ion channels for example, channel-lining transmembrane helices are enriched with charged residues, thus facilitating passage of the cognate ion through the channel. however, many membrane proteins that are not ion channels contain charged residues within the transmembrane region that are used to stabilise helix-helix interaction, e.g. via formation of salt bridges, thus the presence of charged residues alone cannot be used to discriminate pore-forming regions. nonetheless, by taking advantage of a number of recent methods that allow the identification of pore-lining residues in membrane protein crystal structures, computational approaches to automatically detect channels are feasible and are likely to provide valuable insight into both structure and function. pore-walker  <cit>  identifies the pore centre and pore axis using geometric criteria, allowing the biggest and longest cavity through the channel to be detected. pore features, including diameter profiles, pore-lining residues, size, shape and regularity can then be calculated.

here, we present a novel method to automatically predict pore-lining helices in transmembrane proteins. by using pore-walker to label pore-lining residues in a training set of transmembrane protein structures, we have employed a supervised learning approach to predict the likelihood of a transmembrane helix being involved in pore formation. results from testing our method on a crystal structure data set indicate that a prediction accuracy of 72% is possible. using these predictions as inputs for a support vector regression model, we also show that it is possible to determine pore stoichiometry, i.e. the number of subunits required to form the complete pore, with 62% accuracy.

methods
data sets
in order to identify pore-lining residues, we used a high resolution data set based on a previously described crystal structure set  <cit> , subsequently updated with recent additions to the orientation of proteins in membranes  database  <cit>  and homology reduced at the 40% sequence identity level. proteins that lacked either an entry in the transporter classification database   <cit>  or gene ontology  biological process terms  <cit>  relating to transmembrane transport were then removed. we then used pore-walker  <cit> , a fully automated method which detects and characterises channels in transmembrane proteins from their 3d structures, to identify any residues which were exposed to the predicted pore. while other tools such as mole  <cit> , caver  <cit> , hollow  <cit>  and molaxis  <cit>  are capable of generating accurate representations of channels in molecular structures, the pore-walker algorithm is specifically designed to detect channels and pores in transmembrane proteins by incorporating the typical geometry of membrane proteins, in which the protein’s secondary structures, and therefore the channel, tend to lie perpendicularly to the transmembrane plane. additionally, these four methods require a priori knowledge of the channel location in order to calculate a route from inside the protein to the outside environment. in a number of cases, pore-walker either failed to complete or incorrectly identified the transmembrane plane, resulting in a predicted pore that ran approximately parallel to the membrane plane, while in other cases the pore was completely misaligned with the structure. where a visual inspection revealed such erroneous pore placement, or where pore placement disagreed with the literature, the protein chain was removed from the data set, resulting in a final training set of  <dig> chains from  <dig> protein complexes for which pore-lining residues were identified.

machine learning
we used a support vector machine  classifier to discriminate between the two data classes–residues within the transmembrane region that lined the predicted pore, and residues within the transmembrane region that did not. input features were generated using evolutionary information. for each sequence in our training set, psi-blast  <cit>  was used to generate position-specific scoring matrices. two search iterations were performed against the uniref <dig> database  <cit>  with a profile-inclusion e-value threshold of 1e- <dig>  we applied a sliding window approach to extract data from the matrix using a window size of  <dig> centred on the target residue, creating a feature vector of length  <dig>  standardising by z-score to enable faster svm convergence ). only residues from transmembrane helices were used for training, with those predicted as pore-lining labelled as positive examples or negative otherwise. svm-light  <cit>  was used for training with a radial basis function kernel, in combination with a grid search of trade-off and gamma parameters, optimising performance using the matthews correlation coefficient . stringent cross validation was performed using a jack knife test with the target sequence, along with any other sequences with greater than 25% sequence identity, excluded from training files.

in predicting pore stoichiometry, four features were used to train a support vector regression  model: sequence length, the number of pore-lining residues, topology and the number of pore-lining helices, with the target value set to the number of subunits contacting the pore within the membrane region. expressing the fraction of pore-lining residues and pore-lining helices explicitly did not improve performance. since only a small number of features and training examples were used and therefore training was fast, feature values were not standardised. as with svm classification, a radial basis function kernel was used with cross-validation carried out using the same protocol. predicted values were rounded to the nearest integer and the total absolute error across the whole data set was minimised in order to optimise parameters.

RESULTS
pore-walker analysis
analysis of the data set revealed the largest represented tcdb classes were  <dig> a ,  <dig> a  and  <dig> a . members of class  <dig> a typically had the largest maximum pore diameter although there were exceptions . in other classes, full pore opening would require some degree of conformational change but in all cases pore-walker identified the largest internal cavity from which a narrow path to the opposite side of the membrane could be detected.

the  <dig> protein chains consisted of  <dig> transmembrane helices, containing a total of  <dig> residues. of these residues, pore-walker identified  <dig> within the membrane region as pore-lining, corresponding to  <dig> transmembrane helices with approximately 40% of residues in a typical helix orientated towards the pore. a significant number of helices contained very few pore-lining residues, therefore in assessing prediction of pore-lining helices, we only included helices containing six or more pore-lining residues, corresponding to approximately a quarter of a typical helix, resulting in a set of  <dig> pore-lining and  <dig> non-pore-lining helices. as can be expected for residues with side chains orientated towards a solvent environment, pore-lining helices showed a slight enrichment with polar residues, comprising  <dig> % of pore-lining helices, compared to  <dig> % of non-pore-lining helices. most notable was the enrichment of negatively charged aspartic and glutamic acid residues, which constituted  <dig> % of residues in pore-lining helices but only  <dig> % in helices that did not, and histidine, which can carry a positive charge at physiological ph, accounting for  <dig> % of pore-lining residues compared to  <dig> %. pore-lining residue positioning within a helix typically displayed a degree of periodicity, with residues often separated by  <dig> or  <dig> positions, corresponding to a complete helical turn indicating that a single face of the helix was orientated towards the pore. this patterning was usually inconsistent over the full length of the helix, suggesting chains did not form a series of ideal helices packed in a tight bundle around the pore, and that helix tilting, twisting or shielding by other helices may play a role.

in order to address the imbalance between data classes, we additionally included residues adjacent to those detected by pore-walker in the positive training set; we suggest the inclusion of these residues can be accounted for by dynamics not captured within the crystal structures. this resulted in a class ratio of 3464: <dig>  which was adjusted to 1: <dig> by fine-tuning of the svm cost-factor parameter. inclusion of these adjacent residues additionally led to a slight increase in per-residue prediction performance . we also attempted including residues in the i +  <dig> and i− <dig> positions to account for those directly above and below the pore-walker identified residue in the helix, but this resulted in lower overall performance.

svm classifier performance
table  <dig> shows the cross-validated performance of the svm at predicting pore-lining residues and helices. optimal svm performance was achieved using a radial basis function gamma value of  <dig>  and a trade-off value of  <dig>  the ratio between the number of support vectors in the final model and the number of training examples was approximately 5: <dig>  somewhat higher than the equivalent value when discriminating between e.g. transmembrane helix and loop regions , reflecting both the relative difficulty of the predictive task and the small size of the training set. to assess prediction of pore-lining helices, the average raw svm score was determined for residues forming the helix, and a slightly elevated threshold  was used to optimally identify such helices. at thresholds between  <dig> and  <dig> , it appears that incorrect pore-lining residue predictions are contributing excessively to the prediction of false positive pore-lining helices, therefore this raised threshold in effect helps to negate errors in the prior svm prediction step by reducing the false positive rate from  <dig>   to  <dig>  . we defined transmembrane helix boundaries using memsat-svm  <cit>  predictions performed under full cross validation, with the target sequence, along with any other sequences with greater than 25% sequence identity, excluded from training files. we required an overlap of  <dig> residues between predicted and known helices for correct predictions. predicted helices that did not overlap with known helices where recorded as false positives if predicted as pore-lining, but were otherwise not recorded as true negatives. in order to provide users with a measure of likelihood in the range 0– <dig>  average raw svm scores were then converted to z-scores by subtracting the mean and dividing by the standard deviation of scores from the test set ). z-scores were used to calculate a posterior probability for each helix by fitting against a standard logistic function. for comparison, we also developed two naïve classifiers that regarded all polar residues as pore-lining, and helices as pore-lining if they contained  <dig> or more polar residues. these naïve methods were also assessed using transmembrane helix boundaries predicted by memsat-svm.

  z=x−μσ 

tpr: true positive rate. fpr: false positive rate. pore-lining helices were identified by averaging the raw svm scores for each participating residue, while a threshold of  <dig> or more polar residues was found to be optimal for the naïve method.

equation  <dig>  z-score calculation. x is the raw score, μ is the mean and σ is the standard deviation.

identifying pore-lining residues
results indicate that, while the prediction of pore-lining residues from sequence is generally challenging with a maximum mcc of  <dig> , our svm-based method improves significantly over naïve approaches by up to an order of magnitude. chains where prediction accuracy was highest included many ion channels, ammonium transporters and members of the major intrinsic protein  family. the homo-tetrameric calcium-gated potassium channel mthk  and na+/k+ conducting channel  fared particularly well with the majority of pore-lining residues correctly identified. false positive predictions were usually clustered close to the pore in in the na+/k conducting channel while none were predicted in mthk . of the monomeric channels, the  <dig> transmembrane helix glycerol-3-phosphate transporter was the best predicted with the majority of pore-lining residues correctly identified , while the ammonia channel and transporter predictions were also impressive. in the case of the ammonia transporter amtb , two phenylalanine side chains constrict pore access from the periplasmic side, requiring conformational change for transient pore opening  <cit> . these highly conserved residues are correctly predicted by the svm as are the majority of those that line the pore . similar gating regions can be found in transmembrane helices  <dig> and  <dig> of the molybdate transporter modb2c <dig>  which contain clusters of highly conserved residues  <cit> , many of which are also correctly predicted . in general, identifying pores within transporters was more difficult, possibly due to the narrower and more frequently obstructed translocation pathway, with the physicochemical properties of the pore-lining residues bearing less resemblance to those lining the unobstructed water-filled pores in channel proteins. in a number of the worst performing targets, low conservation in multiple sequence alignments was evident suggesting that evolutionary information was not effectively captured.

identifying pore-lining helices
by using the average raw svm score to identify pore-lining helices, performance is markedly improved compared to identification of pore-lining residues with a mcc of  <dig>  and precision/recall values of  <dig>  and  <dig> . this represents an overall accuracy of 72% although the test set does display a slight bias towards negative examples . the performance increase compared to a naïve approach requiring an optimal threshold of at least  <dig> polar residues to identify pore-lining helices  is also substantial. seven targets had all their helices correctly identified, including two 6-transmembrane helix aquaporin proteins  although in the cases of such proteins with re-entrant helices, these regions were not included in the prediction. an attempt to include re-entrant helices resulted in lower overall performance, in part due to the difficulty in accurately predicting the location of these features. cross-validated topology prediction was correct in  <dig> cases , with a total of  <dig> over-predicted and  <dig> under-predicted in the remainder of cases. these results are lower than memsat-svm benchmark results most likely due to the difficulty in predicting pore-lining helices that contain a higher fraction of polar residues than average.

in  <dig> cases , at least 75% of helices were correctly identified. these included a number of large monomeric targets with complex topologies such as the  <dig> transmembrane helix multiple-drug resistance transporter norm  and apct transporter  proteins where only two helices are misclassified in each case , while the  <dig> transmembrane helix ammonia transporters amt- <dig>  and rh <dig>  have one and two misclassified helices respectively. a range of multimeric targets including potassium, mechanosensitive and amiloride-sensitive cation channels had all helices correctly identified .

predicting pore stoichiometry
input features for the pore stoichiometry svr were based on topology predicted by memsat-svm, and predicted pore-lining residues and helices as outlined above, all under full cross-validation, with output values rounded to the nearest integer. the model correctly predicted the pore stoichiometry for  <dig> targets  with a pearson correlation coefficient of  <dig>  and average error of  <dig>  subunits. proteins forming monomeric pores in almost all cases contain three or more pore-lining helices and were generally easiest to identify, with only three false positive predictions. on this basis, proteins forming monomeric pores can be discriminated from those forming multimeric pores in 90% of cases. of the  <dig> multimeric targets,  <dig>  have their stoichiometry correctly determined including a number of tetrameric cation channels and various dimeric transporters including the multidrug abc transporter sav <dig> , molybdate transporter modb2c <dig> , maltose transport system permease protein malfg  and the heterohexameric proton translocating formate dehydrogenase  . in a number of cases where stoichiometries of three or more subunits were observed in native structures, predictions differed by only a single subunit including the homotrimeric atp-gated p2x <dig> ion channel , predicted as tetramer, and the homotetrameric potassium channel nak  which was predicted as a pentamer. under-prediction of pore-lining helices appears to have a significant effect on the prediction of pore stoichiometry, as  <dig> out of  <dig> cases are incorrect when no pore-lining helices are predicted .

a correct topology  is indicated by  <dig>  and otherwise  <dig>  over/under corresponds to the number of over-predicted or under-predicted transmembrane helices.

CONCLUSIONS
we have developed a novel method capable of automatically detecting pores in alpha-helical transmembrane proteins using sequence information alone. validation of this approach by testing on a data set of  <dig> protein chains has demonstrated that pore-lining helices can be detected with an accuracy of 72% and a precision as high as  <dig> . while these results are encouraging, the low number of chains in the training set is likely to have limited svm performance since small data sets reduce tolerance to errors and the ability of svms to develop large generalisation bounds. additionally, the use of crystal structures to determine pore-lining residues neglects the inherent dynamic nature of membrane proteins which exhibit significant conformational flexibility. transporters, in particular, undergo conformational changes within the membrane region to transport the substrate across the bilayer, and this may account for the relative difficulty in identifying pore-lining residues compared to channel proteins, where the gating mechanism usually lies at the membrane/solvent interface, while causing labelling errors when analysing the structure using pore-walker. a more suitable approach might be to extract structures at regular intervals during molecular dynamic simulations before analysis with pore-walker, and perhaps excluding transporters unless both open and closed conformations are available. svr prediction of pore stoichiometry suggests that discrimination between monomeric and multimeric pores is possible with a high degree of accuracy. however, predicting the exact stoichiometry of multimeric pores remains a challenge with only a third of cases successful. again, the relatively limited training set is likely to be a hindrance while a more diverse range of input features, perhaps including global estimates of solvent accessibility and lipid exposure, may improve performance.

despite these challenges, the successful identification of pores and channels in uncharacterised membrane protein sequences, as well as estimates of their stoichiometries, may be of substantial biochemical and pharmacological significance. a large number of channelopathies, diseases caused by disturbed function of ion channel subunits, have already been identified and tools to characterise pores in disease-related proteins may provide valuable insight into routes of therapeutic intervention. from a structural modelling perspective, both identification of pore-forming regions and complex stoichiometry may provide important insight into quaternary structure geometry and assist de novo methods in modelling such regions so that they are solvent accessible rather than lipid embedded. furthermore, site-directed mutagenesis of predicted pore-lining residues may allow modification of substrate specificity, providing valuable insight into protein design.

availability
pore-identification has been integrated into our transmembrane topology predictor memsat-svm and is available as source code from the url below and is free for non-commercial use. all data sets are also available, and cross-validation svm model files are available on request. the software has been tested on a linux operating system. in order to compile and run, the gcc compiler, perl interpreter and ncbi tools are required.

http://bioinf.cs.ucl.ac.uk/downloads/memsat-svm/.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
both authors have contributed equally to this work. source code was developed by tn. dtj provided direction for computational aspects of the algorithm and biological/biophysical insight into aspects of membrane protein structure. manuscript was prepared by tn and has been edited and approved by dtj. both authors read and approved the final manuscript.

