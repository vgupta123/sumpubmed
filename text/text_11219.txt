BACKGROUND
one important goal of computational systems biology is the development of mathematical models for complex metabolic reaction networks. the type of such models and their predictive capacity depend on the available biochemical knowledge. generally, one may distinguish two main steps in network modelling:  stoichiometric network reconstruction and  network analysis . necessary prerequisite for any type of mathematical network model is the knowledge of the network stoichiometry, i. e. reactions, membrane transport processes and associated metabolites. for eukaryotic cells, stoichiometric reconstruction of the network includes the assignment of reactions to cellular compartments. based on the stoichiometric matrix of the network one may perform structural analyses as, for example, identification of elementary flux modes  <cit> , possible routes for a self-consistent expansion of the network starting with some initial seed compounds  <cit>  or calculation of stationary flux distributions based on constraint optimization  <cit> . one central issue in such analyses is to define the possible directionality of a cellular reaction. to decide on this one has to know the  standard free energy change of the reaction and the range within which the ligand concentrations may vary. compared to structural modelling, a deeper insight into the regulation of reaction networks in response to external variations can be achieved on the basis of kinetic models. for the establishment of kinetic network models rate equations for all reactions and transport processes need to be set up. sabio-rk and the chemical kinetics database nist collect kinetic data from the literature. moreover, application of structural modelling approaches to complex eukaryotic cells requires information on the localization of the reactions in the various intracellular organelles as well as the transport of metabolites among the organelles. the biochemical information required for stoichiometric network reconstruction is spread over various data sources.

comprehensive collections for biochemical reactions are kegg  <cit> , biocyc,  <cit> , reactome  <cit>  and um-bbd  <cit> . for information on cellular compartmentalization and substrate specificity the enzyme database brenda  <cit>  is valuable. sometimes the cellular compartment of an enzyme reported in databases or publications might not be the site of its action. for example, a mitochondrial enzyme might be firmly attached to the mitochondrial wall and catalyses the biochemical reaction not inside but outside the mitochondrial matrix. therefore literature search is necessary to obtain detailed knowledge on the biochemical reactions under consideration. there are several approaches to combine information from many sources. the amaze lightbench combines a variety of information which is accessible with a web browser  <cit> . available modelling programs usually allow to edit biochemical networks with a graphical network editor. this approach is sufficient for small networks but for large networks comprising many metabolic reactions an information storage system is required. the recently developed database system meta-all allows users to enter data on biochemical reactions into a locally running oracal database with web-clients  <cit> . the resulting model can be exported in sbml format. the program epe is a visual editor for biological networks including metabolic networks and allows to add annotations.

to facilitate the exploitation of various information sources for the stoichiometric reconstruction of metabolic networks we have developed the interactive computer program metannogen . in contrast to other programs for building user defined reaction network metannogen uses the database kegg of biochemical reactions as primary information source from which biochemical reactions relevant to the considered network can be selected, edited and stored. the advantages of our approach are that  only reaction equations not stored in kegg need to be entered manually,  that the graphical pathway representation of kegg are used, which look familiar because their layout resembles figures in text books on biochemistry, that the kegg database can be updated without affecting the user data and  that the immutable identifiers are provided for compounds and reactions by kegg.

implementation
the program comes as a single executable jar-file and does not require installation. when the jar file is started for the first time the kegg data files are downloaded from the kegg-server and stored on the hard-disk. to update the kegg database the user only needs to delete these files. the next time the program is started it will download the current version. the kegg data is loaded into the main memory each time the program is started. this process has been highly optimized with respect to speed and memory usage to allow loading of the huge kegg database within about five seconds on an i <dig> pc with a cpu tact of  <dig> ghz. keeping the kegg database in the main memory of the local pc assures extremely short access times and thus avoids the typical delays of web interfaces set up on top of a remote database server.

user data and data of the kegg database are stored in separate variables, though they might be linked if they share the same reaction id. therefore the program is not confined to reactions contained in kegg. to facilitate customization of the input form and the sbml output users can modify java source code which is instantly compiled by the embedded compiler .

the technique used to change and compile code at runtime has been described recently  <cit> . no additional software tools are required. metannogen does not necessarily require a central data storage since all datasets created by the investigator are stored locally. these files could be shared with floppy-disks or other portable storage media. however, to facilitate network reconstruction in a team of investigators, a central repository may be implemented using a web-server located in the local network. for this purpose each dataset contains the id of the author who created the dataset.

limitations
• for reactions not contained in kegg the user  needs to type the reaction  equation..

• the metacyc database is not used as a primary data source.

• currently, metannogen is not yet able to perform consistency checks on the network such as identification of unbalanced metabolites.

• known bugs: the graphical tree occasionally collapses. it can be rescued with the -button.

RESULTS
the most comprehensive database of metabolic reactions is kegg  <cit>  which is the reason why kegg was used as a skeleton. as a consequence reactions from other sources as for example metacyc  <cit>  have to be entered manually. the kegg data is represented as an expandable tree because this is an efficient form to display the complex relationships between pathways, reactions, enzymes and compounds. reactions are child nodes of enzymes and vice versa because, eventually, one reaction may be catalyzed by several enzymes and, conversely, one enzyme may catalyze different reactions.

reactions taken over from the kegg database into the user-defined network carry the kegg reaction identifier so that any alterations of reactions in the kegg database can be easily detected and possibly transferred to the corresponding reactions in the user-defined data. for reactions not stored in kegg the user defines an alphanumeric identifier. transport processes are not contained in the kegg database. they have to be entered manually using the same notation as for chemical reactions with the difference that substrates and products have different compartment attributes. the user can type compounds into the text-field of the biochemical equation using common names like "l-citrulline", "citrulline" or "citrullin" and can insert compounds found on a comprehensive list of compounds. compound names may be converted into the respective kegg id as for example "c00327" for l-citrulline if the compound is contained in kegg. all transport processes and those reactions that do not have a corresponding entry in kegg are bundled under the tree branch "orphan" reactions or "transporters", respectively. metannogen allows to specify more than one sub-cellular compartment for one single biochemical reaction which results in the generation of one dataset for each compartment. labeling of all datasets with the user name and protection against unintended modification allows metannogen to be used by a team of investigators.

working with metannogen – a case study
in the following the usage of metannogen is explained using as an example the synthesis of carbamoylphosphate. the figure  <dig> shows the expandable tree with the tree node for carbamoylphosphate synthesis i  and the datasets for cps i and cps ii as well as the citrulline transporter. the synthesis of carbamoylphosphate is the first step in the pyrimidine biosynthesis, the arginine biosynthesis, and the urea cycle. formation of mitochondrial carbamoylphosphate used in the urea cycle is catalyzed by the enzyme carbamoylphosphate synthetase i . the notation of the reaction in kegg reads

2atp + nh <dig> + co <dig> + h2o ⇄ 2adp + orthophosphate + carbamoylphosphate     

to add this reaction to the model the respective tree node with the reaction identifier r <dig> and the ec number  <dig> . <dig>  needs to be marked in metannogen. selecting "new dataset" from the dataset menu creates a new dataset for the carbamoylphosphate synthetase reaction in the user-defined database . the input mask for the dataset appears in the right side of the screen. a toggle button with the traffic light symbols allows to exclude data sets from the stoichiometric matrix without deleting the dataset. this is a useful option if a reaction and its catalyzing enzymes are not reported to exist in the species considered by the user  whereas for a related species  such evidences are available.

checking the consistency of the stoichiometric matrices generated with active or inactive toggle button of such "likely" reactions may provide valuable heuristics for further experimental work. for the model of the liver metabolism the reaction of carbamoylphosphate synthetase is activated since the reaction takes place in human liver without doubt. the first two reactions of urea cycle, the formation of carbamoylphosphate and the ligation with ornithine, take place in the mitochondrial matrix. this knowledge is usually obtained from databases such as brenda  <cit> , um-bbd  <cit> , sabio-rk or from scientific articles. for convenience, some databases are linked and the respective pages are opened in the web browser when the links are clicked.

this set of databases is customizable. for the considered reaction of the mitochondrial carbamoylphosphate synthetase the compartment "mitomx"  is selected by the user in the selection box for sub-cellular compartments. the newly created dataset can hold any kind of additional information on the reaction and the catalyzing enzyme. to keep track of the source of knowledge, notes and remarks taken from literature can be entered as free text. pubmed abstracts can be referred to simply by their id. the abstracts are automatically downloaded and shown with important keywords highlighted. if, for example, the reference pmid: <dig> for an article on carbamoylphosphate synthetase is contained in the text-field and the mouse is moved over it, the abstract is automatically shown and important search terms like "human" or "liver" are highlighted. in general a link to a database is formed by a database id followed by colon, in this case pmid:, and an entry id, in this case  <dig>  an alternative syntax with curly brackets allows references to terms containing characters other than digits and letters as for example brendaec{ <dig> . <dig> } or google{carbamoylphosphate mitochondrial} . the urls of databases can be edited in the customize menu. in kegg most reactions are displayed graphically in . metannogen can display information within these graphical pathway views. to quickly locate the reaction of the cps i in the graphical pathway view "urea cycle"' it can be marked in the object tree and is highlighted by a red frame in the pathway view. this allows to quickly locate a reaction, such as cps i in the context of a certain pathway. choosing "any" in the compartment selector of the kegg-map of a pathway, here the urea cycle, all reactions of the user-defined network are highlighted by filled colored rectangles irrespectively of their compartments. depending on the status of the exclusion toggle mentioned before, a filled green box indicates that it is included into the model in contrast to a red box which would indicate that it is currently excluded. if a specific compartment is selected for the kegg-map a yellow box points out that this reaction does not exist in this but in another compartment. for our example this view reveals that the compounds citrulline_mitomx and citrulline_cyto cannot be balanced because both reactants occur in only one reaction . in such cases the user needs to search for a possible exchange processes of the corresponding metabolite across the membrane separating the two compartments. for citrulline, a transport across the inner mitochondrial membrane is well-described in the literature.

the corresponding notation in metannogen reads

citrulline_cyto ⇄ citrulline_mitomx     

to find out whether genes, transcripts and proteins have been identified for a particular enzymatic activity in men the ensembl and swissprot branches of the tree are helpful. they can be expanded from the reaction nodes. cps  <dig> has the swissprot entry cpsm_human and the ensembl gene entry ensg <dig>  a different carbamoylphosphate synthetase cps ii catalyses the primary step of the purine synthesis. the reaction mechanism is different from that of cps i in that the nitrogen does not originate from ammonia but from glutamine. consequently the reaction id and the enzyme code are different. because the cps ii is a cytosolic enzyme "cytosol" must be selected. the sbml output for the two reactions is shown in figure  <dig> 

customization of metannogen for specific projects
depending on the type of mathematical model that has to be developed for a metabolic network different types of information on the kinetics and thermodynamics of reactions and transport processes are needed. in principle, the text-area for notes can be used for such information. however, to store all information in a unified and structured manner advanced users may also create specific gui elements such as pull-down menus toggle buttons, text-fields and check-boxes in the java source code. for this purpose the customize menu offers the possibility to generate a copy of the gui java file which than replaces the default gui java class in the running application. the user can edit this copy. the source text contains example code for three additional gui-elements which can be activated by removing the "/*" and "*/" tags. this renders the lines enclosed in "/* ... */" active as soon as the modified source code is saved and the additional gui elements immediately appear. in this example the additional gui elements correspond to data fields named "field1", "field2" and "field3'. meaningful names can be given instead. by default additional data fields are not exported as sbml. nevertheless, the sbml output can be adapted using the mechanism mentioned above  <cit> .

again it involves direct manipulate of source code and instant testing of the modified sbml writer at runtime. this is not critical because a copy of the original file is modified by the user. elimination of this file immediately reverts the program to the original state. in the java code the text contents of a field can be requested by invocation of the instance method of dataset objects string metannogendataset#getfield.

searches with pubmed and google
one major obstacle of finding relevant information using search engines is that biochemical enzymes may be named in many different ways. metannogen meets this difficulty by combining synonymous names for the enzymes of interest by logical "or" to form a sensitive search query for google or pubmed. the searches typically result in a larger number of hits. for pubmed abstracts additional aids are available. moving the mouse-pointer over a pubmed id the abstract is downloaded into the local cache and displayed. all user defined keywords are highlighted in the abstract to quickly assess the relevance of the publication. for large numbers of publications this approach is much more efficient than opening the abstracts in the web browser. search queries can be entered as a hyper-references into the remark-field using the syntax pubmed{carbamoylphosphate  and liver and human}.

CONCLUSIONS
metannogen stream-lines the design of large metabolic networks. the metabolic network can be exported as sbml for further analysis.

availability and requirements
metannogen is free of charge and can loaded . the software is distributed under the gnu gpl license. it loads database files from the kegg-server. therefore users should also check the license of the kegg-database. the program requires java runtime environment  <dig>  or higher by sun or ibm and about  <dig> mb of free ram and about  <dig> mb of free hd space. it is tested on ms-windows and linux and should also run on any other platform. it does not need any advanced infrastructure like database server or web server to operate.

authors' contributions
• cg has developed the program

• sh has made substantial contributions to conception and design, and program testing.

• hh has supervised the project and improved the design and tested the program.

