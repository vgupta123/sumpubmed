BACKGROUND
the diversity of traits directly connected to an organism’s life cycle– life-history traits– is endless, and so are the adaptive strategies that organisms can use to increase their fitness. because adaptation depends on the genetic variation available for selection, the genetics of life-history traits has long been a major concern of evolutionary biology, and subject to serious controversy and debate. advances in theoretical  <cit>  and empirical quantitative genetics  have changed our view of life-history traits, enabling more realistic conclusions about the components of phenotypic variation and the forces maintaining this variation. the low heritability of complex quantitative traits is not necessarily the consequence of depleted additive genetic variation, as it had been thought previously , but often the result of extensive non-additive and environmental variance . while many studies have contributed to our understanding of fitness and its phenotypic trade-offs, gaps in our knowledge about the complex network of fitness characters remain.

one life-history trait that has received much attention is development time  in holometabolous, ectotherm organisms, such as drosophila and other insects . dt is one of the best-studied and documented life-history traits, particularly regarding the effects of environmental cues, such as temperature  and crowding . genetic studies showed that mutations in certain genes can also influence dt  <cit> . much of the interest in this trait is because it is believed to be closely related to fitness, as has been shown for drosophila  <cit> , particularly when larval competition is high  <cit> . furthermore, because drosophila is a genetic model system, it provides an especially good opportunity for understanding the genetic basis of developmental rate, with developmental control genes and their downstream counterparts being well-documented  <cit> , as are those affecting developmental rate when disrupted  <cit> . mutations resulting in hormone signaling defects in drosophila , for example, can affect the larval-pupal transition, delaying or disrupting normal development. moreover, drosophila is also a useful model for understanding natural variation in developmental rate, with selection experiments revealing considerable genetic variation for dt in drosophila .

here, we are interested in the initial developmental stage of insects, taking place from the fertilization of an egg until hatching of the larva, or the duration of embryogenesis . doe has often been treated as a fixed, species-specific developmental event, and variation in the rate of embryonic development has been considered as a passive, unavoidable consequence of abiotic factors such as temperature. in spite of that, there is a great variety of hatching patterns, and embryos as a responsive, evolving stage in the life-cycle have gained attention recently  <cit> . there is significant between-  <cit>  and within-species variation in this trait  <cit> . importantly, doe varies greatly among insects, ranging from months   <cit>  to weeks   <cit> , days  or hours .

as for dt generally, drosophila is a particularly good model for understanding genetic variation in doe, as embryogenesis itself has been the subject of intense study  <cit> . but, while egg-to-adult and larval development have both been well-characterized , variation in doe has been relatively neglected, in part because it is not an easy trait to measure. previous studies quantified doe using a technique in which eggshells of the hatching larvae were counted manually  <cit> . as this method is very labor-intensive and prone to observational errors, it also limits work to only one or two strains/populations at a time, and experimenters have only one chance to record hatching. given these limitations, a more reliable and repeatable method adaptable to high-throughput is clearly needed to investigate this trait, and has been developed in the present study. that is, to determine whether there is within-species genetic variation for doe in drosophila, and to precisely quantify it, we established a new microscope-based phenotypic assay and measured the trait in  <dig> dgrp strains. we found extensive genetic variation for doe among the strains, and showed that the majority of the identified polymorphisms retard the time to hatching.

methods
establishing the ecological importance of embryonic development time
to establish the importance of doe for larval competition, we experimentally manipulated differences between strains in doe by modifying the age of the eggs in one strain  while keeping the age fixed in the other . we chose this dgrp line because previous experiments showed that it is similar to the reference strain with respect to egg-to-adult viability  and dt . we tested the competitive advantage of a head-start in doe under both high density  and low density . we gave the dgrp strain different levels of advantage in doe by collecting eggs from this strain earlier than those of the control strain. we tested three levels of advantage:  no advantage ,   <dig> h of advantage  and   <dig> h of advantage . we assessed the fitness of the two competing strains by measuring eav and dt under these conditions, as both traits are closely related to overall fitness  <cit> . an increase in eav and/or decrease in dt in the strain with the advantage given, or the opposite effects for the reference strain, would confirm that doe contributes to overall fitness in d. melanogaster.

d. melanogaster fly strains for doe measurements
the phenotypic response of  <dig> dgrp strains   <cit>  was measured, including all  <dig> strains of the initially sequenced and phenotyped core-set. these inbred drosophila strains allowed us to phenotype a large number of individuals with the same genetic background, making it possible to measure a precise and robust trait mean for each strain. all flies were reared on standard molasses/soy-corn flour/agar media containing vials under low density conditions, in a single 25 °c incubator at 70–80 % relative humidity with a 12/12 h light/dark cycle.

experimental populations and egg collection
to measure doe, we first age-synchronized the parental population. to do this, we set up large egg-laying population cages at 25 °c , and collected eggs on 100 mm petri dishes filled with blackcurrant juice and agar media, sprinkled with fresh yeast. eggs were collected over a  <dig> to 24 h period, and set up in bottles on standard drosophila media at low density . for measuring doe,  <dig> to 2 day-old flies were transferred to population cages and were acclimatized at 25 °c for 2 days prior to the experiments. on days when measurements were taken, synchronized embryos were collected for an hour  on blackcurrant juice plates. two 1-h long pre-lays preceded this egg collection in order to encourage females to lay eggs they may have incubated for varying time periods  <cit> . eggs were carefully washed off the plates into egg collection chambers, and transferred with a fine brush onto a 24-well cell-culture plate  for imaging. each well of the plate can accommodate ~ <dig> embryos, however, numbers varied depending on the number of embryos collected. each round of phenotyping was conducted with randomly chosen blocks of strains, with 2– <dig> of them assayed simultaneously on each array. we also phenotyped a reference strain  in parallel with the dgrp strains. the w <dig> strain acted as a control to account for experimental noise.

imaging plate and imaging
the transfer and subsequent imaging with a stereoscope camera provides far more accurate and repeatable measures than those obtained manually. it reduces experimental and observational error, as well as increases the throughput of the experiment, since in this way more individuals can be measured simultaneously. five randomly distributed wells were used for each dgrp strain, and four for the reference strain. we imaged embryos on a 24-well cell culture plate in which all wells were previously filled with 1 ml  <dig>  % blackcurrant agar. using a precisely measured amount of agar in each well facilitates subsequent imaging, because one focus setting can be used throughout the experiment, and the blackcurrant juice provides a contrasting background for the images of eggs.

sequences of images were taken at sixteen predefined time points throughout the day, between 10 am and 8 pm . imaging started at 10 am, equivalent to  <dig>  h of dt . a strong distinction exists between non-retained and retained embryos, with hatching times following a bimodal distribution  <cit> . embryos that hatched before 10 am are presumably from eggs that began embryonic development while still retained in the female, and therefore were discarded from the analysis  <cit> . excluding these embryos from the analysis allowed us to avoid confounding effects due to heterogeneous egg retention behavior of the strains.

scoring was done with image analysis software  by counting empty egg shells of the hatched larvae on consecutive images . first, a time-lapse image stack was created from the individual pictures of each batch of eggs, then this image stack was aligned using the eggs themselves as landmarks. for counting the hatched eggs, we used the “cell-counter” plugin .

we partitioned hatched embryos into  <dig> developmental categories . after excluding early-hatching embryos  from the analysis, and combining late-hatching ones  with the last measured time point , we had measurements of doe for every strain and every replicate separately. we calculated weighted mean doe by multiplying the number of eggs hatched at a given time point with the corresponding doe. we calculated relative doe by subtracting the mean reference value from the strain means. negative values represent faster doe compared to the reference strain, while positive values mean slower development.

quantitative genetic analysis
all statistical analyses were conducted using r version  <dig> . <dig> . to analyze variation in doe among dgrp strains, we performed anova on the untransformed data, since the normality test did not indicate non-normal residual distribution . specifically, we fit the following linear model: y
ij = μ + li + εij, where y
ij is the relative mean doe measure for the j
th replicate of the i
th line, li is the effect of line i , εij is the error term for the i
th line and the j
th replicate and j is the replicate . the σl
 <dig> provides an estimate of genetic variance , and the error  provides an estimate of the environmental variance . phenotypic variance  is calculated according to the formula σp
2 = σg
2+ σe
 <dig>  and broad-sense heritability  was estimated as h
2 = σg
2/ σp
 <dig>  the phenotypic and genetic coefficients of variation were calculated using raw data, as cvp = 100*√  and cvg = 100*√ , where x and σp
 <dig> are the mean and variance of raw doe estimates across all strains. to perform post-hoc analysis of the data, we used the tukey-kramer test implemented in the hsd.test test in r .

to assess the ecological importance of doe, we first fitted the maximal, four-way anova model on the box-cox transformed dt. the box-cox transformation was used to satisfy the normality and homogeneity of variance assumptions for the residuals of the fitted model, and lambda was calculated with the powertransform function . the initial, full model included four main effects , all of their interaction terms, and an error term . after sequentially dropping non-significant terms, including several interaction terms and one main effect , we obtained the simplified model below, which was used for subsequent analysis: y
ijkl = μ + li + dj + tk + lidj + djtk + εijkl, where y
ijkl is the transformed dt . as an independent confirmation for our model reduction, we used the step function in r, which uses aic as the model selection criteria, and which produced the same reduced model as above. we also analyzed the data separately by density and advantage given to the dgrp strain .

to analyze the eav data, we performed the same steps as for dt, but using the arcsine square-root transformed eav ratios. in this case, however, sex was not included in the full model. the minimal adequate model obtained for eav was y
ijk = μ + li + dj + lidj + εijk . the linear models for dt and eav fit the transformed data well, as indicated by the non-significant shapiro-test results performed on the model residuals .

we used correlations to gain insight into the underlying basis for the genetic variation.

if the variation is maintained due to antagonistic pleiotropy—with genes affecting one trait favorably and another trait negatively—we expect negative correlations between fitness components. if it is the result of deleterious mutations exposed by inbreeding, we instead expect positive genetic correlations between fitness components  <cit> . to examine such scenarios, we used a spearman rank test for quantifying correlations between doe and other dgrp phenotypes.

genome wide association study
we tested for associations between snps and the relative doe measures . single trait measures were uploaded in february  <dig> to the dgrp webtool   <cit> , which performed the analysis between the trait measures and the corresponding dgrp strain sequence variants. briefly, we tested snps and indel markers for an effect on the wolbachia—and major inversion polymorphism–adjusted single trait measures, restricting the analysis to markers with a minor allele count ≥  <dig> and a per-strain coverage between  <dig> and  <dig>  for every marker, we fit the model y
ij 
= μ + m
i 
+ ε
ij, where m was the effect of the polymorphic marker . multiple regression and partial least squares were used to correct for biased allelic effect estimates.

we performed calculations to assess the power of detecting large effect alleles at the level of p < 10− <dig> influencing doe, following the procedure of ivanov et al.  <cit> . for this, we used the pwr.t2n.test function in r , which needs minor  and major allele counts  as well as a cohen’s effect size estimate . d is calculated by dividing the mean phenotypic difference between the two genotypes  by the standard deviation, σp, which is the square root of the sample variance, calculated by √[σ2
1 + σ2
 <dig> /]  <cit> .

we also performed go analysis with gowinda  <cit>  to test for any enrichment in functional gene groups with snps affecting doe. with a relaxed p-value of 10− <dig> we included  <dig> variants as candidates in the analysis, for which we used the program’s gene mode, included snps 2000 bp up/downstream of a gene, used minimum gene number of  <dig> and  <dig> , <dig> simulations. to compare rates of molecular evolution of candidate doe genes relative to others in the drosophila genome, we used estimates of d
n, d
s, and d
n/d
s  along the lineage leading to d. melanogaster from flybase .

RESULTS
ecological importance of embryonic development time
to assess the fitness consequences of shortened/prolonged embryogenesis, we manipulated the doe for one of the strains, and measured dt and eav for two competing genotypes under two larval densities . prior to data analysis, we corrected for the given advantages to the dgrp line in doe , and subtracted the corresponding values from the overall dt of the experimentally delayed reference strain. the experiments revealed significant effects of density and genotype, as well as significant interactions between density and genotype and density and embryo age . we found no significant effect of sex on either of the measured traits. the strain effect for dt was much smaller than that for eav, measured as the fraction of phenotypic variance explained by dgrp line. this appears to be mainly due to the strong effect of density on variation in dt; when restricting the analysis to single density treatments, the strain effects were more similar between the two traits . to have a simple estimate of the fitness effect of embryo age, we calculated relative dt and eav values by taking the difference between the two competing strains . higher relative dt values imply faster dt in the dgrp strain, while a smaller difference between the eav of the two strains indicates increased viability for the dgrp strain . under benign, low-density conditions, dt was marginally faster in the reference strain, regardless of the advantage given to the dgrp strain , but the embryo age did not appear to have a significant effect. however, under competitive, high-density conditions, anova revealed significant main effects of both modified embryo age  and genotype . the difference between the two strains increased gradually from “0 h” to “7 h”, in keeping with the idea that doe per se has an impact on fitness, measured as dt . that is, increasing the advantage to the dgrp strain from “0 h” to “4 h” increased the dt difference from  <dig>  ±  <dig>  h  to  <dig>  ±  <dig>  h  . with  <dig> h of desynchronization, this gap became even more pronounced, the relative dt difference between the two strains increased to  <dig>  ±  <dig>  h .table  <dig> measurement means  of development times  and viabilities  for two competing genotypes

n
555
n
w

low

high


source
p
 <dig> e-48***
 <dig> **
 <dig> e-08***
 <dig> **
 <dig> e-08***
 <dig> e-04***

abbreviations: df. degree of freedom, σ
 <dig> variance component

**p <  <dig> ; ***p <  <dig> 


fig.  <dig> relative dt a and viability b values for two competing genotypes measured at low  and high  densities. the two competing genotypes are w = reference strain, w <dig> and 555 = dgrp line ral <dig>  we tested the competitive advantage of a head start in embryonic dt by giving varying levels of advantages to the dgrp strain. fitness effects of three levels of advantage were tested: no advantage ,  <dig> h advantage , and  <dig> h advantage . six replicates were combined for the “0 h” data, while 3– <dig> replicates gave the “4 h” and “7 h” measurements




development time and viability of the two competing strains . adv is the advantage given to the dgrp strain , n
 <dig> and n
w represents the number of individual flies measured for each genotype. development time is calculated as the time elapsed from the day of egg collection until the emergence of the adult flies , and viability was the ratio of emerged adult flies to the initial egg numbers .

on the other hand, we found no evidence for a significant embryo age effect for eav at either low or high density , and consequently no considerable increase/decrease in viability in the competing genotypes due to the given advantage/delay . despite the fact that viability of the dgrp strain showed an increase with the increasing levels of advantage at both low and high densities , the relative viability measures showed no trend due to greater, undirected changes in viabilities of the reference strain .

genetic variation for the duration of embryogenesis in the dgrp
to characterize natural genetic variation in doe, we measured time to hatching relative to a reference  for  <dig> dgrp strains. in all, we were able to measure doe for  <dig>  individual embryos, with  <dig>  belonging to the dgrp strains and  <dig>  for the reference strain. a mean ± s.d. of 1103 ±  <dig> embryos was measured per dgrp strain, ranging from  <dig>  to  <dig> . mean doe across all strains was  <dig>  ±  <dig>  h . the vast majority of the strains showed similarity in their doe, with  <dig> of  <dig> dgrp strains hatching within  <dig> h . however, we found one strain  that was considerably faster than the reference, showing a difference of  <dig>  h, and three that were up to  <dig>  h slower .fig.  <dig> relative embryonic development time in  <dig> dgrp strains. the boxplot contains relative phenotype measures in three replicates for each strain , compared to a reference, white-eye fly strain . dashed line represents the global average across all phenotyped strains


n
embryonic development time for  <dig> dgrp strains. n indicates sample size . embryonic dt is the obtained raw duration of embryogenesis measure, while rel. med. doe is the relative measure . egg viability was calculated as the ratio of hatched eggs and the total number of eggs transferred to the imaging plate. non-viable eggs contain both unfertilized eggs and embryos that failed in their embryonic development. values resulted in from three independent replicates, and in one case only two replicates 




we found significant differences between strains in their doe , with a high broad-sense heritability, h <dig>  of  <dig> . the genetic coefficient of variance  was  <dig>  while the phenotypic coefficient of variance  was  <dig> . the between-strain variation that underlies variation in doe appears to be potentially complex; there were  <dig> different trait means among the  <dig> lines according to a post-hoc tukey-kramer test.

gwas
using the publicly available webtool   <cit> , we conducted a gwas analysis on  <dig> , <dig> genetic variants found among the  <dig> strains, for which the minor allele was represented in four or more strains, using single-locus analyses. at p < 10− <dig>  we found  <dig> variants  associated with the rate of embryogenesis . the small number of strains makes our study underpowered to draw many conclusions about the genetic architecture of this trait. however, our precise and robust phenotype measures based on hundreds of individual embryos per strain can identify genes and regions putatively affecting doe and provide a basis for subsequent follow-up studies  <cit> .fig.  <dig> gwas p-value distribution. –log <dig> plotted along each chromosomal position for all snps. colors and letters indicate chromosome arms. genes with multiple hits  as well as the highly significant peak on the chromosome arm 3 l are marked




to assess whether there is enough power to detect alleles with a large phenotypic effect on doe, we performed power calculations, similar to ivanov et al.  <cit> . we used mean phenotype values and variances of the two genotypes from our highest ranked snp , p =  <dig>  × 10−7; additional file 5: figure s <dig>  first panel; μ1 =  <dig> , σ2
1 =  <dig> , μ2 = − <dig> , σ2
2 =  <dig> ). despite using only  <dig> strains, we showed that we had some power to detect variants with large effects, depending on the frequency of the minor allele  –which ranged from  <dig> to 43 % for the  <dig> candidate snps uncovered in this analysis. for example, using a p-value cut-off of 10− <dig>  we had 31 % power to detect a variant with an effect size equal to 1 h of difference in doe and a maf of 10 %. for alleles with higher mafs, we had more power: we had 86 % power to detect variants of this effect size with a maf of 20 %, up to 98 % power with a maf of 40 % .

snps significantly associated with variation in doe are presented in additional file 7: table s <dig>  half of the significant snps  occurred in close proximity to each other, and are likely non-independent , resulting in a total of  <dig> candidate genes . among these,  <dig> have no known function, though the biological functions of  <dig> genes have been described previously. most of the annotated polymorphisms  are intronic; if causal, the effect of these intronic snps may be due to their effects on gene expression, as introns can harbor regulatory elements  <cit> .

we also examined the data for a relationship between doe and the presence of the intracellular bacteria wolbachia and common large chromosomal inversions, both of which occur in these lines. we found no effect of wolbachia infection status on the rate of embryonic dt . the dgrp lines have been typed for several chromosomal inversions  <cit> : among the  <dig> inversions that have been identified in the dgrp  <cit> ,  <dig> are monomorphic in our sample of  <dig> lines. the remaining  <dig> inversions  show some extent of polymorphism, and two of the  <dig> were associated with doe . we evaluated if these inversions correspond to the genomic location of any candidate genes. two genes, mur89f  and sema-2b  occur within the significant inversions, and in both cases the identified variant is prevalent in the sample . however, for both inversions, very few of the lines carry the inverted karyotypes– only  <dig> strains harbor in.2r.ns in either homozygous or heterozygous form, and only one line carries in.3r.k. thus, the significant association between doe and inversion karyotype should be treated with caution.

the majority of the identified candidate genes,  <dig> of  <dig> are embryonic genes, having the highest expression in early, intermediate or late embryos among all the developmental stages . most snps affected doe negatively . however, in two cases , the derived allele was associated with a significant decrease in doe in the lines carrying the allele . while mur89f is only expressed in late-stage embryos  and in later developmental stages , both cg <dig> and cg <dig> are embryonic genes, with cg <dig> having the highest life-time expression in 4– <dig> h old embryos . go analysis  does not reveal any significantly enriched categories after correcting for multiple testing. however, three-quarters of the  <dig> mutations occurred in genes that were related to development, regulation and morphogenesis . we also studied the molecular evolution of our candidate doe genes identified by means of the ratio of non-synonymous  to synonymous  substitutions rates , and compared it to other genes in the drosophila genome. consistent with purifying selection acting on these genes, embryonic genes had ω < <  <dig>  similar to that of other protein-coding sequences in the genome .

among the candidate genes with defined biological functions, there was an association with a non-synonymous mutation in the cana gene . this embryonic gene might play a crucial role in the timing of development as it is involved in biological processes such as metaphase/anaphase transition of mitotic cell cycle and microtubule-based movements. a non-synonymous snp was found in the ranbp <dig> gene , a gene involved in nuclear protein transport activity. six of  <dig> strains carried four intronic snps in the wnt <dig> gene, which affects processes such as neuron differentiation and cell fate commitment. an intronic snp was found in the hid gene in  <dig> of  <dig> strains. this gene is a well-described apoptosis activator  gene. moreover, this gene is also associated with head involution, the mechanism of the rearrangement of head segments at the anterior tip of the fly embryo  <cit> .

of the significant gwas hits, eight of  <dig> fall into the same,  <dig>  kb long region of the 3 l chromosome arm, including the five snps with the lowest p-values . this region lacks annotation, and no known genes are in the immediate proximity of these snps . the eight snps form a distinct haplotype . to investigate the possible impact of these snps on gene expression, we used promo  <cit>  to map putative transcription factor binding sites  in our region. we compared two haplotypes: sequence of the dgrp lines with the major alleles  and the sequence of the  <dig> lines carrying the  <dig> minor alleles. the minor haplotype shows loss of two doublesex binding sites, and the gain of several diverse tfbss: deformed , tailless , paired , ftz  and dorsal , proteins with crucial functions in normal development . further, of the two closest flanking genes, one  has its peak expression in early, 0– <dig> h embryos. . though not conclusive, these results suggest a possible mechanism for the effect of these snps on doe, via regulatory changes affecting cpt <dig> expression.

correlations with other traits
to determine the relation between doe and other known characteristics of these strains, we correlated doe  with other traits measured in the dgrp. we found a significant negative relationship between egg viability  and doe , implying that slow embryonic development is coupled with low egg viability. startle response  <cit>  is also negatively correlated with doe . we found no correlation between doe and dt  <cit> , but we found that strains with the longest doe are also the ones with the longest dt at both high and low densities . however, short doe did not result in shorter overall dt. similarly, we tested for a relationship between eav and egg viability measured for the same subset of lines  <cit> . we found a strong positive correlation between the eav and egg viability at both low , medium  and high density . these results suggest that egg viability may be the determining factor in overall pre-adult viability in these lines.fig.  <dig> correlations between relative embryonic dt and other measured traits in the dgrp. a negative relationship between egg viability and relative embryonic dt, correlation: r
2 =  <dig> , p =  <dig> ; b negative correlation between embryonic dt and startle response . strong positive correlation between egg viability and egg-to-adult viability, measured under c low, d medium and e high larval densities. correlations  are shown




it has been shown previously that fly species with longer dts tend to have larger genomes  <cit> . as te content is a major determinant of genome size, we hypothesized that overall te content might be an important factor altering doe. however, doe did not correlate with either total te content, or the number of novel or unique insertions  <cit>  in these lines. we tested if there is a direct relationship between genome size  <cit>  and doe, but we did not find one , even though the subset of  <dig> lines was equally variable in genome size as the entire set of  <dig> strains , providing us with some power to detect a possible correlation.

egg retention– the ability of female flies to withhold fertilized eggs in their reproductive tracts –can have a major impact on doe. therefore, we also developed a way to measure this in the dgrp , and tested whether the traits are correlated. we found no relationship between egg retention and doe, when excluding early hatching embryos  from the analysis . however, the relation between doe and egg retention is significant when including early hatching embryos . the lack of correlation between doe and egg retention confirms that we chose an appropriate cut-off for excluding retained embryos, therefore our doe measures are not confounded by the retention phenotype differences between strains.

discussion
we developed a novel assay to measure the duration of embryogenesis  and found significant genetic variation for this trait in the dgrp. compared with the previously used, time- and labor-intensive method  <cit> , our assay makes it possible to quantify doe for large numbers of embryos and strains. while previous measurements were based on a small number of observations , we were able to obtain robust phenotype measures with our method . another advantage of imaging over the manual counting is that images are taken in rapid succession, minimizing noise and error in the measurements. moreover, since the images can be stored for a long time, data can be subtracted and analyzed at a later time point, which is not possible with the manual counting.

we used our newly developed assay to study genetic variation in the dgrp for doe, and to find possible candidate genes and proteins contributing to variation in the rate of embryogenesis. the dgrp resource  <cit>  is valuable for studying how variation in the genome maps to phenotypic differences. the vast amount of phenotypic information available for this panel of strains, combined with genetic and transcriptomic data, makes this a powerful resource. here, we found extensive variation in doe in a subset of dgrp strains, translating to a 15 % difference in developmental rate between the slowest and fastest strains, comparable to the reduction of egg-to-adult dt in multigenerational selection experiments . moreover, the variation was largely genetic in this experiment, with strain accounting for 89 % of the total phenotypic variance. this strong strain effect on dt has also been observed in lines containing p-element induced mutations . such a strong strain effect is not unexpected for broad-sense heritabilites, measured on inbred lines under strictly controlled conditions.

because complete genome sequences are available for all dgrp strains, we were able to conduct genome-wide association mapping to identify potential candidate genes that may influence the rate of drosophila embryogenesis. developmental timing is based on molecular mechanisms and molecules such as cell cycle components, cell-signaling factors and hormones  <cit> . accordingly, we can find genes with previously described biological functions among our candidates that play a part in cell-cycle , receptor activity , cell signaling  and transcription . naturally, genes with known functions in development and morphogenesis would be strong candidates for controlling doe. seven of the  <dig> genes with known functions , dlp and lar) are involved in developmental processes, indicating that besides their previously described roles they may be important in modulating doe. moreover, the available developmental transcriptome data  <cit>  suggest that the majority of the genes,  <dig> of the  <dig> have their highest expression in embryos among all the developmental stages.

we found that the majority of significant sequence variants caused retardation in doe. however, two alleles caused decrease in doe . mur89f is a mucin-related protein, known to be expressed in salivary glands of drosophila embryos  <cit> . as many mucins are expressed in various tissues throughout embryogenesis, their potential role in organ development has been proposed  <cit> . while the function of the cg <dig> gene is yet to be described, its predominant embryonic expression suggests its role lying in early developmental processes. mur89f is also one of the two candidate genes that can be found within segregating inversions. many fitness traits show associations with inversion genotypes  <cit> , and in concordance with this, we found association between doe and two inversion polymorphisms. inversions span large regions of the genome, and can have a much higher amount of substitutions then the genome average, therefore taking into account inversions is necessary when assessing the genetic basis of traits.

genes that are involved in highly conserved functions, such as developmental patterning and morphogenesis, are expected to be highly constrained  <cit> . instead, altering the expression of crucial developmental genes through chromatin modifications or changes in transcription factor binding activity is a safer, yet effective way to control phenotypes. consistent with this idea, most candidate snps, with only two exceptions, are found in non-coding gene regions  and are potentially affecting embryogenesis via gene expression. half of the snps in our sample can be found in intronic gene regions, and thus, any effect they have are likely to be mediated by gene expression  <cit> . neyfakh and hartl  <cit>  proposed, that the plastic relationship between developmental rate and temperature suggests that variation affecting embryonic development time must be common in natural populations. in agreement with this, the average minor allele frequency in our sample was 23 % .

our results are consistent with a general trend in the literature suggesting that rapid development, at least in drosophila, is associated with high fitness. zwaan et al.  <cit>  found that in selection experiments, slow-developing flies showed reduced viability compared to the control and fast-developing strains. similarly, we found a negative correlation between egg viability and relative doe, which suggests that the relationship between high viability and rapid development also holds for embryos. further, we mimicked the advantages of rapid embryonic development and showed that this resulted in faster overall development time when larval competition was high. the advantage experienced by a strain established early in a culture can be thought of as a kind of intraspecific priority effect  <cit> . priority effects describe the effect of a community initiating species on the later arriving ones, and are well known and studied in ecology literature , in particular for plant  and aquatic communities  <cit> . while most studies focus on interspecific interactions, the importance of intraspecific effects has been described as well  <cit> . the observed delayed/de-synchronized development is indicative of a strong competitive interaction, and can be seen as a form of intraspecific inhibitive priority effect  <cit> . more importantly, we also found that this effect is context- and trait-dependent: the head-start caused no difference in dt of the competing lines under benign conditions , but had pronounced effects when competition was high . on the other hand, we observed a small but gradual increase in viability of the line with the head-start, regardless of the experimental conditions. such context-dependency has also been shown for daphnia species  <cit>  and planktonic protists  <cit> , and can have important implications for species relying on rapid growth, such as drosophila. priority effects increase the competitive strength of organisms and can facilitate the establishment and adaptation of otherwise less fit genotypes  <cit> . finally, the strong positive correlation between egg viability and egg-to-adult viability in the studied lines suggests that embryonic viability is an important determinant of overall viability. our results show that embryogenesis is important for fitness, and altered doe can have consequences for other life-history traits.

CONCLUSIONS
in this work, we studied genetic variation in a trait that we argue is ecologically relevant. for this, we developed a new, microscope- and computer-based method for quantifying genetic variation for the duration of embryogenesis  in drosophila melanogaster, using the dgrp mapping panel. by characterizing doe for more than  <dig>  embryos, we found extensive variation for this trait in a subset of  <dig> lines. the obtained 3-h difference between the slowest and fastest strain translates to a 15 % difference in developmental rate within a single drosophila species, comparable to the reduction of egg-to-adult development time in previous multigenerational selection experiments. we also show that doe itself is ecologically important, and altered doe can cause changes in other fitness components. with our gwas analysis, we identified genes that may influence doe, with the majority of these being embryonic genes and playing part in cell-cycle, receptor activity and cell signaling. we also suggest the role of being involved in developmental processes for genes with unknown biological functions. further functional assays, or transcriptomic analysis of embryos from the dgrp can validate the role of our candidates in early developmental processes.

additional files

additional file 1: table s <dig>  assay of measuring the duration of embryogenesis—imaging time points and corresponding embryonic development times 


additional file 2: figure s <dig>  time-lapse images of a sub-replicate measuring the embryonic development time of a dgrp strain  


additional file 3: table s2: results of anova on dt and eav 


additional file 4: figure s <dig>  representation of the raw phenotypic variation for embryonic development time in  <dig> dgrp strains 


additional file 5: figure s <dig>  box plots of the significant snp associations in the gwa analysis 


additional file 6: figure s <dig>  results of the power calculations to detect associated snps with effect size of 1 h of difference in the duration of embryogenesis 


additional file 7: table s <dig>  top gwas results for embryogenesis length and the corresponding dgrp phenotypes 


additional file 8: figure s <dig>  the effects of wolbachia pipientis infection on the measured phenotype 


additional file 9: figure s <dig>  inversion polymorphisms and their effect on doe 




abbreviations
anovaanalysis of variance

dgrp
drosophila genetic reference panel

doeduration of embryogenesis

dtegg-to-adult development time

eavegg-to-adult viability

hdhigh density

ldlow density

mafminor allele frequency

