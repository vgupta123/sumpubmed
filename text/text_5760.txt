BACKGROUND
chromatin immunoprecipitation followed by sequencing  is a widely used technique essential to study transcription factor binding and chromatin modifications. this technique has been largely used to characterize many biological processes, enabling the creation of valuable public resources of epigenomic data . due to the importance of interpreting these datasets, a large number of algorithms for downstream processing of chip-seq experiments have been developed  <cit> . all these methods are usually based on the evaluation of signal intensities to detect local enrichment of uniquely aligned reads on the reference genome . peak shape shows high variability among the chip-seq experiments that investigate different proteins as well as among different genomic regions in a single chip-seq. this variability is not only related to peak intensity  <cit> . indeed, the shapes of a transcription factor  usually appear concentrated narrowly, while peaks that characterize histone marks can sometimes spread over a large region  <cit> .

recently, peak shape properties different from signal intensity have been used in peak calling , peak ranking  <cit>  and chip-seq differential analysis  <cit> . while the developed methods show that additional features of peak shape can improve peak detection, here we want to understand whether peak shape includes additional biological properties that have not been explored yet. our hypothesis is that peak shape is influenced by the organization and interactions of the proteins bound to the dna, hence we want to understand if the detection of differences in peak shape in a single chip-seq experiment can shed light on the binding of cooperative transcription factors. we are also interested in assessing whether the organization and interactions of these transcription factors is correlated to the genomic context and to gene expression. in order to address these questions, we propose an innovative analysis pipeline that distinguishes different shapes in a set of chip-seq peaks and relates the obtained profiles to several independent genomic datasets . in our method, we use cluster analysis to evaluate whether the peaks of a chip-seq can be divided into groups, according to both the complexity and the intensity of the coverage function that defines them. to achieve this goal we select five shape indices, embedding the problem into the framework of multivariate statistical analysis. we also employ a wide range of statistical techniques to correlate the shape with a functional role. the software sic-chip , which computes the shape indices and clusters the peaks, is available online  <cit>  as a command line r script.

to clarify the meaning of peak shape, we decide to study the erythroid transcription factor gata- <dig>  in k <dig> cell line and in megakaryocytes. in this particular setting, we show that peak shapes contain information that can be used to shed light on cooperative binding and to identify up-regulated genes. moreover, we apply the proposed methodology to a set of chip-seq experiments in k <dig> and we discover that peak shape can vary depending on the different binding proteins under investigation. here we mainly concentrate our attention on the study of peak shape of transcription factors, but the same ideas can be generalized to other types of protein-dna interactions.

RESULTS
peak shape varies among different experiments
we observe that peak shape is quite reproducible as technical and biological replicates obtained with the same library preparation protocols  give rise to the same signal in the same genomic region . this is true even if chip-seq efficiencies for independent experiments can vary  <cit>  as in fig. 1a. in addition, if two antibodies are used to perform chromatin immunoprecipitation for the same transcription factor, a subset of peaks might have different peak shapes . the antibodies may recognize different epitopes of the same transcription factor and this fact can lead to differences in shapes. moreover, transcription factor interactions can be cell-type specific, and we observe that chip-seq peaks obtained using the same antibody in different cell types can show a subset of diverse shapes . these observations suggest that the analysis of peak shape may reveal insights regarding cooperation and association of transcription factors.fig.  <dig> peaks shapes. a random peaks in two chip-seq replicates - in magenta and cyan, respectively - for the transcription factor gata- <dig> in k <dig> cells. despite the different efficiency of the two replicates, peak shape is highly maintained. b peaks in two chip-seq experiments in k <dig> cells, performed with two different antibodies for the same transcription factor gata- <dig>  in this situation some peaks can show different shapes. c peaks in two chip-seq experiments for the transcription factor gata <dig> in k <dig> and peripheral blood-derived erythroblasts - in purple and orange, respectively. also in this case peak shape can vary. some relevant parameters of the chip-seq plotted here can be found in additional file 1: table s <dig> and in additional file 2




it is important to point out that different library preparation protocols might affect peak shape. while the read length of a chip-seq experiment does not have any effect on peak shape, fragment length influences peak shape as differences in fragment lengths result in different signal resolutions . however, the methodology we propose is not affected by differences in library preparation and sequencing, since it considers a single chip-seq at a time and clusters peaks belonging to the same experiment.

overview of the analysis pipeline proposed
the analysis pipeline that we propose is summarized in fig.  <dig>  first, we perform a pre-processing step to produce coverage function and to identify enriched peaks. in this first step, we also estimate the average size of the dna fragments obtained during sonication. we then use this estimate to extend each tag in order to get the original fragments and to compute the coverage function, counting the number of fragments that fall over each nucleotide. the correct estimation of the fragment length is essential since, as we have previously observed, peak shape can vary based on this estimation. next, we calculate five indices of shape: the maximum height, the area, the full width at half maximum, the number of local peaks, and the shape index m divided by the maximum height . afterwards, we cluster peaks in the space of these resulting shape indices. we name this central part of our method shape index clustering  <cit> . finally, the obtained clusters are validated and characterized using four steps: 1) we perform gene ontology analysis and motif analysis; 2) we investigate the genomic locations of the peaks; 3) we study the overlap of the peaks in each cluster with peaks of other available transcription factors and histone modifications, as well as with open chromatin regions; 4) we evaluate gene expression changes in association with the shape clustering. a detailed description of each step in the pipeline proposed is given in methods.fig.  <dig> a schematic overview of the analysis pipeline proposed. after a chip-seq pre-processing, that involves the calculation of the coverage function for each peak found by the peak caller, multivariate clustering on five indices of intensity and shape is employed to find groups of similar peaks. afterwards, the characterization of these clusters is studied by using go analysis and motif analysis. moreover, clusters are related with the presence of other proteins and with gene expression

fig.  <dig> shape indices. a schema of the first four shape indices. b a peak and its corresponding tree, constructed as suggested in  <cit>  and in  <cit> ; the highlighted edges represent a maximal matching for the tree, that defines the index m



gata- <dig> in k <dig> cells
we apply the proposed analysis pipeline to chip-seqs for the erythroid transcription factor gata- <dig> in human erythroleukemic k <dig> cells. the purpose of this study is to assess whether gata- <dig> peak shape is associated with specific regulatory complexes and functions. gata- <dig> is a transcription factor essential for erythroid and megakaryocytic development, and mutations in gata- <dig> are associated with a form of leukemia found in newborns affected by down syndrome. we select k <dig> cells because gata- <dig> binding has been extensively characterized in this cell line  and also because k <dig> cell line has been widely described by several next generation sequencing experiments from the encyclopedia of dna elements  consortium  <cit>  and from many independent investigators.

two chip-seq replicates for gata- <dig> in k <dig> human cells
the experiments under consideration consist of two chip-seq replicates for gata- <dig> from encode  <cit>  . the signal from a normal mouse igg chip-seq  is used as control for peak calling. peaks are called using macs  <cit> . while the number of reads after filtering is comparable and the estimated fragment length is exactly the same in the two replicates, the number of identified peaks is different: we identify  <dig> peaks in replicate  <dig> and  <dig> peaks in replicate  <dig>  with  <dig> overlapping peaks . almost all the regions selected in replicate  <dig> are enriched in replicate  <dig>  meaning that the second replicate is much less efficient than the first one  <cit> . in fig. 1a, we show the coverage function of two random overlapping peaks - in cyan and magenta for the two replicates, respectively. despite the different degree of efficiency of the two replicates, pairs of peaks exhibit the same shape. notably, the whole coverage function has a similar shape in the two replicates, carrying a correlation of ~ <dig>  on the entire genome and a correlation of  <dig>  on the common peaks .

clustering of shape indices leads to three clusters
we use the statistical analysis described in methods to assess whether there are groups of peaks inside a single chip-seq that can be separated according to the shape, as summarized by the five selected indices. here, we present the results obtained by running the analysis on replicate  <dig>  results concerning replicate  <dig> are highly similar, despite the remarkable differences of the two chip-seqs, and can be found in additional file 1: figures s4-s <dig>  notably, if we merge the reads of the two replicates and then we perform the analysis, we obtain highly similar results too. from the scatterplot of the shape indices , from principal component analysis  and independent component analysis , it is clear that the five indices are not mutually independent. actually, the two indices related to the intensity of the signal, namely the maximum height and the area are highly correlated ; the same applies to the three indices associated with peak complexity, i.e. the full width at half maximum, the number of local peaks and the shape index m with correlation coefficients of  <dig> ,  <dig>  and  <dig> , respectively. however, we choose not to reduce the dimensionality of the problem in order to keep all the shape variability that we can catch with the selected indices.fig.  <dig> distribution of shape indices in the three clusters. results of k-mean algorithm with euclidean distance on the standardized shape indices, in replicate  <dig> for k <dig> cells. a-e boxplots of shape indices in the three clusters. f the first two components obtained with independent component analysis, in term of the initial shape indices. g scatterplot of the data in the plane defined by the first two independent components, with each point representing a peak and colored according to the cluster it belongs to



running the k-mean algorithm on the standardized indices for several numbers of clusters k, we obtain the total within-clusters sum of squares plot of additional file 1: figure s2a: k =  <dig> seems a sensible trade-off, since the choice of a higher k is not paid off by a significant gain in the total within-clusters sum of squares. this choice leads to identify a big cluster, that comprises ~75 % of peaks , and two smaller clusters including ~15 %  and ~10 %  of the data, respectively. according to the scatterplot of additional file 1: figure s2b, wherein colors indicate cluster membership, and to the boxplots of fig. 4a-e, that display the distribution of the indices in the three clusters, cluster  <dig> and cluster  <dig> differ in the intensity of the peaks they contains, while cluster  <dig> includes the most complex peaks. similarly, independent component analysis  shows that the three clusters are well divided in the plane defined by the first two components. in particular, the component that corresponds to peak intensity  separates cluster  <dig> from the others, while the component related to the complexity of the peaks  distinguishes cluster  <dig>  in order to better understand the shapes selected through clustering, fig.  <dig> displays the pointwise boxplots of the peak coverage function in the different clusters  and the plot of a random sample of  <dig> peaks . cluster  <dig> is mainly composed of unimodal and not very high peaks, while cluster  <dig> comprises high, bell-shaped peaks; multimodal and wider peaks belong to cluster  <dig>  interestingly, peaks of cluster  <dig> are not those selected with low score  by macs: if we further reduce the threshold in peak detection, we keep on picking a considerable subset of these peaks. hence, the groups of peaks obtained by our clustering of shape indices cannot be deduced by macs output.fig.  <dig> the three clusters obtained on shape indices. results of k-mean algorithm with euclidean distance on the standardized shape indices, in replicate  <dig> for k <dig> cells. a-c pointwise boxplots of the coverage function in the three clusters. for each abscissa, black indicates the median value, dark colors highlight the central 50 % of the distribution, while light colors correspond to the boxplot whiskers. d-f a random sample of  <dig> peaks , with colors highlighting the cluster membership. in both images, peaks are registered using as landmark the location of their maximum height



the comparison of the resulting classification for the two replicates, done on the common peaks, supports the robustness of the considered method. indeed, nearly 90 % of peak pairs fall in the correspondent cluster of the two replicates. moreover, only  <dig> pairs are misclassified between the two extreme shapes, namely between cluster  <dig> and cluster  <dig>  in additional file 1: figure s <dig>  we show the correspondences between cluster memberships of peaks in the two replicates. this cross-replicate robustness analysis and the relationship between the two replicates indicate that it is sufficient to consider the most efficient replicate for the evaluation and characterization of the clusters. thus, in the following analyses, we show only results concerning replicate  <dig> 

only cluster  <dig> is directly associated with the typical biological processes of gata-1
we use the genomic regions enrichment of annotations tool  to perform gene ontology  analysis of the three clusters. go analysis reveals that the terms related to the typical biological processes of gata- <dig>  are enriched exclusively in cluster  <dig> . considering the complete list of terms given by great, it is evident that cluster  <dig> is made up of few genes and many of these genes are key hematopoietic transcription factors: gata <dig>  fog, and tal <dig>  on the other hand, cluster  <dig> also contains genes that are typically regulated by gata- <dig> , but contains also other genes associated with secondary functions of gata- <dig>  indeed we can identify many genes  that are related to apoptosis. interestingly, these genes are nearly absent in cluster  <dig> and present at a lower extent in cluster  <dig> . gata- <dig> is known to inhibit apoptosis while promoting differentiation in erythroid and megakaryocytic cells  <cit> .

peaks of cluster  <dig> contain less gata- <dig> motifs
gata- <dig> has been shown to recognize the consensus sequence gataa  <cit> , so we might anticipate to find this binding motif under the vast majority of peaks, whatever cluster they belong to. this expectation is only partly fulfilled. although gata- <dig> motif is found in all cases, the significance of the enrichment is different in the three clusters . surprisingly, e-values obtained with cluster  <dig> and  <dig> are comparable to the global one. on the contrary, gata- <dig> motif is less present in the peaks of cluster  <dig>  only 79 % of regions belonging to cluster  <dig> contain the consensus sequence gataa, while the motif is found in almost all peaks of cluster  <dig> and in 91 % of cluster  <dig> peaks . furthermore, peaks in cluster  <dig> tend to be associated with multiple gata- <dig> motifs . since other members of the gata family zinc finger proteins, namely gata- <dig> and gata- <dig>  can bind with high affinity the same motif of gata- <dig>  <cit> , the presence of more than one motif under a peak can indicate both a multiple gata- <dig> binding and the simultaneous presence of several transcription factors of the gata family. in fig. 6b, we show the distribution of motif distance from the peak maximum. in addition of being less associated with gata- <dig> motif, cluster  <dig> regions exhibit a higher distance of the found motifs from peak maxima: when the motif is present, it is usually not centered near the maximum.table  <dig> gata- <dig> motif analysis



gata- <dig> motif enrichment and occurrences analysis in the complete set of peaks as well as in the three clusters, in replicate  <dig> for k <dig> cells. for the enrichment analysis, meme-chip with default options is run on samples of  <dig> peaks  to get comparable e-values. in the global set and in cluster  <dig>  that are large with respect to the sample size, the median of e-values obtained by random sampling  <dig> times is reported. in parenthesis we indicate the e-values obtained running meme-chip changing default parameters to allow the motif search in the whole peak regions . the number of peaks with the motif  is computed on the whole sets of peaks

fig.  <dig> occurrences analysis for gata- <dig> motif, in replicate  <dig> for k <dig> cells. a distribution of the number of occurrences of the consensus sequence gataa under each gata- <dig> peak: under many peaks of cluster  <dig> the motif occurs multiple times. b boxplots of motif distances from peak maxima in the three clusters; the mean distance in cluster  <dig> peaks is significantly greater than the mean distances in cluster  <dig> and cluster  <dig> regions 



apart from gata- <dig> consensus sequence, many other motifs are enriched in the three clusters . interestingly, these additional motifs are peculiar to the different clusters, suggesting distinctive types of gene regulation. all the three clusters are enriched for ets motifs, including pu. <dig>  gabpa, and fli <dig> motifs, in accordance with what is shown by previous data on gata- <dig>  <cit> . cluster  <dig> and  <dig>  in contrast to cluster  <dig>  are enriched for tal- <dig> and klf <dig> motifs. interestingly, tal <dig> motif is usually enriched at gata- <dig> activated genes  <cit> . in addition, cluster  <dig> is also enriched by motifs corresponding to foxo <dig>  sox <dig> and srf and tead <dig>  genes that are involved in regulation of apoptosis, in accordance with the functional enrichment of genes present in this cluster.

peaks of cluster  <dig> frequently lie in promoter regions
studying the association of gata- <dig> peaks with known genes, we discover that about 55 % of peaks  are assigned to at least one gene and this percentage is similar in the three clusters . the clusters behave in the same way even considering the proportion of peaks associated to non-coding genes, as it is the same in all clusters . interestingly, when we examine more deeply the genomic locations of the peaks, cluster  <dig> stands out from the others because of its significantly higher association with promoters , defined as the regions within 5 kb upstream and downstream transcription start sites . testing the hypothesis that the proportion of peaks from cluster  <dig> located in promoters is greater than the same proportion for peaks from cluster  <dig> gives p-value = 0; we get the same p-value =  <dig> also considering cluster  <dig>  hence the association of cluster  <dig> with promoter regions is statistically significant. less and more restrictive definitions of promotor regions show the same association for cluster  <dig> .fig.  <dig> association between gata- <dig> peaks and genes for the three clusters in k <dig> cells. gray areas show the intergenic peaks, peaks found in the promoter regions of a known gene  are in dark colors, and peaks located in a known gene body are in light colors. we observe that cluster  <dig> is more associated to promoters than the other clusters . results with less and more restrictive rules are shown in additional file 1: figure s8



cluster  <dig> is associated with a putative protein complex
to investigate the simultaneous binding of gata- <dig> with other proteins, we consider a set of  <dig> publicly available chip-seq experiments for  <dig> different transcription factors, as well as  <dig> histone modification chip-seqs in k <dig> cells . transcription factors chip-seq replicates are kept separated and macs is used to call peaks, independently in each sample, using as control the same signal used with gata- <dig> chip-seqs. in the case of histone modifications, we use peaks called by encode. in addition, we also consider dnase i hypersensitive sites in k <dig> cells  in order to study open chromatin regions.

we use random forest classification, as explained in methods, to select the experiments that are more correlated with our clusterization. specifically, seven different analyses are performed, by using as response the clusters membership and alternatively classifying: 1) all clusters; 2) one cluster versus the union of the other two; 3) two clusters one against the other. all random forest models are able to predict a considerable portion of memberships, indicating that our peak shape clustering is related to co-located proteins. notably, the overlaps of gata- <dig> peaks with open chromatin regions stand out as important in all these analyses, according to gini index . looking more deeply to the relationship between clusters and dnase-seq regions, we can observe that the proportion of peaks that fall in accessible regions of the genome is typical of the different clusters. indeed, almost all cluster  <dig> peaks intersect dnase i hypersensitive sites , while the portion of peaks that fall in open chromatin regions is smaller in cluster  <dig>  and it is further reduced in cluster  <dig> . anyway, the three proportions are much higher with respect to the random case , in which only the 8 % of the peaks intersect open chromatin regions, supporting the claim that none of the clusters is composed exclusively by artifacts. interestingly, the distribution of the percentage of intersection, conditionally to the intersection being non-zero, is essentially the same in all groups, and it is highly similar to the random case. hence, the clusters are characterized by the proportion of peaks that overlap dnase i sites, rather than by the percentages of intersection . inspecting the rankings of transcription factors and histone modifications chip-seqs, according to gini index, we are able to identify a small set of regulatory elements that emerge as influent in the seven random forest classifiers we built, with all replicates in top positions . specifically, we retain for further analyses all the proteins that are, simultaneously, 1) top  <dig> in at least three random forests; 2) top  <dig> in at least five random forests; 3) top  <dig> with all available replicates in at least  <dig> random forests. the eight transcription factors selected are gata- <dig>  cebpd, hmgn <dig>  trim <dig>  pml, tal- <dig>  zmiz <dig> and ccnt <dig> . some of these proteins are known gata- <dig> interactors. in particular, gata- <dig> and tal- <dig> can associate with gata- <dig> in complex to regulate erythroid transcription. in addition, evidences of interaction between gata- <dig> and pml have recently been shown  <cit> . we must point out that among these important regulatory elements there are no histone modifications. indeed, if we perform similar random forest analyses using as predictors only the  <dig> chip-seqs for transcription factors, we get nearly the same results and the same accuracy in cluster membership predictions.table  <dig> transcription factors related to the clustering

the eight transcription factors emerged as relevant for the peak shape clustering in replicate  <dig>  according to gini index in all the random forest classifiers built . combinatorial interaction analysis reveals that cluster  <dig> is characterized by the simultaneous binding of all these eight proteins, together with gata-1



the combinatorial interaction analysis on the transcription factors selected by using random forests shows that cluster  <dig> is characterized by the simultaneous binding of all the eight transcription factors, in addition to gata- <dig>  the most significant results are obtained considering the intersections of gata- <dig> peaks with at least one chip-seq replicate for the other regulatory elements under investigation. nevertheless, the same conclusions are drawn even if we require that gata- <dig> peaks overlap all available chip-seq replicates for the other proteins. notably, the distribution of overlaps with a combination of these eight transcription factors in cluster  <dig> and cluster  <dig> is very similar to the global one, in which no combination outnumbers the others. on the contrary, ~61 % of the peaks belonging to cluster  <dig> simultaneously intersect all the eight proteins considered, while only  <dig> regions contain gata- <dig> alone .fig.  <dig> combinatorial interaction analysis on the eight transcription factors selected with random forests , in replicate  <dig> for k <dig> cells. here we consider having an overlap when gata- <dig> peak intersects at least one chip-seq replicate for the regulatory element of interest. a results considering all the peaks simultaneously. b-d results concerning the peaks that belong to three clusters separately. in all the plots, each row represents the overlap of a gata- <dig> peak with the eight protein considered. the red color means that there is an intersection, while green stands for the absence of the protein in the correspondent gata- <dig> region. the proportion of gata- <dig> peaks that intersect the different proteins is indicated in brackets near the protein name. results obtained considering the more stringent rule of having an overlap if the peak intersects  all replicates can be found in additional file 1: figure s10



the co-binding of these eight transcription factors in the genomic regions of cluster  <dig> emerges also by using multiple correspondence analysis . the advantage of this analysis is that it permits to study all the replicates simultaneously. in particular, by plotting the amount of total variation explained by an increasing number of principal coordinates , we choose to focus on the first two components. the main effect of the first component  is to contrast between the presence and the absence of overlaps, while the second dimension adds some variability among the different regulatory elements considered . we observe that the various chip-seq replicates for the same protein are close in the space of the first two principal components, suggesting that they behave in a very similar way. notably, cluster  <dig> appears as highly different from the other two groups and the global case. indeed, the first component conveniently separates cluster  <dig> peaks from the others. moreover, levels  <dig>  of all variables are clustered together in cluster  <dig>  indicating high similarity between the peaks associated to this category.

genes associated to cluster  <dig> tend to be underexpressed after knockdown of gata-1
to examine the potential correlation between cluster membership and gene expression, we associate each gata- <dig> peak to a known gene if it falls within the region surrounding the transcription start site or in the gene body. given that a peak can be assigned to more than one gene, and conversely each known gene can be associated to multiple peaks, some genes can turn out to be related to two or even all clusters . in order to inspect possible relationships between peak shape and gene expression, we consider only the genes that are unambiguously associated to a single cluster in the next analyses. the gene expression experiments that we study in combination with the results of peak shape clustering consist in four publicly available rna-seqs  in k <dig> cells  <cit>  : two control samples and two replicates after independent knockdown for gata- <dig>  details about the employed rna-seq analysis pipeline can be found in methods. gene expression boxplots  show that there are small differences among the base expression level  of the genes associated to different clusters. indeed, rpkm in cluster  <dig> is slightly higher and less variable then the other clusters, while cluster  <dig> shows lower and more variable rpkm. when we focus on the genes that are differentially expressed after knockdown of gata- <dig>  cluster  <dig> exhibits considerable peculiarities . specifically, cluster  <dig> genes are more differentially expressed than genes associated to the other two clusters . about 27 % of the differentially expressed genes that are associated to at least one gata- <dig> peak are down-regulated following gata- <dig> knockdown. this percentage remains almost the same if we analyze only the genes univocally associated to cluster  <dig> or cluster  <dig> . conversely, half of the genes assigned to cluster  <dig>  are down-regulated. therefore the fraction of genes associated to cluster  <dig> that are down-regulated after silencing of gata- <dig> is almost double than the ones for the other two clusters and for the whole set of differentially expressed genes bound by gata- <dig> . this result suggests that gata- <dig> in peaks of cluster  <dig> acts more prevalently as a transcriptional activator. the reported results are robust to the peak-gene assignment rule: we obtain the same conclusions even considering different definitions of promoter regions . the detailed results can be found in additional file 1: figure s13-s <dig> fig.  <dig> gene expression analysis. expression level fold change for differential expressed genes after knockdown of gata- <dig> in k <dig> cells. the proportion of differential expressed genes in the different clusters is shown above each bar, where purple indicates overexpression, while cyan displays underexpressed genes. only the known genes that are univocally associated to a single cluster are shown. bonferroni corrected p-values of fisher’s exact test on the percentage of overexpressed genes  are shown with asterisks . gene expression analysis results obtained with less and more restrictive definition of promoter regions can be found in additional file 1: figure s15



gata- <dig> in megakaryocytes
in order to check whether our findings hold in another biological system, we decide to redo the analysis for the transcription factor gata- <dig> in primary human megakaryocyte cultures. the advantage to study gata- <dig> binding in primary human megakaryocytes is that they represent an additional and more relevant biological model of the in vivo situation. in addition, we analyze an analogous chip-seq in primary mouse megakaryocytes, to understand whether gata- <dig> peak shapes are maintained across different organisms.

three clusters for gata- <dig> peaks in human megakaryocytes
we consider a publicly available chip-seq experiment by tijssen et al.  <cit>  , on which we apply part of the analysis pipeline described in methods . the sequenced reads are preprocessed as detailed in methods. briefly, bwa is used to map high quality reads to the human reference genome hg <dig>  afterward, macs is employed to call peaks, obtaining  <dig> gata- <dig> peaks . the estimated fragments length of  <dig> nucleotides is then used to compute the coverage function for each peak.

similarly to what we obtained with gata- <dig> in k <dig>  also in megakaryocytes the multivariate analysis on shape indices leads to three clusters . notably, examining the nature of the resulting clusters, we conclude that the selected shapes have the same characteristics of the ones selected within k <dig> peaks, with the only difference being the proportions of peaks in the different clusters. clustering results are shown in additional file 1: figures s16b-s <dig> and fig.  <dig> , where for the sake of clarity the clusters are named and colored as their matching pair in k <dig>  in summary, cluster  <dig> includes the majority of the peaks , that are bell-shaped and quite low. cluster  <dig> is the smallest group  and is composed by high, bell-shaped peaks. finally, cluster  <dig> comprises the most complex and wide peaks .fig.  <dig> the three clusters obtained on shape indices in megakaryocytes. results of k-mean algorithm with euclidean distance on the standardized shape indices, in megakaryocytes. a-c pointwise boxplots of the coverage function in the three clusters. for each abscissa, black indicates the median value, dark colors highlight the central 50 % of the distribution, while light colors correspond to the boxplot whiskers. d-f a random sample of  <dig> peaks , with colors highlighting the cluster membership. in both images, peaks are registered using as landmark the location of their maximum height



key hematopoietic transcription factors simultaneously bind regions of cluster 2
to study the genome-wide binding of multiple transcription factors and identify regulatory complexes, tijssen et al. generated chip-seqs for the hematopoietic transcription factors gata- <dig>  fli <dig>  gata- <dig>  runx <dig> and tal- <dig>  by analyzing all the regions bound by at least one of these proteins, the authors showed that the five transcription factors in megakaryocytes bind the dna together more frequently than expected at random  <cit> . to examine the potential relationship between the three peak shape clusters and the binding of gata- <dig> with different sets of proteins, we pre-process the four chip-seq experiments available  and we use macs to identify the binding sites of each transcription factor . afterwards, we perform combinatorial interaction analysis on the whole set of gata- <dig> peaks, as well as on the three clusters separately. we observe  that only cluster  <dig> is characterized by the simultaneous presence of all the five proteins. notably, about 15 % of the peaks belonging to cluster  <dig> overlap all five transcription factors together, while this co-binding is present in only ~1 % and ~3 % of peaks from cluster  <dig> and cluster  <dig>  respectively. moreover, at least three proteins among fli <dig>  gata- <dig>  runx <dig> and tal- <dig> simultaneously bind only ~15 % of gata- <dig> sites, but this combination is present in ~44 % of peaks in cluster  <dig>  these findings suggest that we can actually use gata- <dig> peak shape to highlight the co-localization preference of the five hematopoietic transcription factors in megakaryocytes. furthermore,  <dig> of the  <dig> genes whose depletion resulted in a severe hematological phenotype in zebrafish , that were identified by the co-localization of the five tfs in  <cit> , are part of cluster  <dig>  thus, peak shape conveys biologically relevant findings.fig.  <dig> combinatorial interaction analysis on the five hematopoietic transcription factors studied in human megakaryocytes. a results considering all the peaks simultaneously. b-d results concerning the peaks that belong to three clusters separately. in all the plots, each row represents the overlap of a gata- <dig> peak with the eight protein considered. the red color means that there is an intersection, while green stands for the absence of the protein in the correspondent gata- <dig> region



gata- <dig> peaks in mouse and human megakaryocytes have similar shapes
we apply our analysis pipeline to an encode chip-seq for gata- <dig> in mouse megakaryocytes   <cit> . we start our preprocessing on the reads already aligned to mm <dig> reference genome, then we call peaks using macs as detailed in methods. after filtering our blacklisted regions we obtain  <dig> peaks and an estimated fragments length of  <dig> nucleotides, comparable with the length obtained in human megakaryocytes. the clustering of shape indices produces four clusters in this case. however, one cluster is made of only  <dig> peaks, and  <dig> out of  <dig> lie in repetitive regions , thus they are false positive peaks. importantly, these  <dig> peaks show extreme shapes  and our clustering methodology is able to recognize and group them together. after excluding this artifact cluster from further analyses, gata- <dig> in mouse and human megakaryocytes have the same number of clusters, with very similar shapes and indices distributions. the sole difference we can spot is that mouse cluster  <dig> peaks are a bit more complex than human cluster  <dig> peaks. this result suggests that peak shape might be the highly similar in the same cell types of different organisms.

clustering of shape indices for other chip-seq experiments
we examine a set of chip-seqs for nine different proteins in k <dig> cells , to understand whether the clustering of shape indices always give rise to the same number of clusters and to the same shapes that are found in gata- <dig>  all the analyses are performed using the same methodology described in methods. interestingly, we observe that the number of clusters varies depending on the protein under consideration. in particular, we obtain four clusters for trim <dig>  ccnt <dig>  z-miz <dig> and pml, and three clusters for gata- <dig>  tal- <dig>  c-fos, sp <dig> and nf-ya. differences in the number of clusters depend on the complexity of the data under analysis. indeed, in all the experiments that give rise to four clusters, one of them is quite small  and contains broad and complex peaks; we exclude that these peaks are alignment artifacts  because they are not located in repetitive regions and they show a central stronger signal. in these cases the peak shapes appear to be generally more complex than the shapes we obtained in gata- <dig> . moreover, different tfs have various rates of peaks in the different clusters. among the tfs with three clusters, we observe that some proteins  produce almost the same clustering of gata- <dig>  while other tfs  have slightly more complex shapes, with characteristic rates .

CONCLUSIONS
we have developed a novel analysis method that studies chip-seq enriched regions focusing both on the complexity and the signal intensity of peaks. shape index clustering for chip-seq peaks has the ability to identify different groups of peaks in a single chip-seq, based on differences in peak shape. these differences could not be identified using either tag counts or peak enrichment alone. in addition, the proposed pipeline involves several downstream analyses able to investigate possible relationships between the peak shape clusters identified by sic-chip and biological properties.

by applying the proposed analysis pipeline to chip-seq experiments for the transcription factor gata- <dig> in k <dig> cells and in primary human megakaryocytes, we have demonstrated that statistically significant different peak shapes are correlated with several cooperative transcriptional regulators. we have shown that gata- <dig> peak shape is associated with characteristic regulatory complexes and changes in gene expression profiles. moreover, peak shape can shed light on previously described gata- <dig> occupancy profiles. specifically, considering gata- <dig> chip-seqs in k <dig> cells, peaks belonging to cluster  <dig> emerge as part of a putative protein complex that comprises well known gata- <dig> interactors such as gata- <dig> and tal- <dig>  the target genes of these peaks appear to be mostly down-regulated after knockdown of gata- <dig>  suggesting that gata- <dig> in cluster  <dig> behaves primarily as a transcriptional activator. this result is in agreement with previous studies that reported the ability of gata- <dig> to act both as an activator and as a repressor, and that also highlighted a positive correlation between activated gata- <dig> target genes and binding of tal- <dig>  <cit> . in conclusion, our study demonstrates that chip-seq shapes include information regarding the binding of other proteins beside the one used for precipitation and it is correlated with gene expression. moreover, studying other chip-seq experiments with the same methodology, we showed that peak shape clustering depends on the protein under investigation. thus, chip-seq profiles carry much more information than previously suspected.

although we presented our methodology applied mainly to chip-seq experiments for transcription factors, the same principles can be applied to the investigation of other chip-seq data, e.g. histone modification peaks. furthermore, a generalization of these methods may be employed to analyze chip-exo data  <cit> . we expect that applying the “peak shape concept” to chip-exo peaks can lead to even more interesting and clear correlations between shape and biological properties, thanks to the high resolution reached by this technique.

