BACKGROUND
a single rapidly evolving rna virus can give rise to a swarm of related descendants  <cit> . clonal expansions can be observed during an acute infection as pathogens replicate within a host  <cit>  or in an outbreak of an emerging pathogen, when a novel virus propagates through a susceptible host population. a viral population diversifies as it expands, enabling the virus to explore larger sections of the fitness landscape  <cit> . studying the dynamics of viral diversification can yield insight into when a host was originally infected, how fast a pathogen is evolving, and if specific genomic alterations are being selected for in a particular host or treatment regime.

clonal populations founded by a single ancestor consist of individual organisms with highly similar, though not necessarily identical, genomes. the consensus genome is a constructed sequence representing the majority allele at each residue; hence, it may not truly exist in the viral population and fails to capture the whole mutant distribution in the sub-population structure. viral diversity in acute infection has been previously studied through single genome amplification and combinations of rt-pcr and cloning  <cit> . these studies have utilized both phylogenetic techniques and exponential growth models to quantify viral evolution  <cit> . with advances in high-throughput sequencing technologies, studying viral genomic diversity and its role in inter- and intra-host evolution has become more feasible. ultra-deep sequencing has been employed to investigate systems of chronic infections in which viral populations have reached sustained levels of diversity  <cit> , as well as to investigate intra-host evolution of viral infections utilizing minor variants  <cit> . however, given estimated viral evolutionary rates of 10- <dig> to 10- <dig> substitutions/site/year, intra-host evolutionary dynamics during the first few days of an acute infection are dominated by very rare variants that only exist in less than 1% of the population  <cit> . due to inherent limitation on the length of the reads produced by high-throughput sequencing technologies, standard phylogenetic algorithms and consensus-based methodologies fail as the coexistence of very rare polymorphisms in each individual viral clone cannot be determined. in other words, the mutations cannot be phased as the information of their linkage with respect to the viral genome is lost   <cit> .

in this manuscript, we introduce a method to study the dynamics of clonal evolutions without the need for phased data. our methodology provides a means to estimate the starting time and evolutionary rates without assuming a model of growth. we validate our method both using a simulated clonal expansion and using genomic data from the  <dig> h1n <dig> influenza pandemic. in the latter case, phylogenetic analyses using full-length genomes are treated as the gold standard, with which our evolutionary dynamic estimates strongly agree  <cit> . we then apply our method to genetic data where phase information is missing. specifically, we infer the intra-host evolutionary dynamics of viral infections in vivo, using high-throughput, deep sequence data obtained from marburgvirus-infected non-human primates .

methods
measures of diversity. if the genome of the expansion's initiating clone is known, the frequencies of the diverging alleles from the seed, as well as their genomic positions , are evident in its descendants. therefore, we define total divergence, dt= ∑sxs, where xs is the frequency of a diverging allele at time ti, positioned at segregating sites, s. knowledge of the alleles present within the seeding clone is commonly unavailable. in lieu of this information, an approximated proxy for the initial seeding genome from the samples collected early in the expansion is often used. even though some polymorphisms become fixed and some disappear from the population, dt, as a measure of divergence, will always increase with time .

to avoid approximating the genome of the initial seeding clone, we propose to estimate the genomic diversity at time ti with the sum of the minimal allele frequencies  at segregating sites. minimal allele frequency can be best represented by one minus the frequency of the dominant allele at a segregating site. by definition, xs are always equal or larger than maf; therefore, estimates based on sum of maf represent the lower bound of those from dt. strong differences between the two measures indicate selection or bottlenecks, as changes in dt measure time and divergence from the seed and the sum of maf indicates variations in population diversity at a particular time.

mathematical framework. consider a clonal expansion with n clones at time ti, after a single initial clone began reproducing at time t <dig>  independent of a model of growth, we define μ¯i=1ti-t <dig> ∫t0tiμτdτ to be the average of evolutionary rates between time ti and t <dig>  the average hamming distance between any of these clones and the seed can be approximated by μ¯il, where l is the size of the genome. assuming that the n clones truly represent the frequencies of the segregating sites at time ti, 〈d〉, the expected distance of the descendants to the original clone, can be re-written as: d≃∑sxs=dt.

to study the early days of intra-host evolution, we assume negligible back-mutations. nonetheless, back-mutations and different rates per base can be accounted for by modifying the definition of 〈d〉 with more fitting substitution models  <cit> . note that 〈d〉 differs from intra-population nucleotide diversity, π <cit> , which is derived from the pairwise comparison of the present genomes at time ti, whereas 〈d〉 is derived from comparing those genomes to the original clone at time t <dig> 

letmjti be the number of accumulated polymorphisms at time ti in sequence j since the start of the expansion at time t <dig>  assuming mj is poisson distributed with mean μ¯il, the log-likelihood of the observed state is l≈∑i,jlog)-μ¯il). in all summations, i counts the number of time points, and j counts the number of sampled viral clones in ti. since the total number of mutations in the population can be counted across the genomes, or equivalently via the frequency of the segregating sites, a crucial observation can be made that ∑jmj=nti ∑sxs=n〈d〉, leading tol≈∑i〈d〉log)-nμ¯il). thus, the maximum likelihood estimate  of the evolutionary rates and the time of the initial clone can be derived from maximizing l. in these estimates, dt or the sum of maf at ti are used to approximate 〈d〉. maximizing a likelihood, in which there are more parameters than data points without any constraints will lead to over-fitting the data. we follow sanderson's modeling of a relaxed molecular clock and penalized likelihood approach  <cit> , and utilizing a non-parametric regularization term,w= ∑i <dig>  we minimize Ψ=-l+λw, where λ is the smoothing parameter. for very large λ, minimizing  Ψ leads to estimates equal to predictions under a strict molecular clock model. on the other hand, small λ leads to over-fitting the likelihood, and the estimates will be highly affected by small changes in the data. therefore, an intermediate value of λ should be chosen, so that the estimates follow the data while avoiding numerical artifacts caused by over-fitting. we determine this value by minimizing  Ψ over a range of values for λ and comparing the resulting values of l versus those of w, by scaling them between  <dig> and  <dig>  in other words, the maximum l is obtained when λ= <dig>  and the minimum w is obtained when λ→∞ . we choose the value of λ that results in equally weighted scaled l and scaled w  <cit> . for all optimization problems in our method, we employ the non-linear active set algorithm  <cit>  as implemented in matlab and r. in each optimization, we require 0<μ¯i and t0<t <dig> 

to calculate standard errors for estimates of 〈μ¯i〉 and t <dig>  we generate  <dig>  bootstrap sets by permuting the sequences in each dataset. using each dataset's smoothing parameter, we obtain maximum likelihood estimates for 〈μ¯i〉 and t <dig>  the bootstrap estimates are normally distributed and are used to calculate 95% confidence intervals. the presence of purifying selection can be measured through ω=βμnon-syn.μsyn., when it is less than  <dig>  here, λ is the ratio between the number of synonymous to non-synonymous sites in the genome, which we obtain by randomly mutating the viral genome one million times, assuming equal probability for transition and transversion events.

simulated data.starting from a single homogenous  <dig>  base-long clone, we simulated an exponentially expanding population at  <dig> time steps. the substitution rate was set at 10- <dig> substitutions/site per time point in addition to a noise term with a mean of zero and standard deviation of 10- <dig>  at each time point,  <dig>  sequences were randomly sampled, simulating a typical depth of  <dig> x for deep-sequencing. we repeated this procedure  <dig>  times.

influenza data. influenza consensus full-length sequences were obtained from influenza virus resource database  <cit>  and gisaid  <cit> , selecting h1n <dig> pandemic strains collected between march  <dig> and march  <dig>  we aligned the sequences of each segment using the muscle algorithm, and further manual curation.

high-throughput marburgvirus data.two separate animal studies provided the samples used in this study. blood from cynomolgus macaques was collected from nhp therapeutic efficacy trial control animals  on days  <dig> and  <dig> of the infection. the viral rna was extracted and sequenced. we rigorously cleaned the sequence reads to remove systematic errors and identified statistically significant single nucleotide substitutions. the ethics statement and details of the library preparation, sequencing, and variant calling are provided in supplementary methods .

RESULTS
simulated data. in a set of  <dig>  simulations, the estimates of evolutionary rates between time points captured the expected evolutionary dynamics , within statistical fluctuations, as shown in figure  <dig> . in particular, the estimates from dt found the average of evolutionary rates, 〈μ¯i〉, to be  <dig>  ±  <dig>  × 10- <dig> substitutions/site per time point, and the starting time of the expansion to be at - <dig>  ±  <dig> . the estimates based on maf indicated the lower bound of those from dt .

the  <dig> h1n <dig> influenza pandemic. the influenza genome consists of eight single-stranded rna segments, which code for  <dig> or more proteins. the novel influenza a virus responsible for the  <dig> pandemic was first identified in late march in california and mexico  <cit> , and spread quickly, as very limited previous immunity to the new strain existed within the human population. phylogenetic analyses estimated the most recent common ancestor of this strain to have arisen around january  <dig> , and to have evolved with a rate of  <dig>  ±  <dig>  × 10- <dig> substitutions/site/year  <cit> . these analyses also identified purifying selection during the pandemic   <cit> . the exact genome of the initial virus that infected the human population is not known; however, we approximated a proxy based on the consensus genomes of strains collected early in the expansion . we found the estimates for the mean of evolutionary rates between time points, 〈μ¯i〉 and the starting time of the pandemic, t <dig>  based on both dt and sum of maf to be consistent across all segments  and supplementary fig. s <dig>  in additional file 1). as there has been no evidence for reassortment events during the  <dig> h1n <dig> clonal expansion in humans  <cit> , we concatenated the segments and estimated 〈μ¯i〉 and t <dig> using whole-genome data. as shown in figure  <dig> , the maf-based estimates for t <dig> agreed with those from dt, and were found to be between november  <dig> and january  <dig>  we also estimated 〈μ¯i〉 of  <dig>  ±  <dig>  × 10- <dig> and  <dig>  ±  <dig>  × 10- <dig> substitutions/site/year during the pandemic, according to dt and sum of maf, respectively. we also identified a strong purifying selection during this period , corroborating results from phylogenetic methods.

deep sequencing of marburgvirus from infected nhp. marburgvirus, in the filoviridae family, is a single-stranded rna genome of about  <dig>  bases that encodes seven proteins, with an estimated evolutionary rate of  <dig> - <dig>  × 10- <dig> substitutions/site/year  <cit> . cynomolgus macaque constitutes a commonly used model organism for infection of filoviruses, recapitulating some of the clinical features of infection in humans. marburgvirus causes hemorrhagic fevers in humans and nhp, who typically succumb to the infection in 8- <dig> days.

working from an existing study of cynomolgus macaques infected with a musoke strain marburgvirus, we utilized deep sequencing data  of viral rna collected at different time points from four samples . we obtained frequency estimates as low as  <dig> % for an average of  <dig> variants per sample . we found ~ <dig>  times more transitions than transversions across samples , and observed a very homogenous viral population in the challenge stock  and a subsequent increase in viral diversity over time in vivo in all four individual experiments . the four independent analyses showed similar results, 1) an increasing genomic diversity with 〈μ¯i〉 of  <dig> - <dig>  × 10- <dig> substitutions/site/year for non-synonymous substitutions and  <dig> - <dig>  × 10- <dig> for all substitutions; 2) 2- <dig> days to convergence with the reference, approximately the amount of time spent propagating the virus after it was originally sequenced  <cit> .

acknowledging the caveat that each of the four samples went through different host-specific immune responses, we combined the data and obtained estimate for 〈μ¯i〉 to be  <dig>  ±  <dig>  × 10- <dig> substitutions/site/year for non-synonymous substitutions and  <dig>  ±  <dig>  × 10- <dig> for all substitutions . we also identified strong purifying selection .

discussion
we have proposed two measures of genetic diversity, derived independently of phasing information: 1) total divergence, dt, the sum of frequencies of diverging alleles from the original clone, and 2) the sum of minimal allele frequencies  at segregating sites. our methodology is robust to recombination or reassortment events within a clonal population because such evolutionary processes do not affect our measures of genetic diversity. since the numbers of sites with diverging alleles in a sampled population, acquired within the first few days of an acute infection or the early months of an outbreak, are much smaller than the length of the viral genome, the assumption that their distribution between two time points can be approximated with poisson distributions holds. assuming negligible positive selection and back-mutations, dt, increases over time by definition; thus, it measures divergence from the seed of the expansion. on the other hand, the sum of maf measures population diversity at a particular moment in time. therefore, strong differences between the two measures indicate deviations from neutral evolution, selection, or bottlenecks. our approach is particularly novel in its independence from an assumed growth model or previously published evolutionary rates, used in similar applications to intra-host data  <cit> . since we assume that the number of segregating sites is much smaller than the length of the viral genome, and that the infection starts by a genetically uniform population, our method is applicable to lytic viruses, and cannot be applied to integrating or lysogenic viruses. based on these measures, we followed a penalized maximum likelihood approach and a model of relaxed molecular clock  <cit> , and were able to estimate the starting point in time and evolutionary rate of clonal expansions.

to evaluate our method with well-characterized examples of clonal expansion, we calibrated it with a set of simulated sequences following a relaxed molecular clock model, and obtained estimates that capture the evolutionary parameters of the generating model. we found the estimates obtained from sum of maf to be the lower bound of those from total divergence. with the purpose of comparing and validating our methodology with standard phylogenetic techniques, we utilized phased whole-genome sequence data from the  <dig> influenza pandemic. limiting the data to the h1n <dig> isolates collected within the first year after the start of the pandemic, our estimates for the mean evolutionary rate, the starting time of the expansion, and presence of strong purifying selection corroborated with phylogenetic results  <cit> 

the novelty and most important application of our method is in analyzing unphased temporal data to which phylogenetic methods cannot be applied. during the course of an acute infection, the diversification of the viral population is not reflected in the consensus sequence, as most changes are minor, rare variants. to study viral intra-host diversity, we employed genomic data obtained from high-throughput ultra-deep sequencing of marburgvirus from four infected nhp, sampled at days  <dig> and  <dig> of the infection. the results showed consistent increases in viral diversity and the starting time of the intra-host expansion was found in agreement with the experimental setup  <cit> . maf-based diversity measures for non-synonymous substitutions in three of the infected nhp presented extremely good approximations for dt, which is especially important when the seed of a clonal expansion is not known . in particular, we found the estimated intra-host evolutionary rates for non-synonymous substitutions to be in similar range but higher than those reported from inter-host phylogenetic analysis  <cit> . combining the data from four samples corroborated with individual analyses, and the ratio of non-synonymous to synonymous substitutions rates indicated similar strong purifying selection to inter-host transmission of marburgvirus  <cit> .

in three samples, maf-based and dt diversity measures differed for synonymous substitutions, due to increases in frequency of a single allele  in the l gene. this allele increased from 6% in the seed stock to 62% , 57% , and 92%  on day  <dig>  the frequencies on day  <dig> were similar to those on day  <dig>  except in one sample , in which it fell to 31%. in one sample  the frequency of this allele was found to be 23% on both day  <dig> and day  <dig>  not affecting maf. synonymous mutations have been shown to contribute to viral fitness in other viruses  <cit> , and despite the fact that this allele did not alter the coding of the l protein, the presence of a selection pressure that leads to increases in its frequency cannot be ruled out.

CONCLUSIONS
as technology progresses, deep sequencing of temporal samples is becoming more readily available; however, due to missing phasing information, the application of standard phylogenetic methods to these data sources is limited. the measures of diversity defined in this manuscript present a distinct advantage over methods based on consensus sequences, specifically because of their power to analyze genomic diversification within days of an infection. this method is an ideal tool to pinpoint the time of infection, to estimate the evolutionary rate within a host, and to identify early markers of selection, in the course of an acute infection.

list of abbreviations
non-human primates . minimal allele frequencies .

competing interests
the authors declare that they have no competing interests.

authors' contributions
hk designed, developed, and validated the mathematical model; zc analyzed the influenza dataset, jk analyzed the marburgvirus dataset, jc and vt contributed to the mathematical model, en, tw, pi, and sb contributed to and gp directed the analysis of the high-throughput data, rr designed the study and directed research. all authors wrote and edited the manuscript.

supplementary material
additional file 1
click here for file

 additional file 2
click here for file

 additional file 3
click here for file

 acknowledgements
the authors would like to thank a. jacunski, d. rosenbloom, j. wang, k. emmet, and o. balaga, for insightful discussions and comments on the manuscript.

declaration
this work was funded by the defense threat reduction agency  project no.  <dig> and dtra grant w81xwh-13-2- <dig>  the publication of this work was funded by a grant from the geneva foundation . the funders had no role in the design, collection, analysis, and interpretation of data.

this article has been published as part of bmc genomics volume  <dig> supplement  <dig>  2014: proceedings of the twelfth annual research in computational molecular biology  satellite workshop on comparative genomics. the full contents of the supplement are available online at http://www.biomedcentral.com/bmcgenomics/supplements/15/s <dig> 
