BACKGROUND
the existence of intronic regions is essential for producing the proteomic diversity of eukaryotes through alternative splicing   <cit> . to achieve such complex splicing events, most eukaryotes  are equipped with several types of spliceosomes. these complex molecular machines are composed of  <dig> snrnas and more than  <dig> proteins  <cit> . spliceosomes recognize splicing motif sites , so that as is carried out for introns with a wide range of lengths  in the context of nearly constant exon sizes  <cit> .

analytical determination of the features that spliceosomes recognize for proper splicing has been an important problem in the field of bioinformatics  <cit> , because as abnormalities are involved in neuronal disorders and other diseases  <cit> . computational approaches have revealed that functional sss contain characteristic rna secondary structures around them, in addition to well-known sequence motifs such as flanked gt-ag dinucleotides within introns  <cit> . in previous research, such characteristics of secondary structure were required to attain a notably high accuracy of as prediction  <cit> . an association between splicing and rna secondary structure has also been validated by several experiments . for instance, homologous 14-3- <dig> ζ genes of insects were reported to need two types of complementary intronic sequence segments for mutually exclusive splicing, and the alternative exons that were present in the mature mrna appeared to depend on the stability of their base pairings  <cit> . accordingly, explaining the roles of rna secondary structure in splicing completion and as regulation is an important endeavor.

computational rna secondary structure analyses around splice sites
since mutation experiments with structure probing methods such as nuclear magnetic resonance spectroscopy or gel electrophoresis are time-consuming and laborious, very few studies have experimentally validated the complete secondary structures around sss  <cit> . high-throughput structure analyses, such as pars  <cit> , have also been rarely applied to pre-mrnas because of their paucity of sequencing reads mapped to the intronic regions  <cit> . hence, computational prediction has significantly contributed to the comprehensive analyses of rna secondary structures surrounding sss.

these studies have revealed that the density of stable base pairs is regulated around sss in complex ways. around alternatively spliced exons, stable structures were shown to be over-represented and conserved relative to constitutive or skipped exons  <cit> . at the same time, a significant enrichment of single-stranded transcript regions was also observed around splicing enhancer/silencer motifs  <cit> . this is presumably because splicing enhancer and silencer regions tend to contain binding sites of sr proteins and hnrnps, which can regulate the splicing efficiency, and the exposure of such regions increases the binding efficiency of these splicing factors  <cit> .

difficulty in rna secondary structure prediction of full-length introns
the ends of introns are known to be subject to complex structural constraints; however, little is known about the presence of structural constraints deep inside introns. although the density of structural motifs of splicing factors will be low compared to the motif around the sss, it is highly plausible that an intronic region far from the sss also needs to satisfy various structural requirements for the normal progression of transcription, degradation, and splicing. a detailed structural analysis of intronic sequences would be useful to test the existence of such structural constraints, and would serve as a valuable aid to understanding what makes the introns different from intergenic regions. nevertheless, very few studies have examined the structure propensity of full-length introns and pre-mrnas, owing to the prohibitive time complexity of global structure prediction; the original mfold and mccaskill’s algorithms require o time complexity for input sequence length n  <cit> . because it is computationally infeasible to apply the algorithms to long rnas, some folding programs restrict the allowed sequence distance between base pairing partners to within a given value w , which reduces the time complexity to o. even with the maximal-span constraint, the computation time for long transcripts is prohibitive. a more serious problem is that the magnitude of the partition functions grows exponentially with the input length n, which can cause overflow or underflow errors when computing structural properties such as base-pairing probabilities and accessibilities .

to circumvent these problems, sliding-window-based approaches have been developed, in which the folding algorithm is run for each artificial sequence window of length l in the input sequence . because such algorithms are easily parallelizable and do not cause numerical errors as long as l is not excessively large, they can be a practical tool for genome-wide structure analyses under the current constraints of computational resources. for example, in ref.  <cit> , the authors used the minimum free energy  of each sequence window to investigate the structural preferences of transcribed regions. however, since it computes only the energy values of sliding windows and does not predict consistent secondary structures or stochastic structural indicators, detailed structural analyses such as the comparison with experimental data and investigation of the positional specificity of structural constraints were difficult. other tools for genome-wide mfe-structure prediction using sliding-window approaches have similar problems  <cit> , because they were designed to search for unidentified short structural rnas whose exact boundaries are unknown but not to analyze the structure propensity of a section of a continuous long rna. as such, it has remained difficult to examine the positional structure propensity of introns using previous techniques that cannot handle an ensemble of possible structures for long transcripts.

our novel software parasor for genome-scale structure analyses
in this paper, we developed a novel software, “parasor”, which enables the distributed computation of various structural features of long rnas based on the boltzmann ensemble over globally consistent secondary structures. parasor divides dynamic programming  matrices into smaller pieces, such that each piece can be computed by a separate computer node without losing the connectivity information between the pieces. parasor avoids the numerical problems of previous algorithms by directly computing the ratios of dp variables whose magnitudes are bounded independently of n. parasor can exhaustively compute structural features such as structural profiles  <cit>  and globally consistent γ-centroid structures  <cit> , as well as conventional base pairing probabilities, stem probabilities, and accessibilities. using parasor, we investigated the structural preferences of entire transcribed regions in the human genome. to our knowledge, there is no exhaustive study examining the landscape of the structure stability of human introns using these probabilistic structural indicators. our analyses demonstrate the potential of parasor to accelerate large-scale structural analyses performed in silico.

RESULTS
parasor: a parallel solution for local rna secondary structure analysis
parasor is our novel software application to exactly compute various expected values such as stem probability  <cit>  and accessibility  from the boltzmann ensemble of global secondary structures, with the constraint of maximal base-pair span. we consider only the structures containing short-range base pairs, since it is well known that the energy model of the secondary structure is inaccurate for predicting distant base pairings  <cit> . the maximal span constraint limits the structure ensemble to the set of global secondary structures that contain only base pairs with spanning lengths ≤w. in ref.  <cit> , it is shown that the constraint of maximal span for the distance of base pairing can improve the accuracy of structure prediction. this constraint also reduces the computational complexity of structure prediction from o to o, as described in the background section.

parasor is the only tool developed to date that can make global structure predictions for long rnas . this high scalability of parasor is attained by the following two techniques:  solving numerical error problems by considering only the ratios of dynamic dp variables, and  allowing distributed computation for a computer cluster. owing to its memory- and disk-saving design, parasor is also useful for small-scale studies that use a single computer.
fig.  <dig> parasor overview illustration. a target sequence fragment is assigned to k computational nodes, and dαkh is stored in external memory in the divide procedure to solve the dependency problem that exists around the ends of a given fragment. in the connect procedure, exact local fold changes Δ
α are computed by the summation of dαkh for each pairing pattern at the left end of the assigned fragment. in the computation of expected values, a variety of measures are available using the dp variables whose magnitudes are bounded independently of n, such as u, Δ
α, and Δ
β




this database can be used repeatedly for the fast structure simulation of similar but different sequences, such as those with point mutations or incomplete rnas that appear during transcription elongation. parasor can also be applicable for the fast simulation of co-transcriptional splicing by using partial dp variables in the database that correspond to partially transcribed rnas.

concordance of parasor prediction with validated rfam structures and a high-throughput structure analysis
since parasor was developed for the structure prediction of long rna sequences, we tested its accuracy with the genome and mrna sequences, using validated structures from the rfam database  <cit>  and a high-throughput structure analysis  <cit> .

first, to evaluate the performance of structure prediction, we used cisreg data, which was compiled in ref.  <cit>  and contains high-quality sub-structures within long sequences. to construct the dataset, they searched the rfam database for structures annotated as cis-regulatory elements, and obtained  <dig>  structures, as well as the flanking mrna or genomic sequences of lengths up to  <dig>  nt on both sides. then, we predicted secondary structures for these whole rnas and compared them with known structures only within the region of target cis-regulatory elements. as for parasor, we used the γ-centroid structure with γ= <dig>  <cit> . since rnalfold  <cit>  does not predict a single consistent structure, we chose the longest non-overlapping structures for evaluation, and calculated the matthews correlation coefficient  between predicted and correct base pairs . figure 2a shows mcc scores of parasor for mrna and genome datasets, which are substantially higher than those of rnalfold. it indicates the efficiency of γ-centroid structure prediction for long rna sequences, as well as short rna sequences  <cit> , as they predict fewer false positives than the mfe-based method.
fig.  <dig> accuracy comparison of single structure prediction. a mcc scores describing the structure predictions of cis-regulatory elements in the cisreg genome and mrna dataset for the performance evaluation of parasor and rnalfold. b auc scores describing the predictions of structured positions of cis-regulatory elements in the cisreg genome and mrna dataset for stem probabilities of parasor and other tools



we also tested the accuracy of binary classification, which predicts whether each base is structural  or accessible , based on the stem probability for each position. this kind of problem is more meaningful when the input rna does not take a single stable structure. for the stem probability pstem computed by parasor localfold  <cit>  and rnaplfold  <cit> , we progressively changed a critical pstem threshold and classified each position as structured or accessible, depending on whether pstem was higher than the threshold or not. then, we evaluated these classifications with the rfam reference structure based on the area under the receiver characteristic operating curves  . figure 2b shows that the auc of parasor is higher than the other two tools for both the mrna and genome datasets.

in summary, parasor is comparable to or better than the state-of-the-art algorithms for the prediction of stable motif structures such as cis-regulatory elements in long rnas.

next, we investigated the congruence between computational predictions and high-throughput structure analysis, using pars data  <cit>  in the same way as cisreg. to compare pstem and pars data from human mrnas, we divided all nucleotide positions into two groups, accessible and structured, as determined by pars scores. aucs of three tools were then computed with a progressively changing pstem threshold for their classification. consequently, although all of the prediction methods showed a high consensus with the pars-based classification, parasor had an almost comparable auc score to localfold and rnaplfold ). in addition, when we compared the 32-nt average of pstem with the 32-nt average of pars scores, parasor showed a slightly higher auc than the other tools ). these results are important, as we extensively study the distribution of such averaged pstem in the later sections.
fig.  <dig> comparison of stem probabilities and pars scores. a auc scores describing the prediction of positions with high pars scores  by stem probabilities for parasor and other tools. b distribution of pars scores for accessible and structured regions with varying read-depth thresholds. each position was classified into accessible or structured depending on the stem probability of parasor  after filtering of the minimum read-depth. outliers are excluded from each tukey boxplot. c comparison of the average stem probabilities of parasor and the median of filtered pars scores among 5′-utr, cds, and 3′-utr categories



because pars scores with low-read depths are supposed to be less reliable, we set a threshold for the minimum read depth to filter out less reliable sites. for such a sample dataset, pars score distributions were obtained for two groups, accessible < <dig> ) and structured > <dig> ) regions according to parasor-based pstem. figure 3b shows that the pars scores are more consistent in structured regions as their median values increase with the strictness of the threshold, while pars scores fluctuate around zero in accessible regions, although they are consistent for a very strict threshold that requires ≥ <dig> read counts to designate a site. such filtering of low-depth regions actually increased overall aucs for prediction methods up to approximately  <dig>  .

since parasor has been developed to analyze genome-wide structure propensity, a consensus between parasor and pars data in terms of structure propensity analyses was also tested for three categories of transcript region, 5′-utr, 3′-utr, and cds. in ref.  <cit> , an average pars score was used to estimate the likelihood of being structured for each region, and it was concluded that 5′-utrs are less structured than 3′-utrs and cds. however, we found that the average pars scores are affected by a small number of outliers with extremely large pars scores. we therefore computed median pars scores after the read depth filtering, and compared them with the mean pstem for three categories . both scores consistently indicate that 5′-utrs have the highest stem density, whereas the stem density of cds regions is the lowest. this high stem density of 5′-utrs is mostly explained by their high gc content, as we show in the genome-wide propensity analysis later.

we have shown that the stem probabilities computed by the probabilistic folding methods such as parasor, rnaplfold, and localfold are highly consistent with the known structures of cis-regulatory elements and the pars data. they also attain aucs around  <dig> - <dig>  when ambiguous sites are removed from the pars data. the differences of auc scores among these programs are of the order of  <dig>  and thus very small for these datasets.

although parasor has similar accuracy to the other two tools, it is distinctly different from them, because it is a global folding method and the expected values such as stem probability and accessibility are computed from the boltzmann ensemble of globally consistent secondary structures, as in mccaskill’s algorithm and rnafold  <cit> . the difference between parasor and the latter two global folding algorithms is its scalability to handle long rnas; parasor can compute the structural properties of the longest pre-mrna in the human genome without any problem, whereas such computation is impossible for the other global algorithms, owing to the numerical errors and high time and space complexities.

in contrast to these global folding algorithms, rnaplfold and localfold average the probabilities that are computed from mutually inconsistent local rna structures on different sliding windows. although these sliding-window algorithms may capture the effects of structural obstacles such as bound proteins, introducing artificial boundaries at every sequence position may also cause artificial effects on the results. for example, it is known that accessibilities are artificially high close to the window boundaries  <cit> , and both the window ends tend to be paired with each other .

another difference between the sliding-window methods and the global folding methods is that the probability distributions they produce are markedly different. as shown in additional file 1: figure s <dig>  the distribution of parasor has bimodal peaks around probability  <dig> and  <dig>  while the distributions of the other tools are more even. furthermore, parasor has additional useful options that are not available in the other tools. for example, it can compute globally consistent γ-centroid structures, which are more accurate than mfe structures . the structural profile for each sequence position was also shown to be a very powerful means of understanding the complex structural specificities of rna-binding proteins  <cit> . we therefore conclude that parasor is currently the most suitable program to analyze the structural properties of a transcriptomic-scale dataset with high confidence.

prediction of structure profiles for human transcript
we performed positional structure propensity analyses for human mrnas and pre-mrnas using parasor. to extract the common properties of human transcripts, we computed μp, the positional profile of probabilities averaged across all human mrnas or pre-mrnas. figure 4a shows μpstem, the positional profile of stem probabilities around start codons, the 1st-3rd exon junctions, and the termination codon, which are computed from mrna sequences. we consistently observed many characteristics reported in previous experimental analyses, such as the sudden fall of stem density before start and termination codons, an increase within start codons, and 3-mer periodicity in coding regions  <cit> . the higher stem probabilities upstream of the first ss can be explained by the gc-rich regions, such as cpg islands, around the first exons .
fig.  <dig> structure profile of mrna and pre-mrna. a
μpstem around start codons , exon junctions , and stop codons . profiles of the first, second, and third exon junctions are drawn in black, green, and red, respectively. b log relative probability around donor sites  and acceptor sites  for bulge , exterior , hairpin , multi , and internal  loops, which are represented by orange, light green, purple, dark green, and blue lines, respectively. each position shows log/μ¯pδ) for the loop type δ. a  <dig> position indicates the starts of introns for donor sites, and the starts of exons for acceptor sites



next, we analyzed the positional specificity for structural profiles μpδ  computed from pre-mrna sequences. because the magnitude of μpδ strongly depends on the loop type, we averaged μpδ across the  <dig> nt surrounding each ss on both sides to compute μ¯pδ and normalize the differences among loop types. in fig. 4b, log/μ¯pδ) is plotted to show the specific increase of loop probabilities around the donor and acceptor sites. around donor sites, pbulge and pinternal increase at position 1– <dig> nt, consistently with the two μpstem peaks located at both sides of the donor sites . previously, several studies have reported the presence of conserved stable stem structures around donor sites  <cit> , and a stem-bulge structure upstream of the donor site is associated with the induction of rex protein binding in htlv- <dig>  <cit>  or the reduction of u <dig> snrnp binding in exon  <dig> of tau  <cit> . in contrast, the structural profiles around acceptor sites contain three separate peaks: phairpin at 3– <dig> nt upstream of the acceptor site, pmulti at 10– <dig> nt upstream of the acceptor site, and pexterior at 13– <dig> nt upstream of the acceptor site. these peak locations are roughly within the polypyrimidine tract, which is the known binding site for u2af and ptb  <cit> . in a previous study, the existence of loop structures was predicted to change the activity of the neighboring alternative acceptor sites in yeast  <cit> . accordingly, such preferences for loop types generated by sequential motifs may help optimize the binding efficiency of constitutive splicing factors. as these preferences for specific loop types around motif sites have not been investigated in previous studies, identifying them and the splicing activity of each site can reveal unknown loop preferences optimized for binding a particular splicing factor.

genome-wide simulation to detect structural constraints on transcribed regions
since the energy scale of secondary structure folding is high enough to influence the efficient progression of various biological processes, such as transcription elongation and translation, we expect many transcribed regions in the genome to be subject to various structural constraints. to study the structural preferences of transcribed regions relative to untranscribed regions, we computed the distributions of average stem probabilities p¯stem for 32-nt windows over both the strands of entire human chromosomes, and compared those of the different functional regions. this window size was chosen because it produced distributions that were close to the normal distribution for which statistical analyses are easier. also, p¯stem are expected to represent local structural features better than single-base stem probabilities .
fig.  <dig> structure propensity of genomic and transcriptomic regions. intergenic regions, intron, cds, 5′-utr, and 3′-utr are represented by black, green, blue, orange, and pink, respectively. a distributions of raw p¯stem for each annotation category. b distributions of normalized average stem probabilities Δp¯stem. c log ratios of densities log/f
intergenic), where f
t is the probability density of Δp¯stem at x for t=intron,5′-utr,cds,3′-utr. d is similar to , except that Δp¯stem was computed for the true boundaries of pre-mrnas



to extract a faint structural propensity of each transcribed region in Δp¯stem compared to intergenic regions, we plotted the log ratios log/fintergenic), where ft is the probability density of Δp¯stem at x for t=intron,5′-utr,cds,3′-utr . as for the cds regions, the density of this ratio is more concentrated around the center , which indicates that the structural strengths in the cds regions are more strongly determined by their base compositions than intergenic regions. additionally, introns and 3′-utrs contain a higher rate of structured regions than that of intergenic sequences, while 5′-utrs, 3′-utrs, and introns all exhibit lower rates of accessible regions. figure 5d is similar to fig. 5c, except that Δp¯stem was calculated for pre-mrnas, rather than for chromosomes. in this analysis, the distributions of introns, cds, and 3′-utr regions are qualitatively similar to those in fig. 5c. in contrast, 5′-utrs exhibit increased accessible regions in a wide range  as compared to that shown in fig. 5c, which is presumably because 5′-utrs are shorter and more proximal to the transcript boundaries than are other regions.

to estimate the statistical significance of structural preferences of each annotation category relative to intergenic regions, wilcoxon’s rank sum test was applied to the distribution of Δp¯stem for each annotation group, as well as their antisense sequences. figure  <dig> shows the z-scores of wilcoxon’s rank sum tests; a positive  value indicates the region contains a higher  ratio of structured regions than that of intergenic regions. we observed that the number of structured regions of introns is significantly higher than that of intergenic regions at a significance level of p<10− <dig> . in contrast, the antisense sequences of introns significantly contain more accessible positions than intergenic regions . antisense and sense sequences have the same gc content, but they can show a different strength of 4-mer normalization as well as p¯stem. hence, such a different tendency of sense and antisense sequences cannot be explained by systematic differences in gc content or other strand-symmetric sequence features between the intron and intergenic regions. additionally, 3′-utrs exhibit the same trend, but at a lower significance level . the 5′-utr sequences possess more accessible positions than do intergenic regions, which is consistent with fig. 5d. when pre-mrna and mrna are compared, we observe that the z-scores of cds change from positive to negative , while 5′-utrs and 3′-utrs do not exhibit notable changes. the increased accessibility after splicing in the part of cds regions suggests the existence of structural constraints in the particular mrnas for translational efficiency or resistance to degradation  <cit> .
fig.  <dig> 
z-score of structure propensity for each genomic annotation category relative to intergenic regions. wilcoxon’s rank sum tests were used to assess the structural preference of each genomic annotation category. a positive  y-axis value indicates the annotation category has a higher  stem density than that of intergenic regions. filled and shaded bars represent z-scores of sense and antisense sequences of each annotation, respectively



positional dependency for these structural preferences was examined by computing the z-scores for each 32-nt positional bin around the donor and acceptor sites in pre-mrnas using wilcoxon’s rank sum statistics . both sense and antisense strands exhibited a positive peak around the donor  and acceptor  sites. this pattern indicates structural constraints for splicing regulation  <cit> , which is not easily explained by primary sequence biases. inside exons, both sense and antisense z-scores approach zero as the distance from sss increases. in contrast, z-scores for the sense strand remain positive within introns , and those for the antisense strand become negative. as the z-score for each bin was independently computed, the entire range of introns appears to be subject to structural constraints.
fig.  <dig> positional profiles of structural preferences around splicing donor  and acceptor  sites. z-scores of wilcoxon’s rank sum statistics for the normalized average stem probability are drawn in black for sense and in red for antisense sequences. dotted lines represent z-scores that correspond to the bonferroni-corrected p-values  in a one-sided test



we note that a significant structural preference can be caused by only a small portion of transcribed regions, owing to the large degrees of freedom of the hypothesis tests. for example, our results suggest that the entire intronic regions are dispersed with small intronic elements that tend to be more structured as compared to controls, but this does not necessarily mean that the majority of introns forms highly stable structures. despite these technical intricacies, we confirmed the same stem preference of intronic regions by different normalization methods, such as regression using gc content instead of 4-mer frequencies and block-wise-shuffled genome sequences instead of intergenic regions as background . furthermore, we also found comparable results for the mouse genome, which implies that these trends are conserved among mammals .

conformational changes caused by splicing events
as described in the previous subsection, we investigated the structural preferences of transcribed regions by elaborate normalization procedures, such as masking repeat sequences, subtracting contributions from k-mer frequency bias by linear regression, and comparisons of functional regions with intergenic and antisense regions. in this subsection, we investigate the structural changes after splicing performed by directly computing the difference of stem probabilities between mrna and pre-mrna as Δqstem=pstem,mrna−pstem,pre-mrna for each exonic site upstream and downstream of sss individually. although this method cannot analyze intronic sequences, it has the advantage of constancy in the primary sequences for which stem probabilities are compared . figure  <dig> shows the positional z-scores of wilcoxon’s signed rank test for Δqstem of pstem averaged by a 32-nt sliding window, where a negative  z-score indicates that a nucleotide position changes to be more accessible  after splicing. both human and mouse analyses show that splicing causes a significant reduction in stem density within approximately  <dig> bases around the sss . we also showed a consistent tendency in the case of pstem using a single nucleotide window .
fig.  <dig> 
z-score for structural differences caused by splicing events around sss in human and mouse genomes. the difference of stem probability was averaged for a 32-mer sliding window separately for the upstream and downstream regions of sss. the dotted line represents a z-score of wilcoxon’s signed rank test that corresponds to a significant bonferroni-corrected p-value  in a one-sided test



to determine the gene features that are correlated with structural changes, we first computed the median and median absolute deviation of Δqstem computed for each single exonic site within the 200-nt window around each ss. then, we computed their correlation coefficients with the gene expression level, gc content of mrna and pre-mrna, and intron length . a highly significant correlation with structural changes was found for gene expression and mrna gc content. the magnitude of conformational changes also has a significant negative correlation with mrna gc content.
we tested statistical significance by pearson’s correlation test.  the total number of tested sss was  <dig>  for the features of gene expression correlation coefficient and  <dig>  for the other correlation coefficients



finally, we studied enriched functional terms in gene sets that contain the sss whose structure is dramatically changed through splicing events. we refer to the sites with the median of Δqstem < <dig> and Δqstem> <dig> as post-accessible and post-structural sites, respectively; then, we selected the top  <dig> % of post-accessible and post-structural sss. we used the david web tool  <cit>  for an enrichment analysis of these groups, and identified several gene clusters with common functional categories. table  <dig> shows the top three clusters for each test, where the expression analysis systematic explorer  score represents a significance measure for enrichment and corresponds to the negative log of the average p-value over the functional terms in a cluster. in the human genome, most post-accessible and post-structural genes are related to cytoskeleton and kinase, respectively, and the pattern is the same in the mouse genome. this may suggest that the genes associated with cytoskeleton, kinase, and other atp-binding proteins are often post-transcriptionally regulated by the changes to their secondary structures.


conformational changes of the mrna that encodes the f-actin binding proteinfig.  <dig> gene structure and conformational change of the nexn gene. a gene structure of the nexn gene. the gsds tool has been used for visualization  <cit> . b median difference of stem probability around each ss. the third ss shown with a red arrow is the most post-accessible ss among the genes in the cytoskeleton cluster. c partial γ-centroid structure of pre-mrna and mrna  around the third ss in the nexn gene. for visualization, we only extracted the region of the substructure enclosed by the outermost pair or exterior loops around the 3rd intron in pre-mrna and the 3rd exon junction in mrna



discussion
comparison between computational structure prediction and experimental structural analyses
the stem probabilities computed for human mrnas agreed well with a large-scale experimental structural analysis in terms of both global characteristics  and statistical correlations between the scores . although there are many reasons why computational folding fails to predict true secondary structures, most disagreement with experimental analyses currently seems to result from insufficient read depths. thus, we expect more agreement with experiments as sequencing coverage continues to increase. we have also shown that the concordance of the prediction tool can be significantly increased by selecting appropriate averaging-window sizes or energy parameters that are suited to the experimental design and other conditions. it may even be possible to study the effects of pseudoknots or 3d structures by looking at the differences between computational predictions and experimental data that cannot be eliminated by such optimization.

the influence of sequence biases on the analysis of structural constraints
a genome-wide comparison of thermodynamic structure stability would clarify the kinds of structural selection that act on the target regions. simultaneously, such an analysis needs to employ an appropriate normalization scheme to eliminate primary composition biases. for example, the high gc content of cds regions may lead to erroneous significance of selection pressure toward stable structures over the entire cds regions, because the stability of rna secondary structure is generally correlated with the gc content of a target sequence. although there are several proposed methods to normalize such sequence biases   <cit> , they are mostly cds-specific and could not be used in the present analysis. intronic sequences are also known to possess several sequence biases, including the asymmetry of a/t and g/c around sss  <cit> , which does not cancel out by simply normalizing gc contents. as there is no perfect method to accomplish the normalization, we have taken a very conservative approach; we masked repeat regions, removed the contribution of k-mer frequency bias using a regression model, and compared the regions of interest with the intergenic and antisense sequences. we have shown that the antisense sequences of introns are more different from the sense sequences than intergenic regions in terms of structural propensity, which implies that the analyses that use only antisense sequences as background would overestimate the selection pressure. to complement this elaborate normalization approach, we have also carried out direct comparison between the same regions of mrna and pre-mrna to evaluate structure propensity inside exons, as they trivially do not possess any difference in the sequence composition bias.

structure propensity of genome sequences beyond k-mer composition effects
we determined that the stem density within cds regions is better predicted by their sequence compositions  than are the stem densities of other regions, while introns and 3′-utrs contain a significantly larger number of regions with higher stem densities than expected . the strand-asymmetric preference for higher stem density persisted over entire intronic regions , which cannot merely be explained by k-mer compositions or strand-symmetric sequence features. such asymmetric preference is possible due to the strand-asymmetric pairing rules of the turner energy model and other asymmetric sequence characteristics; g-u base pairing is not conserved in the complementary sequence and the appearance of different pairing patterns in loop regions such as the change from aaa to uuu. in additional file 1: section  <dig> , we investigated the strand asymmetry of partition function and stem probabilities. they show a significant correlation between the strand asymmetry and the “gu” content of sequence . we have also shown two examples in additional file 1: figure s <dig> and s <dig>  in which strong stems in the sense strand are destabilized and decomposed into multi-loops in the antisense strand. the differences of folding energies between sense and antisense strands are also studied in ref.  <cit> .

as described previously, a significant structural preference can be caused by only a small portion of the transcribed regions, owing to the large degrees of freedom of the hypothesis tests. therefore, our results suggest that the entire intronic regions are dispersed with small intronic elements that tend to be more structured than intergenic and antisense sequences, but this does not necessarily mean that the entire regions of introns are highly structured. it should also be noted that we did not investigate the raw stem probabilities but the residual structural preferences remained after removing the sequence bias using linear regression. therefore, the obvious correlation between stem probability and local gc content is normalized before the main analysis. thus, the significant p-values supposedly reflect the intrinsic structural preferences beyond the obvious correlation between stem probability and local gc content.

one important future goal will be determining whether the known asymmetric mutation patterns in intronic regions  <cit>  can explain this asymmetric structural preference. it will also be interesting to study various biological causes of the higher stem density within introns. it may prevent stalling of polii , help splicing by shortening the physical distance between the donor and acceptor sites, or prohibit the splicing machine from accessing wrong acceptor sites.

a direct comparison of stem probabilities between mrna and pre-mrna showed a clear reduction in stem density around the sss . our analyses indicate that this reduction is significantly correlated with the strength of gene expression. together with the observation that sss exhibit a strong structural preference , these findings suggest that gene expression is mediated by the efficient use of secondary structures that disappear after pre-mrna splicing.

CONCLUSIONS
using our novel software “parasor” and k-mer regression method, we extracted structure profiles of human transcripts and inferred the genome-wide structure propensity beyond sequence composition biases. the structure profiles predicted by parasor showed a high concordance with rfam structures and high-throughput sequencing analyses. a genome-wide simulation using parasor indicated that a structure propensity of transcribed regions is strongly regressed by k-mer composition. by focusing on the residual part of such regression, intronic regions were shown to contain a significantly higher rate of structured regions compared to antisense and intergenic regions, not only around the ends of introns but also throughout entire regions. furthermore, a comparison between pre-mrnas and mrnas suggested that coding regions become more accessible after splicing, presumably because of biological constraints such as translational efficiency.

