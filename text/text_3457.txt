BACKGROUND
genetic association studies aim to detect associations between disease phenotypes and genetic variants. a commonly used tool to establish association between a snp and a disease is to perform statistical tests of association for each individual snp marker. a multiple testing correction can then be applied to control the overall type i error. however, such an approach typically captures only a small proportion of the contributing genetic variants. one likely reason is that common and complex diseases result from the joint effects of multiple loci and environmental factors, each of which has a small individual contribution  <cit> . a variety of tests have been proposed to establish the joint association of multiple snps with the phenotype.

for such joint association analyses, the first category of statistical methods are those that use single snp p-values or test statistics to construct a new joint test statistic. the most significant snp method  uses the smallest p-value to declare significance. fisher's method combines p-values by using negative of the twice of logarithm of product of p-values. another group of test statistics pools snps with relatively strong signals from univariate tests, which include the sum of the k largest test statistics  <cit> , the product of all the tests declared to be significant with some level α  <cit> , the product of the k most significant p-values   <cit> , and the weighted and truncated sum of logarithm of p-values  <cit> .

another category consists of strategies that modify the standard multivariate test statistics in order to reduce the effective degrees of freedom and hence improve the power  <cit> . evaluation of some of the methods is presented in  <cit> . some other methods use genetic similarity between individuals to establish multi-marker association in a genomic region with the phenotypes  <cit> . a comparison of the methods using the similarity measures and some additional references on multi-marker association tests can be found in  <cit> .

the above multi-marker association tests are useful to establish the joint association of a set of snps with the trait. but brute-force searches to identify the subsets of associated snps contained on high-density snp arrays are inefficient. gene annotation databases group functionally relevant genes into biological pathways. some of these pathways are likely to be involved in the etiology of complex diseases  <cit>  and hence testing a few hundred such pathways to identify the subsets of genes involved in the diseases avoids a huge multiple testing burden. thus pathway-based analyses can offer an attractive alternative to improve the power of gwas, and may help us to identify relevant subsets of genes in meaningful biological pathways underlying complex diseases.

in the era of post-gwas analysis there is considerable interest in pathway analysis, and several approaches for testing associations with pathways have been proposed. the kolmogorov-smirnov procedure is used to detect pathways containing a relatively high proportion of significant snps in  <cit>  or significant genes  <cit> . the snp ratio test  assesses association by comparing the proportion of significant snps within a pathway with those ratios in permuted data sets  <cit> . the prioritizing risk pathways  method defines a risk score to identify risk pathways by integrating genetic factors and biological networks  <cit> . combinations of univariate test statistics or univariate p-values for pathway association analysis is also considered in the literature. using the adaptive ranked truncated product  method  <cit>  for gene-level p-values, a pathway association method has been proposed  <cit> . the sum of the armitage trend test statistics of all of the snps within the pathway is used in  <cit> . accounting for the correlation among the snps within the pathway, three approaches for combining univariate test statistics have been recently proposed  <cit> . important factors for considerations in pathway analysis and a review of statistical methods for testing pathway associations are given in  <cit> ; some interesting insights into the pathway analysis using the existing data bases are summarized in  <cit> .

most of the pathway association methods consider all the genetic variants  within a pathway as possible risk factors  <cit> . if only a subset of genetic variants within a pathway has contribution to the disease then these methods may result in loss of power. to address this problem we propose a pathway-based analysis using a model selection criterion to identify a subset of associated genes within the pathway. in the proposed method, each gene is scored by the first principal component  of snp genotypes, which effectively reduces the number of genetic variants considered for a model and hence reduces the degrees of freedom for joint analysis. on the basis of fpc scores, the gene subset is selected using lasso penalized regression  <cit>  combined with some model selection criterion. the p-value of the joint test is calculated by permutation of disease status among affected and unaffected individuals. for the gwas pathway analysis, the false discovery rate  and the family-wise error rate  are applied to adjust for multiple testing.

methods
the joint analysis using reduced gene subset
consider a pathway g with k genes g <dig> ..., gk. let y denote the column vector of disease status for n individuals; the matrix x =  denotes genotype measurements on n independent individuals, where xj is the n by pj matrix of genotypes for pj snps within gene gj. the genotype measurements are coded as  <dig>   <dig> and  <dig>  which correspond to the homozygous genotype for the major allele, the heterozygous genotype and the homozygous for minor allele respectively. in the following, various steps of the proposed method are described and the flowchart of the joint analysis is presented in figure  <dig> 

gene-based score: the first principal component 
the first step is to calculate the gene-based scores for each of the k genes. it is well known that principal components analysis  is an effective way to reduce dimensionality, and the first principal component  explains the maximum variance among all linear combinations  <cit> . in addition, the power of univariate tests using the fpc is comparable to the power of multivariate tests using the first few principal components  <cit> . thus, it is feasible to consider the matrix of fpc of snp genotypes within each gene as the gene-based score. the gene-based score effectively reduces the number of possible factors from p=∑j=1kpj to k for pathway g, where p and k respectively denote the total number of snps and the total number of genes in g. when calculating fpcs, we choose to first center genotypes of each snp over n individuals by subtracting the mean value. when the data set contains considerable numbers of missing genotypes, the r package pcamethods  <cit>  can be used to calculate fpc scores.

the fpc-based test statistic using all genes
if all k genes are used in the joint analysis then the pathway g can be tested using the lr statistic of k genes, which is given by

 t=lr         =sup{p:β∈Θ}sup{p:β∈Θ0} 

where p is the density function of the phenotype given k fpc scores, the parameter space Θ = {β <dig>  β <dig> ..., βk} and Θ = {β0}. the p-value of the test statistic t can be approximated by χk <dig>  if only a subset out the k genes is truly associated with the disease then the multivariate test including all genes may result in a loss of power due to a large number of degrees of freedom . hence, we propose to perform the multivariate test using a reduced gene subset.

the fpc-based test statistic using the reduced gene subset
we perform the gene subset selection by first using the lasso method to generate a series of candidate subsets and then select the best subset. the lasso penalized log-likelihood function is given by

 logl=logl−nλ∑j=1k|βj|, 

where the vector β =  denotes regression coefficients of k gene-based scores, and logl is the log-likelihood function. when the tuning parameter λ is first set to be zero, the corresponding subset s <dig> contains all the k genes. the parameter λ is gradually increased from λ <dig> =  <dig> to λ <dig>  which is the smallest value to delete at least one gene from s <dig>  the subset produced by λ <dig> is denoted as s <dig>  by increasing the values of the parameter λ, the lasso method produces a series of non-empty subsets {s <dig>  s <dig> ..., sk'}. in general, there is a nesting among the subsets, although they are not strictly monotonic. from these subsets, we select the best subset as the reduced gene subset to carry out the joint analysis. the standard approach to select the best subset is to use cross-validation  or to optimize the quantity of the model selection criterion score such as the akaike's information criterion  or the bayesian information criterion . in the context of gwas, the computation burden of cv is large as compared with aic and bic. hence, we choose aic or bic as the gene subset selection criterion in our method. for subset sj , the aic score can be expressed by

 aic =−2logl)+2v, 

where logl) is the maximized log-likelihood function of sj, and v denotes the number of genes contained in sj. the bic score of sj is given by

 bic =−2logl)+logv, 

where n is the sample size. since the penalty function in bic, logv, is usually larger than the one in aic, 2ν, the subset selected by bic are usually contained within the subset selected by aic. denote the reduced subset selected by aic or bic by s* = {g,..., g}. the test statistic of pathway g using s* is defined as the lr test statistic of s*

 t=lr         =sup{p...fpc):β∈Θ}sup{p...fpc):β∈Θ0}, 

where Θ = {β <dig>  β,..,β}, Θ <dig> = {β0}, and fpc,..., fpc denote the fpc scores of genes g,..., g.

p-value, false discovery rate  and family-wise error rate 
although the nominal distribution of t can be approximated by χm <dig>  the p-value of pathway g can no longer be obtained directly from the chi-square distribution. therefore the p-value for pathway g is obtained using a permutation procedure that is based on the permutation of disease status among affected and unaffected individuals. note that the purpose here is not to test the association of the fixed set subset s*, but to test the association of pathway g using this reduced gene subset. hence we need to select the reduced subset in each permuted data set for computing the p-value of pathway g. in each permutation π, lasso is applied to generate a series of candidate subsets using the same procedure. under the null hypothesis, the test statistic in the permuted data set should have the same nominal distribution as the one in the original data . hence, the size of the selected subsets in permutation π is also restricted to m . denote the gene subset selected by lasso in the permutation π as s*. the test statistic of pathway g in π is given by

 t)=lr)=sup{p,β|fpc...fpc):β∈Θ}sup{p,β|fpc...fpc):β∈Θ0} 

where y  denotes disease status in permutation π, and fpc,..., fpc  denote the fpc scores of the m genes in s* . the p-value of pathway g is defined as

 p-value=# of permutations π with t)>t# of permutations π. 

for gwas, fdr and fwer are used to adjust for the multiple hypothesis testing. to be able to compare across several pathways, we first calculate the normalized lr test statistics denoted here as nlr and nlr). the nlr is written as

 nlr=t−mean))sd)). 

the fdr of pathway g is defined as

 fdr=# of permutations with nlr≥nlr# of all obeseved ag with nlr≥nlr 

where ag denotes any pathway in gwas. the fwer is defined as

 fwer=# of permutaions maxag{nlr}≥nlr# of permutations . 

simulation description
an extensive simulation study is conducted to compare the proposed joint analysis with the methods mss, rtp, the admixture maximization likelihood   <cit>  method. to mimic a gwas , we simulate genotypes for snps within associated pathways using a published gwas data set. to model the disease status based on multiple variants, the number of associated genetic variants and the estimates for relative risks are all obtained from this data set. in each simulated data set, we sample  <dig> affected and  <dig> unaffected individuals, which is similar to the sample size of the gwas study. in both the simulated and original gwas data sets, we map the snps to a gene if they are within  <dig> kb of the gene. for each set of parameters,  <dig> replicates are simulated. the power and type i error are derived as the proportion of replicates with p-values ≤ <dig> .

simulated pathways
to reflect the power of different methods to detect small, medium and large pathways, we choose three different pathway patterns in the simulations. the three pathways considered are "tnfr <dig> signaling pathway", "fructose and mannose metabolism" and "cytokine-cytokine receptor interaction"; called here as pathway patterns  <dig>   <dig> and  <dig> respectively. the pathways and the genes within them were constructed using two existing databases . the three pathways capture a wide spectrum of the constituent gene numbers and effect sizes  observed in gwas pathway analysis.

genetic variants associated with disease
we simulate both associated and non-associated genetic variants within the pathway with the assumption that not all the genetic variants in the pathway are disease associated. associated genes and snps are completely determined by gene-based and snp p-values in gwas analysis. first, based on the lr test with fpc, a list of associated genes  within the pathway is generated. for an associated gene, all the snps with p-values ≤  <dig>  are divided into several groups on the basis of the criterion that the snps within the same group are in strong linkage disequilibrium , i.e. r <dig> ≥  <dig> . in each group, we select the one with the smallest p-value as the causal snp. the minor allele frequencies  and estimated relative risks  of causal alleles are obtained from gwas study . in each underlying pathway pattern, the relative risks  of risk alleles are first equal to errs. to evaluate the performance of the association statistic under a spectrum of rrs, we then multiply each of the errs by a factor less than unity.

simulated genotypes and disease status
to retain the observed ld structure within the genes, the haplotype frequencies of the control samples in the gwas are estimated using plink  <cit> . for simulation, we generate a sample of haplotypes with probabilities proportional to the estimated haplotype frequencies. under the assumption of hardy-weinberg equilibrium , two haplotypes are selected at random to form a pair of unphased haplotypes for an individual. finally, the genotypes for snps are obtained by taking the corresponding alleles from the haplotype pairs. given the rrs and mafs, the disease status of an individual is inferred using a multiplicative relative risk model  <cit> . using this procedure we have generated  <dig> replicate data sets of  <dig> cases and  <dig> controls.

methods for comparison
let us denote our pathway association tests based on fpcs with gene subset selection using aic and bic criteria as fpc_aic and fpc_bic respectively; the method that uses all the genes for the pathway association without the model selection is denoted as fpc_full. the three methods mss, rtp and aml have been shown to perform well for detecting the association in comparison with some other existing methods  <cit> . to illustrate the benefit of the gene subset selection, we compare the methods fpc_aic and fpc_bic with fpc_full. the modified gsea algorithm  <cit>  is alternative method to carry out the pathway analysis in gwas. however, this method cannot be applied in a candidate pathway analysis since it needs gene p-values on the whole genome. hence, we do not include this method for comparison with other methods in simulation studies.

the test statistic of the mss method is the smallest p-value of single snp tests of all the snps in a pathway. the test statistic of the rtp method  <cit>  is the product of the smallest k p-values. in our simulation, we choose k =  <dig>  and k =  <dig> . the aml method supposes that snps detectable in the experiment have the same contribution to the disease and all genotyped snps are independent. under these assumptions, the em algorithm simultaneously estimates the proportion of associated snps α and their average effect ζ. the lr statistic is written as

 λ=∑j=1plog+α+exp2/2)/2+exp2/2)/2), 

where p is the total number of snps, zj denotes the square root of χ <dig> statistic at locus j. in mss, rtp and aml methods, the single snp p-values are based on the cochan-armitage trend test.

RESULTS
in this section we report the results in parts. the first part is a comparison of power for our proposed method relative to four other methods. in the second part, we evaluate the performance of gene subset selection and compare it with the gene selection approach based on corrected p-values. in the third part, our method is applied to the psoriasis gwas data from the collaborative association study of psoriasis   <cit>  to detect susceptibility pathways. this study is part of the genetic association information network  consortium. the data set consists of  <dig> k snps genotyped on  <dig> psoriasis cases and  <dig> controls. as part of our ongoing meta-analysis study, we have imputed additional snps on this data set. after the standard quality control filters for gwas  > <dig>  and hardy-weinberg equilibrium  p-value> 10- <dig>  relationship testing and outlier detections), we report our analysis based on  <dig>  snps in  <dig> cases and  <dig> controls.

power of joint analysis
the power of different methods under the three pathway patterns are shown in figures  <dig>   <dig> and  <dig>  the details of the power, the 95% confidence intervals of estimated probabilities and the p-value of mcnemar's test of difference in powers between fpc_bic and other methods are given in additional file  <dig>  tables s <dig>  s <dig> and s <dig>  for the pathway patterns  <dig> and  <dig> , the fpc_aic is slightly more powerful than fpc_bic; but it is less powerful than fpc_bic for the pathway pattern  <dig> . the possible reason is that fpc_aic tends to select too many genes when the percentage of non-associated genes is large.

fpc_aic or fpc_ bic outperformed other methods under all the  <dig> pathway patterns. the power of fpc_full is only slightly less than fpc_bic in pathway pattern  <dig>  as the number of non-associated genes increases in the pathway patterns  <dig> and  <dig>  the power of fpc_full decreases and it is less than fpc_aic or fpc_bic due to large degrees of freedom associated with this statistics. one advantage of fpc_full is fast computation, because its p-value can be approximated by a chi-square distribution. fpc_aic or fpc_bic performs much better than the aml and mss methods. the aml method assumes that all snps are independent and all causal snps have the same effects. under these two assumptions aml has been shown to have a good performance in  <cit> . however, if some snps are highly correlated with truly associated snps, then aml would overestimate the number of causal snps  <cit>  and may also reduce the effects of truly associated snps. mss may result in loss of power if there are many associated snps because it uses only the most significant snp to declare significance. although rtp had higher power than mss and aml, its power was still lower than fpc_aic or fpc_bic. the performance of the rtp method depends on the number of associated genes in the pathway  and hence pre-specification of number of snps to for this method is important  <cit> .

we evaluated the performance of the methods under a spectrum of rrs by multiplying each of the errs by a factor from  <dig>  to  <dig> . for example, under multiplicative model, the combined rr  for pattern  <dig> with  <dig> causal snps is  <dig> , but when the factor  <dig>  is multiplied to err , the combined rr drops to  <dig>   and results in reduction of powers for all the pathway association tests due to the factors like ld pattern of the genes, effect sizes and maf of the causal snps. note that the powers for all the methods are generally low for  <dig> *errs, but the performance of fpc_aic or fpc_bic was still the best. table  <dig> summarizes the type i error, 95% confidence interval for estimated probability and the p-value of mcnemar's test to compare the difference in type i errors between fpc_bic and other methods. all the methods had a type i error controlled around  <dig>  under all settings.

for each of the methods, we presented the type i error, the 95% confidence interval of all estimated probabilities, the p-value of mcnemar's test for the difference of type i error between fpc_bic and other methods. the type i error was calculated on the basis of  <dig> replicates at significance level  <dig> .

evaluation of gene subset identification
it is important to evaluate the performance of gene subset identification using our approach to understand the proportion of true and false positive genes in the selected subset of genes. apart from the aic and bic discussed above, we also consider the classical approach of identifying the gene subset by using the multiple test correction. under multiple testing , the p-value for each gene is obtained using the gene-score lr test and then it is corrected for the total number of genes tested under the bonferroni method. the subsets of associated genes using this procedure are those that had significant corrected p-values . the performance of the methods is examined by two measurements: positive selection rate  to describe the ability of the method to select the associated genes and false discovery rate  for the purity of the selection. psr is defined as

 psr=#  genes truly declared associated #  associated genes; 

fdr is defined as

 fdr=#  genes falsely declared associated #  genes declared associated. 

the fdr of a pathway defined earlier is slightly different from the fdr defined here. the former is described for real data analysis in which the truly associated genes are unknown whereas the above definition of fdr is for the simulation study in which all the associated genes are known.

the psr and fdr of the gene-test were much lower than those of aic under all the pathway patterns. in the pathway pattern  <dig>  there was little difference between the psr of the gene-test and that of bic. but, the psr of gene-test is lower than that of fpc_bic in the other two pathway patterns. it is likely that the bonfferoni correction becomes too conservative as the number of genes within pathway increases. the fdr of bic is higher than that of gene-test, but is still controlled at a reasonable level . these results showed that our method is more powerful than the gene-test for gene identification and has a comparable fdr when using bic as the selection criterion.

application to a published psoriasis gwas data set
psoriasis is a chronic inflammatory skin disease that is marked by a complex interplay of dendritic cells , t-cells, cytokines, and downstream transcription factors as part of a self-sustaining type  <dig> cytokine network  <cit> . here, we applied the proposed method in a published psoriasis gwas data set from the casp to identify susceptibility pathways and important genes. we mapped all  <dig>  snps to genes within the  <dig> kb upstream and downstream region. if the snps are mapped to multiple genes using this definition, we used a hierarchical mapping scheme  following  <cit> . the information on gene id, gene names, and their start and end positions on a chromosome was downloaded from the national center for biotechnology information 's genome database http://www.ncbi.nlm.nih.gov/genomes/. the quantile-quantile plot in the original study  <cit>  showed that signals in mhc are much stronger than those in non-mhc. hence, our analysis only considered non-mhc genes across the whole genome to aviod the bias arising from strong signals in the mhc. we generated  <dig> annotated pathways from kegg pathway database and  <dig> annotated pathways from biocarta pathway database by using database for annotation, visualization and integrated discovery   <cit> . we only examined the  <dig> pathways with at least  <dig> genes to avoid testing overly narrow pathways.

we applied the proposed methods fpc_aic, fpc_bic, gsea algorithm, and the aml to carry out the pathway-based analysis. table  <dig> summarizes the pathways detected by at least one method. the proposed method with the bic criterion detected  <dig> biologically plausible pathways for psoriasis . the detected pathways under the aic criteria were similar to the ones under the bic criteria  and these are also reported in previous studies  <cit> . although "nf-kb signaling pathway" reported in the original paper  <cit>  was not declared to be associated due to slightly high fwers , it had p-values less than  <dig>  and fdrs less than  <dig> . the methods fpc_aic or fpc_bic also identified important genes within the detected pathways . by comparing the total number of genes  with the number of genes identified by the proposed approach , it can be seen that our approach effectively identified a few associated genes within the pathway. at the same time, our analysis is able to identify nearly all of the genes reported by previous studies, such as il <dig>  stat <dig>  il23r, il12b, il23a, il <dig>  tnfaip <dig>  <cit> , and rad <dig>  <cit> . the findings demonstrate that the proposed method is a promising way to identify associated pathway and important genes in gwas.

all the p-values, false discovery rates  and family-wise error rates  were obtained via  <dig> permutations. gene p-value in pathway enrichment method was the p-value of the most significant snp within gene. the aml method was based on the test statistic of cochan-armitage trend test.

column "subset size"  presents the subset sizes selected by aic and bic, respectively. column "selected genes" presents the identified genes by aic and bic, where genes with underline denote the ones selected by both aic and bic, and genes with no underline denote the ones selected only by aic.

the modified gsea algorithm identified  <dig> pathways . although no common pathways were detected by both the fpc_aic or fpc_bic and the modified gsea algorithm, the p-values of pathways  <dig>   <dig> and  <dig> were less than  <dig>  for both of the two approaches. fpc_aic and fpc_bic were not able to identify pathways  <dig> and  <dig> partly due to the fact that no genes with significant p-values within these  <dig> pathways were found. the smallest gene p-values within pathways  <dig> and  <dig> are respectively  <dig>  and  <dig> . in the modified gsea algorithm, the enrichment score is constructed by using all of the genes within pathways, so the large percentage of non-associated genes will result in loss of power. although the modified gsea algorithm can highlight genes with extreme statistics of association by setting the parameter p >  <dig> in the enrichment score, the authors recommend using p =  <dig> <cit> . otherwise, the modified gsea algorithm suffers from the need to select the appropriate value for p. compared to gsea, the proposed approach with aic or bic would effectively increase the power to detect the association since the joint analysis is performed in a reduced gene subset. the aml method did not detect any pathway, but it also has p-values  <dig>  and  <dig>  for pathways  <dig> and  <dig>  in our ongoing meta-analysis including multiple cohorts, we find that some of the pathways identified by our analysis in gain are also replicated in other cohorts. complete meta pathway results will be reported later.

discussion
genes rather than snps are considered the basic units in our method, which is expected to reduce the degrees of freedom of the pathway test statistic. as part of our pathway association, we conducted gene-level association tests based on fpc scores using published psoriasis gwas data and compared the result with single snp analysis. besides the genes reported by in the original paper  <cit> , our gene-level analysis identified several additional genes . it is likely that, if a gene contains a number of snps with medium-size effects, the gene-based score combines their information and hence increases the effect size. hence, our proposed method using gene-based scores should increase the power to detect an association.

in the analysis of empirical data, the proposed method identified a number of biologically plausible pathways for psoriasis. the pathogenesis of psoriasis is characterized by skewed cytokine levels of pro-inflammatory and anti-inflammatory cytokines  <cit> . cytokines are the hormonal messengers responsible for most of the biological effects in the immune system. cytokines can be functionally divided into two groups: those that are pro-inflammatory and those that are essentially anti-inflammatory  <cit> . a subgroup of the t lymphocytes, also known as helper t cells, is regarded as being the most prolific cytokine producers. this subset can be further subdivided into th <dig> and th <dig>  and the cytokines they produce are known as th1-type cytokines and th2-type cytokines. th1-type cytokines  tend to produce the pro-inflammatory responses, while th2-type cytokines  have an anti-inflammatory response. thus, pathways "cytokine network" and "cytokine - cytokine receptor interaction" are relevant to the etiology of psoriasis. our results highlighted a possible role for dendritic cells in regulating th <dig> and th <dig> development. dcs are key sentinels of the immune system, bridging the gap between innate and adaptive immunity  <cit> . a facet of dcs is that these cells may have alternative differentiation pathways that stimulate differing t-cell subsets that typify th <dig> vs. th <dig> skin diseases  <cit> . collectively, cytokines like tnf-α and ifn-γ induce a wide variety of responses including: stat <dig> stimulation followed by expression of downstream response genes and nf-κ b signaling pathways seen in psoriatic lesions  <cit> . nf-κb activation regulates the transcription of other pro-inflammatory genes  <cit> . evidences suggest that brca <dig> part of the "role of brca <dig>  brca <dig> and atr in cancer susceptibility" pathway significantly enhances the ability of tnf-α or ifn-γ to activate transcription from the promoters of nf-κb target genes. together, this information suggests that brca <dig> may play a role in cell life-death decisions following cell stress by modulation of the activity of nf-κb  <cit> . thus, "jak-stat signaling pathway", "tnfr <dig> signaling pathway" and "role of brca <dig>  brca <dig> and atr in cancer susceptibility" are involved in the regulation of cellular responses to cytokines with the aim to providing an insight to the molecular mechanism involved in psoriasis.

in our analysis we compared results from the proposed method to that of the gsea method, since both of the two methods consider genes as basic genetic variants. we also note that there are other existing pathway-based methods for gwas  <cit> . however, most of these methods are taking snps as basic genetic variants in the analysis, so we did not choose them as methods for comparison. our annotation of snps to genes is based on  <dig> kb window size around the gene. there are several options for annotation of snps to gene such as  <dig> kb,  <dig> kb, and even  <dig> kb  <cit>  window sizes around the gene but we used only  <dig> kb window size because a large window size would result in too many overlapping genes. the first principal component of snp genotypes is used to capture the information in a gene, which is reasonable but not necessary. many alternative ways are feasible, such as the most significant snp test statistic used in the gsea method  <cit> , the first few principal components discussed in  <cit> .

we have also performed several diagnostic tests to examine the proposed pathway approach. first to find out whether our defined gene-based score is affected by the length of the associated genes, we performed welch's t-test to compare the mean numbers of snps in the "associated" genes  vs those in "non-associated" genes . the mean numbers of snps in the "associated" and "non-associated" genes are  <dig>  and  <dig> , respectively; combined estimate of standard deviation of two samples is  <dig> ; the p-value for the test of equality of the mean gene lengths is  <dig> ; 95% confidence interval for the mean difference is . this result shows that gene-based test using fpc is not biased due to the number of snps in the genes. second, we have only used the first principal component of snp genotypes to capture the information in a gene, which is may not account for all the variation within the gene. to assess whether the fpc captures all the information within the genes, we performed an alternative gene-level analysis by using the first two principal components. the lr test was done for each of the two principal and the smallest p-value as is taken as the gene-level p-value. we compared the top  <dig> genes in these two gene-level analyses and found that the fpc did not detect only  <dig> genes detected by the first two principal components. this findings show that fpc contains most of the information across multiple snps within the same gene. hence, it is feasible to consider the fpc as the gene-based score to represent genes without increasing the multiple test burdens with many principal components  <cit> .

in the proposed permutation procedure, the size of the gene subset is kept to be the same as the one in the original analysis . this guarantees the lr test statistics of the original data and permuted data to have the same nominal distribution  under the null hypothesis. if the size of gene subset is re-computed in permutation π ), the corresponding lr test statistic approximately follows χm <dig> under the null hypothesis. when m is not equal to m, the test statistics in original data and in the permuted data will not follow the same nominal distribution and hence it is difficult to compare both of them. as discussed in  <cit> , one disadvantage of the permutation procedure is that the test statistic may not follow the overall mean and standard deviation. to overcome this problem a restandardization procedure was proposed by combining the randomization with the permutation procedure  <cit> . currently, we are extending this idea to work on a novel procedure for the calculation of p-values. however, it is beyond the scope of this article.

the method proposed here can be extended in several ways. for example, we have considered only the disease trait  but this can easily be extended to quantitative traits as well. this approach can also be used to perform whole genome prioritized analysis such as the snps in the transcription factor binding sites. association through copy number variants  and meta-analysis can also performed under this framework. to relieve the multiple testing burdens, our pathway analysis uses available knowledge on annotated biological pathways. as a result, it is important that these annotated pathways are well supported by data to avoid false positive findings.

CONCLUSIONS
in this paper, we proposed a pathway-based approach to examine the joint effects of a biological pathway through jointly testing the reduced gene subset. apart from identifying susceptibility pathways, our method also provides a solution to detect important genes using gene selection criteria. the simulation results show that our method effectively increased the power to detect the associated pathways compared to a number of widely used approaches. in the gwas of psoriasis in gain population, our method using the aic criterion identified  <dig> biologically plausible pathways and several important genes for psoriasis. the findings demonstrate that our proposed method is a promising way to discover susceptibility pathways and identify important genes in gwas.

authors' contributions
conceived and designed the experiments: at and jz. performed the gene annotation: sg. analyzed the data: jz, sg, ms and jl. wrote the paper: jz. made the major edits: at, sg, jl and ms. all of the authors read and approved the manuscript.

supplementary material
additional file 1
additional tables s <dig>  s <dig>  s <dig> listing the power of different methods. tables s <dig>  s <dig> and s <dig> respectively summarizes the powers of different methods for three pathways "tnfr <dig> signaling pathway", "fructose and mannose metabolism" and cytokine-cytokine receptor interaction" in simulation studies.

click here for file

 additional file 2
additional table s <dig> listing the top  <dig> associated genes in gain data set. table s <dig> lists the top  <dig> genes associated in psoriasis gain data set by using the fpc-based gene level test.

click here for file

 acknowledgements
we gratefully acknowledge the collaborative association study of psoriasis . the genotype and phenotype data used in this manuscript were obtained from the genetic association information network  database, through dbgap accession number phs <dig> v <dig> p <dig> 
