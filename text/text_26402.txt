BACKGROUND
ecological diversification is responsible for the adaptive radiation of several groups of organisms that are not separated geographically but segregate in alternative habitats or ecological niches  <cit> . the evolutionary process by which ecological diversification drives species formation, known as ecological speciation, involves the establishment of barriers to gene flow through ecologically-based divergent selection  <cit> . interbreeding between populations that have ecologically diverged, by either niche specialization or invasion of a new niche, produces hybrid individuals of lower fitness in each of the parental habitats. ecological speciation theory predicts that reproductive isolation is environment-dependent, i.e. it is driven by ecological selective forces such as resource competition or predation, instead of genetic mechanisms producing hybrid sterility or inviability. the strength of reproductive isolation is correlated with the degree of ecological divergence, rather than time since lineage splitting. convincing evidence exists for the role of ecological speciation in nature, across a disparate range of taxa from angiosperms to insects and vertebrates  <cit> .

past and ongoing radiation of some members of the anopheles gambiae sensu lato  complex is considered to reflect different stages of the ecological speciation process, in particular with respect to divergence of the larval aquatic habitat  <cit> . this complex of african mosquitoes comprises seven recognized isomorphic species distinguished in most cases by fixed chromosomal paracentric inversions, and often by different larval breeding habitats  <cit> . the significance of the complex for evolutionary biologists is compounded by its tremendous importance for human health: this complex contains two of the most important afrotropical vectors of malaria, a pathology that kills about two million children below the age of five each year in sub-saharan africa alone  <cit> . the two main culprits of this extremely efficient vectorial system are the nominal species an. gambiae sensu stricto , and its sibling an. arabiensis, which occur in sympatry across much of their geographical distribution  <cit> . reproductive isolation between an. gambiae s.s. and an. arabiensis is expressed both at the pre-zygotic and post-zygotic level. laboratory colonies of the two species can be induced to mate and produce viable hybrid progeny, but males have atrophied testes, hence only females are fertile  <cit> . in nature, adult hybrids are found at an average frequency of  <dig> – <dig> %  <cit> , and heterogamic matings are rare . the occurrence of viable and fertile female hybrids can lead to introgression of genetic material between the two species  <cit> . despite this semi-permeable nature of the species boundary  <cit> , an. gambiae s.s. and an. arabiensis maintain many distinct genetic and bionomical features and are taxonomically considered good species under most species concepts.

ongoing lineage splitting within the nominal species an. gambiae s.s.  has led to the recognition of "molecular forms" m and s  <cit> , which share many characteristics compatible with ecological speciation. despite the lack of reproductive isolation in captive laboratory strains  <cit> , a significant pre-mating barrier  prevents extensive hybridization in natural populations  <cit> . the rarity of interbreeding can be explained at least in part by the occurrence of mostly homogamous mating swarms  <cit> . hybrids are fully fertile and viable  <cit> , and although rarely found in natural populations  <cit>  , they can account for the high estimates of gene flow and the dearth of significant genetic differentiation between forms inferred from genome-wide scans of natural populations  <cit> . however, two small unlinked centromere-proximal regions of the genome show high levels of divergence across west and central africa where m and s populations occur in sympatry  <cit> . the centromere-proximal location protects both regions from recombination in the face of gene flow between m and s, but the patterns of sequence variation are not consistent with reduced recombination acting alone  <cit> . divergent natural selection aided by reduced recombination in these regions is what nominates them as "speciation islands" that are expected to harbour the genes responsible for emerging ecological and reproductive divergence  <cit> .

despite compelling evidence for the existence of significant if incomplete reproductive isolation between the m and s forms, the mechanistic basis for their reproductive isolation remains completely unknown at both genetic and ecological levels. moreover, while the application of high throughput genomic technologies has led to relatively rapid progress in locating regions of major genetic distinction between m and s forms, comparable amounts of ecological evidence concerning the sources of divergent selection have not been forthcoming. in the arid savannas of mali and burkina faso in west africa, evidence collected prior to the recognition of the m and s molecular forms supported some degree of spatial and temporal segregation between taxonomic units known as "chromosomal forms"  <cit> . the chromosomal forms, defined based on configurations of shared polymorphic chromosomal inversions, correspond imperfectly or not at all with the an. gambiae molecular forms  <cit> , now considered to be the relevant taxonomic units. accordingly, much of the bionomics of an. gambiae ecotypes needs to be revisited in the context of molecular forms. in much of west and central africa, the m and s forms occur in the same villages, sharing the same resources such as hosts, adult resting sites, and freshwater larval breeding sites. at a microgeographic scale, the aquatic larvae of an. gambiae and an. arabiensis, and of the two molecular forms of an. gambiae, have been found at times to segregate in different breeding sites  <cit> , though the ecological factors modulating larval niche partitioning remain unclear  <cit> . habitat segregation of larvae of the two molecular forms has sometimes been associated with the nature of the breeding site. in burkina faso, larvae of the m form are more prevalent in larger anthropogenic longer-lasting habitats such as artificial lakes and rice fields, whereas the s form predominates in rain-dependent smaller ephemeral habitats such as puddles and road ruts  <cit> . habitat-dependent fitness traits have been attributed to larval predation and inter-form competition  <cit> .

spatial scale is an important ecological factor structuring communities and populations . because geography has an impact not only on the likelihood of gene flow but also on the ecological sources of divergent selection  <cit> , habitat segregation between m and s should be studied also at larger spatial scales. across the african continent, knowledge of the geographical distribution of the molecular forms is sparse. della torre and colleagues reviewed existing data on the occurrence and chromosomal make-up of molecular forms across africa and its offshore islands, and showed that both are present in all major biomes and geographic areas, except for the absence of m east of the rift valley  <cit>  . however, a higher-resolution, systematic analysis of the distribution and relative abundance of m and s over large spatial ranges is still lacking: are the two molecular forms equally abundant across major eco-climatic regions, or do they segregate at this eco-geographical scale? how does the present geographical distribution relate to the ecological factors driving the speciation process? can we expect hybridization and gene flow between m and s to be frequency-dependent across their range, in accordance with their geographic distribution?

according to the general tenets of ecological speciation, several predictions can be put forward concerning the ecological divergence of the siblings and incipient species of the an. gambiae complex. first, it can be predicted that in the course of their radiation all the three taxa should have diverged ecologically to some extent. second, from the positive association between the strength of ecological divergence and reproductive isolation found in other taxa, it is expected that the ecological niche of the two molecular forms of an. gambiae should have diverged less than that of an. gambiae and an. arabiensis. third, since the molecular forms of an. gambiae represent a more recent realization of an ongoing speciation process, with the m-form likely being most recently derived  <cit> , we predict that the m-form should occur in more marginal habitats than the other two taxa, in accordance with a process of niche expansion from the original, optimal habitat .

in this and the companion paper by simard and colleagues  <cit> , we present the results of two countrywide surveys of an. gambiae m, s and an. arabiensis carried out in burkina faso  and cameroon  designed to test these predictions with a biogeographic approach  <cit>  based on ecological niche modelling  <cit> . the patterns emerging from these studies help elucidate the role that ecology and geography play in ongoing speciation between the molecular forms of an. gambiae. specifically, we asked the following five questions:  do the three cryptic taxa segregate ecologically at a countrywide spatial range, and to what extent does their habitat overlap?  what eco-geographical predictors characterize the fundamental ecological niche of the three taxa, and which key ecological factors discriminate among them?  does the extent of habitat segregation correlate positively with the degree of reproductive isolation?  does the m form occur in more marginal habitats than the s form?  do chromosomal inversions play a role in the ecological segregation of the molecular forms of an. gambiae? to answer these questions, we implemented an empirical approach to distribution modelling using two spatially explicit statistical methods. first, to identify the ecological forces at work in the speciation process, we performed an ecological niche factor analysis  <cit>  to infer both the eco-geographical factors delimiting the fundamental ecological niche of a focal species and the potential habitat suitability across the entire study area. second, to explore the extent of realized geographical segregation and habitat overlap, we employed geostatistical methods to construct kriged surfaces of the relative abundance of the three cryptic taxa. by comparing the extent of realized versus potential occurrence and abundance of the three taxa in relation to predicted habitat quality, we tested whether the distribution of m  is consistent with a process of niche expansion into a habitat of marginal quality. finally, we compared the degree of association between chromosomal variants and environmental predictors by multivariate ordination techniques to characterize the ecological niche of the different karyotypes observed in our study area, and verify whether chromosomal inversions play a role in the ecological segregation of the molecular taxa of an. gambiae.

the parallel approach in burkina faso and cameroon was prompted by the dramatic distinctions between these countries, both in the extent of eco-geographical diversity and the level of chromosomal inversion polymorphism observed in the molecular taxa: cameroon covers a wide range of biomes including the equatorial rainforest, and the mesic to xeric savannas of central africa, while burkina faso lies in the arid sudanese savanna belt of west africa. chromosomally, the forest populations are largely monomorphic standard, whereas savanna populations are highly polymorphic  <cit> . we expected that this comparative approach would be revealing about the forces driving ecological speciation, in light of the long-hypothesized relationship between chromosomal inversions, ecological adaptation, and speciation in an. gambiae. in this paper we present the results of the burkina faso survey; those of the cameroon survey are presented in the companion paper  <cit> .

methods
study area and sampling plan
a countrywide survey in burkina faso was performed across an area spanning lat 9°45'n–14°40'n and long 5°30'w–1°45'e . in burkina faso, annual rainfall and the duration of the rainy season vary following a latitudinal gradient: in the northernmost regions, rainfall does not exceed  <dig> mm during 2– <dig> months; in the southernmost regions rainfall can be as high as  <dig> mm during 4– <dig> months. population size and relative frequencies of an. arabiensis and molecular forms of an. gambiae vary seasonally according to the distribution of rains  <cit> . to maximise the chance of sampling all three taxa from each location across the country, the mosquito survey began in the north at the peak of the rainy season  and continued until the end of the rainy season in the south .

a stratified random sampling scheme was adopted with the objective of selecting sites  that were representative of the eco-geographical diversity of burkina faso and also accessible during the rainy season. this was achieved by defining three transects covering the full diversity of eco-climatic regions and landscapes present in the country, following the major network of roads. in total, three hundred villages were chosen for sampling  from the national topographic database  of the institute of geography of burkina faso , an electronic georeferenced database of all populated places published in  <dig> by igb. these villages were chosen at random, based on a grid of  <dig> ×  <dig> km cells superimposed on other topographical layers in a geographical information system . for each transect, a buffer zone of  <dig> km on each side was selected and a number of cells proportional to the length of each transect was randomly chosen. one village per cell was then selected at random from the list of villages available within the chosen cells.

entomological survey
freshly-fed female an. gambiae s.l. were collected in the morning while resting inside human dwellings by manual aspiration with the aid of electrical aspirators. mosquitoes were kept in small cages wrapped in wet towels and stored inside cool boxes. additionally, indoor insecticide space-sprays were carried out in the early afternoon. collected mosquitoes were morphologically identified in the field under a dissecting microscope. ovaries of an. gambiae s.l. females at the appropriate stage for polytene chromosome analysis were immediately cropped and placed in a fixative agent  contained within individual  <dig> -ml reaction microtubes labelled with a unique serial number. the remaining carcass was placed in an identically numbered individual  <dig> -ml microtube containing a desiccant . ovaries were stored at -20°c, and carcasses maintained at ambient temperature before further processing. mosquito dna was extracted from the carcass and identified to species and molecular form using rdna-based pcr assays  <cit> . the corresponding ovaries were prepared for karyotype analysis according to standard procedures  <cit> . the banding pattern was observed under a phase-contrast microscope  and interpreted with reference to the chromosomal map and nomenclature of coluzzi and colleagues  <cit> .

geostatistical analysis
geostatistical interpolators were used to construct surfaces of the distribution and relative abundance of members of the an. gambiae s.l. complex at unsampled locations. two response variables were modelled:  the relative frequency of an. arabiensis vs. an. gambiae s.s. and  the relative frequency of molecular form m vs. s. spatial modelling was performed in the geostatistics module of arcgis® v.  <dig>   by fitting an anisotropic spherical function of the arcsine-transformed response variable to the semivariogram. interpolation was then carried out by universal kriging.

association analysis
to investigate patterns of co-occurrence among taxa at the countrywide level, we calculated the degree of similarity in the occurrence of species pairs across locations by the v association coefficient  <cit> . this index is based on the frequency of joint presences and absences by two species in a two-by-two contingency table. the coefficient ranges from - <dig> to + <dig>  the sign of the coefficient denoting whether the species co-occur more  or less  than expected at random  under given species frequencies. the index is called the point correlation coefficient, because it is equal to the pearson correlation coefficient between two species when the values of one and zero are used to denote their presence or absence, respectively. to assess the statistical significance of the index , we calculated 95% confidence intervals by bootstrapping the v values by location over  <dig>  replicates.

ecological niche factor analysis 
static species distribution models  make predictions about the probability of occurrence and geographical distribution of a focal species by extrapolating to a larger spatial extent the association between the environment and the focal species found at a certain number of sample locations  <cit> . the enfa is a multivariate sdm technique based on the concept of ecological niche as a n-dimensional hypervolume in a hyperspace of n resource axes  <cit> . the enfa extracts n uncorrelated factors, constructed as linear combinations of the n resource axes, explaining the major part of the environmental distribution of a focal species. the first factor is the marginality, describing how far is the optimum for the focal species from the mean environmental profile of a reference set . a global marginality value ≥ <dig> means that the species lives in a particular habitat relative to the distribution of habitats available in the reference set. the second and subsequent factors represent the specialization  or tolerance  factors. they are sorted in decreasing amounts of explained variance, and describe how specialized is the focal species with respect to the range of environments available in the study area. a randomly chosen set of cells is expected to have a global specialization value of one, with values > <dig> indicating some form of specialization. a univariate interpretation of the enfa, and a detailed description of its principles and operation are given in  <cit> . the strength of the enfa is that it uses only the presence data of a focal species. in distinction to alternative sdm techniques, absence from a location is considered uninformative rather than indicative of habitat unsuitability.

our study area was rasterized in spatial units of 1-km isometric cells. the entomological data and the eco-geographical variables characterizing the environment were related to each spatial unit and entered into a gis database in arcgis® v.  <dig> . after performing the enfa, a habitat suitability index , ranging continuously from zero to one, was calculated for each cell with the software biomapper v. <dig>   <cit> . then, following hirzel and colleagues  <cit> , habitat suitability  maps were plotted using four classes of habitat suitability that were defined from the predicted-to-expected  ratio of habitat suitability based on the continuous boyce index evaluator statistic  <cit> :  unsuitable habitat, where no presence of the focal species is predicted ;  marginal habitat, where presence is predicted at a frequency less than expected by chance alone ;  suitable habitat, where presence is predicted at a frequency higher than expected by chance alone; and  optimal habitat, separated from suitable habitat by the steep rate of change of the p/e ratio at the higher end of the spectrum of habitat suitability.

eco-geographical predictors
we selected fifteen eco-geographical variables , belonging to three classes: climate , topography , and land use  . the climatic variables were retrieved from the meteorological database of the network of weather stations of burkina faso managed by the agency for the safety of aerial navigation in africa and madagascar . topographic and land use variables were extracted from the bndt. the quantitative climatic variables and three topographic variables  were post-processed to extrapolate the mean value of each spatial unit cell by interpolation and rasterization. most egvs were normalized according to the box-cox algorithm prior to analysis. the boolean variables classifying the occupancy of soil of individual cells by categories of land use were post-processed to render them quantitative: a buffer zone of  <dig> km radius around the focal cell was drawn and the relative frequency of  <dig> ×  <dig> km cells within the buffer zone belonging to the category of land use under consideration was calculated. the frequency was then normalized by the arcsine transformation prior to analysis. the size of the buffer zone was guided by the average dispersal distance that can be covered by an. gambiae complex mosquitoes in our study area  <cit> . quantitative information was extracted from the three vectorial geographical features , by calculating the minimum distance from the focal cell to each of these features.

characteristics of the environmental descriptors used in the ecological niche factor analysis.

evaluation of habitat suitability models
accuracy and robustness of the habitat suitability models was assessed using a 10-fold cross-validation procedure implemented in biomapper. we used the mean and standard deviation as measures of, respectively, central tendency  and dispersion  of evaluator statistics. evaluator statistics of presence-only sdms like the enfa are the absolute validation index , the contrast validation index , and the continuous boyce index  <cit> . the avi is calculated as the proportion of presence points falling in cells having a threshold habitat suitability index . the cvi is the avi minus the avi of a random model, i.e. one that predicts presence everywhere. both statistics suffer from the choice of an arbitrary threshold. to overcome this limitation, the continuous boyce index bcont is calculated as the spearman correlation coefficient between the ratio of the predicted over expected frequency of evaluation points, iterated across the range of hsi values over a sliding window of  <dig> hsi units, and the habitat suitability index. further details about the calculation, use, and properties of the boyce index, are given in  <cit>  and the companion paper of simard et al.  <cit> .

niche breadth and overlap
to compare patterns of similarity, breadth, and overlap of the fundamental and realized ecological niches of each taxon, we adopted two approaches. first, a multivariate discriminant analysis was performed to isolate the environmental ordination axis along which each pair of forms/species was maximally differentiated. statistics of niche overlap and related measures  were then calculated on this factor, as in  <cit> . this analysis was performed in biomapper v. <dig> . in addition, the same statistics were calculated from the dataset of location samples.

chromosomal polymorphism and population structure
we implemented a bayesian multilocus genetic clustering approach using the software structure v. <dig>   <cit> . structure calculates an estimate of ln , representing the probability of obtaining the observed genetic data x conditional on the presence of k populations , with k unknown a priori. we adopted the "admixture" model, as its assumption of correlated allele frequencies between populations conformed best to our biological system, given residual gene flow between molecular forms and linkage between some chromosomal inversions. a series of five independent runs were performed for each k from  <dig> to  <dig>  setting  <dig>  and  <dig>  as burn-in and run numbers . the probability of each individual to belong to one of the k populations was plotted for the most likely value of k. the analyses were at first performed without prior assignment of individuals to molecular or chromosomal form to verify the degree of consistency in the classification of karyotypes by the three different approaches/markers. the analyses were then repeated with prior assignment of karyotypes to molecular form to assess the probability of admixture of each individual.

for the purpose of analysis, inverted and standard arrangements were treated as alternative alleles of a bi-allelic locus. however, because the 2rd and 2ru inversions overlap, we considered that they constituted a three-allelic locus. moreover, some inversions have closely linked breakpoints producing extreme cases of linkage disequilibrium; thus, we repeated the analysis by grouping inversions in four 'inversion systems': 2rj/+, 2rb/bc/+, 2rd/u/+ and 2la/+. results of the two analytical approaches were concordant; here we present only those of the former approach.

ecological niche of chromosomal variants
the association between inversion polymorphism and environmental variables in each molecular form at each sampled location was investigated by multivariate ordination with the software canoco v.  <dig>   <cit> . the karyotypes recorded at each sampled location were plotted in ordination space by detrended correspondence analysis , with environmental variables passively plotted to interpret the general relationship between karyotypes and egvs. this analytical procedure does not take into account the geographical structure of the data, hence results depend upon the underlying spatial and temporal distribution of the egvs.

to extract eco-geographical predictors to be used in the dca, raster maps of the transformed egvs used for the enfa were translated into vector format and overlaid on a layer containing the sampled locations in arcgis v. <dig> . the value of each egv at every sampled location was extracted and saved in a separate layer. all layers were subsequently collapsed in a single table containing information relative to all the egvs for each sampled location. several additional egvs extracted from the bndt were included in this analysis:  the distance from major water bodies, including large artificial or natural water reservoirs , areas of extensive rice cultivation, and areas amenable to flooding;  the vegetation zone as defined by landscape-level physiognomic and floristic associations . the four main zones present in burkina faso, i.e. northern sahelian, southern sahelian, northern sudanese, and southern sudanese, typically characterize a cline from more to less xeric habitats, respectively;  the habitat suitability for either m or s classified as optimal, suitable, marginal, or unsuitable ;  the relative frequency of 'competitors' for a focal taxon .

in the tabular input for canoco analyses, "samples" were the individual locations, and "species" were the individual karyotypes recorded on the 2r chromosomal arm of each molecular form. the karyotype at chromosomal arm 2r of each individual was scored as a series of five digits, after  <cit> . each digit represented one of five polymorphic inversions common in our study area , and could assume a value of "0", "1" or "2". the value "0" indicated the standard homokaryotype, "1" the heterokaryotype, and "2" the inverted homokaryotype with respect to each inversion. inversion 2la on the left arm of chromosome  <dig> was not considered in the analyses because it was nearly fixed  across the study area. due to the limited number of specimens collected in each sampled location, the "species" table contained many zero values. to avoid biases due to the sparseness of the table, we implemented a square root transformation and downweighted rare 'species'  by assigning a weight to each karyotype prior to analysis.

RESULTS
mosquito identification
collections in most villages yielded our target of twenty dissected female an. gambiae s.l.. overall,  <dig>  specimens were molecularly identified out of  <dig>  that were processed. of the identified specimens, most were an. gambiae molecular form s , followed by the m form  and an. arabiensis . we found one an. gambiae-an. arabiensis hybrid, and  <dig> m-s hybrids, representing  <dig> % and  <dig> %, respectively, of all identified specimens. unless indicated otherwise, the hybrids were omitted from further analyses.

geographical distribution
the relative frequency of the three taxa across the sampled locations is presented in figure  <dig>  the distribution of m and s followed a clear geographical pattern: the m form dominated in the northernmost arid zones; the s form was generally most abundant in the moister southern regions. an. arabiensis was more prevalent in the northwest and in the central plateau – between 11°30'n and 13°30'n – decreasing in abundance when moving away from this area.

the interpolated relative frequencies of an. arabiensis vs. an. gambiae  and m vs. s form  quantified the patterns observed in figure  <dig>  in contrast to expectation based on its continental distribution, an. arabiensis was not most abundant in the arid sahelian savanna in the north. rather, this species did not predominate in any region, except perhaps for a small patch  in the north-west around the town of ouahigouya . perhaps even more interestingly, this species remained at intermediate levels of relative abundance across much of the central and southern region occupied largely by the catch basin of the river nakambé . this is the most densely populated area in burkina faso, where anthropogenic modifications and population pressure on the natural environment are at their highest.

the two molecular forms were distributed according to opposite latitudinal clines , with m dominating  in the north , and s in the south . the reversal in frequency between the two forms was rather abrupt between 12°n and 13°n latitude , with the exception of an area of approx.  <dig> km radius between the towns of koudougou  and yako . although the two forms actually co-existed in sympatry across most, if not all, of the study area, the rather steep transition of relative abundance was not matched by equally steep changes of environmental features across the 'boundary' , suggesting that this distribution pattern may have resulted not only from the underlying response of the two molecular forms to the environment, but also from, at least to some degree, spatial dependence and aggregative dynamics due to biological processes such as competitive interactions between forms, predation, or dispersal – among others  <cit> .

association analysis
the similarity of distribution of the three taxa among the samples was investigated by the point correlation coefficient v, which measures the degree of species association based on presence/absence. it is generally assumed that similarity in species occurrence among samples reflects similarity in their overall ecological behaviour  <cit> . however, as measures of species association depend upon the chosen set of samples  <cit> , we performed three distinct analyses to explore the role of geographical scale and ecological conditions on the degree of association and similarity. first, we used the whole data set of samples from the entire study area to investigate the macroecological pattern of species occurrence that was examined previously biogeographically using geostatistical interpolators. then, because of the gross latitudinal pattern in species distribution , we stratified the analysis in a northern , and a southern  stratum, whose boundary corresponds approximately to the reversal in molecular forms relative abundance .

the analysis of the whole data set confirmed the pattern that could be inferred from the maps of species distribution and abundance in figure 2: anopheles arabiensis and an. gambiae m were positively associated, whereas both these taxa were negatively associated with an. gambiae s , indicating that the two molecular forms of an. gambiae were overall ecologically more dissimilar than the m form and an. arabiensis. the southern stratum association analysis conformed exactly to the same pattern . conversely, in the northern stratum the 95% bootstrap confidence intervals of the point correlation coefficient overlapped v =  <dig> in two cases out of three, suggesting that in this area an. gambiae s occurred independently of the other two taxa . a weak, and possibly statistically significant, negative association between an. gambiae m and an. arabiensis was detected in this region . the fact that an. gambiae m and an. arabiensis co-occurred less than expected under a null model where they were most abundant, and were associated more than expected where they were least abundant suggests that they have more similar ecologies , so that they occur in the same habitats where they presumably engage in frequency-dependent competitive interactions. conversely, the fact that an. gambiae s was significantly less associated than expected where it was the most abundant, and it was distributed independently of the other taxa where it was the least abundant, suggests that it is the strongest competitor of the three taxa.

* confidence limits are approximate because some monte carlo replications returned indeterminate values of the v coefficient due to the occurrence in the  <dig> ×  <dig> contingency table of more than one cell with zero values.

association coefficients v  assessing the degree of co-occurrence of species pairs across sampled locations, stratified by two latitudinal classes representing regions of contrasting levels of relative abundance of the two molecular forms of an. gambiae s.s. . n = number of sampled locations .

ecological niche factor analysis
sample size is the most critical parameter when choosing a sampling strategy optimized to return accurate predictions by the enfa  <cit> . our analysis was based on a variable number of presence data points out of  <dig> sampled locations depending on each taxon:  <dig> for an. arabiensis,  <dig> for the m form, and  <dig> for the s form; in all cases our sample size approximated values returning robust results in simulations using virtual scenarios  <cit> . the global marginality, specialisation, and tolerance indices did not differ among the three taxa, but the indices indicated that their ecological requirements were rather marginal and specialized with respect to the global distribution of the egv values in our reference set, i.e. that defined by the environmental conditions encountered across the whole of burkina faso . this is not uncommon when the reference set is constituted by large spatial extents such as whole countries, given that the degree of ecological specialization is generally directly proportional to the diversity of conditions accounted for by the reference set.

the two egvs having by far the greatest impact upon the marginality factor of all the three taxa were distance from populated places and distance from roads . as these variables are related to the density of the human population and of roads, hence to the impact of anthropogenic modifications on the environment, this result is perhaps not surprising considering the high degree of anthropophily  generally expressed by an. gambiae and an. arabiensis in west africa. moreover, during the rainy season, unpaved roads are favourable to the occurrence of suitable larval breeding sites, and may favour the dispersal of mosquitoes by passive transport. similarly, the egv with the third highest positive load on the marginality factor for all species/forms was the frequency in each spatial unit of land exploited for farming annual crops , which is again a variable related to the degree of land occupancy and exploitation by humans.

the remaining four categories of land use differentiated an. arabiensis and the m form from the s form . somewhat surprisingly, climatic egvs were comparatively less influential than other classes of predictors. only in the case of the s form did three out of four climatic egvs have moderate coefficients on the marginality factor: this taxon preferred habitats with higher than average rainfall, and lower than average solar radiation and evapotranspiration, in agreement with its higher prevalence in the more humid savannas of the south. conversely, an. arabiensis was positively associated with higher mean annual temperatures, consistent with its higher prevalence in the more arid savannas of the north. only the s form was slightly associated with higher locations , although it must be noted that the altitude range in burkina faso is limited, and this association probably resulted mostly from a correlation between the s southern distribution and the geographical localization of more mountainous regions in burkina faso .

the first specialization factor  of the enfa, expresses the degree of tolerance of a species to occur in regions departing from the optimal habitat. the higher the factor load , the lower the ability of a species to cope with less-than-optimal environmental conditions. the minimum distance from roads and the frequency of croplands  had the highest coefficients for all three species/forms. this result, considered in the context of the disappearance of the poppl predictor from this set, suggests that the impact of the human population on the ecological niche of these taxa is expressed mainly on rural habitats, presumably through the action of occupation and clearance of the savanna for agricultural purposes. in several instances, the specialization coefficient was moderately high for an environmental predictor of weak marginality . this result is interpreted as the lack of tolerance of the focal species for the more extreme conditions expressed by that egv, even if the optimum of the species coincides with the distribution of the egv across the whole study area. in other instances the specialization coefficient was relatively high for egvs of moderate marginality . this was the case for the environmental predictors shrub for an. arabiensis, farm and shrub for the m form, and rain and farm for the s form. in this case, both marginality and specialization act in the same direction of preference by the focal species for more specific conditions concerning that egv.

fundamental vs. realized ecological niche
according to the broken stick rule, the habitat suitability  maps exploited in all instances the first two factors of the enfa, which explained 76–77% of the available information. the distribution of habitat quality across burkina faso presented some commonalities between the three taxa . specifically, the region defined by the upper and medium basin of the nakambé river was of high average quality  for all the three forms/species. this is an area of high population density and intensive farming , characterized by numerous irrigation schemes . the other commonality between the three taxa was the unsuitability of large, mostly uninhabited, areas occupied by national parks, game reserves, and forestry management projects.

on the other hand, a major difference between the taxa was the relative amount of suitable or optimal habitat available across burkina faso : considerably more for both an. arabiensis and the s form  compared to the m form , for which most habitat was of marginal quality . in other words, the environment in burkina faso provided conditions that were mostly good to very good or totally unsuitable to an. arabiensis and the s form, whereas the same conditions were mostly marginal or unsuitable for the m form.

percent coverage of the study area by different bin classes of habitat suitability stratified by the interpolated relative frequency of members of the an. gambiae complex in burkina faso.

we categorized the study area into two classes according to the interpolated relative abundance of each taxon . for each taxon and abundance class, we assessed average habitat quality .

under the assumptions of equilibrium dynamics and in the absence of interspecific interactions, it is expected that the quality of the habitat as predicted by the fundamental ecological niche requirements should be positively correlated with the realized distribution and abundance of each taxon  <cit> . theory also predicts that departures from this pattern – a signature of transient dynamics and/or interference among the taxa – should be characterized by the most recent  taxon occupying habitat of more marginal quality than the ancestral taxa  <cit> . the predicted association between habitat quality and abundance matched more in the case of an. arabiensis and the s form, and less for the m form. the latter remained overly represented in habitat of marginal quality regardless of abundance status, whereas the former taxa were more abundant in habitat of overall higher quality .

the measures of model performance and robustness  for the hs maps indicated that the models were reasonably accurate for all the three forms/species, but were not particularly robust. this is a general feature of species distribution models of focal species having a widespread distribution with large marginality and restricted tolerance, as in our case, for purely methodological reasons  <cit> . our main purpose, however, was not to predict with any degree of accuracy the occurrence of the focal species, but rather to infer gross patterns of habitat quality and distribution, and to rank the impact of environmental predictors on these. these patterns are less likely to have been strongly affected by the quality and robustness of the model predictions.

model evaluation statistics for the habitat suitability maps shown in figure  <dig>  computed with 10-fold cross-validation. larger values of the mean indicate greater accuracy. smaller values of the standard deviation  indicate greater robustness in model predictions.

ecological niche breadth and habitat overlap
the analysis of factor loads over the first discriminant factor isolated the main eco-geographical variables differentiating each pair of taxa. as shown in table  <dig>  different combinations of variables distinguished the environmental envelope characteristic of each taxon. however, the frequency distribution of the cell scores showed that in all cases the extent of overlap was substantial, indicating that the fundamental environmental envelope described by the selected egvs did not differ markedly among the members of the complex .

coefficients of the first discriminant factor between the habitat characteristics of pairs of an. gambiae s.l. taxa. positive values  indicate variables that favour the first species of the pair, negative values  those that are favourable to the second species of the pair.

to quantify the degree of niche overlap we calculated three indices  <cit> : levin's standardized niche breadth b*, hurlbert niche overlap l, and lloyd's directional interspecific crowding of species y on species x, zx. these measures are related to the probability that individuals of a species will encounter individuals of the other species. to assess the extent of ecological niche similarity and overlap between the fundamental vs. realized ecological niche of the three taxa, we calculated the indices either over the environmental envelope that maximally discriminated each pair of taxa , or across the set of sampled locations .

† levins' standardized niche breadth index b*; eq.  in  <cit> 

§ lloyd's interspecies patchiness index i; eq.  in  <cit> 

* loyd's asymmetric interspecific crowding index zx; eq.  in  <cit> 

indices of ecological niche breadth, and overlap calculated either over the first discriminant axis segregating species  <dig> from species  <dig> of a pair , or across the sampled locations . the first approach provides measures of ecological segregation along the fundamental environmental envelope that discriminate most among the taxa , whereas the second approach provides estimates of the realized degree of segregation between locations. we use the more general notation given by hurlbert  <cit>  of indices accounting for differences in availability of different resource states. the notation for the particular case of equally abundant resource states is provided as a footnote in the table.

anopheles arabiensis had marginally lower indices of niche breadth than the two molecular forms, and the m form had marginally higher values than the s form . the lowest values of lloyd's asymmetric index were those between the two molecular forms, indicating that they segregated the most; an almost two-fold greater value was obtained for the degree of niche overlap between an. arabiensis and the m form, indicating that they segregated the least. the overlap was fairly symmetrical in all cases. the same conclusion was obtained by the lloyd's interspecies patchiness index i: the two molecular forms had the lowest index , an. arabiensis vs. an. gambiae m the highest .

the estimates of niche breadth and habitat overlap obtained from the distribution and abundance of the three forms/species in the sample locations conformed to the general pattern of the discriminant analysis, but differences among taxa and species pairs were much larger . perhaps even more importantly, the degree of niche overlap was lower than that assessed from the fundamental environmental envelope . the index of niche overlap was least between the m and s forms and 3-fold higher between an. gambiae form m and an. arabiensis. similarly, lloyd's asymmetric indices of interspecific crowding were lowest in the case of the m and s molecular forms, and 3–4-fold higher in the case of an. arabiensis and the m form. a comparison of these same indices across columns "da" and "sl" in table  <dig> reveals that the indices of niche overlap were 3– <dig> times greater when calculated along the environmental gradient that maximally discriminates among pairs of taxa. in other words, the realized habitat segregation of the taxa was more pronounced than that expected from the degree of habitat suitability across the study area.

overall, these results indicate that the m form of an. gambiae, despite a potential niche breadth of similar magnitude as the other two taxa, which overlapped extensively with their fundamental ecological niche, realized a niche of lower breadth than an. arabiensis and an. gambiae form s, and diverged most from the latter taxon.

the process of ecological divergence between molecular forms has shifted the niche of the m form towards that of an. arabiensis, thereby inducing a higher niche overlap in the case of these two species.

chromosomal polymorphism and population structure
the chromosomal analysis was based on  <dig>  an. gambiae s.s. that could be scored for all inversions. table  <dig> presents the allocation of karyotypes by molecular form, by chromosomal form  <cit> , and by genetic clusters of karyotypes assigned by structure. structure identified two clusters as the most likely based on the chromosomal data . although most s karyotypes were assigned to cluster  <dig> and m karyotypes to cluster  <dig>  the two clusters did not perfectly coincide with molecular form status . about 9% of s individuals were assigned to cluster  <dig>  and 5% of m-individuals to cluster  <dig>  as expected, karyotypes of the ms hybrids were much more widely shared between clusters . the chromosomal forms definition does not allow the unambiguous assignment of all possible karyotypes, either because of technical difficulties with scoring inversion haplotypes , or because they are by definition 'recombinants' or otherwise segregating in multiple chromosomal forms . these ambiguous karyotypes accounted for  <dig> % of the samples across our study area. thus, while some correspondence between molecular and chromosomal forms of an. gambiae exists in burkina faso as reported in  <cit> , only  <dig> % and  <dig> % of all m and s specimens could be assigned to the chromosomal forms mopti and savanna, respectively.

* depending on linkage this karyotype can be assigned to either savanna or mopti

** depending on linkage this karyotype can belong either to savanna or be considered as a hybrid mopti/savanna

assignment of karyotypes observed in burkina faso according to three classification criteria: the recorded rdna igs state , the multi-locus genetic clustering approach implemented in the software structure, without prior assignment to a given population , and the chromosomal form status according to  <cit> . the non-linnean nomenclature forest, mopti, and savanna defines groups of karyotypes  restoring hardy-weinberg equilibrium of chromosomal inversion markers in field populations of an. gambiae s.s., with particular reference to mali . the table presents the frequency of observed karyotypes falling in each category.

it is interesting to note that the classification of karyotypes into chromosomal forms was originally proposed to restore genetic disequilibria observed in natural populations of an. gambiae. the original definition was mainly based on extensive sampling in mali  <cit> . the same objective, by a different approach, is also the basis of the structure algorithms. however, the two karyotype clusters identified by structure from burkina faso samples are not coincident with the chromosomal form definitions . contrasting levels of chromosomal polymorphism distinguish the two clusters: cluster  <dig> is characterized solely by the presence of the 2rb/+ 2la/+ polymorphism, as encountered in an. gambiae populations across much of africa, including east of the great rift valley. conversely, cluster  <dig> is characterized by all other inversion arrangements  in combination with the 2rb.

if we accept the correspondence cluster 1/s form and cluster 2/m form, then "mismatches" between molecular form and cluster assignment by structure would represent "admixed" individuals whose genotype is the result of shared ancestry or hybridization between the m and s forms. to explore this hypothesis, and to quantify the degree of admixture of different karyotypes, we repeated the stucture analysis, this time after assignment of individual karyotypes to their empirically determined molecular form. in this case, structure estimates the probability that each observed karyotype belongs to the population of origin, or whether it is the result of 'immigration' . the results of this analysis, shown in additional file  <dig>  indicate that most karyotypes derived from m form specimens had a high probability  of belonging to the m form. karyotypes derived from the s form had a higher degree of admixture with m .

ecology of chromosomal variants
the detrended correspondence analysis showed that the m and s form karyotypes segregated along the first ordination axis , which accounted for c. 23% of the variance in the karyotype frequency data and c. 58% of the karyotype/environment correlation. the correlation between karyotypes and egvs along this axis was very high . the contribution of the second axis was comparatively much lower: 7% of the karyotype frequency data and  <dig> % of the karyotype/environment relation, with a correlation coefficient of  <dig> . similar values applied to the third and fourth axes. the first axis, therefore, captured most of the variability in the karyotype frequency distribution and the correlation of karyotypes with environmental conditions across the study area, although there remained a large portion of unaccounted variability that was spread over subsequent axes – each accounting for a relatively minor portion of the remaining unexplained variance. despite the substantial number of egvs, the amount of variance that the eco-geographical variables could account for was only moderate .

to assist interpretation of the environmental gradients captured by the first and second ordination axes, continuous and nominal variables were plotted in ordination space . the first ordination axis was highly correlated with the climatic variables and vegetation zones, suggesting that it defines the geographical  cline associated with these egvs: the right end of the axis was associated with higher values of rainfall and lower values of temperature, solar radiation, and evapotranspiration characteristic of the southern sudan savanna vegetation; conversely higher values of temperature, solar radiation, and evapotranspiration and lower values of rainfall were associated with the two types of sahelian vegetation at the left end of the first ordination axis. the southern sudan savanna region in burkina faso is associated with higher values of altitude due to a hilly region in the south-west , hence slope values are higher as well. higher frequencies of woodland, shrubland, and areas of heterogeneous farming characterize the land cover of these same regions. conversely, the sahel is mostly characterized by areas devoid of vegetation .

interpretation of the second ordination axis is more difficult, but we suggest that it represents a gradient correlated with habitat quality. unsuitable and marginal habitat classes for both m and s map in the lower part of the diagram, whereas suitable and optimal classes, again for both m and s, map in the upper part of the diagram. distance from populated places, a variable that was highly influential in the enfa, has a high negative correlation with the second ordination axis, that is, points falling in the lower part of the diagram are more distant from populated places, hence fall in habitat of lower quality according to the results of the enfa for both m and s. this axis, therefore, would represent a gradient of overall habitat quality for an. gambiae, regardless of molecular form status.

under this interpretation of the two main ordination axes, a model for the distribution of chromosomal variants in m and s can be proposed. the fact that m and s karyotypes strongly segregated along the first ordination axis is not surprising considering the observed pattern of geographical distribution of the two molecular forms across burkina faso . however, it is revealing to compare the response of the same karyotype segregating in different molecular forms. in the diagram, the relative position of a karyotype common to both molecular forms was consistent across forms overall. for example, the standard homokaryotype 00000m/s is found at the right end of both molecular form distributions; similarly, the 2rbc/bc karyotype 02200m/s is shifted to the left in both distributions . thus, the 00000m/s karyotypes were found in less 'arid' conditions in both m and s relative to the average conditions of aridity experienced by each form with respect to their geographical distribution, and the converse for 02200m/s karyotypes. in general, this suggests that although they are present in  different genetic backgrounds of the m or s form, each karyotype responded in a similar manner to environmental variables acting at a macrogeographic scale.

the distribution of karyotypes along the second environmental gradient, the one correlated with habitat quality, indicates that 'admixed' karyotypes within each molecular form occurred in habitat of overall less suitable quality. for example, the admixed karyotypes 02200s, 01100s, 01101s in s and 02000m, 02101m, 02100m, 01000m in m  mapped at the lower end of the second ordination axis, whereas the 'typical' karyotypes were found higher up along this axis. to formally test this hypothesis we calculated the spearman correlation coefficient between the scores on the second ordination axis of common karyotypes  and the probability that the karyotype belonged to the population of origin . the correlation was positive and statistically significant , indicating that indeed, on average, more admixed karyotypes scored lower on the habitat quality gradient.

several inferences can be drawn from these results: first, if alternative chromosomal arrangements were acting as selectively neutral alleles, one would expect similar karyotypes to map closely in ordination space along the first ordination axis. contrary to this expectation, the same karyotypes in m and s were often distant along this axis, but not in a random order, consistent with the hypothesis that chromosomal inversions in an. gambiae are not selectively neutral. second, the adaptive role of inversions is not absolute, but instead is conditioned upon the genetic background of the molecular form. third, under the assumption that 'typical' karyotypes occurred in habitat of better quality because they are better adapted to it, the fitness disadvantage of 'admixed' karyotypes in marginal habitats of poorer quality might be offset by reduced intra-specific competition from 'typical' karyotypes. in other words, the 'admixed' karyotypes are those that 'live at the edge' of the adaptive landscape of each taxon, thereby providing the raw material on which evolutionary forces operate in the ecological speciation process.

discussion
the ecotypification theory of speciation of anopheline mosquitoes postulated by coluzzi  <cit>  is a specialized case of ecological speciation taking into account their small chromosome number  as well as their "flush and crash" population dynamics. like ecological speciation generally, it is based on the coordinated action of ecological and genetic mechanisms for the evolution of reproductive isolation in diverging populations. the principal tenets and steps of this theory are  the invasion of a new ecological niche by a peripheral population;  the appearance in the peripheral isolate and establishment  of alleles conferring a fitness advantage in the novel environment, in the absence of gene flow from the core population;  the maintenance of linkage between these alleles in the face of gene flow from the core population by a genetic mechanism that suppresses recombination, notably paracentric chromosomal inversions;  the increase of genetic differentiation between the ecologically diverging populations by accumulation of allelic differences, including genes involved in reproductive isolation.

from an ecological standpoint, this theory presupposes several ecological mechanisms, of which the invasion of a new niche is amongst the most crucial. when a peripheral population invades a new habitat, it is unlikely that it will already have acquired all the traits necessary to cope optimally with the novel environment. at the early stages of colonization, its fundamental ecological niche will be similar to that of the core population, resulting in extensive niche overlap between these populations. the new habitat, therefore, will be of marginal quality with respect to the requirements of the fundamental ecological niche of the invading peripheral population  <cit> . the occupation of the new habitat by the peripheral population, and its progressive adaptation to it, however, will reduce the realized niche breadth of the peripheral population and the degree of realized niche overlap between the peripheral and core populations. a transient mismatch between the fundamental vs. realized ecological niche of the core and peripheral populations, and the occurrence of the peripheral population in habitat of lower quality, therefore, constitute a signature of recent niche expansion. later on, as the process of adaptation by the peripheral population to the new conditions carries on, its fundamental ecological niche will progressively change to match the environmental envelope characterizing the new habitat, producing a niche shift and a reduction in the extent of niche overlap between the core and peripheral populations.

the ecological niche properties of the m molecular form of an. gambiae that we recorded in populations from burkina faso fit with this signature of niche expansion and ecological divergence from the s form. the fundamental ecological niche of the two taxa inferred under the hypervolume framework formalized by hutchinson  <cit> , was rather similar: both forms need specific environmental requirements, whose occurrence is greatly influenced by the presence and activity of humans, and niche overlap is extensive even over the environmental gradient where the two forms segregate the most.

on the other hand, the biogeographic pattern of occurrence and abundance showed that the degree of realized niche overlap between the two molecular forms of an. gambiae s.s. was proportionally less, in discordance with expectations from ecological speciation theory which predicts, in taxa of similar age, an association between the amount of ecological divergence and the degree of reproductive isolation  <cit> . according to this prediction, we should have observed a higher degree of habitat segregation between the taxa of older ancestry – an. gambiae and an. arabiensis, characterized by efficacious pre-zygotic and post-zygotic mechanisms  <cit> , than between the younger molecular forms of an. gambiae, among which reproductive isolation is at an earlier stage of development  <cit> .

departure from expectation might result from a combination of several factors. first, the association between ecological divergence and reproductive isolation is weaker when post-zygotic isolation is the main isolating mechanism  <cit> ; post-zygotic isolation is stronger between an. gambiae and an. arabiensis than between the molecular forms of an. gambiae  <cit> . second, we have examined only a subset of abiotic resources at a macro-geographic scale, whereas other factors  acting at other geographical scales might account for a different pattern of ecological differentiation among the three taxa. third, in the process of niche expansion, the m molecular form of an. gambiae, which is presumably the most recent, has invaded part of the adaptive landscape of an. arabiensis. if chromosomal arrangements shared between these two taxa  <cit>  were independently selected, genetic similarity might have resulted in ecological convergence.

but what makes a population occupy habitat of marginal quality, and where does the process of niche expansion find its driving force? our results suggest that competition between genetic variants is one of the possible mechanisms. models of adaptive divergence across heterogeneous landscapes have demonstrated that competition can lead to the appearance of clusters of adaptive phenotypes at the extremes of an environmental cline , and there is experimental evidence that competition can lead to the expansion of niche width  <cit> . in our study area, the spatial distribution of chromosomal variants with respect to environmental variables and habitat quality was non-random. instead, the same karyotypes were spatially distributed in a symmetric pattern in both molecular forms in response to gross environmental gradients of climate, vegetation, and land cover. this suggests two things. first, in agreement with a large literature  <cit> , the polymorphic chromosomal inversions of an. gambiae constitute an adaptive system under balancing selection, playing a role in the ecological plasticity and adaptive potential of this species across a diversity of environments. second, that particular karyotypes provide a broadly similar benefit to both m and s forms under the same environmental conditions. however, their particular ecological value appears to be conditioned on the different genetic backgrounds of the m and s forms. when karyotypes 'typical' of one form in burkina faso  were carried by the other form , they were observed in habitat of more marginal quality , suggesting that these rarer 'atypical' karyotypes represent genotypes of overall lower fitness. assuming that 'typical' karyotypes have superior fitness in suitable and optimal habitat, we propose that 'atypical' karyotypes are able to emerge from competition with 'typical' karyotypes only in marginal habitats, where the fitness advantage of the more successful 'typical' karyotypes becomes less . it is possible that 'atypical' karyotypes are those that initiate the process of niche expansion and shift. in the early steps of divergence, these karyotypes are probably maladapted to the marginal conditions they are obliged to live in to escape competition from the 'typical' karyotypes in the core of the adaptive landscape . however, the 'atypical' karyotypes may provide the raw material that evolution can build upon to initiate a process of ecological divergence. were it not for an incomplete reproductive barrier between m and s, 'atypical' karyotypes  would presumably go extinct once they have given rise to ecologically more successful karyotypes , because of their lower overall fitness compared to other karyotypes along the entire environmental gradient. however, because of occasional hybridization between m and s, 'admixed' karyotypes still occur in natural field populations, occupying the same ecological role of their ancestral 'atypical' analogs.

how might these hypotheses relate to the ecotypification theory of speciation? the first observation is that chromosomal variants in an. gambiae populations are ubiquitous and emerge frequently. the analysis of the distribution and frequency of rare chromosomal inversions in this species agrees with a model of high chromosomal plasticity driven by the frequent emergence of chromosomal rearrangements on the 2r arm  <cit> . in general, most of these chromosomal variants do not capture enough adaptive alleles to go beyond the early phases of establishment, or they are otherwise selectively neutral and lost by drift. based on the distribution of karyotypes in relation to the nature of habitat quality, we hypothesize that sometimes the rearrangements provide a selective advantage, but not enough to withstand the competition from genotypes already present in the core of the population adaptive landscape. these karyotypes are therefore confined to more marginal environments where they can initiate a process of niche expansion and niche shift. yet there is a paradox, due to the observation that the same chromosomal inversion variants are shared between molecular forms of an. gambiae. this implies that while ecological adaptation genes should be found inside inversions on the 2r chromosomal arm, they are unlikely to contain the genes responsible for premating reproductive isolation between m and s. indeed, the genome regions currently considered most likely to contain genes for reproductive isolation are highly diverged pericentromeric regions of chromosome x and 2l, termed "speciation islands"  <cit> . the supposition is that paracentric chromosomal inversions are not the sole mechanism by which ecotypification and speciation can take place. all genetic mechanisms by which recombination is suppressed, thereby providing a means to protect the linkage of favourable allele combinations, can play a role in this process – including suppressed recombination regions near centromeres  <cit> . thus, it can be proposed that when ecologically favourable mutations in the pericentromeric "speciation islands" started to appear, the processes of ecological divergence and speciation arrived at a turning point. at this stage, the appearance of alleles controlling reproductive isolation could protect the linkage of the unlinked chromosomal regions  harbouring ecologically-significant allele combinations. another mechanism that could potentially foster this process would be any kind of selection against hybridization of the diverging ecotypes, such as e.g. reinforcement in the 'broad sense'  <cit> . figure  <dig> schematically summarizes the postulated evolutionary steps of the proposed pattern of ecological and genetic diversification of m and s using the path of figure  <dig> as a model, showing the dynamic interaction between ecological adaptation genes on different regions of the genome. it must be stressed that this specific path is only one possible realization that is taken to exemplify the role of 'typical' and 'atypical' karyotypes in the process of ecological niche expansion and the development of reproductive isolation between m and s. it is largely premature to conclude that this evolutionary path was precisely that followed during m and s speciation; we use it here only as a general model that we can use to visualize formally the logic of our argument and generate testable predictions against which future observations can be compared. a summary of the main results, hypotheses, and conclusions inferred from this study is presented in table  <dig> 

* inferred from previously published literature

the present pattern of distribution of the diverging evolutionarily significant units of an. gambiae, the molecular forms m and s, agrees with the view that biogeographic patterns during speciation are dynamic  <cit> . the two forms are currently evolving reproductive isolation, and the present data show that they are ecologically diverging. such ongoing speciation is happening under clinal sympatry, yet the very ecological processes underlying the initial steps of divergence presumably involve the occupation of marginal habitats and may happen under allopatry of the genetic variants responsible for the niche shift.

CONCLUSIONS
anopheles gambiae, the most significant vector for human malaria, shows a remarkable capacity to thrive in a wide range of environmental conditions, provided humans are present. genomic regions of suppressed recombination appear to have a leading role in the adaptation of this species to novel environments and in the emergence of reproductive isolation. ongoing speciation involving the two molecular forms of an. gambiae is accompanied, and presumably driven, by a process of ecological divergence initiated by expansion of the original ecological niche of the ancestral s form. paracentric inversions on chromosomal arm 2r capturing allele combinations of ecological adaptive value were likely instrumental to the initiation of this process. the later appearance of ecologically significant genes in unlinked chromosomal regions such as the speciation islands is postulated for the evolution of reproductive isolation. overall, these results highlight the phenomenal ecological and evolutionary flexibility of this mosquito, as well as the extraordinary complexity of the population structure and dynamics of this biological model – a lesson not only for students of speciation, but also for vector control.

list of abbreviations
asecna: agence pour la sécurité de la navigation aérienne en afrique et à madagascar ; avi: absolute validation index; bndt: banque nationale des données topographiques ; cvi: contrast validation index; dca: detrended correspondence analysis; egv: eco-geographical variable; enfa: ecological niche factor analysis; gis: geographical information system; hsi: habitat suitability index; igb: institut géographique du burkina ; igs: inter-genic spacer; lat: latitude; long: longitude; mcmc: markov chain monte carlo; pcr: polymerase chain reaction; rdna: ribosomal deoxy-ribonucleic acid; sdm: species distribution modelling.

authors' contributions
the study was conceived by cc and njb. cc, fs, and njb devised the field protocol. wmg performed the field collections; wgm, mp and ihnb carried out the laboratory analyses under the supervision of nfs and cc. the geographical information system was conceived and implemented by cs and ko under the supervision of jmf. da, cc, mp, and ko performed statistical analyses. cc, fs, njb, and df coordinated the project. cc wrote the article, which was critically revised by fs, njb, and df. all authors read and approved the manuscript.

supplementary material
additional file 1
list of sampled locations. names and geographical coordinates of sampled villages, dates of collection, and sample size of collected and identified mosquitoes.

click here for file

 additional file 2
vegetation classes in burkina faso. floristic associations defining the four main vegetation classes covering burkina faso that were used as supplementary egvs in the dca.

click here for file

 additional file 3
ecological niche factor analysis statistics. marginality, specialization, and tolerance indices for the three taxa of the an. gambiae s.l. complex across burkina faso.

click here for file

 additional file 4
ecological niche factor analysis coefficients for an. arabiensis. factor loads of the  <dig> environmental predictors . factor  <dig> explains 100% of the marginality, the second and following factors explain increasing amounts of the specialization. positive values of marginality indicate that an. arabiensis was found in locations with higher values than average for that egv. negative values for egvs quantified as "minimum distance from"  indicate "preference to proximity". higher specialization coefficients, regardless of sign, indicate that anopheles arabiensis was found occupying a narrower range of values of the egv than available in the reference set. for visualization purposes, values ≥ <dig>  are outlined in red, values ≤ - <dig>  are outlined in blue.

click here for file

 additional file 5
ecological niche factor analysis coefficients for anopheles gambiae molecular form m. factor loads of the  <dig> environmental predictors  for an. gambiae s.s. form m. other symbols and explanations as for additional file  <dig> 

click here for file

 additional file 6
ecological niche factor analysis coefficients for anopheles gambiae molecular form s. factor loads of the  <dig> environmental predictors  for an. gambiae s.s. form s. other symbols and explanations as for additional file  <dig> 

click here for file

 additional file 7
discriminant analysis of habitat partitioning. relative frequency distribution of the cell scores occupied by forms/species of the an. gambiae complex in relation to the global distribution of all cells in the study area along the discriminant factor for which species pairs differed the most.

click here for file

 additional file 8
maximum likelihood estimates of population structure. values of ln , representing the probability of obtaining the observed genetic data x conditional on the presence of k populations , plotted against the number of genetic clusters k assumed in the population. error bars are standard deviations of five replicate analyses for each value of k .

click here for file

 additional file 9
admixture probabilities of different karyotypes. average probability  that a given karyotype belongs to the population of origin, in this case the recorded molecular form.

click here for file

 acknowledgements
we acknowledge the institut géographique du burkina for providing us with the topographic database of burkina faso. we thank the entomological team of the centre national de recherche et formation sur le paludisme in ouagadougou for the excellence of fieldwork, and the population and administrative authorities of the villages included in this study for their kind collaboration. we are especially grateful to prof. vincenzo petrarca for revising the assignment of karyotypes to chromosomal forms. financial support was provided by the institut de recherche pour le développement and the national institutes of health grant r01-ai <dig> to njb.
