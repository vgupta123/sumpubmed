BACKGROUND
dna pyrosequencing using  <dig> sequencing technology enables sequencing millions of high-quality dna bases per sequencing run  <cit> . this method has been used successfully for transcriptome sequencing and identification of single nucleotide polymorphisms  in many plant species including maize   <cit> , sugarcane   <cit> , eucalyptus   <cit> , and the model legume and close relative of alfalfa, m. truncatula  <cit> . the m. truncatula genome is one of three legume genomes including lotus japonicus and soybean  that have been assembled and annotated  <cit> . snps are the most common sequence variation among plants and are often functionally important. snps can be converted into genetic markers that can be inexpensively assayed using high-throughput approaches  <cit> . traditionally, molecular markers have been used to determine genetic relatedness between plant materials, to assist in the identification of novel sources of genetic variation, to study evolutionary relationships, to confirm the pedigree and identity of new varieties, in population structure analysis and association genetics, to locate quantitative trait loci  and genes of interest, and for marker-assisted breeding  <cit> . the value and uses of dna markers have been shaped in large part by innovations in marker technologies that increase throughput and reduce costs per data point  <cit> . a large number of molecular markers can be used in high-throughput genotyping platforms in association mapping studies to dissect complex traits and in molecular breeding approaches at the whole genome level  <cit> .

alfalfa  is one of the most important forage legume species worldwide and the third most valuable crop in the usa . alfalfa is a high yielding perennial species that requires little or no nitrogen fertilizer because of its ability to carry out symbiotic nitrogen fixation and can be harvested multiple times during the growing season. therefore, it has been an important component of sustainable agricultural systems for many years and has recently been promoted as a potential bioenergy crop  <cit> . cultivated alfalfa is tetraploid  and displays tetrasomic inheritance  <cit> . alfalfa is partially self-incompatible and populations are extremely polymorphic due to their high degree of outcrossing. inbreeding severely depresses plant vigor and fertility in tetraploid alfalfa due to the loss of complementary gene interactions  <cit> , preventing the development of inbred lines. a significant level of sequence conservation was reported between alfalfa and m. truncatula  <cit>  allowing estimates of marker colinearity between the two species  <cit> . simple sequence repeat  markers developed from m. truncatula and some alfalfa sequences are currently available  <cit> . alfalfa like many other crop species, lacks validated snp markers which are required in large numbers for map-based gene isolation, association genetics and genomic selection approaches  <cit> .

high-resolution melting  curve analysis has proven to be a highly sensitive method for mutation discovery and snp genotyping  <cit> . nucleic acid melting is tracked by monitoring the fluorescence of the samples across a defined temperature range generating high-resolution melting profiles that are used to identify the presence of sequence variation within the amplicon  <cit> . base-pair mismatches shift the stability of a duplex by varying amounts depending on the particular mismatch, the mismatch position, and neighboring base pairs  <cit> . hrm was successfully implemented to assay snp variation in diploid and tetraploid alfalfa  <cit> .

we describe the generation of thousands of alfalfa ests  obtained using  <dig> sequencing technology and the first iteration of genome-wide snp identification in tetraploid alfalfa, a non-model plant species that currently lacks a sequenced genome. a sample of candidate snps were experimentally validated using a hrm platform.

RESULTS
sequence assembly and annotation
root and shoot samples were collected during progressively developing water stress from clonal propagules of each alfalfa genotype. rna was purified and a pooled sample for each genotype was used to construct  <dig> titanium cdna libraries. the two libraries were sequenced on separate  <dig> half-plates that generated   <dig>  reads with a total length of  <dig>  mb from genotype chilean and  <dig>  reads with a total length of  <dig>  mb from genotype wisfal . the raw sequences were clustered and assembled separately for each genotype and also as a combined set using tgicl clustering utility  <cit> . the combined sequence assembly with the two genotypes resulted in  <dig>  tcs and  <dig>  singletons ranging from  <dig> to  <dig>  bases, with an average length of  <dig> bases. alfalfa transcriptome sequences were submitted to the short read database and transcript assembly database in genbank  and were assigned the accession numbers , , , and , respectively for wisfal short reads, chilean short reads, chilean assembly, and wisfal assembly. for the purposes of annotation, the combined alfalfa transcript assemblies were located on the medicago truncatula gene index  release  <dig>  maintained by the dana farber cancer institute . a total of  <dig>  alfalfa unique sequences  had a blastn hit to  <dig>  mtgi sequences . for the  <dig>  sequences with hits in the mtgi database, gene ontology  categories of their best match were assigned to each sequence. the proportion of alfalfa  <dig> sequences in each category follows the same general trend as the mtgi , indicating sequence coverage of a broad range of genes in the alfalfa  <dig> sequences.

alignment of alfalfa sequences to the m. truncatula genome
the available m. truncatula genome sequence was used as a scaffold to align the alfalfa transcript sequences. under stringent conditions using blat, including a threshold of 95% identity and 90% coverage ,  <dig>   unique sequences  were mapped to the mt  <dig> . <dig> genome sequence assembly. among these, a total of  <dig>  candidate snps were identified in  <dig>  tcs mapped to the m. truncatula genome  and their likely map positions inferred. to identify the number of distinct loci represented in the alfalfa transcript assemblies, they were searched against the m. truncatula v  <dig>  pseudomolecules annotation. at the nucleotide level,  <dig>   of the alfalfa  <dig> sequences had a blastn  hit with  <dig>  m. truncatula cds. we essentially obtained the same result at the amino acid level, in which  <dig>   of the alfalfa  <dig> sequences had a blastx hit  to  <dig>  m. truncatula predicted proteins.

when combined with the mtgi results,  <dig>   alfalfa sequences had a blastn or blastx hit in mtgi and/or mt <dig>  databases. of the remaining  <dig>  alfalfa sequences,  <dig> of them had a blastx hit  with  <dig> proteins in the soybean glyma <dig>  high confidence gene protein database  <cit>  and  <dig> alfalfa sequences had a blastx hit  with  <dig> l. japonicus proteins  <cit>  further supporting the notion of shared sequences among legumes. only  <dig> of the remaining  <dig>  alfalfa sequences without a match in any of the aforementioned databases had a hit in the arabidopsis tair  <dig>  protein database . the remaining  <dig>  sequences represent a total length of  <dig>  mb , did not have a significant match when blasted against the ncbi non-redundant nucleotide database suggesting they may be miss-assembled or novel sequences.

snp discovery and validation
candidate snps were called based on sequence alignments within and between the chilean and wisfal genotypes. a total of  <dig>  candidate snps were identified in  <dig>  tcs within or between the two genotypes. the snps were assigned to four categories based on their allelic composition . candidate snps in the first three categories have only two variants and include 97% of all candidate snps identified. category  <dig> snps are between the two genotypes and homozygous within each genotype . category  <dig> snps are heterozygous within one genotype and homozygous in the other . category  <dig> is the most abundant type of snps and constitutes 60% of all candidate snps; category  <dig> is the second most abundant type with 21% of all candidate snps. snps in category  <dig>  are biallelic and heterozygous within each genotype . category  <dig> snps have more than two variants  and account for only 3% of all candidate snps identified. we focused on validating category  <dig> snps due to their suitability for mapping in tetraploid alfalfa based on their segregation patterns in this population. category  <dig> snps are heterozygous in all f <dig> individuals from the mapping population resulting from a cross between two homozygous genotypes and thus not suitable for mapping. in this study, candidate snps represented in categories  <dig> and  <dig> were not considered for validation or mapping due to the complexity of their segregation patterns in this autotetraploid outcrossing species.

a subset of  <dig> candidate snps  identified in the alfalfa transcriptome were used to design primer pairs  for snp validation through pcr amplification and hrm analysis. the majority of snp primers  were designed to target category  <dig> candidate snps and  <dig> primer pairs targeted category  <dig> candidate snps . a category  <dig> snp is homozygous within each genotype but different between the two genotypes. the anticipated hrm profile for a category  <dig> snp includes two different and distinct hrm peaks, each of which corresponds to a different homozygous allelic state. category  <dig> snp marker mssnpv <dig> , results in a melting peak for wisfal  and a melting peak for chilean . two of the  <dig> category  <dig> candidate snps were not validated and resulted in overlapping melting peaks between the two genotypes, as shown for mssnpv <dig> . the melting curve peak from category  <dig> snp mssnpv <dig> corresponding to chilean, the heterozygous genotype, is shorter and wider than the peak corresponding to wisfal, the homozygous genotype . the hrm profiles from the remaining  <dig> category  <dig> candidate snps were complex, indicating the existence of additional snps within the amplicon sequence that were not predicted by  <dig> sequencing . results from the hrm evaluation of the  <dig> category  <dig> candidate snps indicate that  <dig> of them displayed the anticipated category  <dig> snp profile ,  <dig> showed complex profiles indicating the presence of additional snps not predicted based on the  <dig> sequences , and eight candidate snp were not validated  based on overlapping melting curves and amplicon sequencing . sequencing of the pcr amplicon obtained from mssnpv <dig> confirmed a single snp at position  <dig> between the two genotypes . a total of  <dig> snps were validated, while  <dig> snp primers  resulted in the identification of additional snps. for example, the predicted category  <dig> snp for mssnpv <dig> at position  <dig>  was confirmed by sequencing and additional snps were identified at position  <dig> and position  <dig> . the predicted category  <dig> snp at position  <dig> for mssnpv <dig> was confirmed, and additional snps were identified at position  <dig> and position  <dig> . in the case of snp mssnpv <dig>  the predicted snp at position  <dig> was confirmed, and three additional snps were also detected . variation in depth of sequence coverage was observed for the snp-containing sequences between the two genotypes. both genotypes were represented in at least  <dig> sequence reads in the case of validated snp mssnpv <dig> . in contrast, candidate snp mssnpv <dig> had less than five sequence reads representing each genotype. overall, validated candidate snps had higher depth of  <dig> sequence coverage than non-validated snps in both category  <dig> and category  <dig> snps.

discussion
snp markers have a broad range of applications and a large number of markers are needed to implement association genetics approaches and genomic selection in plants with low levels of ld  <cit> . large scale snp discovery efforts in a wide range of crop plants are currently limited to a few species. previous snp discovery approaches in other species include sequence comparisons between the arabidopsis ecotypes landsberg and columbia  <cit>  and subspecies of rice  <cit> . although alfalfa is the most widely cultivated forage legume, it lacks genomics resource development compared to other crop species, partly because it is an autotetraploid, perennial outcrossing species. thus, a whole genome snp discovery effort is among the most critical endeavors to develop the necessary tools and integrate molecular breeding approaches in alfalfa. in this study, we utilized  <dig> sequencing for genome-wide snp discovery between and within two genotypes from m. sativa subsp. sativa  and m. sativa subsp. falcata , which have contrasting phenotypes for water stress tolerance. sequencing and snp discovery based on transcriptome sequencing of water stressed plants increased the likelihood of having sequence coverage in genes relevant to water-stress and identification of allelic differences in these genes between the two alfalfa genotypes evaluated in this study.

sequence assembly and alignment to m. truncatula
the close phylogenetic relationship between m. truncatula and alfalfa, same basic chromosome number , high degree of sequence similarity and marker co-linearity  <cit>  facilitated using the m. truncatula genome sequence as a scaffold to align alfalfa transcriptome sequences. despite the size and complexity of the alfalfa genome, alignments of alfalfa  <dig> sequences throughout the m. truncatula genome were apparent . the m. truncatula genome sequence project targeted the euchromatic region and available data indicate that 66% of the genes captured in the current pseudomolecules and 24% of the genes in m. truncatula captured in the fragmented illumina assemblies are found within the euchromatin. therefore, the m. truncatula genome provides a valuable resource for gene annotation of alfalfa sequences. the identification of some alfalfa sequences without alignment to the m. truncatula genome is not unexpected considering that m. truncatula is a selfing, annual diploid species and alfalfa is an outcrossing, perennial tetraploid species with a considerably larger genome. additionally, non-alignment of alfalfa sequences to the m. truncatula genome could occur in regions where there have been authentic genome rearrangements between the two species. we demonstrated the feasibility of using genomic resources from model species to quickly assemble transcriptome sequences from related species. these alfalfa resources can also facilitate opportunities to further understand legume genome structure and evolution.

snp discovery and validation
 <dig> sequencing is a high-throughput approach to identify sequence variation and was utilized successfully here to identify snp variation in tetraploid alfalfa. alfalfa is genetically very diverse and the existence of heterosis between m. sativa subsp. sativa and m. sativa subsp. falcata was previously reported  <cit> . because chilean and wisfal are highly heterozygous outcrossing lines, transcriptome sequencing of alfalfa genotypes enabled the identification of gene-associated snps within and between genotypes covering a range of gene functions and location in the genome. reports that  <dig> sequencing technology may be susceptible to indel-type errors  <cit>  prompted us to consider only base substitutions  with stringent snp prediction criteria.

the hrm platform proved to be a suitable method for validation and genotyping of a large number of candidate snps. the hrm melting curve profiles enables identification of homozygous and heterozygous snp genotypes  <cit> . we report a  <dig> % rate of validation of single candidate snps  indicating that transcriptome sequencing of a crop legume with economic value and assembly of those transcript sequences using the genome of a closely related model species is a viable strategy for genome-wide snp discovery efforts. studies in eucalyptus reported a 83% rate of validation from the candidate snps  <cit> . additional snp in alfalfa were detected using hrm that were not predicted based on the bioinformatics analysis from the  <dig> sequences. these findings were partly due to our efforts to minimize the false discovery rate in sequences with low depth of sequence coverage. therefore, the challenge for snp discovery using  <dig> sequences in a highly heterozygous species such as alfalfa resides in limitations from the depth of sequence coverage rather than sequencing errors. in contrast to a diploid species, tetraploid species have four homologous chromosomes and therefore deeper sequence coverage is needed to accurately ascertain the snp variation within and among genotypes. although an increase in the rate of snp prediction can be obtained using less stringent snp parameters, it also increases the likelihood of false positive snp calls. the discrepancy between snp detection and validation could also be the result of preferential allele expression or allele silencing in the pooled cdna sample that was used because the initial snp identification was based on cdna sequencing whereas validation was made using pcr fragments amplified from genomic dna. the identified snps complement our current work identifying genomic regions associated with water stress tolerance in backcross populations developed from the same two genotypes used for  <dig> sequencing.

previous efforts to identify sequence polymorphism in alfalfa include array hybridizations that identify single feature polymorphisms  using m. truncatula affy chips  <cit> . the approach described here enables the discovery of snps within genes that may not be present on an array developed for the model m. truncatula. additionally, snp discovery efforts based on transcriptome sequencing in a crop species may result in the identification of snps with functional relevance to agriculturally important traits such as persistence, likely not present in an annual model system.

the large number of candidate snps with potential functional relevance identified in this study provides a valuable tool for comparative genomic studies between m. truncatula and alfalfa, and potentially to other forage legume species including white and red clover. evaluations of snp variability, frequency, and distribution, as well as estimates of linkage disequilibrium in alfalfa are now attainable research targets. applications of crop-related snp discovery efforts include genetic diversity analysis, increasing the marker density of genetic maps to support high-resolution association and linkage mapping of target traits, facilitation of future genome assembly of this highly complex genome, integration of genetic and physical maps, and increasing the feasibility of integrating marker-dense molecular breeding approaches such as genomic selection in this important forage legume.

CONCLUSIONS
in order to enhance crop productivity, we need to improve our understanding of the genes involved in plant growth, development, and adaptation to a changing environment including suboptimal soil conditions and biotic and abiotic stress conditions. the  <dig> est-based snp discovery and validation pipeline described here focused on two tetraploid alfalfa subspecies with contrasting water stress tolerance provides a platform for the discovery of agriculturally-relevant genes and corresponding snps. the availability of a large number of validated snps is a valuable molecular marker resource for genetics, high-resolution linkage and association mapping, and molecular breeding approaches using genomic selection, for practical and agriculturally-relevant improvements in alfalfa which are not feasible using model systems.

