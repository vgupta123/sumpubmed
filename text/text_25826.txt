BACKGROUND
cervical cancer is caused by infection with high-risk types of the human papillomavirus  followed by additional changes in the host cell genome. insight in genes that are consistently altered over time will improve our understanding of the molecular mechanisms driving cervical carcinogenesis. these genes may provide novel biomarkers for early detection of cervical cancer as well as potential therapeutic targets. high-throughput techniques, such as microarrays and next generation sequencing, are tools for fast high-resolution genome-wide molecular profiling. applying these techniques to measure genes at consecutive moments in time at multiple molecular levels generates a description of the occurrence of molecular abnormalities during cervical carcinogenesis.

a longitudinal in vitro system of four independent cell lines immortalized with either hpv <dig> or hpv <dig>  previously shown to faithfully mimic cervical carcinogenesis at the genetic level , was used in this study. cell lines were assayed for gene expression  and gene copy number  with microarrays at consecutive moments in time, representing distinct stages of transformation. abnormalities in dna copy number were previously shown to directly affect expression of the genes located within these abnormalities and are believed to facilitate the identification of functionally relevant gene expression changes  <cit> . integrating these two molecular levels will yield models of cancer development and progression, thereby reducing the complexity of  carcinogenesis  <cit> . we present a method that, in contrast to existing methods, is able to integrate dna copy number and gene expression over time, while identifying temporal differential gene expression.

available methods in current literature for time-course differential gene expression analysis can only be applied to a single molecular level. since microarrays have become widely used for studying genome-wide gene expression, a range of statistical methods have been tailored for the identification of differentially expressed genes in microarray time-course experiments. several of these methods are developed in an empirical bayes framework . tai and speed  <cit>  use multivariate empirical bayes statistics to rank time-course gene expression profiles. their method is applicable to both single-condition and multiple-condition datasets and includes a variance stabilization imposing common matrix as a gene-specific variance-covariance matrix. alternative approaches involve spline-based methods which fit a smoothed curve to the longitudinal data to use for statistical testing . storey et al.  <cit>  use a population average time curve based on natural cubic splines to capture dynamics in gene expression levels and employ the f-test to identify significant genes. on the other hand, bats  <cit>  combines these two: it employs gene-wise functional modelling to explain temporal differential gene expression, which is casked in a hierarchical bayesian framework.

in this article we present a method for identification of temporal differential gene expression driven by genomic abnormalities, introducing several new concepts. first, employing low-rank thin-plate splines and empirical bayes shrinkage, identification of temporal differential gene expression is improved in terms of sensitivity, specificity and reproducibility. second, including dna copy number as a time-varying molecular covariate reduces residual variance and allows for the identification of genes which have variation in expression over time caused by genomic abnormalities. genes with expression levels affected by dna copy number aberrations have the capability to contribute to malignant cell growth  <cit> . identification of these genes is therefore essential for a better understanding of cancer development in general. third, we impose a multivariate spatial prior for the dna copy number effect to make the estimate more stable, borrowing information from neighboring features. furthermore, by changing the link function our method can straightforwardly deal both with continuous and count data. to illustrate the wide applicability of our method we applied it to hpv-induced transformation  and head & neck cancer  data.

methods
a method for the identification of temporal variation in gene expression  from an integrative genomics study with a time-course set-up is presented. the variation in gene expression over time is described by a generalized linear mixed model employing low-rank thin-plate splines. hyperparameters of the model are estimated from the data with an empirical bayes procedure. with parameter estimates at hand, we describe how relevant hypotheses may be tested. the section concludes with extensions of the model and practical considerations for its application.

model
consider a time-course microarray experiment where n cell lines are assayed repeatedly over  consecutive time points. at each time point both the dna copy number and mrna gene expression of each cell line are measured. let the random variables xi,j,t and yi,j,t represent the dna copy number and the expression level, respectively, of gene j of cell line i at time point t. their realizations are denoted by xi,j,t and yi,j,t. for both random variables the index j runs from j= <dig> to p. this is due to the application of a matching procedure  <cit> , which matches probes from two high-throughput platforms on the basis of their genomic location.

the expression levels of gene j are assumed to be normally distributed: , with  the error variance of the expression levels of gene j. the mean of this distribution is modelled as:
  <dig>  

where f and h model the fixed and random effects, respectively, of the expression level of gene j. both f and h are specified next.

the fixed effects, encompassing both cell line and dna copy number effects, are modelled by a linear regression component:
  

where αi,j is the effect of cell line i in gene j and βj the dna copy number effect on the expression levels of gene j.

the random effect captures the dynamics in the expression levels over time and is modelled nonparametrically by low-rank thin-plate splines  <cit> . these splines provide enough flexibility for modelling gene expression variation over time. furthermore, the low rank approximation avoids heavy computational costs due to a large number of unknown parameters. the random effect is then modelled by:
  

where zt= and γj=t, the vector of coefficients of the spline. these coefficients are randomly distributed as . the κk, κ1<κ2< ⋯<κk, are fixed knots, equally distributed over the interval .

model  is recasked as a semi-parametric mixed model. in a mixed model the random effects γj,k are assumed independent and all stemming from the same distribution . within the context of thin plate splines this is achieved by assuming a particular parameterization of Σγ,j. this requires the definition of the matrix Ω with  for k <dig> k2= <dig> …,k. furthermore, let  be the singular value decomposition of Ω with uω and vω containing its left and right singular vectors as columns and diagonal matrix dω of its singular values. it is then assumed that Σγ,j can be written as . under this assumption model  can be reformulated as the mixed model:
  <dig>  

where  and . the independent random variables γj,k and εi,j,t of this model are both multivariately normal with mean zero and covariances  only if i1=i <dig> and t1=t <dig> and zero otherwise, and . the choice of Ω results in a covariance matrix with higher covariances of random effects of neighboring knots .

if we denote with y∗,j,∗ matrix of measurements for gene j which are first ordered by cell lines i and within a cell line by time. the likelihood for gene j thus is:
  

which is to be used in the estimation.

estimation
the parameters of model  are estimated by means of an empirical bayes procedure. empirical bayes enables us to exploit the high-dimensionality of the data by ‘borrowing information across genes’, which yields more reproducible results. information will be shared among genes via common hyperparameters of the priors of the model parameters. here this sharing is done only for parameters that will be subject to inference. other parameters are considered confounders that need to be taken into account but are not of central interest. in principle, our estimation allows common hyperparameters for these confounders, but at a computational cost.

for the fixed dna copy number effect a dirac-gaussian mixture prior  is used:
  

where  denotes the gaussian density with parameters . the point mass accommodates the proportion of genes without a dna copy number effect. as this proportion is likely to comprise the majority of genes, it shrinks the βj to zero for those genes with a gene dosage effect.

the random effect γj,k and error εi,j,t are endowed with normal priors:  and . shrinkage is applied on the dispersion parameters  and  for two reasons: a) more stable parameter estimates and b) protection against over-fitting. the reciprocals of these parameters,  and , represent precision, for each a gamma distribution is used as a conjugate prior. the parameters a and b of these hyperprior gamma distributions are estimated using the method of  <cit> . the amount of shrinkage via this prior is determined by the data. the procedure is initiated with a and b resulting in a very flat prior on the precision. this corresponds to a very narrow prior on the variance of the random effect, that is, a flat spline. iteratively, should the data give rise to it, the prior of precision becomes more informative. as a result the variance moves away from zero, increasing the flexibility of the spline. would one desire more shrinkage our procedure allows the employment of a hyperprior composed of a gamma and a point mass at zero.

for the fixed cell line effect αi,j a gaussian prior is assumed: . no shrinkage  is applied to αi,j as it is considered a confounder, for which an unbiased estimate is preferred.

we temporarily assume that the cell lines are merely biological replicates and no inferential statement with respect to the cell line effect will be made in the section ‘head-and-neck cancer’. hence, for the moment the prior of the cell line effect αi,j is . the variance of this prior depends on index j: the hyperparameter of this prior is different for each gene.

given the hyperparameters shared by all genes, the model parameters of the individual genes are estimated by the mean of their posterior distributions. these are obtained by means of integrated nested laplace approximations   <cit> . inla yields the marginal posterior distribution of a model parameter through integration of the posterior distribution over all remaining model parameters. this can be done computationally efficient by means of laplace approximations under the assumption of a gaussian prior on the model parameters. the use of approximated posterior distributions ) is motivated computationally: the posterior distributions of model parameters of many genes need evaluation.

it remains to choose the hyperparameters. an informed choice of the hyperparameters is made through application of the empirical bayes procedure of  <cit> . that is, the hyperparameters are estimated from the data rather than set prior to the analysis. apart from a less subjective choice of the hyperprior, this has two favorable consequences. first, it yields more reproducible results . second, the hyperpriors employed cause shrinkage of the model parameter estimates. in particular, for the random effect it shrinks the dispersion parameter, which controls the smoothness of the fit  <cit> . hence, it constrains the flexibility of the spline and thus reduces the risk of overfitting. an illustration of this effect on the fitted spline can be found in additional file  <dig>  section  <dig> 

the conventional empirical bayesian estimate maximizes the product of the marginal likelihoods:
  <dig>  

where π denotes the prior of its argument . the hyperparameters of the priors of the αj, βj, and  are estimated by maximization of loss function . hereto equate the derivative of  with respect to the hyperparameters to zero and solve. the iterative procedure of  <cit>  yields an approximate solution to estimating equation . the procedure of  <cit>  is computationally fast and allows non-parametric hyperpriors.

from expression  it becomes clear how the parameter estimates are shrunken. the prior of  βj is shared by all genes. hence, the choice of the hyperparameters affects the posterior distribution of all βj. in particular, if the mass of π is more concentrated around zero, the posterior has more probability mass close to zero. only if the data contains enough evidence  to outweigh the prior, the posterior will center around a non-zero value. the prior of βj puts  more mass at zero. moreover, the precision of the other mixture component is estimated from all genes. under the assumption that a  majority of genes do not exhibit an effect, the precision is under-estimated for the minority. this, together with the spike, yields a conservative prior leading to shrunken estimates.

finally, we point out that the procedure described in  <cit>  assumes covariates to be identical over features. in our setting the dna copy number covariate varies over the features. it would be more appropriate to assume a different dirac-gaussian prior for each group of features that shares the same aberration pattern over the samples. these mixture priors differ in the variance of their gaussian part. this could – in principle – be accommodated by a mixture of a point mass at zero and a lot of gaussians, all with mean zero but different variances. however, a mixture of gaussians with the same location but different variance may be approximated by a t-distribution with degrees of freedom equal to the number of gaussians  <cit> . however, this approximation improves as the number of gaussians in the mixture increases. on the other hand, a t-distribution with many degrees approaches a gaussian. as there are usually many different genomic aberration patterns, we exploit this approximation and assume a common variance in our dirac-gaussian mixture prior. in a simulation study  we show that the t-distribution approximation does not differ substantially from the mixture of gaussians with common mean but different variances.

hypothesis testing
from a biological point two questions are of main interest: i) does dna copy number drive gene expression, and ii) is there differential expression over time? the former question can be answered by testing whether the dna copy number effect βj differs significantly from zero, evaluating the null hypothesis h0:βj= <dig> versus its alternative h0:βj≠ <dig>  the second question is addressed by testing  against the alternative . the alternative implies that there is at least one γj,k≠ <dig>  resulting in a non-constant spline. additionally, one may ask whether there is a difference between the cell lines, but this question is not considered here .

both hypotheses are evaluated by means of the likelihood ratio statistic. for the first question on dna copy number the statistic is:
  

where e.g.  is the estimate of αj under the alternative hypothesis ha. p-values are then obtained from the asymptotic  distribution of the likelihood ratio statistics. the degrees of freedom of this chi-square distribution are equal to the difference in the number of parameters of the models compared. note that this test is likely to be somewhat conservative, because  shrinks towards the null domain. the dirac-gaussian mixture prior, however, prevents overly conservative behavior, because it better separates the null genes from the non-null ones than a simple gaussian prior. when testing , the degrees of freedom consumed by the penalized splines are estimated by the trace of hat matrix . finally, to account for multiplicity the false discovery rate  is controlled by means of the procedure of  <cit> .

this hybrid testing procedure  mimics limma  <cit> . limma obtains a shrunken  estimate of the variance and detects differential expression using a classical t-test . here too we borrow strength  across genes to arrive at shrunken parameter estimates, and provide classical p-values. the latter meets the wishes of medical researchers. they commonly report p-values rather than bayes factors. in addition, multiple testing corrections are generally more rigorous in a classical setting than in a bayesian one, because the latter typically provides fdr estimation rather than control.

spatial multivariate prior
dna copy number aberrations are often not confined to a single gene but span a large region of the genome that harbors multiple genes. consequently, neighboring genes may share the same genomic aberration signature. at the transcriptomic level this results in co-expression of these genes  <cit> . put differently, the dna copy number effect  of gene j may be correlated with that of neighboring genes . this phenomenon is not accommodated by the aforementioned prior of the βj.

in this section we describe an extension of our procedure that incorporates the possible spatial correlation among the dna copy number effects. to this end it is assumed that the βj follows a first-order autoregressive ) process along the genome: βj=ρβj−1+εj. the relevant parameter of this process is simply estimated by regression of the βj on the βj− <dig> 

having obtained an estimate of the spatial correlation among the βj, it rests to refit the model. however, the assumption of an ar process on the gene dosage effect complicates the refitting as this should now be done simultaneously for all p genes. this is computationally too demanding. to approximate the joint fit the model is refitted per triplet of neighboring genes . for each triplet a trivariate normal prior is assumed :
  

where the correlation structure of the covariance matrix follows an ar process. for the re-estimated vector of βjs only the middle one is conserved. more details are provided in additional file  <dig>  section  <dig> 

besides doing more justice to the underlying biology the ‘spatial prior’ above reduces the variation of the dna copy number effect. this is achieved as the assumption of an ar process effectively ‘averages’ the dna copy number effect over neighbouring genes. as such, it is also a way of borrowing information across genes.

practical considerations
a straightforward extension of model  is to allow for a different spline in each cell line. this reflects the biological plausibility of different dynamical behaviour in different cell lines. in particular, we may then test for differences in the behavior over time between the cell lines. when rewriting model  to a vector notation, the incorporation of different splines per cell line amounts to the replacement of  by  , and adjusting the parameter vector γj accordingly. figure  <dig> illustrates the difference between the same and different spline models.figure  <dig> 
illustration of the same and different spline model. each panel, one per cell line, plots gene expression against time. the solid red curve represents the fit of the model with a different spline per cell line, while the dashed blue lines depict the fit of the same spline model.



within mixed model  dna copy number and time  compete to explain the gene expression. due to its flexibility the spline may consume variation in expression levels actually due to dna copy number changes. moreover, with dna copy number changes being a more clearly delineated cause , we prefer to attribute variation in expression levels to the genomic aberration. to let dna copy number changes prevail over the spline, the design matrix z of the latter is orthogonalized to the dna copy number data. this orthogonalization does not affect the overall fit, but ensures that the spline captures only variation in expression levels that cannot be explained by dna copy number changes. the effect of the orthogonalization is illustrated in the section ‘hpv-induced transformation’.

to determine the optimal number of knots, we employ the deviation information criterion   <cit> . the dic is a measure for the balance between fit and complexity. for each gene the dic of the model is estimated for different numbers of knots. the number of knots that over all genes yields the best dic is chosen as the optimal k and applied to all genes in the analysis. more details are provided in additional file  <dig>  section  <dig> 

RESULTS
hpv-induced transformation
the proposed method is demonstrated on data of an experiment on hpv-induced transformation. the experiment intends to faithfully mimic cervical cancer development employing a hpv-immortalized in vitro cell line model. hereto two cell lines are affected with hpv <dig> and two with hpv <dig>  <cit> . over time these cell lines acquire genomic and transcriptomic changes. to assess these changes, the genomic and transcriptomic characteristics of the cell lines are measured at eight time points by means of oligonucleotide microarrays. the preprocessing of the dna copy number data comprises of median normalization and segmentation using the circular binary segmentation  method  <cit> . similarly, the gene expression data are background corrected using robust multi-array average   <cit>  and between-array normalized by the robust quantile method. finally, the resulting expression intensity values are transformed using the variance stabilizing transformation  <cit> . dna copy number is assigned to each transcript from the expression array by the overlapplus matching procedure of  <cit>  which uses chromosomal location information. the final data set contains genomic and transcriptomic information on  <dig> features, however in this section analysis is performed only on one chromosome which contains  <dig> features.

we now turn to the identification of genes with differential expression over time. to this end only the expression data features are used, ignoring the effect of genomic aberrations in model . gene j exhibits temporal gene expression if  is rejected. this corresponds to a spline differing from a flat line, and thus indicating changes in expression levels over time. temporal gene expression is identified both with a common and different spline for the cell lines. in both analyses the optimal number of knots equals two . specification of the prior distribution and description of the hyperparameter estimations for  can be found in the section ‘estimation’.
the number of significant probes identified in the analysis for temporal differential expression and copy number  effect


analysis is performed only on  <dig> features, which represent one chromosome.



the common and different spline models employed for the identification of temporal differential expression are now extended to include dna copy number . as noted in the section ‘practical considerations’ the flexibility of the spline may consume part of the dna copy number effect. the proposed remedy limits  the spline basis to the space orthogonal to space spanned by the dna copy number information. to assess the potential gain of the orthogonalization each analysis, with common and different spline, is done with and without orthogonalization. prior distributions are as before. the number of knots is determined as done previously . for each analysis hyperparameters of dna copy number and spline are re-estimated by the empirical bayes procedure.

we first discuss the number of features with differential temporal expression . as in the analysis without dna copy number, the different spline model identifies substantially more features than the model with a common spline for the cell lines. orthogonalization of the  spline basis onto the dna copy number data misses one feature in comparison to the non-orthogonalized analysis. this feature is found only with the non-orthogonalized spline basis. in the latter analysis it only passes the significance threshold by a small margin. hence, in these data the effect of orthogonalization on the identification of temporal differential expression is limited.

turning to the effect of dna copy number, we first analyzed the data with model  containing only the fixed cell line and dna copy number effect. this analysis identified  <dig> features with a significant gene dosage effect on expression. inclusion of the time effect in model  reduces the number of features with a significant gene dosage effect on expression . this is due to the fact that the spline competes with dna copy number to explain the variation in expression levels: the former  captures variation caused by the latter. that aside, here too we see that the improved fit  yields a surge in the number of findings. the orthogonalization of the spline basis identify only one additional feature  compared to the standard analysis. the effect of orthogonalization is more visible in the gene dosage effect βj, as can be witnessed from figure  <dig>  clearly, orthogonalization moves the distribution of the βj’s to the right . finally, on the full data set  the analysis using the orthogonalized spline basis gives a modest improvement in the number of genes significantly affected by dna copy number.figure  <dig> 
histograms of dna copy number parameters. the left panel represents dna copy number parameters estimated using standard spline design matrix, while the right panel indicates parameters estimated employing an orthogonalized spline design matrix.



the effect of dna copy number changes is also analyzed with the spatial prior discussed in the section ‘spatial multivariate prior’. this prior aims to capture roughly the spatial dependency between consecutive features, thus hoping to do more justice to the underlying biology. clearly, estimation of the gene dosage effects with the spatial prior improves the lag one partial correlation among these effects . changes in the actual parameters are noticeable but small. this has limited effect on the fit of the model. consequently, the significance analysis of the dna copy number effect identifies almost the same number of significant features . spatial prior imposed reduces the variation among contiguous features as, effectively, it has a smoothing effect on estimated dna copy number effects. figure  <dig> illustrates the spatial effect by showing the fit of the model with and without spatial priors on the dna copy number parameter . as in the temporal differential expression analysis, the number of features identified with standard or orthogonal spline basis hardly differs.figure  <dig> 
partial correlation of dna copy number parameter, where
β
j
is plotted against
β
j+1
. in the left panel parameters of dna copy number β
j are estimated univariate, while in the right panel parameters are estimated multivariate imposing the spatial prior.
the plot illustrates the effect of the spatial prior for one gene in a single cell line. gene expression is plotted against time and lines represent the univariate  and multivariate fit .



another striking feature of table  <dig> is the difference between the number of significant features with differential temporal expression and those with a gene dosage effect: the former exceeds the latter . in part this difference is explained by the flexibility of the splines. but also by the presence of many other regulators of gene expression  that result in temporal differential expression are captured by the splines. on the other hand, comparing the analyses with a common spline more significant gene dosage effect than temporal differential expression is found. this is due to the fact that dna copy numbers may strongly correlate with gene expression over time. features with expression levels that do not consistently  co-vary with dna copy number are missed by the common spline model .

to give some more tangible insight into the results from the analyses above, we single out the cadm <dig> gene. it is among the genes with the highest significance for temporal differential expression  with a common spline). indeed, cadm <dig> is down-regulated in all four cell lines over time . this gene is well-known in cervical cancer to be down-regulated during progression due to an increasingly methylated promoter region  <cit> . the fits of model  with and without dna copy number hardly differ. the estimate of the dna copy number parameter  confirms this (). this suggests that the down-regulation of cadm <dig> is not due to a dna copy number loss, which corresponds with previous findings .figure  <dig> 
expression levels of cadm <dig> over time. the solid red and dashed blue lines are the fits of the model with and without dna copy number parameter, respectively.



to contrast the results for cadm <dig>  we focus on the slc25a <dig> gene. slc25a <dig> exhibits temporal differential expression . slc25a <dig> is also identified as a gene with a significant dna copy number effect with estimate . inclusion of dna copy number in the model improves the fit substantially . this is seen in figure  <dig> as the difference in fit for the model with and without dna copy number. these results for slc25a <dig> corroborate with existing medical literature: the gene dosage effect for this gene has already been reported in cervical cancer  <cit> .figure  <dig> 
expression levels of slc25a <dig> over time in a single cell line. the solid red and dashed blue lines are the fits of the model with and without dna copy number parameter, respectively.



finally, we want to assess the sensitivity of the results with respect to the choice of the prior distribution. for illustration purposes we focus on the hyperprior of the random effect γk,j. in the section ‘estimation’ we suggest to use the gamma distribution. however, we have also implemented a mixture of a point mass at zero and gamma distribution, which one expects to lead to more shrinkage. model  using different splines and a standard design matrix is refitted now with this mixture prior for the random spline effect. application of our empirical bayes procedure with the gamma prior identified  <dig> features, while the dirac-gamma mixture prior selected  <dig> features. the latter  <dig> are all included in the former  <dig> features. the slight reduction in the number of selected features is of course due to the inclusion of the point mass at zero. the fit of both resulting models is almost identical for most features, but for some features with a slightly less flexible spline as in figure  <dig> .figure  <dig> 
this plot illustrates the effect of using different priors in one cell line. gene expression is plotted against time . the solid red line is the fit of the model with a standard prior, while the dashed blue line is that of the model with an alternative prior.



head-and-neck cancer
to illustrate the wide applicability of our framework, we present the analysis of sequencing data from a head-and-neck cancer study endowed with a time-course set-up. oshlack et al.  <cit>  noticed that there are currently no appropriate methods for the analysis of rna-seq data from time-course experiments. the head-and-neck study aims to identify temporal differential expression due to overexpression of a particular microrna. micrornas are small 20-22nt non-coding rnas that inhibit expression of their target genes. the micrornas recognize these genes by their seed sequence that is complementary to a sequence in the 3’ untranslated region  of the target transcripts. one gene can be targeted by multiple micrornas and one microrna may target a multitude of genes. it is therefore not simple to find a specific relevant target gene of a microrna. in a previous functional screen micrornas were identified that specifically kill head and neck cancer cells, but not normal cells  <cit> . the respective target genes of these micrornas were to be identified in a follow-up experiment. in this follow-up experiment cells of a squamous cell carcinoma cell line were transfected by a microrna mimic and a control. the transfected cells were grown in vitro and sampled at six time points. transcript levels of the 2× <dig> samples were sequenced. data were mapped to the human genome and raw count data  per gene transcript were used and not summarized per gene. their normalization comprises rescaling by a the trimmed mean of each sample’s library . normalized data are rounded to the closest integer to retain the count interpretation of the data.

model  cannot be directly applied to the sequencing data, as the normal distribution is often a poor approximation for the distribution of counts. the normality assumption is replaced by the  negative binomial  <cit> : -. the mean μi,j,t of the counts is  still modeled by the right-hand side of model  with assumptions on model parameters in place. hyperparameters are then estimated via the empirical bayes procedure previously described.

the analysis of the head-and-neck cancer data concentrates on two main questions: identification of tags with temporal variation and those different between the two conditions. to answer this, model  is used without the dna copy number term . common and different spline models are employed as in the section ‘hpv-induced transformation’. parameter γj is the main parameter of interest and the analysis compares the model with and without time effect. the optimal number of knots  is determined using the procedure described in the section ‘practical considerations’. prior distributions for cell line and time effect are as in the section ‘estimation’. hyperparameters are estimated for each analysis separately, but only the variance of the random time effect is shrunken via the empirical bayes procedure. counts of are fitted using the model with same and different splines as illustrated for one rna-seq tag in figure  <dig> figure  <dig> 
the dots represent the rna-seq tag counts plotted against time. the solid  line represents the fit of the model with different splines per group while the dashed  line that of the model with a common spline for both groups.



the number of tags with a significant  temporal variation identified equals  <dig>  for the common  spline model. as observed in the analysis of the hpv-induced transformation data, the use of a different spline leads to many more findings. again, this is explained by the improved fit due to a more flexible model. in particular, all the tags identified with the same spline model are also found by its flexible counterpart.

comparison
the proposed method is compared to three well-known alternatives for significance analysis of time-course microarray data: edge,  <cit> , timecourse,  <cit> , bats  <cit> , and a reference method. the reference method comprises a standard frequentist approach. it fits a linear mixed-effect model, while the null hypothesis is evaluated through an analysis of variance approach , comparing two nested models .

these competitors have not been designed for the analysis of integrative genomics studies with a time-course set-up. hence, our method is applicable to a wider class of studies. besides this qualitative argument, we wish to have a quantitative comparison of the methods. to this end the comparison is restricted to time-course genomics studies involving only a single molecular level. moreover, to avoid bias of any of the methods by a particular model choice, the comparison is done on two real data sets. the first is the hpv-induced transformation data from the section ‘hpv-induced transformation’, limited to the gene expression levels only. the other data set is included in the egde-package  <cit> , where gene expression has been monitored in four individuals from a control and endotoxin-treated group. samples have been collected at five different time points:  <dig>   <dig>   <dig>   <dig> and  <dig> hours after treatment. one individual lacks data for the control group at two time points . since the timecourse method cannot deal with missing time-points this individual is omitted from the analysis. at each time point expression levels of  <dig> genes are available.

we now briefly describe the other methods used in the comparison: edge, bats and timecourse. for a more detailed description please refer to the corresponding references.

edge  captures the temporal variation in the expression levels of gene j by means of a p-dimensional b-spline basis. temporal differential expression is evaluated by an f-statistic measuring the goodness-of-fit of the null hypothesis  in comparison to the alternative hypothesis. in the comparison edge is used with default parameter settings.

method timecourse  uses novel multivariate empirical bayes statistic to rank time-course gene expression profiles. gene expression in timecourse method is assumed to follow a multivariate normal distribution with gene-specific mean and covariance. conjugate priors are assumed on the unknown parameters. hyperparameters of the conjugates are estimated from the data. timecourse yields stable variance estimates by borrowing variance information across genes. the posterior distribution and test statistics are obtained in an analytic form. genes may be ranked using either hotelling t <dig> or mb-statistics. for the comparison we used the timecourse r-package with standard settings and hotelling t2-statistic, due to the balancedness of the study design .

finally, bats  which combines characteristics from previously described methods. similar to edge gene expression variation over time is modelled by a polynomial function, while imposing a hierarchical bayesian model on the parameters . bats is flexible in its choice of the prior for dispersion related parameters, it offers delta, inverse gamma and exponential priors. significance analysis is based on the genes’ bayes factors, while multiplicity correction is addressed in bayesian manner .

sensitivity and specificity of the four aforementioned methods are compared in both data sets. hereto knowledge of the genes with true temporal differential expression is needed. in its absence we constructed a consensus set which fulfills this role. that consensus set comprises of the features identified by all four methods. sensitivity is then the proportion of features with temporal differential expression correctly identified as such. on the other hand, specificity is the proportion of features which are correctly identified as features without differential expression over time . sensitivity and specificity of each method are assessed for various numbers of significant features.
comparison of sensitivity and specificity for tigar, edge, bats and timecourse on the data set of the section ‘hpv-induced transformation’. the left  panel displays the sensitivity of the methods  by plotting true  positive rate against the number of significant features.



furthermore, we compared the reproducibility of the five methods . hereto each data set was divided into two equally sized groups. we assessed how well the results of the two splits coincided. this boils down to the application of each method on both splits. the overlap in significant features for each method was determined.
reproducibility of tigar, edge, bats, timecourse and reference model are assessed on the data set of the section ‘hpv-induced transformation’. the number of significant features identified in both groups are plotted against the initial number of features.



CONCLUSIONS
we presented a method for the analysis of integrative  genomics studies with a time-course experimental design. the method identifies temporal differential gene expression while accounting for time-varying molecular covariates like dna copy number changes. simultaneously, the method assesses which of these covariates significantly contributes to temporal differential gene expression. the method employs a mixed model describing the temporal changes in gene expression in terms of dna copy number and a  spline which captures additional temporal variation in the transcript levels. the method estimates the parameters of this model by means of an empirical bayes procedure that ‘borrows information’ across genes. the empirical bayesian procedure shrinks the parameter estimates , thus accounting for multiplicity. this shrinkage enhances the reproducibility of the results. in a direct comparison with other methods for the identification of temporal differential expression, the proposed method proved to be a strong competitor, particularly in terms of reproducibility. in addition existing methods cannot incorporate additional genomics data. furthermore, our method is straightforwardly applicable to count data resulting from rna-seq experiments. application to an integrative oncogenomics study, involving hpv-transformed cell lines, confirmed genes cadm <dig> and slc25a <dig>  known to be implicated in the development of cervical cancer. the presented methodology also identified other, novel and potentially interesting genes. these are currently under investigation and will be reported in a follow-up medical paper. preliminary pathway analysis already showed that genes identified from this dataset by tigar but not by the other methods were enriched for genes involved in cellular transformation.

our ongoing research concentrates on two extensions of the proposed method. first, we are considering the inclusion of microrna data. micrornas affect expression levels post-transcriptionally. however, which microrna targets which mrna is only partially known. hence, integration of temporal microrna expression data also needs to address the problem of selecting the micrornas targets. with the number of micrornas known and typically measured in time-course integrative genomics studies being larger than the number of samples  this adds an additional layer of complexity to the problem.

the second extension comprises the integration of pathway information. this requires a multivariate formulation of the model for temporal changes in gene expression. next to dna copy number changes now the changes in transcript levels of other genes in the pathway may need to be included. a key challenge here is to ‘borrow information’ within and between pathways.

the methodology described in this paper is implemented in the r-package tigar available upon request from the first author .

electronic supplementary material
additional file 1:
supplementary material. supplementary document containing details about the simulation study setup, additional figures and tables. 

 competing interests

the authors declare that they have no competing interests.

authors’ contributions

vm, wnvw, smw wrote the manuscript. vm implemented the method in r, and performed the data analysis. this work uses an original idea by wnvw, further developed by wnvw, smw and vm. wnvw, mavdw, smw, rdms and pjfs supervised the work. smw, aj, rdms and pjfs generated hpv-induced transformation data and helped with the biological interpretation of the results. rhb and pivn generated head and neck cancer data and helped with biological interpretation of the results. all authors read and approved the final manuscript.

