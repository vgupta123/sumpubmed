BACKGROUND
the role of genetic deterioration in the extinction of endangered species or populations has long been controversial. for over  <dig> years, several authors have proposed that most populations go extinct for environmental or demographic reasons before genetic deterioration will affect them  <cit> . yet, theories predict that the properties of most threatened populations  should lead to inbreeding depression  <cit> , mutation accumulation  <cit>  and loss of evolutionary potential  <cit> . all these expectations have been empirically verified  <cit>  and the important role of genetic deterioration processes in population declines and extinctions has been demonstrated by empirical evidence  <cit>  and extensive analyses  <cit> . in spite of these lines of evidences, the weight of genetic deterioration mechanisms in limiting population viability remains difficult to evaluate, mainly because the classical approaches used to assess the "demographic" and "genetic viabilities" are different and neglect the interactions between demographic and genetic processes. in the field of conservation biology, population viability analyses  are generally based on demographic analysis, use species or population specific data, and apply emphasis to stochastic processes. although more and more demographic pvas include genetic considerations , most of these models focus on the effect of inbreeding depression only, with no possibility for selection to be accounted for mechanistically, and using inappropriate generic estimates of lethal equivalents.

on the other hand, genetically based viability assessments generally neglect realistic ecological constraints . contrary to demographic ones, insights on the "genetic viability" of species or populations use generic  data and come from two main categories of studies:  genetically determined minimum viable population sizes , corresponding to the size necessary to compensate the loss of quantitative genetic variation  by gains through mutations  <cit> ;  theoretical, metapopulation scale studies focusing on the dynamics of deleterious mutations and their effects on fitness  <cit> .

since the first formulation of the demographic-genetic  interactions  <cit> , a few theoretical studies have examined the viability of populations by considering the dynamics of the drift and inbreeding loads as well as explicit and realistic demographic and environmental constraints  <cit>  and no study has so far systematically and theoretically compared demographic, genetic and demo-genetic viabilities in realistic  environments. besides the fundamental importance of understanding how ecological and evolutionary proximal factors limit species viability , a general assessment of the conditions under which ecological or genetic factors are the most critical to viability might have considerable applications in the definition of species or population conservation status  <cit> . important fields of application are  the definition of mvps, which should differ according to whether ecological  <cit>  or genetic  <cit>  processes are considered. recent examples include demo-genetic modeling of lake sturgeon populations, indicating that mvp estimates are strongly underestimated if the effects of inbreeding are neglected  <cit> ;  solving potential antagonism between genetic and demographic aspects in metapopulations  <cit>  and considering genetic connectivity in reserve design   help defining optimal strategies in conservative restoration or supplementation programs  <cit> . for example, recent demo-genetic study on centaurea corymbosa, a narrow-endemic plant, provided guidelines for future reintroductions of the species regarding the number of seeds required and their initial distribution in space to limit the demographic effects of genetic self-incompatibility  <cit> .

here, i compute projected times to metapopulation extinction using three different stochastic simulation models:  a demographic model assuming that population growth is finite and has a constant expectation;  a genetic model accounting for variation in the drift and inbreeding loads. in this model, patch population sizes are assumed always equal to local carrying capacities. however, carrying capacities may vary through time in response to environmental variations, with subsequent effects on the dynamics of genetic loads. the metapopulation is assumed genetically extinct if the average genetic load reaches a certain threshold ;  a demo-genetic model accounting for demographic  and genetic processes  as well as demo-genetic feedbacks. similar environmental and intrinsic constraints were applied to these systems and the demographic, genetic and demo-genetic extinction times that they provided were compared.

 <dig>  
RESULTS
general relationships between ecological metapopulation settings and extinction times
comparisons between exponential and weibull survival models suggested that all extinction rates increased with time , so only weibull models were considered in subsequent survival analysis. comparisons among regression models indicated that  the models including all scenarios  and those including only the scenarios for which all trajectories were extinct after  <dig> , <dig> generations  are in excellent agreement;  the effects of ecological variables on demographic  and genetic  viabilities are qualitatively similar. in all cases, td and tg were positively related to dispersal rate, fecundity and total carrying capacity, while they decreased with fragmentation, as well as the frequency of perturbations . the spatial correlation of environmental perturbations  always reduced demographic viability  but had weaker and more complex effects on genetic viability.

although ecological variables had similar qualitative effects on the viabilities td and tg, the strengths of these effects differed considerably between the demographic and genetic models. a hierarchical partitioning  indicated that tg was mainly related to metapopulation size and fragmentation  while td mostly depended on the basic growth rate and the perturbation regime  .

therefore, when considering all extinct trajectories scenarios, demographic and genetic extinction times were only moderately correlated , but correlation increased when considering only scenarios with a constant environment . in most situations, the demographic extinction time  was longer than the genetic extinction time tg  but the distribution of the tg/td ratio was wide and skewed to the right . further analysis indicated that this ratio strongly increases with total population size and the frequency of perturbations level and decreases with fragmentation . hence, the ecological scenarios for which the genetic viability was higher than the demographic viability were those assuming large metapopulations and low levels of fragmentation .

comparisons between demographic and demo-genetic extinction times
as expected, adding genetic constraints to the demographic model always decreased viability. however, the ratio  varied strongly, from 10- <dig> to  <dig>  . multiple regressions and hp indicated that this ratio was mostly influenced by the perturbation regime and the basic fecundity . the demographic and demo-genetic extinction times were very close to each other in slow growing metapopulations with a highly variable environment. in other situations, tdg may be several orders of magnitude lower than td .

a univariate regression model indicated that td explains about 68% of the variance in tdg. the residuals of this regression were positively correlated with the metapopulation carrying capacity .

comparisons between genetic and demo-genetic extinction times
surprisingly, adding demographic constraints to the genetic model reduced viability in only 66% of the scenarios investigated . the analysis indicated that this ratio was mostly influenced by population size and fragmentation . in small and highly fragmented metapopulations, the genetic extinction time was shorter than the demo-genetic extinction time while the reverse was generally true in other cases .

use of td and tg to estimate tdg
when considered as single predictors in extinct trajectories scenarios, td and tg explained respectively 68% and 65% of the variance in the demo-genetic time to extinction. using the maximum value  did not improve model fit , while using the minimum value increased the r <dig> to 78%, a value close to the r <dig> obtained by including both tg an td in the model . the interaction term between tg and td was positive and highly significant but only marginally improved model fit .

complementary analyses
a complementary analysis indicated that the type of environmental perturbations considered does not influence the qualitative effects of ecological variables on td and tg and tdg, although the quantitative effects of f and p on td may vary with the type of perturbations .

a focus on the effect of fragmentation on extinction times
the effect of the level of fragmentation  on demographic, genetic and demo-genetic viabilities is illustrated in figure  <dig>  the comparison between demographic and genetic viabilities revealed contrasting patterns. with the demographic model, the optimal level of fragmentation increased with overall population size and dispersal rates and could reach high levels . in contrast, genetic viability was maximized with low fragmentation levels  in all situations. in this context, the consideration of demo-genetic interactions tended to buffer extinction times and all demo-genetic optimal fragmentation levels were intermediary between optimal demographic and genetic levels. these patterns remained qualitatively as long as environmental perturbations are spatially independent .

 <dig>  discussion
similarities and differences in demographic and genetic extinction patterns
most ecological settings considered here had similar qualitative effects on demographic and genetic viabilities, in agreement with theoretical expectations. large population sizes allow limiting demographic stochasticity  <cit>  as well as the inbreeding and drift loads  <cit> ; high dispersal rates are associated with demographic rescue and recolonization  <cit>  and reduced drift load  <cit> ; perturbations cause population bottlenecks that are directly associated with demographic extinction and inflate the genetic load  <cit> ; high fecundity rates allow counteracting the effect of demographic and environmental stochasticities  <cit>  and elevate the genetic extinction load threshold. only fragmentation  has less obvious effects . however, despite these similarities, the processes leading to "demographic" and "genetic" extinctions are fundamentally different. demographic viability is related to the mean and variance of the rate of increase  <cit> , which are primarily influenced by the perturbation regime and the basic growth rate . in contrast, genetic viability is associated with the inbreeding and drift loads, themselves primarily related to population size and fragmentation . the causes and implications of this are further developed below.

demographic processes and hard selection models
while the genetic model presented here is a soft selection model , the integration of demographic processes  clearly adds a hard selection component . theoretical work predicts that  with soft selection, population structure should reduce the efficiency of selection against mildly deleterious, nearly additive mutations  <cit>  but will favor selection against severe and highly recessive mutations  <cit> ;  with hard selection, structure should lead to reduced loads even with additive or nearly additive mutations  <cit> .

while the present results are in agreement with predictions from soft selection models, the beneficial genetic effects of population structure expected under hard selection are not visible with the present demo-genetic model . this discrepancy is due to the fact that  the demo-genetic model is only a partial hard selection model, as local population size primarily depends on regulation processes ;  potential genetic effects are masked by demographic effects ;  the genetic and demo-genetic viabilities expressed in the present paper do not necessarily reflect expected equilibrium patterns. in particular, the purging processes leading to reduced inbreeding or drift load may be demographically costly, which implies that some metapopulations will have a low demo-genetic viability despite a small expected equilibrium load.

why genetic models are insufficient to estimate viability
it is generally admitted in the theoretical literature that ecology-genetic interactions should strongly influence the persistence time of populations  <cit> . the demo-genetic interaction refers to the fact that the occurrence of genetic processes is affected by the demographic state of the population, and vice versa, leading to synergistic or antagonistic effects on viability. here, the process of demo-genetic extinction may be decomposed in two phases: an accumulation phase, during which the overall genetic load increases while population size remains approximately equal to the carrying capacity, and an extinction phase during which the population declines to extinction. demo-genetic interactions are important in both phases:  during the accumulation phase, stochastic variations in population size decrease the effective size and accelerate the rise of the genetic load;  during the extinction phase, the population decline increases the rate of mutation accumulation, which in turns accelerates population decline .

the extinction phase  is generally assumed much shorter than the accumulation phase in theoretical genetic models, and the extinction time is assumed equal to the duration of the accumulation phase . here, in all scenarios, the initial decrease in fitness was more rapid with the demo-genetic model as compared with the genetic model . this led to tdg < tg in two thirds of the scenarios investigated, in agreement with previous findings on the demo-genetic interaction. however, in the other third of the scenarios, demo-genetic viability was higher than genetic viability . this comes from the fact that populations may be demographically resilient and persist several generations after their growth rate has become negative . therefore, fitness-based estimations of viability may lead to strong over- or under estimations of the risk of extinction, depending of the relative weights of the demo-genetic interaction and the demographic resilience on viability.

why demographic models are insufficient to estimate actual viability
as expected, incorporating genetic considerations to the demographic model was unequivocally deleterious. however, the magnitude of the reduction in viability was highly variable. it is generally admitted that the proportional effect of genetic deterioration on viability should be larger for populations with a high demographic viability  <cit> . while the present results are in clear agreement with this expectation, they highlight the critical need to distinguish the intrinsic and extrinsic ecological threats to population viability to estimate the effect of genetic problems on extinction. in some of the scenarios investigated, the demo-genetic extinction times were about half the demographic extinction times, while in other cases they were  <dig>  times shorter. typically, the first situation corresponds to large populations with highly variable, low quality environments , while the later corresponds to small, fragmented populations in stable, good quality environments . in the context of the debate over the environmental versus genetic causes of species extinction, the present results demonstrate that the arguments of the partisans of the environment  <cit>  and genetic  <cit>  hypotheses are both theoretically justified. the net impact of genetic deterioration processes on extinction may be strongly variable among and within species, since it strongly depends on the ecological conditions faced by metapopulations . importantly, however, many human induced environmental changes are likely to engender situations where genetic deterioration is the primary extinction cause, in particular where available habitats have been reduced in quantity, and not in quality.

the case of fragmentation
contrary to other ecological settings , fragmentation has non obvious  qualitative effects on demographic and genetic viabilities. from a genetic view-point, most theoretical studies agree that subdivision has detrimental effects on fitness . in the ecological literature, conclusions are less clear  <cit> . the optimal level of fragmentation depends on overall population size and dispersal  as well as on the regime of perturbations  <cit> . in the absence of fragmentation , strong perturbations may rapidly drive the whole population to extinction, even if population size is large  <cit> . in contrast, with very high levels of fragmentation , environmentally induced extinction risk is spread over several units, but the probability of local extinction due to demographic stochasticity increases as local population sizes decrease. thus, in many realistic situations, an intermediate level of fragmentations will be optimal. theoretical work indicates that this general result remains true under a wide range of realistic conditions, provided that  the cost of dispersal is not too strong;  environmental variations are not fully correlated among patches of habitats  <cit> .

consequently,  demographically optimal levels of fragmentation may be much higher than genetically optimal levels;  demo-genetic optimal levels are, in most cases, intermediary between demographic and genetic optimal levels . this implies that optimal levels of fragmentations  may be either under- or over-estimated when based on simple demographic or genetic approaches.

 <dig>  
CONCLUSIONS
understanding the fine mechanisms of extinction is essential to the study of evolution and has crucial implications in the context of the current human induced mass extinction crisis  <cit> . in the field of conservation biology, the definition of species or population conservation status is generally achieved by considering both ecological and genetic constraints  <cit> . however, there is no framework to hierarchise these constraints. for example, when assessing extinction risk of a given population, should one give priority to the demographically based or genetically based estimate? the more pessimistic one? something intermediary between both? these questions are even more important when considering situations where demographic and genetic assessments lead to contradictory management strategies, e.g., in reserve design  <cit>  or supplementation programs  <cit> .

the present results indicate that  in most cases, the demo-genetic extinction time is lower than both the demographic and genetic extinction times, due to a demo-genetic interaction;  while the demo-genetic extinction time is weakly correlated with demographic and genetic extinction times, it is substantially more correlated with the minimum between them, suggesting that considering the most limiting factors  to estimate population viability is a reasonable approach;  a given population may have a high demographic, but low genetic viability or vice versa.

at the evolutionary and ecological scales, most species extinctions are ultimately caused by changes in their environment. however, particular environmental constraints may primarily affect either demographic, genetic processes, or both of them. an illustration of this point is the contrast between captive and wild threatened populations. small captive populations face important deleterious evolutionary changes  but are demographically safe . on the other hand, wild populations with larger carrying capacities and sizes suffer less genetic problems but are ecologically vulnerable . while this antagonism is addressed in recent work in the particular context of the wild/captive population systems  <cit> , there is still no general framework to evaluate how various constraints affect demographic and genetic possesses, and to estimate their respective weights in limiting the persistence of species. the present results indicate that, although most environmental constraints have similar qualitative effects on genetic and demographic viabilities, direct threats or constraints associated with reductions in habitat quality  will primarily decrease demographic viability, whereas reduction in habitat quantity  will primarily affect genetic processes.

 <dig>  methods
i used a monoecious, individual-based model with discrete generations to describe the dynamics of a metapopulation with n patches and a total carrying capacity kt.

selected genetic variation
the genome of each individual was explicitly represented as l =  <dig> different diploid loci that could carry either a wild-type or a deleterious allele. following the approach of jaquiéry et al.  <cit> , i considered variable selection  and dominance  coefficients among loci and a negative correlation between them  <cit> . selective coefficients were exponentially distributed among the l loci, with an average severity set to s =  <dig>   <cit> . at each locus k, the dominance coefficient hk was computed as hk = exp/ <dig>  where c was a constant computed so that the expected dominance of all mutations in the genome equaled h =  <dig>   <cit> . during fertilization, the probability of transmission of each allele at each locus was given by mendelian rules. new deleterious mutations stochastically occurred in each zygote . i assumed no epistasis, no linkage and no reverse mutations. importantly, the mutation parameters used in the present study derive from model organisms, such as drosophila, nematodes or bacteria. these estimates are used in most theoretical studies, and should be viewed as conservative estimates .

at each locus k, the initial frequency of deleterious alleles was given by the mutation-selection balance  <cit> : q0k = u/. the genome of the initial population considered at t =  <dig> was implemented according to these frequencies . thus, the individuals present at t =  <dig> derived from a large panmictic population .

i assumed that deleterious alleles acted on offspring viability. the proportional reduction in survival of the individual i was then given by

 wi=1w <dig> ∏lwki 

where wki was equal to  <dig>  1-hksk or 1-sk, for a locus k without mutation, with a heterogeneous deleterious mutation, or a homozygous mutation, respectively. w <dig> was the expected initial reduction in fitness due to deleterious alleles present at time zero, given by

 w0= ∏lq0k 

in each generation t, the average reduction in survival of the metapopulation ) was computed.

demo-genetic model
in each generation t, in each patch j, all individuals paired randomly with possibility of self-fertilization at the random rate. the fecundity of each individual was determined by a poisson trial of parameter f. punctual negative environmental perturbations resulted in a reduction  of local offspring survival. the survival of each offspring i present in patch j at generation t was drawn from a bernoulli function of expectation s0i = )wi, that depended on the genetic characteristics wi of the individual  and on the occurrence of a local perturbation. the occurrence of a perturbation was determined by a bernoulli trial of parameter p . if no perturbation occurred in patch j at time t, pj was set to zero. if a perturbation occurred, the value of pj was drawn from an empirical severity distribution  <cit> . the parameter cp denoted the degree of spatial correlation of perturbations. i considered two extreme situations where perturbations were either independent  or fully correlated in time  across patches. an alternative method to model perturbations  is presented in results and additional file  <dig> 

i assumed that all patches had the same maximum local carrying capacity , and were initially at their carrying capacity. all parents died after reproduction. local regulation consisted in a truncation of population size of the offspring to k in each generation for each patch. truncation was made independently of the genetic qualities of individuals.

dispersal occurred by assuming that a proportion m  of the individuals present in each patch after the selection and regulation steps  emigrated  in each generation. extinction occurred when there were no more individuals in the metapopulation.

genetic model
in each generation t, in each patch j, two parents were randomly selected to reproduce. fertilization and new mutations occurred as described above to create the new individual i, that survived or not, according to its relative fitness wi . this operation  was repeated until there was kj surviving offspring. then all parents died. kj, the carrying capacity of each patch j at generation t, depended on the occurrence of a perturbation in patch j. it was computed as the rounded value of k), where pj was as described above for the demo-genetic model. in case where all local carrying capacities equaled zero, one patch was randomly drawn and its carrying capacity was set to one, so that the overall carrying capacity was always higher than zero. here, contrary to the demo-genetic model,  population dynamics were independent from w and f. local populations were always at their carrying capacity, which could vary for environmental reasons as in the demo-genetic model: perturbations were modeled by the parameters p  and cp  and acted by temporally reducing local carrying capacities ;  "demographic extinction" could not occur . environmentally-driven variations of population size  tended to reduce the long term effective size and increase the inbreeding level, with subsequent effects on selection. the metapopulation was assumed "genetically extinct" when the average offspring survival w dropped below the threshold w* = f- <dig>  where f was the average basic fecundity . dispersal occurred as for the demo-genetic model.

demographic model
the demographic model worked similarly to the demo-genetic model, but the effect of selected genetic variation on population dynamics was removed . the similarities and differences between the demographic, genetic and demo-genetic models are summarized in table  <dig> 

f : fecundity per individual; wi : juvenile survival for individual i ; w : average offspring survival; m : emigration rate; k : local carrying capacity; size : total metapopulation size.

simulation protocol
demographic, genetic and demo-genetic metapopulation viabilities were examined by assuming that time zero corresponded to sudden environmental changes . i used monte carlo simulations for  <dig> combinations of the ecological input parameters . for each combination,  <dig> population trajectories were drawn. in each case, the median times to demographic, genetic and demo-genetic extinction were computed . i was interested in investigating the viability of small to medium metapopulations  with a wide range of persistence times. with the demo-genetic model , typical persistence times were a few tens or hundreds of generations ; however, in some scenarios assuming large populations with high and stable growth, times to extinction could be very long, especially with the demographic or genetic sub-models. therefore, for technical reasons, all trajectories were stopped after  <dig> , <dig> generations. in scenarios for which one or several trajectories were non extinct after  <dig> , <dig> generations, extinction times could not be computed. these extinction times were treated either as right-censored data  or as lacking data in statistical analyses .

n: number of patches; kt: total carrying capacity of the metapopulation; m: dispersal rate; f: individual fecundity; p: per generation frequency of environmental perturbations; cp: spatial correlation of perturbations.

statistical and graphical analysis
i used survival models, generalized linear models  and hierarchical partitioning  to examine the relationships between ecological input parameters and extinction times.

as a first step, exponential and weibull survival models assuming right censored extinction events were fitted to examine the relationship between extinction times  and ecological input parameters, considering all  <dig> scenarios. the weibull and exponential models were compared to describe whether extinction rates were constant over time or not  <cit> .

as a second step, glm and hp were applied to those scenarios for which extinction times were available  to examine variations in the ratios of extinction times  and their relationships with ecological variables. hp uses all models in a regression hierarchy to distinguish those variables that have high independent correlations with the dependent variable. at all steps, results from the survival models, glm and hp were compared to help interpretation. although most extinction events occurred within the range 10- <dig>  generations , the variance was high and the distribution of extinction times was non-normal. thus, graphical results are presented using logarithmic scales and extinction times were log-transformed  in all statistical analysis. other dependent and independent variables were transformed using usual functions to achieve the best linearity . the aim of these analyses was not to test the significativity of regressions but rather to examine the direction and strength of relationships between ecological variables and viabilities  <cit> . all qualitative results were compared to theoretical expectations and in cases where results were different from expectations, additional simulations were run to determine the underlying causes of observed patterns. metapopulation models were developed in pascal language . all statistical analysis was performed with r  <dig> . <dig>  <cit> , specifically using the survival  <cit>  and hier.part  <cit>  packages.

supplementary material
additional file 1
linear relationships between ecological parameters and viability metrics. contains details on statistical analysis of model outputs.

click here for file

 additional file 2
sensitivity of fragmentation results to genetic parameters .

click here for file

 additional file 3
effect of fragmentation on extinction times: regime of spatially correlated perturbation.

click here for file

 additional file 4
effect of fragmentation on extinction times: complementary results .

click here for file

 additional file 5
fitness and population size reductions: an illustration.

click here for file

  <dig>  acknowledgements
i am grateful to three anonymous reviewers for valuable comments on an earlier version of the manuscript.
