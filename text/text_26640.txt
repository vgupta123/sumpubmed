BACKGROUND
as the leading cause of development failure in clinical trials and withdrawal of drugs from the market, drug-induced liver injury  is one of the most important factor in drug development  <cit> . the severe adverse effects of dili, which include acute liver failure and jaundice, must be considered in drug development. the toxicity of these drugs is attributable to their conversion in the liver to highly reactive metabolites that cause organ damage . however, determining dili potential is a very challenging task, primarily because animal studies do not efficiently predict dili potential in human. for example, in a phase ii clinical trial, acute liver toxicity induced by fialuridine led to the deaths of five subjects, in contrast to its safe use in animal studies  <cit> . in a study of  <dig> pharmaceutical products, the rate of concordance of hepatotoxicity in humans and animals was low, approximately 55%, whereas the rate of concordance was much higher in other target organs, including the hematological , gastrointestinal , and the cardiovascular  systems  <cit> . in addition, clinical features or laboratory tests for predicting dili potential have not been identified  <cit> . moreover, the statistical power of clinical trials is insufficient. severe idiosyncratic hepatotoxicity occurs at very low frequency, and patient samples in clinical trials number only in the thousands. due to this low statistical power, even well-controlled clinical trials can fail to predict dili.

to overcome these problems, many researchers have sought to evaluate the toxicity of compounds in vitro and/or in vivo. however, considering the number of compounds, this approach is time-consuming and costly, and thus there has been much effort to develop prediction models to determine if a compound could cause liver toxicity. computational modeling approaches have been adopted by pharmaceutical companies to help evaluate the efficacy, toxicity, and metabolism of pharmaceutical ingredients  <cit> . in the early stages of the development of prediction models, the predictive power of the constructed models was not satisfactory, and models often relied on experimental data for better performance. some researchers used molecular signatures, such as for alanine transaminase , aspartate aminotransferase , and alkaline phosphatase , all of which are commonly assessed in the diagnostic evaluation of hepatocellular damage  <cit> . in more recent years, machine-learning algorithms for prediction models have also been developed to obtain better predictions  <cit> . however, experimental data are limited utility in constructing prediction models. therefore, several researchers have focused on computational predictions using compound properties and structural characteristics. greene et al. developed structure-activity relationships for potentially hepatotoxic compounds  <cit> . compounds were categorized into four classes associated with hepatotoxicity: no evidence, weak evidence, animal hepatotoxicity and human hepatotoxicity. the resultant hepatotoxicity alerts yielded a concordance of 56%, a specificity of 73%, and a sensitivity of 46%. ekins et al. built a classification model based on the bayesian modeling method with molecular descriptors and fingerprint descriptors  <cit> . the evaluation of the classifier demonstrated a concordance of 60% for internal validation and 64% for external validation. rodgers et al. also developed a quantitative structure-activity relationship  model using liver adverse effects of drugs  as a dataset. they used information on enzyme markers of hepatotoxicity, but these markers can fluctuate due to other factors throughout the day  <cit> . moreover, huang et al. developed a prediction model based on qsar using a variety of descriptors including fingerprints. their model performed well with an accuracy of  <dig> % in internal validation. they further predicted the potential hepatotoxicity of traditional chinese medicines  <cit> . zhang et al. also developed an in silico prediction model for dili. they used three different fingerprints and five machine-learning algorithms and obtained a concordance of 66% using the support vector machine algorithm and fp <dig> fingerprint, in addition to identifying important substructure patterns related to liver toxicity  <cit> . despite these extensive efforts to predict dili, there are no standard qsar models for dili, in contrast to the availability of qsar models for mutagens. moreover, less is known about the substructures that are significantly associated with dili .

thus, in this study, we focused on improving dili prediction models using bayesian weighted substructures and identifying frequently appearing substructures that might be key for dili . first, datasets from the liver toxicity knowledge base  and the drugbank database were obtained and pre-processed  <cit> . we then extracted substructure feature information from  <dig> compounds. the weighted features were obtained from the calculation of the bayesian probability for each substructure represented in a compound fingerprint. the prediction models were trained by two algorithms and evaluated with an independent test set of unseen  <dig> compounds. finally, the constructed models were used to predict the hepatotoxic potential of herb-related compounds from herb databases. moreover, several frequent substructures related to dili-positive compounds were reported as alerts.fig.  <dig> overview of prediction model construction




methods
data preparation
the liver toxicity knowledge base benchmark dataset  and the drugbank database were used as training datasets. ltkb-bd is a benchmark dataset provided by the national center for toxicological research , u.s. fda  <cit> . this dataset contains a list of drugs with dili potential in humans in accordance with fda-approved prescription drug labels. drugs in the dataset are categorized into one of three groups based on their description and severity: most-dili-concern, less-dili-concern, and no-dili-concern. drugs with a black box warning of hepatotoxicity or that were withdrawn from the market were classified into the most-dili-concern category. the drugs in that class were labeled due to their fatal hepatotoxicity, including liver necrosis, jaundice, and acute liver failure. the less-dili-concern drugs included those with moderate dili warnings, and drugs without any dili indication were classified as no-dili-concern drugs. in this study, we began by labeling  <dig> dili-concern drugs and  <dig> no-dili-concern drugs from the ltkb-bd as positive and negative, respectively. we then retrieved simplified molecular-input line-entry system  information using chemspider python api by name matching  <cit> . the smiles information was further used to obtain molecular fingerprints for use as features in model training and construction. we selected only one-matched compounds for higher confidence because chemspider api offers a partial matching service. finally, we obtained  <dig> positive and  <dig> negative compounds.

moreover, we retrieved additional negative data from the drugbank database to balance the data size. from the drugbank database, we extracted fda-approved drugs, with a focus on drugs approved for more than 10 years. the database provides a ‘started-market-date’ and an ‘ended-market-date’, and thus we set the limits to ‘2006’ for the started-market-date and to ‘none’ for the ended-market-date. we again queried chemspider api to obtain the smiles information for these drugs, and we removed the drugs overlapping with the ltkb dataset by comparing the smiles information. finally, we identified  <dig> negative compounds from the drugbank database. in total,  <dig> positive compounds and  <dig> negative compounds were used as the training dataset as listed in table  <dig> table  <dig> the number of compounds used in training and the independent test




molecular fingerprints
molecular fingerprints are a representation of the structure of a compound. fingerprints are widely used in chemical informatics because they consist of bitstrings, which facilitate molecule comparisons. each bit of a fingerprint represents a specific substructure of a molecule, and the annotation of the substructure depends on the type of fingerprint. in the current study, we used pubchem fingerprints , which have a length of  <dig> bits. each bit represents the presence of an element, the count of a ring system, the atom pairs, the atom’s nearest neighbors, and the smarts patterns. the pubchem fingerprint was chosen for substructure reporting in the present study because it describes the structure of a molecule in detail with a long bit-vector. to retrieve fingerprint information, we used the padel-descriptor, which is software used to calculate molecular descriptors including 1d, 2d, and 3d descriptors and  <dig> types of fingerprints for the pubchem fingerprint  <cit> . the software can be downloaded online and supports a graphical interface.

bayesian theory for feature weight calculation
a molecular fingerprint is a binary vector and thus is composed of zeros and ones. the fingerprint indicates the presence of a substructure in a molecule. in this study, we focused on substructure information in dili-positive compounds, and therefore, we used bayesian theory to identify frequent substructures in dili-positive compounds that might cause hepatotoxicity. first, we calculated the probability that a compound was dili-positive/negative given that a structure was present/absent , where p and n each represents positive and negative label, and s indicates a substructure.  <dig> pp|s=ppsps=ps|pppps|ppp+ps|npn 


however, if we calculate the bayesian probability as in the equation above, a substructure will have a probability value of zero if it is absent from both positive and negative compounds. a zero probability does not indicate that a substructure is always absent in either case. if we increase the size of the dataset, those bits might appear. therefore, to avoid zero probabilities, we used laplace smoothing, which is a technique that pretends we observed every outcome k extra times .  <dig> plap,kx=cx+kn+k|x|,plap,kx|y=cxy+kcy+k|x| 


we then calculated the log odds ratio for each substructure .  <dig> log2pp|spn|s 


if the ratio value of a substructure is high, it means that the substructure appeared more frequently in dili-positive compounds. we then set the threshold to give weight using the log odds ratio values. the values of the selected substructures that were greater than the threshold were weighted by multiplying and amplifying the original odds ratio by n in fig.  <dig>  by contrast, the substructures with odds ratio below the threshold received a weight value of one. here, we only gave weight to high log odds ratios because we wanted to predict dili-positive compounds, which are toxic and therefore more critical to predict than negative compounds. the calculated weight vector was then multiplied element-by-element to the original fingerprint. the overall process of weight calculation is illustrated in fig.  <dig> fig.  <dig> the process of feature weight calculation. first, the bayesian probabilities for each substructure were calculated. then, substructures selected based on a log odds ratio threshold were weighted, while others remained binary. when calculating the weight vector, the feature values  of selected substructures were amplified by a user parameter n. the constructed weight vector was then multiplied with the original feature matrix




the random forest  and the support vector machine  algorithms were used to construct the classification and prediction model. the rf algorithm is an ensemble learning algorithm that operates by constructing a large number of decision trees and collecting them. when it devises a prediction, it runs a new input for every decision tree and votes on how it is to be classified. the main advantage of the rf algorithm is that it avoids overfitting problems, which occur frequently when dealing with a small dataset. the implementation of the algorithm is found in matlab statistics and machine learning toolbox . the treebagger function was used for the rf algorithm. svms are among the most popular supervised machine-learning algorithms for pattern recognition and are also used for classification. svm constructs a hyperplane that is used for classification using specified training examples, each including a category label. the constructed model can then be used to predict the dili potential of a new drug. the implementation of the svm we used is a library for support vector machines   <cit> . when training a model, we used similarity matrices calculated using the tanimoto coefficient, a similarity metric that uses the ratio of the intersecting set to the union set because the constructed space would be very high-dimensional with  <dig> features. the use of similarity matrices reduces the dimensions to the data size.

when training the models, we performed 10-fold cross-validation, which divides the training dataset into ten subsamples. nine subsamples are used for training, and one subsample is used for testing. we constructed each model with different thresholds and multiplication numbers, and we compared the performances to select the best model for prediction.

independent test
the data from previous studies were used for further evaluation. we collected the independent test set from two studies: greene et al. and xu et al.  <cit> . greene’s dataset was categorized into four groups: hh ; ne ; we ; and ah . to use strict data, we used the compounds in the hh and ne categories as positive and negative, respectively. after combining the two datasets, we pre-processed the resultant dataset in the same manner as the training set. the smiles information was retrieved from chemspider and was used to eliminate duplicates from the training set and eliminate label contradictions between the two sets. in total, we obtained  <dig> compounds, including  <dig> positive and  <dig> negative.

prediction of natural products
the constructed classification model was then applied to predict the potential hepatotoxicity of natural products. we collected herbal compound information from the tcmid, tcm-id, and kampo databases , all of which contain information about the efficacy of herbs and their constituent compounds. the natural product dataset was also standardized by chemspider, and a fingerprint was obtained. fingerprints were not able to be retrieved for a few compounds, primarily very complex, large molecules with a mass greater than 1000 da. these compounds were excluded, resulting in a final total of  <dig>  compounds.

RESULTS
frequent substructures in hepatotoxic compounds
one of the main purposes of this research was to identify important substructures in dili-positive compounds. the frequently appearing substructures can be inferred from the weighted substructures. we first calculated the probabilities of each substructure to be in positive and negative labeled compounds respectively. then with the log odds ratio of positive to negative we selected substructures to be weighted. we determined the weighted substructures by high log odds ratio values, since we focused on substructures which are frequent in dili-positive compounds. with a log odds ratio threshold of  <dig> , we identified  <dig> substructures.the following substructures with other various threshold values are described in additional file 1: table s1–s <dig> 

model performance
we compared the model without weighted features to the model with weighted features to assess whether giving weights to the frequently appearing substructures affected performance. as shown in fig.  <dig>  models with weighted features performed better in both algorithms. although the rf model previously performed poorly, with the weighted feature, the auc, aupr, and accuracy increased significantly to  <dig> ,  <dig> , and 74%, respectively. likewise, the svm performance also increased, although models without features were already classified quite well. the auc, aupr, and accuracy values were  <dig> ,  <dig> , and 73%, respectively. all models with different thresholds and multiplication numbers were compared. the rf model performed best with a threshold of  <dig>  and a multiplication number of  <dig>  and the svm model performed best with a threshold of  <dig> and multiplication number of  <dig>  a performance comparison using different thresholds can be found in additional file 2: figure s1–s <dig> fig.  <dig> performance of the models in cross-validation. performance in both rf and svm increased with weighted features




furthermore, we compared the performance of the constructed models in an independent test to evaluate the performance with unseen data set. figure  <dig> shows the increased performance with the weighted features. although the sensitivities were high in the non-weighted models, the specificities were very poor. using the weighted feature, the specificity of both models increased to greater than  <dig> , and the overall accuracy values increased slightly.fig.  <dig> performance of the models in the independent test. the gap between sensitivity and specificity decreased and the accuracy increased with weighted features in both models




we implemented a model from zhang’s study for further performance comparison. they developed prediction models with various fingerprints and machine-learning algorithms. we constructed an svm model with the dataset provided by zhang et al. using fp <dig> fingerprints and applied our proposed feature weight calculation method. our method increased the accuracy from 75% to 87% . although the sensitivity decreased slightly, the specificity increased dramatically from  <dig>  to  <dig> , indicating that our method performs well in predicting both negative and positive compounds. as a more precise comparison, we randomly selected  <dig> positive and  <dig> negative compounds from the ltkb dataset a hundred times, and our method resulted in a higher average accuracy of  <dig> %. this result indicates that our method exhibits superior classification and prediction of dili compounds under the same conditions.fig.  <dig> performance comparison between the previous study and the proposed method. our method increased the performance overall compared with that reported by zhang. in particular, the specificity increased dramatically, although the sensitivity decreased slightly




prediction of hepatotoxic compounds in natural products
the hepatotoxic potential of the herb-related compounds was predicted using the constructed models. since the parameters and algorithms in each model vary, the results differed slightly, but the models predicted that more than 60% of compounds in natural products have hepatotoxic potential. rf predicted  <dig>  compounds as hepatotoxic, whereas svm predicted  <dig>  compounds as dili-positive. although the two prediction models yielded different outcomes, the predicted positive compounds greatly overlapped, as shown in fig.  <dig> fig.  <dig> the proportion of predicted compounds in herbs. a rf predicted 67% of compounds as dili-positive. b svm predicted 79% of compounds as dili-positive. c the number of overlapping compounds predicted by the two algorithms




discussion
in the current study, we calculated the weighted feature using bayesian theory and constructed dili prediction models using the updated feature with two algorithms: rf and svm. when calculating the weight vector, we focused on giving weight to those features that appeared more frequently in dili-positive compounds than in dili-negative compounds because it is more important to identify hepatotoxic compounds that might cause critical adverse reactions when developed into drugs. therefore, we set a cutoff to select the substructures to be weighted by their log odds ratio values. the threshold ranged from  <dig>  to  <dig>  and resulted in different performances. with an excessively low threshold, the number of weighted substructures was too large, causing the overall values of the weight vector to increase without differentiating specific substructures and, consequently, poor model performance. by contrast, the use of an excessively high threshold would weight too few substructures, resulting in a decrease of performance. the parameter multiplied with the selected substructure also affected the performance, but the effect was not significant. this result indicates that amplification of values is important but that the degree of amplification does not significantly affect model performance.

both constructed models resulted in good performance in cross-validation considering auc and accuracy; however, the accuracy of the independent test slightly decreased compared to the results of cross-validation. the low accuracy was due to low specificity, indicating that the model tends to predict more compounds as positive than it predicts as negative. this problem occurred because we focused on predicting dili-positive compounds by weighing the related substructures and used a sensitivity threshold of  <dig> , which could be relatively high. because it is safer to predict negative compounds as positive  than to classify toxic compounds as nontoxic, we did not lower the threshold but attempted to reduce the gap between sensitivity and specificity using a weighted feature. this approach helped increase the accuracy. although the increase in accuracy was not dramatic, the model classified the independent test set more precisely, positive to positive and negative to negative. the results also demonstrated that the weighted substructures affected the prediction of dili-positive compounds.

in this study, we also determined frequently occurring substructures in dili-positive compounds. although the substructures with the highest probability are general, as the threshold lowers, more details in the smarts patterns can be observed. we obtained general structures because of the characteristic of pubchem fingerprints, which divide a structure into lower levels.

the prediction of the dili potential of natural products indicated that many compounds are related to drug-induced hepatotoxicity . if compounds found in the intersection of the predicted results from the two algorithms are considered highly hepatotoxic, 63% of natural products from the herb databases have the potential to cause liver toxicity. we reported five compounds of  <dig>  as examples in fig.  <dig>  including the names, structures, and related herbs that contain each compound.fig.  <dig> examples of predicted dili-positive compounds and related herbs. each compound is represented with its name, formula, structure and its related herbs. each compound is related to following herbs - a agrimonia pilosa, phytolacca americana b sophora subprostrata, sophora flavescens c actaea simplex d prunus armeniaca e onychium auratum, lindera umbellate, didymocarpus pedicellata




CONCLUSIONS
we introduced a dili prediction model with weighted features. the weighted features were calculated using bayesian probability giving information of frequency of each substructure in dili-positive and dili-negative compounds. as a result, the weighted features increased the model performance in both cross-validation and independent test with unseen dataset. moreover, we applied the constructed model to prediction of dili potential in herbs. the results show that large number of predicted positive compounds indicates that even compounds found in nature can be toxic and harmful to the human body. this finding is important because some people in eastern countries rely on herbal medicine and believe it is safer than taking general drugs. however, natural products are not always beneficial to health. in addition, natural products have come to the forefront in drug discovery and development. therefore, herbs that are used as home remedies or that are under development must be carefully administered, considering their toxic effects on the human body. in addition, we listed frequent substructures in dili-positive compounds to facilitate drug screening in less time and at lower cost.

as an additional approach, we can improve the prediction models using structural information other than two-dimensional structural information. the frequent substructures we reported here based on the fingerprint annotation can be further developed to aid the identification of toxicophores using neural networks.

additional files

additional file 1: table s <dig>  description of frequent appearing substructures in dili-positive compounds . table s <dig>  description of frequent appearing substructures in dili-positive compounds . table s <dig> description of frequent appearing substructures in dili-positive compounds . 

 
additional file 2: figure s <dig>  performance change by different cutoff. figure s <dig>  performance change by weight values. 

 


electronic supplementary material

the online version of this article  contains supplementary material, which is available to authorized users.

none.

funding
this work was supported by the bio-synergy research project  of the ministry of science, ict and future planning through the national research foundation, by the national research foundation of korea grant funded by the korea government  , and by the gist research institute  in  <dig>  publication charge for this work was funded by the bio-synergy research project .

availability of data and materials
the liver toxicity knowledge base benchmark dataset  is developed by nctr scientists and available on the u.s. food and drug administration . the additional negative dataset from drugbank is also available online .

authors’ contributions
ek and hn conceived of the study. ek wrote the manuscript. hn helped draft the manuscript and participated in the editing of the manuscript. all authors have read and approved the final manuscript.

competing interests
the authors declare that they have no competing interests.

consent for publication
not applicable.

ethics approval and consent to participate
not applicable.

about this supplement
this article has been published as part of bmc bioinformatics volume  <dig> supplement  <dig>  2017: proceedings of the tenth international workshop on data and text mining in biomedical informatics. the full contents of the supplement are available online at https://bmcbioinformatics.biomedcentral.com/articles/supplements/volume-18-supplement- <dig> 

publisher’s note
springer nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.
