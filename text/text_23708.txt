BACKGROUND
the discovery of genes that directly affect human health is an active area of biomedical research. although studies have been historically biased toward the role of individual genes in disease phenotypes, most complex diseases are caused by the influence of numerous genes with lesser individual effects. current efforts in mapping quantitative trait loci  seek to unravel these complex mechanisms through the identification of one or more genetic loci that influence specific phenotypes.

all qtl mapping approaches have three components in common: a population of individuals with a measurable phenotypic diversity, a measure of the genotypic diversity present in that population, and a statistical method to assess the association between the phenotype and genotype. over recent decades, much focus has been directed toward "classical" qtl mapping techniques in the mouse, which use phenotypic and genotypic diversity generated using f <dig> intercrosses or backcrosses and an interval mapping method introduced by lander and botstein  <cit> . this approach has been successfully used to map thousands of qtl in rodents for a wide range of phenotypes, ranging from taste preference to disease susceptibility. however, because this approach uses mouse crosses to generate phenotypic and genotypic diversity, genetic replicates of the f <dig> population cannot be easily produced. therefore, genotyping of each f <dig> animal is necessary after the initial breeding step, which makes traditional qtl mapping both expensive and time-consuming, often requiring months or years to complete. furthermore, of the thousands of qtl that have been identified, only a small percentage have been characterized at the molecular level, in part because of the large size of qtl intervals  <cit> .

recombinant inbred  panels of mice  <cit>  in which the genomes of a pseudo-f <dig> population are fixed have also been used for qtl mapping. these strains have the advantage that isogenic progeny can be easily maintained in the laboratory, and consequently, genotyping in individual strains can be applied to many phenotypes. also, ri strains contain more recombination events relative to f <dig> animals, potentially improving qtl resolution. however, since ri panels are also expensive and time-consuming to generate, the availability of specific crosses is currently limited.

here, we describe a class of qtl mapping methods which uses the existing phenotypic and genotypic variation that occurs in common laboratory inbred mouse strains for association studies . over the past century of breeding and inbreeding to produce the commonly used modern laboratory strains of mice, wide variations in phenotypic traits have been observed. efforts to catalog these inter-strain phenotypic differences are well underway . the genotypic structure of these strains is also being elucidated through efforts at dense mapping of single nucleotide polymorphisms , and variance among these strains is emerging in the form of haplotype structure  <cit> . it has been hypothesized that these inbred mouse strains have the necessary experimental requirements to facilitate qtl mapping  <cit> . this hypothesis suggests that phenotype-specific mouse crosses would not be required for the initial identification of qtl, and that large-scale genotyping efforts could be generated and combined in a phenotype-independent manner. furthermore, this method would be applicable to organisms in which controlled breeding is not feasible.

other association mapping efforts using a diverse panel of inbred strains have been reported  <cit> . recently, we reported results from qtl mapping in inbred strains of mice based on a haplotype association strategy  <cit> . briefly,  <dig>  snps spaced at ~ <dig> kb intervals were identified from the celera mouse snp database. the genomic dna of  <dig> strains of mice  was genotyped across this snp set, producing a total of  <dig>  allele calls. these data were used to map known and novel qtl for several monogenic traits, as well as complex traits such as sweet taste preference, high-density lipoprotein cholesterol  levels, and gallstone formation. independent investigators have also used our haplotype association method to refine a qtl region from an f <dig> intercross study  <cit> .

in this manuscript, we describe in detail a comparison of various algorithmic approaches to haplotype association mapping, in terms of both statistical rigor and success in reproducing known biology. in particular, we address issues of haplotype size and structure, parametric and non-parametric estimation of significance, and control of multiple testing error. finally, we conclude with a description of initial efforts to apply our haplotype association mapping algorithm to the numerous phenotypes stored in the mouse phenome database.

methods and 
RESULTS
test data sets
for the purposes of evaluating our haplotype association mapping algorithms, we considered two phenotypes for which the genetic determinants are relatively well-characterized: sweet taste preference and hdlc. sweet taste preference is a relatively simple quantitative trait for which several qtl have been identified  <cit> . furthermore, one qtl region has been narrowed to a specific quantitative trait gene , called tas1r <dig>  which is responsible for 30% of the variation observed in the sweet taste preference phenotype  <cit> . hdlc is a complex quantitative trait for which many qtl have been identified using traditional cross-based qtl mapping  <cit> . forty-two percent of the mouse genome falls within a known qtl confidence interval. since in most cases these qtl have not been refined to corresponding qtg, and since the cross-based qtl mapping has its own false positive and false negative rates, this system is not the ideal "gold standard" for the assessment of specificity and sensitivity. nevertheless, as one of the most well-studied multigenic and quantitative traits, hdlc levels may be the best available benchmark for evaluating haplotype association mapping results in a complex phenotype.

calculating association scores
 <dig>  single-marker mapping 
the simplest method of computing associations between genotype and phenotype is single marker mapping , in which each snp position is considered separately   <cit> . since each snp is biallelic across inbred strains, a t-test is used to measure the strength of association between genotype and phenotype. for clarity, all p-values are transformed using -log <dig>  henceforth referred to as the "association score". since the segregation of strains into genotypic groups varies widely over loci, the association score and not the locus-specific test statistic is compared between loci. the smm can successfully map the sweet taste preference loci . for the hdlc phenotype, of the top twenty peaks identified by smm, eleven intersect a previously known qtl interval and nine do not  .

 <dig>  mapping by inferred haplotype structure, parametric model 
although the smm strategy can be successful at identifying previously known qtl, the biallelic structure of inbred strains at a single snp locus allows only two genetic groups to be modeled. the assumption of two parental haplotypes is well-suited to the context of qtl mapping based on f <dig> or ri populations. however, when using the panel of inbred strains of mice, inspection of allele patterns across multiple loci suggests that the genetic structure in many cases is more complex   <cit> . for example, figure 3a shows a region on mouse chromosome  <dig> contained in a previously described qtl interval for hdlc  <cit> . over this three-snp window, three predominant genotype patterns are observed. the genotype at one biallelic snp is insufficient to model this genomic structure, explaining why this locus was not detected using the smm strategy.

these observations led us to define an inferred haplotype group as a set of strains with an identical genotype pattern over a local window of snps. a genome-wide analysis of inferred haplotype groupings shows that the number of inferred haplotype groups can frequently exceed even four  but rarely exceeds eight  . therefore, we chose to define inferred haplotype groups based on three contiguous snp loci . two strains are defined to be in the same inferred haplotype group if and only if their genetic pattern across three adjacent snps is identical. based on our current snp density, this three-snp window reflects an average inferred haplotype size of  <dig> kb. our previous studies suggest that haplotype block sizes can commonly be this size or larger  <cit> , although others have reported more fragmented structures in studies in specific genomic regions  <cit> . nevertheless, efforts to increase the density of snp data will improve the ability of our method to interrogate regions of small haplotype size.

using these rules, strains are grouped according to inferred haplotype at each three-snp window. to reduce the occurrence of spurious associations, we require that two inferred haplotype groups of at least five strains each exist at a given locus to be considered. groups consisting of less than three strains are not considered in the analysis, and strains with missing data are removed from the analysis at this locus. based on these groupings of inferred haplotype, the f-statistic from analysis of variance  tests the significance of the genotype/phenotype association at a given locus.

given this model of genotypic structure, we first chose to estimate p-values using an inferred haplotype parametric  approach based on a parametric model of anova . here our test statistic is a modified f-statistic, which differs from the standard f-statistic by a weighting factor that accounts for the population structure in the panel of inbred strains . the results of the hdlc phenotype in this context are shown in figure  <dig> . the locus for sweet taste preference is correctly mapped, and of the top twenty peaks identified by ih-p for hdlc, thirteen intersect a previously known qtl interval and seven do not .

 <dig>  mapping by inferred haplotype structure, kruskal-wallis model 
the results of association mapping using the ih-kw method are shown in figure  <dig> . the locus controlling sweet taste preference is again correctly identified, and of the top twenty peaks identified by ih-kw for hdlc, twelve intersect a previously known qtl interval and eight do not .

 <dig>  mapping by inferred haplotype structure, bootstrap model 
since rank-based methods discard the quantitative information present in the data, we next examined the use of a nonparametric inferred haplotype bootstrap  method to calculate association scores . in contrast to the kruskal-wallis metric, bootstrap methods of estimating significance utilize the original structure of the data. at each three-snp window, we compute the modified f-statistic used in the ih-p approach and use the bootstrap protocol described in figure  <dig> to calculate the significance. the results of ih-b applied to the hdlc and sweet taste preference phenotypes are shown in figure  <dig>  of the top twenty peaks identified by ih-b for hdlc, fourteen intersect a previously known qtl interval and six do not .

controlling for multiple testing
 <dig>  statistical power and false discovery rates
it is important to note that association scores only indicate candidate genomic regions that may contain a gene that influences a given phenotype. the causal relationship between a specific gene and a phenotype can only be confirmed using experimental techniques . a method of assessing power, the false discovery rate, and/or the false positive rate of our method would therefore be of practical value for evaluating this haplotype association mapping algorithm.

accurate estimates of power for our haplotype association method have not yet been determined since the distributions that arise from our methodology in many cases do not satisfy parametric assumptions of existing methodology in the literature. methods proposed to estimate the fdr  <cit>  have used the distribution of p-values over all hypothesis tests to estimate significance cutoffs. however, in our genome-wide association scans, approximately  <dig>  hypothesis tests are conducted at overlapping windows of snps. because neighboring windows share common alleles, each hypothesis test is highly non-independent, resulting in overly conservative fdr thresholds using the methods cited above.

 <dig>  family-wise error rate 
while the assessment of false positive rate is less desirable than estimates of power or fdr, it is the only assessment for which a mathematically justifiable approach exists for its computation. the method we utilize applies to multiple testing situations yet makes no assumptions about the independence of the multiple hypothesis tests.

we implemented an algorithm to compute a family-wise error rate  of our association scores  <cit>  . given a set of hypothesis tests, the fwer threshold is defined by the probability of observing even one false positive  occurring among any of the hypothesis tests . the bootstrap process outlined in figure  <dig> is repeated  <dig>  times with a bootstrapped phenotype vector, and each iteration produces a simulated association score profile. the bootstrap simulation results in a background distribution of association score maxima, and the critical value for the rejection region is defined as the α =  <dig>  percentile of this distribution. in all cases our bootstrap is uniform sampling with replacement.

it has been understood for some time that the fwer is an extremely strict method of defining the critical value for the rejection region  <cit> . using any of our association methods, we find that the fwer threshold produces no significant associations for hdlc, despite the biological observation that many of the top loci overlap with previously known qtl. in the process of protecting against false positives , fwer sacrifices sensitivity and effectively eliminates the power of these association methods.

 <dig>  generalized fwer 
to generate significance thresholds that report practically useful associations, the rejection region must be relaxed by increasing the tolerance of false positives. in the context of multiple testing, the generalized family wise error rate  is the probability of at least k+ <dig> type i errors occurring among any of the hypothesis tests  <cit> . our implementation of the method proposed by dudoit et al. is also illustrated in figure  <dig>  where k >  <dig>  in contrast to the fwer approach which records the genome-wide maximum, we record the kth largest association score genome-wide, where k is the number of tolerated type i errors. to insure the null dominance criterion of gfwer holds  <cit> , we estimate the supremum  of the random association score generated at each locus by using the maximum association score generated from secondary bootstraps samples . in this way, we create a reference distribution that conservatively estimates the distribution of the kth largest values. in the end we have a reference distribution which can be adjusted to tolerate any level of false positives, but allows for asymptotic control of the gfwer.

for hdlc, the bootstrapped reference distribution of k =  <dig> for ih-b is shown in figure  <dig>  the critical value for the rejection region is set at the α =  <dig>  percentile. the gfwer thresholds for both the hdlc and sweet preference phenotypes are shown in figure  <dig> . importantly, by allowing some tolerance of false positives in the control of multiple testing, several significant loci  are identified that overlap with previously described hdlc qtl. table  <dig> shows the significance thresholds using ih-b at various tolerances for false positives  and the number of loci that exceed the threshold. as noted previously, the fwer threshold  reveals no significant associations. it is important to note from table  <dig> that increasing values of k lead to alternate methods of estimating fdr. for example, at false positive tolerances of k =  <dig> or less, the number of loci declared "significant" is consistent with a random phenotype . however, at k =  <dig> and k =  <dig>  the number of significant loci exceeds the tolerance for false positives, indicating that there exists loci with association scores that are significantly higher than random. while the false discovery rates may seem relatively high, they are consistent with what one expects for a complex trait in which the marginal genetic contribution of any single gene can be quite low.

mining the mouse phenome database
we have also applied our algorithms to a sampling of phenotypes in the mouse phenome database . currently there are nearly  <dig> phenotypes stored in the mpd across a wide range of phenotypic categories. we chose a subset of seventeen phenotypes on which we ran all of our haplotype association methods. the phenotype data for males and females were analyzed separately. genome-wide significance was computed with the gfwer method, k =  <dig>  table  <dig> shows the number of significantly associating loci for each phenotype and method.

since these phenotypes are even less well-characterized than the examples we used in the method development , detailed analyses of specificity and sensitivity are not possible. nevertheless, some general trends are apparent. first, more than ten significant loci  by any method were observed in less than half  of the phenotypes examined. several factors could explain the lack of associations in the majority of phenotypes. there could be a gene or genes that truly affect the phenotype, but the genotyping data in this region has missing data or is not dense enough to accurately represent the haplotype block structure. alternatively, the marginal affect of any one gene on the overall phenotype could be too small to detect using these methods. it is also observed that regions of greater haplotype diversity are not interrogated well by these methods due to the loss of power resulting from decreased populations in each haplotype group.

second, in cases where more than ten loci are observed, the ih-kw method is usually the method which reports the largest number of associations. these associations are likely due to the population structure effects described above. although the modified f-statistic used in the ih-p and ih-b methods accounts for haplotype groups that are dominated by closely related strains, the kruskal-wallis statistic is not easily modified in a similar way. therefore, it is likely that the high number of associations is a result of association to the background genetic structure among the inbred lines. two other observations corroborate this hypothesis. the use of an unweighted f-statistic also increases the number of observed associations, and the discrepancy is most notable in phenotypes  in which the group of strains with a highest degree of genetic similarity  contains clustered and extreme values . in the most extreme example, neut, all methods report unusually long stretches of associating loci, indicating that even the modified f-statistic is not sufficient to counteract the strong correlation between phenotype and population structure.

discussion
qtl mapping in rodents has been an important strategy for narrowing the expansive genome to relatively small regions of the genome containing genes relevant to a phenotype of interest. to date, the majority of qtl have been identified using populations based on f <dig> crosses. however, these methods are time-consuming and expensive. furthermore, only a small percentage of the qtl identified using f <dig> crosses have been mapped down to the causative gene or polymorphism, at least in part due to the comparatively large size of the qtl regions.

here, we presented a comparative analysis of methods that utilize the genetic and phenotypic diversity present in common laboratory inbred mouse strains. the potential advantages of this type of approach are two-fold. first, phenotype-specific mouse crosses are not required to generate the required genetic and phenotypic diversity for initial qtl identification. phenotype data still need to be measured on the panel of inbred mouse lines, but assuming an appropriate range of phenotype values exists, the rest of the association analysis can be performed in silico. second, large-scale genotyping efforts can be generated and combined in a phenotype-independent manner, making this approach amenable to collaborative efforts that will benefit the entire mouse genetics community. furthermore, given the existing data sets that we and others have produced, our haplotype association mapping method allows association studies to be quickly performed over a number of available phenotypes .

qtl mapping has also been performed using ri lines, which also have the benefit of combining genotype data in community efforts. however, because commonly available ri lines are derived from only two parents, regions in which the parental strains are identical-by-descent  cannot be probed for qtl. for example, when comparing c57/bl6j and dba , only  <dig> loci have a different inferred haplotype. in contrast, the full panel of laboratory inbred mouse strains interrogates  <dig> loci, even after filtering out loci with trivially small haplotype group sizes. in addition, qtl mapping by ri lines is also currently constrained by the limited availability of specific crosses.

although the set of inbred mouse strains used in our analysis contains greater genotypic and phenotypic diversity compared to the currently available ri lines, the proposal by the complex trait consortium to create additional  <dig> ri strains could serve as an even more powerful resource for genome-wide association algorithms  <cit> . since these strains will be derived from crosses of eight parental strains, they will certainly represent an equally broad genotypic and phenotypic diversity as our panel of inbred strains. in addition, the controlled randomization of the genome will lead to a more controlled population structure than is currently found in the common laboratory inbred strains.

here, we have explored variants of the association mapping algorithm we originally reported  <cit>  using different test statistics and methods of calculating significance in currently available inbred strains. in addition, we have investigated the use of generalized fwer thresholds for setting genome-wide significance thresholds. although the lack of a true gold standard prevents a definitive comparison between these methods, two general trends are observed that can likely be extrapolated to all association mapping in inbred strains. first, since the haplotype block structure in inbred strains is complex relative to ri or f <dig> populations, the use of multi-snp windows to assign haplotype groups is more appropriate than simply using the genotype at a single locus. second, because population structure is clearly evident in these inbred lines, methods to account for that structure must be incorporated into association mapping algorithms. here, we utilize a modified f-statistic that factors into the calculation the average pairwise genetic similarity within a haplotype group.

despite the potential advantages of haplotype association mapping, the limitations in the experimental design relative to traditional cross-based qtl mapping must be noted. as noted above, there is significant population structure in these inbred mice that is not present in either f <dig> or ri populations. this structure complicates the analysis, and in some cases prevents this strategy from being meaningfully applied to certain phenotypes. the association metric of our haplotype associationmethod also uses a relatively simple anova model . traditional linkage analyses base their estimates on regression models that incorporate individual animals, whereas our anova methodology utilizes strain means. further, sizes of haplotype groups are small compared to the much larger number of individuals utilized in typical linkage studies. all of these factors can lead to a loss of power.

it is also important to note the strong dependence this haplotype association mapping method has on the inferred haplotype block structure in the mouse genome. while the existence of haplotype block structure is generally accepted, there is ongoing debate regarding the size of these blocks and the ability of haplotype association mapping methods to detect associations. more recent results of frazer et al.  <cit>  and yalcin et al.  <cit>  indicate the haplotype structure of inbred mice may contain regions of complexity which prevent even dense snp maps from detecting meaningful associations between genotype and phenotype. we have also encountered this complexity when investigating certain loci that contain known quantitative trait genes. in some cases, we have observed that higher snp densities are necessary to detect the known loci, possibly indicating a more fragmented haplotype in this region. clearly those who utilize these algorithms must be cognizant of the limitations of their snp set, but as snp density increases the effect of these issues will be mitigated.

regardless of the relative strengths and weaknesses between haplotype association and traditional qtl mapping, these methods are intermediate steps in pursuit of the final goal – identification of a gene which directly affects the phenotype of interest. in this study, we have used the hdlc levels as the primary phenotype to assess the performance of our algorithms. this phenotype was chosen because it has been extensively studied and many qtl have been previously identified. however, the list of qtl that influence hdlc levels are certainly not exhaustive, and in most cases the specific genes in the qtl regions have not been identified. while the ability of haplotype association methodologies to replicate loci identified in traditional qtl methods is encouraging, this comparison is not an ideal method to assess its specificity and sensitivity. ultimately, a comprehensive assessment between these approaches may come only after the genetic basis for multiple complex traits has been exhaustively studied.

CONCLUSIONS
the use of inbred strains of mice for qtl mapping has many advantages over traditional methods. however, there are also limitations in comparison to the traditional linkage analysis from f <dig> and ri lines, and application of these methods requires careful consideration of algorithmic choices based on both theoretical and practical factors. here, we have demonstrated that the optimal choice of test-statistic depends on the structure of both the phenotypic and genotypic data, that the use of multi-snp windows to infer local haplotype structure is essential when using this diverse population of inbred mouse strains, and that the gfwer approach is an effective way to control for multiple testing error while still preserving sensitivity.

authors' contributions
all authors participated in the design of the algorithms and interpretation of results. in addition, pmc performed all statistical analyses, and pmc and as drafted the manuscript.

supplementary material
additional file 1
results of single-marker mapping  method for sweet taste preference. the upper bar chart shows the computed hdlc phenotype association profile using the parametric smm method. the lower bar chart shows the location of tas1r <dig>  a gene which has been previously shown to influence sweet taste preference  <cit> . the x-axis indicates the genomic axis, where chromosomal boundaries are indicated by the center bar. the maximum lod scores are cut off at  <dig>  association scores below  <dig> and lod scores below  <dig>  are not shown. peaks on the x chromosome are ignored, and multiple peaks within a  <dig> mb window are only counted once.

click here for file

 additional file 2
results of inferred-haplotype parametric  method for sweet taste preference.

click here for file

 additional file 3
results of inferred-haplotype kruskal-wallis  method for sweet taste preference.

click here for file

 acknowledgements
we thank michael cooke, colin fletcher, richard glynne, john hogenesch, and jeff janes for helpful comments and discussions.
