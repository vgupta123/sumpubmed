BACKGROUND
tetraspanin genes are virtually expressed on all cell types in animals  <cit> , and in green plants, fungi and amoebas  <cit> . they have roles in the immune system, the nervous system, tumor, development, infection and fertilization  <cit> . they mediate various biological processes including cell morphology, adhesion, motility, proliferation, differentiation, fusion, invasion, phagocytosis, exocytosis, receptor signaling, synapse formation, protein trafficking, and more  <cit> . though other mechanisms do exist, tetraspanins are most found to function as organizers of various kinds of tetraspanin-enriched membrane microdomains   <cit> . as organizers, tetraspanins bind with primary partner proteins and dimerize with each other to form "tetraspanin webs", which further recruit a variety of proteins to form specialized functional complexes . despite the biological importance and many advances achieved in last two decades, most tetraspanins have not been functionally explored because of their subtle and overlapping roles  <cit> . tetraspanin proteins are 200~350aa long, containing four transmembrance domains , one small extracellular loop  and one large extracellular loop    <cit> . lel contains most of the sites for protein interactions  <cit> , and is composed of a constant region and a variable region. the constant region is formed by three helices, whereas the variable region contains a ccg motif, two to four internal disulphide bonds, and some other motifs   <cit> . because of incremental analyses from several early reports, the origin and basic phylogenetic features of tetraspanins are quite clear now  <cit> .

gene duplication is a major force for gene functional innovation  <cit> . however, most duplicate genes are doomed to loss, but gene retention may be facilitated by expression divergence, neofunctionalization or subfunctionalization  <cit> . small-scale duplication  and whole genome duplication  differ in their influence on the fate of duplicate genes  <cit> . for example, in yeasts and plants, duplicate genes from functional classes like transcription factors and kinases tend to be preferentially retained after wgd; also in yeasts, duplicate genes retained after wgd tend to diverge more quickly in expression regulation than in protein function . in vertebrates, two rounds of wgd  happened at the origin of vertebrates, and a third round occurred specifically to teleost fishes . early genome-wide studies suggest that no increase of positive selection has been detected on coding sequences of retained duplicate genes right after fsgd  <cit> . the same conclusion is also suggested to be applicable for 2r-wgd  <cit> . consistently, several studies on individual gene families find little positive selection right after 2r-wgd, although these studies are not specifically designed to address this issue  <cit> . these reports suggest that the rapid increase of biological complexity and novelties at the origin of vertebrates  <cit> , which is believed to be triggered by 2r-wgd, might not be initially attained through positive selection. however, we have reasons to suspect that 2r-wgd's effect on positive selection could be underestimated. first, the effect has not been carefully evaluated actually; second, since 2r-wgd is so ancient , even a massive positive selection happened, not every modern genes may still carry the selection imprint after such a long time.

the vertebrate tetraspanin superfamily has several advantages which make it suitable for preserving the imprint of ancient sequence evolution and amenable for phylogenomic analysis. it is a large family with  <dig> modern ortholog lineages in bony vertebrates . it has a rigid and compartmentalized protein architecture, which makes it free from domain reshuffling and internal module duplication, or in other words, which limits its structural evolution to amino acid substitutions, insertions and deletions. it maintains highly conserved coding sequences, structural motifs and intron configurations within sub-families. it has high gene retention rate and most of its members preserve traceable genomic syntenic relationships . finally, its molecular function is to act as versatile organizers by interacting with various proteins at different affinities, and most of its members serve important but subtle, overlapping and non-essential functions. these biochemical properties make tetraspanins highly adaptable for functional changes.

in this study, we first reconstructed a detailed phylogeny for bony vertebrate tetraspanins by integrating multiple lines of information from sequence-based phylogenetics, key structural features, intron configuration and genomic synteny. based on this phylogeny, we evaluated the impact of 2r-wgd on the following gene loss, retention and natural selection of the major lineages of vertebrate tetraspanins. in terms of selection tests, we used a stringent branch-site codon model, and contrasted duplication branches with speciation branches. finally, we concluded that vertebrate tetraspanins had undergone a massive wave of gene losses and positive selection on coding sequences right after 2r-wgd.

 <dig> 
RESULTS
 <dig>  tetraspanin genes of deuterostomes
to evaluate the 2r-wgd effect on bony vertebrate genes, we require three aspects of phylogenomic information, including the closest invertebrate  orthologs, ohnolog patterns, and molecular gene trees with dense taxa. since we concentrate on bony vertebrates and most tetraspanin lineages are phylum-specific  <cit> , this study is focused on deuterostome tetraspanins. to determine the major phylogenetic structure of vertebrate tetraspanins, we curated a reference set of tetraspanins from the genomes of human , mouse , zebrafish , ascidian c. intestinalis , amphioxus b. floridae  and echinoderm s. purpurastus  . four molecular protein trees have been constructed from these reference sequences using me, mp and ml methods . to our knowledge, these reference sequences define the most complete tetraspanin repertoires from these species thus far . since the protein sequences between sub-families are so divergent , these trees provide little reliable consensus on the relation between major sub-families. however, together with the information from previous reports  <cit> , these trees clearly define  <dig> ortholog lineages for modern bony vertebrates .

 <dig>  phylogenetics of deuterostome invertebrate tetraspanins
assuming that the phylogenetic structure of invertebrate tetraspanins may be distorted by both the large number of species-specific genes and the shift of the evolutionary pattern after 2r-wgd, here we first evaluated invertebrate deuterostome tetraspanins. fifteen ortholog lineages have been identified from the phylogenetic tree . twelve of them have vertebrate orthologs and hence represent the lineages conserved across deuterostomes; three of them, with less statistic support, have no vertebrate orthologs . amphioxus tetraspanins are found on fourteen lineages, whereas c. intestinalis and s. purpuratus each have tetraspanins on ten lineages. remarkably, amphioxus orthologs on these lineages remain single copy status, suggesting that their gene duplicability might be suppressed by gene dosage effect . in contrast to this, amphioxus developed  <dig> species-specific tetraspanins. such species-specific gene expansion also occurred in c. intestinalis and s. purpuratus. so species-specific ssds and rapid divergence are major force to shape the tetraspanin repertoires in deuterostome invertebrates, which is consistent with the situation in other invertebrates like c. elegans and d. melanogaster  <cit> .

 <dig>  a large tetraspanin gene cluster in amphioxus
a large tetraspanin cluster is present in the genome of d. melanogaster, accounting for half of the  <dig> d. melanogaster tetraspanin genes  <cit> . here we reported a tetraspanin cluster  in the amphioxus genome. it is located on the scaffold_v2_ <dig> and spans  <dig> kb, containing  <dig> tetraspanin genes and  <dig> non-tetraspanin genes . if the 5-most member  is excluded, it still spans  <dig> kb and contains  <dig> non-tetraspanin genes. the tspan <dig> cluster includes tspan <dig>  tspan <dig>  cd <dig>  seven tspan8-like-a, five tspan8-like-b and eight other tetraspanins. given the existence of its orthologous regions in c. intestinalis  and in vertebrates , the origin of this cluster should be dated back to 500~ <dig> mya. this cluster offers rich information for tracing the evolutionary history of vertebrate tetraspanins.

 <dig>  phylogenomic analysis of vertebrate tetraspanins
we compared different molecular trees of reference tetraspanins, and identified  <dig> bony vertebrate tetraspanin ortholog lineages . we also expanded the analysis to include more than  <dig> genomes to make sure no more lineages found . notably, here we required an ortholog lineage to contain representatives from at least two bony vertebrate classes among mammals, reptiles, amphibians and teleost fishes. further comparison between this analysis and that of deuterosome invertebrate tetraspanins helped to classify  <dig> ortholog lineages into  <dig> ancient super-lineages which were originated before 2r-wgd. because sequence divergence within ancient lineages was sometimes large and the sequence-based inference of some ancient lineages were statistically less reliable, we confirmed each of these ancient lineages by examining their critical structural features , intron configurations  and genomic synteny. notably, these information provided support for some evolutionary relations between ancient lineages with certain reliability .

it is worth noting that phylogenetic structures inferred in this study provides more complete information than our previous work  <cit> , and can be quite different from garcia-espana et al's work  <cit> . for the latter case we figured out three reasons. first, more genome sequences and more complete gene data set have been included; second, multiple tree reconstruction methods including more reliable methods like maximum-likelihood  and bayesian inference were used ; third, structural motifs, intron configurations and genomic synteny were integrated into the analyses in addition to sequence-based phylogenetics.

 <dig>  seventeen ancestral vertebrate tetraspanin lineages
the above phylogenomic analysis suggests that  <dig> pre-2r-wgd ancestral vertebrate tetraspanin genes survived until now. one may envisage that through duplications and speciation, these ancient genes expanded into  <dig> tetraspanin lineages , which further gave rise to all  <dig> modern vertebrate tetraspanin sub-lineages. twelve ancient lineages have orthologs in invertebrate deuterostomes, including cd <dig>  cd <dig>  tspan <dig>  tspan <dig>  tspan <dig>  tspan <dig>  rds/peripherin, tspan <dig>  tspan <dig>  tspan <dig>  tspan <dig> and tspan <dig>  notably, three of these twelve lineages have reliable protostome orthologs, including cd <dig> , cd <dig>  and tspan <dig> . the other five lineages, including cd <dig>  cd <dig>  uroplakins, tspan <dig> and tspan <dig>  either have no invertebrate orthologs at all or have distant homologs but have been disproved as orthologs. all  <dig> ancient lineages and  <dig> sub-lineages are shown in separate distance trees in figure  <dig>  which is aimed to show major topologies and the events of long-branch attractions . for reliable gene trees with dense taxa , readers are referred to the reference trees used for selection tests , and to the bayesian protein trees which better contain long-branch effect . finally, more details on these lineages are presented in the legend of figure 4; and the supporting data for the ancient lineages that are most difficult to be defined are presented in the supplemental text.

 <dig>  the monophyletic 8-cysteine super-lineage and the vertebrate tspan <dig> gene cluster
although the inferred phylogenetic relations between  <dig> ancient lineages are much less supported, some reliable parts are nevertheless worth noting. four 8-cysteine-containing ancient lineages , including eight ortholog sub-lineages, form a monophyletic super-lineage . this super-lineage has a special lel structure defined by eight cysteines capable of forming four disulphite bonds. in fact, all metaozoan 8-cys tetraspanins belong to this super-lineage with the oldest one from cnidarians  <cit> , reflecting the ancient origin and independent evolution of this super-lineage. on the other hand, syntenic analysis indicated that the tspan <dig> cluster not only exists in amphioxus and ascidians, but also exists in bony vertebrates, except that in bony vertebrates the cluster has been quadrupled by 2r-wgd. figure  <dig> shows the reconstructed pre-wgd status of the vertebrate tspan <dig> cluster. this gene cluster provides insights into the evolution of six ancestral lineages. four lineages  should represent the earliest members of this cluster, whereas two other lineages  should be derived from ancestral tspan8-like genes given structural similarity between them. besides, the origin of uroplakin, cd <dig> and tspan <dig> seem to be related to this cluster. lastly, more evidence and discussion on the evolution of these tetraspanins are presented in the text of additional file  <dig> 

 <dig>  the ohnolog duplication patterns produced by 2r-wgd
the 2r-wgd has been confirmed by lines of convincing evidence  <cit> . apparently due to wgds, bony vertebrates have many more genes than invertebrates  <cit> . paralogs arisen from wgd are called "ohnologs"  <cit> . ideally, four ohnologs produced by two consecutive wgds manifest a hierarchical pattern like ,), but the pattern recovered from phylogenetic analysis is often violated by gene losses and unequal evolutionary pace in different duplicates. apparently, all  <dig> tetraspanin lineages of bony vertebrates are paralogs derived from  <dig> pre-2r-wgd lineages, but not all paralogs from within an ancient lineage are ohnologs produced by 2r-wgd. in other words, some paralogs could be paralogs originated through ssds. here we used phylogenetic trees and syntenic data to determine ssd-derived paralogs, 2r-wgd-derived ohnologs and the ohnolog duplication patterns  . more details on these patterns are presented in the legend of figure  <dig> 

 <dig>  gene retentions and losses after 2r-wgd
among  <dig> ancestral lineages,  <dig> retain two or more ohnologs and  <dig> of  <dig> retain three ohnologs. these  <dig> lineages include cd <dig>  tspan <dig>  tspan <dig>  tspan <dig>  tspan <dig>  rds/peripherin, tspan <dig>  tspan <dig>  tspan <dig>  tspan <dig>  cd <dig>  cd <dig> and uroplakin, accounting for  <dig> of  <dig> tetrapanin lineages in bony vertebrates . this ohnolog retention rate is quite high, approximately three times the average rate  of all bony vertebrate genes, which is similar to the retention rate of transcription factors and protein kinases. in summary, of  <dig> new tetraspanin lineages in bony vertebrates ,  <dig> are contributed by 2r-wgd and only  <dig> by ssds . this contrasts the invertebrate situation, where ssds control the family size tetraspanins . remarkably, although the high ohnolog retention rate greatly increased the family sizes of vertebrate transcription factors and kinases  <cit> , it didn't increase the family size of bony vertebrate tetraspanins . taken together, 2r-wgd and the high ohnolog retention rate reshape the tetraspanin family composition rather than increase the tetraspanin family size.

although 75%  of the ancient tetraspanin lineages have ohnologous duplicates retained in bony vertebrates, nearly half  of the duplicates produced by 2r-wgd were lost before the radiation of bony vertebrates, not mentioning some lineages which might be lost without trace left. in contrast to this, meanwhile only two new lineages were acquired through ssds. gene losses are also observed to continue prevailing over gene gains in later evolution of bony vertebrates. for example, human lost six of  <dig> tetraspanin ortholog lineages and gained only one new gene  through ssd; mouse lost eight and gained one ; chicken gained two new tetraspanins but probably lost twelve; amphibians probably lost three but gained one; zebrafish gained two through ssds , but even fsgd could not prevent it from losing four bony vertebrate tetraspanin lineages. so we concluded that it is gene losses but not gene gains which prevail in the evolutionary history of bony vertebrate tetraspanins since 2r-wgd.

 <dig>  massive and extensive positive selection right after wgd
we divided branches following 2r-wgd into two conceptual categories, duplication branches and speciation branches . contrasting duplication branches with speciation branches permits to detect the changes in selective regimes on two categories of branches. the major difference between duplication branches and speciation branches is their divergent time from the first wgd. here we used a stringent branch-site test to detect positive selection . three types of branches were examined, including duplication branches, speciation branches leading to mammals, and speciation branches leading to the teleost fishes .

several factors that complicate the analysis of deep evolution of vertebrates need to be assessed before performing selection tests. a large tree with many branches will improve the power of likelihood tests when sequence divergence is high  <cit> . we sampled  <dig> fully-sequenced genomes and many sequences from other sources. several mammalian genomes were excluded due to poor quality. excessive mammalian species won't enhance the power and robustness of our tests because they don't break long internal branches and the real bottle neck in our tests is the lack of sequences from reptiles and amphibians. any way, we compiled at least five mammal species, four teleost species and as many species as possible for reptiles and amphibians. so, to our knowledge, in most cases the taxon number used in our tests has exceeded early studies  <cit> . the structures of the reference trees used for selection tests have been justified by comparing information from bayesian protein trees, maximum likelihood trees, distance trees, and syntenic data. so, one may notice that the reference trees  and the bayesian protein trees  have some discrepancies. in fact, selection tests using both types of trees delivered consistent results , which is expected because the difference between two trees is caused by the lack of sufficient substitution  information on the related branches and the lack of such information is unlikely to produce false positives. highly divergent branches were removed before tests . since we are testing multiple branches in one tree, a scheme of multiple-testing correction is required: first, because the evolution of duplicated genes may affect with each other right after wgd, all duplication branches in a tree are treated as one hypothesis; second, since the branch leading to the mammal class has been divided into three portions by amphibians and reptiles, all three portions of the branch are also treated as one hypothesis; third, as for the branch leading to the teleost class, it forms one hypothesis alone . this scheme is expected to be conservative for duplication branches and relaxed for mammal branches. hocheberg's method is used here   <cit> , which is more stringent than fdr method use in  <cit>  . as for the distributions of codon usage, gc content and transition-transversion ratio, we analyzed them in three layers. first, within the vertebrate ortholog lineages, the difference could be presented between vertebrate classes. but these differences unlikely affect the accuracy and power of likelihood ratio tests  on branches inside the lineage according to the previous simulations  <cit> . second, between ohnolog lineages we detected no significant difference in most cases, which was expected because different lineages contained similar composition of species. third, there was significant difference between invertebrate and vertebrate genes. though we had not to test invertebrate branches, we performed tests using trees without invertebrates and confirmed that similar results could be obtained with or without invertebrate sequences . the last complicating factor we need to consider is the possible ds saturation and model violation on divergent deep branches . saturation of ds may not be a problem for paml's likelihood tests  <cit> , but which is often accompanied by model violation and hence may cause false positives  <cit> . in the next section, we will show that these problems have little impact on our conclusions.

we have tested all  <dig> tetraspanin trees  by using a stringent branch-site model , but only  <dig> were put into further statistic analysis . two trees  were excluded from tests because they lacked proper outgroups and duplication branches. we detected positive selection on  <dig> of all  <dig> duplication branches , which consisted of  <dig> of  <dig> trees. in contrast, we detected positive selection on  <dig> of  <dig> mammal branches and  <dig> of  <dig> teleost branches. so, the difference between duplication branches and speciation branches is statistically significant. this difference becomes even more significant if the p-value for likelihood tests was lifted to  <dig> , suggesting that positive selection on duplication branches is not only more prevalent but also stronger than that of speciation branches. in consistence, positive selection affects 6~36% percent of sites  on the duplication branches, contrasting to  <dig> ~23%  on the mammal branches and  <dig> ~35%  on the teleost branches. typically, positive selection on many tested speciation branches was contributed by only 1- <dig> sites . this result was also confirmed by the proportion of the sites predicted to be under positive selection by the bayes empirical bayes  method . furthermore, if we considered the post-wgd evolution towards mammal radiation as a four-staged process , we could observe a gradual decline on the occurrence of positive selection from 80% to 36%, to 24% and to 12% . taken together, we concluded that for vertebrate tetraspanin genes, massive and extensive positive selection dominated the early period after 2r-wgd, which gradually and significantly decreased in both magnitude and extensity in later bony vertebrate evolution.

* tspan <dig> and tspan12
anumber of branches on which positive selection is detected using branch-site model at given p-value; hochberg's method  was used for multiple testing correction.

bfisher's exact test was used for testing the difference between different types of branches

cthe bony vertebrate-mammal branch was interrupted by amphibians and reptiles, hence produced portion  <dig> , <dig>  see figure 5a for details.

 <dig>  further confirmation of the massive wave of positive selection after 2r-wgd
since the statistic conclusion from last section is so different from those early studies using similar detection schemes for positive selection on vertebrate gene lineages  <cit>  , we decided to thoroughly evaluate its robustness from multiple angles. in our tests, we ignored two trees  due to the lack of proper outgroups and took into account two trees  that have fallen back to single gene status, but in fact, whether to count in these trees or not would not change our statistic conclusions . to further verify the reliability of inference, we performed tests on twelve arbitrarily selected duplication branches using the f <dig> codon model , which is expected to contain the bias on gc content, codon usage and transition-transversion ratio better than the f3x <dig> model. both models produced similar results, except that the f <dig> model caused a bit of power loss in lrt. notably, the quality of sequences can affect the parameter estimation, especially when genomes are sequenced and assembled in varying quality , but after analyzing the branch-site likelihood tests, we figured out that sequence errors tend to increase more false positives on the terminal speciation branches than the deep internal duplication branches. in fact, since in this study the positive selection on duplication branches was much stronger and affected much more sites than on speciation branches, we expect that no matter what testing schemes or sequence problems are encountered, the duplication branches should be less affected than speciation branches.

two factors, the ds saturation and the violation of the codon model assumption, will inflate false positive rates of likelihood ratio tests for positive selection  <cit> . in our tetraspanin dataset, duplication branches produced by 2r-wgd are so ancient and divergent that they have much higher chance to suffer from saturation and model violation than speciation branches. therefore, we have designed three schemes to confirm that the excessive positive selection detected on tetraspanins' duplication branches is evident and trust-worthy.

first, we ran simulations that reproduced the original dataset under nearly-neutral model to evaluate the false positive rates of positive selection on duplication branches . we detected no positive selection  on all  <dig> tested branches. to correction for the possible underestimation of ds substitution rate, we ran another simulation with branch length multiplied by  <dig> . this time we detected positive selection  on only  <dig> branches among all  <dig> tested branches. so, it is clear that ds saturation-induced false positive rate is not a big problem, which is consistent with early simulation analyses  <cit> .

second, we especially assessed those divergent branches in our tetraspanin dataset. there are four duplication branches with ds >  <dig> , two of which are reported under positive selection . positive selection on the tspan <dig> branch is highly supported  and affects a large proportion of sites , whereas ds of the tspan15-like branch is merely above  <dig>   and positive selection on it is also highly supported . moreover, after we removed branches with ds >  <dig>   or ds >  <dig>  , our statistic conclusions still hold, suggesting that in our tetraspanin dataset, divergent branches did not show any higher false positive rate than those less divergent.

third, we employed two protein-based approaches to detect evolutionary rate shifts on or between tetraspanin ohnolog lineages . it is suggested that in theory amino acid-based methods for selection tests may better contain divergent sequences and ds saturation than codon-based methods  <cit> . using diverge <dig>  we detected significant functional divergence between all pairs of tetraspanin ohnolog lineages except the pair of tspan6/tspan <dig> . it should be noted that there were also no positive selection detected on tspan <dig> and tspan <dig> using the branch-site codon model . using raser <dig>  we detected significant rate shifts on all tetraspanin ohnolog lineages . globally, protein-based methods produced much higher significance on each ohnolog lineages than codon-based methods . taken together, we concluded that: 1) protein-based methods seem less stringent than codon-based methods; 2) significant rate shifts did happen on the protein level on tetraspanin ohnolog lineages , which strongly corroborates the results from the branch-site codon model.

 <dig>  natural selection on the extremely long branches
the most divergent branches were not analyzed in section  <dig> , which include four branches originated by independent ssd , two branches arisen from speciation , and one branch produced by wgd . we set up new tests on these branches by using several different models and phylogenetic contexts, but no positive selection could be detected on these branches over the full-length sequence. this outcome is not surprising because codon-based positive-selection models have been shown to have little power in dealing with highly divergent sequences  <cit> . however, we observed that the evolutionary rate, transition-transversion ratio and dn/ds ratio could be different between the tm and the non-tm regions in some tetraspanin lineages , so we redid tests on these branches with the tm and non-tm regions separated. this time, we detected positive selection in non-tm regions on two branches, the mammalian rom <dig> branch  and the cd9-like branch. all these tests are present in additional file  <dig> , and their corresponding reference trees are presented on figure s22- <dig> .

 <dig>  possible compensatory evolution of rom1
the rds family forks into three ohnolog lineages, rds, rom <dig> and rds <dig>  rds is a major organizer for the photoreceptor outer segment  architecture  <cit> . defects of rds may cause blindness. rom <dig> forms hetero-tetramers and -octamers with rds in os  <cit> . a study of rom <dig> -/- mice indicates that though rom <dig> has a role in rod photoreceptor viability and in the regulation of disc morphogenesis, rds alone is sufficient for both disc and outer segment morphogenesis  <cit> . defects of rom <dig> may also cause photoreceptor degeneration but the phenotype is milder than that of rds. as for rds <dig>  the function has not been explored.

the protein structure of rds family is highly conserved and free of indels, suggesting strong purifying selection against indels. positive selection can be detected on all duplication branches and affects 12~29% of the sites, whereas positive selection is much less on speciation branches . a notable observation about the rds family is the accelerated substitution rate of the mammalian rom <dig>  branch , which is so extreme that it causes aberrant topology in the distance tree , but the correct topology can be recovered by using ml or bayesian methods . analysis of the genes adjacent to the genomic location of mrom <dig> showed that the acceleration is restricted to mrom <dig>  suggesting that regional effects are not responsible for the phenomenon. since the high substitution rate of mrom <dig> produces no indels or poor alignment portions, we suspected that acceleration is directional or under certain constraints. the beb site prediction method reports many sites under positive selection in non-tm regions on the mrom <dig> branch without significant lrt support. prompted by this, we divided the alignment into tm and non-tm regions and re-tested the branch . the rationale of this scheme is that to increase the proportion of positive selection sites will increase the power of lrt  <cit> . in this time, positive selection has been significantly detected in non-tm regions, affecting 48% of the sites and having  <dig> under-positive-selection sites predicted with > 95% probability. the likelihood test of positive selection will become much more significant if we reduced the interference from non-rom <dig> sequences and model violations by restricting the tests to the sub-tree of bony vertebrate rom <dig> .

to further find out the relation between the positive selection and the substitution acceleration, we applied the branch-specific model for further tests. these tests indicate that most synonymous substitutions on the mrom <dig> branch are accumulated in tm regions, whereas the synonymous substitution rate in non-tm regions has no difference from other branches . in contrast, most nonsynonymous replacements on the mrom <dig> branch occur in non-tm regions . these observations not only explain why positive selection is not significant across the whole sequence, but suggest that massive and rapid positive selection in non-tm regions of the mrom <dig> branch is driven by the acceleration of global substitution rate. however, it is still hard to comprehend why rapid and massive positive selection suddenly acted on the mrom <dig> branch. we proposed that it is due to compensatory evolution caused by the loss of mammalian rds <dig> .

 <dig> discussion
 <dig>  distinct influence of 2r-wgd on family size and composition of vertebrate tetraspanins
it is reported that after 2r-wgd, only 25% of the ancestral chordate genes retained more than two ohnologs in modern vertebrates  <cit> , but retention events are not random, instead, related to gene functional modes. for instance, genes with high retention rates are enriched in development, signal transduction and transcription regulation  <cit> . the ohnolog retention rate of vertebrate tetraspanins is found to be 75%, three times the average and similar to that of transcription factors  and kinases, suggesting that new tetraspanins tended to be quickly recruited into novel biological processes after 2r-wgd. in line with this, in invertebrates, species-specific ssd-derived tetraspanins also had high retention rate, hence accounting for the majority of invertebrate tetraspanins . why do tetraspanins have high duplicability and retention rate? it is proposed that genes with biochemical features permitting easy adaptation for new functions should have higher duplicability  <cit> . and genes with secondary functions or properties more likely retain both duplicates and develop new functions from secondary properties  <cit> . these hypotheses may explain the situation of tetraspanins, because tetraspanins are involved in various biological processes and interacting with various proteins at different affinities  <cit> .

frequent ssds dominated the tetraspanin family sizes in invertebrates , and 2r-wgd could increase tfs and kinases by 2~ <dig> folds. in contrast, neither 2r-wgd nor ssds significantly increased the family size of vertebrate tetraspanins. instead, high ohnolog retention rate just reshaped the family composition. so in these terms, influence of 2r-wgd on tetraspanins is quite different from those genes  with high retention rates or those genes with low retention rates. now the question is: why did this happen? we find that only  <dig> of  <dig> ancient vertebrate tetraspanin lineages are vertebrate-specific, contrasting to the invertebrate situation where the majority of tetraspanins are species-specific. if assuming that vertebrate ancestors before 2r-wgd had roughly the same amount of tetraspanins as deuterostome invertebrates had , we may infer that 2r-wgd didn't increase the family size of vertebrate tetraspanins but changed the family composition by displacing those vertebrate-specific lineages with the lineages conserved across the deuterostome phylum. if this inference was true, then how did it happen? it is suggested that conserved genes and essential genes are favorable for duplication if initial gene dosage constraint is not a problem  <cit> . it is also proposed that wgd but not ssd is able to lift dosage constraint because dosage balance is not initially altered by wgd  <cit> . based these theories, we speculate that in invertebrates conserved tetraspanins are preferable for duplication but constrained by dosage barrier . however, in vertebrates, since 2r-wgd lifted the dosage barrier, the duplicates of conserved tetraspanins might be able to displace non-conserved genes quickly.

 <dig>  post-2r-wgd massive positive selection and its relation to gene retention and gene loss
in addition to the high ohnolog retention rates, we also detected a massive wave of positive selection in bony vertebrate tetraspanins right after 2r-wgd. this wave of positive selection impacted nearly 80% of the duplication branches and affected 18% of their sites on average. rather than classify this selection wave as a peculiar case on tetraspanins, we argue that it occurred on genome-wide scale but some families like tetraspanins might preserve the signal of positive selection better than others. positive selection were also detected on later speciation branches, but at much less extensity and magnitude, with many branches affected by 1~ <dig> sites of strong signal. we theorize that such a few sites in most cases may not create entirely new functions, but likely contribute minor adaptation or optimization for the new function acquired in early evolution.

initial retention of new tetraspanin ohnologs permitted subsequent differential changes on their coding regions. early studies suggest that initial retention of duplicates after wgd is likely facilitated by dosage balancing selection, expression divergence and subfunctionalization . in this course, darwin's natural selection favored those adaptive changes  and led to neofunctionalization. although initial retention opens a time window for positive selection, it doesn't directly accelerate positive selection. some other events like subfunctionalization and gene loss may facilitate positive selection. initial subfunctionalization on duplicate genes may relax original selective constraints on coding regions and facilitate neofunctionalization  in later sequence evolution  <cit> . as for gene loss, it may also cause positive selection according to the dosage-compensation model. this model predicts that after wgd dosage effect strongly prevent the loss of the duplicated genes encoding interacting proteins in order to maintain the balance of the interaction network , but this model also predicts that once one of the interacting duplicates is lost, the remaining duplicated gene will be positively selected for  <cit> . therefore, gene loss may facilitate positive selection by triggering compensatory evolution on the remaining duplicate gene. the positive selection on mammalian rom <dig> is possibly due to compensatory evolution triggered by the loss of mammalian rds <dig> 

compensatory evolution commonly occurs within a gene, a protein complex or a network  <cit> . within a gene, deleterious mutations can be rectified or compensated by other mutations; within a complex or a network, defects of a component may be compensated by changes on other components. however, gene-for-gene compensation is rare. here we propose a functional vacancy hypothesis to explain gene loss-induced positive selection. this model assumes that close related ohnologs or paralogs have diverged but partially overlapped function. so once an ohnolog is lost, other ohnolog may fill the functional vacancy, but since the replacing ohnolog is not as good as the original, directional  selective pressure may step in and drive further adaptive changes on the replacing ohnolog. this hypothesis may explain the positive selection on mammalian rom <dig>  functional study demonstrates that rds acquired its present function before the radiation of tetrapods  <cit> . the branch pattern and length of rds family suggests that before the mammalian speciation, rds <dig> is more divergent from rds and rom <dig>  whereas rom <dig> is more similar to rds and could be more dispensable or under stronger subfunctionalization. the dispensability of rom <dig> has support from reptiles, where the loss of reptile rom <dig> caused no discernable effects on the sequence evolution of reptile rds and rds <dig> . taken together, we speculate that the loss of mammalian rds <dig> might cause an instant functional vacancy, which may drive the less important rom <dig> to evolve adaptive changes to fill the vacancy.

finally, we infer that 2r-wgd associated gene loss and positive selection could have affected the evolution of vertebrate tetraspanins for 300- <dig> million years or more. first, the early period right after 2r-wgd is ~ <dig> million years, as the divergence of chordates is 520- <dig> mya and that of bony vertebrates is ~ <dig> mya  <cit> . second, gene losses continued to prevail over gene gains in the later evolution of bony vertebrates , and the number of branches under positive selection declined in a gradual way along the evolutionary path from 2r-wgd to the mammal radiation . both phenomena suggest that after the bony vertebrate radiation the influence of 2r-wgd kept declining but continued to act in later 200~ <dig> million years. this lingering effect of 2r-wgd is not restricted to tetraspanins but likely presented on a genome-wide scale, because early studies indicate that the effect of 2r-wgd on the gene family size distribution is still detectable after the tetrapod radiation  <cit> .

 <dig>  the possible differences between 2r-wgd and fsgd
an early study shows that duplicate genes retained after fsgd bias to genes under purifying selection or relaxation of purifying selection  <cit> . studer et al's work further suggests that fsgd had no effect on the prevalence of positive selection  <cit> . these conclusions are quite different from ours on 2r-wgd and tetraspnains . however, if disregarding the duplication branches, studer et al's work and our work are more consistent than different: both studies provide similar estimation of the occurrence of positive selection on the mammal branches  and on the bony vertebrate branches . this implies that the difference lies in duplication branches, in other words, lies between 2r-wgd and fsgd.

one difference between 2r-wgd and fsgd is their differential roles in the increase of biological complexity. 2r-wgd is believed to greatly increase the morphological complexity  in the transition from basal chordates to vertebrates  <cit> . however, it appears less dramatic about the changes on morphological complexity before and after fsgd. in addition, 2r-wgd and fsgd seem to have different duplicate retention rate, for example, both tetraspanins and hox genes had had 75% retention rate after 2r-wgd but 25-30% after fsgd. so it may not be surprising that 2r-wgd and fsgd had different effect on the prevalence of positive selection. one interesting possibility is that the lingering effect of 2r-wgd lasted 300- <dig> million years and hence eclipsing the effect of fsgd. an alternative possibility is that different choices of gene families for tests may make a different result. specifically, our work focused on  <dig> genes from one family that probably suitable for preserving the imprint of ancient sequence evolution, whereas studer et al's work concerned a set of  <dig> fsgd-related genes which are biased to genes of high sequence conservation and retention rate  <cit> . anyway, the final answer requires the analysis of more genes and gene families.

 <dig> 
CONCLUSIONS
in this study, we demonstrate how the 2r-wgd affected the gene retention, losses and positive selection on the bony vertebrate tetraspanin superfamily. based on these results, we argue that a gene family which has high duplicate retention rate after wgd may not lead to the increase of family size; instead, it may just reshape the family composition. this is a new finding about the effect of wgd on the fate of multi-gene families. we also detect a massive wave of gene losses and positive selection that struck vertebrate tetraspanins right after 2r-wgd. to our knowledge, this phenomenon  has not been detected in early studies  <cit> . so, we argue that the effect of wgd on positive selection should not be underestimated, which could be significantly more extensive and intensive than that of speciation. we finally propose that although the influence of wgd are gradually diminished, the influencing time of wgd could be much longer than we thought before; in terms of tetraspanins, the lingering influence of 2r-wgd on gene losses and positive selection might last for 300- <dig> million years.

 <dig> methods
 <dig>  identification of tetraspanin sequences
predicted transcripts of  <dig> deuterostome genome sequences were downloaded from the ensembl ftp site  <cit> , including dasypus novemcinctus , equus caballus , homo sapiens , monodelphis domestica , mus musculus , rattus norvegicus , ornithorhynchus anatinus , gallus gallus , taeniopygia guttata , anolis carolinensis , xenopus tropicalis , gasterosteus aculeatus , danio rerio , oryzias latipes , takifugu rubripes , tetraodon nigroviridis , branchiostoma floridae , ciona intestinalis , ciona savignyi . predicted transcripts of the genome of strongylocentrotus purpuratus  were downloaded from the ncbi ftp site. unique gene data sets of xenopus laevis , strongylocentrotus purpuratus , ciona intestinalis , ciona savignyi  were downloaded from the ncbi ftp site. besides, some sequences from other species were also used, including leucoraja erinacea , squalus acanthias , meleagris gallopavo , lachesis muta , cyprinus carpio , salmo salar  and oncorhynchus mykiss . identification of tetraspanin sequences from these data was performed by using the pssm model pfam <dig> and the stand-alone rps-blast  <cit> . in order to build a reference set of tetraspanin, we set out to find all tetraspanin sequences from human, mouse, zebrafish, c. intestinalis, b. floridae and s. purpuratus. therefore, for these species, we also downloaded and scanned their ab initio predicted transcripts, expressed sequence tags and genomic sequences.

because of the structure features , tetraspanin sequences generally have higher quality than many other gene families, but manual sequence inspection and correction is still needed. fortunately, the sequence, protein architecture and intron positions of tetraspanins are highly conserved within ortholog lineages , so by dividing the sequence into these short portions it is easy to detect and correct the sequence problem. three problems could be encountered: incorrect splicing sites, fragmented genes and sequencing gaps. briefly, four procedures were performed: 1) fgeneh or fgeneh+ with close homologs were used to re-predict the transcript to fix incorrect splicing and fragmental genes; 2) mrna/est was used to correct sequences; 3) when multiple different sequences for a same gene were available, high-quality sequence from close species were used as referee to decide which one and or which portion was more accurate; 4) incomplete genes with sequencing gaps or not corrected genes were deleted.

 <dig>  protein sequence-based phylogenetic reconstruction
only the sequences of "tetraspanin core"  were used for alignment and tree reconstruction. clustalw  <dig>  with all default settings was used to produce multiple alignments. unlike the previous analysis  <cit> , in order not to introduce subjective bias, manual alignment editing was minimized. minimum-evolution  trees were built by using mega v <dig>   <cit> , with  <dig> bootstrap tests and pairwise deletion. both poisson correction model and p-distance model were used in the me method. maximum-likelihood  method was conducted by using phylip v <dig> , with  <dig> bootstrap tests, jones-taylor-thornton model, no gamma correction, and  <dig> times of jumble for figure s <dig> . maximum parsimony  method was conducted by using phylip v <dig> , with  <dig> bootstrap tests and  <dig> times of jumble. bayesian protein trees were carried out using mrbayes v <dig> , with amino acid substitution models recommended by the program. all other not mentioned parameters were set as defaults. in this study, me trees were presented as bootstrapped original trees with branch length, whereas ml and mp trees were presented as bootstrapped consensus trees without branch length.

 <dig>  codon usage, intron configuration analysis and syntenic context analysis
codon bias and gc contents was analyzed using codonw program http://mobyle.pasteur.fr/cgi-bin/portal.py?form=codonw. intron positions for each gene were identified by using stand-alone splign program http://www.ncbi.nlm.nih.gov/sutils/splign/ and marked on the protein sequences using a home-made perl script. syntenic context analysis was carried out manually on the ucsc gene sorter and genome browser http://genome.ucsc.edu/ <cit> .

 <dig>  reconstruction of ohnolog lineages and their duplicating patterns
paralogs arisen from wgds are called ohnologs. we selected all duplicate pairs, triplets or quartets that were created between the speciation of vertebrates and bony vertebrates, and then used the ucsc gene sorter and genome browser http://genome.ucsc.edu/ <cit>  to determine if these duplicates are located on syntenic regions. duplicates sharing synteny were considered ohnolog pairs or triplets . the next step is to determine the duplicating patterns by constructing phylogenetic trees. the theoretical pattern of four ohnologs arising from 2r-wgd should be , but 2r-wgd happened more than  <dig> mya ago and the interval between 2r-wgds was rather short, so divergence and gene loss may distorted the ideal pattern. to reconcile the duplicating patterns, we not only constructed trees from tetraspanin ohnologs, but also constructed trees from those ohnolog genes co-localized with tetraspanin genes. likelihood ratio tests were used to compare the fitness of different phylogenetic topologies using paml program  <cit> .

 <dig>  detection of positive selection and statistic analysis
based on the phylogeny obtained from reference tetraspanin seqences, we produced extended alignments and phylogenetic trees for each ancestral vertebrate tetraspanin lineage  by including more species. for each tetraspanin ortholog lineage, we included at least  five mammal species, four teleost species, and as many species as possible for reptiles and amphibians. because of the conserved protein sequence and architecture, it is easy to produce high-quality alignments for each tetraspanin lineages. protein-based alignments were converted to nucleotide alignments by using revtrans  <cit> . to guarantee reliable likelihood tests, manual sequence correction was conducted on alignments. reference sequences were used as criteria to detect potential problems by eyes, and the problematic sequences were either deleted or corrected, depending on their dispensability in an alignment. the alignment browser of mega  <dig> was used as the basic tool for sequence editing  <cit> . highly divergent sequences were also deleted from the alignments.

paml  <dig> program was used to detect positive selection  <cit> . in a codon model, dn/ds >  <dig>  is considered as indicator of positive selection. in this study, the basic model , two site-specific models  and the branch-site model a were applied on each tree. the branch-site model a has been reported to be more powerful and sensitive than the site-specific model and the branch-specific models  <cit> . in a test using branch-site model a, the branch being tested for positive selection is called the foreground branch, and the other branches in the tree are called the background branches. likelihood ratio test  is used to evaluate whether significant positive selection happens on the foreground branch. two lrts may be constructed: 1) to compare the model a to the nearly-neutral model or 2) to compare the model a to the modified model a with ω =  <dig> fixed. the first lrt is known to have high false positive rate because it does not distinguish between positive selection and relaxed selective constraints  <cit> , hence the second lrt is preferred. the test is done by comparing 2Δlnl to χ <dig> or a 1: <dig> mixture of  <dig> and χ <dig>  to guide against violations of model assumptions  <cit> , the more conservative test with χ <dig> was used in this study. to avoid the known convergence problems , we ran the program twice with two set of parameters, the first set is the defaults, whereas the second set is the parameters inferred from the one-ratio model. since multiple branches from the same tree have been tested, we used the hochberg multiple testing correction method  <cit>  to control the family-wise error rate. except for the construction of reference trees, other processes were automated using a home-made perl script. all statistic analysis following the evaluation of positive selection was conducted by using microsoft office excel.

 <dig>  simulations
those deep ancient branches  may be suffered from ds saturation, which in return may cause false detection of positive selection on these branches. to gain insight into the false positive rates on these branches, we used evolvenssite from paml <dig> to generate alignments under the nearly-neutral  model  <cit> , and ran selection tests on the duplication branches of these alignments using a stringent branch-site model as described in section  <dig> . thirteen tetraspanin families which contain at least two duplication branches were used for simulation. for each family five alignments were simulated, using the same parameters derived from the corresponding family. these parameters include two categories, one derived directly from the original alignment , the other inferred from the original alignment under the nearly-neutral  model using paml <dig> . furthermore, to correct for possible underestimation of the branch length, we generated and tested five additional simulated alignments for each family with all the same parameters except multiplying the branch length by  <dig> .

 <dig>  detection of rate shifts among sites using protein-based methods
there are higher chance for those deep ancient branches  to suffer from ds saturation and codon model violation. if so, the power and accuracy of selection tests on these branches based on codon models may be impaired  <cit> . alternatively, maximum-likelihood approaches based on protein sequences are able to better contain divergent sequences in theory  <cit> , although as a trade-off, they lose part of the codon substitution information. to provide complement and confirmation to the codon models used here, we incorporated two protein-based maximum-likelihood approaches to detect the alteration of selection constraints  on those tetraspanin ohnolog lineages produced by 2r-wgd. the first method is gu's method  that is implemented in the software diverge <dig>  <cit> , which detect specific amino acid sites under functional divergence between two paralog lineages after gene duplication  <cit> . this method tests whether the coefficient of functional divergence θ of two selected lineages is significantly larger than  <dig>  if so, then there is significant functional divergence between two lineages, and the sites contributed to divergence are also inferred using a probabilistic model. the second method is based on a covarion model that is implemented in the software raser <dig>  which allows raft shifts to vary among lineages and permits to identify the rate-shifting sites by empirical beyesian inference  <cit> . here we used raser <dig> to compare the lineage-specific model  with the null model . all other parameters were set to defaults. to avoid the known convergence problems, we ran the program for at least twice for each lineage and each model on different platforms. then likelihood-ratio tests  were performed to determine whether the lineage-specific model fit the data significantly better than the null model. if so, rate shifts on the specified lineage is significant. protein-based analyses were only conducted on duplication branches  from  <dig> tetraspanin families with at least two duplication branches. used alignments and tree topologies are the same as used in codon-based analyses.

 <dig>  data availability
the reference set of deuterostome tetraspanins including six genomes  and some other selected sequences were presented in additional file  <dig>  all alignments used for phylogenetic analyses and positive seletion tests were presented in additional file  <dig> 

abbreviations
lel: large extracellular loop; lrt: likelikhood ratio test; sel: small extracellular loop; tem: tetraspanin-enriched microdomain; tm: transmembrane; tspan: tetraspanin; wgd: whole genome duplication; 2r-wgd: two rounds of wgd at the origin of vertebrates; fsgd: fish-specific wgd.

 <dig> authors' contributions
sh and ax conceited the analysis and drafted the manuscript. sh prepared all scripts and performed most of the analyses. hz carried out the bayesian tree inference. cz and yt collected raw data, and provided technical support on computation and statistics. all authors read and approved the final manuscript.

supplementary material
additional file 1
supplemental text and figures, including:. figure s <dig>  protein me tree of reference tetraspanins, using poisson correction distance.

figure s <dig>  protein me tree of reference tetraspanins, using p-distance.

figure s <dig>  protein ml tree of reference tetraspanins.

figure s <dig>  protein mp tree of reference tetraspanins.

figure s5-s <dig>  one-ratio codon trees of  <dig> ancestral tetraspanin lineage inferred using paml4; used for positive selection tests.

figure s22-s <dig>  one-ratio codon trees of other tetraspanin lineage used for positive selection tests.

figure s37-s <dig>  bayesian inference protein trees of  <dig> ancestral tetraspanin lineage inferred using mrbayes.

click here for file

 additional file 2
supplemental table  <dig>  a reference collection of deuterostome tetraspanin proteins.

click here for file

 additional file 3
supplemental table  <dig>  results of likelihood ratio tests for positive selection using paml  <dig> 

click here for file

 additional file 4
supplemental table  <dig>  detection for rate shifts among sites between tetraspanin ohnolog lineages using diverge <dig> 

click here for file

 additional file 5
supplemental table  <dig>  detection for rate shifts among sites on tetraspanin ohnolog lineages using raser <dig> 

click here for file

 additional file 6
all used alignments .

click here for file

  <dig> acknowledgements
we thank two anonymous reviewers for their comments. we thank jiantao huang for exquisite artworks. this work was supported by projects 2007cb <dig> , and 2008aa <dig> from the ministry of science and technology of china; project  <dig> and  <dig> from national natural science foundation of china. a. xu is a recipient of the outstanding young scientist award from the national natural science foundation of china.
