BACKGROUND
viruses constantly inhabit our body  <cit> . even asymptomatic hosts harbor viral communities and interactions between viruses and the host do not always end with the death of the virus-infected cells  <cit> . this emerging vision raises the need to explore the virome as a significant part of our biology, which can profoundly influence the host in several ways, also other than the classical viral infections  <cit> . for example, like bacteria and fungi, certain viruses can stimulate a low level of immune responses, which are important for the long-term modulation of the human immunological but also metabolic homeostasis. in this regard, foxman and iwasaki  <cit>  showed that a constant reinfection by common low-virulence viruses stimulates antiviral components of the immune system, which correlate with susceptibility to diseases, such as type  <dig> diabetes and asthma. on the other hand, it has been reported that the viruses usually present in the acute infection of the nasopharynx, are also commonly detected in healthy individuals  <cit> . taken together, these data contribute to describe the host-virome interplay as a complex relationship that generally encompasses symbiosis, sometimes with a pathogenic outcome, and can profoundly impact on host health and disease. for these reasons, profiling the taxonomic and phylogenetic composition of such viral communities is pivotal not only to better understand their role in the biology of the human holobiont but also to open new possibilities in the interpretation of complex disorders, with the ultimate goal of eradicating them .

even if the importance of the interplay among eukaryotic virome, microbiome and immune system is already evident, the available techniques for virome characterization usually underestimate the quantity and diversity of viruses in the samples  <cit> . for example, it is recognized that the methods for the viral isolation based on filtering procedures miss giant virus  <cit> . viral communities are also difficult to be characterized since there is not a single gene common to all viral genomes, which prevents the application of analogous approaches to ribosomal dna profiling for bacteria  <cit> . the viral taxonomic composition of a microbial community could be estimated from metagenomic shotgun sequencing and rna-seq of the microbiota dna/rna, by detecting and assigning the viral reads to the appropriate viral taxa. metagenomic samples contain indeed nucleic acids for bacteria, archeabacteria, eukaryotes, phages and eukaryotic viruses. however, currently the most advanced experimental procedures foresee to extract and isolate the encapsidated viral fraction  and only at a later stage, to characterize the metavirome by assembled or read-mapping approaches . to sequence unprocessed samples and directly assign the obtained reads would instead allow a faster characterization of the virome in the context of the microbiome of origin and no risk to miss giant virus due to filtering procedures. we thus present viromescan, a new tool that accurately profiles viral communities and requires only few minutes to process thousands of metagenomics reads. viromescan works with shotgun reads to detect traces of dna and/or rna viruses, depending on the input sequences to be processed. viromescan has been developed to profile the eukaryotic viral community within the microbiome, in particular it estimates the relative abundance of viruses by filtering out the metagenomic reads of human and bacterial provenance, and mapping the remaining sequences on a hierarchical viral database. viromescan is available at the website http://sourceforge.net/projects/viromescan/.

implementation
workflow of the software
once downloaded, viromescan locally processes the metagenome for searching eukaryotic viral sequences. input files should be single-end or paired-end reads in fastq format  retrieved from shotgun sequencing or rna-seq. depending on the research strategy, viromescan gives users the option to choose from a range of in-house built reference databases, including human dna virus database, human dna/rna virus database, eukaryotic dna virus database and eukaryotic dna/rna virus database. the human virus databases contain only viruses that have the human being as the natural host; on the other hand, the eukaryotic virus databases also include viruses for vertebrates, invertebrates, fungi, algae and plants, while excluding bacteriophages. all databases are based on the complete viral genomes available on the ncbi website  <cit> . the ncbi ids of the viral genomes used to build the different databases are reported in additional file  <dig> 

the schematic description of the procedures of analysis computed by viromescan is provided in fig.  <dig>  in detail, metagenomic reads are compared to the viral genomes of the selected database using bowtie <dig>  <cit> . this first step is a complete and accurate screening of the sequences to select candidate viral reads. to perform this procedure before filtering processes allows a considerable gain of time in the subsequent parts of the pipeline, due to the reduction of the dataset to less than 1 % of the total amount of metagenomic reads. afterwards, a quality filtering step of the candidate viral reads has been implemented as described in the processing procedure of the human microbiome project   <cit> . in brief, sequences are trimmed for low quality score using a modified version of the script trimbwastyle.pl that works directly from bam files  <cit> . the script is utilized to trim bases off the ends of sequences, which show a quality value of two or lower. this threshold is taken to delete all the bases with an uncertain quality as defined by illumina’s eamms  filter. additionally, reads trimmed to less than 60 bp are also removed.fig.  <dig> workflow of viromescan. a inputs are single-end reads  or paired-end reads . b candidate viral reads are identified by mapping the sequences to the selected reference database. unmapped reads are not contained in the resulting file. c three filtering procedures to trim low quality reads and completely remove human and bacterial contaminations are computed. d the remaining viral sequences are assigned to appropriate taxonomy and the results are tabulated as both relative abundance and read counts



since the sequences analyzed are whole-genome or rna-seq products, it is plausible that the candidate viral reads contain a small percentage of human reads. for this reason, it is necessary to subject the sequences to the control for human contamination. as reported in the hmp procedures  <cit> , human best match tagger   <cit>  is an efficient tool that discriminates among human, viral and microbial reads. first of all, bmtagger attempts to discriminate between human reads and the other reads by comparing the 18mers produced from the input file with those contained in the reference human database. if this process fails, an additional alignment procedure is performed to guarantee the detection of all matches with up to two errors.

human-filtered reads may also contain an amount of bacterial sequences, which need to be filtered out to avoid biases due to bacterial contamination. bacterial reads are identified and masked using bmtagger, the same tool utilized for the human sequence removal procedure. in particular, in order to detect bacterial sequences, human-filtered reads are screened against the genomic dna of a representative group of bacterial taxa that are known to be common in the human body niches. see additional file  <dig> for the list of bacteria included in this process. nevertheless, the user can customize the filtering procedure by replacing the bacterial database within the viromescan folder with the microbial sequences of interest, associated to environments other than the human body .

finally, filtered reads are again compared to the viral genomes of the chosen hierarchical viral database using bowtie <dig>  <cit> , allowing the definitive association of each virome sequence to a viral genome. for each sample analyzed, the total amount of counts is summarized in a table as number of hits and relative abundance. additionally, graphs representing the abundances at family, genus and species level are provided, using the “graphics” and “base” r packages.

validation of the tool and comparison with other existing methods
five different mock communities each containing  <dig> human dna viruses at different relative abundances were built and submitted to viromescan for its validation. the mock communities contained also human sequences and reads of other microorganisms to test the filtering steps of the pipeline. the simulated metagenomes were composed of sequences of 100 bp randomly generated from the chosen genomic dnas by an in-house developed script. in order to compare the performance of viromescan with other existing tools, the same mock samples were analyzed using metavir  <cit>  and blastn  <cit> . in particular, in the metavir pipeline, we determined the taxonomic composition using the number of best hits normalized by genome length through the gaas metagenomic tool  <cit> . the genomes used to generate the five mock communities are reported in additional file  <dig> 

case study: using viromescan to profile the eukaryotic dna virome across different human body sites
twenty metagenomic samples from hmp  <cit> , belonging to four body sites, including stool, mid vagina, buccal mucosa and retroauricular crease, were used to illustrate the results that can be obtained by viromescan. the ids of hmp samples are reported in additional file  <dig>  these metagenomes had been sequenced using the illumina gaiix platform with 101 bp paired-end reads. the entire metagenomic dataset was utilized to study the differences in the composition of the viral communities across different body sites. no ethics approval was required for any work performed in this study.

RESULTS
the viromescan software is specifically dedicated to the analysis of the virome. in particular, it can be used to detect viruses inside the microbiome from a given environment utilizing raw reads, mostly in fastq format generated by next-generation sequencing technologies. viromescan has the advantage of using a read-mapping approach that allows i) the characterization of the virome within a metagenome, including bacterial, eukaryotic and host sequences, without specific extraction/purification strategies, and ii) the preservation of all the information retained in the input files, information that may be lost by an assembly approach  <cit> . in particular, in the context of a metagenomic dataset, the viral dna could be undersequenced due to the huge amount of bacterial and human dna in the samples, making the assembly difficult or even impossible for viruses with a limited number of reads. however, as all the existing read-mapping approaches, viromescan is blind to viral sequences that are not closely related to viruses already present in the repository. for this reason and in the light of the considerable number of unknown viruses inside a metagenomic sample , the integration of a read-mapping and an assembling approach could be pursued to retrieve a more exhaustive virome profile of metagenomic samples.

viromescan determines the taxonomic composition of the virome by sequence alignment of the reads to completely known viral genomes, and displays the results as either number of hits or normalized hits . the viromescan classifier can be used for multiple analysis of the virome, in particular the normalized results describe the structure of the viral community in terms of relative abundance, and the read count output defines the richness and diversity of such community in the context of the metagenome of origin. the initial choice of the appropriate reference database is possible because the hierarchical databases built within viromescan contain sequences for dna or dna/rna eukaryotic viruses, making the tool very adaptable to the needs of the user. specifically,  <dig> genomes for the human dna virus database,  <dig> for the human dna/rna virus database,  <dig> for the eukaryotic dna virus database and  <dig> for the eukaryotic dna/rna virus database were employed in the construction of the tool. in addition, every viromescan user can create his/her own database for a customized analysis, including assembled sequences of unknown viruses, which could be useful to extend the taxon detection limit of the tool. finally, another advantage of the viromescan tool is that the same metagenomic sample utilized to characterize bacteria, archeabacteria and eukarya within the microbiome, can be used for the viral profiling, opening new perspectives in metagenomic characterization studies.

we first evaluated viromescan performance in estimating the composition of viral communities using synthetic data. to this aim, we constructed  <dig> mock communities comprising reads from  <dig> different human dna viruses, bacterial microorganisms and human genome, to simulate metagenomes including different domains as the intestinal microbiota. viromescan correctly mapped the majority of the reads and identified all the  <dig> viruses in the synthetic communities, accurately estimating their relative abundance at different taxonomic levels , with 100 % of the viral species within 1 % deviation from expected value and the best overall prediction , . viromescan was more accurate on all tested synthetic metagenomes than the other existing methods, with blastn showing the closest performance but substantially slower . to be honest, several other tools for viral community characterization are available but they have been specifically designed to work with long sequences, or to detect open reading frames, which prevented their employment in our comparative analysis . furthermore, viromescan performed the classification at  <dig> reads per second on a standard single processor system, which was faster and more performing than other methods . the currently existing tools do not foresee filtering steps during the computational process, because they are designed to directly analyze viral reads. this fact constitutes a major limitation for the analysis of metagenomic samples, which usually contain a huge amount of bacterial and human reads. the strategy adopted by viromescan has been specifically studied to overcome this problem. in particular, two filtering steps, one for bacterial and one for human reads, have been introduced to reduce the dimensionality of the input dataset, saving time in the analysis computation. additionally, yet importantly, viromescan showed a better mimicry of the abundance of the mock communities when compared to the other methods . the better accuracy is probably due to the fact that bacterial and human reads are not filtered by the other approaches. by analyzing the assignment read by read, we deeply investigated how the non-filtering biases affected the performance of the other classification tools. specifically, blastn failed to classify 50 % and 30 % of the reads belonging to human herpesvirus  <dig> strain hg <dig> and human adenovirus  <dig>  respectively. furthermore, it assigned to a different strain the majority of the reads of human bocavirus  <dig> and vaccinia virus. analogously, metavir failed to detect human herpesvirus  <dig> strain hg <dig>  variola and vaccinia virus, human adenovirus c and d. moreover, it assigned to a different species the reads for bk polyomavirus, and overestimated the reads for parvoviridae and polyomaviridae. in these cases, the superior accuracy of viromescan is probably due to the unique “two-step” assignment process in the pipeline, which involves two consecutive alignments of the reads to the reference database. the first one is computed at the very beginning of the analysis to detect viral candidate reads. the second one is computed after the filtering processes, as validation and final assignment of the viral reads to the correct taxonomy. notably, the “two-step” method is not used in the other existing tools  <cit> . this uniqueness makes viromescan a very efficient tool in saving computational time, because it immediately skims the input reads, and at the same time permits a more accurate assignment of the viral sequences. finally, by removing from the database the reference genomes closely related to those included in the mock communities, we evaluated the potential for viral discovery of the tool. according to our findings, viromescan was able to identify the correct genus of the human adenovirus and human papillomavirus species when their closest genome sequences were removed from the database, but it did not assign any human dna virus when all the related genomes up to family level were deleted. for these reasons, viromescan can not be used as a classifier of viruses belonging to lineages that are completely missing in the database.fig.  <dig> comparison of viromescan to other existing methods. a total of five synthetic viral communities were used in order to compare viromescan with metavir  <cit>  and blastn  <cit> . absolute and r.m.s. errors in assigning taxonomy at  family and  species level are shown. c correlation between predicted and real relative abundance for the  <dig> non-evenly distributed mock communities. d read rate for the tested tools on single cpu

fig.  <dig> comparison between the relative abundances of a single non-evenly distributed mock community as detected using metavir  <cit> , blastn  <cit>  and viromescan, and its real composition. black portions of the bars correspond to the unassigned viral fraction or erroneous viral assignment



we next utilized viromescan to characterize the virome of metagenome samples from different body niches of people enrolled in the hmp  <cit> , analyzing a total of  <dig> samples belonging to four human body sites: stool , mid vagina, buccal mucosa and retroauricular crease. viromescan detected  <dig> viral species from  <dig> viral families with abundance ≥  <dig>  % in at least one sample. the body site that showed the highest diversity was the retroauricular crease with 98 ±  <dig> , followed by gut , buccal mucosa , and vagina . looking at the genus-level diversity, we found a mean of  <dig>  genera per sample, consistent with that detected in a previous study on  <dig> hmp samples   <cit> . thus, we investigated the hypothesis that different body sites reflect different virome profiles at family and species level through hierarchical clustering of the  <dig> samples . interestingly, the gut virome was consistently different from that of the other body sites . in particular, it was characterized by geminiviridae, phycodnaviridae, asfarviridae, iridoviridae, mimiviridae, adenoviridae, nimaviridae, baculoviridae, anelloviridae, nudiviridae, marseilleviridae, malacoherpesviridae, parvoviridae, circoviridae, nanoviridae and poxviridae viral families. on the other hand, the other body sites shared some families, such as polydnaviridae, herpesviridae, polyomaviridae, alloherpesviridae, ascoviridae and papillomaviridae . the differences are also displayed in terms of relative abundance in the histograms and pie charts of fig. 5a. mimiviridae and poxviridae dominated the human gut eukaryotic virome, while herpesviridae and polydnaviridae were the most represented viral families in the other body sites. notably, the relative abundances of hmp samples as determined by viromescan, were consistent with the results obtained by applying blastn , and the viral taxa identified confirm the little available literature. in particular, papillomaviridae, herpesviridae, and polyomaviridae have already been detected in the microbiota of vagina, skin and mouth  <cit> , and adenoviridae, anelloviridae and circoviridae in stool  <cit> . additionally, our findings on the gut samples led to the detection of megavirales and other giant viruses that were not found in previous analyses of the human gut virome, probably due to the filtering approach used for virus isolation  <cit> , but have recently been isolated in human stool and other human samples through different approaches . taken together, all these data confirm the applicability of viromescan to microbial communities and its suitability to metagenomic samples. by using viromescan read-based assignment against the in-house built human dna virus database, we also provided the distribution of the herpesviridae family across the different body sites with a species level resolution . once more, these results highlighted the performance of viromescan, which could help bridge the general lack of information on the eukaryotic virome and its relationship with the host and the other microorganisms of the microbiome.fig.  <dig> different body sites reflect different virome configurations. species  and families  level hierarchical ward-linkage clustering based on the spearman correlation coefficients of the viral profiles of  <dig> hmp samples  <cit>  as determined by viromescan. analysis was carried out considering all the families detected and species with at least  <dig>  % of abundance in 25 % of samples. c hierarchical ward-linkage clustering of viral families generated characteristic clades, which discriminated the gut environment from the other body sites. the names of the families are colored according to the colors of the dendrogram 

fig.  <dig> the eukaryotic virome at family level in an asymptomatic western population, as predicted by viromescan. analysis was carried out on  <dig> hmp samples  <cit>  from  <dig> human body sites, including gut , mouth , skin  and vagina . a the relative abundance of viral families for each hmp sample and the mean relative abundance for each body site are reported in the histograms and pie charts, respectively. b hierarchical ward-linkage clustering based on the spearman correlation coefficients of 19/ <dig> hmp samples containing members of the human herpesviridae family



CONCLUSIONS
viromescan provides the users with new perspectives in the virome characterization analysis. shotgun metagenomics and rnaseq techniques are rapidly decreasing in cost and already supply a community-wide profiling of the bacterial, archeal and eukaryotic microbiome. by enabling an efficient detection of the viral counterpart from shotgun sequencing, viromescan extensively integrates the analysis of the microorganisms that inhabit the human body. furthermore, viromescan can be applied to any environment as a tool for taxonomic profiling of the virome with resolution up to species level. an interesting and flexible aspect for users is that the pipeline of analysis can also be used with a customized database containing viral genomes of interest. however, this version of the tool remains blind to new viruses, which are not present in the database. for this reason, the pipeline will be integrated in the near future with an optional and parallel assembling step to identify unknown viruses within the metagenome. the viromescan databases of eukaryotic and human viruses will be periodically updated based on new genome releases.

availability and requirements
project name: viromescan

project home page:http://sourceforge.net/projects/viromescan/

operating systems: linux, os x

programming language: bash, r, perl, java

other requirements: bowtie <dig>  bmtagger tools from ncbi, picard tools

licence: freebsd

any restriction to use by non-academics: no

additional files
additional file 1: ids of the viral genomes included in the viromescan databases. 

additional file 2: list of the bacteria and corresponding genome ids utilized in the bacterial read filtering procedure during the viromescan pipeline. 

additional file 3: list of the genome ids and microorganisms used to construct the synthetic communities. 

additional file 4: list of the hmp samples  <cit>  utilized to test the viromescan tool. 



abbreviations
bmtaggerhuman best match tagger

eammsend anchored max scoring segments

gaasgenome relative abundance and average size

hmphuman microbiome project

competing interests

the authors declare that they have no competing interests.

authors’ contributions

sr designed the tool. sr and ms developed the different scripts. ms tested the tool with the mock communities and hmp samples. sr, ms, st, sq, eb and mc wrote the manuscript. pb revised and edited the draft. all authors discussed the results and have read and approved the manuscript.

this work was supported by the european union’s seventh framework programme  under grant agreement n.  <dig> .
