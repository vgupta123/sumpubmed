BACKGROUND
the analysis of metabolic networks aims at the understanding of metabolic capabilities of organisms to adapt to, and to maintain growth under different external and internal conditions. various tools exist today to analyze and predict behavior of organisms solely based on metabolic network structure.

important results have been obtained by applying methods like flux balance analysis  <cit> , modeling by differential equations  <cit> , stochastic simulations  <cit> , or elementary flux mode analysis  <cit> . while some of these methods concentrate on the network as a whole, others like elementary flux modes decompose it into smaller parts that form functional modules. chemical organization theory  <cit>  aims at the understanding of reaction networks from both sides. its basic aim is to identify parts of the network, or more precisely, sets of molecular species, that are likely to coexist on a long time scale without any of the species vanishing or other species appearing anew. this not only encompasses steady states of the network as might be identified by elementary flux mode analysis , but also conditions in which there are positive productions of metabolites. therefore it can be seen as a method that defines a mapping from a reaction network consisting of reactions and metabolites to a set of potential phenotypes  <cit>  of the network as specified by the set of organizations it contains. the theory of chemical organizations has previously been applied to a model of the central sugar metabolism of e. coli  <cit> . it was shown that organizations in the model coincided with known growth phenotypes of e. coli under different growth conditions. the growth on each of the carbon sources glucose, lactose, and glycerol could be matched to a specific organization. however, as negative regulation for some genes was ignored because the down-regulation of genes cannot push gene expression levels below the basal level, some organizations represented biologically infeasible system states, for example the simultaneous uptake of all carbon sources.

in this paper, we present an approach to explicitly consider inhibitory regulatory interactions within the analysis of chemical organizations. this allows the more faithful and more precise consideration of biological network models, making the identification of all potential phenotypes of regulated metabolic networks possible. first, the basic concepts of the theory of chemical organizations are presented in the next section. then, the approach to deal with inhibitory interactions is introduced. the method is then first applied to a subnetwork of a network model of the central metabolism of e. coli to predict growth phenotypes. finally, the method is applied to the complete network model to predict the lethality of gene knockouts.

theory of chemical organizations
the theory of chemical organizations  <cit>  provides a new method to analyze complex reaction networks. extending ideas by fontana and buss  <cit> , one main objective is to determine combinations of network species that are more likely to be present over long periods of  time than others. such sets of species are called organizations. to be an organization, a species set has to fulfill two properties: algebraic closure and self-maintenance. the first property – closure – ensures that given the molecular species of an organization, there is no reaction within the reaction network that could create a novel species not yet present in the organization. the second property – self-maintenance – guarantees that every molecular species that is consumed within the organization can be recreated from organization species at a suffcient rate for its maintenance. the basic concepts required for this paper are summarized now more formally.

reaction network
let m be a set of molecular species, pm denotes the set of all multisets with elements from m. a multiset differs from a set in the fact that it can contain the same element more than once. the set of reactions r occurring among the species m can then be defined by a relation r⊆pm×pm. we call the pair 〈m,r〉 a reaction network.

closed set
a set of species s⊆m is closed, if for all reactions ∈r with a∈pm, then also ℬ∈pm. in other words: if the educts of a reaction are contained in s, then also its products must be in s. there is no reaction in r that could create any new species not yet in s from species contained in s.

self-maintaining set
given a reaction system 〈m,r〉 with m = |m| species and n = |r| reactions, s =  be its m × n stoichiometric matrix, where mi, j is the number of molecules of species i that is produced in reaction j . a set of species s⊆m is called self-maintaining if a flux vector v =  ∈ ℝ≥0n exists such that the following three conditions are fulfilled:

 for every reaction ∈r with a∈pm, its corresponding flux is va→ℬ> <dig> 

 for every reaction ∈r with a∉pm, its corresponding flux is va→ℬ= <dig> 

 for every species i ∈ s, its concentration change is nonnegative: i ≥  <dig> 

in other words: if we consider only the sub-network made up by the species of s and additionally the species that can be created from s   and ), we can find a positive flux vector, such that no species of s decays ).

organization
a set of species s⊆m that is closed and self-maintaining is called an organization.

balanced organization
an organization s⊆m is a balanced organization, if a flux vector conforming to the self-maintenance condition can still be found, if in requirement  <dig> of the self-maintenance definition, the greater equal condition is replaced by equality:

 for every species i ∈ s, its concentration change is zero: i =  <dig> 

a rigorous link between organizations and the potential dynamics of a reaction system is provided by theorem  <dig> from ref.  <cit> : assume that the dynamics is modeled as a "chemical" differential equation system dx/dt = sv), then all steady states of the system are instances of organizations. in other words, the species with concentration levels greater than zero in a particular steady state are exactly those species contained in a corresponding organization. note that organizations do not necessarily contain a steady state, as they can also embody growth in which species have increasing concentrations. the only assumption made for this theorem is that molecules that are present and can react will react sooner or later > <dig>  if and only if for all i ∈ a: xi > 0). note that this assumption differs fundamentally from the assumption made by methods like elementary mode analysis, which assume that each reaction can be switched off independently even if the reactants are present in large concentrations  <cit> .

computing organizations
to compute organizations, the convex polyhedral cone p can be used which is defined by the n + m inequalities v ≥  <dig> and s · v ≥  <dig> in the flux space ℝ≥0n. this cone contains all self-maintenance flux vectors as described in the self-maintenance definition. in order to find species sets that are self-maintaining and closed, the extreme rays spanning p are combined in a recursive fashion and the resulting species sets tested. the supplement contains a detailed description of the algorithm, and outlines a heuristic approach to compute organizations for large network models, for which the runtime of the algorithm exceeds practical limits .

methods
regulation has not yet been explicitly considered in the analysis using the theory of chemical organizations. the aim of this section is to elaborate a concept that allows us to also account for regulation. this concept makes it possible to also study regulated metabolic networks using organization theory. the basic idea is to map regulatory rules to normal chemical reaction rules. for inhibitory rules and rules using the direction of a reversible flux we introduce pseudo species representing the absence of a species and the direction of a flux, respectively.

types of regulation
to examine the effects of regulation on chemical organizations we first need to discuss the general types of regulatory interactions that occur in biological systems in more detail.

regulation appears on different levels in the cell, being carried out by a variety of biological entities  acting on further biological target entities. as we are considered with reaction networks, we focus here on the regulation of reactions. two different types of regulation have to be considered. the first type of regulation only changes the flux of the regulated reaction slightly. certain types of autoregulation fall into this category. this kind of regulation does not change the structure of the reaction network and hence does not affect its organizational hierarchy. the second type of regulation is more drastic: it turns a reaction completely off or enables a formerly unavailable reaction. this is the case, for example, when the expression of a protein that catalyzes a reaction is suddenly repressed. as a consequence, the catalyzed reaction is not available to the network anymore once the protein is completely degraded. the induction of uptake pathways is an example for enabling novel reactions. new reaction pathways become suddenly available.

note that, even though drastic, this kind of categorization of regulation leads to meaningful models, for example when translated into a boolean regulatory network  <cit>  and also generalizes to discretization using more than two levels as used in ref.  <cit> .

regulatory interactions do not happen instantly. the time delay between the onset of a regulatory event and its measurable effect in the system can vary between milliseconds  and minutes . however, as we are here interested in the long term behavior of the system, we do not take different time scales of regulation into account.

modeling regulatoy interactions
several approaches exist to represent and model regulatory interactions  <cit> , for example, boolean logic  <cit> , stochastic models  <cit> , and differential equations  <cit> . whereas some approaches require a very detailed knowledge of the mechanisms and kinetics behind the regulation, the representation of regulatory networks by boolean logic can be useful if the knowledge about the underlying kinetics is limited  <cit> . in this approach, the state on or off is assigned to a regulated reaction  <cit> . we will adopt this notion to model regulatory interactions.

two types of regulatory events have to be considered: activation, in which a species is required in order to perform a certain reaction, and inhibition, in which a species inhibits a certain reaction and makes it unavailable. to model this kind of regulation we make use of the properties of reactions being similar to rewriting rules, where the left hand side is being replaced by the right hand side. taking this approach, the molecules on the left hand side need to be present for the reaction to proceed. additionally, regulatory events can be triggered not only by the presence or absence of a species, but also by a species being available in excess or not.

activation
activation or turning on a reaction by a specific species can be simply modelled by considering this species as a kind of a catalyst. in terms of rewriting rules this approach can be considered as an additional constraint on the presence of certain species for the reaction to proceed. by this, the reaction can only take place when the activating species is present. being a catalyst, the activating species is not consumed within the reaction it catalyzes.

let us consider the general case in which species e activates a reaction that transforms a reactant a into product b. in the absence of e, the reaction shall have a zero flux, while the flux shall become positive in the presence of e and a. a reaction a → b activated by e becomes:

 e + a → e + b. 

note that adding e as a catalyst on the reactant and product side of the reaction equation does not change the stoichiometric matrix s. still, one unit of a is being consumed to produce one unit of b. therefore any flux vector that guarantees self-maintenance for a set of metabolites including e but without considering e as an activator, will also guarantee self-maintenance when e is added as a catalyst to model activation.

inhibition
handling inhibition is more diffcult. if inhibitor i inhibits a reaction, we could add an if-statement to each reaction that guarantees that the reaction is only available when i is absent. but since we intend to model regulation within the language of reactions, such if-statements would not fulfill our requirements. an alternative way to model inhibition is to understand it as another type of activation, that is, as the activation of a reaction by the absence of an inhibitor. for achieving this we have to introduce a pseudo species Ī that represents the absence of inhibitor i. in terms of rewriting rules, such species is just a constraint on the presence of a certain species for a reaction to take place. a reaction a → b inhibited by i becomes:

 Ī + a → Ī + b. 

only in the absence of i, represented by pseudo species Ī, educt a can react to form product b.

modelling flux-direction dependent regulation
sometimes it can make sense to define regulatory rules that depend on the direction at which one or more reversible reactions operate. two examples can be found in covert and palsson  <cit> , the rule for the pyruvate response regulator  and the rule for the catabolite activator protein . given a reversible reaction r: a ↔ b and the following flux-direction dependent regulatory rule:

"if the flux of reaction r is positive , then activate protein e.",

we map this regulatory rule to the following conventional reaction rules by introducing a pseudo species fr and its inverse counterpart fr¯:

  rf : a + fr → b + fr 

  rb:b+fr¯→a+fr¯ 

  re : a + fr → a + fr + e  

because in consistent organizations  either fr or fr¯ is present , the reaction rules assure that either the forward rf or the backward reaction rule rb can be active. here, in eq. , we use the presence of the molecular species a and fr as an indicator for the activity of reaction rf . conversely, we can use the presence of the molecular species b and fr¯ as an indicator for the activity of the backward reaction rb.

if necessary, we can add a pseudo species like fr to every reversible reaction rule r in order to obtain an indicator for the direction in which it operates. then, these indicators can even be combined to represent a more complex rule. note that in covert and palsson  <cit> , different flux-directions are logically combined to indicate a surplus of a molecular species .

consistent organization
introducing pseudo species causes a problem, as now two network species represent the same molecular entity. when computing the organizations of such a network, some organizations might exist that contain both or neither of the two species. in both cases, the presence of the species is not clearly defined. either the presence and absence is indicated simultaneously, or no statement is made at all. consequently, we only consider those organizations in the remaining of this paper, in which for all species it is clearly defined whether they are present or not. we call such organizations consistent.

consistent organization
an organization o⊆m is called a consistent organization, if for all species s ∈ m for which there exists a pseudo species s¯∈m that indicates its absence, either s or s¯ is contained in the organization.

in passing we note that this approach allows one to model more than two states of a molecule, for example different phosphorylation states.

modeling boolean logic
there are few cases where a reaction is regulated by a single molecule alone. in most cases regulation is more complex, for example if the availability of a reaction is being determined by the interaction of a set of proteins. in such cases we need to model regulation by a set of boolean functions. this section presents an approach to account for such functions on the level of regulation .

all binary boolean functions can be reduced to either and or or, and the negation not. the construction of a negation has been outlined above. in principle, it would be suffcient to present a method to implement and or or. however, we present methods for both to ease the process of converting regulation logics to chemical reactions.

first we consider the and function. a typical regulation incorporating an and function is the required presence of two activators to perform a reaction. if we consider activator e <dig> and activator e <dig> to be necessary for a reaction converting educt a into product b we can write:

 e <dig> + e <dig> + a → e <dig> + e <dig> + b. 

next, the or function is considered. an example for this case is a reaction transforming educt a into product b that can alternatively be activated by two activators e <dig> and e <dig>  the presence of one of these activators is suffcient to perform the reaction. in this case, the reaction is split into two parts; one that accounts for the presence of activator e <dig>  and one that accounts for the presence of activator e2:

 e <dig> + a → e <dig> + b 

 e <dig> + a → e <dig> + b. 

taking these two basic functions, it is possible to model all regulatory relationships that can be represented by boolean rules in metabolic networks  <cit> .

example: regulatory switch
as an example for the presented procedure, we analyze a simple reaction network comprising – apart from inflow and outflow – two reactions forming a switch as depicted in figure  <dig>  the product of one reaction inhibits the other reaction and vice versa. additionally, an inhibitor i can shut down both reactions. thus, we have a simple and function that requires for both reactions that both i and p <dig>  respectively p <dig>  are absent. a model without regulation would contain only reactions transforming a to p <dig> and p <dig>  the influx to a and the outflux from the products: r' = {∅ → a, a → p <dig>  a → p <dig>  p <dig> → ∅, p <dig> → ∅}.

the boolean expressions describing the regulation are:

 a → p <dig> if ¬i ⋀ ¬p <dig> 

 a → p <dig> if ¬i ⋀ ¬p <dig>  

applying the presented procedure, these expressions are transformed into chemical reactions. the resulting reaction network contains the following reactions:

r = {

  ∅ → a, 

  p2¯+i¯+a→p2¯+i¯+p <dig>  

  p1¯+i¯+a→p1¯+i¯+p <dig>  

  p <dig> → ∅ 

  p <dig> → ∅ }. 

the network contains  <dig> organizations as listed in table  <dig> 

three organizations are consistent: o <dig> = {a, i, p1¯, p2¯}, o <dig> = {a, Ī, p <dig>  p2¯}, and o <dig> = {a, Ī, p1¯, p2}. in the remaining organizations it is at least for one species not clearly defined whether it is present or not. taking organization  <dig> for example, the presence of a and i is determined with a present and i absent, but there is no information concerning species p <dig> and p <dig>  in organization  <dig>  inhibitor i is present and absent at the same time. figure 1) depicts the reaction networks belonging to the three consistent organizations. they represent the three states of the switch. in organization  <dig>  inhibitor i is present and shuts down reactions  and , turning the switch off. in the other two consistent organizations i is not present and there is either a flux through reaction   or through reaction  . they represent the two other states of the switch.

RESULTS
we apply the method to a model of the central metabolism of e. coli by covert and palsson  <cit> . the authors used the model to study the effects of regulation on flux balance analysis. the regulatory network is defined by a set of boolean functions. there are  <dig> enzymes, which catalyze  <dig> reactions. of these reactions,  <dig> are regulated by  <dig> regulatory proteins and therefore controlled by logic statements. the unregulated proteins are assumed to be present in the cell at all times. we add an inflow for all of them in our analysis. to incorporate the regulation into the reaction network, we add the proteins that catalyze reactions explicitly as catalysts in the reactions as described above. following the introduced protocol, the regulatory logic is incorporated by introducing pseudo species and adapting the reactions accordingly. the activity of several genes is described by boolean statements. appropriate chemical reactions are added to model this gene regulation. we analyze two variants of the network model by covert and palsson  <cit> : a simplified core network to study wildtype growth phenotypes on different carbon sources, and the complete network for predicting knockout experiments. both networks are listed in the supplement  and provided as sbml files .

the core network model
for studying growth on different carbon sources including diauxic shift, the network is reduced to the set of reactions that lead from external glucose, lactose, and glycerol to pyruvate via glycolysis. additionally, the pentose-phosphate pathway reactions and the reactions leading from glucose-6-phosphate to this pathway are removed. the resulting network comprises  <dig> reactions of the original network. the considered part of the network does not contain any atp production. however, atp is used up by some reactions, for example in glucose uptake. therefore, atp is provided as input. furthermore, utp, nad, nadp, ubiquinone, and external hydrogen ions are necessary for other uptake and transformation reactions and cannot be provided by this part of the network. these species are added as input as well. to model growth, an outflow is added for every biomass precursor, as in the original network. since we consider proteins as being active only when they are produced, an outflow for every protein is added, modeling degradation. in order to model different growth media and conditions, self-replicator reactions for external glucose, lactose, glycerol, and oxygen are added of the form m →  <dig> m. these reactions ensure that a constant supply of the respective species is available, whenever it is considered to be present. using self-replicator reactions, all  <dig> =  <dig> different growth conditions can be modeled in a single network and can be simultaneously considered in one analysis.

the final model comprises  <dig> species  and  <dig> reactions. the complete list of network reactions can be found in the supplement.

the complete network model
for predicting the lethality of gene knockouts we use the complete network model of the regulated central metabolism of e. coli by covert and palsson  <cit> . depending on the availability of oxygen and the different carbon sources in the growth medium, influxes are added for the respective external species. the currency metabolites hext, pi, adp, atp, nad, nadh, q, qh <dig>  nadp, nadph, fad, fadh, utp, and coa are considered to be unconditionally available in the cell. input reactions are added for all these species. without the influxes of external carbon sources and oxygen, the network contains  <dig> species and  <dig> reactions.

growth phenotypes on different carbon sources
the core network model contains  <dig> consistent organizations. they are listed in table  <dig> . the consistent organizations coincide with the  <dig> possible growth conditions. the smallest organization, organization  <dig>  just contains the input metabolites plus the products of the hydrolyzation of atp, adp, and phosphate. when analyzing the genes that are active in this organization, we find that the response regulators for glucose, lactose, and glycerol are active, indicating that the respective carbon sources are not present. due to the absence of oxygen, the aerobic response regulators arca and fnr are also active.

for brevity, pseudo species indicating the absence of a species are not listed. a list of abbrevations can be found in the supplement. a species followed by 'xt' denotes its extra-cellular form. "ubiquitous proteins" include the proteins that are considered ubiquitously present in the cell and therefore are not listed separately. they are: eno, fba, fbp, galu, gapa, glk, gpma, gpmb, gpsa, pfka, pfkb, pgi, pgm, pyka, and tpia. "input metabolites" denotes the metabolites provided as input to the system: hext , q , atp, utp, nad, and nadp. "glycolysis metabolites" denotes the metabolites of the glycolysis: g6p, f6p, fdp, t3p <dig>  t3p <dig>  13pdg, 3pg, 2pg, pep, and pyr. "lactose derivatives" denotes the derivatives of lactose in the central metabolism: gal1p, glac, udpgal, bdglac, bdglc.

in organization  <dig>  external oxygen is available. consequently, the aerobic response regulators arca and fnr are absent here. this is the only difference between organizations  <dig> and  <dig> 

glucose uptake
the first organization that utilizes an external carbon source is organization  <dig>  which contains the reactions for glucose uptake. consequently, the metabolites of the central metabolism are present in this organization. when examining the proteins of the organization, we find that the glucose response regulator mlc is absent. the organization next in size is organization  <dig>  here, lactose is additionally in the medium. although the repressor of the lac gene, laci, is absent in the organization, no uptake reactions for external lactose are contained in the organization. the lactose permease lacy, a product of the lac genes, is missing. as glucose is available in the medium, the lactose uptake system is not induced by the presence of external lactose. this effect is known as inducer exclusion. the metabolite required for upregulation of the lac genes is not taken up by the cell. organization  <dig> represents a similar case in which glycerol is available in the growth medium but not taken up. all external carbon sources and oxygen are available in organization  <dig>  but the cell is still exclusively utilizing glucose. organizations  <dig> to  <dig> represent further input combinations defining growth conditions with external glucose available. the availability of oxygen does not change the reactions in the part of the central metabolism that is considered in the core model.

lactose uptake
in organization  <dig>  lactose is the exclusive external carbon source. consequently, laci is absent as it is bound by allolactose, a derivative of lactose. hence, it cannot repress the genes necessary for lactose uptake and utilization. we find the corresponding gene products present in this organization, namely lacz and lacy. additionally, derivatives of lactose, for example galactose, are contained in this organization. these metabolites are created in the pathway leading from lactose to the central metabolism. another diauxic shift effect can be observed in organization  <dig>  here, external lactose and glycerol are present as carbon sources, but as in the case with glucose and lactose, only lactose is taken up. organizations  <dig> and  <dig> represent further growth conditions in which lactose is taken up. once again, the availability of oxygen does not change the reactions in the modeled part of the central metabolism.

glycerol uptake
glycerol is the exclusive external carbon source in organization  <dig>  as all proteins necessary for glycerol uptake are present, glycerol is taken up. for glycerol uptake, three different enzymes catalyze the reaction from glycerol-3-phosphate to dihydroxyacetone-phospate, a metabolite of glycolysis. one of these enzymes, glycerol-3-phosphate-dehydrogenase, is constitutively expressed in the model. the other two proteins, glycerol-3-phosphate kinases glpabc and glpd are specific for anaerobic, respectively aerobic growth conditions. therefore, glpabc is present and glpd absent in organization  <dig>  where no oxygen is available. when oxygen is available as in organization  <dig>  glpd is present and glpabc absent.

predicting gene knockout experiments
knockout experiments are performed using the complete network model. gene knockouts are modeled by deleting all reactions in which the corresponding protein takes part as educt or product. the set of consistent organizations is determined for each knockout experiment using a heuristic approach detailed in the supplement. the lethality of a knockout can be predicted by the existence of organizations containing all biomass precursor metabolites. if such an organizations is not found, the knockout is predicted to be lethal. we use organization theory  and an adapted version of organization theory  to predict the same gene knockouts as covert and palsson  <cit> , who used regulatory flux balance analysis  for gene knockout predictions. reference  <cit>  is also our source for in vivo data and predictions by flux balance analysis  and rfba. the results are summarized in table  <dig>  out of  <dig> experiments, the predictions by fba are correct in  <dig> cases . the predictions by rfba are correct in  <dig> cases  and improve the results of fba in nine cases. unmodified ot predicts the lethality of knockouts correctly in  <dig> cases , while aot predicts  <dig> cases  correctly as rfba. the additional model-specific assumptions made by aot are taken from covert and palsson  <cit>  and will be described in detail now.

comparing in vivo knockout experiment results with predictions made by fba, rfba, ot and by aot. a '+' indicates growth, a '-' no growth of the mutants on the indicated substrate. for cases denoted as 'n', data was not available. results and predictions are derived from in vivo/fba/rfba/ot. in vivo data and references, fba and rfba predictions are taken from ref.  <cit> . in five instances, predictions made by ot deviate from rfba predictions . see text for discussion. the growth medium contained glucose , glycerol , succinate , acetate , or ribose . anaerobic condition is denoted by '-o2'.

assumption that accumulation of mass is lethal
in two cases, ot predicts a lethal knockout to be nonlethal . the self-maintenance property allows for the accumulation of internal metabolites, while in rfba, only steady states are considered, and any accumulation of metabolites is regarded as lethal. in these two cases, the organizations containing all biomass precursors contain metabolites with positive productions.  hence, ot predicts the knockout to be nonlethal while rfba predicts it to be lethal as no steady state exists. in aot we restrict our analysis to organizations that are balanced . with this model specific assumption aot classifies the two knockout experiments correctly.

assumption that secreted molecules have no effect
further three incorrect predictions by ot  yield deeper insights into the differences between chemical organization theory and regulatory flux balance analysis, namely in the treatment of by the cell secreted molecules.

in the case of acetate uptake, there are two pathways that enable the utilization of this carbon source as depicted in figure  <dig>  one pathway leads directly from acetate to acetyl-coa, and the other takes the route via acetyl phosphate. the first pathway is catalyzed by the acetyl-coa synthethase . according to the model, the corresponding gene is only transcribed if no carbon source is available or at most acetate or formate, or both. the second pathway is catalyzed by acetate kinase a  and phosphotransacetylase . if one of these genes is knocked out, the first pathway can still support the central metabolism, given that acetate is the exclusive external carbon source. in this case, chemical organization theory predicts both knockouts as lethal, which is not the case in vivo and correctly predicted by rfba. the reason for this discrepancy is that in any network containing the biomass precursor metabolite pyruvate, this metabolite will be secreted by the cell. therefore, such a network also comprises the external form of pyruvate which is an inhibitor for the only remaining uptake reaction for acetate. consequently, there exists no organization containing all biomass precursor metabolites when acetate is the exclusive carbon source in the growth medium and the second pathway is knocked out. because the presence of metabolites is not explicitly considered in rfba, this inhibition is not detected by rfba. however, because the knockout is nonlethal in in vivo experiments, the levels of secreted pyruvate might not be suffcient to have an effect on the expression of acs. or, the cell switches its uptake from acetate to pyruvate until it is depleted and then switches back to acetate again.

the incorrect prediction of the knockout of ppc on glycerol as nonlethal can be explained by the same argument. gene ppc codes for the phosphoenolpyruvate carboxylase, which supplies the citric acid cycle with oxaloacetate . when ppc is knocked out, the only alternative for oa production is the glyoxylate shunt, consisting of the isocitrate lyase  and the malate synthase a . however, the glyoxylate shunt is only active if e. coli grows on acetate or fatty acids as the sole carbon source  <cit> . hence, the knockout of ppc on a glycerol growth medium is lethal in vivo, as the glyoxylate shunt is not activated. in the model, the glyoxylate shunt is regulated by the fatty acid and acetate response regulators iclr and fadr as depicted in figure  <dig>  gene fadr is only expressed if external glucose, or no acetate is available in the growth media. if activated, fadr leads to an upregulation of iclr, which then leads to a downregulation of acea and aceb, inactivating the glyoxylate shunt. if acetate is available in the growth medium, fadr is not expressed, and thus acea and aceb are expressed at high levels, activating the glyoxylate shunt. any organization containing the biomass precursor metabolite acetyl-coa also contains acetate, which is secreted. hence, any organization containing the biomass precursors also contains the external form of acetate, which activates the glyoxylate shunt.

even though considerable amounts of acetate secretion on glycerol media has only been reported in high density cultures  <cit> , ot indicates the possibility for e. coli to grow on glycerol if ppc is knocked out. our result suggests that the activation of the glyoxylate shunt would be enough. there have been reports of e. coli strains growing on glucose media that were also able to grow with ppc knocked out, which is usually lethal. this was facilitated by a mutation that lead to an upregulation of the glyoxylate shunt  <cit> . thus, the results of ot might be biological feasible in this case.

the problems encountered in the regulation by secreted species can be resolved by introducing a pseudo species representing the secreted version of a species. therefore, in aot, a metabolite that can be secreted is represented by two species: one represents the metabolite at high concentration , the other species represents the metabolite at low concentration . these modifications allow aot to correctly predict the three cases discussed above. note that the underlying assumption of this modification is also made by covert and palsson  <cit> .

discussion
by transforming the boolean formalism that represents the regulation of a metabolic network into reaction rules, we were able to demonstrate how chemical organization theory can be applied to regulated metabolic networks. using a model of the central metabolism of e. coli  <cit> , each of the  <dig> wildtype growth scenarios were correctly predicted down to the presence of each protein. each external condition could be directly mapped to a single organization implying a distinct qualitative state of the network .

knockout experiments
without specific assumptions, organization theory  was able to predict the lethality of knockout experiments correctly in  <dig> out of  <dig> cases . with model specific assumptions, "adapted" organization theory  was able to predict the lethality of knockout experiments correctly in  <dig> cases , achieving the same performance as rfba  <cit> . when comparing the performance of ot and rfba with respect to knockout predictions, it must be noted that the model used for the comparison was co-developed with rfba. specific assumptions were made that were deliberatly not made in the pure organization analysis as ot shall provide an universal analysis technique applicable to general biological network models . in this light, we consider the performance of organization theory as competitive.

moreover, there are cases in other models in which predictions by ot are more accurate than those by fba. this occurs, for example, due to the fact that fba only incompletely takes co-factors into account. these co-factors are molecules that are necessary for some reactions to proceed. they can interact through various means with the substrates and products of a reaction. in the  metabolic model by reed et al.  <cit> , we identified  <dig> cases in which ot correctly classifies a knockout as lethal while fba does not. the reason for this difference is that the identified co-factors are necessary for producing biomass metabolites , but they are not considered as biomass metabolites .

influence of model specific assumptions
in our analysis of the model by covert and palsson  <cit> , we found five cases in which ot predictions differ from rfba predictions. all of these cases can be resolved by aot in a straightforward way by taking assumptions into account also made by rfba in  <cit> . in particular, the deviation between ot and fba has uncovered two critical aspects:

first, fba only considers steady states. a system state with accumulating metabolites is regarded as lethal. in ot, accumulating metabolites are explicitly allowed to also cover system states related to growth. to adopt the steady state assumption in ot however, one simply can restrict the analysis to balanced organizations in aot. however, only considering steady states is not necessarily the best "natural" choice. as models usually are not complete, the biological system might contain pathways that are not modeled but can take care of overproduced metabolites. also, certain molecular species accumulate in the cell at certain time points, for example in different phases of the cell cycle. hence, states with positive productions of certain species are not necessarily lethal.

second, in ot only the presence or absence of metabolites is considered. hence, even smallest concentrations of species will potentially trigger further responses. when secreted metabolites have much lower concentrations than external metabolites supplied by the growth medium, this can lead to wrong predictions as secreted metabolites shall not trigger further regulation . however, the problem can easily be resolved by introducing two species representing the metabolite at a high and at a low concentration, respectively. alternatively, we could use the positive flow from the carbon source as a signal for the high concentration of the external metabolite . note however, that with the unmodified ot we found a phenotype that indicates how to bypass the in vivo lethality of a knockout in one case.

identification of all potential qualitative phenotypes
organization theory provides a rigorous link between an organization and the potential dynamics of the reaction system : if there is a steady state, then the species with positive concentrations must be an organization. thus, we can guarantee that there is no other species combination that can give rise to a stationary state. note that the species sets our method identifies contain also proteins, so that the organizations we obtain describe not only which metabolites are present but also which proteins are active in any possible steady state.

a related issue has been raised by shlomi et al.  <cit> : the choice of a flux vector producing biomass in the fba phase of rfba leaves open a whole range of possible flux vectors in the space of possible solutions of rfba. thus, also the outcome of the experiments might depend on this choice. in contrast, ot takes all possible fluxes into account. if there are several qualitative phenotypes  consistent with the regulatory rules, several organizations will be found .

application to large-scale models
the largest organization does not necessarily encompass the whole system. thus when analyzing larger models, ot allows the exact prediction of those parts of a model that can give rise to a steady state. parts missing in such a state can then be refined. for example in the case of knockout experiments, we can determine which part of a network is still available. such knowledge is important when trying to reduce a metabolic model for a specific purpose, for example to increase the production of a certain metabolite. even though the presented method can also be used for genome scale networks, it remains to be seen if all of the regulated organization in such a system could still be found. the bottleneck in the computation is the determination of all organizations of a regulated network before checking if they are consistent. their number can grow exponentially with network size, in which case computation is primarily constrained by the available memory. this problem might be circumvented by an approach that partitions the solution space of the self-maintainance condition and searches those partitions in parallel for organizations . however, such an approach has not yet been implemented. currently, the analysis of a pure  metabolic network of genome scale by  <cit>  is possible with the heuristic approach . if the number of organizations in such a network is small, all of them can be found with the heuristic approach  <cit> . whether and how this scales to regulated genome-scale models is an open issue.

other approaches for integrated network analysis
in recent years other approaches for the integration of regulatory networks into stoichiometric analysis have been proposed: steady-state regulatory flux balance analysis   <cit>  builds on rfba and allows the flux analysis within one step. boolean regulatory rules are integrated into the fba approach by using mixed-integer linear programming. thus, fluxes that obey the regulatory constraints can be computed directly without prior determination of the state of the regulatory network as in rfba. in contrast to our approach sr-fba focuses, like fba, on specific fluxes through the network. thus a possible flux for each possible reaction among the molecules like in organization theory , is not required for a feasible flux vector in sr-fba. likewise problems with co-factors like in fba occur .

another approach, a matrix formalism to analyze regulatory systems, has been proposed by gianchandani et al.  <cit> . similar to our approach, they formulate the regulatory network by representing it as reactions in the stoichiometric matrix. then they analyze the integrated network by using extreme pathway analysis  <cit> . the main difference to our work is that modelling based on the stoichiometric matrix requires a flux through the regulatory network. thus inhibitors and activators are consumed upon interaction and are not modelled as catalysts. even though the authors only analyzed a pure regulatory network, an integration into a metabolic network seems to be possible. interestingly, the concept of a functional state of the resulting network, i.e., the state when all external inputs are defined, resembles the organizations we found. however, those states are restricted to the regulatory part of the network, since the closure of the participating molecules is not taken into account. another aspect of this concept that has not yet been analyzed is to which extent this method can also be applied to larger networks, for example those we analyzed in this work. the integration of the regulatory network into a metabolic network using a flux through the network might further increase the combinatorial explosion of the number of extreme pathways. nonetheless, this approach is valuable for identifying underlying pathways in a regulatory network, a prospect which has not yet been analyzed in connection with ot.

CONCLUSIONS
because ot does not rely on kinetics, it can serve as a first step to analyze the potential behavior of regulated systems. the analysis delivers all potential network phenotypes described by the sets of molecular species that can coexist over a long time . the further analysis of the network can then focus on interesting phenotypes. taking the other direction, it is possible to validate in silico network models. all phenotypes of interest observed in vivo should have corresponding organizations in the network model.

when regulation is considered in metabolic networks, the presented approach offers the advantage that both the metabolism and its regulation are modeled within one single framework: chemical reaction rules forming a network. the unification comes at the expense of introducing a set of pseudo species to represent the absence of species. this allows one to model and consider inhibitory interactions within the framework of organization theory. using an appropriate user interface, the pseudo species can be easily hidden.

authors' contributions
ck and pd introduced the idea of pseudo species indicating the absence of metabolites. all authors contributed to the presented new concepts and procedures building on the framework of organization theory. software implementation, data preparation, and analysis was done by ck and fc. all authors read and approved the final manuscript.

supplementary material
additional file 1
supplement including the analyzed network models and a descritption of the employed algorithms to compute organizations.

click here for file

 additional file 2
the analyzed core model in sbml format.

click here for file

 additional file 3
the analyzed complete model in sbml format.

click here for file

 acknowledgements
financial support by the federal ministry of education and research  grant 0312704a, the eu , and the german research foundation  grant di852/4-x is greatly acknowledged.
