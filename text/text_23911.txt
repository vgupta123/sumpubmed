BACKGROUND
microarray-based high throughput transcriptomic analysis profiles transitory changes in gene expression of an organism in response to perturbations such as a disease state or exposure to chemical or non-chemical stressors. a selected set of characteristic gene signatures could serve as a diagnostic or prognostic tool for samples of interest with regard to a possible perturbation. since the development of microarray technology in the 1990’s, there has been a steadily increasing interest in developing these gene signatures for various clinical and environmental applications  <cit> . as a result, several gene classifiersa were approved for use in human clinical diagnostics, and many more yet to be validated candidates have been identified for ecotoxicological purposes.

to date, most transcriptomics-based gene classifier studies have been conducted in the area of human clinical diagnosis and prognosis, often with mixed results. however, there have been several successful applications recently. for example, four subtypes of breast cancer were differentiated by expression profiling  <cit> , and a 70-gene prognostic classifier was successfully developed and approved by the us food and drug administration to characterize breast cancer patient risks  <cit> . the pathwork tissue of origin test, a microarray-based gene expression test involving  <dig> genes, was also shown to be capable of determining the tissue of origin of poorly or undifferentiated cancers, thus facilitating their diagnosis  <cit> . perhaps the most encouraging success so far is the concept of connectivity mapping , where chemical compounds with similar/dissimilar mechanisms of action  and disease states can be connected by assessing a group of their gene signatures relative to a reference collection of gene expression profiles   <cit> . despite these notable successes, there remain issues that need to be resolved before a widespread acceptance and application of gene classifier approaches become reality, perhaps particularly so in ecotoxicology. for example, the stability/reliability of gene classifiers across independent studies is a common concern. often, classifiers developed for the same phenotype from different studies have little overlap and perform rather poorly on independent datasets  <cit> . and many proposed ecotoxicological gene classifiers are simply differentially expressed genes lacking vigorous statistical and experimental validations.

the predictive performance of a gene classifier is dependent on several technical and biological factors, including quality of data acquisition, choice of classification algorithm, and the complexity of the dataset under investigation. this data complexity refers to the extent to which a dataset is intrinsically structured such that classes of treated and control samples can be separated into distinct groups as defined by gene features . when data quality and classification algorithms are controlled, for example within the same study, the difference in complexity among chemical-tissue conditions underlying gene classifiers may become critical to their respective performance  <cit> . this relationship between data complexity and the performance of a gene classifier was addressed in several recent studies  <cit> . a number of measures such as fisher’s discriminant ratio , overlap between the distributions of two classes, and feature efficiency have been proposed to capture this complexity  <cit> . studies comparing cancer biomarkers suggested that their performance is closely linked to data complexity and sample size  <cit> . when this function is not optimized, there is an increased risk of model overfitting, where stochastic noise in training data gets incorporated and results in poor classifiers. an assessment of classifier performance as a function of data complexity in an ecotoxicological context, therefore, could generate significant empirical insights concerning issues such as sample size required for discovery of a particular type of gene classifier in an optimized experimental design.

application of microarray technology, in general, and development of microarray-based gene classifiers, in particular, for ecotoxicological applications lags far behind those in human biomedical sciences. despite numerous candidate molecular indicators discovered in recent years, few are field-ready for exposure and risk assessment of environmental stressors. several issues probably contribute to this relative lack of progress. first, there is a general lack of knowledge of the data complexity of individual chemical stressors. it is not clear what sample size is required for discovery of a gene classifier for any given chemical with a unique moa. much of the published literature on gene classifier discovery in ecotoxicology involved only a minimum number of biological replicates across treatment conditions due to the prohibitive cost of microarray technology, despite the desirability of a much larger number of replicates  <cit> . second, very few studies have actually conducted independent validations on targeted candidate gene classifiers, a critical step neglected in the discovery process. without vigorous validation, it is not at all clear how reliable putative gene classifiers are for chemical exposures. finally, ecotoxicological application of gene classifiers is also complicated by a large number of uncontrolled physical, chemical, and biological variables in a field setting relative to human clinical applications.

the purpose of this study was to discover gene classifiers for a number of endocrine-disrupting chemicals  with different moas, evaluate their performance, and gain insights on issues important to the discovery process in general, through vigorous computational search and statistical analyses with an experimental design and sampling strategy similar to those found in the current ecotoxicological literature. in addition, the summary statistics of classifiers by various search categories may also shed additional light on the biological impact of these edcs. specifically, our objectives were to: 1) search for edc classifiers either across the entire zebrafish transcriptome or within individual transcription factor  networks based on the microarray data from edc-exposed fish samples; 2) generate additional microarray data dedicated to validation only and test the performance of selected candidates; 3) evaluate the correlation between the performance of classifiers and the data complexity of individual chemical-tissue conditions as measured by f-ratio; 4) and assess the relative effects of edcs on zebrafish based on the summary statistics of classifiers across chemicals, tissue types, and tf networks.

methods
exposure, sampling, rna extraction, and microarray profiling
as part of a larger computational toxicology project studying the impact of a number of edcs on the hypothalamic-pituitary-gonadal  axis in fish, approximately  <dig> microarrays covering  <dig> treatment conditions for zebrafish were available for this investigation  <cit> . many experiment details regarding the project, including the research goals, design, test chemicals, fish exposures, biological endpoints and sample handling  are available elsewhere  <cit> . only a brief overview is provided below.

zebrafish exposures were conducted using  <dig> chemicals with differing known/hypothesized moas within the hpg axis: 17α-ethynyl estradiol, fadrozole, 17β-trenbolone, fipronil, prochloraz, flutamide, muscimol, ketoconazole, trilostane, and vinclozolin  <cit> . reproductively mature male and female zebrafish were exposed to a continuous flow of test chemical , delivered in water , for  <dig>   <dig>  or 96 h. at the end of each exposure period, fish were euthanized in a buffered solution of tricaine methanesulfonate  and tissues, including gonads, liver, and brains  were collected. total rna isolated from selected tissue samples was labeled and hybridized to microarrays by an agilent certified contract laboratory . expression profiling in zebrafish was achieved using agilent two-color zebrafish microarrays . data from approximately  <dig> microarrays, representing  <dig> treatment conditions encompassing the  <dig> chemicals, three tissue types, and three exposure durations, in both male and female zebrafish were analyzed for candidate classifiers . additional unused  <dig> fish tissue samples of flutamide-ovary, prochloraz-ovary, and prochloraz-brain were set aside and subsequently profiled by microarrays for the validation of their corresponding classifiers. the entire microarray dataset is accessible through the national center for biotechnology information gene expression omnibus  <cit>  with the accession number gse <dig> 

except for trilostane-ovary and trilostane-testis, each entry represents equal number of independent replicates of both treated and control samplesa. in trilostane where some of the same controls were paired to different treatment conditions, only unique ones were counted. conditions with less than nine samples in either class were excluded from classifier search. “na”, a condition not included in the study. the dataset of “all tissues” includes brain, ovary, testis, as well as a few additional samples from liver for selected conditions.

afor example, 17α-ethynyl estradiol-brain had  <dig> treated samples and  <dig> control samples; bmale only; cmale and female; dfemale only.

gene classifier discovery and validation
putative classifiers for various chemical-tissue conditions were identified through intensive computational searches with two different strategies . while there are a great number of algorithms available for microarray-based gene classifier discovery, a choice was made to employ a combination of either ga-svm  or ga-knn  based on their previous evaluations as being the best and second best performer respectively  <cit> . ga is a computational approach modeled on biological evolution, incorporating concepts and processes such as genes, chromosomes, selection, recombination, mutation, and fitness  <cit> . it is a powerful tool for optimization, and thus well-suited for the task of reducing data dimensionality by selecting a small number of informative gene features among tens of thousands present on a microarray, a necessary first step for any classifier discovery algorithm. genes selected and arranged into chromosomes then evolve under the principles of biological evolution employing either svm or knn as a fitness function. the fitness here is equivalent to the performance of a classifier. svm can handle both linearly separable and non-separable microarray data  <cit> . the algorithm projects samples from a training dataset into high-dimensional space separated by a hyperplane  <cit> , which is captured in a svm model to be used subsequently for classifying unknown samples. knn identifies a sample in question based on the class memberships of its nearest neighbors as determined by a distance measure in a multi-dimensional space defined by gene features  <cit> .

the performance of gene classifiers was then evaluated by gene set enrichment analysis , where a classifier containing a group of gene signatures associated with a treatment condition was determined for their non-random distribution on the rank-ordered gene lists from the geps of both training and validation data. if a classifier formatted as a gene set is enriched in these gene lists, their respective underlying chemical-tissue conditions must have similar moas, leading to the validation of the classifier. on the original training data, gsea was conducted for the classifiers of all the conditions. for the dedicated validation data, only classifiers for several selected chemical-tissue conditions were assessed. the identities of these conditions were known but withheld during analysis.

microarray data preparation and characterization
to avoid issues resulting from complications of tissue-specific expression  <cit> , gene classifiers were searched primarily within a tissue type. datasets were prepared in this investigation separately from samples of ovary , testis , and brain . as a comparison, an inclusive dataset was also generated containing all samples from above, plus several more from liver. several dye-swaps among the  <dig> microarrays were excluded. individual microarrays were processed as single channel intensities  since, for these studies, the two channels contained unique biological samples  <cit>  and the search for a binary classifier was more straightforward. data preprocessing including filtering and normalization was conducted by dataset, identical to that described by wang et al.  <cit> . the data complexity of a chemical- tissue condition was captured by f-ratio statistic, an effective measure of microarray data complexity  <cit> :

  fimax=μ1−μ22/,i=1ton 

where μ <dig>  μ <dig>  σ <dig>  σ <dig> are the means and variances of the two classes in the condition, and fi the estimated value for gene feature i.

choice of software
both ga-svm and ga-knn were implemented through the software r  <cit>  package galgo  <cit> . the algorithms were implemented in such a way that during a search, samples would be split randomly into a training group versus a test group a number of times. to ensure a minimum number of samples in both groups for the algorithm to function, each chemical-tissue condition must have at least nine microarrays  in order to be included in the search for a gene classifier.

general search strategies
both the transcriptome-wide searches by ga-svm and the network-specific searches by ga-knn were applied to the three tissue-specific datasets and the all tissue combined dataset. while these datasets contained data for multiple chemical-tissue conditions, each search was always conducted on an individual condition within a dataset. several considerations were taken into account in the design of search strategies with regard to datasets, search scope, and algorithms. to avoid the dominant impact of tissue type on geps, searches were primarily conducted within individual tissue types. however, to demonstrate tissue effect on classifier discovery, the all tissue combined dataset was also analyzed. for each chemical-tissue condition, the search scope was either across the entire zebrafish transcriptome or limited to previously reverse-engineered, individual tf networks  <cit> . in other words, the sampling space for ga consisted of all the expressed genes in zebrafish or those belonging to a particular tf network only. given the established linkage between these tf networks and edc effects in zebrafish, this network-specific search could potentially produce more mechanistically-based classifiers. ga-knn was used for the network-specific searches because it is computationally less intensive than ga-svm, and the overall computing load for these searches was far greater than that of the transcriptome-wide searches as a result of hundreds of tf networks over multiple chemical/tissue conditions involved. to further reduce computing demand, network-specific searches for the all tissue combined dataset were limited to three of its chemical-tissue conditions.

transcriptome-wide search
all gene features remaining in a given dataset  after data preprocessing were included in the search space for ga-svm. the number of features was  <dig> in brain,  <dig> in ovary,  <dig> in testis, and  <dig> in the all tissues-combined dataset. prior to searches by ga-svm, a “cost” parameter necessary for a selected svm kernel function had to be determined for individual datasets. an r script was developed for this purpose to conduct a grid search using the r package e <dig>  an interface to c++ library libsvm  <cit> . the ga-svm search was configured by the galgo setup function configbb. varsel, and is summarized in additional file 2: table s <dig>  a ga-svm search was conducted independently for  <dig> different chemical-tissue conditions.

network-specific search
a tf network consists of a tf regulator and a number of target genes under its transcriptional regulation. a tf regulator is also referred as a hub tf. previously, we identified  <dig> reverse-engineered tf networks significantly impacted by edcs  <cit> . network-specific searches by ga-knn were applied to these  <dig> networks as well as the two additional groups of genes: the hub tfs of the  <dig> tf networks compiled into a separate group termed master regulators, and a list of genes coding for proteins known to be involved in regulation of the hpg axis  <cit> . for simplicity, the master regulators and hpg axis will also be counted as tf networks hereafter in the context of classifier search. given the number of chemicals, multiple tissue types, and hundreds of tf networks, a separate r script wrapper had to be developed for galgo in order to batch process a large number of searches. ga-knn searching was also configured by the galgo setup function configbb. varsel . searches for classifiers were conducted for each chemical-tissue condition by the  <dig> networks, which translated to over  <dig>  independent searches spread out over multiple nodes of a computer cluster with the linux operating system.

prioritizing candidate classifiers
the nature of ga-svm and ga-knn was such that there were typically multiple models generated in a search for a given gene classifier, with each model reaching the same pre-defined fitness goal and containing a number of gene features. some of these gene features were often redundant among models. in the case of the transcriptome-wide search, the union of these models was first determined. the resultant unique set of gene features was then visually screened for class separation by its corresponding heat map for a particular chemical-tissue condition. since network-specific searching involved multiple tf networks within a chemical-tissue condition, unique sets of gene features, each derived from multiple models within a network, had to be visually screened by their respective heat maps first, and if qualified, merged across tf networks. those gene features that were redundant across multiple chemical-tissue conditions were then removed in order to reduce ambiguity in future field applications where multiple chemical mixtures may be present. otherwise, a classifier with a subset of gene features responsive to multiple chemicals will become less condition-specific. the remaining gene features unique to a single chemical-tissue condition were then each ranked by the number of tf networks in which it was selected into a model. the top  <dig> were chosen as a classifier for each condition. for both transcriptome-wide and network specific searches, a heat map was generated by an r script developed in house based on a unique set of gene features and the gene expression data of a given chemical-tissue condition from which these features were identified. each heat map contained two-way clustering of samples and genes. during its visual screening, a unique set of gene features would qualify as a classifier  or for further consolidation across tf networks  only if there was a complete separation of treated and control samples into two distinct clusters. the phrase “qualified classifier” was used only in this context throughout this study.

validation
qualified classifiers from all of the chemical-tissue conditions, one classifier per condition, were converted into gsea format  and organized into two files according to their tissues of origin . each classifier composed of multiple gene features became a gene set. gene features were represented by their corresponding gene symbols  <cit> , if available on agilent zebrafish annotations, or original probe identifications . the two gene set files were tested on both the original training dataset and a newly generated validation dataset. this new set of geps was generated from fish exposed concurrently with the other fish used previously for the training data. a total of  <dig> samples,  <dig> ovaries and nine brains, and their paired controls were profiled for their gene expression. labeling and hybridization protocols employed for these new data were similar to those used for the training data; however, a newer version of agilent zebrafish microarray  had to be used because the previous design  <dig> was discontinued. the ovary samples included eight treated with flutamide and eight treated with prochloraz. and there were another eight brain samples from fish treated with prochloraz as well. these chemical-tissue conditions were selected because they had a large number of tf networks each generating a qualified classifier. similar to the previous training data, half of the samples in each of these three treatment conditions were exposed for 48 hr and the other half for 96 hr. each sample was also paired to its corresponding control. the remaining four samples were extra controls from these exposures included for microarray data preprocessing only. outputs from agilent feature extraction software were organized into three datasets, brain only, ovary only, brain and ovary combined, and processed as single channel intensities following a previously described procedure  <cit> . these three different ways of organizing the same outputs provided an opportunity to assess whether microarray data preprocessing would be impacted by sample size.

given that the data for training and validation were produced from agilent zebrafish microarrays of two different designs, their probe ids had to be cross mapped . several types of evidence were considered when cross-mapping the probe ids between the designs: probe sequences, probe coordinates along a chromosome , genbank reference sequence , ensembl gene sequences   <cit> , and ensembl cdna sequence . probes were mapped by common sequence targets on cdna, refseq, and genes by blastn at a minimum e-value of e- <dig>  or perfect match of probe sequences, or +/− 50 bps of start positions on the same chromosome. number of probes matched between the designs varied with type of evidence . overall,  <dig> of  <dig> probes from the design  <dig> were matched to  <dig> of  <dig> probes from the design  <dig> 

a typical classification algorithm such as svm relies on a training dataset and its derived computational model to make a prediction on an unknown test sample. it is difficult to evaluate the performance of a gene classifier on its own independent of the original training data. two alternative approaches were adopted to address this issue, one statistical and the other by visual examination of heat maps. in gsea  <cit> , a classifier originating from a known chemical-tissue condition was validated on the newly produced geps. in the current study, qualified classifiers for various conditions were organized into gene sets by brain or ovary, and analyzed with either the original training data or the newly generated geps dedicated for validation. each classifier contained gene features unique only to its own chemical-tissue condition and not shared with any other classifiers. the gene sets were paired to a microarray dataset with the same tissue type. gsea was conducted using an r script wrapper and the release gsea. <dig> .r from the broad institute  <cit> . based on the gsea results, selected heat maps were generated for prochloraz gene classifiers from brain and ovary using their respective, tissue-specific training and validation datasets. to function effectively as a positive control, gsea was also conducted for all the classifiers on the original training datasets of brain and ovary. for both gsea and heat maps, gene features were cross mapped between the microarray design  <dig> and  <dig> based on the procedure and outputs described above, but at an elevated stringency of e- <dig> for blast-based evidence  and +/− 20 bps for probe starting positions .

RESULTS
putative classifier identification and their distribution across chemicals, tissues, and networks
in the current study, microarray data were organized and prepared according to individual tissue types  each containing multiple chemicals . each condition may also contain data from multiple time points of exposure. several brain conditions also had mixed male and female fish, with seemingly minimal impact on the discovery and performance of their classifiers. the purpose of pooling data in these conditions was to have increased sample size for their classifier search. a separate dataset was constructed by combining all three tissue types together along with additional liver samples for 17α-ethynyl estradiol, flutamide, ketoconazole, and 17β-trenbolone. searches for gene classifiers were conducted for individual chemicals and their controls in these four datasets  either across the entire zebrafish transcriptome or within each of the  <dig> individual networks . given the nature of binary searches, a classifier discovered in this study was intended only for distinguishing geps from fish exposed to a chemical or control within a particular tissue, and not for diagnosing between chemicals. while most of these  <dig>  plus searches yielded putative gene classifiers, only a small subset of them was later qualified by visual evaluation of their heat maps . unless otherwise explicitly stated, it is these qualified classifiers that are analyzed and discussed further. in addition, throughout this report, a classifier will always be discussed in the context of a chemical-tissue condition. for example, a classifier for prochloraz-ovary would refer to a number of gene features identified from the ovary microarray data of prochloraz-treated fish. if valid, it should diagnose geps of fish with the same exposure history.

searches were conducted transcriptome-wide using genetic algorithm-support vector machine followed by visual screening of heat maps. each condition refers to the tissue sampled from fish treated with a particular chemical. “na”, a condition not included in the study; “---“, insufficient sample size for classifier search.

a total of  <dig> individual networks were analyzed by chemical-tissue conditions using genetic algorithm-k nearest neighbors. within a condition, each tf network contributed one classifier composed of multiple gene features. “na”, a condition not included in the study; “---“, insufficient sample size for classifier search; “0”, searched but no qualified classifier; “&”, no search conducted.

abetween  <dig> to  <dig> of the  <dig> networks did not contain sufficient number of genes to be searched due to variations in their availability in different datasets.

given the strong impact of a tissue type on an overall transcriptional profile, it is not surprising that no classifiers were discovered for any chemicals using the expression data combined from multiple tissues . when searches were conducted across the entire zebrafish transcriptome using only data from individual tissue types, classifiers were found for six conditions: muscimol-brain, flutamide-ovary, ketoconazole-ovary, prochloraz-ovary, fipronil-testis, and prochloraz-testis . a typical classifier for these conditions had approximately  <dig> gene features. excluding those features shared among multiple conditions, a classifier for each of the six conditions had from  <dig> to  <dig> unique gene features.

in addition to searches across the entire zebrafish transcriptome, similar analyses were also conducted by tf networks. the search space for these was limited to the  <dig> individual networks, including a group of genes compiled for hpg axis and another group made up exclusively of hub tfs , the networks of which had been previously linked to various chemical-tissue conditions   <cit> . while preliminary classifiers were found from the hpg axis and the master regulators respectively for all  <dig> possible chemical-tissue conditions, only one classifier  from the master regulators later qualified based on its heat map. among the remaining  <dig> tf networks searched, a number of qualified classifiers were found for each of  <dig> chemical-tissue conditions  from a total of  <dig> unique networks, with one per tf network per condition. at maximum, gene features in a given tf network could be selected into classifiers for  <dig> different conditions, with a median of two . the top contributing tf networks in this regard  included xbp <dig> , hif1ab , ybx <dig> , smad <dig> , and yy1b . no preliminary classifiers from fadrozole-ovary, 17β-trenbolone-ovary, flutamide-testis, and trilostane-testis were qualified . brain tissue had the greatest number of tf networks  each yielding a qualified classifier, followed by ovary  and testis . by individual chemicals, prochloraz had the greatest number of tf networks  each generating a classifier, followed by flutamide , fipronil , and 17α-ethynyl estradiol . a similar pattern was also observed in the distribution of number of gene features in a classifier . classifiers from brain had the most gene features , followed by ovary  and testis . chemical-wise, classifiers for prochloraz had the greatest number of gene features , followed by flutamide , and 17α-ethynyl estradiol  . a majority of these gene features overlapped among multiple classifiers.

based on agilent probe ids, each total count includes those gene features overlapping among multiple classifiers. while search was network-specific, gene features were summarized across multiple networks in a classifier for a given condition where available. a total of  <dig> features were selected into classifiers for the  <dig> conditions listed. “na”, not included in the study; “---“, insufficient sample size for classifier search; “0”, searched but no qualified classifier.

testing/validation of selected classifiers
after their discovery from the original training dataset and passing visual screening of heat maps, classifiers were still considered as candidates until further validation on an independently generated microarray dataset. using gsea, a classifier defined by its original chemical-tissue condition, for example, prochloraz-ovary, was tested to see if it could correctly identify the exposure in an independent organism with the same exposure history. a total of six classifiers from the transcriptome-wide search and  <dig> classifiers from the network-specific search each had enough gene features unique only to a particular condition to be a useful gene set. to prove its utility as a diagnostic tool, gsea of classifiers was also conducted on the original training data alongside with the new validation dataset. in theory, gsea should link a classifier to the geps of the training data sharing a common chemical-tissue condition.

the results of testing classifiers were inconsistent. discrepancies existed not only between the original training data and validation dataset, but also within each of them. as expected for the training data, nine out of the  <dig> gene classifiers identified the chemical exposures of their original geps as top candidates based on statistically significant enrichment of gene sets on ranked gene lists . the classifier for flutamide-ovary also identified its target gep of the same condition, but only as the third choice. however, in the majority of cases, several classifiers representing different chemical-tissue conditions would also identify the same gep. for example, classifiers for prochloraz-ovary, ketoconazole-ovary, and flutamide-ovary all diagnosed the gep of prochloraz-ovary. the gep of fadrozole-brain, however, failed for all classifiers tested, including surprisingly its own.

each classifier was formatted into a gene set, and multiple gene sets were grouped by their tissue of origin. gsea was conducted by individual chemical-tissue conditions, at a threshold of fdr ≤  <dig> . classifiers enriched on the top or bottom of a ranked gene list are separated by a semicolon. if two classifiers of the same condition are both significant, only the most significant one is listed. a gep in bold indicates the availability of its corresponding classifier as a gene set. fdr, false discovery rate; f-ratio, maximum fisher’s discriminant ratio; “na“, a condition not included in the study.

asearched but no qualified classifier found for the condition. its gsea was conducted using classifiers for other unrelated chemical-tissues.

bno classifier search was conducted due to insufficient sample size for the condition. its gsea was conducted using classifiers for other unrelated chemical-tissues.

while testing classifiers on their original training data proved the utility of gsea as a diagnostic tool, a classifier has to be evaluated on data completely independent from its discovery. the results were also mixed when selected classifiers from brain and ovary were tested separately on the validation dataset . since the validation datasets prepared by ovary, brain, and their combination all gave similar results, only gsea results based on the combined brain and ovary data are presented. despite potential issues resulting from cross-mapping probes between the two microarray designs or slight differences in sample preparation, the gep of flutamide-ovary was diagnosed by its corresponding classifier, and by classifiers for vinclozolin-ovary, ketoconazole-ovary, and prochloraz-ovary as well. similarly, the gep of prochloraz-ovary was also identified by its classifier and that of ketoconazole. in contrast, none of the classifiers was able to identify the gep of prochloraz-brain. when the classifiers for prochloraz-brain and prochloraz-ovary were evaluated visually by their heat maps on the corresponding geps of the same chemical-tissue conditions from the original training and validation datasets, the complete separation of treated and control samples observed in the training datasets was not evident in the validation data .

although the gene expression profiles  were preprocessed as a whole by combining data from both brain and ovary, each gsea was conducted by individual chemical-tissue conditions at a threshold of fdr ≤  <dig> . classifiers enriched on the top or bottom of a ranked gene list are separated by a semicolon. if two classifiers for the same condition were both significant, only the most significant one is listed. mapping of the probe ids between the agilent design  <dig> and  <dig> was based on identical probe sequences only. fdr, false discovery rate; f-ratio, maximum fisher’s discriminant ratio. “na”, a condition not included in the study.

awhen the geps were preprocessed with data from ovary only, the fdr for flutamide-ovary was  <dig> .

data complexity of chemical-tissue conditions
given the impact of data complexity on the performance of gene classifiers, it is potentially informative to bring this measure into the discussion. a smaller f-ratio reflects less separation of the population mean responses of treated and controls in a given condition relative to their variances, thus a greater complexity.

within the training data, fadrozole-brain had the smallest f-ratio , followed in ascending order by  17α-ethynyl estradiol, muscimol, fipronil, ketoconazole, prochloraz, and 17β-trenbolone . in ovary, fadrozole again had the smallest f-ratio , followed by 17β-trenbolone, ketoconazole, vinclozolin, fipronil, trilostane, prochloraz, 17α-ethynyl estradiol, muscimol, and flutamide . between the two tissues, the relative ranking order of f-ratios remained similar for some chemicals but changed with others, notably 17α-ethynyl estradiol, muscimol, and 17β-trenbolone. there was also a several-fold difference between the largest f-ratios in ovary versus the brain, of flutamide-ovary and 17β-trenbolone-brain respectively. on average, the geps of ovary had a greater f-ratio  than those of brain .

the f-ratios of several chemical-tissue conditions were not consistent between the training and validation datasets. in the training set, several selected conditions with f-ratios from low to high were prochloraz-ovary , prochloraz-brain , and flutamide-ovary . in the validation data, the sequence changed to flutamide-ovary , prochloraz-ovary , and prochloraz-brain . also notable was an observation that those conditions with smaller f-ratios  in the training data tended to yield fewer classifiers while those with greater f-ratios  tended to yield more .

discussion
perhaps the most critical component of any gene classifier discovery effort is independent validation. especially in the field of ecotoxicology, there is a current prevalence of candidates but few field-ready classifiers for exposure and risk assessment. with a limited number of biological replicates in most microarray studies due to cost considerations, it is not clear how well these transcriptomics-based gene classifiers will perform in validations. rather than directly pursuing more complicated multi-class classifiers in our current study, a choice was made to discover simpler binary classifiers for two reasons. one was to avoid potential computational issues arising from the complex biological interactions of edcs all targeting the various components of the hpg axis. second, a multi-class problem can be decomposed into a number of binary classifications problems  <cit> , and initial binary classifiers successfully identified could later be combined computationally to tackle a multi-class classification problem  <cit> . while the microarray training dataset used in this study was not designed specifically for gene classifier discovery, it does represent typical microarray data obtained in ecotoxicology experiments, both in terms of the extent of biological sample replication, and the relevance of edcs to chemicals of concern in fish and wildlife.

in order to make predictions on samples of interest of their chemical exposure history, a typical classification algorithm requires the availability of training data or its representation as a computational model derived beforehand. an approach like gsea offers a flexible alternative. there are two possible scenarios for interpretation when gsea determines that a classifier as assayed on samples of interest is enriched on the rank-ordered gene lists generated from reference geps associated with a known chemical. for an established classifier on samples of unknown, the chemical exposure history of these samples would be diagnosed by the chemical condition associated with the reference geps. for a candidate classifier on known samples, on the other hand, a connection of corresponding chemical conditions between these samples and reference geps would effectively validate the classifier. in a typical study of biomarkers, the same algorithm is used in their discovery and validation. in this research, however, independent algorithms were used in the two stages. the successful linkage, in  <dig> out of a total of  <dig> cases, of treatment conditions of classifiers to those of their respective geps in the training data demonstrated not only the strength of ga-svm/ga-knn for discovery, but also the utility of gsea for validation.

the inconsistent predictive performance of several classifiers on both the original training data and later-generated validation data could be attributed in part to the data complexity of their respective chemical tissue conditions unresolved by computational modeling at their existing sample size. this complexity reflects the differential biological impact of an edc on an individual fish relative to its overall population. in other words, with all other factors equal, the performance of a classifier is probably a function of both the  action of the edc and the population variation in organisms’ response to exposure of these chemicals, both genetic and environmental. accordingly, the sample size required for classifier discovery would likely vary among different chemical-tissue conditions. when biological replication is inadequate for a given level of data complexity, model overfitting could result in an incorporation of both signal and noise, leading to unsuccessful predictions later  <cit> .

as one of a variety of measures proposed to capture the data complexity of geps, f-ratio statistic varies in its degree of correlation with the performance of classifiers <cit> , probably because of a wide range of linear separability present among microarray datasets  <cit> . many complexity measures including f-ratio are thought to be especially effective in characterizing linearly separable data  <cit> . in the current study, a similar inconsistent correlation was also observed between f-ratio and classifier performance. in conditions like fadrozole-brain, prochloraz-brain, and prochloraz-ovary in the training data, f-ratio reflected the performance of classifiers . in other conditions such as prochloraz-brain across the training and validation data, this correlation broke down . and the f-ratio of the same condition, for example flutamide-ovary, also varied widely between the training and validation data in spite of the fact that fish samples involved were co-exposed in the same batch. similar challenges of data complexity impacting classifier performance were also observed in cancer classification data  <cit> . thus, a better characterization of microarray data complexity probably requires an exploration of a full suite of statistical measures and depends highly on chemical-tissue conditions.

the discrepancy between gsea validation results and the corresponding heat maps is difficult to interpret. the heat maps of prochloraz classifiers achieved a perfect separation of treated and control samples from the training data as expected. given the partial success of these same classifiers on the validation data by gsea, it was expected that this would also be reflected in the heat maps. while model overfitting cannot be completely ruled out here, it is likely that such a strict bifurcation of samples in heat maps via two-way clustering of both gene classifiers and samples is simply a more stringent criterion than fdr  <dig> , a commonly accepted threshold for gsea. also notable is that, while ga-svm/ga-knn generated classifiers from the entire transcriptome for most of the conditions or from most individual tf networks for a given condition, a majority of these classifiers were later disqualified during visual examination of their heat maps under a strict requirement of bifurcation of treated and control samples. some of these disqualified classifiers could be false negatives.

while the chemicals included in this study all target the hpg axis and preliminary classifiers were indeed found from this compiled group of genes for all  <dig> conditions, none of these classifiers was later qualified by their heat maps. a similar pattern was also observed in master regulators, a group of hub tfs anchoring gene regulatory networks previously found to be associated with various chemical-tissue conditions for this same set of edcs  <cit> . in contrast, a previous study of master regulators suggested that they tended to be stable and reliable classifiers  <cit> . in addition, almost half of the  <dig> networks generated a qualified classifier for at least one condition. there are several possible explanations for these observations. first, strict separation of treated and control samples in a heat map might be a criterion too stringent for a qualifying classifier. second, the target genes in the hpg axis operate in a variety of tissue types  <cit>  and many of them respond to multiple chemicals. within a given tissue, these genes may not be involved in endocrine regulatory functions. and lastly, with regard to the master regulators, hub tfs may just be classifiers more suitable for problems with better-defined biological endpoints, as in the case of cancer morphology, than for chemicals with diverse treatment effects  <cit> .

with binary classifiers found for six chemical-tissue conditions by the transcriptome-wide searches, and  <dig> conditions by the network-specific searches, each containing many gene features, their distribution statistics across chemicals, tissues, and tf networks could offer some biologically important insights into the moas of edcs. assuming a positive connection between biological impact and the number of such classifiers and gene features involved, the  <dig> edcs under study had the greatest effects on brain tissue, then ovary and testis. chemical-wise, prochloraz would rank as the most active chemical , followed by flutamide, fipronil, 17α-ethynyl estradiol, vinclozolin, ketoconazole, muscimol, fadrozole, 17β-trenbolone, and trilostane. another interesting perspective came from the top tf networks which were shown to generate classifiers for a number of chemical-tissue conditions. some of these networks, as denoted by their hub tfs, included xbp <dig>  hif1ab, ybx <dig>  smad <dig>  and yy1b. the cellular functions behind these tfs include stress response   <cit> , regulation of oxygen homeostasis   <cit> , regulation of transcription and/or translation   <cit> , and signal transduction   <cit> , suggesting far-reaching biological effects of the test chemicals on zebrafish beyond the hpg axis.

with a current knowledge of molecular pathways associated with different types of chemical stressors often lacking, an attempt was made in this study to develop more mechanistically-based gene classifiers by conducting tf network-specific searches. the idea behind this approach was to first construct transcriptome-wide tf networks based on the geps from fish samples treated with multiple edcs, and then to identify a subset of these networks significantly impacted by individual endocrine-active chemicals. classifiers later identified specific to these individual networks would in effect be tied to edcs through common tf networks, which would add a mechanistic perspective to these classifiers. in comparison, a classifier from the transcriptome-wide search was more likely to be a biologically random assemblage of gene features. based on hundreds of individual tf networks previously constructed and linked to various edcs by gsea  <cit> , the network-specific search generated a substantial number of classifiers for multiple conditions in this study despite greatly reduced search space. this approach also yielded classifiers for more chemical-tissue conditions than the transcriptome-wide search. upon confirmation, these classifiers could provide an explicit linkage among a chemical stressor, its underlying regulatory tf networks, and apical  responses.

a common pattern emerging from both training and validation datasets is that multiple classifiers sharing no common gene features could predict the same target gep. assuming a subset of these classifiers is valid, such an overlapping prediction reflects complex interactions between the test chemicals and biological pathways within the tissues that comprise the hpg axis  <cit> , some of which are expected according to the current biological understanding of these chemicals. for example, among the  <dig> edcs, both vinclozolin and flutamide are androgen receptor antagonists in multiple androgen/estrogen-responsive tissues while ketoconazole, fadrozole, and prochloraz are overlapping inhibitors of cytochrome p <dig> 11a,  <dig>  and  <dig> respectively in the gonad. in both the training and validation data, the classifiers for these conditions often simultaneously diagnosed the same gep, as is the case between prochloraz and ketoconazole. perhaps more significant is when this relationship of multiple classifiers all predicting a single gep occurred with seemingly unrelated edcs, such as prochloraz and fipronil, the latter a gaba  receptor antagonist. such a many-to-many relationship among classifiers and geps from different conditions would be informative with regard to the underlying pathways affected by these chemicals and their possible grouping into a smaller number of classes, thus reducing the need to develop classifiers for individual chemical-conditions.

gsea proved to be a flexible tool in ecotoxicological application of gene classifiers without relying on their original training data. future improvement could be made by adopting cmap, a conceptually similar but more refined approach developed for human biomedical studies  <cit> . cmap connects small molecule drugs to one another or a small molecule drug to a human disease state by mapping a group of gene signatures to geps previously assembled as a large reference collection of ranked gene lists. each gep is generated from samples treated with a chemical of interest. with its demonstrated flexibility and effectiveness  <cit> , the cmap algorithm could be an excellent analytical tool for ecotoxicological applications. the main barrier to its application is the need to generate and assemble a large collection of geps linked to a wide variety of chemical compounds of environmental significance. conceivably, cmap could be used in conjunction with preexisting gene classifiers to make predictions on field samples with unknown exposures, validate candidate gene classifiers using pre-established reference geps, categorize environmental stressors into a more manageable number of chemical classes based on pathways affected, and link chemical stressors to their apical biological endpoints.

CONCLUSIONS
in summary, binary gene classifiers for a number of chemical-tissue conditions were identified based on the geps of fish samples previously exposed to these chemicals. consistent with prior reports, tissue type was found to have a major impact on a transcriptome such that data containing multiple tissues yielded no qualified classifiers. the distribution characteristics of classifiers across tissues, chemicals, and tf networks suggested a differential biological impact among the chemicals on zebrafish transcriptome involving some basic cellular functions. an independent validation of classifiers for prochloraz-ovary, flutamide-ovary, and prochloraz-brain on additional geps was partially successful. data complexity measured by f-ratios varied among individual chemicals and between tissue types, suggesting sample size required for classifier discovery is likely different for various chemical-tissue conditions. the varying data complexity was probably also partially responsible for inconsistent performance of classifiers observed in the current study. in the future, a preliminary survey of transcriptomic impact by various stressors would likely be informative with regard to their data complexity and appropriate sample size for gene classifier discovery. an adoption of cmap-based approach for ecotoxicological applications of gene classifiers may also provide a more effective and flexible tool for exposure and risk assessment.

endnotes
awhile terms such as gene classifier, gene signature, molecular indicator, biomarker and their respective plural forms are often used interchangeably in literature, the term gene classifier is used throughout this paper. in its singular form, a gene classifier is defined here as a group of microarray gene features  capable of distinguishing samples in a single chemical-tissue condition between the treated and control. gene classifiers, on the other hand, refer to multiple sets of gene features each diagnostic of a different chemical-tissue condition.

abbreviations
cmap: connectivity map; bed: browser extensible data; edc: endocrine-disrupting chemicals; fdr: false discovery rate; f-ratio: fisher’s discriminant ratio; ga-svm: genetic algorithm-support vector machine; ga-knn: genetic algorithm-k nearest neighbors; gep: gene expression profile; gsea: gene set enrichment analysis; hpg: hypothalamic-pituitary-gonadal; moas: mechanisms of action; tf: transcription factor.

competing interests
the authors declare that there are no competing interests.

authors’ contributions
rlw conducted all the bioinformatic analyses and prepared the manuscript. db, ab, and rf contributed to microarray work. dv and ga conducted fish exposure to various chemicals. jl was involved in the project planning and execution. all coauthors contributed to the manuscript revisions and approved the final version for submission.

supplementary material
additional file 1
figure s <dig>  an illustration of galgo algorithm as adapted from galgo tutorial .

click here for file

 additional file 2
table s <dig>  configurations for ga-svm and ga-knn search.

click here for file

 additional file 3
table s <dig>  cross mapping probe ids between the design  <dig> and  <dig> by five types of evidence: agilent bed  files, zv <dig> cdna and genes from ensemble, reference sequences  from genbank, and agilent probe sequences.

click here for file

 acknowledgements
this work was supported in part by an award from the national center for computational toxicology of the us environmental protection agency  to the ecological exposure research division  in cincinnati, ohio, usa, and the mid-continent ecology division  in duluth, mn, usa. the paper has been subjected to agency’s administrative review and approved for publication as a u.s. epa document. the authors wish to thank the two anonymous reviewers for their critiques of this manuscript.
