BACKGROUND
the gut microbiota   <cit>  is found in virtually any metazoan, from invertebrates to vertebrates. the human body, for example, is home to roughly  <dig> times more microbial than human cells. the collective genome of these symbiotic microorganisms   <cit>  constantly interacts with the host genome, forming the so called metagenome  <cit> . as a result of millions of years of coevolution, the microbial genome stands in dynamical relationship with the host organism and helps it in crucial functions. these include metabolic processes like food absorption and short chain fatty acid  and vitamins production  <cit> , but also the shaping, control and protection of the immune system development  <cit> . it is through the interaction between the different components of the metagenome that the host ‘health phenotype’ is defined  <cit> . the microbiome, and especially the gut microbiome  is linked, through an interdependence relationship, to the host immune system  <cit>  and metabolism  <cit>  and it is crucial for a large number of physio-pathological conditions and diseases. these include inflammatory and metabolic diseases  <cit> , such as obesity  <cit> , metabolic syndrome and type  <dig> diabetes  <cit> . in addition gm composition is influencing ageing  <cit> . moreover, recent advances in sequencing methods have led to new knowledge about the role of gm also on brain development and neural disorders such as autism  <cit>  and multiple sclerosis  <cit> . the bidirectional cross-talk between host and gm is supported by gm transplants results   <cit>  and by the association of gm composition with pathological states  <cit> . thus, gm is sensitive to environmental stimuli , having an high individual specificity and plasticity and being modifiable by pharmacological agents such as pre- and pro-biotics, antibiotics and gm transplants. one of the main characteristics of metagenome, that is crucial in the case of unhealthy people, is the molecular composition of the intersection between the host and the microbiome. this interface is the way by which the host and the microbiota communicate. such interaction is bidirectional and history-dependent and can be characterized as a function of the exchanged metabolic, genetic and immunological bio-molecules  <cit> .

gm is a complex ecosystem with a complex dynamics, that derives from the interactions with the host diet, life-style and health state, but also with components such as the virome  and the immune system  <cit> . nowadays, the availability of next generation sequencing methods , for the characterization of bacterial communities, contributed to the creation of a new research field, called metagenomics. metagenomics is the set of omics measurements that quantify the composition of the metagenome and the interactions between the host and the microbiome at multiple levels: dna , rna , protein  and metabolic network . classical microbiology largely relied on clonal culture techniques and for this reason turned out to be biased. in the 1990s, it has been estimated that the currently cultivable microorganisms represented only a small fraction  of the total microbes within a given habitat  <cit> , proving that culture methods were not able to access the vast majority of bacterial organisms. the great benefit of metagenomics is indeed to overcome such issue. metagenomics allows to sample the whole bacterial population, without the need of culturing and without the need of knowing in advance which microorganism to look for, as required for example by microarrays. this purpose is commonly achieved by sequencing the 16s rrna gene. this choice is due to the fact that the 16s rrna is highly conserved between different species of bacteria and, for this reason, delivers informations about their evolutionary relationships. through 16s rrna sequencing, in particular, one can sample bacteria in a community obtaining their phylogenetic relationships, and this turns out to be particularly useful if we want to give an ecological description of gm.

the quantification of biodiversity and the modelling of the dynamics that brings to a certain composition of gm are important tasks for the assessment of the homeostasis degree and the ‘carrying capacity’ of ecosystems, as well as for the prediction of their evolution, and, for this purpose, mathematical models result pretty useful  <cit> . here we propose a new method to describe the gm dynamics from an ecological point of view. we focus on the gm biodiversity, and in particular on one of its components: the relative species abundance distribution . this is defined within a single phylogenetic level and refers to how common or rare a species is relative to other species. interestingly, ecologists are widely fascinated by the ecosystems rsa, and the reason for this is that it follows very similar patterns over a wide range of ecological communities  <cit> : in a diverse array of populations, ranging from an open-ocean planktonic copepod community, to a tropical bats community, but also in a community of rainforest trees and of british breeding birds, the relative species abundances are recognizably drawn from a single family of distributions, ranging from the log-series  <cit>  to a highly skewed and unveiled log-normal  <cit> . early attempts to fit observed data with statistical distributions were mainly inductive approaches. two milestones among these are indeed fisher’s log-series  <cit> and preston’s log-normal  <cit> . starting from the hypothesis that the number of collected individuals belonging to a given species follows a poisson distribution, fisher showed that the number of different organisms observed in a single sample, if the different species are not equally abundant, can be described by a negative binomial distribution. then he eliminated the zero abundance class  and assumed that the total number of species in a community was infinite. finally he obtained a log-series distribution that was able to fit different datasets. a few years later, preston criticized the log-series on the grounds that it was not a good fit to the data that he had assembled. preston argued that rsa distributions were actually log-normal, partly due to the central limit theorem, and that the log-series resulted from under-sampling. later, several attempts were made in order to derive a theory of rsa, that was based on hypotheses about how ecological communities are organized, as reviewed in  <cit> . here we just note that these theories present many shortcomings, among which a not entirely exhaustive biological interpretation, the presence of many parameters, and, besides that, the inability to explain real data. in this work, we would like to give an explanation for the gm rsa distribution relying on population dynamics. we would like our model to fit experimental data in both situations observed by fisher and preston  and we also would like our model to be simple, without too many parameters and to have a clear biological interpretation. for this purpose, we based our work on the ecological neutral theory.

modern ecological theories can be distinguished in essentially two main schools of thought: the niche assembly perspective and the dispersal one  <cit> . the niche assembly perspective holds that communities are groups of interacting species whose presence or absence and even their relative abundance can be deduced from deterministic ‘assembly rules’ that are based on the ecological niches or functional roles of each species. here, the concept of ‘ecological niche’ summarizes the interactions between species and their environment, and is thus defined by two components: the requirement for an organism of a given species to live in a given environment  and the impact of the species on its environment . according to this view, species coexist in interactive equilibrium and a stable co-existence among competing species is made possible by niche partitioning  <cit> . the other world view is the dispersal assembly perspective, which asserts that communities are open, non-equilibrium assemblages of species largely thrown together by chance, history, and random dispersal. species come and go, their presence or absence is dictated by random dispersal and stochastic local extinction. actually we will refer to a particular class of dispersal theories, those called ‘neutral’, in which ecological communities are structured entirely by ecological drift , random migration, and random speciation. by neutral we mean that the theory treats organisms in a trophically defined community as essentially identical in their per capita probabilities of giving birth, dying, migrating, and speciating   <cit> .

in particular, in this work we show that the gm rsa can be well described by the simple stochastic neutral model initially proposed by  <cit>  for the coral-reefs and tropical trees ecosystems. this model neglects species interaction and assumes that the number of individuals within a species could change only because of a birth or a death. to this birth-death process a further constant influx term is added. this term includes phenomena such as immigration or speciation but can also be considered as the mean effect of species interactions. moreover, the neutrality assumption supposes that all species are described by the same birth, death and influx parameters, keeping the model as simple as possible. the stationary distribution predicted by the model for the rsa is a negative binomial distribution. this has the peculiarity of including the log-series as particular case and of being able to fit also log-normal like data, hence is capable to describe both the common rsa shapes previously observed.

in the following, first we describe the gm data that we analysed. these include ngs data from  <cit> , that involve the gm characterization of three different animal species: chicken, cattle rumen and swine. starting from ngs data, we describe how we built empirical rsa distributions for the gm. in particular, the method includes a clustering procedure of the data sequences, in which changing the similarity threshold settings allows to consider the ecosystem at different phylogenetic levels. then, we deepen the theoretical model by  <cit>  and we show how the negative binomial distribution is obtained, also introducing the related biodiversity number, as proposed by volkov  <cit> . finally, we show our results, according to which the model well fits the gm rsa and turns out to be capable to discriminate between the gm coming from different animal species. this is particularly clear if we compare the biodiversity numbers obtained for different animals and for different phylogenetic levels, that results to be consistent with the second order hill’s number, a commonly used biodiversity index.

methods
we analysed the data from  <cit> , available in the national center for biotechnology information sequence reads archive under the accession number . this study was approved by the institutional animal care and use committee of the university of illinois and includes 16s rrna sequencing data  from  <dig> animals:  <dig> chicken ;  <dig> cattle rumens ; and  <dig> swines . starting from the 16s rrna sequences, we built the rsa distribution of the gut ecological system computing the so called operational taxonomic units  through a clustering procedure based on sequence similarity. this was performed with four different similarity thresholds , as explained below. in particular the rsa was obtained representing the otus abundances in the form of preston plot  <cit> . this is the plot of how many species  have a certain number of individuals , with the x-axis transformed in logarithm to base  <dig> in order to compress the information of the otherwise very long tail of the distribution.

before deepening the methodology, let us underline that in order to give an ecological description of the microbiota, it is highly recommended to base the analysis on de novo otus, rather then on some taxonomic classification in which sequences are clustered through comparison with 16s rrna databases such as rdp  <cit> , silva  <cit>  or greengenes  <cit> . in fact, although phylotype-based methods are appealing approaches, since they enable investigators to place labels onto sequences, indicating their relationships to previously cultured and characterized microbes, they are human-made methods and there are myriad examples of organisms that belong to the same species that have different phenotypes and organisms with the same phenotype belonging to different taxonomic lineages, without talking about unclassified organisms or about the fact that there are at least three different curated taxonomy outlines that contain significant conflicts with each other  <cit> . in order to estimate evolutionary relationships of organisms, genes, species, etc. the tool to be used is phylogenetic analysis, that is the analysis of otus  <cit> . basing our analysis on otus, we will not be able to give names to species, but we will have the great advantage of avoiding the loss of information due to a taxonomic classification.

with the aim of building otus, we clustered the 16s rrna sequences with uclust  <cit> . uclust starts with an empty database in memory and then reads the sequences in input order. thus, sequences were previously sorted by quality, since uclust is sequence order sensitive and needs the highest quality sequences at the beginning of the input file. the algorithm takes the first sequence as first seed, and then all other sequences are processed according to the following statement: if a sequence is similar to a seed within a fixed similarity threshold, then the query is assigned to its cluster; if a sequence is instead not similar to any seed, then it will become the seed for a new cluster. this means that the between classes distance will be at least , while the within class distance will be approximately maximized by such similarity threshold. here, the similarity between two sequences is computed by usearch. the sequences are first globally aligned, then similarity is computed as the fraction of columns in the alignment that contain identical letters, while the distance between two sequences is given by . in this counting, gaps were penalized according to default settings  <cit> . uclust has the drawback of producing clusters that will not have the similarity threshold as exact maximum distance inside them, but overcomes two of the main problems of sequencing analysis, that are time and memory costs. uclust is one of the most common sequences clustering algorithm, and the reason for that is its great advantage of needing to memorize just the seeds and to compare the query sequences just with such seeds.

we applied the uclust algorithm using four different similarity thresholds:  <dig> %,  <dig> %,  <dig> % and  <dig> %. in this way, because of the conservative feature of the 16s rrna gene previously outlined, we obtained clusters , that can be thought as groups of bacteria of the same taxon at a particular phylogenetic level  <cit> , for four different levels. here, the similarity threshold is what defines the phylogenetic level at which we compute the rsa, the scale level at which we study the ecosystem.

starting from uclust results, we estimated the otus abundances, that correspond to species abundances. we then filtered for singletons  in order to minimize the inclusion of sequencing artefacts  <cit> . since the absence of singletons violates some fundamental assumptions of species richness analysis, we randomly removed one sequence per otu, causing all otus with originally two reads  to become singletons, those with three reads to become doubletons, and so on. the effect of an even more conservative interpretation of  <dig> reads on species richness analysis was evaluated by consecutively omitting doubletons and tripletons from the initial data sets. thus, we computed the rsa in the form of preston plot for all four data sets: singletons retained, singletons excluded, doubletons excluded and tripletons excluded. the greatest difference appeared between retaining or removing singletons from the data set, thus, considering the less restrictive case, we chose to exclude just singletons, and to subtract  <dig> from all the other otus abundances. note that, even if the singleton removal is supposed to substantially reduce rsa errors due to the sequencing procedure, the error on the reconstruction of the empirical rsa, due to all the other experimental steps  is not valuable since we have just one gm sample for animal. however, the fact that we find consistent results for the couples of animals of the same species, as showed later, suggests that such error can be neglected.

the gm rsa was modelled according to the neutral theory of ecosystems proposed by  <cit> . here, the dynamics of the population of a single species are governed by generalized birth and death events, that include speciation, immigration and emigration. if we neglect inter-species interactions after the community has reached a steady state, the number of individuals n of a given species evolves according to equation 
  dndt=b·n−d·n+s, 

where b and d denote the per-capita density-independent birth and death rates, while the presence of the constant influx s produces a density dependence effect, which causes a rare species advantage and which can arise due to effective rates of immigration, emigration, speciation or extinction in a local community, but can also be due to intraspecific interactions. note that because of the species equivalence assumption, this equation actually holds for all the gm species.

in order to take into account stochasticity, eq.  <dig> should be rewritten in a probabilistic form, as accomplished by the chemical master equation  <cit>  
  ∂pn∂t=pn−1bn−1+pn+1dn+1−pn 

here the influx s has been included in the birth term, setting 
  bn=b·, 

where Υ=s/b, while the death rate simply is 
  dn=d·n. 

the stationary solution is easily obtained exploiting the current probability conservation condition : 
  pn=p0∏i=0n−1bidi+1=p0∏i=0n−1b·d·. 

here we consider n> <dig> and we can deduce p <dig> from the normalization condition ∑n≥0pn= <dig>  the stationary solution turns out to be a negative binomial distribution 
  pn=s/bΓnn!Γ. 

with two parameters: b/d and s/b.

the average number of species with n individuals, given the total number of species n, is 
  ϕn=n·pn. 

since the zero abundance class can not be observed, the mean number of observed species is 
  nobs=n−ϕ0=n−n·s/b, 

and the average number of species actually in the community, that is the rsa normalization factor, is 
  n=nobs1−s/b, 

from which 
  prsa=nobs1−s/bs/bΓnn!Γ, 

where 
  θ=nobss/b1−s/bΓ=nobs−s/b−1Γ 

is the hubbell biodiversity number  <cit> , as illustrated in volkov’s work  <cit> .

RESULTS
plotting the microbiota rsa distribution in the form of preston plot revealed a first interesting behaviour of this ecosystem. in fact, fig.  <dig> shows that if we consider different phylogenetic levels, that is we build the otus using different similarity thresholds, we obtain rsa distributions with diverse shapes. more exactly, with a threshold of  <dig> %, the rsa almost resembles a log-series distribution, while shifting towards lower similarity percentages, the rsa looks always more log-normal like. actually, a similar trend of the rsa have been observed in  <cit>  for the coral-reef ecosystem, in which the authors firstly considered many small semi-isolated local communities and then assembled them into bigger and bigger metacommunities. so, it seems that considering the gut microbiota ecosystem at higher phylogenetic levels somehow corresponds, from a dynamical point of view, to assembling semi-isolated local communities into metacommunities. moreover, in the past the rsa shape has been described in terms of log-series or log-normal distribution  <cit> , but the log-series is a special case of the negative binomial, that is obtained when s/b→ <dig>   <cit> , and, for what concerns the log-normal, it has been proved not to be an appropriate null model for the rsa  <cit> , and its bell-shaped cases can be well described also by the negative binomial distribution, due to the fact that, dealing with experimental data, these two distributions can take on similar shapes and are often hard to distinguish in practice  <cit> .
fig.  <dig> preston plot of one cattle rumen sample. empirical rsas have been built considering four different similarity threshold:  <dig> %,  <dig> %,  <dig> % and  <dig> %. the rsa tends to become more log-series like for higher similarity thresholds, that correspond to finer phylogenetic levels



our second analysis was to fit the gm empirical rsa with the negative binomial distribution  <dig>  as already pointed out, because of its very long tail, the rsa is represented in the form of preston plot, i.e. with a logarithm to base  <dig> x-axis. in this way, each bin actually contains the sum of the number of species with abundance category between its minimum and maximum  represents the number of species having  <dig>   <dig>   <dig> or  <dig> individuals). thus, the fit was computed considering the sum of the negative binomial distribution from the minimum to the maximum of each bin, that can be simply obtained subtracting the negative binomial cumulative in the minimum from the negative binomial cumulative in the maximum of the bin. figure  <dig> shows the result for one swine sample. the model fits well the gut microbiota rsa and we obtained good r-squared  for all samples at all the similarity thresholds considered. let us observe that, in truth, there is disagreement between the model and empirical data in the rsa tail, that is for high abundance categories. this suggests a deviation from the neutrality assumption. however, we can state that volkov’s neutral model  <cit> , that contemplates the simplest case in which species equivalence holds, is a good approximation of the empirical gm rsa.
fig.  <dig> fit of one swine’s rsa. empirical rsa  and fit with eq.  <dig>  relative to one swine sample for the four similarity thresholds considered



after fitting the data with the negative binomial model, we exploited our result to assess if the model was able to discriminate between different animal species. we studied the variation of the parameter s/b with the similarity threshold, that is with the phylogenetic scale at which we observe the system, by plotting s/b versus the similarity threshold for each sample. figure  <dig> shows the result. in general, for all samples s/b tends to diminish as the similarity threshold gets higher. this result is consistent with our qualitative description of the preston plots, in which we assessed that the empirical rsa looked more log-series like for higher similarity thresholds , in fact, as already pointed out, the negative binomial distribution tends to a log-series for s/b→ <dig>  moreover, s/b results different for each animal group, especially at low similarity thresholds, and clusters together animals of the same species. this result is particularly interesting because of the biological meaning of s/b, or better of s. as exposed in the model description, this parameter is a constant influx term that takes into account effects such as immigration or speciation, but that can also be considered as a mean field effect of all external factors that influence the microbial community: diet, basal metabolic rate, health state, and so on.
fig.  <dig> 
s/b versus similarity. plot of the parameter s/b versus the similarity threshold used in computing the otus for all five samples. note that s/b differentiate the three animal species considered and that it tends to diminish for high similarity thresholds, indicating that the rsa becomes more similar to a log-series, as attended from fig. 1




finally, we computed the biodiversity number θ proposed by volkov  <cit>  through eq.  <dig> using the fit parameters. figure  <dig> shows how θ increases at higher similarity thresholds, pointing out that biodiversity increases at lower phylogenetic levels. moreover, this parameter is capable to distinguish the animal species, exhibiting similar values and trends for animal of the same species and separating animal from different species. in order to compare our result with other commonly used biodiversity indexes, we computed, for all samples at the four similarity thresholds, the first and second order hill’s numbers  <cit>  
  h1=e−∑inpiln fig.  <dig> 
θ versus similarity. hubbell biodiversity number θ  <cit>  computed with eq.  <dig> for the five animals gm at the four similarity thresholds considered. biodiversity increases with similarity and clusters animals according to their belonging species



and 
  h2=1∑inpi <dig> 

where pi is the fraction of individuals in species i and n is the total number of species . h <dig> and h <dig> are biodiversity estimators, that reach their maximum when every species has just one individual and the ecosystem has as many different species as possible, and shift towards their minima when all the individuals of the ecosystem belong to the same species. figure  <dig>  and  show that also these diversity indexes discriminate between different animals; h <dig> separates just the chicken from the mammalians, but h <dig> separates all the three species, confirming that different animals microbiota have different ecologies. moreover, the biodiversity index θ computed with our modelling shows the same trend as hill’s numbers, and in particular animal species are separated in exactly the same order as in h <dig>  comparing fig.  <dig> with fig.  <dig> it is clear that the different animals gm biodiversities estimated with the two methods have the same behavior.
fig.  <dig> 
h
 <dig> and h
 <dig> versus similarity. first  and second  order hill’s numbers for the five animals gm at the four similarity thresholds considered. the result is consistent with the biodiversity number θ




CONCLUSIONS
the gut microbiota behaves like an organ in the host organism and strictly interacts with that, participating to its homeostatic state, including health status. this is the reason for the growing interest in the dynamics that yield a particular gm composition. here we showed that the gut microbiota can be described within the framework of ecological system, suggesting that such description could be helpful in the understanding of this interaction and in the discrimination of different gut microbiota.

we analysed gm sequencing data from  <cit> , that include  <dig> different animals . the stochastic neutral model proposed by volkov for the coral-reefs and tropical trees ecosystems  <cit>  was applied to the gm rsa and showed a good agreement with empirical data. an exception is found in the rsa tail, in which the model does not fit well the data. such discrepancy implies a deviation from the purely neutral model, that anyway can be considered a good and simple approximation of the gm rsa. moreover, the fact that this model works for such different ecosystems  emphasizes the universality of the rsa distribution and of the mechanisms that cause it, as suspected by many authors  <cit> .

we showed that this simple neutral model, in which species are considered to be equivalent and species interaction is neglected, is also able to differentiate between the different animal species from which the microbiota was sampled. in fact, the s/b parameters of animals belonging to the same species cluster together, while separate from those belonging to other species. this is evident if we plot s/b versus the similarity threshold used for otu computation. the curves drawn by the s/b of different animals show different trends, while being alike for animals of the same species, and this means that different animals can be distinguished according to the influx parameter s, that has also a biological interpretation, being related to density dependence effects. for all samples s/b decreases at higher similarity thresholds. this indicates that the rsa extends from a log-series like to a bell-shaped negative binomial distribution when shifting from thinner to broader levels in the phylogenetic tree, a phenomenon analogous to the one observed for the coral-reefs and tropical trees ecosystems when local communities were assembled into meta-communities.

finally, we showed that the biodiversity number θ derived by this neutral model increases with similarity and again differentiates between animals. this result is consistent with the biodiversity computed through the first and second order hill’s numbers, with the difference that, while h <dig> and h <dig> simply relies on the fraction of individual per species, θ is based on a dynamical explanation of the ecosystem.

the study of the animal gm is very useful both for the animal health and for the industry related to animals, but of course, as human beings, our main interest could be more on human health and human gm. we began to analyse some human data approved by the cork clinical research ethics committee, from  <cit> , following a similar procedure. figure  <dig> shows the result for one human gm sample clustered with a  <dig> % similarity threshold. the model seems to work well also on human samples, suggesting that it could describe the gm of a wide range of organisms. in future, we will deepen the study of the human microbiota rsa with the aim of building a predictive model, starting from the rsa distribution, that could be helpful in facing different inflammatory and metabolic diseases, that are, as previously outlined, closely related to the microbiota composition. we surmise that the dynamic properties of the gm, caused by its ecological complexity and interactions with the host, can be modelled within the framework of stochastic population dynamics, including classical models such as predator-prey and ecological/microbial growth equations as species lotka volterra and chemostat growth.
fig.  <dig> human gm rsa and fit with eq.  <dig>  rsa of one human gut microbiota from  <cit>  and fit with eq.  <dig>  otus were built with uclust with  <dig> % similarity threshold



from the fourteenth asia pacific bioinformatics conference san francisco, ca, usa.  <dig> -  <dig> january 2016

competing interests

the authors declare that they have no competing interests.

authors’ contributions

cs carried out the analysis, contributed to the theoretical and bioinformatic parts and drafted the manuscript. sv, eg and dr partecipated in the theoretical discussion. ifv, mb, em and lm contributed to the bioinformatic analysis. pg contributed to the medical introduction. gc conceived the study and helped to draft the manuscript. all authors read and approved the final manuscript.

declarations

publication costs for this article were funded by flagship project cnr-interomics. this article has been published as part of bmc bioinformatics volume  <dig> supplement  <dig>  2016: bringing maths to life . the full contents of the supplement are available online at http://www.biomedcentral.com/bmcbioinformatics/supplements.

