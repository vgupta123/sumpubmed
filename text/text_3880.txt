BACKGROUND
it remains a major undertaking in the post-genome era to determine which biomolecules interact with each other, what function they have and to obtain their three dimensional high resolution structures. the main methods for achieving the latter are crystallography and nuclear magnetic resonance  spectroscopy, both of which can be time-consuming despite significant methodological advances. in addition, many targets elude high-resolution structural studies due to low solubility, low stability, large size or lack of crystal formation. also, there is a rather limited number of structures of complexes compared to single proteins or domains thereof. there is thus a need for complementary methods that can give structural information on complexes since these are usually of higher interest from a biological point of view than single entities.

an alternative strategy to obtain structural information about biological macromolecular complexes is mass spectrometry. here, the advantage is that sample requirements are low and the size limit is expandable to mda complexes. hydrogen exchange experiments coupled with mass spectrometry can yield very detailed information of protein folding and protein interactions, as reviewed in  <cit> . recently, new methods used on large biological macromolecular complexes using ion mobility-mass spectrometry have been introduced, where gaseous ions are separated based on their size and shape  <cit> . also, chemical cross-linking in combination with mass spectrometry can reveal structural insight into proteins and their interactions  <cit> , while the employment of radical probe mass spectrometry  evaluated by proximo can yield structural models of protein complexes  <cit> . these methods are, however, very sophisticated, requiring expensive state-of-the-art equipment and expert knowledge. in addition, time-consuming optimizations are often required, e.g. to find the right cross-linkers and conditions.

in contrast, limited proteolysis in conjunction with mass spectrometry  needs only a routine mass spectrometer and performing the experiments is straight-forward and fast. the resulting data can provide rather detailed information about protein interactions, stability and tertiary structure  <cit> . however, until recently, the extraction of this information was difficult due to the amount of data to be evaluated. mtmdat, introduced in  <dig>  <cit> , is a tool for data processing, peak assignment, and visualization of mass spectrometry measurements, which greatly reduces the rate-limiting step of data evaluation and thereby enhances structural characterization of larger proteins and biomolecular complexes.

here, we describe a novel implementation of mtmdat, which streamlines the process from experimental work to an actual structural model of the complex. a new mtmdat routine directly determines which residues are likely to be involved in a previously identified protein-protein interaction by comparing the mass spectra of bound and unbound proteins after proteolysis. in addition, a new pipeline between mtmdat and haddock  <cit>  has been developed . haddock is a docking method driven by  knowledge from a wide range of sources, e.g. mutagenesis, cross-linking or a variety of nmr experiments. data-driven docking has the advantage that possible solutions are restricted a priori to be in agreement with experimental information. in haddock, this is typically achieved through the definition of active and passive residues. active residues correspond to interface residues identified by experiment, and passive residues are surrounding residues on the protein surface. haddock enforces that every active residue is in contact with at least one active or passive residue on a partner molecule. when experimental information is sparse or absent, bioinformatic interface predictions can also be used  <cit> . haddock allows for conformational change of the molecules during complex formation, and directly supports the docking of nmr structures containing multiple models. the coordinates of more than  <dig> biomolecular complexes solved using haddock have been deposited in the pdb. the mtmdat-haddock pipeline allows the direct calculation of a three-dimensional model of the protein complex based on the interface residues identified by mtmdat, provided that structure coordinates of the unbound components are available. this implementation, together with improvements in mtmdat that increase its usability, enables direct high-throughput modeling of protein complexes from mass spectrometry data.

to demonstrate that the quality of the protein complex structures obtained from limited proteolysis/mass spectrometry data can be competitive compared to structures generated with more classical restraints from chemical shift perturbations  acquired by nmr, we studied the complex of the proteasome subunit rpn <dig> with ubiquitin. rpn <dig> is one of two known ubiquitin receptors in the proteasome  <cit>  to which it docks via rpn2/s <dig>  <cit> . in higher eukaryotes, it has an additional domain that contributes deubiquitinating enzyme uch <dig> to the proteasome  <cit> . the structure of the rpn13-ubiquitin complex has been solved by nmr spectroscopy using chemical shift perturbations upon complex formation and twelve unambiguous intermolecular noes   <cit> . in this study, this structure is used as control for validation of the mtmdat-haddock protocol.

taken together, we present here an alternative approach that is quick and easy for obtaining restraints for data-driven docking. the results obtained by the presented lp/ms method are thus compared with data-driven docking using csp alone as a method to obtain restraints for structure calculation and with purely bioinformatics driven docking using cport for interface predictions  <cit> . the resulting structure is comparable to that obtained by csp experiments, and more accurate than cport bioinformatics interface predictions. the ease of performance, the gain in experiment time and the rapid and expert-free evaluation holds promise for lp/ms to contribute to the field of structural genomics.

RESULTS
the mtmdat-haddock workflow for obtaining the structure of the rpn13-ubiquitin is described in the methods. in short, after performing the actual experimental work and acquiring the mass spectra, mtmdat was used to get time-course plots and 3d plots . this is described in the methods section and in  <cit> . rpn <dig> was readily digested and interaction restraints to ubiquitin could be derived from the cleavage pattern. for deriving ambiguous interaction restraints  from these files, a threshold of 20% was used for rpn <dig>  meaning that the relative cleavage propensity of a given residue in the complex must be at least 20% smaller than for rpn <dig> in the absence of ubiquitin. this high threshold was chosen to decrease the risk of false positives. residues fulfilling this condition were chosen to be active residues for haddock calculations. in contrast, ubiquitin had no susceptibility to proteases. for this reason, in the current study, the mtmdat-derived active residues on rpn <dig> were complemented by cport predictions providing passive residues on ubiquitin. therefore, rpn13-ubiquitin is also a test case for the ability of mtmdat-haddock to deal with missing lp/ms data, complementing them with predictions or data from other sources. for rpn <dig>  passive residues were chosen as described  and were automatically chosen by haddock for all docking runs.

in figure  <dig>  the active residues in protein-protein interaction identified by lp, csp, and cport are mapped onto the published solution structure of the rpn13-ubiquitin complex , and table  <dig> summarizes the active and passive residues that were used in all docking runs. clearly, the limited proteolysis experiment produces two distinct patches . the largest patch consists of four residues  that are indeed part of the interaction interface observed in . the other patch consists of three residues d <dig>  k <dig>  and e <dig>  which are located on the opposite side. the program patchup  has been developed and included in the pipeline, which automatically generates patches in an unbiased way . chemical shift perturbations from nmr titration experiments  <cit>  also give false positives. the amide resonance of r <dig> exhibits perturbations , despite having no interactions with ubiquitin in . the generation of false positives is inherent to the lp/ms and csp methods, due to possible conformational changes in regions further away from the binding interface upon complex formation, which result in chemical shift perturbations measured by nmr spectroscopy and could manifest in a higher accessibility to proteases assessed by the lp/ms method. still, cport gives the largest number of false positives, predicting interacting residues on almost the entire surface of both proteins .

in order to accommodate the presence of false positives and to choose the correct interaction surface in an unbiased way, a general docking calculation protocol has been developed. this protocol consists of two runs. the first run acts as a filter to choose the right patch if more than one is present. to this end, a random exclusion of 50% of airs for each structure calculation is performed. since this increases the sampling space, a higher number of structures has to be calculated in each iteration . in the case presented here, this filter was able to distinguish between false and true positives . here, the largest clusters, which also have the best haddock scores have the correct patch  <dig>  as the interface, as do clusters 5- <dig>  only cluster  <dig> and  <dig> have the wrong patch  <dig>  as the interface. thus, it was possible to filter out the false positive . however, there may be cases, where cluster size and haddock score differ in ranking. in this case, the haddock score is always prioritized. subsequently, a second and final docking run was performed using only active residues from patch  <dig>  for this second run two important changes have to be made. residues whose side chains are surface exposed and are in immediate vicinity to active residues identified by limited proteolysis will also be included as active residues . this assumption is made since the limited proteolysis method can only sample a limited number of amino acids, which are cleaved by the proteases chosen. therefore, surface neighbors of experimentally-identified residues, which would usually be defined as passive, are now also considered as active in the second run. thirdly, no restraints are randomly excluded from the structure calculations. this exclusion is no longer necessary since the right patch should have been identified in the first filter docking run.

a: ranked by haddock score.

b: the average distance of all residues in the interface of the docked model towards the center of the interface of the reference structure.

c: the average haddock score of the four lowest energy structures in the cluster.

d: in parentheses the rank concerning the number of structure is shown.

the comparison between the three docking calculations, lp/ms, csp, and cport are shown in table  <dig>  the performance of our mtmdat-haddock protocol was assessed as follows : i) low average rmsd values for the superimposition of the  <dig> lowest energy structures of the cluster with the best haddock score onto   larger than  <dig>   <cit> , ii) haddock score of the four lowest energy structures  in the cluster closest to the target structure , iii) rank of the cluster with the best structure  based on the haddock score, and iv) number of structures in the cluster closest to  .

a: bl is a baseline run, where all contacts from the reference structure 2z <dig> were included as active residues.

b: lp is similar to the lp/ms run, but not using cport prediction for ubiquitin, but instead all  <dig> ubiquitin residues as passive residues.

c: the cluster with the lowest average haddock score. the number refers to the rank in cluster size.

d: irmsd is the interface rmsd , between the average structure in the cluster and the lowest energy structure of the reference .

e: lrmsd is the ligand rmsd , between the average structure in the cluster and the reference .

f: the fraction of native contacts is calculated by counting all contacts  between rpn <dig> and ubiquitin in the reference structure and comparing how many are retrieved for the average structure in each cluster.

g: the average haddock score of the four lowest energy structures in the cluster .

h: deemed by the lowest irmsd compared with  of the four lowest energy structures in the cluster. the first number is the rank in haddock score, and the second number in parentheses is the rank in cluster size.

i: the “best” values are the comparison between the one best structure in each cluster and the reference, whereas the “average” values are averaged over the ten lowest energy structures of each cluster.

in all four categories, the mtmdat-haddock method performed better than the csp and cport approach. cport performed worse, since it has to sample many possible patches on the entire surface of the protein. the user, who has in applied cases no knowledge about the right target structure, would have chosen the right cluster in the lp/ms method, since the largest cluster with the best haddock score contains structures closer than  <dig> Å to the target structure. for the experimental csp data two different runs were performed, with and without random removal of airs. for both runs, the correct structure was generated, but with an rmsd slightly worse than the lp/ms run . more importantly, in both runs, the correct structure was not ranked as the top cluster, and the top cluster corresponds to a structure that has a large backbone rmsd to the target structure. from figure  <dig>  where the lowest energy structure of the top ranked clusters is superimposed on the target structure, it becomes apparent that, if the top haddock cluster would have been selected, a structure close to the target structure would have been only obtained with the lp/ms method. clearly, csp without random removal of airs performs worst , followed by cport , and csp with 50% random removal of airs . the lp/ms method comes closest with a backbone rmsd of  <dig>  Å. csp- <dig> has the same set up as the filter docking run applied to the lp/ms data. here, the false positive r <dig> would not have been filtered out, since the cluster with the best haddock score is with  <dig>  Å far away from the target structure, and the cluster closest to the target is ranked only third in haddock score and second in cluster size .

the rpn13-ub complex is a difficult docking case, in the sense that haddock has difficulties in reproducing the experimental structure of the complex. as a positive control, the true interface  was selected as active residues. however, even for this baseline run with perfect interface data , only the third-ranked haddock cluster corresponds to  . moreover, random removal of residues was necessary to get even this result: an alternative baseline run without random removal failed . also, the baseline run structures were no more accurate than the lp structures . moreover, we repeated both runs without using passive residues that only the true interface is used in docking calculations . the run with random removal showed similar results, but with worse irmsd . the run, where no active residues were removed slightly improved. a second cluster  with an average irmsd to 2z <dig> of  <dig>  Å  appeared. still, this is a worse performance than the lp run.

finally, we tested the dependency of the lp method on cport in the case of rpn13-ub. cport is a consensus of six interface predictors, and it deliberately overpredicts the interface, allowing haddock to sample a large region of the surface  <cit> . two additional controls were carried out, both using the lp/ms active residues on rpn <dig>  but with various passive residues on the ubiquitin side. first, instead of selecting only the cport predictions as passive residues on ubiquitin, the entire ubiquitin protein was made passive. this allows any location of ubiquitin to take part in the interaction in order to satisfy the experimental restraints, instead of just the residues predicted by cport. table  <dig> ) shows that removing thus the dependency on cport still gives acceptable results, but only as the fourth-best cluster instead of the top cluster as in the lp/ms run. secondly, a control was performed where cport predictions were restricted to a conservative subset, taking only residues predicted by three interface predictors. this control run performed again worse than the lp/ms run, with the correct cluster now ranked as second .

discussion
we have shown here that limited proteolysis/mass spectrometry  data, used with our mtmdat-haddock pipeline, is a valuable alternative to chemical shift perturbations  in the study of protein complexes. for the studied rpn13-ubiquitin complex, lp/ms actually outperformed csp, although both methods are likely to have similar outcomes on a larger set of model systems or even with the advantage on the csp side. they also have similar properties concerning the nature of the obtained restraints, being not absolute distance restraints, but identifying only patches on the protein surface that are likely to be involved in intermolecular contacts. however, lp/ms is a superior method regarding the amount of time and sample used to acquire the data. high-resolution noe-driven nmr-based structure calculations are time consuming and expensive in terms of preparation of isotopically labeled proteins, data recording and analysis, and furthermore require significant expertise. backbone csp data from nmr titration experiments, which are often used by structural biologists to alleviate the need for excessive structural analysis but which are sensitive to structural rearrangements, have the disadvantage of requiring a relatively stable and highly concentrated sample for backbone assignments, which are necessary even if crystal structures of the complex components are available. approaches based on amino-acid selective labeling have been reported that do not require assignment  <cit> , but these require rather expensive labeling of samples. in contrast, altogether  <dig> μl of sample volume of both proteins with a concentration of  <dig>  mm was needed for all lp/ms experiments performed in this study. the optimization and the actual time-course limited proteolysis/mass spectrometry experiments in triplicates can be performed within one working day, where the optimization should be limited to one range-finding experiment, where different protein:protease ratios are tested and in samples digested for  <dig> minutes. the choice of the best ratio is based on the presence of cleavage products. the full length protein should be present as well as shorter fragments. the subsequent time course experiments will then cover the full spectrum of fragment lengths from full length to shortest fragments. peak assignment and data evaluation can be done within an additional day, whereas the time for the docking calculations varies and depends on the usage frequency of the haddock web server. usually, the docking is finished overnight, but can be as fast as one hour. if the user is registered at the enmr platform for structural biology  <cit> , the calculations can be even faster, despite the high number of structures needed in each iteration of this docking protocol. thus, it is theoretically possible to get a structural model within four days with a backbone rmsd at the interface within ≈  <dig> Å of the target structure.

a weakness of the lp/ms method is that it is limited by the proteases’ set of digested residues, whereas csp is able to sample the entire residue space. hence, there are probably many cases, where csp would perform better than lp, but is more difficult to come by. however, this problem can be minimized by using different proteases. if only trypsin is used , a maximum sequence coverage of around 12% can be achieved theoretically for an average protein  <cit> . if chymotrypsin  and v <dig>  are used additionally, the sequence coverage increases in average to 41%. this results in a high chance that at least one of these residues is part of the protein-protein binding interface and that it will be detected as an active residue. however, the smaller the interface, the higher the risk that no cleavage sites are present. in that case this method cannot be employed. this cannot be predicted but will be quickly detected by a lack of difference between the cleavage pattern of free and complexed components. also, the user runs into risks of overinterpretation of results if only one or two active residues have been identified, which would be even worse if they are on different sites of the protein. in this case, further optimization is needed or another method needs to be employed. for example, in a recent study of an e2:e <dig> interface, limited proteolysis was employed to detect the binding interface on the e <dig> ligase site of trim <dig>  <cit> . limited proteolysis managed only to detect one lysine to be involved in binding, altough other possible cleavage sites were present. this was largely due to the fact that binding affinity was observed to be very low in the high micromolar range. thus, a difference between cleavage in the free and bound form is hard to discern. although the rpn13-ubiquitin complex presented a possible difficulty when it comes to proteolytic cleavage since ubiquitin was not cleaved by any of the proteases employed, we showed that lp/ms also works in this  case of one protein being unsusceptible to proteolytic cleavage since this data can easily be complemented by predictions or data from other sources. in this study, interface predictions from cport were used successfully to complement the missing cleavage data. however, for rpn13-ubiquitin, acceptable results could also be obtained by simply defining the entire missing protein  as passive. both of these runs also strongly outperformed docking based on cport predictions alone, showing that the experimental lp/ms data successfully drives the docking.

the detection of false positives is inherent to both the lp/ms and the csp methods. a ligand binding event is often accompanied by allosteric effects such as conformational changes of the protein backbone at locations remote from the binding interface, which will be detected as chemical shift perturbations. this can also lead to a change in stability towards proteolytic cleavage, which will then be detected by the lp/ms method. however, the docking protocol developed here, with its filtering stage, appears to be robust against the detection of false positives. interestingly, the positive control run  and the csp runs, where both input active residues are covering the reference more completely than the lp run perform worse in this case. we can only speculate that the interface of the case used here is difficult to dock, due to lack of secondary structure elements and involvement of mainly loops in the interface. clearly, the user has to be careful while employing this method and do not trust results lightly if there are only few active residues identified. although haddock has been benchmarked and has been used to solve many important complex structures, it still relies on good input data and the usage of only one active residue will ultimately lead to failure of finding a trustworthy solution  <cit> . also, although conformational change can give rise to false positives, it cannot be detected by this method in structural detail. nevertheless, the tool presented here is very useful to the field of structural biology, since it combines limited proteolysis, mass spectrometry, and data-driven docking in a streamlined and unique way, and as shown, can produce structural models of reasonable quality.

the presented method should be especially well suited to samples resistant to crystallization and that interact in the intermediate exchange regime by nmr, such that nmr signals are broadened. also, complexes with flexible regions are easily amenable for limited proteolysis. in this respect, intrinsically disordered proteins would be especially well-suited objects to study with mtmdat. the interest in these unstructured proteins has increased due to their involvement in regulation and disease  <cit> . x-ray crystallography and small angle scattering fail here to contribute valuable structural information, since disordered proteins do not crystallize or do not form a stable measurable shape in solution. despite recent advances in nmr spectroscopy and applications of the same on unstructured proteins  <cit> , it is nevertheless a difficult undertaking to extract structural information from very often transient interactions within a disordered protein or a disordered protein and a binding partner. we speculate that mtmdat can contribute to this field of structural biology by rapidly identifying regions of unstructured proteins that interact with their partners. however, the results will have to be interpreted with caution, since unstructured proteins are expected to undergo large conformational changes, leading to possible false-positive cleavage signals. in addition, obtaining reliable structural models of the complexes will most likely not be possible due to the large conformational changes involved.

in summary, these results show that mtmdat-haddock can be a tool to provide valuable structural insight in cases where classical nmr and x-ray crystallography are unfeasible, e.g. proteins that do not crystallize or have low solubility, or are too large for nmr spectroscopy. also, protein production in large amounts and expensive labeling schemes can complicate or even prevent the structure determination. despite recent advances in nmr methodology, protein-protein complex structure determination is usually not routinely done but needs manual inspection by experts. therefore, in cases where high-throughput is desired, mtmdat-haddock can provide a solution, at the cost of atomic-level accuracy.

CONCLUSIONS
in this article we have presented a new software tool, which evaluates limited proteolysis/mass spectrometry data quickly and extracts information regarding the residues involved in a particular protein-protein interaction. it provides directly the input file for data-driven docking on the haddock web server to calculate a structural model of the complex. the mtmdat-haddock pipeline enables direct high-throughput modeling of protein complexes from mass spectrometry data, by providing an easy interface to obtain structural restraints for protein complex structure calculations. the usefulness of this approach has been validated successfully on the rpn13-ubiquitin protein complex. our results indicate that this approach is competitive, when compared to a similar approach using nmr-based chemical shift perturbation data alone. the level of expertise required to conduct the necessary experiments is however much lower than for nmr and sample requirements are much easier to fulfill. however, it should be viewed as an alternative approach, if sample requirements for nmr or crystallization cannot be fulfilled. as for structural models based on chemical shift perturbations, site-directed mutagenesis should be used to validate the model derived from our method.

