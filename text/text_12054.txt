BACKGROUND
we now have at our disposal the full metabolic network based on genomic data for hundreds of species, mostly bacteria. the level of annotation is however widely heterogeneous across species, making it crucial for any comparative analysis to carefully choose a set of species for which we can guarantee a good enough annotation, and a same procedure for inferring the metabolic network from the annotated genomes.

one question commonly raised by the availability of many complete genome sequences is the number and content of a minimal set of protein-coding genes necessary to sustain a living cell
 <cit> , which has been investigated using experimental and computational approaches
 <cit> . one such method identifies essential genes based on those shared among genomes in a comparative analysis of diverse taxa
 <cit> . some studies included obligate host-dependent bacteria as a possibility for defining minimal gene sets in more specific and naturally occurring conditions
 <cit> . the minimal gene sets proposed were not enriched in metabolic genes
 <cit>  and the corresponding pathways often presented missing steps
 <cit> . these gaps may be due to non-orthologous gene displacement  
 <cit>  whose encoded enzymes have been defined as analogous  and may be structurally unrelated
 <cit> . in comparative analyses of reaction sets instead of genes, nogd has a reduced impact because different orthologous families encoding a single enzymatic capability are often represented by a same reaction. another possible explanation for incomplete pathways is the use of different alternative routes, which recently have been defined as alternologs 
 <cit> . their origin is closely related to different environmental metabolite sources and lifestyles among species
 <cit> . since metabolism is a core function expected to be required for sustaining life
 <cit> , and the core size may continue decreasing as more genome sequences appear
 <cit> , alternative approaches relaxing the requirement for ubiquity were proposed for analysing either prokaryotes
 <cit>  or species from the three domains of life
 <cit> . one such example is the search for proteins commonly present  instead of strictly conserved everywhere
 <cit> . on the other hand, conserved portions of metabolism are found in lifestyle groups of bacteria
 <cit> .

small-scale comparative analyses of a selection of metabolic pathways were performed investigating each one individually
 <cit>  or grouped in one functional module
 <cit> . on the other hand, larger-scale comparative analysis were carried out in other papers but the question put in each case was different, related either to the proportion of metabolic genes in an organism, in absolute
 <cit>  or classified according to lifestyle
 <cit> , or related to the association between ecological strategies and growth rate
 <cit> . the notion of a core metabolism, meaning common elements, has been previously studied. however, this was done by comparing all known strains of a same species, namely, escherichia coli <cit> . this approach of analysing metabolism as a single network allows a global view of functional processes, which was enabled by metabolic reconstruction methods based on genomic data
 <cit> .

here, we work at the level of whole metabolic networks for each organism and we analyse the core small molecule metabolism  of different lifestyle bacteria, aiming to characterise the contribution of each lifestyle group in the reduction of the common set of metabolic capabilities shared by the whole dataset. as concerns the impact of the obligate intracellular group, the question could be reformulated as the reactions which could not be dispensed and/or outsourced to the host in the course of genome compaction. our major goals were to have a representative diversity in the symbiotic associations, a balanced amount of organisms in each lifestyle group, and as few biases as possible that might be related to the use of different annotation pipelines which is important when performing comparative analyses. we address this by comparing the presence of metabolic reactions as well as biochemical capabilities based on a partial enzyme commission  number analysis at level  <dig> 
 <cit> . the purpose of the first is to be stringent although partially dealing with nogd , while the purpose of the latter is to be more relaxed and to compare common functional capabilities in a broader sense. there are two possible advantages to this. one is to deal with enzymatic activities for which it was not possible to assign a full ec number during the functional annotation of a genome which resulted in partial ec numbers that do not denote a specific reaction. the second reason is to try to address the issue of alternologs, e.g., alternative amino acid biosynthetic pathways that are often composed of enzymes which have the same partial ec numbers at level  <dig> . we also analysed the metabolites that each bacterium potentially acquires from its environment in order to relate them to the set of common metabolic functions found for each lifestyle group.

methods
dataset
we selected  <dig> bacteria from the microscope platform
 <cit>  and we carefully classified them according to their lifestyle based on the hamap information on interactions
 <cit>  and the information provided in the literature. the broader lifestyle groups take into account the location of the bacterium in its host, constituting four groups: obligate intracellular intra, cell associated ca, extracellular extra  and the control group free-living fl. we further grouped them in subcategories on the basis of the association type and transmission mode. the lifestyle groups and the abbreviations are given in figure
 <dig>  the full list of bacteria selected and their detailed classification is given in additional file
 <dig>  the data on genes, metabolites and reactions were obtained from microcyc/microscope
 <cit> . microcyc is a collection of microbial pathway/genome databases which were generated using the pathologic module from the pathway tools software
 <cit>  which computes an initial set of pathways by comparing a genome annotation to the metabolic reference database metacyc
 <cit> . using these databases as input, the metabolic networks of the  <dig> bacteria were obtained from metexplore
 <cit> . it is important to notice that the completeness of metabolic network reconstructions is a current limitation as some reactions remain to be discovered and will be missing in the model while some false positive reactions may be wrongly included in the network. on the other hand, reactions shared by most bacteria are less likely to be missing in current datasets than organism-specific reactions, favouring the kind of analyses performed in the present work. the data on metabolic pathways were obtained from metacyc
 <cit> .
 <cit> . for that reason we included in fl one representative of each taxonomic class present in the dataset depending on the availability in the microscope platform
 <cit> . two mycoplasma species were classified in the ca group as they live on the surface of the host cell, although in another study they have been grouped together with the intra because of their reduced genome and the invariant environment within the hosts
 <cit> . the codes for the organisms are the ones from hamap
 <cit> .

core metabolism and core enzymatic function
our analysis is restricted to the small molecule metabolism as defined in the metacyc/biocyc databases
 <cit> , i.e. small molecule reactions are those in which all participants are small molecules, hence reactions involving one or more macromolecules such as proteins or nucleic acids are not represented. the comparisons of compound and reaction sets are based on the biocyc labels
 <cit> , e.g., the last reaction of glycolysis consists in the transformation of phosphoenolpyruvate, adp and h + into pyruvate and water, and its label is pepdephos-rxn. the compounds found in the metabolic networks are those which are involved as substrates or products in the inferred reactions. all metabolites directly provided by the environment and not involved in any reaction as substrate are not included.

the presence of a metabolic core, i.e., of a conserved set of elements in bacteria with different lifestyles, was analysed in terms of common compounds, common reactions and common partial ec number sets. the core metabolism was obtained by computing the intersection of the sets of reactions  for each species. the panmetabolism was obtained by computing the union of these sets. the variable metabolism is the difference between pan- and core metabolism, i.e., the set of elements that are missing from at least one bacterium. these definitions were introduced by vieira et al. <cit> , however they worked with strains of a same species whereas here we compare different species.

the metabolic networks of the  <dig> bacteria were obtained from metexplore
 <cit> . the macromolecules, as defined by biocyc, were filtered out for all the analyses. the analyses were performed using r
 <cit> , as were the graphics. the igraph package
 <cit>  was adopted for analysing graphs.

for the analysis of the core enzymatic functions we used the ec number classification
 <cit>  which consists in a specific numerical identifier  based on the chemical reactions a given enzyme catalyses. we worked with partial ec number sets at level  <dig> , leaving the fourth digit open. the first digit represents which of the six main classes the enzyme belongs to . the following  <dig> digits provide a more detailed description of the enzymatic activity.

connectivity in the reaction graph
we analysed the connectivity of the core metabolic network to check if the common reactions would be connected among themselves, i.e., the produced metabolites would be consumed by other reactions in a chain of biochemical transformations. for that, the metabolic networks of the dataset were modelled as reaction graphs. in such a graph, nodes represent reactions, and arcs  between two reactions represent a compound which is produced by one reaction and consumed by the other. we set filters to exclude pairs of cofactors  and current compounds , which otherwise would connect unrelated reactions
 <cit> .

since we were working with the common reactions of a group of organisms, we computed the union graph of all the metabolic networks modelled as reaction graphs. we then calculated the graph induced by the common set of reactions, i.e., the subgraph containing the nodes corresponding to these reactions as well as the arcs that link them. after that, we checked for the presence of connected components, i.e., whether for every pair of nodes there is an undirected path.

in the case of the common partial ec number sets, we checked whether the reactions corresponding to each one of the partial ec numbers, i.e., one reaction for each partial ec number, are connected in the metabolic networks. we analysed this in the union of all metabolic networks of the dataset  modelled as a reaction graph, as well as in the graph of each organism. this analysis was performed using motus
 <cit> .

controlling for the impact of small networks
we controlled for the impact of bacteria with very reduced genomes on the size of the common set of reactions . the six organisms which possess the smallest reaction sets  were successively removed  and the intersections of the remaining subgroups were recomputed. these six organisms are: “candidatus hodgkinia cicadicola” , “candidatus carsonella ruddii” , “candidatus sulcia mueller” gwss , m. genitalium , buchnera aphidicola cc  and mycoplasma hyopneumoniae . all possible orders for removing them were tested, and then the mean of the intersection sizes for each subset size of organisms was calculated. we also performed the same analysis by removing the eight bacteria with the smallest sets of reactions .

decay of the common reactions in the different lifestyle groups
next, we checked whether there were reactions common to subsets of organisms within the same lifestyle group. to do so, for each lifestyle group l  having nl organisms, we randomly drew x  organisms and computed the intersection  of their reaction sets. this was repeated  <dig> times. in order to test if, when adding more species, the size of the intersection of reaction sets was expected to decrease to zero, we fitted exponential  and logistic  models to the data obtained for each lifestyle group l. assuming normally distributed residuals,
ϵ∼n, these models are given by: 

  el:y¯l=nl∗exp+αl+ϵl 

  ll:y¯l=rl∗exp+rlαl+ϵl 

where
y¯ represents the mean of the intersection of the reaction set over the  <dig> simulations, x is the subset size , αl is the asymptote, rl is the decay rate and ϵl is the residual of the lthlifestyle group. nlis theoretically defined as the mean of the reaction sets for an empty subset size . a null intersection of the reaction sets corresponds to an asymptote α= <dig> 

preliminary analyses showed the strong impact of the two mycoplasma species on the intersection size due to their reduced genomes . thus, both species were removed from the ca group for this simulation. we used the r package nlstools
 <cit>  for model parameter estimation.

differential random loss of enzymes
in order to rule out the possibility that the small intersection of partial ec number sets could be simply explained by a differential random loss of enzymes during genome reduction of the intracellular symbionts, we simulated the miv  partial ec number sets starting from bacteria of the extra group. this was restricted to the gammaproteobacteria of both groups. to do so, for each gammaproteobacteria of the miv group , we randomly picked a corresponding extra gammaproteobacterium and we randomly removed reactions from its set of reactions, until we reached the size of the corresponding miv metabolic network. then, we replaced each remaining reaction by its partial ec number at level  <dig>  and removed redundant partial ec numbers from this set. we therefore obtained a group of simulated miv networks for which we computed the union, intersection and average size of their partial ec number sets. this whole procedure was repeated  <dig> times. additionally, we aimed to test the differential random loss of biochemical capabilities, meaning the loss of partial ec numbers . for that, we performed a similar procedure to the one explained above, however we stopped removing reactions when we reached the size of the miv partial ec number set. we used a monte-carlo test from the r ade <dig> package
 <cit>  to compare simulated and observed values.

metabolites potentially acquired from the environment
in order to identify which metabolites each bacterium potentially acquires from its environment , we used the borenstein method
 <cit> . for this, the metabolic network of each bacterium was modelled as a directed compound graph, whose nodes are metabolites and arcs link a substrate to a product of a reaction. the cofactors and current compounds were filtered. we implemented a version of the borenstein method using the igraph package
 <cit> . in order to cope with possible common inputs missed by the metabolic network reconstruction, we allowed distance one from the topological precursors if they were already assigned as input in another bacterium, and we grouped and compared them among organisms. in this analysis, the following compounds were removed since they are only produced by reactions which also involve macromolecules: dadp, dcdp, dudp, dgdp. hence, a systematic search for the inputs in the small molecule metabolism would indicate these compounds as potential inputs, whereas they in fact can be produced by the cell.

RESULTS
data overview
the total number of genes varies greatly among the  <dig> bacteria, ranging from  <dig> genes for “ca. hodgkinia cicadicola”  to  <dig> genes for ralstonia eutropha  . we noticed that the number of genes is greater in the extra than in the intra, in agreement with the reduced genomes related to the intracellular lifestyle
 <cit> .
 <dig> 

the three most frequent taxonomic classes among all the organisms analysed are gammaproteobacteria, alphaproteobacteria and bacilli. these classes are well distributed in relation to the number of genes , with no correlation observed between the two factors .

the number of metabolic genes ranges from  <dig> for “ca. hodgkinia cicadicola”  to  <dig> for mycobacterium smegmatis . as for the total number of genes, the number of metabolic genes is greater in the extra as compared to the intra bacteria. however, the ratio of the number of metabolic genes over the total number of genes shows important differences depending on the organism . for the organisms in the groups other than miv, the mean ratio of metabolic genes is  <dig>  ±  <dig> . by contrast, the mean ratio of metabolic genes for the miv bacteria is  <dig>  ±  <dig>  and even reaches  <dig>  for “candidatus baumannia cicadellinicola” , being significantly different from the bacteria of the other groups .

among the  <dig> bacteria analysed, the number of compounds and reactions follows almost the same trend as the number of metabolic genes, from  <dig> compounds and  <dig> reactions for “ca. hodgkinia cicadicola”  to  <dig> compounds and  <dig> reactions for m. smegmatis  .

core metabolism in the whole set of bacteria
shared compounds and reactions
for the whole set of organisms, there are only  <dig> common compounds  which correspond to amino acids, cofactors, ions and metabolites involved in the synthesis of nucleic acids. no small-molecule metabolic reaction is common to every organism of the dataset . the  <dig> compounds shared by the  <dig> organisms are therefore not involved in the same reactions in each organism. the full list of reactions analysed with the number of bacteria that possess them and the list of the organisms that lack them is presented in the additional file
 <dig> 

core enzymatic function based on an ec number analysis
we found only four partial ec numbers common to all  <dig> bacteria: two transferases , one hydrolase  and one lyase  . they correspond to  <dig> reactions in the union of all the reactions of our dataset. we searched for any four reactions, each corresponding to one of the four partial ec numbers, that are connected in the metabolic networks. in the union of all metabolic networks of the dataset, the graph induced by these  <dig> reactions has  <dig> arcs and forms  <dig> connected components apart from  <dig> isolated reactions. there are  <dig> occurrences of the four reactions  connected in the union of the metabolic networks. in the reaction graph of each organism, we found this connected pattern of four reactions in the graphs of  <dig> organisms. the common set of partial ec numbers in the whole dataset thus corresponds to a connected portion of the metabolic network of  <dig> bacteria out of the  <dig> analysed. this subset of bacteria represents most lifestyle groups described in this work, ranging from obligate intracellular to free-living as well as from mutualists to parasites.

the detailed description of the  <dig> partial ec numbers shared by the whole dataset includes  <dig> classes of enzymes: transferase, hydrolase and lyase.

controlling for the impact of small networks
clearly, we can expect that the inclusion of bacteria with very reduced genomes will have a large impact on the size of the intersection. however, it remains unclear if the small size of the intersection could be explained only by this. we found that the shared reaction sets, obtained when decreasing the number of organisms, range from zero to five and the mean varies from  <dig>  to  <dig> . there are  <dig> common reactions without the six bacteria with the smallest reaction sets,  <dig> take part in the biosynthesis of peptidoglycan, which is a cell wall precursor. these reactions do not complete this biosynthetic pathway . among the other reactions, there is an inorganic pyrophosphatase, a reaction involved in folate transformations and a couple of reactions which take part in purine nucleotides de novo biosynthesis. removing the eight bacteria with the smallest reaction sets resulted in similar intersection sizes ranging from zero to  <dig> reactions and mean varying from zero to  <dig> . hence, the intersection sizes did not increase much without the bacteria with reduced metabolism.

on the other hand, these bacteria had a greater impact on the common partial ec number sets. the size of the intersections when decreasing the number of organisms ranges from  <dig> to  <dig> and the mean varies from  <dig> to  <dig>  this size increases to  <dig> partial ec numbers without the same six bacteria. when removing the eight bacteria with the smallest sets, the sizes of the intersections increase, ranging from  <dig> to  <dig>  reaching  <dig> partial ec numbers. therefore, a core of biochemical capabilities composed of  <dig> partial ec numbers is present in  <dig> bacteria out of the  <dig> analysed. this set is made of all classes of enzymes:  <dig> oxidoreductases,  <dig> transferases,  <dig> hydrolases,  <dig> lyases,  <dig> isomerases and  <dig> ligases, which correspond to  <dig> reactions in our dataset .

partial ec number set common to  <dig> bacteria out of the  <dig> present in our dataset and the number of reactions in the dataset corresponding to each partial ec number. the  <dig> bacteria which possess the smallest partial ec number sets were removed to calculate the common set.

core metabolism according to lifestyle groups
shared compounds and reactions
the same analyses performed for the whole dataset were also applied to the different lifestyle groups . the aim was to describe the influence of these groups on the size and composition of the common sets of compounds, reactions and partial ec numbers as well as on the union of each of these sets of elements. as a first overview of the two opposing groups in terms of the size of the metabolic networks, i.e., the intra and the extra groups, we notice that the size of the union of the compound sets  is quite large when compared to the mean number of compounds, indicating a relative diversity of the metabolome in these organisms . by contrast, the sizes of the intersections of compound and reaction sets for the same groups are considerably different. therefore, the universe of compounds and reactions of the intracellular bacteria is quite diverse, while common elements are far less abundant.

ratio of the mean size over the union size, as well as the ratio of the intersection size over the mean size, of the compound and the reaction sets among the different lifestyle groups of bacteria.

core metabolism in the extracellular bacteria
we found  <dig> compounds and  <dig> reactions shared by the  <dig> extracellular bacteria. the compounds include nucleosides, amino acids, carbohydrates, cofactors, while the reactions are involved in metabolic pathways, such as glycolysis, nucleotide and amino acid biosynthesis and degradation pathways, and peptidoglycan biosynthesis . most of them  are classified as biosynthetic processes according to the metabolic processes defined in the biocyc databases . these reactions shared by the extra are not connected in the reaction graph induced by these  <dig> reactions, which is composed of  <dig> connected components apart from  <dig> isolated reactions. the largest component has  <dig> reactions which are involved in pyrimidine ribonucleotides de novo biosynthesis, peptidoglycan and amino acid biosynthesis.

core metabolism in the cell associated bacteria
the ca bacteria showed a considerable reduction in the common elements which are  <dig> compounds and  <dig> reactions. even with this reduction, similar categories of compounds as for the extra were found, whereas the reactions observed take part in fewer metabolic pathways: glycolysis and nucleotide biosynthesis and degradation pathways. most of them  are classified as biosynthetic processes . this group is supposed to be intermediate between the intra and the extra ones, thus presenting a broad diversity of genome sizes. in this group, the two bacteria with smallest genomes are m. genitalium  and m. hyopneumoniae j  which are obligate parasites that have undergone extreme reductive genome evolution
 <cit> . this pair of organisms is the one that most influences the small intersection of the ca group. hence, the intersection of the elements of the ca bacteria without the two mycoplasma species increases to  <dig> compounds and  <dig> reactions. these values are similar to the ones found for the extra, the reactions take part in the same metabolic pathways observed for this group and the classification into biosynthetic and degradation processes present similar ratios .

core metabolism in the obligate intracellular bacteria
the intra share  <dig> compounds and one reaction . indeed, the miv is the group mainly responsible for this reduction. the common compounds still include the same ones mentioned for the extra group. the only shared reaction is not assigned to participate in any metabolic pathway in metacyc.

as there is only one reaction common to intra, it is not possible to analyse whether there is a majority of biosynthesis reactions in their core as we found in the extra and ca. instead, we analyse the content of biosynthesis and degradation reactions in the variable metabolism . the total number of reactions in the variable metabolism is  <dig>  for the intracellular group while it is  <dig>  in the extra . the variable metabolism of intracellular bacteria is therefore enriched in biosynthetic reactions  and depleted in degradation reactions .

controlling for the structuring of miv
as mentioned, the absence of a metabolic core common to all symbionts is mainly caused by the absence of such a core within the miv group. we further analysed this group and we found two subgroups with opposite patterns of reaction presence/absence , which can be directly related to the role of the symbiont in the mutualistic relationship
 <cit> . intersecting the reaction sets of each subgroup with non miv organisms did not increase much the common sets, thus the structuring of the miv symbionts does not explain the reduced number of reactions shared by the bacteria analysed.

decay of the common reactions in the different lifestyle groups
as there is a clear trend in the intra group indicating that common reactions decrease to none rapidly, it is important to address the question whether the other groups follow the same rule. this analysis is based on a simulation of the number of common reactions for different subset sizes of the organisms . the exponential model fitted best the data of the intra group, however it did not fit well the data of the ca  and extra groups . we therefore tested a logistic model, which has a smoother decay than the exponential model, and found that it fitted much better this data. as expected, the asymptote for the intra group  was not significantly different from zero . in contrast, the asymptote was estimated at  <dig> for the ca and  <dig> for the extra. thus, based on the analysed dataset, neither the ca nor the extra group is expected to have an empty common set of reactions.

estimates were obtained by fitting the exponential and logistic models to the corresponding data sets. αlis the asymptote, rlis the decay rate and nlis theoretically defined as the mean of the reaction sets for an empty subset size of the lthlifestyle group. point estimates are given with ±2× standard error.

core enzymatic function based on an ec number analysis for lifestyle groups
the number of shared partial ec numbers depends on the lifestyle groups:  <dig> were found for the intra,  <dig> for the ca and  <dig> for the extra . these values represent 6%, 20% and 34% of the respective union in each group. the common set for the intra and ca groups is exactly the same as for the whole set of bacteria. the set for the intra group adds  <dig> more partial ec numbers when compared to the common partial ec numbers of the whole dataset: one oxidoreductase  and  <dig> transferases  . the miv bacteria are the ones which mainly account for the small size of the intersections in the intra group, and they share  <dig> partial ec numbers which means adding the ligase  <dig> . <dig> to the common set. hence, the common set of ec numbers for the miv group comprises all classes of ec numbers, except for isomerase. both the ca and the extra shared sets have all the  <dig> classes of enzymes; the number of different ec numbers of each class ranges from two subclasses of lyases to  <dig> subclasses of transferases.

connectivity of the partial ec number set for obligate intracellular and extracellular bacteria
we searched for connected reactions corresponding to the common partial ec numbers for the intra and extra groups . we found no occurrence of connected reactions in either group . hence, the common set of partial ec numbers in the intracellular and extra groups does not correspond to a connected portion of the metabolic network of these bacteria.

differential random loss of enzymes
the differential random loss of enzymes or of biochemical capabilities  was compared with the small intersection size of the partial ec number sets. comparing the simulated values with the ones of the real miv gammaproteobacteria , we found that the miv have lost a greater diversity of biochemical capabilities than expected by simulation .

size of the mean, union and intersections of the sets of partial ec number for the miv gammaproteobacteria and for the simulated miv.

metabolites potentially acquired from the environment
the absence of a metabolic core in the intra might be linked to the differences in their environment. the number of metabolites that each bacterium potentially acquires from its environment  ranged from  <dig> in “candidatus sulcia muelleri”  to  <dig> in m. smegmatis  with a mean of  <dig> . there are no potential inputs common to the  <dig> bacteria and the union of inputs is  <dig> . the intersection is null in the intra and the ca groups, while it is  <dig> in the extra group. these two inputs are isolated from the rest of the network, and are linked together by one reaction which is catalysed by an enzyme that accelerates the folding of proteins 
 <cit> . overall, we found no common inputs to the whole metabolic network of extra bacteria. the mean values of the inputs in each group are  <dig>   <dig> and  <dig>  respectively. taking into account classes of compounds, the intracellular bacteria have in common ions, cofactors and nucleosides as potential inputs, while the extra add vitamins and carbohydrates.

when we allowed distance one from the topological precursors , the number of common inputs increased inside the lifestyle groups that have less organisms, such as piv. in the broader lifestyle groups, the number of shared inputs remained equal. the number of bacteria that has glucose as input increased from  <dig> to  <dig>  furthermore, the size of the intersection augmented between the groups, such as meh and peh.

overall, we find that neither extra nor intra symbionts exhibit a common core of input metabolites. the absence of such a core is an intuitive explanation for the absence of a metabolic core of degradation pathways: different metabolic environments imply different metabolic pathways. however, this observation alone does not explain the total lack of a metabolic core for the intra symbionts. in this case, the specificity of the symbiosis with the host has to be considered.

discussion
in this paper, we investigated to what extent there is any reaction common to a set of bacteria, including obligate intracellular symbionts, as well as the influence and the trend of each lifestyle group concerning shared reactions or biochemical capabilities. in order to do this, we considered  <dig> bacteria carefully selected to represent a wide range of lifestyles.

existence of a metabolic core
previous studies have found small sets of common metabolic genes even when including bacteria with reduced genomes
 <cit> . based on that and on the fact that we analysed reactions instead of genes , we therefore expected to find a small core of functional capabilities. our analyses of the small molecule metabolism of  <dig> bacteria revealed however that they share no reaction,  <dig> compounds and  <dig> partial ec numbers.

even though there was no reaction common to all bacteria, we actually found one reaction  present in all the dataset except in m. hyopneumoniae . it is catalysed by the hydrolase peptide deformylase , which releases the formyl group from the n-terminal methionine residue of most nascent polypeptides
 <cit> , an obligatory step during protein maturation in eubacteria
 <cit> . the absence of def in this bacterium apparently leaves it unable to formylate met-trnai
 <cit> , and it has been described as absent or nonessential in phytoplasma sp. and mycoplasma arthritidis <cit> . for long, peptide deformylase was believed to be exclusively present in bacteria, however giglione et al. <cit>  identified eukaryotic deformylases which were localized in the organelles only. in our dataset, even the symbiont with most reduced genome ) is potentially capable to code for this enzyme. nevertheless, recently an even smaller cellular genome  of “candidatus tremblaya princeps” has been described
 <cit>  which is missing homologs for def. the presence of this enzyme in almost the whole dataset is justified by the fact that it is mostly related to information processing which is expected to be among the minimal functions required for sustaining life
 <cit> .

such small sets found raised the question whether they could be explained only by the  bacteria with the smallest genomes. these bacteria had a weak impact on the number of shared reactions, while they had a strong effect on the common partial ec number set. removing them, the shared set increased to  <dig> reactions mainly involved in the synthesis of a cell wall precursor, which is not considered as an essential pathway
 <cit>  and is known to be absent or reduced in host-dependent bacteria
 <cit> . conversely, the common partial ec number set increased to  <dig> without those bacteria which is a quite broad set of biochemical capabilities. all six classes of enzymes are included in this set, and are similar to the ones described for a minimal metabolism
 <cit> . only two partial ec numbers at level  <dig>  from this minimal metabolism are not included in our partial ec number set, however the latter partial ec number should not be in our analyses because it involves macromolecules and we work strictly with the small molecule metabolism. furthermore,  <dig> of the  <dig> shared partial ec numbers are not included in this minimal metabolism, and four of them are transferases which are enriched in our common partial ec number set .

the reduced set of common partial ec numbers raised the question whether it could be simply explained by a differential random loss of enzymes. this was not the case. we further identified the miv gammaproteobacteria as having lost a greater diversity of biochemical capabilities. this indicates that there is a set of partial ec numbers  which are kept in subsets of organisms  and accounts for a reduced union.

hence, we did not find a core of metabolic reactions shared by the symbiotic bacteria which agrees with the idea that searching for ubiquity as more genomes are included may ultimately reduce to nothing
 <cit> . conversely, using a more relaxed approach we found a core of biochemical capabilities which is similar to a minimal metabolism previously described
 <cit> .

impact of the lifestyle groups on the existence of a metabolic core
among the different types of classification that we considered –  obligate intracellular, extracellular, cell associated,  mutualistic, commensalist, parasitic,  vertically or horizontally transmitted – the first is by far the one that explains best the differences in terms of metabolism. the ca group also accounted for the small common sets exclusively because of the mycoplasma species. even if this group presents other host-dependent bacteria, their genome sizes at least double when compared to the mycoplasma species, and a core of reactions similar in size to the extra is found. the other lifestyle groups , which include just free-living bacteria, did not contribute to the size of the common set.

furthermore, the impact of the intra and of the mycoplasma species in the small sets can be directly related to their extremely reduced genomes
 <cit> . they also have much fewer metabolic genes, even though this category is much less affected by the reduction in the intra group specially in the miv. these bacteria ) are the most integrated
 <cit>  and are those for which the association with the host is essentially nutritional
 <cit> . indeed, the ratio of metabolic genes is significantly higher for miv, indicating that the loss of genes primarily concerns the non metabolic ones
 <cit> . the loss of metabolic genes is affected by the requirements for host survival, and to some extent by the presence of other symbionts in the same environment
 <cit> .

content and connectivity of the core metabolism of ca and extra
in the analyses of each lifestyle group, we did not find a core of reactions for the intra, however we found it for the extra and ca . the shared reactions are involved in metabolic pathways that are also included in the minimal metabolism described by
 <cit> , such as glycolysis and nucleotide biosynthesis. the cores found also include amino acid biosynthesis pathways which are not present in the minimal metabolism because they assumed a nutrient-rich medium with amino acids unlimitedly available for the minimal cell
 <cit> .

the common sets of reactions of the ca and extra groups are enriched in biosynthesis  according to the metabolic processes defined in the biocyc databases. in the core metabolism of e. coli, biosynthetic reactions are also overrepresented 
 <cit> , thus our study enables to confirm and extend this result to multiple species. overall, the core-metabolism of the ca and extra bacteria is therefore much smaller than the one of the strains of e. coli, but at the same time, it is even more enriched in biosynthetic reactions. the reason for such an enrichment could be that, while the needs of the ca and the extra symbionts are very similar in terms of building blocks for protein and dna synthesis, the nutrients they uptake in their respective environment may be extremely variable. when variable environments are considered, degradation pathways, which are closer to the inputs of the network, are the first to be modified. this explanation is also corroborated by our observations on the lack of common inputs to all bacteria.

considering now the proportion of biosynthesis and degradation reactions in the variable metabolism, we find that it is quite similar in e. coli  and the ca and extra bacteria , but the numbers are quite different for obligate intracellular bacteria . a possible explanation for this is that degradation pathways have largely disappeared in obligate intracellular bacteria, as the host provides an interface between the environment and the bacterium, while synthetic routes have not all disappeared but have been selected for, depending on the nature of the symbiosis
 <cit> .

here, we worked with whole metabolic networks enabling to check whether the metabolic core would represent chains of biochemical reactions regardless of specific metabolic pathways. the core of reactions found was not entirely connected, most likely because of the existence of alternative pathways as highlighted by gil et al. <cit> . this means that searching for ubiquity even inside lifestyle groups does not result in one functional metabolic network.

persistent metabolic core of ca and extra
we found a core of metabolic reactions for the ca and extra, however we did not find one for the intra. this raised the question whether, as we add organisms, the decay of shared reactions and its limit was the same in these groups. first, we fitted the exponential model with asymptote to the data of all groups. this model described well the decay of shared reactions in the intra group. however, it was not appropriate to fit the extra and ca data, since their behaviour of decay was not the same as that for the intra. conversely, the logistic model was well adapted for these two groups. we also tested for common parameters for the two groups, but model fitting was better with each group having its separate parameter values. the decay rates  were similar, while the two other parameters were different. in principle we cannot give a direct biological interpretation to nl, we found its estimates are close to the size of the union of reactions of the corresponding lifestyle group, e.g., nextra was estimated at  <dig>  while the size of the union of extra was  <dig> reactions. as expected, the asymptote estimated for the intra was not significantly different from zero, which agrees with the absence of a core of metabolic reactions found for this group. conversely, the asymptotes estimated for the ca and the extra groups were significantly different from zero; thus, based on the analysed dataset, neither group is expected to have an empty common set of reactions when more genomes of these groups are added. one should be aware that adding one organism that has a very particular niche could certainly change this trend. this result is nevertheless interesting given the fact that there are organisms from distinct taxonomic classes inside these groups, that moreover present different types of association with their hosts. to have an idea of the subset of reactions that would be “asymptotically” kept in organisms with lifestyles similar to those two groups, we analysed the reactions shared by the extra and ca groups in our dataset. these  <dig> reactions are involved in the synthesis of purine and pyrimidine, of peptidoglycan and glycolysis. these findings are similar in number of enzymatic steps and in the content of pathways to the minimal metabolism described by gabaldón et al. <cit> .

CONCLUSIONS
in this paper, we explored to which extent each lifestyle group contributes to the reduction of a core metabolism as well as the composition of this core in the different groups, with a special focus on bacterial species only, in particular those that entertain a symbiotic relationship with a host. moreover, we considered reactions instead of genes. although we might then have expected to find a core, none common to all bacteria was observed. symbionts with the most reduced genomes in our dataset had a weak impact on the number of shared reactions, but had a strong effect on the common partial ec number set which increased to  <dig> without those bacteria, covering a quite broad set of biochemical capabilities similar to those described for a minimal metabolism, with however an enrichment in transferases.

obligate intracellular symbionts appeared as the main reason for such absence of a core of metabolic reactions due to their high specialisation. however, hostdependence alone is not an explanation for this absence. indeed, although the cell associated group contained host-dependent bacteria, their core of reactions was observed to be similar in size to the one of extracellular bacteria once the two mycoplasma species were eliminated from the group. extremely reduced genomes such as those of the two mycoplasma and of the intracellular group remain thus the main factor behind the absence of a core, even though the loss of genes primarily concerns the non metabolic ones.

a core of reactions was found for the cell-associated and the extracellular bacteria. this core roughly corresponds to the minimal metabolism previously described in the literature. it is not entirely connected and therefore does not result in one functional metabolic network. although smaller than the core previously identified for strains of e. coli, we observed that it is even more enriched in biosynthetic reactions, which might be due to the extreme variability of the nutrients that cell-associated and extracellular bacteria uptake in their respective environment. on the other hand, the proportion of biosynthesis and degradation reactions in the variable metabolism appears quite similar to the one found in e. coli. the same is not the case for obligate intracellular bacteria where degradation pathways have largely disappeared but synthetic routes appear instead to have been selected for depending on the nature of the symbiosis.

finally, by using simulation, we tested whether the decay of shared reactions and its limit would be the same for cell-associated and extracellular bacteria as for the intracellular ones. although one should be aware that adding one organism that has a very particular niche could certainly change the result observed, it appears that a subset of around  <dig> reactions would be “asymptotically” kept in cell-associated and extracellular bacteria. these are involved in the synthesis of purine and pyrimidine, of peptidoglycan and glycolysis, and are similar in number of enzymatic steps and content of pathways to the minimal metabolism described in the literature.

competing interests
the authors declare that they have no competing interests.

author’s contributions
cck selected the dataset and lc prepared the data. cck conducted the computational analyses described in the paper. jk and cck performed the simulation of the decay of the reaction sets. all authors contributed equally to coordinating the analyses and writing the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
additional results. additional results exemplifying the issue of nogd, controlling for the structuring ofmiv and connectivity of the partial ec number set for obligate intracellular and extracellular bacteria.

click here for file

 additional file 2
the full list of the bacteria selected and their detailed classification. additional file
2: table s1: the full list of the bacteria selected and their detailed classification

click here for file

 additional file 3
number of genes vs lifestyles. additional file
3: figure s1: total number of genes and number of metabolic genes  according to lifestyles  and taxonomic classes .

click here for file

 additional file 4
compounds common to all dataset. additional file
4: table s2: compounds common to all dataset and their classification.

click here for file

 additional file 5
compounds and reactions common to groups of lifestyle. additional file
5: table s3: size of the mean, union and intersections of the compound and the reaction sets among the different lifestyle groups of bacteria.

click here for file

 additional file 6
the full list of the reactions analysed and the list of organisms that lack them. additional file
6: table s4: the full list of reactions represented by its metacyc id, corresponding enzyme name and ec number. for each reaction, the number of organisms that possess it are presented as well as the list of the bacteria which lack it. the codes for the organisms are the ones from hamap [
 <cit> ] and they can also be found in figure  <dig> and in the additional file  <dig>  the reactions are sorted by the number of organisms that possess them.

click here for file

 additional file 7
partial ec numbers common to groups of lifestyle. additional file
7: table s5: size of the mean, union and intersections of the partial ec number sets among the different lifestyle groups.

click here for file

 additional file 8
metabolic core of the extracellular bacteria. additional file
8: figure s2: qualitative representation of the metabolic core of the extracellular symbionts.

click here for file

 additional file 9
distribution of reactions across metabolic processes. additional file
9: table s6: distribution of reactions across metabolic processes, as defined in biocyc databases. some reactions are classified in more than one process and this explains why it may happen that the two proportions add up to more than 100%. for clarity, we introduced a category for such reactions . for the group ca, the values in-between parentheses correspond to the ca group without the two mycoplasma species.

click here for file

 additional file 10
simulation of partial ec number sets of the miv bacteria. simulation of partial ec number sets of themiv bacteria. additional file
10: figure s3: simulation of the size of the mean , union  and intersection  of the partial ec number sets of the miv bacteria.

click here for file

 additional file 11
number of potential inputs. additional file
11: figure s4: the number of potential inputs of the metabolic networks according to borenstein method [
 <cit> ].

click here for file

 additional file 12
potential inputs common to groups of lifestyle. additional file
12: table s7: size of the mean, union and intersections of the potential input sets among the different lifestyle groups.

click here for file

 acknowledgements
the authors thank arnaldo zaha, joão carlos pereira da silva, jean thioulouse, christian baudet, fabrice vavre and all the members of the bamboo team for valuable discussions. we also thank claudine médigue and the genoscope team for adding new genomes to microcyc upon our request. this work was funded by the capes , lncc , french project anr  miri  blan08- <dig> and the erc  advanced grant sisyphe .
