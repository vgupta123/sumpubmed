BACKGROUND
in the past decade, hundreds of studies investigating the genetics of common human diseases have been published  <cit> . high-density snp microarrays cataloguing variation identified in the hapmap project  <cit>  have been the enabling technology behind these large-scale genome-wide association studies. these microarrays allow the collection of genotypes for many snps in many individuals at relatively low cost. the two major producers of these microarrays are affymetrix inc.  and illumina inc. . the platforms offered by these companies differ substantially in terms of array fabrication, probe design, sample preparation and hybridization protocol. however, both currently genotype around  <dig> million snps per sample and also include non-polymorphic probes for assessing copy number variation in the genome.

illumina's beadchips have rapidly increased in both snp density  and in the number of samples processed in parallel  over the past few years. illumina whole-genome snp beadchips use infinium chemistry, which differentially labels allele a and allele b with red and green dye respectively  <cit> . a number of algorithms are available for processing the raw signal from these arrays into genotype calls. these methods include: gencall  <cit> , illumina's proprietary method implemented in the beadstudio/genomestudio software; illuminus  <cit> ; genosnp  <cit> ; crlmm  <cit> ; birdseed, available in the birdsuite software  <cit> ; and beaglecall  <cit> .

in this paper we compare the four widely applicable methods gencall, illuminus, genosnp and crlmm on different data sets, measuring performance in terms of accuracy and the ability of each method to flag poor quality calls, snps and samples.

methods
algorithms
the four genotype calling methods we compare vary in their modelling approaches and assumptions. table  <dig> summarizes the major features of each algorithm in terms of normalization method, underlying model and computing platform supported. the main modelling differences lie in the normalization method and clustering. normalization can occur either within sample , or both within and between samples . likewise, the model-based clustering can occur within sample  or between samples . in the description below, we use illumina's nomenclature of x and y to refer to the intensities for the respective alleles .

key: w - within sample method; b - between sample method; win - windows operating system; lin - linux operating system; osx - macintosh operating system

gencall is the standard vendor provided method from illumina  <cit>  which is available as a module in the beadstudio/genomestudio software. after reading in the data from binary files  produced by illumina's scanning system, normalization using an affne transform to rotate and re-scale the x and y intensities is applied to decrease dependence between the two alleles  <cit> . normalization is performed separately for beads from different 'bead pools'. a 'bead pool' refers to a set of beads that have been manufactured together and are located in roughly the same physical position  on a beadchip. polar coordinates  are calculated from the normalized x and y values. clustering is performed by the gentrain algorithm, which is a between sample model. neural networks which take the polar coordinate transformed data and estimate the snp-specific centroids for each genotype are used. default cluster centroids are calculated using data from a set of hapmap samples  <cit>  . alternatively, users may perform clustering using the available samples to calibrate the cluster positions to the data. genotypes are then assigned by determining the nearest cluster. the gencall score  is a confidence measure assigned to each call which can be used to filter poor quality calls, snps or samples. illumina generally recommend that calls with gc ≤  <dig>  represent failed genotypes. averaged gc scores over all snps from a given sample, or across all samples for a given snp can be used as sample or snp quality metrics. a more commonly used sample quality metric is the 'no call rate'. for gencall, genotypes with gc score less than a given threshold  are declared as missing. the proportion of missing values, or 'no calls' in each sample gives the no call rate; samples with higher rates are deemed less reliable than samples with lower rates. no call rates less than 1% should be expected for good quality samples which have been properly processed .

a second alternative, named illuminus  <cit> , uses gencall normalized x and y values as input. it models the data from each snp using a four component mixture model which is fitted using an expectation maximization  algorithm to the strength ) and contrast /) values to summarize the four possible states . the indices i and j refer to sample and snp respectively. probabilities  indicating how likely a given call is correct under the model are also available. the genotype with the highest probability is the call reported to the user, and the probability provides a call confidence measure. illuminus fits a separate three component model for x chromosome snps in male samples. a perturbation score is also calculated to quantify how sensitive the clustering is to changes in the initial values used in the em-algorithm. this score serves as a snp quality measure, and a cut-off of  <dig>  and above, which equates to 95% or more of the calls agreeing after perturbation, is recommended in the illuminus documentation. sample quality can be measured by the percentage of calls with a posterior probability less than a threshold . alternatively the percentage of no calls  obtained for each sample can be used as a sample quality indicator. the illuminus software is implemented in c and is available from the authors on request  <cit> .

a third method, genosnp  <cit>  is the only method which ts a within-sample model to the data. genosnp uses the raw  x and y intensities from gencall, which are separated by bead pool and then quantile normalized within sample. a four component mixture model similar to illuminus is then fitted to the normalized log <dig> and log <dig> values. snps from the same bead pool within a given sample are called simultaneously using the model. this approach is quite different to the other methods, which use between sample information to fit the model. in genosnp, a posterior probability is available for each call indicating how likely the call comes from the class assigned. this value serves as a call confidence measure. the average posterior probability across all samples for a given snp may be used to filter snps, with lower average probabilities indicative of snps with poorer clustering under the model. a snp cut-off of  <dig>  or higher is recommended for good quality data sets, and  <dig>  or higher for lower quality data sets. likewise, the average posterior probability of all calls from a given sample can be used as a sample quality metric. a sample quality threshold of  <dig>  or higher is recommended. the genosnp software is implemented in c and is available from the authors on request  <cit> .

the final method in our comparison, crlmm, was originally developed for affymetrix data  <cit>  and has recently been adapted to suit illumina's infinium snp beadchips  <cit> . crlmm extracts summarized x and y intensities directly from the idat files. for normalization, snps are separated based on their physical location  on the beadchip surface and simultaneously quantile normalized between channels  and samples, using the reference distribution obtained from the hapmap training samples . each strip contains snps from multiple bead pools. after normalization, snp-specific log-ratios  and average intensities /2) are calculated for each array. to remove intensity dependent effects of s on m, a three-component mixture model with smoothing splines is fitted to each array via the em-algorithm. next, a two-level hierarchical model, with snp-specific means and standard deviations estimated from the relevant training data set using genotype information from the hapmap project, is fitted. the intensity-dependent splines and the snp-specific genotype means and standard deviations are combined in the model  <cit> . in general, the model assumes  <dig> clusters, except for x chromosome snps in male samples, where a  <dig> cluster model is used. genotype calls are assigned by choosing the class that minimizes the negative log likelihood. crlmm produces a number of quality assessment measures  <cit> . per call confidence is measured using the log-likelihood ratio test from the hierarchical model. at the snp level, the minimum distance between the heterozygote center and either of the two homozygous centers provides a snp confidence score. a signal-to-noise ratio  for each sample assesses the separation of the three major genotype clusters within an array, with lower values indicative of poorer quality data. the crlmm method is implemented in r  <cit>  and is available as part of the bioconductor project  <cit> .

none of the methods compared make calls for the non-polymorphic copy number specific probes which are available on many infinium chip types.

data sets
each of the four algorithms was applied to the data sets described in the following sections.

hapmap data
we used data generated in-house at illumina on hapmap samples  <cit>  from  <dig> different chip types. we refer to these samples as training data sets, as they were used by two of the algorithms  to train the respective models. hapmap data generated independently by a different genotyping core facility, were also analyzed. we refer to these samples as test data sets, as they were run independently of the training data used to calibrate two of the models. any over-fitting of the gencall or crlmm models to the training data, which may give overly optimistic results for these two methods on these data sets, should not be present in the independent test samples. the number of samples for each chip-type, with a break-down by hapmap population is presented in table  <dig>  hapmap data has the benefit of independent calls being available  <cit> . these calls can be used as the gold standard for comparing the accuracy of the various calling methods.

the training samples were processed in-house by illumina. the test samples were processed by an independent core facility. the number of samples from each of the four hapmap populations represented in each collection is given in parentheses .

association study data
data from a recent genome-wide association study  on multiple sclerosis   <cit>  were also used in our comparison. table  <dig> lists the number of samples from each batch. different batches correspond to the various study centers in australia and new zealand where the samples were collected from. each sample was analyzed using illumina's  <dig> k duo beadchip platform processed at the same core facility within a  <dig> month window  <cit> . a total of  <dig>  samples were genotyped using the four methods. we refer to this study as the ms-gwas in the remainder of this article.

each batch corresponds to a center where samples were recruited from.

RESULTS
comparing accuracy using hapmap data
for each chip type, calls from the four methods were compared with the independent genotypes available from the hapmap project. figure  <dig> shows the accuracy of each algorithm for autosomal snps from three high density chip types. the drop rate refers to the proportion of snps which have been removed from the accuracy calculation based on low call confidence measures. for most chip types, crlmm gives slightly better performance than genosnp and illuminus. gencall is generally slightly worse than the other methods. overall differences between the four methods are small. results for other infinium beadchips are broadly similar . we repeated these calculations on a per sample basis to obtain confidence intervals  for each method. supplemental figure s <dig> in additional file  <dig> shows the results for the same  <dig> high density chip types shown in figure  <dig>  in almost all instances, the confidence intervals are non-overlapping which indicates that the small differences observed between the methods are indeed significant.

the performance of illuminus is most variable among the methods, sometimes producing near the best accuracy rates, while on other data sets it is the least accurate. this phenomenon appeared to be related to sample size. to investigate this more systematically,  <dig> k quad training data were analyzed using illuminus with varying numbers of samples . in figure 2a, the decrease in the number of 'no calls' as sample size increases is shown. accuracy also improves with increasing sample number . this analysis clearly demonstrates that having more samples improves the performance of illuminus. other methods aren't adversely affected by low numbers of samples, due to either the existence of a training step  which means model parameters based on data from at least  <dig> samples are available, or a within-sample approach  which leverages information from the many snps within an array to estimate the necessary parameters and make calls. illuminus on the other hand only uses the data available, so for small data sets the model parameters will be less well estimated.

we also examined which method offers the best performance on x chromosome snps , again using accuracy with the independent hapmap project calls as the gold standard. calling algorithms which apply different models to the male and female samples  generally perform better than methods which don't . this improvement comes from higher accuracy for male samples. gencall is generally slightly worse than the other alternatives for x chromosome snps. as for the autosomal snps, we see that the performance of illuminus is better when large numbers of samples are available.

the accuracy versus drop rate calculations were repeated using per snp quality measures instead of individual call confidence measures to filter entire snps from the analysis . the illuminus perturbation score for snp quality gives very similar accuracy to crlmm's cluster separation metric when large numbers of samples are available , while the average per snp posterior probability of genosnp is slightly less accurate than these methods. for smaller sample sizes, illuminus does less well. these measures are superior to gencall's average gc score.

stratifying accuracy by minor allele frequency  shows an interesting profile by method . for both the  <dig> k quad training and test data sets, both genosnp and crlmm have fairly consistent accuracies across the range of minor allele frequencies . gencall and illuminus have poorer performance at lower minor allele frequencies, with increasing accuracy as frequency increases. these trends are consistent as the number of low confidence calls removed increases from 0%  to 1%  and 2% . similar trends were observed for other chip types .

higher-level performance assessment
the hapmap data sets analyzed are of very high quality and not subject to the same sources of variation that affect data from genome-wide association studies. in large projects, the collection of samples and genotypes may occur over a long period of time and arrays may be processed by multiple laboratories or core facilities. we examine data from the ms-gwas where samples have been collected from different centers and processed in batches . gencall, illuminus and crlmm were each run independently on the different batches, while genosnp was run one sample at-a-time. for gencall, re-clustering was carried out by the gentrain algorithm using the samples available instead of the default hapmap cluster information. we use these data to assess how well each method performs at flagging samples of dubious quality.

in figure  <dig>  the sample quality measures for the ms-gwas samples are shown for each method. despite differences in the measures used, the four methods flag many of the same samples as potential outliers. pairs plots of the sample quality measures show this more clearly . as a summary, figure  <dig> shows the degree of overlap between the  <dig> worst ranking samples obtained using the respective sample quality metrics from each method. visual inspection of the data from many of these arrays indicates unusual signal patterns , which makes them good candidates to remove from further analysis.

the agreement between calls made on replicate samples was also assessed for each method. in figure  <dig>  the agreement of calls between  <dig> replicate samples analyzed from dna extracted from blood and saliva from the ms-gwas are shown. high levels of agreement  were obtained for all methods. the concordance from one pair of samples  is not shown, due to the poor quality of one of the replicate samples . genosnp does not produce calls for this sample. presumably, the lack of separation between the three clusters causes numerical problems for the model.

the computing resources used to run each method on a set of samples from the ms-gwas were also examined. table  <dig> shows the time taken and memory usage of each algorithm. we note that gencall was only available under windows, and was run on a different computer to the other methods, which means our results cannot be directly compared. in spite of this, we can say that crlmm is the fastest method of the three which were run on the same linux system, followed closely by illuminus and then genosnp. crlmm is by far the biggest consumer of ram using approximately three times as much memory as illuminus. in contrast, gencall and genosnp use very little ram.

these figures are based on the analysis of a set of  <dig> samples  from the ms-gwas.

* run on a pc  with file-based storage enabled

† run on a quad-core amd opteron  <dig>  ghz cpu linux machine with  <dig> gb ram

⋄ timing does not include time taken by genomestudio to output x and y data used as input for these methods 

CONCLUSIONS
our study represents the largest comparison of genotyping methods for illumina's infinium beadchip platform to date. we examined the performance on data sets varying in size from tens to nearly  <dig> samples from a wide range of chip types.

despite the differences in approach, the four methods compared generally o er similar performance in terms of accuracy with high quality hapmap data , when call or snp-specific quality scores were used to filter data. crlmm is marginally better than genosnp and illuminus , followed by gencall. each method also gives high concordance between replicate samples . variations in the ability of different methods to correctly recover calls from snps with low minor allele frequency were observed, with crlmm and genosnp outperforming gencall and illuminus for snps with the lowest maf. this points to the benefit of borrowing information between snps. in genosnp, this is done explicitly by using the many observations from a given bead pool to estimate parameters in the mixture model and assign genotypes. for crlmm, there will be little information from the training data set on the heterozygous and homozygous cluster locations involving the minor allele. however, since the snp-specific parameters are updated by an empirical bayes shrinkage procedure, more weight will be placed on the priors in these situations. these priors are derived from other snps in the data set. both approaches cope better than methods which model the data from each snp independently  when maf is low. this issue will be important as arrays include more rare variants , such as snps discovered in the  <dig> genomes project  <cit> .

we observed that the performance of illuminus depends upon the number of samples available for the analysis, with larger sample sizes , giving better results in terms of no call rate and accuracy. for genome-wide association studies, low sample numbers are not likely to be a problem, however for linkage studies, which are often much smaller , illuminus would not be the method of choice, unless the samples can be analyzed within a larger batch of the same chip type. all other methods can handle data from small-scale projects without compromising performance.

we note that relative to the time expended recruiting and collecting samples and processing arrays, the time taken to run each algorithm is insignificant, with slightly longer processing times unlikely to be a major factor effecting the choice of method. the ability to parallelize genotyping between multiple processors is a simple way to reduce the time taken to process samples. all four algorithms allow parallelization. by default, genomestudio divides the analysis between the available processors, splitting on sample or snp depending upon the stage of the analysis. for genosnp, which processes samples one-at-a-time, parallelization is trivial; the user can easily divide the samples between the processors available. for illuminus and crlmm, the between-sample nature of the modelling, means that parallelization requires snps to be split between processors. this feature is available as an option in both algorithms. in crlmm, the parallelization is handled using the snow package in r.

as for timing, researchers involved in large scale studies are likely to have access to high performance computing facilities, which means that large memory requirements of methods like crlmm, and to a lesser extent illuminus are not likely to pose a limitation. in the most recent version of crlmm, the memory footprint can be reduced through use of the ff package in r. this package utilizes available disk space instead of ram when ram is limited to store the raw data and genotyping output.

one drawback of the current implementation of crlmm is its reliance on training data to calibrate the model parameters, which means that for customized genotyping, or genotyping in non-model organisms , it cannot be applied due to a lack of availability of hapmap-like training data. we are currently investigating modifications to crlmm to ensure it can be applied in such settings. while gencall also includes a training step on hapmap data for the chip types analyzed in this paper, it can also work in an unsupervised manner, where it estimates cluster centers using the data available without the need for any prior information. illuminus and genosnp can also be used on beadchips containing customized human snp sets or snps from other diploid organisms.

further work would be to extend the comparison to include newer genotyping methods, such as beaglecall  <cit> , which adds an extra layer of haplotype information to the genotype calling process. the improvements offered by the recently released update to the gentrain clustering algorithm  are also of interest. gentrain <dig> was not used in this study, as output from this software was unavailable for any of the data sets analyzed. since most studies published to date will be based on the older version of gencall, our comparison is still relevant.

authors' contributions
rl and mer performed the analysis. mer wrote the manuscript. bsc was involved in software implementation and improvement and provided feedback on the manuscript. the anzgene consortium provided data used in this study. rai oversaw the study and finalized the manuscript. all authors' read and approved the final manuscript.

supplementary material
additional file 1
supplemental figures.

click here for file

 acknowledgements
the full list of authors and affiliations for the anzgene consortium is as follows:

study design and management committee: melanie bahlo <dig>  david r booth <dig>  simon a broadley <dig> , matthew a brown9; <dig>  simon j foote <dig>  lyn r griffiths <dig>  trevor j kilpatrick13- <dig>  jeanette lechner-scott <dig> , pablo moscato <dig> , victoria m perreau <dig>  justin p rubio <dig>  rodney j scott16- <dig>  jim stankovich <dig>  graeme j stewart <dig>  bruce v taylor <dig>  james wiley <dig> .

sample processing, data handling and genotyping: matthew a brown <dig> , david r booth <dig>  glynnis clarke <dig>  mathew b cox <dig> , peter a csurhes <dig>  patrick danoy <dig>  joanne l dickinson <dig>  karen drysdale <dig>  judith field <dig>  simon j foote <dig>  judith m greer <dig>  lyn r griffiths <dig>  preethi guru <dig>  johanna hadler <dig>  ella hoban <dig>  brendan j mcmorran <dig>  cathy j jensen <dig>  laura j johnson <dig>  ruth mccallum <dig>  marilyn merriman <dig>  tony merriman <dig>  andrea polanowski <dig>  karena pryce <dig>  rodney j scott16- <dig>  graeme j stewart <dig>  lotfi tajouri <dig>  lucy whittock <dig>  ella j wilkins <dig>  justin p rubio <dig> .

data analysis: melanie bahlo <dig>  matthew a brown <dig> , brian l browning <dig>  sharon r browning <dig>  devindri perera <dig>  justin p rubio <dig>  jim stankovich <dig> .

phenotyping: simon broadley <dig> , helmut butzkueven <dig> , william m carroll <dig> , caron chapman <dig>  allan g kermode <dig> , mark marriott <dig>  deborah mason <dig>  robert n heard <dig>  michael p pender <dig> , mark slee <dig>  niall tubridy <dig>  jeanette lechner-scott <dig> , bruce v taylor <dig>  ernest willoughby <dig>  trevor j kilpatrick13- <dig> .

addresses: 6the westmead millenium institute, westmead, new south wales, australia. 7school of medicine, griffith university, queensland, australia. 8department of neurology, gold coast hospital, queensland, australia. 9diamantina institute of cancer, immunology and metabolic medicine, princess alexandra hospital, university of queensland, brisbane, queensland, australia. 10botnar research centre, nuffield department of orthopaedic surgery, university of oxford, oxford, uk. 11menzies research institute, university of tasmania, hobart, tasmania. 12genomics research centre, griffith university, queensland, australia. 13centre for neuroscience, university of melbourne, victoria, australia.14the howard florey institute, university of melbourne, victoria, australia. 15royal melbourne hospital, parkville, victoria, australia. 16john hunter hospital, hunter new england health service, newcastle, new south wales, australia. 17hunter medical research institute, newcastle, new south wales, australia. 18centre for bioinformatics, biomarker discovery and information-based medicine, university of newcastle, new south wales, australia. 19department of medicine, nepean hospital, penrith, new south wales, australia. 20christchurch school of medicine and health sciences, university of otago, new zealand. 21uq centre for clinical research, university of queensland, queensland, australia.
22department of biochemistry, university of otago, dunedin, new zealand. 23department of statistics, the university of auckland, auckland, new zealand. 24department of neurology, box hill hospital, victoria, australia. 25sir charles gairdner hospital, nedlands, western australia, australia. 26australian neuromuscular research institute, nedlands, west australia, australia. 27barwon health, geelong, victoria, australia. 28canterbury district health board, christchurch, new zealand. 29school of medicine, university of queensland, queensland, australia. 30department of neurology, royal brisbane and women's hospital, queensland, australia. 31school of medicine, department of neurology, flinders university, bedford park, adelaide, south australia, australia. 32department of neurology, st. vincent's university hospital, dublin, republic of ireland. 33auckland district healthboard, auckland, new zealand.

we thank patrick danoy for providing the raw data from the ms-gwas and for providing information on the computing resources used by gencall; melanie bahlo and jim stanokvich for sample annotation information and useful insights into the ms-gwas data; dan peiffer from illumina inc. for providing access to their in-house hapmap data; mike inouye for providing the illuminus software and advice on its use; eleni giannoulatou for providing the genosnp software and advice on its use; illumina's technical support for answering various questions on infinium technology and the gencall algorithm, marvin newhouse and jiong yang for maintaining the computing environment used for the analysis; keith satterley for help in generating several data packages used by crlmm; marc carlson for making the crlmm data packages available through bioconductor; terry speed for feedback on the manuscript and the anonymous reviewers whose comments also improved the final manuscript.

this work was supported by nhmrc program grant  <dig>  nhmrc iriiss grant  <dig> and a victorian state government ois grant , and nih grants r01gm <dig>  r01rr <dig> and p41hg <dig> .
