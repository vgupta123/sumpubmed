BACKGROUND
to reposition drugs  <cit>  from one approved indication to a new indication, drug developers could significantly save associated development cost  <cit>  and lower development risks <cit> . with the rapid accumulation of genomics, functional genomics, and chemical informatics data in the past decade, several new systematic approaches to drug repositioning have been proposed. for example, one may study the drug-ligand structural binding relationships systematically for all approved drugs to discover their new targets implicated in other diseases using chemoinformatic tools  <cit> . if the drug-drug similarity relationships, disease-disease similarity relationships, or side-effect-to-side-effect similarity relationships  <cit>  are characterized, one may populate indications from one drug to another among all drugs under study that are closely related through shared disease, shared side effect, or shared target relationship profiles. machine learning  <cit>  and biomedical literature text mining  <cit>  approaches can also help uncover non-obvious relationships between approved drugs and potential new indications.

recently, there has been surging interest to apply "connectivity map"  techniques, which attempt to match a repositioned drug's effects by their shared disease perturbation gene expression profiles  <cit> . a major resource--cmap--was developed by lamb et al.  <cit>  to assay genome-wide transcriptional expression data across a wide range of cell lines treated with small drug molecules. based on the cmap data, iorio et al.  <cit>  proposed a drug repositioning method by constructing drug-drug similarity networks. hu and agarwal <cit>  and sirota et al.  <cit>  also investigated how to pair drugs and disease indications based on negative correlation of drug perturbation and disease gene expression patterns identified from cmap. the anti-correlation relationships between the drugs and diseases are demonstrated to suggest novel therapeutic indications for existing drugs. the primary advantage of cmap is that it does not require prior knowledge of drug targets or a drug's detailed mechanism of actions to work. however, cmap's limitation is also quite apparent: limited coverage of drugs, limited drug perturbation gene expression data, limited dosage-dependent conditions, and the dubious transferability of expression patterns from cell lines or animal models to human systems. ultimately, it can be time-consuming and costly before a significant portion of current drugs in all safe dosage conditions can be tested in even a limited number of cell lines for cmap according to the statistics in  <cit> .

in this work, we describe our development of a new resource called dmap that can help drug development researchers evaluate what effects a drug may have on disease-relevant genes or proteins. dmap compiles each drug's stimulatory or inhibitory effects on genes or their protein products , based on the computational integration of such data from different databases. it covers  <dig>  chemical-to-protein effect relationships between  <dig>  pubchem compounds that cover  <dig>  chemical entities with a synonymous name, and  <dig>  distinct uniprot proteins. dmap may be used wherever cmap data coverage is poor for drug repositioning applications. to evaluate the dmap performances, we calculated drug-to-drug similarity based on newly generated dmap profiles  <cit>  and obtained kolmogorov-smirnov test scores  <cit> . we demonstrate that dmap can successfully recall known drugs for examined disease indications. in addition, by applying dmap, we propose novel indications for drugs currently in ncats  <cit> .

methods
develop dmap context from existing databases
in dmap, we collected, integrated and ranked each pair of drug-to-protein/gene relationship. the primary data for drug-protein information comes from the stitch  <cit>  database, and may be expanded easily to include other sources such as ctd  <cit>  data. stitch is an aggregated cheminformatics database of chemical-to-protein interactions connecting over  <dig>  chemicals and  <dig>  million proteins for many species mined from biomedical literature. we parsed out stich chemical protein interactions for homo sapiens with those chemical-protein "edge actions" being either "activation"  or "inhibition" . to eliminate the synonymous chemicals with the same chemical structure, we mapped  <dig>  chemicals to the pubchem database in the result of  <dig>  distinct pubchem compound id .

next, we calculated a probability-weighted summary of all the evidence to determine an overall mechanism of "edge action" for each specific chemical-protein interaction using conf.

  conf= ∑i=1i=n*signi) 

where d and p are specific drugs and proteins, respectively. n is the number of evidence for the interaction between d and p. probi is the confidence of each evidence i with a value within the range of  <dig> <cit> . signi has a value of  <dig> if the evidence i represents activation while has a value of - <dig> if the evidence i represents inhibition.

then, to rank each interaction, we used happi  <cit> , an integrated protein interaction database that comprehensively integrated weighted human protein-protein interaction data from hprd, bind, mint, string, and ophid by assigning a weight weight for each drug's interacting proteins using the following formula adapted from  <cit> .

  weight=k×ln∑q∈netconf-ln∑q∈netn 

here, p and q are proteins on the protein interaction network, k is an empirical constant , conf is the confidence score assigned by happi to each interaction between protein p and q, and n holds the value of  <dig> if protein p interacts with q or the value of  <dig> if protein p does not interact with q.

finally, we developed an intuitive pharmacology score  to combine the probability for each interaction and the weight of the interacting proteins:

  p - score=conf×weight 

here, p-score contains both the information of each drug's action on their interacting proteins and the importance of the protein in the protein-protein interaction network. this is different than the expression level based ranking in cmap, which may be more suitable for biomarker discovery instead of drug discovery. with p-score for each drug-protein interaction, dmap is thus in a compatible format with cmap  <cit> .

integrate drug therapeutic indication data
to construct a golden standard of known drug indications to evaluate dmap's drug repositioning performance, we integrated the therapeutic target database   <cit>  and the dataset from the predict  <cit>  paper. ttd is a database that provides information about drugs' known therapeutic protein targets and their targeted diseases. the predict paper provides a compiled list of drug indications. we integrated these two sources to get  <dig>  drug indication associations corresponding to  <dig>  drugs and  <dig> indications.

prepare disease expression signatures and drug expression signatures
to apply the kolmogorov-smirnov algorithms with dmap or cmap for the drug repositioning, we need the disease expression dataset as one of the inputs. we thus retrieved the disease gene expression profiles from pacini c et al.  <cit> 's paper. in total,  <dig> disease associated microarray experiments were compiled to represent  <dig> distinct diseases. according to pacini c's paper, these datasets were obtained from the geo microarray repository  <cit> . the raw cel files were normalized with rma  <cit> . for those gene expression profiles representing the same disease, they were combined with the median rank normalization by warnat et al.  <cit> .

the drug-gene expression datasets were obtained from iorio et al. <cit> 's paper instead of directly from cmap  <cit>  to reduce the batch effect. iorio et al. <cit>  computed a single synthetic ranked list of genes, called prototype ranked list , by merging all the ranked list of the same compound in cmap. only consistently overexpressed/underexpressed genes are placed at the top/bottom of the rpl. this helped capture a consensus transcriptional response for each drug. we thus chose to use the prl to represent the drug signatures from cmap in this study.

design drug similarity measurement
the hypothesis for the drug similarity network approach is: if two drugs were similar, the disease indication for one drug could be potentially assigned to the other drug. to measure the similarity among each drug pair, we computed sim based on the tanimoto coefficient between their interacting proteins .

  sim=|px+∩py+|-|px-∩py-||px∪py| 

here, dx and dy represent the two specific drugs, px represents the set of proteins interacting with dx, py represents the set protein interacting with dy. |px ∪ py| is the number of total distinct proteins in px and py. |px+ ∩ py+| is the number of overlapped proteins on which both drugs have identical interactions . |px- ∩ py-| is the number of shared related proteins on which the two drugs have opposite interactions . sim lies in the range of  with  <dig> representing that the two drugs share the same interacting proteins and the drugs' action on each protein is the same while - <dig> representing that the two drugs share the same proteins but the drugs' action on each protein is opposite.

evaluate the prediction performance
to assess the prediction performance, we implemented the 'guilt by association'  concepts  presented by chiang et al <cit>  and conducted "leave-one-out" cross-validation. for each drug, we removed its known indications and attempted to recover them by considering the indications for its top n similar drugs found. we calculated overall sensitivity and specificity by varying n--the number of similar drugs--from  <dig> to  <dig>  the area under the roc curve  score was used to measure the performance.

implement kolmogorov-smirnov strategy
we implemented the nonparametric, rank-based strategy based on the algorithm originally introduced by lamb et al. <cit>  to generate a ranked list of candidate drugs for each disease. for each disease signature, we computed an enrichment score separately for the up- or down- regulated genes: esup and esdown. in specific, we constructed a vector v of the position of each of the up- or down- regulated genes on the basis of the values from the reference drug dataset. the vector was then sorted in ascending order such that v is the position of disease gene j. the computation of the enrichment score is based on kolmogorov-smirnov statistic and the details can be referred to in the supplementary material in lamb et al.  <cit> . the drug score is set to zero, where esup and esdown have the same algebraic sign. otherwise, we set the drug score to esup-esdown. to evaluate the statistical significance of the score, we applied a permutation approach by randomly selecting any drug signatures and re-calculated the score accordingly. we did the permutation  <dig> times for each drug-disease pair and computed the p-value by checking the actual score with the score distribution after randomization. we hypothesized that those drugs with a statistically significant negative score might be a possible treatment for the disease of interest.

perform literature validation
to check whether the predicted drug-disease pairs have clinical literature evidence, we used the esearch api provided by ncbi. the query term we used is 'drug name and disease name and '. we recorded the total number of clinical type pubmed articles for each association.

RESULTS
drug directionality map  construction
we constructed dmap containing  <dig>  chemical protein interactions for  <dig>  pubchem compound. . compare to cmap  <cit> , dmap shows a 14-fold increase of cid coverage. in addition, dmap cover most of the anatomical therapeutic chemical  categories: 100% at the first level,  <dig> % at the second level and  <dig> % at the third level. this fact is significant if we compare cmap coverage on atc categories: 100% at the first level,  <dig> % at the second level and  <dig> % at the third level. comparing to all the drugs from drugbank, we have  <dig> % in approved group and  <dig> % in experimental group in dmap that exceeding the  <dig> % and  <dig> % respectively in cmap. the protein and drug-protein interaction coverage in dmap does not match to cmap due to cmap is based on the whole protein screening. the dmap most popular atc category distribution is general balance with the drugbank approved drug distribution except for infectious disease and cancer drugs in category j and l in figure  <dig>  the reason for the approved drugs in drugbank little higher rate than dmap in j and l is probably due to the favor of infectious disease and cancer drug discovery in drugbank. we also normalize the score range  between cmap and dmap to perform pearson correlation and the result is  <dig> , which indicates the difference exists between the cell line drug-protein result, and the protein-chemical association and predicted drug-downstream target association in human. figure  <dig> shows the number of shared chemicals between dmap, cmap, and for drugs with known indications which we compiled from the ttd database <cit>  and literature  <cit>  . cmap contains  <dig> drugs with known indications. meanwhile, dmap contains  <dig> drugs with known indication. among these, cmap and dmap share  <dig> drugs, which cover  <dig> % of cmap but only  <dig> % of dmap. cmap only contains  <dig> drugs not covered in dmap; meanwhile dmap contains  <dig> drugs not covered in cmap. thus, we argue that dmap provides a valuable resource for repositioning existing drug for new uses. to demonstrate this, in the following section we applied two representative drug-repositioning methods with dmap dataset and proved its utility for computational drug repositioning.

in figure  <dig>  we show the scale-free characteristics of the drug-protein interaction bipartite network in dmap. here, the drug degree of a drug is defined as the number of proteins interacting with the drug, and the protein degree of a protein is defined as the number of drugs interacting with the protein. the r-square for linear regression in drug degree and protein degree are  <dig>  and  <dig>  , correspondingly.

dmap's utility for drug repositioning
to check dmap's utility for drug repositioning, we applied the following two well-known drug-repositioning methods in literatures:  drug similarity approach  <cit> ,  kolmogorov-smirnov algorithms  <cit> .

dmap outperforms cmap in repurposing using drug similarity approach
we computed  <dig>  pairwise drug similarities for the  <dig> drugs with known indications by calculating the tanimoto coefficient between their interacting proteins profiles and evaluate the prediction performance with "leave-one-out" cross-validation.

we observe that using the drug-protein interaction in dmap, the repurposing performance significantly increases, compared to the performance using the same type of information in cmap. the overall auc for the prediction based on dmap achieved  <dig> . most importantly, early retrieval performed well, with a partial auc of  <dig>  for a specificity of 90% or above <cit> . since one could only test the limited number of drugs in experimental setting, the good performance in high specificity region, approximately corresponding to the top ten candidates of all the predictions, would make the proposed drug repositioning more meaningful in practice.

in comparison, we performed similar analysis based on cmap transcriptome data and the overall auc was  <dig> . the early retrieval performance was only  <dig> . figure  <dig> showed that the roc curve based on dmap was above the curve from cmap.

to rule out the possibility that the performance difference was purely due to the drug coverage difference between dmap and cmap, we conducted the roc analysis with only the shared drugs between dmap and cmap. the dmap achieved an auc of  <dig>  while cmap only achieved an auc of  <dig>  .

out of all the possible drug pairs, we identified  <dig>  significant pairs by requiring the number of overlapped proteins to no less than two and the drug similarity score at the top 5% of the distribution. the resulting drug network showed a scale-free property , commonly observed in a biological network. most of the drugs are well connected and formed communities. in fact,  <dig> drug pairs out of these  <dig>  significant pairs have shared at least one known disease indication. for the remaining  <dig>  pairs without overlapping indications, the novel drug-disease associations from  <dig>  drug pairs were supported by at least one clinical type pubmed article. table  <dig> lists the top  <dig> drug-disease pairs and could be a good starting point for further experimental validations.

dmap outperforms cmap in repurposing using kolmogorov-smirnov approach
we compiled the gene expression profiles for  <dig> distinct diseases and then queried them against dmap and cmap, respectively, to generate a ranked list of potential treatments for each of the diseases of interest. by using dmap drug-protein interaction data, we were able to correctly retrieve the drugs' indications, which were unable to be retrieved using cmap drug-protein interaction data. we examined results for diseases that are the leading causes of death in the us  <cit> . for breast cancer, with the dmap, we successfully retrieved anastrozole, capecitabine, doxorubicin, estradiol, megestrol, paclitaxel, testosterone and testolactone as possible therapeutic drugs for breast cancer. with the cmap data, only paclitaxel was retrieved as a potential therapeutic drug. for lung cancer, we retrieved cisplatin and etoposide by using the dmap. however, when cmap was used, we were not able to retrieve any drugs for lung cancer. additional file  <dig> also contains the results for other diseases. to have statistical significance, we required a p-value of less than  <dig> . cmap did relatively better in the case for alzheimer's disease and leukemia. for these known relationships covered in cmap but not dmap, or vice-versa, some were due to having a borderline p-value while others were due to violating our hypothesis of negative correlation. overall, dmap and cmap database were complimentary to each other.

besides recalling the known drug-disease relationships, with dmap, the kolmogorov-smirnov approach could also propose novel drug-disease associations. national center for advancing translational sciences   <cit>  provides a list of drugs for translational medical research. we cross checked the novel predictions with their drug list. here, we highlight three case studies for vincristine, nifedipine and progestrone. vincristine is a drug typically indicated for leukemia and wilm's tumor. a recent study performed by indolfi et al. <cit>  revealed that there is a potentially higher rate of survival in patients with bilateral wilm's tumor when patients are given a dosage of vincristine/actinomycin d. nifedipine is indicated to treat high blood pressure and angina. the dmap results suggest that nifedipine can also be used to treat asthma. since nifidipine is a pkc inhibitor and pkc is a potential therapeutic target for asthma  <cit> , it is a potential treatment for asthma. cheng et al  <cit>  demonstrated in their study that nifedipine can help control the constriction involved in sensitized tissue in asthma. furthermore, another study by barnes et al <cit>  suggested that nifidipine modifies exercise-induced asthma. progesterone is a prescription drug used for women taking estrogens after menopause and is also used for treating amenorrhea. the dmap results suggest that progesterone can be used to treat breast cancer. in the study by groshong et al  <cit> , it was determined that treatment with progesterone can be used to regulate breast cancer cell growth.

additional file  <dig> summarized all the novel drug repositioning predicted by both similarity approach and ks algorithms, which could be a starting point for further experimental validation.

CONCLUSIONS
reliable measurements of how drugs affect disease proteins is critical to drug repositioning. in this work we presented a computational drug directionality resource called dmap to address the challenges. we demonstrated that the resource can greatly facilitate the drug discovery process for the following reasons: access to disease gene-drug relationship data with high coverage and quality; incorporating prior knowledge about biological significance with protein interaction network.

this study differs from previous research in that it provides a comprehensive database of computationally derived drug-protein relationships. previous efforts  <cit>  on pairing the expression of drugs and diseases mainly rely on experimental connectivity map. for example, sirota et al. <cit>  performed a large-scale integration of expression signatures of human diseases from the public data with cmap drug signatures. this work provides another alternative resource of directed drug-protein relationships. the drug similarity study proves the validity of the probabilistic-based directionality for each drug-protein relationship. the implementation of k-s algorithm proves the compatibility of the pharmacology score based ranking with the expression based ranking in cmap for the drug repositioning research. with these two major drug repositioning approaches, the knowledge base from dmap performed better than directly using the microarray data from cmap. it can thus serve as a valuable resource for drug repositioning studies.

one limitation of dmap lies in that the number of interacting proteins for each drug is not a constant number. for the gene expression based profiles in the cmap database, each drug was measured against the same number of proteins in experiments while in dmap the number of interacting proteins varies from drug to drug. in dmap,  <dig>  drugs have at least  <dig> activated and inhibited proteins. despite this limitation, the database served its purpose for systematic drug repositioning as demonstrated in this work.

another limitation of dmap is the dependency of drug-protein interaction scoring on protein-protein interaction  databases. as mentioned in  <cit> , disease gene ranking should be performed using ppi data not only with reasonable quality but also high data coverage. in this work, we only used the ppi data to calculate the protein weight. therefore, we believe the conclusions above still hold. in other words, we expect time and ppi quality to affect primarily drug-protein data significantly if and only if the drug-protein relationship score is relatively low; when the drug-protein relationship is high - suggesting that there're lots of data coverage for the relationships across many literature reports - the time or ppi quality effect is expected to be relatively small.

competing interests
the authors declare that they have no competing interests.

authors' contributions
hh performed database construction, drug repositioning performance evaluations and predictions, and led the writing of the manuscript under the guidance of jyc. tn, si, zly and ss participated in data analysis and helped with documentation of the case studies. jyc conceived the project, supervised the entire research team with frequent feedback in the design, implementation, and evaluation of the project, and revision of the manuscript. all authors contributed to the completion of the manuscripts.

funding
publication of this article was funded in part by the national institute of health to dr jake chen .

supplementary material
additional file 1
retrieval of known disease drug relationships from dmap and cmap, respectively.

click here for file

 additional file 2
drug repositioning predicted by both similarity approach and ks algorithms. note: in both files, the star rating is labelled according to the following criteria:

k-s score<- <dig> : «««««

- <dig>  ≤ k-s score<- <dig> : ««««

- <dig>  ≤ k-s score<- <dig> : «««

- <dig>  ≤ k-s score<0: ««

k-s score ≥  <dig> or p-value ≥  <dig> : «

click here for file

 acknowledgements
we acknowledge the support of indiana center for systems biology and personalized medicine during the design and implementation of the project. our database servers and web applications are hosted and maintained with the generous support of indiana university information technology and support group.

this article has been published as part of bmc bioinformatics volume  <dig> supplement  <dig>  2015: proceedings of the 12th annual mcbios conference. the full contents of the supplement are available online at http://www.biomedcentral.com/bmcbioinformatics/supplements/16/s <dig> 
