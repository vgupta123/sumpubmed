BACKGROUND
the identification of tandem repeats exhibiting or with the potential to exhibit length variation is of considerable importance to medical and evolutionary-based research. repeat variability may be associated with important phenotypes. lack of changes in repeats between evolutionarily distant species may reflect high functional constraint, suggesting the functional importance of repeats within a given genomic region. denoeud and vergnaud  <cit>  have described a web-based resource  <cit> , which displays pre-computed tandem repeat length variations among bacterial strains. another resource is trdb, tandem repeats database  <cit> . this versatile resource allows users to upload sequences, detect tandem repeats using the tandem repeats finder algorithm and perform actions such as extracting flanking sequences and predicting primer sequences. in particular, trdb provides a graphic viewing of internal variations along the tandem array in a coordinated way for multiple alleles. here, we present software that allows users to upload and detect tandem repeats, but that is primarily concerned with the prediction and detection of tandem repeat copy-number variation and resulting length polymorphism.

our objectives were to provide software for researchers interested in studying variable numbers of tandem repeats . we set out to provide a platform for comparing available sequences to rapidly identify repeat copy-number variants within tandem repeats , and to provide predictors of polymorphism .

both vntrfinder and polypredictr are written in perl and designed to run in unix. the tandem repeats finder   <cit>  and e-pcr  <cit>  programs are called by these scripts and their results are parsed and included in the final output. trf is commonly used to detect repeat in nucleotide sequences. it identifies likely tandem repeats by looking for clusters of small matching words  separated by a common distance. dynamic programming alignment is used to confirm a repeat and yields a consensus pattern and tandem array. parameters allow modification of the alignment weights, minimum alignment score to report, and maximum pattern size detected. e-pcr is a program commonly used to recover sequence-tagged sites  by searching for sub-sequences that closely match the pcr primers for these sites. if these sub-sequences have the correct order, orientation and spacing and could thus presumably lead to the amplification of a pcr product of the correct molecular weight, the match is reported. the scripts that call trf and e-pcr are implemented online through a cgi interface and are also available for download. web graphics are generated in html where the width of the images is proportional to the length of the tandem repeat with respect to the overall length of the sequence.

implementation
program: vntrfinder
vntrfinder uses the trf program  <cit>  to detect repeats. both variant and invariant repeats are reported, the former defined as a tandem repeat from a reference sequence that is found in a target sequence by vntrfinder and observed to be of different length. the e-pcr  <cit>  program is used to match known repeat regions in a query sequence to the apparently matching region in the target. the program permits variation in the length of the chosen flanks, and the number of permitted mismatches. the e-pcr wordsize parameter is set to  <dig> so that a maximum number of candidate matches are considered. the user can specify trf repeat detection parameters and paste or upload two files with sequences of interest. the first file contains the reference sequence, the second the target sequence – the sequences across which to look for repeat variation, of which an unlimited number can be entered. trf is run on the reference and any redundancy from overlapping repeats is eliminated according to the method described by denoeud and colleagues  <cit> . for vntrfinder, flanking regions of each tandem repeat identified in the reference sequence are then aligned to the related regions of target sequence. for cases where there is one reference and one target sequence, there is the option to automatically run the search in the reverse direction.

for computational efficiency, the method implemented requires that there are no insertions or deletions in the tr flanks. this has the drawback that for more distantly related homologous repeats, the program will miss them. this feature of our approach will be disadvantageous in certain contexts, i.e. when the flanks of tandem repeats are strongly diverged, and contain indels. however, for many practical applications this is not a major issue: where it is a problem, the alternative blast based approach of denoeud and vergnaud is more optimal.

a mismatch parameter defines the number of permitted mismatches in flanking sequences. in locating the best matching sequence, a search is conducted by starting with zero mismatches, which is increased, if necessary, until a single, unambiguous match between reference and target sequences is obtained, or until the value for the maximum mismatches permitted is reached. if two regions of an identical degree of base similarity are detected, then the results are excluded. the motivation for taking this approach, rather than systematically extending the repeat flanks until an apparently unique orthologous region is defined, was as follows; a search of  <dig>  repeats from the human genome against itself with a flanklength of  <dig> revealed approximately 2% that had more than one match. a simple expectation would be ~ <dig> × 10- <dig>  since the great excess of such matches are likely to represent recently duplicated regions of the genome, simply extending the flanks to find the better of the two matches may be prone to erroneous matching of paralogous regions. by avoiding such extension the user is less likely to be misled by such mismatches. in our experience with the smaller bacterial datasets, systematic extension of flanks to identify a match had little effect on the ability to match many additional trs.

the speed of vntrfinder decreases with the number of sequences being searched against; as each repeat in the references is searched against each target sequence, the more targets, the longer the search will take because each reference repeat must be searched against each target. for instance, a search of tandem repeats across the genome of mycobacterium tuberculosis h37rv against the genome of mycobacterium tuberculosis cdc <dig> took approximately  <dig> minutes for a dataset of  <dig> repeats detected using tandem repeats finder default parameters. when mycobacterium bovis was added as an additional target sequence, the search time increased to  <dig> minutes and when mycobacterium leprae was added as another target, the search time increased to  <dig> minutes computational time. also, increases are proportional to the degree of evolutionary divergence of the tandem repeat flanks

it is possible to scan the identified related region of the reference sequence between the flanks for repeats using trf to enrich for length variations that represent a genuine tandem repeat array length difference rather than alternative splices, genome rearrangements etc. this is done by specifying to keep results where the hit "represents length difference consistent with change in the repeat copy-number" is selected. in this instance, the repeat unit length and motif will be the same in both reference and target . specifically, the sequence of the hit is scanned with trf and tandem repeats are checked to ensure that the observed copy-number agrees with the expected one, given the length of the hit tandem array and the length of the repeat unit as follows:

for cases where the length of the hit tandem array is greater than that of the reference, we calculate i, a measure of the inconsistency of the variant with any multiple of the repeat copy number. this is calculated as

i=expv−obsvexpv−obsr
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgjbqscqgh9aqpdawcaaqaaiabdweafjabdiha4jabdchawjabdafawjabgkhitiabd+eapjabdkgaijabdohazjabdafawbqaaiabdweafjabdiha4jabdchawjabdafawjabgkhitiabd+eapjabdkgaijabdohazjabdkfasbaaaaa@4533@

when the length of the hit is shorter than that of the reference, this is represented as

i=expv−obsvexpv
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgjbqscqgh9aqpdawcaaqaaiabdweafjabdiha4jabdchawjabdafawjabgkhitiabd+eapjabdkgaijabdohazjabdafawbqaaiabdweafjabdiha4jabdchawjabdafawbaaaaa@3f36@

where expv is the expected copy-number for the variant , obsv is the observed copy-number for the variant, as estimated by trf, and obsr is the observed copy-number for the reference repeat. this gives a distribution close to  <dig> for variations consistent with a change in repeat copy-number and close to  <dig> for other variants. only variants with a value of i below  <dig>  are retained. the equations serve to describe how closely a length variant matches the expected lengths seen from changes that represent precise changes in copy-number. the cut-off chosen is arbitrary, however, the vast majority of datapoints lie quite close to  <dig> or  <dig>  and therefore alternative choices of the chosen cut-off are unlikely to alter the results obtained. it is important to note that this option represents a stringent search for repeat variation. the option to search for other types of variations is thus also provided, which identifies significantly more matches.

descriptive statistics are gathered to describe the reference repeat and the extent to which the repeat varies across the reference and target sequences. these are the identifier of the reference sequence containing the repeat, the repeat unit length and tandem array length, the repeat unit sequence and tandem array sequence, the start and stop coordinates of the repeat in the reference sequence, the repeat copy-number, the left and right flanking sequence of the repeat, the total tandem array length of the reference repeat and all the hits, represented as a "population" of tandem array lengths, e.g. 26|28| <dig>  and the number of mismatches tolerated in aligning the flanks to the target sequence.

summary statistics that describe variability detected are also provided. these include a simple binary metric describing whether or not a repeat was observed to be variable and also a heterozygosity score  that describes the variability of the repeat in the population of sequences analyzed. the standard deviation of the heterozygosity is also given, which is clearly excessively large in the case of a variant detected between only two sequences, but becomes a useful statistic to establish the reliability of the heterozygosity in the situation where the user has as input a large number of sequences, which have a large number of allelic variants. the standard deviation and standard error of all observed tandem repeat array length alleles is also provided, which provides an indication of the spread of allele sizes. in many cases, the heterozygosity is not particularly informative unless derived from a large sample size and therefore close attention should be paid to the standard error of the repeat array length alleles. the lengths of all unique tandem array lengths and their frequency of occurrence are also provided. examples of the output files can be viewed on our website.

program: polypredictr
polypredictr predicts potentially polymorphic tandem repeats using simple rules previously described  <cit> . the first set of rules, described by wren and colleagues  <cit>  use information on the length of the tandem repeat, its homogeneity and the copy-number of the repeat unit to predict polymorphism. specifically, if a repeat is 100% homogenous , the copy-numbers  <dig>   <dig> ,  <dig> ,  <dig> ,  <dig>  and  <dig>  represent thresholds beyond which the repeats of unit length  <dig>   <dig>   <dig>   <dig>  5– <dig> and >= <dig> are predicted to be potentially polymorphic, respectively. if all units are not identical, these rules may not be applied. an earlier implementation of these rules does tolerate imperfect repeats   <cit>  but has higher false positive rates. these rules are also implemented by polypredictr. the second set of rules, described by naslund and colleagues  <cit>  uses a larger number of criteria as a predictive model. these include copy-number, entropy , gc dinucleotide bias and percentage match between repeats in the tandem array. these very simple rules provide a crude indicator, but the authors' validations of their efficiency have been relatively limited. therefore, the utility of these predictors are not well understood and should be treated with some caution. other attempts to understand the relationship between polymorphism and repeat sequence characteristics have had limited success, highlighting the difficulty of obtaining a set of rules applicable and relevant to all genomes  <cit> . notably, it has been shown that sensitivity of various measures, such as the total length of the tandem repeat, the percentage matches between adjacent copies of the repeat unit, and the gc content of a tandem repeat, while significant predictors of polymorphism, can vary in their predictive power between different species  <cit> .

RESULTS
vntrfinder: comparison to denoeud and vergnaud method
we compared vntrfinder results to those of denoeud and vergnaud  <cit>  for a comparative survey of two strains of the prokaryotes mycobacterium tuberculosis  and neisseria meningitidis . the settings for vntrfinder were as follows: trf minscore, match, mismatch, indel and maxperiod scores set at  <dig>   <dig>   <dig>   <dig> and  <dig> respectively. a number of different flanklength, mismatch and hit retention parameters were evaluated and the results were compared to both the results of denoeud and vergnaud and to the original dataset of repeats detected .

the first observation  is that for the repeats that were successfully matched by both methods in mycobacterium tuberculosis, they agreed quite strongly in their definition of whether or not they were variant  for vntrfinder variants also classified as variants by the denoeud method.

for the more distantly related neisseria meningitidis comparison, vntrfinder again matches more repeats  . in comparison to the mycobacterium tuberculosis search, fewer vntrs identified by denoeud and vergnaud are also detected by vntrfinder  . this is most evident when the check to retain only repeat variants that are consistent with a change in copy-number is applied . there is also an increase in the percentage of repeats reported as variant by denoeud but as invariant by vntrfinder.

why does vntrfinder miss some of the repeats reported by denoeud and vergnaud? this appears to be mainly due to the presence of gaps in the flanks. vntrfinder does not tolerate gaps when matching flanking sequences to a target sequence. by matching flanking sequence  between the neisseria meningitidis species based on the coordinates reported by denoeud and vergnaud, we found that 42%  of repeats that were successfully matched between species using vntrfinder had gaps whereas 56%  of repeats not successfully matched had. if we consider only repeats with no gaps in the flanking sequences when matched between species, then our method detects 91%  of repeats detected by denoeud and vergnaud . in terms of variants shared between datasets, when there are no gaps in the flanks, we identify 75% of their variants whereas we only identify 27% when there are gaps. thus, vntrfinder is better suited to matching homologous repeats with reasonably stable flanking sequences. the example comparison between the highly diverged strains of neisseria meningitidis is likely to be close to or well beyond, the limits of evolutionary distance that is of interest to most researchers; we included this extreme example to clearly highlight the operational differences between different search strategies.

a number of repeats in neisseria meningitidis  were detected by both methods, but were reported as variant by one method but not by the other. dot-plots were made of the sequences involved in these  <dig> incongruent classifications . of the two variants detected by vntrfinder that denoeud failed to detect, in one case there was a conflict in the choice of homologous segments, in the other the variant was an indel in the array flank/repeat boundary. of the  <dig> that denoeud detected and vntrfinder did not,  <dig> represented a conflict in choice of homologous segments,  <dig> involved length variants that did not lie within the repeat array  and  <dig> involved indels at the flank/repeat array boundary. thus, most of these conflicting results highlight regions that are difficult to compare.

we compared the results of vntrfinder to  <dig> previously reported markers that were variant between mycobacterium tuberculosis strains h37rv and cdc <dig> . for all but one of the markers, vntrfinder also reported them as variant and the reported length difference was identical. the marker missed, mtub <dig>  is among the  <dig> markers that were noted as being problematic  <cit> , i.e. repeat variant where the repeat unit is difficult to define. the denoeud et al.  <cit>  web resource  <cit>  reported all  <dig> as variant. the same  <dig> of the  <dig> markers invariant between mycobacterium tuberculosis h37rv and cdc <dig> according to le fleche et al.  <cit>  were reported as invariant trs by both methods. one – miru <dig> – was not reported as a detectable tr by either method. this is not surprising since only one repeat unit is present in the two mycobacterium tuberculosis strains  <cit> . in general, repeats reported by either the denoeud or vntrfinder methods were shorter than those reported by the le fleche study because of the parameters used to detect tandem repeats with the trf algorithm.

vntrfinder: general considerations
as with any alignment method, it is important to stress that parameter choice for flanks and mismatch tolerance should reflect the relationships between the sequences being analysed. for instance, if the user is analyzing sequences from two different genomes where the divergence rate is high, some repeats may be missed. therefore, if the user is interested in a specific repeat and it has not been reported, possibly as a result of the emergence of indels in the flanking sequences, we recommend decreasing the flank length and/or also increasing the mismatch tolerance. these parameter choices will increase the time needed for the search to complete but will increase the likelihood of obtaining a hit, particularly in the case of the flank length choice, as shorter flanks are less likely to overlap sequences containing gaps between the sequences being aligned. for instance, if comparing mammalian sequences of around 80% identity, flanklength and mismatch parameter settings of  <dig> and  <dig> might represent more appropriate defaults for searching.

program: polypredictr
there are a number of caveats to the use of these rules. firstly, the rules were inferred from human variants and thus may not necessarily hold for other species; secondly, many observed variants do not qualify with these rules because even very short repeats  have been observed to be variant  <cit> ; thirdly, many predicted variants may not be variant, with approximately a third of the predictions not being commonly variant using the wren et al. rules  <cit> , and fourthly, rules present by naslund and co-workers  <cit>  only pertain to the prediction of potentially polymorphic repeats of units of six or more bases in length. nevertheless, the rules serve as an initial guide and have some predictive power. they are therefore integrated with vntrfinder on our web server in addition to being provided as a separate standalone application. for example, all  <dig> loci reported by  <cit>  that were not polymorphic between mycobacterium tuberculosis h37rv and cdc <dig> were also reported as invariant by vntrfinder. we investigated which repeats would be predicted to be variant between these two strains; of  <dig> repeats with unit length longer than  <dig> bp,  <dig> were predicted by the wren et al. rules as being polymorphic.  only  <dig> %  were predicted as polymorphic by either these rules or the pompous earlier implementation of these rules  <cit> ). among the  <dig> known repeats reported as variant between mycobacterium tuberculosis h37rv and cdc <dig>  <cit>  and detected by vntrfinder,  <dig> were predicted as variant by the wren rules and an additional  <dig> were predicted as variant using the pompous rules. thus, in total,  <dig> of the  <dig> repeats  were predicted by either method to be polymorphic. thus, in spite of the fact that the wren and pompous rules were designed for mammalian genomes, they may have some more general utility, since they seem to favour repeats chosen by mycobacterium tuberculosis researchers. the two advantages of the naslund approach are firstly that it provides the probability that the tr is variable, rather than a binary score; secondly, it is trained specifically on minisatellite repeats, so that it may well provide a better prediction than the wren et al rules, though obviously it is restricted to trs with a unit length of  <dig> or greater.

in light of the above, we recommend vntrfinder and the identification of variation by matching repeats between homologous sequences as a more robust approach to detecting potential repeat polymorphisms, but in the absence of such sequences, polypredictr is an available useful tool for indicating the potential polymorphism of a repeat.

a visual overview of results highlighting repeats, variant repeats and potentially polymorphic repeats is also provided from which users can link to the relevant results files.

CONCLUSIONS
vntrfinder compares well to an existing resource of repeats matched between bacterial species  <cit> . the software is available to run on data for which no pre-computed results are available on the web, and uses software that is more adept at aligning low-complexity regions  <cit> . the particular method applied is complementary to that used in generating existing pre-computed datasets, missing some variants detected by the denoeud method, but detecting other variants. in practice, a completely exhaustive search for repeat variants is rarely practical, since in the twilight zone of similarity it is difficult to distinguish efficiently between truly homologous and independent repeats. in essence, the blast approach relies on longer range similarity around the repeats, and our method relies on very local similarity. in sequences prone to substantial short range re-arrangement, such as promoter regions, and in low complexity regions our method may prove more efficient, while in more stably evolving sequences the blast approach is likely to be more sensitive. vntrfinder allows filtering to only report repeat variants representing length changes consistent with changes in the copy-number of the tandem repeat unit detected in the reference, as in  <cit> , with the additional check that the bases differing in the insertion/deletion event actually correspond to the tandem repeat unit. the method can also consider multiple sequences and estimate heterozygosity for a tandem repeat locus. together, these resources will assist in the identification of potentially polymorphic tandem repeats or repeats variable among homologs, paving the way for experimental confirmation and functional analyses of the implications of this variability.

availability and requirements
project name: vntrfinder and polypredictr

project home page: 

operating system:  web interface,  unix/linux ,  windows 

programming language: perl

other requirements: downloadable versions require perl

licence: gnu gpl

authors' contributions
cto developed and tested the programs. dcs assisted with program design and the writing of the manuscript. both authors read and approved the final manuscript.

supplementary material
additional file 1
incongruent results for vntrfinder versus the method described by denoeud et al.  <cit> . dot-plots for  <dig> instances of differences in reported variability between the two methods in neisseria meningitidis from a total of  <dig> repeats matched between methods.

click here for file

 acknowledgements
we thank norman davey for assistance in the design of web graphics. this work was supported by the programme for research in third level institutions, administered by the higher education authority of ireland.

figures and tables
* vntrfinder settings are given respectively in parentheses as the flanklength allowed, mismatch allowed, and whether or not repeat length differences from the query were required to be multiples of the tandem repeat unit.

** totals shown are those that align perfectly with the flanks of a repeat originally reported by trf.

proportions of total repeats originally detected in neisseria meningitidis mc <dig> and mycobacterium tuberculosis cdc <dig> that were successfully matched by the different methods to neisseria meningitidis z <dig> and mycobacterium tuberculosis h37rv respectively. 'all variants' refers to the vntrfinder option to report any detected variation and 'multiple of unit' refers to the option to only report variations where the length variation is consistent with a change in the repeat copy-number. the number of variants detected is also highlighted.

* '+/-' indicate repeats reported as variants/non-variants.

repeats were matched between the results reported by vntrfinder and those reported by the method of denoeud and vergnaud.
