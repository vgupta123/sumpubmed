BACKGROUND
the functioning of a living cell is governed by an intricate network of interactions among different types of molecules. these interactions transduce external signals, control gene expression, protein synthesis and localization, chemically modify protein activities, and drive metabolic and biochemical reactions. considerable effort in molecular and cellular biology has been expended over the last  <dig> years by individual research groups on testing and detecting interactions on a small scale. the results of these experiments are enshrined in the literature. in the last few years, a number of efforts have manually curated the literature and created databases of these interactions  <cit> . more recently, the genomic revolution has inspired the development of experimental technologies that can detect interaction networks in a high-throughput manner and on a genome-wide scale. for example, the yeast 2-hybrid screen has been scaled up to unveil protein-protein interaction networks containing tens of thousands of interactions in a number of organisms  <cit> . in a similar vein, the chromatin immunoprecipitation on a microarray  technology allows the detection of the targets of a specified transcription factor on a genome-wide scale  <cit> . these developments have made molecular interaction networks pervasive in systems biology.

concomitantly, a number of computational approaches have been developed to analyze networks and their properties. foremost among them are methods to reverse engineer gene regulatory networks by integrating gene expression data with other types of ’omic data  <cit> . such interactions usually relate the expression of a gene to that of other genes in the cell  <cit> . another broad class of methods overlay gene expression data for a condition on the wiring diagram to compute the cell’s response network for that condition  <cit> . networks of these types can contain hundreds or thousands of nodes and an order of magnitude more edges. for example, the b-cell interactome  <cit> , a network of experimentally verified or computationally predicted protein-dna, protein-protein, and transcription factor-modulator interactions, contains nearly  <dig> nodes and over  <dig>  edges. it is often desirable to summarize the biological information in such networks. a very common approach is to perform enrichment analysis of the terms in some catalog such as the gene ontology  <cit> . enriched functions and processes are very useful in summarizing the main biological themes of a large network at a high level, as a preliminary to more detailed mechanistic studies. when applied to reverse-engineered or response networks, a major drawback of functional enrichment is that it ignores information about the edges in the network being analyzed, i.e., it treats the network simply as a set of genes. therefore, a function may appear to be enriched in a network, but the genes annotated with that function may be highly disconnected within the network. in such cases, it is difficult to interpret the relevance of that function to the network.

in this paper, we introduce a novel method for functional enrichment that explicitly takes network interactions into account. our approach naturally generalizes fisher’s exact test, a widely-used gene set-based technique. we use the sequence of sizes of the connected components of the network to estimate its degree of connectivity. we estimate the statistical significance of this connectivity empirically by a permutation test.

it may be argued that one approach that mitigates the drawback of using gene set enrichment on networks is to find clusters within the network and then compute enriched functions within them. since clusters are usually densely-connected, enriched functions are likely to induce connected subgraphs within clusters. our approach is distinct from finding enriched functions in clusters. clustering algorithms typically compute dense subgraphs. in contrast, we detect subgraphs  that are more connected than may be expected at random. in our results, we show examples of subgraphs that clustering algorithms may not detect.

we showcase three applications of our approach: i) determine which functions are enriched in a reverse-engineered network, ii) given a network and a response sub-network of genes within that network, determine which functions are enriched in the sub-network, and iii) given two experimentally derived networks, determine the functions for which the connectivity improves when we merge the second network into the first. these analyses use data from three different species . they demonstrate that our conceptualization of network-based functional enrichment is a powerful framework for addressing a diverse variety of interesting biological questions about molecular interaction networks.

formulation of functional enrichment
the problem of functional enrichment is usually formulated as follows. we have a universe u of genes and an “interesting collection” c ⊂ u of genes. we desire to evaluate the functional coherence of c based on the annotations of the genes in it. to this end, we have access to a set f of biological functions. for each function f ∈ f, let uf ⊆ u denote the set of genes annotated by f. furthermore, let cf = c ∩ uf denote the subset of genes in c that are annotated by f. we will use lowercase letters to denote the cardinalities of the corresponding sets, which are named by uppercase letters. see figure  <dig>  for an illustration. the standard formulation of functional enrichment in terms of the one-sided version of fisher’s exact test asks the following question:

if we select a set x of uf genes uniformly at random  from the set of all genes u, what is the probability that x ∩ c will contain cf or more genes?

thus, we are interested in the probability that a random set of uf genes would contain cf or more genes from c. as is well known, we can compute this probability by:   

now let us consider the setting in which network-based functional enrichment is relevant. we are given an undirected graph g = , where u is the set of all genes  and i is a set of edges. we are also given a subgraph h =  of g, where c  is a subset of u, and j is a subset of i. note that h may not be the subgraph of g induced by c, i.e., some edges of i that connect node pairs in c may be missing from j. given a function f, define hf to be the subgraph of h induced by the genes in uf ∩ c, i.e., the subgraph of h induced by the genes that are annotated by f. we desire to use statistics of hf to estimate whether the function f is enriched in h or not. this concept is illustrated in figure  <dig> . intuitively, even if hf is highly disconnected, existing methods may declare f to be highly enriched in h. however, it is difficult to interpret the biological relevance of such a function. therefore, we would like to incorporate the connectedness of hf into its evaluation.

ideally, f is highly statistically significant if hf contains only one connected component, and f is statistically insignificant if hf contains only singletons . we define the size of a connected component as the number of nodes in that component. suppose hf has m connected components whose sizes are a <dig>  a <dig> …, am, where ai ≥ ai+ <dig>   <dig> ≤ i <m. using the abbreviation “cs” for “component sizes,” we will use cs to denote this non-increasing sequence of numbers. we would like to estimate the statistical significance of f in terms of cs. if x is a subset of u, we abuse notation and use hx to denote the subgraph of h induced by x. drawing a parallel with the formulation of functional enrichment in the network-free case, we pose the following question:

if we select a set x of uf genes uniformly at random  from the set of all genes u, what is the probability that cs ≥ cs?

clearly, answering these questions requires that we define how we can compare different values of cs(), i.e., decide if one sorted sequence of connected component sizes is “greater than” another. note that two distinct subsets x and y of u may induce different subgraphs of h  that have the same sequence of component sizes. conversely, hx and hy may have the same number of nodes, yet cs and cs may be vastly different.  it appears difficult to determine the null distribution of cs analytically. thus, we developed two sampling-based approaches, discussed in “methods”, to compute the statistical significance of cs empirically.

methods
as before, let g =  be a network whose nodes are the universal set of genes and let h =  be a network whose nodes are the interesting collection of genes. we sometimes refer to g and h as the universal network and the interesting network, respectively. let hf be the subgraph of h induced by the nodes annotated with function f.

first, we elaborate on our method for comparing different values of cs(), i.e., sorted lists of network component sizes. next, with a method to compare subnetworks in hand, we proceed to compute the statistical significance of cs empirically using two sampling-based approaches.

comparing sequences of component sizes
let a = {a <dig>  a <dig> …, am} and b = {b <dig>  b <dig>  …, bn} be sorted sequences such that ai ≥ ai+ <dig> for  <dig> ≤ i <m, and bi ≥ bi+ <dig> for  <dig> ≤ i <n. since the ai’s and bi’s represent component sizes, we assume all values are positive. if m <n, we pad a with zeros by setting ai =  <dig> for m <i ≤ n. we pad b similarly in the case that n <m.

now, we naturally define a = b if and only if ai = bi for all  <dig> ≤ i ≤ max. otherwise, we define a <b if and only if there exists some index i,  <dig> ≤ i ≤ max, such that ai <bi, and aj = bj for all j <i. if neither of these cases hold, we say that b <a. essentially, we walk along a and b simultaneously  until we find an index i where ai ≠ bi. the smaller sequence is the one that contains the smaller of those two values.

function randomization
the function randomization approach for computing the statistical significance of cs parallels the sampling-based alternative to the analytical solution for the one-sided version of fisher’s exact test . in the sampling-based solution for fisher’s exact test , we repeatedly select a set x of uf genes uniformly at random from the universe of genes u. we then calculate an empirical p-value for the function f, which represents the statistical siginificance of the size of cf, as the fraction of samples for which |x ∩ c| ≥ cf, i.e., the size of the intersection between the randomly selected set x and the interesting collection of genes is at least as large as cf. if we repeat this process many times, the empirical value converges to the analytical value computed by equation  <dig> 

in the case of network-based enrichment, we have not been able to derive the null distribution of cs analytically. therefore, we apply a sampling-based algorithm similar to the one used in the non-network case. we repeatedly select a set x of uf genes uniformly at random from the universal genes u. at each iteration we compute the subgraph of h =  induced by genes in x ∩ c and call this subgraph hx. we calculate the p-value for f as the fraction of random choices of x for which cs ≥ cs. this p-value is an empirical estimate of the probability that the intersection between the interesting network and a randomly-selected subgraph of the universal network is more well-connected than hf.

this network-based formulation of functional enrichment strongly parallels the traditional non-network formulation. in fact, notice that if we remove all edges from g and from h, the network-based solution is exactly the same as the one-sided version of fisher’s exact test. in this sense, we generalize a standard functional enrichment approach for gene sets to networks induced by sets of genes.

network structure randomization
the function randomization approach for computing network-based functional enrichment tests the dependency of cs on the size of the set of genes annotated with f. however, hf also depends on the specific interactions present in the underlying universal network g = . to test the dependence of cs on g, we developed a separate method that relies on randomizing the structure of g. we use the following algorithm  <cit>  to generate a randomized universal network with the same degree sequence as g, i.e., the degree of each node is the same in g and in the new network. this algorithm preserves topological properties of molecular interaction networks, such as their scale-free degree distribution.  

the first if statement in randomize prevents the algorithm from producing self-loops in the random network. the second if statement ensures that the edges to be added do not already exist in i′, thereby keeping the resulting graph simple. we perform the edge swap randomization for k|i| iterations, where k is an external parameter to this algorithm. we set k =  <dig> for all analysis presented in this paper. we determined this value for k by running randomize with multiple values of k on the networks discussed in “results”. for each value of k, we analyzed the distribution of the overlap between the edges in a random network and the original network. increasing k beyond  <dig> did not show any significant change in this distribution  for any of the original networks.

in order to assess the significance of cs for each function, we repeatedly generate a randomized universal network g′ = randomize. let h′ =  be the subgraph induced in g′ by the genes in c, and let  be the subgraph of h′ induced by the genes annotated with function f; h′ and  are subgraphs of g′ in the same fashion as h and hf are subgraphs of g. we calculate the p-value for each function f as the fraction of iterations  for which . this p-value indicates the probability that the genes in hf are more connected after randomly shuffling the edges in g  while maintaining the degree sequence of g.

combining p-values
we developed the function randomization approach because of its strong ties to the standard way we interpret functional enrichment. furthermore, it can be expressed as an extension of the one-sided version of fisher’s exact test. this approach is an attempt to answer the following question: “given a function f that annotates uf genes, what is the probability that a randomly-selected set of uf genes will have a more connected intersection with the interesting genes than hf does?”.

as an alternative, we developed the network structure randomization approach because we were interested in a strictly network-based formulation of functional enrichment. this approach is an attempt to answer a very different question from the previous method: “given a function f, what is the probability that the subgraph induced by genes in cf will be more connected in a network chosen uniformly at random from the set of all networks with the same degree sequence as g?”.

in this paper, we only consider those functions deemed well-connected by both approaches. thus, we assign a p-value for each function that is the maximum of the two p-values from each of the two approaches. in the rest of the paper, unless stated otherwise, the p-value for a function refers to the maximum of the p-values computed by both approaches.

RESULTS
we present applications of our methods to three different interaction networks, each for a different organism. in the first application, we identify biological processes from the gene ontology   <cit>  with significant network-based enrichment in the human b cell interactome  <cit> . in the second application, we discuss gene sets from the molecular signatures database  <cit>  that are deemed significantly enriched in a response network that represents the differences between collagen sandwiches and hepatocyte monolayers, two widely-used systems to culture rat hepatocytes  <cit> . in the third application, we discover go biological processes whose network-based enrichment improves when we add a collection of genetic interactions in s. cerevisiae that were identified in a large-scale study conducted by krogan et al.  <cit>  to the biogrid network  <cit> .

each of these three applications of network-based enrichment showcases how our methods can be used in a different manner: i) determine which functions are enriched in a given network, ii) given a network and an “interesting” sub-network of genes within that network, determine which functions are enriched in the sub-network, and iii) given two networks, determine the functions whose connectivity improves by merging the second network into the first. these three applications ask different questions about the functional enrichment of an interaction network, each of which we can answer using the framework presented in “methods”.

we used the synergizer  <cit>  to generate all gene and protein identifier mappings. we visualized all networks using cytoscape  <cit> .

b cell interactome
to analyze functions enriched in human b cells, we applied our methods to the b cell interactome   <cit> , which incorporates three different types of interactions: protein-protein, protein-dna, and transcription factor-modulator. the bci includes both experimentally verified and computationally predicted interactions  <cit>  in human b cells. protein-dna and transcription factor-modular interactions are directed. for the purposes of this work, we treated them as being undirected. we removed repeated edges and self-loops from the bci, resulting in an interaction network with  <dig> nodes and  <dig>  edges. we applied our network-based enrichment methods to identify go biological processes enriched in the bci. after downloading functional annotations from the go website  <cit> , we applied the true-path rule to the annotations, i.e., if a gene was annotated with function f, we ensured that it was also annotated with any ancestors of f in the go directed acyclic graph.

recall that our enrichment methods require a universal network g and an interesting network h. since we were simply interested in the set of functions enriched in the bci, we let both the universal network and the interesting network be the bci. notice that the standard formulation of gene set enrichment  will assign a p-value of  <dig> to every function, since the size of the interesting set of genes and the size of the universe are equal . as a result, we cannot compare our method for discovering enriched functions to the set-based fisher’s exact test for this application. however, our approach assigns non-trivial p-values to several relevant functions, as we show below.

we computed p-values by executing each random sampling approach  <dig>  times. we retained those functions that annotated at least five genes in the universal network and no more than  <dig> genes in the interesting network, resulting in a collection of  <dig> go biological processes. of these,  <dig> processes received a network-based enrichment p-value of less than 10– <dig>  which is the smallest empirical p-value possible over  <dig>  iterations. next, we present three significantly-enriched functions and discuss their relationship to the b cell interactome. the goal of this analysis is to demonstrate that network-based enrichment methods were capable of finding meaningful functions in a network associated with a specific cellular context. figure  <dig> illustrates the subnetwork induced by the genes annotated with each of the three functions. in other words, each of the networks in figure  <dig> is a visualization of the subgraph hf corresponding to one of three discussed functions. these figures only retain nodes that are incident on at least one edge. while we do not incorporate the directionality of the protein-dna and transcription factor-modulator interactions in our methods, we considered the directionality when visualizing the results. we discuss functions that were ranked  <dig>   <dig>  and  <dig> overall. note that  <dig> processes received the smallest p-values. hence, all of them have the rank of  <dig>  we observed that a majority of these functions were related to protein phosphorylation and kinase signaling cascades. the term we discuss next is one that we could relate to b-cells based on the proteins annotated by that term.

protein-dna complex assembly
the go term “protein-dna complex assembly”  was enriched in the bci with a p-value of less than 10– <dig> . figure  <dig> demonstrates that the genes annotated by this function form several densely-connected subgraphs. a clustering algorithm may have detected each individual subgraph but may not have included all of them in a single cluster. thus, the term “protein-dna complex assembly” may be determined to be enriched  in the results of a clustering algorithm only if the clusters were themselves further grouped during a post-processing procedure.

the genes in the subgraph induced by this function are associated with various aspects of the aggregation and binding of proteins with dna molecules to form a protein-dna complex. for example, the nine hist and four h2a proteins are grouped together. dna wraps around the histones, forming higher-order complex protein-dna subunits. many eukaryotic genes contain a dna signature in their promoter region known as the tata box. these genes rely on the ordered assembly of rna polymerase ii and several initiation factors at the tata box. the ten polr genes that form a clique encode different subunits of rna polymerase ii. the eight densely-connected general transcription factors  serve as initiation factors for rna polymerase ii. the eleven neighboring taf genes perform a similar role. this function was likely determined to be enriched because of the hub transcription factor myc, which serves as a bridge between these densely-connected sub-networks. since myc is responsible for regulating many other genes, irregular expression of myc has been linked to several cancers, and some studies have identified this gene as a potential cancer drug target in humans  <cit> .

lymphocyte activation
we found the term “positive regulation of lymphocyte activation”  enriched in the bci with a p-value of 10– <dig> . we expected to discover this function as enriched in the bci: since b cells are a specific type of lymphocyte, up-regulation of lymphocyte activation is an inherent property of genes in the bci. our methods were capable of determining not only that many genes related to lymphocyte regulation appear in the bci, but that there was a rich interconnectivity among these genes. figure  <dig> illustrates that the signal transducer and activator of transcription  proteins  are central to this connectivity. stat <dig> has been shown to play a key role in the development and proliferation of b cells  <cit>  through its activation by and mediation of many interleukins . each of these interleukins serves as a growth factor for various b cell lineages.

glucose metabolism
we found the term “glucose metabolic process”  enriched in the bci with a p-value of  <dig> × 10– <dig> . while glucose metabolism is not solely related to the behavior of b cells, this process is important for many cell types, including b cells, as a primary source of energy. perhaps what was most interesting about this function was its reliance on myc for most of its connectivity. as mentioned, myc is considered to be a master regulator because it regulates the activity of a large number of human genes. figure  <dig> demonstrates that without the annotation of myc by “glucose metabolic process” the network would consist of mostly disconnected proteins. while myc also plays a central role in “protein-dna complex assembly”, one could argue that, even without myc and the edges incident on it, the proten-dna complex assembly network is reasonably well-connected and will be deemed to be significantly enriched by our methods. in the case of “glucose metabolic process,” we elucidated a function whose network-based enrichment score relies heavily on its connectivity through a central hub.

hepatic cultures
the liver carries out a multitude of necessary functions in humans and many other animals, including the metabolism of foreign compounds  and cholesterol. hepatocytes constitute roughly 70-80% of the liver cells. two commonly used systems for culturing these cells in vitro are the hepatocyte monolayer  and the collagen sandwich . briefly, the hm consists of a layer of collagen on top of which a single layer of hepatocytes are placed; the cs is similar to the hm with the addition of an extra layer of collagen on top . a recent study analyzed the expression profile over eight days of genes in primary rat hepatocytes in both hm and cs tissue cultures  <cit> . the authors demonstrated that over eight days, the genes annotated by a wide range of liver-specific biological processes were consistently up-regulated in hepatocytes in cs but not in hm and that processes related to the cell cycle were down-regulated in cs, as compared to hm. hepatocytes in hm differentiate and lose some of their morphology over time, contributing to their loss of liver-specific functions.

for this application of our enrichment methods, we sought to discover functions that annotate differentially-expressed genes in the cs cultures when compared to hms. we used the string database of known and predicted protein interations  <cit>  as our universal interaction network. string assigns a weight between  <dig> and  <dig> to each interaction based on the combined scores of various sources of evidence for the interaction, where higher scores indicate more confidence for that interaction. we removed any self-loops or interactions with a score below  <dig> from the universal network, resulting in a network of  <dig> nodes and  <dig>  edges. we analyzed the expression profiles for rat hepatocyte genes in hm versus cs cultures after  <dig> days of growth  <cit> , since cs showed the greatest divergence from hm after  <dig> days. based on these expression profiles, we used limma  <cit>  to compute p-values that represented the significance of the differential expression of each gene between cs and hm. we desired to compute the response network  that captured the differential expression between cs and hm cultures. accordingly, we used these per-gene p-values in concert with the bionet algorithm  <cit>  to compute a response network  of interconnected genes that is perturbed in cs, in comparison to hm. we used the default parameters for bionet, with fdr= <dig> . please see the bionet publication for more details. the response network contained  <dig> nodes and  <dig> edges. we collected functional annotations of the genes in this network from the molecular signatures database   <cit> . we only retained curated gene sets  and go gene sets  from msigdb, and we removed any functions that annotated fewer than five genes in the universal interaction network.

with the universal interaction network, an interesting subnetwork of the universe , and functional annotations of the universal genes, we applied our network-based enrichment methods. we tested the enrichment of  <dig> msigdb functions for  <dig>  iterations. we also computed the enrichment of each function, using an empirical version of equation  <dig>  to allow us to compare our network-based enrichment p-value for a given function to the p-value given by a standard gene set-based enrichment method . we did not use the analytical version of fisher’s test so that the enrichment p-value estimated by our methods for each function was comparable to that computed by fisher’s test. we observed that  <dig> of the  <dig> functions received a network-based enrichment p-value of less than 10– <dig>  the smallest possible empirical p-value for  <dig>  iterations . we present four of the top  <dig> functions and analyze their relationship to liver cultures. figure  <dig> illustrates the networks induced by the genes annotated by these four top-ranking network-based enriched functions . the genes are colored based on their level of perturbation in the contrast between cs and hm. lightly-colored genes indicate little or no perturbation, while dark red  nodes denote significant up-  regulation in cs compared to hm.

actin cytoskeleton
our network-based enrichment methods discovered the kegg  <cit>  pathway “regulation of actin cytoskeleton” enriched with a p-value less than 10– <dig> . comparatively, the empirical p-value for the one-sided version of fisher’s exact test was  <dig>  , more than three orders of magnitude larger than our p-value. actin organizes into thin filaments to provide structure to cells. cell locomotion is often a driving force for the development of actin cytoskeleton. actin filaments form a highly-organized, complex structure, and manipulation of the actin cytoskeleton enables adhesion to the subtrate and movement of the cell  <cit> . however, hepatocytes are generally stationary cells and are unlikely to use this mechanism. more specifically, hm hepatocytes lose the true hepatic phenotypes much faster than those in cs cultures. a specific characteristic of this loss is the production of actin fibers that help cells in the hm culture to better adhere to the underlying substrate. this phenomenon explains why many genes in the “regulation of actin cytoskeleton” network  are consistently down-regulated in cs hepatocytes compared to those in hm. note that this network contains some up-regulated genes, including fgf <dig> and myh <dig>  these genes are involved in a wide variety of biological processes including cell growth, tissue repair, and cell polarity. their participation in several processes not directly related to actin development may explain why they are upregulated in cs compared to hm in this network.

cell cycle checkpoints
we found the reactome  <cit>  pathway “cell cycle checkpoints” enriched with a p-value less than 10– <dig> , while the empirical version of fisher’s method assigned a p-value of  <dig>  . many genes in this network are essential to the cell cycle process. anapc <dig> codes for part of the anaphase-promoting complex, which is responsible for promoting eukaryotic cells from metaphase to anaphase during mitosis. wee <dig> serves as a key checkpoint in the cell cycle by inhibiting entry into mitosis until the cell has grown to a certain size, thus preventing the separation of the cell into two daughter cells that are too small. mcm <dig> and mcm <dig> are essential genes for dna replication in eukaryotes, a significant process in the cell cycle. under healthy conditions, mature hepatocytes do not readily divide except to replace damaged hepatocytes  <cit> . this observation may explain the downregulation of these genes in cs compared to hm. in other words, down-regulation of cell cycle checkpoints prevents the cell cycle from progressing in cs cultures, in comparison to hm cultures.

nuclear receptor transcription pathway
we identified the reactome “nuclear receptor transcription pathway” enriched with a network-based p-value less than 10– <dig> . fisher’s method returned a p-value of  <dig>  . nuclear receptors are responsible for sensing steroids, hormones, and other signaling molecules in the cell. since one of the primary functions of the liver is the production of hormones, enrichment of this gene set in cs cultures is to be expected and was noted in an earlier study  <cit> . furthermore, we expect many genes involved in this pathway to exhibit up-regulation in cs versus hm cultures. figure  <dig> confirms that all the genes in the intersection between this pathway and the bionet response network are indeed up-regulated. nr1h <dig>  nr1i <dig>  rxrg, and hnf4a encode parts of the liver x receptor, the pregnane x receptor, the retinoic acid receptor, and the hepatocyte nuclear factor, respectively. all these nuclear receptors are responsible for sensing signaling molecules that are highly relevant to liver function, e.g., metabolism of toxic substances and vitamins.

drug metabolism
the kegg pathway “drug metabolism of cytochrome p450” was enriched according to our network-based method with a p-value of less than 10– <dig> . fisher’s method assigned the same function a p-value of  <dig>  . all genes in this network were up-regulated in cs hepatocytes compared to those in hm. one of the primary functions of the liver is processing xenobiotics, including drugs. cytochrome p450s represent a class of proteins that are responsible for breaking down various lipids, steroids, and xenobiotic  compounds. primary hepatocytes actively express these proteins, even in the absence of external chemicals or drugs  <cit> . the enrichment of this pathway in cs cultures  supports the well-known phenomenon that hms rapidly lose liver-specific functions.

gene sets with high network-based p-values
several functions received a high network-based p-value from our methods and a low set-based p-value using fisher’s exact test. we ranked the genes sets in increasing order of their set-based p-values, and we report the two highest-ranking gene sets that received a network-based p-value of  <dig>  according to fisher’s exact test, we found the msigdb gene set “su liver” significantly enriched with a p-value of  <dig> – <dig>  and the gene set “chiaradonna neoplastic transformation kras dn” significantly enriched with a p-value of  <dig>  × 10– <dig> . our network-based functional enrichment approach deemed both functions insignificant with a p-value of  <dig> because there exist no interactions among the genes annotated by either function. gene sets whose constituent proteins are sparsely-connected may be difficult to interpret.

improving functional network coherence
in the third and final application of our network-based enrichment methods, we sought to analyze how the addition of a collection of experimentally determined interactions impacts a dataset of known interactions. specifically, given a universal interaction network in s. cerevisiae, we wanted to determine which biological functions became more coherent within the network after introducing new pairwise interactions discovered in a large-scale genetic interaction  study. we retrieved the yeast interactome from the biogrid database  <cit> , which incorporates both genetic and physical interactions from multiple sources . biogrid includes a sub-network of  <dig>  gis among  <dig> genes reported by collins et al  <cit> . we refer to this list of gis as “the gi study” or “the gis” throughout this section. our goal was to ask which go biological processes became better connected when the gis were added to biogrid. we downloaded go biological process annotations of the genes in biogrid from go  <cit> . as with the annotations of the bci, we applied the true-path rule to the annotations, and we removed any functions that annotated fewer than five genes in the universal network and more than  <dig> genes in the interesting collection c.

we then applied our network-based enrichment approach in two ways. the universal interaction network  remained the same in both cases. in the first case, we set the interesting network  to be the same as the universal network . this analysis is similar to the analysis performed on the bci. essentially, the network-based p-values in this case indicated which functions were enriched in the entire biogrid network, including the gis. for the second case, we set the interesting network to be the universal network with interactions from the gi study removed. if there were other sources of evidence for one of the gis, we retained that edge in the interesting network. the network-based p-values in this case indicated which functions were enriched in the universal network if we ignored any information from the gi study.

let pa be the network-based p-value for function f from the first case, where we considered all edges in the univeral network, including those from the gi study. similarly, let pr be the network-based p-value for function f from the second case, where we removed any edges in the gi study from the interesting network. we scored each function by s = log10/pa). thus, functions whose network-based enrichment p-value decreased  as a result of adding the gis received a positive score, functions whose enrichment remained the same received a score of  <dig>  and functions whose p-values increased  as a result of adding the gis received a negative score. we believed that highly positive-scoring functions were those biological processes whose coherence improved the most by adding the gis. of the  <dig> functions tested,  <dig> functions received a score greater than  <dig> , and only  <dig> function received a score less than - <dig> . next, we discuss the three go biological processes, “chronological cell aging”, “dna geometric change”, and “histone deacetylation”, that received the 2nd, 3rd, and 9th highest overall scores, respectively. these examples illustrate a new application of network-based functional enrichment that is sensitive to the increased connectivity among a set of genes upon the addition of multiple edges. however, gene set-based enrichment may not be sensitive to such an addition of edges if, for example, all newly-added edges were among genes already present in the network.

cell aging
the go biological process “chronological cell aging”  received a score of  <dig>   exhibiting a decrease in network-based p-value of nearly three orders of magnitude with the addition of the gis. this process is the progression of quiescent  cells from their inception to the end of their lifespans. figure  <dig> demonstrates that this increase in enrichment is a result of three gis incident on sod <dig>  a cu-zn superoxide dismutase that has a role in the detoxification of oxygen radicals. these enzymes catalyze the breakdown of the superoxide radical  into an oxygen molecule and hydrogen peroxide. yeast cultures lacking sod <dig> exhibit drastically decreased viability  <cit> . strikingly, the interactions from the gi study were able to connect three previously disconnected subnetworks of genes annotated with chronological cell aging in s. cerevisiae.

dna geometric change
our approach identified the go term “dna geometric change”  with a score of  <dig>  as having a considerably decreased network-based enrichment p-value after adding the gis . the p-value decreased primarily because of the gi between ssl <dig> and top <dig>  which connected two previously disconnected components of the network induced by genes associated with dna geometric change. additionally, the added gis reinforced the connectivity among rfa <dig>  rfa <dig>  rad <dig>  srs <dig>  and their neighboring genes. thus, the connected component induced by these genes was less likely to become disconnected during the randomization procedures used to perform network-based enrichment.

histone deacetylation
our enrichment approach assigned a score of  <dig>   to the go term “histone deacetylation” . the gis improved the connectivity among several genes related to histone deacetylation . the gis also provided a new source of evidence for many previously-known interactions, a property we can deduce from figure  <dig> but one that is not explicitly considered by our methods. however, the interaction connecting hos <dig> to eaf <dig> and the interactions between hst <dig> and cpr1/sin <dig> are perhaps the most interesting as they provide new evidence for including hos <dig>  hst <dig>  and hst <dig> in the large connected component associated with histone deacetylation. the gis that connect hst <dig> and hst <dig> to the largest connected component of this biological process are quite striking, since these genes code for histone deacetylases, and the gis provide previously unknown interaction data for including them in this network.

CONCLUSIONS
in this paper, we have presented a novel approach to functional enrichment that takes into account the pairwise relationships among genes annotated by a particular function. we proposed two different methods for calculating p-values to assess the significance of each function in a network-based context; we described these methods as “function randomization” and “network structure randomization”. we required functions to have low enrichment p-values based on both criteria. our function randomization approach is a generalization of the one-sided version of fisher’s exact test, a standard formulation of functional enrichment for gene sets. specifically, after removing edges from the universal and interesting networks, the function randomization approach is equivalent to the one-sided version of fisher’s exact test. our network structure randomization approach offers a strictly network-centric method for determining functional enrichment.

we utilized our methods on real biological data from three different organisms: human, rat, and yeast. in each organism, we showcased a different application of network-based enrichment. first, we used the human b cell interactome to demonstrate the capability of our methods to simply discover enriched functions in a single network. we have noted that many standard gene set enrichment methods do not address this issue, as they require a universal gene set and an interesting collection of genes within the universal genes. moreover, graph clustering algorithms that are designed to compute dense subgraphs might not detect sub-networks that are well-connected but not very dense, such as those corresponding to “protein-dna complex assembly” and “glucose metabolic process” in figure  <dig>  second, we applied our methods to a response network composed of rat genes perturbed in hepatocytes cultured in two different ways. this approach parallels traditional gene set enrichment methods, where given an interesting collection of genes, we seek functions overrepresented in the interesting genes with respect to some universe of genes. we identify several relevant functions that our network-based method finds as being most significant but are far from the highest-ranking functions using the set-based fisher’s method. third, we demonstrated a novel application of network-based enrichment to assess the functional contribution of a collection of genetic interactions in yeast to the underlying universe of known yeast interactions. 

our work suggests many directions of future research. while we did not take edge reliabilities into account for the analysis presented here, our methods can be readily applied to weighted networks. indeed, our approach for comparing sequences of component sizes can be used to compare sorted sequences of the sums of edge weights within each component . identifying alternative methods for sequence comparison is also an interesting question, particularly those methods for which the resulting distribution of sorted sequences can be determined analytically. such comparison methods may drastically improve the computational efficiency of our network-based enrichment approach. our methods analyze the functions one at a time and often lead to redundant functions being identified as enriched. additionally, we need to apply corrections for multiple hypotheses testing, thereby potentially decreasing our statistical power. furthermore, our permutation-based approach for computing p-values is very time-consuming. these three issues can potentially be tackled by generalizing model-based approaches for gene function enrichment  <cit>  to the domain of network-based function enrichment. after assuming an appropriate model for how biological processes may be perturbed in a cell, these methods proceed to infer the set of biological processes that best explain an input list of genes  against a background list . we are developing a modified version of our network-based approach that identifies groups of functions that jointly cover the network of interest, rather than consider functions individually. applying these methods in the network context is an interesting and important problem.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
all authors aided in the design of the methods. tmm conceived the idea and contributed to implementation of the methods. clp and cco implemented the algorithms. clp collected the data and performed the analysis. clp and tmm interpreted the results and wrote the manuscript.

acknowledgments
this work was supported by an nsf grant cbet- <dig>  and an nsf graduate research fellowship .

this article has been published as part of bmc bioinformatics volume  <dig> supplement  <dig>  2011: tenth international conference on bioinformatics – first iscb asia joint conference  <dig> : bioinformatics. the full contents of the supplement are available online at http://www.biomedcentral.com/1471-2105/12?issue=s <dig> 
