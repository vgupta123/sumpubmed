BACKGROUND
pairwise sequence alignment is the most widely used method for extracting information from protein and dna sequences; it is routinely used to detect protein homologs that diverged more than  <dig> billion years ago. homology -common evolutionary ancestry - can be reliably inferred for proteins that share statistically significant sequence similarity. when statistically significant similarity to a known sequence is found, inferences can be made about the structure, function, and biologically significant residues of the unknown sequence. while the inference of homology is quite robust ,  <cit>  some of the more detailed functional inferences are critically dependent upon the quality of the alignment between the two sequences. for proteins that are very similar , functional inferences are usually very accurate, but for more distantly related proteins, ambiguity in the alignment of poorly conserved regions can lead to errors  <cit> .

the usual gold standard by which sequence alignments are assessed is the structural alignment between two proteins whose three-dimensional  structures are known. the 3d-structure contains more information than the one-dimensional sequence, and diverges more slowly, so that distant evolutionary relationships can be recognized in structures between sequences that do not share statistically significant similarity. however, even clearly related proteins with strong sequence similarity can produce sequence alignments that differ from the most accurate structural alignments . since determining the three-dimensional structure of every protein is not feasible, we seek strategies to produce structurally accurate homology models for sequences of unknown structure. the most common and successful methods involve finding a template among the set of known structures upon which to base the model. in the case of high sequence similarity , this task is relatively trivial, since the sequence and structural alignments are generally quite similar in this range. however, there are only a limited number of sequences that can be modeled in this region; there are far more sequences in the so-called "twilight zone"  where divergent, but clearly homologous proteins can be difficult to align. since the quality of the final 3d-model depends on the alignment of the unknown sequence to the structural template, we focus on improving the quality of alignments between proteins that share statistically significant similarity, and 20% to 40% sequence identity  <cit> .

the most widely used algorithm for generating pairwise sequence alignments is dynamic programming, originally applied to biological sequences by needleman and wunsch <cit> . dynamic programming methods guarantee an algorithmically optimal alignment for the specific sequence and input parameters. however, an optimal sequence alignment score does not necessarily guarantee that the alignment is structurally accurate. sequence alignment scores are optimized for a particular set of amino acid replacement scores and gap penalties; there is no natural process by which two proteins align themselves. for this reason "optimal" sequence alignments can be very different from optimal structural alignments. for example, in figure 1a, the highest scoring structural alignment  had a semi-global sequence alignment score of - <dig>  which is dramatically lower than the optimal sequence alignment score of  <dig>  yet the actual lsqman alignment is very similar to the other structural alignments, and the optimal sequence alignment. the lsqman sequence alignment score is very low because lsqman has a number of gaps of the form acd--/---tqy, which would never be produced in a sequence alignment, but may make sense  in a structural alignment.

furthermore, distantly related proteins often have multiple optimal alignments, as well as a large number of suboptimal alignments with scores very close to that of the optimal score  <cit> . as one moves away from the optimal score, the number of alternative alignments grows rapidly. thus, to keep the number of alignments to be dealt with computationally tractable, one must sample the suboptimal alignment space.

although the "gold standard" by which sequence alignments are evaluated is a structure-based alignment, structural alignments can vary, and there is no algorithm that guarantees an optimal structural alignment  <cit> . the assumption is usually made that because structures tend to vary less than sequences over evolutionary time, differences in structural alignments are small compared to the difference between sequence and structural alignments. while this is certainly true for very distantly related proteins that do not share significant similarity , the range of structural and sequence alignment accuracy has not been carefully examined for proteins that share statistically significant similarity. our results suggest that for proteins with moderately significant sequence similarity, sequence alignments can often be within the range of different structural alignments.

since structurally accurate alignments often have sub-optimal sequence alignment scores, investigators have explored these sets of alternative alignments, asking whether they provide information about accurate structural alignments. for example, jaroszewski et al.  <cit>  examined alternative alignments generated both from a near-optimal alignment generation algorithm and by varying the scoring parameters  and showed that there is frequently an alignment in these sets that is closer to the structural alignment. they concluded that the two methods of generating alternative alignments - alternative scoring parameters and sub-optimal alignment - have complementary  information, since the union of the two sets yielded many more alignments that matched a structural alignment than either of the single sets. holmes and durbin  <cit>  also investigated the accuracy of the optimal sequence alignment and developed a method for calculating the expected accuracy of a given alignment. zhang and marr  <cit>  used an algebraic approach to investigate alternative alignments in the neighborhood of the optimal alignment.

various authors have taken a probabilistic approach to generating sets of alternative alignments. miyazawa  <cit>  calculated alignment probabilities based on the exponent of the alignment score, and compared the resultant probabilities of matched amino acids in the alignment to the respective protein structure alignments. yu and hwa examined the statistical significance of alignments produced using a pairwise hidden markov model   <cit> . knudsen and miyamoto  <cit>  developed an alignment method based on a pairwise hmm that included an explicit evolutionary model for indels. finally, mückstein et al.  <cit>  developed a procedure for sampling alignments based on statistical weighting using the partition function over all possible alignments of two sequences.

while it is of theoretical interest to compare sets of individual sequence and structure alignments, it is only of practical use if one can determine which sequence alignment is the correct one in the absence of structural information. one way to address this question is to estimate the reliability of a particular pair of aligned residues . cline et al.  <cit>  looked at four methods for predicting the reliability of a particular pair of aligned residues and determined that the method proposed by yu and smith  <cit>  for extracting near-optimal alignments from a profile hidden markov model  provided the most improvement in alignment quality. miyazawa  <cit> , knudsen and miyamoto  <cit> , and mückstein et al.  <cit>  examined the relationship between edge probabilities and structural alignment, although in the latter two cases only in the context of a small number of protein pairs, and generally found a good correspondence between them. mevissen and vingron  <cit>  demonstrated the efficacy of an edge reliability index called robustness, which had been defined previously by chao et al.  <cit> , among others . they demonstrated that the robustness of an edge accurately predicted whether the edge was also aligned in the structural alignment. here, we extend the analysis of robustness by incorporating additional alignment quality information and developing a logistic regression model that returns  the probability that a given edge is contained in a structural alignment. we also examine the distribution of alignments produced by proba  and compare them to the distribution produced by the zuker algorithm  <cit> .

RESULTS
our goal is to find characteristics of sub-optimal sequence alignments that can be used to identify alignments, or sub-alignments, that are found in structural alignments. just as importantly, we seek measures of alignment quality that help us predict which alignments are more likely to be correct. since homologous proteins are typically identified through similarity searches, we focus on protein sequences that share statistically significant sequence similarity. we divide our protein pairs by sequence similarity, to explore the relationship between sequence similarity  and structural accuracy. the most similar third of the alignment pairs have sequence similarity expectation values e() < 10- <dig>  with an average of 48% identity. the intermediate and most distantly related sequences have 10- <dig> < e() < 10- <dig>  and e() < 10- <dig> , respectively.

comparison of near-optimal and structure-based sequence alignments
suboptimal sequence alignments can only be used to produce accurate structural alignments if the sequence and structure alignments overlap each other. figure  <dig> depicts the sequence/structural alignment overlap in the context of the path graph. in figure 1a, the alignment of two globin homologs, the structure-based alignments tend to overlap extensively, with only minor deviations from each other, in large part because the eight globin α-helices comprise most of the sequence. the optimal sequence alignment also overlaps the structure alignments extensively. the lines for the 95% of optimal and 75% of optimal sets represent envelopes: i.e. for a given residue in the path graph, the two lines mark the maximum and minimum indices of the residues it is aligned against in the pool of alternative alignments. in figure 1b, two neurotoxins that have a set of three conserved secondary structural elements, but other substantial structural differences, the structural alignments are less consistent, and the 75%-optimal sequence alignments are required to capture the structural uncertainty. in both cases, the structural alignments are contained within the set of alternative sequence alignments.

alignments have a score - either a sequence similarity score or a structural similarity score. while the path graphs indicate that the structural alignments are generally in the space of suboptimal sequence alignments, we need to know how the similarity scores compare. figure  <dig> shows the sequence and structural similarity scores for the alignments depicted in figure  <dig> . in figure 2a, the best sequence alignments have structural similarity scores that are as good as or better than those of the structural alignments. in figure 2c the best sequence alignments have structural similarity scores that are about 20% lower than the structure-based alignments. moreover, while the structure-based alignments tend to have similar structural similarity scores, their sequence similarity scores vary considerably. the alignments produced by proba are shown in figures 2b and 2d. the proba sequence alignment scores span a wider range than the zuker alignments, but this does not necessarily result in alignments with higher structural similarity scores. table  <dig> summarizes the alignment scores for the two pairs shown in figures  <dig> and  <dig> 

†semi-global alignment, blosum <dig> substitution matrix, gap open penalty - <dig>  gap extension penalty - <dig> 

§ the sequence with the highest levitt-gerstein similarity score was chosen from the set of optimal alignments, the set of alignments with a sequence similarity score within 95% of optimal, the set of alignments with a sequence similarity score within 75% of optimal, and the set of proba alignments, and the sequence similarity score and shift score for that alignment were recorded.

¶alignments were created using the log-odds score produced by a logistic regression model in place of a substitution matrix. "robustness" refers to a model that had only robustness as an independent variable, while "model" refers to the full model . see text for details.

a single similarity score is only a rough measure of how similar two alignments are. cline et al.  <cit>  developed the shift score as more robust measure of how similar two alignments are, and demonstrated its ability to account for both shorter alignments that are highly similar and longer alignments that have several edges that are different by a few residues. figure  <dig> shows the distribution of shift scores for near-optimal alignments  with respect to a single structure alignment . as in figures  <dig> and  <dig>  the substantial overlap between near-optimal alignments and structural alignments is apparent for the most similar sequences, although the two begin to diverge as the sequence similarity drops. the structural alignments also become more divergent from each other as the sequence similarity drops, and, perhaps surprisingly,  <dig> of the  <dig> aligned pairs of medium similarity have at least one  sequence shift score as high or higher than a structure-based alignment, and  <dig> have alignments within  <dig>  of the lowest structural alignment . for the low similarity pairs,  <dig> of the  <dig> pairs have sequence alignments as good as or better than the lowest structural alignment, and  <dig> are within  <dig>  shift scores of a structural alignment. thus, there is still substantial overlap between the near-optimal sequence alignment space and the structural alignment space, even using the more sensitive shift score. consistent with figure  <dig>  the proba alignments produce wider ranges of shift scores, which sometimes results in overlap with the lowest structural alignment. however, there does not appear to be any consistent pattern when comparing the zuker and proba alignments. there are examples where most of the zuker distribution is higher than most of the proba distribution ; where the proba distribution is higher ; where the optimal zuker alignment  has a better shift score than the best proba alignment ; and where the best proba is better . it does appear that the best proba alignment has the best shift score of all the proba alignments  more frequently than the optimal zuker alignment has the highest shift score, but this occurs in only  <dig> out of  <dig> pairs.

logistic regression model
to make use of the information contained within the set of near-optimal alignments, one needs a way of ranking or assessing the alignments. in particular, one would like to assess the likelihood that a particular pair of residues has been aligned properly. mevissen and vingron described one such method  <cit> . they calculated the robustness, which is the difference between the sequence alignment score for an alignment including a given pair of aligned residues  and the highest score for an alignment that does not include that edge. they demonstrated that robustness reasonably predicted the reliability that the edge would be found in the structural alignment. robustness gives a measure of the importance of a given edge, but it does not measure aspects of the overall alignment. the frequency that an edge is found in a set of near-optimal alignments incorporates the fact that the area in the path graph surrounding the edge in question may affect whether that particular edge is used frequently. in addition, the maximum bits-per-position score that is obtained by an alignment containing that edge in the set of near-optimal alignments provides information about the overall quality of the alignments that use that edge.

logistic regression is used to predict a discrete response variable using one or more continuous, discrete, and/or dichotomous predictor variables  <cit> . thus we developed a logistic regression model using robustness, frequency, and maximum bits-per-position as predictors, and presence in a structural alignment as the response. as detailed in the methods section, sequence alignment scoring parameters, the threshold for structural targets, and the edge sample size did not substantially affect the resultant model. this is consistent with figure  <dig>  which indicates that altering the scoring parameters did not substantially affect the overlap between the set of alternative alignments and the structural alignments. we also examined different cutoffs for the neighborhood of the optimal score from which alignments were chosen . the roc curves and aic values improved the further the cutoff was from optimal. we also compared using all edges vs. edges from within the local alignment boundaries , and found that the latter gave better aic values. the final model presented in tables  <dig> and  <dig> was constructed from  <dig> randomly selected edges taken from the local region of alignments within 75% of optimal, and generated using three different scoring parameters: blosum <dig> , blosum <dig>  and blosum  <dig> .

the final logistic regression model parameters, based on edges drawn from the set of alignments with sequence similarity scores within 75% of optimal, limited to the local alignment region. see text for details of the model construction.

see text for details of the model construction. aic, akaike information criterion.

we compared the ability of the model to predict whether an edge will be found in a structural alignment or not with that of alternative models  by creating training and test sets of edges by randomly segregating the alignments, then selecting edges from the pool of training or testing alignments. figure  <dig> shows the receiver-operator characteristic  curves for the various models. the area under the curve  improves from  <dig>  to  <dig>  using the logistic regression model compared to using robustness alone. this particular roc shows a higher auc using only frequency than using the full model, but the aic values in table  <dig> indicate that the full model provides the best fit to the data , and the application of the different models indicates that the full model performs slightly better than using frequency alone .

since the proba alignments sampled a wider variety of alignments, which tended to overlap with the structural alignments to a greater extent than the zuker alignments did, we also created a model using the proba alignment edges as input. this model performed slightly worse than that based on the zuker alignments did . we did not directly examine the edge probabilities that proba uses to construct its alignments, but since the algorithm produces a "statistically weighted distribution"  <cit>  of alignments, the frequency of an edge should approximately correspond with its probability. thus if the proba edge probabilities were substantially better at correctly predicting structural edges this should show up in the regression. the implication is that proba expands the diversity of alignments compared to the zuker algorithm, but it is not necessarily any easier to identify which edges are found in structure alignments.

applying the model
having established that the model is superior at identifying structural edges, we next wanted to make use of this information to produce more structurally accurate alignments. we did this in two ways: by "trimming" the optimal sequence alignments and by generating new alignments using the model probabilities.

given a sequence alignment, some fraction of the aligned residues will be incorrect, compared to a reference alignment.  furthermore, some fraction of the correct edges will not appear in the sequence alignment. perhaps the simplest way to make use of an edge classification scheme is to identify suspect edges, and remove them from the alignment. we thus "trimmed" alignments by removing edges from the alignment with low log-odds probabilities produced by the model, or with low robustness or frequency scores. for example, we replaced any edges in an alignment with low log-odds scores  with a gapped alignment . we then compared the percentage of sequence alignment edges that are correct  and the shift scores against dali alignments of "trimmed" alignments with the untrimmed alignments. these results are summarized in tables  <dig> and  <dig> 

numbers shown are the number of sequence pairs, out of  <dig> in each similarity group, whose shift score with respect to the dali alignment are improved or worsened by at least  <dig> , along with the average and standard deviation of the magnitude of the change in shift score. in the case of local alignments or alignments limited to the local alignment boundaries, the dali alignment is also limited to the local alignment boundaries. model trim is the optimal alignment, with edges that fall below 50% probability according to the logistic regression model removed. robust trim is the same, except edges less than a normalized robustness score of  <dig>  are removed. frequency trim is for edges with a frequency less than  <dig>  removed. local trim is the optimal  alignment, with all edges outside the ssearch boundaries removed. model alignment is an alignment produced using the log-odds score produced by the full logistic regression model in place of the substitution matrix scores. robust and frequency alignment is the same, except the logistic regression model only used robustness or frequency as a variable.

numbers shown are the number of sequence pairs, out of  <dig> in each similarity group, whose percentage of aligned edges that are correct with respect to the dali alignment are improved or worsened by at least  <dig> , along with the average and standard deviation of the magnitude of the difference. in the case of alignments limited to the local alignment boundaries, the dali alignment is also limited to the local alignment boundaries. alignments are as described in table  <dig> 

trimming the alignments with the logistic regression model probabilities clearly improves the percentage of true positives in all similarity categories, in agreement with the roc curve. this has minimal effects on the sensitivity ; of the edges in the optimal semi-global alignment removed by the model, less than 10%  are true positives . no more than four true positives are removed in any given pair. for shift scores, trimmed alignments also show clear, if less dramatic, improvement over the optimal alignment. in this trimming analysis, the full model performs similarly to robustness alone and frequency alone.

another way to look at alignment quality is to identify regions of the alignment that are of higher or lower quality, as opposed to individual edges. since we are aligning structurally defined domains, the default was to use semi-global alignments; however, we hypothesized that the regions of the alignment that were within the local alignment boundaries might be of higher quality, under the assumption that there would be more alignment "signal" within this region. tables  <dig> and  <dig> indicate that this is indeed the case, since when we trimmed the optimal global alignments  to the local alignment boundaries , the true positives and shift scores improved significantly. the semi-global alignments trimmed to local boundaries perform better than the ssearch alignments, indicating that the global alignment is necessary even though it is typically of poorer quality at the ends of the alignment . combining trimming by both local boundaries and the regression model did not result in better performance, indicating that a significant portion of the improvement due to the model trimming is due to removing incorrect edges that are at the ends of the alignment .

trimming alignments can help remove incorrect edges, but it is constrained by the initial alignment. we also produced new alignments that were not so constrained, by using the probabilities calculated by the model  in place of standard substitution matrix scores and affine gap penalties . tables  <dig> and  <dig> demonstrate that these alignments also improve structural accuracy compared to the optimal sequence alignment. in contrast, alignments created using the same procedure, except that the regression model was built using only robustness as a variable, are typically less accurate than the optimal sequence alignment. using frequency as the only variable results in slightly lower performance than the full model. the model-trimmed and model-produced alignments are similar, but not identical. the average shift score between them is  <dig> , but ranges from  <dig>  to  <dig> . the model-produced alignments have higher shift scores  in  <dig> of the pairs , while the model-trimmed alignments have higher shift scores in  <dig> of the pairs . the model-produced alignments find novel  correct structural edges, which the trimmed alignments cannot consider. the full model finds two or more novel correct edges in  <dig> of the  <dig> pairs . the corresponding numbers for the robustness-only and frequency-only alignments are  <dig>   <dig> ,  <dig>  and  <dig>   <dig> ,  <dig>  respectively. the number of new correct edges found is modest, but there is no disadvantage to using the model-produced alignments compared to the either the optimal alignments or the trimmed alignments, and in some cases using the model-produced alignment provides substantial improvement. these results also support the use of the full model over the frequency-only model. interestingly, the robustness-only model-produced alignments actually find more novel correct edges than the full model does, even though the overall alignments are clearly poorer. from looking at the alignments and the edges found, it appears that this occurs because the robustness-based alignment produces short runs of 2- <dig> edges that are structurally correct , but which do not appear in the optimal or full model-produced alignments .

discussion and 
CONCLUSIONS
previous authors have shown that there is substantial overlap between the near-optimal alignment space and the structural alignment space  <cit> , and have made use of this information to produce better alignments  <cit>  or evaluate alignments  <cit> . our results also show this overlap, focusing on statistically significant pairwise alignments . it is important to note that the overlap between sequence and structural alignments is due to variation in both spaces: structural alignments produced by different algorithms sometimes vary substantially, in addition to variations in the set of near-optimal sequence alignments. we also emphasize that expectation value is a much more accurate proxy measure for alignment accuracy than the more commonly used percent identity . the differences in percent identity between the medium similarity group and low similarity group  are modest , but the degree of overlap with structural alignments differs significantly .

previous efforts to extract information from the overlap between the structural and sequence alignment spaces have used profile-based methods  <cit>  to improve the alignments of distantly related proteins; here we focus on pairwise alignments. while profile-based methods are clearly able to detect and align more distantly related proteins than pairwise methods, pairwise alignment is more widely used and in some cases may be the only option available; thus improvements in pairwise alignment accuracy are desirable. focusing on individual edges in the alignment, mevissen and vingron  <cit>  demonstrated that robustness can accurately discriminate between structurally correct and incorrect edges in an alignment; however, they did not produce an explicit model for robustness edge classification, and did not attempt to produce improved alignments. we have developed an explicit model that is more accurate than robustness in predicting whether a given edge  is likely to be found in a structural alignment, and that produces the associated log-odds probability. our model can be used to produce alignments that are more similar to structure-based alignments, and is capable of finding correct structural edges that are not in the optimal sequence alignment. the model developed will be integrated into our existing display software that allows users to build and visualize sets of near-optimal alignments,  <cit>  making the model easily accessible.

there has also been substantial effort put into developing probabilistic methods for exploring alternative pairwise alignments. we have used the proba program to compare this methodology with the zuker method of sampling different alignments. it appears that proba samples a more diverse range of alignments, which can result in better agreement with the structural alignments; however, it is not obvious that the "correct" alignments  are any easier to identify within the set of proba alignments. it is intriguing that in some cases the best proba alignment is also the most similar to the structural alignments , which apparently happens rarely if at all with the zuker alignments. further investigation will be required to determine if these cases can be distinguished prior to knowledge of the structural alignment.

