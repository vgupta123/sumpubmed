BACKGROUND
molecular recognition plays an important role in many fundamental processes in biological systems  <cit> . the basic concept of molecular recognition was first narrated by emil fischer more than  <dig> years ago. his "lock-and-key" theory  <cit> , i.e. "... enzyme and glycoside must fit together like a key and a lock in order to initiate a chemical action upon each other...", has long been regarded as the basis for studying the binding between a ligand molecule to its biological receptor. molecular docking, as a computational simulation of the ligand-receptor binding process, is widely applied in many research areas, such as structure-based drug design. for example, docking-based virtual screening  <cit>  has become a complementary approach to high-throughput screening for the discovery of novel lead compounds, which is popular among academic research groups as well as pharmaceutical companies. in such a process, a library of small molecules are fit into the binding pocket of a given target protein through molecular docking, aiming at achieving an optimal complementarity of steric and physicochemical properties. then, a computational method, which is often referred to as "scoring function", is used to evaluate the fitness between the ligand and the protein. all of the molecules are subsequently ranked by their binding scores, and only the most promising ones will be examined later in experiments. obviously, a quantitative prediction of protein-ligand binding affinities is the key to the success of such studies.

as demonstrated in many previous studies  <cit> , today's molecular docking programs, such as dock  <cit> , autodock  <cit> , flexx  <cit> , surflex  <cit> , ligandfit  <cit> , gold  <cit> , and glide  <cit> , are able to identify the correct binding pose of a flexible ligand to its receptor with a reasonable accuracy. however, binding affinity prediction  is still the achilles' heel of molecular docking because in many cases the binding scores produced by scoring functions do not correlate well with true binding affinities, sometimes even cannot rank a set of compounds correctly  <cit> . the relatively disappointing performance of scoring functions in this aspect may be the result of a compromise between accuracy and speed since simplifications have to be made regarding solvation effects, conformational flexibility, and other factors in protein-ligand binding. a number of computationally more expensive methods have also been developed for binding affinity prediction in the past two decades or so. these methods typically conduct conformational sampling of the protein-ligand complex of interest through extensive molecular dynamics simulation in explicit solvent. thus, they are able to address solvation effect and conformational flexibility in theory. free energy pathway methods, such as free energy perturbation  <cit>  and thermodynamics integration  <cit> , sometimes can reproduce protein-ligand binding affinities within 1~ <dig> kcal/mol. nevertheless, they are normally used for the computation of the relative binding affinities of closely resembled ligand molecules, and thus have rather limited applications. "end-point" methods, such as the linear interaction energy  approximation  <cit>  and the mm-pb/sa method  <cit> , avoid the integration of free energy pathway in order to save computation cost. they are normally applied to the modeling of a congeneric set of compounds binding to the same target protein. a number of successful applications of these methods have already been reported in literature. however, their success seems to rely on well-selected systems, and their robustness still needs to be validated more extensively. inaccuracy in force field or inadequate sampling may account for their possible failures. in fact, some comparative tests  <cit>  indicate that such methods are not necessarily more accurate than scoring functions although they definitely consume more computational resources. technically, these methods are by far too computationally expensive for high-throughput tasks. it is also complicated to set up a job with such methods. due to these concerns, such methods are not likely to be integrated into molecular docking programs for practical uses.

considering the balance between accuracy, efficiency, and applicability, scoring functions are still the best choice to tackle the scoring problem for molecular docking and some other tasks in structure-based drug design. thus, improving the general performance of scoring functions is undoubtedly a worthwhile aim. a good number of scoring functions have already been reported in literature since 1990s. they can be classified roughly into three categories:  force field-based methods  <cit>  rely on established force fields to compute the non-covalent interactions between protein and ligand, including van der waals and electrostatic interactions. they are often augmented by gb/sa or pb/sa terms in order to consider solvation effect.  empirical scoring functions  <cit>  decompose the protein-ligand binding free energy into some basic terms, such as hydrogen bonding, hydrophobic effect and so on. each term is computed with an intuitive algorithm, and the weight factors of each term are typically derived from a regression analysis on a set of protein-ligand complexes with known binding affinities. hence, empirical scoring functions are also referred to as regression-based methods.  methods based on potentials of mean force  <cit>  compute protein-ligand interactions as a sum of distance-dependent pairwise potentials. a technical advantage of these methods is that deduction of potentials of mean force only requires the knowledge of protein-ligand complex structures.

most of today's scoring functions are developed as all-purpose models, which are presumably applicable to all sorts of protein-ligand complexes. a recent comparative assessment of  <dig> popular scoring functions conducted by us  <cit>  revealed that an accurate prediction of the binding affinities across a variety of protein-ligand complexes is still a major challenge for them. nevertheless, it was also noticed that on certain classes of complexes, some scoring functions actually produced very promising results. this observation indicates that it is perhaps more practical to develop specific scoring functions applicable to certain classes of protein-ligand complexes in order to improve the accuracy in binding affinity prediction. in fact, this idea has been practiced by some researchers. for instance, teramoto et al. introduced the supervised scoring modes as well as an optimized consensus scoring scheme with feature selection to enhance the enrichment factor in structure-based virtual screening  <cit> . recently, seifert and co-workers published a review article on target-specific scoring functions   <cit> . current all-purpose scoring functions can be re-calibrated on certain classes of protein-ligand complexes to become target-specific, which is probably the most straightforward approach. for example, the drugscore-rna  <cit>  adopts the same framework as drugscore  <cit> , a scoring function based on potentials of mean force, but is derived from  <dig> crystal structures of nucleic acid-ligand and nucleic acid-protein complexes. antes proposed the poem approach   <cit>  and applied it to the optimization of two scoring functions  on kinases and atpases. seifert described a statistical method  for improving the signal-to-noise ratio of scoring functions in molecular docking and successfully customized the böhm scoring function on three selected proteins: cyclin dependent kinase  <dig>  estrogen receptor, and cyclooxygenase  <dig>  <cit> .

the targeted scoring functions mentioned above typically require re-parameterization or special customization on current scoring functions to become suitable for specific systems. in this study, we have proposed an alternative strategy, namely knowledge-guided scoring . this strategy requires no re-parameterization in prior, and in principle can be applied in combination with any scoring functions to any classes of protein-ligand complexes. the key idea is that the unknown binding affinity of a given protein-ligand complex can be estimated more reliably based on the known binding affinity of an appropriate reference complex. the reference complex is required to share a similar pattern of key protein-ligand interactions with the given protein-ligand complex. for this purpose, our kgs strategy utilizes a sufficient number of relevant protein-ligand complexes with known structures and binding affinities as a knowledge set. the key protein-ligand interactions in each complex are summarized as a pharmacophore model, which can be elucidated by an automatic algorithm implemented by us. the knowledge set is then searched through for the appropriate reference complex for any given protein-ligand complex. thus, our kgs strategy can take full advantage of known knowledge, resulting in an improved accuracy in binding affinity prediction. in our study, the kgs strategy was tested in combination with two all-purpose scoring functions, i.e. x-score  <cit>  and plp  <cit>  on three sets of protein-ligand complexes. an improved average accuracy for both x-score and plp was indeed obtained. detailed descriptions are given in the following sections.

methods
overall strategy
our basic assumption is that molecular systems with similar structures have similar properties, a strategy that has been applied successfully to the computation of some physicochemical properties such as partition coefficient  <cit>  and water solubility  <cit> . accordingly, the unknown binding affinity of a given complex can be estimated more reliably from the known binding affinity of a reference complex, which shares a similar pattern of protein-ligand interactions with the query complex. the binding scores provided by a reasonable scoring function should correlate well with experimentally determined binding data as follows:   

here,  denotes for the expected binding affinity of a reference protein-ligand complex ; rscore, sf denotes for the binding score of this complex calculated by a scoring function sf; while b and k, respectively, are the intercept and the slope of the regression line between the binding scores and experimentally measured binding data of a set of protein-ligand complexes. similarly, the expected binding affinity of a query protein-ligand complex  calculated by the same scoring function is:   

by subtracting equation  <dig> from equation  <dig>  one has:   

replacing the expected binding affinity of r with the known experimental value , one has:   

equation  <dig> indicates how the binding affinity of a given protein-ligand complex is computed using the known binding affinity of a proper reference complex as a starting point. for the convenience of narration, this scoring strategy will be referred to as the kgs strategy, i.e. knowledge-guided scoring, throughout this article. in principle, any scoring method may be employed to compute the required binding scores of both the reference complex and the query complex in equation  <dig>  nevertheless, it is certainly more reasonable in reality to choose a capable scoring method for this purpose. the reference complex can be selected among a database of protein-ligand complexes with reliable structures and binding data. the constant k in equation  <dig> can be derived through a regression analysis between the experimental binding data and the computed binding scores by the employed scoring method on the same database. it is introduced to scale the outcomes of scoring functions, which could be in arbitrary units, to a realistic range comparable to the experimental binding data of the reference complex.

pharmacophore elucidation
considering the complicated nature of a protein-ligand binding process, choosing the proper reference complexes is obviously critical for the success of equation  <dig>  if complexes q and r share a similar pattern of protein-ligand interactions, our basic assumption of "similar structures have similar properties" is more likely to be true. thus, the core algorithm of our kgs strategy is how to define the right reference complex. in our study, the pattern of key protein-ligand interactions is presented as a pharmacophore model, which is actually the three-dimensional arrangement of a set of features including hydrogen bond donor, hydrogen bond acceptor, and hydrophobic center. our algorithm for receptor-based pharmacophore elucidation is similar to the one used by the pocket module implemented in the ligbuilder software  <cit> . the overall flowchart of our algorithm is shown in figure  <dig>  the results produced by this algorithm on a cdk2-inhibitor complex  are illustrated in figure  <dig> as an example.

the only input needed by our algorithm is the three-dimensional structure of a given protein-ligand complex, which can be an experimentally resolved structure or a computer model generated by molecular docking or other methods. in either case, the ligand molecule is required to be inside the binding site on the protein with the desired binding pose. the very first step of our algorithm is to identify the amino acid residues on the protein which are in direct contact with the bound ligand molecule. an amino acid residue is considered to be in direct contact with the ligand if any heavy atom on it is within a distance of  <dig>  Å from any heavy atom on the ligand. this distance cutoff is adjustable to the users. a box large enough is then used to enclose all of these residues as well as the ligand molecule . next, evenly spaced grids are created inside the box with a spacing of  <dig>  Å by default. each grid is checked for its accessibility by placing a hydrogen atom on it. if the hydrogen probe bumps with any protein atom, i.e. when the inter-atom distance of the two participating atoms is shorter than the sum of their van der waals radii minus  <dig>  Å, the grid under consideration will be labeled as "ignored". the van der waals atomic radii used in our algorithm are cited from the tripos force field. if a grid is more than  <dig>  Å away from any atom on the protein, it will also be labeled as "ignored", as there will be no direct interaction between the protein and any ligand atom placed on this grid. all "ignored" grids will be removed later on to speed up the following processes. as result, the remaining grids actually define the binding pocket for subsequent analyses.

for each remaining grid, three different types of probes are placed on it and the binding score between each probe and the protein are evaluated thereby. these probes include  a positively charged sp <dig> nitrogen atom , representing a hydrogen bond donor;  a negatively charged sp <dig> oxygen atom , representing a hydrogen bond acceptor; and  a sp <dig> carbon atom , representing a hydrophobic group. the binding scores between each probe and the protein are calculated by using the corresponding algorithms in the empirical scoring function x-score   <cit> . final classification of each grid will be determined according to the particular probe which produces the highest binding score, either as "donor", "acceptor", or "hydrophobic". for example, a grid labeled as "donor" indicates that a hydrogen bond donor is mostly preferred on this particular grid. all of the scored grids are further refined and clustered by a two-step process. at the first step, the average score is calculated over all donor grids. the donor grids whose scores are lower than the average score are re-labeled as "ignored". the same process is also repeated on the acceptor grids and the hydrophobic grids. consequently, only the grids with significant contributions to protein-ligand interactions will survive . at the second step, our algorithm checks each remaining donor grid and counts the total number of its "neighbors", i.e. the remaining grids of the same type within a range of  <dig>  Å. the average number of neighbors for all donor grids is calculated. those grids with a total number of neighbors below the average will be re-labeled as "ignored" and filtered out. the same process is also repeated on all acceptor grids and the hydrophobic grids. after this process, only the grids in aggregation will still survive, which represent the key interaction sites inside the binding pocket more clearly .

finally, a pharmacophore model is deduced based on the outcomes of all previous steps. a pharmacophore feature is used to represent each group of grids of the same type . the center of each pharmacophore feature locates on the grid with the highest "pharmacophore score" , which is computed as follows:   

here, psi is the pharmacophore score of the i th grid under consideration, sj is the binding score of the j th neighboring grid of this grid, and rij is the distance between the i th grid and the j th grid. according to this algorithm, the pharmacophore score of a certain grid combines the contributions from all its neighboring grids within  <dig>  Å. the spatial distribution of the neighboring grids also has an impact: a dense group of grids will be associated with a higher pharmacophore score; whereas the pharmacophore score for a sparse group of grids will be somewhat lower. besides, a correction is introduced in equation  <dig> to favor the pharmacophore features overlapping with the atoms on the ligand: the di in equation  <dig> is the distance between the i th grid and a close non-hydrogen atom on the given ligand. thus, if a pharmacophore feature overlaps exactly with a certain atom on the ligand, its pharmacophore score will retain by 100%; otherwise its pharmacophore score will receive a certain distance-dependent discount. in order to avoid the generation of too many pharmacophore features, our algorithm by default sets the minimal distance between two features to  <dig>  Å, approximately the average van der waals distance between two non-hydrogen atoms. the above process is repeated until all groups of grids are attributed to certain pharmacophore features. occasionally, too many pharmacophore features are deduced by our algorithm when the binding pocket is really large. thus, an upper limit of  <dig> features in a pharmacophore model is set for the sake of subsequent similarity searching. by using our program, the average computation time consumed by pharmacophore elucidation for a typical protein-ligand complex  was merely  <dig> ms on a low-end laptop with one  <dig>  ghz cpu and 2gb memory inside.

pharmacophore mapping
as implied above, the key interactions in the formation of a protein-ligand complex is characterized by a pharmacophore model. by our kgs strategy, the reference complex for a given query complex is the one sharing the maximal similarity in this aspect with the query complex. since a pharmacophore model is basically a set of vertices in space, the problem of defining the similarity between two pharmacophore models turns out to be equivalent to finding the common vertices between two sets of vertices. an algorithm was implemented in our program for this purpose . firstly, all possible matched pairs of features between the pharmacophore models p and q are identified. two features of the same type are considered to match each other. for example, feature a in model p matches feature e in model q. secondly, a hypothetical graph g is constructed on-the-fly using each matched pair of features as a new node. two nodes, e.g. ae and bf, are connected with an edge if the a-b distance in model p is close enough to the e-f distance in model q. here, two distances d <dig> and d <dig> are considered to be close to each other if d <dig> <k *d <dig>  or d <dig> <k *d <dig> . k is an adjustable parameter with a default value of  <dig> . then, the born-kerbosch  <cit>  clique detection algorithm is applied to identify the maximal clique in graph g. the maximal number of common features between models p and q in turn equals to the number of the nodes in the maximal clique. consequently, the similarity index  between models p and q is calculated by the tanimoto method  <cit> :   

here, np and nq are the numbers of pharmacophore features in models p and q, respectively; while npq is the maximal number of common features found between p and q.

for any given protein-ligand complex, an external database of known protein-ligand complexes supplied by the user will be examined with the algorithm described above. the complex with the highest similarity index, if higher than a user-set cutoff, is chosen as the reference in equation  <dig> for calculating the binding affinity of the query complex. by using our program, the similarity search is fairly fast, which took less than  <dig> ms to map a pair of pharmacophore models on a low-end laptop with one  <dig>  ghz cpu and 2gb memory inside.

preparation of test sets
three sets of protein-ligand complexes selected from the pdbbind database  <cit>  were used as the test sets in our study. the pdbbind database provides a collection of experimentally determined binding data of the protein-ligand complexes deposited in the protein data bank   <cit> . the protein-ligand complexes considered in this study were all selected from the "refined set" of the pdbbind database , which consists of  <dig> protein-ligand complexes with high-quality structures and reliable binding data. compilation of the pdbbind refined set has been described in one of our recent publications  <cit> . briefly, each qualified protein-ligand complex in this data set has the following features:

 the complex structure is resolved through x-ray crystal diffraction with an overall resolution better or equal to  <dig>  angstroms. neither the protein nor the ligand has any missing fragment in the crystal structure.

 binding data of the complex is experimentally measured as either dissociation constant  or inhibition constant . both the protein and the ligand used in binding assay match exactly the ones used in structure determination.

 the complex is formed by one protein molecule and one ligand molecule in a binary manner, and the binding is non-covalent in nature. the ligand molecule does not contain any uncommon elements, such as be, b, si and metal atoms, and its molecular weight does not exceed  <dig> 

each test set was composed of a number of protein-ligand complexes formed by one particular type of protein, including  <dig> hiv protease complexes,  <dig> carbonic anhydrase complexes, and  <dig> trypsin complexes, respectively . these three proteins were chosen since they were the three most populated ones in the pdbbind refined set. the structural files of all of these complexes were downloaded from pdb. they were then processed so that they could be readily utilized by the modeling software available to us. firstly, a complete biological unit of each complex was split into a protein molecule and a ligand molecule. atomic types and bond types of the ligand molecule were automatically assigned by the i-interpret program  <cit> . they were then visually inspected and corrected if necessary. hydrogen atoms were added to the protein and the ligand by using the sybyl  <cit>  software. for the sake of convenience, both the protein and the ligand were set according to a simple protonation scheme under neutral ph: all carboxylic acid and phosphonate groups were deprotonated; while all aliphatic amine and guanidino/amidino groups were protonated. all water molecules included in the crystal structure were removed. metal ions, if residing inside the binding pocket and forming coordinate bonds to the ligand , were kept with the protein molecule. no structural optimization was performed on either the protein or the ligand in order to retain their coordinates exactly the same as those in the original pdb file.

in addition, a set of putative binding poses were prepared for the ligand molecule in each complex in all three test sets. these binding poses were generated with the gold software  by docking the native ligand into its co-crystallized protein target. the parameter "no. of ga operations" was set to  <dig> to get docking poses as diverse as possible. the chemscore scoring function implemented in gold was chosen as the scoring engine. all other parameters were assigned the default values. a total of  <dig> top-ranked docking poses were retained for each ligand. the root-mean-square deviations  from the native ligand pose of each docking pose was calculated using the "rms_analysis" utility in gold.

regarding the hiv protease test set, at least one docking pose with rmsd <  <dig> Å from the native binding pose are found among all gold-generated docking poses for  <dig> ligands out of the total  <dig>  it indicates that near-native poses were successfully generated for most ligands with our method. the average rmsd of the docking poses for these  <dig> ligands was  <dig>  Å, indicating that those docking poses were also diverse. another  <dig> ligands had at least one docking pose with rmsd falling in the range of 2~ <dig> Å. our method failed to produce docking poses with rmsd <  <dig> Å only for three ligands in the hiv protease test set. these three cases were all associated with large and flexible ligand molecules. as for the carbonic anhydrase and the trypsin test sets,  <dig> out of  <dig> and  <dig> out of  <dig> ligands, respectively, had at least one docking pose with rmsd <  <dig> Å from the native ligand pose among all gold-generated docking poses. finally, the corresponding native binding pose observed in crystal structure was added to the ensemble of gold-generated docking poses for each ligand to ensure that the most important point in the conformational space of each ligand was sampled.

evaluation of scoring methods
our recent study  <cit>  revealed that two scoring functions, i.e. x-score  <cit>  and plp  <cit> , have relatively better performance in binding affinity prediction than other scoring functions. they were thus chosen in this study to test the kgs strategy. note that x-score has three built-in options, i.e. hpscore, hmscore, and hsscore. in many cases, the difference in the outcomes of these three options is marginal. for the sake of convenience, only the average value of these three options in x-score was considered in our study. similarly, plp also has two variations, i.e. plp <dig> and plp <dig>  only plp <dig> was considered in our study. the x-score program was obtained from its original authors. plp <dig> was implemented by us according to the descriptions given in the original references  <cit>  as well as the information given in the user manual of the discovery studio software   <cit> . we compared the results produced by our in-house implementation of plp <dig> and those produced by the one implemented in discovery studio on the entire pdbbind refined set. these two sets of results were found to be almost identical , indicating that our own implementation of plp <dig> was correct.

for each test set, both x-score and plp <dig> were used to compute the binding scores of all member protein-ligand complexes. for each given complex, the pharmacophore mapping algorithm described in a previous section was applied to identify a proper reference complex among the other complexes included in the same test set. if such a reference complex was found, an adjusted binding score of the given protein-ligand complex was computed with equation  <dig> based on the known binding constant of the reference complex. if not, the binding score of the given protein-ligand complex was unchanged. this process was repeated until all protein-ligand complexes in each test set had been processed. then, the pearson correlation coefficient  between the experimentally determined binding constants and the final binding scores was calculated. the standard deviations  in fitting the computed binding scores to the experimental binding constants were used as a quantitative measurement of the accuracy of each scoring method for comparison. the smaller is the standard deviation, the better is the accuracy.

the computations described above were all based on experimentally resolved protein-ligand complex structures, and the corresponding results are referred to as set i throughout this article. in the reality of binding affinity prediction, however, one needs to rely on predicted structures in most cases. thus, it is necessary to test our kgs strategy in such scenarios as well. for this purpose, a total number of  <dig> putative docking poses were prepared for each ligand in all three test sets. for each complex, all of these docking poses as well as the native binding pose were computed by x-score and plp, respectively, using the same procedure described in the previous paragraph. the binding score of each docking pose was adjusted using equation  <dig> whenever applicable. then, the best binding score obtained across all docking poses and the native binding pose for each protein-ligand complex was considered in the correlation analysis with the experimental data. in other words, the docking poses generated by the gold software were actually rescored by x-score and plp in combination with our kgs strategy. the corresponding results are referred to as set ii throughout this article.

RESULTS
performance on hiv protease complexes
as revealed in our recent evaluation on scoring functions  <cit> , virtually no scoring function was able to provide reasonable predictions of the binding affinities of hiv protease complexes. for example, the correlation coefficients  between the experimental binding constants of the  <dig> hiv protease complexes in our test set and the binding scores computed by x-score and plp are  <dig>  and  <dig> , respectively . the disappointing performance of these two scoring functions may be attributed to the relatively large and flexible binding site of hiv protease, which remains as a challenge for scoring functions as well as other scoring methods.

hiv protease complexes
carbonic anhydrase complexes
trypsin complexes
a pearson correlation coefficient between the experimental binding constants of these complexes and the binding scores produced by the given scoring function.

bstandard deviation in regression 

cslope of the regression line, which is needed in equation  <dig> 

the standard deviations produced by x-score and plp by using crystal structures are plotted as a function of the similarity cutoffs considered in reference searching in figure 4a. detailed statistical results can be found in the additional file  <dig>  table s <dig>  one can see that the standard deviations produced by x-score+kgs, i.e. x-score in combination with the kgs strategy, are consistently lower than those produced by x-score alone, indicating that the kgs strategy is really helpful to improve the accuracy in binding affinity prediction. in particular, the improvement is obvious when the similarity cutoff used in defining the reference complex is above  <dig> , and the standard deviations of x-score+kgs drop below  <dig>  log units. this is logical since our kgs strategy is not supposed to be effective if the reference complex does not share a similarity high enough to the query complex. the similarity cutoff of  <dig> , by which kgs starts to work, actually can be expected. we noticed that a medium-size ligand molecule typically occupies four to five pharmacophore features in binding pocket . assuming that both the ligand molecule in the query complex and the ligand molecule in the reference complex occupy five pharmacophore features and three out of the five features match between the query and the reference, the similarity index would be 3/ =  <dig>  according to equation  <dig> 

the five pairs of hiv protease complexes with the highest similarity identified by our algorithm are summarized in table  <dig>  the chemical structures of the five ligand molecules in the complexes are shown in figure  <dig>  one can see that the ligand in pdb entry 1b6m is actually identical to the one in its reference, i.e. pdb entry 1mtr; while the ligands in pdb entries 1hvj, 1hvk, and 1hvl are basically stereoisomers to those in their references. these findings indicate that our algorithms for pharmacophore deduction and mapping are capable to identify complexes sharing similar patterns of protein-ligand interactions. note that x-score underestimated the absolute binding constants of complexes 1hvj, 1hvk, and 1hvl consistently by 1- <dig>  log units. after the application of our kgs strategy, this systematic deviation has been largely corrected, resulting in a much reduced average error.

pdb
the results produced by plp in combination with the kgs strategy  basically reveal the same trend: at lower similarity cutoffs, the improvements exhibited by plp+kgs over plp alone are not obvious; while at higher similarity cutoffs, considerable improvements are observed, demonstrating the success of the kgs strategy again. an exception is that plp alone produced acceptable results on the five complexes listed in table  <dig>  but this can be well interpreted as a coincidence. interestingly, considerable improvements are also observed above the similarity cutoff of  <dig> , exactly the same as the case of x-score+kgs. in addition, the corresponding results produced by x-score+kgs and plp+kgs are really close on all subsets of complexes when the similarity cutoff >  <dig>  although the performance of two scoring functions alone can be very different. these findings further support our statement that the success of the kgs strategy is in principle independent from the scoring method employed in computation.

when computer-generated docking poses are considered in scoring for instead, i.e. set ii, the standard deviations produced by x-score and plp as a function of the cutoffs used in similarity search are plotted in figure 4b. detailed statistical results can be found in the additional file  <dig>  table s <dig>  the same trend as in set i results are observed for both x-score and plp: the performance of both scoring functions is improved by the kgs strategy when the similarity cutoff used in reference searching is higher than  <dig> . the standard deviations of both scoring functions are lowered by  <dig>  units or even more. this observation indicates that our kgs strategy can be applied not only to the complexes with experimentally determined structures but also predicted structures, e.g. the docking poses generated by a molecular docking program. this feature may make kgs a valuable strategy for "real" drug design tasks, such as structure-based virtual screening. it should be mentioned that the standard deviations at different similarity cutoffs in set ii results are somewhat larger than the counterparts in set i results. it is understandable since for some complexes in this test set, the native binding pose of the ligand molecule is not necessarily the best-scored binding pose selected by scoring function, which is a well-known phenomenon  <cit> . this defective aspect of scoring function of course introduces extra noises in binding affinity prediction.

performance on carbonic anhydrase complexes
compared to the performance on the hiv protease test set, x-score and plp are more successful on this test set. the standard deviations calculated by these two scoring functions are  <dig>  and  <dig>  log units, respectively . the standard deviations produced by x-score, plp and those in combination with the kgs strategy on this test set are plotted as a function of the similarity cutoffs used in reference searching in figure  <dig>  detailed statistical results are summarized in the additional file  <dig>  tables s <dig> and s <dig> 

when only the crystal structures are considered in scoring , one can see that the standard deviations produced by x-score+kgs at various similarity cutoffs are consistently lower than or comparable to those produced by x-score alone . the same trend retains when the scoring method is switched to plp. when the docking poses are considered in scoring , the standard deviations produced by x-score+kgs and plp+kgs are basically lower than those produced by x-score and plp alone when the similarity cutoff is above  <dig>  . in both cases, however, the improvement after the application of the kgs strategy is not as significant as the one observed on the hiv protease test set. it is understandable since as mentioned above, the performance of x-score and plp alone is already good on this test set, leaving not much room for improvement. considering the intrinsic accuracy of the employed scoring functions as well as the uncertainties in experimental binding data, there is certainly a limit on the average accuracy of binding affinity prediction. note that after the similarity cutoff in defining the reference complexes is raised above  <dig> , the standard deviations produced by x-score+kgs and plp+kgs are consistently below  <dig>  log units . we believe that this level of accuracy, if having not reached the limit of scoring functions, should be rather close to it.

another trend observed in figure  <dig> is that x-score+kgs and plp+kgs produced comparable statistical results especially when the similarity cutoffs are relatively high. in contrast, there is noticeable difference in the statistical results produced by x-score and plp alone under the same circumstances. in fact, exactly the same trend can be observed on the hiv protease test set as well . each scoring function has its own strength and weakness, and thus one would expect that different scoring functions produce different results on the given systems. therefore, the users have to test on their selected targets a number of scoring functions or even combinations of scoring functions before any prediction can be made. our results indicate that once scoring functions are combined with the kgs strategy, they tend to produce converged results since the difference between their outcomes are largely leveled off by the use of a reference. this feature will bring great convenience to the users in practice.

performance on trypsin complexes
compared to the performance on the hiv protease test set, x-score and plp are also more successful on this test set, producing standard deviations of  <dig>  and  <dig>  log units, respectively . the standard deviations produced by x-score, plp and those in combination with the kgs strategy on this test set are plotted as a function of the similarity cutoffs used in reference searching in figure  <dig>  detailed statistical results are summarized in the additional file  <dig>  tables s <dig> and s <dig>  interestingly, when only the crystal structures are considered in scoring , both x-score+kgs and plp+kgs produce marginally larger standard deviations than x-score and plp alone on this test set . when the docking poses are considered in scoring for instead , x-score+kgs and plp+kgs produce lower standard deviations than x-score and plp alone only when the similarity cutoff applied to defining reference complexes is really high  . unlike the results obtained on hiv protease complexes and carbonic anhydrase complexes, these results are quite unexpected, which drove us to look for the reason.

the six pairs of trypsin complexes with the highest similarity in this test set are summarized in table  <dig>  the chemical structures of the six ligand molecules in the complexes are shown in figure  <dig>  one can see that in one case  x-score+kgs produced a notably larger error than x-score alone. the experimental binding constants of complex 1o2o and its reference 1o2k  are  <dig>  and  <dig> , respectively. the ligand molecule in complex 1o2o has one additional fluorine atom at the ortho-position of the aminidino group as compared to the ligand in complex 1o2k, which reduces the binding constant by approximately three folds. this reduction in binding affinity may be attributed to the unfavorable dipole-dipole repulsion between this fluorine atom and a nearby hydroxyl group on the side chain of ser <dig> . such dipole-dipole repulsions are indeed not taken into account by x-score  <cit> . the binding scores produced by x-score for complexes 1o2o and 1o2k are  <dig>  and  <dig> , respectively, giving a wrong ranking of these two complexes. consequently, if x-score+kgs is applied to predict the binding constant of 1o2o based on the known binding constant of 1o2k, it can only produce a binding score higher than the one of 1o2k, resulting in an even larger error  than the one produced by x-score alone . we have observed that x-score also produced wrong rankings of some other pairs of trypsin complexes, but 1o2o/1o2k is the one which contributes most to the larger deviations produced by x-score+kgs on this test set.

pdb
the above analysis suggests that failure of the kgs strategy in this case is caused directly by the intrinsic inaccuracy of the employed scoring function. in theory, our kgs strategy can effectively reduce the systematic errors in the predicted absolute binding constants. it thus becomes critical for the employed scoring function to produce correct rankings for the given complexes, a feature termed as "ranking power" in our recent study  <cit> . in that study, we demonstrated that today's best scoring functions are able to provide correct rankings for only 50-60% of the protein-ligand complex families under consideration. a much improved "ranking power" perhaps should be the primary aim for future scoring functions. technically, developers of scoring functions may want to examine the ranking coefficient, such as the spearman coefficient, more closely than the conventional pearson coefficient between experimental binding constants and computed binding scores.

another possible reason for the failure of the kgs strategy in this case lies in our algorithm for pharmacophore elucidation. in our study, a pharmacophore model actually represents a set of key protein-ligand interactions, and our kgs strategy relies on pharmacophore models for defining reference complexes. such a pharmacophore model is dependent on the compositions as well as the conformations of both the protein and the ligand. our algorithm only considers three types of features, i.e. hydrogen bond donor, hydrogen bond acceptor, and hydrophobic center. other basic protein-ligand interactions, such as cation-pi interaction, are ignored for convenience. besides, a pharmacophore has to contain a limited number of features to be practical. therefore, some aspects in protein-ligand interactions may be missing. simplification made in a pharmacophore model may lead to the choice of an inappropriate reference complex. given these flaws, we have observed that our algorithm in some cases produced results controversial to commonsense. for example, complexes 1o2j and 1o2k are formed by an identical protein  and an identical ligand , but the similarity between their pharmacophore models produced by our algorithm is only  <dig> . although these two complexes do exhibit some conformational difference in their binding pockets, one certainly expects a higher similarity score in this case. our algorithm for pharmacophore elucidation certainly can be improved further.

comparison with other targeted scoring methods
as mentioned in the introduction section, current targeted scoring functions  <cit>  are developed typically through re-parameterization or modification on existing all-purpose scoring functions, which often relies on some sophisticated statistical procedures. in contrast, our kgs strategy works in a different fashion. there are two basic modules in the framework of kgs: one is a scoring method, and the other is a method for defining the reference complexes. as for the scoring method, we have tested x-score and plp in this study. but it can be any well-validated scoring function or other approach. once the scoring method is chosen, it can be applied as is without re-parameterization or modification. this is important since many programs are available to the end-users as black boxes. as for the method for defining reference complexes, our current algorithm is based on comparison of structure-based pharmacophore models of relevant protein-ligand complexes. other algorithms of course may be considered as well, such as the protein-ligand interaction fingerprints  <cit> . thus, these two modules can be chosen independently, and it is in principle flexible to combine them. this is a notable technical advantage of our kgs strategy, and that is why we refer to it as a strategy rather than a particular method.

compared to most targeted scoring functions, another technical advantage of our kgs strategy is that its application is in principle not limited to certain classes of targets. in order to apply the kgs strategy, an external database of protein-ligand complexes with known three-dimensional structures and experimental binding data needs to be supplied as a knowledge set. if one needs to consider protein-ligand complexes of various types, this knowledge set may consist of a sufficient number of protein-ligand complexes of various types, such as the pdbbind database. otherwise, if one's study focuses on a particular class of protein-ligand complexes, one may want to supply a knowledge set only consisting of relevant protein-ligand complexes, such as the test sets used in this study. in practice, most researchers study a certain congeneric class of ligands bound to a common target protein, and thus the latter approach is more suitable for this purpose. note that in such a case, one can even employ a targeted scoring function, if available, as the internal scoring method for the kgs strategy to obtain more accurate results. in this sense, our kgs strategy is fully compatible with targeted scoring functions.

it should be mentioned that our kgs strategy is similar to the autoshim method proposed by martin and sullivan  <cit>  in certain aspects. autoshim does not require re-parameterization of scoring function either, and in principle does not tie to any specific scoring functions. according to autoshim, point-pharmacophore like "shims" are generated in the binding pocket on the target protein. these "shims" are then weighted by partial least squares  regression to adjust the outcomes of the flo+ scoring function in order to better reproduce known binding data. nevertheless, autoshim is basically a 3d-qsar model, which integrates the flo+ score as well as several hundred of descriptors . such a model normally needs to be carefully validated to avoid over-fitting since it relies on so many parameters. as a matter of fact, martin et al mentioned that their pls model produced comparable results with or without the flo+ score in the entire descriptor set . in contrast, the internal scoring function  in our kgs strategy plays an indispensable role. another common aspect between autoshim and our kgs strategy is that both methods require a training set of protein-ligand complexes with known experimental binding data. as a qsar-like method, autoshim relies much on this training set for model calibration. for our kgs strategy, the training set is also used for deriving the scaling parameter k in equation  <dig>  but it serves primarily as a knowledge set for defining appropriate reference complexes. using an appropriate reference contributes most to the improved accuracy of our kgs strategy in binding affinity prediction.

finally, as mentioned repeatedly in this article, our kgs strategy computes the binding constant of a given protein-ligand complex based on the known binding constant of a reference complex. it is essentially an interpolation method. we all know that more accurate results can be obtained through interpolation if more known data exist in the problem space. the knowledge of protein-ligand binding data is certainly in a constant increase. for example, binding data included in the pdbbind database increase by approximately 25% each year. thus, application of the kgs strategy will hopefully produce more and more accurate results with the increase in such knowledge. in contrast, other targeted scoring functions benefit indirectly from the increasing knowledge of binding data since re-calibration on a larger data set does not necessarily produce a more accurate model. besides, the majority of experimental binding data as well as crystal structures are actually owned by pharmaceutical companies, which are not available to the public for understandable reasons. researchers from pharmaceutical companies can supply their in-house data as the external knowledge set required by the kgs strategy so that their own data can be effectively utilized in binding affinity prediction as well.

CONCLUSIONS
we have developed a general strategy, i.e. knowledge-guided scoring , for improving the accuracy of scoring functions in binding affinity prediction. our kgs strategy computes the binding constant of a given protein-ligand complex based on the known binding constant of an appropriate reference complex. the reference complex is required to share a similar pattern of protein-ligand interactions to that of the complex of interest. thus, some uncertain factors in protein-ligand binding, which are difficult to be accurately considered by scoring functions, may cancel out in computation, resulting in more accurate prediction of absolute binding affinities.

our kgs strategy was evaluated in combination with x-score and plp on three sets of protein-ligand complexes. as for the hiv protease complexes, x-score and plp alone failed to provide acceptable prediction of binding constants; while both x-score+kgs and plp+kgs demonstrated notably improved performance especially when the similarity cutoff used in reference searching was relatively high. as for the carbonic anhydrase complexes and trypsin complexes, both x-score and plp were able to provide reasonable results by themselves. application of the kgs strategy in these two cases only produced marginally better or comparable results due to limited remaining room for improvement. an interesting observation is that x-score+kgs and plp+kgs produced converged results despite the difference in the outcomes of x-score and plp alone. this prompts that application of the kgs strategy may save the end-users, at least to some extents, from the troublesome evaluation and shopping among different scoring functions. besides, the standard deviations between the experimental and computed binding constants produced by x-score+kgs and plp+kgs are below  <dig>  logkd units  on all three test sets when the similarity cutoff is over  <dig> . this level of accuracy is certainly acceptable for high-throughput tasks in structure-based drug design. it however remains to be verified if application of kgs is able to achieve this level accuracy consistently on other classes of protein-ligand complexes.

in principle, kgs can be applied in combination with any existing scoring functions. unlike many other targeted scoring functions, kgs does not require re-parameterization of the given scoring function, and its application is not limited to certain classes of protein-ligand complexes. in addition, kgs is essentially an interpolation method, and thus its effectiveness is in theory proportional to the ever-increasing knowledge of experimental binding data. in-house collections of binding data can be effectively utilized by kgs in computation as well. compared to other targeted scoring functions, these features make our kgs strategy a more practical remedy for current scoring functions to improve their accuracy in binding affinity prediction. nevertheless, we did not attempt to test the kgs strategy in this study to see if it also helps with binding mode prediction, or achieves higher success rates in cross-docking or hit rates in virtual screening. for those purposes, we believe that our current algorithms for applying kgs may need certain adjustments.

authors' contributions
tc implemented the algorithms for pharmacophore elucidation and comparison, evaluated the kgs strategy, performed subsequent statistical analyses, and drafted this article. zl prepared the three test sets used in the evaluation of the kgs strategy and contributed to programming as well. rw conceived of this study, coordinated and supervised its execution, revised the manuscript substantially for important intellectual contents. all authors have read and approved the final manuscript.

supplementary material
additional file 1
supplementary tables s1-s <dig>  detailed statistical results for making figures  <dig>   <dig> and  <dig>  which were produced by x-score and plp in combination with the kgs strategy on three test sets based on native binding poses as well as computer-generated docking poses. • table s1: statistical results obtained on the hiv protease complexes using native binding poses in scoring • table s2: statistical results obtained on the hiv protease complexes using docking poses in scoring • table s3: statistical results obtained on the carbonic anhydrase complexes using native binding poses in scoring • table s4: statistical results obtained on the carbonic anhydrase complexes using docking poses in scoring • table s5: statistical results obtained on the trypsin complexes using native binding poses in scoring • table s6: statistical results obtained on the trypsin complexes using docking poses in scoring

click here for file

 acknowledgements
the authors are grateful to the financial supports from the chinese national natural science foundation , the chinese ministry of science and technology , and the science and technology commission of shanghai municipality . the authors also thank dr. xun li, dr. fu lin, dr. yan li, jie li and jiajie li for their contributions to the development and maintenance of the pdbbind database.
