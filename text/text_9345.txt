BACKGROUND
metabolomic profiling in general aims to identify or confirm biomarkers that are represented by specific metabolite intensity profiles in the context of different physiological and/or experimental conditions. these conditions may represent different phenotypes of a species, disease or environmental and genetic perturbations, or a time course comparing different developmental or physiological stages of an organism  <cit> . high-throughput analytical measurements, as obtained from mass spectrometry experiments  <cit> , provide a large number of intensity profiles for accumulation of different metabolites. these data sets show an even higher complexity when repeated measurements for each condition have been performed. for an interpretation based on the experimental conditions these replicas need to be aggregated using e.g. the corresponding mean or median value. for comparative analysis of relative metabolite concentrations it is usually necessary to normalize the resulting intensity vectors, e.g according to a unit euclidean or "city block" norm. in the following, the aggregated and normalized multivariate intensity profiles are referred to as marker candidates.

clustering is a well-established technique in the context of gene expression analysis and coexpression studies  <cit> . intensity-based clustering by analogy aims to group similar intensity profiles in order to identify interesting groups of marker candidates and visualize them in a convenient way. a major problem with the application of clustering algorithms is that an adequate number of clusters can often not be inferred automatically. a purely data-driven approach always bears the risk of over- or under-clustering because the correct number of clusters usually depends on task-specific constraints  <cit> . one-dimensional self-organizing maps  <cit>   realize a linear array of prototypes that correspond to local averages of the data, ordered according to their similarity. in metabolomic analysis the visualization of ordered prototypes provides a quick overview on relevant intensity patterns in the data and allows to easily merge neighboring groups of marker candidates into meaningful clusters. for example, in  <cit>  we detected a significant number of clusters representing different physiological stages during a plant wounding time course as described in  <cit> .

the 1d-som realizes a robust and reproducible ordering in particular with regard to changing data quality  <cit> . unlike the classical two-dimensional self-organizing maps   <cit> , which are utilized in a number of software tools for gene expression analysis  <cit>  and metabolomics  <cit> , 1d-soms allow a simultaneous visualization of the clustering and the underlying intensity profiles by means of the topologically ordered prototype array. this visualization corresponds to a two-dimensional color-coded matrix, where the first dimension represents the prototype order and the second dimension represents the experimental conditions. while 2d-soms can be used to visualize the two-dimensional variation in a single condition, 1d-soms provide a complete view on the one-dimensional variation in all conditions simultaneously. therefore, 1d-soms provide a convenient overview of highly complex metabolomic data sets. beside a number of general software packages, like the well-known som toolbox  <cit>  or the "clustering for business analytics" and som packages for the r-project  <cit> , several more specific tools  <cit>  provide functions to order and visualize multivariate intensity profiles along a one-dimensional array. though, none of them provides a specialized interface for convenient 1d-som visualization and analysis of metabolomics data.

in the following, we introduce the marvis  tool, which implements the concept of 1d-som clustering and visualization. based on an example workflow, the functionality and utility of marvis is demonstrated.

implementation
marvis was written in the matlab® programming language and has been compiled for microsoft® windows xp/vista and linux x <dig>  execution of the software requires installation of the matlab® compiler runtime, which is provided with marvis. the installation packages and the documentation can be downloaded from the project home page .

for data import and export marvis uses the csv  file format, which can easily be processed by statistical analysis software and spreadsheet applications. besides data set meta information and customizable headers, a csv file for use with marvis consists of marker candidate-specific lines. each line contains data fields with intensity measurements for all conditions and replicas . by default, marvis performs an aggregation of repeated measurements for each condition using the corresponding mean or median value. the resulting intensity vectors are normalized before clustering using the euclidean or "city block" norm or a z-score transformation. if alternatively normalized intensity profiles should be used for clustering, these user-normalized profiles can be stored as additional data in the csv file. it is also possible to store additional marker candidate properties, which are displayed by marvis as text. for high-contrast visualization of prototype and marker candidate profiles marvis uses customizable colormaps, which map original and normalized intensity values to a broad color spectrum. the colormapping for original and normalized intensities is calculated independently according to the respective minimum and maximum intensity values.

RESULTS
in the following, the functionality of marvis is demonstrated on the basis of a metabolomic case study of a plant wounding experiment analyzed by ultra performance liquid chromatography coupled with an orthogonal time-of-flight mass spectrometer as described before in  <cit> . the data set contains  <dig> marker  candidates for the wound response of the thale cress arabidopsis thaliana under  <dig> conditions. the first four conditions reflect the metabolic situation within a wounding time course of wild type  plants starting with the control plants followed by the plants harvested  <dig> ,  <dig> and  <dig> hours post wounding. the conditions  <dig> to  <dig> represent the same time course for the jasmonate deficient mutant plant dde 2- <dig>  <cit> . each condition contains  <dig> replica samples. the corresponding data set is supplied with the marvis tool as a csv file .

file import
the data set is imported using the open for clustering entry in the file menu. after choosing the input file , marvis displays the import dialog, where the delimiter character , the start row  and column of the header , the number of conditions , and the number of samples for each condition  are specified. in this example, we use the mean intensity value for aggregation of replicas and the euclidean norm for normalization of intensity profiles .

clustering
after confirmation of the import options, the clustering dialog is opened. here, a title  and the number of prototypes  have to be specified. marvis starts the iterative clustering process and displays the intermediate prototype intensity profiles for each clustering state and the number of currently associated marker candidates in a separate window. the clustering process for the example data set only takes a few seconds on a standard pc. after the clustering process has been finished, the clustering state can be selected according to the desired degree of prototype smoothing  by adjusting a scrollbar . here, we choose the final clustering state corresponding to a minimal amount of smoothing, which is suitable for analysis in most cases.

visualization and analysis
after selection of an appropriate clustering state for analysis, marvis returns to the main window and displays the prototype profiles and the number of associated marker candidates in the upper right region. after mouse click on a column corresponding to a particular prototype, further information regarding this prototype is displayed in the other regions of the main window .

the prototype plot shows the array of prototypes according to the current colormap  and additional information on the associated marker candidates . the vertical axis of region 1a represents the number of data set conditions, while the horizontal axis corresponds to the prototype numbers. a cursor  marks the current prototype under investigation. by default, the displayed prototype profiles are equally spaced and region 1b shows the associated cluster sizes as a bar diagram. clicking on the toggle view button changes between different graphical representation modes. besides the default view, the prototype profiles can be spaced according to the size of their associated clusters, which helps to identify dominating intensity profiles . in this case, region 1b contains the original or normalized intensity profiles of the marker candidates associated with each prototype. the title above region 1a indicates, which graphical representation mode is currently activated. by clicking on one of the columns corresponding to a prototype  the associated cluster can be activated.

for the data set of the wounding case study the prototype plot  reveals

• a block of marker candidates that show high intensities in the conditions representing wt plants only 

• an intermediate block of different profiles representing high intensities across wt and dde 2- <dig> mutant plants 

• a block of prototypes that show high intensities in the jasmonate deficient mutant plants only 

• and a block of candidates that particularly represent high concentrations in the third and eighth condition .

the first block corresponds to clusters in  <cit>  that contain wound induced markers exclusively associated with wild type plants as described in  <cit> . in addition, clusters related to the third block contained markers that seem to be dependent on the jasmonate deficiency.

the corresponding bar diagram  shows that a number of clusters contain just a few or no marker candidates at all . these "sparse" clusters result from the restriction of the prototypes on a 1d-topology and usually indicate the use of too many prototypes.

the cluster plot  shows the intensity profiles of marker candidates in the activated cluster. each column represents the intensity profile of a single marker candidate displayed according to the current colormap. a cursor  indicates the currently activated candidate. by clicking the toggle view button, marvis switches between normalized and original intensities. by default normalized intensities are shown. the example data set shows large differences regarding the original intensity values. this results in a colormapping, where low original intensities cannot be visually distinguished. when the logarithmic intensities checkbox in the view menu is activated, the colormapping for original intensity profiles is calculated logarithmically. this improves the visibility of small intensity differences significantly . the logarithmic transformation is only used for the visualization of original intensity profiles and does not affect the clustering results.

the marker information box  shows a table of available information on all marker candidates in the currently activated cluster. each candidate is represented by one row. apart from marker candidate id , retention time  and mass-to-charge-ratio , also the values for additional data attributes  are displayed. in this example, the column kwpvalue represents p-values obtained from a kruskal-wallis test  <cit> . these values have been used as a quality measure for selection of marker candidates in  <cit> . by pressing the up and down cursor keys or selecting a particular row via mouse click, the specific candidate can be highlighted. within the marker information box, the candidates are sorted by retention time. marvis keeps this order of the input file when displaying the candidates of single clusters.

the marker scatter plot  displays the rt vs. m/z values of each marker candidate in the currently activated cluster using big red dots. the currently activated candidate is represented by a big blue dot. in the background all marker candidates of the data set are plotted as small gray dots. by clicking into the plot a particular candidate can be activated. using the scatter plot, putative isotopomers or adducts of compounds can easily be identified by vertical stacks of candidates that do not differ in retention time .

the active-prototype/marker plot  by default displays the magnified prototype of the activated cluster according to the current colormap.

additional functionality
marvis stores a list of selected marker candidates in memory. single candidates or entire clusters can easily be added to or removed from this list. the selected marker candidates can be exported as a csv file for further analysis, e.g. for identification of related metabolic pathways based on mass values of candidates  <cit> . the candidates may also be re-clustered using a lower number of prototypes in order to avoid sparse clusters. in addition to the export of selected marker candidates, marvis can save the entire clustering result as a csv file. this includes the marker data with additional values for normalized marker candidates , cluster number, and intensity profiles of the associated prototypes. the current settings, which include the data set and all user-specific parameters , can be saved and restored. for details on the above-mentioned functions see the marvis documentation.

CONCLUSIONS
marvis provides a graphical user interface for exploratory data analysis, well-suited for the visualization of metabolomic intensity profiles. the realization of 1d-soms gives a convenient overview of multivariate data sets. in particular, the specialized visualization effectively supports researchers to cope with the problem of an unknown number of biologically meaningful groups of intensity profiles. in that way, interesting groups can easily be identified based on their intensity patterns and their position in the prototype array. additional data attributes that support the analysis and interpretation of marker candidates can be integrated in marvis using customized data fields in the csv input file. by using the csv export functions, the clustering results can be imported and processed by other statistical analysis software. the customizable csv file format also allows to import, cluster and analyze experimental data from other than metabolomic studies, e.g. from gene expression experiments. an example application on gene expression data is shown in the marvis documentation.

availability and requirements
• project name: marvis

• project home page: 

• operating system: microsoft® windows xp/vista and linux x86

• programming language: matlab®

• other requirements: matlab® compiler runtime  <dig>  

• license: free for academic use

authors' contributions
ak implemented the marvis graphical user interface and drafted parts of the manuscript. tl contributed conceptually and drafted parts of the manuscript. kf, cg and if provided the metabolomic case study data set, tested the software, contributed conceptually and drafted parts of the manuscript. pm implemented the clustering algorithm and drafted parts of the manuscript. all authors read and approved the final manuscript.

