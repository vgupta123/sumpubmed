BACKGROUND
in a world that is becoming more interconnected every day we find ourselves with increased frequency being in close vicinity to people that are outside our normal environment. to understand how infectious agents disseminate throughout a population it seems therefore essential to model the social model in a realistic manner. monitoring the actual interactions between people is in general unrealistic, although it is plausible in time and space-restricted environments. large-scale realistic population modeling is plagued with problems of being time and effort consuming; to add to this, individual contacts are normally either estimated or based on self-reported data. lastly, while the insight gathered by experimenting with such a model could definitely be used for similar social environments, it remains to be understood what precisely determines this similarity. on the other hand, local-scale modeling may be very precise but involves issues of consent and privacy as study participants usually need to agree to wearing some kind of a tracking device. it is unclear whether the local behavior of people that work in the same place, or attend the same event, can be extrapolated to global behavior.

approach
under these circumstances, we approach the problem from a novel angle: we approximate the actual social model by using contacts extracted from real social networks. the advantage is that these networks can be extracted from already existing sources and they faithfully record interactions between people in their natural environment. our purpose is to understand how the infection spreads depending on the structure of the contact network and the individuals who introduce the infection in the population. this would help public health authorities to respond more efficiently to an epidemic since it would answer questions such as: how many people will be affected at any given time and how does the epidemic propagate? how many individuals will need hospitalization and treatment? how many individuals -and which- would need to be targeted to stop, or at least slow down, an epidemic? what would be an effective vaccination policy to implement? how long will the epidemics last with and without intervention? this work is a step towards successfully addressing these issues. more specifically, the purpose of the work we present in this paper is to accurately model the evolution of an epidemic in specific populations over a short to medium time span depending on the characteristics of the social model. based on the dissemination patterns we observe, we study which vaccination policies are more successful than others in reducing the number of infected individuals and delaying the peak of infection. as part of this analysis, we need to asses to what extent social networks are a good approximation for face-to-face contacts. modeling the evolution of an epidemic involves modeling both the behavior of the specific infectious agent as well as the social structure of the population under study. in most existing approaches the population model is built based on using probability distributions to approximate the number of individual interactions. some other approaches synthetically generate the interaction graphs  <cit> ; these can be very useful in a qualitative estimation of how populations with different characteristics -i.e. different clustering coefficients, shortest paths, etc- may affect the spreading of the infectious agent. our approach approximates an actual social model by a realistic model based on real demographic information and actual individual interactions extracted from social networks. to the extent of our knowledge ours is the first attempt to model the connections within a population at the level of an individual based on information extracted from social networks such as enron or facebook. we additionally allow modeling the characteristics of each individual as well as customizing his daily interaction patterns based on the time and the day of the week. this reflects the fact that at different times individuals may interact with others in different environments: at work, at home, during leisure time or via spontaneous contacts. this social model is used as an input to our epidemic model; this is a sir-type  model  <cit>  extended with latent, asymptomatic, and dead states  <cit> , as well as a hospitalized state. since we are interested in a propagation model that is realistic, we split the infectious stage into three stages  <cit> : pre-symptomatic infection, primary stage of symptomatic infection -during which antiviral treatment may be administered-, and secondary stage of infection following the window of opportunity for treatment with antivirals. we also introduce the possibility of vaccinating individuals before symptoms appear. we assume that if an individual has recovered he becomes immune for the duration of the current epidemic. this is a reasonable assumption given the characteristics of the influenza virus and the fact that we are interested in short to medium time frames. we implemented epigraph  <cit> , a simulator which takes as inputs the social and the epidemic models as briefly described above. the implementation is distributed and fully parallel; this allows simulating large populations of the order of millions of individuals in execution times of the order of tens of minutes. to validate our model we plot and compare our predictions with the weekly evolution of infectious cases as recorded by the 2004- <dig> new york state department of health statewide summary report  <cit>  . we observe a close similarity with our prediction results. we compare propagation within our social network-based graph with propagation in synthetic graphs whose distribution of the number of individual interconnections follow exponential and normal  distributions. we also evaluate the propagation of the infectious agent when individuals with different characteristics are initially infected. lastly, for the case of the social network-based graph we evaluate different vaccination policies; the criteria are based both on individual characteristics -age being a major factor- and on the contact patterns. the idea is to identify the individuals with most contacts, apply to them a selective vaccination policy, and study the effect on the disease propagation.

related work
interconnection networks
the majority of human-transmitted infectious diseases use physical contact as the main transmission mean. for this reason the dynamics of the propagation is tightly related to the structure and the characteristics of the network of connections between the individuals within a population  <cit> . typically epidemiological models are compartmental in the sense that they model the dynamics of the epidemics by nonlinear differential equations and do not model the topology of the contact network. the assumption is that individuals in a population are homogeneously connected, which means that all individuals have the same probability of infecting other individuals  <cit> . in reality each person has specific, possibly very different, interaction patterns. this makes the interconnection network be heterogeneous  <cit> . additionally, there tend to be few people who have many connections, some strong but most of them weak -these are the super-connectors- while most of the individuals have few connections  <cit> . the typical way to approximate a heterogeneous contact network is to build a contact graph in which the individuals are nodes and edges represent connections  <cit> . a straightforward model implements the graph as an adjacency matrix. we use a more sophisticated model in which each matrix cell holds a value that represents the type of social interconnection: study, work, leisure, or family. the patterns of interactions depend on whether they occur between individuals within the same group or from different groups. we additionally allow the type of interconnection to change depending on a time parameter to reflect the fact that we may interact with individuals from different group types at different times during the day. this approach allows to more accurately model the heterogeneity of the actual contact network. work such as hpcgen and epigrass  <cit>  take the approach of modeling actual populations; fastgen and cl-model  <cit>  choose instead to generate a random adjacency matrix. hpcgen uses actual demographic data from census data and interviews, and introduces the idea of generating the contact network based on social structures with arbitrary degree distributions following a poisson distribution. to work well hpcgen requires a very high accuracy when modeling the social contacts for a specific population. the contact network is fully static in the sense that the interconnections between individuals cannot change during simulation. experiments have shown that such a model is accurate in the case that the propagation rate of the infection is high relative to the rate with which the interconnections may change in the network  <cit> , but would break down otherwise. direct methods for gathering information about social contacts generally rely on self-reported data  <cit> . this approach has obvious limitations and work such as  <cit>  depart from it by employing tracking devices. their experiment is based on the data gathered from about  <dig> of the participants to a 2-day conference and studies the impact of temporal aspects and heterogeneity in the contact network. one of their main conclusions is that the duration of contacts and the rate of new contacts is very important in the dissemination of the disease. it would be interesting to see how their results generalize to a contact network that involves more than one group and in which all interactions are recorded. bian  <cit>  develops a conceptual framework in which each individual is assigned both a physical location and a semantic location -home, work, etc-. homes and workplaces are assigned locations and individuals travel between these locations. the links between night-time and day-time populations are estimated by using travel time between homes and workplaces, according to census data. they simulate a population of  <dig> individuals belonging to  <dig> families and  <dig> workplaces, over the period of a month. the main question is how can such a realistic approach generalize. this work is further developed in  <cit> , which analyzes the virus propagation through a realistic model of the city of buffalo, ny. the population is modeled based on demographic information, as well as information about the structure of the business sector in this city. the connections between individuals take place in different locations -work, home, services, neighbourhood- depending on three time periods. the epidemic model has only four states, and they validate their results against data from nysdoh. germann  <cit>  presents a large-scale simulator based on a stochastic model for influenza. it uses a molecular dynamic algorithm for modeling the interactions between individuals. their approach is computationally expensive, requiring extended simulation times and a large number of processors to complete. in contrast, epigraph has lower computational requirements and can simulate single individuals with specific characteristics and dynamically evolving interactions.

a different approach is followed by biowar  <cit> . biowar is a multi-agent network model for simulating the effects of epidemic outbreaks due to bioterrorism attacks. it takes into account several input models such as disease, geography, weather, attack and communication technology, also it models the population behavior distributed in social group types with real census data. influsim  <cit>  extends the seir epidemic model. it uses demographic information from real census data and it models the social structure based on different age groups. influsim uses differential equations to model the transmission of the disease and does not take into account time-dependent individual interactions, such as epigraph does. an interesting recent study by miritello  <cit>  applies a sir-type epidemiological model over a contact network extracted from  <dig>  million national phone calls between  <dig> million people. they are interested in how information travels and they obtain significant differences depending on the duration of the calls. the study observes that most calls have a heterogeneous distribution over time, with bursts of short calls and few much longer calls. while this work does not investigate virus propagation, there are some interesting similarities between their work and the setup for epigraph.

epidemic models
the typical mathematical model for simulating epidemics is the sir model  <cit> . the sir model is usually appropriate for infectious diseases which confer immunity to recovered individuals and it works best if demographic effects may be neglected. our work focuses on the propagation of the influenza virus over short to medium time spans. work in  <cit>  extends the mathematical model with latent, asymptomatic, and dead states, as well as the possibility of introducing a vaccine program. the latent state corresponds to the incubation state in which an individual is infected but has not yet developed symptoms. a relatively small percent of the population will never develop them, passing into an asymptomatic state. all asymptomatic individuals, together with a high percentage of infected individuals recover and become immune. the rest of them pass to the dead state. alexander  <cit>  develops a mathematical model to evaluate the impact of antiviral treatment on the emergence of drug resistance. as part of this model, the clinical course of infection is divided in three stages: pre-symptomatic, symptomatic with the possibility of antiviral treatment, and symptomatic after the treatment opportunity has passed. although we are not considering the emergence of new viral strains, we do model the three infectious stages. additionally, we extend this model to introduce a new hospitalized state.

our contributions
the specific contributions of this work are the following:

• population: we use real demographic data extracted from the u.s. census to model group types with different characteristics. at the level of the individual, we allow modeling characteristics such as age, gender, and race.

• contacts: we leverage data extracted from social networks to model the interaction patterns between individuals pertaining to the same social group. we allow customizing individual interaction behavior based on the day of the week and the time of day.

• simulator: we implement a scalable, fully distributed simulator and we evaluate its performance on two platforms: a distributed memory multiprocessor cluster and a shared memory multicore processor.

• results: we validate the results of the simulation against real data obtained from nysdoh. we investigate the virus dissemination process and compare it with dissemination in networks which have exponential and normal contact distributions, as well as in a social model without time-dependent interactions. we additionally study how infecting different type of individuals may affect the epidemic.

• vaccination: we analyze and compare the impact of different vaccination policies on managing the virus dissemination process.

we first describe the modeling task and the simulation algorithm, followed by the analysis we undergo to understand the impact on the epidemics of the network structure and of the characteristics of the individuals that introduce the virus in the population. we then present and discuss the performance and simulation results of epigraph, including those for vaccination. we summarize the paper with the conclusions and some directions for future work.

methods
the modeling task
this work focuses on understanding and predicting the effects of the flu virus propagation throughout specific populations over a short to medium time span. we specifically do not focus on extended time periods for which qualitatively different parameters may make a difference. in addition, in our model there is no entry into or departure from the population, except possibly through death from the disease. neither are we considering the possibility that an individual may get re-infected once recovered, during the same epidemic. generally diseases transmitted by viral agents confer immunity so the assumption is that if an infected individual recovers he will acquire immunity for a time period at least as extended as the simulation time for the infection. on the other hand we are modeling interaction features that may have a large impact in the case of a single epidemic outbreak but whose effects level out over time. two such examples are the structure of the social model, as well as the connectivity characteristics of the specific individuals which introduce the virus in the population.

epigraph consists of two main components:  the social model for the population under study, including the patterns of contact between individuals within this population, and  the epidemic model, which captures the mechanism by which susceptible individuals get infected and go through the different stages of the infection. this model is specific to the infectious agent under study, in our case, to the influenza virus. we use the social model built as described in the following section as an input for the epidemic model.

modeling the population
the social model is represented via an undirected connection graph and can capture heterogeneity features at the level of both the individual and each of his interactions. each node models a single individual and may have specific characteristics such as gender, age and race. we use actual demographic information to instantiate the nodes. each graph edge represents an interaction between two individuals; we use contact information from social networks to realistically approximate these connections. connections are time-dependent such that the graph captures the dynamic nature of interactions. in the current implementation two individuals interact based on the day and the time.

individuals and groups
to most faithfully simulate the effects of an infectious agent spreading through a specific population we decided to use real instead of synthetic data. we use demographic information obtained from the primary metropolitan statistical area of boston  <cit>  to determine the distribution of the population in group types; these typically show different patterns in terms of social interactions. a group is a collection of individuals of the same group type as extracted from the demographic information. the group types which we extracted from the census and which we are modeling are the following: school-age children and students, workers, stay-home parents, and retired individuals. the population is split into many groups, each of one of these types. this structure reflects the way individuals tend to associate with each other in terms of social contacts.

these groups represent social structures such as companies, schools, or groups of stay-home parents and retired people that are interacting in education programs, hobby classes, kids' schools or any other kind of activities that make them come in contact. the second aspect which needs to be considered in the virus propagation is the individual characteristics of the members of this population. severe illness and death regularly occur in elderly or otherwise unhealthy individuals. in most epidemics, 80% to 90% of deaths occur in persons over  <dig>  <cit> , but in the  <dig> pandemic, young adults showed the highest mortality rates. during the recent swine influenza scare, healthy adults were equally affected by the virus. every individual in our simulation has personal information associated with him, which is taken as an input when computing both the probability of getting infected and the efficiency of vaccination. we consider that children younger than  <dig> years have the highest risk of getting infected, followed by seniors older than  <dig> years  <cit> . for seniors older than  <dig> the efficiency of the vaccine is assumed to be 55%, while for the rest of the population  it is taken to be 75%.

connections
rather than assuming a distribution or generating synthetic interaction graphs, we use real information from social networks to model the social interaction patterns. the interaction network is built statically to reflect the existence of communication between individuals but abstracts away the timing for these interactions. to recover some of the dynamic nature of these interactions we introduce a time parameter depending on which an individual may interact with any number of other individuals following his own patterns. each individual has contacts within his own group as well as with individuals from other groups. let's take the example of a worker. he is going to interact frequently with people from the same work group during work hours, with friends during leisure hours, with random people when using public transportation, and with family during evening/night hours. we therefore model three kinds of interactions:  between individuals of the same group ,  between individuals of different groups , and  between members of the same family. each of these kinds of interactions is assigned to a specific daily time frame depending on the schedule for the main activity -work, study, etc- for leisure activities, and for family time. this makes the simulation more realistic, particularly over short time periods. in principle, it is possible to assign any time-dependent interaction pattern separately for each individual.

• intra-group connections: which specific group an individual belongs to determines the actual number and patterns of interactions with other individuals from his own group. one of the main contributions of our work is that we model intra-group communications by scaling down real interaction graphs extracted from online social networks  such as enron and facebook. the idea is to exploit the connectivity that exists in real business and leisure sns and approximate face-to-face contacts by a scaled version of virtual contacts. the graph extracted from the enron email database consists of  <dig>  nodes and  <dig>  edges , while facebook has  <dig>  nodes and  <dig> , <dig> edges . we use enron's sn to model the worker and retired groups and facebook's to create the school and stay-home groups. note that the sns are bigger than the generated groups. we scale each down by selecting as many random entries of the sn as group members, than connecting the nodes following the same patterns as those in the sn. the selection of random entries of the sn allows us to create different interconnection patterns for each group. this approach is more realistic than either synthetically generating the interaction graphs or using probability distributions to approximate the number of individual interactions.

• inter-group connections: we create a number of inter-group contacts per individual based on the group characteristics which the individual belongs to. mostly the inter-group contacts occur in the hours between finishing one's main daily activity -such as work or study- and going home in the evening, or during weekends. these reflect daily activities which occur in public places such as parks, public transportation, etc., where one generally interacts with unknown people or friends pertaining to a different group.

in addition to intra- and inter-group contacts we also model a different type of social interaction: the contacts one has with members of his family. these may be pertaining to the same or to different groups and one has contacts with them from late night to morning, and during the weekends. we assign a different distribution for the type and duration of contacts of an individual during weekends.

modeling the infectious agent
the epidemic model is based on the principles of the sir model as it is described in  <cit>  and extended for the case of the flu virus by  <cit> . the extended model consists of a set of additional states -latent, asymptomatic, and dead- which reflect real possible stages during the development of the infection within a host. we further enhance the model with a hospitalized state in which an individual's contacts are severed. having such a state is important when simulating realistic cases where hospitalization may be needed in order to curb the effects of the epidemics.

more recent work  <cit>  has observed that the infective period consists of three phases with different characteristics, which may affect the dissemination of the influenza virus. these phases are as follows:

• pre-symptomatic infection: in this stage individuals are infectious but symptoms are not yet present, therefore no treatment can be administrated. figure  <dig> represents this stage as ls .

• primary stage of symptomatic infection: symptoms are present and a percentage of the individuals will seek medical care. this is the window of opportunity for initiating antiviral therapy. in general, antiviral drugs reduce both the period of infectiousness and the infectivity, but they may facilitate the emergence of drug-resistant viral mutants. in this work we are not considering new viral strains. figure  <dig> represents this stage as i p . instead of using a fixed duration for the window of opportunity, such as specified in  <cit> , we assume that every individual may have a slightly different one . to what extent the antiviral treatment will have an effect depends on the time within the window when an individual seeks medical care. if an individual is treated with antivirals and the treatment has an effect then he moves immediately to state i sv. otherwise he remains in i p for the duration of the time window, then passes to i s.

• second stage of symptomatic infection: symptoms are present and a percent of the individuals will seek medical care. at this point viral therapy is no longer effective. other types of treatment may be possible, as well as isolating the individual -for instance via hospitalization- such that he does not continue infecting susceptible individuals. figure  <dig> represents this stage as i s .

the epidemic model for influenza has many parameters, some of the most important being the basic reproduction number r <dig> , the time an individual spends in each of the states, the probability that an individual will take a transition from a source state into each of the target states, and so on. the time each individual spends in a given state is generated following a normal distribution to simulate the time ranges specific to each stage of the flu infection. we adopt most of the concrete values for the model parameters from the existing literature on flu epidemics  <cit> . table  <dig> shows the basic reproduction numbers for a subset of the states in figure  <dig>  for a complete list of the parameters used by our simulator please refer to  <cit> .

vaccination
our model allows vaccinating a subset of individuals either before the outbreak of the epidemics or at any other point during the outbreak. the lower half of figure  <dig> consists of t -subscripted states which reflect the susceptible, latent , asymptomatic, infectious , and hospitalized states for the case of vaccinated individuals. the figure contains a transition from state s to state st which reflects the adoption of a vaccination policy for susceptible individuals. since in case of the flu virus no symptoms are evident during the latent period, it is in reality possible to vaccinate individuals either in the latent or in the asymptomatic -and recovered following asymptomatic- states. we assume that getting vaccinated in the states lp , ls , a, or r following a does not make any difference with respect to the individual's response to infection. the epidemic model does not, therefore, represent vaccination in these stages. vaccinating a susceptible individual has specific implications such as: reducing the susceptibility of getting infected at the time of contact with an infected individual, reducing the probability of infecting another individual, reducing the recovery time, and reducing the possibility of becoming symptomatic. due to the fact that only part of the population is susceptible as result of a vaccination program we now use for the t -subscripted cases a control reproduction number rv instead of the basic reproduction number r <dig> .

in case of an epidemic the period of time between its onset and the time when a vaccine becomes available is usually problematic because of the lack of understanding of both the effects of the timing when the vaccine is administrated and the choice of who will receive the vaccine. these factors are not independent, and they have further implications not only in terms of the number of infected individuals and the speed of virus dissemination, but also for the gravity of the infection in different population groups. our simulator allows analyzing the effects of implementing a vaccination program at different times throughout the dissemination of the infectious agent.

one of the advantages of our epidemic model is that it is possible to monitor the effect of interventions such as vaccination or hospitalization at an individual level. it is therefore possible to simulate various scenarios like vaccinating or isolating a specific collective, for instance the members of a specific company or school, or a given city area.

the simulation algorithm
our simulation algorithm uses as inputs both the social model as well as the epidemic model. the simulation algorithm processes each connection of every individual to generate a probability with which the connection will serve for transmitting the infection. this probability depends on:  the connection type and current time: the connection types are intra-group, inter-group, and family, and each of them corresponds to a specific daily time slice;  the current states of the connected individuals in the epidemic model;  the personal characteristics of the individual subject to being infected.

to better understand the propagation characteristics for a connection graph based on social networks such as the one we are proposing, we also simulate propagation through two other types of graphs, both synthetically built based on probability distributions -specifically exponential and normal distributions. in these cases there is no differentiation in groups of different group types. later on in the paper we report on these simulations and we draw similarities and differences between the dissemination of the virus through these networks.

epigraph uses sparse matrices to represent the contact graphs. this enables both optimized matrix operations and an efficient way to distribute and access the matrices in parallel. epigraph has been designed as a fully parallel application. it employs mpi  <cit>  to perform the communication and synchronization both for the contact network as well as for the epidemic model. this approach has two main advantages. first, it can be executed efficiently both on shared memory architectures -for instance multicore processors- and on distributed memory architectures, such as clusters. on both platforms epigraph successfully exploits the hardware resources and achieves a significant reduction in execution time relative to a sequential implementation. the second advantage is that the simulator scales with the available memory, thus the size of the problems that can be simulated grows with the number of computational resources.

the basic reproduction numbers for a subset of the states in figure  <dig>  for a complete list of the parameters used by our simulator please refer to  <cit> .

analyzing the impact of the network structure
it is well-known that most human societies have super-connectors, people that act like hubs between the other members of the population and bear the weight of the connections in a social network. we naturally expect that the existence of these super-connectors will facilitate the spread of viruses and will make it harder to control the size of an epidemic. is our social network such an aristocratic  type of network? if we identify who the super-connectors are, what is the effect of vaccinating them  for the dissemination of the virus? how can we reliably identify the super-connectors?

to start answering these questions we set up two experiments; the first is meant to analyze the network structure by comparing the dynamics of virus dissemination within our social network-based network with that through other two networks which have exponential and normal probability distributions. the second experiment analyzes the effect on the epidemic of adopting different vaccination policies, some of them targeting the individuals having the largest number of connections.

graph structure
existing work such as  <cit>  presents the results of studying the relationship between the structure of the connection network and the propagation of an epidemic. these studies show that there exists a direct connection between the network structure and both the size of the epidemic  and the timing of the propagation. to study the correlation between the structure of the contact network and the infection propagation,  <cit>  constructs a model based on two parameters adopted from network theory; this approach is later used by  <cit> . these two parameters are the following: the connection degree <k>which stands for the average number of contacts, and <k2>which stands for the average of the squared values of the number of contacts.

the simulation scenario for our social network-based approach uses the demographic information of the city of boston  <cit>  to build the group structure. the population size is  <dig> ,051; we connect these individuals via a network of about  <dig> million contacts with an average of  <dig> contacts per individual. for comparison purposes, we generate contact networks based on exponential and normal distributions. to do this, we model the connection degree of the individuals in the network as a probability distribution based on two parameters: μ and σ. μ represents the mean value at the peak of the probability distribution; σ represents the standard deviation. the contact networks based on these probability distributions lack the group structure present in our social model. we generate these contact networks such that they have the same average contact number. table  <dig> shows a comparison for several parameters of these networks. for the case of the social network-based interconnection model the values of both <k>and <k2>are computed based on the distribution of the daily individual connections:

k
k2
μ
σ
comparison for several parameters of the social network-based model, the normal distribution-based model, and the exponential distribution-based model. the parameters we are showing are: the average contact number, the connection degree, the average of the squared values of the number of contacts, the mean value at the peak of the probability distribution, and the standard deviation.

 k= ∑n <dig> 

 k2=∑n <dig> 

where k <dig> , k <dig> , and k <dig> stand for the number of individual connections of type intra-group, inter-group, and within the family. p <dig>  p <dig>  and p <dig> are the number of hours dedicated by an individual to intra-group, inter- group, and family activities.

for the normal distribution most individuals have a number of connections close to the average and there are no super-connectors which may accelerate the propagation of the infection. the following section presents the results of simulating the virus propagation throughout these networks when the individuals that introduce the virus in the population are either average- or highly connected.

super-spreaders
depending on the properties of a connection graph it may be fundamental to understand not only the global behavior but also the individual behavior of the members of a population. individual behavior may be a determining factor in the speed and extent of the infection propagation. in this context it is important to understand which are the individuals which spread the virus faster and further, and evaluate both the effects of infecting them, as well as vaccinating them with the purpose of containing an epidemic.

in an effort to better identify super-spreaders in a given population we use the number of connections to define four group types: the individuals with high inter-group contacts, those with high intra-group contacts, those with highest numbers of overall contacts, and those with average number of overall contacts.

the simulation algorithm identifies these four population groups based on the number of connections. it can then evaluate the effects on the virus propagation of either infecting, or vaccinating, each of these different groups. the remainder of the paper presents the results of these simulations and evaluate different vaccination policies based on targeting some of these group types.

RESULTS
the aim of this work is to understand the virus propagation process throughout a population both for prediction as well as for prevention purposes. a good, although difficult litmus test for the quality of the simulator is to compare its results with actual data. to prove the accuracy of the simulation results we compare them with the weekly data published by nysdoh. we then analyze the virus propagation under different scenarios involving different types of interconnection networks and assuming that the virus is introduced in the population by groups of individuals with different characteristics. we also evaluate different vaccination policies meant to shorten and slow down the epidemic process.

validation
comparing the effect of the interconnection graphs
to estimate the impact of the structure of the interconnection network on the epidemic we simulate the virus propagation through the interconnection graphs introduced earlier in the paper by initially infecting a given percentage of the population that has specific individual characteristics. specifically, we build four interconnection networks as follows: two which follow probability distributions -normal and exponential, and two based on social networks, one as described in in the previous section and the other one flattened to reflect time-independent connections. that is, every individual connects with all his contacts the whole  <dig> hours a day, regardless of group type . for each of these models, we select a percentage of the population to serve as the individuals who introduce the virus in the population; specifically we chose to infect  <dig> individuals. we simulate two different scenarios: in the first one we select the  <dig> individuals with the highest number of overall contacts; in the second one we select  <dig> individuals whose contact numbers are similar to the average contact number for the entire population. for the social network-based graphs we model the greater boston area; the average number of connections is  <dig>  we maintain the same average number of connections for the other three graphs; the probability-based graphs nevertheless do not reflect either the social structures nor the time-dependent interactions between individuals. figure  <dig> and figure  <dig> illustrate the simulation results for the two scenarios and each of the four interconnection networks. although in all of the cases we predict the same peak value and total number for the infected individuals in the two scenarios, the difference in the speed of the virus dissemination between the two scenarios is pretty different. in the case of the normal distribution the difference is of about  <dig>  days; in the case of the exponential this raises sharply to  <dig>  days, while for the social network simulation  it goes up to a whole week. the starting day for the epidemic is the earliest in the flattened social network and the latest in the non-flattened case -at a difference of about  <dig> days from each other. the normal- and exponential distribution-based models exhibit an intermediate value between  <dig> and  <dig> days after the starting day in the flattened network.

it is interesting to notice that the start time in the exponential distribution network is later than the one in the normal distribution network in the case of infecting individuals with average connection degree, but slightly earlier in the maximum connection case. this is due to the fact that the virus will start propagating faster in the exponential network if super-connectors introduce the virus in the population as they will have many more connections in the exponential than in the normal distribution case. due to the fact that there aren't many of them, soon after the breakout the infection cannot sustain the same propagation speed. this is no longer the case if it is the average connection degree individuals which start the infection. in this case the exponential will lag behind because the normal distribution has more average connection individuals than the exponential one does. the number of infected individuals -measured in millions- for each of the four models is:  <dig>  for the normal distribution,  <dig>  for the exponential,  <dig>  for the flattened social model, and  <dig>  for the non-flattened social network.

note that the non-flattened social model exhibits a much lower peak value  than the other cases; we expect this to be mainly due to the fact that in the normal, exponential, and flattened models all individuals interact with all the individuals that they are in contact with at all times. this gives raise to many more infections than in the non-flattened case, where individuals connect with others only within a time slot of the day. the irregularities in the non-flattened graph are a result of simulating a more realistic -and different- behavior of individuals during weekends.

interconnection patterns
in general we expect individuals that are highly connected to play an important role in the virus dissemination. given a specific social model it is nevertheless not necessarily clear which kind of connections matter most. to get a better understanding we define several kinds of individual types depending on their interconnection patterns; we then infect a subset of individuals in these groups to compare the effects of the virus propagation. we are interested in the individuals with high inter-group, intra-group, and overall contacts, as well as those with a number of contacts similar to the population average. given our internal representation, an efficient way to approximate the number of inter- and intra-group contacts is to define a small window centered on the individual and count the connected individuals outside and within the window. as shown in figure  <dig>  the number of infected individuals is virtually the same in the four networks but the time at which the peak of infection is reached is different. as expected, when infecting individuals with a mean number of connections the peak is reached the latest, at day  <dig>  when choosing individuals with a maximum overall number of connections the epidemic reaches its peak at day  <dig> 

somewhat less intuitive are the starting times corresponding to the maximum inter- and intra-group connections, standing at days  <dig> and  <dig>  the reason for this behavior is that, during weekdays , one gets in contact with people outside his group  only for  <dig> hours, compared to  <dig> hours for people inside his group . while family connections happen within a daily  <dig> hour slot, it may, or may not be the case that the family members are outside one's group. but more importantly, these connections are very few -of the order of  <dig> or  <dig> 

vaccination policies
knowing whom to vaccinate and what is the time frame when this can be done to slow down an epidemic are questions that health officials are faced with in case of an outbreak. currently, vaccination policies are more a matter of minimizing the impact of the virus on the individuals who seek treatment rather than an effort to curb the propagation. this does not reflect a lack of preoccupation but the fact that it isn't an easy problem to solve. in case of an outbreak there are seldom enough vaccines ready to administer to the majority of the population -or even to the population that is most at risk. our simulator can provide guidance about which individuals should be treated to slow down the propagation process and reduce the number of infections. figure  <dig> illustrates the simulation results when vaccinating the following sets of individuals:

• vaccination of a 28% of randomly chosen individuals.

• vaccination of school children and students, which were shown to be the main infection spreaders.

• vaccination of elderly people, which have the greatest risk of contracting the virus.

• vaccination of a 28% of the population representing individuals with the highest number of overall connections.

• vaccination of a 10% of the population representing individuals with the highest number of overall connections.

note that vaccinating young and elderly people curbs the propagation noticeably more -by about a fifth- than vaccinating 28% of the individuals at random does. the young and elderly make up  <dig> % of the population. it is noteworthy to mention that vaccinating a mere 10% of the population by targeting the individuals with the highest number of overall connections reduces the infected numbers even more than the previous two cases; the start time of the epidemic in this case occurs slightly earlier. lastly, by vaccinating 28% of the population consisting of individuals with the highest number of overall connections, the number of infected people is reduced to 27% of the case when vaccinating the young and elderly and 21% of the random vaccination of 28% of the population. more detailed simulations and analysis could be of help to health authorities in estimating the cost and feasibility of different vaccination policies relative to their effects in terms of the number of infected individuals and the starting time for an epidemic.

performance
we developed epigraph as a scalable, fully parallel and distributed simulation tool. we ran our experiments on two platforms: an amd opteron  <dig> cluster using  <dig> processor nodes and running at  <dig> mhz, and an intel xeon e <dig> processor with  <dig> cores and running at  <dig> ghz. for the social network-based graph which has  <dig> , <dig> nodes and  <dig> million edges, the simulation algorithm runs in  <dig> seconds on the cluster and  <dig> seconds on the multicore processor. for the distribution-based models the running times can go up to a maximum of about  <dig> minutes.

CONCLUSIONS
this paper presents a novel approach to modeling the propagation of the flu virus via a realistic interconnection network based on actual individual interactions extracted from social networks. we have implemented a scalable, fully distributed simulator and we have analyzed both the dissemination of the infection and the effect of different vaccination policies on the progress of the epidemics. some of these policies are based on characteristics of the individuals, such as age, while others rely on connection degree and type. the epidemic values predicted by our simulator match real data from nysdoh.

work in progress and future work
work in progress involves studying the effects of using additional individual characteristics in understanding disease propagation throughout a population. we are also analyzing the characteristics of our social models -such as clustering, node distance, and so on- and investigating to what degree disease propagation and vaccination policies have a different effect for social networks with varying such characteristics. lastly, we are investigating a deeper definition for super-connectors which involves more than one's direct neighbours, as well as an efficient technique to finding them. there are many ramifications of this work which lead to several directions for future investigation. we only mention a couple of them here. first we are interested in whether recording the actual position of each individual brings new insights to the social model. this provides a way to reconstruct interaction patterns with people inside and outside one's group. we are also interested in whether the duration of the individual contacts turns out to be relevant at a large scale and whether there is a connection between it and a notion of strong and weak connections which would reflect the degree to which a connection may serve as a channel for spreading the infectious agent between pairs of groups or individuals. finally, it will be interesting to see how our approach scales to a nation-wide simulation.

abbreviations
nysdoh: new york state department of health; sn: social network; sir: susceptible-infectious-recovered.

competing interests
the authors declare that they have no competing interests.

authors' contributions
gm, mcm and des performed all coding and simulations. gm, mcm, des, and jc conceived, designed the work, analyzed the data and wrote the paper. all authors read an approved the final manuscript.

