BACKGROUND
motivation
the deluge of publicly available molecular biology data, including genome-wide gene expression measurements  <cit>  and gene and protein interaction networks  <cit>  has necessitated the development of computational methods that produce comprehensible views of large numbers of biological molecules and their connections. reporting perturbation in gene expression on the basis of individual genes  <cit>   has given way to more holistic techniques—referred to as functional enrichment—that instead report the significance of the collective perturbation of processes—sets of biologically related genes   <cit> ) to find the set of processes with the greatest fit to the observed data.

products of genes do not act independently but rather in concert with products of other genes through numerous interactions. in a similar vein, biological processes, composed of genes, may themselves interact. accordingly, researchers have begun developing methods to identify connections between processes based on the underlying gene interaction networks. a method by li et al. <cit>  computed the “crosstalk” between processes by counting the number of interactions that occur among the genes of each process and assessing the significance of this number against empirical distributions. dotan-cohen et al. published a more direct method  <cit>  which uses fisher’s exact test to determine if one process is linked to another, i.e., if genes in the first process have significantly more interactions with genes in the second process than would be expected by chance. wang et al. <cit>  published a method that calculates what they call “functional similarity” between two processes using the sum of the distances between all pairs of genes belonging to those processes.

while the previous methods represent advances in finding high-level connections between processes, they do not incorporate information which could lead to discovering which connections have relevance under specific biological contexts. motivated by this methodological gap, in earlier work  <cit>  we extended the method of dotan-cohen et al. <cit>  by integrating gene expression data with gene-gene interactions to compute what we termed “contextual biological process linkage networks” . a link in a cbpln indicates not only that the genes of two processes have a significant number of interactions among them, but that genes at the interface exhibit a large amount of perturbation in expression. thus, it became possible to infer the inter-process connections relevant to a cell or tissue’s response to an internal or external stimulus.

the cbpln method has several aspects that need improvement. first, because it must build empirical distributions to determine the significance of each link, it becomes prohibitively computationally expensive as the number of links to test grows. second, the method reports all significant links, since it makes no distinction among two or more links that are found to be significant on account of nearly identical sets of gene-gene interactions, it may output many redundant significant links. this latter drawback is universal to all methods that compute inter-process links, and also to most techniques for functional enrichment.

here we present a new method that simultaneously addresses the shortcomings of earlier methods. our method takes inspiration from the methods for functional enrichment reported by lu et al. <cit>  and bauer et al. <cit> . we assume that links between biological processes become perturbed during the response of a cell or tissue to some stimulus, and that this perturbation of inter-process links propagates via the individual gene-gene interactions between genes belonging to the different processes. we can not directly observe perturbation of the links between the processes; instead, our method considers the perturbation of genes participating in the interfacing interactions of processes as noisy observations generated from the perturbed inter-process links. our method infers a non-redundant set of processes and their perturbed links, which we call a biological process network , from the interactions between the observed perturbed genes. we compute the likelihood of candidate bpns in terms of parameters accounting for the noisiness in the observed states of the gene-gene interactions. using markov chain monte carlo , we identify bpns of high likelihood. we label this new method “mcmc biological process networks” . bpns thus computed summarize the important biological trends within a response network by reporting to the user a digestible number of inter-process links that can be explored in greater detail.

overview of the method
mcmc-bpn aims to explain as many interactions between genes with perturbed expression by as few inter-process links as possible. by including a link between a pair of processes in the bpn, we say that link “explains” the interactions cross-annotated by that pair of terms. our objective is to the reward inclusion of links in the bpn that explain many interactions between perturbed genes not already explained by other links in the bpn. simultaneously, another objective is to penalize the inclusion of more links in the bpn than necessary, including links which mostly explain unperturbed interactions, and missing a large number of perturbed interactions. to this end, we define a likelihood function as the product of several bernoulli distributions, controlled by three parameters used to adjust for the amount of “noise” in the observed perturbation of the cross-annotated links.

the first of these parameters, the link prior λ, serves to reduce the number of links in a bpn, for when λ is low, having few links increases the overall likelihood. a low value for the second parameter, the false-positive rate α, encourages bpns that explain many perturbed interactions. finally, when the parameter β, which represents the false-negative rate, has a low value, it encourages bpns that explain few unperturbed interactions. note that modifying the bpn in such a way that increases the contribution of one parameter to the likelihood may be offset, or even outweighed, by a decrease in the contribution to the likelihood by another parameter. for example, including every possible link in a bpn will have a favorable likelihood contribution via α, since it necessarily explains all perturbed interactions. such an inclusive bpn will, however, lead to very poor contributions via λ  and β . thus, such a bpn will have a very low overall likelihood. a desirable bpn must strike a balance among the tension of all three parameters—neither including too many links, nor explaining too few perturbed interactions, nor explaining too many unperturbed interactions—in order maximize the overall likelihood.

while the likelihood function provides a means of scoring the quality of a given bpn, for any given data set, there exist 2|l| possible bpns, where l is the set of all possible links between pairs of processes. to search this potentially enormous solution space, we use the metropolis-hastings algorithm for markov chain monte carlo   <cit> . each state in the markov chain represents a particular set of values for the parameters λ, α, and β, as well as a particular configuration of inter-process links. the neighbors of the state are those which have one additional or one less link, or which have one parameter with a different value. the parameter values and links which contribute to bpns with high likelihoods will tend to remain consistent from one visited state to the next. thus, we report the final bpn as the links that appear most frequently throughout the states visited during the mcmc.

application
we applied mcmc-bpn to three treatment-control experiments relating to the liver and liver disease. in the first application, we compared gene expression of rat hepatocytes in two common in vitro culture systems  <cit> : hepatocyte monolayer  and collagen sandwich . the remaining two experiments contrast gene expression levels from liver tissue samples from dozens of human patients diagnosed with hepatitis c virus -induced cirrhosis and hepatocellular carcinoma  with expression levels of samples from healthy patients  <cit> . approximately  <dig> million people worldwide suffer from hcv infection  <cit> . hcc ranks third among the deadliest cancers worldwide, of which hcv is among the leading causes of incidence  <cit> . below, we present and discuss the bpns computed to summarize the major trends of differential expression of each of these three data sets. we found the bpns contained links between biological processes that were anticipated, as well as unexpected connections that suggest further exploration.

RESULTS
data sources and contrasts
we obtained functional annotations for the genes from the c <dig> canonical pathways and c <dig> go gene sets of the molecular signatures database  version  <dig>   <cit> , downloaded on february  <dig>   <dig>  corum complexes  <cit>  downloaded on february  <dig>   <dig>  netpath signal transduction pathways  <cit>  downloaded june  <dig>   <dig>  and nci pathway interaction database’s curated pathways  <cit>  downloaded february  <dig>   <dig>  for the rat data, we normalized all data into the ensembl peptide id namespace through a combination of the synergizer  <cit>  and madgene  <cit>  mapping services. for the human data, we used the same services to normalize all the data into entrez gene namespace.

next, we integrated the annotations with the gene interaction networks. we say that a pair of processes “cross-annotates” interactions in the underlying gene-gene interaction network if one of the two genes belongs to one of the processes in the link and the other gene belongs to the other process.  for each contrast, table  <dig> presents the number of processes, the number of cross-annotating pairs among these processes, the number of interactions which the process pairs cross-annotate, and the number of those interactions which we consider “perturbed” .

for each contrast, we performed a total of five runs of mcmc-bpn. each run took between  <dig> and  <dig> hours on a single core of a  <dig> ghz amd opteron  <dig> processor using our implementation in python. we first describe results on the consistency of the bpns computed by the different mcmc runs and summarize bpn statistics. second, we show that the bpns contain very little redundancy. third, for each contrast, we display an example bpn and provide detail on several interesting links in the reported bpns. fourth, we demonstrate that the bpns produced by mcmc-bpn are more informative while also being less redundant than those computed by two previous methods: cbpln  <cit>  and biological process linkage networks   <cit> . finally, we describe some general observations of the behavior of the mcmc and features which affect the performance of our algorithm. two additional files accompany these results. the supplementary information  contains  details on how we executed the mcmc-bpn software to obtain and visualize our results and  a description of the files in the supplementary results, which are available in additional file  <dig>  this file contains all the five bpns for each of the contrasts studied and the parameters estimated by each run of the software.

consistency and statistics of bpns computed by mcmc-bpn
we measured the consistency between the five bpns for each contrast in two ways: how many links  each pair of bpns shared, and how many explained interactions each pair of bpns had in common. the average jaccard index  for all ten pairwise comparisons of the shared links in the cs vs. hm bpns was  <dig> ; in these and subsequent results, we report averages but not the standard deviations, since they were one to two orders of magnitude smaller than the averages. figure  <dig> presents, for each of the three contrasts, a pair of heatmaps showing the overlap between each pair of bpns on the basis of their common perturbed and unperturbed explained interactions. for the cs vs. hm contrast, the average jaccard index for the common perturbed interactions was  <dig> , illustrating the high degree of overlap between the reported bpns. the five bpns for the cs vs. hm contrast consisted of an average of  <dig>  processes with  <dig>  inter-process links explaining  <dig>  interactions, of which  <dig>  interactions were perturbed. the bpns explained  <dig> % of all perturbed interactions using  <dig> % of the possible links.

unlike the cs vs. hm contrast, the bpns reported for the cirrhosis contrast showed mixed consistency. figure  <dig>  clearly illustrates the divergence in the bpns computed for the cirrhosis contrast in terms of the overlap of their explained interactions. three of the five bpns  were identical, with  <dig> processes and  <dig> links between these processes. the two remaining bpns had only two processes with one link and four processes with two links, respectively, none of which were present in the three identical bpns. we found that β, the false-negative rate, took on a very high value  for these runs in comparison to the others . this value of β indicated that only 5% of the interactions explained by these bpns were perturbed. we discarded these two bpns from further analyses, reasoning that they represented a situation where the mcmc could not escape a local minimum. we found that the  <dig> links of the three remaining bpns explained  <dig> interactions,  <dig> of which were perturbed. thus the bpns explained  <dig> % of all perturbed interactions using  <dig> % of all possible links.

similar to the cirrhosis contrast, three of the bpns computed for the very advanced hcc contrast had a high degree of similarity ). the remaining two bpns, which had a modest similarity to each other, showed very little overlap with the first three bpns. unlike the cirrhosis contrast, the two groups of bpns had similar numbers of processes and links; the three similar bpns had a mean of  <dig>  processes with  <dig>  links between them, and the two remaining bpns had a mean of  <dig>  processes and  <dig>  links. they differed remarkably, however, in the number of interactions their links explained. the three similar bpns explained a mean of  <dig>  interactions, of which  <dig>  were perturbed. the remaining two bpns explained a mean of  <dig>  interactions, of which  <dig>  were perturbed. as in the cirrhosis contrast, we found that β assumed high values  in these two runs compared to the others . again reasoning the mcmc may have failed to escape local minima, we excluded the two dissimilar bpns from the remainder of our analyses.

lack of redundancy in bpns
we sought to determine whether there was any redundancy within each bpn for each contrast. we used two measures for this evaluation:  the overlap among links in a bpn in terms of common interactions and  the number of links in each bpn that explained each interaction. we define these measures in more detail in the section titled “ measuring redundancy within a bpn.”

we measured the amount of overlap between every pair of links within each bpn in terms of the number of common explained interactions, averaging the results over the bpns computed for each contrast. figure  <dig> displays, for each contrast, the distributions of the maximum observed jis for each link, divided into perturbed explained interactions and unperturbed explained interactions. among the five cs vs. hm bpns, when considering perturbed interactions, a mean of  <dig> % of links had a maximum ji between  <dig> and  <dig> . for unperturbed interactions, this number was  <dig> %. moreover,  <dig> % of perturbed explained interactions and  <dig> % of unperturbed explained interactions in cs vs. hm had only one link explaining them on average.

links in cirrhosis bpns also exhibited little overlap ), with all links having a maximum ji of at most  <dig> , both for perturbed and for unperturbed interactions. at least 85% of the perturbed explained interactions and the unperturbed explained interactions were explained by only one link. links exhibited little overlap in very advanced hcc bpns as well, as shown in figure  <dig> . nearly 90% of the links had a maximum ji of at most  <dig>  in the case of perturbed explained interactions, with the number being nearly 70% for unperturbed explained interactions. moreover, about 72% of both perturbed and unperturbed explained interactions were explained by only one link.

overall, the dominance of low jis for the processes and links indicated that the bpns computed by mcmc-bpn demonstrated very little redundancy. the fact that most explained interactions had only one explaining link supported this observation.

interpretation of the bpns
cs vs. hm
figure  <dig> presents one of the bpns computed using the mcmc-bpn method on the data for the cs vs. hm contrast. the bpn contained up- and down-regulated processes in different components. most up-regulated processes were related to metabolic functions performed by the liver, including lipid and carbohydrate metabolism, while most down-regulated processes related to cell replication and the cytoskeleton. these reflect the greater retention of physiological function of hepatocytes in cs culture versus hm culture, and the greater degree of de-differentiation for cells in hm versus cs, respectively, as reported by kim et al. <cit> .

two main components dominate the bpns. the first component contained a mix of processes related to fatty acid metabolism  and processes related to amino acid and carbohydrate metabolism , all critical functions carried out by hepatocytes  <cit> . a link between oxidoreductase_activity and reactome_metabolism_of_amino_acids bridges these two groups of processes. the second component contained down-regulated processes related to the de-differentiation of the hepatocytes in hms.

although the names of some of the processes appear to be very similar, their actual gene content tended to overlap very little. for example, the sets of genes annotated to cell_cycle_go_ <dig> and to kegg_cell_cycle had ji of only  <dig> . similarly kegg_ppar_signaling_pathway and reactome_regulation_of_lipid_metabolism_by_peroxisome_proliferator_activated_receptor_alpha, which are directly linked in the bpn, had a genes-based ji of  <dig> . figure  <dig> shows the dense network of interactions explained by this link. while genes belonging to both processes, such as peroxisome proliferator-activated receptor α and cholesterol  <dig> α-hydroxylase , are involved in some interactions, there are many interactions that involve genes belonging to only one of the two processes.

cirrhosis
the three consistent bpns in the cirrhosis contrast were composed entirely of immune response-related processes, as shown in figure  <dig>  while we anticipated seeing a response in terms of liver-related processes as in the two previous analyses, two factors likely played a large role in the dominance of the immunity processes. first, all cirrhosis patients had sustained infection by hcv. second, samples in the previous two analyses contained rna extracted solely from hepatocytes, the cells responsible for the bulk of metabolic functions of the liver. the samples in this contrast  were from the whole liver. thus, they contained a mixture of cell types, which could dilute the signal from metabolic processes. our results corroborate those found by wurmbach et al. <cit> , who categorized the bulk of the differentiated genes as participating in immune response.

very advanced hcc
the majority of processes in the three similar bpns of the very advanced hcc contrast related to cell replication, owing to the advanced nature of hcc in the patients from whom the samples were derived.  the largest component of the bpn contained  <dig> processes and  <dig> links, including both down- and up-regulated processes, largely including processes related to cell replication. the bpn contained a few links related to liver-specific functions, however, such as that between kegg_valine_leucine_and _isoleucine_degradation and oxidoreduc tase_activity_acting_on_the_ch_ch_group_of_donors, both down-regulated in comparison to control patients, indicating the progression of liver damage in the hcc patients. interestingly, reactome _innate_immunity_signaling was down-regulated in hcc patients compared to controls, suggesting a breakdown in immune response. mcmc-bpn reported a significant link between this process and regulation_of_mitotic_cell_cycle.

comparison with cbpln
we compared performance of mcmc-bpn to the cbpln method by running mcmc-bpn over the day  <dig> cs vs. hm dataset taken directly from the cbpln study  <cit> , which featured the same gene expression and interaction data as the cs vs. hm study presented above, but a subset of older annotation data from msigdb. specifically, the cbpln study featured a set of  <dig> processes significantly upregulated in cs in comparison to hm that we had manually identified and selected.

we performed five independent runs of mcmc-bpn on the cbpln day  <dig> dataset. two runs had identical sets of links with values of α and β between  <dig>  and  <dig> . the other three runs had high values of  <dig>  and  <dig>  for both α and β. we retained only the bpns in the first group for further analyses. both these bpns contained  <dig> of the  <dig> terms and  <dig>  of the  <dig> possible links, which explained  <dig>  interactions, including  <dig>  of the  <dig>  perturbed interactions.

cbpln produces a bpn with directed links. we ignored these directions to facilitate comparison to mcmc-bpn. we considered a link significant in the cbpln results if the corrected p-value was at most  <dig> , per the original cbpln study  <cit> . the resulting undirected bpn for cbpln contained all  <dig> processes with  <dig> links . the links explained  <dig>  interactions, including  <dig>  perturbed interactions .

compared to the bpn produced by cbpln, the bpns produced by mcmc-bpn explained approximately two-thirds  as many perturbed interactions in the underlying response network, however, they incorporated only approximately one-quarter  as many links as the bpn produced by cbpln. as shown in figure  <dig>  the links in bpns from mcmc-bpn had much less overlap  when compared to the links in the bpn produced by cbpln .

thus, while mcmc-bpn produced bpns which explained somewhat less of the response network than the bpn produced by cbpln, it did so using a much more concise, much less redundant set of links. furthermore, cbpln required explicitly defining the set of links for which to test for significant perturbation, whereas mcmc-bpn did not require any such specification.

finally and most importantly, we note that mcmc-bpn was able to compute all five bpns in fewer than  <dig> hours cumulative runtime on a standard modern desktop pc, whereas cbpln required several hundred hours of cumulative runtime on a high-performance computing cluster on the same dataset, primarily due to its need to build empirical distributions to determine the statistical significance of each link. executing cbpln becomes nearly intractable on the full cs vs. hm, cirrhosis, and very advanced hcc datasets. as stated in the “ motivation” section, the computational expense of running cbpln to compute links between more than a few dozen processes served as one of our primary motivations for developing mcmc-bpn.

comparison with bplns
we also compared mcmc-bpn to the bpln method presented by dotan-cohen et al. <cit> . we computed bplns for the three contrasts using the method of dotan-cohen et al. <cit>  . we used the same input annotations as for mcmc-bpn runs, i.e., those processes found significantly perturbed for the cs vs. hm contrast by gsea. since bpln does not consider the state of perturbation of genes in the interaction network, we restricted the interaction network to all the perturbed interactions. like cbpln, bpln also produced directed links between processes, so we considered a significant link in either direction sufficient to indicate a significant undirected link.

for each contrast and for each of two stringent significance thresholds, table  <dig> lists the number of significant  links in the bpln, the number of processes connected by these links, and the number of interactions that these links explain. the first significance threshold of  <dig>  is an arbitrary albeit reasonable threshold that an investigator might select when exploring results from bpln. the second threshold produces a bpln with a number of links as close to, but no fewer than, the number of average links reported for mcmc-bpn . we discuss these results below but only for the second threshold for each contrast, in order to avoid repetitiousness.

link
significance
perturbed
perturbed
“link significance threshold” indicates the threshold value for which a link’s benjamini-hochberg-corrected p-value must be less than or equal to in order to declare the link significant. “processes” indicates the number of processes involved in the bpln and “links” the number of significant links between those processes. “explained perturbed interactions” indicates the number of perturbed interactions explained by the links in the bpln. “unexplained perturbed interactions” indicates the number of perturbed interactions that are not explained by any link in the bpln.

cs vs. hm
the bpln produced at the cutoff of  <dig>  ×10− <dig> gave the same number of significant links as the mcmc-bpn runs , but the bpln links explained only 41% of the perturbed interactions explained by mcmc-bpn . further, 45% of the links in the bpln at this cutoff had a maximum ji between  <dig>  and  <dig> ).

cirrhosis
a threshold of  <dig>  ×10− <dig> gave a number of significant links for bpln that matched the reported average for mcmc-bpn. at this threshold, the links in the bpln results explained fewer than half the number of perturbed gene-gene interactions. over 65% of links had a maximum ji of  <dig>  or greater ).

very advanced hcc
at the threshold of  <dig>  ×10− <dig>  the bpln contained  <dig> significant links, matching as closely as possible to the reported average of  <dig>  for mcmc-bpn. these links explained less than half the number of perturbed interactions as those explained by the links from mcmc-bpn. the links from bpln involved fewer processes overall compared to mcmc-bpn. the links from the bpln at this threshold, however, displayed a large amount of redundancy, with 88% having a maximum ji of  <dig>  or greater; see figure  <dig> .

thus, for all contrasts, the links reported by bpln proved less informative and more redundant than those reported by mcmc-bpn. we concluded that bpln computed a much poorer summary of the perturbed gene interaction network in comparison to mcmc-bpn.

behavior of the mcmc
since our markov chain has the property of irreducibility  and aperiodicity , we expect that, given sufficient number of steps, mcmc will visit each state in the solution space with a frequency proportional to the likelihood of the state  <cit> . to demonstrate that mcmc-bpn follows this behavior, we performed five additional runs of mcmc-bpn for the cs vs. hm contrast wherein we recorded the frequency with which the mcmc visited each state. in these runs, we fixed the parameters to the most probable values as determined by the first five runs , and permitted only links-based transitions.

the plot in figure  <dig>  shows the distribution of the number of distinct states visited with a given likelihood, for different values of the likelihood. the plot in figure  <dig>  shows the distribution of the likelihoods in terms of the total number of times a state with a given likelihood was visited. together, these plots indicate that the mcmc visited the most abundant states the most frequently. when we normalized the total number of visits by the number of distinct states, however, we observed that the mcmc visited the most likely states more frequently than those with lower likelihoods, as shown in figure  <dig> . we observed very similar behavior in all five runs for recording the state frequencies. these results suggest that the stationary distribution of our markov chain is indeed one where the probability of visiting a state is proportional to its likelihood.

CONCLUSIONS
we have presented a method for computing connections between biological processes specific to a biological context corresponding to comparing gene expression measurements from two conditions . our method, which we call mcmc-bpn, uses mcmc to search a solution space of possible inter-process links that can explain the perturbed interactions between genes of the processes. we computed bpns for three liver-related contrasts:  rat hepatocytes in cs compared to those in hm , and samples from livers of human patients with  hcv-induced cirrhosis  or  hcc  compared to samples from patients with healthy livers.

the bpns varied in size, roughly in proportion to the number of perturbed interactions for the contrast. the bpns explained around 20–40% of the perturbed interactions per contrast, using only  <dig> % of the possible links, and exhibited very little redundancy. in contrast, bpns computed by cbpln and bpln contained several more links than mcmc-bpns. moreover, these methods produced bpns with considerable redundancy. we demonstrated that the bpns reported contextually relevant connections between processes, such as cell-growth processes related to late-stage cancer in the very advanced hcc contrast, or metabolic pathway processes related to better retention of physiological function in cs vs. hm.

in the cirrhosis and very advanced hcc contrasts, we observed a bifurcation in the bpns reported by mcmc-bpn, where one set contained bpns that explained many more perturbed interactions than the other. we noticed that during these runs, the poorer quality bpns tended to assume high values for the false-negative rates, suggesting that the mcmc entered a solution space of poor likelihood that nevertheless was large and distant from more optimal solution spaces. one possible solution to alleviating this problem is to monitor the mcmcs as they progress, terminating or restarting those that diverge greatly from solutions of high likelihood. a more simple solution would be to restrict the values which the parameters can take even further .

it may be possible to increase both the number of probable links , as well as the probabilities for each link that contributes strongly to the overall likelihood by calculating the link probability as the fraction of most likely bpns  in which the link appears. strategies to reduce the required number of mcmc steps, and thus the running time, include pre-computing the possible contribution of each link to the likelihood before starting the mcmc, and pruning out the links with low contribution, thus significantly reducing the search space. we hope to include these and other improvements in future versions of mcmc-bpn. alternatively, state-space-searching algorithms other than mcmc could be applied, such as simulated annealing . we believe that mcmc-bpn and future extensions will prove useful in revealing the larger stories hidden within the ever-increasing amounts of high-throughput life science data.

