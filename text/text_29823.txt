BACKGROUND
in phylogenetic studies, it has become increasingly common to sequence large numbers of individuals at many loci . while these multilocus datasets provide the potential to improve the accuracy of phylogeny inferences over large sets of taxa, for a variety of reasons, topologies of trees inferred at different loci might not match  <cit> . one source of this gene tree discordance is incomplete lineage sorting, the phenomenon in which sets of sampled lineages fail to coalesce in the population in which they are first capable of coalescing  <cit> . with incomplete lineage sorting, several species tree inference methods—including concatenation  <cit> , democratic vote consensus  <cit> , greedy consensus  <cit> , majority-rule consensus  <cit> , matrix representation with parsimony  <cit> , and minimize deep coalescences  <cit> —can be misled by discordance of gene trees across loci.

numerous approaches have been used for estimating species tree topologies from multilocus sequence data. consensus methods construct species tree topologies from gene trees according to deterministic rules applied to the input set of trees  <cit> . these methods take as input a set of gene trees produced from individual loci, allowing for separate input evolutionary histories at each locus. because genetic lineages in different species sometimes have relatively few sequence differences, however, the information in a locus can be insufficient to accurately infer gene trees, thereby allowing incorrect gene trees to adversely influence the constructed species tree . concatenation methods concatenate a set of multiple alignments and construct a tree from the concatenated alignment, treating the estimated “super-gene” tree as a species tree estimate  <cit> . because concatenation combines all loci to form a single locus, and because different loci can have different evolutionary histories that are disregarded in the analysis of the concatenated alignment, the analysis of loci in this way can lead to incorrect species tree inferences  <cit> . consensus and concatenation have in common that they are “two-stage” methods, in which species trees are inferred in two steps—inference of gene trees and then species tree inference for consensus, and inference of the super-gene tree followed by a conceptually substantial though methodologically trivial pronouncement that this tree is the species tree estimate for concatenation  <cit> . a third class of approaches can be labeled “single-stage” methods, in which species trees are inferred by simultaneously modeling the evolution of sequences among all sampled loci to output a species tree estimate  <cit> . these single-stage model-based methods often have desirable statistical properties, but because they typically explore large spaces of possibilities rather than algorithmically constructing estimated trees, they can be computationally intensive and applicable only to smaller datasets.

properties of species tree inference methods can be examined using a variety of frameworks, including theory, simulations, and empirical assessments. theoretical investigations are often concerned with limiting properties as the number of loci approaches infinity  <cit> . in-depth explorations of inference methods often rely on simulation studies, which are commonly used to investigate the performance of species tree inference methods on simulated multilocus datasets  <cit> . these theoretical and simulation-based studies have the advantage of knowing the true species tree, but the disadvantage that the scenarios they examine lack the complexity of empirical data.

an alternative approach is to evaluate methods on an empirical dataset in which the space of parameter values is defined by the evolutionary history of a group of species. recent studies have empirically investigated the performance of species tree methods from multilocus datasets in a variety of organisms, including birds  <cit> , insects  <cit> , newts  <cit> , plants  <cit> , primates  <cit> , rice  <cit> , rodents  <cit> , snakes  <cit> , and yeast  <cit> . while some of these studies constructed highly-supported species trees, others did not, possibly due to high levels of genealogical discordance resulting from incomplete lineage sorting, hybridization, and ancient rapid radiations.

in one such study,  <cit>  found that samples from a multilocus dataset of north american pines displayed widespread genealogical discordance. this pattern of incomplete lineage sorting is a common feature of long-lived shrubs and trees , and likely arises from factors such as large effective population sizes and long generation times  <cit> . because gene tree discordance is needed for different algorithms to produce different estimates, high levels of gene tree discordance make north american pines an interesting group in which to compare species tree inference methods.

in this study, we take an empirical approach to the evaluation of species tree inference methods by examining the performance of  <dig> strategies for inferring species tree topologies using multilocus data from north american pines. each “phylogenetic inference strategy” consists of three components: a method of constructing species trees from gene trees , a gene tree inference method , and an outgroup species. our framework thus focuses on two-stage inference strategies that can be separated into gene tree inference and species tree inference steps, so that the effect of the choices of gene tree and species tree estimators can be directly evaluated. we examine ∼ <dig> kilobases  of sequence spanning  <dig> nuclear loci sequenced in  <dig> individuals from eight ingroup species of pinus subsection strobus  and three outgroup species of pinus subsection gerardianae. with our empirical approach, unlike in simulation-based and theoretical evaluations, the true species tree is not known. it is still possible, however, to evaluate properties of species tree estimators without knowledge of a true tree, by comparing the features of species trees inferred by different methods. we apply techniques from multivariate statistical analysis to sets of inferred species trees to compare characteristics of species trees estimated by different strategies and to identify groups of strategies that behave similarly.
pinus 
subsection 
strobus


 <dig> <cit> .

 <dig> <cit> .

methods
north american white pine dataset
a total of  <dig> individuals were sequenced in eight ingroup species of north american white pines from pinus subsection strobus  andresen, p. flexilis james, p. lambertiana douglas, p. monticola douglas ex d. don, p. strobiformis engelmann, and p. strobus l.) and three outgroup species from pinus subsection gerardianae , the identified sister lineage to pinus subsection strobus <cit> . sequencing was conducted on haploid templates generated from dna extractions of seed megagametophyte tissue; as a single haploid sequence was generated for each individual at each locus, no phasing was necessary. gene sequences were obtained from  <dig> putative nuclear loci chosen from among ∼ <dig>  loci recently resequenced for loblolly pine  using single pass, bidirectional sanger sequencing of pcr products amplified from haploid megagametophyte tissue excised from seeds of each species. further description of laboratory protocols appears in  <cit> . sequence data were pre-processed and organized using pinesap <cit> , a bioinformatics pipeline that combines phred <cit> , phrap <cit> , and muscle <cit>  to call bases and align sequencing reads. reported nucleotide sequences consisted only of a, c, g, t, missing, and gap information, with no other ambiguity codes used. after pre-processing, the data were manually assembled and aligned using codoncode . bases were called using a minimum phred score  <cit>  of  <dig> for aligned bases. all polymorphisms were visually validated. all alignments were further aligned to resequencing data from p. taeda  using the profile-profile option in muscle <cit> . these alignments are publicly available as part of the dendrome project . genbank accession numbers for sequences in the study appear in additional file 1: table s <dig> 

of  <dig> loci sequenced initially,  <dig> were dropped from further consideration due to low overall quality of sequence reads. an additional  <dig> loci were discarded due to possible chloroplast or mitochondrial contamination, on the basis of blast analysis against pine organellar sequences in genbank <cit> . two loci were dropped due to sequence similarity to retroelement-like proteins, leaving  <dig> high-quality nuclear gene alignments. we then eliminated  <dig> loci for which at least one of the  <dig> species contained no data. this filter reduced the dataset to  <dig> loci, covering ∼ <dig> kb of aligned sequence data.

coding regions  could be confidently identified for  <dig> of the  <dig> loci by further analysis using tblastx against protein-coding genes in arabidopsis, oryza, picea, and populus. for these  <dig> loci, the gene for the highest-scoring tblastx hit, in combination with the expressed sequence tag from loblolly pine, was used to identify coding regions. site annotations for each alignment were validated with blastp analysis of the amino acid sequences derived from the inferred coding intervals against the gene that was used to derive the site annotations. for the data from the  <dig> annotated loci, ∼62% represents exonic regions, ∼18% represents intronic regions, ∼1% is from 5’ utrs, and ∼19% is from 3’ utrs. because  <dig> of the loci could be confidently identified as belonging to coding regions, with a substantial fraction of exonic sequence, the data likely contain a mixture of non-neutral and neutral regions.

overview of the analysis
the procedure for obtaining results for each of the  <dig> phylogenetic inference strategies  appears in figure  <dig>  for a given strategy, we started from a dataset d with l loci. to generate distributions on the set of clades inferred by a given strategy, we used the bootstrap, creating bootstrap replicates by randomly choosing with replacement b sets of l loci. as many of the loci are coding and the eight pine species are closely related, we chose not to bootstrap across sites within a locus to ensure that bootstrapped alignments would contain reasonable levels of variation. next, we applied a gene tree inference method to each bootstrap replicate dataset. based on the set of inferred gene trees in a bootstrap replicate, we then applied a species tree construction method to estimate a species tree topology with one of the three outgroup species. for each phylogenetic inference strategy, we constructed b= <dig> independent bootstrap datasets, thereby estimating  <dig> species tree topologies. from these topologies, we created a list of clades, each with a corresponding count of its number of appearances in the  <dig> bootstrap replicates. clade lists were then analyzed to assess differences among the estimates produced by different strategies.

creating datasets
our final set of  <dig> loci contains many loci that are highly conserved across multiple species. because of the high level of conservation, for these loci, little information exists for identifying relationships among lineages. thus, if methods for inferring gene trees were applied to certain loci, the resulting gene trees would be highly unresolved and would therefore provide little information to species tree construction methods. this issue motivates the construction of datasets that attempt to reduce the chance of inferring highly unresolved trees, and that provide phylogenetic inference strategies with the maximal amount of sequence data available.

we therefore analyzed four carefully selected subsets of the initial dataset . two of these are datasets of multiple alignments that contain information on a single individual per species . the other two contain information on multiple individuals per species . these four datasets are constructed such that each possesses desirable properties for certain strategies in the collection of  <dig> phylogenetic inference strategies, providing the strategies with as much information as possible to infer resolved phylogenies. for example, because it is desirable for a pair of species to have nonzero distance, we require pairs of distinct species to be separated by at least one observed mutation. furthermore, because it is desirable to minimize missing data, we choose individuals that yield minimal missing data in a multiple alignment. one of the two datasets with a single individual sampled per species is optimized for locus-by-locus gene tree inference , whereas the other is optimized for gene tree inference from a concatenated alignment . similarly, one of the two datasets with multiple individuals sampled per species is optimized for locus-by-locus gene tree inference , whereas the other is optimized for gene tree inference using multiple loci simultaneously . the procedures used for constructing these datasets appear in sections on “datasets with one individual per species” and “datasets with multiple individuals per species”.

let sk, k= <dig> ,…, <dig>  denote the set of individuals from pine species k, considering eight ingroup species  and three outgroup species . denote the amount of overlapping non-gap non-missing sequence between a pair of individuals x and y by nxy and denote the number of non-gap non-missing nucleotide differences between a pair of individuals x and y by dxy. further, denote the final dataset of l= <dig> loci by d={a <dig> a <dig> …,al}, where aℓ is the set of aligned sequences at locus ℓ for individuals from all  <dig> species. it is from dataset  that we create the four optimized datasets as summarized in table  <dig> and figure  <dig> 

datasets with one individual per species
the first dataset, ds, consists of alignments with a single individual sampled per species at each locus . that is, we generate a dataset of multiple alignments at each of l loci with only one individual per species, thereby creating multiple alignments of  <dig> individuals. this dataset is used by phylogenetic inference strategies that utilize the concatenation-based species tree construction methods with the maximum likelihood, maximum parsimony, and neighbor-joining gene tree inference methods . to create ds, we choose the subset of  <dig> sequences aℓs at locus ℓ by first maximizing the total overlap sequence n=∑x,y∈aℓs,x≠ynxy and then, if there is a tie for the overlap n, maximizing the total number of substitutions d=∑x,y∈aℓs,x≠ydxy. in other words, for any other set of aligned sequences aℓr⊆aℓ at locus ℓ with a set r of only one individual sampled per species, the amount of overlapping non-gap non-missing sequence in aℓr is no larger than in aℓs, i.e., n≤n. we note that the quantity nxy represents a calculation only on a pair of individuals x and y, whereas n considers all  <dig> pairs of individuals. further, for any other set of aligned sequences aℓr⊆aℓ at locus ℓ with a set r of only one individual sampled per species and n=n, the total number of pairwise sequence differences in aℓr is no larger than in aℓs, i.e., d≤d. if multiple sets r of  <dig> individuals share the same values of n and d, then we choose the set of  <dig> individuals randomly among the tied sets. we choose the “optimal” set of  <dig> individuals at each locus in this way both to maximize the sequence contributions of individual loci to the inference of gene trees  and to maximize the potential for creating resolved gene trees .

the second dataset, ds, <dig>  is a subset of ds with ls,0≤l loci that consists of only those loci in ds for which there exists at least one nucleotide difference between each distinct pair of species . in other words, for any pair of individuals x and y with x,y∈aℓs and x≠y, dxy≥ <dig>  and dxy> <dig> if x, y, or both are from species  <dig> through  <dig>  this condition of at least one nucleotide difference between species pairs assists in constructing gene trees that are bifurcating. dataset ds, <dig> is used by phylogenetic inference strategies that utilize consensus methods with maximum likelihood, maximum parsimony, and neighbor-joining .

datasets with multiple individuals per species
the third dataset, dp, is identical to our starting dataset . thus, strategies that use dp consider all available sequences. dataset dp is used by phylogenetic inference strategies that employ the concatenation-based species tree construction methods with the neighbor-joining gene tree inference method using multiple individuals .

consider a dataset d of l loci sampled randomly with replacement from dp. define 

  pijall= <dig> i=j∑aℓ∈d∑x,y∈aℓdxy1{x∈si,y∈sj}∑aℓ∈d∑x,y∈aℓnxy1{x∈si,y∈sj},i≠j, 

where the indicator random variable 1{x∈si,y∈sj} equals  <dig> if x∈si and y∈sj and  <dig> otherwise. the distance matrix defined by eq.  <dig> is used to estimate gene trees for all strategies applied to dp. given distinct species si and sj, pijall represents the p-distance  averaged over pairs of individuals, one from species i and the other from species j. note that eq.  <dig> represents a weighted rather than unweighted average for the mean p-distance between species i and j. although the distance is weighted, it is the same as a distance between pairs of species calculated on a concatenated alignment.

the fourth dataset, dp, <dig>  is a subset of dp with lp,0≤l loci. this subset consists of only those loci in dp for which there exists a pair of individuals in each distinct pair of species  with at least one nucleotide difference between them. define 

  pijℓ= <dig> i=j∑x,y∈aℓdxy1{x∈si,y∈sj}∑x,y∈aℓnxy1{x∈si,y∈sj},i≠j, 

where 1{x∈si,y∈sj} is an indicator random variable that equals  <dig> if x∈si and y∈sj and  <dig> otherwise. the numerator of pijℓ represents the number of pairwise sequence differences, summed over pairs of individuals, one from species si and the other from species sj, at locus ℓ. the denominator represents the sum across pairs of individuals, one from si and the other from sj, of the non-gap non-missing sequence shared between pairs of individuals at locus ℓ. to construct dp, <dig>  we create a subset of dp that consists only of those loci in dp for which the p-distance  is nonzero between each distinct pair of species . this dataset is utilized by phylogenetic inference strategies that employ consensus methods with gene trees inferred by neighbor-joining using multiple individuals . similarly to dataset ds, <dig>  this condition of a nonzero p-distance between species pairs assists in constructing bifurcating gene trees. we note that the species tree estimation approach taken in this study neither requires pairs of individuals in the same species to have nonzero distances nor to have distances of zero. we only enforce that the distance calculated between pairs of species is nonzero.

inferring gene trees
for each of the four datasets ds, ds, <dig>  dp, and dp, <dig>  we inferred gene trees from bootstrap samples  <cit>  that contain loci randomly sampled with replacement from the dataset. for strategies applied to datasets ds and ds, <dig>  we inferred gene trees from sequence alignments by applying either maximum likelihood  under a general time-reversible substitution model , maximum parsimony , or neighbor-joining  to a p-distance matrix calculated between pairs of alignments. for strategies applied to dp and dp, <dig>  we inferred gene trees by applying neighbor-joining to the pall and pℓp-distance matrices, respectively. we term the method for inferring gene trees from the pall and pℓp-distance matrices “neighbor-joining using multiple individuals” . gene trees were inferred using paup∗ <cit> . note that the estimation of gene trees on the scale explored in this study would be computationally intensive on the full set of sampled individuals; thus, we do not consider gene tree inference directly from alignments with multiple lineages sampled within species, and when exploring multiple lineages , we do so only with distance matrices between pairs of species rather than pairs of lineages.

inferring species trees
we view as a species tree inference method any method that outputs a species tree estimate. the six species tree inference methods in this study are concatenation  <cit> , supermatrix rooted triple , steac  <cit> , star  <cit> , rooted triple consensus , and minimize deep coalescences . concatenation and smrt are concatenation-based, and steac, star, rtc, and mdc are consensus methods. because we have adopted a unified two-stage framework for phylogenetic inference strategies in which gene trees are first inferred by one approach and species trees are then inferred from gene trees by a second approach, we did not investigate single-stage approaches such as best  <cit> , and *beast  <cit>  that bypass gene tree inference or that perform gene tree inference simultaneously with species tree inference. our analysis pipeline explores the performance of two-stage inference strategies when the roles of gene tree and species tree inference are separated, and it therefore requires that strategies estimate species trees from inferred gene trees and that they permit different gene tree inference methods to provide input to a given species tree method. the six species tree methods investigated in this article satisfy both of these conditions, whereas species tree methods such as bucky  <cit> , best  <cit> , and *beast  <cit>  do not. further, the methods we have selected are well-suited to a computationally intensive bootstrap approach included in our pipeline for generating distributions of species tree topologies, and the more computationally intensive of the single-stage methods would not be easily accommodated within this framework. given the large number of two-stage methods available, it would not be possible to be comprehensive; we have thus chosen a limited number of methods that represent a range of underlying principles. our choice of methods permits a diverse set of criteria for estimating species trees to be evaluated, and the conceptual differences in the underlying methods enable some differentiation in behavior across methods.

consider a set of l loci  with m ingroup and one outgroup species. concatenation methods concatenate the l alignments to create a single “super locus” consisting of an alignment of the m+ <dig> species across l loci. from this alignment, a gene tree is inferred by either maximum likelihood, maximum parsimony, or neighbor-joining—note that the definition of concatenation does not require that gene trees be estimated using any specific method—and is then taken as the species tree estimate. similarly, smrt creates a concatenated alignment of the m+ <dig> species from a set of l alignments. however, smrt then constructs from this concatenated alignment all m <dig> concatenated alignments of three ingroup species and an outgroup species. rooted three-taxon gene trees are then inferred from each of the m <dig> concatenated alignments. a supertree algorithm is then applied to the set of rooted three-taxon gene trees to estimate an m-taxon species tree topology. this study uses the modified mincut supertree algorithm implemented in the program supertree <cit>  to construct a species tree from rooted three-taxon gene trees.

consider a set of -taxon gene trees  inferred at each of l loci. steac estimates a species tree topology by using estimated mean coalescence times. for distinct species si and sj, the mean coalescence time is computed as the estimated coalescence time for si and sj, averaged over all l gene trees. this resulting mean is placed into a matrix of distances between species, to which neighbor-joining is applied to estimate the species tree topology .

star estimates a species tree topology by using average coalescence ranks. it assumes that the rank of the root of a gene tree is equal to the number of species in the tree . an internal node of a gene tree is then assigned one less than the rank of its immediate ancestor. for distinct species si and sj, the average coalescence rank is computed as the rank of the node that connects si and sj, averaged over all l gene trees. similarly to steac, these average coalescence ranks specify a matrix of distances between species pairs. neighbor-joining is applied to the matrix to estimate the species tree topology using phybase.

rtc estimates a species tree from rooted three-taxon tree topologies. at each locus ℓ, ℓ= <dig> ,…,l, rtc finds the set of m <dig> rooted tree topologies of three ingroup and one outgroup species that are displayed by the inferred gene tree at locus ℓ. rtc then applies quartet puzzling  <cit>  to the m3l topologies to estimate the species tree topology .

a coalescence event between a pair of lineages is considered “deep” if the coalescence does not occur in the first population in which the pair of lineages is capable of coalescing. given a gene tree, the number of deep coalescences on a species tree is defined as the total number of “extra lineages”, summed across branches of the species tree topology, that is needed to fit the gene tree within the species tree topology. here, the number of extra lineages for a branch is one fewer than the number of lineages that survive to the ancestral node of the branch; if incomplete lineage sorting does not occur, then only one lineage persists from a branch to a more ancestral branch, and there are no extra lineages. for a set of l gene trees, the number of deep coalescences for a species tree is the total number of deep coalescences for the species tree given a gene tree, summed across the l gene trees. mdc estimates a species tree topology by minimizing the number of deep coalescences. that is, mdc finds a species tree topology for which the number of deep coalescences that will fit the set of l gene trees within the species tree topology is minimal. this study utilizes the mdc implementation in phylonet <cit> .

multivariate analysis
we aim to determine which of the  <dig> phylogenetic inference strategies perform similarly, and we use multivariate analyses to define clusters of strategies that provide similar species tree estimates. consider a 72×145-dimensional data matrix s in which rows represent strategies and columns represent  <dig> observed clades, among the ∑k=28-18k= <dig> possible non-trivial clades  of eight species. entry sij in column i and row j of s is the number of times that strategy i infers clade j in  <dig> bootstrap replicates across loci.

principal components analysis  was applied to s to create a 72×2-dimensional matrix v, with rows representing strategies and the first and second columns representing the first and second principal components, respectively. plotting strategies onto the space defined by these principal components yields a two-dimensional spatial “map” of phylogenetic inference strategies. we similarly applied multidimensional scaling  to a distance matrix for all  <dig> pairs of strategies, computing pairwise distance as the mean robinson-foulds distance  <cit>  across all  <dig> pairs of bootstrap trees, and extracting the first two components. we calculated the robinson-foulds distance using treedist in phylip.

to compare spatial maps of phylogenetic inference strategies, we used procrustes analysis  <cit> . in particular, we compared the spatial distribution of a subset of 72-r strategies when analyzed alone to the spatial distribution for all strategies. the comparison enabled us to quantify the influence that a set of r strategies with a particular feature  has on the full spatial distribution. consider a proper subset Σ={σ <dig> σ <dig> …,σ72-r} of the full set of strategies. consider a ×145-dimensional data matrix sΣ in which rows represent the strategies in set Σ and columns represent observed clades. sΣ is a submatrix of s, in which the rows corresponding to strategies in Σ are selected from s. consider a × <dig> target matrix x and a × <dig> comparison matrix y. x is matrix v restricted to the set of strategies Σ. y represents the first two principal components in the pca applied to matrix sΣ. now consider a × <dig> matrix z=byt+c, where b is a scaling factor, t is a 2× <dig> matrix that rotates and reflects y, and c is a × <dig> matrix that has constant columns and that is used to translate the matrix. procrustes analysis seeks to find b, t, and c to minimize the sum of squared differences between x and some × <dig> matrix z⋆=byt+c. that is, z⋆ is formally defined as z⋆=argminz{∑i=172-r∑j=122}. the dissimilarity measure between x and z⋆ is computed as 

  ∑i=172-r∑j=122∑i=172-r∑j= <dig>  

where μj=172-r∑i=172-rxij is the jth entry of the centroid of x. this measure takes the sum of squared differences between points on the spatial maps defined by x and z⋆ and normalizes it by the sum of squared differences between the points on the spatial map defined by x and their centroid.

define a cluster as a set of strategies and let the centroid of a cluster be the location in the 145-dimensional space of clades whose coordinates are the means of those of all strategies in the cluster. hierarchical clustering was performed by first creating a matrix of euclidean distances between all  <dig> pairs of 145-dimensional vectors represented by the matrix s. define the within-cluster sum of squared euclidean distance as the squared euclidean distance between a point in a cluster and the cluster centroid, summed over all points in the cluster. from the 72×72-dimensional matrix of euclidean distances between strategies, a dendrogram relating the strategies was constructed using the ward algorithm  <cit> , which iteratively merges clusters until all points are contained within a single cluster. for a given iteration, two clusters are merged if their merged cluster has a smaller within-cluster sum of squared euclidean distances than any other potential merged cluster. the nesting of clusters created by the algorithm defines the dendrogram.

we performed k-means clustering on the  <dig> 145-dimensional vectors, using k clusters, k= <dig> ,…, <dig>  given k, strategies were separated into k clusters on the basis of the squared euclidean distance between all pairs of the strategies in a 145-dimensional space. we ran  <dig> replicates with random starting locations. each replicate yielded a total within-cluster sum of squared distances for the set of k clusters, representing the within-cluster sum of squared distances between points in a cluster and the cluster centroid, summed over all k clusters. we then chose the set of cluster assignments that had the minimum total within-cluster sum of squared distances, where the minimum was taken over all  <dig> replicate starting locations.

to compute the pearson correlation coefficient between a pair of strategies, we only used points in the 145-dimensional vector that were nonzero in both strategies being compared.

RESULTS
we accounted for the variable outcomes of individual phylogenetic inference strategies by applying the strategies to bootstrap datasets instead of their respective full datasets. our analysis identified  <dig> distinct clades observed in the set of  <dig> phylogenetic inference strategies, among  <dig> possible non-trivial clades on eight species, across  <dig> bootstrap replicates for each strategy. from these clades, we created a 72× <dig> matrix s in which each row is a strategy and each column is a clade. the value of sij, the cell in row i and column j, is the number of times among the  <dig> bootstrap replicates that strategy i inferred a species tree with clade j. this summarized dataset s of clade counts was used for all further analyses.

clade size
we first investigated the level of balance  <cit>  in the tree topologies inferred by each phylogenetic inference strategy. the distribution of clade sizes  provides a basis for measuring tree topological balance. topologies with numerous small clades tend to be more balanced than topologies with large clades. for example, consider the topologies tbal=))) and tunbal=c)d)e)f)g)h). topology tbal is the most balanced eight-taxon topology whereas tunbal is the most unbalanced eight-taxon topology. considering non-trivial clades, tbal has four clades of size two and two clades of size four. tunbal has one clade each of size two, three, four, five, six, and seven. thus, the clades of tbal are smaller than those of tunbal. the mean clade size for tbal is ∼ <dig>  and the mean clade size for tunbal is  <dig> .

clustering of strategies
we next used pca, mds, hierarchical clustering, k-means clustering, and correlation analysis on the matrix of clades s to identify phylogenetic inference strategies that perform similarly. figure  <dig> displays plots of the first two principal components, which account for  <dig> % and  <dig> % of the variation across strategies, respectively. figure 4a shows that separate clusters are formed by strategies that are based on concatenation, smrt, and steac, and that strategies based on star, rtc, and mdc form a cluster together. further, a larger cluster is formed by strategies that are based on concatenation, smrt, and steac, and another larger cluster is formed by strategies that are based on star, rtc, and mdc. these larger clusters have a simple interpretation in that one of the larger clusters contains topologically-based strategies  and the other contains strategies that are not strictly topologically-based . strategies are classified as topologically-based if they only use information on tree topologies to construct a species tree. in contrast, strategies are classified as not strictly topologically-based if they use information other than the gene tree topologies, such as sequence or branch length information, to construct a species tree. relabeling the points in figure 4a according to gene tree inference method, figure 4b shows that strategies that are based on m  form a cluster, and that there are no separate clusters for strategies that are based on ml, mp, or nj. figure 4c, which labels points according to outgroup, shows that no strategies separate into clusters based on the choice of outgroup. when we apply mds to robinson-foulds distances between the sets of bootstrap replicate trees produced by pairs of strategies , we obtain similar observations of the clusters of strategies, detecting an important role for m and for the difference between topologically-based and non-topologically-based strategies, and no strong signal for the outgroup choice.

from figure  <dig>  we can see that much of the variation across the  <dig> phylogenetic inference strategies, as explained by pca and mds, is caused by m. strategies based on m are more similar in clade outcomes to other strategies based on m than they are to other strategies that are not based on m. the magnitude of this effect can be quantified using procrustes analysis, which demonstrates that m has a large influence on the spatial relationship among all other phylogenetic inference strategies .

interestingly, the clustering of strategies by pca and mds in figure  <dig> matches well with the groupings observed in figure  <dig>  which is likely driven by similar signals. in figure  <dig>  three large clusters are represented by the subtree to the left of the root of the dendrogram  and by two subtrees to the right of the root . the two subtrees to the right of the root  involve strategies that are based on m  or strategies that are based on species tree construction methods that are topologically-based . that is, strategies that correspond to the orange cluster are based on either star, rtc, or mdc. in contrast, the subtree to the left of the root  contains only strategies that use species tree construction methods that are not strictly topologically-based .

from figures  <dig> and  <dig>  we find that phylogenetic inference strategies form three basic clusters: a cluster that involves strategies that are based on m, a cluster that involves strategies that are topologically-based, and a cluster that involves strategies that are not strictly topologically-based.

clade flow
following the “haplotype flow” computations of  <cit> , we can view “clade flow” as a proportion of clades inferred by one phylogenetic inference strategy that are also inferred by another strategy. figure  <dig> displays a heat map that represents a form of clade flow, where the cell at row i and column j in the heat map represents the fraction of clades inferred by strategy i that were not inferred by strategy j. by definition, the heat map is not symmetric. as can be seen from the mostly white and yellow boxes for rows corresponding to strategies based on m, these strategies tend to infer clades that are supported by other strategies. that is, if a species tree topology is inferred by a strategy that is based on m, then clades displayed by that topology will often also be present on species tree topologies inferred by other strategies. in additional file 2: figure s <dig>  strategies based on m contribute to the most variation across strategies. a possible explanation for this observation is that the flow of clades is largely unidirectional. that is, if a strategy is based on m, then clades that are inferred by that strategy also tend to be supported by other strategies; however, if a strategy not based on m infers a clade, then that clade is not often supported by strategies based on m. because clades inferred by strategies based on m also tend to be supported by other strategies, it follows that strategies based on m tend to infer clades that are also supported by other strategies based on m. this sharing of clades among strategies based on m causes those strategies to be more similar to each other than they are to strategies not based on m. in contrast to the results for m, as can be seen from the mostly dark boxes in rows for strategies based on mdc, strategies based on mdc tend to infer clades that are not supported by other strategies .

similarly to the behavior of mdc, strategies that are based on concatenation, smrt, and steac together with ml, mp, or nj share more clades with other such strategies  than with the remaining strategies . in contrast, as was observed with m, strategies based on star and rtc together with ml, mp, or nj share similar numbers of clades among other such strategies as with the remaining strategies . these results suggest that strategies that are topologically-based  tend to infer clades that are also supported both by other topologically-based strategies and by strategies that are not strictly topologically-based, whereas strategies that are not strictly topologically-based  tend to infer clades that are not supported by strategies that are strictly topologically-based .

representative topologies
we next wanted to use a set of representative species tree topologies to highlight similarities and differences in topologies constructed by various strategies. topologies were estimated using the greedy consensus algorithm  <cit>  applied to clade counts. because our previous results  indicate that the choice of outgroup species does not strongly influence the overall inferred topologies, it is sensible to average across outgroups. therefore, we first present topologies for each of the  <dig> species tree–gene tree inference method pairs constructed from clade counts that were averaged over the three outgroups . next, to obtain a clearer picture of the types of topologies that are inferred by the six species tree inference methods, we present topologies for each of the six species tree inference methods, constructed from clade counts that were averaged over gene tree inference methods and outgroup species . finally, to assess the influence that various gene tree inference methods have on the overall inferred species tree topology, we present topologies for each of the four gene tree inference methods, constructed from clade counts that were averaged over species tree inference methods and outgroup species .

discussion
in this article, we have empirically evaluated strategies for inferring species tree topologies from multilocus sequence data. we have found that mdc tends to infer balanced topologies, whereas smrt and steac tend to infer more unbalanced topologies. this bias toward balanced topologies exhibited by mdc is a consequence of the nature of the criterion that mdc uses to construct species trees, reflecting a theoretical finding that species trees with more balance have lower deep coalescence costs  <cit> .

the strategies that we have examined fall into three classes in terms of the species tree inferences they produce: strategies applied only to datasets including all available sequenced individuals , topologically-based strategies , and strategies that are not strictly topologically-based . while it is not unexpected that some approaches would behave similarly, it is surprising that strategies did not cluster based on the dataset or approach used . instead, strategies that take quite different species tree construction approaches  form a cluster. topologically-based strategies tend to infer clades that are supported by other strategies, whereas strategies that are not strictly topologically-based tend to infer clades that are not always well-supported by other strategies. for example, clades inferred from strategies that are not strictly topologically-based tend not to appear on trees that were inferred from strategies that are topologically-based. a possible reason for this observation could be a lack of phylogenetic signal to properly infer branch lengths; that is, if a phylogenetic inference strategy is not strictly topologically-based, then sequences with little phylogenetic signal  can strongly influence the species tree inferred by that strategy. because steac uses branch-length information to infer a species tree topology, sequences with little signal can reduce its performance relative to topologically-based methods such as star  <cit> .

although our main goal has been to use north american pines to investigate relationships among phylogenetic inference strategies, our results also provide some information about the phylogenetic placement of the pine species in the study. this analysis is the first multilocus study to provide substantial confidence for a sister relationship of p. chiapensis and p. strobus. pinus chiapensis is a threatened species of mexico and guatemala whose phylogenetic affinity has been uncertain. morphological and molecular evidence have been used to alternately argue for a sister relationship between p. chiapensis and p. strobus, from eastern north america, or between p. chiapensis and p. monticola, from western north america  <cit> . here,  <dig> of  <dig> trees in figure  <dig> grouped p. chiapensis and p. strobus as sister taxa, mostly with reasonably high bootstrap support. when phylogenetic inference strategies were averaged over either gene tree methods  or species tree methods , the {p. chiapensis, p. strobus} clade was always recovered.

the close phylogenetic affiliation of p. ayacahuite, p. flexilis, and p. strobiformis has long been suspected, as these three species represent similar forms that are continuously distributed from southern british columbia and alberta into honduras  <cit> . here, the {p. ayacahuite, p. flexilis, p. strobiformis} clade is well-supported, although relationships among these three species are less clear. two possibilities, namely , p. ayacahuite) and , p. flexilis), appear more likely based on our analysis . interestingly, figure  <dig> finds that the , p. flexilis) clade is well-supported by all strategies that use m.

beyond these clades, the full phylogeny of this group of pines remains unclear. considering the trees inferred in figure  <dig>  relationships among p. albicaulis, p. lambertiana, p. monticola, and the clades {p. chiapensis, p. strobus} and {p. ayacahuite, p. flexilis, p. strobiformis} are not stable across inference strategies, and bootstrap support is generally low. we might have expected greater resolution in this study, due to the exhaustive sample of the ingroup, extensive intraspecific sampling, large molecular dataset, and ease of species delimitation .

we can attribute the lack of resolution in the pine phylogeny to several possible sources. first, the loci in the study were chosen because they amplify across a broad range of taxa from subgenus strobus , and might therefore be more slowly evolving and less informative for phylogenetic inference than typical loci. thus, the size of the dataset might not be indicative of its information content for phylogenetic inference. second, we have focused on strategies that have been implemented for ease of comparison and have not explored the full collection of available methods , nor have we considered such techniques as investigation of different subsets of taxa or loci on the basis of the strategies that we have studied . a study with a primary goal of resolving the pine phylogeny might achieve greater resolution through analyses that deviate from our standardized procedure. third, the speciation events of interest might have occurred fast enough that retention of ancestral polymorphisms, as has been observed elsewhere among conifers  <cit> , might inhibit convergence on a stable, well-supported topology. further work with more loci or faster-evolving loci will be important for distinguishing among these alternatives.

one caveat for interpreting our results is that except in our analyses based on m, we only considered a single lineage sampled within a species. information on multiple lineages of the same species can have a significant effect on the performance of species tree inference methods, and many methods can use information on coalescences within and between species as part of the inference process . therefore, it is important to keep in mind that we have used one of a number of potential schemes for sampling individuals within our data, as sampling scheme can have an impact on the efficacy of species tree estimators  <cit> .

another caveat is that some of the datasets were obtained from procedures designed to maximize information content at each locus. these optimization procedures yielded datasets with one sequence sampled per species. because the sequences within these optimized datasets are no longer randomly sampled within each species, a possible concern is that our results are not representative of random samples. this concern might be warranted when considering the inferred relationships of the various pine species in figures  <dig>   <dig> and  <dig>  however, as the strategies applied to each of these optimized datasets retain their general relationships across datasets , the conclusions drawn in this article should also hold for large noncoding datasets. additionally, it is important to mention that an identical dataset is not used for all strategies considered, and notably, strategies that used m relied on different datasets from those that used ml, mp, and nj. although this is a limitation, the clustering pattern suggests it is not a major concern. in our principal components , cluster , and correlation  analyses, though the strategies were split by whether they used m or were either topologically-based or not strictly topologically-based, these three categories do not precisely map onto the different datasets. therefore, though the dataset varies across the  <dig> strategies, other factors beyond the difference in datasets are contributing substantially to the difference in results.

finally, a third caveat is that to maintain a uniform procedure across strategies, we did not estimate the nucleotide substitution model before applying maximum likelihood. this choice might have caused some systematic bias in ml gene tree estimates by overparametrizing the substitution model. however, we found that our inference strategies did not cluster by whether maximum likelihood, maximum parsimony, or neighbor-joining was used , suggesting that any systematic bias due to using a general time-reversible substitution model did not drive our observed clustering patterns.

CONCLUSIONS
based on a collection of two-stage strategies that we have investigated, representing a subset of all available methods, our analyses have highlighted several aspects of phylogenetic inference strategies that enable recommendations for inferring rooted phylogenies from large-scale multilocus data. first, it is beneficial to examine multiple strategies  <cit> , considering some methods that use only topological information  and others that also incorporate additional information . if species tree topologies returned by these different classes of species tree construction methods agree, then an investigator can be more confident in the inferred tree topology. second, estimates should not be based solely on species tree construction methods that appear to be biased toward certain types of topologies . instead, it is preferable to utilize these types of methods in conjunction with other approaches. for example, after obtaining an unbalanced inferred tree from an inference method, if mdc also infers the same unbalanced topology, then we can be more confident that the true species topology is actually unbalanced. finally, it is best to utilize as much information as is available on individuals at every locus. that is, if multiple individuals are sampled within a species at a given locus, then we should use all available sequence data from the species . this point is supported by the observation that clades inferred by m tend to “flow” to other strategies . based on our findings, we recommend the joint consideration of multiple approaches to estimating species trees that originate in different locations in the space of methods and that exhibit diverse properties in their species tree estimates.

availability of supporting data
the data used in this study are available in additional file  <dig> 

competing interests
the authors declare that they have no competing interests.

authors’ contributions
md, js, and nar designed the project. dbn, aje, js, al, and rc generated and prepared the data. md and js performed the data analysis. md, js, and nar wrote the paper, with contributions from all authors. all authors read and approved the final manuscript.

supplementary material
additional file 1
genbank accession numbers for sampled sequences.

click here for file

 additional file 2
supplementary information on phylogenetic inference strategies, sample collection locations, and procrustes analysis.

click here for file

 additional file 3
zip archive containing data filesdp,dp, <dig> ds,ds, <dig>  and a description of these files.

click here for file

 acknowledgements
we thank zachary szpiech, cuong than, chaolong wang, and two anonymous reviewers for their helpful comments and ben figueroa, ismael grachico, erik grimstad, brian knaus, john liechty, and jill wegrzyn for help with data generation and analysis. this work was supported by nsf grants dbi- <dig>  dbi- <dig>  dbi- <dig>  deb- <dig>  and by the murdock college science research program.
