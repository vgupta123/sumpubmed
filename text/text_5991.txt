BACKGROUND
repetitive sequences make up a significant part of many genomes  <cit> . they are dynamic elements that contribute to plasticity, and they generally evolve faster than coding regions; for this reason they can be used in species identification and phylogenetic inference  <cit> . current genome sequencing methodologies involve mostly high-throughput shotgun approaches, and genome survey sequencing  is often an initial but large-scale step. the presence of a considerable amount of repetitive sequences in the genome under study can hamper library construction, accurate sequencing and especially assembly of the final genome sequence. an early assessment of the nature, frequency and variability of the repetitive content of a genome is therefore important. such data strongly influence the evaluation of sequencing strategies and assembly because of the impact of repetitive elements on the estimation of genome coverage, library quality and progress in scaffold construction. the elimination of repetitive sequences from the initial assembly process is important to avoid errors and unnecessary complexity. identified repeats can also be useful in a variety of other studies, for instance as molecular markers in mapping and strain characterization. for example, prior to large-scale sequencing of the leishmania braziliensis genome, most of its known repeats were simple microsatellites or species-specific repeats  <cit> , while for leishmania major, a closely related species, several other types of repeats were reported  <cit> . a global analysis of the types and frequencies of repeats of l. major could only be done after completion of the sequence  <cit> .

algorithms for de novo repeat detection  <cit>  are normally based on suffix trees  <cit> , on word count algorithms  <cit>  or on similarity searches  <cit> . programs like repeatmasker  search for repeats using a database of known repetitive sequences, such as repbase  <cit> . however, the high evolutionary rates make detection of a particular repeat feasible only in closely related organisms, and many repeats are species-specific  <cit> . it is important to note that these programs usually require a complete and accurate genome assembly while, on the other hand, the presence of repeat sequences greatly hampers the assembly process in many eukaryotes, such as in trypanosoma cruzi  <cit> , human  <cit>  or drosophila  <cit> . one of the difficulties in repeat recognition in gss data arises when repeats are longer than the reads. during the assembly process these repeats tend to be joined into one contig  <cit> , but ideally, reads with repetitive sequences should be excluded from the initial assembly and mapped manually in the final stages  <cit> . identifying repetitive units before the assembly thus avoid errors and speeds up the process, providing more accurate scaffolds. however, it is difficult to detect and estimate the frequency of repeats when working with a small dataset , and it is hard to differentiate between a truly repetitive sequence and a genomic region with higher sequencing coverage.

to help identify repetitive units before the assembly phase of a genome, we designed and evaluated a pipeline  based on similarity searches  <cit> , the interpretation of sequence landscapes  <cit> , the assembly of clustered sequences  <cit>  and in-house perl scripts. the main challenge is to determine the limits of the repetitive sequences found in the gss dataset and to estimate their abundance in the whole genome.

as a case study, we used  <dig> gss with at least  <dig> bp of good quality  generated in our laboratory and covering approximately  <dig> % of the genome of l. braziliensis. several putative repetitive structures could be identified with our approach. results were then verified against several datasets representing about 16% coverage, such as l. braziliensis gss obtained from embl , from the sanger centre  and against the complete assembled genome. human leishmaniasis, a tropical disease transmitted by phlebotomine sand flies, is caused by protozoan parasites of the genus leishmania. l. braziliensis is the most common etiological agent of cutaneous leishmaniasis in brazil and the disease constitutes an important public health problem in brazil and other central and south american countries  <cit> . we also applied rerep to a large set of reads obtained from a genome project of e. coli k <dig> using  <dig> technology, to ascertain the viability of the methodology with the shorter reads from this approach. we could also determine the number of false positives and negatives in this experiment, as the genome is completely assembled.

RESULTS
design and testing of rerep
during gss sequencing in a larger project, and usually before assembly, repetitive elements should be identified and temporarily removed from the dataset. for this purpose, we developed a workflow  where gss sequences are cross-compared  using blast  <cit>  or nucmer from the mummer package  <cit> . to speed up the algorithm, the first seed  can be increased. for each read, all alignments of minimal length l enter into the construction of the sequencing landscape, a graphical representation of the abundance of each base in the sequence . if sub-sequences of a landscape occur with a frequency higher than the chosen threshold t, they are considered to be putative repetitive sequences . prss are extended if the base frequencies of at least one border of the sequence landscape are above the threshold t, by assembling all sequences included in the construction of its sequence landscape. the cycle is repeated to find shorter or less abundant repetitions, as shown in figure  <dig> 

to test our rerep pipeline, we first applied it to cosmid l <dig> of l. major, which had previously been analyzed for the presence of repeats  <cit> . figure  <dig> shows a dotplot  of cosmid l <dig> against itself, showing the repetitive structures present in this sequence. also shown are two corresponding sequence landscapes . the sl represents the frequenc y of each base as a participant in a high scoring pair , generated from alignments with length bigger than l. in this case for the value of l we chose  <dig> and  <dig>  in general, one is interested initially in finding the larger repeats. as a rule of thumb, one can start with an l value of half the size of the average read length. the user can define the sensitivity of repeat detection by adjusting the parameter t . in fully assembled genomes t should be one, while for gss analysis, t must be adapted to the degree of coverage. even with low coverage, simple overlaps of sequences can be interpreted as repeats, thus t must be sufficiently high to minimize the number of false positives.

analysis of l. braziliensis gss datasets
analysis of an experimental dataset containing  <dig> l. braziliensis gss reads generated in our laboratory allowed the detection of five putative repetitive sequences prs  using the parameters set l =  <dig>  t =  <dig>  these prss and the respective sls can be seen in the additional file 1: prs. prs_ <dig> is composed of several in tandem repetitions of a shorter element, called tanprs_ <dig>  visualized after analysis of prs_ <dig> with the emboss program "etandem"  <cit> . sequencing of a pcr product with primers designed to amplify the prs_ <dig> element  confirmed the existence and structure of the tandem repeat. the size of the largest fragment obtained by pcr was around  <dig> kb . as the larger element prs_ <dig> contains such tandem repeats, its copy number cannot be found precisely by the analysis of blast  <cit>  results, nor by algorithms based on word counting; the analysis of the shorter repetitive elements  gives a better estimate of their frequency. the copy number of tanprs_ <dig> in our 970_gss dataset, using different mismatch scores, was equal to  <dig>   <dig>   <dig> and  <dig> when the allowed percentage of mismatches was set to 0%, 5%, 10% and 15%, respectively. for comparison, we assembled a dataset containing  <dig> l. braziliensis gss from the embl database; a dataset of the first  <dig> wgs reads from the l. braziliensis genome project at the sanger centre and a set of  <dig> simulated reads generated from the l. braziliensis assembled genome sequence  using the program 'readsimulator' . finally, the complete assembled genome was used to obtain the best possible copy numbers. as the final assembly of the genome of l. braziliensis contains a high number of gaps, the number of repeats could be wrong. under the same conditions mentioned above, we obtained for tanprs_ <dig> in the 9644_gss_embl frequencies of  <dig>   <dig>   <dig>   <dig> and compared to true copy numbers of  <dig>   <dig>   <dig>   <dig> in the assembled genome. a multiple alignment shows few mismatches between the tanprs_ <dig> elements . prs_ <dig> was found twice in the 970_gss dataset, and  <dig> times in the complete genome, while prs_ <dig> was identified by rerep as a prs but, after verification against the complete genome sequence, was shown to be present only once ; a subregion of this prs  has similarity to a single copy dna in l. major and l. infantum. prs_ <dig> was found  <dig> times in the 970_gss dataset, and  <dig> times in the genome . prs_ <dig> was found  <dig> times in 970_gss,  <dig> times in 9644_gss_embl and  <dig> times in the complete genome, and was identified as a subtelomeric region of l. braziliensis  <cit> , occurring in  <dig> chromosomes. prs_ <dig> was also found in l. peruviana, l. panamensis and l. guyanensis, but neither in l. major nor in l. infantum.

additional analyses with repeatmasker and repbase  <cit>  revealed no known repeats in 970_gss, including repetitive elements previously described by other groups for the genus leishmania . thus, less than  <dig> % of the 970_gss dataset is composed of simple repeats and low-complexity regions. table  <dig> shows the length of each prs, the number of reads and chromosomes containing the prs and the frequency of each repeat in the respective datasets.

the number of occurrence of each prs was calculated after parsing blast results using an e-value with cut-off e- <dig> in the following datasets:  970_gss;  9644_gss_embl; and  the complete assembled genome of l. braziliensis. number of reads  in dataset a and b and chromosomes  in dataset c where the corresponding prs was found.

minimizing false positives by adjusting the parameter t
in order to minimize the number of false positives detected by rerep, we analyzed the behaviour of the t parameter, which is related to the sequencing coverage and the abundance of the prss. we applied rerep to the three reference datasets 9644_gss_embl, 9693_wgs_sanger and 9644_simgss_sanger with parameters l =  <dig> and t from  <dig> to 5; we also used t =  <dig> for the 9644_gss_embl dataset. the results of the  <dig> runs were analyzed against the whole genome sequence obtained by blast to check the abundances of the prss, broken down by the number of hits per prs .

the number of prss found by rerep with different t parameter for the three datasets is given in the first line . the detected prss of each individual run are blasted against the whole genome sequence . the number of hits is reported in the following lines: # no hit and #  <dig> hit indicates false positives. # >  <dig> hits indicate prss occurring more than twice in the genome. # >  <dig> hits indicates highly repetitive prss. an l parameter of  <dig> was used.

the value of t is directly correlated with specificity , and inversely with sensitivity .

one prs from the 9693_wgs_sanger dataset  was not found in the complete genome, nor were several prs from the 9644_gss_embl dataset. these probably represent non-l. braziliensis sequences, which are artefacts in the library. these reads were compared with genbank nr/nt and are considered as heterologous sequences, probably derived from the cloning procedure and not removed before submission. in the 9693_wgs_sanger dataset the spurious prs matched with maxicircle  sequences; the anomalous hits in the 9644_gss_embl included  <dig> reads with no match in genbank. interestingly, the  <dig> sequences had a gc content of 20% as opposed to 58% for the genome of l. braziliensis.

as can also be seen in table  <dig>   <dig> repetitions out of  <dig> prss were identified in the 9693_wgs_sanger dataset with t =  <dig>  these sequences occur between  <dig> and  <dig> times in the assembled genome. this high amount is due to tandem repetitions. three elements could be found in  <dig> to  <dig> different chromosomes . on the other hand the amount of false positives is high:  <dig>  and ). in the 9644_gss_embl dataset,  <dig> putative elements were found , but only  <dig> were found more than twice in the assembled genome, resulting in  <dig> false positives. interestingly, the value of the t parameter that minimizes the number of false positives is different for different datasets of the same genome: t >  <dig> for 9644_gss_embl dataset and t =  <dig> for the two others.

checking the uniformity of read distribution
the high number of false positive prss in the 9644_gss_embl dataset suggests that bias was introduced at some point, either in the library construction, sequencing procedure  or sequence submission, causing data redundancy. the analysis of a multiple alignment of the reads containing the prss can be enlightening. if there are no mismatches, sequences are probably from the same genomic region, because genuine repeats show a lot of mismatches, mostly at the boundaries or flanking regions .

applying rerep to data from new sequencing technologies
we further applied rerep on a data set of escheria coli obtained from a 454-read sequencing run. as this genome has been fully assembled, we were able to detect false positives and false negatives. additional file  <dig> shows the repeats of minimum length of  <dig> bp in e. coli and their abundance. we applied rerep with different sets of parameters, varying the l and the t parameter. for reasons of speed we increased the word size parameter to  <dig>  therefore, divergent repeat copies might not be found, but this is not a problem, as the assembler will be able to differentiate these repeats. of the  <dig> repeats in the e. coli genome ,  <dig> occur more than twice, and the best parameter setting to minimize the number of false positives are l =  <dig> and t =  <dig>  detecting  <dig> false positives, and  <dig> true positives. with l =  <dig> and t =  <dig>  we detected  <dig> false positives and  <dig> repeats . the maximum amount of found repeats  was  <dig>  , at the cost of  <dig> false positives and  <dig> with the cost of  <dig> false positives.

discussion
the detection of repeats in gss data is an open problem. correct identification of repetitive elements greatly facilitates assembly, especially for organisms with a high proportion of repetitive sequences. in fact, most of the available eukaryotic genome sequences are not fully assembled, repeats being one of the main reasons. for instance, the trypanosoma cruzi genome  <cit>  could not be assembled because approximately 50% of its genomic content consists of repetitive sequences and low complexity regions, and also because of heterozygosis. similar problems occur in the genome projects of human  <cit>  and drosophila  <cit> . currently, most programs that detect repetitive elements are used with an assembled sequence. a few other approaches, such as  <cit> , attempt to find repetitions in sequencing data, but work with high coverage data and do not propose an algorithm, but use the output of phrap and a general statistic of expected number of contigs.

some assembler programs automatically mask k-mers that occur more frequently  <cit>  or try to identify flanking regions or branching points  <cit>  before and during the assembly process. other approaches split contigs that have high coverage into several contigs after assembly, using snps  <cit> .

in general, no analysis of repetitive sequences in early-stage gss acquisition is performed, which often causes problems with assembly and evaluation. we have here presented a pipeline called rerep  that can detect de novo repeats in gss sequence data. in addition, a rough estimate of the total number of repeats in the genome can be obtained. the pipeline was evaluated by analyzing cosmid l <dig> of l. major  and by applying rerep to different datasets of l. braziliensis and to e. coli.

working with a dataset of low genome coverage poses certain difficulties. for a sequence to be identified as a repeat, it must occur at least twice in the dataset. figure  <dig> shows possible scenarios for repeat identification. not all repeats will be found, depending on the coverage and the distribution of the gss data. still, it is more likely to find short tandem repeats than, for example, lines or sines, because the short pattern will occur far more often in the dataset  <cit>  and even more than once in a single read, as shown by the element tanprs_ <dig>  the relative paucity of prss found in the 970_gss dataset of l. braziliensis suggested a genome content of about 3% of repetitive elements. in the publication of the genome  <cit> , around 10% of repeats was estimated.

extrapolations to the whole genome based on the analysis of a dataset covering only  <dig> % should be made with caution. the estimation after analysis of the 9693_wgs_sanger dataset was more precise , since the coverage was ten times higher.

our pipeline includes the possibility of adjusting three parameters: i) the choice of the e-value and word size as a cut-off for sequence similarity detection allowing to find more divergent sequences; ii) the l parameter, which correlates with the expected size of the repeats and iii) the choice of the threshold t, which is related to the expected frequency of a base in an hsp, or the genome coverage in the sequencing project.

we normally choose the l parameter around half of the read length. this means that the overlap is at least 50%. smaller l will find shorter repeats . in general, our algorithm does not have any limitations in terms of read length. but for short reads of around  <dig> bp, k-mers algorithms might be more efficient. the results from the analysis with data from  <dig> sequencing technology demonstrate this. these reads were also used to examine the false positive and false negative rates. for assembly purposes, it is better to set aside all detectable repetitive elements, even including a larger number of false positives.

but for repeat studies, the amount of false positives should be minimized. in principle, each overlap in an assembly that forms a contig can also be considered as a repetition. to avoid "detection" of these overlaps, the t parameter can be increased. lander and waterman  <cit>  described the amount of overlaps of repeats by a poison distribution. so we know that, for a coverage of 1×, 10% of the genome is represented at least three times in the reads at hand. if the genome has repeats, this number will be higher, and less contigs will be formed. to distinguish true overlaps from repetitions, one can examine the border of the overlaps in the sequence landscape. if the amount of hits arises at a given position with at least two other reads, this represents probably the start of a repeat, as it is not likely that more than two sequence reads start on the position.

rerep is an analytic tool for the analysis of gss data before assembly, with the aim of estimating and identifying repetitive elements and their frequencies as precisely as possible, allowing good decisions to be made during assembly. visualization tools like consed  <cit>  offer functionalities such as visualisation of the read depth, which has certain similarities with our sl. however, while the assembler tries to distinguish between these very similar reads as much as possible, rerep tries to join and identify them as part of the same prs. assembly results cannot be parsed like the sequencing landscapes can after using different l or t parameters, because this information is not available. rerep can find repetitions even in a small preliminary dataset, and the use of sls provides a more quantitative and assessable way to analyze the presence of repetitive structures compared to homology matrices . future work will include a better differentiation between real polymorphisms and sequencing errors using mate pair information, for instance.

CONCLUSIONS
we have developed a new approach for determining repeats in gss data. depending on the genome coverage of the gss dataset, it may not be possible to detect all repeats. but depending on the copy number of the repetitive elements identified, it is possible to obtain a rough estimate of their total frequency in the genome. in addition, the results can be used to optimize the sequence assembly process. after application of our pipeline to a l. braziliensis gss dataset, four repeats were identified, of which three had not been documented so far.

