BACKGROUND
currently, the comparison of multiple sequence alignments  is based on aligning the sequence profiles that represent conservation at specific positions. however, the alignment quality of profile-profile alignment becomes unreliable as the sequence identity of seed sequences becomes low  <cit> . even though using predicted secondary structure as additional information slightly improves profile-profile alignment, it is still unsatisfactory since the most protein secondary structure prediction methods are based on sequence profile. in this situation, using correlated mutation information originated from coevolution of two or more residue positions would be informative.

constructing alignments with high quality is important in comparative modeling, in which target-template alignment is a crucial step together with template selection, but the sequence alignments based solely on statistical amino acid matches become undependable at low sequence identity. particularly, below 20% sequence identity referred to as midnight zone, using sequence alignment without structural evidence can be problematic. practically, it is found that many proteins with similar structure have low sequence identity  <cit> , and, in casp <dig>  about half of the targets have the single best templates with <20% sequence identity  <cit> . this means that the reliability of alignment in the midnight zone is a bottleneck for protein structure prediction, and therefore its improvement is strongly desirable.

correlated mutation is estimated in various ways. mcbasc algorithm  <cit>  calculates the correlation of amino acid substitutions at individual positions. sca algorithm and its variants  <cit>  measure the relative amino acid frequencies observed after perturbing the msa. mutual information  <cit>  is used for estimating correlated mutation. recently, it is also found that normalizing mutual information improves the determination of coevolving residues  <cit> . in spite of these efforts, the application of correlated mutation is restricted mainly to inter-residue contact prediction  <cit>  and functional site prediction  <cit> . moreover, it has not been utilized for the purpose of sequence alignment, the most basic procedure in sequence analysis, and there is no universal method for comparing correlated mutation patterns of different proteins.

in this article, we introduce a novel method, cm profile, which represents correlated mutation based on signal processing technique called linear predictive coding   <cit> , and apply it to the protein sequence alignment problem. the results show that the employment of correlated mutation improves alignment quality consistently at different scop levels and sequence identities. the analysis on a few examples shows that the use of cm profile makes alignments preserve correlated mutation and the residues with common contacts are aligned with high scores.

methods
data
we prepare protein pairs which are non-redundant and distantly related with each other. the data are derived from scop  <cit>  version  <dig>  with <35% sequence identity downloaded from astral compendium  <cit> .  <dig> domains whose msa is composed of less than  <dig> sequences are omitted because correlated mutation analysis using msa with a small number of sequences can be unreliable and include much noise, and  <dig> domains remain. to make pairs of distantly related homologs, we select superfamilies with at least  <dig> domains, and pair the domains with each other in each superfamily. the selected domains are composed of  <dig> domains of  <dig> folds,  <dig> superfamilies, and  <dig> families. for parameter selection we use  <dig> pairs consisting of  <dig> domains randomly chosen, and for testing use  <dig> pairs consisting of the remaining  <dig> domains.

the frequency matrices and the position-specific score matrices  representing sequence profiles are automatically generated by running psi-blast  <cit>  version  <dig> . <dig> against ncbi nr database with “–j  <dig> –e  <dig>  –h  <dig> ” options. the msas used for constructing cm profiles are also generated by running psi-blast with the same option, and then thinned by removing the sequences covering less than 50% of the seed sequence and clustering the remaining sequences at 65% sequence identity.

representation of correlated mutation
if we have a sequence of length n, we build, at each position,  <dig> correlated mutation vectors consisting of n correlated mutation scores with other positions for one of  <dig> possible amino acids pairs. the correlated mutation vector for amino acid pair a, b at position i, m = , consists of n log-odds scores defined as

  ,

where f is the joint frequency of amino acid a at position i and amino acid b at position j, f is the marginal frequency calculated as , and f is the marginal frequency calculated as . the correlated mutation score m of amino acid a at position i and amino acid b at position j has a positive value if they have positive correlation with each other, a negative value if they have negative correlation, or zero if they evolve independently. because a small number of observations can make the joint frequency very noisy, we apply low number correction  <cit> , thereby defining the joint frequency as

  ,

where n is the number of observations of amino acid a at position i and amino acid b at position j in the msa, and .

since the dimension of correlated mutation vector is variable depending on sequence length, the correlated mutation vectors of distinct sequences are not paralleled. therefore, we extract the spectral features, known as lpc cepstral coefficients, to represent the correlated mutation vector. lpc cepstral coefficients have been used for comparing dna and protein sequences  <cit> .

the basic assumption of lpc model is that the present sample at time n, s, can be calculated as a linear combination of the past p samples. the approximation is expressed as  <cit> 

  ,

where the coefficients {ak} are constants called as lpc coefficients, which are determined by minimizing the sum of squared error  .

to solve this equation for the predictor coefficients {ak}, we differentiate e with respect to each ak and set the result to zero, . 

the result gives a set of p linear equations

,

where r, known as the autocorrelation function of s, is defined as

,

and symmetric, i.e. r = r. the linear equations can be expressed in matrix form as

since the p x p matrix of autocorrelation values is a toeplitz matrix that is symmetric and all the diagonal elements are equal, the solution of the linear equations can be calculated recursively and very efficiently through levinson-durbin algorithm without relatively expensive computation such as matrix inversion. if the linear equation is solved, more advanced spectral feature called as lpc cepstral coefficients can be derived from the lpc coefficients by the following recursion.

by using the lpc analysis process described above, we transform a correlated mutation vector to the cm profile consisting of the lpc cepstral coefficients. since the cepstral coefficients are decaying, we use only the first l coefficients excluding c <dig>  additionally, we normalize cm profiles of a protein by fitting the mean and variance into zero and one, respectively, to weight them equally regardless of the orders. we obtain consequently a l-dimensional cm profile, c, that represents the correlated mutations between amino acid a at position i and amino acid b at other positions. in other word, all the correlated mutation between position i and other positions are represented as  <dig> x l coefficients.

alignment
to compare sequences, we define the alignment score between the position i of a protein and the position j of another protein as follows,

,

where wmut, wcor, and wsec denote the weights, and smut, scor, and ssec denote the similarity scores of sequence profiles, cm profiles, and secondary structure predictions, respectively, between the positions i and j. smut is the sequence profile score defined as

,

where q, q, t, and t are the frequencies and the pssm scores of amino acid a at position i and j respectively. scor is the cm profile score defined as

,

where d, c) is the euclidean distance between cm profile c at position i and cm profile c at position j, d <dig> is the threshold, and α is the scaling factor. the scor gives a positive score in case that the distance between cm profiles is less than d <dig>  and a negative score in case that the distance is more than d <dig>  ssec is the secondary structure prediction score given as  <dig> if the predicted secondary structures at position i and j are identical, and  <dig> otherwise. we use psipred  <cit>  to predict secondary structures. based on the score matrix consisting of s for all i and j, we perform the needleman-wunsch algorithm with affine gap costs and baseline to find the optimal alignment.

assessment and parameter selection
we assess the alignment quality by measuring the average maxsub score  <cit>  of models derived from sequence alignments. the model is generated by directly copying the coordinates of c-alpha atoms based on the sequence alignment, and the maxsub score of the model is computed with default options. the maxsub score identifies the largest subset of c-alpha atoms of a model that superimpose well over the experimental structure, and provides a single normalized score in the range of  <dig> to  <dig>  the maxsub score  <dig> indicates a completely wrong model, and  <dig> indicates a perfect model. the parameters of each method are selected by simulated annealing  that uses the average maxsub score of training set as the objective function.

RESULTS
the selected parameters by simulated annealing are listed in table  <dig>  for p and l in lpc analysis,  <dig> and  <dig> are used, respectively. for α in cm profile score calculation,  <dig>  is used. combining cm profile, sequence profile, and secondary structure prediction  improves the conventional methods, the profile-profile alignment without and with secondary structure prediction , by  <dig> % and  <dig> %, respectively. in addition, combining cm profile only with profile-profile alignment  improves the ppa by  <dig> %, which is  <dig>  times more increase than ppa_ss which improves ppa by  <dig> %. however, using cm profile solely performs poorly; therefore we will exclude it in the following test.

wmut, wsec, wcor, and d <dig> denote the corresponding notations in alignment score function, and gopen, gext, and base denote gap-open cost, gap-extension cost, and baseline parameter used for dynamic programming procedure. ppa and ppa_ss denote profile-profile alignment without and with secondary structure prediction, respectively, cmpa denote alignment solely using cm profile, and cmpa_ppa and cmpa_ppa_ss denote alignment combining cm profile with ppa and ppa_ss, respectively.

as shown in table  <dig>  overall, cmpa_ppa_ss and cmpa_ppa significantly outperform the original methods, ppa_ss and ppa that do not use correlated mutation information by  <dig> %  and  <dig> % , respectively. the p-values are calculated by wilcoxon signed rank test. at family level, using cm profile shows almost the same improvement that can be achieved by using secondary structure prediction. however, it is seen that cmpa_ppa_ss shows  <dig>  times more improvement than ppa_ss and cmpa_ppa. a dramatic result can be seen at superfamily level where the average sequence identity is  <dig> %, less than  <dig> % at family level, and 96% of the protein pairs have sequence identity less than 20%. cmpa_ppa_ss and cmpa_ppa improve ppa by  <dig> % and  <dig> %, respectively, while ppa_ss does by  <dig> %. this indicates that the use of correlated mutation is much more effective for difficult cases, where the sequence identity is very low, and the following analysis also consistently shows more effective improvements below 20% sequence identity. moreover, it also implies that both the information can be used complementarily and many of the current alignment methods using secondary structure prediction can be improved by incorporating correlated mutation information. according to a previous study using data set derived from scop with <75% sequence identity, the sophisticated methods including the structural state assignment based on self-organizing map and the scoring function based on artificial neural network, have performed best and shown the average maxsub score  <dig>  at superfamily level  <cit> . in their work, the other methods have shown the average maxsub scores of  <dig> - <dig> . the maxsub scores of ppa and ppa_ss of this work are also in that range. although the results cannot be directly compared, it is reasonable to expect that cmpa_ppa_ss should outperform the previous method on their test set as well.

family and superfamily denote the average maxsub score at scop family and superfamily level, and all denotes the average maxsub score of all samples. ppa and ppa_ss denote profile-profile alignment without and with secondary structure prediction, respectively, and cmpa_ppa and cmpa_ppa_ss denote alignment combining cm profile with ppa and ppa_ss, respectively.

as shown in figure  <dig>  cmpa_ppa_ss and cmpa_ppa outperform the conventional methods, ppa and ppa_ss, consistently, regardless of sequence identity at superfamily level. similarly at family level, alignment quality deteriorates below 20% sequence identity, and the average maxsub score of ppa does not exceed  <dig>  below 15% sequence identity. although cmpa_ppa_ss also shows a decline below 20% sequence identity, it significantly improves ppa and ppa_ss by  <dig> % and  <dig> %, respectively, in the range of 0-10% sequence identity, and by  <dig> % and  <dig> %, respectively, in the range of 10-20% sequence identity.

this result has important implications in several aspects. it is well known that profile-profile alignment is improved most by using secondary structure prediction  <cit>  and numerous state-of-the-art methods hence incorporate secondary structure prediction in their alignment scheme  <cit> . also in our results, profile-profile alignment is consistently outperformed by combining secondary structure prediction. however, it is more significantly improved by combining correlated mutation , and the best performance is achieved by combining correlated mutation and secondary structure prediction together . taking this into account, the state-of-the-art methods can be improved significantly by incorporating correlated mutation information.

another aspect is related with the reliability of alignment in the midnight zone. an alignment becomes less reliable when the sequence identity lies in the midnight zone  <cit> . since using correlated mutation is more advantageous for the proteins pairs with low sequence identity and cm profile is easily combined with conventional methods, the coverage of current alignment methods in the midnight zone can be increased by using cm profile. the most important implication is related with the template-based protein structure prediction. from two other aspects described above, it is obvious that using correlated mutation remarkably improves current alignment methods for the sequences with less than 20% sequence identity. this is beneficial to target-template alignment because most of promising templates sharing the same structure have relatively low sequence identity  <cit> . practically, according to the recent analysis for the template-based modeling targets of casp <dig>  <cit> , almost half of the targets, specifically  <dig> among  <dig> targets, have the best templates with similar structure but low sequence identity less than 20%, and a virtual predictor based on the best templates overall outperforms all other groups by far. the effectiveness of cm profile will carry out more reliable target-template alignments and subsequently provide better models for difficult target-template pairs, thereby increasing the confidence for template-based structure prediction.

to assess the performance of cm profile for domains which have less msa sequences than  <dig>  we build two additional test sets from the omitted domains. the first test set is built from the domains with 50- <dig> msa sequences, and consists of  <dig> domains of  <dig> folds,  <dig> superfamilies, and  <dig> families, deriving  <dig> pairs. the second test set is built from the domains with 1- <dig> msa sequences, and consists of  <dig> domains of  <dig> folds,  <dig> superfamilies, and  <dig> families, deriving  <dig> pairs.

when testing with the domains whose msa is composed of 50- <dig> sequences, using cm profile improves ppa and ppa_ss by  <dig> % and  <dig> %, respectively, as shown in table  <dig>  also, when testing with the domains whose msa is composed of 1- <dig> sequences, using cm profile improves ppa and ppa_ss by  <dig> % and  <dig> %, respectively, as shown in table  <dig>  although the improvement rate becomes small for the domains with less msa sequences, correlated mutation is still valuable as additional information for sequence alignment. moreover, combining profile-profile alignment with both correlated mutation and secondary structure prediction outperforms the others significantly, convincing that both the information can complement each other. however, just as the quality of profile-profile alignment decrease when the amount of sequences in msa is not sufficient, the performance of cm profile seems to decrease likewise.

family and superfamily denote the average maxsub score at scop family and superfamily level, and all denotes the average maxsub score of all samples. ppa and ppa_ss denote profile-profile alignment without and with secondary structure prediction, respectively, and cmpa_ppa and cmpa_ppa_ss denote alignment combining cm profile with ppa and ppa_ss, respectively.

family and superfamily denote the average maxsub score at scop family and superfamily level, and all denotes the average maxsub score of all samples. ppa and ppa_ss denote profile-profile alignment without and with secondary structure prediction, respectively, and cmpa_ppa and cmpa_ppa_ss denote alignment combining cm profile with ppa and ppa_ss, respectively.

discussion
the reason for the effectiveness of cm profile is related with the correlation between coevolution and contact. it has been shown that the residues important for protein function are not only conserved but also coevolved with other inter-related residues  <cit> . this fact has been exploited to infer the structural factor such as inter-residue contacts  <cit>  and to evaluate the correctness of de novo model  <cit> . recently, it has been also shown that key residues can be identified by analyzing residue-residue coevolution network  <cit> . in the aspect of alignment, contact-mutation matrices derived from structural information have been used for improving alignment quality  <cit> . cm profile utilizes correlated mutation information much more globally and progressively, implying all the correlated mutation of possible residue pairs. this optimizes alignment to match multiple contacting residue pairs, while the previous studies only consider at most two residue pairs, thereby improving alignment quality noticeably.

in the following, we exemplify that combining cm profile generates the alignment reflecting correlation mutation, and the aligned residues with high cm profile score are related with common contacts. as listed in table  <dig>  the proteins pairs are chosen from scop class a, b, c, and d, and share the same superfamily but different family.

ppa and ppa_ss denote profile-profile alignment without and with secondary structure prediction, respectively, and cmpa_ppa and cmpa_ppa_ss denote alignment combining cm profile with ppa and ppa_ss, respectively.

if the inter-related residues of a protein are aligned with the comparable residues of other protein, the correlated mutation information should be kept mutually in the resulted alignment. to demonstrate this, we investigate the correlation coefficient between correlated mutations of proteins. as correlated mutation measure, we calculate mutual information with low number correction  <cit> , and the residues not aligned are excluded. the resulting correlated mutation scores for aligned residues are shown as matrix form in figure  <dig>  although the matrices do not look completely symmetric, they have positive correlation coefficients,   <dig> ,   <dig> ,   <dig> , and   <dig> , respectively. these values are small, but all the correlations are statistically significant . in other words, the present method constructs an alignment that preserves coevolution.

as shown in figure  <dig>  the residues with high cm profile scores are located spatially close with each other even though they are distant on sequence. on the other hand, the residues with high sequence profile scores are dispersed or not superimposed. this shows that cm profile reflects the structural aspect with regard to residue-residue contact in alignment and the common contacts of aligned proteins are ranked highly by cm profile score. this will be very useful in template-based protein structure prediction.

due to the generality of cm profile, it can be successfully exploited for various bioinformatics applications, particularly with machine learning approaches. our approach is position-specific and consists of a fixed number of values, which allows cm profile to be manipulated in the same way that we use sequence profile. thus, cm profile can be easily adopted into the current methodology without serious modification to complement them. moreover, it should be noted that our cm profile is not optimally generated because sequence profiles are automatically generated by psi-blast  <cit> . the present method can be improved significantly, as the accuracy of correlated mutation is increased through various corrections and noise reductions  <cit> .

CONCLUSIONS
we develop a novel method to represent correlated mutation as the spectral features derived from lpc analysis, and we also apply it to sequence alignment of distantly related proteins. when combined with conventional sequence profile, cm profile improves alignment quality significantly better than predicted secondary structure information. especially, the dramatic improvement in the midnight zone is observed, which should be beneficial for target-template alignment in protein structure prediction. finally, because the methodology that we have developed in this work can be generalized to many interesting areas of bioinformatics, we expect that cm profile can be applicable to other bioinformatics applications equally well.

competing interests
the authors declare that they have no competing interests.

authors' contributions
csj designed the study, implemented the methods, performed the experiments and the result analysis, and drafted the manuscript. dk conceived of the study, participated in its design and coordination, and helped to draft the manuscript. all authors read and approved the final manuscript.

