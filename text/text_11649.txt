BACKGROUND
microsatellites are genomic sequences comprised of tandem repeats of short nucleotide motifs . they occur in all eukaryotic organisms and to a limited extent in prokaryotes, mostly in intergenic regions. indeed, they may represent a significant part of genomes, for example about 3% of genome size  in humans  <cit> . microsatellite loci vary in length due to insertions or deletions  of one or more repeats, which are caused by a not-fully-understood molecular phenomenon, referred to as polymerase slippage  <cit> . a peculiarity of some loci, and the main reason for their wide use in biology, is hypermutability, with a slippage mutation rate of approximatively  <dig>  mutation per locus par generation in humans  <cit> . biologists have been interested in studying microsatellites for at least two reasons. first, some microsatellites are involved in molecular functions, such as recombination  <cit>  or regulation of transcription factors  <cit> . others, present in coding regions, are involved in neurodegenerative disorders, including fragile x syndrome and huntington's disease  <cit> , and in some forms of cancer  <cit> . second, they have been widely used as molecular markers in population biology  <cit> . high mutation rates result in extensive polymorphism within populations, and most microsatellites are selectively neutral. therefore, understanding their evolutionary dynamics, especially the effect of mutation, is important  <cit> . these dynamics have been studied directly by analyzing the rate and nature of mutations in pedigrees  <cit> . an alternative approach uses distributions of microsatellites extracted from large stretches of dna or fully sequenced genomes  <cit> . theoretical distributions based on specified models of mutation can be fitted to these empirical distributions in order to infer the most appropriate model  <cit> . hence, by understanding the evolutionary dynamics of microsatellites, we can gain both pure and applied knowledge about molecular evolution.

given the size of sequenced genomes, microsatellite detection requires computer programs. moreover, microsatellites may exhibit more or less complex nucleotide sequence, since stretches of tandem repeats may be interrupted by point mutations or indels and the detection of these is not trivial. a comparison of studies based on the genomic distribution of microsatellites reveals a surprising variability in the criteria used to detect microsatellites. for example, these criteria include the minimum or maximum repeat number  <cit> , the motif type   <cit> , or the minimum distance between successive microsatellites  <cit> . another aspect of this variability is the method used to detect microsatellites: either it is not mentioned or it relies on home-made, poorly explained algorithms  <cit> . this variability is likely to affect empirical distributions of microsatellites, and therefore might affect the inferred mutation parameters. in addition, this comparison also reveals that imperfections , are managed differently. such imperfections are of a few types, including single mismatches in a locus, multiple mismatches at consecutive or non-consecutive positions, the succession of different motifs , and perfect microsatellites separated by several nucleotides   <cit> . imperfect microsatellites are generally excluded from studies, either by decomposing imperfect loci into perfect independant subparts, or by taking into account only perfect isolated loci. both solutions provide a biased view of reality, because imperfections result from the evolutionary process, and influence the evolutionary dynamics by restricting the slippage rate  <cit> . a more integrated view on microsatellites requires more sophisticated and dedicaded algorithms.

at least a dozen detection algorithms have been described in the literature over the last ten years and they are based on three main approaches. first, combinatorial algorithms  <cit>  scan genomic sequences linearly and detect tandem repeats as sub-sequences following specific construction rules. various rules have been proposed, but these methods guarantee exhaustive detection of all sub-sequences corresponding to the rules. the second group of methods  <cit>  uses algorithms that first scan genomic sequences to detect regions that may be microsatellites under given statistical rules. these regions are then submitted to validation tests that sieve out desired sequences. this pool of sequences may not be exhaustive because some sub-sequences that could pass validation tests may not be detected by statistical tests. however, these algorithms are time-efficient, and appropriate statistical criteria insure relevant results. in the third approach, algorithms align a given motif, or library of motifs, along genomic sequences  <cit> . regions detected as microsatellites are those whose alignment score is higher than a given threshold.

the rules leading to microsatellite detection are clearly defined for all these algorithms. however, it is likely that because they are based on different mechanisms they will detect different sets of microsatellites. moreover, the rules upon which some of these algorithms rely are defined by parameters whose value can be set by the user . detections can also be affected by the genomic sequence under consideration because of differences among the genomes . as far as we know, no study has been conducted to compare the relative efficiency of these approaches and to evaluate how the parameter settings of given algorithms can affect empirical microsatellite distributions. here, we analyze the distributions of mono- to hexanucleotide microsatellites using five algorithms representative of the different classes of methods, namely mreps  <cit> , sputnik  <cit>  , trf  <cit>  , repeatmasker  <cit> , and star  <cit>  . three of them  are rather widely used by biologists. these distributions were characterized by microsatellite number and size, divergence from pure microsatellites , and genomic position. most of the analyses were conducted using the genomic sequence of the human x chromosome, but some analyses were also conducted in three other genomes of very different size and structure . for three algorithms , we first evaluated the influence of variable parameter settings, and then we compared the five algorithms with fixed parameter values of sputnik, trf, and mreps.

RESULTS
parameter influence
the number of detections with trf increases exponentially as the alignment score decreases from  <dig> to  <dig> . this increase is paralleled by an important reduction of the average length, and a more limited reduction in divergence. the variation in detection number is mainly due to the minimum size of detections, which is correlated to the score . however, for microsatellites larger than  <dig> bp, which are not affected by the minimum size constraint, the number of detections is still significantly larger at lower score . also note in figure 1a the approximatively exponential decrease in detection number with length regardless of score, at least for lengths of less than  <dig>  modifying alignment weight also affects the number of detections, though to a more limited extent . interestingly, this is related to the detection of longer , more divergent microsatellites. for example, the average divergence grows from about 4% to  <dig> % . decreasing alignment penalties for different minimum scores  reveals the same tendancy, with an increase in average detection length and divergence . the validation score and mismatch penalty of sputnik have the same effect as the alignment score and weights of trf . the number of detections increases exponentially as the validation score decreases because the minimum size of detections decreased. however, contrary to trf, the validation score does not affect distributions of detections that are larger than the threshold size  . smaller values of mismatch penalty greatly increase the average divergence  and slightly increase the number of detections and average length . this means that microsatellites detected with a - <dig> penalty are essentially a set of enlarged microsatellites detected with a - <dig> penalty, due to better tolerance to imperfections. the influence of mreps resolution parameter parallels that of alignment weights in trf and mismatch penalty of sputnik. indeed, larger resolution values lead to larger and more divergent detections . between resolutions  <dig> and  <dig>  the number of detections is 25% higher, while the corresponding increase for average length and average divergence are  <dig> % and 114%. again, this means that greater values of resolution essentially enlarge existing detections by allowing more errors. examples of detections for different parameter settings of trf, sputnik, and mreps are provided in table  <dig> 

trf alignment weights were set to { <dig> ,7} when varying the minimum threshold score, and the minimum threshold score to  <dig> when alignment weights varied. mreps resolution was  <dig>   <dig>   <dig>  and  <dig>  sputnik mismatch penalty was set to - <dig> when varying the minimum threshold score, and the minimum threshold score to  <dig> when varying the mismatch penalty. match bonus and fail score were always fixed to  <dig> and - <dig>  respectively. divergence is deduced from the alignment of the detected sequence with the perfectly repeated corresponding sequence of focal consensus motif:

 divergence = /alignment length). 

threshold alignment score of trf was set to  <dig> and alignment weights varied from { <dig> ,7} to { <dig> ,5}. sputnik mismatch penalty was set to - <dig>  - <dig>  and - <dig>  mreps resolution value varied from  <dig> to  <dig>  for each detection, we report the start/end positions, divergence from a pure repeat, motif and actual sequence. variation of detection when reducing weights is as follows: n: newly detected sequence; e: enlargement of a previous sequence; c: concatenation of previous sequences. new nucleotides detected by enlarging or concatenating previous sequences are underlined. the sequence at position  <dig> is an example of a microsatellite detected at low values of alignment weights of trf. it cannot be detected with alignment weights down to { <dig> ,5} because correct match bonuses cannot compensate for imperfection penalties. reducing alignment weights may also enlarge detections, as shown for alignment weights { <dig> ,5} at position  <dig>  a succession of close errors  decreases the alignment score, which falls under the threshold score for weight values larger than { <dig> ,5}. reducing alignment weights also provokes concatenation, when an enlarged tandem repeat overlaps with one of its neighbors. at position  <dig>  two substitutions , stops detection when alignment weights are set to { <dig> ,7}. with a smaller substitution penalty , the detection is enlarged up to position  <dig> and overlaps with the other detection. reducing sputnik mismatch penalty allows detection of larger microsatellites, by concatenating shorter, perfect ones. the two detections at position  <dig> and  <dig> are concatenated with a mismatch penalty of - <dig>  because the penalty induced by two errors at position  <dig> and  <dig> are compensated by the second detection. a second concatenation occurs at position  <dig> with a mismatch of - <dig>  the two merged detections are not of the same motif, but the two errors induced by this difference are compensated by the matching bases with low values of mismatch penalty.

a larger resolution value for mreps enlarges already-detected tandem repeats. in the first part of the tandem repeat at position  <dig>  adjacent repeats are separated by at most one error, and this part is detected at resolution 1; however repeats tat and aaa are separated by two errors, so the second part can only be found at resolution  <dig> or higher. finally, increasing resolution provokes concatenation. detections for resolution  <dig> at positions  <dig> and  <dig> are enlarged when resolution is 3; both periods are reduced to  <dig> , and the two sequences are merged.

comparison of algorithms for perfect detection
algorithms were first executed on the human x chromosome with trf theshold score set to  <dig>  trf alignment weights to { <dig> ,7}, mreps resolution to  <dig>  and sputnik mismatch penalty and validation score to - <dig> and  <dig> respectively . the distribution of perfect detections was studied first. the absolute numbers of detections are critically different, with a 80-fold ratio between the two extreme values, returned by sputnik and repeatmasker . trf  is three times less efficient than sputnik, while star and mreps return  <dig> and  <dig> detections/mb respectively.

the comparison of length distributions revealed that the differences among algorithms depend mainly on the minimum detection length . for detections larger than  <dig> bp, the number of detections by mreps and star are smaller than those of sputnik, trf, and repeatmasker, for all motif classes except di- and trinucleotides . these differences are highly significant for all motif classes , except for penta- and hexanucleotides due to a lack of power. it could be noticed that the 'humps' in the di- and tetranucleodite distributions previously reported  <cit>  are equally detected by all algorithms. for small sizes , striking differences are observed among algorithms. first, repeatmasker is highly constrained by its internal minimum-size threshold, which prevents detection of microsatellites that are smaller than  <dig> bp. on the other hand, trf and sputnik essentially detect microsatellites that are smaller than  <dig> bp for all motif classes, especially tetra- to hexanucleotides. indeed, very short  tetra- to hexanucleotides, representing detections with  <dig> to  <dig>  repeats, are about  <dig> -fold more numerous than mono- to trinucleotides of 8– <dig> bp  for trf, and 2-fold for sputnik. the minimum-size effect is also clearly visible with mreps. detection starts at  <dig> bp for dinucleotides,  <dig> bp for trinucleotides, and up to  <dig> bp for hexanucleotides. this explains why mreps detects far fewer microsatellites than trf and sputnik. star distributions are very different from those returned by the three other algorithms under  <dig> bp, with the number of detections increasing rather than decreasing. the maximum number of detections of star is generally reached around  <dig> bp, except for dinucleotides for which the number of detections starts to decrease beyond  <dig> bp. microsatellites below these sizes are at the limit to yield a local increase in compression gain. in such cases, only regions that are near enough from the previous detection are reported .

statistical tests were not performed for distributions of short detections  because detection levels ensure critical differences.

comparison of algorithms for imperfect detections
differences among algorithms for the detection of imperfect microsatellites in the human genome do not follow those observed for perfect ones. sputnik  detects only 2-fold  more imperfect microsatellites than repeatmasker, compared to the 80-fold  ratio for perfect detections . moreover, sputnik and trf detect respectively almost 17- and 4-times less imperfect microsatellites than perfect ones, while the other algorithms detect about 2- to 4-times more imperfect than perfect microsatellites. the average length and divergence are negatively related to the number of detections for trf, sputnik, star, and repeatmasker. for example, the highest average length and divergence are obtained for repeatmasker, which also exhibits the lowest number of detections. the average length and number of detections are directly linked to the minimum detection length , which prevents detection of many short microsatellites, but also increases the average divergence level . similarly, high average length and divergence, and low detection number for star are explained by its limited capacity to detect short microsatellites . interestingly, mreps shows the reverse pattern, with the largest number of detections  obtained for the shortest, more divergent loci.

both imperfect and all  detections are provided for the human genome while all detections only are reported for the other genomes. hs = homo sapiens, sc = saccharomyces cerevisiae, dm = drosophila melanogaster, nc = neurospora crassa. divergence is deduced from the alignment of the detected sequence with the perfectly repeated corresponding sequence of focal consensus motif:

 divergence = /alignment length). 

when perfect and imperfect microsatellites are considered at once , sputnik is the most efficient in terms of the number of detections, followed by trf and mreps, while star and repeatmasker still yield a much lower number of detections. note also that the average size of imperfect detections is larger than the average of all detections, for all algorithms except mreps. this confirms that imperfect and perfect microsatellites detected by mreps have about the same length.

an important issue is whether the detections returned by the five algorithms occur at the same physical locations in genomes. this was evaluated through the 'coverage' parameter. more than  <dig> % of repeatmasker and star detections are also detected by sputnik, trf, and mreps, with a full coverage of repeatmasker by sputnik . on the other hand, the coverage of sputnik, trf, and mreps by star and repeatmasker is much lower . this is consistent with the fact that the latter algorithms detect more microsatellites than the former. notably, the coverage between algorithms is also consistent with the number of detections . this suggests that detections common to the five algorithms are generally located at the same positions.

proportion of the total number of detections  of algorithm a also detected  by algorithm b in the human x chromosome. the value in brackets is the proportion of nucleotides detected by a and covered by b.

the coverage can also be estimated in nucleotide numbers. this method yields a slightly different answer than the one provided by the number of detections . on the whole, frequent detections are associated with small microsatellites . the reverse pattern is observed above the diagonal of table  <dig>  this is again likely due to the difference in average detection sizes for the five algorithms: for example, trf detections covered by star and repeatmasker are the longest ones.

comparison of organisms
the algorithms were executed on three other genomic sequences and the results are presented in table  <dig>  the number of detections per mbp was larger for n. crassa, h. sapiens, and d. melanogaster than for s. cerevisiae, although the difference is not significant . on the other hand, a lot of variation was detected among algorithms for a given genome, as previously observed for the human x chromosome . interestingly, algorithms rank exactly in the same order for the four species with regard to the number of detections.

comparing length and divergence also provides similar values among species for a given algorithm when considering all microsatellites . length distributions of perfect microsatellites in s. cerevisiae, n. crassa, and d. melanogaster show patterns similar to those observed in humans . as for the number of detections, extensive variation is observed among algorithms for a given genome . the rank order of algorithms was the same as described previously, the only exception being in d. melanogaster and s. cerevisiae where mreps divergence is lower than that of repeatmasker.

discussion and 
CONCLUSIONS
we compared the performance of five algorithms, four of which have been developed for detecting tandem repeats. the logic underlying microsatellite detection by these five algorithms is representative of the three main approaches that are currently available . in order to analyze the performance of these algorithms as fully as possible, we considered several parameters , the six motif lengths corresponding to the classical definition of microsatellites , and four different genomes. our first conclusion is that in algorithms where parameter values can be modified by the user, the settings of these parameters is critical. for example, increasing trf minimum score and sputnik validation score allows detection of 20- to 40-times more microsatellites, especially those that are smaller and more perfect. conversely longer and more imperfect microsatellites were detected by decreasing trf weights, sputnik mismatch penalty, and increasing mreps resolution. therefore, modifying parameter settings has important consequences.

interestingly, this variation was not reported in the original articles  <cit>  in which detection efficiency was evaluated with respect to execution time . delgrange and rivals  <cit>  noticed though the large variation in results associated with parameters setting in trf, but were not concerned with size or divergence level. extending our comparison to five algorithms provides generally similar results. on the whole, repeatmasker and star detect fewer and longer microsatellites than trf and mreps . divergence is also larger for repeatmasker and star than for trf. sputnik results are similar to those of trf, despite a different algorithmic approach. the microsatellite sets detected by the five algorithms are also very different: on the whole, most microsatellites detected by repeatmasker and star are also detected by trf, sputnik, and mreps, while the reverse is far from true. such conclusions are likely generalizable because similar results were obtained in four genomes of different sizes and gc contents. although repeatmasker and star were classified in the third approach  while mreps, sputnik, and trf are representatives of the first and second approaches, respectively, we do not conclude that the third approach generally differs in efficiency from the other two approaches.

these results require some explanation. first, the striking difference among algorithms  are mainly due to differential detection of short microsatellites, especially perfect ones. the bulk of microsatellites in genomes are short . more precisely, microsatellites  exhibit a negative exponential size distribution within genomes  <cit> . large threshold sizes  or sharp constraints on size imposed by the significance threshold  therefore prevents detection of the majority of microsatellites. a noteworthy contribution to these short detections by sputnik and trf is made by tetra-, penta-, and hexanucleotides. these microsatellites with two-to-three repeats make almost one half of the total number of microsatellites detected by trf and they are much more numerous than expected. for example,  <dig> roughly has a probability of  <dig>  ×  <dig>  of occurence in the human genome, corresponding to about  <dig>  detections on the x chromosome. trf returned  <dig> detections, more than  <dig> times the expected value. interestingly, the same patterns were detected in the four genomes studied. we cannot offer any clear explanation to the occurrence of these short repeats. however, even when short microsatellites are not taken into account, the five algorithms do not return the same sets of detections, therefore exhibiting different efficiencies. one reason is that the same repeat region might be interpreted differently by the five algorithms. these differences in detections are illustrated in table  <dig> where some long, imperfect detections reported by repeatmasker and star are decomposed into much smaller detections by mreps , trf , and sputnik .

resolution of mreps was set to  <dig>  threshold alignment score of trf to  <dig> and alignment weights of trf to { <dig> ,7}. sputnik mismatch penalty and validation score were set to - <dig> and  <dig>  respectively. the number of detections varies with algorithms . moreover, the sequence information is dealt with in different ways; an example is the region of cryptic simplicity between positions  <dig> and  <dig>  repeatmasker and star decompose it into large, distant and highly imperfect detections, though not the same for the two algorithms. mreps returns a succession of shorter detections, overlapping the whole region. trf detects only short, not much divergent, subregions, which do not completely overlap with the whole region. sputnik detections are very numerous, short and slightly divergent, but overlap the whole region. detection of compound microsatellites by mreps is illustrated at position  <dig>  where other algorithms detect only a perfect polya strech. the detection at position  <dig> is returned as two detections by mreps, because the two consecutive errors  stop the detection when resolution is set to  <dig>  very short hexanucleotides  are detected by both trf and sputnik at positions  <dig> and  <dig>  most detections of sputnik are two-repeat tetranucleotides, or three-repeat trinucleotides, which cannot be detected by other algorithms.

second, mreps detected more divergent microsatellites than the other four algorithms. this might partly be due to compound microsatellites, i.e, succession of motifs such as  <dig>  based on our definition, which considers only one motif per detection, such detections are ascribed to a single motif, here  <dig> 

the right part of the sequence is read as  <dig> with five errors, giving a 20% divergence. such a compound microsatellite is erroneously counted as one short imperfect detection, and would be better counted as two shorter perfect detections of different motifs. the wide average divergence is also induced by the absence of a validation score in mreps. such a score imposes a minimum number of correct repeats for detections to be validated. because increasing the proportion of wrong repeats reduces the number of correct ones, detections must be longer to reach a given score. the absence of such a constraint in mreps results in short detections that can be as divergent as long ones.

third, the limited differences detected among the four genomes studied were not fully unexpected, though smaller than those that have been previously reported  <cit> . this result suggests that the evolution of microsatellites is related to forces that are little affected by local processes or characteristics, either genomic  or populational . microsatellites are affected by two types of mutations, i.e., slippage and point mutations. it might be that the net outcome of their action does not vary among genomes larger than a few tens of millions base pairs, as are those studied here.

our results have some practical implications. first, it has become common practice, when genomes are newly sequenced, to evaluate the relative size of genomic fractions . although microsatellites do not constitutes a large parts of genomes , estimates of their density will depend on the algorithm used and on the algorithm parameters. as an example, the international human genome sequencing consortium  <cit>  estimated that mono- to hexanucleotides constitute  <dig> % of the human genome using trf with weight { <dig> ,5} and score  <dig>  this value rises to  <dig> % using weight { <dig> ,7} and score  <dig>  as we did here. second, and less trivial, our results might interfere with conclusions on microsatellite evolution drawn from genomic approaches. as mentioned in introduction, microsatellite evolution can be derived by fitting models specifying mutation parameters  to actual length distributions of microsatellites. these distributions are generally built using home-made, often poorly described algorithms. for example, out of a representative set of studies following this approach  <cit> , only two describe the algorithm used. it is therefore not clear how one can compare these approaches to the approach defined in introduction and whether the fitted distributions are representative of the actual set of microsatellites. for those studies fitting length distributions, the extensive variation in the number of detections among algorithms might be less of an issue than the shape of the length distributions . however, it might be interesting to fit distributions with outcomes from different algorithms to evaluate the amount of variation in the inferred mutation processes. another problem is that these studies focus completely on perfect microsatellites. detecting such tandem repeats is algorithmically less complex than detecting imperfect ones, for example by scanning specific motifs and extending the search to neighbouring positions, or searching adjacent identical subsequences of the same length, whatever the motif . perfect microsatellites can also be detected using the other approaches, and filtering out a posteriori imperfect microsatellites. whatsoever, we have seen that the set of returned perfect microsatellites depends on the algorithm. this, again, might affect the inference of mutational processes acting on microsatellites. moreover, restricting the analysis to perfect microsatellites does not render the full complexity of microsatellite evolution. note that, although some studies included imperfect microsatellites  <cit> , the chosen parameters were so stringent that detection was close to perfect. these examples show an attempt to integrate imperfection into microsatellite studies, but none discuss the implications of their parameter choices, despite the non-negligible influence of imperfections on microsatellite evolutionary dynamics  <cit> .

one reason why different sets of perfect microsatellites are detected by different algorithms relies on the choice of different minimum distances separating two successive microsatellites. from an algorithmic point of view, two tandemly-repeated stretches, each of the same motif, and separated by a single  nucleotide 10g10) can be considered as two perfect microsatellites. from an evolutionary point of view, such a sequence is best viewed as a single imperfect microsatellite resulting from an insertion within a perfect microsatellite. a less rhetorical example can be drawn from the literature. dieringer et al., calabrese and durrett, and lai and sun  <cit>  all looked for dinucleotides in the human genome, but used different definitions. for lai and sun, a detection was considered as perfect when none of the four bases on its left side were included in another detection. for calabrese and durrett, perfect detections must be separated by at least  <dig> bp and should not include a repeat of the focal motif within the  <dig> bp flanking sequences. divergently, dieringer et al. considered all perfect subparts as independent microsatellite detections. counting only those detections equal to  <dig> repeats , the detection numbers are about  <dig>   <dig>  and  <dig> for dieringer et al., calabrese and durrett, and lai and sun respectively.

more generally, our results highlight the problem of defining a microsatellite. the simple widely-used definition is the one given in introduction . however, these definitions are not precise enough to aid in decidions regarding which nucleotide regions are microsatellites. indeed, they do not characterize the minimal required length, nor the level of imperfection. for example, compound microsatellites set specific challenges to detection methods, as mentioned above. some attempts have been done to generalise the definition of microsatellites, for example by introducing wildcarded motifs  <cit> . in this case, a compound microsatellite atatatatacacacac is defined as a  <dig>  where * can be replaced by any nucleotide. other authors  <cit>  provided a first attempt to distinguish between complex and compound microsatellites, and to return them in a comprehensive way 44).

this typological definitions are those retained in the combinatorial algorithms used above. an important line of research would be to design new algorithms that couple microsatellite detection and the inference of the most parsimonious history of duplications and point mutations for the region being analysed  <cit> . the tandem repeat detected would then be described by both its sequence and history of duplications. in a duplication history, different motifs may be duplicated and such an approach would authorize several motifs to be involved in the formation of a single tandem repeat, as in compound microsatellites. the duplication history would help in both delimiting the tandem repeat and producing an explicit consensus sequence.

