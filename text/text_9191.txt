BACKGROUND
genetic loci that affect the expression levels of mrna are called expression quantitative trait loci . considering mrna transcript abundance as a quantitative trait, the aim is to detect the associated genetic loci, which is the key to understanding the regulation network and disease phenotype. thanks to the high-throughput and advanced sequencing technology, genome-wide linkage and association studies  <cit>  have shown to be effective for finding causal gene loci for diseases in many species from yeast to human. the interested reader may find a detailed overview of the eqtl issues and some existing mapping methods in reviews  <cit> .

the simplest mapping ideas are regression-based methods, but traditional methods have some disadvantages. single qtl regression and the interval mapping method  <cit>  tend to show too many associated loci and fail to take into account the complex interaction effects. while multiple-qtl approaches, such as the two-dimensional scan, consider such interactions, they are computationally expensive and have low statistical power due to multiple tests. these methods are based on the selection of a p-value threshold, thus if the threshold is not selected properly, high false positive rate occurs. compared to multiple-qtl regression, variable selection methods seem to be more robust. storey et al.  <cit>  showed that the forward sequential search is more powerful than the exhaustive two-dimensional scan. however, since markers once selected cannot be removed from the model, the forward selection tends to select an excessive number of markers and only achieves local optimization. to overcome some weaknesses of the stepwise selection, tibshirani proposed the lasso penalized regression  <cit> . the lasso method with l <dig> penalty produces interpretable models with some coefficients exactly  <dig>  two of its extensions are appealing. the group lasso or glasso  <cit>  on the one hand selects variables and reduces the dimensionality in a group fashion by applying l <dig> penalty to each group of variables. the elastic net method  <cit> , on the other hand, by adding up the l <dig> and l <dig> penalties together, becomes ideal for " large p small n" problems with highly correlated data. however these excellent lasso-based methods  <cit>  are not designed for eqtl and more biological information should be incorporated to improve their performances. therefore we aimed to develop a new penalty which can give more accurate selection of qtls as well as allowing more flexibility of model setting for different biological prior knowledge.

previous studies have demonstrated that incorporating biological information on genes with the same function would increase the accuracy of detection of hot spots  <cit> . since the problem has small sample size, large noise and high dimensionality, we hope to borrow information from a gene expression network. it can be any kind of network: a network based on annotation system such as gene ontology   <cit>  or kegg  <cit> , a clustering or co-expression network, a protein-protein interaction network etc. to add the network into our penalized regression framework, the network-constrained regularization method  <cit> , an extension of the elastic net, is enlightening. the idea is simple: the difference between the coefficients of two connected genes on the network should be small. pan applied this idea to his network-based method  <cit> , and the results clearly demonstrate the advantage of methods utilizing gene networks.

besides the gene expression network, correlations between markers or linkage disequilibrium  structure are very informative. the true causal snps are rarely genotyped but may be in ld with near markers. in addition the epistatic effects among different snps can be very large, with each individual snp' s effect very low. in these cases we need complex models rather than linear ones to describe the ld structure. wu et al. proposed to group snps into snp sets based on ld structure in the association study, and then test the joint effect of each snp set  <cit> . we applied this idea to our regression framework and selected the markers at the group level just like the glasso  <cit> . as a result, our method:  has more power to detect significant loci,  allows us to consider the complex joint activity of snps within each marker set,  better captures untyped causal snps,  reduces the dimensionality of the problem dramatically, and  may be combined with other existing low-dimensional selection methods for further study. it is also worthwhile to point out that by forming marker sets, we are able to consider the additive and dominant effects of one locus as a group. naturally, the effects of the three different kinds of genotypes  of one snp should be represented by two dummy variables, which exist or not at the same time. in addition, once we group some markers into a set, covariate models and different epistatic models can be constructed within the set, providing additional information to understand the true biological regulatory mechanism.

methods
network-based group variable selection
suppose that the dataset has n samples and p markers. we have g quantitative gene traits y <dig>  y <dig> ..., yg, where yg = t, g =  <dig> ..., g and we combine them to form the entire gene expression vector . the p markers can be divided into j blocks describing the j marker sets, where the jth marker set for the ith individual is xj, i = , j =  <dig> ,..., j, p = p1+p2+ · · · +pj being the total marker number. then the marker data matrix is xm = , where xj = t. we combine them to get the entire marker data matrix x = diag . note that all the g traits come from the same genotype data and the marker data matrix is the same for all traits. we then regress all gene traits y on the marker data x. after the location and scale transformation, we can assume that the regressors are standardized and each response is centered, obviating the need to consider the intercepts.

let' s consider a network that is represented by a graph with e edges and g vertices. each vertex represents a trait, an edge u~v indicates that gene trait u and v are linked on the network. let' s define the degree du of the vertex u as the total number of edges linked to u; and suppose du >  <dig> for each u. to describe the structure of the network, we use matrix l similar to  <cit> . the p by p block element l of l is defined as:  

where ip is the identity matrix of order p. since l is always non-negative definite, it can be decomposed as l = sst, where sgp × ep is the matrix in which, taking every p by p matrix as one block, the block rows are indexed by the vertices and block columns are indexed by the edges of the graph such that each block column corresponding to an edge u~v has an entry  in the row corresponding to u, an entry  in the row corresponding to v and zero elsewhere.

for any pair of fixed non-negative tuning parameters λ <dig> and λ <dig>  we define our network-based group variable selection  criterion:   

where β = t, βg = t, βj, g = t and the norm is l <dig> norm. the first term is the sum of squared errors. the second term is identical to the glasso penalty only with an additional sum over gene traits and is used for selecting marker sets. the weights  ensure that the penalty term is of the order of the parameter number of each group. the third term can be written as  

where Σu~v denotes the sum over all unordered pairs  for which u and v are linked on the network. the third term actually reveals the assumption that genes which are highly correlated and truly regulated by the same qtls tend to have the same effect. the ngvs estimator  is the minimizer of equation , i.e.   

the following lemma shows that minimizing our ngvs criterion is equivalent to solving a glasso-type optimization problem, thus can be computed by some efficient existing algorithms.

lemma  <dig>  given dataset  and two fixed tuning parameters , define an artificial dataset  by  

where s is the decomposition of l. let and then the ngvs criterion can be written as  

let be the solution to the above glasso minimization problem; then the solution to  is 

following zou and hastie  <cit> , the ngvs estimator should be adjusted by a factor of 1+λ <dig> due to the possible bias of double shrinkage. from lemma  <dig>  the ngvs problem can be reformulated as an equivalent glasso problem by augmenting the dataset from gn to gn+ep. therefore, when doing variable selection, this model can select all gp variables if gn+ep > gp. glasso can only select at most gn variables before it saturates. by choosing a network with the total number of edges bigger than g/p, even when n is much smaller than p, we can overcome the limitation. this can be easily accomplished by using a smaller correlation threshold or making the network sufficiently big.

lemma  <dig>  is determined by equation . assume that gene u and v are only linked with each other on the network and the corresponding response vectors are equal, i.e. yu = yv, then for any λ <dig> > <dig> where is the estimated coefficients for gene g.

lemma  <dig> is true since the penalty is a strictly convex function with λ <dig> >  <dig>  this lemma shows the grouping effect of ngvs, which means that coefficients corresponding to highly correlated gene traits on the network tend to be the same. therefore, our method can borrow information from traits with the same underlying function.

block co-ordinate gradient descent algorithm
some algorithms are available for solving the glasso problem. yuan and lin provided an iterative algorithm  <cit> , but they realized that the computation burden explodes dramatically as the number of regressors increases. they also proved that glars and ggarrote are not suitable for this problem, which are both the group forms of the lars algorithm  <cit> . to handle " large p small n" problems efficiently, meier et al. developed their block co-ordinate gradient descent  algorithm  <cit> . the method can be applied to any generalized linear model where y has an exponential family distribution.

the key idea of bcgd method is to combine a quadratic approximation of the log-likelihood with an additional line search. we first pick a zero vector as the initial coefficient vector, denoting no groups have been selected. then by approximating the nonlinear log-likelihood by a second-order taylor expansion at β of the last iteration and replacing the hessian of the log-likelihood by a proper matrix, the minimization direction is found and β is updated by a point of that direction. thus, either a new group will be selected, or the coefficients of previously selected groups will be changed slightly. the algorithm is fast in computing a whole range of solutions given sufficiently small grid on penalization parameters and then generating the selection order. the algorithm is available in the r-package grplasso.

marker sets and gene expression networks
biological information incorporated by our proposed ngvs method mainly include gene expression network and loci correlation, that is, the way to form marker sets. proper grouping of markers based on the prior knowledge can increase the power to detect causal snps, while bad division of marker sets may probably harm the results since the unlinked loci may dilute the effect of causal loci. basically, all grouping ideas can be divided into three categories: ld-based, knowledge-based, and convenience-based. in gwas, grouping snps in or near a gene is an ideal method; while in linkage analysis, because of the limited number of markers, grouping highly correlated markers produces good results. genes that are located within a gene pathway often share biological functions and could be considered as a group. a more detailed analysis about how marker sets are formed can be found in  <cit> .

the gene expression network, if properly set, could come from any source such as go or kegg pathways  <cit> , clustering or co-expression network, ppi network etc. one way of constructing the network is, as we did in the real data analysis, to first identify a group of gene traits which share the same biological function by means of an external database, then to construct a co-expression network by a reasonable cutoff for the correlations between trait pairs using the same or a second dataset. the cutoff should be chosen such that the network satisfies the inequality e>g/p as discussed above with the degree of each gene trait bigger than  <dig>  the network provides a good performance in real data analysis.

selection orders and tuning parameters
with our ngvs method, for each fixed λ <dig>  we are able to generate a selection order of the marker sets for a wide range of choices of λ <dig>  we call this the big scale selection order as it describes the ranking of importance for the groups of markers. once the relative importance of marker sets is established, further selection order of markers within each marker set can be produced by various existing methods. we call this the small scale selection order. to generate the final selection order of individual qtls, we try to combine the two different scales together. hence we need to go over a three-stage procedure: firstly getting the big scale selection order with ngvs; then finding the small scale selection order by any method suitable for low-dimensional selection; finally, combining the two selection orders together according to the three criteria discussed below.

in the first stage, we face a " large p small n" variable selection problem. though we can select the optimal parameters by cross-validation or some kind of cp or gcv criterion, it is time-consuming for two-dimensional tuning parameters. based on our experiments, when considering big scale ranking, the results are quite stable against different λ2's. so we use λ <dig> =  <dig> in our analysis and for this given λ <dig>  we let λ <dig> vary over a wide range of grid to give the big scale selection order. the step size of λ <dig> should be small enough to guarantee that at most one new marker set is selected at a time. in the second stage, we have reduced the problem to be a " large p small n" variable selection problem. so all methods designed for low-dimensional ranking should be suitable, though we prefer to use the glasso, which can select additive and dominant effects as one group. the small scale selection orders within each marker set are obtained without considering the loci structure and the co-expression network. this is because small scale differences of each gene trait are allowed. furthermore, for a low-dimensional problem, simple selection methods are accurate enough to detect qtls and considering the network may lead to bias . once the selection orders in two scales are ready, we apply three criteria to combine them in the final stage. firstly, the most significant loci in each marker set are ranked according to the big scale selection order with ngvs; secondly, loci within each marker set are ranked according to the small scale selection order with glasso; thirdly, when several loci satisfy the first two criteria, the locus with the smallest p-value for single qtl regression should be selected ahead of the others. here, single qtl regression means assessing the significance of each individual snp using the likelihood ratio test. the final selection order of all the markers will be determined uniquely by these three criteria. the final order is a combination of macro-order based on prior biological information, micro-order within each small group and single qtl p-values ranking. if we want to detect the causal qtls of a certain trait, we can identify as significant the first desired number of loci in the final selection order.

however, if we care more about general findings for a class of gene traits, we should pick out, according to the big scale order, marker sets which are identified as significant in most traits, then form the final selection orders and make conclusions only using markers in these identified marker sets. the whole process is shown in figure  <dig> 

assumptions for covariate, additive, dominant and epistatic effects
four assumptions of our method are listed here:  the distribution of the error term is normal;  markers that are in high ld regions together reflect more information than one single marker;  highly correlated traits tend to be determined by the same loci;  covariate, additive, dominant and epistatic effects should be assumed based on some prior knowledge. covariates such as age and sex sometimes are quite influential for gene expressions, hence cannot be ignored. if one covariate is significant, typically, we add it into the regression model as one additional group, together with the interactions of the covariate with markers. as for the additive and dominant effect, we assume that one snp has only additive effect or both effects. models containing two effects can provide more accurate qtl detection than the additive models as is shown by our results.

epistatic effect refers to the interaction of multiple genetic variants. however, how this joint activity really happens is hard to detect. we propose two possible ways to describe epistasis - kernel model and near interaction model. if we focus on only the gth gene trait and its corresponding jth marker set, then by representer theorem  <cit> , the relationship function hj, g of markers within the marker set can be written as:  

where k is some kernel function defining the epistatic relationship. thus we extend the original regression model for the gth trait yg = x0βg+εg to be:  

for example, the linear kernel defines a linear model just as yg = x0βg+εg, but with an increased degree of freedom when pj<n. note that kernel function is applied to each marker set. thus with the same division of marker sets, we can treat kernels as j×n correlated new variables and get the big scale selection order as before. essentially, kernel function projects nonlinear relationship into a higher dimensional space and the regression is then modelled linearly in the new space. the kernel can also be intuitively interpreted as the measure of similarity between two individuals. after this representation, we need only to introduce different kernels to specify the epistatic model and here we present five kernels we will use in our analysis.

 linear kernel: 

 polynomial kernel: 

 gaussian kernel: 

 identical-by-state  kernel: 

 weighted ibs  kernel: 

where  and qjk is the minor allele frequency  for the kth marker in the jth group. the first kernel is linear while the second adds the interactions of snps to the qth order. the next two kernels basically give various ways to measure the distance between two individuals. and the wibs kernel is a correction of ibs for the rare alleles because they are usually more informative than common alleles.  <cit>  offers more detailed explanation about these kernels and how to select a proper kernel.

despite the many choices of kernels, it can be advantageous to switch to traditional two-locus interactions because, if showen to be significant, the biological interpretation is easier. we can extend each marker set to contain all the interactions between snp pairs in the set and treat each of them as one new variable. however, when the number of snps in one marker set is large, we tend to only add near interactions. in high ld regions, we may consider interactions of two loci a little farther apart, while in low ld regions or with snps not densely genotyped, interactions of adjacent markers are enough. we will consider the adjacent-locus interaction model together with different kernel models in our analysis.

RESULTS
to evaluate the performance of our proposed ngvs method, we simulated two models: the first to illustrate the advantages and disadvantages of the method in a low-dimensional setting; the second to mimic the high dimensional real problem.

"large n small p" simulation
first, we generated seven latent variables z <dig> ..., z <dig> denoting genotypes according to a centered multivariate normal distribution whose covariances were cov =  <dig>  and cov =  <dig> |i-j| for i<j and ≠. then zi was trichotomized as - <dig>   <dig>   <dig> if it is smaller than Φ- <dig>  larger than Φ- <dig> or in between respectively, representing genotype aa, aa, aa. and we considered the linear model:  

where z <dig>  i, z <dig>  i, z <dig>  i were one realization of z <dig>  z <dig>  z <dig> for individual i; yi, g's denoting the gene expressions determined by additive and dominant effects of loci  <dig>   <dig>   <dig>  which were modelled as two dummy variables - one for genotype aa and one for aa; the expression network of two linked genes was also considered, i.e. g =  <dig>  2; ri, j, g~u, i =  <dig> , <dig>  j =  <dig>  was a scaling factor used to perturb the effect size of the marker on trait g; finally εi=  ~ n where Σij =  <dig> σiσj for i ≠ j, Σii= σi <dig> and Σ was determined by our choice of the signal-to-noise ratio , which is defined as the expected value of the mean square over the variance of expressions. two different snrs of  <dig> and  <dig> and two different ways to form the marker sets were tried. for each case,  <dig> simulated datasets were generated independently to calculate sensitivity and specificity.

the first way to construct marker sets is that z <dig> and z <dig> or four corresponding dummy variables are grouped into one marker set; and the two dummy variables for each of the other  <dig> loci build up the other  <dig> marker sets. this division for marker sets assumes that we have some prior knowledge about the higher correlation between z <dig> and z <dig> we call this marker set formation with snr =  <dig> and snr =  <dig> model  <dig> and  <dig> respectively. the second way to construct sets is to group z <dig>  z <dig> and z <dig> or six corresponding dummy variables into the first marker set; z <dig> and z <dig> are grouped into the second one and z <dig>  z <dig> in the third one. this division represents a bad set formation because every significant locus is tangled with some insignificant one. we call this division with snr =  <dig> and snr =  <dig> model  <dig> and  <dig> respectively.

we compared three methods:  our proposed ngvs which combines gene expression network and loci structure;  glasso which scans that information and merely selects additive and dominant effects simultaneously trait by trait;  the traditional lasso method which only considers additive model. in ngvs, the selection order was constructed as illustrated above. and in the other two methods, selection orders were obtained by applying a wide range of different tuning parameters. sensitivity and specificity of identifying the first three loci in the final selection order as significant loci are reported in table  <dig>  and the roc curves corresponding to the  <dig> models are shown in figure  <dig> 

ngvs: the network-based group variable selection method; glasso: the group lasso without gene network and loci structure; lasso: only considering additive effect of each locus. sensitivity and specificity are calculated based on  <dig> simulations, with standard errors reported in parentheses.

from table  <dig> and figure  <dig>  it is clear that our method is more powerful than lasso in all of the four models. this is because lasso only considers the additive effect of each locus when the underlying mechanism truly contains two effects. methods selecting two effects in a group manner such as the glasso and the ngvs perform better. in model  <dig> and  <dig>  where snr =  <dig> meaning that we have sufficient information for detecting qtls accurately, glasso provides fairly good results. if the signal is strong enough, adding improper loci grouping and gene network may increase uncertainty, thus impair sensitivity. in model  <dig> where we have proper marker set division, no significant difference in auc between ngvs and glasso is discovered; while in model  <dig> with bad maker sets formation, auc of ngvs is reduced. however, in model  <dig> and  <dig>  where background noise is important such that we do not have enough knowledge to select significant loci individually, by combining markers into marker sets, our ngvs method is more powerful than glasso. even when the marker sets formation does not reflect the true ld structure , adding network information and loci structure still increases sensitivity. in sum, if high-noise background is present, the information each qtl provides is not enough. we are able to obtain more powerful and convincing results by combining qtls into marker sets and combining highly correlated gene traits into a network, then putting the information into our proposed ngvs framework.

"large p small n" simulation
in the second simulation, we considered a simulated dataset including  <dig> samples, each with the data of  <dig> markers, or  <dig> dummy variables, and  <dig> gene traits, to mimic a real linkage analysis. we first generated genotypes denoted by z <dig> ..., z <dig> according to a centered multivariate normal distribution. the covariances are set to decrease as the distance between markers increases and  <dig> when the markers are more than  <dig> markers apart. like before, zi's were trichotomized as - <dig>   <dig>   <dig>  we considered the following model:  

where z <dig>  i, z <dig>  i, z <dig>  i, z <dig>  i belong to three different marker sets  <dig> ,3; ri, j, g, εi, g are defined as before and snr =  <dig>  twenty simulated datasets were generated independently to calculate true positives  and false positives . our main aim here is to find out the causal markers z <dig>  z <dig>  z <dig> and z <dig> 

we applied our three-stage selection procedure. we first selected significant marker sets using our ngvs method based on the additive-and-dominant-effect model; then glasso was used to find the causal markers within each marker set; finally we decided the final selection order for all the loci. the full network of the  <dig> gene traits considered here obviously satisfies our requirement e>g/p. for the marker set formation, r markers rj-r+ <dig> ..., rj were grouped to form the jth marker set, j =  <dig> ..., and r =  <dig>   <dig>   <dig>   <dig>  note that r =  <dig> means we do not actually have a marker set and select the qtls individually. in brief, we can either choose to use the gene expression network or not and choose among  <dig> different marker set formations - a total of  <dig> possibilities. when the network was utilized, we applied our proposed ngvs method under the  <dig> different marker set formations. if the network was not taken into account, we considered each individual gene trait respectively, but still maintained the  <dig> different marker set structures. we call this single trait selection, which means loci structure was taken into account but the qtls were selected for each trait individually. in single trait selection, if r =  <dig>  it is just glasso used to select two dummy variables of one locus as a group for each trait. besides the  <dig> possibilities, we also compared the selection orders of the single qtl regression and the lasso. single qtl regression assumed linear simple regression and tested whether the slope was significantly different from zero by likelihood ratio test. the selection order came from the ranking of p-values. note that our method is a combination of the big scale ngvs, the small scale glasso and the p-values coming from single qtl regression as the adhesive tool of the two scales.

the total tps and fps of the  <dig> gene traits of the  <dig> simulated datasets if we identified the first k loci in the final selection orders as significant are shown in figure  <dig>  our ngvs method with marker set formation r =  <dig> performed the best. the effect of the scale of marker sets is shown through the first  <dig> columns of figure  <dig>  the histogram of first  <dig> columns is slightly u-shaped, which suggests that considering ld structure properly can increase power, but including too many non-causal markers will dilute the effect of causal ones. the proper way to form marker set as we discussed before should be decided based on prior knowledge and ld correlation. single trait selection with proper marker set scale gives almost the same result with ngvs. however, under marker set formation r =  <dig> and r =  <dig>  the  <dig> gene network protected ngvs from suffering the power decrease generated by containing too many unlinked loci into marker sets. borrowing information among correlated gene traits reduces the risk of using improper division of marker sets. comparing ngvs with glasso, we conclude that adding a proper loci grouping and gene expression network indeed can improve the performance. single qtl regression and the glasso are probably useful for coarse ranking, but not good enough. in addition, the comparison between ngvs with lasso illustrated the importance of considering the additive and dominant effects together. methods lacking the description of the latent two-effect mechanism can only select markers of strong effect. in summary, when the sample size is smaller than the marker size, our method considering two-effect model, marker sets and correlated traits together can discover more casual qtls of moderate effect and give more true positives.

real linkage data analysis
we analyzed a published mouse linkage dataset deposited at the gene expression omnibus  by lan et al.  <cit> . this dataset provides liver mrna expression levels of more than  <dig> traits from  <dig> f <dig> mice generated by crossing strain c57bl/6j  with btbr. lan et al. found that b6-ob/ob mice, when made obese, are resistant to diabetes while bebr-ob/ob mice are not. then the  <dig> animals were genotyped at  <dig> mit microsatellite markers, an average of approximately  <dig> cm apart across the entire genome. the liver mrna was quantified by affymetrix m430a and b arrays. the dataset was processed using the robust multi-array average  normalization method  <cit> . previous analyses of this dataset have demonstrated the increase of power by combining mapping and correlation information  <cit> . lan et al. first used standard interval mapping  <cit>  to map each probe at 5-cm resolution and selected  <dig> " seeds", that is, gene traits with lod score of interval mapping higher than  <dig> ; then  <dig> seeds were identified, which share the same go term " g protein-coupled receptor" . by combining  <dig> correlated traits with the  <dig> seeds, which are also in the gpcr protein signalling pathway, there was clear evidence of a co-regulatory region on chr  <dig> at  <dig> cm. they also found that markers in chr  <dig> may have some effects.

in our analysis, we considered two ways to form marker sets: loci within one chromosome as a marker set and loci within the boundaries where significant correlation decrease happens as a marker set. the smaller marker set formation was shown by the black squares in figure  <dig>  though the adjacent loci were almost  <dig> cm apart, we found that snps located within a chromosome were still in high ld . for the gene expression network, it can be constructed either from the  <dig> seed traits or from another dataset. under the correlation cutoff of  <dig> , only  <dig> of the  <dig> traits were linked with others and used for the construction of the network . to mimic the practical situation with a prior network, we used the same network as pan  <cit> . using gene names, pan identified  <dig> gpcr genes appearing on both our dataset and another mouse dataset with liver gene expression of  <dig> f <dig> female mice. the co-expression network was derived from the second dataset using a cutoff of  <dig>  for the correlations of the  <dig> genes . for each of the  <dig> combinations of marker set formation and network, we applied our ngvs method and single trait selection. the big scale selection orders of the two methods and the final selection orders of the ngvs are shown in table  <dig> 

16/1200007
the co-expression network  <dig> was constructed by  <dig> gpcr traits and a cutoff of  <dig> . the co-expression network  <dig> was constructed by  <dig> gpcr traits shared by two datasets and a cutoff of  <dig>  was used. marker set  <dig> and  <dig> denotes respectively loci within one chromosome and loci within the boundaries where significant correlation decrease happens were grouped as one markerset. numbers in big scale orders of ngvs and single trait selection represent the corresponding marker set numbers, while final selection orders of ngvs represent the marker numbers.

the results were consistent with lan et al.  <cit> . according to the final selection order of ngvs, marker  <dig>   <dig>   <dig>  on chr  <dig>  or loci at around  <dig> cm, were significantly linked with gpcr genes. this region was identified as the most significant by  <dig> of the  <dig> traits in the first co-expression network under chromosome marker set scale and by all except one under smaller marker set scale. there were also weak signals that loci on chr  <dig> at  <dig> cm have effect on the expression levels of some genes. the second co-expression network did not generate very consistent results among traits, because the  <dig> genes used were not highly correlated. however, we can still identify the  <dig> cm region on chr  <dig> by  <dig> of the  <dig> genes in the top  <dig> selected loci with the smaller marker set division. the marker sets constructed by correlations can be treated as a more detailed division of the marker sets formed by chromosomes. it is clear that marker set formation by correlations generate more consistent and convincing results than naively setting markers within each chromosome as a group. however, in this real data case, due to the high correlations, even marker set formation by chromosomes may improve the results. additive model and single trait selection gave specious results . the successful reproduction of existing results proved the effectiveness of ngvs.

kernels, interactions and covariates
in the above analysis, we only considered linear models. covariate and epistatic effects based on different assumptions are discussed below. to simplify the analysis, we only considered a co-expression network of trait ankrd <dig>  sfrp <dig>  ergic <dig> each connected with the other two. the following six models were formulated:  the additive linear model;  the two-effect linear model;  the additive linear model including adjacent interactions between markers;  the two-effect linear model including adjacent interactions between markers;  the two-effect sex-dependent model treating sex as one additional group;  the additive model with  <dig> different kernels - linear, polynomial , gaussian , ibs and wibs.

all the big scale selection orders are shown in table  <dig>  ideally, we hoped the model to pick out chr  <dig>   <dig> as the previous findings. by comparisons of model  <dig>   <dig>   <dig>   <dig> with the basic linear model  <dig>   <dig>  we made some conclusions. under the adjacent interaction models  <dig> and  <dig>  the results of additive model and two-effect model both showed improvement compared to model  <dig> and  <dig> respectively. this meant epistatic effects do have a large impact on the expression levels of mrna. under sex-dependent model  <dig>  sex as one group was first identified as significant. also, we noticed the enhancement of significance of chr  <dig>  the fact probably implied an underlying influence of sex on the gene expressions through loci on chr  <dig>  unfortunately, the trait number was too small to draw the conclusion. under the kernel model  <dig>  we found that the linear kernel which simply increases the degree of freedom without changing the linear relationship of loci performed poorly; the polynomial kernel which considers all the two-way interactions together was slightly better; gaussian, ibs, and wibs all performed extremely well since they measure the similarities between individuals; gaussian seemed the best way to capture the similarity as we may expect; and wibs performed better than ibs, which proved that rare alleles indeed provide more information. from the discussion above, we notice our framework is very flexible.

model 1: the additive linear model; model 2: the two-effect linear model; model 3: the additive linear model including adjacent interactions between markers; model 4: the two-effect linear model including adjacent interactions between markers; model 5: the two-effect sex-dependent model treating sex as one additional group; model 6: the additive linear model with  <dig> different kernels.

in order to get general findings, we picked out marker sets chr  <dig> and chr  <dig>  as they were identified as significant by all the  <dig> traits under most of the model assumptions. then we made final selection orders for the  <dig> traits only using loci on chr  <dig> and chr  <dig>  we identified marker  <dig>   <dig>  on chr  <dig> and marker  <dig>  on chr  <dig>  the region marked by d2mit <dig> and d2mit <dig> was obviously hot spot for those gpcr genes. under two-effect adjacent interaction model  <dig> with loci on chr  <dig> and  <dig>  we went further to discover the significant epistatic effects by treating each interaction term as one variable and applying glasso to genes in the first co-expression network. we found that  <dig> of the  <dig> gene traits exhibited the epistatic effect between marker  <dig> and  <dig>  on chr 2;  <dig> of the  <dig> gene traits showed the effect between marker  <dig> and  <dig>  on chr  <dig>  it is interesting that the most significant epistatic effects occurred together with their additive and dominant effects. under two-effect sex-dependent model  <dig> with loci on chr  <dig> and  <dig>  we tried to detect the sexual distinction. for chr  <dig>  there was no significant evidence for difference between males and females. however for chr  <dig>  interaction of sex with marker  <dig>  was identified by  <dig> of the  <dig> gene traits. so we believe that d11mit <dig> denotes a region which has a regulation mechanism related to sex. the results above still need further biological study.

CONCLUSIONS
we have proposed a penalized regression method called the network-based group variable selection. the basic idea of our method is along the ongoing efforts to incorporate prior biological knowledge into data analysis. in eqtl, we hope to combine information from both the correlated gene expression traits and the loci structure  <cit> . by considering networks, we obtain more power to detect the co-regulatory causal snps; and by considering marker sets, our method gains great flexibility for modelling the complex joint activity of multiple snps and reduces the dimensionality of eqtl problem dramatically. we formulated the method based on these ideas and made it suitable for the efficient block co-ordinate gradient descent algorithm  <cit> . furthermore, we provided the way to create the selection orders in the big and small scales and combine them together.

however, the method has some limitations. first of all, the method is designed for high-dimensional biological data such as linkage analysis or genome-wide association study, thus it is not very effective for low-dimensional selection problems. our method is especially powerful for high-dimensional and very noisy data. in addition, combining more information means longer computation time and larger storage space. though our method is powerful for detecting causal snps with moderate or weak effect, we need to try different tuning parameters λ <dig> and make λ <dig> vary with a sufficiently small step to generate the selection order. when the network is complex and the number of snps is large, our method is quite expensive. the storage of high-dimensional matrix is also a problem for eqtl.

we applied our method to two simulations and one real linkage dataset to demonstrate the capability of the ngvs. simulation one compared three methods for a low-dimensional model setting and we concluded that our method is suitable for problems with high-noise background. simulation two mimicked the real linkage data. it showed that considering the proper loci grouping, the co-expression network and the additive and dominant effects simultaneously is essential for obtaining convincing results. under the framework of our method, we also considered many different models including kernels, interactions, and covariates in the real data analysis. all the results led to the co-regulatory regions on chr  <dig>   <dig> for gpcr genes, which replicated the findings of lan et al.  <cit> . furthermore, we found that gaussian kernel can depict the similarities of individuals very well; the interaction between marker d2mit <dig> &d2mit <dig> and between d10mit <dig> &d10mit <dig> are significant; and sex may have some effect on the expressions through marker d11mit <dig> on chr  <dig>  although all these conclusions need to be tested by additional research, it is clear the ngvs has the power and flexibility to handle high-dimensional problems with high-noise data successfully.

competing interests
the authors declare that they have no competing interests.

authors' contributions
ww initiated the project, invented the ngvs method, completed the simulation experiments and the linkage data analysis, and drafted the manuscript. xz provided advice for important intellectual content and revised the manuscript. all authors read and approved the final manuscript.

acknowledgements and funding
this work is supported in part by nsfc grants  <dig> and  <dig>  the authors thank xueya zhou and profs. minping qian and xihong lin for their helpful discussions. the authors thank the reviewers for their helpful comments.
