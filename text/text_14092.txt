BACKGROUND
gene regulation and metabolic reactions are two primary activities of life. despite vast amount of works have been dedicated to study each system, the coupling between the two systems is relatively less probed. it is therefore necessary to shift focus from individual systems to their integration.

the coupling between metabolic reactions and gene regulation is supported by abundant direct and indirect evidence. some assays indicate substrates of metabolic reactions influence the activities of transcription factors or signal transduction pathways . more studies show metabolic enzymes are differentially expressed under different nutrient conditions or enzyme knock-outs . these studies suggest 1) metabolic reactions are controlled by enzyme quantities besides concentrations of substrates and allosteric regulation of enzymes, 2) enzyme gene expressions are indirectly regulated by metabolites. both implications are sensible from an evolutionary perspective. despite its slowness, gene regulation yields a persistent response which can shift the cell from one metabolic "mode" to another. it is also easier to control due to the modularity of gene regulation and the separation between functional  and regulatory  elements in the genome. the influence of metabolites on enzyme gene regulation is a necessary arrangement to make the systems  responsive to environmental changes and maintain the homeostasis of metabolism.

previous methods of modeling the joint processes of gene regulation and metabolic reactions fall into three general categories. the first approach explicitly establishes the links between specific metabolites and transcription factors and models the influence between metabolites and gene expression. examples include imposing binary constraints from gene expression data on metabolic fluxes  <cit> , explaining mrna and protein expression data under different carbon sources with cascades of protein interactions  <cit> , and incorporating  links and functions in a boolean network  <cit> . while this approach can model the mutual influence between metabolites and transcription factors, existing works tend to focus on either direction.  <cit>  emphasize the constraints of enzyme expression levels on metabolic fluxes, and  <cit>  focus on the effect of metabolites on gene expression. moreover, although these models in principle can learn the interactions between metabolites and transcription factors, most current works extract these links from previous studies and treat them as given. the second approach integrates the two systems by proposing high-level hypotheses regarding the regulation of metabolic enzymes and validates these hypotheses by experimental data. common hypotheses include efficient allocation of resources to optimize growth  <cit> , combination of flexibility of flux modes and efficiency for biomass growth  <cit> , and co-regulation of enzymes along metabolic pathways  <cit> . while these hypotheses provide insight about the design rules of the regulatory and metabolic systems, they also lack the information about the underlying mechanisms. the third approach builds a dynamic system of metabolic reactions and gene regulation. examples include models of galactose switch  <cit> , pheromone response pathways  <cit> , and general metabolic reactions  <cit> . while dynamic systems can in principle capture the complex system behavior, they also suffer from the lack of data and unknown kinetic parameter values.

in this work we propose a joint model of gene regulation and metabolic reactions that combine the merits of the first two approaches and compensate their shortcomings. our model aims for answering the following questions. first, we want to demonstrate whether the coupling between the two systems is essential to explain different types of perturbation data. second, the identities and functions of the feedback links between metabolites and regulators are often unknown. we want to find those missing links from the perturbation data. third, we want to identify the mechanisms responsible for perturbation responses. by abstractizing these mechanisms as paths in the joint network of gene regulation and metabolic reactions, this question is translated into finding the "active paths" which explain the perturbation responses. fourth, in addition to individual  links we are also interested in the "design rules" regarding the architecture and functions of the feedback regulation of metabolic enzymes. we want to test whether certain hypotheses pertaining to feedback regulation can better explain the experimental data. the general concept of our model is illustrated in figure  <dig>  the networks of gene regulation  and metabolic reactions  are joined by edges from metabolites to transcription factors or enzyme genes. we consider the data of gene expression or metabolic fluxes by altering genes  or metabolites . a perturbation data is explained by a set of paths connecting the perturbation source  to the response  if the predicted responses along those paths coincide with the actual response. the consistency requirement for explaining perturbation data imposes constraints on the attributes in the joint network such as the functions  of  edges. for example, to explain the up regulation of gene  <dig> by supplying metabolite  <dig> in figure  <dig> the aggregate function of the red path must be positive.

we encode these constraints as a probabilistic graphical model – factor graph – over the network attributes, and apply a graphical model learning algorithm to identify the attribute values which optimally fit the data. to build a joint network we use two methods to establish links between metabolites and genes. the first method searches among all  pairs and incrementally augments the joint network with the links which maximize the number of explained perturbation responses. the second method explicitly adds links according to several general hypotheses pertaining to the functions of metabolic pathways and enzymes. the modeling framework is illustrated in figure  <dig>  the inputs of the model are the joint network and the perturbation data. once the joint network is built, we incur the learning algorithm to infer the active paths and functions of the feedback links. the outputs of the model are these inferred attribute values. once the attribute values are inferred, we can evaluate the explanatory power of the model by counting the number of perturbation responses explained by and contradicted with the model. we can also validate the predictive power of the model by using cross validation or simulation tests. our model applies the following simplifying assumptions. first, the links from metabolites to transcription factors or enzymes are often indirect and functional. typically, the change of metabolic conditions is sensed by a receptor protein and propagated to transcription factors via a signal transduction pathway. we do not attempt to reconstruct this mechanism due to insufficient data of signal transduction. second, the model concentrates on four mechanisms 1) metabolites modulate the activities of transcription factors 2) the activities and quantities of transcription factors affect enzyme gene expression 3) enzyme gene expression affects the flux of the reaction it catalyzes 4) the concentration of a reactant affects the reaction flux and its products. a path in the joint network represents a combination of these mechanisms. for example, the red path in figure  <dig> contains mechanisms  and , while the green path contains mechanisms  and . third, for simplification we ignore several important mechanisms such as allosteric regulation of enzyme conformation, nutrient uptake, the functions of coenzymes  and small metabolites . fourth, we only consider a special case of the combinatorial effects of multiple transcription factors or enzymes: each factor or enzyme acts independently and the change of each factor or enzyme suffices to alter gene expression or metabolic reactions.

RESULTS
we first describe a joint network of gene regulation and metabolic reactions and the datasets used in this work. we then define the terminology pertaining to paths in the joint network and outline the constraint-based probabilistic graphical model over model attributes. we applied two approaches to construct the joint models of metabolic reactions and gene regulation and used them to explain the perturbation responses. the first approach learns the feedback links between metabolites and regulators which best explain the data. we investigated the change of explanatory power with respect to path length and active paths connecting perturbation sources and responses in this joint model. the second approach encodes four general hypotheses pertaining to enzyme gene regulation in the joint model. to further validate the predictive power and the consistency of the model learning algorithm, we did two validation tests. we performed three cross validation tests on the perturbation data to ensure the inferred model could accurately predict the responses in the test data. we also simulated perturbation responses from the models with hypothetical feedback links and verified that the model learning algorithm could retrieve these feedback links from simulated data.

a joint network of gene regulation and metabolic reactions
we constructed the joint network of gene regulation and metabolic reactions of escherichia coli. the regulatory part of the network contains the nodes of regulators , operons and genes. regulators link to operons they bind and operons link to their member genes. the metabolic part of the network contains the nodes of metabolites, fluxes of reactions, and enzymes. metabolites at both sides of a reaction connect to the flux of this reaction with bidirectional edges. enzymes catalyzing a reaction connects to its flux with unidirectional edges. the regulatory and metabolic parts are coupled by two types of directed edges: edges linking genes to enzymes indicating the mapping between enzyme gene identities and functions, edges linking metabolites to regulators indicating the feedback control of metabolites on regulator activities.

many metabolic reactions are either irreversible or have a "preferred direction" under the normal growth condition. we therefore annotate the preferred directions of reactions and specify their "input"  and "output"  metabolites. for instance, in reaction glucose + atp ⇌ glucose-6-phosphate + adp, glucose is the input and glucose-6-phosphate is the output.

for e. coli, the substrates and enzymes of metabolic reactions, the operons of many genes, the bindings of transcription factors on some operon promoters, and the functions of these transcription factors were downloaded from the ecocyc database  <cit> . we used these information to construct metabolic and regulatory networks. as a proof-of-concept demonstration we focused on genes and reactions involved in the central carbon metabolism. we included the metabolic pathways of glycolysis, tricarboxylic acid  cycle, pentose phosphorylation, entner-doudoroff, acetate utilization, and several other reactions connecting these reactions. we also included the enzymes catalyzing each reaction in these pathways, operons containing these enzymes, and the transcription factors which are known to control these operons according to ecocyc. there are  <dig> metabolic reactions,  <dig> metabolites,  <dig> enzymes,  <dig> transcription factors and  <dig> other genes in this subset. the joint network is shown in figures  <dig>   <dig>   <dig>   <dig>  the list of these participants is provided in additional file  <dig> 

datasets
perturbation data of e. coli from  <dig> sources were used: the gene expression datasets under acetate supply  <cit> , glucose and amino acid limiting conditions  <cit> , and pyruvate kinase knockout  <cit> ; the metabolic flux datasets under pyruvate kinase knockout  <cit> , phosphoglucose isomerase and glucose-6-phosphate dehydrogenase knockouts  <cit> . metabolic flux data capture the rates of metabolite production in certain reactions. an informative review of metabolic flux measurements can be found in  <cit> . table  <dig> summarizes the properties of these data. notice rows  <dig> and  <dig> are two experiments from the same reference.

we quantized expression and flux data into three levels. for expression data the ratios between the perturbation and reference conditions were reported. we quantized an expression response as significantly up or down regulated if it changes more than two folds in either direction. the only exception is the expression data of pykf knock-out  <cit> :  <dig>  fold or higher for up regulation and  <dig>  fold or lower as down regulation. for flux data the percentage of fluxes relative to glucose uptake was reported. we quantized a flux response as significantly increase or decrease if the change ≥ ± 15% of glucose uptake relative to the reference condition. these quantization criteria were primarily based on the discussions in the references of the data sources. for instance, in  <cit>  the authors consistently used 2-fold changes to determine differential expression; in  <cit>  zwf was reported up-regulated in pykf knock-out, while the expression ratio of zwf was about  <dig> . ideally quantization should be based on statistical analysis of the control experimental data. since the control data and statistical analysis were not provided in these sources, we could only use these subjective criteria. the problem of identifying noisy fluctuations as significant changes is less severe as we limited to the subset of genes and reactions highly relevant to the perturbed processes.

paths in the joint network
a key concept of this work is to explain perturbation responses with paths in the joint network. in this section we clarify several terms regarding paths and give them mechanistic interpretations. a metabolic pathway denotes a series of metabolic reactions with known biochemical functions, e.g., glycolysis or tca cycle. it is recognized by biochemists and reported in the databases such as ecocyc. in contrast, a path denotes a sequence of consecutive edges in the joint network. it is determined by network topology and may not carry real biological meanings. however, we can give each path a causal, mechanistic interpretation in terms of gene regulation and metabolic reactions. for instance, the red path in figure  <dig> denotes the gene regulatory alteration via the feedback link between metabolite  <dig> and regulator  <dig>  the green path in figure  <dig> denotes the cascade of kinetic shifts along reactions 1– <dig> by changing metabolite  <dig>  the paths containing only ,  and  edges represent the kinetic shifts of reaction fluxes and metabolites due to the changes of metabolites or enzyme levels. we call such paths metabolic paths. the paths containing only  and  edges represent the causal events of transcription regulation. we call these paths regulatory paths. we are interested in the causal events which involve both metabolic shifts and gene regulation. a path containing both regulatory and metabolic edges and the  feedback links is called a mixed path. a perturbation response  denotes a tuple of the perturbation , an affected gene or flux, and the direction of the response  with respect to a reference condition. a valid path represents a plausible mechanism that can possibly explain a perturbation effect. these paths are obtained by filtering all the paths connecting each perturbation source and response according to node types and network topology. the filtering criteria are described in the methods. a valid path explains a perturbation data if its predicted response coincides with the actual response. a valid path contradicts with a perturbation data if its predicted response disagrees with the actual response. a valid path is active if its underlying mechanism is responsible for the perturbation effect. concrete definitions of valid paths, predicted responses, explanation and active paths will be given below.

paths are useful for explaining perturbation responses. a perturbation data contains both direct and indirect effects. the active paths provide consistent hypotheses about the direct and indirect mechanisms for perturbation responses. however, it is easy to create many arbitrarily long paths to fit the perturbation data. to restrict the expressive power of the model we limit the maximum path length and investigate the change of inference results with respect to the path length limit.

attributes of the joint network
we assign the following attributes to the joint network: the presence or absence of each edge, the function  of each edge, and the activity of each valid path. some of these attributes are already known. for example, the sign of an  edge is always positive because the enzyme catalyzes the reaction; the signs of many  edges are reported in ecocyc. other attributes are not given thus have to be inferred from data. we are interested in the following unknown attributes: the presence/absence and functions of  edges, and the activities of valid paths. a complete specification of the values of all attributes in the network is called a model configuration. it represents a hypothesis about the functions of interactions and causal mechanisms to explain the perturbation data.

a probabilistic graphical model over network attributes
a perturbation response can be caused by cascades of regulatory changes and metabolic shifts represented by paths in the joint network. to explain a perturbation response with a valid path the predicted response along the path must be consistent with the observed response. the predicted response along a path is determined by the functional direction of the perturbation , the functions  of  and  edges, and the causal directions of the reactions . the concrete rules of prediction are described in methods.

the consistency requirement for explaining a perturbation response imposes constraints on the attributes along the path. figure  <dig> illustrates these constraints with a toy example. this small network is constrained by three perturbation responses. first, deleting regulator r <dig> up-regulates enzyme e <dig>  the edge sign e <dig> is negative in order to explain this response. second, reducing metabolite m <dig> down-regulates e <dig>  to explain this response the product of s <dig> and s <dig> is positive. third, reducing m <dig> also reduces flux f <dig>  m <dig> and f <dig> are connected by three paths. the predicted responses along paths  <dig>  and  <dig>  are compatible with the observed response, but the predicted response along path  <dig>  is the opposite of the observed response. thus only paths  <dig> and  <dig> are active.

the power of integrating constraints is evident even in this toy example. each local constraint may not suffice to uniquely determine attribute values, but multiple perturbation responses pertaining to overlapped paths may provide sufficient constraints. by combining constraints  <dig> and  <dig>  we uniquely infer that s <dig> and s <dig> are both negative. in addition, the responses from one data may reinforce the confidence about path activities for other data. the down-regulation of e <dig> in m <dig> reduction strongly suggests that path  <dig> is responsible for explaining the reduction of f <dig> in m <dig> reduction.

we want to find the attribute values which satisfy all constraints from the perturbation data. this problem is np-hard and may not be solvable. we relax these hard constraints and express them as a probabilistic graphical model – a factor graph model  <cit>  – over the network attributes. the network attributes are treated as discrete random variables and each local constraint is relaxed as a non-negative real-valued function – a "potential function". the product of all potential functions – the unnormalized joint likelihood function – represents all the constraints from the data. the difficult constraint satisfaction problem is hence relaxed as a tractable graphical model inference problem. the optimal configurations which maximize the joint likelihood function can be calculated using standard inference algorithms such as the max-product algorithm  <cit> . details about constructing the factor graph model from local constraints and the inference algorithm are described in methods.

learning feedback links between metabolites and regulators
the feedback links between metabolites and regulators are not reported in the ecocyc database thus need to be specified. we first applied a simple algorithm to reconstruct these feedback links from perturbation data. it searches among all  pairs and incrementally augments the joint network with the links which maximize the number of explained perturbation responses minus the number of contradicted responses. intuitively, a link is chosen if it creates "shortcuts" connecting many perturbation data with valid paths. different sets of links are retrieved at different path length limits, and at a fixed path length limit there can be multiple link sets which have equal explanatory power. we call these link sets degenerate link sets since they are equally good to fit the existing data. table  <dig> shows the inferred feedback link sets with the corresponding maximum path length, the explanatory power of the models , and their statistical significance using a permutation test. two interesting properties arise from table  <dig>  the explanatory power of the model first increases with increasing maximum path length then decreases when the maximum path length exceeds  <dig>  allowing longer paths connects more perturbation responses but also generates more spurious paths. the model's explanatory power is a balance between these two factors. in addition, the metabolites of the degenerate link sets are close in the metabolic network. for instance, either  or  appears in many inferred edge sets. since the existing data do not have sufficient resolution to delineate these links, they tend to explain the same set of perturbation responses. most optimal link sets in table  <dig> comprise two links. the first link connects an upstream metabolite of glycolysis  to arca, a global repressor of glucose metabolism enzymes  <cit> . the second link connects a downstream metabolite of glycolysis  to arca. these links explain the the expression data of glucose limitation and acetate supply because they connect glucose and acetate to differentially expressed genes. they also create short paths connecting deleted enzymes  and metabolic fluxes and provide alternative explanation for flux changes.

arca and arcb form a two-component regulatory system for respiratory control  <cit> . in the deficiency of oxygen, arcb phosphorylates arca, which inhibits the expression of enzymes for aerobic respiration. apparently arca is affected by oxygen but not the metabolites in the central carbon metabolism. however, other links between metabolites and regulators yield inferior explanatory power than those two putative links. for example, a standard mechanism for catabolite repression of enzyme genes is through the crp-camp transcription factor complex  <cit> . some genes differentially expressed in glucose limitation – such as fuma, fumc, acea, acek, and nadh dehydrogenase members – are not bound by crp but by arca. the link  thus cannot explain these expression responses. previous studies also confirm the effect of acetate and pyruvate on arcb and arca activities  <cit> . curiously, acetate and pyruvate are reported to activate arca, hence repress the aerobic genes. this prediction contradicts with the expression data of acetate supply, suggesting other regulators are involved or arca is affected by conditions accompanied glucose or acetate supply.

to further investigate the properties of inferred models, we focused on a joint network comprising representative links from these two degenerate sets:  and . we examined the change of explanatory power of the model with respect to maximum path length and the types of perturbation responses explained by the model. finally, we investigated the active paths explaining the perturbation data.

the first two rows of table  <dig> show the net number of explained significant perturbation effects  and their permutation p-values versus the maximum path length. the explanatory power of the model first increases with the maximum path length then stabilizes when the maximum path length exceeds  <dig>  this property is again a balance between the improved connectivity of models with longer paths and the likely contradictions caused by spurious paths.

to understand the mechanistic interpretations of our models, we further analyzed the active paths responsible for explaining the data from each perturbation experiment. to save space we only present the analysis of  <dig> perturbation experiments. the active paths explaining each of the  <dig> perturbation experiments are shown in the supplementary files . all the network graphs are drawn by cytoscape  <cit> .

encoding general hypotheses about metabolic enzyme regulation
besides individual links between metabolites and regulators, it is also of interest to know whether enzyme expressions and functions are related by abstract "design rules" or general hypotheses. these rules bypass the incomplete transcription factor binding information and may reveal the general relations between the functions and regulatory architecture of metabolic pathways. ideally the general hypotheses should be learned from the data as the  links. to do this we need a rigorous definition of hypotheses and a systematic way to search and test these hypotheses. in this preliminary work, we only proposed four simple hypotheses and tested them using the same perturbation data. we consider metabolic pathways with definite physiological functions and preferred directions .

 <dig>  the input metabolites of a metabolic pathway activate the expression of enzymes catalyzing reactions along the pathway.

 <dig>  the end products of a metabolic pathway inhibit the expression of enzymes catalyzing reactions along the pathway.

 <dig>  when multiple pathways compete for the same inputs but have different products, the products of one pathway inhibit the enzyme expression along the competing pathway.

 <dig>  glucose represses genes involved in the tca cycle, electron transfer, and metabolism of other carbon sources.

hypotheses 1– <dig> reflect simplified heuristics for efficient resource allocation. to avoid wasting enzymes, a metabolic pathway is turned on only when input metabolites are available, and is turned off when it produces sufficient products or when a competing pathway is active. hypothesis  <dig> is based on a well known phenomenon of glucose repression  <cit> . these simple rules by no means suffice to characterize enzyme gene regulation but are good working hypotheses to test. a general hypothesis is encoded in the model by adding links from metabolites to enzyme genes and designating their functions . we encoded these hypotheses in the joint model and applied it to the same perturbation data. the first two rows of table  <dig> show the net number of explained significant perturbation responses and its statistical significance versus the maximum path length. figure  <dig> shows the explained significant responses categorized by the types of responses and paths explaining the effects. similar to table  <dig>  the net number of explained responses first grows with the maximum path length then saturates. the profile of explained effects is also similar to figure  <dig>  expression data are exclusively explained by mixed paths, flux data are explained only by metabolic paths when the path length is short. as the path length increases more flux data are explained by mixed paths. the net numbers of explained effects are comparable between the two approaches. the results in figure  <dig> and table  <dig> are also summarized in the supplementary file .

the explanatory power by adding the general hypotheses to the model is statistically significant across different maximum path length: the p-value < 10- <dig> for the maximum path length from  <dig> to  <dig>  we also evaluated the explanatory power contributed by each hypothesis by comparing the model with a null model lacking each hypothesis. figure  <dig> shows the gain of the explanatory power contributed by each hypothesis with varying path length. clearly, hypothesis  <dig>  has the highest contribution to the explanatory power. hypothesis  <dig>  also yields substantial contribution until the maximum path length reaches  <dig>  a negative contribution means the net number of explained responses becomes smaller by incorporating the hypothesis in the model. as the maximum path length increases, more paths are created and the hypothesis is more likely to be violated along some of these paths. hypothesis  <dig>  has a small yet non-negative contribution for the maximum path length ≥  <dig>  in contrast, hypothesis  <dig>  has small positive contribution along short paths but has negative contribution as the maximum path length exceeds  <dig>  therefore, adding hypothesis  <dig> to the model does not improve  the explanatory power of the model. we also draw the active paths in the general hypotheses models explaining each perturbation experiments. to save space we put these figures in the supplementary files .

validating inferred models
we performed two computational tests to validate the predictive power and the consistency of the model learning algorithm. first we performed three cross validation tests on the perturbation data to check whether the model could accurately predict the perturbation responses. second we built hypothetical models of metabolic-regulatory coupling, simulated perturbation response data according to these models, and verified whether the learning algorithm could recover the hypothetical models.

the test accuracy reaches 60% when the maximum path length is  <dig>  and drops significantly to about 50% when the maximum path length is  <dig>  this suggests overfitting occurs as the maximum path length exceeds  <dig> due to spurious paths. figure  <dig> shows the results of models derived from the general hypotheses. it demonstrates a similar pattern as figure 9: the accuracy rate is close to their upper bounds when the maximum path length ≤  <dig>  reaches the maximum around 50% when the maximum path length is  <dig>  and drops significantly as the maximum path length exceeds  <dig>  the inferior test accuracy rates are due to the larger number of valid paths created by the general hypotheses. moreover, the test accuracy rates generated by three different cross validation tests are very close, indicating they are robust against the choice of test sets.

besides cross validation, we also verified the consistency of the model learning algorithm by checking whether the algorithm could accurately learn the underlying model if the model hypotheses were correct and sufficient data were given. we generated a hypothetical model by adding two random  links and assigning random signs to these edges. hypothetical perturbation experiments were selected by randomly deleting/overexpressing genes or increasing/decreasing metabolite levels in the joint network. expression and flux responses of each perturbation were simulated according to the hypothetical model, and significant responses were incorporated in the hypothetical perturbation data. we then inferred the missing links and their signs from these data and compared the inferred links with the hypothetical model. this procedure was repeated for  <dig> random hypothetical models. as shown in figure  <dig>  the fraction of random models accurately learned by the learning algorithm increases with the number of experiments. when  <dig> experiments were provided, about half  of the random models were accurately learned by the algorithm. when  <dig> experiments were provided, over three quarters  of the random models were accurately learned. this "learning curve" suggests that our method can in principle learn the missing links  if sufficient data are provided.

discussion
we want to achieve four goals from the inferred models: 1) evaluate the advantage of an integrated model over separate systems, 2) identify the feedback links between metabolites and regulators and their functions, 3) computationally test the general hypotheses pertaining to the feedback control of enzyme expressions, 4) identify the active paths responsible for perturbation effects. in this section we discuss whether these goals are fulfilled from the results.

the advantage of an integrated model is obvious. as shown in table  <dig>  a joint model of regulatory and metabolic networks explains perturbation data significantly better than the two separate networks. this advantage arises from the improved connection from perturbation sources to responses in the joint network. specifically, it is essential to establish feedback links from metabolites to transcription factors or genes in order to explain the differential expression of genes under different metabolic conditions. other types of perturbation data may also be explained by short paths containing both regulatory and metabolic links. table  <dig> indicates multiple sets of feedback links yield the same explanatory power. therefore, we cannot uniquely identify the feedback links. this is expected since our perturbation data do not have sufficient resolution to discriminate between multiple link sets. nevertheless, we can approximately map the positions of the metabolites involved in the metabolic network: one link connects an upstream metabolite of glycolysis to arca, and the other link connects a downstream metabolite of glycolysis to arca. these degenerate link sets can guide us to narrow down the true feedback links by further experiments.

the two inferred links  and  are not directly supported from previous studies. the main objection is that arca is regulated by oxygen but not metabolites in the central carbon metabolism  <cit> . we argue the validity of these links from both modeling and biological perspectives. two criteria of justifying a model are its simplicity and predictive power. these two links are the most "economical" augmentation to explain the data because many genes differentially expressed in glucose limitation and acetate supply are bound by arca. more links are required if we consider the feedback control through other transcription factors. for instance, some differentially expressed genes in glucose limitation are not bound by crp, a standard regulator for glucose repression. furthermore, cross validation tests indicate the models can accurately predict the perturbation responses. biologically, the two links may embody indirect mechanisms. aerobic respiration is elevated by glucose limitation or acetate supply, whereas arca is a main repressor for aerobic respiration enzymes. the influence of glucose and acetate on aerobic respiration hence may indirectly modulates arca and affects these enzymes.

as shown in table  <dig>  a model encoded with four simple hypotheses explains the data significantly better than the model without these hypotheses. however, we found the explanatory power contributed by each hypothesis was quite different. while the hypothesis of glucose repression  accounts for a large number of perturbation responses, hypotheses  <dig> and  <dig> have only moderate and weak explanatory power. moreover, hypothesis  <dig> apparently yields contradictions as the maximum path length becomes longer. the results imply some of these hypotheses are not valid and more complex "design rules" exist. for the extremely robust, tightly regulated system of central carbon metabolism, there are probably more sophisticated design rules governing gene regulation and metabolic reactions. therefore, it would be desirable to apply the tests to the data covering a wide range of metabolic pathways.

finally we want to verify the inferred active paths explaining the perturbation responses. pure metabolic paths connecting metabolites or enzymes to fluxes merely restate the kinetic shifts of metabolic reactions. mixed paths, however, are difficult to verify directly. we again justify these paths from both modeling and biological perspectives. from a modeling perspective, we want to restrict the path length to limit model complexity and reduce overfitting. therefore, we tend to use "shortcuts" via the feedback links to explain the perturbation responses. on the other hand, the active paths explaining different types of perturbation data are highly overlapped. for instance, in figures  <dig> and  <dig> we use paths containing  and the links from arca to tca enzymes to explain both the expression data in glucose limitation and flux data in pgi knock-out. similarly, in figures  <dig> and  <dig> we use paths containing  and the links from arca to tca enzymes to explain both the expression data in acetate supply and flux data in pyka/pykf knock-outs. using the same set of mechanistic hypotheses to explain different data is desirable from a modeling perspective since it suggests the model is not tuned to a specific data.

biologically, the inferred active paths provide insight about the underlying mechanisms. one interesting example is the paths explaining the reduction of tca fluxes under pgi knock-out . we used the mixed paths containing  and  to explain the flux changes because they are much shorter than the pure metabolic paths. the longer metabolic paths are indeed responsible for these flux changes since a long cascade of kinetic shifts can occur rapidly. however, we should not exclude the influence of enzyme gene regulation in flux changes. as shown in figures  <dig>   <dig>   <dig>   <dig>  altering metabolic conditions changes both metabolic fluxes and enzyme levels. thus flux changes are likely to be the composite effects of both kinetic readjustment and gene regulation. intriguingly, our model indicates the directions of these two effects are consistent. for example, blocking the second step of glycolysis  has the opposite effect of reducing the input metabolite of glycolysis . the metabolic fluxes along the tca cycle are decreased in pgi knock-out and the enzyme expressions along the tca cycle are up-regulated in glucose limitation. similarly, blocking the second last step of glycolysis  has the opposite effect of increasing the output metabolite of glycolysis . the metabolic fluxes along the tca cycle are decreased in pyka/pykf knock-out and the enzyme expressions along the tca cycle are up-regulated in acetate supply. the agreement between enzyme expression changes and flux readjustment suggests gene regulation exerts another layer of control enhancing the kinetic shifts of the metabolic network. this design is sensible from an evolutionary perspective since gene regulation is likely evolved to improve the efficiency of an existing system of biochemical reactions.

the main contribution of this work is model the coupled processes of gene regulation and metabolism with a simple, mechanistic abstraction – paths in the joint network. the analysis on the data of the central carbon metabolism provides biological insight about the underlying system. as a proof-of-concept demonstration we do not expect to have novel discoveries from this very well-studied system. we plan to apply the model to less well-known systems such as the metabolism of human, other bacteria or archea. we are also aware of various limitations of the model: the discretized model attributes and data, ignorance of the dynamics of gene regulation and biochemical reactions, simplification of the combinatorial regulation of multiple transcription factors, and so on. we plan to overcome these limitations in the extended version of the model.

CONCLUSIONS
we propose a unified modeling framework of integrating the information of gene regulation and metabolic reactions. we hypothesize the perturbation effects are propagated along paths in the joint network and build a factor graph model specifying the constraints of using these paths to explain the perturbation data. the learning algorithm identifies the feedback links between metabolites and transcription factors, their functions and the active paths explaining the perturbation data. we also explicitly test four general hypotheses relating the functions and regulation of enzymes. by applying the model to the expression and flux data of the central carbon metabolism, we suspect gene regulation provides another layer of control to enhance the rebalance of reactions toward the new steady states. we also show the four simple hypotheses have different explanatory power to fit the data and suggest more sophisticated design rules may govern the regulation of the central carbon metabolism.

