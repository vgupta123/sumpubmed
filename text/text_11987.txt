BACKGROUND
prokaryotic cells inhabiting the human body outnumber its own eukaryotic cells at least ten to one, with the overwhelming majority of bacteria residing in the intestine. this complex community of symbiotic, pathogenic and commensal microorganisms is called the microbiome
 <cit> . the human gut microbiome might be considered as an organ within an organ
 <cit> . it has been shown to be indispensable for the human life as it is capable of vitamin production
 <cit> , digestion of complex polysaccharides
 <cit> , controlling intestinal epithelial cell proliferation through the production of short-chain fatty acids
 <cit> , and influencing the normal development and function of the mucosal immune system
 <cit> . while bacteria are responsible for these functions, bacteriophages, in turn, influence their abundance in the human gut
 <cit> .

as a reaction to an ongoing phage pressure, prokaryotes have developed numerous defence mechanisms
 <cit> . the crispr systems are especially interesting, as they retain the history of interactions between viruses and their prokaryotic hosts
. despite being highly diverse
 <cit> , typically they are comprised of a crispr cassette containing an array of unique spacer sequences  alternating with conserved short direct repeats and preceded by a 5′-leader sequence of 200–500 bp. the systems also include numerous crispr-associated  genes that encode proteins performing various, only partially characterized functions essential for the system’s activity
 <cit> . a crispr cassette is transcribed as a long precursor rna molecule that is further cleaved into small fragments , each containing one complete spacer. crrnas are the main players in the rna-guided degradation of foreign replicons
 <cit> . accumulation of new spacers occurs at one side of a cassette, adjacent to the leader sequence, while internal spacers may be deleted by recombination. hence older spacers are shifted to the 3′-end, and cassettes retain a unique chronological footprint of viruses that have infected a given strain
. however, a part of a cassette or even a complete cassette may be also acquired via horizontal gene transfer
 <cit> . in addition, identical or similar repeats in different crispr cassettes may indicate their common ancestry.

up to 60% of all microorganisms that inhabit the human body are considered to be unculturable
 <cit> . culture-independent metagenomics is the most powerful approach to study the composition and dynamics of complex microbial communities. the metagenomics data allow one to obtain a complete snapshot of coexisting microorganisms, both prokaryotes and their viruses.

to date, crispr systems have been analyzed in metagenomic datasets of several environments including acidophilic biofilms
 <cit> , acidic hot springs in yellowstone national park
 <cit> , australian hypersaline lake tyrrell
 <cit> , ocean metagenome produced by the global ocean sampling  expedition
 <cit> , and the rumen microbiome
 <cit> .

a considerable effort is directed to large-scale investigation of the human microbiome using the metagenomic approach. the main aim of these studies is to understand the role of the endogenous flora in health and disease. among all body sites, the diversity of microorganisms in the human gut is known to be the highest
 <cit> . the data from several human microbiome metagenomic projects are available, as well as human gut virome data
. a high level of microbial diversity and availability of metagenomic datasets obtained using various sequencing techniques make the human gut microbiome a promising object for studying crispr systems.

indeed, crispr cassettes were characterized across body sites in different individuals through independent projects
 and as a part of the human microbiome project
 <cit>  with a particular attention to the gut metagenome
. in these studies, raw reads containing crispr repeats were collected, followed either by the analysis of the spacer content
 <cit>  or reassembly of repeat-containing reads into contigs
 <cit> . this approach allowed the authors to identify thousands of spacers, although it was limited to crispr cassettes with already known repeats. while being a powerful tool to study the distribution of spacers, this strategy does not account for the crispr cassette structure, and hence may not track the evolutionary dynamics of spacers within cassettes. to offset this, we identified cassettes in assembled contigs. the comparison of spacers and repeats of these cassettes with previously analyzed spacers and repeats, in particular, those identified by read-based techniques, yielded only few matches. this suggests that both approaches are useful as they produce complementary findings. we analyzed the crispr content in three human gut metagenomes, two of which have not been analyzed earlier in this context. we identified crispr cassettes, compared the sets of repeats and spacers with the ones identified in earlier studies and analyzed the differences, identified protospacers, reconstructed the taxonomy distribution of cassettes and protospacers, characterized the distribution of spacers and protospacers in individual metagenomes, and, finally, described the dynamics of spacer positions within crispr cassettes for different classes of spacers.

methods
metagenomic datasets
human microbiomes
the gut samples of the human microbiome project  dataset were downloaded as an assembly in  <dig> , <dig> contigs
 <cit> . the total length of hmp contigs comprised  <dig>  mb. the fecal dna samples were collected from  <dig> adults of various ages  sequenced by illumina ga machines
 <cit> .

the assembled metagenomic dataset from  <dig> healthy japanese individuals  was downloaded from the camera website
 <cit> . this dataset contained  <dig>  contigs of the total length 463 mb. the samples were collected from adults and children including unweaned infants , comprising two families of three and four members, and six unrelated individuals. the shotgun reads were obtained using megabace <dig> sequencers 
 <cit> .

the contigs from the distal gut metagenomic project  were downloaded from the ncbi website
 <cit> . the assembly contained  <dig>  contigs, comprising 336 mb. the reads were sequenced using the abi 3730xl dna analyzer
 <cit> .

the information about metagenomic datasets used here is summarized in table 
 <dig> table  <dig> 
characteristics of the analyzed metagenomic datasets


the human microbiome project 
healthy human gut metagenomes 
distal gut metagenomic project 


identification and analysis of crispr cassettes
to construct a set of crispr cassettes for each metagenomic dataset, we used three algorithms, piler-cr
 <cit> , the crispr recognition tool 
 <cit> , crisprfinder
 <cit> , and a previously designed filtering procedure
 <cit> .

in addition, we attempted to use crass
 <cit>  with default parameters to assemble crispr cassettes from metagenomic reads. while the number of detected cassettes for the dg read dataset was comparable to that obtained by our procedure, crass did not assemble crispr cassettes from the hmp data. relaxing parameters for the number of repeats and spacer or repeat length  allowed crass to identify only one crispr cassette in the hmp dataset. for the jpn dataset metagenomic reads were not available, and hence crass could not be applied. hence, for uniformity, crass predictions were not considered further.

to determine contig taxonomy, contigs were subjected to the blastx search
 <cit>  against the non-redundant protein collection  of genbank
 <cit>  . taxonomic labels were assigned manually based on the degree of consistency in the taxonomy origin of the top hits. taxonomic labels at the phylum level were assigned if at least top ten hits belonged to one phylum; taxonomic labels at the level of class, family, and genus were assigned if the majority of top  <dig> hits belonged to the same taxon of that level. if top hits were taxonomically diverse, the contig was assigned with a nonspecific taxonomic label. a contig might not be assigned with a taxonomic label for the following reasons:  crispr cassette covering entire contig length;  crispr cassette flanked by regions containing only universal cas genes, known to be subject to frequent horizontal gene transfer, so that their phylogeny does not necessarily reflect taxonomy
 <cit> ;  flanking regions containing genes with no significant similarity to any entry in the non-redundant genbank collection. the cas genes were identified as described previously
 <cit> .

we considered two types of data to perform the blastn search in order to identify sources of spacers . firstly, we compared spacer sequences to all viral entries, including complete genomes, from genbank. secondly, we compared the spacer sets with the human metagenomic datasets themselves, assuming that these data may still contain contigs of phage, prophage, or plasmid origin after filtering out small particles .

if a mismatch between two similar sequences is located at a distance less than one word from the sequence end, blastn would not extend the alignment over this mismatch. since the alignments between spacers and protospacers are necessarily short, this means that spacer-protospacer pairs with mismatches in the middle might be aligned by blastn only partially. to offset this and to estimate the real number of mismatches in identified spacer-protospacer pairs, all obtained hits were postprocessed, and if the observed matching regions were shorter than the corresponding spacer sequence they were extended in one or both directions to match the full length of the spacer.

the number of mismatches was calculated for extended alignments of spacer-protospacer pairs and a threshold of four mismatches along the entire spacer length was set to define candidate protospacer sequences. to ensure that a sequence matched by a spacer is not an undetected crispr cassette, we performed a parallel blastn search for repeat sequences from the corresponding crispr cassettes against the same datasets as it was done for spacer sequences.

the taxonomic labels were assigned to protospacer-containing contigs as described above, and then transferred to the respective spacers as follows: if the protospacer was of a phage or plasmid origin, we used the taxonomical information about its host, whereas if the protospacer came from a sequence of a bacterial origin, its taxonomy was assigned as described above. if the spacer was already assigned with a taxonomical label, the assignments were compared.

in order to estimate the significance of the observed similarities between spacers and a sequence database, we generated randomized sets of “pseudospacers”, where each spacer was replaced by a random fragment of the same length and, if possible, from the same contig. the range for randomization excluded regions covered by crispr cassettes. if a crispr cassette covered a metagenomic contig  completely, i.e., if both flanking sequences were shorter than 100 nt, a fragment of the same length was taken from a randomly selected contig coming from the same individual but not containing predicted crispr cassettes.

however, a straightforward application of this procedure would be confounded by gene homology. this would manifest as similarity extending beyond the pseudospacer-pseudoprotospacer pair. to avoid this possibility, we extracted the flanking sequences of selected pseudospacers. these sequences had the same length as the repeats in the respective cassette. they were run against the same datasets as pseudospacers. a pseudospacer-pseudoprotospacer pair was taken into account only if none of its pseudospacer-flanking sequences matched the same sequence.

repeat clusters were constructed as described previously
 <cit>  using the standard blastclust procedure applied to the set of consensus repeat sequences . all clusters with more than one member were collected. alignments for the obtained clusters were constructed using the standard muscle procedure
 <cit> . for further analysis, the repeats were considered to be similar if they belonged to the same repeat cluster.

to search for pam sequences , 10 nt regions flanking protospacers from both sides were used
 <cit> .

crispr cassettes were oriented, when possible, according to the position and direction of transcription of cas genes. an end of a cassette was labeled as the leader terminus if the adjacent region of the contig contained a cas gene in the proper orientation. in addition, cassettes lacking flanking sequences of sufficient length were oriented by comparison to cassettes from the same repeat cluster, for which the orientation had been already assigned, assuming that the repeat should be encoded on the same strand for the entire cluster. for cassettes not belonging to clusters with defined orientation, the leader and trailer termini could not be determined, and such cassettes were not considered in the orientation-dependent analyses.

targeting spacers were defined as spacers having at least one reliable protospacer in the same individual metagenome. shared spacers were defined as spacers observed in two or more individual metagenomes.

to estimate whether targeting spacers tend to occur close to the leader-end of cassettes, and shared spacers, to the trailer-end, the following monte-carlo simulation was implemented. only complete cassettes  with defined orientation, were used. spacers in each cassette were enumerated. for each cassette, serial numbers of all targeting  spacers in the cassette were summarized. then the obtained statistics were summarized for the whole set of considered crispr cassettes. hence, we obtained a single value equal to the sum of all serial numbers of all targeting  spacers. after that, spacers in each cassette were randomly shuffled and the same procedure was applied. it was repeated  <dig>  times and the distribution of the analyzed statistic was built for the targeting and shared spacers. then the statistic obtained for real cassettes was compared with the constructed distributions, and the p-values were calculated.

to check whether spacers and protospacers tend to co-occur, we performed the following test. for each individual we constructed a 2 ×  <dig> contingency table featuring the number of spacer-protospacer pairs with spacer  coming from this individual. for the resulting set of contingency tables, the cochran–mantel–haenszel  statistic was calculated
 <cit> . as a null hypothesis we assumed that the occurrences of spacer and corresponding protospacer in an individual are independent. to check whether our data fit this hypothesis, we shuffled protospacers across the individual metagenomes, so that the number of protospacers in a given individual remained unchanged. this procedure was performed  <dig>  times, and in each round of permutations the cmh statistic was calculated. the obtained distribution was used to estimate the p-value of the observed statistic.

RESULTS
characteristics of crispr cassette sets
we used three publicly available human metagenomes to search for crispr cassettes. the latter were identified by several existing programs . to exclude false predictions of crispr cassettes in the metagenomic data, a filtering procedure was applied
 <cit> . this procedure retains the following types of cassettes:  cassettes predicted by the crt, crisprfinder and piler-cr programs simultaneously;  candidate cassettes  adjacent to cas genes;  candidate cassettes whose repeat consensus is similar to the repeat consensus of a cassette already accepted based on  or .

the sets of identified cassettes are shown in figure 
 <dig> and characterized in table 
 <dig> and additional file
1: table s <dig>  the largest set of cassettes was identified in the jpn dataset, followed by hmp, and few cassettes were observed in the dg metagenome. among the algorithms, the largest number of candidate cassettes was produced by crisprfinder, followed by crt and piler-cr, with considerable overlap between the predictions . examination of individual predictions demonstrated that crt and piler-cr tend to consider genomic repeats and low-complexity regions as a candidate crispr cassette, whereas crisprfinder reports numerous short cassettes of the type “repeat-spacer-repeat”.figure  <dig> 
venn diagram showing the numbers of crispr cassettes identified by the three programs. jpn , hmp , and dg  metagenomes are presented. abbreviations for the program names are: crt – the crispr recognition tool; cfi – crisprfinder; pil – piler-cr.


statistics of identified crispr cassettes and spacers



cassettes

identified by:
  piler-cr
  crt
  crisprfinder
  all three programs
   <dig> or  <dig> programs, but adjacent to
cas
genes

final set of cassettes:
  total number
  cassettes adjacent to
cas
genes
  cassettes with assigned taxonomy
  cassettes with assigned crispr-cas type:
    i type
    ii type
    iii type

spacers

total number

unique spacers

spacers with protospacers in:
  the same metagenomic dataset
  nr database

repeats

unique

repeats with matches in crisprdb

repeats from known clusters according to the crisprmap algorithm
columns correspond to three metagenome datasets.

then, we considered candidate crispr cassettes identified by at least one of the programs, and adjacent to cas genes . there are several possible reasons why these cassettes have not been identified initially, including short cassette lengths, varying length of spacers, divergent repeats, etc., confounding individual programs. notably, of  <dig> cassettes adjacent to cas genes,  <dig>  had repeats not observed in other databases or complete genomes. that done, no candidate cassettes with repeats similar to the repeats of already accepted cassettes were observed. hence, filtering condition  turned out to be redundant. this proves robustness of the procedure.

the final set of crispr cassettes consisted of  <dig>   <dig>  and  <dig> cassettes from the jpn, hmp, and dg metagenomes, respectively. two distinct cassettes were never observed in one contig. in all three metagenomic datasets, a considerable fraction of cassettes were adjacent to putative cas genes. we detected  <dig>   <dig>  and  <dig> such cassettes in the jpn, hmp, and dg metagenomes, respectively, comprising 24%, 71%, and 43% of the total cassette number in the respective set.

the set of  <dig> crispr cassettes in the jpn metagenome contained  <dig> spacers, comprising  <dig> unique spacers.  <dig> spacers from  <dig> hmp cassettes comprised  <dig> unique ones. only one spacer out of  <dig> spacers found in  <dig> dg cassettes occurred twice . the non-redundant set of repeat sequences contained  <dig>   <dig>  and  <dig> unique repeats for the jpn, hmp, and dg metagenomes, comprising  <dig> repeat clusters .

once a reliable set of crispr cassettes was constructed, we compared consensus repeat sequences from these cassettes  with repeats from already known crispr cassettes deposited in crisprdb
 <cit> . only  <dig> of  <dig> identified unique repeat sequences matched repeats from the crisprdb database. all matched repeats originated from the jpn metagenome and corresponded to  <dig> repeat clusters. such a small intersection with crisprdb indicates that most crispr cassettes identified here are novel.

generally, two different approaches to identification of crispr cassettes in metagenomic data are feasible: making prediction on assembled contigs or extracting spacers directly from raw reads. crispr prediction on assembled contigs retains the order of spacers in a cassette. on the other hand, assembly of sequences containing repeats is difficult, and hence a considerable fraction of crispr cassette-containing reads would remain unexplored. the other approach, recently used to identify crispr cassettes in the human gut metagenome
 <cit> , analyzes raw reads and extracts spacer sequences flanked by sufficiently long repeat segments from already known crispr cassettes from existing databases. here, the set of identifiable spacers is limited by the set of known repeats. a combination of the described strategies, named “targeted assembly of crispr cassettes”, first selects reads matched by known repeat sequences or predicted by a program , and then reassembles them into crispr cassettes
 <cit> . we compared our results with those produced by these two approaches on the human gut metagenomic data.

the crispr set identified by stern et al.
 <cit>  in raw hmp reads contains  <dig>  spacers,  <dig>  of which are unique. comparing these spacers with the spacer sets identified here, we found only  <dig> matches in our set of the hmp spacers  and  <dig> matches in the jpn set . no matches with spacers from the dg set were observed. the matched spacers comprise 3% and 4% of our unique spacers in the hmp and jpn sets, respectively, i.e., roughly the same fractions of the whole sets of unique spacers.

the fact that only few of the spacers from stern et al. <cit>  matched spacers identified here could be caused by two reasons: either these spacers or the respective cassettes were present in the hmp assembled contigs, but had been missed by our identification procedure, or the reads containing these spacers were not assembled in the contigs. to distinguish between these alternatives, we performed blastn search for unique spacers from the stern set against all assembled hmp contigs. most spacers  did not match contigs. the remaining spacers and the matching contigs were analyzed in more detail. as repeats identified by stern et al. were not available, we checked whether hmp contigs matched by the stern spacers contained repeats from the hmp repeat set  and/or known crispr repeats from crisprdb
 <cit> . with the exception of the contigs with three spacers that exactly matched hmp spacers identified here and twelve spacers with non-exact matches , none of contigs matched by the stern spacers contained repeats either from crisprdb or from our hmp repeat set. further, six spacers from the stern set matched hmp contigs with questionable  crispr cassettes, which had been predicted by only one or two algorithms due to a low level of repeat conservation and varying spacer lengths within a candidate cassette. this strongly suggests that we did not miss any considerable number of identifiable cassettes with spacers from the stern set while the false negative rate of our predictions given the available data is low. on the other hand, a considerable fraction of the stern spacers  matched hmp contigs without repeats or crispr cassettes predicted by either algorithm. given that the stern et al. <cit>  procedure relies on known repeats, these matches could be protospacers of those spacers.

the set of crispr cassettes identified in the hmp data by the targeted assembly approach contained  <dig> cassettes,  <dig> of which were found in gut samples
 <cit>  and we used the latter for further analysis. comparison of these data with the repeat sequences identified here yielded only four matches with repeats from the hmp set, originating in four different crispr cassettes. only  <dig> of hmp repeats identified by rho et al. <cit>  had matches in the assembled hmp contigs. these contigs did not pass our filters as they did not contain crispr cassettes identified by the three programs due, in particular, to short cassette length or degenerate repeats; neither they contained cas genes. as in the previous case, it shows that the rho cassettes absent in our set have been produced by reads that had not been assembled into contigs.

unfortunately, we could not make a universal comparison as the necessary data were not available – only spacers were provided in
 <cit>  and only repeats, in
 <cit> . still, this analysis shows that crispr cassettes identified by our approach are mostly novel and considerably different from crispr cassettes found in human gut microbiomes earlier, and hence the contig-based and read-based approaches produce complementary results. indeed, the read-based approach missed cassettes with new repeats, while the contig-based techniques missed cassette fragments in unassembled reads.

the number of crispr cassettes in individual metagenomes varied. no dependence between the number of identified cassettes or spacers and the average contig size or sample size could be observed ; however, the sequencing technologies and assembly algorithms could be responsible for the observed differences between the datasets. on the other hand, the number of identifiable crispr cassettes might reflect the major taxonomic breakdown of human gut microbiota and, indirectly, enterotypes of particular individuals
 <cit> .

taxonomy of metagenomic contigs containing crispr cassettes
to define the taxonomic origin of contigs containing the identified cassettes, a blastx-based procedure was used . the short length of metagenomic contigs combined with the propensity of cas genes to horizontal gene transfer makes taxonomic predictions for crispr-containing contigs difficult. we assigned the taxonomy at least at the domain level to  <dig> of  <dig> jpn cassettes ,  <dig> of  <dig> hmp cassettes , and  <dig> of  <dig> dg cassettes . the differences in the average fractions of crispr-containing contigs with assigned taxonomy reflect the average lengths of the contigs in the respective samples.

despite the fact that the total number of cassettes identified in the three studied metagenomes was considerably different, the prevalent taxa of contigs with crispr cassettes were similar in all three datasets . the largest fraction of contigs with assigned taxonomy belonged to firmicutes. we observed  <dig>   <dig>  and  <dig> contigs of the firmicutes origin in the jpn, hmp, and dg metagenomes, respectively, with the majority of them belonging to bacilli and clostridia. in the jpn sample,  <dig> contigs were observed in adults and  <dig>  in children.figure  <dig> 
taxonomy of crispr-containing contigs. the presented metagenomes are: jpn ; jpn, children only ; hmp ; dg . the abbreviation “nd” stands for “not determined”.



the second major group in the jpn metagenomic dataset was comprised of  <dig> contigs  from actinobacteria with a majority of them assigned to the bifidobacterium genus. contigs belonging to proteobacteria and bacteroidetes/chlorobii group comprised about 2% each. proteobacterial contigs were predominantly coming from enterobacteriaceae, in particular, from escherichia coli. for about 25% of jpn contigs, no strong evidence of any particular bacterial phylum was detected, so these contigs were generically assigned to bacteria . according to a previous analysis of the jpn metagenome
 <cit> , the major constituents in adults and children are different. crispr-containing metagenomic contigs originating from children were assigned to the same predominant taxa as the whole dataset, but the fraction of contigs assigned to actinobacteria was larger  .

as mentioned above, the largest fraction of hmp crispr-containing contigs  was assigned to firmicutes . 22% of hmp contigs showed a clear bacterial origin but could not be assigned to any particular phylum, while for 16% of contigs, the taxonomic origin could not be determined. a minority of crispr-containing contigs in the hmp metagenome originated in actinobacteria, bacteroidetes, and proteobacteria, together comprising less than 6%. in the dg metagenomic dataset, one cassette was assigned to bacteroidetes and one, to actinobacteria . no archaeal contigs containing crispr cassettes were observed in any human gut metagenome.

the taxonomy breakdown of the crispr-containing contigs slightly differs from that based on 16s rrna for the entire metagenomic datasets. according to 16s rrna, the major constituents of the jpn metagenome in adults and weaned children were always bacteroidetes followed by several firmicutes genera and the genus bifidobacterium. in the case of infants, representatives of bifidobacteriaceae and enterobacteriaceae were predominant
 <cit> . this does not agree with the prevalence of firmicutes crispr-containing contigs in the jpn metagenome. in hmp, the major fraction of the microbial diversity, according to 16s rrna, is comprised by firmicutes, followed by almost equal fractions assigned to bacteroidetes, actionobacteria and proteobacteria, i.e., it is very similar to the taxonomic diversity of crispr-containing contigs predicted in the hmp metagenome. in the dg metagenome, the majority of 16s rrna sequences were assigned to firmicutes and a smaller number, to actinobacteria
 <cit> . this breakdown generally matches the taxonomic breakdown of crispr-containing dg contigs with one exception: according to our data, one crispr-containing contig was assigned to bacteroidetes. probable reasons for these discrepancies might be biases in the estimation of the taxa abundance due to variability of the 16s rrna genes copy number ranging from  <dig> to  <dig> per bacterial genome
 <cit> , or varying crispr prevalence in different bacterial phyla.

crispr-castypes
functional crispr-cas immune systems consist of crispr cassettes and cas genes
 <cit> . we classified the identified systems according to repeat types and associated cas genes where possible. the latter were found in flanking sequences of  <dig> cassettes. in a large fraction of flanking sequences  the only identified cas gene was cas <dig> , a universal marker of all crispr-cas systems, hence not applicable for differentiating system types. among cassettes that could be classified according to characteristic cas genes,  <dig> were assigned to crispr-cas type i;  <dig> cassettes, to crispr-cas type iii; and  <dig> cassettes, to crispr-cas type ii. for  <dig> cassettes, the composition of associated cas genes was sufficient to assign subtypes .

crispr repeats may be divided into types based on sequence similarity and ability to form stable secondary structures
 <cit> . the repeat type is associated with certain cas genes, and hence the repeat sequence itself can be used as a classifying feature. recently, an automated classifier of crispr repeats – crisprmap – was published
 <cit> . crisprmap was designed for comprehensive classification of all known  crispr cassettes based entirely on the repeat properties . applying crisprmap to crispr repeats identified in the human gut microbiomes resulted in assignment of  <dig> unique repeat sequences corresponding to  <dig> cassettes to one of six superclasses  . the representatives of all six superclasses were found. superclasses f, e and d appeared to be the most populated ones. of note, these superclasses contain families with little sequence conservation
 <cit> . repeats from  <dig> cassettes were not assigned with any superclass label according to the crisprmap classification; however, for  <dig> of these, a crispr-cas type could be determined according to the composition of the associated cas locus
 <cit> . this suggests that these come from previously unknown crispr cassettes.

for  <dig> cassettes both classification labels could be assigned. for  <dig> cassettes the crispr-type assignments did not match the repeat-based classification . contradictions were observed for only three repeat superclasses . this may indicate that the existing correspondence between cas-gene composition and repeat types should be revised.

identification of protospacers
we compared each of three non-redundant spacer sets with the metagenome it originated from. in the jpn non-redundant set, we identified  <dig> reliable spacer-protospacer pairs . the observed protospacers corresponded to  <dig> different spacers  and originated from  <dig> unique metagenomic contigs. for two metagenomic contigs  the number of protospacers was remarkably high . these contigs clearly demonstrated a bacteriophage origin and were similar to bacillus phi29-like phages. for one spacer from the jpn spacer set, we detected  <dig> protospacers, all of them coming from contig regions corresponding to bifidobacterial transposase genes. for  <dig>  of non-redundant hmp spacers, we identified  <dig> spacer-protospacer pairs with protospacers coming from  <dig> different contigs. for the dg spacer set, no reliable spacer-protospacer pairs in the same metagenomic dataset were observed .

the comparison of the spacers with the nr collection of genbank yielded  <dig> spacer-protospacer pairs for the jpn spacer set, corresponding to  <dig> spacers . among these spacer-protospacer pairs, eleven matches were found in complete viral genomes. the detected protospacers corresponded to four different spacers and were located in genomes of phages infecting escherichia, salmonella, clostridium spp. and three unspecified enterobacteria . notably, one of these spacers had protospacers, all with four mismatches, in five different enterobacterial phages: enterobacteria phage vt2-sakai, enterobacteria phage sf <dig>  escherichia stx <dig> converting bacteriophage, stx <dig> converting phage ii, salmonella enterica bacteriophage se <dig>  this protospacer corresponded to the most conserved region in the lambda phage protein ea <dig> gene, occurring in all five enterobacterial phages. this may reflect a close evolutionary relationship of these sequences with the real source of the spacer, and, probably, this spacer might mediate crispr-dependent multiphage resistance against a group of enterobacterial bacteriophages .figure  <dig> 
the position of protospacer corresponding to the most conserved part of a protein related to the lambda phage
ea22
protein in six related enterophages.  nucleotide sequence alignment for spacer and identified protospacers.  amino acid sequence alignment for the respective protospacers. the protospacer position is shown by the black frame.



seven spacers coming from contigs with the same repeat sequence matched protospacers in two unclassified phages; six residing in the unidentified phage clone 2204_scaffold <dig>  and one, in the unidentified phage clone 2209_scaffold <dig> . both phages were isolated from human gut samples. four protospacers originating from those unclassified phages occurred in coding sequences assigned to hypothetical proteins, while three protospacers were located in intergenic regions.

three spacers matched protospacers in the complete genome of bifidobacterium longum subsp. infantis 157 f. remarkably, one of these protospacers was located in a gene encoding a putative phage tail protein , i.e., it originated from a prophage sequence. the remaining two bifidobacterial protospacers originated from genes encoding conserved hypothetical proteins. of note, the bifidobacterial protospacers corresponded to spacers from two crispr cassettes assigned to children.

the remaining three spacers for the jpn set matched protospacers of enterobacterial origin, residing in plasmids from escherichia coli, salmonella enterica and klebsiella pneumoniae. one of the enterobacterial protospacers matched a plasmid gene encoding replication protein a from the repfib replicon; another one matched a gene encoding a putative antirestriction protein, and the remaining protospacer corresponded to an intergenic region of various e.coli plasmids . summing up, the majority of jpn protospacers found in genbank sequences were of clear viral or plasmid origin.

only nine protospacers, corresponding to nine spacers, were found in the nr collection for the hmp spacer set . of five protospacers matching regions in the genome of faecalibacterium prausnitzi, two resided in intergenic regions, two corresponded to a gene annotated as the growth inhibitor protein, and the remaining protospacer matched cds of a hypothetical protein. three protospacers for hmp spacers matched sequences of uncultured organisms, clones lm0aba27zf12fm <dig> and vc1a546tr, both isolated from human gut samples. finally, the remaining protospacer corresponded to a hypothetical protein-coding gene in bifidobacterium longum subsp. longum.

no reliable protospacers were associated with the dg spacer set both in the same metagenomic dataset  and among viral sequences from genbank. the observed low number of matches with complete and partial phage genomes  probably reflects the fact that most of the viral space remains unexplored.

in order to estimate the significance of detected protospacers, we performed a similar search against the nr collection for simulated pseudospacers . for  <dig>  spacers simulating the jpn spacer set, we detected  <dig> hits  corresponding to ten pseudospacer-pseudoprotospacer pairs. unlike the real jpn spacers with identified protospacers, jpn pseudoprotospacers were mainly found in complete genomes of various bacterial taxa, corresponded to intergenic regions, and showed no tendency to match mobile elements or genes associated with prophages or viruses. based on this simulation, we posit that protospacers corresponding to spacers from crispr cassettes are not random matches obtained by chance and are indeed associated with defence against mobile elements such as viruses and plasmids. similar results were obtained for the hmp and dg spacer sets .

although short protospacer adjacent motifs  are considered to be a common feature of many diverse crispr systems
 <cit> , we could not detect any reliable pam motifs for the protospacers clustered by the repeats.

taxonomy of protospacer origin and compatibility with the crispr-cassette taxonomy
the taxonomy of crispr-containing metagenomic contigs can be determined relying on either flanking sequences or protospacers. when a metagenomic contig was assigned with both types of taxonomic labels, they were compared.

out of  <dig> crispr-containing contigs in the jpn metagenome,  <dig> had taxonomy status assigned by the flanking sequences,  <dig> contigs had taxonomic labels based on the protospacers and, seven had both types of taxonomic labels. five of them demonstrated a good concordance between the taxonomic labels, as the assignments agreed at least on the level of phyla. for two contigs with an uncertain flank-based assignment , the protospacer-based taxonomy was more specific .

out of  <dig> hmp contigs with crispr cassettes,  <dig> were assigned with taxonomic labels based on the taxonomy of cassette-flanking regions, and for six contigs the taxonomic assignment could be made according to protospacers. only three contigs had both taxonomic labels, and in all cases they were in a general agreement .

similarity of the spacer composition in the human gut microbiomes
a pair of adjacent spacers was observed in more than one metagenome, in the jpn and hmp datasets. the respective contigs overlapped by a region containing these two spacers and a short flanking sequence of 134 nt. according to the independently assigned taxonomic labels, both cassettes were of the same taxonomic origin, belonging to firmicutes.

in individual jpn metagenomes, the largest number of shared spacers was observed between crispr cassettes assigned to children, in particular, for the f2x-f2y and f2x-inm pairs . in three pairs , complete crispr cassettes with flanking sequences were shared. in almost all cases, shared spacers originated from crispr cassettes with identical direct repeats, the only exception being the f1t-f2w pair having one mismatch between the repeat sequences .figure  <dig> 
shared spacers between jpn individuals. each square stands for an individual metagenome . identifier for each individual, gender, age, the numbers of predicted cassettes and spacers are specified within the respective square. individuals with identifiers starting with ‘f’ belong to families , individuals with identifiers starting with ‘in’ are independent. numbers of shared spacers are shown on the edges connecting individuals; numbers of repeating spacers in the same individual are shown on the directed edges.



the number of spacers occurring in more than one individual  in the jpn metagenome was  <dig>  to check whether this is significantly more or less than expected at random, we applied a shuffling procedure. at that, we randomly replaced cassettes between individuals, so that the number of cassettes assigned to a given individual did not change. this procedure was applied  <dig>  times, and the number of shared spacers was calculated. the average number of shared spacers was  <dig>  and the distribution is shown in additional file
2: figure s <dig>  in all cases the number of shared spacers was larger than the observed one, indicating that the latter was significantly below the random expectation .

to estimate the crispr core, we considered the distribution of repeats among individual metagenomes. no universal or widely distributed repeat clusters  were detected . the overwhelming majority of repeat clusters  appeared to be highly specific and associated with only one particular individual. still,  <dig> repeat clusters were shared between at least two individual metagenomes. the most widely distributed repeat cluster was found in five different individuals . at that, four repeat clusters were found in individuals coming from different metagenomic datasets , i.e., geographically distant populations, indicating a possibility for a common crispr core in the human gut metagenomes. however, available data were insufficient to further address this problem.

spacer-protospacer co-occurrence in individual metagenomes
we then analyzed whether protospacers have a tendency to originate in the same individual metagenome as the spacers . we analyzed the combined human gut set that contained  <dig> individual metagenomes.  <dig>  of individuals had a majority of protospacers originating in other individual metagenomes. for  <dig>  of such individuals there was one particular individual metagenome that contained a large fraction of protospacers. the preference of spacers to have protospacers in the same individual metagenome was clearly observed in the f2y, inb and inr individuals, featuring a considerable number of spacer-protospacer pairs . no cross-matching pairs between siblings  were observed . surprisingly, we identified a large number of protospacers in the jpn dataset that corresponded to spacers originating from the hmp dataset, much more than in the hmp dataset itself. a possible explanation comes from the hmp metagenomic dna purification protocol: the procedure included filtering of a sample suspension through  <dig> um mesh nylon membrane
 <cit> . this procedure probably eliminated viral particles and subsequently viral sequences in the hmp metagenome, further leading to the relative scarcity of hmp protospacers for hmp spacers, compared to jpn protospacers. the fact that we observed many spacer-protospacer pairs in different individuals suggests that viruses associated with the human gut are to some extent universal, containing a fraction of ubiquitous viruses present in many individuals.

to check whether spacers and protospacers tend to co-occur, the cmh statistic was calculated for the real data and simulated data . the cmh value for the observed data was  <dig> , while the distribution of cmh statistic for the shuffled tables is shown in additional file
2: figure s <dig>  in the majority of cases the actual cmh statistic was larger than that calculated for the shuffled tables, , however, not reaching significance.

the observed lack of clear preference of spacers and protospacers to occur in the same individual suggests that crispr systems in most individual metagenomes are active and highly effective against bacteriophages. a similar observation was made earlier
 <cit> . on the other hand, in several studies focusing on crispr dynamics in human oral microbiomes
, protospacers for the respective spacers were more likely to be identified when the oral virome of the respective individual was also available. so, the observed scarcity of identified protospacers for the gut crispr spacers may be revised when individual gut viromes will be also available for comparison.

compared with the spacer-protospacer co-occurrence patterns in crispr systems from the ocean metagenome
 <cit> , the crispr composition of the human gut seems to be more homogeneous as some spacers happen to have protospacers in geographically distant populations. it is a likely consequence of the relatively larger stability and uniformity of environmental conditions in the human gut , compared to the physical and chemical characteristics of the ocean samples. the latter differ dramatically, so their crispr content does as well.

position of targeting spacers and shared spacers
positions of targeting spacers, i.e., spacers having protospacers in the same individual, are shifted to the leader end of a cassette   , whereas spacers shared between metagenomes of different individuals tended to be located close to the trailer end of a cassette  , and hence are older.figure  <dig> 
positions of functionally important spacers compared to positions of all spacers. targeting  and shared  spacers are presented. spacers in each cassette were enumerated. for each cassette, serial numbers of all targeting  spacers in the cassette were summarized, and then the obtained statistics was summarized for the whole set of cassettes . the plot shows the distribution of sums of serial numbers of targeting  spacers for the shuffled sets of cassettes  .



these observations agree with earlier reports about selected, experimentally studied systems. indeed, in response to the phage infection, streptococcus thermophillus alters its crispr loci by adding new spacer-repeat units to the leader end of the cassettes
 <cit> . further, reconstruction of crispr loci of an extremophilic archaeon, i-plasma, showed that the leader-end spacers are highly diverse while the trailer-end spacers tend to be clonal population-wide
 <cit> . the observed clonality of the trailer ends could be caused by consecutive selective sweeps that would homogenize crispr composition in a population, followed by differential addition of new spacers at the leader end.

CONCLUSIONS
we analyzed crispr systems in the metagenomic datasets of three human gut microbiomes. a detailed comparison with other studies
 <cit>  demonstrated complementarity of read-based and contig-based approaches — while many spacers remained in unassembled reads, our contig-based procedure could identify cassettes with new types of repeats and characterize the evolutionary dynamics of spacers within cassettes.

in all three metagenomes, the largest fraction of contigs with crispr cassettes was assigned to firmicutes. comparison of the identified spacers with the genbank nr collection and complete viral genomes yielded only few matches, revealing that the viral space remains largely unexplored. contrariwise, we found an appreciable number of spacers originating in the same metagenomic datasets. based on the implemented statistical analysis, we could not reject the hypothesis that the observed co-occurrence of spacers and their protospacers was generated by chance, and moreover a considerable fraction of spacers had protospacers originating in other gut metagenomic datasets.

on the other hand, the overlap in spacers between different human gut metagenomic samples was negligible. here we encounter an apparent paradox: a low spacer similarity between individuals versus a considerable number of spacer-protospacer pairs originating in different individuals. the absence of spacer-protospacer pairs in the same individual may result from high efficiency of crispr systems against viruses, i.e., fast elimination of the respective bacteriophage from the environment
 <cit> .

on the other hand, the occurrence of protospacers in other individuals suggests that there exists a common viral core inhabiting the human gut, and that this core may be shared between geographically distant populations. the extent to which crispr systems acquired resistance against these common viruses, i.e., the presence of spacers, may vary between individuals.

in comparison with crisprs in the ocean metagenome
 <cit> , the human gut appeared to be a more homogeneous environment as some spacers have protospacers in geographically distant populations. a possible explanation comes from the uniformity of environmental conditions in the human gut compared with different ocean samples . a broad range of physical and chemical conditions in the ocean results in variability of the microbial and phage composition, and, consequently, differences in the crispr content.

the contig-based approach allowed us to reconstruct the order of spacers in crispr cassettes. targeting spacers tend to be located closer to the leader end. as this is the site of addition of new spacers
 <cit> , this indicates a footprint of recent bacteriophage infections. vice versa, spacers shared between individual metagenomes tend to be located closer to the trailer-end of the cassettes, and hence represent a more ancient, common state of the crispr based immunity
 <cit> .

electronic supplementary material
additional file 1: table s1: characteristics of reliably predicted crispr cassettes. classification of adjacent cas genes, where possible, and crisprmap classification of repeat sequences are provided. background colors denote samples . 

 additional file 2: figure s1: crispr detection in relation to metagenome characteristics. vertical axes: numbers of identified cassettes  and spacers . horizontal axes: average contig length  and total contig length . each dot corresponds to an individual human gut metagenome: red dots represent dg individuals; blue dots, jpn individuals; green dots, hmp individuals. figure s <dig>  distribution of crispr-cas types in the identified cassettes. the classification is based on the cas-loci composition, see the text for details. figure s <dig>  distribution of the number of shared spacers between individuals for  <dig>  random permutations. the red dashed line shows the number of observed shared spacers. figure s <dig>  distribution of repeat clusters across individual metagenomes. figure s <dig>  distribution of the cmh statistic for independence of spacer and protospacer occurrences in individual metagenomes. the distributions are based on  <dig>  permutations of protospacers across individuals . the red dashed line shows the observed cmh statistic. 

 additional file 3: table s2: compatibility of the crisprmap classification of repeat sequences and the crispr-cas system classification of adjacent cas genes. inconsistent assignments are highlighted. 

 additional file 4: table s3: number of spacer-protospacer pairs per individual. columns – metagenomes containing spacers, rows – metagenomes containing protospacers; each cell shows the number of spacer-protospacer pairs originating in the respective metagenomes. background colors in the header columns and rows denote samples . cells have green background if the respective value is non-trivial  or grey background if the spacer and protospacer originate in the same sample. 

 additional file 5: figure s3: heatmap of the spacer-protospacer pairs distribution between individual metagenomes. colors reflect the numbers of detected pairs . 

 additional file 6: table s4: comparison of taxonomic labels assigned to crispr-containing contigs and respective protospacers for the jpn metagenome. column ‘protospacer’ shows the taxonomic label of the contig containing the respective protospacer; column ‘contig’ shows the taxonomic label of the contig containing the respective cassette. table s <dig>  comparison of taxonomic labels assigned to crispr-containing contigs and respective protospacers for the hmp metagenome. column ‘protospacer’ shows the taxonomic label of the contig containing the respective protospacer; column ‘contig’ shows the taxonomic label of the contig containing the respective cassette. table s <dig>  list of shared repeat clusters. all repeats observed in at least two individuals are listed. 

 abbreviations
bpbase pairs

cascrispr-associated

crisprclustered regularly interspaced short palindromic repeats

crrnacrispr rna

cmhcochran–mantel–haenszel test

dgdistal gut metagenomic project

gosglobal ocean sampling expedition

hmphuman microbiome project

jpnmetagenome of  <dig> healthy japanese individuals

nrnon-redundant

pamprotospacer-adjacent motif

vlpvirus-like particles.

competing interests

the authors declare that they have no competing interests.

authors’ contributions

aag carried out the analysis and drafted the manuscript. msg participated in the design and helped to draft the manuscript. iia conceived the study, participated in its design and coordination, and helped to draft the manuscript. all authors read and approved the final manuscript.

we thank prof. adam godzik and dr. iakov davydov for helpful suggestions. this work was partially supported by the russian foundation for basic research  and the russian academy of sciences .
