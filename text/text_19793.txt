BACKGROUND
the mallard  is the world's most abundant and well-studied waterfowl species. besides being an important game and agricultural species, it is also a flagship species in wetland conservation and restoration. waterfowl  and especially ducks are focal organisms in long distance dispersal of avian influenza in the wild  <cit> , and the mallard has been identified as the most likely species to transport this virus  <cit> .

as a general pattern, mallards breeding in temperate areas migrate from northern breeding grounds to more southerly wintering areas avoiding freezing conditions at breeding sites  <cit> . however, there are also non-migratory populations in europe and elsewhere. although some geographical patterns can be discerned from ringing recoveries on national levels, there is in europe no clear delineation of flyways, and only little knowledge about the overall population structure from a genetic perspective  <cit> . this is exactly the situation for which wink  <cit>  proposed the use of snps to study bird migration in a population genetic framework. since the number of snps necessary to detect low levels of differentiation is expected to be high  for highly mobile organisms  <cit> , we aimed at a high throughput discovery of snps in the mallard. large scale discovery of snps in the genome of the wild mallard might also provide a useful set of markers in the descendant, closely related domesticated duck . being the third most consumed species on the poultry market globally  <cit> , the domestic duck provides a valuable subject for detailed genomic studies. nevertheless, genomic information about the domestic duck is limited to a few studies providing only low resolution linkage and physical maps  <cit> . therefore our study also set out to facilitate duck breeding objectives by providing sufficient markers for improving the duck linkage map and allowing qtl mapping using snps.

a general limitation in developing a snp-set in non-model organisms has been the unavailability of extensive genomic sequence information from multiple individuals that represent a sufficient portion of the genetic variability of the population or species under study. however, the illumina sequencing technology  <cit>  coupled with the approach of generating a reduced representation library   <cit>  has proven an efficient approach in solving this problem in the turkey   <cit>  and great tit   <cit> . also in rainbow trout  <cit> , pig  <cit>  and cattle  <cit>  next generation sequencing of rrls has been effective in the identification of considerable numbers of snps.

here, we describe the discovery of more than  <dig>  novel snps in the genome of the mallard, which currently lacks a published sequenced genome. lacking this reference genome we initially aimed for paired-end sequencing on an illumina genome analyzer of an rrl of fragments in the size range of 110- <dig> base pairs  and with a read length of  <dig> bp. this would create an overlap between the forward and reverse dna sequence reads of continuous sequences, permitting the reads to be merged. this in turn helps in providing sufficient flanking sequence  of a snp which is a requirement for genotyping and is hard to retrieve in the absence of a reference genome. however, at the time when our study had started, genome sequencing of the domestic duck genome and de novo assembly was in progress and almost completed by the beijing genome institute . this allowed for snp discovery by next generation sequencing of an rrl of pooled wild mallard samples and mapping locations of almost  <dig> million of the resulting reads to a draft mallard reference sequence. identified snps were compared with those observed within the reference genome sequence of domestic duck  and est sequencing  resulting in more than  <dig>  shared high quality snps. a set of putative snps can contain large numbers of incorrectly inferred snps  and thus we also aimed to estimate the quality of our set. quality, here, is a measure of the reliability of the snp set. this includes not only the percentage of false snp inferences but also evaluation of the way in which these snps will be usable for many purposes; i.e., if they cover a large spectrum of minor allele frequencies, or if these were reliably inferred by our analyses .

RESULTS
complexity reduction
we targeted for a sequencing depth of about  <dig> times at limited sequencing cost by sequencing a fraction, representing 5% of the mallard genome  approach). restriction enzymes were screened for suitability for rrl construction, with the goal of a 20-fold complexity reduction of the mallard genome within the targeted size range of 110- <dig> bp. restriction enzyme analyses showed that these requirements are met by combining two rrls, one created by enzymatic digestion with alui and one by digestion with hhai, representing 4% and 1% of the mallard genome, respectively.

an in silico digest of the chicken genome, which is very similar  <cit> , predicts similar genome fractions of the rrls of  <dig> % for alui, but only  <dig> % for hhai . we prepared two pooled dna samples of nine wild mallard individuals from three locations across europe. to prepare the rrls, we digested these samples with alui or hhai and isolated fragments in the 110- <dig> bp size range from a preparative polyacrylamide gel. the genomic libraries were combined in the sequencing sample preparation procedure. due to a lack of a reference genome we aimed for paired-end sequencing on an illumina gaii of the combined rrls and a sequence read length of  <dig> bases. this created an overlap between the forward and reverse reads of a pair which allows merging of the reads. merging the reads helps in providing sufficient flanking sequence of a snp. this sequence is necessary for genotyping and is hard to retrieve in the absence of a reference genome. merged paired reads, possibly supplemented with single reads, are subsequently clustered for snp discovery.

illumina sequencing and snp detection
we generated  <dig>  million  <dig> bp reads using three sequencing lanes on an illumina gaii of which two lanes were run in paired-end mode. the raw data files from the sequencing instrument are deposited in the ncbi short read archive under accession number sra <dig>  it was shown that a phred quality score  <cit>  threshold of  <dig> ensures sufficient quality reads for snp detection purposes  <cit> . because the average base call quality score over all sequence reads dropped below  <dig> after read position  <dig>  reads were trimmed to  <dig> bp. after trimming, we performed additional quality score based filtering  and finally we retained  <dig>  million reads  of  <dig> bp length corresponding to a total of  <dig>  billion bp of sequence information . of these reads 35% were single and 65% were paired reads. by creating rrls 5%  of the mallard genome was represented . from this we calculated that the raw sequencing data cover the sequence target  <dig> times  whereas the quality filtered data provide a 16Ã— target coverage. using maq  <cit>   <dig> , <dig> of the reads could be mapped onto the mallard reference genome . a total of  <dig>  putative snps were identified by maq  <cit>  of which  <dig>  candidate snps passed our applied snp identification quality thresholds . this set of snps is further referred to as duck-rrl  and available in the dbsnp database under accession numbers ss <dig> - ss <dig> 

paired and single sequence reads remaining after filtering raw reads.

1raw sequences were filtered for length  <dig>  only reads without base-call errors  were considered. singly represented reads are required to have a per base-call quality of  <dig>  sequences more than four times overrepresented, based on the raw rrl coverage  were discarded.

snp usability
more than  <dig> % of the snps were flanked by at least  <dig> bp on either side and met the requirements for probe design constraints for all genotyping platforms whereas all snps met the flanking sequence requirements for an iselect  genotyping assay. for the  <dig>  snps that showed more than two alleles, we only considered the most frequently observed minor allele because tri- or tetra-allelic snps are very rare  <cit>  and it is likely that most other minor alleles represented sequencing errors instead of true sequence variants. analysis of the estimated allele counts of the snps in our dataset  showed that we obtained a majority of snps with a high minor allele count  of the real population data).

snp quality assessment
sequencing errors are more abundant in the tails of next generation sequencing reads and are thought to cause an excess of false snp predictions. an increase in the number of snps towards the end of the reads is expected if sequencing errors are the cause of a substantial number of predicted snps in the dataset. to validate our sequence filtering and snp detection constraints we plotted the distribution of the snps over the  <dig> positions in the sequence reads . positions one, two and  <dig> all show an underrepresentation of snps whereas positions three, four and five show an overrepresentation. snps are equally distributed over read positions  <dig> to  <dig> and at  <dig> the number of snps per nucleotide position drops but after this remains more or less stable until position  <dig> 

because of the length of the rrl fragments , there is an overlap between paired forward and reverse reads  from position  <dig> onwards. this overlap results in a higher sequence depth and a tiny increase in the number of snps being detected at these nucleotide positions .

we estimated the possible errors in snp calling due to sequencing errors by looking at transition  - c/t pyrimidine to pyrimidine or a/g purine to purine changes - versus transversion  ratios, which are all the four other possible pairs of changes. random mutations or sequence differences due to errors should give a ts:tv ratio of 1: <dig>  in reality, a bias due to a higher rate of c => t mutations due to the deamination of methylcytosines in cpg dinucleotides induce a much higher ts rate  <cit> . for instance in chicken, the ts:tv ratio is  <dig> : <dig>  based on the analysis of more than  <dig> million snps in the dbsnp database  <cit> . our results show that the number of a/g substitutions almost equalled the number of c/t substitutions in the transitions class. also the substitutions within the transversions class occurred in comparable frequencies . the ts:tv ratio for d-rrl was  <dig> : <dig> which is very similar to the  <dig> : <dig> ratio found in chicken.

 <dig> = the transitions total divided by the transversions total for a data subset.

the two transitions and four transversions are abbreviated by their nucleotide ambiguity codes r, y and m, w, s, k.

sequencing errors were also evaluated per read position by plotting the ts:tv ratio observed over the  <dig> positions in the sequence reads . we observed steady expected ts:tv ratios for positions 7- <dig> whereas ts:tv ratios for positions 1- <dig> were lower and the ts:tv ratios for position  <dig> was higher than expected.

snp benchmarking
the de novo assembly of the domestic duck genome by the beijing genome institute , covering both chromosomes of a single individual, resulted in the identification of  <dig> , <dig> putative snps . domestic duck est sequencing identified a total of  <dig>  snps  in protein coding regions of the genome .

to benchmark d-rrl we compared it with these two external and independent datasets and identified snps that are shared with either d-wgs or d-est. we observed  <dig>  snps  in common between d-rrl and snps in the d-wgs dataset. furthermore d-rrl had four snps in common with d-est whereas d-wgs shared  <dig> snps with d-est . only a single snp was shared between all three datasets. the subset of snps  that d-rrl shared with either of the two other snp resources is further referred to as d-shared. we analysed d-shared by calculating the macs and the ts:tv ratios . furthermore, we plotted the ts:tv ratio per read position and the distribution of the snps over the  <dig> nucleotides of the sequence reads in the same way as was done for d-rrl. in d-shared we observed a similar distribution of macs compared to d-rrl . the distribution of the snps in d-shared detected on read positions 7- <dig> is similar to that observed for d-rrl; however, d-shared shows a higher variation in the amount of snps between the read positions . also, ts:tv ratios at these read positions were similar with slightly more variation per read position in d-shared.

although reduced, also d-shared showed a peak of the snp distribution on read positions three to six, as we observed in d-rrl. however, ts:tv ratios for these positions were at the expected level of > <dig>  indicating that most snps in these read positions likely resulted from true nucleotide polymorphisms. finally, compared to d-rrl, the d-shared subset of snps showed a higher average ts:tv ratio of  <dig>  and indicated a relative increase of  over  transitions .

domesticated versus wild mallard
besides the identification of snps in wild mallards we also searched for nucleotide positions in the genome that show differences between the wild mallard population and the domesticated duck reference. we investigated nucleotides that where monomorphic within the wild mallard rrl consensus sequence data set but that differ from the corresponding non-polymorphic position in the domesticated duck reference. we identified  <dig>  such snps  and assessed the quality of this set of snps by plotting the ts:tv ratio per nucleotide position and plotting the distribution of the snps over the  <dig> nucleotide positions in the sequence reads . the distribution of snps predicted in the first six read positions showed a high peak whereas from position six to  <dig> the number of snps per read position was more or less constant, only slightly increasing towards the end. the ts:tv ratios were as expected except on the first six read positions and the end, where it was lower than expected. compared to d-rrl and d-shared the overall ts:tv ratio of d-between was lower, 2: <dig>  and showed a relative increase of  over  transitions .

the distribution of snps over the genome
knowing genomic positions of snps as genetic markers is important. many population genetic and genetic mapping applications rely on unlinked markers. thus, for future use in generating a mallard linkage map and performing qtl studies in domestic and wild mallard it is essential that the snps are widely distributed over the genome. the domestic duck genome assembly that we used as a genome reference consists of thousands of scaffolds and contigs which are not assigned to chromosomes. estimating the distribution of snps across this duck genome is therefore not possible using this sequenced reference. consequently, the closest related available genome sequence  was used for estimating the physical distribution of the identified snps. common and high quality mallard snps  were aligned to the chicken genome and the distribution of this snp-set was plotted over the chicken chromosomes . a total of  <dig>  snps could be mapped to unique locations evenly distributed over the chicken genome.

snp validation by genotyping
the d-shared subset of snps was validated by genotyping an animal panel consisting of  <dig> mallards using  <dig> predicted snps distributed uniformly over the chicken genome . a total of  <dig>  snps gave reliable genotypes in the assay, and  <dig>  of these were indeed proven to be polymorphic. the average minor allele frequency  was  <dig>  in the animals that made up the discovery panel and  <dig>  in the whole animal panel . the average heterozygosity was  <dig>  in the discovery panel and  <dig>  in the whole animal panel. the allele frequencies of polymorphic genotyped snps in the discovery pool showed a correlation of  <dig>  with those derived from the sequence data in the discovery pool of nine animals.

discussion
this snp study is the first large sequence variant discovery performed in mallards, as well as in any of the waterfowl. the availability of a large number of detected snps provides sufficient markers to study mallard population structure and migration in a population genetic framework. this large number of accurately inferred snps will also facilitate improved linkage maps of the mallard genome  <cit>  and provide a sufficiently dense marker map to allow high resolution qtl studies in the domestic duck, further facilitating duck breeding. furthermore, such high density linkage maps are essential for chromosomal assignment of the sequence scaffolds of the sequenced reference genome.

snp detection within a pool of wild european mallards
initially, our study was designed to detect snps within a pool of wild european mallards by single-end and paired-end sequencing of a small fragment rrl. we targeted for genome libraries of sufficiently small fragments for paired reads to overlap. this allows the reads to be merged resulting in the complete sequence of the majority of the fragments in the rrl. merged paired reads subsequently would serve as a reference genome. however, with the recent availability of a next generation sequenced domestic duck genome assembly, a reference based mapping approach became feasible, enabling a more efficient snp identification approach. our study shows that the overlap in generally lower-quality ends of paired-end sequence reads is beneficial in reference based snp detection. an observed drop in the number of predicted snps after position  <dig>  is explained by a drop in phred scores of the raw sequence data at exactly that position . subsequent filtering for quality scores eliminates more putative snps after read position  <dig>  however, accounting for this inherent quality issue in the raw data, we observed that the number of snps being predicted per read position shows a tiny increase in the overlapping ends of our mate pairs whereas earlier studies  <cit>  reported decreasing numbers of predicted snps per nucleotide position towards the end of sequence reads. the deamination of methylcytosines results in a thymine base. this reaction is especially frequent in cpg dinucleotides motifs, causing a much higher mutation rate from c to t than any other mutation type. as a consequence, ts:tv rations are much higher than expected, as for instance in chicken where it is  <dig> : <dig> instead of the 1: <dig> ratio expected if mutations were random. a similar 1: <dig> for ts:tv ratio would be found in sequences if base differences were due to sequencing errors rather than true polymorphism . the ts:tv ratio of snps we predicted in the overlapping ends of our sequences remains in the expected range  suggesting that these snps reflect true nucleotide polymorphisms. a local decrease in ts:tv ratio would be observed if snps in read positions  were caused by randomly introduced polymorphisms . thus we expect that the predicted snps represent true nucleotide polymorphisms. the increased number of snps at the overlapping ends can be explained by local higher sequence coverage, caused by sequence overlap of paired reads, resulting in a higher representation of dna sequence variants. a higher coverage allows for multiple observations of the variant in low quality sequences, allowing it to pass maq's quality thresholds to call it a true snp  <cit> . as a result, even more of the rare sequence variants in these overlaps will meet the minor allele occurrence constraint in our snp detection method. an indication that the additionally identified snps at the read ends involve rare sequence variants is the lower representation of these snps in d-shared.

ascertainment bias due to limited sequence depth
besides limited sequencing depth also sequence quality is a limiting factor for inferring snps. this is illustrated by the overall trend in the number of predicted snps per read position in d-rrl and d-shared , which mirror the decreasing trend of average base call score per nucleotide position inherently present in illumina sequencing . a similar trend is not observed in d-between because here the snps are predicted from differences between the reference and the discovery panel of wild mallards. read depth is less limiting in d-between because it is only used to provide one unambiguous  base, deviating from the reference, of sufficient quality whereas in d-rrl the read-depth has to provide sufficient base calls for both the major allele and the minor allele to be considered a snp.

besides the unequal distribution of identified snps over the read positions also the underrepresentation of snps with a mac < <dig>  is an indicator of a coverage limitation. due to the limited coverage, only snps that are present in multiple individuals in the discovery panel have a reasonable probability to meet the minor allele representation constraint set by our snp detection method. more common alleles will pass the representation constraint more frequently than rare alleles resulting in an overrepresentation of common alleles and an underrepresentation of rare alleles.

snp set quality assessment by comparison
we identified a large number of putative snps in the sequenced mallard discovery panel by sampling ~5% of the mallard genome. extrapolating the total number  of identified snps would result in a snp every ~ <dig> bp. the actual number of true snps in the sets d-rrl and d-between is expected to be lower considering the overrepresentation of predicted snps in the read positions one to six together with low ts:tv ratios in these read positions. also the comparison of d-rrl with d-wgs, in which common true variants remained and false snps were discarded, show that snps predicted in read positions one to six should be used cautiously. the distribution of d-shared does not show overrepresentation of snps on position one to six. furthermore, expected ts:tv ratios in d-shared were observed for positions three to six and expectedly lower ts:tv ratios in position one and two due to the rrl enzyme restriction motif. therefore we think that a considerable fraction of snps in read positions one to six in d-rrl and d-between are false positives. because standard sequencing error rates of the illumina gaii are low  in the first  <dig> bases of a read  <cit>  we expect that the first six bases in our sequence dataset were affected by non-standard, systematic, sequencing errors. these are most likely resulting from a combination of inadequate separation of sequencing clusters due to the restriction tag in the rrl and an overloaded sequencing flow cell . this hypothesis is supported by the fact that quality scores were considered by the snp inferring algorithm  <cit>  and that two observations of the minor allele were required for a putative snp making it unlikely that these numbers of false positives are due to standard sequencing errors. low ts:tv ratios for snps at read position  <dig> and  <dig> in d-between suggest that the snps from these positions should also be omitted. subtracting snps from positions one to six  results in  <dig>  snps in d-rrl and  <dig>  snps in d-between that will likely yield good success rates in genotyping.

shared snps
we showed that d-rrl shares one sixth of the snps with d-wgs and an almost negligible number of snps with d-est. ests only represent a few percent of the genome, of which only a fraction was sampled by the rrl. due to this limited shared genome fraction and because snps in protein coding regions are rarer than in non-coding regions, a large overlap in snps between these sources was not expected. between d-wgs and d-est we observed a  <dig>  times larger overlap, which can be explained by a more or less complete overlap in sampled genome fraction and a better representation of rare alleles in d-wgs. the relatively large overlap between d-wgs and d-rrl indicates a low genetic divergence between wild mallard and domestic duck. a relatively large fraction of shared snps between two independent studies also suggests a low false discovery rate. as stated earlier, the snps identified in this study will be used to study mallard population structure and movements in a population genetic framework  <cit> . because the required number of genetic markers for such an analysis is small compared to the total amount of markers we generated  <cit> , we selected snps from d-shared that show an equal distribution over the chicken genome. this requirement greatly reduces the number of available markers since only a small fraction could be mapped  due to the relatively large evolutionary divergence time between chicken and ducks  <cit> . genotyping of this snp subset confirmed the expectation that snps that are shared between independent snp detection studies yield a snp set of high quality.

CONCLUSIONS
when performing snp identification studies using next generation sequence technologies, it is important to know what limitations in sensitivity and specificity can be expected, particularly at low sequence coverage. we show that sensitivity decreases with decreasing base calling quality towards the ends of sequence reads which can be compensated for by increasing the sequence coverage in the ends. snp distribution and ts:tv ratio over read positions are helpful metrics for the assessment of systematic errors in the sequencing dataset in particular when statistics can be compared to a high quality subset of the data. we showed that the fairly large subset of predicted snps that is shared between independent snp detection studies in wild and domestic duck is likely to represent true snps, and suggests a low divergence between these forms.

we present for the first time a solid and scalable genotyping environment applicable to mallards and its domestic form. not only do we provide over  <dig>  most reliable snp markers that can be used in duck breeding and molecular genetics, we also evaluate a sub-set of  <dig> snps for use in ecological genetics. the power of this set combined with relatively low genotyping costs through down-scaling of the marker set will allow long needed studies into the molecular ecology of mallards with regard to various relevant topics, including the study of genetic variation and genetic structure, resolution of unresolved ambiguities of mallard migration systems or inference of both small and large scale movement patterns.

