BACKGROUND
metabolic engineering has emerged as an important field aimed to improve cellular production of valuable biochemicals and biofuels. conventional approaches in metabolic engineering for identifying targets for manipulation focus on metabolic branch points, where undesired reactions are eliminated from competing branches to enhance flux through desired reactions using genetic modifications. however, these metabolic network modifications will not only affect fluxes through local metabolic pathways, but also have system-level effects on metabolic behavior due to changes in carbon, energy, and electron flow. correspondingly, such conventional approaches may fail to identify modifications in distant pathways that can potentially improve cellular production.

computational models of metabolism have been successful in predicting the consequences of gene deletions at a systems level  <cit> . in escherichia coli, genome-scale models of metabolic networks have been used to identify metabolic engineering strategies such as gene deletions or additions to maximize production of primary or secondary metabolites  <cit> . some computational methods, such as optknock  <cit> , identify knockout strains that would have improved biochemical production capabilities after undergoing adaptive evolution. knockout mutants that force the coupling between biomass and biochemical production allow one to use growth rate as a selective pressure and find adaptively evolved strains with improved growth rates and production capabilities. such methods have been used to generate lactate and succinate producing strains  <cit> . a number of variations on optknock have appeared recently which use alternative search algorthims, add non-native pathways, and consider deviations from wildtype flux levels  <cit> .

computational strain design methods evaluate the effects of gene or reaction deletions to search for the mutants with improved production capabilities. a gene deletion is simulated by removing the reactions associated with the target gene from the metabolic networks; however, most current methods are often based on reaction deletions, and not gene deletions. however, genes and reactions do not always have a one-to-one relationship due to the presence of multi-functional enzymes, enzyme subunits, orphan reactions, and isozymes. thus, knockout mutants based on reaction deletions can sometimes be genetically impossible or difficult to construct. also, existing methods do not take into consideration the transcriptional regulatory networks that control metabolism. as a result, predicted strains with high production capabilities may not be able to grow initially or evolve to the desired final state due to regulatory restrictions.

in this study, we present a new optimization approach, optorf, to identify metabolic engineering strategies based on a minimal number of metabolic and transcription factor gene deletions and metabolic gene overexpression, which couple biomass and biochemical production. here, gene to protein to reaction  associations are modeled directly using a boolean approach and reactions are removed when the associated genes are deleted. interactions between the regulatory and metabolic networks are also modeled using boolean approaches by turning on or off metabolic gene expression in response to transcriptional factor  status. these boolean relationships can be effectively formulated as linear constraints using binary variables and matrices, which are more systematic and/or computationally efficient than previously suggested formulations for modeling gpr associations and integrating metabolic and regulatory models  <cit> .

the integrated model of metabolism and regulation can predict the steady-state metabolic flux distributions and regulatory states simultaneously. consequently, the optorf framework allows for the identification of optimal metabolic gene knockouts as well as transcription factor knockouts. in addition, overexpression of genes that are unexpressed under a given condition can be found in order to improve the production of a target biochemical. using genome-scale metabolic and regulatory models of e. coli  <cit> , we have identified metabolic engineering strategies for ethanol production using optknock  and compared these strategies to those found using our new approach optorf  with and without transcriptional regulatory constraints. our analysis showed that the strategies based on reaction deletions often require a larger number of gene deletions, and also many of them result in lethal growth phenotypes when transcriptional regulation is considered. in addition, we have identified metabolic engineering strategies for overproduction of higher alcohols such as isobutanol via non-fermentative pathways based on a recent study  <cit> . while ethanol and higher alcohol production in e. coli is evaluated here, the optorf approach can be easily applied to other biochemicals and microorganisms.

methods
optorf is a bi-level optimization problem which identifies the optimal metabolic and regulatory gene deletions as well as gene overexpressions that maximize biochemical production at the maximum cellular growth under transcriptional regulatory constraints . the inner problem of optorf, which is a linear programming  problem, maximizes growth under the given gene deletions and regulatory states that are determined by the constraints of the outer problem. optorf is formulated as a single level mixed integer linear program  by replacing the inner maximization problem with its optimality conditions as constraints. gpr associations and transcriptional regulatory constraints are systematically formulated using three dimensional arrays, which differ from recently reported approaches  <cit> .

an example of an integrated metabolic and transcriptional regulatory network is shown in figure  <dig>  in this network, a substrate  can be utilized to produce biomass  via either intermediate metabolite i <dig> and/or i <dig>  reaction r <dig> converts i <dig> into by-product p <dig> and  <dig>  b, whereas reaction r <dig> converts i <dig> into by-product p <dig> and  <dig>  b. reaction r <dig> is carried out by enzyme e <dig> which consists of two subunits encoded by gene g1a and g1b. reaction r <dig> can be carried out by either enzyme e <dig> or e <dig>  which are encoded by genes g <dig> and g <dig> respectively. transcription factor tf <dig> is active when s is present, and activates expression of g <dig> and g <dig>  and represses g1a expression .

since the cellular objective is maximizing biomass production  from substrate , pathways involving r <dig>  would be normally preferred to ones involving r <dig> . given an engineering objective of producting p <dig>  close inspection of the reaction network indicates that removal of reactions r <dig> and r <dig> or reaction r <dig> would couple maximum biomass production to production of p <dig> instead of p <dig>  optorf will identify genetic modification strategies involving gene deletions that are associated with these reactions . however, g1a expression is inhibited by tf <dig>  and tf <dig> is active in the presence of s, and thus reaction r <dig> cannot happen. therefore, optorf will also identify the overexpression of g1a along with the gene deletions mentioned above. an alternate strategy to the overexpression of g1a would be the deletion of tf <dig> which inhibits expression of g1a. in fact, when tf <dig> is deleted, the genes activated by tf <dig>  would be no longer expressed, which reduces the number of genes that are needed to be deleted. therefore, optorf will first identify double knockout strategies including the tf <dig> deletion, and then find the alternate strategies with the g1a overexpression .

gpr association
constraints for gpr associations are systematically formulated using a three dimensional array ) and binary variables for reaction , enzyme , and gene  status, where j, n, and g specify a reaction, enzyme, and gene, respectively. each reaction with a known gpr association  can be carried out by the associated enzyme complex ), and each enzyme complex is associated to gene products ), where jgpr, n, g are defined as the following:  

if any of the enzymes for reaction j are present  = 1), the reaction can have a non-zero flux  where dj indicates whether a reaction can or cannot occur. if all the enzymes are not present  = 0), then the reaction cannot occur . this reaction-enzyme logical relationship can be formulated as the following:      

if all of the associated genes for enzyme n are expressed  = 1), then the enzyme is present . if any of the subunits are not expressed  = 0), then the enzyme is not present . this enzyme-gene logical relationship can be formulated as the following:      

reactions without known gpr associations are not constrained by these gpr rules.

transcriptional regulation
transcriptional regulation of metabolic genes are also formulated as linear constraints using a three dimensional array ) and binary variables for gene expression/transcription factor  activity , condition , and effector status , where m specifies a condition for gene expression/tf activity and r affects these conditions . effectors  can be tfs, flux values, and environmental conditions. the sets that are used in the formulation are defined as follows:  

each metabolic gene, g ∈ gmet, is transcribed if the conditions for its expression, m, are satisfied. if any of the conditions for gene g expression is satisfied  = 1), the corresponding gene is expressed . if none of the conditions for expression are satisfied  = 0), then the gene is not expressed . similarly, each transcription factor, g ∈ gtf, is active  if any of the conditions for its activity is satisfied. if none of the conditions for activity are satisfied, then the transcription factor is inactive . then, the binary variables for tf activity  are used to constrain the binary variables for tf effectors  which determine the conditions for metabolic gene expressions or other tf activities.         

each condition for gene expression or transcription factor activity, m, has its associated effectors, r. if all the associated activators are active  and repressors are inactive , then the condition for gene expression or transcription factor activity is satisfied . if any of the activators are inactive  or repressors are active , the condition for gene expression or transcription factor activity is not satisfied .         

each effector, r, can be a transcription factor , positive metabolic flux , negative metabolic flux , or other environmental stimuli . intracellular and extracellular stimuli are reflected by the positive or negative metabolic flux indicators by constraints, where intracellular stimuli are dependent on the flux values  of internal reactions and extracellular stimuli are dependent on the flux values of exchange reactions . a threshold value  is used to determine whether the flux is positive  or negative  as the following:            

the constraints including 'if' indicators were implemented directly using the gams/cplex indicator constraint facility instead of the big m method. other environmental stimuli  such as oxidative stress or high osmolarity were assumed to be absent in this study.   

gene deletion and overexpression
a gene deletion or overexpression is implemented by introducing gene knockout indicators , gene overexpression indicators  and surrogate gene expression indicators () as the following:         

the gene knockout indicator allows an expressed gene  to be unexpressed , and the gene overexpression indicator allows a repressed gene  to be expressed . if an expressed gene is deleted , the value of its surrogate gene expression indicator is equal to zero . if a gene is not expressed , then the surrogate gene expression indicator assumes a value of zero  and no gene knockout is allowed . if a repressed gene is overexpressed , its surrogate gene expression indicator takes a value of  <dig> . no overexpression is allowed if a gene is already expressed , and the surrogate gene expression indicator assumes a value of  <dig> . a gene can be either deleted or overexpressed, but not both at the same time. similarly, a transcription factor deletion is implemented by allowing an active tf  to be deleted . however, the variables wg are not introduced for all tfs to prevent an inactive tf from being active. the total numbers of gene deletions and overexpressions are limited to desired values, k <dig> and k <dig>  respectively.      

then, instead of the gene expression/tf activity indicators, the surrogate gene expression/tf activity indicators are used to determine the enzyme/tf status and thus reaction states via gpr associations and transcriptional regulation by equations - which replace equations ,, and .         

optimality condition
the bi-level optimization problem can be formulated as an milp using the strong duality theorem in the similar way as described in optknock  <cit> . here, a general procedure to construct the optimality conditions for the inner lp problem is presented without using large bounds for primal and dual variables. the objective function and simulated conditions are specified using a linear combination of fluxes () and lower bounds for each flux (), respectively. the primal lp  is formulated as follows:           

the reversible reactions  are only constrained by the mass balance equation, and associated with these constraints are unconstrained dual variables . the uptake, secretion, or irreversible reactions are additionally constrained by the lower bounds (), and associated with these constraints are positive dual variables . the reactions removed by gene knockouts are constrained to zero by using binary variables , and associated with these constraints are unconstrained dual variables . the dual lp  is formulated as follows.              

at optimality, the values of the objective functions in  and  are equal, and primal and dual variables satisfy the constraints of  and , respectively. the following optimality conditions for the inner problem are always satisfied as the values of all binary variables  are fixed to  <dig> or  <dig>  the inner problem can be written as:   

in this study, we used the biomass formation as the objective function of inner problem . the constraints including 'if' indicators are implemented directly using the gams/cplex indicator constraint facility. we also constrained the dual variables for reaction removal  to be within a small range  in order to reduce the solution time .

optorf formulation
the objective function in the outer problem of optorf formulation is a linear combination of fluxes with penalty terms for the total number of gene deletions or overexpressions (). the first term defines biochemical production of interest, the second term applies a weighted penalty  to an additional gene deletion, and the third applies a penalty  to an additional overexpression. in other words, the biochemical production rate should increase at least by α or β if an additional gene is deleted or overexpressed, respectively. these penalty terms can be very useful for eliminating strains needing more genetic modifications if the improvement in production is small. when α or β is a very small value , it effectively eliminates unnecessary modifications from the solution without affecting the optimal biochemical production. for example, if deleting gene a results in the same product yield as deleting gene a and b , then the gene b deletion would not appear in the optimal solution.

if multiple solutions are desired, integer cuts constrain successive optimal solutions with a parameter , which is the number of differences in genes among identified strategies. a previously identified solution  is comprised of a set of gene deletions and overpressions that are stored in parameters  and , respectively. if δ is set to  <dig>  integer cuts prevent optorf from finding the same solution as the previous ones. one may set δ to a higher value in order to obtain a more diverse set of metabolic engineering strategies. in this study, we used α = 10- <dig>  β = 10- <dig>  and δ =  <dig>  the complete optorf algorithm is defined by the following equations:     

models and simulation conditions
in this study, we have implemented an integrated model of metabolism and regulation for e. coli, imc <dig> v <dig>  <cit> , which consists of  <dig> metabolic genes and  <dig> tfs. there was one transcription factor, glnl, that was included in the original model but was missing regulatory targets. glnl should affect glng activity, but instead glng activity is independent of glnl >2)). however, this missing regulatory interaction would not affect the results of this study as glng is not active under these conditions and was not identified as a strategy for improving production of the alcohols examined here. in the optknock simulations, we excluded transport reactions for acetate, carbon dioxide, formate, phosphate, and water from consideration as eliminating transport may be challenging. in addition, atp synthase deletion was excluded from consideration since the deletion resulted in a high variability in ethanol production at the predicted optimal growth condition. equivantly, the deletion of foca, focb, and atp operon were excluded from the optorf simulations. the optorf approach was applied to identify metabolic engineering strategies for overproduction of ethanol or higher alcohols  in glucose minimal media. maximum glucose uptake rate  and oxygen uptake rate  are specified in order to simulate anaerobic growth conditions   <cit> . a minimal growth rate was set to  <dig>  hr- <dig> for all simulations. the optimization problems were solved using cplex  <dig>  accessed via the general algebraic modeling system .

RESULTS
we identified metabolic engineering strategies for ethanol production in e. coli using the optorf formulation with an integrated model of metabolism and regulation, and compared the resulting strategies to ones using a previous approach based on reaction deletions . first, a set of reaction deletion strategies was obtained using optknock, and then a corresponding set of gene deletions needed to remove the reactions in each optknock strategy was identified. these optknock gene deletion designs were then compared to the gene deletion strategies found by optorf without considering transcriptional regulation to examine the differences between the reaction-based strategies and gene-based strategies. to investigate how transcriptional regulation affects adaptive evolution of microbial strains, we analyzed available data for adaptively evolved e. coli mutant strains using the integrated metabolic and regulatory model. optknock strategies were then re-analyzed using an integrated metabolic and regulatory model and compared to the optorf strategies identified when transcriptional regulatory constraints were considered. finally, we present metabolic engineering strategies for overproducing ethanol or higher alcohols in e. coli that include both metabolic gene deletions and overexpressions, as well as transcription factor deletions, using our developed approach.

reaction deletion vs. gene deletion
in this section, we compare reaction-based deletions to gene-based deletions and describe how the optknock and optorf approaches differ in the strategies they identify. in most cases, the relationship between genes, proteins, and reactions is not one-to-one. a metabolic reaction can be carried out by one or more enzymes, each of which can be comprised of multiple gene products. an enzyme can catalyze multiple reactions that utilize different substrates, and different enzymes may catalyze the same reaction. consequently, removal of a reaction may require deletion of multiple genes and may accompany the removal of additional reactions, which can result in a different metabolic solution space from the one predicted when reactions can be removed individually. figure  <dig> shows an example, where different outcomes are found for reaction deletions and gene deletions. there are two transketolases  in e. coli each of which catalyzes two reactions  in the pentose phosphate pathway. by removing tkt <dig> reaction along with phosphotransacetylase reaction , ethanol production can be coupled to cellular growth at an improved production rate. however, deletion of the two genes  needed to remove the tkt <dig> reaction results in a lethal growth phenotype  <cit> , which is correctly predicted by the model since tkt <dig> would also be eliminated. this illustrates how the coupling of cellular growth and biochemical production by reaction-based strategies may no longer occur when the necessary genes are deleted. moreover, if the reaction that needs to be removed happens spontaneously or does not have known gene associated to it, there is no practical way to genetically engineer the cells.

the number of genetic manipulations needed is an important factor when evaluating metabolic engineering strategies. when isozymes are present, a strategy with the minimum number of reaction deletions does not necessarily correspond to a strategy with the minimum number of gene deletions. for example, there are four gene products in e. coli known to function as serine deaminases. in order to completely remove this particular metabolic reaction from the system, one would have to knockout all four genes. if removal of an alternative reaction would serve the same purpose, but require fewer gene deletions, then optorf would identify the simpler genetic strategy while reaction-based frameworks would not be able to distinguish between them.

we have analyzed the top  <dig> ethanol producing strains found by optknock for each double, triple, quadruple, and quintuple reaction deletion . figure 3a shows the minimum number of gene deletions required to remove the identified set of reactions for each case. on average, we found that two more gene deletions would be required than the number of reaction deletions to completely eliminate the reactions suggested by optknock from the network . the identified set of necessary gene deletions also resulted in removal of additional reactions  in most of the cases , sometimes resulting in lethal growth phenotypes . for each optknock strategy found, we identified another strategy requiring the same number of gene deletions using optorf without transcriptional regulatory constraints . this gave us metabolic gene deletion strategies that can be compared to ones identified by optknock. as shown in figure 3b, the ethanol yields for optorf designed strains were higher than the yields for optknock strains, and all optorf strains were capable of growing .

from a computational point of view, gene deletions can be more advantageous than reaction deletions due to the nature of combinatorial optimization. the difficulty of solving such an optimization problem increases exponentially with the total number of decision variables, i.e., reactions or genes to choose from. generally, the total number of reactions are larger than the total number of genes in available genome-scale models. for example, the most recent metabolic reconstruction of e. coli k- <dig> mg <dig>  <cit>  includes  <dig>  reactions, but only  <dig>  orfs are accounted for. although optorf requires a number of binary variables for genes, proteins, and regulatory rules, these are very tightly constrained by the gpr association and transcriptional regulatory constraints. as a result, the computation time to solve an optorf problem is comparable to the time to solve an optknock problem.

adaptive evolution and transcriptional regulation
transcriptional regulation plays a significant role in controlling the expression of metabolic genes thereby affecting flux through metabolic reactions. these regulatory effects have not been directly considered in previous strain design approaches. transcription factors not only affect metabolic flux distributions by controlling gene expression, but they also sense and respond to metabolic or environmental changes. integrating transcriptional regulatory networks with metabolic networks requires the connection between genes and reactions. we have effectively formulated these transcriptional regulatory and gene to protein to reaction  logical relationships, which enables us to predict the effects of transcription factor deletions as well as metabolic gene deletions on transcription regulation and metabolism, simultaneously.

metabolic engineering strategies described in this work are based on the assumption that microbial cells would evolve to have higher growth rates, and that biochemical production would increase along with cellular growth rate, the latter being the selective pressure during adaptive evolutionary experiments. an important question that one might ask is how malleable the transcriptional regulatory network is during adaptive evolution. if cells can easily rewire their transcriptional networks to gain higher fitness, it is possible that knockout strains could lose the coupling of biochemical production and growth, if expressing unexpressed genes leads to a higher growth rate without a higher biochemical production. to address this issue, we have analyzed available data for adaptively evolved strains of e. coli, and compared the data to predictions using the integrated model of metabolism and regulation.

first, previously experimentally implemented e. coli strains designed for lactate production  <cit>  were re-assessed using the integrated metabolic and regulatory models. figure 4a and 4b show the possible lactate and biomass yields for ΔptaΔadhe and ΔptaΔpfk strains predicted by the metabolic model  and integrated metabolic and regulatory model . the experimental observations for lactate yields and biomass yields during  <dig> days of adaptive evolution are also shown. all the deletions were simulated based on gene deletions and not reaction deletions, and yields were plotted to normalize the fluxes to changes in glucose uptake rate which occured during adaptive evolution. the ΔptaΔadhe strain is only predicted to produce more lactate with increased growth by the integrated metabolic and regulatory model, while no coupling between lactate production and growth is predicted by either model for the ΔptaΔpfk strain. experimentally observed trajectories for ΔptaΔadhe strain move towards the optimal point predicted only by the integrated metabolic and regulatory model , while the ΔptaΔpfk strain does not exhibit improved lactate production in agreement with both models .

metabolic gene deletion strains have also been evolved on different carbon sources  <cit> . we have analyzed growth phenotypes for these strains using the metabolic model and integrated metabolic and regulatory models, and found that only the strains grown on malate showed a significant difference in predicted growth rates between the regulated and un-regulated models. figure 4c shows the experimentally observed growth rates relative to the predictions for mutant strains grown on malate at the end of adaptive evolution . mutant strains seem to evolve and increase their growth rates to the optimal values predicted by the integrated model, but do not reach the values predicted by the metabolic model alone. the only strain that did exceed the integrated metabolic and regulatory model predictions, Δzwf, also had large experimental standard deviations in the observed growth rates. based on these results, it is possible that cells undergoing adaptive evolution do not significantly rewire their transcriptional regulatory networks, and therefore regulation should be considered in the design of production strains.

another advantage of using an integrated model of metabolism and regulation emerges when it comes to predicting essential genes. an integrated model is better at predicting essential genes under a given condition, and hence more likely prevents gene deletions which are lethal from being included in the strategies. it was previously shown that an integrated model of e. coli correctly predicts the growth phenotypes for  <dig>   of the total  <dig>  cases , while a metabolic model alone predicts  <dig>   cases correctly  <cit> . an integrated model is also capable of predicting essential transcription factors  as well as metabolic genes in e. coli  <cit> . accordingly, strains that are designed with regulatory considerations should grow better initially and may achieve the desired phenotype faster.

metabolic model vs. integrated model
the ethanol producing strains identified in the first result section were re-analyzed using the integrated metabolic and regulatory model to demonstrate the differences from using the metabolic model. when we re-calculated the production rates and growth rates for the  <dig> previously identified optknock strains after imposing regulatory constraints, we found that ethanol production was significantly lower for most strains . this is attributed to the fact that some of the regulated enzymes are not being expressed according to the transcriptional regulatory constraints. for each optknock strain we subsequently identified the minimum number of genes that need to be overexpressed to achieve the same ethanol yields when regulatory affects are not considered . in other words, we found the sets of genes which are down-regulated by transcriptional regulation, but are necessary to achieve the same growth and ethanol production rates as shown in figure  <dig>  without overexpression of these genes, the ethanol yields of optknock strains were much lower than the yields of optorf strains identified when regulatory effects are considered in the strain design process . also, the number of lethal growth phenotypes for optknock strains were much higher when regulation is accounted for  implying that these strains would not be able to grow, at least initially , and would possibly be difficult to construct. interestingly, optorf strains exhibit a sharp increase in growth and ethanol yields between  <dig> and  <dig> gene deletion strategies. this is due to the expression of genes involved in the entner-doudoroff pathway, and this pattern was not observed in figure 3b and 3c when regulatory interactions were not considered in the design of optorf strains.

finally, the strain designs identified by optknock , optorf without regulatory constraints , and optorf with regulatory constraints  were compared to identify common genetic strategies. figure 6a shows the list of commonly found gene deletions for different approaches and their frequency. among the top  <dig> strategies found by each approach , genes that appear in at least 15% of the total  <dig> strategies are listed. overall, deletion of pyruvate formate-lyase  was the most frequent for all of the approaches. deletion of phosphoenolpyruvate:sugar phosphotransferase system  was mainly found in approaches without transcriptional regulation, while the two transcription factor deletions  are identified only by optorf when transcriptional regulation is accounted for. deletion of pgi or tpia was evenly distributed across all methods, indicating that one of them is typically necessary to couple growth to ethanol production .

for each of the three approaches, we generated a heat map based on the correlation coefficients between the genes that appear in at least 10% of their corresponding  <dig> strategies . if a pair of gene deletions always appears in strategies together, the corresponding cell in the heat map is colored in yellow. a cell is colored in black when a pair of gene deletions are anti-correlated. for example, pta and eutd appear together since the deletion of both is required to eliminate the phosphate acetyltransferase activity, while either fnr or arca appears since the deletion of either transcription factor results in a similar phenotype. the pattern of correlation becomes clearer  as the structure of the model gets simpler from a gene-based deletion with transcriptional regulation  to reaction-based deletion without transcriptional regulation . this indicates that as models account for the complex structure and interactions of networks, more diverse metabolic engineering strategies can be identified.

strain designs for ethanol production by optorf
we have employed optorf to identify metabolic engineering strategies for ethanol production in e. coli. strains are designed to grow on glucose minimal media in anaerobic conditions. notable differences from the previously reported strain designs  <cit>  are that these strategies include the deletion of transcription factors  and electron transport chain components  as well as overexpression of metabolic genes . we have identified a set of strategies consisting of only gene deletions , and another set of strategies that also include overexpression of genes . it should be noted that the deletion of lactate dehydrogenase  is not required in the presented strategies because ethanol production is preferred over lactate production at the optimal growth condition, and so deletion of ldh would not be required. lactate could be produced initially when cells are growing sub-optimally , but lactate production would be predicted to decrease as cells adaptively evolve to higher growth rates, which favor ethanol production due to differences in redox requirements .

the predicted ethanol yields and growth rates are listed for two-deletion strategies and five-deletion strategies. three or four deletion strategies are not shown because the ethanol yield was not significantly improved over two deletion strategies. the variability in ethanol yield at the predicted maximum growth rate was zero or very small  for all cases. the ethanol yield is reported as % of the maximum theoretical yield . maximum glucose uptake rate of  <dig>  mmol/gdw/hr was used to simulate anaerobic growth conditions.

in addition to gene deletions, overexpressed genes are identified to further improve ethanol production. the maximum number of overexpressed genes was limited to two for all cases, and strategies including less than four gene deletions are not shown due to the negligible increase in ethanol yields by gene overexpression.

deletion of fnr or arca is found in most strain designs, where some enzymes involved in aerobic metabolism  can be advantageous for ethanol production. aerobic genes in central metabolism that are repressed by these anaerobic regulators include aceab, aceef, lpd, mdh, sucab, and sdhabcd. the de-repression of malate dehydrogenase  was predicted to be especially important based on comparisons between flux distributions with and without mdh. if necessary, such repressed genes may be overexpressed, as an alternative to deleting fnr or arca to ensure that metabolic activity is high enough to achieve the desired level of ethanol production.

genes involved in the electron transfer chain were also identified as needing to be deleted to limit the amount of nadh oxidized by this pathway. nadh:ubiquinone oxidoreductase  i and ii catalyze the transfer of electrons from nadh to the quinone pool, and the electrons are passed to fumarate by fumarate reductase , an essential enzyme for anaerobic growth. optorf identified the deletion of ndh- <dig> , the predominant ndh under anaerobic conditions, to block electron transfer from nadh to fumarate. as a result, the model predicts a decrease in frd flux and reduced succinate production in ndh- <dig> deficient strains, while flux through fumarase and malic enzyme is increased.

deletion of pgi was also found in many of the strain designs for ethanol production, suggesting re-direction of flux through glycolysis to the pentose phosphate  pathway or entner-doudoroff  pathway. this increases generation of nadph whose electrons are passed to nad via nadh transhydrogenase, and the additional nadh is used to reduce acetyl-coa to ethanol by alcohol dehydrogenase . while increasing the amount of nadh available to produce ethanol, the pgi deletion also lowers the net atp production and thus decreases growth rate as compared to the wild-type strain. the ed pathway consists of two enzymes, edd and eda, and the expression of edd is repressed by the transcription factor gntr. deletion of gntr would de-repress the expression of edd, which allows for the conversion of glucose to pyruvate and glyceraldehyde-3-phosphate. equivalently, overexpression of edd was identified as an alternative to deletion of gntr. the activation of the ed pathway in a pgi mutant also leads to a significant increase in growth rate, which would be favorable for industrial-scale ethanol production.

there are three enzymes, pflab, pflcd and tdce, which possibly function as pyruvate formate-lyase . the regulatory model indicates that expression of pfld requires either arca or fnr as activators, and a previous study showed that pfl activity was still detected in pfla or pflb mutant  <cit> . another study revealed that a fnr deletion alone is sufficient to decrease pfl activity down to the level of ΔfnrΔarca strain, while an arca deletion alone did not decrease pfl activity  <cit> . thus, deletion of fnr, pflb, and tdce would abolish pfl activity and require cells to use pyruvate dehydrogenase   <cit> , whose expression is repressed by fnr and arca in anaerobic conditions. deletion of fnr would lower pfl activity and attenuate the repression of pdh, the result being the production of nadh instead of formate when pyruvate is converted to acetyl-coa. in the absence of oxygen, some of the acetyl-coa would be reduced to ethanol consuming two nadh molecules to maintain a redox balance.

deletion of pta and eutd  would reduce acetate production, and hence increase formation of other by-products such as ethanol, lactate, or succinate. however, multiple studies have shown that the mutations in the ack-pta pathway cause accumulation of pyruvate  <cit> , and the integrated metabolic and regulatory model predicts the secretion of pyruvate  in a ΔptaΔeutd mutant. pyruvate can be either secreted or reduced to form other fermentation by-products, but there is not enough nadh available to ferment all the pyruvate generated by glycolysis. in order to convert pyruvate to ethanol, arca and gntr deletions are needed to derepress pdh and the ed pathway, along with a pgi or tpia deletion to re-direct flux from glycolysis to the ed pathway. a Δtpia mutant alone could cause methylglyoxal accumulation and inhibit the anaerobic growth  <cit> , but re-directing flux to the ed pathway should prevent methylglyoxal accumulation.

in the strategies that include both gene deletion and gene overexpression, we found that overexpression of edd replaced the gntr deletion in most strains to activate the ed pathway. in addition, overexpression of fructose- <dig> -bisphosphatase  was predicted to increase the amount of fructose-6-phosphate, and reverse the direction of the non-oxidative branch of the pp pathway in the strains utilizing the ed pathway. the reversed pp pathway results in a decreased flux in the tca cycle and an increased flux in the ed pathway and pdh, leading to improved ethanol production. the model predicts that ptsh deletion  increases flux through the lower half of glycolysis and decreases succinate production. switching glucose transport from the phosphoenolpyruvate:sugar phosphotransferase system  to proton symport has been shown to improve overall performance and production yield for ethanol as well as other compounds  <cit> .

glutamate can be synthesized via multiple pathways depending on the availability of nitrogen sources. when ammonia is abundant, an atp-independent pathway functions to save energy by converting α-ketoglutarate to glutamate using nadph. this pathway is encoded by glutamate dehydrogenase , the deletion of which would require cells to use the atp-dependent pathway that normally operates when the concentration of ammonia is low  <cit> . this atp-dependent pathway would decrease growth rate, but increase the flux through the ed pathway and pdh, and improve the ethanol production.

predicted flux distributions corresponding to maximum biomass production and gene expression states are shown in figure  <dig> for both the wild-type and ΔfnrΔpflbΔtdceΔpgi+edd strain. these were predicted by the integrated metabolic and regulatory model . the ethanol production rate was predicted to be approximately  <dig> % of the maximum theoretical yield and the corresponding growth rate was  <dig>  h- <dig> for the mutant strain . this result is somewhat similar to the previously reported values  <cit> , but the perturbation strategy identified by optorf takes into account transcriptional regulatory effects, and as such could facilitate the adaptive evolution process of the mutant strain to achieve the desired phenotype. some of the gene deletions presented here have been used previously to engineer un-evolved and evolved strains of e. coli for ethanol production  <cit> . the strength of the optorf appoach emerges when these individual modifications are put together in a cooperative manner to generate a strategy, which simultaneously considers the metabolic and transcriptional regulatory network.

strain designs for higher alcohol production
in addition to ethanol, we have also identified metabolic engineering strategies using optorf for over-production of higher alcohols such as isobutanol and 2-phenylethanol from glucose. since e. coli does not naturally produce these higher alcohols, we have augmented the imc1010v <dig> network with non-fermentative reactions and corresponding gpr associations for synthesis of these alcohols based on a recent study  <cit> . in summary, 2-keto acid decarboxylase  and alcohol dehydrogenase  were added to the network to allow for production of 1-propanol, 1-butanol, isobutanol, 2-methyl-1-butanol, 3-methyl-1-butanol, and 2-phenylethanol from intermediates in isoleucine, leucine, and valine biosynthesis. we have assumed these enzymes, kdc and adh, have no substrate specificity so that the production of any higher alcohol is equally preferred.

our computational results found that most of the strategies for ethanol production can also be modified for the production of some higher alcohols with the additional deletion of adhe  and addition of kdc and adh. in particular, we have found that the anaerobic production of isobutanol can be coupled to growth at ~94% of the theoretical maximum yield . in addition to the strategies found in the ethanol case, deletion of the ab-specific pyridine nucleotide transhydrogenase  was identified to be beneficial for increasing isobutanol production. this prevents the electron transfer from nadh to nadp, and thus more nadh would be available for the production of isobutanol.

the predicted isobutanol yields and growth rates are listed for gene deletion and overexpression strategies. the two enzymes needed for synthesis of isobutanol  were assumed to be present for all cases. the variability in isobutanol yield at the predicted maximum growth rate was zero or very small  for all cases. the isobutanol yield is reported as % of the maximum theoretical yield . the simulation conditions were the same as the ethanol case.

in addition to isobutanol, we found that the production of 1-propanol and 2-phenylethanol can also be coupled to growth, but their yields were much lower than the isobutanol yield . however, the production of other branched-alcohols such as 2-methyl-1-butanol or 3-methyl-1-butanol can be accompanied with the production of other alcohols including ethanol and isobutanol. in other words, cells could either produce 2-methyl-1-butanol  along with the other alcohols or produce only the other alcohols. in such cases, changes in the substrate specificity of kdc or adh enzymes would be needed to generate specific alcohols. interestingly, the identified metabolic engineering strategies for 2-phenylethanol production were very distinct from the strategies for other alcohol production strains . while strategies for producing other alcohols involved increasing fluxes in the oxidative branch of pp pathway and ed pathway, the strategies for 2-phenylethanol include deletion of genes in the both the oxidative  and non-oxidative  branches of the pp pathway. the model predicts that these gene deletions would increase the fluxes in the aromatic amino acid biosynthesis pathways, which leads to the increased availability of phenylpyruvate, the precursor for 2-phenylethanol. analysis of these higher alcohols illustrates how optorf can be used to couple biomass and production of metabolites which are not part of central metabolism.

CONCLUSIONS
we have systematically integrated metabolic and regulatory models, and developed a new computational framework  for designing microbial strains for metabolite production. we compared our new approach to optknock, and found four primary differences between the strains that are identified using the two approaches. first, optknock may propose removing reactions that do not have any genes associated with them, making the construction of such strains experimentally impossible. second, optorf can find metabolic engineering strategies requiring the smallest number of gene deletions while still achieving high production yields. since optknock strategies are based on reaction deletions they often require more gene deletions than those found using optorf. third, optknock may suggest reaction deletions that result in a different solution space when the necessary genes are deleted or transcriptional regulatory effects are accounted for. in this case the adaptive evolutionary outcome would be different than what is predicted when only reaction deletions are considered, sometimes resulting in reduced production yields or lethal phenotypes. lastly, optorf can propose changes such as the overexpression of metabolic genes or deletion of transcriptional factors that may lead to faster evolutionary trajectories.

based on our analysis of experimental data using integrated metabolic and regulatory model it is unclear to what extent, if any, cells re-wire their transcriptional regulatory network during adaptive evolution. given that a finite number of mutations are found in adaptively evolved strains  <cit> , it seems likely that cells could get stuck in a local maxima in the fitness landscape, where they would need to change the regulation of multiple gene products to improve fitness. this idea is supported by the fact that the same starting strain can evolve to different end points, and in some cases achieve only sub-optimal behaviors  <cit> . by taking regulatory effects into account when designing strains it may be possible to start with strains that are already expressing the necessary enzymes needed to achieve the desired production and growth rates. some evolved strains may stay within the solution space defined by metabolic and regulatory constraints, while others may alter their regulatory networks if it results in a significant growth advantage, thus altering the solution space in which they evolve. thus, it will be particularly important to conduct parallel evolutionary experiments to find evolved strains that lead to higher production without violating regulatory constraints.

in its current implementation, optorf uses boolean approximations to describe how transcriptional regulation affects metabolic fluxes. although the use of boolean variables do not exactly represent the dynamic nature of metabolism and regulation, it has been previously shown that constraint-based models using these approximations successfully predict the cellular behavior in continuous and batch culture  <cit> . the approach could be extended to include other types of regulatory models which can account for varying levels of gene expression or enzyme activity. a previous study has shown that the behavior of a transcriptional regulatory network can be well approximated by a system of linear equations near a steady-state, where gene expression does not substantially change  <cit> . the optorf approach could be improved by applying these linear approximations in the regulatory part of the model, in order to describe varying gene expression levels, and using approaches to constrain metabolic fluxes based on predicted gene expression levels  <cit> .

the optorf approach is currently applied to produce metabolites that can be coupled to biomass production. a recent study has used a genetic algorithm to design strains with un-coupled metabolite and biomass production, where a bi-level problem is used and the inner problem uses an objective function to predict un-evolved cellular phenotypes  <cit> . optorf could also be extended to find metabolic engineering strategies that do not require coupling of cellular growth and product formation, and would evaluate gene deletions, gene overexpression, and regulatory effects simultaneously to identify such strategies.

the novelty of the method developed here is that it accounts for transcriptional regulatory networks in addition to metabolism in the design of strains for metabolic engineering. however if desired, the approach can be used with and without transcriptional regulatory constraints to consider the interdependence of reactions through their gpr associations. it should be noted that the integrated model of metabolism and regulation allows for simulating the effects of both gene overexpression  and gene deletion. the optorf approach can also suggest transcription factor deletion as an alternative to metabolic gene deletion or overexpression, which provides greater flexibility in metabolic engineering strategies. by further incorporating flux modulation approaches such as those proposed in optreg  <cit> , additional engineering strategies can be designed which consider adjustment of flux values and not just the complete removal/addition of reactions via gene deletion or gene overexpression.

the approach we have developed here is general and can be used to engineer production of a variety of products in different microorganisms, for which constraint-based models exist. the number of microbial transcriptional regulatory network models continues to grow, which has been enabled by high-throughput datasets and computational analysis  <cit> . regulatory networks reconstructed from analysis of high-throughput datasets can be integrated with metabolic networks using boolean or other types of regulatory modeling formalisms, and our approach can applied to new integrated models of metabolism and regulation. as such, it will have impacts on the biological production of a wide variety of products, ranging from biofuels and other commodity chemicals to specialty chemicals  <cit> .

authors' contributions
jk implemented the model and approach, performed the analysis, and drafted the manuscript. jlr conceived of the study, participated in its design and coordination, and helped to analyze the data and draft the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
implementation of optorf for the example network. the optorf approach is implemented in the general algebraic modeling system . a free demo version of gams can be downloaded from http://www.gams.com. this file contains the example network described in figure  <dig> 

click here for file

 additional file 2
list of strain designs for ethanol production. this spreadsheet contains the list of strain designs described in figures  <dig> and  <dig>  and corresponding growth rates and ethanol production yields.

click here for file

 additional file 3
list of strain designs for higher alcohol production. this spreadsheet contains the list of strain designs for 1-propanol, isobutanol, 2-methyl-1-butanol, 3-methyl-1-butanol, and 2-phenylethanol.

click here for file

 acknowledgements
this work was funded by the doe great lakes bioenergy research center . the authors also wish to acknowledge bob landick, tricia kiley, brian pfleger, and christos maravelias for useful discussions and chris tervo for help editing the manuscript.
