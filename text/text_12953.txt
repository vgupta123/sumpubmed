BACKGROUND
genome sequencing projects have told researchers where genes are located, in human and an ever increasing number of other species, and microarrays and other sources of information can tell when genes are activated: but the complete understanding of how genes expression is regulated at the transcriptional and post-transcriptional levels, as well as the characterization of all the elements involved in the process still remain an open question in molecular biology. transcription is a fundamental step in the regulation of gene expression, and it is modulated by the interaction of transcription factors  with their corresponding binding sites  on the dna  <cit> , mostly located near the transcription start site  of the gene or far apart organized in cis-regulatory modules .

computational methods for the discovery of conserved tfbss  can be split into two broad categories: the 'single species, many genes' approach  <cit> , and the 'single gene, many species' one  <cit> . in the former case, a set of regions  from co-regulated genes are analyzed looking for over-represented motifs, that is, the tfbss responsible for the co-regulation of the genes; while in the latter approach, known as phylogenetic footprinting , a single gene is investigated, and non coding regions flanking it are compared to their homologs in other species. non coding sequence elements that are found to be conserved by evolution are likely to be involved in the regulation of the expression of the gene. clearly, the two approaches can be merged, and each of a set of co-regulated genes can be compared both to its homologs, and to the others  <cit> , and this analysis can be also performed on a full-genomic scale  <cit> . given the ever increasing number of annotated genomic sequences available, phylogenetic footprinting has become more and more widely used, since it avoids the need of assembling a set of co-regulated genes  and allows for the investigation of single genes alone.

the comparison of homologous non coding sequences can be performed both for the identification of single tfbss, for example in promoter regions, and on a larger scale for the discovery of distal crms, an approach that has been successful in several cases ever since the first human-mouse comparisons have been possible . the available methods that are more commonly used first build an alignment  of the sequences investigated  <cit> , or take advantage of the pre-computed full genomic alignments now available  <cit> . then, one simple solution to identify conserved functional elements is to use descriptors of the binding specificity of tfbss  and look for conserved aligned regions fitting the descriptor. this approach can be used both for the detection of single tfbss  as well as of clusters of tfbss likely to form conserved crms .

methods of this kind have to face two issues: first of all, the need of reliable descriptors of the binding specificity of the different tfs. usually, pwms yield a large number of false positive matches  <cit> , and while requiring a match to be conserved throughout different sequences reduces them, the problem of defining whether a match is significant in all the species considered remains. second, and most important, is the need of having a reliable alignment of the sequences investigated. tfbss tend to be quite short , when compared to a typical region analyzed : in case the sequences aligned are too divergent, the result is that conserved tfbss can be missed simply because not correctly aligned. a dual solution, of using matches of tfbss as anchors for the alignment has indeed been proposed in order to overcome this problem and improve alignment reliability  <cit> . sequence alignments are avoided by the footer algorithm  <cit> , that performs human-mouse comparisons by using distinct descriptors for the tfbss of the two species, and looks for matches for homologous tfs that fall at similar positions with respect to the genes studied.

when known tfbss descriptors are not used, the idea is naturally to identify elements or regions that can be considered to be "significantly conserved", and hence likely to possess a regulatory function. the simplest strategy is just to single out the most conserved parts of the alignments, according to identity percentage: while a non-coding region highly  conserved can be reasonably suspected to possess a functional role  <cit> , the problem is often to define how much conserved regions should be to be considered significant. in fact, while conserved tfbss and crms can be qualitatively defined as "islands of conservation in a sea of much less conserved dna"  <cit> , suitable measures able to quantify this concept have to be introduced  <cit> . indeed, recent research has focused on this point. mba is an algorithm that looks for blocks of highly constrained alignments, weights them according to phylogenetic distance, and estimates significance according to neutral substitution rates  <cit> . a regulatory potential  score is defined in  <cit> , by looking for patterns of conservation frequently found in conserved regulatory regions. evolutionary and hidden markov models are combined in phastcons  <cit> , in order to define a measure of significance for the conservation of a multiple genomic alignment.

while all these methods can perform well in the identification of quite large conserved regulatory regions like crms or whole promoters  <cit> , they are less powerful for the identification of single tfbss. size and conservation of tfbss are in fact often not enough to constitute "significant" parts of the alignments   <cit> . another important issue is defining how much conserved a region should be to be considered as worth of further investigation. different homologous genomic regions, for example in a human-rodent comparison, show a varying degree of conservation, that is, seem to evolve at different rates  <cit> . thus, for example, if a unique significance threshold is used in some cases a whole promoter region can be considered as "significantly conserved" , while in others no significant sequence element is reported.

indeed, some methods that do not compute a global or local sequence alignment have already been proposed. several motif discovery algorithms for the detection of conserved sequence elements in co-regulated genes already exist  <cit> , and sometimes have been successfully applied to homologous sequences as well  <cit> . algorithms of this kind, however, assume that input sequences are not related by evolution, and thus look for subtle similarities: the result is that a human-mouse comparison can report a deluge of conserved motifs, regardless of the algorithmic strategy and significance evaluation employed.

footprinter  <cit> , instead, is an algorithm for the discovery of conserved motifs explicitly devised for phylogenetic footprinting, that looks for conserved sequence motifs making use of the phylogenetic relationships among the sequences. motifs conservation is first of all evaluated according to parsimony scores. while this approach bypasses the need of pre-aligning the sequences, parsimony scores alone do not provide a fine-grained ranking of the motifs found, especially when a few sequences are investigated, i.e., in a typical human-rodent comparison. a statistical evaluation of the results of the algorithm is possible, by comparing motifs found with a "random" dataset of simulated orthologous sequences. the problem is, again, that even when the same species are compared the degree of conservation in the promoters of different genes can vary significantly according to the genes investigated, and thus establishing unique significance thresholds has the effect of yielding too many significant motifs in some cases, too few in others.

the aim of this work is to introduce a novel strategy to identify significantly conserved motifs and regions in homologous sequences. given a reference sequence, and one or more homologs, the algorithm we propose is based on the idea that functional conserved elements should be conserved both in sequence and in position with respect to the genes they regulate. starting from this consideration, we adapted to this case a statistical measure we previously used for the discovery of tfbss in sequences from co-regulated genes, by adding to it positional conservation. moreover, as we discussed before, defining absolute measures of significance for conservation is hard, given that sequence conservation varies greatly according to the species and the genes considered. we tackle this problem by measuring conservation not in an absolute, but in a relative way, according to the average degree of conservation of the whole sequences compared, with the idea that functional elements should be more conserved than the rest: in other words, what the algorithm evaluates is not significant conservation, but rather significant variation of conservation within the same sequences. clearly, the motifs and regions selected by the algorithm can be further processed by matching them against descriptors of known tfbss, or compared to regions extracted from other co-regulated genes.

RESULTS
in this section we first present the algorithm, then we assess its performance showing results obtained on tests performed on collections of known functional elements.

algorithm
the weederh algorithm takes as input a reference sequence s, and any number k ≥  <dig> of homologous sequences h <dig> ... hk. also, it assumes that all the sequences have been taken from the different genomes with respect to the same reference points: that is, all sequences are upstream of the tss or the atg codon of homologous genes, or are intergenic regions between two genes and between their homologs in other species, and so on. conserved motifs are identified in the reference sequence, by comparing it to the homologs. the steps performed by the algorithm can be summarized as follows:

 <dig>  each oligo of suitable size of the reference sequence is matched against the homologous sequences;

 <dig>  matches not exceeding a given substitution threshold are scored with a measure taking into account sequence and position conservation, and the highest scoring match is kept;

 <dig>  oligo scores are transformed into relative scores, according to the average scores obtained by oligos of the same size;

 <dig>  high scoring oligos are merged, whenever possible, in order to obtain longer motifs and regions.

it can be immediately seen that we used for modeling conserved sites the oligos themselves, rather than more involved representations of tfbss like profiles and position weight matrices  <cit> . the latter are clearly more powerful than oligos and consensi for modeling the binding specificity of a given tf: however, for the ab initio discovery of novel motifs and sites, which in turn is essentially based on the detection of similar oligos and its statistical evaluation  <cit> , recent results have shown no definite prevalence, and rather consensus-  based models have often yielded better results  <cit> .

finding conserved motifs
in the first step, each oligo of a given length m of the reference sequence s is matched against each of the homologous sequences, and all its occurrences with at most e substitutions are collected. given si, the m-mer at position i of the reference sequence, a match at position j of the k-th homologous sequence hk presenting d ≤ e substitutions is scored by taking into account sequence and position conservation:

bk  = - log ) - log  + 1)

where e is the expected frequency of si with at most d substitutions in the species of sequence k , and Δ  is the distance between the two positions, measured according to the reference points defined . this function is similar to the one we employed in the original weeder algorithm  <cit> , that anyway did not make any assumption on the positional conservation of the motifs.

the score of oligo si with respect to the k-th homolog hk is given by the maximum among the matching positions:

bk=max⁡jbk
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgcbgqdawgaawcbagaem4aasgabeaakiabcicaoiabdmgapjabcycasiabd2gatjabcmcapiabg2da9maaxababagagiyba0maeiyyaemaeiieaghaleaacqwgqbgaaeqaaogaemoqai0aasbaasqaaiabdugarbqabagccqggoaakcqwgpbqacqggsaalcqwgqbgacqggsaalcqwgtbqbcqggpaqkaaa@4599@

if no match is found for si in sequence hk, or all matches yield negative scores  this score is set to zero. at this point, the overall score associated with si could be defined as the sum of the scores in each homologous sequence: but, the bk values can vary greatly according to the overall conservation of the sequences compared . however, regardless of the species considered, the idea underlying the algorithm is that functional elements should be more conserved than the rest of the sequences: thus, instead of using directly the bk scores the algorithm first transforms them into relative scores. let

μ=∑ibk|s|−m+1
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwf8oqbcqggoaakcqwgrbwacqggsaalcqwgtbqbcqggpaqkcqgh9aqpdawcaaqaamaaqababagaemoqai0aasbaasqaaiabdugarbqabagccqggoaakcqwgpbqacqggsaalcqwgtbqbcqggpaqkasqaaiabdmgapbqab0gaeyyeiuoaaoqaamaaemaabagaem4uamfacaglhwuaayjcsdgaeyoei0iaemyba0maey4kasiaegymaedaaaaa@4880@

and

σ2=∑i−μ)2|s|−m+1
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfdpwcdaahaawcbeqaaiabikdayaaakiabcicaoiabdugarjabcycasiabd2gatjabcmcapiabg2da9maalaaabawaaabeaeaacqggoaakcqwgcbgqdawgaawcbagaem4aasgabeaakiabcicaoiabdmgapjabcycasiabd2gatjabcmcapiabgkhitiab=x7atjabcicaoiabdugarjabcycasiabd2gatjabcmcapiabcmcapmaacaaaleqabagaegomaidaaaqaaiabdmgapbqab0gaeyyeiuoaaoqaamaaemaabagaem4uamfacaglhwuaayjcsdgaeyoei0iaemyba0maey4kasiaegymaedaaaaa@546e@

be the mean and the variance of the scores obtained by m-mers of the reference sequence when matched against sequence hk. the term |s| indicates the length of the reference sequence. the score of each m-mer is standardized into a χ <dig> relative score:

χk2=−μ)2σ2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfhpwydaqhaawcbagaem4aasgabagaegomaidaaogaeiikagiaemyaakmaeiilawiaemyba0maeiykakiaeyypa0zaasaaaeaacqggoaakcqwgcbgqdawgaawcbagaem4aasgabeaakiabcicaoiabdmgapjabcycasiabd2gatjabcmcapiabgkhitiab=x7atjabcicaoiabdugarjabcycasiabd2gatjabcmcapiabcmcapmaacaaaleqabagaegomaidaaagcbagae83wdm3aawbaasqabeaacqaiyagmaagccqggoaakcqwgrbwacqggsaalcqwgtbqbcqggpaqkaaaaaa@5252@

the overall relative score for the m-mer at position i of the reference sequence is finally defined as the sum of the relative score contributions of each homologous sequence:

χ2=∑kχk2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfhpwydaahaawcbeqaaiabikdayaaakiabcicaoiabdmgapjabcycasiabd2gatjabcmcapiabg2da9maaqafabagae83xdm2aa0baasqaaiabdugarbqaaiabikdayaaakiabcicaoiabdmgapjabcycasiabd2gatjabcmcapawcbagaem4aasgabeqdcqghris5aaaa@42f5@

χ <dig> scores are computed only when bk  > μ  for each homologous sequence hk, otherwise it is set to zero. concerning suitable values for the motif length m that has to be considered, in the experiments we present in this article we ran the algorithm on size m =  <dig> and m =  <dig>  computing for each mean and variance values: longer motifs or regions are detected by combining and merging shorter ones, as explained in the following section.

merging motifs
very often, the regulation of the transcription of an eukaryotic gene is the result of the simultaneous action of different tfs. binding sites for cooperative or competitive factors are often adjacent or overlapping each other, with the result that regions longer than a single site are often found to be conserved throughout different species. in order to detect explicitly these regions, in the second step the algorithm merges motifs adjacent in the reference sequence , if their best occurrences  are adjacent in all the homologs.

since the occurrences of the two motifs do not overlap and are independent, the sum of the original bi scores of two motifs m <dig> and m <dig>  and bi) has mean μ <dig> i + μ <dig> i and variance σ <dig> i+σ <dig> i, that is, are the sum of mean and variance of the first and second motif bi scores, respectively, computed according to the motifs' length for each homologous sequence hi. the resulting χ <dig> score of the merged motif can be then defined as:

χ2=∑i+bi−μ1i−μ2i)2σ1i2+σ2i2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfhpwydaahaawcbeqaaiabikdayaaakiabcicaoiabd2gatnaabaaaleaacqaixaqmaeqaaogaemyba02aasbaasqaaiabikdayaqabagccqggpaqkcqgh9aqpdaaeqbqaamaalaaabagaeiikagiaemoqai0aasbaasqaaiabdmgapbqabagccqggoaakcqwgtbqbdawgaawcbagaegymaedabeaakiabcmcapiabgucariabdkeacnaabaaaleaacqwgpbqaaeqaaogaeiikagiaemyba02aasbaasqaaiabikdayaqabagccqggpaqkcqghsislcqwf8oqbdawgaawcbagaegymaejaemyaakgabeaakiabgkhitiab=x7atnaabaaaleaacqaiyagmcqwgpbqaaeqaaogaeiykakyaawbaasqabeaacqaiyagmaaaakeaacqwfdpwcdaqhaawcbagaegymaejaemyaakgabagaegomaidaaogaey4kasiae83wdm3aa0baasqaaiabikdayiabdmgapbqaaiabikdayaaaaaaabagaemyaakgabeqdcqghris5aaaa@61d1@

merging is performed by the algorithm only on motifs that in the first step had positive χ <dig> score, and thus were more conserved than the average in each homologous sequence. this step is iterated for each position of the reference sequence, that is, single motifs are first compared to the adjacent ones; then, motifs resulting from merging are compared to the adjacent ones, and so on until no further merging is possible. the result is that in this way long conserved regions can be detected, but the regions have to be conserved also locally: they must be built by fragments that, taken singularly, fit our model for conserved tfbss. thus, in the merging step the algorithm is able to detect regions of size  <dig>   <dig>   <dig>  and so on.

input parameters
the only parameters needed by the algorithm, other than the species of origin of the input sequence, are the motifs' size and the maximum number of substitutions allowed when collecting occurrences. as introduced before, in our experiments we used oligos of length m =  <dig> and  <dig>  with e =  <dig> and  <dig> substitutions, respectively. the choice of these parameters was based first of all on the parameters used in the original weeder algorithm, and also on studies that showed how variation of 25% of the sequence seems to be a critical value, at least for human-rodent comparisons. this, in turn, implies that also longer regions must present at most 25% of substitutions in their occurrences in the homologs. usually, tfbss presenting 30% or more mutations in their homologs are in fact much less likely to preserve their function  <cit> .

output
in a typical application, like a human-rodents comparison, several overlapping motifs  with positive χ <dig> scores are found. to trim down the size of the output, the algorithm avoids reporting motifs that overlap by more than  <dig> bps for eightmers,  <dig> bps for twelve-mers, and  <dig> bps for longer motifs, with a simple top-down greedy procedure. if a motif overlaps another motif with higher score by more than the defined number of nucleotides, it is removed from the ranked output of motifs.

an example of a typical output of the algorithm is shown in figure  <dig>  for the  <dig> bp upstream and non-coding first exon of the p <dig> gene of human, mouse, and rat. the highest scoring motifs are shown, displayed within a ucsc genome browser window. known tfbss annotated for the human gene in the transfac database are also shown. it can be seen how a quite long region has been reported, on which adjacent binding sites map, while other shorter motifs are scattered along the sequence, the distal ones falling within a region not deemed to be conserved according to genomic alignments . we also show the location on the human sequence of motifs predicted by meme  <cit>  , that cover most of the sequence itself: in fact, since algorithms of this kind are mainly aimed at the detection of very subtle similarities  <cit> , the high level of overall conservation and the few sequences available lead to the prediction of several long significantly conserved motifs.

experimental setup
to test the algorithm, we used data taken from the abs database  <cit> , a collection of experimentally validated transcription factor binding sites conserved in at least two species, together with the homologous promoters containing them. we retrieved from the database  <dig> sets of homologous sequences  <dig> bps long, containing a total of  <dig> experimentally validated binding sites. seven sequence sets contained human-mouse-rat sequences,  <dig> a human-mouse pair,  <dig> a human-rat pair, and  <dig> mouse- rat sequences. we used these data first to build simulated datasets, then to test the algorithm on real orthologous sequences.

results on simulated sequences
we built a dataset of simulated sequences as follows. for each human sequence retrieved from the database, we generated simulated mouse and rat sequences by using the dawg program  <cit> , that permits the simulation of sequence evolution also including insertion and deletions. we set different substitution rates yielding different sequence identity percentages, while gap and the other parameters needed were estimated by the dawg algorithm from the alignment of the sequences retrieved from the database. since our algorithm selects motifs according to maximum substitution rates, rather than defining substitution rates also for the evolution of binding sites we chose to use the original sites annotated in the abs database. thus, once a simulated rodent sequence set was generated, we selected a single site annotated in the human sequence and we planted its annotated homologs in the rodent sequences, together with the five nucleotides flanking them on each side. motifs were planted at their original positions, since weederh scores motifs according to their conservation in position. in this way, we obtained  <dig> sequence sets, each containing a single planted motif. eighteen sets were composed by human-mouse-rat sequences,  <dig> by a human-mouse pair, and  <dig> contained human-rat sequences.

we assessed the performance of the algorithm by using different measures. first of all, at the nucleotide level, we calculated the percentage of the nucleotides of the true sites planted in the sequences that were predicted as part of a conserved motif by the algorithm . this measure is equivalent to sensitivity . then, at the site level, by defining a site as correctly predicted if either at least eight of its nucleotides or at least 75% of the site nucleotides overlapped a predicted motif . in order to have an estimate of the false positive predictions of the algorithm we also computed the overall length of the motifs predicted by the algorithm in each sequence set, that is, the percentage of the reference sequence covered by motifs , and according to this the specificity .

performance of weederh at different χ <dig> score thresholds on the  <dig> simulated sequence sets. %pred indicates the percentage of nucleotides of the reference sequence belonging to a motif output by the algorithm. nc indicates the nucleotide coverage, the percentage of nucleotides in annotated sites matched by a predicted motif ; sc indicates the site coverage, the percentage of annotated sites matched  by a motif predicted by weederh; finally, sp is specificity. the bottom row reports the performance of the footprinter algorithm on the same set.

to make a comparison, the core of the footprinter algorithm is based on the same idea, finding matching oligos in the sequences examined, and computing a parsimony score according to the number of mismatches in motifs' instances and the phylogenetic relationship among the species investigated. when no substitution was allowed in motifs instances, footprinter yielded a nucleotide coverage  of 61%, and a site coverage of 72%, with motifs predicted only on small fraction of the reference sequence . with threshold  <dig>  however, weederh reached the same specificity, but with sensitivity of . <dig> and site coverage of about 78%, respectively.

other than yielding lower accuracy, the parsimony score employed by footprinter makes a fine grained ranking of motifs more difficult, especially when few  homologous sequences are examined. allowing one or two substitutions when searching for conserved motifs  improved the results up to 99% when allowing two substitutions, but also increased significantly the percentage of the reference sequence covered by a motif: 99% with two substitutions  and 72% with one substitution. figure  <dig> shows the roc curve obtained by weederh at different χ <dig> values, plotting sensitivity and site coverage vs. .

results on homologous human-rodent promoters
as a further test, we applied the algorithm to the original datasets retrieved from the abs database , composed of  <dig> sets of human-rodent homologous promoters and  <dig> mouse-rat sequence sets. the results, at different χ <dig> values are summarized in table  <dig> and figure  <dig> .

performance of weederh at different χ <dig> score thresholds on the  <dig> orthologous promoter sets retrieved from the abs database. %pred indicates the percentage of nucleotides of the reference sequence belonging to a conserved motif output by the algorithm. nc indicates the nucleotide coverage, the percentage of nucleotides in annotated sites matched by a predicted motif; sc indicates the site coverage, the number of annotated sites matched  by a motif predicted by weederh; sp is specificity. the next two rows report the performance of the footprinter algorithm on the same set, using parsimony score alone , and with the introduction of significance estimation . finally, the bottom row shows the same data for the phastcons most conserved tracks available at the ucsc genome browser .

the first piece of information that can be gathered is that virtually all the reference sequence is covered by a motif satisfying the substitution threshold, as shown by the first row of the table that reports the motifs found regardless of the χ <dig> score threshold. but, the annotated sites in the sequences have indeed a positive χ <dig> score, since using a threshold of  <dig> yields coverage of about 99% at the site level and 96% at the nucleotide level. in this case, however, the motifs output still cover about 79% of the reference sequence. increasing the χ <dig> score threshold to values ≥  <dig> has the effect of lowering the fraction of the reference sequence covered by a conserved motif to 30–40%, while the site coverage falls less sharply, with about 80–85% of the annotated sites correctly predicted. it should be noticed that in this case higher performances are obtained at lower threshold values, nevertheless with lower specificity values. this is due to the fact that the sequence sets analyzed are in general more conserved than the artificial sets we generated , and thus motifs stand out less well with respect to the rest of the sequences. a single sequence can also contain more than one annotated site. moreover, rather than be spread randomly along the sequences as in the previous case, now it is more likely to find conserved blocks within the sequences, thus yielding a higher number of oligos satisfying the substitution thresholds employed by the algorithm.

the number of sites correctly predicted by the algorithm is anyway again quite satisfactory, but in this case assessing how many false positives are reported is far from being straightforward. first of all, one should have an estimate of how many functional sites should be expected inside the  <dig> bp promoter of a mammalian gene. then, according to the species included in the analysis, how many sites should be expected to be conserved, a number that for human-mouse comparisons has been estimated to be ranging from  <dig> to 72%  <cit> . in other words, the region analyzed might also contain other functional sites not conserved in the other species. finally, the conservation of functional sites often spans a region longer than the sites themselves, increasing the number of predicted nucleotides.

we then ran footprinter also on this sequence set. again, the best performance  was obtained by using a parsimony score threshold of  <dig> , with motifs covering more than 37% of the reference sequence. with χ <dig> score threshold of  <dig>  weederh motifs covered the same percentage of the reference sequence, with 84% of success at the site level and 76% at the nucleotide level . thus, with the same specificity, weederh yields a higher sensitivity. introducing for footprinter significance evaluation of motifs  did not improve the results, increasing the specificity but also reducing the percentage of correctly identified sites to 70%. the same specificity was reached by weederh with χ <dig> score threshold of  <dig> , but with 79% of the annotated sites correctly predicted.

we also compared our results to the phastcons annotations  <cit>  available at the ucsc genome browser  <cit> . the overall percentage of the reference sequences used in this test annotated as "most conserved" is around 25%, and about 55% of the sites annotated in the database are covered . although the tracks are generated by comparing human to all the vertebrate genomic sequences available, instead of rodents alone , this result nevertheless highlights the fact that methods like phastcons are better suited to identify large conserved regions rather than single sites. examples are shown in figures  <dig> and  <dig>  with the results of weederh compared to the conserved regions predicted by phastcons and rp  <cit>  available at the ucsc genome browser. indeed, these examples show typical situations in which the two methods either do not detect any conserved element in the core promoter because single tfbss are too small to reach a significant level of conservation , or can single out only large conserved regions . this is also a drawback deriving from the usage of a single, global threshold of significance. these examples show how weederh can work at a much more fine grained level of detail, actually being able to identify correctly conserved tfbss either with little or, vice versa, a very high level of overall sequence conservation.

given the difference in performance on the same threshold values for the artificial and real datasets, it might seem that the problem of defining a significance threshold remains, only recast at a relative level, that is, depending on the overall degree of conservation of the sequences investigated. however, useful information can be gathered by examining the ranking, in the lists output by the algorithm, of the motifs matching a planted site. the overall distribution is shown in figure  <dig>  in artificial sequences, more than 60% of the planted sites matched a top-scoring motif, and nearly 80% one of the first three. also in the real promoter case, motifs corresponding to a functional site tend to appear within the first five positions , thus providing further evidence to the fact that indeed the measure used by the algorithm highlights conserved real tfbss, that are as we stated in the introduction, "more conserved than the rest". one third of the  <dig> sites are matched by the highest ranking motif, 17% by a second-ranking motif and 13% by the third one. 75% of the annotated sites are matched by a motif ranking among the first five, 90% among the first ten. the percentage is increased if we remove from the ranking those higher-scoring motifs that match an annotated site, in other words, if we count in the ranking of a motif only those preceding it that do not match an annotated site . in this case, almost half of the sites are matched by the highest ranking motif, or by a motif that is preceded by other motifs matching a solution . vice versa, in  <dig> sequence sets out of  <dig> the highest scoring motif matched an annotated site , and in  <dig> out of  <dig> one of the first three motifs matched an annotated site. a rapid inspection of the highest scoring motifs not matching a site annotated in the abs database, however, revealed that in all the cases but one the highest scoring motif matched at least one site annotated in transfac, or a signal like tata- or caat-boxes that given their constrained position are perfect candidates to be picked by the algorithm.

the scoring function employed by the algorithm seems thus to be reliable, and scanning the output list from top to bottom is very likely to produce satisfactory results. an interesting result is also the fact that in the case of mouse-rat comparisons, where the sequences presents a much higher degree of similarity, the percentage of annotated sites correctly identified remains fixed at 90% even at high score thresholds, showing that true sites are higher scoring also in the presence of a higher level of sequence conservation.

finding conserved distal motifs and regions
as we have shown in the previous section, the scoring function employed by the algorithm can successfully discriminate motifs and regions corresponding to true functional sites. the dataset we used for the test, however, was composed of sequences carefully selected, in other words, truly orthologous promoters. in this way, the positional conservation term in the scoring function quite naturally yields the best results. very often, however, the selection of the input sequences is far from being straightforward: even in largely annotated genomes like human and mouse, genes present several different transcription start sites, alternative promoters, and so on, making difficult the choice of which "upstream" region has to be considered. moreover, in other recently sequenced genomes like dog, no transcripts are often available, and genes are annotated only starting from the atg codon  <cit> . to assess whether the scoring scheme employed is efficient also in the case of longer sequences less carefully selected we performed further tests.

the actin cardiac alpha chain gene  has the atg codon located within the second exon, with a fully non-coding first exon. weederh successfully identified all the  <dig> sites contained in the  <dig> bp promoter region retrieved from the abs database . we repeated the experiment, but this time retrieving the  <dig>  base pairs upstream of the atg codon of the mouse and human genes. the results are shown in figure  <dig>  displayed within a ucsc genome browser window. the topmost track  shows the location of the highest scoring motifs. it can be seen that they are clustered around the tss of the gene, falling within the  <dig> bp promoter of the abs database . motifs shown in this area cover all the abs annotated sites. also interestingly enough, other clusters of motifs are visible, namely at around - <dig>  - <dig>  and - <dig> from the tss. as a matter of fact, three distal enhancers are annotated for the actc gene, driving developmental and cardiac-muscle specific expression of the gene  <cit> .

to ease the identification of clusters of conserved motifs, we added to the basic algorithm the computation of the average motif χ <dig> score  in regions  <dig> bp long. figure  <dig> shows the regions with average 12-mer χ <dig> score greater than  <dig>  matching the experimentally annotated enhancers.

another example is the actin, skeletal muscle gene . in this case, we retrieved for human, mouse, and rat the whole intergenic region  upstream of the gene. in this case, two regions were selected as densely populated of significant motifs : the core promoter, again, and another region at around - <dig>  matching an experimentally validated enhancer  <cit> .

these examples, as well as other tests we performed, show how the conservation principle the algorithm is based on can work also on input sequences whose size spans well outside the typical length of a core promoter, where positional conservation is looser. while not explicitly devised for the identification of distal enhancers, weederh nevertheless can be applied to cases where the exact location of the tss of a gene in different species is not available, or in general to identification of conserved motifs located at several hundreds of base pairs of distance from the reference point selected, on which other methods that do not compute global sequence alignments cannot be applied.

CONCLUSIONS
the ever increasing availability of annotated genomic sequences, as well as the observation that several non coding regulatory sequence elements are highly conserved throughout different species, have made phylogenetic footprinting one of the most widely used approaches to the identification of sequence cis-acting elements regulating gene expression. the algorithm we presented in this work was aimed at overcoming some of the drawbacks of the methods currently used, namely, the need of reliable genomic alignments and/or descriptors for the binding specificity of transcription factors. the introduction of a relative scoring strategy, moreover, bypasses the problem of defining global significance thresholds. the algorithm is also quite efficient, requiring less than one minute for a typical promoter analysis and a few minutes for sequences a few kbp long. the results we obtained from the tests we performed show that the algorithm can reliably predict conserved tfbss in homologous promoters, with better performance over existing methods and annotations, but also can identify conserved sites and regions in longer sequences. clearly, other methods are more suited for the discovery of distal regions and enhancers, that can be located at several thousands or millions of base pairs from the gene they regulate; nevertheless, weederh can provide significantly more information than traditional motif-finding algorithms.

