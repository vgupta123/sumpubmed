BACKGROUND
nowadays many microarray-based studies adopt complex experimental design involving multiple treatments, cell lines/tissues, multiple dosages, time points, phenotypes and so on  <cit> . these studies are often involved with complex research hypotheses. for instance in one of our previous studies  <cit> , we were interested in identifying differentially expressed genes  in responding to common bile duct ligation in bone marrow stem cells  compared against primary hepatocytes. two deg sets from bmscs and hepatocytes were identified respectively, and the overlapping genes across the two cell types were obtained. the overlapping genes produced across the two cell types allowed the identification of common biological pathways, ontological classes, and biological mechanisms across the two cell types in responding to the treatment.

the intersection operations on multiple gene lists are equivalent to performing multiple tests for the combined hypotheses on every single gene. although there are many statistical tests proposed for gene expression studies  <cit> , the problems of obtaining overlapping gene sets based on multiple tests were overlooked in microarray-based studies. to obtain genes that satisfy the specific hypotheses, researchers simply overlap the gene sets from multiple gene sets and visualized them in venn diagrams. however, because of lacking multiplicity adjustment, this procedure overlooks the changes of statistical properties, i.e., power, type  <dig> error rate, p-values, during the intersection operations. this type of multiple testing for finding overlapping genes is known as the intersection-union test . despite some early efforts  <cit> , the statistical properties and adjustment algorithms of iut are not well established. berger has proved that iut without multiplicity adjustment is a level-α test  <cit> , when the individual tests were controlled at type  <dig> error rate α. however, the family wise error rate  for iut α' is generally much smaller than α. therefore, performing iut without multiplicity adjustment would be very conservative and result in too many false negatives.

in this paper, we show that current overlapping operation, applying no p-value adjustment for iut, is overly conservative in general. as a result, current microarray studies suffer from low power in detecting overlapping genes and therefore limit its use in biological data mining. we developed an analytical solution, named as relaxed iut  for the multiplicity adjustment of iuts under certain conditions. we theoretically proved that our proposed method is a less conservative and more powerful than current approaches. we demonstrated the superiority of riut for detecting overlapping genes in simulated data sets and complex microarray-based toxicogenomic studies.

RESULTS
monte-carlo simulation results of riut
as an example to showcase the power of riut, the mrna expression of a given gene is tested whether it is significantly altered by a drug treatment in multiple tissues. suppose gene expressions were measured in m different tissues and one is interested in the overlapping degs. for each tissue, a two-sample t-test is performed between a treatment group and a control group, each containing n replicates to obtain a list of significant genes for that tissue. then we have an iut that is constructed by m individual tests, each for a different tissue:

h0i: the drug has no effect in the ith tissue, i.e., μti = μci,

hai: the drug has effect in the ith tissue, i.e., μti ≠ μci,  <dig> ≤ i ≤ m,

where μti and μci denote the expression mean of the treatment and the control groups respectively of the ith tissue. the hypotheses for iut are h0: the drug shows no effect on at least one tissue vs. ha: the drug shows effect on all tissues.

for the monte-carlo simulation, the expression data for the treatment and control groups were modeled as normal distributions n and n respectively, where μci =  <dig>   <dig> ≤ i ≤ m. we then drew n =  <dig> samples from each of these distributions and apply riut and biut to these simulated data. table  <dig> shows the estimated type  <dig> error rate by  <dig> simulated instances of iut formed by  <dig> individual tests. expression mean μt <dig> is fixed at  <dig> for the first tissue and different values of μt <dig> were used to represent the drug having diverse effects  on the second tissue. overall, the drug has no effect on the first tissue and the null hypothesis h <dig> of iut is true. results show that both riut and traditional berger's iut  are bounded by nominal α at which the individual hypotheses were tested. the actual type  <dig> error for iut is generally smaller than α. riut is less conservative than biut as it achieves a type  <dig> error rate that is closer to α. to prove concept, we also tested two meta-analysis methods for combining independent tests, the fisher's method  <cit>  and stouffer's method  <cit> . the results show that their actual type  <dig> rate can be so much higher than the nominal one that these methods are not suitable for the iuts.

m =  <dig>  n =  <dig>  and μt <dig> =  <dig> ; individual tests were performed at α =  <dig>  and each estimate were based on  <dig> runs.

at μt1= μt <dig> =  <dig>  the resultant p-value distributions generated from  <dig> instances were illustrated in figure  <dig>  theoretically, the p-values originated from null hypothesis should appear approximately uniformly distributed . the adjusted p' using riut achieved the desired distribution as shown in figure 1a. however, figure 1b shows that the unadjusted p is seriously skewed to the right, indicating that the test is overly conservative.

m =  <dig>  n =  <dig>  and μt <dig> =  <dig> ; individual tests were performed at α =  <dig>  or α =  <dig>  and each estimate based on  <dig> runs.

as a more realistic simulation, we pooled instances being positive  and negative . we use γ to denote the simulation bernoulli probability that an individual hypothesis is not null such that prob = γ. the population means were set at μt <dig> = μt <dig> =  <dig> . according to this procedure, we simulated  <dig> instances under different γ and the resultant number of true negative and true positive were denoted as k <dig> and k <dig> respectively. the identified false positive and true positives were notated as v and s respectively. the results in table  <dig> confirmed our previous observations that riut is a more powerful and less conservative. the same patterns were observed in simulations using other parameter values .

m =  <dig>  n =  <dig>  and μt <dig> = μt <dig> =  <dig> ; individual tests were performed at α =  <dig>  and each estimate were based on  <dig> runs.

identifying overlapping genes that respond to multiple drug treatment
this example illustrates how riut algorithm can be used in real dna microarray-based multiple-testing problems. originally generated from the maqc project  <cit> , this data set consists of rat rna samples that came from six treatment/tissue groups. the treatment/tissue groups were aristolochic acid/liver, aristolochic acid/kidney, riddelliine/liver, comfrey/liver, control/liver and control/kidney. there were six biological replicates in each treatment/tissue group. mrna expression profiles were obtained using four commercial platforms including affymetrix , agilent , applied biosystems  and ge healthcare  in five different labs with two labs using the affymetrix microarray platform. totally,  <dig> chips were obtained and the cross-platform probe-mapping gave rise to  <dig> genes commonly detected across four platforms.

in this example, our goal is to identify the common genes responding to different drug treatments. these genes may shed lights on common cytotoxicity mechanisms of these drugs. we used the liver/control  group as control and the  <dig> drugs treatment at rat liver were referred to as l_aa, l_cfy, and l_rdl respectively. the iut consists of two individual tests, , each testing whether a gene differentially expressed in response to one specific drug treatment versus control. the combined iut was used to identify the genes that differentially expressed in combined each pair of the three treatments. table  <dig> shows the number of overlapping differentially expressed genes identified using riut compared with the traditional biut at different labs/platforms. as expected, the number of significant genes obtained using riut is consistently greater than that obtained using biut. the magnitude of increase ranges from 13% to 184%. for many iuts, the number of identified overlapping genes using traditional biut is close to the number of nominal false positives , suggesting that biut lacks power to identify true overlapping differentially expressed genes. the testing results using real microarray data confirm our analytical results of theorem  <dig> and theorem  <dig> . in addition our monte-carlo simulation demonstrates that riut is a more powerful and less conservative approach than biut.

α =  <dig>  

iut a: t1: l_aa vs. l_ctl and t2: l_cfy vs. l_ctl

iut b: t1: l_rdl vs. l_ctl and t2: l_cfy vs. l_ctl

iut c: t1: l_aa vs. l_ctl and t2: l_rdl vs. l_ctl

detecting genes with time-course and dose-response effect to chemical treatment
to further demonstrate the applicability of riut in microarray studies, we focus on the rat cadmium toxicogenomic data set  <cit> . this study employed a more complex study design, in which both gene expression and cytotoxicity changes were profiled in a multi-dose multi-time-point setting. briefly, primary rat hepatocytes were isolated and were exposed to three different doses of cadmium acetate  for  <dig> h. cells were collected at  <dig>   <dig>   <dig>   <dig> and  <dig> h in all three groups  for cytotoxicity evaluation by lactase dehydrogenase  leakage as well as for mrna expression profiling by dna microarray. affymetrix genechip® oligonucleotide arrays  were used for mrna expression profiling. there are  <dig> probe sets representing ~ <dig> important toxicology-related genes in the rt u <dig> array. the microarray experiment was repeated using primary hepatocytes from  <dig> animals, each with  <dig> replicates  for each dosage  at each time point , resulting in a total of  <dig> chips . the  <dig> replicates were averaged in our analysis.

firstly, to identify differentially expressed genes in responding to cadmium treatment at each time point, two-sample t-tests were performed between the treatment  and control at each time point. secondly, to identify the genes with persistent differentially expression due to cadmium exposure across different time points, the overlapping of the degs at both short term  and long term  were identified using our proposed method. the second research question was then formulated an iut problem which could be solved using our proposed method.

we constructed an iut consisting of two individual tests . the joint p-value distribution from t <dig> and t <dig> for all genes is illustrated in figure  <dig>  it is shown that t <dig> and t <dig> were approximately independent  and their p-values were approximately uniformly distributed under null hypothesis . therefore the assumptions in theorem  <dig> and  <dig> were not violated. in fact for most microarray-based studies, these assumptions need to be checked by scatter plot.

we performed riut and biut  for all  <dig> probe sets. riut identified  <dig> overlapping probe sets and traditional biut identified  <dig> at α =  <dig> . the power of iut methods directly affected the identified gene set on which the follow-up pathway interpretation was based. to demonstrate this effect, a pathway enrichment search was performed by comparing the iut-identified gene sets with the specific kegg pathways  <cit>  using a fisher's exact test on david  <dig>  <cit> , resulting in an enrichment p-value for each pathway which were listed in table  <dig>  using the riut gene set, we identified  <dig> significantly over-enriched pathways . however, using the biut gene set, no significant pathways in kegg was identified. it has been reported that the metabolism of xenobiotics by cytochrome p <dig> pathway is significantly affected by cadmium exposure  <cit> . the activity of mapk signaling pathway and porphyrin and chlorophyll metabolism pathway have also been affected by environmental cadmium exposure  <cit> . again, our analysis results using cd time-course data set indicate that riut is a more powerful method than biut and the significance can be seen in the biological pathway identification.

 based on the gene sets derived from riut and biut

discussion
riut can be improved in three ways to be applicable in more scenarios:  estimating unknown nuisance parameters;  dealing with more than  <dig> individual tests; and  combining non-independent tests. for the scenario , the current approach for estimating π with an arbitrary λ was originally proposed by storey  <cit>  for estimating false discovery rate. the authors proposed a bootstrap method for finding optimal λ which can also be used here. it should be noted that theorem  <dig> is valid no matter how the λ is chosen and how good π is estimated. for iuts consisting of more than  <dig> individual tests, it is difficult to obtain the analytical solution as theorem  <dig>  however, we can apply a step-up procedure which agglomeratively applies riut on its least significant individual test. it is more difficult to extend our procedure for non-independent tests. it may need a resampling-based algorithm to incorporating correlation structure of multiple tests and dealing with non-normality issues. resampling needs intensive computation which can be largely offset by today's powerful and inexpensive computing facility. resampling of iut is based on resampling of individual tests which can be conveniently performed by either bootstrap or permutation. bootstrap and permutation were discussed in many literatures  <cit> .

CONCLUSIONS
our study demonstrated that the current unadjusted iut approaches were overly conservative, which resulted in loss of power in finding overlapping genes in microarray-based gene expression studies. our proposed riut was analytically proved to be a more powerful and less conservative approach than the current unadjusted iut. the power improvement is more apparent in tests with weak and moderate effect sizes. this is also demonstrated in monte-carlo simulations and real case studies. in addition, certain known biologically relevant pathways were identified using the riut-derived overlapping genes which were not detected by using the traditional biut.

appendix
let x denote the random vector of data values. suppose the probability distribution of x depends on an unknown parameter θ. the set of possible values for θ will be denoted by Θ. suppose we have m individual tests and let ri denote a rejection region for a level-α test of h0i : θ ∈ Θi versus hai : θ ∈ Θic,  <dig> ≤ i ≤ m, where Θi is a specified subset of Θ and Θic is its complement. then iut tests the union of sets against an intersection of sets. h0:θ∈Θ0=∪i=1mΘi versus ha:θ∈Θ0c=∩i=1mΘic, with the rejection region r=∩i=1mri. in other words, the iut rejects only if all of the tests reject.

berger's theorem: iut with rejection region r is a level-α test of h <dig> versus ha.

proof. for any θ ∈ Θ <dig> and for any  <dig> ≤ l ≤ m, we have pθ=pθ≤pθ≤α. therefore, is iut is a level-α test. ▪

