BACKGROUND
in the context of systems biology, modeling is used to drive the acquisition of knowledge about the molecular mechanisms governing intracellular processes by evaluating the system’s behavior. in this way, measuring how the levels of some key species in the network evolve, for example, upon environmental perturbations, may help to retrieve important features concerning connectivities and rate constants of the underlying mechanism . one key challenge in systems biology is the identification of kinetic models from limited quantitative data  <cit> , hence the increasing interest in results connecting structure, parameters and dynamic behavior  <cit> .

biochemical switches are biochemical reaction networks with the capacity for two different stable steady states. depending on the initial and environmental conditions the system will evolve towards one steady state or the other. this property enables the cell to take decisions, by transforming, for example, graded stimuli into all or none responses. bistable switches are ubiquitous in cell signaling networks, from pheromone sensing  <cit>  to cell proliferation regulation  <cit> . the presence of bistability reveals structural properties that the network might or might not have, allowing to discriminate among different structural hypotheses. there are a number of results connecting particular structural features with the absence or presence of bistability in biochemical reaction networks. some of these results are central to the chemical reaction network theory   <cit> , which has received in the recent years a considerable amount of attention from the  biology community  <cit> .

how can bistability bring insight on the parameters of a model?

the forward problem of determining the mapping from the parameter space to the space of the model behavior and, in particular, to the capacity of the model for bistability, can be approached using standard bifurcation analysis  <cit>  when the number of parameters is small. to build bifurcation diagrams the steady states of the system are computed by varying one or a small number of parameters with the rest of the parameters being fixed. in a previous work  <cit>  a condition for multiple steady states was derived within the framework of crnt. the condition can be easily checked by evaluating the determinant of a matrix, thus providing an efficient tool to tackle the aforementioned forward problem: once values are assigned to the parameters it is immediate to assess the capacity or not for multiple steady states.

the inverse problem of finding parameter regions compatible with bistable behaviour can be tackled by checking the multistationarity condition derived in  <cit>  through the whole parameter space. in  <cit>  an algorithm based on interval methods was suggested for a reliable and systematic search in order to obtain a complete partition of the parameter space. starting from a reaction mechanism with  experimental evidence of bistability, the algorithm allowed us, based on this qualitative information, to restrict the parameter space to where multiple steady states can be found.

here, our goal is to exploit quantitative information from experimental data in order to infer the actual values of the model parameters, and what we develop is a method for parameter estimation from experimental data. typical evidences for bistability obtained from experiments are, for example, hysteretic dose response curves. dose response curves indicate how the steady state of a system evolves upon increase or decrease of a given stimulus. in a hysteretic dose response curve a continuous change in the stimulus , produces a discontinuous jump in the measured steady state concentration or output beyond the so called bifurcation point. in this work we address the inverse problem of determining the parameters that produce certain desired properties of the bifurcation diagram and, consequently, in the observed experimental dose response curves. in particular, the method uses the location of the bifurcation points given by experimental dataa to infer the kinetic parameters, exploiting the condition derived in  <cit> . in contrast to other methods developed for inverse bifurcation analysis which use generic bifurcation conditions  <cit>  and can therefore be used for any system of ordinary differential equations, our method is specific for chemical reaction networks since it exploits their particular structural properties, bringing additional insight into the inverse bifurcation problem for chemical reaction systems.

the basic ingredients of the inverse bifurcation method are described in the methods section, where a brief introduction of some essential crnt concepts is given together with the condition for multiple steady states derived in  <cit> , here extended to a broader class of systems. the main contribution of the paper is presented in the results and discussion section where we develop the inverse bifurcation method exploiting the multistationarity condition to infer kinetic parameters of bistable networks. the method presented provides an alternative way of estimating parameters with few  experimental data, and can also be combined with standard techniques . as a proof of concept we apply our method to estimate the kinetic parameters of a genetic toggle switch model.

methods
reaction network graph and dynamics
we consider biochemical reaction networks with mass action kinetics where the dynamics are modeled by systems of ordinary differential equations . the structure of mass action kinetic models is given by the connectivity and the stoichiometry of the network and the parameters are the kinetic rate constants. let us denote by m the number of species and by r the number of reactions in a reaction network, the balance equations describing the dynamics of the concentrations of the species involved are a set of odes usually written as ċ=nv, with c∈ℝ≥0m being the vector of concentrations, n∈ℝm×r the stoichiometric matrix and v∈ℝr the vector of reaction ratesb. within the context of crnt alternative ways to encode the balance equations are used such that the connection between structure and dynamics can be more easily exploited  <cit> . results in this paper rely on a particular representation of the balance equations already introduced in  <cit> , which is based on the graph of complexes of a reaction network and briefly presented next.

for illustrative purposes we consider the mechanism in figure  <dig> where the transformation of a protein s to its active form p is mediated by another protein or enzyme e, whereas s inhibits its own activation. the complexes of the network are the linear combinations of species at both sides of the reaction arrows and the number of complexes is denoted by n. in the graph of complexes of a reaction network the nodes are the complexes c <dig> …,cn and the edges are the reactions. the subgraphs are called linkage classes and the number of linkage classes is denoted by ℓ. two nodes ci, cj are strongly linked if there is a directed path from ci to cj and also a directed path from cj to ci. a terminal strong linkage class is a maximal set of nodes within a linkage class such that there is no edge pointing to any other set of nodes strongly linked. the number of terminal linkage classes is denoted by t. networks with t>ℓ are considered in general to be unsuited for the description of real chemical systems  <cit> . in what follows, we focus on networks where t=ℓ .graph of complexes for the protein activation mechanism. every node of the graph corresponds to a network complex. the zero complex  represents the environment.



for a reaction network being bistable there is necessarily an exchange of matter and/or energy through the boundary of the system. according to the second law of thermodynamics isolated systems evolve towards the thermodynamic equilibrium. isolated reaction networks endowed with mass action kinetics achieve the thermodynamic equilibrium which has been demonstrated to be globally asymptotically stable  <cit>  precluding any kind of complex nonlinear behavior such as bistability or limit cycles. a reaction kinetic system is thermodynamically isolated if there is no matter exchange with the environment and the kinetic constants are such that the detailed balance condition is fulfilled  <cit> .

exchange of matter can appear implicitly, as it happens in reactions of the form s→2s, or explicitly in the form of pseudo reactions of the species that are entering or going out of the control volume with a zero complex representing the environment. in the context of signaling, we use the same formalism of pseudo reactions with the environment to account for the formation or degradation of a species s .

in our example we consider the degradation of the species s and p, and the constitutive formation of the inactive form s. the corresponding graph of complexes is depicted in figure  <dig> where every complex is labeled with a number i from  <dig> to n.

once species and complexes are labeled  we build the molecularity matrix y∈ℝm×n, where yij is the molecularity of the species i in the complex cj. every complex cj for j= <dig> …,n has an associated mass action monomial: 
  ψj=∏i=1mciyij, 

and every arrow in the graph, going from complex cj to complex ck is weighted by a rate constant kjk. the corresponding reaction rate is vjk=kjkψj. within this framework the balance equations read: 
  ċ=yaψ, 

where the matrix a∈ℝn×n is built from the adjacency matrix of the graph and contains the kinetic rate constants  <cit> .

as a consequence of the mass conservation laws the trajectories of eq.  in the concentration space are constrained to a convex region known as the reaction polyhedron  <cit>  or stoichiometric compatibility class, which is next defined after introducing the stoichiometric subspace. the stoichiometric subspace is the subspace spanned by the columns of the stoichiometric matrix n. considering the formulation in eq. , it can be defined for networks with t=ℓ as s:=im. we denote by s the dimension of the stoichiometric subspace, i.e. dim=s. the number of independent conservation relations is given by m−s. let b be a matrix such that the rows of bt are a basis of the left null spacec of ya, i. e. tb= <dig>  let us take a reference concentration vector c <dig> and define 
  w=bt, 

the reaction polyhedron consists of all c≥ <dig> such that w= <dig>  closed reaction networks are conservative systems  <cit> , i.e. all the species participate in at least one conservation law and therefore there is a strictly positive row vector v  such that vs= <dig>  on the contrary, open systems are not conservative. the existence of conservation laws implies that the ode system  is not minimal, i.e. some equations depend linearly on the others. we can alternatively describe the system by a set of s linearly independent odes and a set of m−s algebraic equations of the form: 
  btc=b, 

with b=btc <dig>  the original system of odes is thus transformed into a system of differential algebraic equations . the derivation of the set of odes  and the dae system for the protein activation network is included in additional file  <dig> 

locus of equilibria and tangent bifurcation condition
a condition for multiple steady states in biochemical reaction networks is derived and demonstrated in  <cit>  for weakly reversible networks. in the context of intracellular processes, networks are often non weakly reversible. however, in the general case they fulfill t=ℓ, i.e. they have a number of linkage classes equal to the number of terminal linkage classes . for networks with t=ℓ the condition in  <cit>  is still valid. for the sake of completeness, we briefly summarize next the derivation of this condition, simplified and adapted to t=ℓ networks. the reader can find the detailed derivation and proof in  <cit> , from which the validity for t=ℓ networks follows.

the system in eq.  is at equilibrium for any c that satisfies yaψ= <dig>  equivalently, one can say that a vector z∈ℝn defined as z=aψ belongs to the deficiency subspace: 
  dδ:=ker⋂im. 

the dimension of this subspace is the deficiency of the network, δ=dim. for networks with t=ℓ the deficiency is given by the formula δ=n−ℓ−s, and a basis ω <dig> …,ωδ for the deficiency subspace dδ can be computed from graph matrices taking into account that: 
  span=keryΛt, 

where Λ is a n×ℓ matrix in which entry Λij= corresponds to the node ci in the linkage class ℒj such that Λij= <dig> if ci∈ℒj and Λij= <dig> otherwise.

since the vector z defined above is a linear combination of the vectors of the basis of dδ, we have: 
  aψ=∑i=1δαiωi. 

on the other hand, from eq.  provided that ψ> <dig>  we get: 
  lnψ=ylnc. 

from eqs.  and , a set of n−ℓ linearly independent equations can be obtained in terms of the state vector c∈ℝ>0m, the deficiency parameter vector α∈ℝδ and the kinetic parameter vector k∈ℝ>0r: 
  ℋs= <dig>  

where ℋs:ℝ>0m×ℝδ→ℝn−ℓ is continuous and differentiable, given a rate constant vector k. eq.  describes the locus of equilibria of a reaction network . wherever this locus is continuous eq.  defines the so called equilibrium manifold of dimension λ=m−s.

the system in eq.  together with an initial concentration vector c <dig> describes an initial value problem. a reaction network has a unique steady state if for all the initial conditions stoichiometrically compatible with c <dig> the system reaches the same equilibrium c∗, which is also stoichiometrically compatible with c <dig>  the steady state is, in fact, the intersection between the equilibrium manifold and the reaction polyhedron defined by w= <dig>  where w has been introduced in eq. . typical bistable systems show three intersections, one of them corresponding to an unstable steady state  <cit> , as illustrated in figure  <dig>  if the equilibrium manifold and the reaction polyhedron become tangent at some point of the state space, multiple steady states appear, at least, for some stoichiometric compatibility classes. here it is important to remind that if the network has deficiency  <dig> and is weakly reversible then bistability is necessarily excluded according to the deficiency zero theorem  <cit> .scheme illustrating the condition for multistationarity for
λ
=
δ
= <dig>  in this diagram the intersections between the equilibrium manifold and the reaction polyhedron correspond to two stable equilibrium points  and one unstable equilibrium point .



let us assume δ=λ= <dig> such that the manifold is a one dimensional curve. starting from the equilibrium manifold  and taking derivatives with respect to α, we obtainddcℋsdcdα+dαℋs= <dig> and therefore the derivative of c with respect to α is given by 
  dcdαα;k=−dcℋs−1dαℋs. 

the equilibrium manifold and the reaction polyhedron are tangent provided that btdcdα= <dig>  with b being introduced in eq.  . this geometric condition is generalized for arbitrary deficiency and manifold dimension by defining the following matrix: 
  g=dcℋsdαℋsdcwdαw, 

where dcw=bt and dαw= <dig>  the equilibrium manifold and the reaction polyhedron become tangent when the determinant of matrix  vanishes, i.e.: 
  detg= <dig>  

the tangent bifurcation condition for the protein activation network is derived in additional file  <dig>  this network fulfills δ=λ= <dig>  the corresponding equilibrium curves for a given set of parameters are depicted in figure  <dig> where it can be observed how the equilibrium manifold is tangent to the direction of the reaction simplex in two different points of the state space . these points correspond to tangent bifurcations, also known as saddle nodes or limit point bifurcations, indicated by lp in figure 3b and c, where the steady state concentration values of the species ess and s are depicted with respect to the concentration of total enzyme et.equilibrium manifold and tangent bifurcation points for the protein activation mechanism.
a) equilibrium manifold in the space of the species. b-c) bifurcation diagrams showing the steady state concentration of the species ess and s versus the total enzyme.



RESULTS
parameter inference from dose response curves: deficiency one networks
dose response curves, also known as stimulus response curves  <cit> , are x-y diagrams commonly used to represent the input-output behavior of biochemical networks where x is the magnitude of a measurable stimulus  and y is the magnitude of the associated system’s response.

in what follows we refer to dose response diagrams obtained when the steady state concentration of a given species  is plotted against some parameter . the parameter can be a kinetic rate or a conservation law constant, i. e. the total amount of an enzyme or conserved moiety, bi in eq. . linear combinations of species of the form qi=qic are also admitted as outputs, where q is a matrix defining a linear map from the space of the species to the space of the observables.

if the structure and parameters of a biochemical reaction network model are known, dose response curves can be obtained computationally from the model equations using a continuation algorithm  <cit> . in a typical bistable system two tangent bifurcations appear during the equilibrium continuation, where the direction of the parameter reverses as the curve is followed . these two tangent bifurcations enclose the range of the bifurcation parameter leading to bistability  <cit> .scheme of a bifurcation diagram for a bistable reaction network and its corresponding forward and backward dose response curves.
a) bifurcation diagram where the x-axis is the total concentration of a particular moiety and the y-axis is the concentration of a given species. stars indicate tangent bifurcations also known as saddle nodes or limit points . unstable equilibria lie on the dashed curve. b) corresponding forward dose response curve. c) corresponding backward dose response curve.



experimentally, dose response curves are obtained by measuring the steady state concentration of a given species for increasing/decreasing values of the parameter at hand. increasing or decreasing the parameter we obtain the forward  or the backward  dose response curve respectively. typical bistable systems show hysteretic behavior, leading to differences between parameter increase  and decrease  as illustrated in figure 4b and c. for bistable systems, the tangent bifurcation points in the dose response curves can be located by means of experimental measurements. details on the experimental procedures are out of the scope of this paper.

suppose that we know the structure of a biochemical network with capacity for bistability and we want to know the values of the kinetic parameters. next, we introduce a methodology to infer the parameters of the network from dose response curves, or more precisely, from the tangent bifurcation points.

for illustrative purposes we focus first on structures where δ = λ= <dig> and we consider dose response curves where the input is the total amount of a particular moiety, i.e. where a conservation law constant bi is plotted on the x-axis, and the concentration of a species cj, or a combination of species qj, is plotted on the y-axis. as it is illustrated in figure  <dig>  from the forward and backward dose response curves we can elucidate the values of the parameter b where the tangent bifurcations appear, or in other words, the lower and upper values of the mass conservation constant  enclosing the region where bistable behavior is observed.

the two points defining the lower and upper bound of the region of bistability in the dose response curve indicate two different stoichiometric compatibility classes tangent to the equilibrium manifold. they correspond, in fact, to two different points in the state space cl=c and cu=c where the tangent bifurcation condition is fulfilled. therefore, we have: 
 btdcdααl;k=btdcdααu;k= <dig>   where dcdα is given by eq.  and c> <dig>  c> <dig> belong to the equilibrium manifold, i.e.: 
 ℋscαl;k,αl;k=ℋscαu;k,αu;k= <dig>  

we search for a parameter vector k such that the equilibrium manifold is tangent to the reaction polyhedrons fixed by bl and bu.

in order to efficiently search for a point in the space of the kinetic parameters satisfying all the conditions above we can solve an optimization problem. first, we define the objective function to be minimized : 
 j0k,α <dig> α2=∑i=12btdcdααi;kdcdαtαi;kb, 

such that at the optimum j0= <dig> the geometric condition is fulfilled. the optimization problem can be formulated as: 
  minimizej0k,αl,αuk∈ℝ>0r,αl,αu∈ℝsubject to:ℋscl,αl;k= <dig> ℋscu,αu;k=0bt·cl=bl,bt·cu=buq·cl=ql,q·cu=qucl> <dig> cl∈ℝmcu> <dig> cu∈ℝmpl≤p≤pupl,pu∈ℝr+ <dig>  

where r is the number of kinetic parameters, p is the decision vector containing the kinetic parameters k and the deficiency parameters αl and αu. the lower and upper bounds for the decision variables are denoted by pl and pu respectively and the equilibrium manifold equations are treated as equality constraints. the values of bl and bu, as well as the corresponding concentrations  or combinations of concentrations  at the bifurcation points are obtained from dose response curves. this optimization problem is non convex and multimodal and consequently a global optimization algorithm  <cit>  is used to search for the solution.

by solving the optimization problem  we obtain a parameter vector k which is compatible with the observed dose response behavior. it is important to note here that, although we obtain a single point k in the parameter space as the output of the global optimization algorithm, the solution of the optimization problem  might not be unique, indicating that the set of parameters chosen cannot be identified univoquely. identifiability of the parameters a priori, which depends on the network structure and the available observables is tackled next, where we propose a procedure to find a set of parameters and/or parameter combinations that can be identified univoquely.

parameter inference from dose response curves: general formulation
we have illustrated, for bistable networks of deficiency one and equilibrium manifold of dimension one, how to efficiently find a set of parameters starting from dose response curves, such that the tangent bifurcation condition is fulfilled at the two points enclosing the bistability interval in the dose response diagram. next we generalize the method such that: 
it is valid for networks of arbitrary deficiency and manifold dimension,

it is valid for different types of dose response curves,

it allows to identify a set of parameters of the network with their confidence intervals starting from experimental data subject to noise.



to this aim, we first propose a numerical strategy to elucidate a priori a set of parameters or parameter combinations which can be identified univoquely from the data. then, we use a monte carlo approach to estimate the parameter values and confidence intervals.

error free analysis and identifiability a priori: constraint satisfaction problem
in order to tackle the identifiability a priori, we consider the error free case where neither experimental nor model error is assumed, and explore the parameter space in order to find the viable parameter regions i.e. subsets of the parameter space where the reaction network model maintains the desired behaviour. in this case, the location of the bifurcation points of the model in the bifurcation diagram must coincide with the location observed in the experimental dose response curves. to this aim we formulate next a constraint satisfaction problem  <cit>  where a set of constraints impose the desired conditions on the decision variables.

we define the decision vectorp∈ℝr+2λ. it contains, on the one hand, the kinetic parameters that are unknown  and, on the other hand, the degrees of freedom which are needed to define the equilibrium manifold at the two bifurcation points. for networks with λ=δ we take the deficiency parameter vectors αl,αu∈ℝδ. for networks with λ≠δ a total of 2λ variables are taken from the vectors of deficiency parameters αl,αu∈ℝδ and/or the concentration vectors cl,cu∈ℝm.

a first set of  constraints is given by: 
  detgcl,αl;k=detgcu,αu;k= <dig>  

with k∈ℝ>0r, αl,αu∈ℝδ. a second set of  constraints is given by the equilibrium manifold equations: 
  ℋscl,αl;k= <dig> ℋscu,αu;k= <dig>  

the mass conservation laws and the observed concentrations constitute the third set of  constraints: 
  bit·cl=bl,bit·cu=buq·cl=ql,q·cu=qu. 

where the values of bl and bu, as well as the corresponding concentrations  or combinations of concentrations  at the bifurcation points are obtained from dose response curves. finally, a set of  constraints is given by 
  cl> <dig> cl∈ℝmcu> <dig> cu∈ℝmpl≤p≤pupl,pu∈ℝr+2λ, 

where pl and pu are lower and upper bounds for the decision vector variables.

when the stimulus in the dose response curve is a manipulable kinetic parameter or rate constant, ki, two extra equality constraints need to be satisfied, indicating the values of the manipulable parameter at the lower and upper bifurcation points . the dose response curves are obtained in this case, for example, by fixing the kinetic parameter at hand at different values and measuring the corresponding steady state concentration of the species of interest.

as indicated, the dimension of the decision vector will depend on the number of kinetic parameters that remain unknown and the number of degrees of freedom that need to be fixed to define the equilibrium manifold.

in order to find the regions in the parameter space where the constraints  are satisfied we use the algorithm for exploration of parameter spaces by zamora-sillero et al.  <cit> . this algorithm has been shown to efficiently search for pre-defined conditions in high dimensional, non convex and poorly connected viable spaces, characteristic of complex biological networks. it combines local and global explorations of the parameter space, where for the global search, an adaptive metropolis monte carlo method allows to identify poorly connected viable regions. here, we use the algorithm to identify the viable regions containing those parameter vectors allowing for bistability and, in addition, compatible with the expected dose response behavior. the constraints are encoded in a cost function and the algorithm can search through the parameter space for different cost thresholds. the algorithm requires an initial viable point as an input. to start the exploration we take the optimum obtained by minimizing : 
  j1k,α <dig> α2=∑i=12detgci,αi;k <dig> 

subject to the constraints already defined by . this optimization problem is non convex and multimodal and we solve it by means of a global optimization method  <cit> .

the exploration algorithm provides as an output a large set of uniformly distributed viable points that allow to characterize the viable regions in the parameter space, i.e. those regions in the space of parameters that fulfill the constraints imposed  <cit> . the large set of viable points obtained is used to assess numerically which parameters and/or combinations of parameters are locally identifiable a priori starting from a given set of observables, by evaluating the viable regions obtained.

we use this approach in order to find a set of identifiable parameters in the protein activation network model. we take as observables the total enzyme concentrations at the lower and upper bifurcation points, bl=etl and bu=etu respectively, as well as the concentrations of s, ess and p. the corresponding values are included in table  <dig>  starting from these observables, a set of identifiable parameters ρ <dig> …,ρ <dig>  is obtained. these identifiable parameters are shown in table  <dig> together with the expressions in terms of the kinetic rate constants and the corresponding viable ranges. here it is important to remark that, if the set of parameters is identifiable, a lower threshold in the cost function value leads to narrower viable parameter regions. as an indication of performance, for the protein activation model with its original parameterisation  a single run of the exploration algorithm found  <dig> viable points in  <dig> seconds.observable values for the protein activation network 



etl
etu
[
s
]
l
[
s
]
u
[
e
s
s
]
l
[
e
s
s
]
u
[
p
]
l
[
p
]
u



parameter
equivalence
lower bound
upper bound
monte carlo confidence interval

ρ
1
k
14/k
41

ρ
2
k
18

ρ
3
k
26/k
62

ρ
4
k
37/k
73

ρ
5
k
57

ρ
6
α
l

ρ
7
α
u

k
 <dig> and k
 <dig> were fixed at  <dig> and  <dig>  respectively.



the bifurcation diagrams and tangent bifurcation points computed for the viable parameter regions are depicted in figure  <dig>  where the different colors indicate different thresholds of the cost value.bifurcation diagrams and tangent bifurcation points for the protein activation mechanism.
a-d) bifurcation diagrams. e-h) tangent bifurcation points.



experimental uncertainty and practical identifiability: monte carlo approach
in a real experimental scenario we expect to get a number of replicate measurements for each data point which are subject to experimental error, and we need to estimate the unobserved kinetic parameters k from the datae.

let k^ be a vector of estimates of k, and α^l, α^u the estimated values of the deficiency parameter vectors for the lower and upper bifurcation points. the lower and upper conservation law constants can be expressed as: 
 bl=bitcα^l;k^+εbl,bu=bitcα^u;k^+εbu,  where εbl and εbu represent vectors of residuals. similarly, the expressions for the concentration observables read: 
 ql=qitcα^l;k^+εql,qu=qitcα^u;k^+εqu. 

we can express the sum of squares of the residuals between the observed responses in the data set and the model prediction as a function of the kinetic parameters and deficiency parameters αl and αu : 
  j2k,α <dig> α2=∑i=12bi−btciαi;ktbi−btciαi;k+…∑i=12qi−qciαi;ktqi−qciαi;k. 

we seek for estimated values of the unknown parameters that, on the one hand minimize the sum of the residuals between observed and predicted bifurcation points, and on the other hand ensure that the tangency condition is fulfilled. therefore, the parameter estimation is formulated as an optimization problem with two individual objectives. both the function j <dig> defined in eq.  and the function j <dig> are optimized simultaneously. since the objectives are not conflicting we can directly minimize a weighted sum of j <dig> and j <dig>  with weights w <dig> and w <dig>  the problem thus reads: 
  minimize∑i=12wijik,αl,αuk∈ℝ>0r,αl,αu∈ℝsubject to:ℋscl,αl;k= <dig> ℋscu,αu;k=0cl> <dig> cl∈ℝmcu> <dig> cu∈ℝmpl≤p≤pupl,pu∈ℝr+2λ, 

besides the actual values of the parameters, in presence of experimental noise our goal is to obtain information on the confidence intervals of the estimated parameters. to this aim, we propose a monte carlo approach consisting of the following steps: 
assuming we have enough number of experimental replicates, a probability distribution is fitted to the experimental data. here we assume normally distributed data, but the best choice of the probability density function is to be decided upon the retrieval of the experimental data with regards to the specificities of the system under study and the data acquisition technique. lets remind that the input data for the inverse bifurcation method are experimental measurements of the bifurcation points in dose response curves. depending on the experimental set up, we might choose univariate or multivariate distributions to fit our data.

a number m of replicates of the observed data is sampled from the distributions previously fitted. for each sample, we solve the optimization problem , obtaining one optimal parameter set. in this way, starting from m samples we obtain a distribution for every parameter.

statistical properties of the resulting distributions for the estimated set of parameters are calculated. starting from the probability distribution estimates, robust confidence intervals and parameter correlations analysis can be computed  <cit> .



as a proof of concept, we apply the approach proposed to the protein activation example with in silico noisy data. we take as observables, as in the previous analysis, the total enzyme concentrations at the lower and upper bifurcation points, bl=etl and bu=etu, as well as the concentrations of s, ess and p. in particular, we assume that we get from experimental dose response curve analysis measurements for the following pairs: etl,l, etl,l, etl,l, and etu,u, etu,u, etu,u. the goal is to obtain the corresponding distributions for the identifiable parameters ρ <dig> …,ρ <dig> defined in table  <dig> 

we generate the in silico data starting from the noise free data in table  <dig>  assuming normally distributed and uncorrelated error, proportional to the mean. note that the assumptions about the error distribution and correlation might be different for different problems and experimental conditions without affecting the applicability of the method. a number of random replicates is taken from the fitted distributions in order to apply the proposed inverse bifurcation approach. the complete set of experimental data used is depicted in figure 6a, b and c, where the fitted distributions obtained from the data are shown , together with the replicate samples . the optimization problem  is solved for each sample using the scatter search global solver by egea et al.  <cit> . the average computation time spent by the solver in every run to get the optimal set of parameters is  <dig> seconds.uncertainty propagation from the measurements to the parameters for the protein activation network.
a-b-c) experimental data. the distributions obtained by fitting the original in silico experimental data are represented by the red ellipses . the blue dots are the random samples taken from the distribution. d-e-f-g-h-i-j) inferred parameter distributions. monte carlo 95% confidence intervals are enclosed by green lines. distribution means are indicated with red lines.



the histograms obtained for every parameter by applying the inverse bifurcation method proposed are shown in figure 6d-j.

parameter estimation via inverse bifurcation of a genetic toggle switch
the capacity for bistability is found in some specialized gene circuits like the bacteriophage lambda switch  <cit> . the interest in genetic switches, also involving networks of non-specialized regulatory components, led to the engineering of the first toggle switch in bacteria described in  <cit> . in that work, the authors designed a synthetic, bistable gene circuit based on the predictions of a simple mathematical model consisting of two ordinary differential equations where the repressor binding was described by hill functions. the conditions for bistability in the two dimensional ode model were explored by  <cit>  using nullcline analysis.

here we are interested in the inverse problem. starting from a gene regulatory network with experimental evidence for bistability and assuming that the underlying model structure is known, we want to estimate the kinetic parameters of the model. through this example, we show how our inverse bifurcation method allows to exploit the capacity for bistability to infer the kinetic parameters of the network. in silico data are used aiming to mimic a realistic experimental scenario.

we assume that the gene regulatory network under study is shown experimentally to be bistable. in particular, a characteristic all or none hysteretic response is observed in the system when one of the decay constants is gradually varied.

the underlying mechanism is a regulatory network with the same design principle described in  <cit> , i.e. a repressor p <dig> inhibits the transcription of the repressor p <dig> from gene g <dig>  and the repressor p <dig> inhibits the transcription of the repressor p <dig> from gene g <dig>  the corresponding reaction network is depicted in figure  <dig>  the mutually inhibitory arrangement of the repressor genes together with the cooperativity of repression of gene g <dig> endow the system with capacity for bistability. assuming mass action kinetics for all the interactions this model structure is, in qualitative terms, compatible with the experimental behavior observed.graph of complexes for the gene regulation toggle switch. every node of the graph corresponds to a network complex.



in order to infer the parameters of the model using the inverse bifurcation method, we need to localize the tangent bifurcation points based on dose response measurements. in this case, a manipulable decay constant, the degradation rate constant corresponding to the protein p <dig>  is chosen as the bifurcation parameter. this degradation rate constant is fixed at different values and the corresponding concentrations of different species are measured at steady state. in this case we chose as observable the concentration of proteins p <dig>  p <dig> and the intermediate complex g2p <dig>  but different selections are possible, depending on what can be measured in a particular experimental scenario.

from the dose response measurements, two tangent points are localized, at low and high decay constant values k713l= <dig> , k713u= <dig> . the steady state concentrations of the selected species  are measured at these values of the decay constant. the in silico experimental dose response data  are shown in the figures contained in the additional file  <dig>  where we plot the steady state concentration measurement of each species obtained at k713l versus the one obtained at k713u.

the gene regulation network has two mass conservation laws  and the corresponding mass conservation constants are g1t=g2t= <dig> , computed from the gene copy numbers and the cell volume.

in order to find a set of identifiable parameters we first make use of the constraint satisfaction method proposed, starting from noise free data . the numerical values for every observable are included in table  <dig>  the set of parameters ρ <dig> …,ρ <dig> defined in table  <dig> is found to be identifiable a priori. for the original  <dig> dimensional parameter space the exploration algorithm found  <dig> viable points in  <dig> seconds.observable values for gene regulation toggle switch 



[
p
1
]
l
[
p
1
]
u
[
g
2
p
1
]
l
[
g
2
p
1
]
u
[
p
2
]
l
[
p
2
]
u



parameter
equivalence
monte carlo confidence interval

ρ
1
k
18/k
213

ρ
2
k
18/k
310

ρ
3
k
49/k
94

ρ
4
k
511/k
115

ρ
5
k
612/k
126

ρ
6
α1l

ρ
7
α2l

ρ
8
α1u

ρ
9
α2u

k
 <dig> was fixed at  <dig> 



we apply the monte carlo approach previously introduced taking  <dig> random samples from the data distributions . the parameter distributions obtained by the inverse bifurcation method are depicted as histograms in additional file  <dig>  from the parameter distributions we compute the confidence intervals and the parameter correlations. the corresponding robust monte carlo confidence intervals are depicted together with the histograms in additional file  <dig> . the two dimensional correlation among the parameters is illustrated in figure  <dig>  these results show the successful performance of the method for parameter estimation of the toggle switch model with in silico noisy data.parameter correlations for the gene regulation toggle switch. white contours represent the 95% pairwise confidence ellipses of the covariance matrix.



CONCLUSIONS
we develop an inverse bifurcation method that allows to estimate kinetic parameters from experimental dose response curves in bistable systems. the method is suitable for a broad class of biochemical models and dose response data where the stimuli are kinetic or mass conservation constants and the responses are the steady state concentrations of species involved.

in order to infer a set of kinetic parameters of a bistable switch compatible with the available dose response experimental data, the inverse bifurcation is formulated as an optimization problem and solved by a global optimization algorithm  <cit> .

the method exploits the inherent structural properties of biochemical reaction networks. on the one hand, inherent properties of reaction networks were used to derive  the ‘tangency’ condition from the reaction graph, used here instead of a generic bifurcation condition. on the other hand, the method uses the insight that tangent bifurcation points are precisely the loci where the equilibrium manifold and the reaction simplex become tangent. the tangency condition is an algebraic expression dependent on the parameters that can be systematically computed from the graph matrices. in this way our method avoids simulating the system at every iteration of the optimization algorithm reducing dramatically the computational effort in comparison to direct fitting .

as a first approach to assess the identifiability a priori and select a set of parameters which are identifiable, we propose a constraint satisfaction problem. this problem is numerically solved by an algorithm  <cit>  that allows to efficiently explore large search spaces to obtain a large set of uniformly distributed points characterizing the viable regions in the parameter space. the parameters that can be directly identified depend on the structure of the equilibrium manifold equations and the dose response data available. this first approach to identifiability is local and heuristic. a complete analytic understanding on how to find a priori a set of identifiable parameters is subject of future work.

in presence of experimental uncertainty, monte carlo simulation and global optimization are combined to generate the parameter distributions compatible with the experimentally observed behavior.

in this work we show how a set of parameters can be identified using only information about the location of the bifurcation points in the dose response curves. the inverse bifurcation method could also be applied in combination with standard approaches , to significantly improve identifiability and facilitate the parameter estimation task.

the method has been successfully applied to a number of examples of interest in biology including a protein activation network and a gene regulatory toggle switch, illustrating the potential of the chemical reaction network theory for kinetic model identification.

endnotes
a in this paper we use experimental data generated in silico.

b the time derivative dxdt of a vector x depending on time t is denoted by x˙. the space of n dimensional real vectors is denoted by ℝn and the space of m×n real matrices by ℝm×n. the space of n dimensional real vectors with all strictly positive entries is denoted by ℝ>0n and the space of n dimensional real vectors with all nonnegative entries by ℝ≥0n.

c in what follows we denote the null space  of a matrix x by ker.

ddxf denotes the jacobian of f with respect to x.

e we here assume for simplicity that the set of parameters k is identifiable. in case a different set of parameters ρ is found to be identifiable a priori the decision vector k is replaced by ρ.

additional files
additional file  <dig> 
further details on the method for inverse bifurcation. in this file, detailed computations for the protein activation network and the gene regulatory toggle switch examples are included.



additional file  <dig> 
in silico experimental data for the gene regulation toggle switch. in this figure, the in silico experimental data for the gene regulation toggle switch example are depicted  and random samples taken from the distribution .



additional file  <dig> 
parameter distribution histograms and monte carlo confidence intervals for the gene regulation toggle switch. distribution means are indicated by vertical red lines and confidence intervals  are enclosed by green lines.



competing interests

the authors declare that they have no competing interests.

authors’ contributions

iom and py performed the research. iom developed the theory and conceived and designed the experiments. js contributed to experiment design. iom and py wrote the manuscript. all authors read and approved the final manuscript.

