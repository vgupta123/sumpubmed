BACKGROUND
dna microarray and next generation sequencing technologies allow researchers to screen ten thousands of genes for differences in expression between up to hundreds of individuals or experimental conditions of interest. not only the progressively increasing data throughput of newest array and sequencing technologies challenges data analysis methods but also the increasing availability of large data sets from public data repositories such as gene expression omnibus  or array express  with to date hundred thousands of different assays implying large-scale meta-analyses. these resources pose a challenge how to best arrange and to visualize the huge heaps of data in a fashion that enables combination of sample- and gene-centered views on multidimensional expression data to capture the global picture of groups of samples while simultaneously presenting the specific expression pattern within each individual sample.

self-organizing map  machine learning was developed by kohonen about thirty years ago  <cit> . it projects data from the original high dimensional space to reference vectors of lower dimension. first studies applying som to microarray gene expression data were published by tamayo et al.  <cit>  and törönen et al.  <cit> . these and later applications of the som method to expression data emphasized either a gene-centered perspective to cluster genes  <cit>  or a sample-centered mode to map individual samples onto the som grid enabling the classification of samples into a small number of diagnostic or prognostic groups  <cit> . the som method can be configured also in such a way that it combines both, the sample- and gene-centered perspectives  <cit> . this specific approach decodes the expression pattern of ten thousands of genes per sample into a two-dimensional mosaic pattern which allows the sample-to-sample comparison of expression profiles by direct visual inspection.

it has been demonstrated that such som displays are featured by several important benefits  <cit> :  they provide an individual visual identity for each sample;  they reduce the dimension of the original data;  they preserve the information richness of the molecular portraits allowing the detailed, multivariate explorative comparisons between samples,  they are highly intuitive not-requiring specific knowledge of the underlying algorithmic kernel of the method, and  they can be treated as new, complex objects for next level analysis in terms of visual recognition.

som-based gene expression analyses have been applied, for example, in studies on cell differentiation and development  <cit> , organogenesis  <cit>  and tumor differentiation  <cit> . it has been demonstrated that som analysis can visualize relevant substructures inherent in the data without forcing them into hierarchies and without significant loss of primary information  <cit> . this intuitive image-based perception clearly promotes the discovery of qualitative relationships between the samples in the absence of an existing hypothesis. the som approach also offers new concepts of data analysis based on, e.g., metagene summaries, global entropy estimates and state-space trajectory characteristics  <cit> .

despite its convincing advantages the som method is relatively infrequently applied to high-dimensional molecular data compared with alternative approaches such as hierarchical clustering. possibly, interpretation of som mosaic patterns is less trivial and/or unusual for many researchers because it requires basic understanding of details of the method such as the way how expression of real genes transforms into expression profiles of the metagenes. the lack of availability of this information presumably hampers application of som-based methods in a wider number of applications. moreover, standard analysis tasks such as feature selection, significance analysis of differential expression and functional gene set enrichment analysis require the availability of appropriate algorithms and of suited program tools to generate the desired information. such approaches must consider the specifics of gene expression analysis  on one hand, but also the specifics of som-machine learning on the other hand.

we strongly advocate in favor of the som method. the present publication aims at bridging the gap between the potency of som-machine learning to reduce dimension of high-dimensional data on one hand and its availability with special emphasis on gene expression analysis on the other hand. our approach includes a series of analytical reports which might support interpretation of som metagene data  and an available r-program package. here we focus on the identification and functional interpretation of metagene clusters using gene set overrepresentation analysis, a novel aspect in the context of som analysis, and on the comparison of data analysis based on single and on metagenes.

we apply our approach to expression data of human tissues which is well suited as an illustrative example: the selected  <dig> tissues provide a sufficient large data set of highly diverse expression pattern possessing a complex internal covariance structure. moreover, the samples are well classified in terms of distinct tissues and tissue categories allowing the clear assignment of expression pattern. the discovery of this human body index data set is also motivated by the argument that tissue-specific rna expression pattern indicate important clues to the physiological function of the coding genes, suitable as a reference for comparison with diseased tissues. our analysis thus provides a first step towards a som atlas of gene activity in normal human tissues which complements previous work on this objective  <cit> .

we address selected methodical aspects of the som method which aim at extracting functional information about the expression pattern: firstly, we complement the gallery of primary som images with a number of summary maps characterizing the covariance structure of the data after transformation into latent variables. these summary maps allow extraction of so-called spot-clusters which collect co-expressed metagenes together. this spot-clustering enables to significantly reduce the dimensionality of expression data to a handful of representative expression-modules in an unsupervised fashion. the results of som-clustering are compared with the results of alternative methods such as non-negative matrix factorization, hierarchical clustering and sets of correlated genes. secondly, the detected spot-clusters are linked with biological knowledge to support functional interpretation of the data based on the 'guilt by association' principle. particularly, we apply gene set overrepresentation analysis to visualization space which is a novel approach to our best knowledge. thirdly, we analyze the capability of the som approach for data filtering and dimension reduction in terms of maintaining representativeness and reduction of noisiness of the data. finally, we applied som analysis in a zoom-in step to a subensemble of tissues to increase the resolution of the method. we use the sample-centered second-level som representation to visualize similarity relations between the different tissues and compare the results with independent component analysis.

the main paper is supplemented with additional files which provide the full gallery of som-images of human tissues, a detailed methodical section addressing issues such as calibration of microarray raw intensity data to minimize possible artifacts due to systematic biases caused by improper preprocessing  <cit> , the configuration of the som-method and additional options of data analysis. we developed our own r-program including all analysis functionalities described below for application of the method. the program is available as cran-package 'opossom'.

 <dig>  
RESULTS
 <dig> . expression maps of human tissues
microarray expression data taken from the human body tissue index data set were input into the som machine learning algorithm after calibration and normalization of the raw probe intensities as described in the methods section below and in additional file  <dig>  our som method transformed the whole genome expression pattern of about  <dig>  single genes into one mosaic pattern per tissue studied. figure  <dig> shows selected som-fingerprints of  <dig> selected tissues using a  <dig> ×  <dig> mosaic grid. the collection of som profiles of the complete set of  <dig> tissues is given in additional file  <dig> . each tile of the som mosaics refers to one of  <dig>  metagenes characterizing the expression landscape of the data set. the metagenes act as representatives of miniclusters of single genes with similar expression profiles. their number varies from metagene to metagene . the color gradient of the map was chosen to visualize over- or underexpression of the metagenes in the particular tissue compared with the mean expression level of each metagene in the pool of all samples studied: maroon codes the highest level of gene expression; red, yellow and green indicate intermediate levels and blue corresponds to the lowest level of gene expression. each individual mosaic exhibits characteristic spatial color patterns serving as fingerprint of the transcriptional activity of the respective tissue sample.

the tissues are grouped into ten categories in accordance with the classification used in hornshoj et al.  <cit> . most of these categories show typical som-landscapes which are characterized by red and blue spots at specific positions due to over- and underexpressed metagenes as the most evident features. for example, the profiles of adipose tissues might be identified by the maroon-red overexpression spot in the right upper corner and those of nervous tissues by a similar spot in the top left corner.

some tissues combine the characteristic spot pattern of different tissue categories . for example, the expression fingerprint of tongue  shows the typical overexpression spot evident in the profiles of other epithelial tissues  but also the spot typically found in muscle tissues . the physiology of tongue tissue as a 'mucosa covered muscle' is thus reflected in the expression profile. another example is pituatary gland , an endocrine gland located near hypothalamus: its som landscape shows the upregulated spot found in other nervous system tissues  in the top left corner, as well as a unique spot in the bottom right area not found in the profiles of other tissues. this spot obviously collects genes which are specifically overexpressed in pituatary gland , whereas the first spot represents a common signature typically found in nervous system samples. some som-fingerprints are outliers in their tissue category: for example, small intestine , classified as digestive tissue, shows the overrepresentation pattern of muscle type tissues. this is not surprising as this organ consists of a double layer of smooth muscle. also myometrium , the smooth muscle of the uterus, is classified as muscle. its som expression profile however closely resembles that of endometrium  and also of ovary , reflecting the common function of these three organs in female reproduction.

in general, som fingerprints within a tissue category reveal similar pattern, whereas different tissue types show consistently different expression landscapes. such differences can be detected, for example, by simple visual inspection of the mosaic pattern of nervous, immune system and endocrine type tissues. hence, comparison of the som-textures allows the straightforward grouping of the tissues into different categories based on differences of their expression patterns.

 <dig> . metagene characteristics and overexpression spots
the metagene expression profiling map in figure 3a illustrates the systematic character of the alterations of metagene expression between different regions of the som. adjacent metagene profiles show similar profiles whereas more distant metagenes are different and partly show mirror symmetry with respect to the abscissa. in the centre of the map one finds virtually invariant metagenes whereas the profiles along the borders of the map strongly vary between different tissue categories. this distribution of the profiles reflects the fact that som machine learning tends to maximally segregate different modes of strong variation on one hand while maximizing the distance between such modes relative to virtually invariant profiles on the other hand. note also, that the number of real genes per metagene strongly varies throughout the map as indicated by the numbers given in each tile of the metagene expression profiling map.

the metagene expression profiling map uses a smaller number of tiles and thus a coarse grained latticing of the mosaic. the population and variance maps shown in panel b and c of figure  <dig> provide information about the number of single genes per metagene minicluster and the variability of the metagene profiles via appropriate color coding using the finer granularity of the mosaic. som-machine learning scales the difference between the expression profiles of adjacent metagenes inversely to their population, i.e., adjacent metagene profiles become more similar for highly populated metagenes. this way the method tends to distribute the single genes over as much as possible tiles. the population map reveals that the real genes inhomogeneously distribute among the tiles of the mosaic . highly populated metagenes  predominantly group along the edges of the map whereas only a few highly populated tiles are found in its central area. a zone of 'empty' metagenes lacking real genes  clusters in four regions halfway between the centre and the edges of the map. the tile of maximum population  refers to genes with virtually invariant, mostly absent specific expression in all tissues studied . these invariant genes give rise to the dark blue spot in the central area of the variance map . the variance map also reveals that other nearly invariant metagenes cluster around this tile in the central area of the map . both, invariant and empty metagenes carry essentially no specific information as classification markers in transcriptional profiling. hence, the tiles occupied by empty and invariant genes form regions not suited for differential expression analysis between the tissues studied.

the more variant and higher populated metagenes reveal an underlying spot like pattern preferentially along the boundaries of the map , which agrees with the over- and underexpression spots detected in the som mosaics of individual tissues. for an overview about all observed spots we generate two types of integral maps characterizing over- and underexpression, respectively . they transfer either the over- or the underexpression spots observed in the individual profile into one master map. the profiles of selected metagenes reveal marked under- and overexpression for distinct tissue types which transform into a characteristic spot patterns . for example, the metagenes in the top left corner show overexpression for nervous system and underexpression for immune system tissues whereas the metagenes in the bottom right corner are, in turn, characterized by overexpression in immune system tissues. table  <dig> assigns the different spots to the tissue mosaics in which they are observed.

synaptic transmission
system process
carboxylic acid metabolic process
carboxylesterase activity
organ development
reproduction
immune response
dna fragmentation during apoptosis
mitotic cell cycle
regulation of structural morphogenesis
protein maturation
biopolymer metabolic process
a spots are assigned in figure 3d and 3e. over- and underexpression spots are labeled using upper and lower case letters, respectively.

b top-three overrepresented gene sets

 <dig> . gene set overrepresentation
the som assigns mini-clusters of real genes to each metagene represented by a tile in the two-dimensional mosaic pattern. these metagenes collect sets of single genes with similar, mostly highly correlated expression profiles. the correlation and coexpression of the single gene profiles in each spot can be utilized as a simple heuristics with implications for tentative gene function because biological processes are usually governed by coordinated modules of interacting molecules  <cit> . application of gene set overrepresentation analysis to the metagene clusters makes use of this 'guilt-by-association' principle which assumes that co-expressed genes are likely to be functionally associated  <cit> . previous som analyses have shown that, indeed, functionally related genes cluster together in the som images  <cit> .

for each of the miniclusters we therefore estimate the degree of overrepresentation with respect to pre-defined gene sets using the hypergeometrical  distribution. it provides an overrepresentation p-value for each metagene and each gene set considered. we visualize the distribution of p-values of each gene sets using the same two-dimensional mosaic as used for the original som images and appropriate color-coding. the obtained overrepresentation maps allow identification of metagenes containing an enriched fraction of genes from a selected gene set by visual inspection. note that this map applies to all samples studied because each of the mini-clusters contains the same genes in all samples used to train the som. the overrepresentation map thus reflects the global enrichment pattern of a chosen set of genes in the experimental series studied.

overrepresentation analysis is not restricted to single tiles but it can also be applied to the over- and underexpression spots detected in the previous subsection. accordingly, overrepresentation of selected gene sets can be linked with additional properties of the expression profiles such as overexpression by combining spot selection with overrepresentation analysis. particularly, the genes associated with each spot are analyzed for overrepresentation of genes taken from the collection of  <dig> gene sets downloaded from the gsea-homepage according to the go-categories molecular function, biological process and cellular component . the hypergeometrical distribution then provides an ordered list of gene sets ranked with decreasing significance of overrepresentation for each of the spots.

the heatmap in figure  <dig> visualizes the metagene expression in each of the spots in the series of tissues studied. it allows to link overexpression with overrepresentation in a tissue- and spot-specific way. it clearly reveals that nervous , muscle  and homeostasis  tissues are characterized by essentially only one overexpression spot  with clearly assigned molecular function. some of the tissue-specific spots are also overexpressed in other tissues. for example, the muscle-specific spot b shows overexpression also in tongue and small intestine which partly contain muscle tissues as discussed above.

it is noteworthy that the enriched areas in the overrepresentation maps of the gene sets 'nervous system development' and 'immune response'  largely agree with the overexpression spots in the som images of nervous and immune system tissues, respectively. a non-negligible number of genes from these sets are however located in other regions of the map which are assigned to alternative molecular functions. for example, genes from the gene set 'immune response' accumulate in spot d assigned to tissue development. this spot is overexpressed in a larger number of tissues such as epithelium and adipose tissues which are not explicitly assigned to the category immune system tissues. moreover, subgroups of genes from these gene sets are located in the central area of the map which accumulates virtually invariant and weakly expressed genes . possibly part of the genes in these sets are incorrectly specified and/or possess a more complex activation pattern 'beyond' the similarity metrics used to train the som. we suggest that combination of gene set overrepresentation analysis with som-expression profiling allows verification and further refinement of existing gene sets.

in summary, gene set overrepresentation analysis links selected gene sets and different regions of the som images with single-tile resolution. these regions, in turn, can be collected into over- or underexpression spots in different tissues. overrepresentation analysis then provides lists of significantly overrepresented gene sets which characterize the respective spot in a functional context. some of the spots can be assigned to specific molecular characteristics such as 'nervous processes', 'muscle contraction' and 'immune response'. both, the single-tile som-wide and the multi-tile spot-wise overrepresentation analysis constitute a link between characteristic expression pattern and concepts of molecular function for the associated genes. these orthogonal views complement each other: the former one judges the homogeneity of a selected set with respect to different metagene expression profiles. the latter one assigns selected expression profiles to their tentative molecular function.

 <dig> . filtering metagenes and single genes
the reduction of the size of the data set by removing genes that carry essentially no or low information is common practice to improve downstream analysis such as two-way hierarchical clustering of genes and samples. such data reduction has been shown to result in dendrograms which more accurately reflect relationships between the samples with increasing stringency of the filter applied  <cit> . this improvement can be rationalized by the fact that random noise tends to disrupt similarity relations between genes and samples. on the other hand, also the opposite trend is possible: systematic errors in the data, e.g. due to batch effects, can cause artificial clustering if the bias affects subsets of genes in a coordinated fashion. hence, a particular filter aims at improving data by removing either noisy, biased and/or weakly expressed genes. on the other hand, extreme filtering is dangerous because it may eliminate valuable information, for example, about genes of relatively low and thus noisy expression but with important biological impact. hence, filtering is an optimization task with the requirement of removing virtually irrelevant data while preserving all information in the remaining part of the data which is important in the context of the particular issue studied. we will shortly call the latter property as the 'representativeness' of a filter and the former one as its 'noisiness', i.e. the mean noise-to-signal ratio of the data included. optimization thus aims at maximizing representativeness while minimizing noisiness.

'top-list selection' is probably the simplest method of filtering: one first defines a ranking criterion such as differential expression or variability , then one ranks the data accordingly and finally selects a certain number of features on top of the list for further analysis. the length of the list can be cut by applying different criteria such as a fixed number of features or a significance threshold.

som analysis enables alternative filtering based on the metagenes as representative features characterizing the expression profiles of miniclusters of single genes. in other words, the metagene profiles itself can serve as a filtered and compressed extract of the original data. our som-method assigns the expression profiles of the n =  <dig>  input genes measured in  <dig> tissues to  <dig>  metagene clusters. each metagene cluster consequently contains g/m = <nk > =  <dig>  real genes on the average. hence, complexity of transcriptome characterization is reduced to about one sixth by utilizing the metagenes instead of the 'real' genes.

moreover, the local g/m-ratio considerably varies between the different metagene clusters with minimum and maximum values of nk =  <dig>  and nk =  <dig> . thus each metagene can be representative for a very different number of real genes. in consequence, the importance of transcriptome information is effectively reweighted by using metagenes instead of real genes. for example, the metagene of highest population  clusters genes of virtually invariant expression profiles. these essentially not-informative features comprise  <dig> %  of all single genes but only  <dig> %  of all metagenes. hence, their contribution is effectively down-scaled by nearly a factor of ~1/ <dig> if one uses the metagenes instead of real genes. in other words, som clustering itself can be viewed as a sort of selective compression filter reducing the number of features considered by condensing larger numbers of similar single gene profiles into one metagene profile with a profile-specific compression factor, fkcompression = - <dig> .

metagene filtering is expected to outperform single gene filtering in terms of representativeness and noisiness because the reduced number of metagenes not only preserves the diversity of single gene profiles but it also amends the resolution of downstream analysis due to the reduced noise of the metagene profiles. with the objective of proving this expectation we compare two options for data filtering by applying top-list selection either to the metagenes or to the single 'real' genes. we used three types of filters to reduce the number of single genes and metagenes, namely fold change -expression, variance and significance  filtering . in the first case the full set of absolute fc-values of all genes  under all conditions studied are ranked and a certain number of topmost features is considered for further analysis.

note that lists of equal numbers of metagenes and of single genes are asymmetric owing to data compression in the metagene miniclusters. the different sample sizes selected by both options of filtering are given in detail in additional file  <dig>  metagene lists integrate roughly a tenfold larger number of 'real' genes in our som settings. figure  <dig> compares the areas in the som mosaic filtered by fc-lists of different lengths if applied either to metagenes or to single genes. the shorter metagene lists cover essentially the same regions of the som as the longer single gene lists with considerable overlap of the selected meta- and single genes. the large overlap demonstrates that the metagene filter is representative for the metagene-associated single genes which are also selected to a large fraction if one applies single gene filtering using a roughly ten-times longer list. for example,  <dig>  out of the  <dig>  single genes are shared by the fc- <dig> single gene and the fc- <dig> metagene lists . however,  <dig> out of the top- <dig> metagenes do not contain the genes from the single gene list which, on the other hand, contains  <dig> single genes in  <dig> metagenes not selected by the metagene list. hence, the metagene filter covers a wider range of expression profiles than the single gene filter which selects only a few additional features. figure 7b illustrates that different spot areas are progressively excluded from the list of filtered features with increasing stringency of the filter as expected.

in addition to fc-filtering we applied variance and significance filtering which select profiles of largest variance and of highest significance of differential expression, respectively. the former filter possesses similar properties as the fc-filters. in contrast, significance filters select more diverse collections of features which are spread over different areas in the respective mosaic representations . below we apply fc-filtering in the more detailed analysis to judge the consequences of both filters for selected downstream characteristics.

 <dig> . metagene- and single genes-based clustering analysis
in the next step we applied secondary standard analysis methods to the lists of filtered genes and metagenes to assess the particular effect of filtering. we performed one- and two-way hierarchical clustering and independent component analysis  using either the expression values of a list of real genes or of a list of metagenes of selected lengths. hierarchical cluster analysis was applied because this method is often routinely run as a first step of data summary in microarray data analysis  <cit> .

one way hierarchical cluster trees obtained from single gene and metagene fc-lists of length  <dig>   <dig> and  <dig> reflect similar properties showing that clustering is relatively robust with respect to the chosen conditions . tissues from categories with homogenous som-pattern such as nervous , adipose  and immune system  tissues  robustly cluster together at nearly all conditions studied. note that the blue cluster of immune system tissues however partly decomposes if one uses the shortest single gene list  owing to the loss of representativeness. on the other hand, the fc- <dig> metagene list of equal length still produces a compact blue cluster reflecting the improved representativeness of the same number of metagenes.

the blue immune system tissue cluster splits for both, the single gene and metagene filters in the opposite limit of low stringency using fc- <dig> lists. these lists obviously become too long with worse noisiness characteristics. note, that the fc- <dig> metagene list considers all available metagenes whereas the fc- <dig> single gene list is still limited to only 16% of all available single genes. longer single gene lists reduce the quality of the observed cluster structure due to the progressive inclusion of noisy genes . in summary, metagene lists are more representative and less noisy than single gene lists of equal length in downstream cluster analysis. on the other hand, also the length of metagene lists is optimal in the intermediate range : shorter and longer lists are suboptimal in terms of representativeness and noisiness, respectively.

the cluster trees generated on the basis of single gene and metagene lists reveal another interesting difference : the mean length of the outmost branches between the periphery of the circles and the first split point is considerably shorter for the metagene-based trees than for the single gene-based trees. this relation reverses for the innermost branches. this systematic difference indicates that metagene clusters are more compact than single gene clusters  owing to the decreased noisiness of the metagene data. in the right part of figure 8a we compare the inter-to-intra cluster ratio of the euclidian distances between the samples  for three tissue categories as a simple measure of the compactness of their clusters. the f-score of the metagenes systematically exceeds that of the single genes.

the heatmaps express detailed information about the amount of genes differentially expressed in the various tissues . for example, the percentage of single genes which are overexpressed in the nervous tissues and underexpressed in the other tissue categories  increases from values of less than 50%  to a dominating amount of more than 90%  whereas the percentage of genes overexpressed in other tissue categories almost completely vanishes. hence, the relative contribution of genes collected into clusters characterizing a selected tissue clearly depends on the length of the list. the use of metagenes instead of single genes effectively re-weights the contribution of tissue-specific genes. particularly, the percentage of metagenes which are specific for nervous tissues is markedly smaller in the metagene list giving rise to a more balanced distribution of features.

 <dig> . metagene- and single genes-based ica analysis
hierarchical clustering may identify groups of samples which share genes or metagenes of similar expression pattern. hierarchical clustering however does not represent the multivariate structure of the data. such aspects become highlighted by projecting the data to subspaces of lower dimension spanned by interesting modes such as the components of minimum mutual statistical dependence. ica provides a visual plot in the space spanned by these independent components which are shown to point along the directions of maximum information content in the data or, equivalently, of non-normal distribution of the data  <cit> . we applied ica to single and metagene lists to see which of the alternative data sets offers the better separation among the various tissue groups.

the ica-plots of the two leading independent components shown in figure 8c illustrate the degree of similarity between the samples as a function of the selected filters. all filters except one provide virtually three clusters, namely that of nervous , immune system  and the remaining tissues. the fc- <dig> single gene filter merges the latter two clusters due to its small representativeness with respect to non-nervous tissues . note also that the relative dimension of the three clusters in the ica-plot and thus also their intrinsic resolution changes from filter to filter. these trends reflect the subtle interplay between the length of the list and its representativeness and/or noisiness which might overweight one tissue category and underweight another one. for example, the specifics of epithelium tissues  become relatively well resolved using the fc- <dig> metagene or, alternatively, the fc- <dig> single gene lists. the respective heatmaps in figure 8b confirm that this tissue category is well represented by a reasonable number of specifically over- and underexpressed genes/metagenes in these lists. the fraction of these genes however clearly decreases in the other filtering lists giving rise to the suboptimal resolution of the cluster of cyan circles in the ica plots. the right part of figure 8c compares the relative size of three clusters in terms of the fraction of the covered coordinate region. the metagene-based clusters are less dependent on the chosen length of the list and more balanced especially for short lists.

the ica plots in figure 8c reveal another interesting property inherent in the expression profiles: the points especially of nervous  and immune systems  but also of epithelium  tissues form chain-like clusters which point roughly along the coordinate axes. this pattern reflects the fact that the transcriptional activity of nervous tissues on one hand side and immune system and epithelium tissues on the other hand side are governed by different and mutually independent groups of genes. we will discuss this point below more in detail in the context of the som mosaics. in the context of the filter lists it should be noticed that this property of the data gets partly lost after most stringent single gene filtering  whereas essentially all metagene lists well reflect the independence of the expression pattern of the different tissue categories.

in summary, ica analysis illustrates the robustness and the discrimination power inherent in the metagene lists. the use of metagenes allows compressing the length of the list by about one order of magnitude without loss of information. the filtering conditions govern the resolution between different tissue categories in the ica plot in a subtle way. short and intermediate metagene lists provide best results in this respect. notably, consideration of the full metagene information without filtering  provides still reasonably resolved clusters in the ica-plot. in conclusion, metagenes are more robust with respect to the quality of secondary analysis than single gene lists owing to their better representativeness. hence, the reduction of dimensionality provided by som analysis improves the performance of downstream hierarchical clustering and ica analysis. the number of considered features can be reduced by about one order of magnitude without loss of information if one uses metagenes instead of real genes. clustering and ica characteristics obtained for the metagene and single gene lists after variance and fdr filtering virtually agree with the results of fc-filtering .

 <dig> . metagene- and single gene-based correlation analysis
in the next step we calculated pairwise correlation maps  illustrating pearson correlation coefficients for all mutual combinations between the tissues. the pcm-heatmaps shown in figure 9a are obtained using the fc- <dig>  and fc- <dig>  filters representing both roughly the same number of genes . the metagenes clearly provide pcm-patterns of higher contrast which becomes emergent as diagonal and off-diagonal dark red/maroon and blue clusters. they refer to tissue pairings with highly correlated and anti-correlated expression profiles, respectively. both, the single gene and the metagene pcm reveal essentially four groups of tissues which consist mainly of nervous , immune system , muscle  tissues and also of a mix of diverse tissue categories.

the expression profiles of nervous tissues strongly anti-correlate with essentially all the other tissue categories, i.e. a gene overexpressed in nervous tissues usually becomes underexpressed in non-nervous tissues and vice versa. the original expression som always reflect this property showing one characteristic overexpression spot in the top left corner  and otherwise a blue and light blue background due to underexpressed genes/metagenes . muscle tissues show strong off-diagonal correlation with the group of diverse tissues but not with the immune system tissue group. this property can be mainly attributed to spot d in the right upper corner in the som of these tissues whereas the diagonal correlation component mainly originates from the muscle-specific spot b . the cluster of immune system tissues along the diagonal of the pcm can be associated with spot f in their som. hence, the diagonal and off-diagonal clusters in the metagene pcm can be related to different spots in the original expression som of the different tissue categories.

to get further insights into the origin of the contrast differences between the single gene and metagene pcm we calculated frequency distributions of the pairwise correlation coefficients either between tissues of one category or between tissues of different categories . intra-category correlation coefficients are expected to be close to unity because samples of the same categories show usually similar expression profiles. indeed, these metagene correlation coefficients are close to unity as expected whereas the respective single gene correlations show a markedly broader distribution resulting in smaller correlation values on the average. inter-category pairings of single genes show a broad distribution centered about zero with a strong component of anti-correlation near - <dig>  revealing that single genes of different tissue types are either not or anti-correlated. the metagenes produce a more resolved trimodal distribution with strong components of correlated, anti-correlated and uncorrelated metagenes near  <dig> , - <dig>  and  <dig> , respectively. the component peaks are clearly sharper and the whole distribution covers a wider range of correlation values. hence, the metagenes obviously enable the better resolution of different subcomponents produced by different tissue types.

the pcms reveal that anti-correlated metagene expression profiles are especially found between nervous tissues and the other tissues. we therefore calculated a second set of frequency distributions restricting the intra-tissue correlations to nervous tissues only and the inter-tissue correlations to that between nervous and all the other tissues . the latter histograms reveal that the degree of anti-correlation is much stronger for the metagenes than for the single-genes again showing that metagenes more sharply express the correlation pattern of gene expression. note that this anti-correlation is evident already in the textures of the original tissue som: large blue areas in the som of nervous tissues reveal under-expression of the respective metagenes which become selectively overexpressed in the som of other, non-nervous tissues . the inter-nervous tissue correlation histogram also shows a strong correlation peak near unity which is caused by the metagenes commonly overexpressed in nervous tissues and pituatary gland  as discussed above.

in summary, our extended dataset of human tissues confirms the results of guo et al.  <cit>  who found that som based metagenes well recapitulate gene expression profiles of the entire gene dataset despite dimension reduction and that the visual patterns capture the real similarity relationships among samples with a high fidelity. moreover, one can improve the resolution power of popular standard analyses based on two-way hierarchical clustering or pairwise correlation heatmaps using metagenes instead of real genes. the som metagene pattern serves as an adequate data filter which appropriately selects representative features characterizing the expression properties of the system studied.

 <dig> . selecting tissue specific metagenes: comparison of methods
one essential feature of the som approach discussed in the previous subsections is the reduction of dimensionality of the full data set from ten thousands of single gene expression profiles to a few thousand metagene profiles. in a second unsupervised reduction step, the dimensionality is further reduced to a handful of overexpression spots representing clusters of co-expressed metagenes which are highly expressed in, at minimum, one tissue. particularly we demonstrated that the global expression landscape of human tissues is characterized by about nine- to - ten of such spots . for comparison with these spot-clusters we applied selected alternative methods of dimension reduction: non-negative matrix factorization , k-means hierarchical clustering  and correlated gene set clustering . these supervised clustering methods use different approaches: nmf virtually decomposes each of the expression profiles in original space into an additive set of 'metagene' profiles with non-negative expression amplitudes. hc is a heuristic iterative algorithm that tries to separate the original data into compact clusters using typically euclidian distance metrics. cgs uses correlation metrics in combination with stringent significance testing to group the original data into groups of correlated single genes. nmf, hc and som were compared under different aspects in previous work . here we judge the ability of the methods to generate tissue-specific clusters using a simple entropy-measure  <cit> . we assume a number of ten clusters in each of the supervised clustering methods in correspondence with the som results. figure  <dig> shows that som clustering outperforms the alternative methods in terms of specificity of the obtained spot clusters. in the supplementary material  we show that som-clustering also outperforms the alternative methods in terms of representativeness and correlation contrast between nervous, immune systems and the remaining tissues similar to the results presented in the previous subsection.

note that som, hc and cgs cluster genes together which show similar profiles in the series of samples using either distance or correlation metrics. such groups of co-expressed genes can be interpreted in a common functional context based on the guilt-by-association heuristics  <cit>  . instead, nmf decomposes the gene expression patterns as an additive combination of nmf-metagenes whereas som, hc and cgs use a decomposition that insists mutual exclusion of features  <cit> . the functional meaning of this polysemous decomposition of nmf in comparison with the exclusive guild-by-association decomposition is presently not clear and requires additional work.

 <dig> . zoom-in step and similarity analysis
som expression profiles show very similar spot pattern for tissues of the same category in most cases. for example, the profiles of nervous and immune system tissues are commonly characterized by highly expressed metagenes in spot a located in the left upper corner and in spot f located in the right lower corner of the mosaic, respectively. subtle tissue-specific characteristics are visible in the blue and green regions of under- and moderately expressed genes. these specific patterns of gene expression of selected subclasses of tissues were studied with increased resolution using a 'zoom-in' step which trains a new som based on the reduced set of tissues samples. the obtained expression images reveal a much more diverse spot pattern than the images obtained from the whole set of tissues discussed because som training adapts the expression profiles of the metagenes to a smaller bandwidth of expression values observed in the subensemble selected. three examples for zoom-in analysis are presented in additional file  <dig>  we separately trained soms for the nervous tissues, immune system tissues and a collection of  <dig> diverse tissues including adipose, muscle and epithelial tissues.

guo et al. proposed a second-level som analysis step  <cit> . it maps all samples together into one two-dimensional mosaic pattern to visualize the degree of similarity between their metagene expression profiles. the second-level som algorithm uses the metagene expression of all samples considered as input. after training, each tile of the mosaic is characterized by the expression profile of one 'metasample' which serves as the condensation nucleus of the associated minicluster of real samples possessing similar som pattern. the mutual distances between the samples in the map are related to the degree of similarity of their som expression pattern. figure  <dig> shows 2nd level som and ica maps of the  <dig> tissues studied. one distinguishes essentially the same three main clusters in both plots, namely that of nervous tissues , immune system tissues  and the remaining ones. the substructures of the three groups were further disentangled by applying the zoom-in step for each of the three tissue clusters as described above.

in general, ica and 2nd level som provide a similar view on the samples, however with subtle differences. for example, the ica algorithm distributes the sample points continuously in the coordinate system spanned by the two leading principal components of maximum information content. the mutual separation between the points linearly scales with their distance in units of these components. in contrast, som machine learning uses non-linear scale to distribute the sample points in the discrete space defined by the mosaic grid of metasamples. it enables to display differences between the samples with improved resolution in regions of high sample density. in consequence, the individual tissues effectively spread over a larger area in the som mosaics than in the respective ica.

as noticed above, most of the samples group into linear clusters which orient along one of the coordinate axes in the two dimensional ica plots. the orthogonal orientation of most of these clusters indicates that each of them is characterized by genes which vary mutually independently. for example, nervous and immune systems tissues aggregate into such linear and perpendicularly-oriented clusters in the original ica of all  <dig> tissues. note that nervous and immune systems tissues are characterized by their specific spots a and f, respectively. recall that these spots contain genes which indeed vary virtually independently.

similar orthogonal clusters are found in the ica plots after zoom-in of the nervous, immune system and diverse tissues. the obtained clusters reveal groups of tissues which are governed by independent sets of genes with enhanced resolution. for example one finds that telencephalon tissues  form one linear cluster which can be attributed to a category-specific spot in the zoom-in som images . the linear clusters formed by muscle  and epithelium  tissues are oriented in perpendicular direction in the zoom-in ica plot of the 'diverse tissues'. both clusters are characterized by specific metagene spots in the som images after zoom-in. tissues with mixed spot patterns due to different tissue components such as tongue are located at intermediate positions between that of the pure tissue components. we also generated three-dimensional ica-plot to assess the third main independent component . these plots reveal that the characteristic pattern of orthogonal linear clusters of selected tissue categories can extend into the third dimension.

the second-level som and ica plots similarly arrange the tissues samples. however, non-linear scaling of the som partly disturbs the linear arrangement of samples observed in the ica plots. for example, the linear ica-cluster of the nervous tissues  transform into a slightly more compact cluster in the 2nd level som. on the other hand, the 2nd level som more in detail resolves small differences between the expression profiles . hence, although very similar, 2nd level som and ica visualize partly complementary aspects of the data which can be studied more in detail using the spot-texture of the individual som of the samples studied. tree-based similarity analysis provides an additional option to visualize the mutual relations between the samples .

 <dig>  
CONCLUSIONS
the microarray expression data of  <dig> human tissues was used as an illustrative example to demonstrate the strengths of the som method in disentangling large sets of heterogeneous data. after suited preprocessing and training, the som method decomposes the original data into metagene expression profiles representing clusters of correlated single genes. metagene expression values in the individual samples provide mosaic pictures visualizing tissue-specific over- and underexpression in terms of characteristic color-coded textures. they enable the direct comparison of the expression of individual samples in a simple and intuitive way.

particularly, the tissue-specific patterns of gene expression were readily discernable in the obtained gallery of individual tissue maps. they reveal a series of about one handful stable over- and underexpression spots which selectively characterize different tissue categories such as nervous, immune system, muscle, exocrine, epithelial or adipose tissues. single tissues of mixed characteristics such as tongue  can be easily identified. also anti-correlated expression spots are detected which, for example, are overexpressed in nervous tissues but underexpressed in the other tissues and vice versa.

to extract the functional context of spot and metagene related lists of single genes we applied overrepresentation analysis with respect to pre-defined gene sets of basically known functional impact. the mapping of overrepresentation of a selected gene set into the som mosaic provides a 'functional' map showing areas which are potentially relevant for this function. tissue related spots typically contain enriched populations of function-related gene sets well corresponding to molecular processes in the respective tissues. this result strongly supports the 'guilt-by-association' principle that coexpressed genes are likely to be functionally associated. it, in turn, implies the ability to define either new gene sets using selected som spots or to verify and/or to amend existing ones.

the som method compresses the original set of high-dimensional data in two consecutive steps: firstly, similar expression profiles of single genes are collected into metagene clusters, which reduces the number of relevant features nearly by one order of magnitude in our application. these metagene profiles can be understood as a sort of 'eigen-modes' characterizing the multitude of expression pattern inherent in the data. secondly, the textures of the obtained som are decomposed into a few  spots of similarly  expressed metagenes. this 'double compression' sequentially applies global  and local  criteria.

the use of metagene instead of single gene expression reduces the dimension of the data and leads to an increased discriminating power in downstream agglomerative analysis such as hierarchical clustering and independent component analysis owing to essentially two facts: firstly, the set of metagenes better represents the diversity of expression pattern inherent in the data and secondly, it also possesses the better signal-to-noise characteristics as a comparable collection of single genes. due to the better representativeness, metagene lists are less sensitive to downstream filtering than lists of single genes. metagenes can be seen as a natural choice to detect context-dependent patterns of gene expression in complex data sets. som-spot clustering provides groups of genes of higher sample-specificity compared with selected alternative methods such as non-negative matrix factorization, hierarchical clustering and correlated gene set clustering.

our example shows that som cartography transforms large and heterogeneous sets of expression data into an atlas of sample-specific texture maps which can be directly compared in terms of similarities and dissimilarities. this global view on the behavior of defined modules of correlated and differentially expressed genes is more intuitive than ranked lists of hundreds or thousands of individual genes. importantly, the dimension reduction of the data does not entail the loss of primary information in contrast to simple filtering approaches which irretrievably removes part of the data. instead, the reduction of dimension is attained by the re-weighting of primary information in the aggregation step. the whole set of single gene expression profiles remains virtually 'hidden' behind the metagenes. this primary information together with the respective gene annotations can be extracted in later steps of analysis to interpret the observed som textures using concepts of molecular biological function.

finally, the software used in this publication is available as cran package 'opossom'.

 <dig>  methods
 <dig> . microarray data and preprocessing
microarray raw intensity data  of m =  <dig> tissues each measured in rm =  <dig>   <dig> ..  replicates were downloaded from the gene expression omnibus repository as the 'human body index - transcriptional profiling' - data set .

raw probe intensities are calibrated and transformed into expression value using the hook method  <cit> . the expression values from all arrays are subsequently divided into present and absent ones  <cit>  and normalized as described in the additional file  <dig> 

logged expression values of each gene  were transformed into differential expression values relative to the mean expression of the particular gene in the experimental series of tissues considered,   

eq.  thus defines differential expression in units of the logged fold change, logfc ≡ Δe.

 <dig> . som-mapping of gene expression profiles
in the next step, the preprocessed differential expression values of the series of tissue samples, Δe, are processed using the unsupervised machine learning method to train a self organizing map  representing information-rich diagrams. the som method applies a neural network algorithm to project high dimensional data onto a two-dimensional visualization space  <cit> . soms have a strong visualization capability by presenting each individual sample as an entity allowing its identification in a series of samples. each som still keeps full high-resolution information about the co-expression pattern of the genes in the samples studied.

we applied a home-made r-program  <cit>  which uses the cran package 'som'  <cit> . the som-algorithm assigns the expression profiles of the n input genes measured under m conditions to a number of k < n rectangular 'tiles' , each of which is characterized by one representative profile of metagene expression given by a vector of length m, Δekmeta =  . it is trained such that the profiles of the metagenes capture the range of all individual expression pattern observed. each individual expression profile of a 'real' gene is assigned to the metagene pattern of closest similarity using the minimum euclidian distance as criterion. each metagene thus serves as a sort of condensation nucleus for a minicluster of nk 'real' genes with similar expression profiles, Δek,i = , with i =  <dig> ..nk and .

the metagenes are arranged in a two-dimensional grid with k = x⋅y tiles where x and y are the number of tiles per dimension. most similar expression profiles of metagenes are located adjacent each to another. the correlation between metagene expression decreases with the mutual distance between the tiles on the mosaic. the degree of similarity between adjacent metagenes depends on the number of genes assigned to the respective metagenes being closer for larger populated metagenes and vice versa. for each condition m =  <dig> ..m a som mosaic pattern is constructed by color-coding the tiles k =  <dig> ..k according to its metagene expression, Δek,mmeta. this way one obtains a coherent mosaic pattern that is characteristic for each sample owing to the similarity of adjacent metagenes. since the soms assign the same metagene to the same tile in all samples, they can be directly compared to each other allowing immediate identification of biologically interesting groups of genes.

typically, the number of tiles to 'pixelate' the expression profiles is k =  <dig> ×  <dig> -  <dig> ×  <dig> =  <dig> -  <dig> with, on the average, nk =  <dig> -  <dig> genes per metagene. the obtained mosaic pattern is usually more homogeneous than typical gene clustering heatmaps containing typically about  <dig> clusters. this finer granularity of som-maps is associated with a fewer number of genes per unit  which in consequence gives rise to a more detailed expression pattern.

the number of tiles per som image and also the lattice-type  potentially affects the obtained cluster structure and color texture of the images. in a preliminary study we found that the number of tissue-specific 'spots' converges for x = y >  <dig> and weakly depends on the chosen lattice type. under these conditions the number of tiles exceeds the number of relevant expression modules roughly by two-orders of magnitude which allows their resolution with high granularity. the contrast of the som images can be adjusted using different color-scales to attenuate different aspects of the expression profiles with the aid of pattern recognition, feature selection and/or data filtering. in the supplementary information we compare three options of contrast variation with the focus on strong-to-moderate differential expression , very strong overexpression  or weak-to-moderate differential expression .

details of these methodical studies are presented in additional file  <dig> together with a schematic workflow of our som-pipeline used. the complete set of analysis results, as well as the current version of our r-program 'opossom' can be downloaded from http://som.izbi.uni-leipzig.de. the program is also available as cran package via http://cran.r-project.org/.

 <dig> . supporting maps
we define the following supporting maps which provide additional information about the miniclusters defined by each metagene and the associated real genes:

 the metagene expression profiling map uses a coarse grained mosaic to provide an overview of the courses of the metagene profiles. for visualization purposes we use a coarse grained  mosaic with considerably less tiles than the mosaic grid applied for the soms . the metagene profiles might be plotted together with the associated single gene profiles.

 the population map plots the number of real genes per metagene in logarithmic scale, log nk.

 the variance map illustrates the variability of the expression profile of each metagene in the samples studied,   

 the integral over-/under-expression summary maps collect all over-/underexpression spots observed in the individual sample soms into one master map.

an extended set of supporting maps visualizing the covariance and the euclidian distance between the genes and metagenes in each tile, the maxima and minima of the metagene profiles in absolute scale and the correlations between the metagenes are given as supporting information . these maps illustrate the concerted changes of real genes in each of the metagene clusters and of the metagenes in the som images. it is shown that the euclidian distance-based som algorithm implicitly clusters correlated expression profiles together in different regions of the som.

 <dig> . gene set overrepresentation analysis
gene set analysis requires the knowledge of predefined gene sets to study their enrichment in gene lists which are obtained from independent differential expression analysis . a large and diverse collection of such sets can be downloaded from the 'gene-set-enrichment-analysis'-website . particularly, we included in total  <dig> gene sets in our analysis according to the go terms 'biological process' , 'molecular function'  and 'cellular component' . we use the term 'overrepresentation' to assign the probability to find members of a given set in a list compared with their random appearance independent of the values of their expression scores. we use the hypergeometric distribution to characterize overrepresentation in terms of a p-value which estimates the probability to find a stronger overlap between the list and the set by chance  <cit> .

 <dig> . grouping samples: second level som cartography
we applied second-level som analysis as proposed by guo et al.  <cit>  to visualize the similarity relations between the individual som-metagene expression patterns. second-level som analysis uses the k metagene expression profiles of the m samples as input. it then clusters the samples and not the genes as in first-level som analysis. each tile of the second-level som mosaic characterizes the expression profile of a representative metasample defined by k metagene expression values. the m samples were presented using a mosaic grid of size k2som > m. note that the number of metasamples usually exceeds the number of real samples whereas in first order som the number of metagenes is usually much smaller than the number of real genes. a considerable fraction of tiles of the second order som are consequently empty with no sample assigned.

 <dig> . estimating similarities: clustering-, tree- and independent component-analysis
one- and two-way hierarchical clustering  <cit>  and independent component analysis  <cit>  were applied in two versions using either the profiles of the som-metagenes  or the profiles of individual 'real' genes  using the r-packages 'stats' and 'fastica' for clustering and ica, respectively. hierarchical clustering uses euclidian distances between the genes/metagenes as similarity measure, whereas ica is based on covariance. in addition to two-way hierarchical clustering heatmaps, we generate pairwise correlation maps  which visualize the pearson correlation coefficients between the gene expression profiles  in all pairwise combinations of samples.

 <dig> . filtering genes and metagenes
optionally, the number of real genes and/or metagenes used in the analyses is reduced by applying three types of filters to exclude genes/metagenes of weak or of virtually invariant differential expression from downstream analysis:  fc-filtering: the genes/metagenes are ranked with decreasing absolute value of the fold change  for each sample and a certain number  of the top-most features is selected;  variance filtering: the genes/metagenes are ranked with decreasing variance of their expression profiles and a certain number of top-most features is selected;  fdr-filtering: only genes/metagenes with a local false discovery rate  smaller than a certain threshold  were selected. the local fdr estimates the probability of false positives in a list genes/metagenes. we used a shrinkage t-score statistics to assign p-values to each single gene the distribution of which then provides its fdr-values. the fdr of the metagenes is simply calculated as log-average of the single gene fdr of the respective metagene cluster. details of the method will be published separately .

 <dig> . filtering benchmarks
the performance of metagene and single gene filters was compared using the following benchmarks :

hierarchical clustering: the ratio of the inter-class and intra-class variance of the euclidian distances between the respective expression data  was used to estimate the quality of the clusters.

two-way hierarchical clustering: the percentage of genes/metagenes attributed to tissue-specific clusters for three tissue categories  was used to estimate the representativeness of the list.

ica: the percentage of the variance of the independent components ic <dig> and ic <dig> of one tissue category, % = one_category/three_categories, was used to judge the relative size of the respective cluster.

 <dig> . measuring cluster specificity with entropy and alternative clustering methods
the cluster-specificity estimates the degree to which the expression of a selected cluster differs from ubiquitous uniform expression of all clusters in a given tissue. it can be measured in terms of the entropy  <cit> ,   

where ec,m is the logged expression of the cluster which is calculated as mean value over the expression values of its members. the entropy is calculated for each tissue sample m =  <dig> ..m where the sum runs over all clusters c =  <dig> ..c. it has units of bits and ranges from zero for tissues with only one highly expressed cluster to  <dig> for tissues with uniformly expressed clusters.

for comparison with the som spot-clusters we applied selected alternative methods of dimension reduction: non-negative matrix factorization , hierarchical clustering  and correlated gene set clustering . for nmf- and hc-clusterings we use the cran-package 'nmf'  <cit>  and the basic package 'stats'  <cit> , respectively. cgs-clusters were obtained using an in-house r-program  <cit> .

authors' contributions
hw and hb: conceived and designed this study, performed data analysis and wrote the manuscript. hw: wrote the r-programs and performed the calculations. ml and mb contributed to finalize the study. all authors read and approved the final manuscript.

supplementary material
additional file 1
the additional text describes methodical issues such as the calibration of microarray data and the adjustment of the size and topology of the som, additional supporting maps which illustrate the covariance and correlation structure of the metagene clusters, alternative options of contrast of the som images, the filtering of metagenes/single genes and the interpretation of cluster trees. further details of zooming-in of tissue subgroups are given together with the 3d-ica plots of the tissues studied.

click here for file

 additional file 2
whole set of  <dig> som expression profiles of human tissues

click here for file

 additional file 3
expression profiles of human tissues in alternative color scales.

click here for file

 additional file 4
agglomerative cluster analyses after single gene and metagene filtering using fdr and variance criteria

click here for file

 additional file 5
table of samples studied the complete set of results of our som analysis of the human tissue dataset can be found on our website: http://som.izbi.uni-leipzig.de

click here for file

 acknowledgements
the project life is financially supported by the european fonds for regional development  and the state of saxony . hw was kindly supported by the helmholtz impulse and networking fund through helmholtz interdisciplinary graduate school for environmental research  <cit> .
