BACKGROUND
metabolic flux analysis is becoming increasingly important for the understanding of the dynamics of metabolic networks  <cit> . flux values can be derived from wetlab experiments, e. g. using stable isotopic tracers , or from drylab computational approaches, such as flux balance analysis  based on comparative flux analysis conclusions can be drawn about the influence of internal or external parameters on the metabolic behavior of a biological system. the visualization of fluxes in the context of metabolic networks supports such analysis. firstly, images are a convenient way of communicating information to the scientist and, secondly, visual analysis of network-associated fluxes is intuitive for the user. thirdly, especially for flux distributions in large networks, flux visualization enables data interpretation on a global level and facilitates the gain of knowledge. as an extension to network-based flux visualization, interactive exploration techniques provide the basis for an easy and fast comparison of different flux distributions, which would be very elaborate when working with raw data in tabular form.

an adequate tool for the visual exploration of flux distributions has to provide the following functionalities:  user-friendly input of external flux data as biochemical reaction formulas, including experimental specifications such as time points, different species and substance weights to represent c- or n-fluxes,  import of biological networks from different databases,  network editing capabilities,  validation of the input data set,  network-based visualization of flux values and visualization options for individual user requirements,  visualization of quality parameters,  interactive comparison of different flux maps, e. g. from different species and  output of flux visualization in different  formats.

here we present fluxmap, a vanted  <cit>  add-on specialized on the visualization and exploration of flux distributions, supporting all above mentioned requirements. the fluxmap workflow schema depicted in figure  <dig> and an example shown in detail in additional file  <dig> 

implementation
data input
for the import of flux data, fluxmap makes use of a structured excel template file . in fields  <dig> and  <dig> the user is asked to specify experimental metadata such as experiment annotation and information about different conditions. field  <dig> contains information about time points which have been considered in the course of the experiment. in case of the visualization of substance fluxes, the user needs to specify the substance weights  in field  <dig>  for visualization of mass fluxes the atom number has to be set to  <dig> for each metabolite. reaction formulas have to be defined in field  <dig> with the corresponding flux measurement values in field  <dig>  the reaction formula consists of two arrow-separated lists of reactant and product substances. stoichiometric factors are part of the reaction formula and are allowed to be non-integer numbers. furthermore, the input template supports the assignment of quality parameters  to each flux measurement value. taken together the template enables users to import and save the flux measurement data together with experiment metadata in a well-structured way.

network representation and mapping
in the process of parsing the template file, fluxmap generates a dataset which is adapted to the hypergraph properties of metabolic networks. considering the stoichiometry of the reactant, the flux measurement value of the reaction and the substance weights, reactions are represented as bipartite graphs by adding a reaction node  connecting all metabolites participating in this reaction with edges to or from this node. the parsed dataset then can be mapped to a biochemical network. these networks can be drawn manually in vanted or imported in various file formats  from the local file system or external pathway sources such as kegg  <cit>  and metacrop  <cit> . during the mapping process the flux values are automatically extracted from the parsed template and represented as edge thickness between the corresponding nodes. the direction of edges in the network will be adapted according to the flux data. zero fluxes are indicated by a dashed line, thereby visually preserving the topology of the network even for sparse flux data. in case of reactions in the template which are not represented in the network, fluxmap enables the user to automatically add corresponding network elements.

balance validation
the data mapping step is followed by a validation step for checking the flux balance of each reaction . for balanced flux distributions, the sum of all ingoing fluxes into a reaction node is equal to the sum of all outgoing fluxes. if this condition is not fulfilled, the reaction will be reported to the user as unbalanced. several reasons might account for a reaction being unbalanced. in most cases this is due to typographical errors in the input template, such as misspelled substance names , wrong stoichiometry , missing stoichiometry and missing reactions or reactants. another reason is given by the nature of the flux the user wants to analyze. in mass flux maps, which describe the flux of molecules per time unit, certain reactions cannot be balanced . therefore balance validation is only applicable for fluxes of atom numbers per time unit, e. g. computed carbon flux distributions or data from 13 c labeling experiments.

the validation step supports users in tracking down typographical errors in the input template which facilitates the import and analysis of large and complex flux data sets.

visualization
fluxmap offers a simple dialog which can be used to parameterize the visualization of the flux distribution according to individual needs . the multiplicator parameter adapts the global edge thickness of all fluxes . the arrowhead/-tail ratio might be varied in order to emphasize the edge direction rather than the edge thickness . different reaction node visualization styles can be chosen, e. g. invisible, small, rounded or normal nodes with or without labels . it is additionally possible to visualize the quality parameters using a configurable color graduation, thereby highlighting potential measurement errors . each of these parameter modifications triggers an instant redraw of t he flux map. instead of the representation of flux values as edge thickness, flux data might also be visualized using charts, e. g. bar- or line-charts which are assigned to edges or the reaction nodes. general network editing functionalities  are implemented in vanted and accessible through fluxmap.

interaction
as specified in the input template, the flux dataset can comprise values representing different samples and varying conditions . this complexity in flux data sets creates the need for the interactive exploration by switching between these experimental factors. in order to meet this requirement, fluxmap offers a combobox  and a slider , enabling users to explore and visually compare corresponding flux maps .

network layout provides the basis for network visualization and exploration. especially in large networks it is indispensable to follow the fluxes throughout the whole map. fluxmap supports several automatic layouting algorithms such as the dot-layout and additionally offers flux-specific layouts including the functionality for splitting nodes with a high degree of connectivity. usually these nodes represent substances taking part in many different biochemical reactions, such as atp or co <dig>  the user may select such nodes based on a node list sorted by degree of interconnection, and thus trigger an automatic splitting of these nodes into a number of cloned nodes, one for each reaction . node splitting on the one hand improves network layout but on the other hand makes it difficult to visually follow the global flux. therefore, fluxmap enables the user to temporarily re-connect nodes with the same label again . this interaction can be repeated successively for several metabolites, thereby facilitating the tracking of main flux directions throughout large maps.

data output
the  network can be saved in the gml or graphml file format. the graphical export is possible as raster images  and vector images . using the noncommercial tool imagej  <cit> , raster images may be used to create animated gif files, e. g. in order to be able to show animations between different flux distributions in powerpoint slides. furthermore, fluxmap supports export as clickable web pages.

RESULTS
13c measurement of metabolic fluxes in seeds
in order to evaluate carbon flux distributions of the central seed metabolism of pisum sativum and medicago truncatula13c measurements were carried out based on the experimental procedure from junker et. al.  <cit>  and raw data was processed according to wiechert et. al.  <cit> . from a biological point of view the comparison of both plants is of interest, as on the one hand they belong to the same family, indicating a high genetic similarity, but on the other hand show a strong physiological difference: the pisum sativum seed primary product is starch, whereas the medicago truncatula seed primary product are lipids . to understand the differences of the metabolism from a systemic perspective, both flux maps have to be visualized and compared interactively. the data is taken directly from the output of 13cflux, which is a toolkit for isotope-based metabolic flux analysis  <cit> . the dataset consists of two conditions, a list of how many carbon atoms the substances have, the relative flux values and a quality value indicating measurement uncertainty. using the combobox in fluxmap, users are able to compare both flux maps, including the quality of the fluxes. by switching between both conditions it is easy to see that for medicago truncatula there is a lower flux into starch, but a higher flux into lipids in comparison to pisum sativum . further statistical evaluation may be carried out to search for other significant differences or correlations.

flux balance analysis of oxygen conditions in barley seed metabolism
grafahrend-belau et. al.  <cit>  generated a stoichiometric model of barley seed central metabolism and analyzed the impact of six different oxygen levels on the rate of biomass synthesis . using flux balance analysis they derived simulated flux distributions for different oxygenic phases . the visualization focuses on mass fluxes rather than substance fluxes and, consequently, the weights of all metabolites were set to  <dig> in the input template. additionally flux variability analysis  was performed, which gives the minimal and maximal possible flux through a reaction, when observing all possible flux distributions that fulfill the given constraints . fva is used for the detectionmof essential reactions or reactions allowing for am high flux variation, thereby providing robustness against environmental influences. in the present use casemthis variability information is assigned to each reaction as a quality parameter. if the “quality” is zero, them flux through this reaction does not vary and is drawn black . more variable reactions have “high quality” values and are visualized by red graduation. fluxmap enables users to easily switch between the different oxygen conditions while displaying the quality information simultaneously. the simulated flux distributions for three different oxygen regimes  are in accordance with published experimental results : under anaerobic conditions a high flux through fermentative enzymes is predicted whereas aerobic conditions lead to a higher flux into storage products and seed biomass. furthermore, different oxygen levels affect the tca cycle in terms of cyclic or non-cyclic modes and the direction of its reactions. note that fluxmap automatically adapts the edge directions.

discussion
fluxmap provides functionalities for the advanced visualization and exploration of flux maps, regardless of source and type of the flux data. following the argumentation of sweetlove and ratcliffe  <cit> , who conclude that flux distributions derived from flux balance analysis provide an important complement to experimentally determined 13 c-flux distributions, fluxmap supports the visual analysis of mass and substance fluxes.

for the visualization of flux measurement data other software exists with partially overlapping features compared to fluxmap, as summarized in table  <dig>  the majority of tools provide the possibility to import flux data from other sources. this is not true for metafluxnet and optflux, which compute and analyze internal simulation-derived flux data. on the other hand, only these tools and fluxmap are able to process substance and mass fluxes. as a common feature, most of the tools offer direct access to network databases as well as network editing functionalities, which are important prerequisites for network-based flux visualization. once flux data is mapped onto a network only the fluxmap workflow comprises a flux balance validation step. with regard to visualization and exploration functionalities, it is comparable to tools such as fluxviz, fa-bina and omix with options for customization and interaction. in the context of advanced visualizations, fluxmap supports the representation of quality parameters such as the confidence interval for each flux value. finally most of the tools allow for the integration of other -omics data in order to set fluxomics in relation to metabolomics, transcriptomics as well as proteomics.

feature overview of tools available for flux visualization in the context of networks. “+” indicates good support of the feature, “-” indicates an absent or inadequately supported feature. in conclusion, fluxmap supports a broad range of features and novel functionality for the visual exploration of flux distributions in biological networks.

in summary, fluxmap combines a simple, fast and source-independent data import of flux data with different parameters for generating user-specific visualizations as well as intuitive network exploration capabilities. fluxmap and the underlying vanted system provide a framework for the integration of comprehensive metabolic datasets and their combined representation in the network context. other add-ons of the vanted system enable fluxmap to e. g. access experimental and pathway databases and add support for the systems biology graphical notation  <cit> .

CONCLUSIONS
fluxmap is a tool for the visualization and interactive exploration of flux distributions in biological net- works and available from additional file  <dig>  flux data import is achieved using a structured template containing experimental metadata as well as flux values and quality parameters each of which is assigned to one biochemical reaction. after the import and mapping of the flux data, balance validation can be used for the identification of possible input errors. various visualization and interaction options enable users to explore, compare between and interact with visualized flux maps of different conditions and samples. as an extension of the vanted system, fluxmap also provides network editing functionalities and further options for data analysis such as statistical tests. in conclusion, the fluxmap tool fulfills all requirements of flux data visualization and, together with basic vanted functionalities, constitutes a comprehensive software package for advanced, network-based analysis of flux and other metabolic datasets.

availability and requirements
· project name: fluxmap

· project home page: http://www.vanted.org/fluxmap/

· operating system: platform independent 

· programming language: java 6/7

· license: gpl  <dig> 

authors’ contributions
hr implemented the tool. hr, ah and aj wrote the manuscript. bhj and ah provided requirements. bhj and ah evaluated the implementation. fs supervised the project and gave conceptual advice. all authors read and approved the manuscript.

competing interests
the authors declare that they have no competing interests.

supplementary material
additional file 1
workflow screenshots - tutorial.pdf. a pdf containing a series of screenshots of an exemplary fluxmap workflow.

click here for file

 additional file 2
software and source code - fluxmap.jar. the java binary and the source code as a jar-file, which can be installed and used as an add-on for vanted.

click here for file

 acknowledgements
we thank eva grafahrend-belau for providing the simulation data and christian krach for testing the tool.
