BACKGROUND
in macromolecular crystallography, the determination of a 3d structure of a molecule of interest involves the gathering of the intensity and phase information for a crystal diffraction pattern, from which an electron density map can be calculated. unfortunately, in a diffraction experiment, only the intensity is measured, and information about phases is lost. the missing information must be provided either from independent experiments or must be estimated from other sources. the molecular replacement  technique is an approach with which to approximate the phase information from a structure of a related macromolecule or from a theoretical model of the macromolecule under investigation . mr involves the placement  of a search model in the asymmetric unit of the target crystal
 <cit> . the placements are scored by an mr search function that measures the agreement between the theoretical and the observed structure factors
 <cit> . the success of mr depends on two factors: the fraction of the asymmetric unit for which there is a suitable model, and the global model quality  of the search model. in most cases of successful mr applications for determination of protein structures, the sequence identity between the target and the template is at least 35%
 <cit> .

traditionally, typical mr experiments involved homologous structures rather than theoretical models of the target protein. anna tramontano and coworkers tested the utility of theoretical models submitted to the critical assessment of techniques for protein structure prediction  experiment. they were able to obtain an interpretable electron density map for  <dig> out of  <dig> models
 <cit> . in an earlier work, that group reported that gdt_ts  was a better indicator of the model utility for mr than rmsd. they also showed that models with gdt_ts <  <dig> were never successful in mr, while gdt_ts > <dig> was sufficient to guarantee mr success
 <cit> .

it is obvious that the success of mr depends on the accuracy of the search model. unfortunately, this parameter is unknown until the native structure of the target protein is solved. however, in the structural bioinformatics community, model quality assessment programs  were developed, which predict the accuracy of protein structure models , both globally and for individual residues. the existing mqaps are based either on physical effective energy obtained from fundamental analysis of the particle forces or on empirical pseudo-energy derived from known protein structures
 <cit> . mqaps can be divided into two other categories: 1) “true mqaps” - methods capable of assessing quality for single models, without using any alternative models  for the target protein; 2) “clustering mqaps” – methods that rely on structural comparisons between a number of alternative models generated for the target sequence. according to the casp <dig>  casp <dig>  casp <dig> experiments, where plenty of models based on varied prediction methods are compared, clustering approaches significantly outperform “true mqaps”, especially when ranking models according to their accuracy. however, in cases when only one or very few alternative models are available, the gap between “clustering mqaps” and “true mqaps” is marginal, with “true mqaps” performing better in extreme cases
 <cit> .

the aim of our work was to investigate whether protein structure prediction in combination with local model quality assessment can effectively increase the success rate of mr in comparison to the polyalanine-based mr. first, we developed an automatic mr workflow that adds information about the local model accuracy to the 3d structure of a search model. second, we demonstrated that the knowledge of real local accuracy of a model has significant positive impact on the success rate of mr. finally, we showed that predicted local model accuracy, according to current clustering mqaps, could also improve the utility of computational models for mr.

methods
dataset of models
the analysis was performed on structure factors deposited in the protein data bank  for  <dig> proteins , each of which had one molecule in the asymmetric unit  and resolution ≤  <dig> Å. all of these proteins had previously been targets in the casp <dig> experiment and had their structure factor data deposited in the pdb. each protein from the dataset was used to query the dali program
 <cit>  to find structurally similar proteins . our goal was to analyze the utility of models for molecular replacement rather than to compare the utility of various search tools for finding tentative models for molecular replacement. for this reason we selected dali rather than sequence-based homology search tools that only predict structural similarity.

based on these dali alignments, models of reference proteins were generated with modeller
 <cit> , a model-building program that minimizes the violation of stereo-chemical constraints as well as restraints derived from the template, and yields the canonical set of atoms for each residue. unaligned regions  longer than  <dig> aa were removed from these models . as a result,  <dig> comparative models were created for the  <dig> proteins. additional file
1: table s <dig> presents the basic statistics of these models.

the average model crmsd from the corresponding native structure was  <dig>  Å, the mean gdt_ts was  <dig>  and the average model completeness  was 89%. the most accurate models were created for protein 2gw <dig> , the least accurate ones for 2h <dig> .

the temperature factor
the temperature factor or b-factor can be thought of as a measure of how much an atom oscillates or vibrates around the position specified in the model. for instance, atoms at side-chain termini exposed to the solvent are expected to show more freedom of movement than atoms in the densely packed protein core. if the temperature factor bj is taken as a measure of a thermal motion of atom j, then bj is related to the mean-square displacement of the atom from its average position as follows:

  βj=8π2uj <dig> 

where: uj <dig> is the mean-square displacement of the atom from its average position in all  directions.

since b-factor relates to uncertainties in atomic positions, we decided to apply the above equation to recalculate the b-factor of an atom on the bases of its accuracy, and then use two mr programs that take into account b-factor values as the indicator of local accuracy of a model. the idea had been also proposed by read during the casp 7th conference
 <cit> .

global and local accuracy of a model
in order to compute real global and local accuracy of the models in our study, the lga
 <cit>  program was used in a sequence-dependent mode. each model was superimposed onto its corresponding native structure and then the deviations between the atoms in the model and their counterparts in the native structure were measured.

we also used two parameters to measure the global accuracy of a model. the first one is a root mean square deviation  between corresponding c-α atoms of the target and model structure. the second one is a global distance test . the latter measure corresponds to the average value of fractions of c-α atoms in the model that are placed within the distance of  <dig>   <dig>   <dig>  or  <dig> Å from the corresponding c-α atoms in the native structure.

in addition, we also tested the predictions yielded by two model quality assessment programs : metamqap and metamqapclust. the metamqap program
 <cit>  uses a machine learning approach to assess the deviation of c-α atoms in a model. in order to operate, metamqap combines the output from a number of model quality assessment programs , including verify3d
 <cit> , prosa
 <cit> , bala-snapp
 <cit> , anolea
 <cit> , prove
 <cit> , tune
 <cit> , refiner
 <cit> , and proqres
 <cit> . in addition, the metamqap prediction is based on the following residue features: secondary structure, solvent accessibility, and residue depth. the metamqap method is a “true mqap” - it is capable of producing model quality estimation based on just one single model.

metamqapclust requires a set of models as an input. it functions similarly to the qmeanclust method
 <cit> . first, it ranks all models according to the metamqap score. then, a 3d-jury
 <cit>  procedure is executed for the 15% of top-ranked models. the 3d-jury score of a residue i in a model j is the mean distance of the residue to corresponding residues in the pairwise superposition of the considered structures:

  sij=1n−1∑k= <dig> k≠jndijk 

where: sij is the score of residue i in a model j. n is the number of the 15% of top-ranked models, dijk is the distance between i residues in superimposed models j and k.

in the casp <dig> experiment, metamqap and metamqapclust were shown to belong to the groups of best performing “true mqaps” and “clustering mqaps”, respectively
 <cit> .

using local model accuracy of a model for mr
the main goal of the study was to investigate whether a combination of local model quality assessment with structure prediction can effectively increase the success rate of mr . accordingly, local model quality was used to modify the b-factor values of a search model which then in turn was used to find mr solutions using molrep
 <cit>  and amore
 <cit> . in our procedure, the two programs took into account the b-factor values of the atoms as indicators of uncertainties in these atoms’ positions. in addition, we also tested whether all-atom models have the same utility for mr as the backbone-atom ones. taking all of these questions into account, we created ten groups of search models, as listed below:

 all_ <dig> – full atom models, no information about local model accuracy was used - the b-factor of each atom was set to  <dig> 

 all_ideal – b-factor values were modified  according to the real local accuracy of a model, calculated by superposition of the model onto the true structure.

 backbone_ <dig> – models as in all_ <dig>  but containing backbone atoms only .

 backbone_ideal - models as in all_ideal, but backbone atoms only .

 all_ca_ideal – b-factor values of each residue in the model were modified  according to the real local accuracy of the position of this residue’s c-α atom.

 backbone_ca_ideal - models as in all_ca_ideal, but backbone atoms only .

 metamqap-evaluated - b-factors values were modified  according to the local model accuracy predicted by the metamqap method
 <cit>   . since metamqap predicts deviation only for c-α atoms, the b-factor value predicted for each c-α atom was transferred to all main-chain atoms of the residue under consideration. in addition, all side-chain atoms were removed.

 metamqapclust-evaluated – similar to metamqap-evaluated, but the local model accuracy was predicted by the new metamqapclust method instead of metamqap.

 polyala – plyalanine templates - template structures converted to polyalanine models.

 polyala_ <dig> – similar to polyala, but the b-factor value of each atom was set to  <dig> 

the groups from a) to h) contain different modifications of each of the initial  <dig> models. additionally, we also run mr with polyalanine templates , which we consider as the baseline regarding to the polyalanine-based mr procedure.

molecular replacement and model building workflow
the mr procedure and model building were run in a completely automatic fashion . the workflow consisted of the following steps:

a. the b-factor value of each atom was modified according to the local accuracy of a search model. in case of metamqap and metamqapclust, which predict only the deviations for c-α atoms, the deviations of other atoms for a given residue were assumed to be equal to the b-factor value of the c-α atom of the residue.

b. the placement of a search model in the asymmetric unit was done by two programs, molrep
 <cit>  and amore
 <cit> , included in the ccp <dig> suite
 <cit> . both programs were executed with the default parameters . the default resolution limit of  <dig> Å was used for both programs.

c. for each method  the  <dig> best orientations of a search model in au were collected. then, the phaser
 <cit>  was used to refine all of these solutions. the phaser program was run in a refinement mode with the default parameters.

d. the best orientation according to the phaser program was given as input to refmac
 <cit>  to perform  <dig> cycles of restrained refinement without prior phase information.

e. finally, by using the arp/warp program
 <cit> , the observed structure factors  and reconstructed phases  were used to build the structure of the target protein. the arp/warp program was executed with the default parameters.

RESULTS
we performed mr for  <dig> known protein structures with a resolution better than  <dig> Å and one molecule per asymmetric unit. for these proteins,  <dig> comparative models were created in total . to investigate if the local accuracy of a search model is important for mr, we tested eight variants of the modifications of these models. in addition, as a control study, we also tested two sets of polyalanine templates . finally,  <dig> independent mr phasing attempts were performed.

in order to count as a successful mr case, at least half of the c-α chain must have been built by our molecular replacement workflow . first, we checked whether the use of known or predicted local model accuracy improved the utility of theoretical models in mr. second, we assessed which measure of the global model quality was the best indicator of a model suitability for mr. finally, we analyzed when mr benefited most from the use of theoretical models when the information about the local accuracy of these models was given.

the absolute real local accuracy of search models increases the likelihood of successful mr calculations
this section deals with testing if local accuracy can improve the mr success ratio. thus, as it was described in the methods paragraph, we tested  <dig> different variants of search models, which were varied in the following characteristics: the type of the local accuracy of a model , the subset of atoms used to define the structure of a search model , the type of a search model .

according to the data presented in figure
 <dig>  all-atom models without any information about local model quality  were effective in  <dig> % of the mr cases analyzed. similarly, backbone-atom variants of these models  were successful in  <dig> % of the cases, showing that the removal of side-chain atoms slightly increases the model utility for mr.  <dig> % success ratio was achieved when polyalanine templates  were used. interestingly, the use of polyalanine templates with b-factor values set to  <dig>  had significantly lower success ratio , suggesting that b-factor values bring an added value to the mr procedure - the original b-factor values increased the success ratio by  <dig>  % compared with the polyala_ <dig> search models.

when the real local accuracy of a model was used to modify the b-factor values, all-atom models  and backbone-atom models  were able to solve respectively  <dig> % and  <dig> % of mr cases. search models modified only according to the real deviation of c-α atoms  were less useful for mr. mr searches with all_ca_ideal models found correct solutions in  <dig> % of cases, while for backbone_ca_ideal models the success ratio was  <dig> %.

in conclusion, we demonstrated that: 1) backbone models were more efficient in mr than the corresponding all-atom models; 2) the classic mr based on either homologous structures or comparative models had a success ratio of  <dig> % at most ; 3) comparative models were slightly more useful for mr than the corresponding polyalanine templates; 4) the use of real local accuracy almost doubled the utility  of all-atom models ; 5) when only the local quality of c-α atoms was used the success ratio increased  <dig>  times only .

the role of global model quality in predicting the model utility for mr
global model quality is defined here as the overall deviation between the model and the reference  structure. the root-mean-square deviation  between the corresponding atoms of the model and the native structure is one of the most commonly used measures of global model quality. however, it exhibits many problems, such as strong dependence on protein length and the hypersensitivity to the presence of a few major outliers. in contrast to rmsd, gdt_ts is a measure that calculates the largest set of the c-α atoms falling within a defined distance cutoff of their position in the native structure. therefore, gdt_ts score measures the fraction of correctly predicted structure and is less sensitive to larger errors localized in a few regions of the model. the gdt_ts score was adopted as the main assessment criterion for the critical assessment of structure prediction
 <cit> .

to analyze how efficient the rmsd and gdt_ts measures are for predicting whether a model is suitable for mr, we conducted the roc curve analysis. for each predictor, the area under the roc curves  was measured. in such analysis a perfect prediction would yield auc =  <dig>  whereas auc = ½ would suggest a random prediction. among predictors, not only did we test rmsd and gdt_ts, but also the target-template sequence identity measured for the structural-alignment of the structures of the target and the template protein. table
 <dig> presents the auc values for all types of search models studied here. on average, gdt_ts was the best indicator of mr success , rmsd was the second best  while sequence identity computed for structural alignment was characterized by the lowest mean auc value, eq.  <dig> . nevertheless, according to the methodology described by hanley and mcneil
 <cit> , these differences were not statistically significant for α= <dig> . although gdt_ts was the best indicator of mr success on average, it was not always the best predictor. for the models showed to be least useful for mr , sequence identity for structural alignment performed better than gdt_ts.

part a presents the accuracy of predictions of whether a model is suitable for mr. the auc values are presented for all types of search models studied here. in addition, for each predictor also the averaged auc value is shown. part b shows the optimal threshold values for the predictors. such a point reports to the value of a predictor for which the success of mr drops significantly. predictors tested: rmsd and gdt_ts - global model quality computed by lga program. seqid_stru and seqid_seq – sequence identity computer for structural alignment  and sequence alignment , respectively. the following parameters describe target-template sequence alignment made by the hhalign program: fraction_of_gaps, aligned_columns, global_alignment_score, target length, above_ <dig> , above_ <dig> , above_- <dig> , above_- <dig> , below_- <dig> . amigomr – a predictor based on the logistic regression on abovementioned hhalign parameters.

until this point, only parameters requiring the knowledge of the native structure were tested. thus, we decided to investigate whether it is possible to predict the probability of the success of mr using only template and target sequences, i.e. using no information about the native structure. accordingly, we employed the hhalign program
 <cit>  to align each target sequence to sequences of the proteins that, according to dali, are homologous to the target protein. the parameters derived from the hhalign output describe the quality of each new alignment and consequently were also tested as possible indicators of mr success. these included the following: 1) sequence identity, 2) fraction of unaligned residues, 3) global alignment score, 4) number of aligned columns, 5) target length, and 6) the column score between the query and target. as the auc values presented in table
 <dig> indicate, target-template sequence identity was the best predictor of mr success , while the next best performing parameters were alignment score  and fraction of column with local alignment score above  <dig>  .

we also searched for threshold values for the optimal predictions made by the predictors studied here . in order to estimate such a threshold value for each of the predictors studied here, a standard roc analyzing procedure was applied, in which a threshold value was defined by the point on a roc that was closest to the top-left corner of a roc plot. the results presented in table
 <dig> shows that when gdt_ts is used to predict the mr success, the backbone_ <dig> models with gdt_ts ≥  <dig>  can be considered as useful for mr. for backbone_ideal and metamqapclust-evaluated models, the optimal thresholds of gdt_ts were  <dig>  and  <dig>  respectively. when sequence identity of a target-template profile alignment is used as a mr-success predictor, backbone_ <dig>  backbone_ideal and metamqapclust-evaluated models were suitable for mr for the following thresholds: 31%, 24% and 27% respectively.

developing the method for accessing the model utility for mr
as reported above, the sequence identity between the target and the template for the search model is not as good predictor of mr success of the model as the gdt_ts, while the latter requires the knowledge of the native structure . hence, in the second step of the study, we developed a predictor that operates only on the target and template sequences and does not require information about the native tertiary or secondary structure. among possible indicators of mr-success the following variables were tested, obtained from the hhalign program
 <cit> : 1) global alignment score, 2) number of aligned columns, 3) sequence identity between the target and the template, 4) fraction of unaligned residues, 5) target length, and 6-10) local alignment score  – the number of columns aligned with a score of at least:  <dig> ,  <dig> , - <dig> , - <dig> , and below - <dig> . these parameters were used as a set of independent variables in logistic regression predicting the mr-success. the regression was executed in a backward mode, in which the analysis begins with a full or saturated model and independent variables are eliminated from the model in an iterative process. the accuracy of the model is tested after the elimination of each variable to ensure that the model still adequately fits the data. the analysis is complete when no more variables can be eliminated from the model. in our study, the logistic regression procedure identified eight parameters statistically important for mr-success prediction: the number of column aligned with score at least:  <dig> ,  <dig> , - <dig> , - <dig> , sequence identity, fraction of unaligned residues, global alignment score, and target length. the predictor was trained and tested using a leave-one-out-cross-validation procedure, in which each learning set is created by taking all the samples except one; the sample left out serving as the test set. thus, for n samples, the cross-validation process is repeated n times, with each of the samples used exactly once as the validation data. as depicted in table
 <dig>  the mean auc value for the predictor was  <dig> . this shows that the predictor performs much better than sequence identity  and only slightly less efficiently than gdt_ts .

the abovementioned predictor can be executed via a simple web server – amigomr  which, using only the sequences of the mr target and the sequence of the template, predicts whether a search with a comparative model based on a given template will find the correct mr solution.

we decided to conduct a test of amigomr in conditions closer to real life. to do so, we downloaded the latest structures released by the pdb , which contained  <dig> protein entries that have been solved by x-ray crystallography. from this group, we selected  <dig> protein structures that were either single chain proteins or homomultimers. among these proteins,  <dig> have been solved by mr. in the remaining cases phases have been obtained experimentally. we clustered members of each group at 40% sequence identity and as a result we obtained a set  <dig> protein structures that had been solved by mr, and  <dig> structures that had not so. the first group we consider as structures proven to be solvable by mr. mr is usually attempted as the first method before experimental determination of phases, hence the second group of protein structures that had not been solved by mr is likely to be enriched in cases difficult for mr – nonetheless, no information about failed mr is available for these structures.

for each of these protein structures, we queried the genesilico fold prediction metaserver
 <cit>  and then amigomr. in the case of protein structures that had not been solved by mr, amigomr predicted  <dig> % of them as proteins for which the mr would be unsuccessful. in the case of structures proven to be solvable by mr, amigomr generated  <dig> % wrong predictions. assuming the first group of proteins as negatives and the second group as positives, for the dataset of these proteins, amigomr achieved sensitivity:  <dig> , specificity:  <dig>  and accuracy:  <dig> .

the impact of local model quality on mr success, and its dependence on global accuracy of a model
in the previous paragraphs, we showed that the estimation of local model quality facilitated successful protein structure determination by mr. thus, we decided to check if there is a relationship between the global quality of a model and the impact of knowledge about the local quality of the model on the mr success. figure
 <dig> presents mr success ratio as the function of the global accuracy of the model, expressed here by the gdt_ts score. for search models of high quality , the lowest success ratio  was obtained by polyalanine templates with b-factor values set to  <dig> . utilizing comparative models, but without the information about their local model accuracy, was successful in  <dig> % and  <dig> % of mr searches for backbone_ <dig> and all_ <dig> models respectively. unsurprisingly, significantly higher success ratio was observed when local model quality was applied for mr. for cases, when the perfect local model accuracy was used, all-atom models  and backbone-atoms models  solved  <dig> % and  <dig> % of mr cases, respectively. thus, the results suggest that using the real local accuracy of a model can boost the model utility for mr by 54%.

for the models of moderate quality , we observed that real local accuracy of a model significantly enhanced the mr success ratio, compared to a standard mr searches that do not utilize any information about the local accuracy of a model. in the case of backbone-atoms models, the local quality boosted the mr success ratio by 236% , and by 255% for all-atom models .

in accordance with our expectations, the search models of low quality  were practically useless for classic mr - neither all <dig> nor backbone <dig> solved any mr cases. the same phenomenon was observed for their corresponding polyalanine templates with b-factor values set to  <dig>  noteworthy, the utilizing real local accuracy of a model helped to find a few correct mr solutions with models of quality below gdt_ts  <dig>  in our study, all-atom models combined with their local model quality were successful in  <dig> %.

in the preceding paragraph, we demonstrated that the real local accuracy of a model had a significant positive impact on the model usefulness for mr. compared to the mr searches using polyalanine templates with b-factor values set to  <dig> , utilizing local accuracy of a model  can increase the mr success ratio by 75% for models with gdt_ts ≥ <dig> and by 317% for models of lower global accuracy .

according to our data, local model quality was critical for solving mr cases with the use of low quality models . for such cases we achieved a  <dig> % success ratio using backbone_ideal models, while for classic mr  the ratio was 0%.

the utility of model quality prediction by metamqap and metamqpacons in mr
in the previous paragraphs, we have shown that the real local accuracy of a model positively influences mr searches. nevertheless, the real quality remains unknown until the final structure of a protein is solved. however, there has recently been a tremendous development in the field of methods that predict local model quality without any knowledge of the native structure. since there are two main classes of model quality assessment programs : “true mqaps” and “clustering mqaps”, we decided to verify whether the mqaps of either type are able to enhance the model utility for mr. to achieve that, we tested two mqaps developed in our laboratory: metamqap  and metamqapclust . thus, we created two groups of search models, the first group  containing models with their b-factor values set according to the deviation predicted by metamqap. since metamqap predicts only the deviation of the c-α atom for a given residue, the b-factor values of the remaining atoms were set to the b-factor value of the c-α atom. moreover, all side-chain atoms were removed from the models. the same procedure was applied to produce the second group of models , but here we used the metamqapclus method to predict the model accuracy.

according to the results presented in figure
 <dig>  the metamqapclust-evaluated models helped to solve  <dig> % of mr cases, showing that using metamqapclust enhanced the success ratio by  <dig> % compared to the backbone_ <dig> models. no improvement over unmodified models was observed in the case of the metamqap-evaluated models.

models with gdt_ts≥ <dig>  with b-factor values changed according to the metamqapclust prediction, solved  <dig> % of mr cases. thus, for those models the mr success ratio is improved by 25% compared to backbone_ <dig> models. for the lower-quality models , metamqapclust predition enhanced the mr success ratio by 90% compared to backbone_ <dig> models. finally, metamqapclust helped in obtaining the correct mr solution with a model having gdt_ts score of  <dig> , i.e. demonstrated that the use of mqaps can push the threshold of applicability of mr for models with gdt_ts <  <dig> 

discussion
we have shown that using local model quality to recalculate the b-factors of a search model increases the success ratio of mr. for our dataset of  <dig> search models, the real local accuracy of a model increases the mr success ratio by 101% compared to corresponding polyalanine templates. on the contrary, when local model quality is not utilized in mr, the computational models solved only  <dig> % more mr searches than polyalanine templates. this suggests that comparative models can be very useful in mr, if their local accuracy is taken into account.

the presented roc analysis  points to the fact that the gdt_ts between the model and the native structure is a better measure for assessing model utility for mr than rmsd or sequence identity computed for structure-based target-template alignment. the findings are consistent with those of giorgetti and tramontano
 <cit> . they also reported that gdt_ts > <dig> was sufficient to guarantee success in mr and that models with gdt_ts < <dig> were not successful in mr. in our study, we showed that mr can be solved even using models with gdt_ts< <dig>  this inconsistency may be explained partially by the fact that in our mr workflow two mr programs: amore and molrep, were used independently, thus increasing the likelihood of determining the correct mr solution. in contrast, the giorgetti’s mr workflow
 <cit>  used only molrep to find the initial solution, and then amore just for the refinement of an initial mr solution. moreover, the search models studied here were trimmed by removing insertions longer than  <dig> residues. we decided to do that because insertions are more likely to contain significant errors, and if they are not removed, the errors may cause a model to fail in mr
 <cit> .

an important finding comes from the comparison between mr procedures that use/do not use the local accuracy of a model. for the mr searches not utilizing such accuracy the success ratio drops significantly for gdt_ts ≤  <dig>  . when local accuracy of a model is used, the mr success ratio declines significantly for gdt_ts ≤  <dig>  . interestingly, a marginal 2-unit change in gdt_ts score is accompanied by an over 2-fold change of the observed mr success ratio . a possible explanation for this might be that to solve a phase problem by mr a particular fraction of well-modeled atoms  is always required by a mr algorithm. if this criterion is satisfied, the likelihood of mr’s success can then be significantly boosted by making incorrectly modeled atoms  less important for the calculation of structure factors. in this paper, we have shown that this can be achieved by setting temperature factor values according to the local accuracy of a model, and then solving the phase problem by using mr programs that take into account these b-factor values .

we observed that the knowledge of the local quality of a search model is crucial for mr searches with models of moderate quality . backbone variants of models solved only  <dig> phasing attempts . in contrast, the same models found correct solution for  <dig> cases , provided they had their b-factors values modified according to the real local accuracy of a model. the results proved that the real local quality of a model increases the model usefulness by 235%. in comparison, for the highest quality models , backbone models were successful in  <dig> cases  of mr searches, while a combination of the backbone models with their real local accuracy found the correct solution in  <dig> cases , thus increasing the mr success by 54%. the difference suggests that moderate quality models still contain a required fraction of well-modeled atoms , but that to make these models significantly more useful for mr, the influence of local errors on the calculating of structure factor must be reduced.

not only have we evaluated the potential of using the perfect local model quality for mr but also tested whether the use of model quality assessment programs  can increase the mr success ratio. between the two tested mqaps: metamqap  and metamqapclust , only the metamqapclust method has been shown to significantly boost the mr success ratio. for our dataset of  <dig> search models, a workflow combining mr with the metamqapclust prediction found  <dig> correct solutions, which is 45% more compared to polyalanine models  and 39% more compared with backbone-atoms models with b-factor values set to  <dig> . the observation shows that current mqaps can significantly increase the mr success ratio.

since metamqapclust predicts only the accuracy of c-α atoms, it is very important to stress that the upper limit of the usefulness of the mqap for mr is defined by the above-mentioned results for backbone_ca_ideal models. in these models, for each residue, the real deviation of a c-α atom was used to modify the b-factor values of remaining atoms. we showed that backbone_ca_ideal solved  <dig> mr searches. this means that an ideal c-α-mqap would make mr find 65% more solutions than polyalanine-based mr, and only 14% more than mr that uses the current metamqapclust program. this shows that further development of mqaps predicting the accuracy of c-α atoms is still needed. however, mr using both all-atom models and real local accuracy of these atoms -  - solved  <dig> mr cases, which is 37% more that metamqapclust-based mr. thus, we postulate that mr would benefit most from an mqap capable of predicting local model quality  for all atoms in a model. to our best knowledge, such a method has not been developed so far.

our study is admittedly biased towards an optimistic view of the possibilities of combining comparative models and local model quality with the mr technique. the main limitation lies in the fact that the comparative models tested here were created on the basis of structural target-template alignments, thus producing more accurate alignments than sequence- or profile-based alignment methods. we decided to use structural alignments instead of sequence- or profile-based ones for the following reasons: first, there are plenty of different sequence- or profile-based methods and selecting one or a few of them would also bias our results towards these method. second, there has been a continuous development in sequence alignment methods based on profile-profile comparison, thus the accuracy gap between structural and non-structural alignments methods has decreased. finally, as shown by the godzik group
 <cit> , the likelihood of solving the phase problem for a given protein increases for extensive mr searches using the population of alternative alignments. therefore, the structural alignment can be considered as a representative of these alternative alignments. considering all these assumptions, we are sure that not only does our study present the theoretical upper limitations of combining local model accuracy with mr, but also with the continuous development of profile-profile alignments methods it offers a new practical approach for mr.

CONCLUSIONS
in conclusion, we have shown that using comparative models only marginally increases the mr success ratio in comparison to the polyalanine structures of templates. however, the situation changes dramatically once comparative models are used together with their local accuracy. we found that the lower the global quality of a model, the more significant is the impact of knowledge about the local quality of the model on the utility of the model for mr. we demonstrated that the use of a local accuracy of a model greatly increases the likelihood of successful mr calculations for search models with gdt_ts ≤  <dig>  we proved that the real local accuracy of a model enhances the mr success ratio threefold, for polyalanine models with gdt_ts between  <dig> and  <dig>  surprisingly, the perfect local accuracy of a model can make mr find correct solution even with a model having gdt_ts ≤  <dig>  our mr workflow was successful with a model that had gdt_ts= <dig>  and target-template sequence identity of 16%.

since the real local accuracy of a model is not known once the structure of a protein is solved, we tested whether model quality assessment programs  can improve the utility of theoretical models in mr. between the two programs tested in the study, metamqap  and metamqapclust , only the metamqapclust significantly boosted the mr searches. this suggests that current clustering mqaps can increase the model utility for mr. in addition, in our opinion, there is a great need for the development of mqaps capable of predicting the deviation for all atoms in a model, not only c-α ones.

inspired by these findings, we have added a new functionality to genesilico fold prediction metaserver
 <cit>  that will allow building models that are more useful for mr searches. thus, for a submitted target sequence, the genesilico metaserver generates many alternative models, then these models are trimmed in order to remove insertions longer than  <dig> aa, next metamqapclust is executed to assess the local quality of these models. finally, these model’s b-factor values are modified according to metamqapclust prediction. such models can be easily downloaded to the user’s computer, and then used as an input for mr searches .

additionally, we have developed a simple method, amigomr, to predict if mr search with the template-based model will find the correct solution. in our mr-workflow, amigomr predicts the mr success almost as accurately as gdt_ts does. nevertheless, for different home-made mr workflows, amigomr may less accurately estimate the absolute probability of solving mr with a given model. however, in such cases our method can still help to rank models according to their usefulness for mr. the amigomr program can be executed as a standalone web application:
http://iimcb.genesilico.pl/pawlo/amigomr/introduction.html and is also automatically run for predictions returned by the genesilico metaserver.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
mp and jmb conceived of the project, mp developed the mr-pipeline and generated data presented in the publication. mp analyzed the results, drafted the manuscript and prepared the figures. jmb edited the manuscript. both authors analyzed and interpreted the data. all authors read and approved the final manuscript.

supplementary material
additional file 1
supporting information. table s1: basic statistics of models constructed for all target proteins. figure s1: the results page of genesilico fold prediction metaserver and two its new functionalities. figure s2: rebuilt of models in our mr workflow. figure s3: correlation between the value of atom deviation and mr success.

click here for file

 acknowledgements
we thank jorge navaza, adam godzik and lukasz jaroszewski for inspiration and discussions. we thank lukasz kozlowski for help with adding new functionalities to genesilico fold prediction metaserver .we also wish to thank grzegorz chojnowski and iga korneta for critical reading of the manuscript.

this project was supported by the 7th framework programme of the european commission . m.p. was supported by the polish ministry of science . j.m.b. and the implementation of the amigomr software as a server was supported by the polish ministry of science and higher education .
