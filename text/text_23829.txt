BACKGROUND
over the past few decades, there has been a groundswell of support for phylogenetic methods to account for the ancestral relationships between interspecies data  <cit> . it is apparent that the signal of similarity by descent is sufficiently strong to mask other potentially interesting patterns in evolutionary samples  <cit> ; as a result, researchers have developed a suite of approaches for mitigating the influence of relatedness on inference from species or sequence data  <cit> . the most sophisticated approaches directly use phylogeny in an inferential procedure, and when this is possible, the explicit incorporation of an evolutionary model seems the best and most logical choice  <cit> . nevertheless, in many applications, no model readily presents itself, and the task instead reduces to modifying the impact of each species or sequence datum to reflect the unique contribution of that datum to the breadth included in the study. disagreement on the quantitative interpretation of this qualitative endpoint has led to a number of competing methods  <cit> , and as the goals of these methods differ, there is no direct means of comparison  <cit> .

how to average data collected from related taxa may be the most basic problem in which the vagaries of phylogenetic relationships come into play. because of the dependence structure imposed by the phylogenetic tree, it is inappropriate to treat sequences or other data collected from extant species as independent  <cit> . when the tree is known or can be confidently inferred, it provides the raw material to tease apart the relative contributions of each species to an average. still, even after agreeing on an appropriate dependence structure, it remains to define what qualities of the data the average should reflect. put another way, what defines the "average" parameter to be estimated from the species data?

typically, the process of averaging sample data creates a statistic that is used to estimate a population parameter. but, when the process is averaging data related by phylogeny, neither the population nor the parameter of interest is clear. one exception to this uncertainty is the ancestral reconstruction of a trait , which can be viewed as a type of averaging in which the parameter of interest is the unknown value of the most recent common ancestor of the set of species in the study. in that case, the population can be taken as the hypothetical collection of values of all species descended from the common ancestor of the species in the sample. this approach was taken in  <cit> , and, in concert with a evolutionary model, yields a formal estimation procedure. specifically, by assuming that evolution of a trait from the common ancestral value proceeds forward in time according to a brownian motion on the phylogeny  <cit> , the probability of observing the sample species data x <dig> .... xn can be expressed in terms of the unknown ancestral value μ as

 pr⁡=1n|Σ|exp⁡tΣ−1)
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacyggqbaucqggybgcdaqadaqaaiabdifaynaabaaaleaacqaixaqmaeqaaogaeiilawiaesojgskaeiilawiaemiwag1aasbaasqaaiabd6gaubqabagccqgg8bafiigacqwf8oqbaiaawicacaglpaaacqgh9aqpdawcaaqaaiabigdaxaqaamaakaaabawaaewaaeaacqaiyagmcqwfapacaiaawicacaglpaaadaahaawcbeqaaiabd6gaubaakmaaemaabagaeu4odmfacaglhwuaayjcsdaaleqaaaaakigbcwgaljabciha4jabcchawnaabmaabagaeyoei0yaasaaaeaacqaixaqmaeaacqaiyagmaawaaewaaeaacqwhybawcqghsislcqwf8oqbcqwhxaqmaiaawicacaglpaaadaahaawcbeqaaiabdsfaubaakiabfo6atnaacaaaleqabagaeyoei0iaegymaedaaowaaewaaeaacqwhybawcqghsislcqwf8oqbcqwhxaqmaiaawicacaglpaaaaiaawicacaglpaaaaaa@62ff@ 

where x is the length-n column vector of species data,  <dig> is a length-n column vector of ones, and Σ is the covariance matrix specified by the phylogeny under the model . the parameter of interest μ can then be estimated by maximum likelihood as μ^=wtx=1tΣ−1x1tΣ−11
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf8oqbgaqcaiabg2da9iabheha3naacaaaleqabagaemivaqfaaogaeciwaglaeyypa0zaasaaaeaacqwhxaqmdaahaawcbeqaaiabdsfaubaakiabfo6atnaacaaaleqabagaeyoei0iaegymaedaaogaeciwagfabagaecymaezaawbaasqabeaacqwgubavaagccqqhjowudaahaawcbeqaaiabgkhitiabigdaxaaakiabhgdaxaaaaaa@42bf@, which doubles as a recipe for constructing a weighted average of the data x collected from related species. importantly, however, this average is designed to faithfully estimate the ancestral data, and depending on the shape of the phylogeny, the most recent common ancestor may be far from representative of taxonomic distribution of the species in the study. a simple alternative might be to find a point on the phylogeny that does appropriately represent the taxonomic distribution; for example, this rationale has motivated the center-of-tree approach as a remedy for phylogenetic deficiencies in consensus and ancestral-state hiv vaccine design  <cit> . unfortunately, this exchanges one problem for another, as in general no clear concept of a representative point currently exists.

toward the same goal of representing the whole of the phylogeny, we turn to a different interpretation of the estimation problem in  <cit>  and develop a useful alternative in similar spirit. in what follows, we redefine the concept of a phylogenetic average, comparing this in philosophy to existing methods. in doing so, we show that our notion of an average is inherently robust against the vagaries of ancestral relationships, and we discuss how this directly relates to the use of species weights. additionally, we show that our approach maps the average value to a representative point in species space that lies off the phylogeny. this last result provides an alternative to ancestral reconstruction that may in some cases be preferable, including when the goal of reconstruction is vaccine design.

RESULTS
defining an average
the brownian motion model has traditionally been used to describe the evolution of quantitative traits undergoing genetic drift  <cit> . as in the averaging context of  <cit> , we interpret the brownian motion as random flux about an optimum, and we consider the effects of variation about that optimum to be negligible. furthermore, there exists a prototypical value μ, which in  <cit>  was attained by the ancestral species at the phylogenetic root. in our approach, we also seek a prototypical μ, but instead make no a priori assumption that it is the ancestral species which attains the value of interest. unfortunately, by no longer treating the root as a representative point, both the biological and statistical interpretations of μ in  <cit>  are lost. to construct a meaningful parameter in this setting, our approach is to consider the sample paths of the stochastic process from which the data are presumed to arise.

when data are collected from related taxa, only the endpoints of the evolutionary process are observed. but suppose we adopt a "missing data" perspective and consider the case when the entire evolutionary trajectory is known. under this scenario, there is no "averaging problem", because we can directly compute the average of the values observed over the course of the evolutionary trajectory. the question then is how to estimate this same average in the absence of the missing data. we propose an average of averages, namely the expectation of the average trajectory value with respect to a probability measure on all possible trajectories. it turns out that this can be easily accomplished within the existing brownian motion framework.

computing an average
recall that the model of  <cit>  views the species data x <dig> ..., xn as the multivariate endpoint of a brownian motion on the phylogeny. the initial value of the process is the unknown parameter μ at the root, which we will henceforth call xa to reflect its meaning as the unobserved ancestral datum. we begin this section by exploiting the reversibility of the model to remove the unnatural emphasis on the root and its value xa.

to develop our ideas, it is easiest to proceed using a two-taxon tree for which the data are simply x <dig> and x <dig> . the tree relates two extant species, labelled  <dig> and  <dig>  whose data are x <dig> and x <dig>  respectively. there are t <dig> units of evolutionary ivergence separating species  <dig> and the ancestral species a, while species  <dig> and the ancestral species a are separated by t <dig> units.  the brownian motion model assumes that x <dig> and x <dig> have evolved from the ancestral value xa according to lineage-specific brownian motion processes ω <dig> and ω <dig> . the two independent processes begin at time  <dig> at the ancestral species a, with ω <dig> = ω <dig> = xa. running forward in time, the data are assumed to be the endpoints of these processes: ω <dig> = x <dig> and ω <dig> = x <dig>  the approach of  <cit>  views the species data as random and the ancestral value as an estimable unknown: conditional on xa, x <dig>  and x <dig> are independent normal random variables with common mean xa and variances t <dig> and t <dig>  respectively. by contrast, we advocate conditioning on the species data and considering the evolutionary trajectory  as random. among other benefits, this approach allows us to exploit the reversibility of brownian motion, combining ω <dig> and ω <dig> into one process ω . according to the model, the combined process ω is a brownian bridge, or in other words, a brownian motion conditioned on both of its endpoints  <cit> . the distribution of the now random xa is simply the distribution of ω, which theory gives to be normal with mean 1t1+t2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabigdaxaqaaiabdsha0naabaaaleaacqaixaqmaeqaaogaey4kasiaemidaq3aasbaasqaaiabikdayaqabaaaaowaaewaaeaacqwg0baddawgaawcbagaegymaedabeaakiabdifaynaabaaaleaacqaixaqmaeqaaogaey4kasiaemidaq3aasbaasqaaiabikdayaqabagccqwgybawdawgaawcbagaegomaidabeaaaogaayjkaiaawmcaaaaa@4019@ and variance t1t2t1+t2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabdsha0naabaaaleaacqaixaqmaeqaaogaemidaq3aasbaasqaaiabikdayaqabaaakeaacqwg0baddawgaawcbagaegymaedabeaakiabgucariabdsha0naabaaaleaacqaiyagmaeqaaaaaaaa@37f4@ . in particular, the mean of this distribution is exactly the estimated average μ^
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwf8oqbgaqcaaaa@2e79@ from  <cit> .

earlier we proposed to average the values observed over the course of the evolutionary trajectory; now we have a framework under which this can be accomplished. rather than take ω to be the quantity of interest for each sample path, we consider for each sample path its average ω¯=1t1+t2∫0t1+t2ωdt
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwfjpwdgaqeaggaaiab+1da9maalaaabagaegymaedabagaemidaq3aasbaasqaaiabigdaxaqabagccqghrawkcqwg0baddawgaawcbagaegomaidabeaaaagcdawdxaqaaiab=l8a3naabmaabagaemidaqhacagloagaayzkaaaaleaacqaiwaamaeaacqwg0baddawgaaadbagaegymaedabeaaliabgucariabdsha0naabaaameaacqaiyagmaeqaaaqdcqghrii8aogaemizaqmaemidaqhaaa@4762@ .
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwfjpwdgaqeaaaa@2e98@ of each sample path is computed using the formula ω¯=1t1+t2∫0t1+t2ωdt
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwfjpwdgaqeaggaaiab+1da9maalaaabagaegymaedabagaemidaq3aasbaasqaaiabigdaxaqabagccqghrawkcqwg0baddawgaawcbagaegomaidabeaaaagcdawdxaqaaiab=l8a3naabmaabagaemidaqhacagloagaayzkaaaaleaacqaiwaamaeaacqwg0baddawgaaadbagaegymaedabeaaliabgucariabdsha0naabaaameaacqaiyagmaeqaaaqdcqghrii8aogaemizaqmaemidaqhaaa@4762@. the mean μ of the distribution of these values is the average that we propose here.

the brownian motion model induces a distribution on ω¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacuwfjpwdgaqeaaaa@2e98@, and the mean of this distribution is exactly the average of averages we seek. using fubini's theorem and a generalization of the result for the distribution of ω, we have

 e =1t1+t2∫0t1+t2edt=1t1+t2∫0t1+t21t1+t2dt= <dig> 
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgfbqrdawadaqaaggaciqb=l8a3zaaraaacaglbbgaayzxaagaeeiiaaiaeeypa0zaasaaaeaacqaixaqmaeaacqwg0baddawgaawcbagaegymaedabeaakiabgucariabdsha0naabaaaleaacqaiyagmaeqaaaaakmaapedabagaemyrau0aamwaaeaacqwfjpwddaqadaqaaiabdsha0bgaayjkaiaawmcaaagaay5waiaaw2faaawcbagaegimaadabagaemidaq3aasbaawqaaiabigdaxaqabawccqghrawkcqwg0baddawgaaadbagaegomaidabeaaa0gaey4kiipakiabdsgakjabdsha0jabg2da9maalaaabagaegymaedabagaemidaq3aasbaasqaaiabigdaxaqabagccqghrawkcqwg0baddawgaawcbagaegomaidabeaaaagcdawdxaqaamaalaaabagaegymaedabagaemidaq3aasbaasqaaiabigdaxaqabagccqghrawkcqwg0baddawgaawcbagaegomaidabeaaaagcdawadaqaaiabdsha0jabdifaynaabaaaleaacqaixaqmaeqaaogaey4kasyaaewaaeaacqwg0baddawgaawcbagaegymaedabeaakiabgucariabdsha0naabaaaleaacqaiyagmaeqaaogaeyoei0iaemidaqhacagloagaayzkaagaemiwag1aasbaasqaaiabikdayaqabaaakiaawufacagldbaaasqaaiabicdawaqaaiabdsha0naabaaameaacqaixaqmaeqaasgaey4kasiaemidaq3aasbaawqaaiabikdayaqabaaaniabguiiydgccqwgkbazcqwg0badcqgh9aqpdawcaaqaaiabigdaxaqaaiabikdayaaadawadaqaaiabdifaynaabaaaleaacqaixaqmaeqaaogaey4kasiaemiwag1aasbaasqaaiabikdayaqabaaakiaawufacagldbaacqgguaglaaa@87b2@ 

in words: when there are only two data points, our method dictates that they have equal weight in an average. the mathematical discourse runs the danger of obscuring what has transpired: in computing the average of averages, fubini's theorem gave the choice of which average to take first. averaging first by time point rather than by sample path, we were able to collapse the distribution of sample paths into the dashed line of means . taking the average of that straight line on the y-axis was trivial and yielded the halfway point  <dig> 
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabigdaxaqaaiabikdayaaadawadaqaaiabdifaynaabaaaleaacqaixaqmaeqaaogaey4kasiaemiwag1aasbaasqaaiabikdayaqabaaakiaawufacagldbaacqgguaglaaa@3716@ this is also the mean of the distribution of average values shown in figure  <dig> 

while a two-taxon application is trivial, the methods outlined above are completely general and apply to datasets and phylogenies of arbitrary size. our average of averages is easily computed for any tree topology, binary or multifurcating, without regard to the placement of the phylogenetic root. in the two-taxon case, we saw that our result took the form of a weighted average. this is also general; under the brownian motion model, the average of averages will always be a convex combination wtx=∑i=1nwixi
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwh3bwddaahaawcbeqaaiabdsfaubaakiabhifayjabg2da9maaqadabagaem4dac3aasbaasqaaiabdmgapbqabaaabagaemyaakmaeyypa0jaegymaedabagaemoba4ganiabgghildgccqwgybawdawgaawcbagaemyaakgabeaaaaa@3e47@ of the species data x <dig>  ..., xn . thus, in defining our notion of an average, we have also proposed a novel taxon weighting scheme. the implications are explored in subsequent sections.

weights and averages
if we restrict our consideration of averages to convex combinations  wtx of the observed data vector x, then the assignment of weights to taxa is tantamount to an averaging procedure. the literature on taxon weighting is extensive, particularly with regard to sequence data, and can be coarsely dichotomized into extrapolative and interpolative procedures. the bulk of weighting schemes have been designed to extrapolate beyond the sample; in these methods, weights w are chosen to summarize the data x so as to maximize the ability of wtx to recognize distant similarity to the dataset  <cit> . averaging procedures, by contrast, are interpolative, and seek to summarize the data x so as to maximize the similarity between wtx and x itself. the common thread that unites these weighting schemes is the goal of discounting redundancy due to similarity by descent; however, because the different ends fundamentally require different means, for relevance we limit the discussion to only those interpolative procedures suitable for averaging. specifically, we will focus on the previously described tree-based brownian motion approach  of  <cit>  and the related distance-based approach  of  <cit> , restricting attention in the latter case to pairwise distances derived from a tree. both methods seek an interpolative average that mitigates the impact of ancestral relations in an interspecies sample.

distances and representative points
when considering the taxonomic distribution of an interspecies dataset, there are minimally two issues to consider:  the placement of the taxa relative to each other, and  the placement of the taxa relative to the evolutionary trajectory described by the tree . the relative placement of the taxa to each other can be summarized by the matrix d of pairwise distances whose entries dij record the phylogenetic branch length, and hence the evolutionary divergence, separating species i and j. the relative placement of the taxa on the tree can be summarized by d in concert with an additional vector z whose entries zi record a measure of evolutionary divergence between species i and an arbitrary reference that we call the representative point. in the acl approach, zi is the divergence  between species i and the common ancestor at the root at the tree; by contrast, the distance-based va approach has no explicit representative point and accepts any z proportional to the vector  <dig>  in both cases, the weight vectors can be shown to satisfy the linear relation dw - z = c <dig>  where c is a normalizing constant so that the weights sum to one. the solution to this equation gives the weights as

 w=d−111td−11+d−1z1td−1z
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwh3bwdcqgh9aqpdaqadaqaaiabigdaxiabgkhitiabhgdaxmaacaaaleqabagaemivaqfaaogaeciraq0aawbaasqabeaacqghsislcqaixaqmaagccqwh6bgeaiaawicacaglpaaadawcaaqaaiabhseaenaacaaaleqabagaeyoei0iaegymaedaaogaecymaedabagaecymaezaawbaasqabeaacqwgubavaagccqwhebardaahaawcbeqaaiabgkhitiabigdaxaaakiabhgdaxaaacqghrawkdaqadaqaaiabhgdaxmaacaaaleqabagaemivaqfaaogaeciraq0aawbaasqabeaacqghsislcqaixaqmaagccqwh6bgeaiaawicacaglpaaadawcaaqaaiabhseaenaacaaaleqabagaeyoei0iaegymaedaaogaecoeaohabagaecymaezaawbaasqabeaacqwgubavaagccqwhebardaahaawcbeqaaiabgkhitiabigdaxaaakiabhqha6baaaaa@5952@ 

which in this form reveals w as a convex combination of two weight vectors d−111td−11
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabhseaenaacaaaleqabagaeyoei0iaegymaedaaogaecymaedabagaecymaezaawbaasqabeaacqwgubavaagccqwhebardaahaawcbeqaaiabgkhitiabigdaxaaakiabhgdaxaaaaaa@3743@ and d−1z1td−1z
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabhseaenaacaaaleqabagaeyoei0iaegymaedaaogaecoeaohabagaecymaezaawbaasqabeaacqwgubavaagccqwhebardaahaawcbeqaaiabgkhitiabigdaxaaakiabhqha6baaaaa@3867@ that reflect the taxonomic considerations  and , respectively. note that the use of the inverse pairwise-distance matrix in the above formula is what distinguishes the acl and va procedures as interpolative and suitable for averaging.

a framework for comparison
the method we propose, called the branchmanager , can be discussed with acl and va in a common framework. our previously described notion of an average parameter μ leads to a weight vector w that satisfies the same linear relation dw - z = c <dig> as above . the pairwise distance matrix d is the same as in acl and va; however, the bm vector z has entries zi which record the average divergence between species i and any point on the tree. a simple example based on a three-taxon tree helps clarify bm and its relationship to acl and va . the tree has been rooted where the three branches meet at an internal node. as mentioned above, the acl-vector z records the branch length between each species and the root; thus, for the example in figure  <dig>  zacl =  <cit> t. this can be made more general by embedding the branches of the tree in coordinate space. in figure  <dig>  the three branches adjacent to species  <dig>   <dig>  and  <dig> are respectively embedded into x-, y-, and z-axes with the root of the tree placed at the origin . species  <dig>  for example, has coordinates  and the divergence between species  <dig> and the root is computed as the l1-distance | <dig> - 0| + | <dig> - 0| + | <dig> - 0| =  <dig>  this is the entry for species  <dig> in the vector zacl, and the entries for species  <dig> and  <dig> can be similarly expressed; the crux is that the vector z can be computed as the l1-distance between each species and a representative point, in this case, the phylogenetic root.

whereas acl uses an explicit representative point on the phylogeny, the points for va and bm are implicit and require moving off the phylogeny into extended coordinate space. the representative point for va is any point l1-equidistant to every species on the phylogeny; in the example, this point has coordinates  and is at an equal distance  <dig>  from species  <dig> , and  <dig> . of course, if the phylogenetic tree is ultrametric so that each species is equidistant from the root, then the points for va and acl agree. this reifies the argument of vingron and sibbald  <cit>  that acl and va weights are the same when the tree is ultrametric; if d and z are the same, then so too is w. by contrast, it is only for a star phylogeny that bm will also in principle agree. the representative point for bm is what we term the "phylogenetic center of mass"; in other words, the balance point of the tree if it were treated as a rigid body. returning to figure  <dig>  imagine the tree as three rods, one for each branch, fused together at the origin in space. the center of mass of this object has coordinates , and this acts as the representative point for bm. crucially, the phylogenetic center of mass adapts to the shape of the phylogeny, whereas the representative points for acl and va in general do not. as the following example suggests, it is this quality that lends desirable properties to bm weights and averages.

a theoretical example
to illustrate the deficiency of the acl and va methods relative to bm, consider a contrived phylogeny of species  <dig> through n . we have chosen an ultrametric tree so that the methods above can be addressed simultaneously through the n × n pairwise-distance matrix

 d=
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwhebarcqgh9aqpdawadaqaauaabeqafuaaaaaabagaegimaadabagaeginaqdabagaeginaqdabagaes47iweabagaeginaqdabagaeginaqdabagaegimaadabagaegomaidabagaes47iweabagaegomaidabagaeginaqdabagaegomaidabagaegimaadabagaesy8i8eabagaeso7i0eabagaeso7i0eabagaeso7i0eabagaesy8i8eabagaesy8i8eabagaegomaidabagaeginaqdabagaegomaidabagaes47iweabagaegomaidabagaegimaadaaagaay5waiaaw2faaaaa@5179@ 

disregarding the root , the tree has a star-like phylogeny, and it is intuitive that the data from each species should contribute meaningfully to an average in which species  <dig>  owing to its greater divergence, receives proportionately greater weight.

indeed, both acl and va assign species  <dig> the largest weight n3n−2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabd6gaubqaaiabiodaziabd6gaujabgkhitiabikdayaaaaaa@3259@; however, the remaining n- <dig> species each receive a paltry 23n−2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabikdayaqaaiabiodaziabd6gaujabgkhitiabikdayaaaaaa@31e6@. imagine in the extreme that the datum x <dig> from species  <dig> is an outlier that does not reflect the family, while the data from the remaining species take the identical and biologically interesting value v. the acl and va averages, assuming the phylogeny of figure  <dig>  agree and are given by ∑i=1nwixi=n3n−2x1+2n−13n−2v
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaaewaqaaiabdeha3naabaaaleaacqwgpbqaaeqaaogaemiwag1aasbaasqaaiabdmgapbqabaaabagaemyaakmaeyypa0jaegymaedabagaemoba4ganiabgghildgccqgh9aqpdawcaaqaaiabd6gaubqaaiabiodaziabd6gaujabgkhitiabikdayaaacqwgybawdawgaawcbagaegymaedabeaakiabgucarmaalaaabagaegomaijaemoba4maeyoei0iaegymaedabagaeg4mamjaemoba4maeyoei0iaegomaidaaiabdaha2baa@4d10@. as the weight on x <dig> is at least one-third, this average can be quite different from v, and unfortunately collecting more data will not help: no matter how many new species present data with the value v, the contribution of the outlier x <dig> to the average will never be less than one-third.

the poor performance of the acl and va averages  can be attributed to their common representative point at the root. as more species are added to the phylogeny in figure  <dig>  the root becomes increasingly unsuitable as the focus for an average. though the additional lineages contribute evolutionary divergence, this information is effectively ignored at the root; by contrast, the phylogenetic center of mass is adaptive and responds to the addition of branches to the tree. a crude two-dimensional projection of the tree as embedded in n-dimensional space  illustrates this point . the shaded semicircle indicates the region of space in which the branches of additional species are being embedded. the phylogenetic mass in this region is growing with each new lineage, while the mass contributed by species  <dig> stays constant; thus, as new species are added, the phylogenetic center of mass is being pulled away from species  <dig> towards the remaining species. this is what we mean by "adaptive": the center of mass responds to the entire evolutionary trajectory.

as the phylogenetic center of mass moves away from species  <dig>  the bm weight on the datum from that species diminishes. of course, with the addition of more species, the weights on each of the remaining data decrease as well. the weight vector obtained by bm is given by wbmt=
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwh3bwddaqhaawcbagaemoqaikaemyta0eabagaemivaqfaaogaeyypa0zaamwaaeaafaqabeqaeaaaaeaadawcaaqaaiabiwda1iabd6gaujabgkhitiabikdayaqaamaabmaabagaemoba4maey4kasiaegomaidacagloagaayzkaawaaewaaeaacqaizawmcqwgubgbcqghsislcqaiyagmaiaawicacaglpaaaaaaabawaasaaaeaacqaizawmcqwgubgbcqghrawkcqaiyagmaeaadaqadaqaaiabd6gaujabgucariabikdayagaayjkaiaawmcaamaabmaabagaeg4mamjaemoba4maeyoei0iaegomaidacagloagaayzkaaaaaaqaaiabl+uimbqaamaalaaabagaeg4mamjaemoba4maey4kasiaegomaidabawaaewaaeaacqwgubgbcqghrawkcqaiyagmaiaawicacaglpaaadaqadaqaaiabiodaziabd6gaujabgkhitiabikdayagaayjkaiaawmcaaaaaaaaacaglbbgaayzxaaaaaa@6305@, which is intuitively satisfying. as species  <dig> remains the most divergent taxon on the star-like tree, its datum receives the largest weight as before. now, however, the addition of further species is accompanied by a proportionate decrease in all of the weights. interestingly, the ratio of the weight on x <dig> to the each of the remaining weights is w1w2=5n−23n+2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabdeha3naabaaaleaacqaixaqmaeqaaagcbagaem4dac3aasbaasqaaiabikdayaqabaaaaogaeyypa0zaasaaaeaacqai1aqncqwgubgbcqghsislcqaiyagmaeaacqaizawmcqwgubgbcqghrawkcqaiyagmaaaaaa@3b77@, which quickly approaches an asymptote of 5/ <dig>  that this ratio is stable is indicative of bm's performance; in the cases of acl and va, this ratio is n2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabd6gaubqaaiabikdayaaaaaa@2f13@ and grows unbounded.

a biological application
the theoretical situation in figure  <dig> is not particularly unrealistic. real phylogenies are often severely imbalanced, including the very example used to demonstrate the acl method  <cit> . we illustrate our method with a subtree of eleven hiv- <dig> isolates taken from the full phylogeny of fifteen isolates originally presented in  <cit>  . the isolate z <dig> traces its lineage directly to the phylogenetic root; consequently, z <dig> carries valuable, non-redundant information about the characteristics of the ancestral virus. the acl approach reflects this, as the weight of z <dig> is  <dig>  ; in other words, focused at the root, z <dig> contributes over 34% to the characteristics of the average isolate. but the root may not representative, and in this example most of the diversity is far from the root and z <dig>  representation at the phylogenetic center of mass mitigates the influence of z <dig>  simultaneously rewarding its non-redundancy while penalizing its divergence from the bulk of the remaining isolates . our approach reduces the weight of z <dig> to  <dig>  while upweighting the remaining ten isolates relative to acl , leading to an average that better reflects the diversity in the study.

the significance of choosing appropriate weights to compose an average depends on the characteristics that the average is meant to reflect. in the context of a sample of orthologous proteins, these characteristics are often functions of the amino acid sequences, and in  <cit>  some average properties of the hiv- <dig> envelope proteins  were used to motivate the discussion. as an illustration of this point, consider the alignment of a region of gp <dig>  the major envelope protein of hiv- <dig> . positions 307– <dig> reside in the variable region v <dig> of gp <dig>  and have been shown to include the binding site  for certain type-specific hiv-1-neutralizing antibodies that occur naturally in chimpanzees  <cit> . the sequence iriqrgpgrafvtig, shared by bh <dig>  pv <dig>  bru, and hxb, contains a number of amino acids with high β-turn potential, hydrophobicity, flexibility, and surface probability  <cit> . it is natural to ask whether this observation extends to all eleven hiv- <dig> isolates, or alternatively, whether there are amino acid positions for which the average value of each of these characteristics is high. we therefore turned to a set of scales that quantify each of the aforementioned physicochemical properties  <cit>  and then proceeded to compute a bm-weighted average of each at positions 307– <dig> in gp <dig> . figure 6a shows the results of this analysis. for the sake of presentation, each of the four physicochemical property scales was standardized, and the average characteristics at each position were themselves averaged across a window of width five. this approach highlights the overall trends in the plot, specifically what appears to be an exposed β-turn central to the fifteen amino acid stretch . this echoes the observation first made in  <cit>  and ultimately verified in a subsequent study of the structure of gp <dig>  <cit> .

the preceding calculations made implicit use of the weighted profile obtained by summing the bm weights of the amino acids present at each position in the alignment of figure 5c. by design, such a profile has been "corrected" for phylogenetic relationships, resulting in a more faithful representation of the family of sequences comprising the alignment. the bm-weighted profile for positions 307– <dig> of gp <dig>  presented as a logo  <cit>  in figure 6b, does not resemble the standard profile obtained by assigning each of the eleven sequences equal weight. in particular, because the four most closely-related isolates  receive only a combined weight of  <dig> , their identical sequence iriqrgpgrafvtig does not overwhelm the bm-weighted profile. moreover, due to differential treatment of the divergent isolate z <dig>  the bm-weighted profile also does not resemble the profile obtained by weighting each sequence according to acl; in the acl-weighted profile, the sequence qsirigpgkvfyakg from z <dig> dominates. the effect of biasing of the profile is most strongly seen through its further compression into a consensus sequence: in figure 6b, the bm-weighted consensus sequence reads across the top as qsitigpgrafyttg, which disagrees in three of its first four positions with the unweighted consensus sequence shown in black . paralleling the theoretical example above, the effect of bm here is to reduce the combined influence of closely-related isolates  without awarding disproportionate weight to highly-divergent ones . the result is a profile  which reflects the "average" sequence over the evolutionary period described by the phylogeny.

discussion and 
CONCLUSIONS
to function as a useful statistic, an average must faithfully summarize the dataset at hand. when the dataset is comprised of observations from related species, an average should additionally respect the phylogenetic relationships that underlie the data in the study. in this work, we present an alternative to existing methods that naturally achieves both ends. our approach, the branchmanager , seeks an interspecies average as a parameter μ that summarizes the entire evolutionary trajectory relating the data. in doing so, we assume that the sampled species define the taxonomic scope of the study and rely on their phylogeny and a stochastic model to define what the average should be. we derive our estimate of μ as a convex combination wtx of the species data x, and we consider the bm weight vector w in a common framework with those obtained by two existing methods: acl  <cit>  and va  <cit> . we show that bm, acl, and va each derive their weights using the pairwise-distance matrix d obtained from the tree in concert with a unique vector z that records the distance between each species and what we call a representative point in extended phylogenetic space. in comparing the representative points used by each method, we explain why acl and va may perform poorly for imbalanced phylogenies; conversely, we describe why the phylogenetic center of mass used by bm is adaptive and always reflects the branching structure of the tree. we proceed by example to demonstrate how each representative point influences its respective weights and averages, concluding that those derived by bm exhibit desirable properties.

because bm uses a representative point that lies off the phylogeny, it is difficult to provide a qualitative description of the weights that it assigns to each species. informally, our approach uses the dataset to infer its entire evolutionary trajectory, and each species is assigned a weight equal to its contribution to that inference. thus, the bm weight on a species can be loosely thought of as the fraction of total phylogenetic branch length to which its datum can be in some way attributed. in the two-taxon tree of figure 1a, this is exactly the case: each species is responsible for half of the length of the branch that connects them, and it is intuitive that each should receive a weight of  <dig> . this simple intuition can be extended to a more complicated phylogeny at the cost of some precision. in figure  <dig>  for example, the isolate z <dig> receives a weight of  <dig> , suggesting that it is responsible for  <dig> % of the total phylogenetic branch length. the branch length between z <dig> and the first divergence point among the remaining isolates is  <dig> , and this accounts for  <dig> % of the total phylogenetic branch length; half of that percentage, or  <dig> %, can be attributed to z <dig>  making  <dig>  a lower bound for its bm weight. the difference between this lower bound and the true weight of  <dig>  is primarily due to z3's majority influence on its branch – the taxon across that branch is unobserved, making z <dig> the more reliable partner in inferring their common evolutionary trajectory.

owing to the assumptions underlying its derivation, bm is best suited for averaging quantitative interspecies data. nevertheless, the weights that our procedure derives can be used to form a weighted consensus of categorical data as well. for example, as an alternative to existing methods of achieving consensus from a family of dna or protein sequences, bm can be used to define a consensus sequence weighted with respect to the phylogenetic center of mass. for exactly the reasons described in the text, we believe that a profile or consensus formed using bm weights faithfully represents the sequence data and its taxonomic origins. insofar as bm attempts to bring its average close to the evolutionary path defined by phylogeny, it is not unreasonable to anticipate that a bm-weighted consensus may be a functional member of the sequence family being summarized. such an approach may also prove fruitful in the area of vaccine design, where consensus, center-of-tree, and ancestral reconstruction methods are already being employed.

with an eye toward the derivation of taxon weights, we have confined the discussion to brownian motion, but in principle our approach to phylogenetic averaging can be applied to any reversible continuous-time markov process in which the root position may be ignored. for sequence data, or for functions of sequence data , a suitable model of molecular evolution may be preferable to the brownian motion we have described  <cit> . in such an application, because the states of the process are discrete , sample paths will be piecewise constant rather than continuous and integrable as in the case of brownian motion. as a result, sample paths can be summarized by the proportion of time spent in each state, and we can compute the average proportion of time in each state by taking the expectation over all sample paths. in practice, this requires the simulation of many sample paths, from which the average proportion of time in each state can be computed. to clarify this, consider position  <dig> of the gp <dig> alignment . under a stochastic model for proteins such as jtt  <cit> , we can sample evolutionary paths on the phylogeny that are consistent with the alignment  and record the proportion of time spent over all paths in each amino acid. this induces a multinomial distribution on the twenty amino acids that can be used to  define a consensus,  create a profile, or  report average characteristics as in figure  <dig>  whether such an approach will prove fruitful remains to be seen. the efficacy of our scheme with regard to discrete-state evolutionary processes will be the subject of a future study.

