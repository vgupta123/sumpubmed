BACKGROUND
many of earth’s environments are highly dynamic and unpredictable. nevertheless, life has mostly found ways to cope with the continuous and the sporadic changes. at the heart of the ability to survive in a range of environmental conditions are regulatory mechanisms that ensure maintenance of internal homeostasis , which relies on accurate sensing of internal metabolite levels  <cit> . at the other end of the spectrum of environmental variation lie sporadic, potentially drastic changes that challenge the abilities of organisms to adapt . successful lineages have responded to such events with evolutionary adaptations including lineage specific gene expansions and whole genome duplication. interestingly, recent experimental evolution studies have shown that evolutionary adaptation can be a remarkably rapid response  and that surprisingly few mutations are needed to achieve significant fitness gains . it has been suggested that the ability to drastically change the phenotype with few mutations, which we shall refer to as evolvability, is itself an evolved property  . this leads to the question of how the evolution of evolvability and the evolution of regulated phenotypic plasticity interrelate.



although evolutionary adaptation has traditionally been considered a slow process compared to physiological adaptation the results of aforementioned studies suggest that evolutionary adaptation and phenotypic plasticity can be alternative viable strategies when organisms face repeated changes in environmental conditions. under which circumstances would one or the other strategy be more likely to evolve? are there evolutionary paths that lead from one strategy to the other? here we studied the interplay between these two strategies by performing in silico evolutionary experiments using a virtual cell  model  <cit> . this model was previously used to study a generic pattern of rapid genome inflation and gradual streamlining during long term genome evolution  <cit>  as well as adaptive and neutral effects of whole genome duplications following environmental change  <cit> . here, we used wild-type virtual cell strains  that have been pre-evolved for internal homeostasis. homeostasis was evolved by selecting for the maintenance of constant internal concentrations of a resource and an energy carrier when external resource concentrations fluctuate continuously. we then let pre-evolved wt-vcs adapt to periodic environmental changes with different frequencies, while retaining the selection for internal homeostasis.

we find that when the frequency of changes is low, populations evolve higher evolvability provided that they retain their capacity to regulate resource homeostasis. the evolution of evolvability is evident from a decrease in the number of generations that lineages remain in an unfit state, after environmental change, as well as an increase in the frequency of mutations with large positive fitness effects relative to the alternative environment  <cit> . when the frequency of environmental change increases populations in addition evolve a distinct phenotypic plasticity strategy. regulated phenotypic plasticity allows these populations to retain fitness during a drastic change in environmental conditions, without adaptive mutations. however, the evolution of additional gene regulation that is needed for phenotypic plasticity takes place on a much longer time scale than the evolution of evolvability. in parallel with the evolution of distinct strategies to cope with environmental change we identify evolved patterns of genome structuring. in genomes of lineages that evolved high evolvability the number of mutational targets for adaptation increases over time. in addition, a subset of these evolvable lineages evolves a distinct genome structure characterized by genes that remain unregulated, but whose dosage is rapidly tuned to the prevailing environment by duplications, deletions and point mutations.

RESULTS
we employed the virtual cell  model  <cit>   to study the evolution of adaptive strategies to cope with repeated environmental change. vcs exist in populations of fixed size and compete for a chance to produce offspring in the next generation, completely replacing the current population. their fitness depends on the ability to maintain cellular homeostasis. cells have a high fitness if they maintain equilibrium concentrations of the two internal molecule species a and x close to a fixed target during fluctuations in external resource  concentration that range over more than two orders of magnitude. concentrations of a and x arise from the internal cellular dynamics that are given by a system of odes, representing the activities of the proteins in the cell. the activities of catabolic and anabolic enzymes and pumps directly affect concentrations of a and x. transcription factors  influence gene expression when their binding motif matches a binding site in the operator of a gene. tfs can bind either a or x as a ligand, and have a differential regulatory effect on their downstream genes, depending on their ligand binding state. this ability to regulate gene expression depending on ligand binding state is crucial for the cells’ capacity to evolve homeostasis.
fig.  <dig> virtual cell model overview. a virtual cells have a circular genome that encodes metabolic and regulatory proteins. an externally available resource molecule  diffuses passively over the membrane  and is actively imported  by pump proteins. once inside, a is converted to  by catabolic enzymes. x serves as the energy source for the import reaction . in addition, a and x are converted to an unspecified end product  by anabolic enzymes. protein expression from genes  can be regulated by tfs if their binding motif matches the gene’s operator sequence. binding of a ligand  by the tf alters its regulatory effect on gene expression. the genome can contain multiple copies of any of the gene types. different copies may encode different values of the gene’s parameters, such as the enzymatic constants of the reaction that they catalyse or the binding motif and regulatory effect. b fitness is determined by measuring the difference  between the realised steady state concentrations of internal a and x and the homeostasis target value . c during the evolutionary experiments the external concentration of a is continually varying, while the homeostasis target remains constant. cells have a chance proportional to their fitness to contribute offspring to the next generation




all proteins are transcribed from a spatially explicit, circular genome. point mutations affect parameters of individual genes, such as the kinetic constants of enzymes, operator binding sites, and binding motifs and regulatory effect parameters of tfs. large scale mutation events are the duplication, deletion or translocation of stretches of neighbouring genes as well as whole genome duplications . after duplicating, the two identical copies of a gene will diverge due to subsequent, independently accumulating point mutations. we are interested in the genome structure and mutational events on the line of descent  of a lineage . in most of the analysis we focus on the mutational events fixed shortly before and after environmental change.

evolved wild-types rapidly adapt to novel environments
in a previous study we evolved  <dig> vc populations under fluctuating resource conditions  <cit> . from these we selected four wt-vcs that successfully evolved homeostasis regulation in their native environment for continued evolution in the current study. here, we subjected populations to different periodic environmental changes at various change frequencies. the novel environments were constructed by changing passive diffusion rate of the a molecule, degradation rate of proteins and the stoichiometry of conversion from a to x of the catabolic reaction . given that a change in any of these environmental parameters separately already has a significant effect on fitness, the combination of three simultaneously changed parameters represents a drastic change in environmental conditions, posing a significant challenge for cells to readapt. note that the periodic environmental changes are discrete events and are in addition to the continuous fluctuations of the external resource concentration. therefore, populations are constantly selected for homeostasis, while only periodically being exposed to a drastic change in the environmental conditions. simulations were started from an early, intermediate and late evolutionary time point , with respect to the evolution of wild-types for all four wt-vcs. each starting population is cloned to four fold replicates, that hence evolve under identical circumstances but with a different random number seed for mutations. thus, our initial experimental set consists of  <dig> wt-vcs ×  <dig> evolutionary time points ×  <dig> environments ×  <dig> replicates.
per environment the values of the homeostasis targets , passive diffusion rate, catabolic conversion stoichiometry and degradation rate are listed. the native environment was used for all populations in the initial phase of homeostasis evolution. the upper part of the table defines the sensable environments, in which tar a and tar x remain constant. in each evolutionary experiment populations are switched repeatedly between the native and novel environment. for an extended list of simulation parameters see additional file 1: table s1



fig.  <dig> time to readaptation. pre-evolved wt-vcs were subjected to a change to a novel environment  and allowed  <dig> generations  to readapt. the time in generations to reach the high fitness value  was recorded and binned per  <dig> generations.  <dig> wt-vcs ×  <dig> evolutionary time points ×  <dig> replicates yield  <dig> runs for each environment. 83% and 86% of populations in environment  <dig> and  <dig>  respectively, reached high fitness before  <dig> generations. for comparison, the adaptation times of the original wt-vcs are indicated by arrows in the same plot




evolution of evolvability at low frequency environmental change
next, we continued the evolution of the populations by periodically changing between their native environment and a novel environmental condition. previous research has shown that both genome organization  <cit>  and network structure  <cit>  can evolve to accommodate rapid phenotypic switching between two different environmental targets. here, both levels of organization can potentially evolve. in contrast to these previous studies, here, vcs can also sense the effects of environmental change, analogous to the sensing of resource fluctuations used for homeostasis regulations. this gives us the opportunity to study the interplay of the evolution of regulation and evolvability. to do so, we performed evolutionary experiments where wt-vcs adapted to periodically changing environments.

in our first setup we let environments change every  <dig> generations. we find that over the course of  <dig> generations of evolution the majority of replicates  at some point fail to reach a fitness > <dig>  within the  <dig> generation environmental epoch. in other words, these lineages lose the ability to maintain resource homeostasis after environmental change. strikingly, if a population fails to readapt to a change, the success rate on the subsequent change goes down to 55% compared to a 93% success rate if the population previously readapted successfully. the failure to readapt may be a consequence of losing the gene regulatory network  structures that are essential for homeostasis regulation with respect to nutrient fluctuations. as is evident from the much longer time scales for initial evolution , homeostasis regulation is comparatively hard to evolve de novo. therefore, one explanation for the repeated failure to readapt to environmental changes of some lineages would be that these at some point lost the regulatory structures in their grn that functioned to maintain resource homeostasis. it would then take a considerably longer evolutionary time to evolve the lost genetic information anew. this is comparable to the initial phase of evolution, where homeostasis took a long time to evolve . in contrast, lineages that retain the regulatory structures needed for resource homeostasis would have a shorter evolutionary path to becoming adapted to the other environment.

the lineages that fail to readapt could be considered as ‘evolutionary dead-ends’. when we removed them from the analysis and focus on the successfully readapting lineages we find that both the time in generations  and the number of mutations  needed to readapt decrease. clearly, the populations become more evolvable with respect to the periodic environmental change. to better understand how populations were able to adapt more rapidly to environmental change over time we analysed the potential for mutations to reinstate fitness following environmental change. this analysis was applied along the lod as follows: each lod was divided into four equal length time frames and in each time frame individuals from lods in all simulation were combined. for each individual we then recorded the fitness measured in the  alternative environment before and after a single round of mutation, thus assessing the adaptive potential of mutations in the environment that individuals did not experience during their life time. we find that the fraction of large benefit mutations increases over successive evolutionary time frames , explaining why these populations need fewer generations and mutations to adapt later in the experiment. although the fraction of these mutations is low within an individual  there is a large chance that a mutation recovering most of the fitness will arise in the populations within a few generations. thus, the increased evolvability towards periodic change is due to changes in the mutational landscape that becomes biased towards mutants that are fit in the alternative environment.
fig.  <dig> generations and mutations needed for readaptation in successfully adapting lineages. populations under environmental change at  <dig> generation intervals between the native and novel environment. as novel conditions, environments  <dig> and  <dig> defined in table  <dig> were used. the number of generations  and mutations  needed to readapt is plotted at every back and forth change of the environment. the values are averaged over all wt-vcs replicate runs in the respective environment that are not ‘evolutionary dead-ends’. 


fig.  <dig> evolution of mutational landscape towards beneficial mutations. we put individuals in the lod that lived just before a change of environment  in the next environment and let them undergo a single round of mutation. in this alternative environment we measure their fitness before and after the random mutation and define the fitness effect of the mutation as the gain relative to the maximum possible gain ). different colour graphs are for different periods of the evolutionary simulations. for environment  <dig>  and environment  <dig>  measures for all populations and all replicate runs are averaged




another way to infer the effect of genome restructuring on the evolution of evolvability is by looking at the type of mutations that become fixed during readaptation. for lineages that undergo changes to novel environment  <dig> we recorded the set of mutations occurring immediately following an environmental change until they recovered fitness to > <dig> . comparing the first pair of changes to the novel environment and back to the native environment with all subsequent changes we find an increase in the importance of point mutations for fitness recovery . whereas initially only 10% of readaptations exclusively use point mutations, this increases to 50% during subsequent changes. figure 5
b shows for one simulation the evolution of ‘primed sites’ of genes that allow fitness to be recovered with a single mutation. heat map colours indicate for how many distinct parameters  a single mutation to a new value can lead to instant recovery of fitness. in the example, the number of genes as well as the number of target sites per gene is going up during the first part of the simulation. in the grn in fig. 5
c genes are highlighted that contained such primed sites at some point in the evolutionary. it can be seen that enzymes as well as tfs can evolve primed mutational sites. thus, the mutational landscape evolves to connect genotypes encoding the different phenotypes most suited for the different environments.
fig.  <dig> mutational priming in the grn. a fraction of changes where populations in environment  <dig> needed only point mutations to readapt. this was measured by examining mutations found in the lod, from the generation immediately after a change occurred until an individual with fitness > <dig>  was found. the first pair of changes back and forth is compared to all subsequent changes. b at the time points before each  environmental change we plot, for individuals in the lod of a sample evolutionary run, the number of primed sites of all the genes in the genome. we systematically mutate all parameters  of all genes in the genome. if mutating a site can restore fitness to > <dig>  in the alternative environment then this site is a primed site of a gene. a gene can have more than one site  that is primed, as indicated by the colour of the squares. only genes are plotted that have at least one primed site at some point during the evolutionary simulation. genes that come into existence only later, after duplication, or disappear due to deletion, are partly greyed in the plot. c shows the grn at the halfway point of the simulation  where genes with ‘primed sites’ are indicated by yellow outlines. note that at a subsequent evolutionary time point enzyme  <dig> is deleted from the genome and enzyme  <dig> exists only transiently in the genome between change  <dig> and  <dig>  red: tfs, green: catabolic enzymes, blue: anabolic enzymes, purple: pumps. arrows indicate regulation  by tfs. the colour saturation indicates gene essentiality, measured as the relative loss in fitness loss upon knockout  of the gene. note that the colourless gene is in fact a tf with very low essentiality value.




we conclude, firstly, that populations that maintain general regulation of homeostasis are surprisingly evolvable when challenged with novel environmental conditions. secondly, that these populations further increase the speed of adaptation by evolving primed mutational sites, that allows rapid phenotypic switching. and thirdly, that this process is remarkably efficient, given that environments change only once per  <dig> generations.

time scales of evolvability and regulation
general homeostasis regulation in wt-vcs appears to confer high evolvability when populations encounter novel environmental conditions. moreover, evolvability increased further when environments changed only once per  <dig> generation. when changes to the environment are more frequent, it is expected that phenotypic plasticity becomes increasingly advantageous  <cit>  as it avoids the waiting time for beneficial mutations. to study the transition from evolutionary to regulatory adaptation we expanded our analysis to environmental changes at every  <dig>   <dig>   <dig>   <dig> and  <dig> generations. in addition, to increase the scope for the evolution of regulated phenotypic plasticity we study evolution in two simplified environments , where catabolic conversion stoichiometry is the only parameter that changes . for this analysis we restrict the starting population set to two randomly selected wt-vcs, that were propagated from the intermediate evolutionary time point. now that changes are in quicker succession, we retain lineages that fail to adapt to some changes in this part of the analysis.

under higher frequencies of environmental change two adaptive strategies emerge. figure  <dig> illustrates the distinct fitness profiles of these strategies in two simulations. for the lod fitness is determined both in the actual environment that an individual experienced and the alternative environment that it did not see during its life time. the first strategy, which we named an evolver strategy, shows dramatically different fitness values between the experienced and the alternative environment. it follows that every time the environment changes, the lineage has to readapt by evolutionary adaptation. moreover, the evolver strategy emerges nearly instantaneously and is maintained for many changes throughout the simulation. in contrast, a regulator strategy evolves much more slowly, with low levels of fitness in both the actual and the alternative environment and is further characterised by slowly converging levels of fitness in the actual and alternative environment. this convergence is due to phenotypic plasticity of individuals, that adaptively regulate gene expression to match each environment. having observed these clearly distinct adaptive strategies we came up with criteria to classify different simulations as using either of these strategies. lineages were classified evolvers from the moment that they successfully readapted from a drop in fitness < <dig>  to a fitness > <dig>  within  <dig> generations of environmental change, in at least  <dig> out of each  <dig> consecutive changes. they were classified as regulators from the moment that they attained a fitness > <dig>  in both environments at every subsequent generation.
fig.  <dig> regulator and evolver strategies. fitness values over evolutionary time measured in the environment that the lod historically experienced  and the alternative environment . data points are averages over the first  <dig> generations after switching and bins per  <dig> generation intervals




using this classification, fig. 7
a shows the fraction of simulations that evolved one of the strategies for different frequencies of environmental change. when environments change once per  <dig> generations, only the evolver strategy evolves. as expected, regulators become more frequent when environments change more frequently. at intermediate frequencies both strategies evolve and persist. at the highest change frequencies none of the lineages are classified as evolvers. notably, some lineages that are evolvers early in evolution, later transition to the regulator strategy. the evolution of strategies in the opposite direction was, however, never observed. interestingly, evolvers at lower frequencies always have a higher fitness, measured in the first  <dig> generations after a change , than those evolved at higher frequencies . possibly, spending a longer period of time in a single environment allows better fine tuning of homeostasis regulation . alternatively, the frequent population bottlenecks when very few fit mutants contribute offspring to the next generation during the frequent environmental changes could put a strain on the maintenance of genetic information.
fig.  <dig> evolution of adaptive strategies at different ecological time scales. data from simulations in environments  are combined, thus totalling  <dig> wt-vcs ×  <dig> environments ×  <dig> replicates =  <dig> runs per change frequency. the fractions  and time of appearance  of the evolver and regulator strategies in the lod are plotted for evolutionary simulations under different frequencies of environmental change. the first occurrence of a regulator strategy is recorded if the individuals in the lineage maintain a fitness value > <dig>  in both the native and novel environment. the first occurrence of the evolver strategy is recorded if for  <dig> out of  <dig> subsequent changes the fitness first drops below  <dig>  and then rises above  <dig>  within  <dig> generations of environmental change. if an evolver strategy arises that subsequently gives rise to the regulator strategy in the same lineage, this event is additionally marked in b with a red star and a line indicating how long and how  the transition to the regulator strategy proceeds


fig.  <dig> evolutionary fitness and genome dynamics of example lineages in environment  <dig>  all data shown are from a set of five lineages that evolved under conditions changing between the native and novel environment  <dig>  lineages were selected to illustrate distinct evolver and regulator fitness and genome dynamics. two of the lineages evolved under  <dig> generation periodic changes, one at  <dig> generation period and two more under a  <dig> generation period. four out of the five lineages evolved in different simulations from a single wt-vcs. one of the lineages that evolved under  <dig> generation periodic change has the evolver strategy , while the other lineage under the same conditions evolved a regulator strategy . a fitness values over evolutionary time measured in the environment that the lod historically experienced  and the alternative environment . data points are averages over the first  <dig> generations after switching and bins per  <dig> generation intervals. b genome size in the lod. line colours correspond with colour coding in a. in each lod this segment corresponds with  <dig> environmental changes. c the top graphs show the conservation of genes in the final ten environmental changes. bars represent number of genes per gene category and are coloured coded according to time of origin  of genes. only changes in the last ten changes in the simulation are shown, corresponding to  <dig>   <dig> and  <dig> generations, respectively for period  <dig>   <dig> and  <dig> environmental changes. bottom graphs show the essential gene regulatory network at the final time point of the simulation. red: transcription factors, blue: anabolic genes, green: catabolic genes and purple: pumps.  two regulatory modules that do not feed back on each other have been highlighted. this grn structure fulfils the modularity criterion 




we then analysed the relationship between change frequency and the time scales at which either strategy evolved. in fig. 7
b we plotted the time of establishment of either strategy. the evolver strategy can evolve remarkably fast, sometimes establishing immediately at the first environmental change. in a strongly contrasting pattern, regulation invariably takes many changes and generations  to evolve. also, whenever both strategies co-occur at a given frequency, the evolver strategy is established prior to any of the regulators. we conclude that evolvability can be a highly efficient strategy for populations to continually adapt to changing environmental conditions. only when the periodic environmental change occurs with a sufficiently high frequency and over many iterations can populations reach a comparable level of adaptation with regulated phenotypic plasticity.

contingency and robustness of strategies
sometimes biological replicates of a single wt-vcs start population subjected to identical change frequency evolved different strategies . these lineages maintained their respective strategy for over  <dig> generations, showing that the strategies can have comparable success rates at evolutionary time scales and are contingent on their prior evolutionary history. nonetheless, we have seen that the evolution of the two types of adaptive strategy clearly depends on the frequency of environmental change. we wondered how robust each strategy was, once it had evolved, under conditions that would otherwise favour the evolution of the alternative strategy. we selected evolvers that evolved under the  <dig> generation change regime and regulators evolved under the  <dig> generation regime and subjected each to the opposite change frequency, namely  <dig> generation changes for the evolvers and  <dig> generation changes for the regulators. because we suddenly apply an environmental change frequency at the opposite side of our frequencies range, this can be considered a ’severe case’ for testing robustness. interestingly, we found that the evolutionary response to a change in frequency can be twofold. figure  <dig> illustrates that both evolver and regulator populations may react by either evolving the alternative strategy or maintaining their prior strategy. we conclude that both strategies can enable a population to adapt persistently under a wide range of frequencies of environmental change. nevertheless, regulation provides superior fitness when the environment changes rapidly. importantly, even though smooth mutational paths exist between the two strategies for a subset of the evolved solutions, in other cases lineages appear stuck in the strategy that they evolved earlier.
fig.  <dig> robustness and plasticity of evolvers and regulators. example evolutionary simulations of two regulators  that had previously evolved under  <dig> generation periodic changes and were subjected here to  <dig> generation periodic changes and two evolvers  that had previously evolved under  <dig> generation period changes and were subjected here subjected to  <dig> generation periodic changes. continuous and dashed lines are fitness in the actual and alternative environment, respectively, with the difference filled in 




genotypic strategies
so far, we identified different strategies by analysing the phenotypes of ancestors in different environments. now, to get more mechanistic insight into regulators and evolvers we study the structure and evolution of their genome and gene regulatory networks. large fluctuations in genome size occur over the course of evolution . fluctuations are most pronounced during the first half of the evolutionary experiment, while streamlining dominates the second half  <cit> . these dynamics are expected to initially increase mutation rates and variation and subsequently reduce mutational load, when the role of adaptive evolution diminishes  <cit> .

because the large genomes and tangled networks during early evolution pose a problem for in analysing the function of the grn, we apply a pruning step to remove redundant genes. . in the simplified networks we find recurrent evolution of a characteristic grn structure among evolvers . the structure is characterised by a regulated part that controls expression of one or two of the protein types  in the metabolism and an unregulated part in which proteins of the remaining mostly exist in multiple copies. the unregulated, variable part of the genome undergoes regular duplication and deletion to adjust protein dosage on demand, while the core regulated part of the genome is largely conserved .

some of the grns of regulators evolved a remarkable, modular structure, characterized by independent subsets of tfs exclusively regulating a specific enzyme type. to investigate this observation further we tested for the presence of multiple interconnected gene sets , that do not have regulatory feedback to the other modules. moreover, these modules should segregate the regulation of one of the enzyme types from the others. applying these criteria we found that in the full change environments  27% of regulators evolve a modular network structure. intriguingly, in the environments where only the catabolic conversion stoichiometry changes , modularity evolved in 94% of lineages . this suggests that modularity is a highly evolvable feature whose evolution depends on the specific type of environmental change. because the stoichiometry of the reaction from a to x changes in the simplified environments environments it can be beneficial to independently regulate catabolic and anabolic enzymes that control the internal balance between a and x. in conclusion, we find that evolver and regulator strategies are associated with particular grn structures and evolutionary genome dynamics in a significant subset of lineages.

discussion
adaptation to changes in the environments is vital for long term survival of populations. unsurprisingly, species have evolved many molecular mechanisms to regulate their phenotype in order to adapt to environmental changes  <cit> . however, it is increasingly evident that evolutionary adaptation can be a fast and efficient mechanism for populations to adapt to novel circumstances  <cit> . here, we have shown that rapid evolutionary adaptation to novel environmental changes is expected when organisms have previously evolved gene regulatory structures for maintaining homeostasis under external nutrient fluctuations. moreover, when the environment changes periodically, populations evolve an even higher degree of evolvability with respect to the change, requiring few mutations to readapt. remarkably, this effect is already present after a few changes that are  <dig> generations apart.

when environmental change becomes more frequent, the selective advantage of a fully regulatory response to change increases. in line with expectation we found that an increasing fraction of populations evolved regulated phenotypic plasticity towards both environments, when change frequency increased. interestingly, a recent study found that yeast evolved better phenotypic plasticity towards two stressful environments during  <dig> generations of evolution in rapidly alternating  conditions  <cit> . here, by investigating adaptation on a continuum of ecological time scales we could capture the transition between highly effective mutational adaptation and hard to evolve but very stable physiological regulation. remarkably, during the evolution of the latter strategy, lineages would frequently evolve evolvability first. a related phenomenon has been observed in yeast species that initially adapted by transiently duplicating chromosomes or chromosomal segments  <cit> , before evolving fine tuned regulation in a novel environmental condition  <cit>  . while we found that some lineages displayed evolutionary plasticity by transitioning between strategies, other populations robustly maintained their previously evolved strategy in a new environmental change regime that was more favourable to the alternative strategy without losing viability .

evolution of genome structure
in populations that used the evolver strategy we observed a recurring network structure characterised by a highly connected and stable part regulating a subset of the enzyme types , complemented with an unregulated parting containing the remaining enzyme type at variable copy numbers . this structuring may either be selected to enhance adaptability or, alternatively, could neutrally emerge due to long term evolution in periodically changing environments. for example, having a set of unregulated copies of a particular enzyme enables rapid adaptive dosage adjustments by gene duplication and deletion. conversely, this structure may be the result of a ratchet effect due to repeated bottlenecks  <cit> , that gradually breaks up the existing regulatory structures. the operation of a ratchet is supported by the observation that evolvers in rapidly changing environments, that experience more and faster bottlenecks have lower fitness than when change is slow. the resulting structure is more likely to provide a fast and relatively robust mode of readaptation. therefore, we hypothesize that the evolution of a core-variable genome structure is due to the interplay between both mechanisms. finally, a generic genome streamlining pattern  <cit>  that we also observe in our current experiments , combined with the evolution of a sparsely regulated core-variable genome may cause a population to become evolutionarily stuck, as seen for evolvers that maintained their strategy under a change regime that otherwise strongly selected for the regulator strategy .

in contrast to core-variable genome evolution, modularization of grns in regulators appeared significantly environment specific, evidenced by the much higher fraction of modular networks encountered in populations changing to the simplified environments  <dig> and  <dig> compared to the full environments  <dig> and  <dig>  although modular network structures have previously been shown to evolve in environments consisting of modular sub-goals  <cit> , here the underlying process appears qualitatively different, because environments were not constructed as modular sub-goals or presented in a modular way. that is, we modelled environmental changes as a discrete, integral change in environmental parameters. in our case, grns therefore appear to evolve a representation of the modularity inherent in the metabolic task, by segregating the functional sub-networks used for specific metabolic reactions, thereby capturing the structure of their outside environment without for presenting these reactions in a modular fashion .

divergence and evolutionary rates
the diversity of evolved strategies in our simulations could exist under identical environmental conditions, showing that they confer comparable fitness. remarkably, evolver and regulator strategies sometimes evolved from an identical genetic background . once evolved, both the modular genome structures of regulators and core-variable genome structures of evolvers were stably inherited over long evolutionary time frames. yet, the rate of genomic change for the evolver strategy is expected to be much higher than that of the regulator. without any additional knowledge, these differences in evolutionary rates could well be interpreted as the result of differences in external selection pressures on the two closely related populations. this example shows that any hypothetical inferences about environmental conditions experienced by a population are contingent on the adaptive strategy that it employs. put differently, identical environmental conditions can be perceived as stable by one populations, while demanding constant evolutionary adaptation in another.

loss of homeostasis regulation
a significant subset of simulations failed to regain fitness at some point after environmental change. if these populations are allowed to continue evolving, their subsequent adaptability is significantly worse. thus, losing pre-evolved homeostasis regulation decreases the chance to adapt to subsequent environmental changes. having homeostasis regulation for nutrient fluctuations as the general fitness criterion for vcs played an important role in our result of finding high adaptability and evolvability. arguably, homeostasis is a vital survival mechanisms in natural populations. in fact, much of the fast readaptation to novel conditions observed in laboratory conditions exploits pre-existing adaptation mechanisms  <cit> , by mutationally inducing gene over or under-expression. this feature makes our model qualitatively different from most other modelling approaches, that do not consider such a pre-evolved survival mechanism in all environments  <cit> , and uniquely enabled us to observe the interplay between evolvability and regulation.

sensing changes
during the evolution of homeostasis regulation under external resource concentration changes spanning two orders of magnitude, pumps and enzymes become tightly regulated by tfs that can sense internal concentrations of the nutrient  and energy carrier  molecules. the regulatory control mechanisms that evolve for homeostasis maintenance can be exploited during adaptation to certain dimensions of environmental change. for example, vcs show a high degree of preadaptation to changes in passive diffusion and more varying levels of preadaptation to changes in degradation rate . similar results were found during experimental evolution of bacteria  <cit>  and yeast  <cit>  to various environmental stressors, where evolved lines were often fitter or produced more biomass than ancestor and control lines under previously unseen stress conditions.
fig.  <dig> single parameter environmental change. fitness in the current  and alternative environment  measured in the lod. each fitness measure is the average of the first  <dig> generations after an environmental change. a four populations adapting to changes in passive diffusion. passive diffusion is increased like in environment  <dig>  b four populations adapting to changes in degradation. degradation is decreased like in environment 5




living organisms constantly monitor their internal metabolite concentrations via ligand binding and other sensing mechanisms. in this study we focused on environmental changes that cells can perceive directly or indirectly by internal sensing, mirroring the majority of adaptive evolution in the wild. in contrast, most previous computational work on adaptation to environmental changes has either imposed novel fitness targets, without a mechanism to sense the change  <cit>  or employed short-cuts to sensing via an input node in a regulatory network that represents the environmental condition directly  <cit> . although we cannot easily mimic the latter type of sensing, it was possible to impose changes of the fitness criterion that vcs cannot sense. additional experiments with such non-sensable changes in the homeostasis fitness criterion  indicated that adaptation takes much longer, but that evolvability still noticeably improved in most cases . one reason for the longer adaptation times, may be that, by definition, populations cannot evolve phenotypic plasticity to non-sensable changes, because they lack a signal to initiate regulated physiological change. nevertheless, the genotype to phenotype map can still evolve to allow for efficient phenotype switching with little genotypic change  <cit> .

in contrast, here, we observe adaptation to changes on a continuum of ecological time scales. the resource fluctuations that vcs continuously experience during their life time represent the fastest frequency on this scale. the homeostasis regulation that vcs evolve to cope with these fluctuations put them at an advantage when they are challenged with novel other types of environmental change at slower time scales. similarly, for natural populations we expect that general homeostasis mechanisms can be exploited for subsequent adaptation to more drastic environmental perturbations of cellular dynamics.

lastly, it is important to realise that natural populations use several adaptive mechanisms and strategies that were not modelled in vcs. bacterial populations undergo frequent horizontal gene transfer, acquiring environment specific genes that exist in the pan-genome when needed  <cit> . in addition, mutator strains with up to three orders of magnitude higher mutation rates arise frequently under conditions where adaptive exploration of the mutation landscape is beneficial  <cit> . perhaps most intriguingly, the budding yeast has recently been found to posses a regulatory pathway that induces directed mutations under specific environmental circumstances  <cit> . the last example clearly indicates that regulation and mutation are far from strictly separate adaptive strategies. rather, the need for robustness and evolvability synergistically shape the genotype and phenotype of a lineage, as information about the changing environment is integrated over long evolutionary time scales  <cit> . notwithstanding the additional strategies that species may employ to cope with a changing environment, we believe the current study provides useful insights into antagonistic and synergistic evolutionary patterns when allowing phenotypic plasticity and evolvability to evolve simultaneously. moreover, the, to our knowledge, unique requirement in our model to maintain homeostasis, an ubiquitous regulatory mechanism in biology, while adapting to environmental change, adds to the relevance of our findings for understanding adaptation in real populations.

CONCLUSIONS
when challenged with novel environmental conditions, populations can show remarkably fast recovery, by exploiting previously evolved homeostasis regulation. in addition, when the environment changes periodically populations evolve a highly efficient evolver strategy, by increasing the number of genotypic targets for beneficial mutations. as the frequency of changes increases, the evolver strategy gives way to evolution of regulators, albeit at much longer evolutionary time scales. remarkably, both types show evolutionary plasticity with respect to transitioning to the other strategy. at the same time we found cases of evolver as well as regulator lineages that robustly retained their respective strategy under change frequencies that would otherwise promote evolution of the alternative strategy. moreover, both strategies could evolve under identical conditions and genetic background, demonstrating high contingency of the evolutionary trajectories. we conclude that organisms can exploit regulatory mechanisms evolved for fast homeostasis regulation when adapting to periodic environmental changes. as a result, adaptation by mutations can compete successfully with regulation over a continuum of ecological time scales. regulation only evolves when environmental changes are very frequent and continue over long evolutionary time scales.

