BACKGROUND
as new sequencing technologies develop, thousands of eukaryotic genomes across all kingdoms of life will be sequenced during the next decade  <cit> , and this trend will spark an improvement in our knowledge of evolutionary biology and functional genomics. genome annotation is a stepping stone to bridge the gap between genomic sequences and the biology of organisms  <cit> . it can be stated that the quality of genome annotations represents the value of genome sequences.

gene prediction, within the process of genome annotation, is a complex endeavor. in eukaryotic species, it is usually carried out by integrating multiple sources of evidence  <cit> , such as complementary dna , proteins in closely related species, and de novo predictions  <cit> . representing the integral sequences of messenger rnas , full-length cdnas  are recognized as the gold-standards for discovering and annotating gene structures in eukaryotic genomes  <cit> . additionally, even incomplete cdnas, i.e. expressed sequence tags , provide more accurate evidence than other sources. nevertheless, until recently, the sequencing of cdna was a laborious and capital-intensive task.

thanks to the massively parallel cdna sequencing  technologies  <cit> , scientists can obtain cdna fragments from transcriptomes with reasonably complete coverage in a reduced time scale and at a lower cost  <cit> . with its informative content, rna-seq is expected to revolutionize the prediction of genes  <cit> . rna-seq has been used to improve the genome annotations, including:  correcting predicted gene structures  <cit> ;  detecting new alternative splicing isoforms  <cit> ; and  discovering new genes and new transcripts  <cit> . however, most of these applications focused on species with well-annotated genomes, such as human, mouse, yeast, arabidopsis thaliana, and rice. among these studies, trapnell, williams and pertea et al. and guttman, garver and levin et al. correctly reconstructed full-length transcripts for most known expressed genes in specific mouse tissues  <cit> ; nevertheless, their procedures still need to be tested in other eukaryotic genomes, because of varied genome characteristics  <cit> . for less-studied genomes, denoeud, aury and da silva et al. used the short rna-seq reads to build thousands of gene models for the grape genome  <cit> ; however, fewer genes were predicted than in the public annotation  <cit> .

although far from perfect, the considerable potential demonstrated in these studies for the applicability of rna-seq in gene predictions encourages us to update the original gene prediction of the cucumber genome , which was annotated and published in  <dig>  <cit> . therefore, based on evidencemodeler   <cit> , we built a genome annotation pipeline in which we incorporated analyses of solexa/illumina rna-seq reads. in an attempt to provide a high-quality gene set for the scientific community and for further study, we reassembled and reannotated the cucumber genome. we subsequently compared the two versions of the gene predictions to evaluate any improvements brought about by rna-seq. the comparison presented here supports the hypothesis that rna-seq has a positive impact on gene prediction of the cucumber genome.

RESULTS
genome reassembly
using the improved soapdenovo program  <cit>  , we reassembled the cucumber genome by integrating additional large insert paired-end illumina ga reads from cucumis sativus var. sativus  and from cucumis. sativus var. hardwickii . the final assembly  spans  <dig> mb and contains  <dig>   <dig> scaffolds . this is approximately  <dig> mb less than the previous assembly  and this difference mostly represents redundant repetitive sequences and contaminating sequences. the n <dig> and n <dig> contig sizes of assemver  <dig>  are  <dig>  kb and  <dig>  kb, respectively, and 90% of the assembly falls into  <dig> scaffolds larger than  <dig> kb. compared to assemver  <dig> , assemver  <dig>  is more contiguous, thus facilitating genome annotation.

reconstructing transcripts from rna-seq by de novo assembly and 'align-then-assemble' approaches
we obtained about  <dig> million solexa/illumina rna-seq reads from poly rnas extracted from  <dig> cucumber tissues .

two different approaches, de novo assembly and 'align-then-assemble'  <cit> , were used to reconstruct transcripts from these rna-seq reads. the de novo assembly was carried out by inchworm, a de novo assembler of rna-seq in trinity  <cit> , which reconstructed  <dig>   <dig> de novo contigs from the  <dig> tissues . we applied cd-hit  <cit>  to remove some de novo contigs, such as assembled artifacts with low-coverage or redundancies from different tissues. finally,  <dig>   <dig> de novo contigs assembled by rna-seq reads remained for gene prediction. in the 'align-then-assemble' approach, we mapped and generated spliced alignments of the rna-seq reads from each tissue to the reassembled cucumber genome using bowtie  <cit>  and tophat  <cit>  . cufflinks  <cit>  was then used to reconstruct  <dig>   <dig> transcripts belonging to  <dig>   <dig> transcriptional units from the alignments of  <dig> tissues. however, a complete open reading frame  could be found in only  <dig>   <dig>  transcripts reconstructed by cufflinks using getorf in emboss  <cit> .

reannotation of the cucumber genome
the reassembled cucumber genome  contains  <dig>   <dig> protein-coding genes with  <dig>   <dig> transcripts ,  <dig> trnas,  <dig> rrna,  <dig> snrnas,  <dig> snornas,  <dig>   <dig> mirnas  and  <dig>   <dig> transposable elements . this version of the annotation is labeled as annotver  <dig>  .

compared with the published annotation of the cucumber genome , annotver  <dig>  contains  <dig>   <dig> fewer protein-coding genes, mostly because of the reduced size of the reassembly and the removal of some contaminating bacterial segments implied by about  <dig>   <dig> bacterial genes in annotver  <dig> . consistent with the reduction of gene number in annotver  <dig> , there is an increase in the number of multi-exon genes, which indicates an improvement of the protein-coding prediction to some extent, because the prediction of single-exon genes is still unreliable in eukaryotic genomes.

two other improvements resulting from the incorporation of rna-seq are the prediction of untranslated regions  and alternative splicing isoforms. of the  <dig>   <dig> protein-coding genes in annotver  <dig> ,  <dig>   <dig> genes have utrs and  <dig>   <dig> genes appear to have alternative splicing isoforms. in general, incorporating rna-seq reads offers overwhelming evidence for the prediction of these two features. the prediction of utrs was uncertain before the appearance of rna-seq, because of the incompleteness of ests and the difficulty of collecting bona fide fl-cdnas. furthermore, because they are not well conserved across species, comparative predictive techniques are not suited to utr detection. however, the use of high-throughput rna-seq from the same species naturally removes both of these difficulties. similarly, rna-seq provides evidence pointing to the potential for alternative splicing, though it is still quite difficult to determine full-length isoforms from these short reads. with the help of de novo assemblies and pasa assemblies  <cit> ,  <dig>   <dig> full-length isoforms of  <dig>   <dig> genes were identified. rna-seq provides an opportunity to comprehensively study alternative splicing events in cucumber, as in other species.

evidence support for multi-exon genes
for the  <dig>   <dig> multi-exon genes in annotver  <dig> , we inspected different sources of evidence for them, and the results suggested that most of the multi-exon genes were supported by reliable evidence, such as transcript evidence or protein evidence  <cit> . in fact, there are three sources of evidence in our pipeline: transcript evidence from rna-seq or ests, proteins from related species, and predictions from de novo predictors , which actually provided introns in the final gene structures  <cit> . we did not include the predictions of augustus  <cit>  and geneid  <cit>  in this analysis because the two predictors had used rna-seq information and homologous proteins, respectively.

our analysis shows that most of the multi-exon genes are supported by reliable evidence, such as transcripts or proteins. in figure  <dig> a,  <dig>   <dig>  multi-exon genes are supported either by transcript evidence or protein evidence, while  <dig>   <dig>  genes are supported by all three kinds of evidence. to check which evidence has a more positive effect on the gene prediction, we traced the sources of evidence for full-length supported genes, because full-length-supports, for single gene prediction, ensure the accuracy of the gene structural prediction. herein, a gene that is supported by one type of evidence is termed as full-length supported gene if all of the gene's introns are fully supported by the evidence. as expected, transcript evidence from rna-seq or ests supported more full-length genes than the other two kinds of evidence for multi-exon genes in annotver  <dig>  . in fact,  <dig>   <dig>  multi-exon genes are full-length supported genes when supported by transcript evidence, while  <dig>   <dig>  genes and  <dig>   <dig>  genes are fully supported by de novo predictions and protein evidence, respectively.

de novo predictions are also necessary for gene predictions. although rna-seq has a high coverage, de novo predictions actually support more multi-exon genes than do transcripts , because of the large number of genes generated by the three de novo predictors, for example, genemark.hmm-es predicted more than  <dig>   <dig> genes. furthermore, about one tenth of the multi-exon genes  are supported only by de novo predictions, which indicates that de novo predictions are indispensable to the completeness of the final gene sets.

as transcript evidence plays a considerable role in the multi-exon gene prediction, we examined the contributions of rna-seq to the final gene set, especially when compared with ests. figure  <dig> c shows that most of the ests are covered by rna-seq and none of the multi-exon genes are supported only by ests. despite the fact that one gene in figure  <dig> d is full-length supported by one est, we maintain that rna-seq could replace ests in the process of protein-coding gene prediction.

evidential support for multi-exon genes suggests that rna-seq has an innate capability for high coverage in protein-coding gene predictions. transcript evidence is taken as the most valuable evidence in protein-coding gene prediction, as it often identifies exact intronic boundaries  <cit> . rna-seq, among all the transcript evidence that affects gene prediction, is the one that could increase the number of genes supported by transcript evidence and improve the structural predictions. rna-seq could also be used in place of ests as the major transcript evidence, which liberates scientists from time-consuming work in traditional cdna sequencing projects. although rna-seq still could not replace the role of fl-cdna in gene discovery, sophisticated methods of transcript reconstruction through rna-seq in the near future may help us to reconstruct more full-length transcripts.

improvements of protein-coding gene prediction
the prediction of protein-coding genes has many different features in annotver  <dig> , such as longer transcripts and coding sequences , more and longer exons, and more and shorter introns . to analyze the gene structural differences between annotver  <dig>  and annotver  <dig> , we mapped the cdss of annotver  <dig>  to the genome, assemver  <dig> , by spaln  <cit> . of  <dig>   <dig> cdss having a hit,  <dig>   <dig> cdss matched complete gene structures with start and stop codons. some of the  <dig>   <dig> cdss mapped to the same gene loci in assemver  <dig> , indicating that some redundancies in the original assembly have been removed in assemver  <dig>  . the comparison of gene predictions is illustrated in figure  <dig>  in which  <dig>   <dig> genes in annotver  <dig>  fall into  <dig>   <dig> gene loci in annotver  <dig> . the structures of  <dig>   <dig> genes in annotver  <dig>  are consistent with the structures of  <dig>   <dig> genes in annotver  <dig> . the different number of consistent gene structure in the two versions results from mapping of two or more genes at one locus, as mentioned above. figure  <dig> also illustrates  <dig>   <dig> genes in annotver  <dig>  and  <dig>   <dig> genes in annotver  <dig>  that are located in different loci in the reassembled cucumber genome. to further compare the difference of the two gene sets, we performed four analyses, which all suggest that annotver  <dig>  is better than annotver  <dig> .

the first analysis concerned merged or split gene structures, which map to the same locus but with different gene numbers in the two versions . we found that  <dig>   <dig> genes in annotver  <dig>  merged into  <dig> genes in annotver  <dig> , and  <dig> genes in annotver  <dig>  split into  <dig>   <dig> genes in annotver  <dig> . to discriminate between true and false positive merged/split events, we searched each group of genes in one locus against uniprot plant proteins using blastp  <cit> . each group of genes has one merged gene in one version and several split genes in the other. the number and consistency of hits for the split members decided whether a merged/split event is optimal . figure  <dig> a illustrates that the number of optimal merged/split events in annotver  <dig>  is greater than in annotver  <dig> .

the second analysis focused on genes at the same locus but with different structures . there are  <dig>   <dig> pairs of genes, each of which was composed of an annotver  <dig>  and annotver  <dig>  gene that only map to each other, but are structurally different. we then launched a pfam domain search by interproscan  <cit>  and performed the global pairwise alignments by stretcher in emboss  <cit>  on each pair . the search of interproscan found  <dig>   <dig> different kinds of pfam domains in  <dig>   <dig>  genes in annotver  <dig> , whereas,  <dig>   <dig> different pfam domains were found in  <dig>   <dig>  genes in annotver  <dig> . in the same way, when identity, similarity, score, and gaps in alignments are compared, global pairwise alignments also suggests that genes in annotver  <dig>  are more optimal than genes in annotver  <dig>  .

in the third analysis, the presence of non-overlapped locus protein-coding genes implies specific genes in different predicted gene sets. to measure the reliability of version specific genes in the two sets, we compared the percentages of blastp hits to uniprot plant proteins and multi-exon genes between annotver  <dig>  and annotver  <dig> . the blastp results indicated that the prediction of annotver  <dig>  produces more genes and a higher percentage of hits  to uniprot than annotver  <dig>  . meanwhile, the specific genes in annotver  <dig>  contain a significantly higher percentage of multi-exon transcripts  than those in annotver  <dig>  .

finally, a small dataset of  <dig> wrky genes and  <dig> wrky gene assemblies generated in an experimental study  <cit>  gave us an opportunity to directly compare the accuracy of the two gene predictions. we aligned the  <dig> wrky genes and  <dig> assemblies to the newly assembled genome of cucumber using spaln  <cit>  and mapped out  <dig> loci, where wrky <dig> and wrky <dig> aligned to the same locus due to the change in assembly. the prediction in annotver  <dig>  missed  <dig> loci of wrky genes and predicted only  <dig> wrky genes with the same structures as the experimental data. by contrast, annotver  <dig>  only missed  <dig> wrky gene and  <dig> of them had structures consistent with the experimental data. even though five wrky gene structures in annotver  <dig>  are different from the experimental data, one of them, which is supported by protein evidence, shows a better structure than the experimental data . in this example, the experimental data is consistent with annotver  <dig> , but the transcripts reconstructed by rna-seq, ests and homologous proteins all indicate an extra exon at the 5' end, whereas a single-exon gene is predicted by annotver  <dig> . although the first exon boundary is different in the two isoforms, they are supported either by genewise or transcript evidence. thus in this case, two genes in annotver  <dig>  are merged into one gene with two isoforms when predicted in annotver  <dig> .

in all four analyses, annotver  <dig>  shows a better performance than annotver  <dig> . although the processes of generation of the two gene sets are different , they are comparable, because the principles of evidence combination are nearly the same. in fact, annotver  <dig>  used less protein evidence and homolog est evidence than did annotver  <dig>   <cit> ; however, using rna-seq compensates for this minor deficiency and actually obtains a better gene set. thus, adopting the rna-seq technique proved to be vital to the quality of protein-coding gene prediction in the reassembled cucumber genome.

CONCLUSIONS
a genome project requires continual refinement, even after the publication of its genome sequence. some problems, such as bacterial dna contamination during genome sequencing and redundancy of repetitive dna sequences, were found in the first assembly of the cucumber genome; therefore, we reassembled the cucumber genome. after rna-seq evidence of transcription was generated, we improved the prediction of protein-coding genes in the reassembled cucumber genome, based upon the rna-seq reads. in the new assembly, about  <dig>   <dig> protein-coding gene structures are modified and about  <dig>   <dig> genes are newly predicted. based upon the comparison of the gene sets of the two versions, we conclude that the considerable improvement in protein-coding gene prediction is largely due to the use of the rna-seq technique. we also suggest that, for newly sequenced or less-studied eukaryotic genomes, rna-seq is a good choice for providing evidence for prediction of protein-coding genes, as it reduces the necessity for est sequencing and increases the utility of each round of genome annotation.

