BACKGROUND
for over fifteen years, drug resistance has been a primary challenge in the effective treatment of hiv, and our understanding of resistance mechanisms has evolved along with the virus itself as new therapies have emerged <cit> . thanks to worldwide efforts to tackle hiv drug resistance, many successful treatment regimens have been developed, including combination therapies <cit>  such as the highly active anti-retroviral therapy  regimens <cit> , but treatment options have been uncertain for patients who fail these regimens due to the accumulation of drug-resistant mutations <cit> . more recently, in addition to targeting molecules other than hiv- <dig> reverse transcriptase  and protease, second-generation rt and protease inhibitors  have been developed such that they remain potent against variants resistant to first-generation inhibitors. specifically, tipranavir <cit>  and darunavir <cit> , the two pis most recently approved for clinical use, have been shown to be potent against viruses harboring multidrug resistance mutations such as v82a and l90m, in the cases of both tipranavir and darunavir <cit> , and v82t or i84v in the case of darunavir <cit> . however, even these drugs have been shown to lose potency in the presence of certain mutations or mutation patterns <cit> . in fact, the existence of hiv- <dig> variants showing resistance to all clinically-approved inhibitors highlights the issue of cross resistance, or the existence of mutation patterns arising from a certain therapeutic regimen that simultaneously cause resistance to other drugs as well. cross resistance among hiv- <dig> pis has been studied <cit>  and reviewed <cit>  extensively for over a decade, with several key mutation patterns thought to confer cross resistance to the vast majority of pis. consequently, one strategy is to take advantage of the lack of cross resistance when a mutation confers resistance to one pi but maintains susceptibility to other pis. for example, d30n and i50l are associated with resistance specifically to either nelfinavir and atazanavir, respectively, but such mutations do not greatly reduce susceptibility  to other pis <cit> . sequential or simultaneous administration of regimens that are each potent against variants toward which the other fails may be a potential strategy to prevent drug resistance and treatment failure <cit> . in light of the combinatorial number of both potential treatment regimens and potential mutation patterns, it is becoming increasingly important to understand both the major mutation patterns conferring resistance on the genotypic level as well as the major phenotypic patterns of cross resistance - or lack thereof - of these mutation patterns toward the nine clinically-approved pis.

computational analyses have played a key role in increasing our understanding of the genotypic and phenotypic patterns of hiv drug resistance and our ability to predict drug response phenotype from genotype <cit> . the large amount of publicly available data has greatly facilitated these analyses <cit> . several computational studies have analyzed new or existing data to identify mutations associated with one or more pi or rt drugs <cit> . some studies have presented longitudinal mutagenetic tree or mutation pathway models for the temporal appearances and contingencies of such mutations <cit> . others have uncovered pairs or clusters of correlated mutations associated with pi or rt therapy through direct enumeration, statistical or information-theory based methods, clustering, or a combination of techniques <cit> . one particularly successful application of computational analysis is the accurate prediction of drug resistance  - often measured as a fold-change in ic <dig> of a drug toward the mutant vs. wild-type - of a target variant given its amino acid sequence . many approaches have been used to create prediction models, including regression-based methods <cit> , decision trees <cit> , and other machine learning methods, including artificial neural networks, support vector machines, and others <cit> . several studies have also comparatively evaluated or combined methods to improve accuracy <cit> . models have also been created for predicting drug resistance phenotype <cit>  and virological success or failure <cit>  resulting from combination therapies. in addition to these data-driven approaches, structure-based approaches for predicting drug response have also been developed, often in conjunction with the bioinformatics-based approaches <cit> . taken together, the large collection of available predictive methods still require interpretation and comparison when making patient treatment decisions <cit> , but overall they have been valuable tools both for practical decision-making and for increasing scientific understanding.

the many computational studies of hiv genotype-phenotype data therefore demonstrate the power of uncovering patterns in data, with each study providing a valuable perspective on important features of hiv drug resistance. however, the vast majority of studies have offered a perspective at the genotypic level first - that is, they look for patterns on the genotypic level that correlate with phenotypic responses, usually to one drug or drug regimen at a time, in turn. to our knowledge, a rigorous cluster-based analysis of genotype-phenotype data that first uncovers patterns within the complete phenotypic space and then determines representative genotypes giving rise to the multidrug response phenotypes has yet to be done. the goal of this study is therefore to provide this unique, simultaneous view into the existing phenotypic patterns amongst all the hiv- <dig> pis, as such a perspective can provide novel insights into the major combinations of pis for which cross resistance can occur.

in this work, we analyze phenotypic drug resistance patterns by considering experimental resistance data of  <dig> clinical isolates of hiv- <dig> protease measured against the nine clinically-approved hiv- <dig> protease inhibitors. to determine phenotypic drug resistance patterns toward all nine drugs, a constrained k-medoids clustering method implemented via integer programming was employed. clusters were validated by quantifying their ability to predict a sequence's level of resistance toward one drug knowing the sequence's level of resistance toward other drugs. the selection of representative genotypic sequences from each cluster indicated mutations associated with common patterns of phenotypic resistance and can serve as a "panel" of mutants that collectively represent clinically important variants. furthermore, our direct analysis of phenotypic space allowed us to determine that the virus often utilizes multiple genotypes to achieve similar phenotypic patterns of multidrug resistance. we also show that certain drugs show highly correlated antiviral activities, while other drugs - especially tipranavir - have unique responses. finally, information theoretic approaches were employed to determine amino acid positions and identities within hiv- <dig> protease that are most informative for selection into a phenotypic cluster. taken together, this work provides a simplified framework for understanding major drug resistance patterns toward clinically-approved hiv protease inhibitors and the mutation patterns that best characterize them.

methods
data set
we analyzed  <dig> hiv- <dig> isolates in the hiv drug resistance database <cit>   for which cell-based in vitro pi susceptibility testing had been performed by the phenosense  assay <cit> . susceptibility was quantified by the monogram-measured fold-change <cit> , defined as the ratio of the 50% inhibitory concentration  of the isolate to the ic <dig> of a wild-type control. only those isolates for which susceptibility had been tested against all nine clinically-approved inhibitors were included. the nine inhibitors considered were amprenavir , atazanavir , indinavir , lopinavir , nelfinavir , ritonavir , saquinavir , tipranavir , and darunavir . the data set size was limited by the availability of isolates tested for drv susceptibility. many clinical isolates contained mixtures at one or more amino acid positions. due to the limited data, mixtures were not excluded from the data set. in this work, we will refer to clinical isolates as "sequences," though we recognize that some contain mixtures at certain positions.

to estimate the degree to which mutation frequencies in the genotype/phenotype  data set are representative of true population frequencies, the frequencies of non-polymorphic treatment-selected mutations within non-wt sequences were compared between a larger genotype-only data set of  <dig>  sequences <cit>  and the data set used here. reasonable correlation  was found between the data sets .

fold-change values were log-scaled such that for a given drug, a constant factor of fold-change is represented by a constant numerical difference. because the relationship between fold-change and clinical response is different for each drug, scaled values were standardized so that they represent predicted clinical responses, the phenotype of interest in this work. to do this, the logarithm base used for the log scaling of each drug was set to either the monogram biological cutoff, the geometric mean of the monogram lower and upper clinical cutoffs, or the single clinical cutoff provided, depending on which type of cutoff was available for a particular drug . monogram biological cutoffs are defined as the fold-change values below which 99% of the wt sequences reside, and therefore fold-changes above this value likely have decreased susceptibility. monogram lower and upper clinical cutoffs are fold-change values at which reduced clinical response and unlikely clinical response occur for a given drug, respectively. ritonavir-boosted cutoff values were used when available. after log-scaling, scaled resistance values of  <dig> and  <dig> qualitatively signify decreased susceptibility and susceptibility equal to wt, respectively, for all drugs. to equalize the range of variation in the scaled resistances for each drug and to confine variation to a clinically meaningful range, we capped the maximal and minimal scaled resistances of all drugs to the least extreme value of these among the nine inhibitors -- those of drv . the upper cap of the scaled values  corresponded to a raw fold-change value for drv of  <dig>  the upper-limit value used when the fold-change toward drv was greater than the upper limit of the assay. sequences with scaled resistances equal to the capped values are therefore considered either highly resistant  or potentially hypersusceptible . an interpretation of scaled resistance values is in table  <dig> 

the bases used for log scaling each drug were informed by monogram biological and clinical cutoffs as described in the text. unstarred bases are equal to the available monogram biological cutoffs; singly-starred bases were calculated as the geometric mean of lower and upper clinical cutoffs. double-starred bases are equal to the single available monogram clinical cutoff. for all drugs, scaled values were capped to the least extreme minima and maxima . maxima in the table were generally used when assay upper limits had been reached, representing that the actual fold resistance was higher than the assay could accurately determine. the maximum measurable fold-change can vary for a given drug between isolates, but due to the cap being well below their ranges of maximum fold-change values, our results are entirely unaffected by variation for most drugs; the upper fold-change limits for drv and lpv may have at times been slightly lower than the upper cap used here, but as a check for robustness, preliminary results were generated with varying upper caps and were qualitatively similar to those shown here.

clustering
sequences were clustered based on their drug-resistance phenotypes, quantified by scaled resistance values. a globally-optimal constrained k-medoids clustering approach was implemented via a linear integer program similar to other variations of integer and mixed-programming-based k-means and k-medoids clustering formulations <cit> . the k-medoids approach was chosen after exploration of multiple clustering methods , as it was deterministic, provably optimal, and allowed for the easy implementation of hard constraints, which we felt were crucial here for generating clusters that were phenotypically similar across all drugs.

the clustering method was as follows: first, each sequence was assigned a point in a 9-dimensional space whose coordinates are the scaled resistances toward the nine inhibitors. from these points, a distance matrix was generated, in which element dij is the euclidean 2-norm distance between the ith and jth sequences. the goal was to select k cluster centers  from within the data set and assign each point in the data set to one of these k medoids such that the sum of the distances from points to their assigned medoids was minimized.

constraints were placed on this optimization to guarantee phenotypic similarity within a cluster, as the goal of this work is for the clusters to represent major phenotypic patterns. first, a hard constraint was set to bound the distance between any cluster member and its medoid to be less than or equal to a specified value, c. secondly, a hard constraint was set to cap the maximum infinity norm of the distance between any cluster member and its medoid to a specified value, c∞. such a constraint prohibits grouping together two sequences that are highly similar toward  <dig> drugs but differ qualitatively in their level of resistance toward only one drug - an undesirable outcome if we wish for our clusters to highlight major cross resistance patterns.

k, the number of clusters, is determined by feasibility; it is the minimum value of clusters for which the constraints are satisfied. in this work we use c =  <dig>  and c∞ =  <dig> ; the value of c =  <dig>  occurs roughly at the "elbow" <cit>  or "kink" <cit>  of a plot of the minimum k needed as a function of tightness  , suggesting that it allows a reasonable balance between maintaining both a low number of clusters and adequately tight clusters. a c∞ of  <dig>  guarantees that a given cluster members' scaled resistances toward any given drug cannot vary by more than  <dig> c∞ =  <dig> ; there will not be a pair of cluster members in which one sequence shows no resistance to a given drug while another shows high levels of resistance . higher values of c∞ would make clusters too diffuse along individual dimensions, preventing their interpretation as clinically-relevant phenotypic patterns. lower values were found to be too restrictive and generated additional clusters with redundant patterns . to check for robustness of clustering as a function of these parameters, c and c∞ were each varied in turn up to +/- <dig>  units in increments of  <dig> . qualitative phenotypic patterns remained very similar, and pairs of sequences that were clustered together in the original clustering remained together an average of 71% as these parameters were varied.

figure s <dig>  is a plot of the number of clusters  vs. data set size, using random subsets of the data. as our data set is currently not large enough to show robust convergence , the quantitative results that are affected by data set size are to be considered preliminary; more data could allow for more robust convergence in future studies and would increase confidence in the quantitative conclusions.

the integer programming formulation used is shown in supplementary methods . all integer programs in this work were implemented using the gams interface  and were solved using cplex  <dig> . <dig> .

validation
the clustering was validated by its effectiveness  in predicting the level of drug resistance of a sequence to one drug based on the sequence's levels of drug resistance toward other drugs, using the following n-fold cross-validation procedure <cit> :

remove each sequence  from the data set - label it sequence "a."

cluster the remaining sequences using the above method.

choose one of the nine drugs and eliminate its phenotypic data for sequence "a".

assign sequence "a" to the cluster to whose centroid it is closest, based on 8-dimensional distance 

predict the level of drug resistance of sequence a toward the eliminated drug to equal the cluster centroid's scaled resistance value for the eliminated drug. based on this value, classify sequence a with a resistance score from 0- <dig> .

for each drug, the total rms error and the percent correctly classified after leaving out each sequence in turn was compared to two controls:

control  <dig> : to predict the resistance of a sequence toward a drug, randomly choose a value from the distribution of scaled resistances in the data set toward the particular drug, and classify it using the corresponding resistance score. this control assumes that the level of resistances between drugs is not correlated.

control  <dig> : to predict the resistance of a sequence toward a given drug, simply use the mean of the levels of sequence "a's" scaled resistances to the other eight drugs, and classify with the corresponding resistance score. this control assumes that resistances toward the nine drugs are highly correlated.

genotypic analyses
in the absence of amino acid mixtures at positions within isolates, the genotypic distance between any two sequences was defined simply as the number of positions at which their amino acid sequence differed. for some analyses, all  <dig> protease positions were considered. to reduce noise due to polymorphic positions in certain analyses, only  <dig> positions that have been associated with resistance or drug treatment by previous statistical learning or analysis methods  <cit>  were considered, unless otherwise noted:  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>  and  <dig>  we note that there may be unavoidable arbitrariness in the selection of such a set without considerable initial genotypic-phenotypic analysis , and in the course of our research we tried multiple sets, allowing us to check for robustness.

to account for mixtures in isolates, the contribution toward the genotypic difference between two sequences due to a position, dm, was defined in the general case as follows:  

where "c" is the number of amino acids that the isolates have in common at that position, and max is the number of amino acids in the mixture with the greater number of amino acids at that position. as an example, if one isolate contained a mixture of leucine and methionine at a position and another contained only leucine, then dm for this position would be ) = 1/ <dig> 

intracluster genotypic or phenotypic variability was estimated as the average of all the pairwise genotypic or phenotypic distances. a bootstrapping procedure was used to generate p-values to assess statistical significance of either distance for selected clusters. random clusters of a size equal to the considered cluster were selected with replacement from the unclustered data, and the distance metrics were calculated. this procedure was repeated  <dig>  times to generate distributions for both genotype and phenotype distances, from which p-values were calculated. bootstrap studentized statistics were obtained by dividing the difference between a value and the bootstrapped distribution mean by the standard deviation of the distribution.

from each cluster, representative sequences were selected. for genotypically diverse clusters, we wished to select multiple representative sequences from each cluster to highlight genotypic diversity. to that end, constrained k-medoids optimizations were run on each cluster using integer programming; the resulting medoids became the representative sequences. for each phenotypic cluster, the minimum value of k was determined such that all sequences within the cluster would be within a genotypic distance of ti of at least one medoid. we used a value of ti =  <dig> when possible, as it produced one representative sequence for all but the most diverse clusters , allowing for easy interpretability. additionally, at this k, the sum of the distances between each sequence and its assigned medoid was minimized. sequences containing mixtures at any of the  <dig> positions listed above were excluded from being representative, as were sequences with any of the  <dig> amino acid positions undefined . with this constraint, it becomes possible for phenotypic clusters  not to generate any representative sequences with ti =  <dig>  to account for this, ti was increased to  <dig> for clusters  <dig> and  <dig> and  <dig>  for cluster  <dig>  the integer-programming formulation used here is shown in supplementary methods .

sets of sequence positions or amino acid residue identities most informative of overall cluster assignment or membership in an individual cluster were identified according to an incremental mutual information -based method described previously  <cit> . briefly, the method approximates high-order joint entropies to determine an optimal small subset of features  that collectively have the highest mutual information  with a given output . these approximated mi values have also been shown to correlate with classification error and with exact mi values in analytically solvable systems. first, the mi between variables of interest was computed, using the frequencies to estimate probabilities. for each mi, the bias in the value was estimated by computing the mi of the pair after randomizing the ordering of the sequence data for each variable  <dig> times. variables whose mi with the outputs exceeded their maximum shuffled mi were considered statistically significant and included in subsequent steps; remaining positions were omitted. sequence positions or binary mutation variables were then selected incrementally to maximize the joint-mi  between the set of all chosen variables and either the cluster assignment or membership in a specific cluster. mixtures were not included in the distributions. features were added incrementally until all positions or mutations were included, yielding a full ranking.

miscellaneous
data scaling and other matrix manipulations, including principal component analysis, were done using matlab 2010a and 2011a . matlab and microsoft excel  using vba were used for figure generation.

RESULTS
cluster analysis reveals specific phenotypic resistance patterns among clinical isolates
globally-optimal k-medoids clustering was used to find groups of sequences with similar multidrug phenotypes, using the tightness constraints c and c∞ mentioned in the methods to enforce thresholds of phenotypic similarity. the clustering yielded  <dig> multi-membered clusters, along with  <dig> outliers. figure  <dig> shows the resulting clusters; each cluster is represented as a row, with each of the colored boxes within the row representing the resistance score  toward the corresponding drug of the cluster's centroid , according to the legend. at right, representative sequences are shown for each cluster, with non-wt amino acid identities shown at selected positions. a listing of mutations at all positions for each representative sequence is provided as supplementary information . for two clusters , more than one representative sequence was needed due to the genotypic diversity.

generally, the largest clusters were those in which  there was no resistance  to any drug,  there was high resistance to all drugs,  there was high resistance toward all drugs except drv, to which there was moderate resistance,  there was high resistance toward all drugs except drv and tpv,  there was resistance toward only nfv and rtv, and  there was high resistance to apv, atv, nfv, rtv, and sqv.

the clusters demonstrate that there is often cross resistance of sequences toward many drugs. generally, sequences are most commonly resistant to rtv and nfv, followed by atv and sqv, then apv, ind, and lpv, and finally tpv, and drv. in general, resistance to drv implies resistance to nearly all other drugs, with a few exceptions: three clusters showed moderate to high levels of resistance against all drugs except tpv , and two clusters showed moderate to high levels of resistance against all drugs except sqv . in both cases, the representative sequences of the clusters each had at least one mutation that has been associated with hypersusceptibility toward the particular drug in a previous study in which mutations were the independent variables and fold-change was the dependent variable <cit> . these mutations include l10f, g48v, i50v, i54l, and l76v in the case of the clusters with unique susceptibility to tpv and i47a in the case of the clusters with unique susceptibility to sqv.

one may ask if grouping  <dig> sequences into  <dig> phenotypic clusters and  <dig> outliers shows that hiv is exploring a large or small part of the available phenotypic space. to address this question, we repeatedly generated sets of  <dig> random points within the same nine-dimensional scaled space of our data set and clustered them using the same constraints applied to the true data set. the average minimum number of clusters needed over  <dig> trials was  <dig>  with the smallest number of clusters needed being  <dig>  clearly, the fact that only  <dig> clusters  were needed to partition the actual data within the constraints demonstrates that hiv protease is exploring a very small portion of possible phenotypic space. in fact, due to the constraints used in the clustering, the volume of 9-dimensional phenotypic space occupied by each cluster must be less than the smaller of either the volume of a hypersphere of radius c or a hypercube of length 2c∞. using our constraint values, the smaller of these is the former, with a value of ~ <dig>  volume units. the volume of clinically-relevant phenotypic space can be calculated from the maximum and minimum scaled values in table  <dig> to be  <dig> volume units. therefore, only / <dig> = ~6% of phenotypic space, at best, has been explored by the considered isolates, compared to / <dig> = ~44% for a random data set of equal size.

if a drug is removed from the data set, the minimal number of clusters needed to represent the phenotypic diversity must be less than or equal to the minimal number needed with that drug included. one way to measure the additional phenotypic diversity provided by each drug is to remove each drug in turn and re-cluster using the k-medoids approach under the same distance constraints. drugs that, upon removal, greatly reduce the number of required clusters have phenotypes that vary somewhat independently from the other drugs. drugs that, upon removal, do not greatly reduce the number of required clusters have phenotypes that vary predictably with  the remaining drugs. when this analysis was carried out, it was found that removal of tpv reduced the number of needed clusters by the most , suggesting that tpv's response toward sequences varies somewhat independently from other drugs. in other words, tpv might show varied, graded responses toward certain groups of sequences toward which other drugs show relatively constant responses. removal of atv, sqv, or apv also reduced the number of needed clusters by over  <dig> . removal of lpv, drv, nfv, rtv, or idv reduced the number of required clusters the least  suggesting that their scaled resistances either vary predictably with those of the other drugs or do not vary appreciably in general.

phenotypic clustering allows for potentially improved prediction of unknown drug phenotypes given phenotypic information for other drugs
our results indicate that a small portion of the full phenotypic space has been explored by the virus, assuming a representative data set; consequently, one may be able to successfully predict resistance to a given inhibitor given resistance data toward other inhibitors, without knowing any genotypic information. to test this hypothesis, we used a cross-validation procedure in which each sequence from the data set was removed in turn and the sequence's resistance toward each drug was estimated based on a clustering assignment using the other eight resistance phenotypes . pairs of sequences that were clustered together in the original clustering remained together an average of  <dig> % of the time across all n runs of the validation, not counting runs in which a member of the pair was excluded in turn, demonstrating the stability of the clustering during the cross-validation procedure. the results of the cluster-based prediction are summarized in table  <dig> 

percent of viruses whose resistance score toward each drug was correctly classified , as well as the rms error  over all sequences of the phenotypic difference between predicted and actual phenotype  using the two controls described in the text " and "ctl <dig> " and the cluster-based prediction. the top panel presents results using all  <dig> sequences, and the bottom panel shows results after removing the two clusters showing little or no phenotypic resistance to any drug.

two controls were used for comparison and are described in the methods. control  <dig> , which randomly reported a value from the distribution of scaled resistances in the data set toward the particular drug, was able to correctly categorize resistance 21%-36% of the time, depending on the drug. the rmse's of the actual scaled resistance values were often over a whole unit away, meaning that it would often predict no resistance when there was in fact resistance, and vice versa. nfv and rtv were classified correctly most often; the clustering suggests that this may be because they were more likely to exhibit either no resistance or complete resistance, providing a less graded distribution overall from which to sample.

control  <dig> , which guessed the "unknown" phenotype to be the average of the other  <dig> known phenotypes for the isolate, performed much better overall than control  <dig>  categorizing resistance correctly for more than half of the sequences for atv, apv, ind, lpv, and sqv. its strong performance is additional evidence for the high level of both correlation between drug responses and cross resistance. performance was worse for  nfv and rtv, which are often inactive to viruses toward which other drugs are effective, as figure  <dig> indicates,  drv, which, according to figure  <dig>  often remains effective toward viruses resistant to other drugs, and  tpv, which, as shown above, has less phenotypic similarity to other drugs.

compared to either control, the cluster-based prediction correctly classified a higher percentage of viruses for every drug, although the improvement over control  <dig> was modest in some cases, with the rmse's being marginally higher in some cases as well, suggesting that when the cluster-based classification was incorrect, it was quite different. the improvement in classification was largest for nfv, rtv, and drv. classification rates overall were well over 50% correct with rms errors being fairly small . the notable exception is tpv, again supporting tpv's uniqueness.

the relatively large number of sequences susceptible to all drugs in our data set might bias the prediction accuracy of certain methods to be higher than what would be expected from a data set that contained a more even distribution of all multidrug phenotypes. to control for this, we redid the above analysis after having left out the sequences corresponding to the two clusters shown in figure  <dig> that show no or very little resistance to all nine drugs . not surprisingly, control  <dig> performs much better with rtv and nfv, as now, nearly all sequences in the data set are resistant to either drug. also unsurprisingly, control  <dig> performs worse because the two clusters that were removed contained sequences whose responses to all drugs were highly correlated. the cluster-based classifier still has the highest classification accuracy, but again, the rmse values were sometimes greater than those for control  <dig>  nevertheless, these results show that an understanding of major phenotypic resistance patterns can allow for reasonable prediction of a sequence's resistance toward one drug given resistance information toward other drugs, and the strong performance of the controls under certain circumstances further highlights the underlying structure in the resistance patterns.

the accumulation of hiv protease mutations results in a "path" in phenotypic space
principal component analysis  was used to project the nine-dimensional, columnwise-centered drug-resistance phenotypes of all sequences onto the two dimensions along which there is most variation. figure  <dig> is a plot of the sequences in this two-dimensional space, colored by the total number of amino acid differences from consensus-b wild type protease . the first two principal components are able to capture approximately 90% of the variation in the data, again suggesting that there are large correlations between drug responses toward the sequences. as indicated in table  <dig>  the first principal component indicates resistance toward all drugs , with slightly less resistance toward tpv and drv, relative to their means. the second principal component indicates resistance toward nfv and rtv, less resistance to atv, sqv, and idv, and low resistance or even increased susceptibility toward apv, lpv, drv, and especially tpv, relative to each drug's mean resistance value.

the first two principal components together capture approximately 90% of the variance in the data and represent development of high resistance toward all drugs and development of high resistance to nfv and rtv with increasing resistance toward atv, sqv and idv, respectively.

interestingly, the points in figure  <dig> form a "path" through phenotypic space. such "horseshoe"-shaped paths are often indicative of a non-linear ordering or underlying gradient in the data <cit> . here, the path clearly tracks the genotypic mutations accrued by the sequences. sequences with few mutations appear to have resistance toward nfv, rtv, atv, sqv, and idv, but little resistance to apv, lpv, drv, or tpv , while sequences with many mutations are resistant to all drugs . three sequences along the path are selected in figure  <dig> and their corresponding scaled phenotypes and genotypes are listed to the right of the plot. the point selected on the intermediate portion of the path represents a sequence that includes the mutations m46i and l90m, which have been shown to be highly correlated <cit>  and to be associated with resistance to nfv, idv, and rtv, and other drugs to a lesser extent <cit> . the point selected at the right end of the path represents a sequence that shows at least moderate resistance to all drugs, and includes the mutations v82t, i84v associated with resistance to tpv <cit> , and l33f, i47v, and i54m, associated with resistance to both tpv <cit>  and drv <cit> , in addition to containing mutations that harbor resistance toward first-generation drugs.

as a whole, figure  <dig> supports the historical "path" of drug development, in that it is relatively easy to become resistant to first-generation drugs with relatively few mutations , but many accumulated mutations appear to be necessary to confer resistance to the newer drugs, such as darunavir <cit> . whether or not this pathway is due to history and treatment regimens or whether it is a fundamental consequence of the structural features of the drugs and the viable evolutionary space of hiv- <dig> protease requires further study.

a handful of sequences lie "off" the pathway. three such sequences are indicated in figure  <dig>  and several more are listed in fig. s <dig> . the top and bottom sequences indicated in figure  <dig> are both uniquely susceptible to sqv and have the mutation v82l which has been associated with increased sqv susceptibility <cit> . the middle sequence shows low levels of resistance across all nine drugs. all three of these sequences fall off the pathway because of their non-negligible levels of resistance toward one or more second-generation drugs while maintaining susceptibility to one or more first-generation drugs. additional outliers are shown in the supplementary information .

phenotypic similarity does not imply genotypic similarity
mutations from two sample pairs of sequences from the lower-right quadrant of each figure are shown. in figure 3b only the mutations contributing to the genotypic distance are shown. as can be seen, very different genotypes can generate similar resistance patterns. for example, the sequences shown in the lower box at the right of figure 3a show high levels of resistance toward all drugs; each sequence has a subset of documented drug resistance mutations, such as v32i, l33f, m46i, i47v, f53l, g73s, v82a, and l90m in the case of the first sequence and m46l, i54v, v82f, and i84v in the case of the second sequence, but the sequences have few mutations in common , most of which are considered highly polymorphic accessory mutations <cit> . the variety of mutations through which the protease is able to achieve similar multidrug clinical phenotypes demonstrates that phenotypic similarity does not imply genotypic similarity. recall here that two sequences that are both sufficiently above the clinical fold-change cutoff for resistance for a given drug are both considered phenotypically identical toward that drug, due to the capping of scaled resistance values above a threshold. therefore, while they are phenotypically similar from a clinical perspective, they may possess quite different  raw fold-change values toward a given drug.

another way to understand the genotypic variation for a given phenotypic pattern is to analyze the genotypic diversity within each phenotypic cluster. for each individual phenotypic cluster obtained in the above analysis, we used a k-medoids approach to identify representative genotypes for that cluster. through constraints, a more genotypically diverse phenotypic cluster would require more sequences to represent it. figure  <dig> shows the representative sequences chosen for all phenotypic clusters. as can be seen, two clusters , even though they are of similar sizes to others, require multiple representative genotypic sequences. multiple representative sequences for a cluster suggest multiple genotypic paths to the phenotype.

to quantify phenotypic and genotypic diversity within clusters, resampling was carried within each cluster as described in the methods. table  <dig> summarizes the results for all clusters with more than  <dig> members. the p-values for intracluster phenotypic distance  show significantly low variation, but hard constraints in the clustering enforced phenotypic similarity so this low variation is by design. it is also not surprising that the genotypes of non-resistant clusters are also statistically similar , as none of these sequences would be expected to bear a resistance-associated mutation, so they should all effectively be "wild-type". however, among multidrug resistant phenotypes, there is either no more or no less genotypic variation between members within a cluster than there is between any two random sequences in the data set , or there is more genotypic variation than would be expected by random sampling in the cases of clusters  <dig> and  <dig> . furthermore, on average, pairs of sequences from the same cluster generally share less than 50% of their mutations ; the one exception is the cluster containing sequences resistant to all drugs , whose members share 54% of their mutations on average; indeed the average intra-cluster genotypic distance for this cluster is in some cases less than that for clusters containing fewer mutations on average, suggesting that a higher number of mutations may not mean greater genotypic variation, and also indicating that the most highly resistant sequences might need to have some "key" mutations in common. when removing from the data set one from each pair of  <dig> sequences from the same patient at two different time points and reclustering, the most highly resistant cluster still had >50% shared mutations on average and a lower intra-cluster genotypic distance than some other resistant clusters, although it now required two representative sequences, suggesting that some - but not all - of this similarity may be due to including data at different time points from the same patient. this idea is further addressed in the discussion. nevertheless, while a larger data set would allow for a more rigorous control for the number of mutations within a cluster when computing p-values and for the exclusion of data from the same patients at multiple time points, thus allowing for fairer comparisons, this simple analysis suggests again that in general, phenotypic similarity does not imply genotypic similarity, and certain multidrug phenotypes may be achieved by more varied genotypes than others.

"phenotype" is the nine-digit shorthand describing the binned level of resistance of the cluster centroid toward each of the nine drugs . "intra pheno" is the average intra-cluster phenotypic distance . "p pheno" are p-values for intra-cluster phenotypic distance. a p-value of  <dig> indicates that a more extreme distance was not sampled in  <dig>  trials. analogous headings are shown for genotypic distance as well; genotypic distance was defined using the list of non-polymorphic positions in the methods. "avg muts" is the average number of mutations at non-polymorphic positions for sequences within the cluster. "shared muts" is the average number of shared mutations between all pairs within a cluster. shan. ent. is the computed shannon entopy  for the cluster, adding up the entropies at each non-polymorphic position.

feature selection uncovers important positions and mutations for cluster assignment
finally, we sought to rigorously determine sets of amino acid positions and mutations that were most informative of membership in the phenotypic clusters. figure 4a shows the results of greedily selecting one position at a time such that at each step , the  mutual information  between the chosen set of features and the cluster assignment is maximized. only those positions that had significant mi with the output are included. the red bars indicate the mi between an individual position and the cluster assignment, with the yellow star indicating the threshold for statistical significance . the blue bars indicate the joint mi between the subset selected thus far and the cluster assignment. note that positions are not strictly selected in decreasing order of individual mi. because mutations at certain positions may be highly coupled with positions already in the feature set, less individually informative positions may contribute to a more informative set of positions. this technique therefore chooses highly non-redundant features that are still informative of the output. finally, the black bar shows the total information content of the output, the cluster assignments.

figures 4c and 4d show sample results for mutations that are informative of assignment into specific clusters - cluster  <dig> , the most resistant cluster, and cluster  <dig> , the completely nonresistant cluster. all other results for clusters with 8+ members are shown in figure s <dig> . figure 4c indicates that the amino acid identities most informative of membership into the "most" resistant cluster include several mutations that have been associated with resistance to drv <cit>  including v11i, l33f, v32i, l89v, and g73s, as well as mutations such as i84v and l90m that are associated with broad cross resistance toward other pis.

finally, many of the informative residues in the non-resistant cluster  are actually wild type amino acids. this suggests that the lack of mutations at these positions correlates with low levels of resistance. additionally, several mutations listed are at accessory positions such as  <dig>   <dig> and  <dig>  suggesting that mutations at these positions are reasonable markers for "any" resistance in general. it is important to note that while this method highlights which mutations are most informative of cluster assignment, it does not identify whether it is the presence or the absence of the mutation that is associated with cluster membership.

discussion
this study highlighted major patterns of phenotypic resistance across all nine clinically-approved hiv- <dig> pis. cluster analysis yielded several phenotypic patterns, including clusters showing resistance to all drugs, all but one specific drug , a large subset of drugs, a small subset of drugs, and only one drug . through choosing representative sequences for each phenotypic pattern, we have corroborated previously reviewed observations <cit>  that mutations such as l33f, v82a, i84v, and l90m are associated with broad cross resistance, while others, such as d30n and i50l are associated with resistance to only one drug and still others such as i47a and i54l are linked with hypersusceptibility toward a given drug. while we have uncovered a variety of phenotypic patterns, not every possible resistance pattern was sampled, suggesting that cross resistance and other factors cause highly correlated drug responses, assuming our data set is representative. indeed, our considered isolates occupy only a small portion  of the available, clinically-relevant phenotypic space. for example, no cluster shows a moderate or high level of resistance toward drv without resistance to several other drugs, including apv and lpv. whether this result is due to patient treatment histories or the intrinsic properties of the drug--protease interactions requires further study. if the latter is at least partly the case, it corroborates the observation that drv may have a higher genetic barrier to resistance <cit> .

tpv's response toward sequences often shows little relationship to other drugs' responses. the relative lack of cross resistance to tpv may make it particularly useful <cit>  in conjunction with other inhibitors to "cover" the mutation space of the virus. tpv's differing response profile may follow from its unique structural characteristics. it is the only clinically-approved inhibitor that does not use a water molecule to mediate hydrogen bonds with the flap regions of the protease, suggesting the importance of developing structurally diverse drug molecules toward a target as a strategy to combat resistance <cit> .

the representative sequences of four clusters  had no mutations at the  <dig> positions considered in computing genotypic distance for this purpose, and yet their phenotypes were not identical on average. this suggests a potential role for mutations at other positions that may not be associated with primary drug resistance. a rigorous study that analyzes the differences in mutation frequencies in such clusters and considers their impacts on the susceptibilities of individual cluster members, while beyond the scope of the current work, would be interesting potential future work, especially when more data are available.

we demonstrated that phenotypic clustering may allow for prediction of resistance to a particular drug based only on resistance information toward other drugs and no genotypic information. while our goal was not to develop a prediction method that is superior to the available genotypic-based methods specific to each drug, especially as it may be rare to have multidrug phenotypic data available, it is interesting to assess how well our "genotype-blind" method performs when compared to genotype-based methods. rigorous comparisons to mean standard error values in other studies are difficult due to different scaling and capping procedures used here for phenotypic standardization. nevertheless, some studies used a pearson correlation coefficient  between predicted and actual log-fold-change as a measure of accuracy. r values for pis available at the time of selected studies ranged from  <dig> - <dig>  <cit> ,  <dig> - <dig>   <cit> , and  <dig> - <dig>  <cit> . from the cross-validation procedure used to generate table  <dig>  our "genotype-blind" method gave r-values ranging from  <dig> - <dig>  using all  <dig> data set members, with the exception of tpv, although these numbers may be artificially high due to our capping of extreme values. predictions of resistance to tpv had an r value of only  <dig> , consistent with the observed difficulty in predicting tpv resistance based on the phenotypes shown toward other drugs. finally, our reported classification accuracies are lower than those reported for genotype-based predictions, but this is partly because we use five categories as opposed to the binary or 3-way classifications commonly used. if we adopt a naive binary classification scheme , our cluster-based classification accuracies using the n-fold cross validation procedure for the entire data set range from 85%-95% excluding tpv, compared with 85%-95% for binary classification schemes reported in the literature  <cit>  . it is interesting to note that while not the major goal of our paper, we have shown that with the exception of tpv, it may be possible to approach comparable drug resistance prediction accuracy without any genotypic information; this level of accuracy demonstrates the restricted phenotypic space occupied by the virus.

our analysis was limited by the number of accessible isolates that have each undergone phenotypic resistance testing against all nine inhibitors. a large priority for future work is acquiring enough data such that the number of clusters is robust to the data set size such that one could be confident that all or nearly all phenotypic patterns have been sampled. one strategy is to pool isolates phenotyped by different assays to bolster the amount of data; indeed, a preliminary clustering was carried out in which the data analyzed here were combined with  <dig> isolates phenotyped using the antivirogram  <cit>  assay, but differences between the assays may have subtle but important effects on the interpretation of scaled resistance values, even when using cutoffs specific to each assay, creating potential artifacts in the clustering . more data would allow for larger cluster sizes in general, and therefore a higher confidence in associating certain genotypic features with cluster assignments; one could also look for differences in phenotypes between virus subtypes if such data were concurrently available. additionally, more data may allow for cluster sizes to accurately represent the relative frequencies of phenotypes within the population and would allow us to exclude isolates containing mixtures at key positions; such an exclusion would have been too restrictive with the amount of data currently accessible.

finally, larger clusters would also allow us to account for and potentially exclude sequences that may be from the same patient at different times, allowing for more robust conclusions to be made about the genotypic variability within a cluster. preliminary analyses were conducted in which one sequence each from  <dig> sequences pairs from the same patient in our data set was arbitrarily excluded , yielding a 370-member set. qualitative results of genotypic variability remained similar, in that several resistant clusters showed as much or more genotypic diversity than randomly chosen data set members, although again, the most resistant cluster showed a higher percentage of shared mutations between cluster members on average even though it now required two representative sequences.  <dig> clusters were needed to cluster the "unique-patient" data set as opposed to  <dig> for the original data set, suggesting that data from the same patient taken at different time points can provide additional phenotypic diversity. 98% of sequence pairs grouped together in the smaller data set were grouped together in the original data set, showing that the overall clustering remained very similar.

since the time the manuscript had been originally drafted, we obtained approximately  <dig> more isolates, and we have carried out very preliminary analyses of a larger  data set including these new sequences.  <dig> clusters were needed to group the data using the same constraints with the original data set, and the phenotypic patterns of most clusters were identical or highly similar; 86% of sequences pairs that had been grouped together originally remained together in the clustering of the larger data set. we also used our original  clusters to predict resistance to each drug for each of the new isolates, using the other drugs' resistance values to select the closest centroid . scaled resistance scores  were predicted correctly from 66%-82% of the time, depending on the drug; interestingly, predictions for tpv  and drv  were better than seen in the n-fold cross validation, while those for nfv  and rtv  were worse. prediction accuracy may be affected by the points in time at which the data were obtained, as resistance patterns may change over time.

treatment histories were not entirely available for the current data set; acquiring such information and analyzing future data in their context can provide additional insights. for example, one could determine the extent to which treatment histories affect the "path" seen in figure  <dig> and the dependence on individual multidrug resistance phenotypes on past treatment; such analyses could highlight the extent to which treatment histories affect the genotypic variation within a phenotypic cluster.

while the methodology and analyses were applied here to the hiv- <dig> protease system, the framework is generally applicable to any system for which there are phenotypic data across multiple drugs. in addition to continuing to analyze hiv- <dig> protease as the available data grow, another natural next step is to apply these methods to the hiv- <dig> nucleoside or non-nucleoside reverse transcriptase inhibitor systems and to compare the patterns of cross resistance within those systems with the ones obtained in the present study. by rigorously studying phenotypic resistance patterns of multiple systems, one may begin to address more general ideas, including whether cross resistance has equally affected all target systems and whether potential genotypic diversity within phenotypic clusters is a general feature of target systems.

CONCLUSIONS
to our knowledge, this study provided the first cluster-based analysis of the clinically-explored multidrug phenotypic space of hiv- <dig> protease, uncovering major multidrug patterns of resistance, cross resistance, and potential hypersusceptibility. we showed that while genotypic similarity implies clinical phenotypic similarity, the converse is not necessarily the case. we also provided genotypic determinants of phenotypic patterns. rather than consider each drug in turn, as others have done, we have accounted for their relationships and collapsed the vast nine dimensional space into a smaller one through clustering, allowing us to consider genotypic features that are associated with a simultaneous nine-drug response. we have therefore provided a new perspective on existing drug resistance patterns and their associated genotypic features. such a framework will be useful as new therapies emerge and will require evaluation in the context of existing drug resistance.

authors' contributions
rws and mlr conceptualized the research. kmd, pn, bmk, syr, and mlr implemented methods and performed analyses. syr and rws acquired data. sph provided critical support for certain analyses. rws, bmk, pn, and mlr drafted the manuscript. all authors have read and approved the final manuscript.

supplementary material
additional file 1
contains the formal integer-programming formulations used within the work, five supplementary figures  and one supplementary table . this file also contains a link to a website containing the n =  <dig> data set used in this work. .

click here for file

 acknowledgements
the authors acknowledge morgan carr-markell, patrick flaherty, kevin gold, tim mcmurry, and bruce tidor for helpful discussions. kmd was partially supported by the national science foundation . pn was partially supported by the wellesley college brachman-hoffman fund and the howard hughes medical institute. bmk was partially supported by the national institutes of health . syr and rws were supported by the nih grants p01gm066524- <dig> and ai <dig>  sph was supported by nih-r01gm <dig>  mlr was supported by wellesley college.
