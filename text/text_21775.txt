BACKGROUND
the development of imaging technology over the past two decades has enabled significant advances in biology and resulted in an exponential increase in the size and complexity of the data sets generated  <cit> . however, this ability to acquire data at a rapid rate has also led to major data management challenges  <cit> . consequently the ability to manage and analyse image sequences, particularly those recorded at a high frame rate, is now recognised as the major bottleneck in laboratories using high throughput imaging systems  <cit> . this bottleneck is being addressed by the development of bioinformatics, an emerging field tasked with developing techniques to extract biological data from image datasets allowing the subsequent deletion of memory intensive images  <cit> .

among the many methods of automated image analysis available to biologists is motion analysis, a technique that has been used for quantifying the behavior of mammals  <cit> , fish  <cit> , sperm  <cit> , larvae  <cit> , algal spores  <cit>  and bacteria  <cit> . these applications measure parameters including distance travelled, speed and angular velocity and they therefore rely on an observable forward motion in the sample studied. the application of these motion analysis systems to quantify embryonic movement effectively is limited, as the movement patterns embryos exhibit are often complex, subtle and diverse , which creates challenges in quantifying embryonic movements in a holistic way. here we demonstrate a technique for quantifying motion patterns in embryos that can distinguish the effects of environmental stressors on embryos at different developmental stages.

we applied sparse optic flow  <cit> , a machine vision motion analysis technique , to image sequences of two widely used vertebrate model species at three early developmental stages:  danio rerio embryos at stages 19 h,  <dig>  h and 33 h  <cit> , and  xenopus laevis at stages  <dig>   <dig> and  <dig>  <cit> ; and  to embryos of an invertebrate, the freshwater pond snail radix balthica, at stages e <dig>  e <dig>  e <dig>  e <dig> and e <dig>  <cit> . at each developmental stage image sequences were recorded under control conditions and in embryos exposed to abiotic stressors, for which developmental effects have previously been observed  <cit> . danio rerio embryos were exposed to  <dig> % ethanol , and a salinity of  <dig>  <cit> , xenopus laevis were exposed to a salinity of  <dig>  <cit>  and radix balthica embryos were exposed to salinities of  <dig>   <dig> and  <dig>  <cit> .

as the embryos are shape-deformable it is sensible to encode optic flow as a summation of directed rotations. optic flow was therefore calculated as the mean angles of positive  and negative  rotation for each frame and, from these data, the centre of mass was calculated as x and y polar coordinates . the patterns in these frame-by-frame movement parameters  were analysed using discrete fourier analysis, run using the r language for statistical computing  <cit> , to quantify the distribution of energy of each of these parameters, within  <dig> to  <dig> frequency bins ranging between  <dig> –  <dig>  s. a bray-curtis similarity matrix based on  <dig> variables  was visualised using multidimensional scaling  and differences in movement patterns between developmental stages and treatment groups were tested statistically using anosim  <cit>  . this analysis revealed that, in all three species, for most of the developmental stages examined, individuals exposed to an environmental stressor were distinguishable from control organisms and also that many of the developmental stages in control treatments were distinguishable from each other. this technique could be applied to any species whose movement patterns can be visualized and could have applications within the fields of biotechnology, toxicology and developmental biology where the extraction of a holistic measure of embryonic movement patterns would be desirable.

anosim of bray-curtis similarity matrices calculated from the results of discrete fourier transform on frame-to-frame motion parameters. manual quantification of movement patterns: number of tail flicks for danio rerio  and xenopus laevis  and number of embryo rotations for radix balthica ; anova between treatment groups to tests for differences in the manual quantification of embryonic movement for  danio rerio,  xenopus laevis and  radix balthica. *** - p ≤  <dig> , ** - p ≤  <dig> , * - p ≤  <dig> , ns – not significant.

using bray-curtis similarity matrices calculated from the discrete fourier transform of frame-to-frame motion parameters for  danio rerio  xenopus laevis and  radix balthica. *** - p ≤  <dig> , ** - p ≤  <dig> , * - p ≤ <dig> , ns - not significant.

RESULTS
time series of the output parameters produced by optic flow  revealed patterns that accurately reflected the organism’s movement seen during manual observation of the same image sequence, e.g. tail flicks in zebrafish embryos resulted in peaks in the motion parameters recorded by the optic flow motion analysis. subsequent analysis of the frame-to-frame motion analysis parameters was successful in distinguishing individuals exposed to environmental stress from those under control conditions within many of the developmental stages studied , and to distinguish, within species, individuals under control conditions at different stages of development .

danio rerio
danio rerio embryos at 33 hpf exposed to  <dig> % ethanol were statistically distinguishable from those under control conditions . all developmental stages of danio rerio used here  exhibited increased tail flick frequency in response to exposure to  <dig> % ethanol and this was visible in the optic flow motion parameter plots as increased peak frequencies . embryos exposed to  <dig> % ethanol also exhibited more vigorous tail flicking and this caused greater levels of movement within the egg than seen in embryos under control conditions, recorded by optic flow as changes to the calculated x and y coordinates of the centre of mass. however, embryonic movement responses at stages  <dig> and  <dig>  hpf were highly variable. two embryos from both  <dig> and  <dig>  hpf showed movement patterns typical of control embryos and one embryo at  <dig>  hpf exposed to ethanol performed more tail flicking  than all other embryos exposed to ethanol combined. this inter-individual variation perhaps goes someway to explaining why stress responses in these developmental stages were not distinguishable. exposure to a salinity of  <dig> produced no discernible difference in movement responses compared with control embryos.

danio rerio at  <dig>   <dig>  and 33 h post fertilization  under control conditions were all distinguishable from each other via analysis of frame-to-frame parameters. danio rerio at 19 h post fertilisation  performed a regular flicking at the end of the tail. this movement resulted in optic flow producing small peaks in the magnitude of clockwise and anti-clockwise movements and in the calculated x and y coordinates of the embryo’s centre of mass. embryos at  <dig>  hpf performed a less regular tail flicking involving a greater length of the embryo’s tail and this was visible in the motion analysis data as peaks in clockwise and anticlockwise movements and also in the x and y image coordinates of the embryo, with greater amplitude than those seen in  <dig> hpf embryos. the more vigorous embryonic movements caused occasional shifts in the orientation of the embryo within the egg and this resulted in periodic shifts in the x and y image coordinates of the embryo. danio rerio at  <dig> hpf exhibited the longest periods with no gross movement, but when embryos at this stage did perform tail flicks these were more vigorous than at  <dig> or  <dig>  hpf and so this produced larger peaks in the clockwise and anticlockwise movements recorded. there was little change in the x and y coordinates of the centre of mass in danio rerio at  <dig> hpf due to the embryo having little space to move within the egg capsule.

xenopus laevis
xenopus laevis exposed to a salinity of  <dig> in the three developmental stages used here were statistically distinguishable from control individuals . xenopus laevis at stage  <dig> exhibited an increase in tail flicking frequency when exposed to a salinity of  <dig>  although there was significant inter-individual variation in this response ranging from  <dig> to  <dig> tail flicks, during the ten minute recording period. despite this variation there was a clear distinction in the multidimensional scaling plot between control and salinity exposed embryos . xenopus laevis at both stages  <dig> and  <dig> exhibited more frequent tail flicking when exposed to the salinity treatment. tail flicking in stage  <dig> embryos exposed to salinity caused movement of the egg capsule within the well and this was observed in the motion analysis as changes to the calculated x and y centre of mass parameters.

xenopus laevis under control conditions at stage  <dig> was distinguishable from both stages  <dig> and  <dig>  however stage  <dig> was not distinguishable from  <dig>  xenopus laevis at stage  <dig> performed only a very occasional tail flicking and this was a slow movement, relative to stages  <dig> and  <dig>  leading to a gradual peak in either the clockwise or anti-clockwise magnitude of movement, depending on the direction of the tail flick. embryos at stages  <dig> and  <dig> had greater regularity in the frequency of tail flicking than embryos at stage  <dig> and these tail flicks were often too rapid for optic flow to track continuously in the image sequence resulting in sharp peaks in the negative and positive movements calculated. in stage  <dig> and  <dig> individuals optic flow also identified and tracked blood flow within the organism and this produced a low level of continuous negative and positive movements which were not present in the motion parameter data for stage  <dig> embryos in which blood flow was not visible. stage  <dig> individuals had hatched from the egg capsule but motion analysis output did not show any difference between them and stage  <dig> embryos, as the organism displayed the same body flicking behavior. the main difference in motion parameters between stages  <dig> and  <dig> was caused by a more pronounced heart beat and blood flow in stage  <dig>  producing more continuous low level negative and positive movements .

radix balthica
embryos at all five developmental stages exposed to salinity treatments of  <dig>   <dig> or  <dig>  with the exception of embryos at developmental stage e <dig> exposed to a salinity of  <dig>  were statistically distinguishable from control embryos . all developmental stages of radix balthica used here exhibited a dose-dependent decreased frequency and magnitude of embryonic movements with increased salinity. embryos from developmental stages e <dig>  e <dig> and e <dig> exhibited fewer ciliary-driven oscillations than control embryos. embryos at e <dig>  which under control conditions undergo a “figure of eight” path within the egg, when exposed to salinity, rotated with little net movement within the egg. radix balthica at stages e <dig> and e <dig> exposed to a salinity of  <dig> exhibited less gliding around the egg compared to control embryos, and this resulted in less positive and negative movement identified by optic flow as less change to the x and y centre of mass motion parameters. when embryos at stages e <dig> and e <dig> were exposed to a salinity of either  <dig> or  <dig> they stopped gliding around the egg, using their cilia, resulting in only minor changes to x and y centre of mass coordinates. however, despite the lack of overall movement in the egg, embryos in these treatments did continue to exhibit small scale movements of their muscular foot and shell which led to small peaks in the negative and positive movement parameters recorded by the motion analysis.

radix balthica embryos under control conditions at the developmental stages; e <dig>  e <dig>  e <dig>  e <dig> and e <dig> were all statistically distinguishable from each other with the exception of e <dig> from both e <dig> and e <dig> . the movement patterns of r. balthica produced by optic flow were markedly different between early and late developmental stages due to the developmental transition from regular ciliary driven rotations to complex muscular movements more similar to those seen in adult snails . the manually observed rates of ciliary rotation in the three earliest stages  closely matched the cyclical patterns in negative and positive angles of rotation produced by optic flow.

the oscillatory pattern in clockwise and anti-clockwise movement became more variable as development progressed from ciliary rotation  to muscular movement  producing marked differences in the frame-to-frame optic flow parameters. optic flow was still able to accurately to track embryos exhibiting these more complex muscular movement behaviors, despite accurate manual quantification not being possible.

e <dig> stage embryos are spherical and exhibited a “figure of eight” type movement within the egg capsule, which produced a sinusoidal pattern in the x and y coordinates of its centre of mass . e <dig> stage embryos are “crescent shaped” and occupy approximately three times the volume of the e <dig> stage, which resulted in the coordinates of the centre of mass having a frequency close to that of its rotational rate. there was some long term movement in the x and y coordinates of the calculated centre of mass caused by lateral, as opposed to spinning, movement within the egg capsule. e <dig> stage embryos occupy approximately one third of the egg capsule and are significantly more asymmetrical than the e <dig> stage and also exhibit variable rates of spinning which leads to a less uniform pattern. in e <dig> stage embryos, cilia-driven rotational behaviour is largely absent and replaced by prolonged periods of apparent inactivity, during which the embryos undergo muscular contractions and flexing of the foot and shell. the loss of rotational movement is evidenced by the lack of a clear rhythm in the centre of mass time series replaced instead by a mostly linear pattern. periods during which no large scale movements occur are interrupted by occasional gliding around the egg capsule. e <dig> stage embryos are much larger than e <dig> stage embryos, the former almost completely filling the egg capsule, however they exhibit similar patterns of behaviour to e <dig> embryos. this increase in size explains the decrease in the amount of “noise” surrounding the x and y centre of mass from the e <dig> to e <dig> stage as the embryo has very little room to move within the egg capsule in the e <dig> stage which likely restricts small scale movement.

manual quantification of embryonic behaviour  was found to be less effective at distinguishing individuals exposed to stress treatments than the motion, and subsequent frequency, analysis presented here. manual quantification of movement parameters could not distinguish treatments that were not distinguishable using this motion analysis technique. furthermore, this technique was successfully able to distinguish some treatments that were not distinguishable using manual analysis .

discussion
the application of motion analysis that we present here to detect the effects of abiotic stressors on different stages of embryos of three species incorporates data quantifying embryonic movements at a range of frequencies and so provides a holistic analysis of embryonic motion. this type of analytical approach may be applicable to a wide range of species, at various developmental stages, as it doesn’t rely on one particular type of movement, but rather being able to incorporate a diverse range of embryonic movements into a single analysis. this potential benefit is demonstrated here through the ability of this technique to distinguish environment-induced changes in motion in early molluscan developmental stages undergoing ciliary rotation, late molluscan development, during which the heart beat and slow muscular contractions are the prominent movement, and vertebrate developmental stages during which movement is mostly in the form of tail flicking or, in later development, the beating heart and associated blood flow. this technique was also better able to distinguish embryos exposed to stressors than analysis of manual quantification of movement patterns .

while we have shown that this technique can be applied to embryos of two of the most common vertebrate model species and an invertebrate embryo, there is no reason why, in principle, such analysis cannot be extended to species belonging to other phyla . the spectral frequency analysis used here to analyse the frame-to-frame motion parameters, could be modified to target particular frequencies and refined for use on different species or to increase efficacy at detecting a particular behavioural response to a stressor. refinement of the spectral analysis to target frequencies relevant for particular movements would enable this technique to be used as an automated toxicological assay able to quantify complex behavioral responses to stressors.

image analysis and automated pattern recognition have been used to relatively good effect in reliable and quick species identification procedures  <cit>  and the determination of developmental stages  <cit> , but have not been used successfully to stage live animals in real time. the innovative use of motion analysis presented here was successfully able to distinguish many of the developmental stages studied and so demonstrates its potential application to an automated system for staging living, animal embryos. although most biologists are probably accustomed to staging organisms prior to their use in an experiment the efficacy and reliability of developmental staging has long been questioned  <cit> . automated image analysis is recognized as offering advantages over manual analysis; including greater consistency and accuracy and is less time consuming  <cit> . therefore this approach could offer the benefits of automated image analysis for staging living embryos. the ability of this technique to distinguish stress induced changes and embryonic developmental stages also demonstrates its potential application to automate both, screening of short term stress responses and longer term effects on rates of development e.g. decreased developmental rate in long term exposure to a stressful environment.

CONCLUSIONS
image analysis is a key tool in biology for the extraction of biologically meaningful data from image datasets. here we present a novel application of motion analysis coupled with spectral frequency analysis for providing a holistic measure of movement patterns. this technique is able to distinguish environmentally-induced alterations to movement patterns, and also individuals at different stages of development, and therefore could have applications in disciplines such as ecotoxicology, developmental biology and biotechnology.

