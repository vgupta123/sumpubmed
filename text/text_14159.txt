BACKGROUND
identification of peptides, especially post-translationally modified peptides, using liquid chromatography coupled with tandem mass spectrometry  is the basic task of current proteomics research  <cit> . database search is the most widely used computational approach to peptide identification from mass spectra  <cit> . other approaches include de novo sequencing  <cit>  and tag-based approach  <cit> . however, due to the complexity of mass spectra, the majority  of them cannot be interpreted at present  <cit> . among many reasons for the low interpretation rate of mass spectra, unexpected or unknown peptide modifications is a major one  <cit> .

identification of modified peptides is usually conducted in a restrictive manner; that is, a set of variable modifications are specified before database search. however, there are hundreds of known natural or artificial modifications . most of them have multiple specific sites. therefore, it is no practical to select all the modifications for database search, since this will lead to combinatorial explosion of search space as well as increased chance of random matches. in current popular search engines, such as sequest  <cit>  and mascot  <cit> , no more than ten variable modification types are allowed. the problem is that in most cases we know little about which modifications occur in the protein sample and exist in the mass spectra in hand. most of the time, oxidation on methionine is the only variable modification specified for database search. as a result, a large amount of spectra from modified peptides have not been interpreted in the past.

to address the above problem, unrestrictive approaches to modification identification have been proposed in recent years  <cit> . ms-alignment is the first algorithm for unrestrictive identification of modifications  <cit> , which aligns the experimental spectrum against the theoretical spectrum predicted from a peptide in the database in a modification-tolerant manner, just like the sequence alignment in genomics. in this way, any modifications can be identified as long as the two spectra compared present enough similarities. spider formulates modification identification as a dynamic programming problem, searching for a modified peptide that minimizes the difference between the de novo sequenced and the database peptides  <cit> .

although the above approaches to unrestrictive identification of modifications are useful and attractive, they involve time-consuming database search processes or rely on good spectrum quality. if we can know the real types of modifications presented in the spectra prior to database search, the time spent will be reduced significantly. in fact, several methods have been proposed to detect modifications independently of sequence databases  <cit> . due to the dynamic nature of modifications, the modified and unmodified forms of the same peptide often exist simultaneously in a protein sample. mass spectra of modified and unmodified peptides are correlated with each other in their peptide masses, lc retention time and fragment peaks. savitski et al.  <cit>  proposed to use the peptide mass difference histogram constructed from paired spectra to detect modifications. however, their method builds on the complementary use of cad and ecd fragmentation modes in the mass spectrometer, and thus is not applicable to current common proteomic experiments where only cad or ecd is used. potthast et al.  <cit>  described a method called mass distance fingerprint to detect modification types from common proteomic mass spectra. in contrast to their rather complicated statistical model of mass distribution, they used the peptide mass information only, limiting the confidence of discoveries. bandeira et al.  <cit>  proposed to detect modification-related spectral pairs by comparing the peptide fragmentation data. their method is applicable to both abundant and low-concentration modifications, but at the cost of computational efficiency.

this paper describes a simple yet efficient approach to detecting abundant modifications in high-accuracy peptide mass spectra using both peptide mass and retention time information. each pair of spectra is represented by a two-dimensional  vector composed of the mass difference and the retention time difference between their precursor ions. a bivariate gaussian mixture model is used to discriminate modification-related spectral pairs from random ones. in this way, accurate modification masses and confident spectral pairs can be obtained. we also use a peptide propagation method to assign peptides to modification spectra at given false discovery rate  without searching a database. experiments on two glycoprotein data sets demonstrate the effectiveness of our method.

although our method is at present unable  to find low-concentration modifications, it possesses several advantages compared to previous methods to detect modifications and spectral pairs:

fast

only the peptide mass and retention time information is used. computing the spectra similarity based on peptide fragmentation data enables detection of low-concentration modifications but is very time-consuming. clustering spectra according to the 2-d peptide mass and retention time data is demonstrated to be very fast. abundant modifications and corresponding spectral pairs can be efficiently detected in this way as shown in results section of the paper.

accurate

peptide retention time is used in addition to peptide mass. although using peptide masses alone can also reveal modifications, retention time provides an independent source of supporting evidence. two features are far more discriminative in detecting modification-related spectral pairs than only one feature. therefore, modification masses and identities can be more accurately determined.

robust

our approach to modification and spectral pair discovery is independent of peptide fragmentation data. it is known that modified peptides often have complex fragmentation patterns. for example, phosphorylated peptides often undergo insufficient fragmentation, resulting in dominant neutral-loss precursor peaks. peptides of cation modifications have even poorer fragmentation spectra with reduced fragment signals according to our observation. therefore, those methods using peptide fragmentation data to measure the spectra similarity are unreliable to detect pairs of poorly fragmented spectra. the method proposed in this paper is naturally immune to this problem.

methods
roughly speaking, we use two steps to look for modifications. in the first step, the peptide masses are used alone to obtain a list of candidate modification masses. in the second step, for each candidate modification mass, the retention time is added to validate the modification. each possible pair of spectra is represented by a 2-d vector of peptide mass difference and retention time difference. then, a bivariate gaussian mixture model is used to differentiate modification-related spectral pairs from random ones. by doing this, the accurate modification mass values can be estimated and the influence of the modifications on retention time can be characterized. before all of these analyses, the spectra data set is first reduced to remove redundancy, as described below.

removal of spectra redundancy
in tandem mass spectrometry, abundant peptides will produce many duplicate spectra, leading to data redundancy. the disadvantages of spectra redundancy in our problem lie in two folds. first, redundancy brings high computational burden. since we are dealing with the peptide mass and retention time differences between all pairs of spectra, the size of the problem increases quadratically with the number of spectra. second and no less important, the spectra redundancy may cause unexpected effect on the distributions of peptide mass and retention time differences. the retention time of abundant peptides may possibly distribute across a large range. this is obviously undesirable for our analysis. to remove the spectra redundancy, among all the spectra whose peptide mass values are within a small window , only one of them is reserved as the representative spectrum and all other spectra are removed. of course, spectra of close peptide masses may not be produced by the same peptide and some spectra may be falsely removed as redundant spectra. however, this hardly affects our analysis. we find that a representative subset of spectra is already enough to reveal the dominant modifications.

detection of candidate modification masses
given a set of peptide mass spectra, the peptide mass differences  between all pairs of spectra are calculated. as an example, figure  <dig> illustrates the Δm histogram for data set  <dig> . only those Δm of relatively small values  are considered in this paper, since most modifications are small molecules. as stated previously, for abundant modifications, modified and unmodified peptides tend to be present simultaneously in the sample. therefore, frequent Δm may correspond to possible peptide modifications. those Δm of significantly high frequency are considered as candidate modification masses, which will be further validated according to their corresponding retention time shifts.

to detect statistically significant high-frequency Δm, some probabilistic approach has to be employed. since peptide masses  cluster around unit values, it is inappropriate to assume that all Δm are equally probable. one option is to assume that random Δm follow a mixture of gaussian distributions centred on unit mass values, and use peptides randomly generated or from some database to generate this mixture distribution. however, it is unknown to what extent this assumption holds and the estimated distribution fits the real spectra data. instead of using a complicated model, in this paper we resort to a simple yet practically effective approach to the problem posed. for each mass window of one da around a unit mass value , the most frequent Δm  is extracted, that is,

 Δmif=arg⁡max⁡|Δm−i|< <dig> counts,i= <dig> ,...,n 

where counts is the number of occurrences of Δm and n is the number of mass windows. while most Δmif are random events, some may result from peptide modifications. we observe that the frequency, i.e. counts, of random Δmf approximately follows a gaussian distribution, as shown in figure  <dig>  since it is unknown what type of distribution the frequency of modification-induced Δmf comes from, we use a heuristic way to estimate the random part of counts. let cmin and cmed denote the minimum and the median of counts|ni= <dig>  respectively. then, those counts smaller than 2cmed - cmin are used to estimate the parameters, i.e., mean and variance, of the random gaussian distribution of counts. then, for each Δmif, a p-value is calculated based on this gaussian distribution. those Δmif with p-values less than a given threshold are considered as candidate modification masses.

validation of candidate modification masses
after a list of candidate modification masses are found through the above steps, the next task is to filter out false positives and select a high-confidence subset, since it is possible that the high frequencies of some Δm found in step  <dig> may be just due to chance rather than real modifications. given that we do not want to use the fragment peak information , it is necessary to look for other type of evidence to verify the candidate modification masses.

in lc-ms/ms experiments, in addition to the peptide masses, the retention time of peptides is another type of information readily available. since the peptide retention time is orthogonal to the peptide mass, it is an important source of evidence to validate the modifications. the modified and the unmodified forms of a peptide share the same amino acid sequence and differ by a modification group only. as a result, they are similar in physical and chemical properties and thus lc behaviour, i.e. retention time. a modification usually has a relatively small and consistent effect on the retention time of peptides. therefore, we can expect that if a high-frequency Δm is truly due to a modification, spectral pairs of this Δm will show consistent differences in peptide retention time. for example, a modification may tend to increase or decrease the retention time of peptides to some extent, or simply have no significant influence at all. if a candidate modification mass is accompanied with a wild distribution of retention time differences, this candidate is very likely to be a false alarm.

an intuitive way to implement the above analyses is to show the mass differences and the retention time differences  together in a 2-d histogram. as an example, figure  <dig> illustrates a Δm and Δrt histogram for the carbamidomethylation modification found in data set  <dig> . for simplicity, the scan number is used as a substitute for the retention time in this paper. we can see that there is a sharp peak in the histogram, which is produced by the spectral pairs of this modification. as shown, the modification mass is about  <dig> da and the modification does not lead to a significant increase or decrease in the peptide retention time. the accurate modification mass and retention time shift can be automatically determined in a statistical framework described below.

estimation of mixture distribution
each pair of spectra is represented by a 2-d vector  composed of peptide mass difference Δm and retention time difference Δrt between the two spectra, i.e.,

 Δ = ⟨Δm, Δrt⟩. 

we assume that in the vicinity  of each modification mass, Δ follows a bivariate gaussian mixture distribution with two components, one of which is produced by random spectral pairs and the other by modification-related spectral pairs, or formally,

 Δ∼αrandg+αmodg,αrand+αmod= <dig>  

where g is the gaussian distribution with mean μ and covariance matrix Σ, subscripts rand and mod denote random and modification-related spectral pairs, respectively, and αrand and αmod are mixing coefficients. the parameters of the mixture distribution can be estimated using the expectation-maximization  algorithm.

detection of spectral pairs
after the modification-related and the random distributions of Δ are estimated in the above step, modification-related spectral pairs can be identified at given posterior error rate. given an observation of Δ, the posterior probability of the corresponding spectral pair being modification-related is

 p=pppp+pp=fαmodfαmod+fαrand, 

where f is the gaussian probability density function:

 f=12π1/2e−12tΣ− <dig>  

spectral pairs with posterior probability larger than the given threshold are accepted as true modification-related spectral pairs.

propagation of peptide assignments
after high-confidence modification-related spectral pairs are found out, the peptide assigned to one spectrum can be propagated to its paired spectrum. it is expected that many spectra that cannot be assigned peptides to via standard database search can be identified in this way. this is especially useful for modification spectra of low signal/noise ratios. for example, according to our observation, cations usually prevent peptides from sufficient fragmentation, resulting in few signal fragment peaks. in addition, some modifications can occur at many sites. for example, according to the annotations in the unimod database, the carbamidomethylation can possibly occur at the n-term of any peptides and five amino acids anywhere. it is not practical to specify too many variable modifications in current database search engines, which will greatly increase the time of database search and the chance of false positive identifications. therefore, direct propagation of peptide assignments among paired spectra will be a promising and efficient approach to identifying modified peptides and increasing the interpretation rate of spectra, a major expectation in the proteomics community.

inference of modification types
for spectra of high mass accuracy, e.g. spectra produced from ft spectrometers, the Δm values can be resolved in ppm level. although we used  <dig>  da as the bin width in the Δm histogram, more accurate values of modification masses can be obtained by fitting the 2-d distribution of Δ. retention time difference Δrt, as an additional source of information can exclude many random spectral pairs. with accurate modification masses, the types of common modifications can be easily determined by searching modification databases, e.g., unimod. retention time shift is another type of evidence to infer modification types. different modifications have different influences on the retention time of peptides. for example, we observe that oxidation tends to decrease the retention time . some rare or unknown modifications may not be registered in databases. in this case, the molecular formula of a modification has to be manually inferred. special attention should be paid to cation modifications. for an n+ cation, the resulting Δm is the atomic mass of this cation minus n proton masses. see data sets  <dig> and  <dig> in this paper for examples of cation modifications.

RESULTS
we used two data sets of mass spectra to test our algorithm. both data sets were produced from glycoprotein samples. the reason lies in that in order to identify glycosylated peptides, protein samples have to undergo complex treatments, which can possibly introduce chemical modifications. we show that modifications can be efficiently discovered using our algorithm and either including the modifications into the database search process or directly propagating peptides between paired spectra can significantly increase the number of spectra interpreted.

data
data set 1
ig g depleted human plasma from a healthy donor was mixed with wga, con a and jac lectins to enrich most glycoproteins. then the glycoproteins were reduced, alkylated and digested by trypsin and pngase f, followed by lc-ms <dig> analysis. after treating the glycopeptides with pngase f, the deglycosylated peptides had a + <dig>  da mass drift on asparagine to aspartate. lc-ms <dig> experiments were performed on an ltq-ft mass spectrometer. the ltq-ft mass spectrometer was operated in the data-dependent mode. a full scan survey ms experiment was acquired in the ft-icr mass spectrometer, and the five most abundant ions detected in the full scan were analyzed by ms <dig> scan events. this resulted in a total of  <dig>  ms <dig> mass spectra.

data set 2
ig g depleted human plasma from a healthy donor was mixed with lch lectins to enrich core fucosylated glycoproteins; then the glycoproteins were reduced, alkylated and digested by trypsin and endo f <dig> . samples were separated by scx and rp hplc, and then sent to an ltq-ft mass spectrometer. a full scan survey ms experiment was acquired in the ft-icr mass spectrometer, and the five most abundant ions detected in the full scan were analyzed by ms <dig> scan events. an ms <dig> spectrum was automatically collected when one of the top three intense peaks from the ms <dig> spectrum corresponded to a neutral loss event of  <dig>  m/z,  <dig>  m/z and  <dig>  m/z. among the resulted ms <dig> mass spectra, those that were sure to be from core fucosylated glycopeptides were selected out intelligently in a post-processing step  <cit> . the final data set consists of a total of  <dig>  ms <dig> mass spectra considered to have been generated from core fucosylated glycopeptides.

discovered modifications and spectral pairs
tables  <dig> and  <dig> list the modifications and the number of related spectral pairs discovered in data sets  <dig> and  <dig>  respectively. the modification masses and the retention time  shift caused by modifications are automatically learned using the algorithm presented above. the number of spectral pairs related by each modification with posterior probabilities above  <dig>  is also given. it is shown that the modification mass values determined from data are very accurate, up to the level of  <dig>  da or even  <dig>  da. this high mass accuracy is largely due to the use of retention time as a second dimension for detecting spectra pairs. using peptide masses alone would result in a much lower mass accuracy, e.g.  <dig>  da or so. with a high mass accuracy, the modification types can be easily identified by searching the unimod modification database. in addition, since the peptide fragmentation data is not used in our algorithm, the computational process is very fast. except the time for loading mass spectra data from disk, only a couple of minutes are needed.

among the discovered modifications, some are common in lc-ms/ms experiments, e.g., oxidation, carbamidomethylation and water-/ammonia-loss. carbamidomethylation is usually specified as a fixed modification on cysteine as an artifact for database search. however, we show here that carbamidomethylation may occur on more specific sites abundantly in a variable manner. modifications of important biological functions are also found. methylation is an in vivo post-translational modification, while deamidation can occur both in vivo and in vitro. other modifications may have been introduced by special sample treatments or from samples themselves, e.g., the sodium cation coming from digestion buffer of glycosidase or lectin binding buffer commonly used in the glycoproteomics research and the iron cation coming from hematoglobins in plasma.

two types of cation modifications are found. they are the sodium cation  in data set  <dig> and the very abundant 2+ iron cation ) in data set  <dig>  the fe modification  is not registered in the unimod database and has not been reported before. note that the fe modification  has been found and reported  <cit> . three evidences make us very confident of the identity of the fe modification. first, the empirical mass is very close to the theoretical one – a difference of only  <dig>  da. second, the retention time shift  caused by this modification is very small, just like other cations, e.g. sodium. third, we observe that a large proportion of spectra with this modification have higher charge states than their paired spectra without this modification. this can be explained by a polyvalent-cation modification.

improvements on peptide identification
there are two ways to make use of the found modification types to improve peptide identification. the most common way is to include them as variable modifications into the database search process. the other is to directly propagate peptide between paired spectra without re-searching the database. both experiments are conducted. tables  <dig> and  <dig> give the peptide identification results on data sets  <dig> and  <dig>  respectively. database search is performed using the pfind search engine  <cit>  and the target-decoy database method  <cit>  is used to estimate the fdr of search results. for data set  <dig>  we include the deamidation  introduced by sample preparation and the common oxidation  as variable modifications in the first round of database search. then, the most abundant carbamidomethylation  is added in the second round of database search. as a result,  <dig> more spectra are interpreted, although the increase in the number of peptide identifications is trivial. based on the first-round database search results, peptide propagation is carried out. it turns out that  <dig> spectra with the carbamidomethylation modification are assigned with peptides at the same fdr  as database search . moreover, after peptide propagation between spectra paired by the cation:na modification,  <dig> more spectra are assigned with peptides. on data set  <dig>  inclusion of oxidation into the database search increases the number of interpreted spectra by  <dig>  while peptide propagation between spectral pairs related by the cation:fe, oxidation and deamidation increases the number of interpreted spectra by  <dig>   <dig> and  <dig>  respectively. note that cation modifications, e.g. na and fe adduct cannot be added into database search as variable modifications. this is because it is not clearly known which amino acids the cations are attached to and the spectra with cation modifications usually have very low signal/noise ratio according to our observation. on average, an increase of 10% in spectra interpretation rate is obtained on these two data sets after considering the discovered modifications.

to sum up, experimental results demonstrate that including the detected modification types into database search can increase the number of interpreted spectra to some extent, while direct peptide propagation between spectral pairs related by modifications can interpret even more spectra. moreover, it seems that spectra with cation modifications can only be effectively assigned with peptides by peptide propagation.

CONCLUSIONS
in this paper, we have presented a method for detecting abundant modifications in peptide mass spectra using the peptide mass and retention time differences. the method is more accurate than those using peptide masses only and is more efficient than those using peptide fragmentation data. one disadvantage of our method is that it cannot detect low-concentration modifications. but we argue that this method is not designed for this purpose. by using a statistical framework, very accurate modification masses can be obtained and the influence of modifications on the peptide retention time can be quantified. moreover, modification-related spectral pairs can be detected at a given posterior error rate. an interesting phenomenon observed in this paper is that propagating peptides between paired spectra can interpret even more spectra of modified peptides than including the discovered modifications into database search. peptide propagation is particularly useful for identifying peptides of cation modifications. in the future, we wish to test the method on more proteomic data sets and incorporate more information to cluster spectra.

competing interests
the authors declare that they have no competing interests.

authors' contributions
yf conceived and implemented the algorithm, performed data analysis, and wrote the manuscript. wj and zl carried out the lc-ms/ms experiments, helped identify the modification types, and participated in writing the manuscript. hw participated in the design of the algorithm and carried out selecting of core fucosylated spectra. zy, hc, yl, lx, ww, cl and lw provided the support of pfind-series software tools. lx wrote the program for peptide propagation. rs participated in writing the manuscript. wg, hq and sh supervised the project and revised the manuscript. all authors read and approved the final manuscript.

*pp stands for the posterior probability of being modification-related. 3sigma stands for three times of standard deviation. for the last three modifications, spectral pairs of pp >  <dig>  are not detected out. this is due to the less abundance of these modifications. however, this does not prevent the algorithm from accurately estimating their masses.

*those modifications are found from the 1-d Δm histogram and manually validated by 2-d <Δm, Δrt> histogram, but the data points for them are too few to effectively estimate their Δm and Δrt distributions.

*peptide propagation is conducted based on the peptide identification results of the first-round database search . peptide propagation cannot identify more peptides, but significantly increases the number of interpreted spectra.

