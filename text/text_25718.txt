BACKGROUND
for the past decade, studies on ecology and evolution have relied upon the assessment of genetic diversity in populations and species  <cit> . genomic screening approaches for the measurement of diversity are more satisfactory than any other phenotype- or genotype-based techniques in the sense that they reveal a large number of markers  <cit> . before the 1990's, restriction fragment length polymorphisms , random amplified polymorphic dna  and simple sequence repeats  were widely used to generate a relatively high number of markers. however, the implementation of amplified fragment length polymorphisms – aflp  <cit> , a relatively cheap, easy, fast and reliable method  <cit>  – has exponentially increased the number of informative markers, resulting in large datasets. most of those approaches retrieve genetic information through pcr-based techniques coupled with electrophoretic gels. as a result, markers are identified according to their absolute size that is measured as a function of mobility. the aflp technique starts by digesting genomic dna with two restriction enzymes . this step is followed by the amplification of a subset of the restricted dna fragments  through two successive pcr reactions  and the separation of the amplicons by electrophoresis. amplicons are fluorescently labelled and electrophoresis takes place in a genotyping machine, for instance using the genescan technology . as a result, the reaction conducted on a sample constitutes an "aflp electropherogram" or "profile", in which each amplicon is recorded as a "peak" that is characterized by its mobility  and intensity . the final step of the analysis aims to convert numerous aflp profiles, that reflect the results of an aflp reaction conducted on many samples, into a binary matrix where the presence/absence of each amplicon is recorded for each sample. while the genescan technology improves the accuracy of the genotyping process, its precision is not absolute and several factors  can affect the recorded size of an amplicon. consequently, variability of recorded sizes complicates the analysis, as the same amplicon may have similar but non-equal sizes throughout the sampling. due to these variations, checking and recording the presence/absence of a given amplicon, through the sampling, is generally done manually by the user. this phase is termed "scoring" and is achieved by the following procedures:

i. defining amplicon size categories  that ideally represent aflp loci.

ii. recording the presence/absence of an amplicon within each bin and for each sample  <cit> . as a result, an aflp locus will be coded as a binary state, where the presence of an amplicon is coded with  <dig>  while the absence of the amplicon is coded as  <dig> .

programs such as genographer v <dig>   <cit>   propose a graphical solution by displaying the genescan results on a "gel-like" interface and allowing the user to manually define the bins. although this strategy allows direct control of the scoring, it requires experienced users and remains sensitive to human biases . moreover, the procedure becomes problematic for large numbers of samples and adding new samples to the analysis requires a new scoring session. as a consequence, the final results may vary among runs, among users and across time, weakening the reproducibility and reliability of the analysis. these limitations justify the use of partially automated  or fully automated scoring procedures , where the user does not directly score the dataset, but parameterizes a scoring algorithm. at least three main issues must be considered when scoring a dataset .

i. size homoplasy  <cit> , which can arise in two ways: a) when two non-identical amplicons are considered to be homologous because they display identical mobility or b) when two amplicons are scored as absent at the same locus for differing reasons .

ii. occurrence of bin definition errors resulting from a non-optimal scoring parameterization. this bias can lead to two contrasting errors: either a) "oversplitting", in which bins are too thin and may split variant locations of the same amplicon into smaller and erroneous sub-bins, or b) including an exaggerated range of amplicon sizes within the same bin, thus introducing an artificial similarity between unrelated samples. although they differ in their causes, we assume that this second bias has comparable consequences for the dataset quality as those caused by size homoplasy. we will therefore term this bias "technical homoplasy" in order to distinguish it from size homoplasy.

iii. difficulties in detecting amplicons due to variable quality of aflp reactions. low quality runs can lead to the introduction of a noisy signal  within the dataset. this bias can be limited by using optimized and standardized laboratory aflp protocols  <cit>  and by running blank samples in order to determine the background noise associated with the genotyping machine.

in addition, recent studies propose the evaluation of the quality of both bins and alleles in order to increase the final dataset quality. several of these procedures are applied once the scoring is complete  <cit> . however, it is also possible to proceed before the scoring phase, while analysing the aflp profiles, for instance by tuning the peak detection parameters  <cit> .

the scope of the present study covers methodology of automated aflp scoring in the framework of population genetics and phylogeography. we propose a new automated solution for scoring aflp electropherograms: rawgeno, a program implemented as a package in the widely used r cran freeware. we investigate the effects of sub-optimal settings on our algorithm, by focusing on two upstream processes of the aflp electropherograms analysis: the bin definition and the recording of alleles. for this purpose, we tuned scoring parameters and produced five datasets differing in the average width of bins. this strategy, applied to the model-species cerastium uniflorum , produced five datasets with increasing technical homoplasy. in parallel, we produced five analogous datasets with the commercial software genemapper. finally, we scored the dataset manually by using the freeware genographer. using these eleven datasets, we first evaluate several descriptive statistics that can be used to optimize the scoring of the aflp data. we then investigate the effects of the aflp scoring settings, as well as the choice of the scoring method, on downstream analyses such as data mining statistics , inter-individual and inter-population distance, maximum likelihood clustering  and population diversity indices.

methods
technical features of rawgeno
the analysis begins by detecting and calculating the size of peaks within the aflp profiles. this preliminary analysis is conducted either with genescan v <dig> . <dig>  or with the freeware peakscanner v  <dig>   to produce an exhaustive list of detected amplicons generated by the aflp reaction. this list records the size, fluorescence and sample origin of each amplicon which are used as the input data for rawgeno. it should be noted that our program can potentially be modified to handle results from other genotyping machines.

the bin definition algorithm  <cit>  is the core of our library . in brief, it begins by defining the locations and limits of the bins. the bins are identified on the basis of the range of amplicon sizes from all samples, regardless of their fluorescence intensity . this strategy aims to minimize the bin widths while maximizing the intervals between bins. amplicons are sorted according to their sizes and size intervals are computed between each consecutive amplicon. transitions between successive bins are identified by considering the inter-bin size intervals to be larger than the intra-bin ones. two additional rules are involved in bin definition. first, bins must fit within a user-specified width range . second, a bin can include only one amplicon per sample. the application of this second rule is modulated by the "minimum bin width" parameter, in order to allow the occurrence of technical homoplasy. as a result, "thin" bins are accepted only if they effectively co-occur in at least one sample. similarly, the definition of "wide" bins that would include more than one amplicon per sample within a single bin is prevented as often as possible but remains possible by manipulating the "minimum bin width" parameter. once bins are defined, the algorithm notes the presence or absence of an amplicon in each bin for each sample and builds a binary matrix. finally, amplicon features  are used to improve the binary matrix quality .

empirical data and experimental design
in order to investigate the effects of the scoring procedure on genetic analyses, a dataset from an extensive study on intra- and inter-specific plant biodiversity  was chosen as a model. this dataset includes samples covering the whole geographic range of cerastium uniflorum , a perennial, diploid  plant distributed throughout the european alps in subnival habitats. a total of  <dig> individuals  from  <dig> populations  were analysed with three selective aflp primer pairs. details on the sampling scheme, the primer pairs used and the scoring methods are provided in gugerli et al.  <cit>  and bonin et al.  <cit> . raw data were obtained after running aflp reactions on an abi  <dig> sequencing machine  and analysing electropherograms using genescan v <dig> . <dig> . the program was set up with default detection parameters; only peaks ranging between  <dig> and  <dig> bp with a minimum fluorescence intensity of  <dig> rfu  were included in the analysis. in the context of the intrabiodiv consortium, the scoring was performed manually using genographer v <dig>   <cit> , through a classical user-defined protocol  <cit> , in which non-reproducible bins were discarded before being recorded . as a consequence, this manually scored dataset did not include information regarding rates of reproducibility of alleles and individuals. the resulting scored matrix  was coded as binary states with lines and columns recording presence or absence of amplicons in samples and bins respectively. finally, ten datasets were produced by tuning the scoring parameters of rawgeno and genemapper. we tuned the "minimum bin width" parameter of rawgeno and the "bin width" parameter of genemapper in order to force the algorithms to assign amplicons displaying close but differing sizes to the same bin. as a consequence, the technical homoplasy of the datasets increased proportionally while increasing the bin width.

automated scoring procedures
the parameters of rawgeno were determined as follows : the "maximum bin width" was left unconstrained and set as being the maximum observed amplicon size in the dataset . as a consequence, rawgeno avoided systematically the oversplitting bias . in contrast, the "minimum bin width" was constrained during the analysis and set to  <dig>  bp,  <dig> bp,  <dig> bp,  <dig> bp and  <dig> bp. this strategy produced datasets with an increasing amount of technical homoplasy since rawgeno was forced to use wider bins. it bears repeating that this setting strategy was used to intentionally increase the technical homoplasy in the produced datasets and not to produce optimally scored datasets . the parameters in genemapper were determined using the standard detection settings and a polynomial degree of three was used for peak recognition in the electropherograms. the scoring step was achieved by tuning the "bin width" parameter with values ranging from  <dig>  bp to  <dig> bp . the precise effect of the "bin width" parameter on the genemapper scoring algorithm could however not be predicted a priori and was deduced from the results we obtained. replicated samples  were included in all ten datasets, which allowed the calculation of error rates  and subsequently, the removal of non-reproducible bins  in the final dataset. monomorphic bins and singletons were also removed. the whole set of downstream analyses  were carried out on these cleaned datasets. the ten resulting matrices were coded as binary states in the same way as for the manual dataset . for rawgeno, datasets were labelled as follows: rg_ <dig> , rg_ <dig>  rg_ <dig>  rg_ <dig> and rg_ <dig>  genemapper datasets were labelled as follows: gm_ <dig> , gm_ <dig>  gm_ <dig>  gm_ <dig> and gm_ <dig> 

descriptive statistics
several indices were computed. first, the final number of bins  was recorded for each dataset. second, the mean homoplasy rate was computed within the rawgeno datasets. the homoplasy rate  was defined as the number of amplicons belonging to the same individual that are assigned within the same bin. this statistic was calculated for each sample/bin and averaged for the whole dataset. the frequency of the "present" allele was computed for each bin and frequencies were plotted against the bin sizes . finally, the level of correlation was calculated between each of the ten automatically scored datasets and the manually scored one . this was achieved by: i. calculating jaccard similarity indices  <cit>  between samples, within each dataset. this calculation is defined as being asymmetric as it only accounts for presences in individual genotypes while absences are not considered. ii. calculating pearson's correlation between the resulting similarity matrices, using the similarity matrix obtained with the manually scored dataset as reference.

ordination techniques
the datasets produced from the automated analysis were compared to the manually scored one by using a partial constrained correspondence analysis  <cit> . we used the "vegan" package  <cit>  implemented in the r cran environment and applied the "cca" function . this analysis was used to produce residuals containing information that is specific to the automatically scored dataset, according to the following model: va - vm = ra, where va is the variance of the automatically scored dataset, vm is the variance of the manually scored dataset and ra is referenced to as the residuals that are specific to the automatically scored dataset. we further measured the ability of these residuals to discriminate populations, in order to assess whether the automatically scored datasets effectively contained more information than the manually scored one. this calculation was achieved by applying a mantel test between the residuals matrix and a contrast matrix comprising the population origin of each sample. this test required the computation of euclidean distance on the contrast and residual matrices, for which we used the "mantel" function of the "vegan" r cran package .

error rates and optimality criterion
for each dataset, two estimators of the error rate were computed by considering the information comprised in the replicated samples.

i. the mismatch error rate  <cit>  defined as eb = mrepl/nbin, where mrepl is the total number of mismatches between a sample and its replicate and nbin is the total number of bin. this statistic was computed for each sample-replicate pair.

ii. the bayesian error rates ε <dig>  and ε <dig>  that represent, respectively, the probability of mis-scoring the presence or the absence of aflp fragments. we used masterbayes  and the aflpscore r cran script collection  <cit>  to compute  <dig> estimates of these statistics.

these two estimators required the inclusion of replicated samples and did not allow addressing the quality of datasets where non reproducible bins had been removed . as a consequence, we propose a new "optimality criterion" based on the information content per bin . this statistic was calculated for each sample of the dataset and was defined as ibin = msampling/nbin where msampling is the average number of mismatches between the considered sample and the other samples of the dataset and nbin is the total number of bins in the dataset. this criterion can be computed at any stage of the scoring process and does not require the inclusion of replicated samples. here, we applied it after the removal of non-reproducible bins.

biogeographic structure
we investigated the spatial genetic structure in our datasets at two levels of complexity: first between individuals by computing the jaccard similarity index  <cit> , second between populations by using an estimator of the fst and by performing maximum likelihood clustering . fsts were computed with the program aflp-surv  <cit>  . jaccard similarity indices  and fst values obtained with the various datasets were compared using scatterplots and linear regressions. maximum likelihood clustering was performed using psmix  <cit> , a package implemented under the r cran environment. it uses maximum likelihood methods in order to assign individuals into a predefined number of groups with an associated probability. the algorithm assumes hardy-weinberg equilibrium within groups and linkage equilibrium between loci. the datasets were coded as follows: each individual genotype was duplicated, in order to simulate a diploid co-dominant dataset. the absences  of the original genotype were coded as absences in the duplicated genotype  whereas presences  occurring in the original genotype were coded as missing data in the duplicated genome . this coding scheme is adapted from bonin et al.  <cit> . the default settings of psmix were applied . the number of investigated groups  ranged from two to nine, with ten replicated runs per k. for each k value, only the run showing the highest likelihood value was selected for further analysis. the resulting assignment probabilities were compared using pie-charts mapped on geographical maps.

diversity indices
three indices, revealing the level of diversity in each population, were computed: i. the estimated heterozygosity , by using aflp-surv  <cit>  . ii. the percentage of polymorphic loci , using aflpdat, an r cran script collection  <cit> . iii. the presence/absence rarity index . the values estimated with the various datasets were compared using scatterplots and linear regressions.

RESULTS
applying the scoring
the manual scoring required approximately  <dig> hours of "human work" and produced  <dig> reproducible bins. automated scoring procedures, in contrast, produced the scorings in about  <dig> hour . moreover, the automatic scoring procedures preserved a large number of bins as we obtained  <dig>   <dig>   <dig>   <dig> and  <dig> bins for the rawgeno datasets  and  <dig>   <dig>   <dig>   <dig> and  <dig> bins for the genemapper datasets . as expected, the use of larger bin widths decreased the number of bins and introduced technical homoplasy. interestingly, technical homoplasy occurred more rapidly, with the increase of the bin width, in small fragment sizes  than in larger fragments. this result is explained as follows. amplicon sizes are generally asymmetrically distributed because short amplicons are often over-represented compared to larger ones   <cit> . as a consequence, these small amplicons were shown to be especially prone to reflect size homoplasy  <cit>  and in addition, our results showed that they were also likely to accumulate more technical homoplasy than the rest of the aflp profile.

using manual scoring as a reference point
we first investigated the quality of datasets by referring to the manually scored dataset. technical homoplasy, generated by forcing the scoring algorithm to create large bins , clearly impacted the dataset quality, as shown by a decreasing correlation to the manual dataset with increasing bin width . this result matched our expectations and outlined the effects of technical homoplasy. interestingly, we observed an optimal bin width effect in the genemapper datasets , where datasets scored with small bin widths showed less correlation to the manually scored one than the datasets scored with a greater bin width . conversely, in rawgeno this phenomenon was avoided since correlation values remained relatively constant between datasets that were scored with small to medium bin widths . divergences between rawgeno and genemapper can probably be explained by differences in algorithm settings. while rawgeno allowed the user to set both the "minimum" and the "maximum bin width", we suspect that the "bin width" parameter of genemapper might have effects similar to those of the "maximum bin width" parameter of rawgeno. decreasing the "maximum bin width" parameter can exaggerate the splitting of bins and, as a result, appropriately sized bins might be split into smaller and erroneous sub-bins. this bias is expected to produce datasets with a high number of low-quality bins . such a hypothesis is in accordance with the very high number of bins produced in gm_ <dig>  and gm_ <dig> for instance. holland et al.  <cit>  showed that, by using genemapper, choosing a bin width below  <dig>  bp was misleading since it resulted in oversplitting. we could however not obtain an absolute confirmation of this hypothesis since genemapper algorithms are strongly black-boxed.

divergences related to varying bin width parameters were also detected by the partial constrained correspondence analysis . this procedure inspected the residuals of the automatically scored datasets . it appeared that the residuals contained relevant information in several datasets . this was particularly true for genemapper datasets where the scoring algorithm outlined several additional biogeographic patterns . these patterns, however, were seldom interpretable since they segregated single populations from the rest of the samples and were identified neither by the manual scoring nor by rawgeno . we could however consider that the very high number of bins associated with these gm datasets  might have included such additional private alleles. finally, both oversplitting and technical homoplasy decreased the information content of residuals. this result was reinforced by an optimum bin width effect where only rg_ <dig>  from the rawgeno datasets and gm_ <dig> and gm_ <dig> from the genemapper datasets showed the highest residual information content, while technically biased datasets presented lower values.

error rates and optimality criteria
the previous statistics used the manually scored dataset as a reference. this strategy, however, might be misleading for several reasons. first, this reference point is not available when analysing a new dataset and second, manual scoring may introduce subjective biases  in the dataset. it is therefore clear that the evaluation of dataset quality requires a much more absolute criterion, such as error rates. however, the properties of the different estimators must be evaluated taking into account technical homoplasy and bin oversplitting. for instance, the mismatch error rate , defined by the number of mismatches between a sample and its replicate, divided by the number of bins , failed to unambiguously detect the oversplitting, while technical homoplasy was slightly detected . on one hand, oversplitting could not be detected by an increase of the mismatch error rate since it dramatically increased the number of bins. technical homoplasy, on the other hand, was hardly detected because it artificially decreased the number of mismatches between a sample and its replicate, leading to an underestimation of eb. similar results were described by holland et al.  <cit>  where the eb rate  was shown to be unable to discriminate datasets scored with varying bin sizes. as a result, we advise that the mismatch error rate should not be used to optimize the bin definition and the scoring of aflps. this criterion provided, however, valuable information when the number of bins remained similar among datasets. this situation was encountered, for instance, during further quality checking steps, such as fluorescence or bin reproducibility filtering. interestingly, the two bayesian error rates  detected both the oversplitting  and the technical homoplasy . these indices thus provided a valuable solution for optimizing the whole range of scoring parameters, including downstream filtering procedures as shown by whitlock et al.  <cit> . these statistics, however, required a large computational time and a quicker alternative may be desirable. we therefore propose the use of a new statistic, i.e. the information content per bin , as a quality criterion to optimize the first steps of aflp scoring . in our study, this statistic detected both the oversplitting and technical homoplasy. oversplitting increased the number of bins faster than the number of mismatches. in contrast, the technical homoplasy decreased the accuracy of the dataset at a faster rate than the number of bins decreased. maximizing the ibin represents an interesting trade-off between the accuracy of the dataset and the number of bins that are used to record the aflp information. we propose applying this criterion to optimize the bin definition, while the other quality criteria  can be used during downstream scoring steps. according to the ibin criterion, we assumed that rg_ <dig> and gm_ <dig> datasets had a reasonably good quality. this result was confirmed for rg_ <dig> by both the correlation to the manually scored dataset and the partial constrained correspondence analysis , while according to these same statistics, gm_ <dig> might perform better than gm_ <dig>  it bears repeating, however, that datasets scored with bin widths up to  <dig> bp probably included some level of technical homoplasy. the presence of stutter-bands  might contribute to this. the effect of this phenomenon on scoring could either produce rare alleles that led to the definition of non-informative bins or cause erroneous results when the range of the stutter bands extended into another bin . moreover, stutter-bands generally had a decreased fluorescence and their various peaks might not be reproducible. therefore, scoring parameters that considered a cluster of stutter-bands as a single allele probably handled the situation in a more appropriate way.

analysis sensitivity
biogeographic structure analyses were moderately affected by the scoring system . for instance, both inter-individual  and inter-population  distances provided comparable results from one scoring method to the other . additionally, these measures were also moderately affected by the scoring parameters in cases when technical homoplasy and oversplitting were avoided .

the psmix clustering analyses provided similar patterns . the spatial genetic structure of c. uniflorum seemed to be composed of five main phylogeographic regions . these regions were identified by the clustering analysis in the following order : meridional , oriental , cryptic , and finally occidental and central regions . interestingly, the automatically scored datasets showed much higher assignment probabilities to clusters than did the manual dataset . rawgeno and manual scoring provided congruent genetic structures while genemapper identified specific patterns that were difficult to interpret . these patterns also disrupted the clustering analyses and similar values of k may not provide converging results when comparing the three scoring methods. the main phylogeographic structures were observed when inspecting the entire set of clustering runs , although results were slightly influenced by the scoring algorithm. the scoring parameters were also important. the consequences of technical homoplasy ranged from a loss of discrimination power  for the datasets with moderate homoplasy , to erroneous results for the most biased ones . in this situation, coherent results could be observed only up to four groups  where the most evident phylogeographic regions were detected  while detailed groupings  were missing or identified at higher values of k . interestingly, and despite the relatively high number of bins , accuracy of clustering was not observed beyond five groups in datasets displaying moderate homoplasy, indicating that the additional bins of these datasets probably contained noisy information . this result also agreed with the ibin values that showed a decrease in the information content of these datasets.

in contrast to genetic structure patterns, population diversity indices were extremely sensitive to the scoring features since the estimated heterozygosity, the percentage of polymorphic loci and the rarity index showed important discrepancies among the datasets . interestingly, the percentage of polymorphic loci and the estimated heterozygosity were the most robust measures that we tested . detection of rare loci was more successful when the datasets were finely scored, but this statistic was particularly sensitive to the technical homoplasy . we explain these results as follows. first, the sampling scheme of our model species might not be robust enough  and in this context, estimates of genetic diversity might be strongly influenced by technical biases. second, scoring biases such as the oversplitting of bins or the technical homoplasy affected the definition of bins and the recording of presence/absence of alleles. as a consequence, statistics that relied directly on the polymorphic status of presence/absence of alleles,  were likely to be particularly sensitive to the dataset noise. as a result, scoring biases may have reinforced the problems caused by size homoplasy in estimating the genetic diversity  <cit> . this point raised the question of how to obtain reliable diversity estimates by using aflp datasets and the use of other indices, such as the proportion of different genotypes in a population , might provide more robust results. in contrast, synthetic statistics such as distance-based methods or clustering analyses probably buffered the technical noise with the rich signal of aflp and finally provided coherent results. similar observations were made in other studies  <cit>  where distance-based analyses proved to be robust regardless of the choice of the scoring algorithm and its settings. we also report convergent observations for gene flow detection  where f <dig> hybrids and introgressed individuals were detected accurately, regardless of moderate levels of technical homoplasy. finally, several steps that might help to eliminate unsatisfactory bins or peaks  were not applied in the present study. better results may be obtained by optimizing this specific aspect of the analysis. such filtering methods, as well as new tuning strategies, will be progressively implemented in rawgeno. in any case, however, we stress that users must carefully choose the parameters of the scoring algorithms to reflect the aim of the analysis.

CONCLUSIONS
scoring a dataset manually is a time consuming process that is complicated when investigating a large number of samples. using an automated system can significantly increase the reproducibility of the dataset as all the electropherograms are scored uniformly and as genotyping errors are limited to technical factors . our study showed that, with high quality aflp and genescan raw data, automated procedures can be particularly efficient in producing ready-to-use datasets, at least in the context of population genetic or phylogeographic studies . however, the automated scoring of aflps is a multiple-step process and a trade-off based on several quality criteria may be desirable since it might provide more relevant information than a single statistic. optimizing the parameters used in the scoring algorithm therefore represents one of the most important steps of the whole analysis. using rawgeno, we were able to evaluate the impact of technical homoplasy and bin oversplitting on optimality criteria and genetic structure patterns by intentionally biasing our starting datasets. interestingly, our results demonstrated that a high number of redundant and informative bins might overcome technical homoplasy due to scoring errors, at least when investigating biogeographic structures. while allowing for some plasticity during the optimization of the scoring procedure, this result also reinforces the use of the aflp methodology for its ability to produce highly informative datasets. by contrast, the estimation of genetic diversity may be considered with caution since scoring biases are likely to reinforce problems caused by size homoplasy.

finally, rawgeno provided results at least as accurate as those obtained by scoring the dataset manually  or by using a commercial software such as genemapper. to our knowledge, rawgeno is the only freely available program proposing a fully automated scoring solution, from electropherogram files to user-defined working binary matrices. benefiting from the open source r platform, rawgeno can be potentially enhanced and used by any user.

authors' contributions
na <dig> carried out the main design of the study, organized the package, programmed and debugged the r code, and drafted the manuscript. jwt, de and tg participated in the design of the study and programmed parts of the code. na <dig> participated in the main design and coordination of the study and helped to draft the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
detailed technical features of rawgeno. this document provides a description of scoring and bin filtering solutions proposed by rawgeno. in addition, it includes recommendations to achieve a proper scoring.

click here for file

 additional file 2
spatial genetic structures for all datasets. the graphics are displayed on an array where the lines represent the different datasets  and the columns display the different analyses. the three first columns contain the scatterplots of three genetic diversity indices . the values obtained by using the automatically scored datasets  are compared to those obtained with the manually scored dataset . the red line represents a linear regression between values obtained by both datasets . the next columns contain individual clustering results .

click here for file

 additional file 3
effect of the scoring parameters on diversity estimators. scatterplot of the number of bins , according to the mean homoplasy rate . the mean homoplasy rate  is defined as the average number of peaks belonging to the same individual that are affiliated within the same bin. the eleven datasets are displayed as dots  and as maps on the scatterplot. the maps represent c. uniflorum populations with circles. the radius of circles is a function of the measured diversity. a. percentage of polymorphic loci . b. estimated heterozygosity . c. rarity index .

click here for file

 acknowledgements
the authors would like to thank the intrabiodiv consortium for providing raw aflp datasets and particularly conny thiel-egenter for producing the genemapper outputs. they also warmly thank sarah kenyon, russell naisbit and three anonymous referees for providing valuable comments on earlier versions of the manuscript. rawgeno includes software developed by saic for the national cancer institute and by tommy gerdes for the rigshospitalet. roberto guadagnuolo, françois felber, celia bueno, sven buerki, michael stipe, thom yorke and anouk beguin provided helpful ideas and discussions; fabien fivaz and anthonny lehmann helped to code the graphical user interface. this study was funded by the national centre of competence in research  plant survival and by the swiss national science foundation .
