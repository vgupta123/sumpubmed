BACKGROUND
evolution involves both deterministic processes, such as selection, and random processes such as drift. when deterministic and stochastic processes are combined in the same model it is common to use the "diffusion approximation" – essentially assuming that populations are large , that population size is relatively stable, and that selection is weak  <cit> . the diffusion approximation is nearly always used when analytical  solutions are sought.

the diffusion approximation has yielded many important results concerning the interaction of deterministic and stochastic evolutionary processes. in particular, a number of different models have shown that the direction of evolution is influenced not only by the relative mean fitnesses of different strategies  but also by the variances in possible fitness values associated with each strategy  <cit> . if the variance in each individual's fitness distribution influences directional evolution, then it seems likely that other aspects of the fitness distribution  should do so as well. however, most of the models that have been studied have used methods  which make it difficult to see the effects of higher moments of the fitness distribution of an individual.

the most general  mathematical description of evolution that we currently have, the price equation  <cit> , does not easily accommodate stochastic evolutionary processes. the price equation is an exact description of the relation that must hold between the phenotype of parents, the fitness of parents, the difference between parents and offspring, and evolutionary change  <cit> . unfortunately, all of these parameters must be specified exactly. the price equation is thus exact only in hindsight, after reproduction has taken place and we know the precise value of each individual's fitness and the mean phenotype of its offspring.

despite this apparent limitation, the price equation has been used extensively to study social evolution  <cit> , the foundations of quantitative genetics  <cit> , and the analysis of multilevel selection  <cit>  as well as in other fields such as ecology  <cit> . since all of these fields also involve stochastic processes, it would be of value to have a theory with the generality of the price equation that does not require that all parameters are known exactly to begin with.

below, i present a general equation for directional evolutionary change that treats fitness and offspring phenotype as random variables, rather than numbers, but imposes no restrictions on the distributions associated with these random variables. this is essentially a stochastic version of the price equation, though it is derived independently and contains a term not found in price's formulation. this theory accommodates all processes that influence directional evolution, both deterministic and stochastic. using this result, i show that deterministic and stochastic processes interact in complex ways. one result is that stochastic variation in fitness amplifies the effects of selection in small or fluctuating populations. furthermore, the role of fitness variation within an individual is more complex than has generally been recognized. the well known tendency for populations to be pulled towards phenotypes with minimum variance in fitness turns out to be one instance of a more general rule that, all else held equal, populations are pulled towards phenotypes with minimum symmetrical variation in fitness, as measured by all of the even moments of an individual's fitness distribution. this process can actually cause the variance in fitness to increase . there is also a tendency for populations to be pulled towards phenotypes with maximum positive asymmetry in fitness . finally, this equation contains a term, capturing the direct effects of reproduction on offspring phenotype, that has no analog in the price equation.

RESULTS
in the following analysis, the fitness of an individual  measures the number of descendants that the individual has at some future time, potentially including the individual itself  <cit> . we consider a population of individuals that have not yet reproduced, and therefore treat fitness and offspring phenotype not as fixed values, but as random variables, each having a distribution of possible fitness values. the mean of an individual's fitness distribution, w^, is the number of descendants that the individual is expected to leave.

because each individual has a distribution of possible fitness values, the mean fitness in the population , which determines population growth rate, is also a random variable. if w¯ =  <dig> then the population goes extinct, and the change in mean phenotype is undefined. we thus define Ω= as the ratio of individual fitness to mean population fitness, conditional on the population not going extinct. throughout this discussion, x¯ refers to the average value of x in a population, and x^ refers to the expected value of random variable x.

the general equation
using the notation given in table  <dig>  the expected change in mean phenotype over some interval  is given by :

  Δϕ¯^=cov⁡+cov⁡i¯+δ¯^ 

this is essentially a stochastic version of price's theorem. note, though, that it contains a term that has no analog in price's formulation. this new term, cov⁡i¯, describes the population average of the covariance, within an individual, between the average phenotype of that individual's offspring  and the individual's contribution to population growth . this term does not appear in price's theorem because that equation treats offspring phenotype and fitness as parameters, rather than random variables . this is why price's theorem is exact only after reproduction has taken place.

we can write equation  <dig> in more familiar form by defining δ as the difference between the mean phenotype of an individual's offspring and that individual's own phenotype, then substituting ϕ + δ for ϕo, to yield:

  Δϕ¯^=cov⁡+cov⁡+cov⁡i¯+δ¯^ 

note that ϕ, the current phenotype of an individual, is not treated as a random variable. this is because, at whatever time we look at the system, ϕ already has a value for each individual. by contrast, w and δ are random variables because they concern future events and thus could have a range of possible values. terms in equation  <dig> containing δ concern processes, such as mutation and recombination, that cause offspring to, on average, differ from their parents. if we set δ =  <dig>  we are left with only cov, which is the change due only to differential survival and reproduction. this term corresponds to the "selection differential" term in the price equation  <cit> . however, we will see that because both individual fitness  and mean population fitness  are now random variables, the term cov now contains more than just selection.

because it is the expected value of the ratio of two correlated random variables, Ω^k  can behave in unexpected ways. in order to tease these apart, we can expand Ω^k to yield :

  Ω^k=w^kh+∑i=1∞iμi+1w¯^i+ <dig> 

here, h is the harmonic mean of the distribution of possible values of w¯, and μi+ <dig>  is the st mixed central moment of wk and w¯i. , is the covariance between individual fitness and mean population fitness). the value of the μi+ <dig> terms is determined by the source of random variation in fitness. we will consider two special cases: pure demographic stochasticity and random environmental change. for this discussion, we will set δ =  <dig>  which is equivalent to looking only at the "selection differential", s, which ignores mutation, recombination, and other processes that could cause offspring to not resemble their parents.

demographic stochasticity in a constant environment
even in an environment that seems constant to an outside observer, there will be variation in individual fitness values, even among individuals with the same phenotype. this variation corresponds to what is generally called demographic stochasticity, and it will be present in all populations  <cit> . pure demographic stochasticity is roughly equivalent to the "within-generation" component of variation discussed by gillespie  <cit> .

if the fitness values of different individuals are independent , and the environment does not change from generation to generation, then we can find the selection differential  by expanding cov. considering only the first three terms in the expansion, this yields:

  s^≈cov⁡h−cov⁡)nw¯^2+cov⁡)n2w¯^ <dig> 

here, n designates actual, rather than effective, population size. the three terms on the right-hand side of equation  <dig> each correspond to different directional evolutionary forces acting on the population. these are: 1) selection  term), 2) a force pulling the population towards phenotypes with minimum variance in fitness, and 3) a force pulling the population towards phenotypes with maximum positive skewness in fitness. the terms corresponding to higher moments of the distribution of fitness follow the same pattern; those containing even central moments are negative and those containing odd central moments are positive.

random environmental change
in addition to pure demographic stochasticity, the environment may change over time in ways that differentially affect different phenotypes . in this case, the expected fitness of individuals with a particular phenotype will itself vary over time, so the total fitness distribution of an individual will be a function of both the distribution of expected fitness values, given its phenotype, and the distribution of variation around this expected value due to demographic stochasticity. in such a case, we can write the fitness of individual i as wi = w˜i + si, where w˜i is the expected fitness in the current environment of individuals with the same phenotype as i, and si is the deviation of individual i from this expectation due to pure demographic stochasticity.

if we denote the frequency of phenotype ϕ in the population as fϕ, then in a very large population, the expected change in mean phenotype is approximated  by:

  s^≈cov⁡h−cov⁡)w¯^2+cov⁡)w¯^ <dig> 

equations  <dig> and  <dig> have the same form. the difference is that in equation  <dig> we are assuming that the fitness of each individual is independent of the fitness of every other individual, whereas in equation  <dig> we assume that the fitness values of all individuals with the same phenotype are correlated, since they are all influenced in the same way by the environment. for intermediate sized populations experiencing a varying environment, both var and var will enter the calculations .

discussion
equations  <dig> and  <dig> apply to any evolving system. these equations are based only on the assumption of a population of things that leave descendants and have measurable phenotypes, and they encompasses all factors, both deterministic and stochastic, that contribute to directional evolutionary change in a closed population. if we specify the exact population size in the next generation , and fix the value of δ for each individual, then equation  <dig> becomes equivalent to the price equation with fitness simply replaced by expected fitness, w^ <cit> . for simplicity, i will often refer to ancestors as "parents" and descendants as "offspring", with the understanding that the same equation applies regardless of the time interval over which we look. furthermore, the ancestors and descendants need not be the same type of biological unit. for sexually reproducing organisms, we can treat a mated pair as the ancestor and an individual offspring as a descendant, or an individual as the ancestor and a successful gamete as the descendant. descendants may also include the ancestors at a later time, allowing for overlapping generations.

the phenotype, ϕ, may be any measurable trait. this fact allows us to derive much of classical evolutionary theory from equation  <dig> simply by choosing the appropriate phenotype. for example, we can derive standard population genetic models for change in frequency of an allele, a, by defining the phenotype  of an individual as the frequency of a within that individual's genotype . defining ϕ in this way, ϕ¯ is equal to the frequency of the a allele in the population  <cit> , so equation  <dig> gives the change in allele frequency.

many  of the evolutionary processes that i discuss in the following sections appear because w¯ is a random variable. this is a biologically interesting case because demographic stochasticity – stochastic fluctuations in natural populations due to variation in individual reproduction – is ubiquitous in nature  <cit> . in most of the following discussion, i will focus on the special case in which the fitness values of different individuals within the same generation are independent. it is important to note that this does not preclude density dependent population regulation. for example, if all individuals in a population happen to produce more offspring than needed for replacement, then the population size will increase. in the next generation, though, the resulting increased competition may reduce the fitness of all descendants, preventing  further population increase. if this reduced fitness of descendants is manifest as reduced viability, then this is equivalent to the different "culling" processes discussed by gillespie  <cit> . in the case of "exact culling"  <cit> , the mean phenotype is unchanged by the culling process, so the changes in mean phenotype discussed here will occur even though the population does not increase over multiple generations.

it is of course possible for density dependence to involve a direct influence of one individual's reproduction on that of another. one example is the case of cavity nesting birds where the number of suitable cavities is fixed. in this case, the act of one pair locating a cavity directly reduces the probability that another pair will do so. in such cases, there will be a negative covariance between the fitness values of different individuals . this negative covariance will appear in the values of the μi+ <dig> terms in equation  <dig>  specifically, making no assumptions about independence of fitness values, μ2=1nvar⁡+n−1ncov⁡¯. the term cov⁡¯ is the average covariance between individual i's fitness and that of other members of the population.

the first term on the righthand side of equation  <dig>  cov, captures the contribution of differential survival and reproduction to directional evolutionary change. though this is traditionally called the "selection differential"  <cit> , the expansion of this term  shows that stochastic processes can contribute substantially to directional evolution, both in small populations and in populations subjected to random environmental variation. in this discussion, i will define "selection" as differential expected production of descendants that is causally determined by differences in phenotype. under this definition, some of the processes that contribute to cov are not kinds of selection. i will nonetheless continue to use "selection differential", designated s, because it is the standard term.

equations  <dig> and  <dig> show the expected selection differential for cases corresponding to different sources of fitness variation. the difference between these equations makes sense when we note that, in equation  <dig>  all individuals with the same phenotypic value have the same fitness in any particular generation. what matters is thus the frequencies of the different phenotypic values . this is also true in equation  <dig>  here, however, each individual's fitness is independent of that of all other individuals, so each individual is effectively its own "type", with frequency 1n. it thus makes sense that the powers of 1n in equation  <dig> are replaced, in equation  <dig> by powers of fϕ.

the expected selection differential is amplified by random variation in fitness
the first term on the righthand side of equation  <dig>  cov/h, shows that the magnitude of the expected selection differential increases with increasing variation in w¯. this follows from the fact that the term cov which captures the effects of selection, is divided by the harmonic mean of w¯, h. since the harmonic mean is disproportionately influenced by small values, h will tend to decrease as the variation in w¯ increases, as is expected in small populations or in a variable environment. equation  <dig> in the methods section shows how 1/h depends on variation in w¯.

to understand the biology behind this phenomenon, note that the selection differential is inversely proportional to mean population fitness ; it is thus disproportionately influenced by small values of w¯ . for a population of size n, w¯ is essentially the mean of a sample of n points drawn from the overall fitness distribution. in a very large population , the value of w¯ will nearly always be very close to the expected value, w¯^. by contrast, in a small population, there is a significant chance that w¯ will be much larger or much smaller than w¯^. since the small values have a disproportionate effect on the selection differential, the expected selection differential increases as population size decreases. the same thing occurs even in large populations if w¯ is uncertain due to random environmental fluctuations. in order to test this conclusion, i performed monte-carlo simulations, following a population over one generation, using the fitness distributions in fig. 1c. the mean change in ϕ¯, averaged over  <dig>  runs, is shown in fig. 1d. note that in this case, the expected change due to selection in a very small population can be substantially larger than would be expected from classical theory. in this example, the environment is held constant, so the amplification of the selection differential decays with increasing population size. if the variation in w¯ is a consequence of environmental variation that differentially affects different phenotypes, then we will see the same amplification in large populations as well. the "worked example" section in methods explains how to calculate 1/h from the individual fitness distributions.

though this phenomenon is not generally recognized in the literature, a special case can actually be derived from equations in gillespie's  <dig> paper  <cit>  and in proulx  <cit> .  = var and x¯≠y¯, using the notation of that paper. i am indebted to steve proulx for pointing this out). in this special case, the expected change increases with the variance in individual fitness values. in general, equations  <dig> and  <dig> show that all of the moments of the individual fitness distributions contribute to 1/h, and figure  <dig> shows that considering only the variance can easily underestimate the degree to which the effects of selection are amplified.

this phenomenon at first seems at odds with the theoretical  <cit>  and experimental  <cit>  studies that have suggested that the average long term response to selection increases with increasing n, resulting from the increased availability of genetic variation in larger populations  <cit> . the reason that this effect has been missed is that theoretical studies have treated w¯ as a fixed parameter . holding w¯ fixed means that Ω^=w^w¯, which is independent of population size . experimental studies have effectively done the same thing, by choosing the same number of individuals in each round of selection and by using truncation selection  <cit> , minimizing the variation in individual fitness. recent theoretical and empirical studies concerning the adaptive potential of small populations  <cit>  have considered the effects of population size only on genetic variation, assuming that the selection differential is independent of population size. the loss of heritable variation should indeed cause the long term response to selection to be reduced in small populations. over the short term, though, the amplification described here should facilitate a rapid adaptive response over the first few generations. such an amplified selection response could contribute to population differentiation in peripheral isolates.

the even-moment effect: populations are pulled towards phenotypes having minimum symmetrical variation in fitness
symmetrical spread about the mean of a distribution is measured by the even central moments. in the summation on the right-hand side of equation  <dig>  the terms containing even moments are all negative i = -1). the covariance between phenotype and these terms thus corresponds to the population being pulled towards phenotypes with minimal symmetrical variation. this is apparent in equations  <dig> and  <dig>  in which the term containing the variance  is negative.

this is illustrated in figs. 2a and 2b. the even-moment effect results from the fact that the fitness of individuals  with the most variable fitness covary most strongly with w¯ <cit> . when those individuals with high variation in fitness leave many descendants, the value of w¯ also tends to be high, reducing the magnitude of change. conversely, when those with high variation leave few descendants , w¯ tends to be low, increasing the magnitude of the decline . in a constant environment, this effect drops off with increasing population size, since the even moments of w¯ are all divided by increasing powers of 1/n. as with the amplification of selection differentials discussed above, though, the even-moment effect remains strong in large populations when variation in individual fitness is due largely to environmental variation.

the tendency of populations to be pulled towards phenotypes with low variance in fitness has been noted by many authors  <cit> . most of these studies used some form of the diffusion approximation, and thus assumed that higher moments could be ignored . equation  <dig> shows that, in fact, all even moments contribute to this phenomenon. to illustrate this, figure 2c shows a case in which the expected direction of evolution is towards the phenotype with the higher variance in fitness. the reason is that the fourth and higher even moments of the fitness distribution associated with the phenotype with higher variance are much smaller than those associated with the other phenotype. if the variation in fitness is due to pure demographic stochasticity alone, then in this example variance in fitness is expected to increase only in very small populations, since the fourth moment term will be divided by n <dig> and so will drop off quickly as n increases. on the other hand, if variation in fitness is primarily a result of environmental variation, then the fourth moment term will be multiplied by fϕ <dig> rather than 1n <dig>  so the higher moments may have an influence even in large populations, especially when the different phenotypes have similar frequencies.

the even-moment effect has sometimes been associated with the idea that selection acts on the geometric mean of individuals' fitness distributions.  <cit> . while geometric mean fitness is appropriate when fitness varies in a deterministic and predictable manner over time, it is not relevant in the case discussed here, where fitness is a random variable within a generation  <cit> . to illustrate this, fig. 2d shows a case in which the strategy with the lowest geometric mean fitness is the one that is expected to increase in frequency. instead, the direction of evolution is determined by Ω^. specifically, when Ω^i >  <dig>  the descendants of individual i are expected to comprise an increasing proportion of the population. though Ω^ resembles traditional "relative fitness", the fact that w¯ is a random variable that is correlated with w means that Ω^ does not scale like relative fitness . this is why it is possible to have Ω^0<Ω^ <dig> even if w^ <dig> > w^ <dig>  in which case the trait that is expected to increase in frequency is also the one that causes individuals possessing it to have the lowest expected reproductive output . the "expected relative fitness" discussed by lande  <cit>  is a special case of Ω^ . note that the term "relative fitness" is used in different ways in the literature. in some cases, relative fitness refers to the fitness of an individual  divided by mean population fitness   <cit> . in other cases, relative fitness refers to the fitness of one individual or phenotype divided by the fitness of another individual or phenotype . the exact reason that these two interpretations yield different results will be discussed elsewhere. for now, fig. 2d is sufficient to show that geometric mean fitness does not necessarily identify which strategy will increase. though the even moment effect is sometimes referred to as selection acting on variance, i argue below that the even-moment effect should not be treated as a kind of selection.

previous discussions of the even-moment effect have treated it as a function only of population size. however, equation  <dig> shows that this effect scales as 1/; it is thus amplified if w¯^ <  <dig>  meaning that the population is expected to decline in size. the pull towards phenotypes with minimum variance in fitness can thus be important even in larger populations if they are rapidly declining. the degree to which declining population size amplifies the even-moment effect will depend on how the variance  scales with the mean. in the extreme case in which the variance in fitness is independent of the mean, declining populations will be strongly influenced by the even-moment effect. as an example, consider a population of  <dig>  individuals that is declining such that the expected number of individuals in the next time interval is  <dig>  in this case, the strength of the force pulling the population towards phenotypes with minimum variance in fitness is the same as it would be in a stable population with the same variances in fitness and size n =  <dig>   if the fitness distributions are approximately poisson, then the variance will scale linearly with the mean and so dividing by w¯^ <dig> will still amplify the even-moment effect, though to a lesser degree.

the fact that declining populations may be particularly prone to the even-moment effect could have consequences for the probability of extinction. stochastic extinction – resulting from chance fluctuations in population growth rate – is a substantial threat to very small populations  <cit> . if a declining population shifts towards phenotypes that have minimum variance in fitness, then this could reduce the chance of stochastic extinction when the population becomes very small. further study will be necessary to determine if this phenomenon can significantly influence extinction probabilities.

the odd-moment effect: populations are pulled towards phenotypes with maximum positive asymmetry of fitness
this follows from the fact that the odd moment terms on the right-hand side of equation  <dig>  which measure asymmetry of the fitness distribution, are all positive. real fitness distributions will almost always be asymmetrical. this follows from the fact that individual fitness can not be less than zero but could possibly be very large, and that w^ will usually be close to  <dig> 

in the case of pure demographic stochasticity, the odd-moment effect will be noticeable only in very small populations, since the third moment term in equation  <dig> is divided by n <dig>  the fifth moment term by n <dig>  and so on. as with the even-moment effect discussed above, the odd-moment effect may be significant even in large populations when fitness variation is due to environmental fluctuations. for example, a phenotype that normally has moderate fitness but does much better than others during rare good years may show a long term increase that is greater than would be expected from the mean and variance of its fitness distribution.

note that the asymmetry that we are considering here is in the distribution of possible fitness values of an individual . this is quite different from the "asymmetric fitness function" often discussed in the evolutionary genetics literature  <cit> , which describes a case in which the plot of fitness as a function of phenotype is asymmetrical . it is also different from asymmetry in the distribution of breeding values, which has long been known to influence evolution  <cit> , as well as the asymmetry in the expected change under selection that appears in some diffusion models  <cit> . rather, the odd-moment effect is a directional evolutionary force that appears when different individuals have different degrees of asymmetry in their fitness distributions.

associations between offspring number and offspring phenotype
equation  <dig> contains two terms representing covariance between the degree to which offspring differ from their parents  and contribution to population growth . the first of these, cov, captures the degree to which the individuals that have the highest expected contribution to population growth are also those that produce offspring that deviate most from their parents. in this term, the covariance is over the entire population, and may result either from a direct causal influence of fitness on offspring phenotype, or any fortuitous association in which the phenotype that confers the highest value of Ω^ happens to also be associated with individuals who's offspring differ most  from their parents.

by contrast, the term covi measures the covariance within an individual between w and δ, meaning that if that individual produces more offspring than expected, then its offspring's phenotypes are expected to deviate more  from its own . this term will be nonzero when there is a direct connection between how many offspring an individual produces and the phenotypes of those offspring. one example of this would be a case in which, for any given individual, producing more offspring directly causes those offspring to be smaller. such "offspring-size/clutch-size tradeoffs"  <cit>  are expected in cases in which parents provision their offspring with limited resources, so producing more offspring necessitates giving fewer resources to each one. this term would also be nonzero in cases in which the offspring of a particular individual interact with one another in such a way that their development is influenced by how many siblings they have .

relation between selection and directional stochastic evolution
definition of selection
as mentioned above, i am defining selection as differential expected production of descendants that is causally influenced by variation in phenotype. under this definition, selection is captured by the term cov, assuming that the association is due to causal impacts of ϕ on w^. some researchers  define selection differently, as any process involving differential survival or reproduction that leads to a predictable change in allele frequency  <cit> . this definition runs into problems with processes like balancing selection, that do not lead to any directional change.

furthermore, defining selection as everything that leads to directional change effectively precludes it from being a specific evolutionary mechanism, since it is defined as the set of all mechanisms that produce a particular result. defining selection in this way makes it effectively synonymous with directional evolution.

by contrast, if we define selection as differential production of descendants  that is causally determined by variation in phenotype, then we have identified a particular class of mechanisms that will produce predictably different consequences under different conditions. balancing and stabilizing selection are easily accommodated by this definition.

these definitional issues have no bearing on the evolutionary importance of the processes discussed above. readers who prefer to define selection as anything that produces directional change may read the following section as a discussion of different components of selection.

directional stochastic effects
the even- and odd-moment effects discussed above result from the same random variation in individual reproduction that causes drift. to understand the relationship between directional stochastic evolution, drift, and selection, it is important to distinguish between two different factors that can produce directional change: 1) the relative probabilities of the mean phenotype increasing or decreasing, and 2) the expected magnitude of change in each direction . in the case of pure drift, these factors exactly cancel one another out – a higher probability of moving in one direction is exactly balanced by a larger step size in the other direction – leading to a net expected change of zero . drift is thus non-directional  = 0), but has a magnitude measured by the variance in Δϕ¯. drift can occur only if there is variation in the fitness distributions of individuals. as population size increases, the magnitude of drift decreases, approaching zero as n → ∞. 

directional stochastic effects behave like drift insomuch as they require that individuals have distributions of possible fitness values. however, the probability of moving in each direction and the expected step size in each direction do not cancel one another out. in a constant environment, the expected magnitude of change declines towards zero as n → ∞, as in the case of drift.

in the case of selection, there is both a higher probability of the mean phenotype changing in one direction and a larger expected step size in that direction. unlike drift and directional stochastic evolution, selection can take place even if there is no variation in any of the individual fitness distributions. as population size increases, the expected change due to selection decreases somewhat, but does not go to zero; instead asymptotically approaching the value cov⁡w¯^. furthermore, the probability of the population changing by this amount in the direction specified by selection approaches  <dig> as population size approaches infinity.

selection also differs from the directional stochastic terms in that it involves covariance between phenotype and the first raw  moment of the fitness distribution. by contrast, all of the directional stochastic terms involve central moments of w. also, the denominator in the first  term is the harmonic mean of w¯, ), whereas all subsequent terms involve dividing by powers of the expected value of w¯, .

consequences for adaptive landscape models
the concept a surface describing fitness as a function of a set of phenotypic traits , has a long history in evolutionary theory  <cit> , and variants of this idea have recently been presented as unifying concepts in evolutionary biology  <cit> . this is indeed an important kind of abstraction that both hones our intuition about evolution and allows us to visualize an important set of formal evolutionary models. the results presented above, though, show that thinking of evolution in terms of an adaptive landscape can also lead us to miss important evolutionary processes.

by its nature, an adaptive landscape treats w¯ as a number, rather than as a random variable . because of this, both the amplification of selection differentials and all directional stochastic evolutionary processes are eliminated from adaptive landscape models. even in a stable environment with frequency independent selection, directional stochastic effects could pull a population downhill on an adaptive landscape.

one possible way around this would be to to consider a surface of expected relative fitness, essentially plotting Ω^, rather than w^ or w¯^, as a function of phenotype  <cit> . however, equation  <dig> shows that Ω^ is itself a function of population size, meaning that such a landscape would change shape as n changes even if selection is not density dependent in the classical sense .

the more appropriate visual image would be an adaptive fog, with variable density and thickness corresponding to different fitness distributions for different phenotypes. the dynamics of evolution through such a fog are described by equations  <dig> and  <dig>  and are determined not only by the slope of expected mean fitness  but also by variations in the thickness of the fog and by population size ). unfortunately, this image lacks the visual simplicity of the adaptive landscape, which remains a very useful concept but should be recognized as an approximation based on the assumption that fitness values are fixed.

relation between equation  <dig> and the price equation
i refer to equation  <dig>  as a stochastic version of the price equation because it is derived in an analogous way. equations  <dig> and  <dig> are not, however, equivalent to the price equation and can not be derived directly from it ¯ can not be derived simply by treating w and δ as random variables in the price equation). the reason for this is that the price equation is derived by treating fitness and offspring phenotype as parameters, having numerical values, rather than as random variables, which have distributions. this is why the price equation is exact only in hindsight, when we know how many descendants each individual had and what their phenotypes are. .

we can, of course, apply the price equation to looking forward in time if we are willing to assume that expected fitness  can be used in place of the actual number of descendants that an individual will leave, and to further assume that we can predict the phenotypes of offspring. . however, the preceding discussion shows that considering only expected fitness  leads us to miss an entire class of evolutionary mechanisms.

how, then, is it possible for both equations  <dig> and the price equation to be exactly true given that they are different? any evolving system must satisfy both equation  <dig> and the price equation. however, if we focus on change over a particular generation, these equations are appropriate at different times. prior to reproduction, when fitness and offspring phenotype are not yet exactly determined, equations  <dig> and  <dig> are exact descriptors of the expected change over the coming generation. after reproduction has taken place, the price equation will, retrospectively, be an exact description of what just transpired.

the limitations of general theories in biology
equations  <dig> and  <dig> and price's equation are general in the sense that they apply exactly to any evolving system. note, though, that this does not mean that they answer all of our questions about evolution. two objections that are sometimes raised about the price equation  are that it is not dynamically sufficient  <cit> , and that it does not directly address some important evolutionary questions, such as the probability of fixation of an allele.

as discussed in the methods section , whether or not equation  <dig> can be iterated into the future  is determined by the kinds of phenotypes that we are studying and what assumptions we make about them . in the case of a population containing two distinct phenotypes , the entire distribution is uniquely defined by the mean. in such a case, we can iterate equation  <dig> through time with no further simplifying assumptions. if there are more than two phenotypes , then some further assumption, such as hardy-weinberg equilibrium, is necessary to achieve dynamic sufficiency. in the case of a continuous phenotypic trait, a simple way to make the model dynamically sufficient is to assume that the trait is normally distributed, meaning that we need only calculate the change in the mean and variance  <dig> for ϕ  <cit> ).

these are exactly the same assumptions that make models in population and quantitative genetics dynamically sufficient. thus, the general equations discussed here are no less dynamically sufficient than any of the standard models . the general equations simply apply to a much broader set of cases, some of which do not allow for a single, compact, dynamically sufficient equation  <cit> .

another criticism is that these equations describe only the change over a generation, which does not, by itself, answer some evolutionary questions. however, the change in mean phenotype  is one of the most basic pieces of formal evolutionary theory. in some fields, such as quantitative genetics, change in ϕ¯ is the primary quantity of interest. in other cases, such as evolutionary game theory, it is a key factor in evaluating the quantity of interest . in population genetics, change over a generation is sometimes the quantity of interest, and even when it is not , change in allele frequency is an essential part of the answer  in a diffusion equation). though the general models discussed here do not answer all of our questions, their value lies in their ability to generalize and unify special case models, and to give us insights into the mechanics of evolution that can be obscured by the assumptions necessary to predict the long term behavior of particular model systems.

CONCLUSIONS
the interplay of deterministic and stochastic processes is central to much of evolutionary theory. unfortunately, our most general mathematical description of evolution, the price equation, is not well suited to the study of stochasticity. this is because the price equation describes evolution exactly only after change has taken place, meaning that it contains no stochastic terms . a general stochastic evolution equation, derived in a similar way to the price equation but different in that fitness and offspring phenotype are treated as random variables, reveals a number of general rules about the interaction of deterministic and stochastic processes in evolution.

one result is that variation in mean population fitness, resulting either from small population size or environmental fluctuations, tends to amplify the effects of selection. this suggests that the adaptive potential of small populations may be greater than has been assumed. another result is that the well known tendency for populations to be pulled towards phenotypes with minimum variance in fitness turns out to be a special case of a general trend to minimize symmetric variation in fitness. this process can actually cause variance in fitness to increase, so long as higher even moments decrease. this even-moment effect is matched by an odd-moment effect, which tends to pull populations towards phenotypes with maximum positive asymmetry in fitness.

both the even- and odd-moment effects can drive a population to evolve towards phenotypes with lower expected fitness. this is consistent with  previous results showing that differential variance in fitness can drive directional evolution. it is not, however, consistent with the idea that geometric mean fitness determines the direction of evolution. instead, in cases of perfect heritability, the direction of evolution is determined by the expected value of individual fitness divided by mean population fitness , conditional on the population not going extinct. this confirms the importance of "expected relative fitness"  <cit> , when defined properly, as a determining factor in evolutionary dynamics.

finally, the general equations presented here contain a term capturing the direct influence of parental fitness on offspring phenotype. this term, which has no analog in the price equation, may be important in the many cases in which parents provision their offspring or in which individual development is influenced by interactions with siblings. this also illustrates the value of treating offspring phenotype, like fitness, as a random variable.

