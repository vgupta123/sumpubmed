BACKGROUND
metagenomics seeks to understand microbial communities by dna sequencing. deeper sequencing and better reference databases are advancing the potential and success of such analyses. while metagenomics provides information on the gene content of a microbial community, metatranscriptomics promises to reveal the actual metabolic activities of this community at a specific time and place, and how those activities change in response to environmental forces or biotic interactions.

a number of different systems and resources for metagenome or similar analysis, which are offered in the form of databases, web portals, web services and basic stand-alone programs  <cit> . these resources are mainly focused on the analysis of individual metagenomes and currently do not have the capacity for rapid and highly interactive comparison of multiple datasets. furthermore, many of these resources are suitable only for taxonomic analysis. in our experience, only the mg-rast web server  <cit>  currently provides a readily useable service for analyzing a new metagenomic dataset. however, while web portals are attractive because they offer large computational resources for data analysis, some scientists have concerns about uploading their unpublished data to a website. to address this problem of taxonomic analysis, the program megan  <cit>  was published in  <dig>  as the first stand-alone interactive tool for analyzing the taxonomic content of a dataset. a subsequent version of the program was developed that allows one to compare the taxonomic content of different datasets  <cit> . megan is easy to install and use, and requires only a blast output file as input to operate. the program is designed to allow both high-level analysis that summarizes data at different ranks of the ncbi taxonomy, and detailed analysis that drills down to individual reads and their blast matches. the goal of this paper is to describe new features of megan that allow the functional analysis of a microbial community. this type of analysis can assist in understanding biochemical processes or in estimating the influence of environmental changes on biospheres. the next major release of megan allows the functional analysis of metagenomic and metatranscriptomic datasets using the seed classification, based on the given blast file. for comparative purposes, one can simultaneously map multiple datasets onto the seed hierarchy and also compute distance matrices on datasets based on their seed content.

for the pathway analysis, the field of systems biology already possesses a high-quality database, namely the kyoto encyclopedia for genes and genomes   <cit> . megan provides a kegg analysis window that reports which kegg pathways are present in a dataset and allows one to then inspect these pathways; for example, megan can capture all reads that are mapped to a given pathway of interest.

RESULTS
seed analysis with megan
megan performs a taxonomic analysis of a dataset by mapping reads onto different taxa in the ncbi taxonomy, depending on the phylogenetic footprint of the gene that a read contains . the result is displayed as a rooted tree where the nodes represent the different taxa and are scaled and labeled by the number of reads assigned to the taxon.

now, as a new feature, megan uses the seed classification  <cit>  for functional analysis. in this classification, genes are assigned to functional roles and different functional roles are grouped into subsystems. the seed classification can be represented by a rooted tree where the internal nodes represent the different subsystems and where the leaves represent the functional roles. note that the tree is “multi-labeled” in the sense that different leaves may represent the same functional role, if a role occurs in different subsystems. the current seed tree has about  <dig>  nodes.

to perform a functional analysis, megan assigns each read to the functional role of the highest scoring gene in a blast comparison against a protein database. figure  <dig> shows a part of the functional analysis of a marine metagenome sample. the program reports the numbers of reads assigned to each functional role.

kegg analysis with megan
to perform a kegg analysis, megan attempts to match each read to a kegg orthology  accession number, using the best hit to a reference sequence for which a ko accession number is known. megan then calculates the number of hits to each kegg pathway and reports these numbers to the user. the user can request to see the hits to a given pathway and an appropriate image of the pathway is generated by coloring the pathways based on the kegg mapping. megan allows one to analyze several datasets together, using different colors to show which parts of a pathway are present in which datasets. because different genes that are present in different organisms in a consortium of microbes will often not operate together in a single pathway, megan allows one to restrict the pathway analysis to a set of one or more taxa in the ncbi taxonomy  <cit> .

comparing functional content of different datasets
megan supports the simultaneous analysis and comparison of the taxonomic content and now also the functional content of multiple datasets in several ways. the functional content of a set of metagenomes can be simulteniously opened and compared using a new seed-based tree view . furthermore a collection of datasets can be compared using six different ecological indices, the unifrac measure  <cit>  and different distance analysis techniques . as an example figure  <dig>  shows the comparison of eight bergen marine samples based on their functional content using goodall’s index. finally it is also possible to compare pathways present in multiple microbial communities using megan’s keggviewer. one can compare multiple datasets using different colors see figure  <dig> 

megan and mg-rast
a first comparison between megan and mg-rast was performed with a small subset of an flx-titanium pyrosequencing dataset  obtained from a hydrothermal vent microbial community. out of a total of  <dig> sequences, mg-rast assigned  <dig> functions and megan 727; the latter amounts to 88% of the assignments from mg-rast. figure  <dig> shows the comparison of assignments on the highest seed subsystem hierarchy. both tools assign a very similar number of sequences to most of the subsystems, although some subsystems vary by a factor of  <dig> or more.

in addition, we have tested our program on a published dataset . out of a total of  <dig>   <dig> sequences mg-rast assigned  <dig>   <dig> functions and megan  <dig>  748; here megan has more assignments. figure  <dig> shows the comparison of megan and mg-rast assignments for these data. in both cases, we see that the number of reads assigned to different subsystems by mg-rast and megan are very similar, but with some large differences. these differences are to be expected, as megan and mg-rast use different reference databases for their analysis. in the megan analysis, we used the march’ <dig> version of the ncbi-nr  protein database  <cit> , whereas mg-rast  used an expert-annotated, nr database build from all organisms curated in the seed.

for pathway analyses using kegg metabolic maps
we have performed pathway analyses for pooled dna samples from the plm-bergen datasets. to compare megan against mg-rast, we have concentrated on two different pathways, namely the ‘citrate cycle ’ and ‘photosynthesis’.

the citrate cycle : the citric acid cycle is of central importance for cells that use oxygen as part of cellular respiration. we compared the results for this cycle produced by both tools  using pooled dna samples from the plm-bergen datasets. the resulting pathway graphs  look very similar in both the cases when we consider only the presence or absence of enzymes. mg-rast only colors the enzyme nodes if they are present  in the pathways, but megan’s keggviewer is able to scale the color of the enzymes according to their read abundances . this color gradient can help in understanding the enzyme kinetics, as the abundance of reads assigned to an enzyme can be proportional to the turnover frequency  associated with that enzyme. if we assume that the tca cycle is the most prominent cycle of a cell, then all the enzymes are supposed to be present with some level of abundance. here, we can see some nodes  are absent in the mg-rast analysis, but are present with a very low read abundance in megan’s keggviewer.

photosynthesis: for all the datasets considered, for the photosynthesis kegg map, mg-rast only provides hits associated with ‘f-type atpase’, ‘cytochrome b6/f complex ’ and ‘photosynthetic electron transport ’. for example, using the four pooled dna samples from the plm-bergen datasets, the mg-rast server states that all the ‘f-type atpase’ enzymes are present . but with megan’s keggviewer we can also see the photosystem i or ii, ‘cytochrome b6/f complex ’ and reads associated with ‘photosynthetic electron transport  .

these results show the advantages of megan’s keggviewer for kegg-based functional analysis.

CONCLUSIONS
here we have presented the functional assignment module of megan. using two examples, we show that megan and seed obtain comparable results to mg-rast. with this new version of megan, researchers can perform a functional analysis using the seed classification. because megan performs this analysis directly from the blast input file, no additional calculations are required. thus, megan provides a stand-alone alternative to the mg-rast server. in future work, we plan to integrate megan into the mg-rast portal. this will bring together the highly interactive features of megan and the computational power of mg-rast together.

