BACKGROUND
in most cellular processes, proteins interact with other molecules to perform their biological functions. these interactions include the binding of ligands in receptor sites, the binding of antibodies to antigens, protein-dna interactions, and protein-protein interactions. shape complementarity has long been recognized as a major factor in these interactions  <cit> . the protein surface can form pockets, which are binding sites of small molecule ligands. the determination of pockets on protein surface is therefore a prerequisite for protein-ligand docking and an important step in structure-based drug design. in the last decade, many computational methods have been developed to predict and analyze protein-ligand binding sites. many such as pocket  <cit> , ligsite  <cit> , surfnet  <cit> , cast  <cit> , and pass  <cit>  use pure geometric characteristics and do not require any knowledge of the ligands.

one of the first methods, pocket  <cit> , introduced the idea of protein-solvent-protein events as key concept for the identification . the protein is mapped onto a 3d grid. a grid point is part of the protein if it is within  <dig> Å of an atom coordinate; otherwise it is solvent. next, the x, y, and z-axes are scanned for pockets, which are characterized as a sequence of grid points, which start and end with the label protein and a period of solvent grid points in between. these sequences are called protein-solvent-protein events. only grid points that exceed a threshold of protein-solvent-protein events are retained for the final pocket prediction. since the definition of a pocket in pocket is dependent on the angle of rotation of the protein relative to the axes, ligsite extends pocket by scanning along the four cubic diagonals in addition to the x, y and z directions. ligsite was originally tested on  <dig> receptor-ligand complexes of which  <dig> bind in the largest,  <dig> in the second largest, and  <dig> in the third largest predicted pocket.

to further improve these results, we introduce two extensions to ligsite: first, instead of capturing protein-solvent-protein events, we capture the more accurate surface-solvent-surface events using the protein's connolly surface  <cit> , and not the protein's atoms. we call this extension ligsitecs . second, we re-rank the pockets identified by the surface-solvent-surface events by the degree of conservation of the involved surface residues. we call this extension ligsitecsc .

three other approaches to pocket detection are surfnet, cast, and pass. in surfnet  <cit> , the key idea is that a sphere, which separates two atoms and which does not contain any atoms, defines a pocket . first, a sphere is placed so that the two given atoms are on opposite sides on the sphere's surface. if the sphere contains any other atoms, it is reduced in size until no more atoms are contained. only spheres, which are between a radius of  <dig> to  <dig> Å are kept. the result of this procedure is a number of separate groups of interpenetrating spheres, called gap regions, both inside the protein and on its surface, which correspond to the protein's cavities and clefts. surfnet was used to analyze  <dig> enzyme-ligand structures and the ligand is bound in the largest pockets in 83% of the cases  <cit> .

cast  <cit>  computes a triangulation  of the protein's surface atoms using alpha shapes  <cit> . in the next step, triangles are grouped by letting small triangle flow towards neighbouring larger triangles, which act as sinks. the pocket is then defined as collection of empty triangles. cast was tested on  <dig> of  <dig> enzyme-ligand complexes used for surfnet  <cit> . cast achieves a success rate of 74%.

pass  <cit>  uses probe spheres to fill cavities layer by layer . first, an initial coating of the protein with probe spheres is calculated. each probe has a burial count, which counts the number of atoms within  <dig> Å distance. only probes with count above a threshold are retained. this procedure is iterated until a layer produces no new buried probe spheres. then each probe is assigned a probe weight, which is proportional to the number of probe spheres in the vicinity and the extent to which they are buried. finally, a small number of active site points  are selected by identifying the central probes in regions that contain many spheres with high burial count. the final active site points are determined by cycling through the probes in descending order of probe weight, keeping only those above a threshold and farther than  <dig> Å apart from each other. finally, the retained active site points are ranked by probe weight.

besides the purely geometric methods above, there are methods, which take additional information into account to re-rank predictions. surfnet's predictions were refined by considering the degree of residue conservation in the pocket  <cit> . q-sitefinder  <cit>  uses the interaction energy between the protein and a simple van waals probe to locate energetically favorable binding sites.

the ultimate goal of ligand-binding sites prediction methods is to find active sites on uncharacterized structures. therefore, it is of great importance to test and validate the methods on sufficiently large data sets. to this end, we use  <dig> bound structures from the protein ligand database   <cit>  and  <dig> bound/unbound structures from  <cit>  and  <cit> .

implementation
algorithm
ligsitecsc is an extension of ligsite. instead of defining protein-solvent-protein events on the basis of atom coordinates, it uses the connolly surface and defines surface-solvent-surface events. the algorithm proceeds as follows: first, the protein is projected onto a 3d grid. in order to minimize the necessary grid size, we apply principal component analysis so that the principal axis of the protein aligns with the x-axis, the second principal axis with the y-axis and the third with the z-axis. for the grid we use a step size of  <dig>  Å. the rotation does not affect the quality of the results , it only minimizes the necessary grid size. second, grid points are labelled as protein, surface, or solvent using the following rules: a grid point is marked as protein if there is at least one atom within  <dig>  Å. next, the solvent excluded surface is calculated using the connolly algorithm  <cit>  and the surface vertices' coordinates are stored. in the connolly algorithm, a hypothetical probe sphere  rolls over the protein. the connolly surface is a combination of the van der waals surface of the protein and the probe spheres surface, if the probe is in contact with more than one atom. a grid point is marked as surface if a surface vertex is within  <dig>  Å. note, that the distance thresholds ensure that all surface grid points are also labelled as protein. all other grid points are marked as solvent. consider fig. 1a. a sequence of grid points, which starts and ends with surface grid points and which has solvent grid points in between, is called a surface-solvent-surface event. ligsitecsc scans the x, y, z directions and four cubic diagonals for such surface-solvent-surface events. if the number of surface-solvent-surface events of a solvent grid exceeds a minimal threshold , then this grid is marked as pocket. finally, all pocket grid points are clustered according to their spatial proximity. i.e. if a pocket grid point is within  <dig>  Å to a pocket grid point cluster, it is added to this cluster. otherwise, it becomes a new cluster. next, the clusters are ranked by the number of grid points in the cluster. the top three clusters are retained and their centers of mass are used to represent the predicted pocket sites. this first extension to the basic ligsite algorithm is called ligsitecs. for ligsitecsc, the top  <dig> pocket sites are re-ranked according to the degree of conservation of the involved surface residues. to be precise, the conservation score is the average conservation of all residues within a sphere of certain radius  of the center of mass of the cluster. the conservation score for each residue in a given protein is obtained from the consurf-hssp database  <cit> .

ligsite, pass, cast, surfnet implementations
in order to compare ligsitecsc to ligsite, ligsite is implemented as well and the same parameters are used in both methods. a cast pymol plugin was downloaded from cast.engr.uic.edu/cast/, pass executable binaries  were requested from its authors and the surfnet source code was obtained from .

datasets
to validate the binding site predictions we use two benchmark datasets of bound-only and bound/unbound structures. for the bound dataset, we use the protein ligand database pld  <cit> , which is the largest hand-curated database containing all the protein-ligand complex structures available in the pdb. currently, it has  <dig> protein ligand complexes . we removed redundant structures and selected those having conservation scores in the consurf-hssp database . the result is a set of  <dig> structures .

for a realistic evaluation, which takes into account flexibility of structures, we need bound and unbound structures. the predictions are made for the unbound structure and are checked against the bound structure.  <cit>  presented a large test set of  <dig> ligand-bound protein complexes. among these  <dig> structures,  <cit>  created a data set of  <dig> structurally distinct proteins, for which there are also unbound structures. additionally,  <cit>  created a data set of  <dig> bound/unbound protein structures. the structure 2er <dig> is ignored since no ligand is found in the current pdb entry. furthermore, there are five examples occurring in both data sets: 1stp, 2ypi, 1rbp, 1ifb, 3ptb and 5cpa. as a result, we have  <dig> bound/unbound structures on which we test ligsitecsc, ligsite, pass, cast and surfnet .

in  <dig>  cases, the five methods predict the same pockets as binding sites. fig.  <dig> on the left shows such an example. these pocket sites are spatially similar and they are all the biggest pockets corresponding to the ligand binding sites. fig.  <dig> on the right shows a case where all methods fail, since the binding site is nearly flat, so that the assumption that the ligand binds at a large pocket, does not hold.

to further validate the algorithms, ligsitecsc, ligsite, surfnet, and pass are tested on non-redundant bound structures of  <dig> protein-ligand complexes from the protein ligand database. cast is not evaluated since we only get a pymol plugin for it, which has to be used manually. as summarized in table  <dig>  ligsitecsc performs slightly better than the others and achieves an overall success rate of 75% for top  <dig> predictions.

the predicted pocket sites are classified into four classes following  <cit> : the ligand binding sites is the first, second, third largest pocket or none of these. table  <dig> shows the percentage for these four classes, as well as the average and the stadard deviation of the size of the pocket sizes in term of the number of pocket grid points. the goal of re-ranking by conservation is to bring hits found in the second and third largest pocket to rank  <dig>  the ratio of the largest pocket to the second largest for a given protein approximately indicates how unusually large the largest pocket is. for binding sites in the largest pocket the ratio is greater than for binding sites in the second and third largest pocket. to put it differently, if the largest pocket is significantly larger than the others, then it is likely the binding site, otherwise the other two pockets are likely, too. there are  <dig> cases in the fourth class that the ligand does not bind to any of the top  <dig> pocket sites . among these  <dig> structures, there are  <dig> cases that the ligan-binding site is around a small pocket and the ranking of this site in ligsitecs is behind  <dig>  ligsitecs fails to identify binding sites for the other  <dig> structures. however, among these  <dig> cases there are  <dig> proteins that the ligand-binding site is near the biggest pocket. ligsitecs can identify these pocket sites at the top  <dig> if the distance threshold is set to  <dig>  Å. the ligand-binding site is geometrical flat for only  <dig> cases . however, the binding site is more conserved than the rest of the surface except for  <dig> in these  <dig> cases. none of the geometrical methods can detect such flat binding sites.

the structures are prepared as follows: all solvent molecules including phosphate, sulphate and metal ions are ignored in the unbound structures. next, the bound and unbound structures are aligned using pymol  <cit> . note, that the choice of structural alignment algorithm is not significant, as nearly identical structures are aligned, which only differ in some conformational changes. after each tool predicts ligand binding sites the predictions have to be rated. this is a difficult task as the methods follow different approaches and use different evaluation methods. for example,  <cit>  measure the accuracy by the percentage of predicted pocket atoms that are in contact with the ligand. a protein and ligand atom are in contact if they are within a distance of the sum of the van der waals radii plus  <dig>  Å  <cit>  used a precision threshold for success in which at least 25% of probe sites in a single cluster are within  <dig>  Å to a ligand atom. alternatively, the success rate of predictions can be measured by computing the distance between the ligand and a single point representing the pocket  <cit> . to assess different methods on the same data set, we need a common criterion for success. therefore, we take a distance-based approach. for ligsitecsc and ligsite, this point is the geometric center of the pocket sites' grid points. in pass, the pockets are represented by its active site point ranked by their probe weight. in surfnet, the default "gaps.pdb" output file is a pdb-format file in which each gap region generated by surfnet is represented by a single atom record. each atom is located at the center of mass position of the corresponding gap region, and the atoms can be used to represent the predicted pocket sites ranked by their volume. cast defines atoms belonging to a pocket. the pocket can be represented by its center of mass. thus, for all methods we can define a single point which represents the predicted pocket and we can compute the distance of this point from the ligand. a prediction is a hit if it is within  <dig> Å to any atom of the ligand.

negative datasets
evaluating protein interactions is inherently difficult, as not all interactions are known. a positive dataset of true interactions as defined above cannot be assumed to be complete. negative datasets of experimentally confirmed non-interactions are not available  <cit> . therefore, researchers working on protein-protein interactions infer non-interactions from randomly selected pairs of proteins. such pairs are apriori unlikely – but not impossible – to interact. the likelihood that they do interact is low, as there is a quadratic number of pairs of proteins, while the number of truly interacting proteins is comparatively low.  <cit>  estimate e.g. only  <dig>  types of interactions in the light of an estimated  <dig> structural folds. a second approach to infer negative datasets, additionally requires that the protein pairs are in different cellular locations  <cit> . this additional requirement indeed ensures that they cannot possibly interact. while improving the quality of the data, this additional requirement introduces a bias in the negative dataset, as the protein pairs in different cellular locations are not representative of all pairs  <cit> .

to summarise, the definition of negative interaction datasets is difficult, but we can follow a similar approach for protein-ligand interactions as done for protein-protein interactions. we define two negative datasets: the first consists of  <dig> randomly selected surface patches. these patches are apriori unlikely – but not impossible – ligand binding sites. here, a surface patch consists of a randomly selected surface exposed cα and all cα atoms with  <dig> Å and  <dig> Å, respectively. for comparison, the area of a circle of these radii is  <dig> Å and  <dig> Å and the volume of a sphere of these radii is  <dig> Å and  <dig> Å, respectively. these values give a broad comparison to protein interface sizes ranging from small ones less than  <dig> Å to large ones greater than  <dig> Å.

the second negative dataset consists of  <dig> randomly selected hetero permanent protein-protein interaction interfaces. as the interface is used by a protein complexe it cannot be a ligand binding site. the permanent interactions were selected from the scoppi database  <cit> .

to determine whether our method predicts any of these negative surface patches, we consider a predicted ligand binding site to hit a surface patch, if at least 50% of the residues overlap. before we discuss the results of ligsitecsc on these negative datasets, we will discuss the results for all methods on the positive dataset.

RESULTS
conservation has been widely used for function site prediction  <cit>  and protein-protein interaction interface prediction  <cit> , combined with other physiochemical properties. here, we propose to re-rank the top  <dig> geometric-based prediction using the degree of conservation of the involved residues. as a result, we can improve the ranking for  <dig> out of  <dig> structures, which are hits of ligsitecs's top  <dig> predictions. ligsitecsc correctly ranks  <dig> out of these  <dig> as top  <dig> . fig.  <dig> shows a typical example that how conservation score improves the ranking for a kringle domain .

in ligsitecsc, there are four key parameters which influence the results, namely grid size, minimal number of surface-solvent-surface events , the radius of the sphere to calculate the conservation score and the distance threshold for defining hits . for grid size, we tested ligsitecsc using  <dig> ,  <dig> ,  <dig>  and  <dig>  Å. the success rates only vary - <dig> to + <dig> percentage for the  <dig> bound structures . although a smaller grid size leads to finer-grained pockets, the ranking is not affected. additionally, smaller grids leads to cubically increasing run-time. thus we choose  <dig>  Å. the surface-solvent-surface events  vary from  <dig>  to  <dig> . fig.  <dig> shows the success rates of ligsitecs for different minsss values on the  <dig> bound structures. the cutoff of  <dig> leads to the best results and is therefore chosen. scanning along nonetheless, scanning along  <dig> directions fails if the structure forms a ring . as mentioned earlier, at the second stage, the top  <dig> pocket sites are re-ranked by the average conservation score of residues with a sphere of radius  <dig> Å. this radius ensures a moderate size of patch within this sphere, which gives a reasonable average conservation score for re-ranking.

representing the pocket site as the mass center of grid clusters is somehow too simple for very large pockets. the ligand does not occupy the whole pocket sites and does not locate around the center of the pocket sites. also, the orientation of ligand and the shape of the pocket sites are very important for the assessment of predictions. fig. 6a shows a perfect prediction on carbonic anhydrase ii . in this case, the pocket sites cover all ligand atoms and the minimal distance between the mass center of this pocket and the ligand is  <dig>  Å. however, as shown in fig. 6b, on acetylchitotriose , only a small part of ligand atoms occupy the pocket sites. in fig. 6c, the ligand is very small comparing to the pocket site it locates on purine nucleoside phosphorylase . the minimal distance between them is  <dig>  Å, which is not counted as a hit . this phenomenon might be a reason why the success rates of surfnet here are lower than reported in  <cit> , which used a different hit definition. however, increasing the distance threshold does not improve the performance of ligsitecsc significantly . nevertheless, the advantage of representing pockets as a single point is that different methods can be assessed by the same criteria. moreover, rather than using the original grid points in the cluster, it is straightforward to extend this single point using a sphere of a certain radius.

finally, let us consider ligsitecsc's performance on the negative datasets. as described in the implementation section, we defined two negative datasets of surface patches, which are unlikely binding sites and hence serve as a negative control. i.e. ligsitecsc should not predict any of these sites as possible ligand binding sites. the first set consists of  <dig> randomly selected surface patches, for which we varied the radius between  <dig> and  <dig> Å. ligsitecsc misclassifies 8%  and 23% . the range from 8% to 23% is not surprising as the volume of a sphere doubles as its radius changes from  <dig> to  <dig> Å.

the second negative dataset consists of  <dig> permanent protein complex interfaces. ligsitecsc misclassifies 13% as predicted ligand binding sites. these results are in line with  <cit> , who analysed pockets involved in protein-protein and protein-ligand interactions and found that there are fundamental differences including conservation. thus, ligsitecsc achieve reasonable results on the negative controls, further strengthening the positive results discussed above.

CONCLUSIONS
in the last decade, many computational methods have been developed to identify pockets on protein surfaces and to analyze the relationship between the pockets and ligand-binding sites. most of them are purely geometric and do not require any knowledge of the ligands. however, there is no comparison between these methods. in this paper, we propose a method called ligsitecsc, which extends ligsite  <cit>  by defining surface-solvent-surface events and ranking them by the degree of conservation  <cit> . we compare ligsitecsc to ligsite, pass, surfnet, and cast on a dataset of  <dig> unbound/bound and  <dig> bound-only protein-ligand complexes using the same evaluation criteria. on the unbound/bound complexes, the methods predict the same correct ligand-binding sites in  <dig> out of  <dig> cases. overall, ligsitecsc performs slightly better than the other approaches and correctly predicts the ligand binding site in 71% and 75% cases, respectively.

availability and requirements
ligsitecsc is online at scoppi.biotec.tu-dresden.de/pocket. users can submit pdb files or enter a pdb id and specify the chain id. the parameters can be adjusted by the user. it returns the pocket sites in a standard pdb file format and a python script for visualization of pockets using pymol  <cit>  as well. ligsitecsc and ligsite are both implemented in c++ using the ball  <cit>  library. ligsitecsc's c++ source code is freely available for academic users from the web site, and as additional file  <dig> in compliment to this manuscript.

authors' contributions
bh carried out the research and drafted the manuscript. ms guided the research and revised the manuscript.

