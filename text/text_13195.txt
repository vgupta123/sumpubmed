BACKGROUND
over the hundreds of years of biochemical research, humanity has encountered myriads of chemical entities with countless combinations of functional groups that imparted upon their bearers distinct reactivities and properties. according to the structure-activity relationship  principle, grouping these entities into structure- and property-based classes within a larger chemical ontology  can enable the recapitulation of or improvements in the prediction of their biological functionality and chemical reactivity patterns, thus providing indispensable assistance in understanding the molecular nature of metabolism, toxicity, and bioactivity  <cit> . in addition to this, the assignment of individual chemical entities to a given class within a chemical ontology or hierarchy may facilitate the inference of the potential anticipated roles and properties of these entities. this capacity of chemical ontologies may help support the development of the rising systems sciences, such as chemogenomics and systems chemistry  <cit> .

despite the numerous efforts to develop automated chemical classification and ontology construction approaches , this process has so far practically remained firmly within the hands of human curators, as exemplified by perhaps the largest chemical ontology constructed to date - the chemical entities of biological interest  database and ontology  <cit> . as more chemical data becomes readily available from large-scale experimentation, chebi and numerous similar repositories of biological and chemical information  are increasingly coming under strain due to lack of human curators, the overwhelming wealth and diversity of the new chemical information, and the boundlessness of the chemical space. clearly, a means to automate and facilitate these classification efforts is urgently needed if we desire to understand, expose, and integrate the entirety of available chemical information.

manual chemical classification efforts frequently involve the tedious work of multiple human experts who carefully peruse the relevant chemical literature to gain competence in assigning chemical entities to a range of classes. although the reliance of biochemical activity-based classification efforts on the predictions or informed estimates of human experts has been largely relegated to the informal or speculative domain of scientific communications thanks to the development of numerous quantitative structure-activity relationship  elucidation approaches  <cit> , chemical hierarchy construction is still very much a human-dominated domain. chemical hierarchies in common use, such as chebi and the medical subject headings  organic chemistry hierarchy  <cit> , are structure-based but often have the capacity to incorporate chemical classes that are based on functional chemical attributes, such as those bearing a certain pharmaceutical activity . although structure- and function-based classification schemes involve somewhat different approaches for construction, the basic accepted sar dogma is that chemical structure and chemical function are inseparably linked, as noted earlier. therefore, structure-based classification efforts could be useful in initiating the construction of predictive models of small molecule bioactivity.

the correlation and overlap between chemical topology-based and biological function-based chemical hierarchies is expected since much of biological activity is enacted through interactions and transformations that are specific to a particular set of structural features of small molecules. for instance, most enzymes operate on a very limited set of chemical structures: carbonyl reductases, operate on carbonyl and alcohol functional groups while bacterial transpeptidases bind to and operate upon structures that resemble the peptide bond, leading to the potency of beta lactam-based drugs in the inhibition of their operation. while there may be more than one 2d chemical structure that results in an interaction with a given enzyme , we claim that there is a finite set of 2d chemical skeletons that result in a bioactive interaction, and that given a sufficiently large dataset of compounds known to be bioactive, it is possible to characterize a class of functionally active compounds as a collection of classes with well-defined, consistent structural features. concerns for the predictive capacity of such classifications, like the distinction between stereoisomers and a range of chemical properties such as molecular volume that may result in disqualifying an otherwise well-suited 2d skeleton from a bioactivity-inducing interaction can be laid to rest by explicitly incorporating these features into class definition. in this work, we demonstrate that given the logical expressivity afforded by the web ontology language   <cit> , we can automatically create formal logical definitions for a range of topology and property-based chemical classes which can then self-assemble into a chemical ontology.

while manual literature searching and experimental data analysis is often involved in the classification of chemical entities into functional classes, structure-based hierarchy construction is much more well-defined and easily amenable to automation. in constructing structure-based chemical classes, a modern curator would familiarize themselves with any existing informal class definitions, as well as any known chemical class members. based on this expertise, the curator would then define a class, create a short textual or pictorial description of this class, and add child/parent relationships to the other classes, as well as including several representative entities. in essence, this approach requires the resulting ontology to consist of a formalisation of expert domain knowledge in the area, while providing no means for this knowledge to be captured in a machine-understandable format. the result of this is a lack of facile re-use of the work of human curators in classification and annotation of novel entities and establishing child/parent relationships for newly added classes when the ontology grows or is modified. unfortunately, the majority of chemical ontologies, such as chebi database and ontology, mesh chemical classifications, and lipidmaps  <cit> , suffer from this, resulting in artificial discipline-specific barriers to research, since none of these can be easily or automatically integrated. as the chemical ontologies grow in size and the range of relationships covered, manual ontology development becomes increasingly difficult due to the multiplying number of consistency checks that have to be performed for each new class and relationship added.

to date, automated chemical classification has mostly belonged to the domain of qsar studies which involve the characterization of a training set of chemical entities with respect to a particular set of computable or measurable molecular features, as well as the property of interest, such as biochemical activity or biomedical potency  <cit> . the features that are used for training are often selected such that the cost of their acquisition is significantly lower than that of the modelled property. this feature set is then used to construct a predictive model using one of many available mathematical procedures, including the creation of decision trees  <cit> , multidimensional parametric fits  <cit> , or three-dimensional pharmacophore models  <cit> , to name a few. the resultant models are then verified for their capacity to adequately classify molecules into a range of classes of interest using a test set of compounds not used in model creation. while the resultant models may often achieve a great degree of accuracy, the vast majority of such models are not readily amenable to human understanding or automated incorporation into a chemical hierarchy. in order to fully appreciate the structural and physicochemical molecular features of relevance to a particular functional or structural classification, post-processing of the resultant mathematical models is often required. although we have recently demonstrated the conversion of decision tree-based qsar models into formally axiomatized owl chemical ontologies  <cit> , the problem of integration of disparate, problem-specific functional chemical classifications into a single chemical ontology is still largely unsolved. compounding this problem is the fact that chemical class definitions derived using statistical machine learning approaches are often inherently probabilistic - that is, no class membership requirement is formally stated as a necessary or sufficient condition. in order to derive a truly self-organizing chemical ontology, a deterministic classification in terms of well-defined features and their combinations is necessary.

while function-based chemical hierarchy construction has not been adequately addressed, methods to generate structure-based chemical ontologies have been studied in the past to some extent. for example in  <cit> , a very early attempt at formalizing chemical classes and their relationships for chemical inference has been carried out, but never practically implemented for any large-scale classification exercise. in  <cit> , a chemical ontology has been manually constructed with classes formally defined as containing molecules that possessed a particular functional group or a set of functional groups. while this work has been successfully applied for practical chemical functionality analysis through chemical semantic similarity identification enrichment, the basic ontology construction still followed a manual process and was limited to a set of pre-defined functional groups, insufficient for characterizing a number of more complex chemical classes. furthermore, the lack of a formal, accessible framework for chemical classification  has resulted in limited logical chemical class axiom expressivity, therefore limiting the applicability of the approach for characterizing some chemical classes . finally, the work of  <cit>  has resulted in a structure-based chemical ontology that employed combinations of chemical substructures of increasing complexity to produce increasingly specialized chemical classes, with the aim of improving the structural analysis and pattern identification in sets of biologically active compounds.

unfortunately, a framework or approach for fully automated construction of chemical ontologies has never been achieved. in this work, we propose a radically novel approach for structure-based chemical classification automation by abstracting and automating the majority of chemical curation to construct machine- and human-understandable, formally axiomatized chemical class definitions in owl. further, we use these automatically generated chemical classes to enable machine reasoning over the ontology and demonstrate ontology self-organization, as well as classification of individual chemical entities represented using the chemical entity semantic specification formalism  <cit> . finally, we demonstrate that certain functionally-relevant classes can be defined unambiguously using our approach, and integrated into the overall chemical ontology seamlessly.

RESULTS
we have reduced the activity of a human curator to several steps, namely a) the identification of high-confidence chemical class members, b) identification of consensus chemical patterns that have to be present in a given compound to qualify for membership in a given class, c) creation of formal chemical class definition axioms, and d) chemical classification and class relationship assignments based on the acquired expertise . the ontology that we aim to generate with the framework we have developed is primarily based on, but not limited to, chemical structure. we operate on the premise that chemical class sub-specialization is enabled through chemical structure extension. we claim that for each class, a collection of functional groups exist that are necessary for a molecule to be considered a member of this class. this forms the basis for the self-organization of our automatically generated chemical ontologies.

automated derivation of formal chemical class definitions
given a set of chemical entities known to be members of a given chemical class, our framework is capable of abstracting and generalizing a set of consensus molecular sub-graphs and features that are present in all representative members of this class . in identifying such features, we consider not only the chemical graph that is formed by the overlap of several smallest class representatives, but also the chemical sub-graphs formed by the fragmentation of class members, and atomic features, such as ring membership, aromaticity, and connectivity. therefore, we generate a set of both, canonicalized smiles  <cit>  and canonicalized smarts  <cit>  patterns  that are present in a given molecule. canonicalization of smiles and smarts patterns is important because the fragmentation of chemical structures and their generalized forms often yields chemical patterns that are equivalent, but can be written down as valid smiles or smarts in multiple ways. canonicalization of consensus patterns ensures that each pattern has exactly one definition, thus allowing for facile integration and comparison of consensus fingerprints from multiple class definition generation procedures.

the defining features, or chemical structural motifs, that are present in every member of a given class are deemed to be necessary for class membership and are termed consensus chemical features and their collection may be viewed to constitute a consensus chemical fingerprint for a given chemical class. the consensus chemical features that contain but are not contained in other consensus chemical features are termed by us principal characteristic substructures. these substructures can be used directly by curators for quick validation of the automatically generated class definition. for instance, for the chebi peptide class , one would expect the principal characteristic substructure to constitute the amino acid backbone , which is indeed the case.

in the process of determining principal characteristic substructures, we have identified certain classes for which our algorithm could not converge on an expected substructure set. surprisingly, this was observed for carboxylic acid esters, where only the pattern associated with a carboxylic acid, but without extension to create an ester was found. upon closer investigation, we have discovered that these difficulties in convergence were exclusively due to errors in the manual curation of input data. in the case of carboxylic acid esters, the failure of convergence was due to the inclusion of a molecule containing rconr pattern instead of the rcocr pattern in the training set. technically, carboxylic acid esters conform to a pattern rcor', where both, r and r' are aryls or alkyls  <cit> , meaning that the inclusion of the nitrogen-linked ester derivative was erroneous. this was a very fortunate development, since this identified one possible method to verify the consistency and correctness of human curators.

our second premise is that for one class to be considered a child class of another chemical class, it has to contain all the consensus structural features of the parent class, and some additional features specific to it only . therefore, while the principal characteristic substructures will be useful in establishing the unique structural identity of a given class, the rest of consensus structural features are useful in establishing the class hierarchy . this basic premise applies to both, simple consensus structural fingerprints, and the formal logical definitions of chemical classes and forms the foundation of the self-organizing nature of the chemical ontology generated by our framework.

the next step in self-organizing chemical ontology generation is the formalization of chemical class definitions based on the consensus structural fingerprints. for this, we generate and maintain a single owl ontology that is constantly updated with the unique consensus chemical substructures that are identified as a result of class analysis, using previously reported principles of unique, canonical, and invariable uris for each functional group class  <cit> . the functional groups defined in this ontology are then used in converting the consensus structural fingerprints. for instance, a class of 'organic alcohols' is found to contain the consensus structural features expressed in smarts notation as  ,  ,  , and  . this can be translated into the following equivalent class statement in owl using the manchester dl query syntax  <cit> , which states that an instance of the class of organic alcohols is exactly defined by being an instance of a molecular entity and having at least one  instance of each of the four functional groups:

'organic alcohols'

equivalentto

'molecular entity'

and 'has part' some ''

and 'has part' some ''

and 'has part' some ''

and 'has part' some ''

clearly, this specification is human-readable, and can be further enriched by adding annotations on the functional groups involved, including graphical representations or textual descriptions for the various functional groups, in order to facilitate chemical class definition understanding.

further, if one wishes to handle cases where more expressive logical statements are necessary, this is always an option. consider, for example, the class of glycols , which require the presence of a minimum of two alcohol functional groups in a given molecule. please note that we state that diols contain at least two alcohol functional groups, since in our approach, triols should be identified as simply a subclass of diols. the cardinality restriction to at least two alcohol functional groups allows for this. thus, diols can be defined as follows. please also note that cardinality is not currently screened for by the framework proposed here and all the cardinality restrictions in our automatically generated ontologies were added manually.

diols

equivalentto

'molecular entity'

and 'has part' some ''

and 'has part' some ''

and 'has part' some ''

and 'has part' min  <dig> ''

attributes and molecular descriptors can also be handled with such definitions. for instance, we may find out that a given enzyme catalyzes the oxidation of organic alcohols that are no heavier than  <dig> daltons. this mixing of chemical sub-graphs and physicochemical attributes is also possible, using the principles and concepts defined in the cheminf ontology  <cit> .

'reactive diols'

equivalentto

'molecular entity'

and 'has part' some ''

and 'has part' some ''

and 'has part' some ''

and 'has part' min  <dig> ''

and 'has attribute' some 

using the dataset of diols annotated with their computed molecular weight with the concepts from the cheminf ontology, we were able to correctly identify that all  <dig> diols in the chebi training set for this class were indeed 'reactive diols' as per the logical definition above.

self-organizing chemical ontology
in order to test the integrative capacity and accuracy of our chemical classification framework, we have manually generated a dataset containing  <dig> chebi and  <dig> mesh chemical classes, for a total of  <dig> classes with at least  <dig> and at most  <dig> representatives in each chemical class. to demonstrate the self-organizing chemical ontology creation from a specific source, we have created a stand-alone self-organizing ontology for each, the chebi and the mesh data sets, containing the formal class definitions derived from consensus chemical fingerprints of each class . upon application of the pellet reasoner to classify these ontologies, we observed self-organization of the formally axiomatized chemical classes into chemical ontologies with a hierarchy . each child-parent inference was screened by a curator to identify that the automatically generated ontologies were consistent for both datasets. in this screening, we have considered the structural viewpoint - that is, it was permissible for ethylamines, for example, to be classified as the child class of methylamines, since an ethylamine constitutes a structural extension of a methylamine, and because the training sets obtained for these classes  included among methylamines chemical entities that were derivatized on the carbon atom that should have otherwise been terminal . while we do not make any claims with respect to the validity of this approach, we note that this sub-classification inference in our work mirrors the manually assigned sub-classification in the mesh hierarchy of organic chemicals.

because both ontologies were built using one central functional group ontology and the cheminf ontology for chemical descriptors, we were then able to trivially import the chebi ontology into the mesh ontology within protégé  <dig>   <cit>  by specifying direct chebi ontology import within the mesh ontology, and to apply the pellet machine reasoner  <cit>  to the resultant ontology to reconstitute a unified chemical ontology with  <dig> chemical classes . thus, for the first time, we were able to automatically and trivially integrate and re-use the manual curation efforts from multiple data sources in order to construct a single seamless chemical ontology. manual analysis of the class relationship inferences was carried out to ensure that the inferred chemical hierarchy was consistent and coherent from the viewpoint of chemical structure.

chemical classification accuracy
for a demonstration of chemical classification, we have randomly selected a set of  <dig> chemical entities and employed the integrated ontology in order to classify each individual compound. because each chemical entity could be classified into multiple classes, the number of class membership inferences  exceeded the number of tested chemical entities. within this dataset, 91% of chemical entities received inferences that exactly matched their annotation within the test set and additional  <dig> % were matched to classes consistent with their test set-assigned class. for example, if a compound was a member of the alcohols in the test set, but actually contained two oh groups, this compound was correctly identified as belonging to diols or glycols, without the explicit specification of its membership among the alcohols, even though this membership is implied.

overall,  <dig> % of the entity inferences were correct . most of the observed errors were in the classes that necessitated the definition of negations. for example, a carboxylic acid is a structural derivative of an alcohol, but is strictly speaking not one. from a structural perspective, classification of a carboxylic acid as an alcohol is not incorrect. however, from a classical organic chemistry viewpoint, this is an incorrect classification, and has been noted as such in this work. in addition to this, we have observed that identifying incorrect inferences in some cases led to facile identification of adjustment of the training sets to automatically generate a more accurate chemical entity description or suggested manual refinements to definitions . an additional table shows the classification results in more detail .

the direct inferences are class inferences that are identical to the annotations in the test set. correct inference counts include the direct inferences and inferences that were deemed correct by a curator. please note that a lack of direct inferences does not reflect an error - merely the presence of another class whose definition was a closer match for a given molecule than its original class. more than one inference was possible for a given molecule. percentages of total inferences for each class are given in brackets for each category.

the entire classification process for  <dig> compounds took  <dig> minutes and  <dig> seconds, running on a core i7- <dig> machine with 6gb of ram, executed serially, while the computational time to classify non-populated ontologies was negligible.

seamless integration of novel chemical classes: enzyme substrates
in order to demonstrate the flexibility and facile amenability of our ontology to the incorporation of novel chemical classes, and especially chemical classes of biological relevance, we have created a stand-alone class of chemical entities that are substrates to yeast alcohol dehydrogenase, using information in the brenda database  <cit> . because this data was experimentally derived and the reactions indicated were confirmed to occur in nature, no human curation  was necessary for the training set composed of  <dig> unique chemical entities. upon the repetition of the exercise described above with this chemical class, we have, unsurprisingly, discovered that the resultant class of yeast alcohol dehydrogenase substrates was a subclass of alcohols, with the added requirement of possessing an oxygen atom connected to one hydrogen atom and a non-aromatic carbon atom.

discussion
here, we have presented a radically streamlined framework and approach to chemical ontology construction based on explicit formal semantic specification of chemical classes and rooted in chemical graph analysis. by eliminating the manual assertion of ancestry relationships between the various chemical classes and instead emphasizing the adequate curation of the limited  training set of the starting chemical class representatives and the automatically generated logical class definitions, we have greatly simplified the work of human curators, thus potentially improving their productivity and making the annotation and classification of the rapidly multiplying chemical information more manageable.

one may argue that curators may also easily define chemical patterns in order to define a given chemical class instead of starting with identifying a diverse set of compounds that would then be used to automatically derive the relevant patterns. while this is indeed true, automated consensus chemical structure identification has numerous benefits, including the exhaustive identification of primitive structural features that are useful in constructing class hierarchies, as well as in the inherently objective identification of the structural patterns of interest. manual supplementation of class definitions is always possible, as we have shown with class customization, and is sometimes required, in cases where our algorithms cannot identify a consensus pattern despite the best efforts of the curators to include only valid structures in the training sets.

for example, classes that include much variability within the key structural elements may not be adequately characterized by our algorithm as it stands currently. for example, the iupac-recommended interpretation of the term 'ester' includes compounds that conform to coc  and coc patterns, among others  <cit> . if entities representing both of these patterns were grouped into a single training set, a single descriptive pattern would not be identified with our current algorithm, since there is variation on the central atom. in this case, a human curator's intervention may be necessary to include a pattern such as coc that describes both cases.

although this is a difficult problem to address, it is not unavoidable with future improvements to the consensus chemical pattern identification algorithms. for example, had we not considered the atomic ring membership property in the generation of our consensus chemical patterns, we would not have been able to adequately model the class of cyclic organic compounds. one approach around this would be to manually define a feature  and screen for this feature to identify whether it is a consensus chemical feature for a given class. another, much more labour-intensive approach would be to identify the cyclic organic compound sub-classes and explicitly enumerate them in the definition of this class, as follows.

'cyclic organic compounds'

equivalentto ' molecular entity' and 'has part' some cycle

'three-membered cycle' subclassof cycle

'five-membered cycle' subclassof cycle

fortunately, our algorithm currently identifies and screens for the presence of a number of ring features and abstracts chemical structures so as to include considerations for atoms' hydrogenation state , ring membership, aromaticity, general type , as well as combinations of these attributes. thus, the feature  is automatically identified by our algorithm by examining the chemical entities in the training set. in addition to this, we screen for  <dig> pre-defined patterns designed to capture the nuanced chemical class definitions, such as the general ester feature discussed above, and we screen each class with all the previously-generated consensus patterns in the other class definitions. this allows us to handle the definition of many more classes than just those with automatically generated consensus substructures, including, for example, bicyclic molecules, which are composed of two fused rings and are characterized, among other automatically identified features, with the manually pre-defined  smarts pattern, which defines any atom contained within two rings simultaneously.

while some cases can be handled automatically in principle, for some classes of compounds such as nanotubes  or polycyclic cages , manual curation is unavoidable, as we do not yet have the capacity to adequately characterize the requisite consensus chemical feature information in terms of smiles, smarts, or properties, but only some very complex logical expressions or expressions in some molecular query languages. this may potentially be handled automatically in the future by screening for the requisite higher-order chemical graph features and patterns using seamlessly integrated semantic web services with the sadi framework  <cit> , but is not handled by us at present.

another aspect that we would like to address in the future is the automated identification of consensus chemical feature values in order to investigate the handling of more biologically relevant chemical classes, as demonstrated for the 'reactive diols' class. while we have already demonstrated the learning and formal logical encoding of biological activity and toxicity decision trees, we have not yet connected that effort to structure-based classification. in addition to this, classes of biologically active compounds are rarely as well defined as they are for the alcohol dehydrogenase substrates. for instance, structurally distinct compounds may sometimes engage in a number of productive binding or interaction modes with the same enzyme. while such annotation is not our primary focus, we claim that each individual binding mode should be amenable to topology-based and consensus feature-based logical characterization as a sub-class of the broader enzyme substrate class. failing that, as we have demonstrated, the existing chemical graph-based class definitions can always be easily augmented with various chemical property and geometric characterization restrictions manually.

unfortunately, certain aspects of chemical class definition formulation are difficult to address in principle. of particular concern is the negation of chemical statements in some class definitions. for instance, some people may argue that fatty acids constitute a class of compounds that should not contain any rings, among other features. this negative relationship is rather difficult to capture with the proposed methodology, and in fact, the majority of cases where classification of small molecules was incorrect were due to the lack of automatically generated negations in the class definitions. to name just one example of the consequences of this behaviour, due to the lack of negation detection, esters are inferred to be a subclass of ethers. while it is possible to correct this manually by including statements regarding the necessity of the absence of certain structural features in the class definition for ethers, automatic identification of such structural features is still challenging. the difficulty here is not posed so much by the identification of the features that are consistently absent from every member of a given class, as it is by the identification of which of the numerous features identified as absent from every member of a class should truly be absent. of course, given a diverse enough training set for a given class, many of the chemical features would be eliminated from the list of forbidden features. however, one may never be entirely certain that the groups still on the list should indeed be forbidden in a given class, until all the possible class members have been included in the training set, thus defeating the purpose of automated classification.

the final aspect where human curation still has an edge is human-created, arbitrary or otherwise necessarily diverse groupings, such as is the case for vitamins and many natural products, or terms that refer to broad functional roles rather than chemical structure. certainly, this is still very much a domain of subjective human classification where humans are irreplaceable, and will likely never be wholly replaceable by automated and objective chemical classification approaches. thus, human involvement is necessary in our proposed mode of chemical ontology construction and refinement, but it is also more subtle, nuanced, and much more productive than it has ever been in any of the on-going chemical ontology construction efforts.

having discussed the limitations and caveats of the proposed framework as it currently stands, let us examine more closely what it enables. by providing chemical class definitions in a logical and objectively consistent manner, we have created a means by which chemical hierarchies can be seamlessly integrated and new, previously uncharacterized classes can be added without necessitating a manual review of the whole ontology structure. the process of annotation of chemical entities has been greatly simplified and reduced to merely chemically fingerprinting a molecule and importing its chess-encoded fingerprint for facile automated classification with machine reasoning agents, all of which can be done on-the-fly as the chemical entities are loaded into a given ontology.

finally, there is no further reason for compartmentalization and erection of artificial barriers between the ontologies derived by distinct chemical classification efforts. in principle, all chemical hierarchies can be fused into a single, consistent, and self-organized ontology, where chemical class equivalences and relationships are automatically inferred and reconciled. we have demonstrated this with the automatic integration of chemical classifications derived from multiple, independently-curated data sets, one using the mesh-annotated pubchem molecules, and one that relied on chebi small molecule annotations. previously, classification efforts in either manually created hierarchy stressed the manual establishment of explicit parent/child relationships between the various chemical classes, as well as potentially formulating a short description regarding what exactly went into deciding whether certain compounds should be annotated as members of a given class. in this regard, chebi is, beyond comparison, superior to the mesh classification, because unlike mesh it includes a programmatically examinable, formal ontology of chemical classes that can be queried for small molecule class membership. in addition to this, the chebi ontology is understandably includes many more terms and specific classes of biological interest.

unfortunately, neither of the two chemical ontologies currently has means for facile integration with each other, nor facile class extension and inclusion of previously uncharacterized chemical classes. for both ontologies, the precise location of novel class addition is performed using subjective human assessment and examination of the possible child and parent classes. when a decision is made for the location of the class in the context of the chemical hierarchy, no formal justification is provided for the decision, meaning that the location of the class is a subject to errors and interpretation. on the other hand, in the formally specified ontologies that we generate by screening the data that is already available with pubchem and chebi, every subclass inference is explainable logically and amenable to facile correction through corrections in formal chemical class definitions rather than an unexplainable reshuffling of the class relationships in the current ontologies. furthermore, the effort of adding a novel class into the ontology is limited to defining the class itself, rather than analyzing all the other existing classes for their potential role as parent classes or sub-classes of a given novel class. this is the principal reason for the ease of the integration of the mesh and chebi ontologies. to summarize, the principal benefits of our proposed approach are i) the ease of chemical class integration into existing hierarchies, ii) facilitated chemical class definition and characterization, and iii) logically explainable and therefore easily correctable chemical class hierarchy assignments. furthermore, to generate the hierarchies presented in this work, we have essentially re-used the previous work done by annotators on the chebi and mesh projects already, with slight screening modifications of the existing data sets. this gives hope that the existing chemical hierarchies can be somewhat easily converted into their logically encoded forms.

the automatically generated ontology that we present here also removes much subjectivity and ambiguity from chemical class assignments and annotation of individual small molecules. it is no longer necessary to manually adjust the annotation of every small molecule that needs to be classified. this is of critical importance as the chebi effort transitions to the classifications of hundreds of thousands compounds present in the chembl database, and the pubchem database experiences constant exponential growth of millions of new, partially characterized or completely uncharacterized compounds. the classification procedure for the novel small molecules presented here is highly accurate, and when each class is screened using a testing set, classification inconsistencies are highly visible and easily correctable. for example, the classes of alkadienes and diols necessitated cardinality restrictions in their formal definition to account for the fact that these classes required a given molecule to contain two alkene or two alcohol groups, respectively. upon screening these classes with a test set of known positives and known negatives, the misclassification of known negative compounds containing only one of these groups has alerted us to the omission of cardinality restriction in the definition of these classes. while we anticipate adding automatic cardinality restriction identification in future work, this feature is currently not implemented and appropriate class definitions had to be manually corrected. thus, awareness of the formal definition of these classes has alerted us to an omission in our work. on the other hand, there is no capacity or provision for explaining chemical classifications and annotations in the major chemical ontology building efforts, which means that any errors in chemical entity annotation assignment have to be manually identified by the users of these hierarchies, discussed by curators, and then manually corrected, in a further time-consuming endeavour. we shall reiterate: in the proposed framework, only class definitions need to ever be adjusted, while chemical entity classification is automatically inferred, and can be generated at will, for any arbitrary compound, and the chemical hierarchy is dynamically reconstructed.

we must note that the high degree of accuracy of automated small molecule classification is not surprising since we were operating on structurally-derived classes and we have performed a nearly exhaustive characterization of chemical structure to identify unambiguous, deterministic class definitions. this is in sharp contrast with the inherently probabilistic, 'black box' training approaches based on artificial neural networks or support vector machines, where features of chemical entities in a given training set are incorporated into  mathematical expressions which are expected to be correct only a fraction of time, and due to the statistical nature of these approaches may involve chemical features that may have little to do with the proper classification of a given compound into a given class, in reality. our task is very much simplified, as we do not concern ourselves with chemical features that only appear in a fraction of compounds within a given class, but rather admit to class definition only the consensus features.

CONCLUSIONS
based on our own experiences in constructing the chemical hierarchies presented here, we envision a new iterative approach to chemical ontology development . in this scheme, curators are primarily concerned with the assimilation of a representative set of chemical entities for each chemical class based on whether the desired principal chemical substructures for a given class have been identified. manual adjustment of some class definitions and adjustment of other definitions to explicitly include disparate classes that may contain a set of well-defined, but disparate and non-overlapping sub-classes may also be performed. however, explicit specification of class membership or chemical ontology hierarchy is possible but not recommended in this approach to maintain the self-organizing and objective nature of the chemical hierarchy.

with the rising of systems sciences to prominence, we believe that chemical annotation and classification frameworks, such as the one presented here, shall increasingly rise in prominence and importance. the already impressive collection of chemical data on the semantic web and its fruitful applications in chemical research suggest that semantically enabled chemical classification systems are of immediate applicability and importance. furthermore, the ability to formally specify and exchange chemical class definitions can open new doors to collaboration in chemical and biological research, driving new innovations and discoveries.

