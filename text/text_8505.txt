BACKGROUND
the wealth of omics data being currently produced raises the need for efficient and flexible models to analyse these data. one typical objective is to understand which molecular changes affect gene expression levels or, if available, protein expression levels. molecular profiles reliably measured currently include dna methylation and copy number, sequence information including snp and loss-of-heterozigosity  information, as well as microrna expression levels. all these are known to be involved in gene expression regulation.

many methods have so far been proposed for finding associations between two omics data sets . these enable us to study for example which copy number changes affect gene expression levels, or alternatively which methylation changes affect gene expression, and to which extent they do so. such findings can for example shed light onto oncogenic mechanisms. one such method has been proposed by menezes et al.  <cit> , whereby a statistical test is used to for example assess the association between gene expression and the copy number of a genomic region around it. in that work, the authors showed the power gain to find associations yielded by considering sets of measurements, rather than considering only associations between pairs of features, as done elsewhere  <cit> .

methods have also been proposed for the joint analysis of microrna expression and mrna expression profiles. in this context, many micrornas can target the same mrna, and one microrna can target multiple mrnas. so it makes sense to consider target prediction information while looking for associations between mrna and microrna expression levels. van iterson et al.  <cit>  use the method proposed by menezes et al.  <cit> , with gene sets now defined by various target prediction tools. it is then shown that the method has power to find associations that are sucessfully validated, in spite of limited sample size. they also show that predicted associations using sets of features lead to more robust, and thus more reliable, results, in this case with a higher validation rate, than associations predicted using pairs of features . this is in agreement of findings from menezes et al.  <cit> . the extra robustness is brought in by the fact that the impact on small effects observed for specific genes must be observed for at least a considerable subset of genes, before they become significant.

with multiple types of molecular profiles measured, it makes sense to consider methods for analysing all of them together. only a few of the integrated analysis methods so far proposed have been extended to handling more than two data sets. methods proposed by waaijenborg et al.  <cit>  and by witten et al.  <cit>  use a sparse canonical correlation framework. as such, they are of an exploratory nature, aiming at finding sets of covariates from the various data sets which are most correlated.

here we extend the integrated analysis method proposed by menezes et al.  <cit>  to handle multiple high-dimensional data sets. the aim is to test for association between one type of molecular profile  and other types , the latter represented by sets of probes, rather than individual ones. under the null hypothesis, no association exists between mrna and either copy number or methylation, in our example. the use of sets makes for a robust and powerful method: robust, because noise originating from individual probes is ignored; and powerful, because subtle associations found between mrna and multiple methylation probes are detectable as the probability of seeing many of these small associations together by chance will be considered small, which would be ignored if they were considered separately. given the high-dimensionality of the problem, the fact that our method evaluates statistical significance is crucial to help separate noise from true associations. moreover, since our method uses a regression framework, it can take confounders into account. as the original method, it is thus a flexible, powerful and efficient method to analyse jointly many omics data sets.

this paper is organized as follows. in the “methods” section we present the statistical test for associations between a response and multiple gene sets. here we will refer to covariate sets instead of gene sets, essentially because sets may contain any set of variables, and need not refer to a gene. in the “results” section we illustrate the workings of our method under various types of associations between data sets with a simulation study. we also apply our method to sets of tcga samples:  <dig> of colon cancer and  <dig> of breast cancer, for which copy number, methylation and gene expression profiles are available.

methods
the integrated analysis model
menezes et al.  <cit>  have proposed using score tests to find associations between a response  and a set of covariates . let us represent by yni the expression for gene i, and by xnj the genomic copy number for gene j, where i= <dig> …,i and j= <dig> …,j represent the sets of probes used, and n= <dig> …,n indexes the sample. note that it is assumed that measurement sets {yi},{xj} are available per sample, although it is not necessary that both sets of probes correspond to the same loci. then we write, for any given i, 
  eyni=hα+∑j=1jβjxnj,n= <dig> …,n, 

where h is a given inverse link function and {βj}∼n, making model  a random-effects model. from now on, we consider observations yi for a single gene indexed by i, but we omit the index i for clarity.

the approach proposed by menezes et al.  <cit>  focuses not on fitting model  directly, but on testing whether or not the association between y and {xj} is statistically significant, for each gene expression probe y. this is done by making use of the global test  <cit> . in this framework, under the null hypothesis that y is not associated with the set {xj}, we have var=τ= <dig>  on the other hand, when y displays association with variables in {xj}, then some of the βj will be non-zero, and thus var> <dig>  specifically, the global test is a score test for the hypotheses 
 h0:var=0vs.ha:var≠ <dig>   first proposed by  <cit>  and later applied to the context of testing association between a molecular profile and a clinical variable by goeman et al.  <cit> . let us define rn=∑jβjxnj, the part of the linear predictor that depends on the data, r=t, and x an n×j matrix containing all observations for the covariates. then a statistic to test the hypotheses above was proposed by goeman et al.  <cit>  as 
  q∝txxtt, 

or in its standardized form 
  t=q−eqvarq. 

applying this test generates one p-value per gene expression variable y. for a set of gene expression probes {yi,i= <dig> …,i} a list of ip-values is obtained.

extension to two sets of covariates
assume now that a second set of covariates {zk} is observed, and there is interest in studying the association between both covariate sets and the response yi. now model  becomes 
  eyni=α+∑j=1jβjxnj+∑k=1kγkznk,n= <dig> …,n, 

where {βj}∼n and {γk}∼n, so that model  still is a random-effects model, and where we have assumed for simplicity that h=x. similarly to the single covariate-set case, under the null hypothesis no association exists between either y and {xj}, or y and {zk}. in this case, obviously the variances σ,τ of the random effects {βj},{γk} in  must be zero. on the other hand, under the alternative hypothesis, y displays association with either {xj} or {zk}, meaning that either one of the two random-effect variances σ,τ must be non-zero. thus, to test for association between each yi and the sets of variables {xj},{zk}, it is of interest to test the hypotheses 
 h0:var=var=0vs.ha:var≠0orvar≠ <dig> 

to derive the test statistic in this case, we first write the likelihood for {yi} as 
  l=er∏i=1ifiyi|ri,β,γ,σ,τ, 

with fi representing the density of yi, given the random effect ri=xiβ+ziγ, and it is assumed that cov=σi, cov=τi and cov= <dig>  using a taylor series, we can derive a first-order approximation for the term in the expectancy as: 
  ∏i=1ifi1+12∑i=1iσrii+τsiiui2+12∑i=1i∑j=1iσrij+τsijui1uj <dig>  

let us define θ=≡. by assuming that yi has a distribution belonging to the exponential family with canonical link, we obtain expressions for partial derivatives of the log-likelihood with respect to σ,τ. with some algebra, we get that the score vector u is proportional to 
  q−tr,q−tr, 

where r≡xxt and s≡zzt. from  <cit>  we know that e=tr and, similarly, e=tr. a detailed derivation is given in section  <dig> of the additional file  <dig>  thus, the score vector is formed by the centered and unscaled individual test statistics, for association between y and x,z separately. it then follows that a test statistic to test the hypothesis h0: σ=τ= <dig> can be obtained by using utu, leading to the expression 
  q−tr2+q−tr <dig>  

note that this is not the score test statistic, although it is derived from the score vector. this is similar to the suggestion in goeman et al.  <cit>  of using only centering while testing for association with a single set x. for simplicity, we may ignore the centering and the squaring, then write the unscaled test statistic for two covariate sets as 
  q≡q+q. 

it is interesting to note that, from , 
 q+q=txxt+zztt,  where xxt+zzt is the matrix in the quadratic form that would have been obtained if our model had a single set of covariates given by the merged set {x,z}, and with effect modelled by a single vector of random effects. in such a case, the design matrix would have been obtained by binding the columns of x and z together and, thus, the unscaled score test statistic would be given as above.

the same test statistic  could have been derived by taking σ=η∗τ, where η is a given constant, and deriving the test in terms of τ only. the choice of η is free but must be made a priori, each choice resulting in a test with different power properties. it is intuitive to see that this is possible, and that the derivation used here corresponds to choosing η= <dig>  by the equivalence to a test for association with a single set of covariates.

thus, a test statistic for two covariate sets can be obtained as the sum of the individual  test statistics per covariate set, as in . similarly for the unscaled and unsquared versions of the score test statistics, the test statistic for two covariate sets x and z is equivalent to the one obtained for a single covariate set formed by {x,z}.

in practice, some sort of centering and scaling of q,q may be used, especially when covariates take values in different ranges, are of very different sizes and/or display different variances. in such cases, centering and scaling can ensure the separate sets are given the correct weights in the combined test statistic q. this can be done by using the scaled individual test statistics as in . an alternative is given in section  <dig> of additional file  <dig> 

extension to more than two covariate sets
since the inner product of the score vector is equal to the sum of the squared and centered test statistics for the individual covariate sets, for any given number of covariate sets m, the test statistic  obtained for m= <dig> can be extended for any m. in particular it is straightforward to show that, if squaring and centering are ignored, the test statistic for any m number of covariate sets is the same one as generated by a model with a single covariate set, formed by merging all covariate sets together.

data correlation structure
we have seen that the unscaled and linear form of the test statistic  equals the test statistic for a single covariate set, formed by the union of all covariate sets into a single one, or q where w is a matrix formed by the columns of x,z bound together. as such, the test statistic proposed considers not only correlation between the covariates and the dependent variable y, but also pairwise correlations between covariate pairs, as shown by goeman et al.  <cit> , section  <dig>  in particular, this means that the test statistic will have most power in directions where {x,z} have the most variance, as well as display association with y. the specific directions where most power lies will depend on the correlation structure in the data. in the “results” section, we will illustrate in a simulation study how the power varies, considering correlation structures of practical interest.

test statistic null distribution
for testing, the distribution of txz <dig> under the null hypothesis of no association between y and x,z is needed. here we will consider the expression  for the combined test statistic. for the single-set testing, goeman et al.  <cit>  obtains an expression for the asymptotic distribution of q under a generalized linear model, which is the exact finite sample distribution under the linear model, as used here. this  null distribution can be written as a ratio of weighted sums of χ <dig> random variables  <cit> .

our test statistic  for two covariate sets x,z can be seen as a test statistic for a single covariate set resulting of the union of the two original sets. this means that the distributions derived in goeman et al.  <cit>  can be used for .

note that, in case of applying the test to many separate responses {yi}, such as expression levels of many different genes, the resulting computational burden of numerically estimating the distribution per response may be superior to computing p-values via permutation. in the cancer examples, we use permutations to compute p-values for q for computational ease, and use the sum of test statistics .

software
methods presented in this work are implemented in the bioconductor package sim, currently for a single covariate set, and in the short-term for multiple covariate sets. all computations described and applied in this work used r from at least version  <dig> . <dig> .

RESULTS
simulation study
setup
we run a simulation study to evaluate the power of the proposed test statistic under various types of effects. a detailed description of the entire study setup is given in section  <dig> of the additional file  <dig>  for completeness, here follows a brief description. the data here is assumed to consist of two explanatory sets of covariates, {xj,j= <dig> …,j} and {zk,k= <dig> …,k}, and a set of dependent variables {yi,i= <dig> …,i}.

we consider four independent data sets, each involving one set of variables {yi,xj,zk}, with i,j,k= <dig> …, <dig>  each data set can be seen as a  region, here assumed to involve one association type between the covariate sets and the dependent variable yi for i= <dig> …, <dig>  and no association for the remaining probes. the associations considered are: region i, where yi is associated with {xj} only, which we will refer to as “x only”; region ii, “additive”, where both covariate sets affect outcome linearly; region iii, “multiplicative”, where both covariate sets affect outcome linearly as well as multiplicatively; and region iv, “split-samples” or “complementary”, where {yi} depends upon {xj} for half of the samples, and for the other half {yi} depends upon {zk}. for each data set, three sample sizes are considered:  <dig>   <dig> and  <dig> samples.

within each region, we test for association between each yi and the covariate sets {xj},{zk} using the test statistic . here p-values are estimated by comparing the observed test statistic to values obtained after permuting the dependent variable samples  <dig> times, and re-computing the test statistics. for the aims of this particular study, which is to compare roc curves, no multiple testing is necessary.

in what follows, we introduce correlation between x and z in two different ways. firstly we define each entry in z as a linear function of the corresponding entry in x, with remaining entries uncorrelated. subsequently, we consider a more realistic framework by assigning empirical correlation structures to x,z. more details about the entire study setup are given in section  <dig> of the additional file  <dig> 

z is a function of x
here we assume that xj∼n for all j, with all xj independent, and zk≡xk+wk, with wk∼n, and wk⊥xk, for all k. for simplicity we assume that i=j=k. the relationship between xj and zk implies that var=var+var and cor={var/}1/ <dig>  the amount of correlation between xk and zk can be changed by simply changing var= <dig>  if var= <dig> and cor= <dig>  if var= <dig>  for all k, whilst cor= <dig> for j≠k, although observed values may vary due to randomness.

we will also simulate data with the same assumptions as above, but now take zk≡−xk+wk, so that xk,zk have a negative correlation. for this case, we will take var= <dig>  so that cor=− <dig> . note that the {xj} are uncorrelated, as are {zk}, in all three cases.

roc curves produced for each different type of effect/region suggest that most power is typically yielded when the covariate sets x and z are positive and strongly correlated . the biggest difference in power is observed in the situation where x affects the response, followed by the split-samples case. this is surprising, but not entirely unexpected. indeed, in this case q brings information about q and thus, when their sum is used for testing, the power to find effects increases the most.
fig.  <dig> roc curves, simulation study with z as a function of x. roc curves to evaluate power to find four different types of effects between one dependent variable and two independent covariates sets, n= <dig>  simulation study using z as a function of x. different line colours correspond to different amounts of correlation between z and x




using empirical correlation structures
in practice, correlation structures can be considerably more complex than assumed in the previous subsection, so we here consider two empirical correlation matrices, derived from the tcga colon cancer data studied in the subsection “colon and breast cancer datasets”. in this example, gene expression is explained by set of copy number  or methylation  covariates. specifically, we chose genes ggt <dig> and gdap1l <dig>  both on 20q. expression of both genes was found to be associated with cn as well as me in our analyses . for ggt <dig>  tests involved  <dig> cn and  <dig> me covariates. the majority of copy number and methylation covariates were negatively associated with each other, with the strongest pearson correlation estimated as − <dig> . gene gdap1l <dig> was found to have expression associated with  <dig> cn and  <dig> me covariates, but here cn and me covariates are positively associated with each other, with pearson correlation around  <dig> . subsequently, observations for {xj} and {zk} are generated from a multivariate normal distribution based upon one of the covariance matrices at a time. for both genes, cn measurements are highly associated with each other .

the roc curves suggest that power achieved is comparable in the two cases, for situations where only one of the covariate sets is correlated with the response, or where the covariate sets are correlated to different subsets of observations for the response . however, when effects are either additive or multiplicative, then power to find effects is greater if the covariate sets are positively correlated, as is the case with gdap1l <dig>  conclusions remain the same for n= <dig>  .
fig.  <dig> roc curves, simulation study with empirical correlation matrix for genes ggt <dig> and gdap1l <dig>  roc curves to evaluate power to find four different types of effects between one dependent variable and two independent covariates sets, n= <dig>  simulation study using an empirical correlation matrix for x,z. different line colours correspond to different correlation matrices, corresponding to the covariate sets for the genes considered



we conclude that the test statistic  yields acceptable power to find associations with the response, in situations of practical interest.

colon and breast cancer datasets
data and definitions
in our simulation studies we have shown that the joint test statistic q given by  can test for, and find, different types of associations between covariate sets and responses. here we will see that its relationship with the individual test statistics q,q can help elucidate the relative effects of molecular mechanisms under study on the response. to illustrate this, we will consider molecular profiling  data for colon  and breast  cancer samples, extracted from the cancer genome atlas . for details about the data, see section  <dig>  of additional file  <dig> 

here we will consider gene expression as the response variable, and we will study how dna copy number and methylation affect expression levels, both individually as well as jointly. specifically, we consider a model such as , where yi represents the ith gene expression probe, {xj} represents the set of copy number probes that are within  <dig> mb in either direction of the transcription start site of the gene, and {zk} represents the set of methylation probes that are within  <dig> kb of the gene’s transciption start site in either direction. these window sizes are arbitrary and reflect current knowledge on the distance of cis–regulatory effects of copy number  and methylation on gene expression  <cit> .

we computed p-values for q, which we will refer to as the joint test, as well as for the individual test statistics q,q, which will be referred to as the cn test and the me test, for association between dna copy number or methylation with the gene expression. in all comparisons, we use p-values not corrected for multiple testing, as the comparisons between different test results can be more reliably done in this way . associations for which p≤ <dig>  were selected. in all cases, empirical p-values distributions were verified to be enriched with small p-values, so that in none of the cases does the set of mrna probes selected have small p-values entirely due to chance. indeed, if we consider the number of tests done per chromosome arm , we can verify that the largest number of p-values that by chance is smaller than  <dig>  is  <dig>  for 1p. various ratios of the number of selected tests will be computed, following definitions in additional file 2: table s4

tables of all mrna probes tested, with p-values computed by joint and individual tests, can be found in additional file  <dig> for the colon cancer data, and additional file  <dig> for the breast cancer data.

individual and joint copy number and methylation effects
individually, copy number changes explained a larger portion of the gene expression variance than methylation, notably for the colon cancer data set . interestingly, in the colon cancer data we found twice as many mrna expression probes selected as associated with copy number  than in the breast cancer data , despite the latter involving almost  <dig> % more samples than the former . so, copy number changes seemed to regulate the expression of a larger number of genes for colon cancer, compared with breast cancer. the proportion of mrna expression probes selected as being regulated by methylation changes was comparable in these two data sets .

results separately per chromosome arm mostly reflect the stronger copy number effect in colon cancer compared with breast cancer. methylation effects are, on the other hand, observed in very similar proportions . examples of this are found with 1q and 17q. however, two chromosome arms display more extreme behaviour: 20q and, to a lesser extent 13q, are outliers in the colon cancer data set, with a larger proportion of selected associations with either copy number or methylation than the remaining arms.
fig.  <dig> comparison of copy number and methylation effects. proportion of genes selected by their expression association with copy number  and with methylation , for colon  and breast  cancers, per chromosome arm



proportions of selected joint tests for colon and breast cancer  reflect mostly the proportions found with the cn test ; this is due to the copy number effect largely influencing the joint effect.

we can better understand these differences if we now consider test results per gene. for colon cancer, the joint test yielded virtually the same results as the cn test, for 20q and 13q in colon cancer . in addition, more than  <dig> % of all mrna probes selected by me tests were also selected by cn tests . as both 13q and 20q often display copy gains in colon cancer , this suggests that those gains are likely to be important for oncogenesis, and methylation may be compensating for some of this effect. in contrast, for breast cancer the joint test selects mrna probes that were not selected by the cn test on 20q , and at most  <dig> % of the mrna probes selected by me tests were also selected by cn tests .

on the other hand, genes on 5q, 16p and 16q displayed associations mostly with copy number, but not with methylation, for both cancer types . here, the joint test selects additional mrna probes, not selected by the individual test statistics . in addition, mrna probes selected by me tests were selected also by the cn test less often . this makes results for 13q and 20q in colon cancer more remarkable: they yielded the highest percentages of selected cn tests and me tests, and the largest overlap of me tests with cn tests.

such comparisons help picking up trends that differentiate cancer types, although they obviously ignore region-specific effects: 17q has commonly amplified regions in breast cancer with an impact on gene expression  <cit> , which is not the case for colon cancer.

overlap between individual and joint tests
results from joint and individual tests may naturally display some association: this indicates how much of the total gene expression variability is explained by each individual effect. here we considered the proportion of tests selected both individually as well as with the joint test, compared to the total of selected joint tests . when the joint test leads to many extra discoveries compared with the individual test, this proportion is small. if the proportion is close to  <dig>  however, the joint test statistic mostly finds associations already identified by the individual test, suggesting that a single molecular profile drives effects on gene expression.

the complement of this proportion , the ratio of new discoveries with the joint test, points out clearly that large fractions of joint test new discoveries arise, when compared with the me test . this was expected: most of these result from the stronger copy number effect. nevertheless, the advantage of the joint test is evident as there are new discoveries with the joint test for all chromosome arms.
fig.  <dig> joint test new discoveries. computed as the proportion of genes with selected expression association with the joint set of covariates, that was found not to be selected by either copy number  or methylation  separately. top: colon cancer. bottom: breast cancer



the overlap ratios show that, as expected, a relatively large proportion of mrna probes selected by joint tests was also selected by the cn test . in contrast, selected joint tests were also selected with the me test at considerably smaller proportions . this can be again explained by the stronger copy number effects in colon cancer, and stronger methylation effects in breast cancer. note that herewith when we refer to a “selected test” we obviously mean a “selected mrna probe by the test”.

results per chromosome arm mostly reflected the strong copy number effect, especially for colon cancer . some special patterns appear: 8p and 8q display similar effects in both cancers as 13q and 20q in colon: selected joint tests were mostly also selected by the cn test , and most selected me tests corresponded to selected cn tests .
fig.  <dig> comparing individual and joint tests: overlap and dilution. top row: overlap between individual and joint tests. computed as the proportion of genes selected by both its expression being associated with the joint set of covariates, formed by both copy number and expression, as well as by each single set of covariates, per chromosome arm. this proportion is relative to all selected joint tests. bottom row: dilution. computed as the proportion of selected genes for expression association with one set of covariates , that are not selected with the joint set of covariates, formed by both copy number and expression, per chromosome arm. the proportion is relative to all selected tests for association with either copy number  or methylation 



another interesting case is 18p, where copy number changes seemed to drive mrna expression regulation, with virtually all  selected joint tests overlapping with selected cn tests for colon cancer. for breast cancer, selected joint tests corresponded to selected cn and me tests in precisely  <dig> % of the cases each, with no overlap between selected cn and me tests . thus, here copy number and methylation changes seem to drive gene expression regulation, independently of each other, for different genes.

another interesting example is 19q, for which approximately 63– <dig> % of the selected joint tests were not selected by the cn test individually, whilst selected joint and me tests had the largest overlap , suggesting that methylation effects may drive gene expression regulation on 19q, for both cancers. indeed, methylation effects dominated the joint test statistic value, although copy number effects were still found for genes not found to be associated with methylation change .

methylation seemed to play a stronger role in gene expression regulation in breast cancer, compared with colon cancer. this was particularly noticeable examining the overlap proportions between selected joint and methylation tests. on chromosome  <dig>  in particular, these proportions of overlap were strikingly larger in the breast cancer data , compared with the colon cancer data . interestingly, one of the selected genes on 9p is cdkn2a, which is mapped by six mrna probes on the agilent expression microarray used. of these, two were selected as associated with both the methylation and the joint tests in the breast cancer data, and two were just above the selection threshold  with these two tests. in contrast, in the colon cancer data only one probe would be selected with a less stringent cut-off, by the methylation and the joint tests . indeed, methylation and gene expression were associated in both data sets, although the correlation was more widely and evenly spread across both methylation as mrna-expression probes .

in order to better understand the mechanisms regulating cdkn2a expression, let us consider the mrna probe a_23_p <dig> which had significant associations in breast, but not colon, cancer. a total of  <dig> breast cancer samples displayed dna copy loss, whilst only  <dig> colon cancer samples displayed a small loss in this region . note that the mrna probe was often not under-expressed for these samples. after sorting samples in the methylation data according to the copy number data heatmaps, we see that the samples displaying larger dna copy loss  also displayed hypo-methylation of about half of the probes which, again, was only observed for breast cancer . we then looked at scatterplots of a_23_p <dig> expression and the  <dig> methylation probes in the covariate set tests, which suggested that many of those displayed negative association with mrna expression in breast cancer, but not in colon, as expected of a functional hyper-methylation event affecting gene expression . in particular, dna loss was associated with hypo-methylation of some probes in breast cancer, but these probes were not correlated with mrna expression. indeed, methylation probes correlated with mrna expression did not show correlation with dna copy number. this suggests that, in breast cancer, methylation affects cdkn2a expression, independently of dna copy number change.

tests with different 
CONCLUSIONS
a selected joint test typically corresponded to at least one selected individual test, making interpretation of results straightforward. however, there was a small but non-negligible proportion of mrna probes  that was selected by the joint test, whilst that was not the case with either of the individual tests . such cases tended to reflect small effects spread across multiple covariates, in this case both copy number and methylation probes, with the collection of small effects leading to an association with the larger covariate set being selected. as such, these are worthy of further investigation. looking at the results per chromosome arm, we found that 11p and 17p had relatively high proportions  of effects found only with the joint test statistic, for the breast cancer data .

there were also mrna probes selected only by an individual test, but not by the joint test. indeed, around  <dig> % of the mrna probes selected by cn tests were not selected by the joint test, for both colon and breast cancers. if such effect dilution occurs, the conclusion is obviously that copy number affects gene expression whilst methylation does not, to an extent that the copy number effect, either not very strong or only spanning a small subset of the copy number variables, is no longer enough to drive the result of the joint test statistic. from the mrna probes selected by me tests, between  <dig> and  <dig> % were found not to be selected by the joint test, for colon and breast cancer respectively.

copy number effects were found to be up to  <dig> % diluted for most arms . this was partly expected due to the large overlap between joint and cn tests. on exception is 19q, of all mrna probes selected by the cn test, around  <dig> % for colon and  <dig> % for breast were not selected by the joint test statistic, whilst for the me test these proportions were  <dig> and  <dig> % respectively . so, 19q is a chromosome arm where methylation effects dominated the joint test statistic and, as such, were diluted to a very small extent; on the other hand, about half of the individual copy number effects were diluted in the joint test statistic.

overall, we observed more dilution of methylation effects in the joint test statistic with the breast cancer data, compared with colon . this is likely due to the fact that the breast cancer displayed more methylation effects but, as these effects were mild, they were more likely to be diluted in the joint test statistic. the largest methylation-effect dilutions in the breast cancer data were observed for 6q, 7p, 8p and 8q, where the last two yielded at least  <dig> % of selected joint tests also being selected by the cn test, for both colon and breast cancer. what the dilution proportions tell us is that the copy number effect dominance comes at the cost of the methylation effect: between  <dig> and  <dig> % in colon cancer, and between  <dig> and  <dig> % in breast cancer, of the methylation effect was “lost”. this is also evident from the gene-wise test graphs for these chromosome arms, as a set of p-values that is near zero for the me test, but not for cn or joint tests .

examples of effects found
our results highlight a variety of effects of copy number and methylation explaining gene expression variability. to illustrate this, we selected probes found with our tests and examined corresponding patterns in the data motivating the findings. for each test, we selected probes for which a test had p-value ≤ <dig> . specific criteria used to select mrna probes for detailed analysis are given in subsection “examples of genes found: selection criteria” of additional file  <dig> 

the selection criteria used are likely to find mrna probes with strong copy number effects on 13q, 20q and 8q, as we know these characterize the colon cancer data. indeed, this is what we found, but with an interesting twist: copy number seemed to explain mrna expression for only part of the samples, with in almost all cases a subset of samples with diploid copy number and yet varying mrna expression. this was the case with genes ggt <dig>  pigu, nufip <dig>  wfdc <dig>  slc39a <dig>  pcdh <dig> and ift <dig> . since these probes were also selected on the basis of the me test, we expected methylation to also regulate mrna expression, in particular in diploid samples, in spite of the strong copy number effect. indeed, we found that, not only samples with dna copy gain also have less methylation, but also diploid samples more often display more methylation. for these samples, it seems that copy number and methylation have an additive effect on mrna expression. note, however, that in most cases, copy number and methylation did not explain mrna expression completely, with a few samples displaying less methylation as well as a copy gain, and yet being under-expressed compared to the remaining samples. this suggests that a third mechanism is regulating mrna expression for a subset of samples, for example down-regulating mrna expression in samples with dna copy gain and less than average methylation, or up-regulating mrna expression in diploid samples with more than average methylation. in such cases, the event of up- or down-regulation of mrna expression is thus achieved by different mechanisms depending on the sample, which illustrates the concept of complementary effects introduced in the simulation study.
fig.  <dig> gene ggt7: expression, methylation and copy number. mrna expression  of one probe mapping to gene ggt <dig> in the colon cancer data. top graphs: methylation values  for chosen probes within  <dig> kb of the gene start site; point colours represent the dychotomized copy number , with blue corresponding to approximately diploid number of copies; the vertical dashed line represents the cut-off used to separate samples with more or less methylation. middle graphs: median copy number values across all measurements within the  <dig> mb region around the gene start site; point colours represent the dychotomized methylation , with blue corresponding to less methylation; the vertical dashed line represents the cut-off used to separate samples approximately diploid from those. bottom graph: mrna expression for all samples, sorted from the smallest to the largest; three plotting symbols are used per sample to convey dychotomized copy number , methylation probe  <dig>  and methylation probe  <dig> ; symbol colours are blue for lower values  or pink , as before



it is interesting to note that the mrna regulatory mechanism just described implies that dna copy number and methylation are negatively correlated. this is the opposite from what we expect if a copy number change occurs at random, which would alter methylation in the same direction. this suggests again that the methylation changes are functional, since they neither can be a consequence of dna copy gain nor are they likely to have occurred by chance  on the diploid samples.

not all probes followed this pattern. probe a_23_p <dig>  mapping to gene gdap1l <dig>  is interesting because copy number also separated samples into diploid and copy gain, but now copy gain samples are under-expressed compared with diploid ones . methylation still displayed a  association with gene expression, for at least two probes. it is possible that methylation compensated for the dna copy gain here, since 20q is very often gained in colon cancer.
fig.  <dig> gene gdap1l1: expression, methylation and copy number. mrna expression  of one probe mapping to gene gdap1l <dig> in the colon cancer data. top graphs: methylation values  for chosen probes within 50kb of the gene start site; point colours represent the dychotomized copy number , with blue corresponding to approximately diploid number of copies; the vertical dashed line represents the cut-off used to separate samples with more or less methylation. middle graphs: median copy number values across all measurements within the  <dig> mb region around the gene start site; point colours represent the dychotomized methylation , with blue corresponding to less methylation; the vertical dashed line represents the cut-off used to separate samples approximately diploid from those. bottom graph: mrna expression for all samples, sorted from the smallest to the largest; three plotting symbols are used per sample to convey dychotomized copy number , methylation probe  <dig>  and methylation probe  <dig> ; symbol colours are blue for lower values  or pink , as before



finally, the probe selected on 19q on the basis of the me and joint tests, mapping to the slc7a <dig>  showed indeed methylation negatively correlated with mrna expression . as expected, dna copy number was not correlated with mrna expression.

the probe chosen mapping to cdkn2a displays a similar pattern to that for slc7a <dig>  with a trend of over-expression for samples displaying more methylation by one or both methylation probes. on the other hand, almost all samples with under-expression displayed more methylation with at least one of the two methylation probes . this was not observed for the same probe in breast cancer samples. we conclude that expression of cdkn2a is often regulated via methylation, but that this can be best represented by different mrna probes, for breast and colon cancer. methylation probes showing strong association with mrna expression may be the same, as is here the case.

after observing that methylation plays an important role in gene-expression regulation in breast cancer, we also looked for genes that had, for the me test, p≤ <dig>  and p> <dig>  in breast and colon cancer, respectively. this yielded  <dig> genes. in order to make the selection even stricter, we required that each gene had at least two mrna probes satisfying the criterion, which led to  <dig> genes. this list included gene mgc <dig>  also known as mzb <dig>  it has been previously found to be frequently methylated in hepatocellular cancer  <cit> . of the  <dig> mrna probes mapping to it, two are methylated above average for all samples . another gene on this list is rab40c, a member of the ras oncogene family. of the  <dig> mrna probes mapping to it,  <dig> are significant and exhibit a negative correlation between median copy number and mrna expression .

the above mechanisms illustrate effect types that can be found by our approach, squeezing relevant information out from thousands of mrna probes, copy number and methylation measurements and yielding a list of mrnas for further investigation. obviously, correlation does not mean causation: further research would be needed to verify which of the associations found indeed is functional. in particular, statistical significance need not lead to biological relevance: as with any statistical method, there are effects found of too small a magnitude to be biologically relevant.

discussion
we have proposed a test to find associations between a dependent variable and two or more sets of covariates. it can be used for example to test for associations between a gene’s expression levels with copy number and/or methylation in a region around it. these help us better understand molecular mechanisms of gene expression regulation, individually and jointly, as we showed with the colon and breast cancer tcga data.

in our illustrations, we have not corrected for multiple testing, even though many hypotheses were tested simultaneously. this was done for the sake of clarity: our illustrations involved comparing results from different data sets, and such comparisons are better made on the basis of uncorrected p-values. indeed, multiple testing correction such as fdr may for example yield the same corrected p-value for many hypotheses, and it often does, even if uncorrected p-values are distinct. in practice, obviously multiple testing correction must be used if the test is applied many times.

other methods have been proposed to look for associations between one molecular profile, and two or more other profiles. one framework that has been used by various authors for the two-dataset case  and, by some, has been extended to the three-dataset case, is that of penalized canonical correlations  <cit> . this framework tries to find  combinations of the variables in the molecular profiles datasets that are  strongly correlated. as such, they are of an exploratory nature. indeed, canonical vectors essentially identify sets of variables that are most strongly correlated. while their correlation may be considered high, it could still be due to chance, especially considering the high-dimensionality and sparseness of the data sets. in addition, due to their very nature sparse-canonical correlation-based approaches are computationally complex, and the complexity increases very quickly with each added independent dataset, as well illustrated by lee et al.  <cit> . compounded with the high-dimensions of the datasets involved, this means that such methods do not easily scale up. furthermore, it can be difficult to interpret the canonical vectors.

in contrast, our approach is meant to be used when researchers have given sets of interest, which is is often the case in practice. here we studied gene expression-regulating mechanisms by copy number and methylation, and used sets of measurements is cis, in and around the gene are of interest. we could have also considered trans effects by simply expanding the set. to study gene expression-regulating mechanisms by microrna expression, one could form a set of microrna  that may target that gene. to study eqtls affecting a gene’s expression, natural sets are all snps in haploblocks mapping to a  <dig> mb region centered around the start of the gene  <cit> . our approach then tests the association of the dependent variable with all covariates in the set.

bayesian approaches have also been proposed to analyse two datasets  together , but as such approaches are naturally computationally complex, they often become prohibitively computationally complex when used on the whole genome, or for more than one independent data set. richardson et al.  <cit>  tried to address the complexity by proposing a more efficient algorithm for mcmc estimation, although they do not apply their method to more than two data sets in their paper.

our approach is computationally simple, so it can be scaled up to the whole genome and be used with many covariate sets. the simplicity results from the focus on testing, rather than on model fitting, as do bayesian approaches, or on finding canonical vectors. this allows for quick, simple and objective evaluation of results, and easy prioritization of found associations.

vaske et al.  <cit>  proposed another method to analyse multiple molecular profiles simultaneously. their method first replaces multiple probes by pathways, producing a matrix of inferred associations between samples and pathways, which is used, instead of the entire dataset, in analyses. this data with reduced dimensions is then used to build directed graphs. this process involves discretization of the data set, to enable establishment of direction in the graph estimation. as such, it relies on pathways containing information relevant to the study, as well as biological information about molecular interactions within pathways. this makes for a much more structured method, that is of particular interest when specific pathways and/or processes are under study. indeed, results are reported per pathway, so relating them back to the genes is not trivial.

our method is less structured, and this enables us to find a wide variety of types of association between covariates and the response which, as we saw in the tcga data example, may not be linked to any known pathway. so it is preferred in cases where no particular effect is a priori of interest. the lack of imposed structure makes it more flexible. indeed, our approach could be used on the matrix of inferred pathway activities generated by the approach of vaske et al.  <cit> , instead of their proposed graphical model, where we would have ignored the interaction factors. here all pathways could be used in a single set of covariates to study relationship with a clinical outcome, for example. in particular, results are easy to interpret: not only it indicates clearly if the response is associated with the covariates, but also we can decompose each test statistic into the separate contributions of each covariate towards the joint set, pinpointing covariates driving the test result  <cit> .

in the tcga data examples, we observed similarities and differences between how copy number and methylation regulate gene expression in these two cancer types. for some chromosome arms, such as 1q and 17q, proportions of discoveries are similar between the two cancers. this needs not mean that the same gene expression-regulating mechanisms are involved, but that genomic changes of the same type are involved at the same ratio. also, copy number and methylation do not necessarily explain gene expression variation of the same genes, and the joint test finds additional associations compared to the individual tests. for other arms, such as 13q and 20q, there are clear differences between the genomic changes found to affect gene expression in colon and breast cancer.

some genes were selected to illustrate patterns found by the method, which showed some expression-regulating mechanisms driven by a combination of copy number and methylation changes. this is just the tip of the iceberg, with many other potentially interesting effects contained in the results. researchers interested in further exploring our results can use the whole-genome results table provided .

the pioneering articles of tcga colon  <cit>  and breast  <cit>  cancer samples characterization have of course already given a detailed overview of molecular changes observed in these data sets. they have, however, not looked for complex regulatory mechanisms as we do here. so, our findings complement theirs, although we must be careful when extending the results from the samples subset used here to a larger set of cancer samples, as we cannot guarantee that the samples we chose represent well all similar cancer samples.

in the illustrations above we assumed that gene expression was the molecular phenotype of interest. clearly that is not always the case, and other molecular phenotypes of interest include protein expression profiles. our method can equally well be applied to such cases, with the reason for us not to have done so is the relatively limited number of samples with protein profiles available. in our experience, a minimum number of samples needed to yield reliable results is about  <dig> for the two-dataset case , but that of course is very much dependent on the signal-to-noise ratio in the data sets.

our approach can also be used in a generalized-linear model context, where the dependent variables are related to the sets of covariates via a link function, such as the logarithm or the logit. this extension is straightforward, as we use the framework of the global test  <cit> . this allows us for example to consider rna-seq data as dependent variables, if a suitable data transformation exists such that covariate effects can represent well variability in the transformed rna-seq data. ideally, we would like to represent the data variability using the negative binomial, as done for example by the bioconductor packages edger  and deseq , as it handles the data overdispersion . note, however, that this is not straightforward as the negative binomial distribution is not in the exponential family. this extension is beyond the objectives of this paper and will appear elsewhere.

another application of interest is to study the impact of changes in multiple molecular profiles on patients’ survival outcome, a variable formed by time from diagnosis to event and event information. this can be done by means of a cox proportional-hazards model as an extension of the global test for this setting proposed earlier  <cit> .

