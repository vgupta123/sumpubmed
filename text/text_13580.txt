BACKGROUND
the crispr/cas <dig> system has emerged over recent years to become the prevailing method for genome editing with many different applications in a wide variety of organisms . clustered regularly interspaced short palindromic repeats  are sequences found in many species of bacteria and archaea, consisting of repeated sequences interspersed with different non-repetitive sequences. these spacer sequences are derived from previous viral infections and the crispr/cas system functions as an adaptive immune response to viral infection . crispr associated  genes are arranged in operons next to crispr loci  <cit> .

the endogenous type ii crispr system is composed of a crispr rna  derived from the spacer sequences  <cit> , a trans-activating rna  and the cas <dig> endonuclease, which cuts at sequences complementary to the crrna  <cit> . the form most commonly used in genome editing applications employs a single chimeric version of crrna and tracrrna known as a synthetic guide rna . this can be used to efficiently induce small insertions/deletions , through inaccurate repair of double-strand breaks, preferably generating frameshift mutations to produce loss-of-function alleles for genes of interest. cas <dig> protein recognises a small motif known as the proto-spacer adjacent motif , which is present in the foreign sequence, but not in the crispr locus, allowing it to distinguish self versus non-self . for streptococcus pyogenes cas <dig>  the pam sequence is ngg, leading to a consensus crispr target site of n21gg. for sgrnas produced in vitro using a t <dig> promoter the first two transcribed bases are g, making sgrnas with a ggn19gg consensus  <cit> .

the crispr/cas system has made it feasible to generate targeted mutations on a large scale. previous approaches relied on either chemical or insertional mutagenesis , and while these were very successful they suffer from a problem of diminishing returns, because of their random nature. also, genes that are haploinsufficient will not be recovered by these strategies, as f1s with such alleles will not survive to be screened. the ability to disrupt gene function in a targeted high-throughput manner provides a complementary approach with the potential to realise the goal of producing a knockout allele in every gene in the zebrafish genome. beyond that it will also make other genomic modifications straightforward, enabling the study of non-coding portions of the genome such as non-coding rnas and enhancers.

the most time-consuming aspects of generating mutants by crispr/cas are screening and genotyping. for example, sgrnas need to be screened for cutting efficiency as there is currently no reliable way of predicting the activity of any given sgrna. mosaic sgrna-injected individuals then need to be screened for those that transmit the appropriate alleles . finally, individuals need to be genotyped to identify those that are carrying such alleles. capillary sequencing is expensisve and not high throughput and methods such as t <dig> endonuclease i assay and high-resolution melt analysis do not identify which alleles are useful. since g0-injected individuals are mosaic for induced indels, there is also the problem of what tissue to screen to best evaluate germline transmission rates.

we have developed a scalable design and analysis pipeline for the production of crispr/cas <dig> mutants. to streamline screening, we use high-throughput next generation amplicon sequencing of sperm samples from g0-injected males. this allows us to cryopreserve sperm samples at the same time, producing an archive of alleles. it also provides information on the specific variants in the germline of each individual enabling us to design genotyping assays to the particular variants in each sample. this greatly simplifies the identification of f <dig> carriers and allows us to segregate multiple different alleles transmitted by the same founder.

RESULTS
crispr/cas <dig> sgrna design
there are currently many web sites and programs for designing sgrnas and determining possible off-target sites  all with differing strengths and weaknesses depending on the particular application. for example, only a few allow design of sgrnas in batch. to facilitate the design of sgrnas for large numbers of target genes, we have created a set of perl modules and scripts . the modules define objects that represent components involved in the design process such as a target region of dna, a crispr/cas <dig> target site and pcr primers. the scripts automate particular parts of the process such as scoring crispr target sites and designing pcr primers for amplicon sequencing. since there is currently no reliable way of predicting the cutting efficiency of a given sgrna, targets are selected to minimize possible off-target effects.

the design process is illustrated in fig.  <dig>  the design scripts take either ensembl identifiers  or genomic regions as input. allowing arbitrary regions as input enables design of sgrnas to modify non-coding regions such as promoters and enhancers. in the search phase, the sequence is scanned for all possible sites matching a given target sequence . these sites are scored for off-target potential. currently, off-target scoring is done by aligning target sequences back to the reference genome using bwa, allowing an optional number of mismatches. however, faster algorithms for off-target finding exist  <cit>  and these will be incorporated into the design module. all the possible target sites are output with a score that reflects both off-target potential and, if using ensembl identifiers, the position of the target site in the supplied gene/transcript. optionally, sites can be filtered based on known snp data to avoid possible mismatches to the target site in the line being used.fig.  <dig> crispr sgrna design process. an ensembl gene model is shown at the top; two exons are expanded in the rest of the diagram. the target sequence is searched for crispr sites, these are scored and the best scoring are selected. for screening, pcr primers are designed for making amplicons into sequencing-ready libraries. the package also includes a database schema for storing information on crispr designs and screening information



once crispr target sites have been selected, pcr primers for screening sgrna efficiency can be designed using another script that runs primer <dig>  <cit>  multiple times to produce nested primer pairs. the crispr package also contains a sql  database schema that holds information about target regions, crispr sites, construction oligos, pcr primers etc. there are also scripts to automatically load the information into a database using the output files from the design scripts.

for this study, sgrnas were designed as pairs to allow larger than normal deletions to be made. in addition, these pairs could be used with cas <dig> nickase  <cit>  rather than native cas <dig> if off-target effects proved to be a significant issue. the criteria for picking pairs were as follows: pairs of sites were considered valid if the predicted cut sites were between  <dig> and 100 bp apart and the crispr sites were in a tail—tail orientation . evidence from human cells showed that such an orientation was much more efficient than head—head when using cas <dig> nickase  <cit> . the usual target sequence when designing sgrnas for in vitro transcription is ggn19gg to incorporate the end of the t <dig> promoter sequence  <cit> . however, this makes finding correctly spaced and oriented sites for designing pairs of sgrnas much less likely. to allow us to design pairs, we relaxed the sequence constraint to n21gg and placed two extra g nucleotides on the 5′ end, thus making the sgrna  <dig> bases longer. each pair of sgrnas was injected together using native cas <dig> and screened for efficiency using a single amplicon spanning both crispr sites. all the target sequences for the sgrnas used in this study are in additional file  <dig> 

generating mutants using crispr/cas9
an illustration of our screening workflow for generating mutants using the crispr/cas <dig> system is shown in fig.  <dig>  first, sgrnas are designed by selecting target sites with low off-target potential in the region of interest. generally, we find that selecting two target sites per gene is enough to find at least one sgrna that is sufficiently active. rna for microinjection is produced in vitro using the method of gagnon et al.  <cit> , which can be done in  <dig> well plates without any cloning steps.fig.  <dig> crispr workflow. a overall workflow. diagram showing the steps of the process. b strategy for sgrna screening. initially, sgrnas are screened for efficiency and those with high cutting efficiency are re-injected. the g <dig> embryos are raised and males are screened for germline crispr-induced indels. for high-transmitting samples, embryos are generated by ivf, raised and the resulting f <dig> carriers are identified by kasp



to screen the activity of sgrnas in a high-throughput manner, we use pcr primers designed for use with the miseq sequencing platform to amplify the region surrounding the crispr target site. this allows us to screen amplicons in hundreds to thousands of embryos in a single sequencing run. typically, we first assess sgrnas by injecting small numbers of embryos and screening for cutting efficiency by amplicon sequencing . selected sgrnas that efficiently induce indels are re-injected and the embryos raised to adulthood. males are selected from these families and sperm is collected for both cryopreservation and screening for germline mutations, again by sequencing. the samples that carry high frequency frameshift alleles are selected for in vitro fertilisation  to produce f <dig> families. screening the germline of g <dig> founder fish allows us to design kasp genotyping assays  for the specific variants that will be transmitted to the next generation enabling us to quickly identify f <dig> carriers for incrossing and subsequent phenotyping.

screening the germline by amplicon sequencing
the second part of the process of producing mutant lines is identifying crispr-induced indels, for both initial efficiency testing and recovery of transmitting alleles. like many groups , we have used high-throughput sequencing of amplicons for identifying variants. the illumina miseq platform allows fast turnaround times and provides enough reads to screen hundreds of samples over many amplicons. nested primers are designed to amplify a 250– <dig> base pair  region surrounding the crispr target site. the internal primers have partial illumina adaptor sequence to allow for the creation of sequencing-ready libraries by pcr. amplicons from a single sample  are barcoded using primers containing illumina adaptor sequence and an 11 bp barcode .

the analysis procedure is shown in fig. 3a. first, adaptor and primer sequence is trimmed from the reads using cutadapt  <cit> . large deletions within the amplicon will result in the sequence reading into the adaptor sequence on the other side of the amplicon. primer sequences are also trimmed to reduce the possibility of false positives caused by primer-dimer contamination. the trimmed reads are then mapped to the genome with the bbmap aligner . bbmap is better able to map reads containing large indels which is essential for this application.fig.  <dig> crispr analysis pipeline. a analysis pipeline. schematic of sequence analysis procedure. b pipeline outputs. examples of the visualisations that the pipeline produces. top—plate map showing the percentage of reads containing an indel for each sample along with the total number of reads. bottom—display of induced variants relative to the crispr target site



these alignments are then analysed by a custom perl script that selects candidate alleles from the bbmap-produced bam files and downsamples the reads into separate allele-specific bam files  <cit> . these are analysed using the program dindel  <cit>  to call the specific insertions/deletions. the script then outputs each allele found and its frequency within the sample. two custom r scripts are used to produce graphical representations of the data. examples of these are shown in fig. 3b. more detail on how to run the design and analysis scripts is provided in additional file  <dig> and in the crispr repository.

screening somatic tissues versus the germline
to investigate the best way to screen potential founder g <dig> individuals we compared the crispr-induced alleles present in the germline and the soma. we isolated both sperm and fin tissue from individual males from crispr-injected families and analysed them by amplicon sequencing. we tested nine different sgrnas for five different genes.

the questions we were interested in were:is the percentage of reads showing an indel in the fin clip predictive of the percentage of reads showing an indel in the germline?

do the variants found in the fin clip reflect the ones in the germline?



as shown in fig.  <dig>  the complement of alleles found differs greatly between the two samples. overall, there is a correlation between the percentage of reads with an indel in each tissue , although there are many clear examples where this is not the case . the correlation between the percentage of reads showing an indel in the fin clip and the percentage of reads showing an indel in the sperm sample ranges from − <dig>  to  <dig>  across the nine sgrnas , however this may be misleading due to differences in efficiency between the sgrnas. importantly, the frequencies of specific alleles do not correlate well between the tissues . indeed,  <dig> of the  <dig> samples showed variants in the fin-clip sample and no variants in the germline. in addition, of the  <dig> variants identified across all samples, only  <dig> were shared between the fin clip and the sperm sample of the same individual. this means that it is not possible to predict which, if any, of the variants seen in the fin-clip sample will be transmitted to the next generation.fig.  <dig> comparison of induced indels between germline and somatic tissues. a plot of total percentage of reads with an indel in sperm versus fin clip. b plot of frequencies for individual variants in sperm versus fin clip. variants that are present in both the sperm and fin-clip samples from a single individual are in red. plot has been cropped to make points near the origin easier to distinguish. figure s <dig> is the original. c plot showing the average overlap of indels in each tissue for each sgrna. d plot showing the correlation between the frequency of reads from miseq data and the number of carriers identified in f <dig> outcrosses



given the high efficiency of most crispr sgrnas, it is feasible to recover f <dig> fish carrying induced indels by screening fin-clip dna. however, these data show that screening fin clips of g <dig> individuals is not predictive of the germline transmission rates or the transmitted alleles.

direct genotyping of f1s by kasp genotyping
another important benefit of directly screening the germline of potential founders is that it allows us to know exactly which alleles will be transmitted to the next generation, removing the need to sequence f <dig> individuals. we can design kasp genotyping assays  for the transmitted alleles in advance of the f <dig> individuals being old enough to cross. this allows us to rapidly screen f <dig> individuals for the transmitted alleles that they carry by simple fin clipping and genotyping pcr. figure 4d shows the frequencies of variants called from sperm sequencing data plotted against the frequencies of carriers identified in f <dig> individuals by kasp for sgrnas that have been taken through the complete pipeline. variant frequencies called from amplicon sequencing correlate well with the number of carriers identified in f <dig> offspring. this provides confirmation that our indel calling is working well and allows us to use the frequencies reported from amplicon sequencing as a guide as to which sperm samples to select for ivf to generate the most f <dig> carriers.

another different workflow would be to screen f <dig> embryos from g <dig> incrosses by sequencing to identify high transmitting pairs, which can then be recrossed. indeed, similar results to ours have been reported using this scheme by varshney et al  <cit> . they showed that only  <dig>  %  of somatic mutations identified in fin clips were transmitted to the f <dig> generation. screening f <dig> embryos may be a preferable workflow for labs that do not routinely cryopreserve sperm although sperm samples can be screened without having to cryopreserve them. however, screening f <dig> embryos requires keeping living fish housed as pairs until the analysis is completed and then for a second cross to be carried out following analysis. screening g <dig> sperm is a streamlined workflow that involves less fish work to identify loss-of-function alleles.

ggn21gg sgrnas have reduced efficiency compared to ggn19gg ones
using this system we have designed and screened the efficiency of  <dig> sgrnas designed to  <dig> genes . these sgrnas were designed as pairs as detailed above. after screening all  <dig> sgrnas for efficiency we could see that a large proportion of them had very low activity. to investigate whether the ggn21gg design was the cause of this, we redesigned the lowest efficiency sgrnas as single ggn19gg sites. as shown in fig.  <dig>  these sgrnas are significantly more active . there are multiple possible explanations for this. first, the increased length of the sgrna may affect efficiency. second, mismatches between the 5′ gs and the genomic sequence may reduce cutting efficiency. thirdly, it is possible that the difference is due to the different target sites selected for each of the designs.fig.  <dig> efficiency of longer sgrnas. a longer sgrnas  tend to be less efficient than those designed to the usual consensus . plot shows the distribution of the mean indel frequency for sgrnas with different design strategies. b plot showing the distribution of induced indel frequencies for individual sgrnas with different design strategies



we think that this last possibility is unlikely given the effect size and number of sgrnas tested. it has previously been reported that the cas <dig> system can tolerate mismatches in the 5′ end of the sgrna  <cit> . interestingly, it has been reported in human systems that adding extra g nucleotides to the 5′ of the sgrna reduces off-target cutting  <cit> . cho et al. compared on- and off-target cutting efficiency for three different target sites using either ggn21gg or gn20gg for the design. all three targets showed decrease off-target cutting efficiency. however, for two of the target sites, the ggn20gg designs were also significantly less active at the on-target site than the corresponding gn20gg design.

therefore, we favour the idea that it is the increased length causing the decreased efficiency. another group  <cit>  has also recently reported reduced cutting efficiency with the same ggn21gg design compared to ggn19gg.

CONCLUSIONS
we have developed a system for designing and analysing crispr cas <dig> sgrnas in batch. the crispr package is freely available and can be downloaded from github . we have developed an efficient germline screening platform using ngs. we have used this system to compare the variants found in the germline and somatic tissues of founder individuals and have shown that, in zebrafish, somatic tissues are not predictive of the alleles  that are transmitted to the next generation. we have also observed a decrease in efficiency of sgrnas designed using a different consensus sequence. it would also be possible to extend our method to screen multiple amplicons in the same samples, allowing screening of injections of multiplexed sgrnas, as well as using it to screen samples for precise genomic changes rather than indels.

