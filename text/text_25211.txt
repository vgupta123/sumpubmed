BACKGROUND
the human leukocyte antigen  is a highly polymorphic gene cluster located on the major histocompatibility complex  on the chromosome  <dig>   <cit> . the mhc has an extension of  <dig>  megabases and contains over  <dig> genes divided into three sub-regions: class i , class ii  and class iii   <cit> . the hla genes are the most polymorphic group known in the human genome. their high rate heterozygosity is the result of the presence of three genes encoding classical mhc class i and three or four gene sets for the classical mhc class ii molecules, on each chromosome. the cells express at least three different mhc proteins, decreasing the chance of each individual being homozygous at all these three loci  <cit> . another important feature of hla genes is the presence of linkage disequilibrium  between the alleles of the different loci. despite the large number of alleles at each expressed loci, the number of haplotypes observed in populations is smaller than the expected. this fact indicates that certain hla alleles tend to occur together in the same haplotype rather than randomly segregating together  <cit> .

hla haplotype analysis has been used for disease-susceptibility locus identification and for a better knowledge of many other processes such as population genetics, due to its relation with immune response and high polymorphic rate  <cit> .

molecular haplotyping is expensive and laborious. on family-based studies, the genotyping of the relatives of each studied subject is required to establish phases. for other population-based studies there are several molecular methods available that allow a correct construction of the haplotypes  <cit> . allele-specific polymerase chain reaction   <cit>  and somatic cell hybrids  <cit> , are two of the most used molecular methods for an unambiguously determination of haplotypes on relatively small population studies  <cit> . the use of statistical methods is a less expensive and time-consuming approach for the inference of haplotypes from a large population genotypic dataset  <cit> . several statistical methods have been proposed, but it is unclear how accurate each method is for haplotype estimation on hla genes.

the most commonly used approach, estimating hla allele and haplotype frequencies, is the expectation-maximization  algorithm  <cit> . em algorithms support complex datasets including large number of individuals with ambiguous haplotypes, since they make an initial guess of the haplotype frequencies  <cit> . em-based haplotype frequency estimates can accommodate several loci with an arbitrary number of alleles. however, analysis of a large number of loci can result in a exponentially growing computing time. furthermore, most reports on the use of em methods have not provided information on the validity of the estimates, nor on the influence on estimation accuracy of population genetic factors, such as departures from hardy-weinberg equilibrium  and the actual haplotype frequency  <cit> . the arlequin v <dig>  software  <cit>  integrates several basic and advanced methods for population genetics data analysis, using the em algorithm to estimate maximum likelihood  haplotype frequencies.

another alternative is the application of bayesian methods that incorporate prior expectations based upon population genetic principles  <cit> . using a wide variety of real and simulated data sets it was demonstrated that bayesian algorithm is robust to the violation of hwe, to the presence of missing data, and to occurrences of recombination hotspots  <cit> . the program phase v <dig> . <dig>  <cit>  implements a bayesian statistical method and partition-ligation for reconstructing haplotypes from population genotype data.

in this study the accuracy of two of the leading methods of computational haplotype inference â€“ em algorithm based implemented in arlequin v <dig>  and bayesian algorithm based implemented in phase v <dig> . <dig> was compared for a data set composed of  <dig> unrelated families phase-known hla haplotypes .

RESULTS
identification of the real hla haplotypes
all the  <dig> loci and haplotypes were in hwe. the analysis of all pairs of alleles at different loci revealed the presence of  <dig> haplotypes  in complete ld . as shown in table  <dig>  there were  <dig> pairs of class i alleles,  <dig> pairs of class ii alleles and  <dig> pairs of class i plus class ii alleles, all with |d'| =  <dig> 

one hundred different extended haplotypes were identified . after splitting the extended haplotypes into class i  and class ii ,  <dig> and  <dig> real haplotypes were observed respectively. fifty haplotypes with frequencies above  <dig>  were found;  <dig> class ii ,  <dig> class i  and  <dig> extended haplotypes .

computational estimation of the hla haplotypes
the five runs performed with both phase v <dig> . <dig> and arlequin v <dig>  gave the same hla haplotype results, despite using different random sample groups.

variable number of loci
haplotype frequencies obtained through the family-based study were compared with the results estimated by arlequin v <dig>  and phase v <dig> . <dig>  both methods showed an overall decrease in the similarity index  as the number of analyzed loci increased . arlequin v <dig>  had the highest if value for class ii haplotypes , which was close to its maximal value. phase v <dig> . <dig> results showed lower values than arlequin v <dig> , also decreasing as the number of loci increased. however, phase v <dig> . <dig> had a higher if value than arlequin v <dig> ,  <dig>  and  <dig>  respectively  when the analysis of five loci haplotypes was performed.

the ih value of both methods for class ii haplotypes was  <dig>  . lower results were observed with the three loci haplotypes . phase v <dig> . <dig> registered the highest ih values obtained for the five loci haplotypes.

the mean squared error  increased as the number of loci was increased from two to three. the highest values were obtained with three loci haplotypes, decreasing again with five loci haplotypes . the same figure shows that mse values for arlequin v <dig>  were always higher than phase v <dig> . <dig>  and that the discrepancy between these methods was more evident as the number of analyzed loci increased.

variable number of samples
in order to investigate the performance of both methods with different sample sizes, four different randomly selected groups of samples  with different sizes were defined for each one of the five runs performed. these groups of samples were investigated with both methods, and the results of the estimation accuracy measures are shown in figure  <dig> 

despite increasing the number of samples, both methods exhibited a small range of variation in the if value . arlequin v <dig>  showed the same if with  <dig> or  <dig> samples , although a small reduction of this value was obtained with  <dig> or  <dig> individuals . different results were obtained with ih arlequin v <dig>  values . ih decreased when the sample size was increased from  <dig> to  <dig> individuals , increasing again when the test was performed with  <dig> to  <dig> individuals .

phase v <dig> . <dig> analysis reported smaller if values than arlequin v <dig>  with  <dig> samples , but after increasing the sample size the values obtained were always higher than arlequin v <dig>  .

the mse of arlequin v <dig>  for  <dig> samples was  <dig> order of magnitude lower than the registered by phase v <dig> . <dig> . when the sample value was increased from  <dig> to  <dig> individuals the arlequin v <dig> 's mse increased from  <dig> e- <dig> to  <dig> e- <dig>  while in phase v <dig> . <dig> this value decreased from  <dig> e- <dig> to  <dig> e- <dig>  both methods showed an overall decrease when samples where higher than  <dig> individuals, although phase v <dig> . <dig> had the best mse values.

haplotypes with frequencies above  <dig> 
there was 100% concordance between real class ii haplotype phases  and those predicted computationally by both methods . the if values were  <dig>  for arlequin v <dig>  and  <dig>  for phase v <dig> . <dig>  which were both close to its maximal value. within the two loci haplotype analysis, phase v <dig> . <dig> mse value was lower than arlequin v <dig> , despite the maximum ih value reported by both methods.

if results were lower with arlequin v <dig>  than phase v <dig> . <dig>  for the  <dig> loci haplotypes . although arlequin v <dig>  generated  <dig> out of  <dig> real class i haplotypes, it also created  <dig> incorrect haplotypes with frequencies above  <dig>  . phase v <dig> . <dig> was more effective and accurate in haplotype construction, as well as in frequency estimation, thus presenting the best mse value of the two methods, as shown on table  <dig>  despite having a better mse value , phase v <dig> . <dig> generated  <dig> incorrect haplotypes, one more than arlequin v <dig> .

regarding the  <dig> loci haplotypes , phase v <dig> . <dig> had a more favourable mse , and a better performance in ih . moreover, phase v <dig> . <dig> presented  <dig> incorrect  <dig> loci haplotypes , one less than arlequin v <dig> . the if value was similar between arlequin v <dig>  and phase v <dig> . <dig>  showing that both methods had a high accuracy on extended haplotypes estimation . one of the incorrect haplotypes generated by phase v <dig> . <dig> showed a frequency of  <dig> , but in general this software estimated lower frequencies for the incorrect haplotypes that were generated by both methods. in this group of haplotypes  the number of possible combinations between the alleles of the various loci increased due to the increase of the polymorphic rate but the number of real haplotypes decreased when compared to the  <dig> loci haplotypes with frequencies above  <dig> .

discussion
we have tested the effectiveness and accuracy of two computational algorithms to estimate haplotype frequencies and to predict haplotype phases using real hla haplotypic data. to our knowledge this was the first work aiming to test statistical methods using haplotypic data from the hla region, characterized by a high rate of polymorphic sites and ld.

contrasting with the findings of xu et al.  <cit> , the decrease in accuracy of both methods occurred when ld rate between the alleles increased. both methods registered a higher decrease in the if value from  <dig> to  <dig> loci than from  <dig> to  <dig> loci , suggesting that the presence of hla-b was the main factor influencing the algorithms' performance. this finding was confirmed when the number of individuals varied within the  <dig> loci haplotypes  .

regarding the variable number of loci analysis, it is relevant to notice that the  <dig> loci and  <dig> loci haplotypes included the locus hla-b which has the highest level of polymorphism within the hla region  <cit> . moreover being especially polymorphic, hla-b alleles were present in  <dig> of the pairs of alleles with |d'| =  <dig> 

the if and mse results show similar behaviour in both methods in terms of overall haplotype frequency estimation, despite the variation on the number of tested loci. these findings are in contrast to those observed by other authors  <cit> , but are quite similar to the results obtained by zhang et al.  <cit> . despite the differences between the em-based method and phase v <dig> . <dig> observed by the first authors  <cit> , the work of zhang et al.  <cit>  revealed that, in general, for most populations, there is no significant differences between the phase v <dig> . <dig> method and the em-based method when comparing estimated and true sample haplotype frequencies.

the low variability observed in arlequin v <dig>  if values when different numbers of samples were tested is in agreement with previous reports performed with em algorithms in haplotype frequency estimation in other genes  <cit> . these previous studies demonstrated that the em-based method has a very good performance under a wide range of population and data set scenarios.

analyzing the mse values of variable number of samples and loci, phase v <dig> . <dig> had the best performance, exhibiting higher mse values than arlequin v <dig>  only in the smallest group of samples .

concerning haplotypes with frequencies above  <dig> , arlequin v <dig>  ih values had a progressive decline as the number of loci increased. the decrease in haplotype frequency accuracy in arlequin v <dig>  might be the result of the presence of a high polymorphic site, like hla-b, as well as the increase in the number of loci  with variable number of polymorphic sites. the ih decrease, registered by phase v <dig> . <dig> , was very small when the number of loci was increased from  <dig> to  <dig>  suggesting once more that in phase v <dig> . <dig> the presence of hla-b, and consequently the increase of the polymorphic rate in the larger extended haplotypes, was the major factor influencing its performance.

like the if, the ih values in both methods seem to be influenced by the number of polymorphic sites and the rate of pairs of alleles in complete ld.

the best results in both algorithms were obtained when only the class ii real haplotypes with a frequency above  <dig>  were analysed. the class ii region has a low polymorphic rate when compared with the class i region, decreasing the number of possible combinations within the alleles. however, this group has less pairs on complete ld , which could suggest a low effectiveness in both methods  <cit> . no incorrect haplotypes were estimated, suggesting that for this type of samples both arlequin v <dig>  and phase v <dig> . <dig> had a very good performance. the results obtained with class ii were in concordance with the work of adkins  <cit>  in single nucleotide polymorphism  haplotypes. this author showed that both em-based methods and phase could identify all the haplotypes with a frequency above  <dig> .

the increase of polymorphic rate in the  <dig> loci haplotypes  increased the number of different real haplotypes with frequencies greater than  <dig> . one incorrect haplotype was generated in common by both methods, presenting a lower frequency when calculated by arlequin v <dig> . the presence of this haplotype  in both methods might be caused by the complete ld between b* <dig> and cw* <dig> . higher haplotypic frequencies  increase the confidence and the accuracy of computational methods on haplotype determination. consequently, it decreases the probability of identifying an incorrect haplotype.

the strong ld among the markers in this region is well known  <cit> , and was confirmed by the results displayed on table  <dig>  despite the influence of ld in the performance of computational methods  <cit> , the results demonstrated that the rate of polymorphic sites within the loci also plays an important role. the increase of ld rate was responsible for the decrease of the accuracy of these programs contrary to the findings of other authors, whose research addressed other genetic regions with both high and low ld  <cit> . in these studies, the authors worked with snp where the probability of recombination events is small despite the existing ld rate. the results obtained in the present work might be a consequence of hla system specificities. the hla high rate of heterozygosity allows a large number of combinations between different alleles  <cit> , even with the strong ld in this region. therefore it is likely that in both methods the decrease of accuracy when the ld rate increases is the result of the high variability in pairs of alleles with |d'| =  <dig> 

the algorithm of phase v <dig> . <dig> is similar to the algorithms of stephens et al.  <cit>  and stephens and donnelly  <cit> , which contains a "pseudo-gibbs sampling step"  <cit> . it should be noted that the theoretical convergence of the underlying algorithm of phase v <dig> . <dig> remains an open problem  <cit> , although the comparisons of stephens and scheet  <cit>  showed that, on average, phase v <dig> . <dig> produces more accurate haplotype estimates  than does the algorithm of stephens and donnelly  <cit> . to remedy this problem, zhang et al.  <cit>  developed a novel coalescence-guided hierarchical bayesian method wich uses a hierarchical structure to directly model the coalescence relationship among modern-day haplotypes. this method has shown to have merits compared with phase v <dig> . <dig> 

CONCLUSIONS
this work suggests that high hla haplotype frequency in the population under study is an important factor for the accuracy and performance of arlequin v <dig>  and phase v <dig> . <dig>  despite the presence of a high rate of polymorphic sites and alleles with complete ld.

arlequin v <dig>  had the best performance on haplotype inference and frequency estimation when dealing with less than  <dig> loci haplotypes. phase v <dig> . <dig> had the best overall performance both in haplotype prediction and in frequency calculation. nevertheless, in general and like reported in previous works  <cit> , the difference found in this work between phase v <dig> . <dig> and arlequin v <dig>  was insubstantial.

the best results of both algorithms were obtained when only real haplotypes with a frequency above  <dig>  were analysed.

from a practical point of view, both methods provide advantages and disadvantages to estimate hla haplotypes. arlequin v <dig>  main advantage may be the format of the input file, which does not require any transformation on the haplotypic data and supports the hla nomenclature currently used. with phase v <dig> . <dig>  the haplotypic data needs to be transformed into a numeric code, prior to running the program, and the results have to be transformed again to the original hla nomenclature. hence, data transformation can become very laborious when using large haplotypic data sets. phase v <dig> . <dig> main advantage is the fact that all the possible haplotypes are displayed in the output file, which can be useful in certain studies. this does not happen with arlequin v <dig>  where only the most frequent haplotypes  are displayed on the output file.

the present work indicates that, like with other genes and sample sizes  <cit> , computational methods can provide an effective calculation of hla haplotype frequencies by using data from unrelated individuals. these computational methods can provide an accurate prediction of haplotype phases on this particular region, despite the strong ld and high polymorphism within alleles from different hla loci. this work may present some useful information about statistical approach in studies using hla.

