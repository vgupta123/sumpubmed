BACKGROUND
the detection and avoidance of long-branch effects in phylogenetic inference has been a longstanding challenge. arising when there is unequal divergence among taxa, long-branch effects are caused by convergent and parallel changes that give rise to a systematic bias in the phylogenetic estimation procedure, producing one or more artefactual phylogenetic groupings of taxa  <cit> . while early investigations discussed long-branch effects as a significant problem for inference with parsimony, it has since been demonstrated that inference by maximum likelihood  and bayesian approaches can also be subject to long-branch effects  <cit> , even when the correct model is specified exactly  <cit> .

an extensive literature exists composed of simulation studies that have evaluated the performance of different inference methods on model trees, investigating the branch length conditions wherein long-branch effects lead to misleading results. for example, in what is classically termed the felsenstein zone, two long-branched taxa are non-sisters in a four-taxon tree. simulation studies have demonstrated that parsimony is more likely to group the long-branched non-sister taxa together  than likelihood methods. siddall  <cit>  referred to the converse zone, where two long-branched taxa are true sisters in a four-taxon tree, as the “farris zone”. simulations performed by swofford et al.  <cit>  demonstrated that along a tree-axis that includes both the felsenstein zone and the farris zone, ml outperforms parsimony overall in recovering the correct quartet topology. many subsequent simulation studies compared the performance of parsimony and ml in other model trees . as bergsten  <cit>  pointed out, the conclusions of these comparative simulation studies have been highly dependent on the specific model tree and branch length conditions subjectively chosen for individual investigations. analysis of these comparative simulation studies shows clearly that parsimony has a strong bias towards grouping long-branched taxa together, but also that ml and other probabilistic methods that in principal account for unequal branch lengths and correct for unobserved changes  <cit>  can minimize but not eliminate the risks of long-branch effects  <cit> .

in contrast to the extensive simulation studies comparing the performance of different inference methods, few analytical frameworks are available to quantify the phylogenetic utility of molecular loci for resolving specific phylogenies with unequal branch lengths. theory provided by felsenstein  <cit> , hendy and penny  <cit> , and kim  <cit>  has revealed general branch length conditions in which inference becomes inconsistent. but because these works assume a character with binary states with equal substitution rates, the inconsistency conditions identified by assuming such a simplistic model cannot be directly applied to real-life molecular loci, which typically follow much more complex molecular evolutionary models and vary in rates of evolution.

post-hoc analytical methods have been developed that detect the presence of long-branch effects in molecular data. for example, split decomposition  <cit>  with spectral analysis  <cit>  has been utilized to plot split graphs to show where conflicting signal exists in a molecular data set  <cit> , and relative apparent synapomorphy analysis  has been developed to detect problematic long branches by examining the taxon-variance plot of a molecular data set  <cit> . the taxon-variance plot has attracted some zealous criticism in several studies that report false outcomes for identifying problematic long branches  <cit> . no such method is perfect for all examples. even so, one issue with these post-hoc analytical methods is that the graphic outputs produced evaluate realized sequence data to convey a qualitative sense rather than quantification of phylogenetic utility.

recently, progress has been made towards analytical prediction of the utility of sequence data for resolving phylogenies in which long-branch attraction bias may arise. extending the work of fischer and steel  <cit> , which evaluated the sequence length needed for accurately resolving a binary four-taxon phylogenetic tree with four long subtending branches and a short internode, martyn and steel  <cit>  investigated the required sequence length to resolve a quartet in which just one subtending branch is long, rather than all four, in the presence and absence of a molecular clock. however, they also demonstrated that those results were critically dependent on the assumption that all sites are evolving at a single rate. susko  <cit>  advanced an analytical method based on laplace approximations to provide simple corrections for long-branch attraction biases in bayesian-based inference towards particular topologies; the effectiveness of the corrections was further demonstrated in simulations of four-taxon and five-taxon trees.

in this paper, we quantify an accurate prediction of utility of molecular characters for resolving a quartet phylogeny with uneven subtending branches as assessed by parsimony, by incorporating contributions toward the correct tree from any parsimony-informative sites that are consistent with the actual quartet topology . we also characterize a highly conservative lower bound of utility by incorporating contributions toward the correct tree only from those true, unobscured parsimony-informative sites . we build on the signal and noise framework of townsend et al.  <cit> , which uses the estimated substitution rates of individual molecular characters to estimate the power of a set of molecular sequences for resolving a four-taxon tree with equal subtending branch lengths. this result, applied to the poisson model of molecular evolution, was subsequently generalized by su et al.  <cit>  to apply to all standard symmetric molecular evolutionary models of nucleotide substitution up to and including the general time reversible model . herein we further generalize the signal and noise analysis by relaxing the assumption of equal subtending branch lengths for the four-taxon tree. further, we use the generalized signal and noise analysis to explore how varying branch length conditions and alternative model assumptions affect the predicted phylogenetic utility. we apply the generalized signal and noise analysis to four-taxon trees in which long-branch attraction bias arises as a consequence of unequal evolution rates or an asymmetrical topology. we demonstrate that the generalized signal and noise analysis can help identify for these example phylogenies branch length conditions in which inference is inconsistent.

theory
phylogenetic signal and noise
the markov chain of a nucleotide character under the gtr model is commonly mathematically modeled by a four-by-four substitution rate matrix q, whose element qij gives the instantaneous rate at which the nucleotide character changes from nucleotide i to nucleotide j, where j ≠ i, and i, j = t, c, a, or g . the average substitution rate of the character, λ, can be calculated as  <dig> λ=∑i∑j≠iπiqij. 

where πi  represents the equilibrium frequency of each of the four nucleotides. the probability of the nucleotide character changing from one nucleotide to another over a finite time period can then be described by a substitution probability matrix, p, whose element pij provides the probability that the character with average substitution rate λ will change from nucleotide i to nucleotide j  after time t. the substitution probability matrix can be derived from the substitution rate matrix via the equation  <dig> pλ,t=eqλt. 

equation  <dig> can be solved via eigendecomposition . using p, we track the markov chain of a nucleotide character in an ultrametric four-taxon tree with four uneven subtending branches. let m and n denote the ancestral states of the nucleotide character at the two ends of the internode, whose length in time is represented by t0; let c <dig>  c <dig>  c <dig>  and c <dig> represent the nucleotide character’s states at the terminal tips of the four subtending branches, whose lengths in time are denoted as t <dig>  t <dig>  t <dig>  and t <dig>  respectively . to allow unequal substitution rates of the character across the branches, we denote the average substitution rate of the character in the internode and the four subtending branches as λ <dig>  λ <dig>  λ <dig>  λ <dig>  and λ <dig>  respectively .figure  <dig> an unrooted four-taxon tree in an ultrametric form, with an internode of length  t
 <dig> and four subtending branches of lengths  t
 <dig>  t
 <dig>  t
 <dig>  and t
 <dig>  the ancestral states of a molecular character at the two ends of the internode are denoted as m and n. the character states at the terminal tips of the four subtending branches are denoted as c
 <dig>  c
 <dig>  c
 <dig>  and c
 <dig>  the average substitution rate of the character over the internode and the four subtending branches is denoted as λ
 <dig>  λ
 <dig>  λ
 <dig>  λ
 <dig>  and λ
 <dig>  the expected number of character state changes in the internode and the four subtending branches are thus given by λ
0
t
 <dig>  λ
1
t
 <dig>  λ
2
t
 <dig>  λ
3
t
 <dig>  and λ
4
t
 <dig>  respectively.



the four-taxon tree has three possible tip-labeled subtrees, which we denote as τ <dig>  τ <dig>  and τ <dig>  respectively; only one of the three subtrees  matches the actual quartet topology . each of the three subtrees can be supported by an “aabb” pattern of character states . a character exhibiting an aabb pattern that is consistent with the actual quartet topology  contributes to correct resolution of the four-taxon tree, while a character showing an aabb pattern that is consistent with either of the two incorrect subtrees  contributes to incorrect resolution of the tree. summing the probabilities of all possible scenarios of character state changes across the internode and subtending branches that result in a desired pattern of character states at the four terminal tips as in su et al.  <cit> , the probability of a nucleotide character showing the synapomorphic pattern is provided by yλ <dig> λ <dig> λ <dig> λ <dig> λ4;to,t <dig> t <dig> t <dig> t <dig>   <dig> =∑m∑n∑c1=c2∑c3=c4≠c1πmpmnλ <dig> t0pmc1λ <dig> t1pmc2λ <dig> t2pnc3λ <dig> t3pnc4λ <dig> t <dig>  

similarly, the probability of a character exhibiting either of the homoplasious patterns is provided by  <dig> x1λ <dig> λ <dig> λ <dig> λ <dig> λ4;to,t <dig> t <dig> t <dig> t4=∑m∑n∑c1=c3∑c2=c4≠c1πmpmnλ <dig> t0pmc1λ <dig> t1pmc2λ <dig> t2pnc3λ <dig> t3pnc4λ <dig> t <dig>  and  <dig> x2λ <dig> λ <dig> λ <dig> λ <dig> λ4;to,t <dig> t <dig> t <dig> t4=∑m∑n∑c1=c4∑c2=c3≠c1πmpmnλ <dig> t0pmc1λ <dig> t1pmc2λ <dig> t2pnc3λ <dig> t3pnc4λ <dig> t <dig>  

while the homoplasious patterns arise due to homoplasy , the synapomorphic pattern can result from either true synapomorphy, or apparent synapomorphy due to homoplasy . the probability of true synapomorphy is characterized as the probability of a signal occurring in the internode  multiplied by the probability of no subsequent state change in the four subtending branches. the probability of a signal occurring in the internode can be calculated by following a derivation similar to that presented in equations 3- <dig>  yielding  <dig> pr{a difference of states at the two ends of the internode}=∑m∑n≠mπmpmnλ <dig> t <dig>  

the probability of the signal remaining unobscured by subsequent state changes in the subtending branches can be evaluated by  <dig> przerostatechangesinthefoursubtendingbranches=e−λ1t1+λ2t2+λ3t3+λ4t <dig> . thus, the probability of true synapomorphy is the product of equations  <dig> and  <dig>   <dig> Πλ <dig> λ <dig> λ <dig> λ <dig> λ4;to,t <dig> t <dig> t <dig> t4=∑m∑n≠mπmpmnλ <dig> t0e−λ1t1+λ2t2+λ3t3+λ4t <dig>  the probability of apparent synapomorphy is thus provided by subtracting equation  <dig> from equation  <dig> 

note although the derivation of equations 3– <dig> above is presented for nucleotide characters, these equations are also applicable to amino acid characters by substituting an amino acid substitution rate matrix for the nucleotide substitution rate matrix q in equations  <dig> and  <dig>  and could also be applied to morphological characters that evolve in accord with the mk matrix  <cit> .

predicting phylogenetic utility
to simplify notation hereafter, we will suppress the routine but continuing functional dependencies on λ <dig>  λ <dig>  λ <dig>  λ <dig>  λ <dig>  t <dig>  t <dig>  t <dig>  t <dig>  and t <dig>  because parsimony uses almost exclusively the aabb patterns to inform quartet topology reconstruction, evaluating y − max for a molecular character gives an accurate quantitative measure of the character’s phylogenetic utility for resolving a quartet phylogeny as assessed by parsimony. for a given character, if y − max >  <dig>  the character has more support for the correct quartet topology than for either of the incorrect quartet topologies as assessed by parsimony, and thus by sampling more of such a character, inference via parsimony will converge to the correct topology. conversely, if y − max <  <dig>  the character has a stronger support for an incorrect topology than for the correct topology as assessed by parsimony, and thus by sampling more of such a character, inference via parsimony will not converge to the correct topology. therefore, evaluating y − max yields a quantitative measure of whether inference will be consistent under parsimony.

however, evaluating y − max for predicting phylogenetic utility and consistency conditions under probabilistic inference methods such as ml and bayesian methods faces two opposing biases. first, ml and bayesian methods can obtain additional information to resolve a quartet phylogeny—albeit of markedly lower impact per character—from some non-aabb patterns. for example, given a non-aabb pattern observed at a character that resulted from a signal in the internode having then been partially masked by noise , a probabilistic inference method will attribute likelihood to the correct topology from this character if the state changes that occurred in subtending branches are consistent enough with the model and occurred slowly enough to provide useful information. on the other hand, unlike with parsimony-based inference, not every character showing an aabb pattern is interpreted by probabilistic methods to support a quartet topology. for instance, given a synapomorphic pattern observed at a character that actually arose from an absence of state change in the internode followed by parallel state changes in sister subtending branches, a probabilistic method that classifies the site as fast-evolving will rightfully obtain little support for the correct topology from this character.

addressing the first bias as outlined in the preceding paragraph is not straightforward within the framework of signal and noise analysis, because tracking all non-aabb patterns that can have varying and ambiguous levels of support for the correct quartet topology as assessed by probabilistic inference methods is impractical and would render analysis highly cumbersome. however, the second bias as explained above can be addressed by evaluating an alternative measure of predicted utility that excludes support for the correct quartet topology due to apparent synapomorphy. such a measure can be obtained by comparing the probability of true synapomorphy only, Π, to the probability of observing either homoplasious pattern consistent with an incorrect quartet topology, max. the resultant measure, Π − max, represents a conservative lower bound of utility, since it does not include support for the correct quartet topology due to partially masked signal, which parsimony typically does not recognize but probabilistic inference methods can recognize under ideal circumstances. ultimately, because true synapomorphy represents unmasked, actual phylogenetic signal and provides unambiguous support for the correct quartet topology regardless of which inference method is concerned, in branch length conditions where Π − max >  <dig>  the strength of unmasked actual signal is greater than the strength of homoplasy that supports an incorrect topology, and therefore correct inference can likely be achieved by both parsimony and probabilistic methods.

RESULTS
example 1: predicted utility of a character in the felsenstein and “farris” zones
in demonstrating long-branch attraction by parsimony and “long-branch repulsion” by ml, huelsenbeck and hillis  <cit>  and siddall  <cit>  performed simulations for two four-taxon model trees with different branch length conditions that encompass the felsenstein zone and the farris zone, respectively. in this example study, we apply the signal and noise analysis to these two model trees to predict the phylogenetic utility of a nucleotide character in the felsenstein zone and the farris zone.

for this analysis, we assume the jukes-cantor  model—the simplest time reversible nucleotide substitution model—which both huelsenbeck and hillis  <cit>  and siddall  <cit>  used in their respective simulation studies. to be consistent with huelsenbeck and hillis  <cit>  and siddall  <cit> , we express the length of any tree branch, represented here as p, in terms of the expected probability that the nucleotide at one end of the branch differs from the nucleotide at the other end. under the jc model, the p length of a branch can be related to the branch length in time, t, and the substitution rate of the nucleotide character in the branch, λ, via the equation  <dig> p=34−34e−43λt. 

from equation  <dig>  the length of a branch can range between  <dig> and  <dig>  under the jc model.

the four-taxon tree modeled by huelsenbeck and hillis  <cit>  is shown in figure 2a. the tree’s internode and two subtending branches on the opposite sides of the internode are constrained to be equal , as are the other two subtending branches . figure 2b shows the alternative four-taxon tree modeled by siddall  <cit> . in this case, the internode and the two subtending branches on one side of the internode are constrained to be equal , so are the two subtending branches on the other side of the internode . figures 2c and d show the branch length space of the two model trees, each constructed by varying the respective tree’s three-branch length on the horizontal axis and two-branch length on the vertical axis. the felsenstein zone is in the upper-left portion of the branch length space of the huelsenbeck and hillis  <cit>  model tree, and the farris zone is in the upper-left portion of the branch length space of the siddall  <cit>  model tree.figure  <dig> two classic quartet branch length conditions in which long-branch effects can arise. a) four-taxon tree modeled by huelsenbeck and hillis  <cit> . the internode and two subtending branches labeled a are constrained to have the same length , so are the two subtending branches labeled b ; p
a and p
b represent the three-branch length and two-branch length , respectively. b) alternative four-taxon tree modeled by siddall  <cit> . the internode and two subtending branches labeled a’ are constrained to be equal in length , so are the two subtending branches labeled b’ , with p
a
’ and p
b
’ representing the alternative three-branch length and two-branch length, respectively. c) branch length space of the model tree investigated by huelsenbeck and hillis  <cit> , with the three-branch length p
a on the horizontal axis and the two-branch length p
b on the vertical axis. these axes apply to figures 3a, c, and e. the upper-left portion of this branch length space corresponds to the felsenstein zone. d) branch length space of the alternative model tree investigated by siddall  <cit> , with the alternative three-branch length p
a
’ on the horizontal axis and the alternative two-branch length p
b
’ on the vertical axis. these axes correspond to those in figures 3b, d, and f. the upper-left portion of this branch length space corresponds to the farris zone as termed by siddall  <cit> .



for the huelsenbeck and hillis  <cit>  model tree, the probability of a nucleotide character showing the synapomorphic pattern is less than that of a homoplasious pattern  < 1) in an area located in the upper-left portion of the branch length space, which corresponds to the felsenstein zone . in contrast, for the siddall  <cit>  model tree, y ∕ max >  <dig> is true in virtually the whole branch length space . for both model trees, in the uppermost and rightmost areas of the branch length space, true synapomorphy accounts for less than 10% the probability of a character showing the synapomorphic pattern  . for the siddall  <cit>  model tree, Π ∕ y <  <dig>  is also true in an additional area in the upper-left portion of the branch length space, which falls within the farris zone .figure  <dig> contour map of y ∕ max for a nucleotide character which assumes the jc model over the branch length space of a) the huelsenbeck and hillis  <cit>  model tree and b) the siddall  <cit>  model tree, with contour lines of y ∕ max = 1/ <dig>  1/ <dig>  1/ <dig>  1/ <dig>   <dig> ,  <dig>   <dig>   <dig>  and  <dig> shown if present within the respective branch length space. contour map of Π ∕ y for a nucleotide character under the jc model over the branch length space of c) the huelsenbeck and hillis  <cit>  model tree and d) the siddall  <cit>  model tree, with contour lines of Π ∕ y =  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> , and  <dig>   shown if present. contour map of Π ∕ max for a nucleotide character under the jc model over the branch length space of e) the huelsenbeck and hillis  <cit>  model tree and f) the siddall  <cit>  model tree, with contour lines of Π ∕ max = 1/ <dig>  1/ <dig>  1/ <dig>  1/ <dig>   <dig> ,  <dig>   <dig>   <dig>  and  <dig> shown if present.



for the huelsenbeck and hillis  <cit>  model tree, the probability of true synapomorphy is greater than the probability of a character exhibiting either homoplasious pattern  > 1) in an area that borders on the horizontal axis of the branch length space . for the siddall  <cit>  model tree, Π ∕ max >  <dig> is true in a similar but slightly more extended area that borders on both the horizontal and vertical axis of the branch length space .

example 2: predicted utility of a character with an identical rate across lineages for resolving an asymmetrical quartet tree
in this example, we assess the predicted utility of a nucleotide character for resolving a hypothetical four-taxon tree with an asymmetrical topology. for this analysis we consider a nucleotide character which follows the molecular clock assumption and has an equal substitution rate in the internode and four subtending branches in the four-taxon tree of interest . we assume the jc model for the nucleotide character. the four-taxon tree in question has an internode with a length in an arbitrary time unit of t0 =  <dig> ; two non-sister subtending branches have an equal length of 4t0 =  <dig>  , while the other two non-sister subtending branches both have a length of  <dig> l , where l >  <dig> 

the value of Π − max increases as a function of λ for each value of l =  <dig> ,  <dig>   <dig> , and  <dig> for the four-taxon tree until reaching a maximum at an optimal substitution rate . as λ increases further, the value of Π − max begins to decrease and then drops to zero at a threshold substitution rate . as λ increases beyond that threshold, the value of Π − max becomes negative. given each value of l, as λ increases from zero, the value of Π − max increases from zero. as the value of l increases, corresponding to an increasingly asymmetrical topology, the maximum value of Π − max decreases as do the optimal and threshold substitution rates.figure  <dig> the predicted utility Π − max versus substitution rate λ based on the jc model is plotted for l =  <dig>  , l =  <dig> , l =  <dig>  , and l =  <dig> , for the four-taxon tree as depicted in figure  <dig> in which λ
0 = λ
1 = λ
2 = λ
3 = λ
4 = λ, t
0 =  <dig> , t
1 = t
3 =  <dig> , and t
2 = t
4 =  <dig> l.



example 3: predicted utility of a character with a variable rate across lineages for resolving a symmetric quartet tree
in this example, we evaluate the predicted utility of a nucleotide character for resolving a hypothetical four-taxon tree with a symmetric topology. the four-taxon tree in question has an internode with a length  of t0 =  <dig>  and four subtending branches with an equal length of  <dig> l, where l >  <dig> . for this analysis, we again assume the jc model for the nucleotide character; however, the character does not necessarily follow a molecular clock across the quartet. we assign a fixed substitution rate of  <dig>  to two non-sister subtending branches of the four-taxon tree , and a free substitution rate of λ in the internode and the other two non-sister subtending branches of the tree .

the value of Π − max as a function of λ starting from λ =  <dig> first increases from a negative value until reaching a positive maximum at an optimal rate , across values of m =  <dig> ,  <dig>   <dig> , and  <dig> for the four-taxon tree. it then decreases monotonically as λ increases beyond the optimal rate. given each value of m, the value of Π − max is positive and close to its maximum when the substitution rate of the character is similar in the four subtending branches . as the value of m increases, corresponding to an increasingly deep internode, the maximum value of Π − max decreases, and so do the optimal rate of λ and the range of parameter λ for which the value of Π − max is positive.figure  <dig> the predicted utility Π − max versus substitution rate λ based on the jc model is plotted for l =  <dig>  , l =  <dig> , l =  <dig>  , and l =  <dig> , for the four-taxon tree as depicted in figure  <dig> in which t
0 =  <dig> , t
1 = t
2 = t
3 = t
4 = lt
 <dig>  λ
1 = λ
3 =  <dig>  and λ
0 = λ
2 = λ
4 = λ.



example 4: effects of alternative model assumptions on predicted utility
su et al.  <cit>  evaluated the impact of specifying alternative nucleotide substitution models on the predicted utility of nucleotide characters for resolving a four-taxon tree with even subtending branches, based on an analysis of five genes in  <dig> taxa of the yeast genus candida and allied teleomorph genera. similarly, here we compare how varying the model specification affects the predicted utility of a nucleotide character for resolving a four-taxon tree with uneven subtending branches due to unequal substitution rates. we perform this analysis based on the nucleotide character and the hypothetical four-taxon tree as used in example  <dig> above, with m =  <dig>  for the four-taxon tree . we assume four alternative nucleotide substitution models for the nucleotide character, including—from simple to complex—the jc model, which assumes equal substitution rates and equal base frequencies at equilibrium, the kimura 2-parameter  model, which assumes unequal transition and transversion rates and equal base frequencies, the hasegawa-kishino-yano  model, which assumes unequal transition and transversion rates and unequal base frequencies, and the gtr model, which assumes six unequal substitution rates and unequal base frequencies . the parameter values for the jc, k2p, hky, and gtr models used in this analysis are based on the parameter values of these models estimated for the actin  marker in the analysis by su et al.  <cit>  of  <dig> taxa of the yeast genus candida and allied teleomorph genera .table  <dig> 
estimated parameter values for the models for the actin  marker


jc
k2p
hky
gtr

rtc

rta

rtg

rca

rcg

rag

πt

πc

πa

πg


the value of Π − max of the character as a function of λ is highest under the jc model . the range of the parameter λ within which Π − max is positive is wider under the jc model than under the three higher parameterized models; this range differs little among the k2p, hky, and gtr models.figure  <dig> the predicted utility Π − max versus substitution rate λ is plotted based on the jc  <cit>  model , the k2p , the hky , and the gtr model , for the four-taxon tree as depicted in figure  <dig> in which t
0 =  <dig> , t
1 = t
2 = t
3 = t
4 =  <dig> , λ
1 = λ
3 =  <dig>  and λ
0 = λ
2 = λ
4 = λ. the model parameter values are presented in table  <dig> 



discussion
in this paper, we have relaxed an assumption of phylogenetic signal and noise analysis by allowing a four-taxon tree of unequal subtending branch lengths. previous analyses  <cit>  assumed a phylogenetic quartet with four subtending branches of equal lengths. although any internode has an inherent quartet structure  <cit> , not all internodes have subtending branches that have equal lengths, even without heterochrony. furthermore, sampling additional taxa can effectively reduce branch lengths  <cit> , rendering appropriate branch lengths to consider for phylogenetic informativeness shorter than the extracted quartet. while slight differences in branch lengths probably do not represent a significant violation of the theoretical assumption under the previous versions of signal and noise analysis, for internodes where all of the subtending branches have markedly different lengths, the assumption of equal branch lengths is no longer acceptable. the generality and the accuracy of the signal and noise analysis can therefore be improved by quantifying the probability of synapomorphic and homoplasious character state patterns in four subtending branches of unequal lengths. this improvement, if it could seamlessly incorporate increased taxon sampling in addition, would facilitate the application of signal and noise analysis freely and precisely to all describable internodes of phylogenetic interest.

we have also recast previous analysis so that it can characterize the probability of a true synapomorphy in a four-taxon tree, including only true synapomorphy as support for the correct quartet topology. previous signal and noise analyses  <cit>  have not distinguished true synapomorphy vs. apparent synapomorphy and include both as support for the correct quartet topology. while parsimony infers support for the correct quartet topology from both true synapomorphy and apparent synapomorphy, probabilistic inference methods can better discriminate against apparent synapomorphy by accounting for fast rates of evolution and correcting for unobserved changes  <cit> . in the meantime, however, the generalized signal and noise analysis does not quantify contributions from obscured signal at sites that are not parsimony-informative, even though probabilistic inference methods can recognize some support for the correct topology from these sites. therefore, including support for the correct quartet topology only from true, unobscured parsimony-informative sites yields a conservative lower bound for predicting phylogenetic utility.

in the first example, based on the two model quartet trees with branch length conditions that correspond to the felsenstein and “farris” zones, our analysis has characterized the probability distributions of true synapomorphy, apparent synapomorphy, and homoplasy in support for an incorrect topology in the those zones. these analysis results provide analytical predictions of the contrasting performances of parsimony and ml in the felsenstein and farris zones as shown by simulations of huelsenbeck and hillis  <cit>  and siddall  <cit> . in the felsenstein zone, parsimony is likely to give incorrect inference of the quartet topology, because support for the correct quartet topology as assessed by parsimony  is less than support for an incorrect topology in the corresponding area of the branch length space. this observation is consistent with the expectation that parsimony-informative sites that are consistent with an incorrect quartet topology are more likely to occur and accumulate if the internode is short , the rate of evolution of the character is fast , or the differences in the rate of evolution between branches is large . in contrast, ml can perform better than parsimony by gathering additional support for the correct quartet topology from partially-informative non-aabb patterns, which are not tracked by our theory. in the farris zone, parsimony is likely to yield correct inference of the quartet topology, since support for the correct quartet topology as assessed by parsimony is greater than support for either incorrect topology in the corresponding area of the branch length space. however, the strong performance of parsimony in the farris zone is in fact due to apparent synapomorphy; in the corresponding area of the branch length space, almost all support for the correct quartet topology is contributed to by apparent synapomorphy. since ml does not accrue likelihood for the correct quartet topology in the presence of apparent synapomorphy in the way that parsimony does, ml is not misled into performing as well as parsimony in the farris zone in terms of recovering the correct quartet topology.

this generalized signal and noise analysis can be applied to diverse scenarios in which unequal branch lengths can arise and potentially introduce long-branch effects. unequal branch lengths can be either caused by unequal evolution rates across lineages within the study group , or due to an asymmetrical topology, which can arise as a result of differential speciation or extinction rates and/or incomplete taxon sampling  <cit> . the signal and noise theory decouples the rate of substitution and time in characterizing the length of a branch. thus, the theory can account for differences in both substitution rates and evolution times across lineages, and it can be applied to phylogenies in which unequal branch lengths occur due to unequal rates of evolution, asymmetrical topologies, or both.

in the second example, based on a four-taxon tree with an asymmetrical topology, results of the signal and noise analysis demonstrated that the chance of correctly resolving an asymmetrical quartet phylogeny can be increased by sampling slower-evolving molecular loci; the more asymmetrical the underlying topology is, the slower-evolving the sampled molecular loci should be. rapidly-evolving molecular loci have poor predicted phylogenetic utility because at these loci, there is a higher probability of observing noise or homoplasy than actual signal. for the quartet tree used in this example study, the signal and noise analysis furthermore quantified the threshold substitution rate above which a nucleotide character may contribute a negative utility towards correct resolution of the quartet tree. in molecular phylogenetic investigations, a common practice to reduce long-branch effects is to exclude fast-evolving molecular loci—such as third codon positions—from inference analysis, based on the rationale that these loci are likely saturated or randomized  <cit> . on the other hand, third codon positions can contain a significant amount of information of the phylogenetic structure  <cit> , and removing an excessive amount of rapidly-evolving loci can lead to a significant reduction in resolution  <cit> . therefore, for an actual quartet phylogeny for which the inferred topology is suspected to result from long-branch effects, by applying the generalized signal and noise analysis to an alternative topology that is hypothesized to reflect the actual taxon relationship, one can estimate a threshold substitution rate for sampling molecular loci for overcoming the suspected long-branch effects while in the meantime minimizing the number of fast-evolving loci that are unnecessarily excluded from analysis.

in the third example, in which the substitution rate of a nucleotide character was variable across the four taxa within the study group, the signal and noise analysis demonstrated that in addition to sampling slower-evolving molecular loci, sampling loci with less variation in substitution rate across lineages is helpful for avoiding biases towards topologies that group faster-evolving non-sister branches together. the deeper the internode in question is, the more likely there is to be significant rate variation, and yet the deeper the internode is, the less variation in substitution rate across lineages the sampled molecular loci should have. at molecular loci with significant rate variation across lineages, convergent or parallel character state changes tend to accumulate along the lineages with faster substitution rates, thereby obscuring actual signal and reducing the phylogenetic utility of these loci. for the quartet tree assessed in this example, the signal and noise analysis has also quantified the range of rate variation across lineages within which a nucleotide character has a positive predicted utility towards correct quartet resolution. in phylogenetic studies, another proposed approach to reducing long-branch effects involves selecting only representative taxa with the lowest substitution rates and minimum rate variation across lineages  <cit> . however, numerous studies have suggested that increased taxonomic sampling generally leads to improved accuracy in phylogenetic inference , and excluding a large number of taxa may thus significantly decrease the accuracy of inference outcomes. therefore, in an investigation in which the inferred topology is suspected to arise due to long-branch effects, by applying the generalized signal and noise analysis to an alternative topology hypothesized to reflect the actual taxon relationship, one may estimate the desirable range of rate variation across lineages to inform taxon sampling while at the same time avoiding removing an excessive number of taxa from analysis.

lastly, in the fourth example, which compared utility prediction for the four-taxon tree in the previous example based on four alternative nucleotide substitution models , analysis results indicated that predictions of the signal and noise analysis are fairly robust to alternative model specifications, consistent with the finding of su et al.  <cit>  in quartet trees with even subtending branches. in this example based on a four-taxon tree with unequal substitution rates across lineages, the predicted utility is higher under the jc model than under the other three more complex models; but as the model parameterization increases from the k2p model to the gtr model, the predicted utility remains largely unchanged. as explained by su et al.  <cit> , in most realistic molecular data sets, there is always a certain degree of heterogeneity in model parameter values when the data are fitted to an optimal model. as the model grows in complexity, some character states, due to association with higher model parameter values, will begin to dominate the evolutionary process and thus effectively reduce the character state space. analysis results of su et al.  <cit>  also demonstrated that the predicted utility of a molecular character increases as the character state space increases . thus, specifying an overly simple model can fail to adequately account for heterogeneity in the evolutionary process and hence cause an increase of the effective character state space. consequently, the predicted utility based on an overly simple model is higher than actual. but once a model of sufficient complexity is fitted to the molecular data in question, the effective character state space is reduced closer to its actual size, and the predicted utility is more accurate. therefore, specifying increasingly more complex models will lead to decreasingly little impact on predictions of the signal and noise analysis.

CONCLUSIONS
in this paper, we have generalized phylogenetic signal and noise analysis by allowing a four-taxon tree of unequal subtending branch lengths. this generalized signal and noise analysis provides analytical prediction of utility of characters evolving at diverse rates of evolution to resolve quartet phylogenies in which unequal branch lengths arise due to unequal rates of evolution, asymmetrical topologies, or both.

