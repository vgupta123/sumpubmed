BACKGROUND
imputing missing values is crucial for molecular marker data sets generated by methods with inherent high levels of missing data, for example genotyping-by-sequencing   <cit> . this also holds for approaches aiming to reduce genotyping expenses by combining high-density marker profiling of a population subsample with medium-density marker profiling for the majority of population members. accurate imputation is important for maximizing the power of detecting causal polymorphisms underlying complex traits  <cit> .

imputation algorithms can be classified into map-dependent and map-independent algorithms. map-dependent methods impute missing values utilizing available linkage information  <cit> . in contrast, map-independent algorithms do not use the linear order of markers  <cit> . the accuracy of missing value imputation is expected to be lower for map-independent algorithms in comparison to map-dependent ones which exploit additional information. the magnitude of such differences in accuracy, however, is not known. despite their lower expected accuracy, map-independent algorithms are relevant for species for which dense and high-quality genetic or physical maps are absent.

several factors can influence the accuracy of imputing missing values for particular markers  <cit> . increasing reference population size enhances imputation accuracy  <cit> . the accuracy of imputation benefits also if genotypic information is available for markers tightly linked to those being imputed  <cit> . in addition, allele frequency impacts the imputation of missing sites, with lower expected imputation accuracy for rare variants  <cit> . the interplay between population size, allele frequency, and linkage disequilibrium, however, has not yet been examined in detail despite the potential interactions of these factors.

imputed molecular marker data are often used for population genetic and quantitative genetic studies  <cit> . the impact of imputation accuracy on diversity analyses has been investigated by analyzing gbs data from rice, maize, and wheat with a map-independent algorithm  <cit> . the findings revealed that estimating heterozygosity, inbreeding coefficients, and genetic differentiation were substantially biased when missing values were imputed. the effect of imputing missing values in gbs data for the purpose of genomic selection has been examined empirically in maize, wheat, and barley  <cit> . the prediction accuracy of genomic selection increased if missing values were imputed in contrast to a scenario excluding the missing marker data. the power to detect quantitative trait loci  increased in genome-wide association mapping studies in human and animal populations if missing values were imputed  <cit> . analyzing the linkage disequilibrium between true and imputed snps in barley additionally supported the idea that qtl detection may be improved by marker imputation in plant populations  <cit> . nevertheless, in-depth studies determining the impact of imputing missing values on the power of genome-wide association mapping in plants are still lacking.

here, we draw upon published data derived from a diversity panel consisting of  <dig> european wheat varieties  <cit> . all lines had been genotyped with 9 k  <cit>  and 90 k snp arrays  <cit> , which allowed us to simulate low to high marker density and gbs-like imputation scenarios. the main goal of our study was to investigate the implementation, prospects, and limits of marker data imputation for quantitative genetic studies. in particular, we  contrasted the imputation accuracy of one map-independent and three map-dependent algorithms under varying reference population sizes,  studied the influence of linkage disequilibrium and minor allele frequency on imputation accuracy, and  investigated the effect of imputation on the precision of diversity studies, the accuracy of genomic selection, and on the power of qtl detection in genome-wide association mapping.

methods
datasets
we used genotypic information based on previously published 90 k snp array data from  <dig> european wheat varieties  <cit> . in addition, we used information on marker positions of snps which were present on a previously published 9 k snp array  <cit> . two of the included lines did not differ with respect to their 9 k snp array profile. hence, one of them, variety exotic according to  <cit>  was excluded from analysis. after performing quality checks to exclude those markers that were monomorphic and for which genetic map information was unavailable  <cit> ,  <dig>  snps remained for the 90 k snp array and  <dig>  snps remained for the 9 k snp array .

imputation scenarios
we randomly divided the  <dig> individual lines into a reference and a test population in order to evaluate the effects of low to high marker density imputation. we assumed that the reference population was fingerprinted with the 90 k snp array and the test population only with the 9 k snp array . marker data for the  <dig>  snps present in the 90 k but not in the 9 k snp marker data sets were treated as missing values for lines from the test population, and represented the targets for imputation. we assumed different reference population sizes of  <dig>   <dig>   <dig>  and  <dig> out of  <dig> lines. the sampling for each reference population size was repeated  <dig> times in order to reduce random error  <cit> . data sets generated in this way are referred to as low to high marker density data in the following.

we also implemented imputation on randomly excluded empirical data for mimicking gbs-derived marker data. for each line within the population of  <dig> lines, the 90 k snp array marker data were randomly masked with the four missing value levels of  <dig> %,  <dig> %,  <dig> %, and  <dig> %. these four levels correspond to the missing data rates for the four scales of low to high marker density imputation with  <dig>   <dig>   <dig>  and  <dig> out of  <dig> lines in the reference population . the resulting randomly depleted data sets are here forth referred to as gbs-like marker data.

imputation approaches
we used three map-dependent imputation algorithms which have been widely used in animal and plant genetics . in addition, we applied one map-independent algorithm . random forest regression had performed best among  <dig> map-independent methods according to a recent study  <cit> .

the beagle algorithm  <cit>  exploits hidden markov models  to infer haplotypes of individual lines and to impute missing values. first, data completion is initialized by imputing the missing values based upon allele frequencies with random phasing of the haplotypes of the individual lines. the initial data set is then used to build localized haplotype-cluster models, which represent a special class of hmm. each model proceeds along a chromosome and has the same number of levels as the number of markers. at each level, the hidden states are the clusters of haplotypes  <cit> . the emitted symbols are the alleles. a forward-backward algorithm  <cit>  is applied to estimate the probabilities of each possible haplotype based on the genotype information. then, new haplotypes for the individuals are sampled according to the conditional probabilities as input for the next iteration. the procedure is repeated until the final iteration, where the viterbi algorithm  <cit>  is applied to infer the most-likely haplotypes for all individuals. thus, the missing data points are imputed simultaneously in this step.

the fimpute population-based algorithm  <cit>  is based on a haplotype-matching process which assumes that all individuals in the population are related. sliding windows are used to search for consistent haplotype segments assuming that each imputed individual has a recent common ancestor within the reference population. the initial window size is large and moves along each chromosome in steps with a certain overlap. then, the window size is steadily reduced as the procedure is repeated. finally, the most likely haplotype is determined for each individual line based on the frequency of haplotypes in the reference population. moreover, the number of hits from the window analysis is computed and the missing data points are imputed.

the impute <dig> algorithm  <cit>  is an enhanced version of the impute <dig> algorithm  <cit>  and is based on hmm and markov chain monte carlo  iterations. it differs from beagle mainly in two points. first, it separates the procedures of inferring haplotypes and imputing missing genotypes. second, it divides the data into  markers with information present in both the reference and the test set , and  markers with information present only in the reference set . beagle in contrast builds a joint model for all individual lines at all loci. the algorithm impute <dig> starts by guessing the haplotypes in the t part and then performs a number of mcmc iterations. the first step in each iteration involves the loci of the t part. for each individual line, new haplotype pairs are sampled based on the probability derived from the genotype and the currently estimated haplotypes of all other individual lines, in addition to a scale parameter. in the second step, missing alleles in the u part are then imputed based on the probability derived from the results of the calculation in the first step.

the random forest algorithm is an advanced machine learning approach  <cit> . molecular markers are first sorted from the lowest to highest missing data levels. then, the missing values are initialized through a simple imputation method  and the random forest regression model is fitted and iterated. for each marker vector y containing missing values,  <dig> regression trees are grown using the non-missing values via bootstrapping. at each node in each tree, a random sample of n− <dig> predictors, that is, other markers at the same row of the missing part of y, is used as splitting variables, where n refers to the number of markers. the terminal node of each tree gives a prediction of the missing part of y. then, the means of predictions obtained in all regression trees are taken as the imputed values. the above steps are repeated until convergence or  <dig> times at maximum.

imputation accuracy
we used the correlation  between true and imputed marker profiles as the parameter to estimate imputation accuracy. this metric is recommended because it efficiently measures the imputation accuracy for rare variation  <cit>  and is related to the power of detection of genome-wide association scans  <cit> . missing data points in the original data set, which are not caused by masking, were excluded from the evaluation.

factors affecting the imputation accuracy
we used the r <dig> statistic  <cit>  as a measure of linkage disequilibrium  and examined the association between imputation accuracy and maximum ld between the imputed and observed markers. the values of r <dig> were estimated as r2 =  − pp)/ppp), where p is the frequency of haplotype ab and p, p, p, p is the allele frequencies of two bi-allele loci. furthermore, we studied the association between minor allele frequency  and imputation accuracy.

effect of imputation on the estimation of rogers’ distance
we studied the effects of imputation on estimating rogers’ distances among pairs of genotypes . rd was used as genetic distance measure because it is linearly related to the coefficient of co-ancestry for homozygous lines  <cit>  and was estimated as rd=1m∑i=1m12∑j=1nipij−qij <dig>  where pij and qij are allele frequencies of the j th allele at the i th locus in the two individuals under consideration, ni is the number of alleles at the i th locus, and m refers to the number of loci. for the low to high marker density imputation scenario, we first calculated the correlation between the rd matrices estimated by the original 90 k and original 9 k snp marker data as a benchmark. we then estimated the correlations between rd matrices based on different imputed low to high density marker data sets and the original 90 k snp marker data. here, the comparison was exclusively based on imputed markers in data for the lines from the test population in order to focus solely on the accuracy of imputed marker values. significance of the correlations between rd matrices was tested according to a mantel test  <cit> .

since there exist no markers without missing values in the gbs-like marker data sets generated by random depletion, we instead first estimated rd matrices among pairs of genotypes based on the genotypic profiles by omitting for each pair of lines markers with missing values. we then calculated the correlation between non-imputed rd matrices and the rd matrices estimated using the original 90 k snp marker data. we subsequently estimated the correlations between rd matrices based on different imputed gbs-like marker data sets and the original 90 k snp marker data. here, the comparison was based on individual lines from the total population comprising  <dig> genotypes.

effect of imputation on genomic selection
we performed simulations to study the effect of imputation on the prediction accuracy of genomic selection. heritability was assumed to be  <dig> . every marker was set to contribute equally  to the total genetic variance in order to mimic a genetic architecture typical for complex traits such as grain yield. to investigate the effects of imputation accuracy on genomic selection, we calculated accuracies of prediction using imputed low to high marker density data sets derived from the four different imputation algorithms, four different reference population scales, and ten technical replications. for low to high marker density imputation, the results were then compared with the accuracies of prediction by ridge regression best linear unbiased prediction   <cit>  using the original 9 k and original 90 k snp data sets. for the gbs-like scenario, we estimated the genomic relatedness matrix of the total population based on the randomly depleted 90 k snp data sets without imputation, and then used the genomic best linear unbiased prediction  model to predict genotypic values as outlined in detail elsewhere  <cit> . the accuracies of prediction of gblup were compared to those calculated based on the different imputed marker data panels. it is important to note that gblup and rr-blup are equivalent  <cit>  but gblup facilitates a more proper handling of missing data for the gbs-like scenario.

effect of imputation on genome-wide association scans
we further performed a simulation study to investigate the effect of imputation on genome-wide association mapping. heritability was set again to  <dig> . simulation was performed assuming one qtl explaining 10% of the genetic variance for which a perfect marker was available in the 90 k, but not in the 9 k snp array. the remaining  <dig>  markers were assumed to contribute equally  to the remaining genetic variance. the maf of the qtl was chosen to be larger than  <dig> .

for low to high marker density imputation, we selected snps with different levels of ld  between the qtl and the most closely linked markers in the 9 k snp data set. we compared the detection frequencies of qtls in the following  <dig> scenarios:  in the total population fingerprinted with the original 90 k snp marker data,  in the reference population fingerprinted with the original 90 k snp array, and  in the total panel of  <dig> lines for which non-available 90 k snp marker data had been imputed. in addition, the detection frequencies of the most closely linked snp markers present in the 9 k data set from the total population was included in the comparison.

for the gbs-like imputation scenario, also three levels of ld were considered. here, ld was measured between the qtl and the most closely linked markers in the original 90 k snp data set. we compared the detection frequencies of the qtl in the following  <dig> scenarios:  in the total population fingerprinted with the original 90 k snp marker data set,  in the assumed available genotypic profiles of the total population of  <dig> lines irrespective of imputation, and  in the total panel for which non-available 90 k snp array data had been imputed by three imputation approaches.

genome-wide association mapping was performed based on a linear mixed model approach  <cit> . the model can be described as y = μ + αm + xg + e, where y is the vector of simulated trait values for each genotype, μ is the vector of common intercept terms, m is the effect of the marker being tested, α denotes the vector of scores of the marker, g is the vector of genotype effects with the corresponding design matrix x and e is a residual term. the marker effect was assumed to be fixed, while all other effects were assumed to be random. correction for population stratification was done by assuming g~n <dig> kσg <dig>  where k is a kinship matrix estimated as  <dig> minus the rd and σg <dig> is the genotypic variance estimated by a maximum likelihood  approach. significance of marker-trait associations was tested based on the wald-f statistic.

RESULTS
accuracy of imputing missing values with map-dependent and independent algorithms
the accuracy of imputing missing values was quantified for different algorithms by estimating the correlation between the original high density 90 k snp marker profiles and the imputed marker profiles . in this scenario, the markers for which missing values were imputed were the ones included in the 90 k snp but not in the 9 k snp array. the map-dependent methods beagle, fimpute, and impute <dig> led to higher imputation accuracies than the map-independent method random forest . imputation accuracy benefited from increasing the size of the reference population. nevertheless, even for the smallest reference population size of  <dig> out of  <dig>  the average correlation between true and imputed marker profiles amounted up to  <dig>  for impute <dig> table  <dig> 
accuracies of imputing measured as average correlations  between observed and estimated marker genotypes



algorithm
ref 50*
ref 100*
ref 200*
ref 300*

cor
cor
cor
cor
map- dependent  and map-independent  algorithms were applied with reference population sizes of  <dig>   <dig>   <dig>  and  <dig> lines out of  <dig>  and imputing was performed for a low to high marker density and for a gbs-like data scenario.

*for gbs-like imputation scenarios, ref  <dig>  ref  <dig>  ref  <dig>  and ref  <dig> refer to missing value rates  <dig> %;  <dig> %;  <dig> %;  <dig> % for all lines of the population, corresponding to scenarios with reference population sizes of  <dig>   <dig>   <dig>  and  <dig>  of the total of  <dig> lines.



we contrasted the above scenario with a scenario mimicking imputation of missing values for genotyping by sequencing -like data sets . estimated values of correlations between true and imputed marker profiles for gbs-like data were consistently higher than for imputing from low to high density marker profiles. the only exceptions were results obtained with the algorithms fimpute, impute <dig> and random forest for the smallest reference population size of  <dig> out of  <dig>  interestingly, the accuracy of imputing missing values benefited from an increase in the reference population size more for the gbs-like than the low to high imputation scenario . furthermore, we observed different rankings among algorithms comparing the two imputation scenarios.

imputation accuracy is influenced by linkage disequilibrium and minor allele frequency
average ld among adjacent loci in the total population amounted to  <dig>  with a standard deviation of  <dig>  . we analyzed the influence of ld and maf on imputation accuracy with varying reference population sizes. figure  <dig> summarizes the results for a reference population size of  <dig> out of  <dig> individuals for the low to high density scenario. similar trends were observed for all other reference population sizes independent from the applied imputation scenario .figure  <dig> 
linkage disequilibrium influences the accuracy of imputing missing values. the relationship between linkage disequilibrium  and the average correlation between observed and imputed genotypic data, as calculated using map-dependent  and map-independent  imputation algorithms, for a reference population size of  <dig> out of  <dig> lines. trends are shown as boxplot displays separately for three minor allele frequency  classes.



the impact of ld on the accuracy of imputing missing values was examined separately for three different maf classes . we focused on ld between snps from the 90 k marker data set and those from the 9 k marker data set that were most closely linked to them. the average maf in the total population amounted to  <dig>  with a standard deviation of  <dig> . the imputation accuracy improved non-linearly with increasing ld between the 90 k array snps and most closely linked 9 k array snp for all four applied imputation algorithms irrespective of the maf class. the coefficient of variation for accuracy of imputing missing values decreased substantially with increasing ld for all map-dependent methods. this trend was less pronounced for the map-independent method random forest.

we further studied the influence of the maf on the correlation between true and imputed marker profiles separately for four classes of ld . despite higher average correlations between true and imputed marker profiles for higher ld classes, we observed that the accuracy of imputing missing values increased with increasing frequencies of the minor allele irrespectively of the extent of ld. this trend was, however, by far less pronounced than the influence of ld on the accuracy of imputing missing values.

effect of imputation accuracy on estimated landscape of relatedness
for the low to high density marker imputation scenario, we used the correlation of all pairwise rogers’ distances  based on the original 9 k in comparison to the original 90 k snp array as benchmark. the correlation amounted to  <dig>  . this value was not reached by imputing missing values with the map-independent algorithm random forest. in contrast, the correlation of rd estimated based on imputed and observed marker data was  <dig>  for the map-dependent algorithm impute <dig> even for the smallest reference population size  <dig> out of  <dig> .table  <dig> 
correlations between rogers’ distance matrices of the individual lines of the test population



data set
ref 50
ref 100
ref 200
ref 300

cor
cor
cor
cor
estimates are based solely on imputed parts of data sets  and the original 90 k snp data set, as well as the correlation between rogers’ distance matrices of the original 9 k and original 90 k snp data sets. different imputed low to high marker density data sets were generated by map- dependent  and map-independent  imputation algorithms for reference populations of  <dig>   <dig>   <dig>  and  <dig> out of  <dig> lines. all correlations were significantly larger than zero  according to a mantel test.



for the gbs-like imputation scenario, the correlation between rd matrices between randomly depleted 90 k snp marker data without imputation and the original 90 k snp data set was regarded as benchmark. for imputation with the map-independent method random forest, the benchmark was not reached with missing data rates of  <dig> % or  <dig> % . in contrast, with imputation by either of the three map-dependent methods beagle, fimpute, and impute <dig>  the correlation between rd estimates based on imputed and original  <dig> snp data was higher than the respective benchmark for all missing data levels.

effect of imputation on the accuracy of prediction of genomic selection
to examine the impact of imputing missing marker data on the accuracy of prediction of genomic selection, we simulated a scenario for a complex trait. we used the accuracy of prediction realized with the original 9 k and the original 90 k snp data sets as points of reference for the low to high density marker scenario. the accuracy of prediction for the total population increased by only 7%  when using the full 90 k instead of the 9 k snp marker profiles . the accuracy of prediction of genomic selection based on the original 9 k snp marker data was outperformed by imputing missing values with the map-independent algorithm random forest only when a reference population size of  <dig> out of  <dig> individual lines was used. in contrast, the accuracy of prediction of genomic selection based on the data sets imputed with the map-dependent algorithm impute <dig> outperformed the accuracy of prediction of genomic selection based on the original 9 k snp marker data even with a small reference population size of  <dig> out of  <dig> individual lines.figure  <dig> 
imputing from low to high density has a limited effect on the accuracy of genomic selection. correlation between results of genomic selection based on true and predicted genotypic values applying genomic selection for the original 90 k  and 9 k snp data sets  for the total  <dig> lines, as well as for imputing low to high density marker data applying map-dependent  and map-independent  imputation algorithms, for reference population sizes  <dig>   <dig>   <dig>  and  <dig> out of  <dig> lines.



as a benchmark to evaluate the accuracy of genomic selection based on imputed gbs-like data sets, we used the accuracy of prediction realized with a gblup approach based on a kinship matrix estimated with original 90 k snp marker data or the non-imputed marker data. the accuracy of the gblup approach based on the original 90 k snp marker data amounted to  <dig>  . prediction accuracies of gbs-like data sets profited slightly when missing marker data were imputed . applying map-dependent as well as map-independent algorithms led to higher accuracies of prediction as compared to the gblup across all examined scenarios with missing data rates of  <dig> %,  <dig> %,  <dig> % and  <dig> %.figure  <dig> 
imputing improves accuracy of prediction of genomic selection based on gbs-like data sets. correlation between true and predicted genotypic values applying genomic selection for the original 90 k snp data set , as well as for genotype-by-sequencing-like data sets where missing values were not imputed  or were imputed with map-dependent  and map-independent  algorithms for rates of missing values of  <dig> %,  <dig> %,  <dig> % and  <dig> % in the total population of  <dig> lines.



effect of imputation accuracy on power of association mapping
finally, we approached the impact of missing data imputation on the power of association mapping in a simulation study. we assumed the presence of a qtl with a marker allele frequency above  <dig>  which explained 10% of the genotypic variation. such a qtl could be detected in more than 80% of the performed association mapping runs based on the original 90 k snp marker data for the whole population. replacing the original 90 k snp marker data by imputed data starting from 9 k snp marker profiles led to reduced qtl detection power for almost all tested reference population sizes and ld values . nevertheless, imputation using the map-dependent methods increased the power of association mapping in comparison to qtl detection based on non-imputed marker profiles. this increase was more pronounced if a snp with high ld to the qtl was covered within the 9 k snp marker data. in comparison, imputation using the map-independent random forest method increased the power of qtl detection only slightly, except that a marker within the 9 k snp data set was tightly linked to the qtl. similar trends as for the low to high marker density imputation scenario were observed for the gbs-like scenario .figure  <dig> 
imputing from low to high marker density increases the power of association mapping. detection frequency of a major qtl explaining 10% of the genotypic variance in the total population based on the 90 k snp data set  and the snp present in the 9 k data set most closely linked to the snp in the 90 k data set . detection frequency of a major qtl in the reference population with sizes from  <dig> to  <dig> individuals fingerprinted with the 90 k snp array . detection frequency of major qtl with varying degrees of linkage disequilibrium  between the qtl and closest linked 9 k snp marker estimated in the total panel for which depleted 90 k snp array data have been imputed for the test population with map- dependent  and map-independent  algorithms for the reference population sizes of  <dig>   <dig>   <dig>  and  <dig> out of  <dig> lines.



discussion
in crop improvement programs, molecular markers are employed for  studying the relationship among lines  <cit> ,  qtl mapping in breeding populations  <cit> ,  marker-assisted foreground- and background selection  <cit> , and  genomic selection  <cit> . in this context, the profitability of applying molecular markers strongly depends on the marker density required to achieve the intended purpose and the costs of fingerprinting at this marker density per genotype  <cit> . one possible strategy to reduce the total costs of such studies encompasses fingerprinting of only a core panel of lines to full depth with a dense marker platform coupled with genotyping of the entire breeding population with less dense and low-cost marker techniques . low and high density fingerprints are then combined in a second step using imputation algorithms to generate marker data sets for further analysis  <cit> . the main goal of our study was to investigate the implementation, prospects, and limits of marker imputation for quantitative genetic studies using experimental data collected from a representative sample of european wheat lines  <cit> .figure  <dig> 
strategy for molecular breeding of wheat. we suggest combining high-density genotyping of a core set of wheat lines with low density and low cost fingerprinting of the entire breeding population followed by imputing of missing marker data for the subsequent quantitative genetic analyses.



imputation accuracy benefits from high-quality physical and genetic maps in wheat
comparing the performance of different imputation approaches, we observed substantially higher correlations between true and estimated marker profiles for map-dependent than for map-independent imputation methods . this can be explained by the use of haplotype information in the map-dependent approaches  <cit> . our findings thus clearly stress the importance of the availability of high-quality physical  and genetic maps  for crops in order to implement imputation  in plant breeding. in this light, an ordered draft sequence of the hexaploid bread wheat genome has recently been released  <cit> . moreover, considerable effort has been devoted to develop dense consensus maps for wheat  <cit> . relevant physical and genetic map information is thus becoming available in order to support molecular wheat breeding strategies involving imputation. hence, we focus our discussion on the results generated for map-dependent methods. for minor crops without detailed map information, map-independent imputation might still seem an option. however, its clear limitations require careful consideration. for instance, the genetic relatedness among genotypes will be biased when diversity is calculated based on genomic data compiled by map-independent imputation .

implementation of imputation strategy in wheat
in accordance with previous findings  <cit> , we observed that imputation accuracy strongly depended on ld between the markers in the reference panel and the markers to be imputed . in contrast, allele frequency impacted imputation accuracy only marginally if the low density panel contained markers that exhibited at least moderate levels of ld  with the imputed markers in the high density panel . average r <dig> values of markers with distances of up to  <dig>  cm amounted to only  <dig>  with a 25% quantile of  <dig>  in our panel of european wheat lines . this fast ld decay in our european elite wheat panel is surprising as ld is expected to decrease substantially slower in wheat as a selfing species  <cit>  in comparison to an outcrossing crop such as maize  <cit> . taking the decay of ld and the length of the genetic map of wheat of around  <dig>  cm into account  <cit> , and focusing on the gene space only, one can estimate how many markers will be needed to be determined at minimum. for a scenario involving rare alleles, approximately  <dig>  markers would be required in order to facilitate high imputation accuracy.

a previous study combining experimental data of a cattle population with computer simulations  <cit>  suggested that an optimal composition of the reference population could increase imputation accuracy. we examined this issue in our study by inspecting the association between the diversity of the reference population measured as the average rd and the imputation accuracy. for all sizes of the reference population, we observed moderate correlations with an average value of r =  <dig> . this indeed hints to the possibility to enhance the imputation accuracy via an optimal composition of the reference population. a more detailed analysis of this prospect in our current study, however, is hindered by the lack of deep genotyping information that would be required to optimize the composition of the reference population  <cit> .

influence of missing site structure on imputation accuracy
the distribution of missing marker data points also impacted the accuracy of imputation . random missing data, as applicable for our gbs-like data sets  <cit> , facilitated higher imputation accuracy compared to blocks of missing marker data. the relative advantages or disadvantages of the diverse marker platforms available, however, depend ultimately also on many other factors such as e.g. costs per marker data point, distribution of markers, as well as potential ascertainment bias  <cit>  that cannot be discussed in the framework of this study.

association mapping profited most from imputation of missing values
marker densities only marginally affect the accuracies of genomic selection for complex traits. typically, a plateau of accuracy is reached with a few hundred markers for bi-parental populations  <cit>  and with a couple of thousand markers for diversity panels  <cit> . even slightly lower numbers of markers have been recommended to reliably portray genetic relationships  <cit> . in accordance with these findings, we observed that accuracies of prediction of genomic selection or relatedness estimation could profit only marginally from imputing missing marker data .

in contrast, association mapping is strongly influenced by the marker density  <cit> , as other than genome-wide prediction it focuses on one qtl at a time  <cit> . therefore, missing marker data at a particular locus cannot be compensated by other closely linked loci, which leads to a strong impact on the power of qtl detection  <cit> . consistent with this expectation, we observed that the power of association mapping strongly benefited from imputing missing marker data . consequently, for association mapping in breeding populations, substantial added value can be generated by complementing routine genotyping performed on an economic marker platform with high density genotyping of a core set of lines for subsequent data imputation. the high density marker data could for instance be generated by re-sequencing, as has been implemented for soybean  <cit>  or maize  <cit> .

in wheat, several relevant agronomic traits such as flowering time  <cit> , plant height  <cit> , abiotic stress tolerance  <cit> , and disease resistances  <cit>  are expected to be controlled by large effect qtl. such a genetic architecture with large effect qtls enables efficient marker-assisted selection. association mapping can be considered as a promising approach to identify further functional markers in breeding populations  <cit> . the identified functional markers can be efficiently combined with genome-wide prediction approaches to bridge the gap between marker-assisted and genomic selection  <cit> .

CONCLUSIONS
from the examined quantitative genetic applications, association mapping profited most from imputing missing values. association mapping is valuable for traits controlled by large effect qtls, which is the case for a number of the economic important traits in wheat. consequently, routine implementation of marker imputation provides a powerful tool for marker-assisted wheat improvement.

additional files
additional file 1: figure s <dig>  generation of simulated low to high marker density and gbs-like snp marker data sets. for low to high marker density data simulation, the  <dig> lines were divided into a reference and a test population, for which availability of 90 k or 9 k snp marker data sets, respectively, was assumed. thus, data for snps present in the 90 k but not in the 9 k snp marker data sets were the target for imputation. sizes of the reference population were set to  <dig>   <dig>   <dig>  and  <dig> out of  <dig> lines. further, genotyping-by-sequencing-derived-mimicking data sets were generated by randomly depleting  <dig> %,  <dig> %,  <dig> %,  <dig> % of marker information from 90 k data sets for individual lines, thus being comparable to the low to high marker density scenarios involving  <dig>   <dig>   <dig>  and  <dig> reference lines.

additional file 2: figure s <dig>  rapid decay of linkage disequilibrium with genetic map distance. distribution of linkage disequilibrium measured as r <dig> over different genetic map distance classes between snp marker pairs determined for  <dig> wheat lines. no. pairs represents the amount of snp pairs within each distance class.

additional file 3: figure s <dig>  minor allele frequency impacts the accuracy of imputing missing values. the relationship between minor allele frequencies of 90 k snps and average correlations between observed and imputed genotypic data, calculated using map-dependent  and map-independent  algorithms for a reference population size of  <dig> individuals. trends are shown as boxplots for four classes of linkage disequilibrium  levels between 90 k snps and the respective most closely linked 9 k snp.

additional file 4: table s <dig>  correlation between rogers’ distance matrices for imputation in a gbs-like scenario.

additional file 5: figure s <dig>  influence of imputing for gbs-like data sets on power of association mapping. detection frequency of a major qtl explaining 10% of the genotypic variance in the total population fingerprinted with the 90 k snp array . detection frequency of a major qtl in the available genotypic profiles of genotyping-by-sequencing like data sets with missing rates varying from  <dig> % to  <dig> % . detection frequency of major qtl with varying degree of linkage disequilibrium  between the qtl and closest linked snp marker estimated in the total panel for which missing genotyping-by-sequencing like array data have been imputed with four algorithms  based on four different missing rates .



abbreviations
gbsgenotyping-by-sequencing

qtlquantitative trait locus

snpsingle nucleotide polymorphism

hmmhidden markov models

mcmcmarkov chain monte carlo

corcorrelation

ldlinkage disequilibrium

mafminor allele frequency

rdrogers’ distances

rr-blupridge regression best linear unbiased prediction

gblupgenomic best linear unbiased prediction

remlrestricted maximum likelihood

cmcentimorgan

competing interests

the authors declare that they have no competing interests.

authors’ contributions

conceived and designed the experiments: sh, yj, yz, and jcr. analyzed the data: sh. contributed reagents/ materials/analysis tools: rb, ee. wrote the paper: sh, yj, yz, mfm, tfs, and jcr. all authors read and approved the final manuscript.

the genotyping data were generated within the frames of the projects gabi-wheat and valid  funded within the plant biotechnology program of the german federal ministry of education and research . the funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.
