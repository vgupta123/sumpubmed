BACKGROUND
tumor development is driven by oncogenic alleles created by somatic mutations  <cit> . these alleles are present in a tumor sample at different fractions, resulting from a history of clonal expansion  <cit> . obtaining accurate estimation of variant allele fractions  has become a critical step towards delineating the clonal architecture of a tumor sample and identifying driver mutations that promote clonal expansion .

despite rapid progress in the next generation sequencing , challenges remain in accurately estimating vafs. at a sequencing coverage of 50-100x, such as those obtained from standard whole-genome sequencing  or whole-exome sequencing, it is difficult to distinguish sub-clonal difference based on allele fractions estimated from single nucleotide variants  and small indels  <cit> . at deeper  coverage, it is feasible to distinguish a few clones . unfortunately, obtaining and analyzing such deep coverage at a whole-genome scale is still prohibitively expensive. even at such high coverage, substantial variations in vafs have been observed among variants from the same clone, making it challenging to infer the number of clones and assign variants to clones  <cit> . megabase  long chromosomal aberrations have long been utilized in pathology laboratories to characterize heterogeneity in a tumor sample  <cit> . recently, they have been utilized to perform early detection in circulating cell-free dna samples  <cit> . industrial scale application of paired-end short-insert ngs has made it possible to extend such characterization to smaller svs that are of kilobase  in length  <cit> . most ngs dna libraries have higher physical coverage than sequence coverage, i.e., the dna insert sizes are more than twice longer than the read lengths. this makes structural variants , including small  svs and balanced svs, more accurate targets than snvs and indels for vaf estimation.

it is shown from wgs that there are typically tens to hundreds of somatic svs in a genomically instable colorectal or breast cancer genome . potentially more exist at sub-clonal levels in a heterogeneous sample  <cit> . therefore, enabling vaf estimation of svs can substantially impact mutational profiling and tumor heterogeneity analysis.

unfortunately, it is not straightforward to quantify the amount of evidences that is specifically associated with an sv allele from sequence alignments, which are usually obtained from aligning individual reads or read pairs to the human reference genome  <cit> . depending on the type of sv and the results of alignment, signals that indicate the presence of an sv may appear in several different forms such as read depth, discordant read pairing, read split-alignment, end-clipping, unmapped read and so on  <cit> . many tools only utilize one form of signal  <cit> . for example, theta  <cit>  and absolute  <cit>  utilize only read depth  from large  copy number variants . thus, they cannot be applied to estimate the allele fraction of balanced svs such as inversions and reciprocal translocations. they are also limited in measuring smaller svs, which often occur more frequently than larger svs. breakdancer  <cit>  utilizes only discordant read pairs, while crest  <cit>  and pindel  <cit>  utilize only split-reads. several recent tools such as genomestrip  <cit> , delly  <cit>  and erds  <cit>  utilize two or more signals. however, they do not have an integrative model that simultaneously explains multiple forms of signals introduced by an sv and are geared towards identifying discrete sv genotypes in normal diploid genomes. clonehd  <cit>  utilized both snvs and cnvs in a hierarchical model for probabilistic inference, but it did not utilize other types of svs. to our best knowledge, no method has been proposed to estimate continuous vaf for svs in heterogeneous tumor samples.

we present in this paper, a maximum-likelihood method and a software tool called breakdown that aim to address the aforementioned challenges in estimating vaf for sv in a heterogeneous tumor sample. our method analytically integrates  <dig> forms of sv signals: read depth, discordant read pairing and end-clipping and thus considers more evidences than any existing tools. our formulation expands beyond existing work that assumes monoclonality and allows us to include any svs in clonal heterogeneity inference, an improvement over previous investigations that involved only snvs  or large cnvs. as a stand-alone tool, breakdown can be applied in a ngs data analysis pipeline to enhance the accuracy and estimate vafs for svs nominated by any other discovery tools. we assessed the performance of breakdown using both simulated and real cancer genome sequencing data and found that it can produce consistently satisfactory results. breakdown was designed to be self-adaptive to different conditions , normalized against biases , and robust to outliers. it builds in a scoring system that is calibrated with validation data and can accurately inform true error probabilities.

RESULTS
a maximum likelihood vaf estimator
we have developed an approach using maximum likelihood, which estimates the vaf of an sv that best explains the associated alignment data. briefly, our approach includes the following five steps . first, parameters such as average coverage and insert size are initialized based on measures from randomly selected regions of the genome. read pairs encompassing an sv are extracted from the data  . second, these read pairs are classified into three groups: a) normal, b) discordant and c) soft-clipped, based on their alignment patterns. the numbers of read pairs n, d and s are counted respectively in these  <dig> groups . these counts are normalized with respect to  gc content and mapping quality . third, given the expected numbers of counts  and the observed counts n, d and s, the maximum likelihood estimation of vaf and genotype can be obtained. vaf is a continuous variable ranging between  <dig> and  <dig> and is suitable to represent allelic structure in heterogeneous samples, while genotype is a discrete variable  that is suitable in homogeneous samples. we keep both variables in one formulation to achieve unified maximal likelihood inference in either heterogeneous or homogeneous samples . in this paper, we focus on measuring vafs in heterogeneous tumor samples. a bayesian variant score is computed to quantify the confidence of the results .figure  <dig> 
schematic overview of breakdown. a) in the input are the bam files and a set of sv calls. reads encompassing each sv are extracted for analysis. genome-wide parameters such as average read count per bp per gc content are initialized. b) the encompassed reads are divided into three groups: normal, discordant and soft-clipped. reads in each group are counted. c) normal reads for large cnvs are counted in a series of consecutive non-overlapping bins. d) read counts are normalized by gc contents. e) expected read counts are defined as functions of sv, vaf and sequencing data. f) genotype and vaf that maximize the likelihood function are derived from the expected and observed read counts. g) variant scores are estimated that quantify the confidence of the results. detailed explanations of the mathematics are available in methods.



based on the above method, we implemented a software tool called breakdown, which can be used in conjunction with sv discovery tools such as breakdancer, genomestrip, delly, crest, pindel, etc. to measure the genotype or vaf of candidate svs in a bam file.

characterizing the estimation accuracy
our method involves sophisticated numerical calculations. does it always return the correct results? to answer this question, we simulate read counts under various combinations of parameters including vafs, variant types, variant sizes, sequence coverage, and insert sizes . we then ask breakdown to estimate vafs from simulated counts. to measure accuracy, we compute the chance of an estimated vaf falling near  the true value in  <dig> random trials.

from short-insert  short-read  low-coverage  data , it is very challenging to estimate vaf accurately from snps, medium-size deletions , inversions  and reciprocal translocations . however, it is possible to accurately  estimate relatively high  vaf from large  deletions. when coverage increases to 30x , which is typically for wgs data, vaf as low as  <dig>  can be accurately estimated from large deletions. notably, vaf estimated from invs and tras are more accurate than those estimated from snvs, thanks to larger physical coverage than sequence coverage. medium-size deletions perform always better than snvs but worse than invs and tras in low  vafs. however it outperforms invs and tras at high  vafs. the accuracy of svs over snvs becomes even more striking as the insert size becomes longer  , which indicates that our method has successfully leveraged physical coverage. even at ultra-high  coverage , the snvs still have limited accuracy  in estimating small  vafs from short insert data. this result indicates that current methods that measure vafs from only snvs are suffering from great challenges in delineating low-abundance sub-clones, whereas when svs are included, low-abundance sub-clones would have much higher chance to be identified.figure  <dig> 
accuracy of estimated vaf in simulation. plotted are the chances  of the estimated vaf falling within 10% of the true vaf . each data point is estimated from  <dig> random samples. each subplot in the figure contains  <dig> curves representing the accuracy of vafs estimated from snvs ,  <dig> kb deletions ,  <dig> mb deletions , and inversions/reciprocal-translocations . various types of sequencing data are simulated and results compared: a) short-insert  short-read  at 5× sequence coverage, b) short insert short read at 30× coverage, c) long insert  short read at 30x coverage and d) short insert short read at 500× coverage.



in summary, this simulation results indicate that our method can accurately estimate vafs for various types of svs and can enhance the heterogeneity analysis from either short or long insert data at any coverage.

comparison with published tools
the genomes of a tumor often evolve from a complex history that spans multiple years. to understand if breakdown is more accurate than other tools in inferring complex history, we created a 5-clone mixture tumor sample, based on a mock phylogeny tree . each branch in the tree represents the birth of a new clone that contains two novel svs. we generated synthetic reads from this bulk tumor genome. we also generated additional reads from the wild-type genome to simulate “normal contamination” that are frequently observed in real tumor samples. we created  <dig> data sets by varying the “normal contamination rate” from  <dig> to  <dig>  with an incremental of  <dig> . we applied both breakdown and theta on these  <dig> data sets and compared the accuracy of estimated vafs . in all  <dig> sets, breakdown achieved lower vaf estimation errors than theta . we noticed that the accuracy of theta starts to deteriorate when the normal contamination rate increases, whereas breakdown achieved consistently small errors . this result indicated that breakdown is likely more accurate in modeling real tumor sample that often contain multiple tumor clones with variable rates of normal contamination.figure  <dig> 
comparison of vaf estimation errors between breakdown and theta. plotted are the mean and the maximum errors  estimated from  <dig> lineage specific svs by breakdown and theta under six normal contamination rates from  <dig> to  <dig>  .



identify somatic svs from tumor-normal matched wgs data
to assess breakdown’s capability in accurately estimating vaf and detecting somatic events in real data, we download the wgs data of a metastatic melanoma cancer cell-line colo- <dig> and its matched normal cell-line  <cit> . for each putative sv, we compute its vaf in the tumor and the normal samples independently. we first run breakdown on  <dig> previously validated deletions in the tumor  <cit> . except for  <dig> events, which are suspected to be germline , the estimated vafs in the normal sample for the other  <dig> events  have a mean of  <dig>  and a standard deviation of  <dig> , as expected for somatic deletions.

in the tumor sample, we observe that those events on chromosome  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig> and x have vafs diverging from  <dig>   <dig>  or  <dig>  which are unexpected from a homogeneous diploid sample. this implies aneuploidy on these chromosomes, assuming the tumor sample is pure. this speculation is confirmed by a previous independent study that characterizes the genome-wide copy number profile in this sample  <cit> . on chromosomes  <dig>   <dig>   <dig> and  <dig> that are indicated as mostly diploid  <cit> , the estimated vafs are within  <dig>  of either  <dig>  or  <dig>  . thus, the vafs estimated by breakdown in both the tumor and the normal samples appear to be valid.

we run breakdancer on the tumor and the normal samples independently, and run breakdown on the resulting deletion calls. since previous studies have been fairly comprehensive at identifying somatic heterozygous deletions  we focus on identifying loss-of-heterozygosity  events. we find  <dig> candidate loh events that have vafs between  <dig>  and  <dig>  in the normal and between  <dig> and  <dig>  or  <dig>  and  <dig> in the tumor . among them,  <dig>  overlap previously reported loh regions deriving from segmenting the b-allele frequency of snps  <cit> . two lohs are of potential functional impact. one at chr10q <dig>  hits c10orf <dig>  a melanocyte-differentiation gene that has been related with autosomal-recessive albinism in humans  <cit> . this homozygous deletion is found overlapping the only homozygous region found in four affected individuals but not in any unaffected ones. the other loh at chr14q <dig>  hits gene nrxn <dig> , which has been related to malignant melanoma  <cit> .figure  <dig> 
a loss-of-heterozygosity deletion in
nrxn3
in colo- <dig>  plotted is an image from the integrative genome viewer  that represents read alignment over this deletion  in the tumor sample  and in the normal sample . the discordant read pairs  and drop in coverage  correspond to the start and the end of the deletion . vafs are estimated by breakdown to be  <dig>  and  <dig> , respectively in the tumor and the normal.



identify sub-clonal svs in breast cancer samples
we analyzed three pairs of matched tumor-normal breast cancer samples to show that breakdown can accurately estimate vafs of medium-size deletions, inversions and translocations. the first pair consists of an estrogen-receptor -positive primary breast cancer sample pd <dig>  sequenced by illumina hi-seq at 188×, and a matched normal sample at 38x. the clonal structure of this tumor has been previously inferred based on snvs and large cnvs  <cit> . the other two tumor samples pd <dig> and pd <dig> were sequenced at around 40× and their clonal structure have been characterized by theta  <cit> . for these  <dig> cases, we called structural variation using breakdancer on the paired tumor and normal samples. we then run breakdown on each of the candidate sv calls. through this process we discovered several subclonal deletions , inversion and translocation  that have not been previously reported  <cit> .table  <dig> 
novel sub-clonal somatic structural variants detected by breakdown



pd4120
atrnl1

pd4120

pd4120

pd4120
hira, pi4ka

pd4115
ube4b

pd4115
fktn

pd4115
cacna1b

pd4115
xist

pd4088
listed are the novel somatic structural variants in the breast cancer sample pd <dig>  pd <dig> and pd <dig> along with breakdown estimated vafs . also shown  are the genes overlapping with either deletion loci or translocation breakpoints.



for the novel somatic svs detected in pd <dig>  two deletions  have breakdown predicted vafs of  <dig>  and  <dig> , respectively . because the tumor purity of pd <dig> is around 70%  <cit> , these two deletions are thereby likely heterozygous deletions in the primary clone . the third deletion   has a predicted vaf of  <dig> , which may originate from one of the sub-clones  that has a snv vaf peak at  <dig> . it can be seen  that although the read depth signal is not apparent, there are  <dig> discordant read pairs and  <dig> split reads, all of which are important for estimating vaf but have been ignored in the previous studies. the translocation  has a breakdown estimated vaf of  <dig> , which matches another sub-clone  with a snv vaf peak at  <dig> . for the four deletions discovered in pd <dig> , two  have vafs estimated at around  <dig> , which implies that they are likely heterozygous variants in the founding clone. the other two  had estimated vafs at around  <dig> , and are likely homozygous deletions in the subclone of  <dig> % abundance  <cit> . one novel somatic inversion  that we found in pd <dig>  has an estimated vaf  <dig> , which may be a homozygous event in the founding clone. in summary, all of the novel somatic svs we have identified were consistent with previously inferred clonal architecture, which demonstrated the accuracy of our method.figure  <dig> 
sub-clonal svs in pd <dig>  plotted are the integrative genome viewer  screenshots that display reads in the tumor sample  and in the normal sample  of a) a  <dig> bp deletion between chr10: <dig> and chr10: <dig> with an estimated tumor vaf  <dig> , and b) an intra-chromosomal translocation between chr22: <dig> and chr22: <dig> with an estimated tumor vaf  <dig> . reads are displayed from the top to the bottom in the following order: split reads , discordant read pairs , and normal read pairs.



discussion
in this paper, we presented a novel sequence analysis method that can estimate the vafs of svs from a heterogeneous tumor sample.

we showed that vafs estimated from svs by our methods are at least several times more accurate than those estimated from snvs, thanks to our integration of diverse alignment signals  from multiple groups of reads. we also clearly demonstrated that different types of svs are associated with different accuracy in vaf estimation and our method can fully harness the structural nature of these svs.

our work has extended current clonal inference from snvs and large cnvs to include medium-size svs and balanced svs such as inversions and translocations. it is possible to further extend our model to account for complex svs such as chromothripsis  and chromoplexy  <cit> .

in terms of accurately estimating vafs, our approach compared favorably to existing tools. in our simulation, our model could more reliably estimate vafs than theta from tumor samples that have multiple clones and a high level of normal contamination. other approaches such as absolute were not directly comparable to our approach, because they were designed to infer tumor purity and ploidy without further characterizing clonal structure or subclonal mutations  <cit> .

in our analysis of colo- <dig>  we identified  <dig> putative germline deletions in somatic loh regions. these events, although potentially important, have not been systematically reported in previous studies that examined the same set of data. therefore, the results obtained by our approach can facilitate more accurate characterization than the previous studies that utilized only snvs and indels  <cit> . our finding also indicated that previous studies might have narrowly focused on detecting gohs but somewhat ignored lohs. as medical genomics research continues, we expect that our method will have a tremendous opportunity to improve the comprehensiveness of mutational profiling from an unprecedented amount of wgs data that are accumulated by the tumor genome atlas, the international cancer genome consortium  <cit>  and broader biomedical research communities.

the analysis of breast cancer samples pd <dig>  pd <dig> and pd <dig> demonstrated the identification of subclone svs using breakdown. the estimated vaf, together with those from snvs and large cnvs, will serve as input to further infer clonality, ploidy and purity. while these three perspectives are intermingled, we believe that incorporating svs into the picture  <cit>  will greatly enhance the quality of the inference.

besides heterogeneous tumor samples, our method can also be applied to infer the genotypes of normal homogeneous wgs samples such as those in the  <dig> genomes projects  <cit> . we will report our findings in a separate manuscript.

CONCLUSIONS
we have developed a maximal likelihood framework, which integrates multiple forms of alignment signals to estimate the allele fraction of a structural variant. our methods and software tool breakdown can estimate the allele fraction of most structural variants including small and large deletions, balanced inversions and translocations. evaluation based on both simulated and real data indicates that our method outperforms existing approaches and can greatly enhance the characterization of intra-tumoral heterogeneity in genomically instable tumors.

