BACKGROUND
in this paper, we consider the evolution of a pair of gene duplicates following a duplication event which gives rise to two perfect copies of the original gene. gene duplication was first presented as an important process by ohno  <cit> , who postulated that the emergence of new functions in genomes was enabled by gene duplication. ohno  <cit>  claimed that duplication relaxed selective pressures on proteins and enabled mutations to accumulate, leading to the eventual process of neofunctionalization. gene duplication has since been identified as a common occurrence in sequenced genomes  <cit> , and as an important contributor to genome diversification  <cit> .


subfunctionalization was first analyzed in a series of papers by force and lynch . it is a process of subdividing functions from the ancestral state between the duplicated gene copies, which allows for both copies of the gene to be preserved by selective pressure without the need to invoke positive selection . to model the evolution of gene duplicates, subfunctionalization is taken together with pseudogenization, a process in which genes lose all functionality, and are effectively lost to the genome. these competing processes describe the ultimate fate of duplicates under subfunctionalization; the copies will either subfunctionalize, in which case both are preserved by selective pressure, or one of the copies will eventually pseudogenize, and the other copy will be preserved.

hughes and liberles  <cit>  sought to build upon the work in force and lynch  <cit>  and lynch and conery  <cit>  to generate models for neofunctionalization and subfunctionalization. in these works  <cit> , the expected behaviour of duplicates evolving under sub/neofunctionalization is characterized by inspection of the mechanisms of both processes. survival/hazard functions were chosen for their conformity to the predictions implied by the characterization and used for subsequent analysis. however, the parameters in these survival/hazard functions do not uniquely characterize processes in the mechanistic framework. here we perform a complete mechanistic analysis of subfunctionalization. the mechanistic approach has two main advantages in comparison to fitting phenomenological functions  it leads to testable predictions about the shape of the survival function under the subfunctionalization model  it allows estimation of biologically meaningful parameters such as null mutation rates and the number of functions that can be partitioned. the main contributions of this work are: 
development of a continuous-time markov chain model for the subfunctionalization process.

analysis of the shape properties, long and short-term behaviour of pseudogenization rate, and interpretation of what this means in terms of biological predictions of the subfunctionalization process.

fitting the model to genome data for four mammalian species.

the first subfunctionalization-model-based estimates of the relative rate of fixation of null mutations both in the coding and regulatory regions of gene duplicates.

the first model-based estimates of the likely numbers of regulatory regions to exist in gene duplicates.




in the section “a continuous-time markov chain model for subfunctionalization” we contstruct the model, justify the various transition rates by analyzing the mechanics of the subfunctionalization process, and note some important structural features of the model.

in the section “the pseudogenization cause-specific hazard rate” we introduce the pseudogenization  cause-specific hazard rates. this gives the instantaneous rate of pseudogenization  under the assumption that neither subfunctionalization, nor pseudogenization has occurred so-far. we offer a minor correction to the approximation applied by hughes and liberles  <cit> .

in the section “pseudogenization rates” we define and derive results for what we call the pseudogenization rate. this gives the instantaneous rate of pseudogenization without the assumption that subfunctionalization has not yet occurred . we argue that this rate is more useful in the context of subfunctionalization than the pseudogenization cause-specific hazard rate. we analyze the shape properties of this function, showing that subfunctionalization predicts qualitative behaviour which is consistent with the empirically observed curve  <cit> .

in the section “subfunctionalization survival function and poisson duplication” we introduce a simple model for the underlying duplication process. we apply this, together with the survival function implied by our subfunctionalization model, to derive an equation for the likelihood of observing some count of duplicates at a particular time. by taking the product of these likelihoods over each of the time points represented in a data set, it is possible to estimate parameters for both the subfunctionalization model, and the duplication model.

in the section “shape properties of the pseudogenization rate functions” we examine the shape properties of the pseudogenization rate functions under some different parameterizations. we find that the rate function is sigmoidally shaped, but under certain parameterizations can appear exponential-like in shape.

in the section “fitting the model to genome data” we fit the model to the genomic data set analyzed in hughes and liberles  <cit> , and derive some relevant results. the mechanistic nature of our model means that this fitting provides direct estimates of the rates of mutation in the genome relative to synonymous site mutation, as well as the number of regulatory regions that duplicate genes are likely to have.

in the “discussion” we consider some biological implications of this analysis. by analyzing the shape properties of the pseudogenization rate function, we rethink the predictions on gene duplicate survival implied by the subfunctionalization process. while our analysis agrees in part with previous characterizations, particularly due to hughes and liberles  <cit> , we highlight several points of difference. most notably, we discuss the finding that our model does not necessarily lead to the broadly concave decline in pseudogenization rate thought to characterize subfunctionalization . we see that, under certain parameter sets, the model can lead to rapid convex decline in the hazard rate which would be associated with rapid subfunctionalization and a low risk of nonfunctionalization; and we suggest some possible candidate genes which might exhibit this behaviour.

in the “conclusions” we discuss the results of the mathematical and empirical analysis, and what this means for the biological process of subfunctionalization. we summarize our goals for modeling gene duplication with reference to the development of an overall mathematical model for gene duplication, incorporating all of the major biological processes.

much of the mathematical detail is omitted from the main text, and is included in additional file 1: section a of additional file 1: makes use of the embedded discrete-time markov chain to derive various probabilities of interest, including the probability of absorption by the time of the n
th mutation.

in section b of additional file  <dig> we consider the cause-specific hazard rates, and derive various measures of interest including the probability of absorption before time t, mean time to absorption and the k
th moments of time to absorption.

section c of additional file  <dig> contains the derivation of the main rate of interest in this work, the pseudogenization rate, as well as the average pseudogenization rate where the number of regulatory regions is treated as a random variable.

in additional file 1: section e we compare the qualitative features of the model detailed in this work to two existing phenomenological approximations. we also outline a method for retro-fitting our model to the model of teufel et al.  <cit> .

sections f and g of additional file 1: contain proofs of two important results which are used in the main body of the text. we consider the general case of an absorbing continuous-time markov chain  with finite state space, and derive limits of the cause-specific hazard rate , and an analogue of the pseudogenization rate discussed throughout the main body of this work .

methods
a continuous-time markov chain model for subfunctionalization
in this section, we define the model which is central to this paper. the model is a continuous-time markov chain , with a structure which is very similar to the phase-type distribution,  <cit>  which has been widely studied in the probability modeling literature, but has so-far seen little or no use in evolutionary biology. in later sections, we will exploit this structural similarity in the derivation of hazard rates and other measures. in additional file 1: section a, we also perform an analysis of the embedded discrete-time markov chain  <cit>  to derive results pertaining to the probability of subfunctionalizing/pseudogenizing at  the time of the i
th mutation.

the model which we define below is motivated by the mechanics of regulatory subfunctionalization. broadly speaking, subfunctionalization can occur as a non-regulatory process, however the assumptions of this model have been chosen to match the biology of regulatory subfunctionalization as closely as possible, while allowing for analysis. there is potential application of this model to other modes of subfunctionalization where the underlying mechanics are essentially similar to the mechanics of regulatory subfunctionalization. the following key assumptions should be carefully considered when applying the model to processes besides regulatory subfunctionalization: 
the process is assumed to be neutral,

null mutations are assumed to occur independently, and at a constant rate,

it is assumed that, due to selection pressure, an unmutated copy of each subfunction is always retained in at least one duplicate




consider the situation described in the duplication–degeneration–complementation  process of force et al.  <cit> . immediately after some duplication event, we have two identical genes, each with z mutable regulatory regions. assume the notation of hughes and liberles  <cit> , taking the  rate at which null mutations are fixed in each of the z mutable regulatory regions for each gene to be u
r, and the  rate at which null mutations fix in the coding regions for each to be u
c.

for a fixed number z of the regulatory regions in the duplicate pair of genes, consider a continuous-time markov chain {x,t≥0}, with state space 
  <dig> a={ <dig> ,…,z−1}∪{s,p}, 


where state i∈{ <dig> ,…,z−1} represents the number of fixed null mutations to have occurred in the case that neither subfunctionalization nor pseudogenization have happened yet, and the states s and p are introduced to represent subfunctionalization and pseudogenization respectively. s and p are both absorbing states - that is, once subfunctionalization or pseudogenization occurs, the process stops and remains in state s or p, which represent the preservation of both copies, or one copy respectively. under the subfunctionalization process, a duplicate pair is preserved if it undergoes subfunctionalization, otherwise one gene is lost  and the remaining gene is preserved.

note that we can significantly simplify the problem by modeling the number of null mutations to have occurred in the system as whole, rather than trying to track mutations in each gene separately. as soon as a null mutation has occurred in both genes, either subfunctionalization or pseudogenization must have occurred, so we need only count the total number of mutations until one of these two possible outcomes is realized.

we define the generator for our markov chain to be matrix q= [q
ij] where the non-zero off-diagonals are given by 
  <dig> qij=2ucifi= <dig> j=p2zurifi= <dig> j=1ucif1≤i≤z− <dig> j=purif1≤i≤z− <dig> j=i+1orj=sur+ucifi=z− <dig> j=purifi=z− <dig> j=s. 


below, we show that the rates q
ij in  are indeed the relevant transition rates by considering the evolution immediately after duplication.


transitions from
0→p clearly, the process starts in state  <dig>  since no null mutations have fixed at the instant of duplication. null mutations fix in the coding region for each gene at a rate u
c, and this leads to pseudogenization. therefore transitions from 0→p occurs at rate 2u
c.


transitions from
0→ <dig> null mutations fix in each of the 2z regulatory regions at a rate u
r, and hence transition 0→ <dig> occurs at a rate 2zu
r.

after the first mutation, either a null mutation fixed in one of the coding regions, and the process has been absorbed into state p, or a null mutation has fixed in one of the regulatory regions of one of the genes, and the process is now in state  <dig> 

as described in  <cit> , null mutation in the regulatory region results in the loss of some particular function for that gene, and the total loss of a function is selected against. hence the duplicate pair must retain at least one unmutated copy of each regulatory region between them - this is the fundamental concept of subfunctionalization. it follows then that the remaining unaffected gene must be preserved, and so too must its copy of the regulatory region which has mutated in the other duplicate.


transitions from
1→p since the unaffected gene now has a unique function which is protected by selective pressure, this gene is no longer susceptible to pseudogenization under the subfunctionalization process. as such, only one copy may now undergo null mutation in the coding region, which it does at a rate u
c. hence the rate of transitions from 1→p is u
c.


transitions from
1→s also, since one regulatory region in the unaffected gene is protected by selective pressure, and one region has already undergone null mutation for the other gene, each gene has z− <dig> regulatory regions which are now susceptible to null mutation. if such a mutation occurs in the previously unaffected copy, then both copies will have a unique function, and both will be protected by selective pressure. this is subfunctionalization, and hence the process transitions from 1→s at a rate u
r.


transitions from
1→ <dig> on the other hand, if a null mutation fixes in one of the z− <dig> susceptible regulatory regions of the same copy in which the previous mutation fixed then the process transitions to state  <dig> - as two mutations have now fixed, but the process has not yet been absorbed. hence the process transitions from 1→ <dig> at a rate u
r.


transitions from
i∈{ <dig> ,..,z−2}→j we note that for the process to reach state i∈ <dig> ,…,z− <dig> all mutations must have occurred in the regulatory regions of the same copy, since subfunctionalization  occurs as soon as both copies have a unique function. therefore, a similar argument is used to show that for all i∈{ <dig> ,..,z−2} transitions 
from i→p occur at rate u
c,

from i→s occur at rate u
r,

from i→i+ <dig> occur at rate u
r.





transitions from
z−1→s when the process is in state z− <dig> there is only one regulatory region for each copy susceptible to null mutation, which occurs at a rate u
r for each copy. if such a mutation occurs in the so-far unaffected gene then the process transitions to state s, hence the rate of transition from z−1→s is u
r.


transitions from
z−1→p there are two distinct ways in which the process can transition from z−1→p. the first is similar to the previous cases, with a null mutation occurring in the coding region of the copy in which all of the previous mutations have fixed, which occurs at rate u
c. the other way is for a null mutation to fix in the last remaining regulatory region of this same gene, which occurs at a rate u
r. hence the rate of transition from z−1→p is u
r+u
c.

the full set of possible transitions for the case where z= <dig> is illustrated in fig.  <dig> 
fig.  <dig> the  transition diagram for z= <dig>  regions hit by null mutation are coloured red, and regions which are protected by selective pressure are coloured yellow





block matrix form of q
now, we define q
∗ to be the block matrix of q which records the transition rates between the non-absorbing states in { <dig> ,…,z−1}, and v= to be a z× <dig> matrix where  vectors v̲s and v̲p record the rates of transition from the non-absorbing states in { <dig> ,…,z−1} into the absorbing states s and p, respectively. we have, with o denoting zero matrices of appropriate sizes,


 where





this form of the generator matrix is useful, as we will make extensive use of the matrix q
∗ and the vectors v̲s and v̲p in our derivations.

note that since q is a transition rate matrix, the row sums must be  <dig>  the rows full-of-zeros corresponding to the absorbing states are interpreted as the process having zero rate of transition out from these states

the pseudogenization cause-specific hazard rate
in this section, we give a brief overview of the pseudogenization cause-specific hazard rate. a detailed analysis of both the pseudogenization and subfunctionalization cause-specific hazard rates is given in additional file 1: section b. in the traditional hazard rate setting, there is only one absorbing state, and the hazard rate is a measure of the rate at which a process is absorbed, given that it has not yet been absorbed. the cause-specific hazard rate can be applied when there are several absorbing states, and is a measure of the rate at which a process is absorbed into a particular absorbing state, given that it has not yet been absorbed into any absorbing state.

given a random variable t recording time until absorption, the hazard rate λ
i, given that the process starts in state i is defined  <cit>  for all t≥ <dig>  as 
  <dig> λi=limh→0+p=i)h=fi1−fi, 


where f
i is the probability density of absorption occurring at time t given that the process starts in state i, and f
i is the corresponding cumulative distribution function.

for the model described in the section “a continuous-time markov chain model for subfunctionalization” the hazard rate can be shown  to be 
  <dig> λi=−ei̲eq∗tq∗1̲ei̲eq∗t1̲, 


where e
i is a  vector with a  <dig> in the i-th position and 0’s elsewhere, and  <dig> denotes a column vector of 1’s of appropriate size.

when an absorption occurs, the process transitions into an absorbing state . this motivates the definition of the cause-specific hazard rate  <cit> , which can be thought of as the instantaneous rate of transition into a particular absorbing state given that the process has not yet been absorbed. in our case, we refer to these rates as the pseudogenization cause-specific  and subfunctionalization cause-specific  hazard rates, given by 
  <dig> λij=limh→0+p=j|t>t,x=i)h=fij1−fi, 


after some analysis  we see that the cause-specific hazard rates for our model are given by 
  <dig> λij=ei̲eq∗tvjei̲eq∗t1̲. 


additional analysis including an investigation of the limiting behaviour, and the derivation of various measures which are not directly related to the central narrative of this paper are included in additional file 1: section b. although these results are not pivotal to this work, they are likely to be of interest to more mathematically inclined readers interested in applications of the phase-type distribution to the derivation of related measures.

now, in order to approximate the pseudogenization hazard rates, hughes and liberles  <cit>  applied the following: 
  <dig> λtz≈pizeforti−1≤t<ti, 


where the fixed points t
i are evaluated using 
  <dig> t0=0andti=ti−1+efor1≤i≤z. 


that is, the  assumption was made that the hazard rates are piece-wise constant within such specified time intervals [t
i− <dig> t
i].

however, there was an error in the approximation at which hughes and liberles  <cit>  ultimately arrived. they wrote 
  <dig> λtz=2ucfor0≤t<t1ucfort1≤t<tz−1uc+urfortz−1≤t<tz0fort≥tz. 


notice that no weight is given to the possibility that subfunctionalization has occurred for t<t
z, and for t≥t
z no weight is given to the possibility that it has not occurred. hence this approximation assumes that subfunctionalization occurs at the time of the z
th mutation t=t
z exactly. this is a small but critical error, as the approximation only holds in the unlikely event that subfunctionalization occurs at time t=t
z, which for most parameter sets is far from the mean time to subfunctionalization. we contend that this ultimately led to the mischaracterization of the subfunctionalization process in  <cit> , and we will see in in the section “shape properties of the pseudogenization rate functions” that our rate function behaves very differently to this approximation.

with a minor correction we get a good approximation for the pseudogenization cause-specific hazard rate, using the same notation we can write 
  <dig> λtz=2ucfor0≤t<t1ucfort1≤t<tz−1uc+urfort≥tz− <dig>  


however, as mentioned above, we contend that this is not the rate of central interest in modeling subfunctionalization.

pseudogenization rates
in this section, we introduce a new measure, referred to as the pseudogenization rate, which we contend to be of greatest interest in modeling subfunctionalization, and gene duplication more generally. this measure is a slight variation of the hazard rate which accounts for the possibility that subfunctionalization has occurred. this allows analysis of the instantaneous rate of pseudogenization when it is not possible to determine whether subfunctionalization has occurred.

note that in the traditional hazard rate setting, all of the absorbing states are thought of as corresponding to something analogous to death, or failure. in such case, we are rarely interested in modeling the process after absorption, and hence the focus on rates in which absorption has not occurred. in contrast, the central feature subfunctionalization is the ability for both duplicates to be preserved by selective pressure when subfunctionalization occurs. hence in our model, the absorbing state s corresponds to an immunity from subsequent failure, and as such we are interested in modeling the behaviour of the system only under the assumption that failure  has not yet occurred.

hughes and liberles  <cit>  assumed that subfunctionalization occurred at precisely time t=t
z, and approximated the rate of pseudogenization by first approximating the cause-specific hazard rate  up to time t=t
z, and setting the rate to be  <dig> for t>t
z ). in this way, they partially overcame the fact that the cause-specific hazard rate fails to account for the primary feature of the subfunctionalization process. however, the assumption that subfunctionalization occurs at some predetermined point in time is hard to justify, and we show that there are substantial differences between the qualitative behaviour of such an approximation and the exact rate derived here.

pseudogenization rate for fixed z
let 
  <dig> tp=inf{t>0:x=p} 


be the random variable recording the time at which pseudogenization occurs. assume that there are z regulatory regions in the duplicate pair of genes. we define the pseudogenization rate as 
  <dig> hpz=limh→0+p=0)h=f~1−f~, 


where f~=p and f~=f~′ are the corresponding cumulative distribution and probability density functions, respectively. after some analysis  this leads to a pseudogenization rate of 
  <dig> hpz=e̲0eq∗tv̲p1−e̲0eq∗t−i−1vp. 


given enough time, and given that pseudogenization does not occur , we would intuitively expect that subfunctionalization must eventually occur. as such, we would expect the rate hpz to approach zero as t approaches infinity, that is, 
  <dig> limt→∞hpz= <dig>  


we have confirmed this analytically in additional file  <dig> section c).

note that it does not make sense to calculate moments of time to pseudogenization  with this rate. this is because of the possible absorption into the state s - if subfunctionalization occurs, then the time to pseudogenization is infinite. recalling that the pseudogenization rate does not condition on subfunctionalization not occurring, clearly then the mean time to pseudogenization is infinite. for a meaningful calculation of moments, the hazard rate should be used.

average pseudogenization rate 
we now consider the pseudogenization rate averaged over the possible values of z. we let z be a random variable tracking the number of regulatory regions in a duplicate pair, and define the average pseudogenization rate as 
  <dig> hp=∑z=zminzmaxpzhpz. 


notice that since each hpz→ <dig> as t→ <dig>  it follows that 
  <dig> limt→∞hpz= <dig>  


subfunctionalization survival function and poisson duplication
in order to fit the model to genome data, we will make use of the survival function implied by our model together with some assumptions about the underlying gene duplication process.

by eq. , the survival function corresponding to the random variable t
p is given by 
  <dig> p=1−f~=1−e̲0eq∗t−iq∗−1vp. 


note that the data  contains the counts of the number of surviving duplicates at the current time. however, this number depends on the gene duplication process, which needs to be considered in the analysis. by introducing a poisson process to model the duplication process , and a random variable y representing the number of duplicates that have survived to time t we are able to derive the probability that there are y duplicates surviving at the current time as 
  <dig> p=y)=1−f~β0yy!e−β01−f~, 


where f~ is defined in , and β
 <dig> is the average number of duplication events that occur in a time interval of length  <dig> s - s being the expected number of substitutions per silent site. note, the time interval is chosen as  <dig> s since this is the size of the intervals in the data set we examine in the section “fitting the model to genome data”.

note that  defines a poisson random variable with parameter 
  <dig> β=β0), 


which is the expected number of duplicates surviving to time t if the duplication process is poisson with parameter β
 <dig> and the survival process is the model under discussion in this paper.

with this result, calculating the likelihood of the data given the parameters is straight-forward, and computationally tractable, as we only need to multiply over the probabilities for each of the data bins.

next, in order to fit the parameters β
 <dig> u
r,u
c and z to the data set, we use the maximum likelihood method with the log likelihood given by 
  <dig> log=∑idilog−β−Γlog, 


where d
i is the count in the i
th bin of the data set, and s
i is the associated cumulative number of silent substitutions per silent site, used as a proxy for time.

for the data set we examine in the section “fitting the model to genome data”, s
i= <dig> i.

RESULTS
here we discuss some further mathematical results which have more direct biological implications than those discussed in the methods section, as well as results from data fitting. in the section “shape properties of the pseudogenization rate functions” we discuss results pertaining to the shape of the pseudogenization rate function introduced in the section “pseudogenization rates”, these results have some implications about the predictions of the subfunctionalization process which are detailed further in the discussion. in the section “fitting the model to genome data” we fit the model to the data sets of hughes and liberles  <cit>  to estimate the relative rates of mutation and the number of regulatory regions comprising gene duplicates in homo sapiens, mus musculus, canis familiaris and rattus norvegicus.

shape properties of the pseudogenization rate functions
in this section we analyze the shape properties of the pseudogenization rate function, and consider the implications of these properties on the predictions of the subfunctionalization process. we show that our model predicts a sigmoidal shaped pseudogenization rate, we also show this does not always imply the broadly concave decreasing hazard rate  suggested by hughes and liberles  <cit> . we find the critical value at which the function’s behaviour shifts from being obviously sigmoidal to apparently exponential , which we illustrate in fig.  <dig> 
fig.  <dig> pseudogenization rate hpz with for z= <dig> γ less than a, greater than b and equal to c
γ
crit. panel d shows the overall shape of hpz, with negative values of t included. a pseudogenization rate hpz with γ<γcritz. the change in concavity occurs at t≈ <dig> . as such, the sigmoidal nature of the function is apparent - we see an initially slowly decreasing hazard rate which decreases more and more rapidly up to the change in concavity, after which the decline in the hazard rate slows, and approaches the asymptote at zero. b pseudogenization rate hpz with γ>γcritz. here the change in concavity occurs for some t< <dig>  and hence cannot be seen in real, physical time . the shape is not obviously sigmoidal, and looks similar to that of an exponential decay. the rate of pseudogenization is initially declining rapidly, before approaching its asymptote at zero. c pseudogenization rate hpz with γ=γcritz. here the change in concavity occurs at exactly t= <dig>  this is qualitatively similar to the case in panel b, with the pseudogenization rate rapidly declining, and the decline becoming slower as the rate approaches its asymptote at zero. d pseudogenization rate hpz taken as a function over all ℝ. this gives a complete picture of the shape of the pseudogenization rate function. smaller values of γ translate the graph to the right, and result in a longer initial period of slowly declining pseudogenization rate. if γ>γ
crit, the point of inflection occurs to the left of t= <dig>  and we see behaviour similar to panel a





hughes and liberles  <cit>  found that a hazard rate following a weibull distribution provided an extremely good fit to gene duplicate data. konrad et al.  <cit>  fit sigmoid  curves to their data sets. panel  of fig.  <dig> shows that this is indeed the shape arising from our model. note that the time axis in panel  of fig.  <dig> includes negative values. there is an obvious continuation of hpz to the domain t∈ℝ  where we take the same expression for hpz without interpreting t as corresponding to time.

considering the behaviour of hpz for negative t can be useful, as an important qualitative feature is whether the change of concavity occurs in t≥ <dig>  or t< <dig>  at the point of inflection, the function changes between decreasing more and more quickly, and decreasing more and more slowly. as far as our biological interpretation of hpz  is concerned, we are only interested in t≥ <dig>  hence, whether this change of behaviour occurs in real, physical, time  or not is an important defining feature of the characteristics of the process. this is demonstrated in fig.  <dig> 

notice that there are two distinct predictions for the behaviour of this process. the process can begin with a rapid decline in the rate of pseudogenization, quickly approaching its asymptote at zero, and leaving relatively little opportunity for pseudogenization to occur. alternatively, it can start with a slowly declining pseudogenization rate, giving more time for pseudogenization to occur before a high probability of subfunctionalization eventually takes over and the rate of pseudogenization begins to rapidly decline towards it’s aymptote at zero.

in the absence of a relative clock  the parameters u
c and u
r are only meaningful relative to each other. as such, non-dimensionalization is a convenient technique to reduce the number of parameters from  <dig> to  <dig> 

we can replace parameters u
c and u
r with their ratio γ=u
r/u
c, and work with time units 1/u
c. thus u
c can be thought of as the units of the rate . this technique is applied implicitly throughout many of the results that follow.

the change in concavity will occur when the second derivative is zero, i.e. when hpz′′= <dig>  we define γcritz to be the ratio u
r/u
c at which the second derivative is zero precisely when t is zero, i.e the ratio u
r/u
c such that hpz′′= <dig>  when 0<γ=ur/uc<γcritz the concavity of hpz will change for some t
∗> <dig>  and we see the behaviour where an initially slowly-declining hazard rate decreases more and more quickly before slowing back down as it approaches zero. otherwise, the change in concavity occurs for some negative value of t, and in this case the hazard rate begins its rapid decline immediately, with the rate of decline slowing from it’s initially-high value at all times. figure  <dig> shows the values of γcritz for various values of z.
fig.  <dig> critical values γcritz for various values of z. when ur/uc≤γcritz the change in concavity for the pseudogenization rate function will occur in positive time. otherwise, the change occurs in negative t and the sigmoidal nature of the function will not be apparent when plotted for t>0




the sigmoidal shape is in good qualitative agreement with previous results, and in additional file 1: section e we retro-fit our model to existing phenomenological approximations due to teufel et al.  <cit>  and konrad et al.  <cit> , finding particularly good agreement with the shape of the hazard function in teufel et al.  <cit> . the continuation of hpz to include negative t is particularly useful in this analysis, and in additional file 1: section g we prove a result about the limit as t→−∞ of a generalization of hpz applicable to any absorbing ctmc with a finite state space.

we note that the shape of hpz is only sigmoidal for 0<u
r<u
c. for u
r= <dig> the shape of hpz becomes exponential, and when u
r>u
c, hpz may have multiple turning points, or points of inflection. however, these are not realistic parameter sets for subfunctionalization.

example  <dig> 
in this example, we examine the shape of the pseudogenization rate for z= <dig>  and γ=ur/uc= <dig> <γcrit12= <dig> . in this case, the sigmoidal shape of the rate function is quite apparent. this is because the change in concavity occurs in physical time, and hence in panel  of fig.  <dig> we can see that the rate is relatively flat near t= <dig> 

example  <dig> 
for this example, we examine the shape of the pseudogenization rate for z= <dig> and γ=ur/uc= <dig> =γcrit <dig>  shown in panel  of fig.  <dig>  here we see little evidence of the sigmoidal shape of the rate function for t≥ <dig>  which could be well approximated by an exponential decay.

example  <dig> 
in this example, we examine the shape of the pseudogenization rate for z= <dig> and γ=ur/uc= <dig> >γcrit12= <dig> . in this case, the point of inflection does not occur in physical time and the shape of the function becomes indistinguishable from an exponential decay. panel  of fig.  <dig> shows the rate function for this example.

fitting the model to genome data
in this section we fit the model to the data set analyzed in hughes and liberles  <cit> , the data set is included in additional file  <dig>  while the matlab scripts used for analysis are in additional file  <dig>  this data consists of counts of the number of duplicate pairs in several genomes with corresponding estimates of the cumulative number of silent substitutions per silent site, binned in intervals of length  <dig> s, where s is the cumulative number of silent substitutions per silent site. the silent substitutions can be used as a proxy for time, and the intervals of length  <dig> s represent on average  <dig>  million years. hughes and liberles  <cit>  tested the quality of the alignments by comparing the mean and median fraction of alignment columns which were gap free. they concluded that the alignments for the four species m. musculus, r. norvegicus, h. sapiens and c. familiaris were of high quality, and these are the data sets we will examine here. in  <cit>  hughes and liberles fit off-the-shelf survival functions to these data sets. here we assume that the underlying duplicate process is a poisson process, and fit the survival function derived from our model as discussed in the section “subfunctionalization survival function and poisson duplication” of the methods.

we computed maximum likelihood estimates  θ^z= for u
r,u
c and β
 <dig> for each z from  <dig> to  <dig> for four mammalian genomes. we call the best of these z’s  z^, with the understanding that this is not a true maximum likelihood estimate, since we restricted z^∈{ <dig> ,…,20}. we chose this truncation because it is unlikely that a gene would have in excess of  <dig> regulatory regions  <cit> . the case z= <dig> is excluded, as subfunctionalization cannot occur in this case, and the survival model reduces to an exponential survival function with parameter  <dig> when z= <dig> or u
r= <dig> 

the ratio γ=u
r/u
c and z appear to be strongly correlated in the mles, as shown in fig.  <dig>  a power law relation between γ and z appeared to fit quite well, with r
 <dig> values > <dig>  for each of the four genomes.
fig.  <dig> maximum likelihood estimates for γ=u
r/u
c for each z= <dig> ,…, <dig> for four mammalian species. a
γ vs z in the mle for canis familiaris. b
γ vs z in the mle for homo sapiens
c
γ vs z in the mle for rattus norvegicus
d
γ vs z in the mle for mus musculus





we compared the fit of our survival function  against weibull and exponential functions using relative likelihood via the aic  <cit> . for all four genomes, our model outperformed the exponential function, but was itself outperformed by the weibull function in the rat, mouse and human genomes. in the canine genome there was insufficient evidence to choose between the weibull function and the survival function derived from the model.

mechanistic models can contain parameters that are part of the generative process but add little to data fitting, sometimes resulting in less support for mechanistic models when compared to simpler models, even when the mechanistic models give more accurate inference of the underlying process as judged by the accuracy of parametrization . with this justification in mind, we move forward with analysis of the results of fitting the mechanistic subfunctionalization model to genomic data. the analysis of mechanistic parameters is conditional on the generative process being what is modeled, namely subfunctionalization.

to estimate the relative rates of mutation γ=u
r/u
c together with the mean number of duplicates per  <dig> s, β
 <dig>  we fixed z=z^ and computed e
 <dig> likelihood intervals for each of the parameters using the profile likelihood approach. we also calculated e
 <dig> likelihood intervals for z using the values of the mle. in the regular asymptotic case e
 <dig> likelihood intervals are equivalent to  <dig> % confidence intervals  <cit> . since the shape of the profile likelihood is quite standard , it is reasonable to regard these intervals as approximate 95% confidence intervals. these results are summarized in table  <dig> 
fig.  <dig> the profile likelihood curve for u
c in the rattus norvegicus genome

e
 <dig> likelihood intervals and maximum likelihood estimates for four species

rattus norvegicus
mus musculus

u
c

u
r

β
0

z
homo sapiens
canis familiaris

u
c

u
r

β
0

z



there were some minor identifiability issues in fitting the model to this data, in particular, for the rattus norvegicus and canis familiaris genomes, we were able to find good relative likelihood scores for any z= <dig> ,… <dig>  which prevents us from reliably estimating z for these two genomes. together with the close correlation between z and γ=u
r/u
c this could be overcome by fixing one or more of the parameters using some outside analysis. in both cases, the maximum likelihood estimate for z was z^= <dig> 

as a point of interest, we ran some simulations using parameters similar to those estimated for the rat genome. we simulated bins of data identical to those in the data, i.e.  <dig> bins corresponding to  <dig> s, <dig> s,… <dig> s, and found that the parameters of the model were difficult to recover in this case, with the mle value for z varying between runs with the same parameters. in some runs, even when z was fixed to the correct value used in the simulation u
r and u
c were not able to be accurately recovered, with γ=u
r/u
c varying from around  <dig>  to  <dig>   in the handful of simulations we ran. the true parameters fell within the e
 <dig> likelihood intervals, but it wasn’t until we increased the number of intervals to  <dig> that we started to get more reliable recovery of the simulation parameters.

the simulation analysis provided some insight into the relatively unstable results for the rat and dog genomes. we suspect that the combination of low count values , together with the relatively low estimated mutation rate, leads to an overall lack of information in the data for these two genomes compared to the others, and hence the difficulty pinpointing parameters. based on the results of the simulations we ran, we expect that the likelihood intervals for these genomes are somewhat reliable, while the maximum likelihood estimates themselves are probably not very precise.

we also note that for the rat genome the value u
r= <dig> was within the established likelihood intervals. in this case, the survival function for our model reduces to an exponential survival function with parameter 2u
c. the lack of differentiation between the mechanistic and phenomenological models in this case is likely due to the previously mentioned relative lack of information in the rat data.

for the homo sapiens and mus musculus genomes the maximum likelihood estimate for z was z^= <dig> in both cases, with z= <dig> , <dig> falling in the e
 <dig> likelihood interval. in these two cases the higher mutation rate estimates, together with larger counts of duplicates are suggestive of more informative data, and the results are in-line with this suggestion. we expect the maximum likelihood parameter estimates to be more reliable in these cases.

note that we model the evolution of a pair of gene duplicates, and thus our estimates implicitly assume that all of the duplicates in the genomes analyzed have the same parameters as each other. that is, the maximum likelihood estimate z^ is an estimate for the number of regulatory regions each gene has assuming they all have the same number of regulatory regions. similarly, the estimates for u
c and u
r assume a consistent rate of mutation throughout all of the genes in the data set.

these assumptions are inherent to the application of models at the level of individuals  to larger data sets, however the importance of these assumptions is particularly apparent when considering fixed parameters such as z. in the absence of parameter z, we could think of the poisson rates u
c and u
r as measuring an average mutation rate across the genome, however, since z is fixed there is no similar interpretation for the number of regulatory regions. with this in mind, we can think of u
c and u
r as average mutation rates given that all duplicates examined have exactly z regulatory regions.

in order to relax this assumption, we computed analogous maximum likelihood estimates for randomly distributed z using a truncated  poisson distribution with parameter α, given by 
  <dig> p=αzz!e−α∑k=220αkk!e−α− <dig>  


which resulted in distributions where the majority of the weight was at the lower end of the truncation, z= <dig>  however, this result should be viewed with care, as the procedure is biased in favour of results which place the majority of the weight around the points of truncation, z= <dig> and z= <dig>  this is because having the majority of the weight on a single value of z allows for the parameters β
 <dig> u
r,u
c to be chosen so as to best fit the particular value of z, giving a distinct advantage over more evenly weighted distributions.

it should be noted that this analysis relies upon a particular set of assumptions, that the mode of action on all genes in the genome is subfunctionalization of the regulatory regions. it should be further noted that subfunctionalization of coding sequences is possible, but in some circumstances may not be a neutral process characterized by the same dynamics. for example, subfunctionalization from a ligand-binding generalist to a pair of specialists that are specific to an individual or set of ligands might require selection to attain that specificity . other types of coding sequence subfunctionalization, like regulation mediated by post-translational modification of specific amino acids might occur with regulatory region-like dynamics.

discussion
the present work partially contradicts hughes and liberles  <cit>  characterization of subfunctionalization by an initially constant, and then broadly decreasing, concave hazard function which has been adapted by subsequent works . the intuition behind this characterization can be explained by thinking of the initial period of constant hazard rate as corresponding to the waiting time for the first mutation. after this first mutation the unaffected gene will be selectively protected against pseudogenization, and hence there is a sharp decline in the hazard rate . once the first mutation has fixed, there is now an opportunity for an additional mutation to lead to subfunctionalization, in which case the rate of pseudogenization will decrease from u
c to  <dig>  the probability that subfunctionalization occurs before time t is rapidly increasing with t, and this leads to the concave decline in the hazard function.

in contrast, our hazard rate hpz has a sigmoid shape, which includes a period of concave decline, followed by a change in concavity, and a period of convex decline. considered as a function of t> <dig>  hpz can include short or long initial periods of concave decline, or no period of concave decline at all, depending on the ratio γ=u
r/u
c. in all cases the hazard rate hpz will be declining convexly towards  <dig> from some point t=t
crit onwards.

for γ>γcritz the change in concavity occurs for some t> <dig>  and we see a short or long period of concave decline followed by convex decline  of fig. 2). this essentially agrees with the characterization of hughes and liberles  <cit> . in fact, fig.  <dig> of  <cit>  shows a period of convex decline in the mean hazard rate when averaging over certain distributions of the number of regulatory regions z. however, the present work shows that even with a fixed number of regulatory regions z a change in concavity will occur in the hazard rate hpz. this suggests that the period of convex decline is more fundamental to subfunctionalization than suggested by the characterization of  <cit> , which focused particularly on the period of concave decline.

for γ<γcritz the difference in our hazard rate and the characterization of hughes and liberles  <cit>  is more stark, and warrants a careful reconsideration of the biological intuition. in this case, the hazard rate hpz is convexly decreasing for all t> <dig>  much like an exponential decay  of fig. 2).

this convexly decreasing hazard rate hpz, as seen in our model, contradicts the characterization of subfunctionalization as predicting a concave decline in the hazard rate. however, the prediction of a convex decay comes from the same mechanics which motivate, and  give rise to the concave characterization. thus, we suggest some new intuition for duplicates that have a large nonfunctionalizing mutation rate in the regulatory regions.

noting that hpz=λpzp≠s), consider now the evolution of a duplicate pair with some large nonfunctionalizing mutation rate in the regulatory regions, relative to that in the coding regions. two important features are then apparent which explain the convex decline of the hazard rate hpz.

first, there is a high probability that an initial nonfunctionalizing mutation in the regulatory region occurs in a short time. this results in an initial, rapid decrease in the rate of pseudogenization, since the first nonfunctionalizing change in a regulatory region results in a change in the pseudogenization rate from 2u
c to u
c.

second, once this first mutation has fixed, there is a very high rate of subfunctionalization . since hpz=λpzp≠s), the term p≠s)  dominates. together with the initially rapidly decreasing pseudogenization, this leads to the exponential-like decay of hpz.

biologically speaking, the case γ<γcritz could correspond to a set of genes with complex regulation and a small coding sequence target for both nonfunctionalization and for the accumulation of synonymous mutations. this analysis predicts that genes with the features of complex regulation requiring multiple functional transcription factors that have the ability to be subfunctionalized together with a short coding sequence would be strong candidates for subfunctionalization rather than nonfunctionalization, and would be less likely to be characterized by a concave hazard function. these conditions could be met, for example, when genes are expressed in multiple tissues at different levels. when examined in actual genomic data, genomes dominated by such genes have not been observed, but represent a theoretical possibility in which subfunctionalization would be better characterized by a convex than a concave declining hazard function.

at the individual gene level, there are several classes of proteins that might be thought of as candidates for falling into this space. casein is a longer protein that could accumulate synonymous changes, but would be hard to nonfunctionalize. it is expressed in multiple tissues, but the regulation of its expression and the strength of negative selection on each regulatory domain is not well known  <cit> .

another example of genes that might fall into this category are hormones like insulin and gonadotropin hormone releasing hormone  that are relatively short proteins, although they are less broadly expressed  <cit> . gnrh has in fact been retained after multiple gene duplication events in vertebrate lineages with functional divergence between copies   <cit> .

our final example of genes that are candidates to show this behaviour are the intrinsically disordered proteins, which are shorter than folded proteins on average, and may be more mutationally robust to nonfunctionalizing mutations  <cit> . what is unclear at this stage is the selection on their function and their expression.

while these types of genes are not likely to dominate any whole genome analysis, the model predicts that genes with small mutational footprints for nonfunctionalizing mutations and large footprints for regulatory subfunctionalization would undergo subfunctionalization at high rates.

CONCLUSIONS
in this paper, we have introduced a new mathematical model for the biological process of subfunctionalization. the model is mechanistically motivated, and analytically and computationally tractable. we have analyzed the model in detail, deriving key performance measures including mean times to subfunftionalization/pseudogenization, variances, and hazard functions. the parameters of the model correspond to real biological processes, and as such we have been able to use model fitting to make some inferences about the nature of gene duplicates in four mammalian genomes. the model provides a means to calculate exact results pertaining to subfunctionalization under different rates of mutation for fixed or randomly distributed numbers of regulatory regions, and to estimate the values of these parameters via maximum likelihood.

this gives a fresh perspective on the subfunctionalization process, and results from the mathematical analysis show that the subfunctionalization model predicts behaviour which is qualitatively more in-line with empirical reality than previously thought. the model fits well to empirical data sets, with its survival function providing a better fit than the often-used exponential function in all of the cases examined. the highly flexible weibull distribution outperformed our model in three of the four cases examined in terms of absolute fit, however the main advantage of a mechanistic model over a flexible phenomenological model is the fact that it uses biologically meaningful parameters.

our analysis of the four mammalian genomes  suggests that  gene duplicates most likely have only a few regulatory regions, and that the rate of mutation in these regulatory regions is around 5– <dig> times smaller than the rate of mutation in the coding region, which is suggestive of the relative mutational target sizes. this is the first model-based estimate of the number of regulatory regions in gene duplicates. the estimates, based upon an assumption of duplicate gene preservation through the subfunctionalization process are in-line with the conventional thinking. force et al.  <cit>  suggested that the ratio of mutations be about  <dig> , and hughes and liberles  <cit>  suggested that between  <dig> and  <dig> regulatory regions were realistic. mechanistic characterization of mutational potentials in protein-coding genes from molecular-level analysis can add additional insight into these parameterizations.

further, we have discovered a previously unrecognized characterization of subfunctionalization which could theoretically occur in genes with small mutational footprints for nonfunctionalizing mutations and large footprints for regulatory subfunctionalization. while these genes are not likely to dominate any whole genome analysis, the model predicts that they would undergo subfunctionalization at high rates, with a sharply convex declining hazard rate for pseudogenization. this contrasts the characterization of hughes and liberles  <cit> , which features a  concave declining hazard rate and is confirmed by our model for genes with larger footprints for nonfunctionalization mutations.

in order to make accurate inferences in a phylogenetic context, increasingly realistic models of the underlying evolutionary processes will be required. while the model described here tackles only a small piece of the overall picture of the evolution of gene duplicates, we believe it is helpful towards the development of a mechanistic model for the overall process of gene duplicate evolution. our model describes the evolution of a pair of duplicates evolving under subfunctionalization with relatively few assumptions. in terms of modeling this process, the main weaknesses of the model are the lack of detailed modeling of the coding region, which is treated as a single unit which can undergo nonfunctionalizing mutation at a constant poisson rate, and the assumption of constant poisson rates of mutation, consistent across the regulatory regions.

applying this model to whole-genome data, as in the section “fitting the model to genome data”, requires a broadening of scope beyond the evolution of a pair of duplicates, and beyond the process of subfunctionalization. we have implicitly assumed that all of the duplicates in each of the genomes examined are evolving under subfunctionalization, which is not likely to be a realistic assumption. also, we have fit a single parameterization of the model to each genome. this is similarly unrealistic, as it would imply that all duplicates have the same number of regulatory regions as each other, and that all of these regulatory regions undergo nonfunctionalization at the same rate. at the whole-genome level a more realistic approach would be to allow each duplicate pair to evolve according to a separate parameterization of the model, however this method would have no statistical power.

furthermore, some attributes of the generative process have not been modeled. one example is the underlying population genetic process of fixation of both the gene duplicate itself and mutations in the gene. when these mutational events are non-neutral, this process becomes particularly difficult to model. similarly, the organisms studied here at genomic levels are diploid, but no model for dominance and the underlying genetics has been proposed. finally, a steady state mutational process has been assumed, with a constant duplication rate.

two distinct avenues for extension of the work presented here are apparent. the first is in widening the scope of the model itself, for example by including other processes besides subfunctionalization, such as neofunctionalization, dosage balance, and potentially other processes described in innan and kondrashov  <cit>  to create a more complete model for the evolution of gene duplicates. the second avenue for extension would focus on the application of models in broader analysis. here we applied our model in a whole-genome analysis to get some estimates of mutation rates and number of regulatory regions. the larger problems of the inference of parameters in a phylogenetic context, gene tree/species tree reconciliation, and ancestral copy number inference from multi-species data in a phylogenetic context are of particular interest.

additional files

additional file  <dig> contains most of the mathematical details supporting this analysis, including derivations and proofs of various results referenced throughout the main body of this work. 





additional file  <dig> contains the data set analyzed in this work. the data was originally published and analyzed by hughes and liblerles  <cit> . 





additional file  <dig> contains matlab scripts used in this analysis, together with some directions for use. 




abbreviations
ctmccontinuous time markov chain

ddcduplication–degeneration–complementation

gnrhgonadotropin hormone releasing hormone

mlemaximum likelihood estimate

funding
mmo would like to thank the australian research council for funding this research through linkage project lp <dig>  brh would like to that the australian research council for funding this research through future fellowship ft <dig>  dal would like to thank the united states nsf for funding this research through grant dms -  <dig> 

availability of data and materials
the data set supporting the conclusions of this article is included in its additional files. the data set was obtained from correspondence with tim hughes, and was first published in  <cit> .

authors’ contributions
tls conceived the model and performed mathematical analysis, data analysis and prepared drafts and developed code. mmo conceived the model, performed mathematical analysis, wrote parts of the initial draft and edited drafts. brh performed mathematical analysis, edited drafts and offered biological insight. dal edited drafts and provided key biological insight and interpretation of results. all authors read and approved the final manuscript.

competing interests
the authors declare that they have no competing interests.

consent for publication
not applicable.

ethics approval and consent to participate
not applicable.
