BACKGROUND
with the breakthrough of protein structure determination technologies, in particular x-ray crystallography, rapidly increasing 3d structures of proteins become available. for example, pdb  has stored  <dig>  entries which are solved by x-ray crystallography as of july  <dig>  these quaternary structures can be used to uncover the binding mechanisms of proteins and to annotate protein functions. however, crystal packing contacts, which are a kind of false protein binding, also exist in pdb to blur the analysis of quaternary structures. in fact, crystal packing is due to the artifact of the crystallographic packing environments and it is randomly formed during the crystallization process. it does not occur in solution or in physiological states  <cit> . the immediate question is how to accurately determine whether a crystal contact produced from a pdb entry is a true biological interaction. this problem is difficult especially when a protein complex consists of a large number of protein chains, a common situation in pdb and also in real biological systems.

this research problem has attracted intensive interests. methods have been proposed to understand the difference of interfacial properties between biological binding and crystal packing. for example, biological interfaces were found to be much larger  <cit> , or more conserved than crystal packing  <cit> , or more abundant in aromatic residues  <cit> . biological interactions were also found to have different residue composition from the rest of protein surfaces  <cit> , while crystal packing interfaces possess similar composition to the rest of protein surfaces as a whole  <cit> .

complicated computational methods have also been proposed to classify true biological binding and false binding. an idea is to break an interface down to contacting atomic or residue pairs, and then uses the enrichment or frequency of these pairs as features for the classification. based on the atomic pair representation idea, weng's group  <cit>  and klebe's group  <cit>  have both utilized machine-learning algorithms to construct effective classifiers for distinguishing different types of protein binding, such as crystal packing, permanent and transient interactions  <cit> . liu et al. have used a new definition of atomic contacts named β contacts in atomic pair representation for interfaces, and demonstrated that it is a novel idea to outperform the existing methods in distinguishing crystal packing from homodimers  <cit> . using residue pairs to describe interfaces, bernauer et al. have constructed an svm classifier dimovo for identifying biological protein interactions  <cit> . liu and li have designed the propensity vector of residue contacts within the o-ring to develop oringpv for the distinction between crystal packing and biological interactions  <cit> . many other features have also been used. for example, the pita method scores crystal packing using the properties of contact size and chemical complementarity  <cit> . zhu et al.  <cit>  have extracted six properties from interfaces, such as interface size, amino acid composition and gap volume, and then used them as an svm input to train their noxclass classifier to discriminate between crystal packing, obligate and non-obligate interactions  <cit> . recently, capitani's group  <cit>  have proposed to use core size and evolutionary metrics of interfacial residues to classify small biological interfaces from large crystal contacts. their method eppic can outperform a widely-used method pisa  <cit> .

despite the intensive research on the characterization of crystal packing and biological binding, it still remains an important issue to design a good method which can be always effective across multiple datasets containing interfaces of diverse sizes, and especially on those datasets where crystal packing and biological binding have similar interface sizes  <cit> . it is even more challenging to detect one single discriminative feature which can clearly characterize crystal packing interfaces having different sizes across multiple datasets.

in this work, we propose to use b factor to distinguish biological interfaces from crystal packing contacts. b factor is a measure to capture the atomic vibrational motion. we propose to use three features derived from b factor for this classification problem. one is denoted as Σb; it is the sum of the normalized b factors of the interfacial atoms at a binding interface. the second is the ratio of Σb over the logarithm of minr +  <dig> . this feature is denoted by avgΣb. the third feature is denoted by avgno.b which represents the ratio of the number of interfacial atoms with a negative normalized b factor over the logarithm of minr +  <dig>  the fourth new feature is a compound feature by integrating avgΣb and avgno.b through multiplication to amplify these two features' collective synergy.

to show the effectiveness and the interpretability of the four features, we visualize their distribution properties from four datasets of biological binding and crystal packing, and from a biological protein-protein and protein-peptide binding dataset newly constructed from pdbbind  <cit> . for the protein interactions in this new dataset, their binding affinity is known and the complexes have diverse interface sizes.

because interface area is considered as one of the most effective features by the existing research, we especially compare our features with interface area. to show the overall classification performance of these features, we also compare the cross-dataset classification performance of each of the four features with the performances achieved by the interface area approach and those by existing methods. the results have demonstrated that each of our four features, in particular avgΣb, avgno.b and their multiplication, consistently outperforms the feature interface area and existing prediction methods across almost all of the datasets. these features based on b factor thus have a strong capability to distinguish true and false biological interfaces of diverse sizes for real-world applications.

data sets
four datasets in the literature and a new dataset are used to investigate the four features derived from b factor.

the first dataset  contains  <dig> crystal packing interfaces and  <dig> biological homodimers  <cit> . dimovo was trained on this dataset  <cit> .

the second dataset  has  <dig> crystal packing interfaces and  <dig> homodimers  <cit> . this dataset was used by several existing works  <cit> , including pita  <cit>  and pisa  <cit> .

the third dataset  comprises  <dig> obligate interactions and  <dig> crystal packing interfaces  <cit> . noxclass was trained on this dataset.

the fourth dataset  is composed of  <dig> crystal packing interfaces and  <dig> biological interfaces  <cit> . the uniqueness of this dataset is that crystal packing interfaces are larger and biological interfaces are smaller than those in the first three datasets. eppic was trained and optimized on this dataset  <cit> .

a new dataset is constructed from the protein-protein binding and protein-peptide binding data stored at pdbbind  <cit> . all the complexes are annotated with a binding affinity extracted from pdbbind. the binding biological units in pdb structures are obtained using an automatic process according to the information provided in pdbbind. an interface is included in this dataset, if the pdb structure satisfies the following requirements.  the pdb structure is determined by x-ray crystallography rather than other techniques, and  the resolution is better than  <dig>  Å.  in the pdb entry, the number of atoms should be 3+ times than the number of residues in order to remove those pdb entries with a possible error.  in the complex, both of the binding partners have more than  <dig> residues.  in the interface, the number of atomic contacts from non-standard residues is less than 20% of all atomic contacts. this newly constructed dataset is composed of  <dig> protein-protein or protein-peptide complexes with binding affinity information. this dataset is denoted as pdbbind. it is a bench-marking dataset for testing algorithms on classifying biological binding interfaces of diverse area sizes.

methods
in this section, we describe what is b factor and how it is normalized. then, we describe how to derive b factor related features to represent an interface. we also show how to detect the optimal distinguishability of each feature on training datasets and then test it on other datasets.

b factor and its normalization
b factor is also known as temperature factor or debye-waller factor. it measures and quantities the uncertainty/mobility of an atom in dynamic protein 3d structures, namely, the displacement of the atomic positions from its mean position. b factor is an indicator of the relative vibrational motion or the disorder of an atom in protein crystal. it is calculated using bi=8π2ui <dig>  where ui <dig> is the mean square displacement of atom i. b factor increases as ui <dig> increases. a low b factor implies that the atom is in the well-ordered parts of the structure, while a large b factor generally suggests a very high flexibility of this atom.

protein flexibility is closely related to protein functions such as catalysis and allostery  <cit> . deeply buried atoms in the core of the protein are usually rigid with a low b factor  <cit> , and interfacial residues in protein binding complexes also have lower b-factors in comparison to the rest of the tertiary structural surface  <cit> . for different pdb structures, the distribution of b factors varies greatly. thus, a normalized b factor is used in this work and calculated by equation  <dig> 

  bnormi=bi-b¯ ¯δb× <dig> b¨normi=min 

where bi is the b factor of atom i, b ¯ and δb are the mean and the standard deviation of the b factor of all atoms within a binding unit of the pdb biological complexes, and bnormi is the normalized b factor of atom i. the number  <dig>  is a typical threshold under a standard normal distribution, indicating the  <dig>  probability of a value outside  for each of the two tails. min means the minimum of two values, while max returns the maximum. the first equation in equation  <dig> is used to normalize and scale the 90% confidence interval of the b factor to . the second equation in equation  <dig> is used to set any value outside the 90% confidence interval to either - <dig> or  <dig>  whichever is closer. the normalization is performed individually on each contact partner in a complex, no matter the contact is false or true.

using b factor related features to characterize an interface
interfacial atoms
an atom from a biological unit is defined as an interfacial atom if it has at least one β contacts with the partner biological unit. we note that a biological unit may contain more than one chain. β contact is a new definition of atomic contact  <cit> . it requires that there is no other atom interrupting the contact. formally, given a quaternary structure of a protein complex p, a β contact between two atoms i and j in p requires that  the spatial distance between i and j is less than a threshold td plus the sum of their van der waals radii defined by  <cit> ,  i and j share a voronoi facet in p's voronoi diagram, and  the contact cannot break p's β-skeleton. the β-skeleton  <cit>  of a discrete set p is an undirected graph in computational geometry. in this graph, two points i and j have an edge if angle ikj is sharper than a threshold determined by β, ∀k ∈ p, k ≠ i, j. this angle threshold is denoted as ∠β, which actually defines a forbidden region fr of the contact between i and j. the forbidden region fr of a β contact usually does not cover any other atoms. otherwise, if there is an atom k in fr, the contact between i and j is not a β contact. a β contact suggests that its two atoms should have enough direct contact area to form an important interaction. the number of atomic β contacts in protein binding interfaces is only a small fraction number of distance-based contacts or less than half the number of contacts in the voronoi diagrams  <cit> . interestingly, it has been demonstrated that the use of β contacts can achieve better prediction performance for distinguishing false binding of crystal packing from homodimers  <cit> , for predicting binding hot spots and the change of binding free energy after mutations  <cit> , and for estimating protein-ligand binding affinity  <cit> .

in this work, an interfacial atom is used for further analysis if and only when the number of its local contacts across the interface is more than  <dig>  the local contacts of an atom include the contacts of the atom itself and the contacts of its covalently-bonded nearby atoms. the covalently-bonded nearby atoms of a given atom i are those atoms within two covalent-bond steps from i. for example, given a chain of covalent bonds i − j − k − l − m, where − indicates a covalent bond. from i, the covalently-bonded step is  <dig> to i, is  <dig> to j, is  <dig> to k, is  <dig> to l, and is  <dig> to m. thus, i, j and k are the covalently-bonded nearby atoms of atom i, while l and m are not. the requirement of the number of local contacts is used to detect non-isolated atomic contacts.

four interfacial features related to b factor
b factor score  the first feature to describe an interface is the sum of the normalized b factors of all of the interfacial atoms. that is, Σb= ∑j=1nb¨normij, where n is the number of interfacial atoms and ij is an interfacial atom,  <dig> ≤ j ≤ n.

average Σb  a recent published work has suggested that the area size of protein interfaces is related to the size of proteins  <cit> . thus, we calculate the ratio of Σb over the logarithm of minr +  <dig>  and name this ratio average Σb, denoted by avgΣb. formally, avgΣb = Σb/log. here, minris the smaller number of the average numbers of residues per chain for the two biological units in a complex. the logarithm is used to decrease the effect of minr on avgΣb when minr is extremely large.

the number of interfacial atoms with a negative normalized b factor  we also calculate the number of interfacial atoms having a normalized b factor less than  <dig>  it is denoted by no.b. similarly, we produce the ratio of no.b over log based on the same reason for avgΣb. this ratio feature is denoted by avgno.b.

a combined feature--avgΣb*avgno.b we also multiply avgno.b and avgΣb/ <dig> as a feature to describe an interface. this feature is denoted by avgΣb*avgno.b. the intuition behind this new feature is to amplify the collective synergy of avgΣb and avgno.b through multiplication.

interface area 
an effective feature widely used by the existing works to distinguish biological binding and crystal packing is interface area . interface area measures half of the change of a surface area upon protein complex formation. the classification performance of this feature is considered as a baseline performance here. Δasa of a protein complex is calculated through equation  <dig> 

  Δasa=/ <dig> 

where asa <dig> and asa <dig> are the surface areas of the two biological units of the protein complex and asac is the surface area of the protein complex.

similarly, the ratio of Δasa over the logarithm of minr +  <dig> is denoted by avgΔasa. both Δasa and avgΔasa are compared with the b factor based features for identifying biological binding interfaces from pdb structure data.

optimization of the scoring threshold for each feature
for each of the features introduced above, we use the following process to find the best threshold point on a learning dataset for the classification of test data. we explore all possible split points for a feature, and assess the mcc performance with regard to every split point. then, we collect all those split points which produce the top 10% performance, and take the average of these split points as the optimal split threshold for the feature in the learning process. this threshold is used to predict interaction types  for the structure data from the other datasets. using the average of the top 10% best split points instead of the best split point is for the purpose of increasing performance stability and generalizability of the feature. when the pdbbind dataset is used for learning, the value at the first 25% quantile, which is close to  <dig>  is used as the threshold and tested on the other datasets. this is because pdbbind is constructed using an automatic process without manual checking, and it is possible that some true complexes are wrongly collected. the threshold value 25% is not optimal. there is no gold standard to select an optimal threshold on pdbbind, because only positive samples are given.

assessment measures
prediction performance is measured by precision, recall, specificity accuracy and mcc whose definitions are given in equation  <dig> 

  precision=tptp+fprecall=tptp+fnspecificity=tntn+fpaccuracy=tp+tntp+tn+fp+fnmcc=tp*tn-fp*fn 

where binding complexes are considered as the true cases, while crystal packing as the false cases; tp, fp, tn and fn are the number of true positives, false positives, true negatives and false negatives, respectively. hence, precision is the number of correct binding complex predictions divided by the number of positive predictions, recall is the fraction of correct binding complex predictions over all true binding complexes, while accuracy is the number of correct predictions divided by the number of all true or false complexes.

RESULTS
we report cross-dataset classification performances achieved by each of the b-factor based features in comparison with the performance by the feature interface size . it is observed that avgΣb, avgno.b and avgΣb*avgno.b have much better performance than Δasa. we then present a detailed distribution analysis for these features' scores of the protein structures from the five datasets. we also compare avgΣb with two published methods eppic  <cit>  and pisa  <cit>  to highlight our better classification performance.

cross-dataset classification performance by single features
comparison between Σb and Δasa: Δasa is a geometrical feature widely used by existing methods, and it is considered as an effective approach to the classification between crystal packing and true biological binding. it has been suggested to use  <dig> Å <dig>  <cit>  as a threshold to distinguish crystal packing contacts from homodimers, achieving an accuracy of 85% on the ponstingl data set. in  <cit> , it is shown that a cutoff of Δasa at 650Å <dig> has approximately 7% error rates on the bncpcs dataset including  <dig> non-obligate interactions. however, these methods have limits to achieve good performance when the biological binding interfaces and crystal packing contact areas have diverse interface sizes.

bncpcs
dc
bahadur
ponstingl
x.xx represent the classification performances where x.xx is the mcc score and y.yy is the accuracy score. the italic numbers are the learning performances, and thus they are not used in the comparison. the bold-font numbers are the better performances when comparing Σb and avgΣb*avgno.b with Δasa, and Σb with Δasa.

when tested on the bahadur and ponstingl datasets, Σb outperforms Δasa for all cases, achieving at least  <dig>  mcc improvement in  <dig> of the  <dig> cross-dataset comparisons, and achieving  <dig>  -  <dig>  mcc improvement in another  <dig> comparisons. when tested on bncpcs, Σb has also achieved higher mcc performance than Δasa when both Σb and Δasa are optimized on dc and bahadur. Δasa has only achieved a higher mcc performance than Σb on bncpcs, when optimized on the ponstingl dataset. we note that crystal packing contacts from bncpcs are easy to be distinguished--both Σb and Δasa have achieved an accuracy higher than  <dig> . when pdbbind is used in learning process and the other datasets are used for testing, Σb always outperforms Δasa remarkably.

comparison between avgΣb and avgΔasa: when the two average-smoothed features, i.e., avgΣb and avgΔasa, are used in the classification, their performance is better than the non-smoothed features Σb and Δasa, respectively. this affirms that taking average is a good way to deal with the issue of relative size of an interface compared to its chains. this idea is especially meaningful when protein-peptide binding interfaces are considered for classification where peptides are usually of small sizes and the corresponding binding interfaces are always much smaller than protein-protein binding interfaces. table  <dig> also shows the superior performance of avgΣb in comparison with avgΔasa for almost all of the cross-dataset tests.

the performance of avgno.b and of avgΣb*avgno.b: the feature avgno.b is also useful to classify crystal packing from biological binding. but its performance is a bit unstable in comparison with Σb or avgΣb. nevertheless, it still has a stabler than Δasa. the cross-dataset classification performance by avgΣb*avgno.b  is presented in the middle row of table  <dig> for each of the datasets. this performance is competitive to the best performance achieved by avgΣb or avgno.b. this feature also outperforms Δasa and avgΔasa for almost all of the across-dataset tests.

the value distributions of our b factor based features and the value distribution of the feature interface size
the value distributions of the features on the five datasets are drawn in figures  <dig>   <dig> and  <dig>  the p-values of these distributions for the two types of interfaces are reported in table  <dig>  it is clear from figure  <dig> and figure  <dig> that b factor related features such as Σb are more powerful than interface size to distinguish between biological binding interfaces and crystal packing interfaces.

bncpcs
dc
bahadur
ponstingl
in particular on the dc dataset, crystal packing contacts have very similar area sizes with those of the biological binding interfaces. features Σb and avgΣb can classify these two types of interfaces very well. this classification is quantified as in table  <dig> where b factor related features always have much smaller and more significant p-values than those of Δasa. however, Δasa even has insignificant p-value  <dig>  on the dc dataset. features avgno.b and avgΣb*avgno.b  can also separate the two types of interfaces with a clearer boundary than Δasa does  and figure 2).

the scatter plots of avgΣb and Δasa on the five datasets are presented in figure  <dig>  figure  <dig> indicates that Δasa wrongly classifies many of those protein binding interfaces of pdbbind below the horizontal line as crystal packing contacts, while avgΣb misclassifies much less number of protein binding interfaces on the right-hand side of the vertical line . further, figure  <dig> suggests that a cross-dataset Δasa threshold is useless on dc. figure  <dig> on the bahadur dataset and figure  <dig> on the ponstingl dataset both demonstrate that many of the crystal packing contacts with a large interfaces can have a small avgΣb values and thus they can be correctly classified by avgΣb. in figure  <dig> on bncpcs, both Δasa and avgΣb are powerful to distinguish between crystal packing and biological binding.

in conclusion, avgΣb and avgΣb*avgno.b have a consistent classification performance across the datasets with diverse interface sizes, including those large interfaces of crystal packing and small interfaces of biological binding.

classification performance comparison with pisa and eppic
the performances by avgΣb and avgΣb*avgno.b are compared with a widely-used method pisa and a newly published method eppic . although much less number of features are used by our approach, our single feature avgΣb can outperform both eppic and pisa. on both the ponstingl and the bahadur datasets, the mcc scores of eppic are quite close to those of avgΣb, and also much higher than those of pisa.

all of these methods are optimized on the dc dataset. eppic-core is the classifier using the number of core residues in interfaces according to the definition in eppic. the performance of eppic or pisa is borrowed from  <cit> . the scores of eppic and pisa are absent on the bncpcs dataset.

our method also has much higher specificity and higher precision, indicating that the predicted biological binding interfaces are more likely to be true binding. it is thus quite useful to automatically compile protein-binding datasets from pdb for large-scale structural analysis where crystal packing contacts should be correctly labeled and then excluded to enhance the analysis results.

feature avg Σb can be used to correct errors in biological binding annotation: an example
the b factor feature avgΣb is able to correct annotation errors. we demonstrate such corrections in figure  <dig> by examining two derived protein complexes from pdb entry 1uby.

the interface in figure  <dig> is manually mistaken as a biological binding interface in the bahadur dataset. but, it is the interface in figure  <dig>  instead of that in figure  <dig>  that should be in this dataset. feature avgΣb can correct this mistake with two reasonable evidences as follows. firstly, the interface in figure  <dig> has an avgΣb value of  <dig> , which is in the top-right region of figure  <dig> with '+'. this avgΣb value is extremely different from the avgΣb values of other biological binding interfaces as shown in figure  <dig>  secondly, the interface in figure  <dig> has atoms with larger b factor in red, while the interface in figure  <dig> has atoms with much smaller b factor in blue. thus, avgΣb can make a reasonable prediction that the interface in figure  <dig> is dimeric and the interface in figure  <dig> should not be. this is also consistent with the biological evidence in the remark  <dig> of 1uby <cit> . thus, the interface in figure  <dig> needs more biological evidences to be claimed as a true dimer. this example illustrates that the b factor feature avgΣb can be used to correct wrong annotations of biological binding interfaces.

CONCLUSIONS
in this work, we have proposed to use b factor as a new characteristic to distinguish between crystal packing contacts and biological binding interfaces. assessed on five datasets, all of the b factor related features have exhibited their excellent capability for classifying various biological binding interfaces with diverse interface sizes. our b factor features have also achieved better classification performances than the widely-used feature interface size and two published methods pisa and eppic. in particular, the average sum of normalized b factor of interfacial atoms is a clear indictor for biological binding. as a future work, the b factor related features and our method will be employed for a large scale annotation of potential biological binding interfaces for pdb.

competing interests
the authors declare that they have no competing interests.

authors' contributions
ql designed the methods and performed the experiments. jl supervised the study. jl and zl participated in the analysis. ql drafted the manuscript. ql, zl and jl read and revised the manuscript. all authors approved the final version.

