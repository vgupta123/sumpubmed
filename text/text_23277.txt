BACKGROUND
the failure to develop a rational, generally applicable cure for obesity-related diseases can be attributed to the highly complex regulation of energy metabolism, which is not yet fully understood. on the other hand considering the historic successes in deciphering the underlying biochemical pathways, it is assumed that the chemical transformation steps of basic metabolites are known in their entirety. this view is seriously questioned in light of the recent discovery of atgl, a protein that catalyzes the initial step of hydrolysis of triacylglycerides at the surface of lipid droplets in adipocytes  <cit> . it is surprising that the fundamental activity of this key enzyme escaped from attention so far  <cit> . just considering the many dozens of additional hypothetical human protein sequences with low but statistically significant sequence-similarity to known metabolic enzymes that can be collected with psi-blast searches  <cit> , more such findings are still expected to be ahead.

one of the key steps in energy metabolism is the separation of fatty acids from glycerol moieties. a diverse set of lipases performs this task in various contexts by hydrolyzing the connecting ester-bonds  <cit> . one of the best characterized lipases, pancreatic lipase, acts at the stage of food digestion  <cit> . other lipases, such as hormone sensitive lipase or lipoprotein lipase, are involved in lipid accumulation and release in tissue  <cit> .

most lipases share a common type of 3d structure known as α/β-hydrolase fold, which is present in enzymes with quite diverse substrate specificities  <cit> . the catalytic mechanism of most lipases is reminescent of serine proteases as it proceeds via the nucleophilic attack of a serine-histidine-aspartate triad  <cit> .

the recently discovered, novel key enzyme involved in fatty acid release from adipocytes, adipose triglyceride lipase   <cit> , does not share any direct sequence similarity with known mammalian lipases. in fact, it appears to belong to a protein family that is centered around patatin, a potato storage protein with lipid acyl hydrolase activity  <cit> . the catalytic mechanism of these enzymes is inherently different from classic lipases as it proceeds via a serine-aspartate dyad  <cit>  as opposed to the well described serine-histidine-aspartate triad.

in this work, we present sequence-analytic evidence that the atgl/patatin family and the classic mammalian lipases represented by the human pancreatic lipase evolved from a common ancestor. moreover, we display a set of structural and sequence key features that are conserved between these two enzyme groups including also related protein families.

the analysis of homology relationships within large superfamilies of protein sequences are a reoccurring theme in biomolecular sequence analysis. finding the pancreatic lipase/atgl relationship is just one application for the respective methodologies. it should be noted that detecting subtle yet statistically significant and structurally plausible relationships in families involving thousands of members is not a straightforward task since the manual analysis of myriads of reports generated by standard blast/psi-blast  <cit>  installations for sequence comparisons in databases is impossible in practice. progress in this area was hampered by insufficiently developed tools. here, we developed a computer implementation of a family searching heuristic involving:  automated invocation of fan-like iterative psi-blast  <cit>  searches with starting sequences.  filtering of starting sequences with various sequence-analytic methods for detecting compositional and repetitive pattern bias.  automatic re-detection of starting sequence segments in reciprocal searches.  criteria for alignment length and overlap with the starting sequence segments.  automated parsing of outputs and  database-supported analysis of similarity networks. the user-parameterized measures  are designed to suppress the detection of unrelated hits for the case of a starting sequence that are thought to represent a single globular domain, a functionally and structurally independent elementary module. this familysearcher is part of the sequence-analytic workbench annie  <cit>  that is being developed in our laboratory. to our knowledge, this article describes the first software package for sequence family collection with fully automated checks for bidirectional search criteria, transitive hit overlap criteria and generic procedures for masking repetitive regions that is applicable for extremely large sequence families.

RESULTS
familysearcher: methodical specifics of analyzing homology relationships in large sequence families
the concept of sequence homology is a powerful approach to organize the sequence space of known proteins and to generate hypotheses on the function and evolutionary origin of yet uncharacterized proteins  <cit> . if a protein sequence segment "a" without compositional or pattern bias is used as a starting point in a search for similar proteins and reveals a sequence "b" as a hit, the respective two sequences are considered homologous and a common evolutionary ancestor can be postulated. the direct connection between these two sequences is called a unidirectional link if "a" finds "b" and a bidirectional one if the reciprocal search started with "b" also reveals "a" as homologue. if two protein sequence segments "a" and "b" do not have a direct link but are significantly similar to the same sequence region of an intermediary protein "i", all three sequences are considered homologous. this relationship can be generalized for the case of multiple intermediates. the sequence of links in the sequence space relating two homologous proteins is termed a path.

studying distant homology relationships of densely populated protein clusters of the sequence space with thousands of similar sequences is a complicated endeavor. blast/psi_blast searches  <cit>  are not commutative with respect to exchanges of starting and hit sequences and slightly differing queries can collect largely different families. therefore, only exhaustive searches involving all potential family members as start sequences can assure that the maximal number of sequence family members is found. this procedure also ensures that non-trivial paths to new proteins that are unexpectedly related are determined. for the analysis of large families, this implies thousands or tens of thousands of database searches. although performance and costs of compute servers and storage devices have improved, it is still early to launch such calculations without well-thought selection of a starting protein segment . besides the hardware issues, software solutions are necessary to automatically guide the search process and to analyze the huge amount of data generated.

within our annie suite  <cit> , we have developed familysearcher, a generic environment for protein sequence family collection . the procedure is organized in stages. at the beginning of each stage "n", the starting sequence segments  are freed from regions with compositional and repetitive pattern bias and psi-blast  <cit>  searches are started with them. hit segments are collected, parsed and the new hits represent the start sequences for the next stage "n+1". it is possible to exclude candidates that are not confirmed by reciprocal checks; i.e., the requirement that the starting sequence at stage "n+1" should find back the same region of the starting sequence at stage "n" that lead to its own selection as a hit . after completion of a predefined maximal number of stages , the links are stored in a database and paths between hits are analyzed. this strategy has already been successfully applied to reconstruct entire sequence families for smaller sequence groups  in similar contexts where a simpler procedure was applied.

paths of links in the sequence space with statistically significant sequence similarity between the groups of atgl/patatin and classical lipases do exist
to search for a connection between classic lipases and atgl, we selected the lipolytic domains of one well-characterized protein for each sequence family as a starting sequence set. we used regions of the pancreatic lipase  and of the potato tuber protein patatin  for two separate familysearcher processes. after performing up to seven stages of the collection procedure for either of the familysearcher processes , we indeed obtained a set of  <dig> paths that connect these two query sequences. for one set of nine intermediate sequences establishing a connection between the two starting targets, several paths are depicted in figure  <dig> 

there are paths that consist fully of bidirectional links  with the sole exception of the links connecting a representative of the classical lipase group to the potential patatin-like phospholipase eal <dig>  for example , the connection between yp_ <dig>  and eal <dig>  can only be established from the pancreatic lipase side of the path. closer examination of significances reveals that the links at this stage are also among the weakest and appear to represent the "missing link" between the two sequence families. there are other paths between the two starting sequences avoiding eal <dig> but the respective significances are worse and the alignments are shorter . known 3d structures that are most closely related to the proteins included in the path of figure  <dig> are listed in table  <dig>  obviously, the scop and cath identifiers above eal <dig> correspond to variations within a single superfamily . the step to the atgl/patatin group involves a change in fold . figure  <dig> also shows that there are several "shortcuts". these are links between non-adjacent intermediates in the path with a maximal fraction of bidirectional links that, although being significant, lack a confirmation from reciprocal searches. known 3d structures that are most closely related to the proteins included in the path of figure  <dig> are listed in table  <dig> 

it should be noted that the familysearcher run had to be halted because of computational time and storage space constraints. at the given point, the algorithm had been running on  <dig> cpus for  <dig> days while it had produced about  <dig> terabyte of data. since the main aim of uncovering a link between the two families of lipases had been accomplished , it was decided to stop the run and investigate the obtained results in detail. it can be expected that other "missing links" or even further related protein families remain to be found despite of the variety of proteins and enzymes that were already detected to be related to the two lipase families.

the ancestral module common to the atgl/patatin and classical lipase families consists of a three-strand β-sheet, an α-helix and a turn with the active site serine
the set of protein segments collected by familysearcher has a common region of homology that forms the basis for the path in the sequence space connecting the pancreatic lipase group with patatin/atgl. this common region can be distilled by analyzing the psi-blast generated pairwise alignments, by 3d structural considerations and by investigating conservation patterns in sequence subfamilies . an alignment of the respective sequence regions involving the path members from figure  <dig> , representatives from most major clusters as well as their most similar sequences with atom-level resolved 3d structure is shown in figure  <dig> . the common region of similarity involves 50– <dig> residues and is sometimes interrupted by inserts. we suggest that these 50– <dig> residues represent an ancestral sequence module that, at the beginning of its evolution, might have been without inserted regions. it is interesting to note that this module contains only a part of the catalytic core, namely the nucleophilic serine, which is either involved in an enzymatic triad  or dyad mechanism . the sequence regions that encompass the remaining catalytically active residues are too divergent among many subfamilies to deduce an ancestral relationship and, thus, could not be incorporated into the multiple alignment, which represents the whole sequence group . the phylogeny of the sequence segments from the alignment  is in agreement with the supposed evolutionary position of the intermediate sequences found in the path.

from the viewpoint of molecular function, these homologues are not limited to lipases and esterases, but include large sets of proteins that act on various other types of substrates. among these enzymes are proteins such as polyketide synthases, dienelactone hydrolases or aminopeptidases . as we did not reconstruct the entire encompassing protein family, we expect that more proteins with alternative substrate specificities might be detected in rigorous searches. nevertheless, the variety of enzymes found in this work clearly demonstrates the ubiquitousness of the ancestral module.

visual inspection of 3d structures of proteins encountered during the search at regions involved in the alignment of figure  <dig> reveals a set of conserved structural elements. these consist of three parallel β-strands and an α-helix located between the second and third strand. the characteristic nucleophilic elbow of esterases is located in the loop between the end of the second beta-strand and the start of the alpha-helix. considering the locations of the secondary structural elements with respect to the nucleophilic elbow, we introduce the following numbering: β- <dig> and β- <dig> for the strands that are upstream of the nucleophilic residue, and α+ <dig> and β+ <dig> for the structures that lie downstream of the elbow. the core structural elements are depicted in figure  <dig> 

only few automated structure comparison tools such as ce  <cit>  can delineate common substructures from otherwise differing protein structures. it is interesting to note that this program does not find the ancestral core module if it is confronted with the complete 3d structures of the respective proteins. we generated pairwise structural superposition of a set of  <dig> 3d structures , 1din  <cit> , 1auo  <cit> , 1fj <dig>  <cit> , 1m <dig>  <cit>  – from proteins obtained in the family-search using pancreatic lipase as the query, and a set of two structures – 1oxw  <cit> , 1cjy  <cit>  – from the atgl-side). for the  <dig> superposed pairs of α/β-hydrolase structures belonging to the pancreatic lipase group,  <dig> aligned with scores at family level similarity ,  <dig> with superfamily level similarity ,  <dig> in the twilight zone , and  <dig> with low significance similarity with z-scores between  <dig>  and  <dig> . moreover, the secondary structural elements β- <dig> and α+ <dig> including the active nucleophilic residue were correctly aligned for each pair of structures, regardless of the significance level. the same observation could be made for the  <dig> structures from the atgl-side . however, no alignment could be generated by ce between any structure from the classic lipase set and any from the atgl side. we concluded that fold similarities are restricted to a small part of the structure – the conserved ancestral module – and that this stretch is simply too short to provide significant results because the remainder of the fold could not be aligned by the ce program.

to test this hypothesis, we generated structural alignments between the set of  <dig> structures and  <dig> different sub-stretches of the crystal structures from the atgl-side:  the entire core module ranging from β- <dig> to β+ <dig> including also inserted secondary structure elements .  the part of the core module that encompasses the nucleophilic elbow from β- <dig> to α+ <dig> . in the former case, a nearly correct structural superposition  could be obtained for about half of the alignments, yet with low-significance similarity levels corresponding to z-scores between  <dig>  and  <dig> . in the latter case, all core elements were correctly aligned to the subject structures. the low z-scores of  <dig> – <dig>  obtained in this context are a result of the shortness of the stretch. as the significance measure is dependent on the length of the region, even the cores of the highly similar structures 1cjy and 1oxw align with a z-score of only  <dig> . these results indicate that structural similarities limited to the ancestral core module do exist, even though fold and sequences may be different for classic lipases and atgl.

discussion and 
CONCLUSIONS
the analyses of homology relationships between sequences of large superfamilies were previously hampered by the insufficiency of the available computer-based methods and corresponding tools. for example, confirming an evolutionary relationship between classical lipases clustered around pancreatic lipase and the atgl/patatin group is a difficult task not only because the relationship is distant, the similarity is subtle and the respective common region involves a substructure interrupted with insertions. the group of sequences that are very similar to classical lipases is so large  that most database searches started with their representatives get obliterated with closely related group members. it becomes a major problem to identify proteins that are located at the boundary of this cluster and give hope to discover new links to outside protein groups if used as a starting sequence. on the other side, sequence diversity among the atgl/patatin group is obviously not large enough to generate a profile that is sufficiently rich to establish the link to classical lipases. analyzing distant evolutionary relationships of very large protein families requires automatic methods for collection of homologous families if one does not wish to transform each new problem case into an art for ingeniously finding the critical links. the familysearcher within the annie environment is the solution for this problem. since automatic family collection is not corrected on the fly by the watchful eye of an experienced human sequence analyzer, special precautions with regard to removing compositional and repetitive pattern bias, to reciprocal searches and to checking whether hits fall into the same region of starting sequences are necessary to prevent the procedure walking astray. our experience has shown that the application of the search constraints described in the methods section has always led to convergence except for the case of known very large groups such as the pancreatic lipase/atgl/patatin group described in this article .

in this work, we have identified an ancestral core module consisting of 50– <dig> residues with a three-strand parallel β-sheet, an α-helix and a turn involving the catalytic serine as substructure with likely common evolutionary origin within the joint classical-lipase/atgl/patatin cluster. the mere similarity of relative spatial location of some secondary structural elements close to the catalytic serine did not escape the attention of rydel et al.  <cit> , who compared the structures 3tgl  and 1oxw  visually and aligned  <dig> backbone cα-atoms. we find that the similarity between the various proteins is limited to the ancestral module  but remnant sequence similarity is still detectable with significance. reduction of overall sequence and structure similarity to a small core module has already been described for other protein families. for example, the tudor domain "royal family" contains a β-β-β-α- <dig> core with suggested methyl substrate binding function as a common feature of the superfamily  <cit> . atgl and classic lipases have fundamental differences with respect to the catalytic mechanism as well as overall fold but both catalyze triglyceride hydrolysis. this suggests that they might have acquired the same function from different predecessor enzymes that are, in turn, derived from the common ancestral module.

if the enzymatic core module is really ancestral, there should be a correspondence with closed loop prototypes that have been described by berezovsky et al.  <cit> . indeed, prototype p <dig> and the related prototype p <dig> have structural  and sequence similarity  to the ~ <dig> residue region  that also encompasses the nucleophilic elbow in the ancestral module . in prokaryotes, the p1-containing region corresponds to the p-loop or atp/gtp-binding motif with the consensus -x-g-k-. this tiny-residue motif is similar to the gxsxg stretch followed by further small residues between β- <dig> and α+ <dig> in the collected family . the relationship of flanking beta-strands  with currently described prototypes is unclear. it is possible that they are parts of alternative closed loop structures that might be different between the patatin-like proteins and classic lipases and, thus, exemplifies emergence of/divergence to distinct functions from the common structural ancestor via sequence modification.

apparently, this β-β-α-β core module was present as an ancestral enzyme that provided basic capabilities for nucleophilic attack mechanisms. in fact, this single mechanism has been evolutionarily extremely successful for many substrates and reaction variants, since the classical-lipase/atgl/patatin cluster contains numerous enzymes that are neither lipases nor esterases, such as polyketide synthases, dienelactone hydrolases or aminopeptidases .

a striking feature of this mechanism is the discrepancy between high sequence variability and very constrained spatial restrictions for the catalytic center. for proteins that use catalytic triads, the regions that encompass the typical catalytic aspartate and histidine residues are not conserved at all. not only can the 2d structures of these protein stretches be completely different, but also the sequence positions of these residues relative to the nucleophilic residue  vary considerably. for example, while the catalytic asp of pancreatic lipase  was shown to reside directly at the c-terminal end of the β+ <dig> strand, it is located in long loop region more than  <dig> residues downstream of the active-site serine in the c. antarctica lipase  nonetheless, the distances of the catalytic residues in the 3d structures of the obtained sequences are relatively constant , most probably a result of the fact that the enzymatic mechanism crucially depends on a correct spatial arrangement of the catalytic residues.

if proteins carrying these modules indeed shared a common origin, then the sequence variability in the additional regions  would appear to have enabled the emergence of at least two different enzymatic mechanisms: one relies on a catalytic triad and the other one on a dyad. but which mechanism is the ancestral one? did the histidine get deleted from the triad, resulting in a protein family that uses ser-asp dyads, or was it inserted into an ancestral dyad, leading to the archetypical ser-his-asp triad? assuming an evolution from more simple to more complex mechanisms, the his-insertion version appears more reasonable. the emergence of a catalytically active fold should be more probable if the number of residues that need to be brought into vicinity is limited to two, not three. considering the evolutionary flexibility regarding the relative positions of the catalytic amino acids in the protein sequences, a third residue may then easily have been inserted during the sequence evolution history. moreover, not only the regions around the asp or asp/his catalytic residues are highly diverse. various additional modules have been inserted into the sequence, apparently, depending on the physiological environment, substrate specificity or regulation requirements. the ancestral fold template for breaking bonds using nucleophilic attacks seems to have been so "popular" in evolution that it became the origin for an extremely diverse and ubiquitous superfamily of proteins.

