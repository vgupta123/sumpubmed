BACKGROUND
adaptation of populations to their local environments plays a fundamental role in the maintenance of genetic diversity  <cit>  and is a common ecological pattern in plants  <cit> . reciprocal transplant experiments wherein genotypes are planted across environmental gradients remain a primary tool with which to assess local adaptation . studies investigating the genetic basis of local adaptation have been revolutionized by using high-throughput sequencing to pinpoint alleles that assort across ecological gradients against a genomic background mixed by migration . this ‘reverse ecology’ approach utilizes genomic variation to nominate traits important to adaptation, in contrast to the forward genetic approach where traits of interest are genetically dissected  <cit> .

there are multiple metrics that are widely used to detect local adaptation in performance data from reciprocal transplant experiments. the "local versus foreign" comparison requires that genotypes from a given habitat type outperform genotypes from a different habitat type in their source habitat, but are outperformed in the alternative habitat. the "home versus away" comparison requires that genotypes perform better in their source habitat type than they do in the alternative habitat type. the local versus foreign metric has been preferred over the home versus away metric because in order for subpopulations  to resist invasion by foreign genotypes they must outperform these non-adapted genotypes  <cit> . in addition, the home versus away metric can be obscured by differences in habitat quality–if one habitat type is intrinsically more favorable than the other then all genotypes might perform better there, even if there is local adaptation by the local versus foreign metric. recently, motivated largely by studies of host-parasite local adaptation, a distinct "sympatric versus allopatric" metric has been investigated from a theoretical perspective  <cit> . this metric recognizes that in addition to habitat quality, the signature of local adaptation can also be obscured by deme genetic quality. thus, if some demes contain more deleterious alleles than others, they might be outperformed in both habitat types even if they in fact contain locally adapted alleles. the sympatric versus allopatric contrast considers the meta-population level fit between demes and their habitats, and as a consequence it has greater statistical power than the previous two metrics  <cit> . importantly, simulations show that locally adaptated alleles can give rise to patterns of performance variation that do not match the local versus foreign metric.

local adaptation of wild populations has applied importance, since crops tolerant to increasing drought and salinity are needed to sustain agricultural production under future climates  <cit> . warming will cause large parts of the world to become drier, which will interact with irrigation to increase soil salinity, and rising sea-levels can infiltrate agricultural land  <cit> . currently, approximately 11% of irrigated agricultural land is salinized and soil salinization is a growing problem worldwide, particularly in the united states, china, india, and pakistan  <cit> . the strong selective regime imposed by saline habitats is evidenced by specialized halophytic plant species and ecotypes  <cit> ; such natural populations are an important reservoir of adaptive variation that could be useful in breeding future crops. the legume genus medicago contains  <dig> species whose native distributions surround the mediterranean basin  <cit> . m. sativa is an important perennial crop and the annuals m. polymorpha and m. truncatula are cultivated in australia. m. truncatula has been widely adopted as a model species for legume genetics  <cit> . m. truncatula is diploid and self-compatible, with an estimated selfing rate of ~95%  <cit> . in addition to genome sequences for both m. truncatula  and congeners  <cit> , there is whole-genome resequencing data of a range-wide 'hapmap' collection . m. truncatula populations have been collected across ecological gradients in tunisia  <cit> ; these tunisian populations occur on and off naturally saline soils and exhibit genetic variation in salinity responses  <cit> . previous work using microarray-based genotyping of twelve tunisian accessions detected a small number of candidate loci that assorted with saline soils  <cit> .

in this study we combine a series of empirical tests of local adpatation to saline soils with whole-genome polymorphism scans in natural tunisian populations of m. truncatula. we measure performance in field gardens, on field soils, and across salt treatments to measure patterns of adaptation and local adaptation and assess traits under selection. we use genomic data to document patterns of migration and recombination. we identify soil-assorting loci that are candidates for adaptation to salinity and compare them to range-wide allele frequencies and to the sister species m. littoralis. finally, we corroborate candidate genes for salinity adaptation using annotated gene functions.

RESULTS
soil salinity in the field has strong negative impacts on plant performance
we assessed the potential for natural selection in saline and non-saline habitats by planting  <dig> genotypes from replicate saline and non-saline origin sites  into replicate saline and non-saline tunisian field plots . saline gardens were significantly more saline overall :  <dig> μs/m and  <dig> μs/m; saline mean ec  <dig>  μs/m and  <dig>  μs/m; f =  <dig> , p <  <dig> ; figure  <dig>  table 1). ec at saline sites rose during the growing season but remained steady at non-saline sites  =  <dig> , p =  <dig> ; saline sites: time f =  <dig> , p =  <dig> ; non-saline sites: time f =  <dig> , p =  <dig> ; figure 2). in saline gardens, germination was significantly lower than in non-saline gardens  =  <dig> . <dig>  p <  <dig> ; additional files  <dig> and 3); furthermore, within saline gardens the ec of microsites where seedlings failed to emerge was higher than in successful microsites  =  <dig> , p =  <dig> ). seedlings that emerged in saline gardens had a 74% lower survival to reproduction than in non-saline gardens  =  <dig> , p <  <dig> , additional file 2). thus, natural saline soils pose strong selective challenges in the field to m. truncatula through both germination and survival.figure  <dig> 
tunisian
m. truncatula
from saline and non-saline sites.  tunisian collection sites.  neighbor-joining phylogeny of all snps. red dots indicate nodes with bootstrap support greater than 80%. nodes subtending splits between populations tn <dig>  tn <dig>  and tn <dig> are indicated with arrows and do not have bootstrap support.  migrate-n analysis of the four populations; numbers above the arrow are m estimates going left-to-right and numbers below are the reverse. results are averaged across ten replicate sets of  <dig> loci.
saline populations are locally adapted to salinity and flower earlier.  soil ec increased in saline field subsites  but not in non-saline subsites . note that only s <dig> is an original collection site.  a natural m. truncatula germinant emerging from its pod at the beginning of the field experiment .  phenotypic means and standard errors of saline origin  and non-saline origin  genotypes. plants were grown in saline and non-saline field gardens , field-collected soils in the greenhouse , and 0mm and  <dig> mm nacl on a common substrate . a saline origin by salinity treatment interaction is significant in panels c, d and e.


soil characteristics



field experiment gardens

reciprocal soil experiment
soil analysis of tunisian field gardens where field experiment was performed and of field collected soils used in the reciprocal soil transplant experiment. sar: sodium absorption ratio, esp: exchangeable sodium percentage.

m. truncatulapopulations are locally adapted to saline soils at the meta-population level
to measure patterns of adaptation to soil salinity, we conducted a series of field and greenhouse experiments using pod number and aboveground biomass as fitness proxies. m. truncatula fruits are barbed pods containing 4– <dig> seeds and pod number is a relevant fitness metric since pods do not open to disperse seeds. a greenhouse-based pod germination experiment shows that a single seed germinates per pod  and we observed such germinants alongside our field experiment . it was not possible to grow plants through reproduction in the field, due to concerns regarding genetic contamination of the sites, or in the reciprocal field soil experiment due to space constraints in the tunisian greenhouse. however, we have two sources of data that enable us to draw conclusions about fitness from biomass data. in greenhouse trials aboveground biomass was significantly correlated with pod production ; furthermore, we found correlations between biomass and pod production for field plants that grew contemporaneously with our experimental plants . thus, although imperfect, aboveground biomass is a reasonable fitness proxy for m. truncatula at both saline and non-saline field sites and under greenhouse conditions for the range of genotypes included in our experiments.

our field experiment was designed to assess adaptation to salinity in the presence of natural variation in soils, climate, and biotic interactions. we observed heavy aboveground herbivory in both saline and non-saline gardens  <cit> . low germination  and survival  in saline gardens gave poor power to detect whether genotype soil origin affects biomass in saline field gardens  =  <dig> , p =  <dig> ). however, in non-saline gardens the saline origin genotypes had  <dig>  times lower performance than non-saline origin genotypes  =  <dig> , p <  <dig> ; figure  <dig>  additional files  <dig> and 3). lower performance by saline genotypes in non-saline conditions could be due to more deleterious alleles at high frequency in saline populations and/or to the presence of locally adapted alleles that improve fitness in saline habitats but decrease fitness in non-saline habitats.

definitive evidence of local adaptation to saline soils, defined by the presence of locally adapted alleles segregating across the meta-population, comes from a parallel greenhouse experiment in which seedlings were reciprocally transplanted into raw field-collected soil from the four original collection sites. plants had lower survival on saline field soils  =  <dig> , p <  <dig> ; additional files  <dig> and 5), with the lowest survival in the most saline soil  =  <dig> , p <  <dig> ). as in the field experiment, we assessed performance by aboveground biomass at flowering. saline-origin genotypes were significantly outperformed by non-saline genotypes on non-saline field soils and tended to outperform non-saline-origin genotypes on saline field soils, with a significant interaction term  =  <dig> , p <  <dig> ; figure  <dig>  additional files  <dig> and 5).

while this pattern does not satisfy the strict local versus foreign definition of local adaptation  <cit> , the interaction term between the origin soil type and the destination soil type does indicate that there are segregating alleles that cause saline-origin genotypes to respond differently to saline field soils. we calculated the sympatric versus allopatric contrast following  <cit>  and found it to be both large and statistically significant, despite our study only containing four populations  =  <dig> , p =  <dig> ). furthermore, we did not detect significant home-soil advantage when considering the performance of genotypes in the field soil from the site at which they were collected  =  <dig> , p =  <dig> , additional file 5); thus, local adaptation appears to be to some shared attribute of saline soil between these populations. to separate the effect of salt from other differences between saline and non-saline soils, we conducted a second greenhouse experiment on a common substrate with added nacl. salt treatment caused plants to have 30% lower aboveground biomass and produce 54% fewer pods . saline genotypes were smaller than non-saline genotypes under all conditions but showed a smaller decline in biomass between treatments with a significant interaction term  =  <dig> , p =  <dig> ; figure  <dig>  additional file 6). furthermore, saline-origin plants tended to have more pods under saline conditions while non-saline plants tended to have more pods under non-saline conditions, with a significant interaction term  =  <dig> , p =  <dig> ; figure  <dig>  additional file 6). since the sympatric-allopatric contrast requires a reciprocal experimental design at the level of the population to calculate the correct f-ratio test  <cit> , we are not able to apply this metric to these data. however, although neither the biomass nor reproduction data satisfy the local versus foreign metric of local adaptation, the significant interaction terms between soil type origin and salt treatment reflects genetic differences between saline populations and non-saline populations in how they respond to salt. we thus infer that saline origin populations contain alleles that mitigate the decline of performance under saline soils, or conversely that non-saline origin populations contain alleles that increase their sensitivity to salinity. we note that non-saline genotypes had higher biomass than saline genotypes under well-fertilized salt treatment in the greenhouse, possibly reflecting pre-adaptations to these high nutrient conditions. however, even in this artificial setting there was a significant interaction between saline origin and salinity for pod production , which we argue indicates the presence of alleles involved in local adaptation to soil salinity.

selection analysis and trait differentiation
to gain insight into the underlying causes of salinity adaptation, we used selection analysis to identify traits correlated with differences in reproduction. we detect natural selection on a suite of phenological and morphological traits in the greenhouse—in non-saline environments, traits associated with faster vegetative growth rates are favored by selection, while in saline environments traits associated with salinity tolerance  and earlier germination and flowering are favored . consistent with a response to selection for earlier flowering, saline origin genotypes flower earlier under greenhouse, field soil, and non-saline field conditions . we note that both of our greenhouse experiments also show genetic variation for flowering time and aboveground biomass but that there were no genotype by treatment interactions after accounting for terms involving soil origin .table  <dig> 
selection on plant traits under saline and nonsaline treatments


 <dig> **
- <dig> *
- <dig> *
 <dig> **
- <dig> 
- <dig> ***
- <dig> ***
- <dig> **
- <dig> **
 <dig> **
 <dig> ***
 <dig> **
 <dig> t
 <dig> ***
 <dig> ***
- <dig> **
- <dig> *
 <dig> t
 <dig> ***
 <dig> ***
 <dig> ***
 <dig> ***
 <dig> 
 <dig> ***
 <dig> ***
 <dig> ***
 <dig> 
 <dig> *
 <dig> ***
 <dig> ***
 <dig> ***
 <dig> ***
 <dig> ***
 <dig> **
- <dig> **
 <dig> *
 <dig> *
 <dig> *
 <dig> **
 <dig> **
- <dig> 
selection differentials  and gradients  in non-saline and saline treatments, using the fitness metric relative total pod number. sla: specific leaf area, lwc: leaf water content, rwc: root water content, swc: stem water content. t x e: test for change in selection between saline and non-saline treatments. significance is denoted by t:  <dig>  > p >  <dig> , *p <  <dig> , **p <  <dig> , ***p <  <dig> , ****p <  <dig> . bold values indicate significance  with transformed relative total pod number.



populations are not structured by soil type
gene flow could occur among these populations via dispersal movement of spiny pods by livestock transported by truck to pastures across this small country. whole-genome resequencing of these  <dig> m. truncatula genotypes shows that ld decays to r2 <  <dig>  within 10kb on average, with a high degree of variability around this estimate . population subdivision measured by fst averages  <dig>  genome-wide, but hierarchical analysis shows that this structure occurs largely between populations within soil rather than between saline and non-saline soil types . pairwise fst values are lowest between the two non-saline populations, but the saline populations are as strongly differentiated from one another as they are from non-saline population ns1; the saline populations are equally differentiated from ns <dig> . analysis of snps using structure  <cit>  suggests a history of admixture between two ancestral clusters, but these clusters do not track soil habitat . despite population structure, divergence among individuals within a population is greater than divergence between populations . finally, coalescent models implemented in migrate-n  <cit>  demonstrate substantial levels of ongoing migration between all four populations with high estimates in all directions and overlapping confidence intervals for estimates of theta . as there is no evidence of divergence by soil type —replicate saline populations are not more similar to one another at the whole genome level than they are to non-saline populations—these populations enable us to detect islands of genomic differentiation that are candidates for local adaptation to saline soil.table  <dig> 
pairwise fst values between the four populations in this study


means of  <dig> bootstrap replicates of  <dig>  snps each, 95% intervals below the diagonal. saline: s <dig>  s2; non-saline: ns <dig>  ns <dig> 



genomic differentiation in relation to salinity in m. truncatula
candidate genomic regions for salinity adaptation
our resequencing data identifies loci that may contribute to performance differences among saline and non-saline origin genotypes. coinciding with meta-population level local adaptation to saline soil, we document soil-type assortment of a small number of genomic regions. of  <dig>  non-singleton snps,  <dig> are significantly associated with soil type after bonferroni correction . these alleles show nearly perfect assortment with soil type; linkage disequilibrium  circumscribes  <dig> genomic regions that contain  <dig> genes . we identify  <dig> of these as candidate genes with non-synonymous snps that assort with soil type; not all of these snps were detected in the original scan because of missing data .figure  <dig> 
genomic regions assorting with saline soil type.  soil type assortment p-values plotted across the mt <dig> . <dig> genome. black dashed line: bonferroni threshold; triangle: ld block  <dig>  that contains medtr4g <dig> . 
atconstans ortholog medtr4g <dig>  showing relationships between tunisian haplotypes and the gene model. gray lines connect alleles in the haplotype diagram with their position in the gene model below. haplotypes—red: saline allele, blue: non-saline allele, green: heterozygous , empty: no call. snp bar heights show allele frequency difference between saline and non-saline populations—pink: nonsynonymous, cyan: synonymous, dark blue: utr.


soil-assorting ld blocks


ld blocks defined by snps that have pairwise correlation >  <dig>  and are surrounding the soil-assorting snps .
candidate genes in the soil-assorting genomic regions


†
genes with non-synonymous mutations in conserved amino acids that assort with soil type. not included are  <dig> unknown proteins and  <dig> hypothetical proteins. expanded information in additional files  <dig>   <dig>   <dig>   <dig> and  <dig>  †biological process, biochemical function, protein annotation.

we found soil-assorting non-synonymous snps in multiple genes annotated with functions that are consistent with adaptation to salinity. in particular, we identify medtr4g <dig> , a trehalose-6-phosphate phosphatase gene that may be involved in osmotic protection, along with several candidate genes closely related to known regulators of the abscisic acid  and jasmonic acid  pathways. medtr3g <dig>  encodes a calcium-dependent protein kinase  co-orthologous to three arabidopsis cpks  that all regulate aba signaling . ld block  <dig>  contains three paralogs encoding jasmonate methyl esterases that convert methyl jasmonate  into biologically active ja; two contain soil-assorting non-synonymous snps. medtr4g <dig>  encodes a cbl interacting protein kinase  that is orthologous to atcipk <dig> . m. truncatula contains  <dig> cipks compared to  <dig> in a. thaliana.

we further identify candidates with roles in phenology regulation and biotic interactions. saline alleles of medtr4g <dig> —the ortholog of constans, a central flowering time regulator in a. thaliana—differ from non-saline alleles by a non-synonymous snp  immediately adjacent to the highly conserved b-box zinc coordination site . in addition, ld block  <dig>  contains four paralogs of flowering locus t . a nb-lrr gene  contains  <dig> soil-assorting non-synonymous changes. finally, medtr7g <dig>  is an apyrase-like protein and is in linkage with two genes  involved in flavonoid synthesis.

the set of snps with false-discovery rate  below 1% contains  <dig> snps that intersect  <dig> unique genes . among these genes is the only sodium:potassium:chloride symporter annotated in the m. truncatula genome . although there was not significant go enrichment for any of our candidate sets, single genes of large effect could be present in our candidate list without causing go enrichment.

saline alleles are typically rare across the range and derived relative to an outgroup
locally adapted alleles that enhance fitness in saline habitats but are deleterious on normal soils are predicted to be rare within the range-wide sample of m. truncatula. furthermore, recent adaptation via these alleles would result in them being derived in comparison to the sister species m. littoralis. to test these predictions, which focus on the alleles themselves rather than the populations, we used data from the medicago hapmap project. for each site considered in the soil-assorting test, we calculated the allele frequency across  <dig> non-tunisian genotypes of m. truncatula. all else being equal, the saline-assorting allele has a 50% chance of being the rare allele in the range-wide sample. however, our bonferroni-significant saline-assorting alleles were more often the rare allele than expected by chance .we additionally ask whether saline alleles tend to be derived relative to an outgroup, the sister species m. littoralis. under neutral evolution we expect a constant rate of fixation of new mutations in a lineage, whereas selection should increase the fixation probability of derived mutations. the m. truncatula reference and the m. littoralis consensus differed at  <dig>  of the  <dig>  sites considered in the soil-assorting test, and shared the same allele at  <dig>  sites. the saline majority alleles were significantly more often diverged than the reference from the m. littoralis consensus . thus, the saline populations’ divergence was used as the background rate to test whether the bonferroni-significant soil-assorting snps were more diverged from m. littoralis than expected by chance. of the  <dig> soil-assorting snps,  <dig> differ from the m. truncatula reference and the m. littoralis consensus. of these, at  <dig> sites the m. truncatula reference and the m. littoralis consensus also differ. saline alleles are more often divergent from both the m. truncatula reference and the m. littoralis consensus than expected by chance . thus, saline-assorting alleles are typically rare within m. truncatula and derived relative to the sister species m. littoralis. combined, these results further suggest that natural selection in saline habitats has played a role in shaping soil-assorting genomic regions, although differences in demography are a possible alternative hypothesis.

discussion
understanding the maintenance of genetic diversity requires identification of situations in which such genetic variation is adaptive; this problem can be approached from both ecological and genomic perspectives  <cit> . local adaptation, as determined by reciprocal transplant experiments, has been found in 71% of published studies  <cit> . in a growing number of instances, local adaptation has been dissected at the genomic level  <cit> . in the current study, we integrate manipulative experiments with genomic analyses of saline and nonsaline genotypes from replicate wild tunisian populations of m. truncatula to identify candidate traits and genomic regions associated with local adaptation to soil salinity.

ecological signal of local adaptation to saline soils in m. truncatula
combining field and greenhouse experiments, we show that salinity imposes high mortality on m. truncatula in the field and that there is a strong signal of local adaptation to salinity at the meta-population level using a reciprocal transplant on field-collected soils. furthermore, a follow-up experiment manipulating sodium chloride concentrations demonstrates that saline populations are adapted to salt, with non-saline origin genotypes showing greater sensitivity to salinity for both growth and reproduction relative to saline origin genotypes. while none of these experiments are a full reciprocal transplant under field conditions, they nonetheless provide compelling evidence for local adaptation to saline soils and to salinity per se.

there is currently debate in the literature regarding how best to identify local adaptation in empirical settings. the strictest definition of local adaptation  <cit>  would require that saline genotypes significantly outperform non-saline genotypes in saline conditions in addition to nonsaline genotypes significantly outperforming saline genotypes in nonsaline conditions . rather, the pattern of fitness variation across saline and non-saline environments that we observe supports that these populations are locally adapted by an evolutionary definition  that considers the meta-population as a whole  <cit> . defining local adaptation at the level of a single populations or environments is confounded by habitat quality and/or deme genetic quality, both of which are likely to vary in our study system. the meta-population approach that we take fits models of performance variation that include terms for population, habitat, and soil origin by destination or salt treatment interaction term. an interaction between soil type origin and destination treatment for performance in our experiments reflects a heritable difference between saline and non-saline genotypes in how they respond to saline soils and salt treatments. this interaction is conceptually similar to the 'sympatric versus allopatric contrast' advocated in recent work  <cit>  and we find the sympatric-allopatric contrast metric to be high and significant in our reciprocal soil experiment. altogether, we conclude that these populations are locally adapted to salinity at the meta-population level and contain alleles with habitat-specific fitness effects.

under greenhouse conditions, we found the somewhat puzzling result that non-saline genotypes produced greater aboveground biomass than saline genotypes under salt treatment. several factors may explain this result. first, aboveground growth may not correspond directly with fitness  and thus might not reflect adaptedness of populations but rather, different allocation patterns. indeed, while our experiments show that biomass is a reasonable fitness proxy, the r <dig> under greenhouse conditions is only  <dig> . second, if non-saline genotypes have higher fitness due to greater genetic quality of these demes, rather than possession of saline-adapted alleles, migrants from non-saline populations could invade saline populations. however, recombination would move locally-adapted saline alleles into the superior genetic background of non-saline genotypes to create even fitter genotypes. thus, as long as recombination occurs sufficiently often relative to migration of non-adapted alleles in high quality genetic backgrounds, locally adapted alleles could persist in these populations.

evidence for migration and recombination
in order to detect alleles that segregate with saline habitats, outcrossing and migration must occur at appreciable levels. since m. truncatula is highly selfing  <cit> , linkage disequilibrium is expected to be large. however, although we observe higher ld in our study populations  than range-wide estimates   <cit> , this still yields gene-scale resolution on average; these patterns closely match our previous microarray-based study  <cit> . coalescent-based analysis of migration using the snps in this study detected evidence of substantial migration between all pairs of populations, despite the moderate genome-wide levels of population structure as reflected by fst. importantly, hierarchical fst analysis found that most structuring occurs between populations rather than between soil types. we expect that migration occurs largely by migration of seed pods on the fur of grazing animals such as sheep, which have been moved widely around tunisia since historic times.

reverse ecology gives insight into the mechanisms of salinity tolerance
genomic analysis identifies a small number of candidate genomic regions for the adaptation to saline soils that we observe at the phenotypic level. comparison with a range-wide sample shows that saline alleles are typically rare within m. trunctula and comparison with the sister species m. littoralis shows that saline alleles are typically evolutionarily derived. both of these patterns could be explained by either stronger genetic drift in saline populations or selection acting on these alleles in a habitat-specific manner. while our coalescent-based analysis does not support differences in effective population size between saline and non-saline habitats, additional data tracking the census size or estimating ne, as has been done previously in other m. truncatula populations  <cit> , via time-series analyses would provide power to more rigorously test this alternative hypothesis. consideration of the functional annotation of soil-assorting genomic regions points towards plausible candidates for locally adapted alleles and nominates multiple pathways and potential selective agents underlying salinity adaptation in m. truncatula. in particular, we find soil-assorting candidate genes that are potentially involved in abiotic stress tolerance, stress avoidance through shifts in flowering time, and biotic interactions.

candidates for abiotic stress tolerance
we identify several candidates for adaptation that likely play direct roles in enabling plants to tolerate the abiotic stresses of salinity, which include ion toxicity as well as osmotic stress  <cit> . hormone signaling, especially aba, often mediates acclimation to abiotic stress  <cit>  and multiple candidate genes are closely related to known aba pathway regulators. first, medtr3g <dig>  codes for a cpk whose three homologs in a. thaliana are all involved in aba signalling. atcpk <dig> negatively regulates aba signaling during seed germination and post germination growth  <cit> , while atcpk <dig> and atcpk <dig> are induced by drought and salinity stress and positively regulate aba-responses and stress tolerance. in addition to impaired aba signaling, atcpk <dig> and atcpk <dig> mutants are pleiotropic for seedling insensitivity to salt stress and they are impaired in aba-induced stomatal movement—a process strongly controlled in response to stress. a related experiment found that seedlings of saline origin genotypes from these populations are more sensitive to aba than non-saline genotypes  <cit> .

second, the plant hormone meja controls stomatal closure and three paralogs encoding the final enzymatic step in this pathway assort with saline soils. the ja pathway is also involved in interactions with herbivores  <cit> . third, medtr4g <dig>  is orthologous to atcipk <dig>  which is not currently characterized. however, cipk proteins are known for their roles in integrating environmental cues, especially abiotic stress  <cit> , with roles in salinity tolerance via na + homeostasis, k+ uptake and guard cell function during dehydration, and regulation of aba signaling; a novel cipk protein hbcipk <dig> in the halophyte hordeum brevisubulatum was recently shown to complement salt sensitivity in a. thaliana
 <cit> . together, these facts nominate medtr4g <dig>   as a strong novel candidate for salt tolerance.

finally, metabolic tolerance to osmotic stress can be achieved by producing small metabolites  <cit> . our candidate gene medtr4g <dig>  encodes trehalose-6-pentose phosphotase , which converts trehalose-6-phosphate to trehalose. overexpression of tpp in rice enhances tolerance to both salinity and cold stress  <cit>  and in m. truncatula the accumulation of trehalose in nodules enhances salinity stress  <cit> . we did not find candidates with clear annotations for salt exclusion, unlike in a. thaliana where the sodium transporter hkt1; <dig> controls sodium accumulation in cells and variant alleles of this gene both assort with saline soils and confer increased fitness under salt treatment  <cit> .

early flowering as an avoidance strategy in saline populations
our study documents both ecological and genomic lines of evidence for the importance of salt stress avoidance through early flowering. a consistently differentiated trait between these populations is flowering time—saline origin genotypes flower earlier in non-saline field conditions, on all field-collected soils, and under both saline and non-saline treatments. using a greenhouse selection analysis, we detect direct selection for earlier flowering under saline treatment despite an overall selection differential that favors later flowering in both saline and non-saline conditions. flowering time has been found to play a key role in local adaptation in multiple annual plants  <cit>  and emerges as a candidate mechanism of adaptation from our genomic analyses as well.

we find two separate candidate intervals that likely play important roles in regulating flowering time. one intriguing candidate gene in our study is medtr4g <dig> , the m. truncatula ortholog of a. thaliana constans , which contains a saline-assorting nonsynonymous snp that changes a highly conserved amino acid. this gene encodes a zinc-finger transcription activator that controls the expression of floral-inductive genes, including the transcription factor flowering locus t , in a light-dependent manner  <cit> . a separate candidate genomic region on chromosome  <dig> contains four paralogs of ft, including both fta <dig>  fta <dig> , and ftc but not ftb <dig> or ftb <dig> . previous work in mapping populations of m. truncatula identified a major qtl on chromosome  <dig> that co-localizes with our region  <dig>  and contains all of the ft genes in our candidate interval  in addition to a homolog of constans   <cit> . complementation tests of the late-flowering ft- <dig> a. thaliana mutant determined that mtfta <dig> and mtftc are both functional copies of ft that regulate flowering time  <cit> . additional work studying a tnt <dig> insertion mutant with earlier flowering connected this phenotype to medtr7g <dig>  and concluded that the proposed mtco  was not orthologous to atco
 <cit> ; our reciprocal blast identifies medtr4g <dig>  as the true ortholog to atco. finally, transcription of fta <dig> in m. truncatula has been shown to accumulate in leaves during development and respond to vernalization and day-length in tandem with flowering time, while overexpression promotes earlier flowering and tnt <dig> mutants of mtfta <dig> are late flowering  <cit> .

to our knowledge, allelic variation in constans or ft have not been previously linked to abiotic stress tolerance. the seasonal rise in salinity at our field sites may select for early flowering to avoid salt. we detect a significant selection gradient favoring earlier flowering in our greenhouse experiment, but only under salt treatment. coupling these results with our finding that saline genotypes flower much earlier than non-saline genotypes across a suite of conditions, we conclude that flowering time likely plays a major role in adaptation to saline soils. in a. thaliana, the genomic basis of flowering time and its adaptive value have been documented in detail through of decades of forward genetics, genome-wide association studies, and ecological analyses  <cit> . avoidance of stress is a common strategy in annuals  <cit>  and early flowering is a common breeding target.

candidates linked to biotic interactions
adaptation to contrasting environments may occur in response to multiple selective agents simultaneously, including antagonists and mutualists. furthermore, biotic interactions may exert natural selection in a manner that depends upon the abiotic context, for example, saline soils can modulate disease pressure in tomato  <cit> . at the molecular level, biotic and abiotic stress factors often interact, with ja and aba playing additional roles as biotic stress signals  <cit> . in our field experiment, we observed heavy herbivory in both saline and non-saline gardens  <cit> , particularly by hypera weevils in non-saline sites; thus biotic interactions could be additional sources of selection that differ across habitats.

the nb-lrr gene medtr6g <dig>  falls on chr <dig> and contains  <dig> soil-assorting nonsynonymous changes. nb-lrr genes regulate disease resistance  <cit>  and most of these snps affect the leucine-rich repeat domain that confers pathogen specificity and is under positive selection in other nb-lrr proteins  <cit> . in addition, the candidate genes medtr7g <dig>  and medtr7g <dig>  are homologous to the a. thaliana t8f <dig>  protein, which is predicted to act in the flavonoid pathway to produce phytoalexins. finally, the apyrase candidate gene  is strongly expressed during early nodule development  <cit>  and in roots under salt stress  <cit> . thus, while it may play a role in symbiotic nitrogen-fixation it may also respond to stress directly. recent work using the range-wide collection of m. truncatula identified three candidate loci associated with climatic variables which have annotated roles in biotic stress, including one also found in a range-wide a. thaliana study  <cit> . however, we do not detect differentiation at these previously identified loci in the present, locally focused study.

limitations of the current study
the nb-lrr gene medtr6g <dig>  that is differentiated between saline and non-saline populations represents the sole candidate gene in common with our previous study  <cit> . given that the vast majority  of genotypes in the current study differ, with only three out of four populations in common, it is not surprising that we obtained largely different soil-assorting regions. larger population sizes and additional geographically disjunct saline populations are needed to assess the repeatability of the candidates identified here.

additional work explicitly manipulating rhizobial symbionts and antagonists, including herbivores and pathogens, will be required to determine whether these partners play a role in adaptation to salinity in m. trunactula. furthermore, the field and greenhouse experiments reported here were done without manipulating competitive environment or maternal environment. a related experiment with a subset of the same m. truncatula genotypes found that phenotypic responses to salinity depend upon both the presence of a conspecific competitor and upon whether the maternal environment was saline or non-saline  <cit> .

as the candidate genes and pathways discussed above remain to be validated with functional genomic tools, there are several non-adaptive alternative hypotheses for the differentiation that we observe. first and foremost, local adaptation may be caused by fixation of habitat-specific deleterious alleles through drift  <cit> . differentiated loci may also occur through gene surfing during population expansion or through segregating incompatibilities  <cit> . the parallel genomic patterns in our two saline populations argue against such processes, but this inference would be greatly strengthened by the inclusion of additional saline and non-saline populations. a quantitative genetic approach involving between-population crosses would further strengthen the connection between genomic variation and adaptive phenotypic variation.

while we have focused on mutations that alter the amino acid sequence of proteins, we note that expression variation could play an equally important role in adaptive evolution  <cit> . annotating regulatory regions within the m. truncatula genome will elucidate the potential role of non-coding sequence polymorphism. future experiments assaying gene expression would yield further insight into the molecular pathways underlying adaptation to saline soils.

CONCLUSIONS
integrating genome scans with ecological experiments and selection analysis in the model legume medicago truncatula identifies mechanisms by which legumes may have adapted to saline soils. importantly, while the reverse ecology approach that we take does not enable us to connect genomic candidates to salinity adaptation directly, these candidate genes elucidate potential routes to adaptation in natural contexts where soil salinity may be consistently associated with variation in other abiotic and biotic factors. the diversity of implicated processes underscores that complex field environments can impose selection on multiple correlated traits.

elucidating the genetic basis of adaptation to saline soils provides insights for breeding improved abiotic stress tolerance in crops and informs efforts to protect species from consequences of climate change such as sea level rise and coastal salinization. in total, our results point to the importance of both salt tolerance and salt avoidance. we have uncovered several promising targets with roles in abiotic stress tolerance and early flowering time, which require further validation but could ultimately be used in breeding salt tolerance in crop legumes to ensure food security in an era of global change.

