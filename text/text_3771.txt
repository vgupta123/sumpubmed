BACKGROUND
microarray researchers need easy-to-use tools to identify differences in the coexpression and coregulation of genes between phenotypes that cannot be identified with traditional tools. often researchers compute student's t-tests, analysis of variance , significance analysis of microarrays  <cit>  or empirical bayes analysis  <cit>  for each gene on their microarray to identify individual differentially expressed genes  among two or more phenotypes  <cit> . unfortunately, these approaches ignore coexpression because they cannot account for the complex multivariate relationships among genes. multivariate statistical methods like hierarchical clustering and principle components analysis  are often used for quality control and exploration of microarray data. however, these multivariate methods do not effectively model coexpression nor do they allow for hypothesis tests to compare phenotypes. gene-gene association networks built using aracne  <cit> , context likelihood relatedness   <cit> , maximum relevancy   <cit>  and other methods often provide helpful models of coexpression and coregulation, but the networks are based on data from a single phenotype and are not easily compared using statistical tests. new methods are needed to account for the complex relationships among genes while providing hypothesis tests to compare phenotypes.

several research groups have addressed the question of comparing the coexpression of specific gene-gene pairs or coexpression networks among two or more phenotypes. two early examples used search algorithms to identify optimally sized clusters of coexpressed genes and resampling tests to identify significant differences among the coexpressed clusters between phenotypes  <cit> . other published methods used variations on familiar statistical techniques like fisher's z tests or modified f-statistics to directly compare pairwise gene-gene correlations between two phenotypes  <cit> . some of these methods  <cit>  are readily available as source scripts of package libraries in r http://www.r-project.org. some interesting approaches apply the results from statistical tests that compare pairwise gene-gene associations between two phenotypes to the construction and interpretation of gene coexpression networks  <cit> . both of these methods allow researchers to explore the complex differences among gene expression networks using statistical tests, but unfortunately neither method has been implemented in a user-friendly tool.

dapfinder and dapview are plug-ins for brb-arraytools http://linus.nci.nih.gov/brb-arraytools.html, which will provide researchers with accessible tools to test differences in the coexpression between two phenotypes and explore those results on gene association networks. brb-arraytools is a comprehensive microarray analysis package that does not require specific skills in programming or direct script usage. it is available for free to non-commercial users and has more than  <dig>  users in  <dig> countries  <cit> . our dapfinder and dapview tools will identify and visualize individual significant differences in gene-gene association between the two classes, each of which we will call a differentially associated pair . output from these tools can be used to construct gene-gene association networks and identify the significant differences in coexpression between two groups. our hope is that these tools can be used to identify systems-level features in the gene-gene association networks like network growth or decay, network merging or splitting, and network birth or death, reflecting functional changes in biological pathways.

implementation
dapfinder
dapfinder is used to compute pair-wise gene-gene associations  for two groups of microarray experiments, then compare each specific gene-gene association between the two groups with a statistical test . gene-gene associations can be estimated using pearson correlation coefficients, spearman rank correlation coefficients, kendall rank correlation coefficients or mutual information. pearson correlations are the most familiar metric and the easiest to compute, but only the spearman, kendall and mutual information metrics are appropriate for nonlinear associations between genes. significant pearson correlations within each class are identified using a one-sample fisher's z-test. differences in gene-gene correlations  are automatically tested using fisher's z-test methods, while optional permutation tests are used to compare differences in gene-gene correlation or mutual information. p-values from the fisher's z-test methods are approximate p-values that assume large sample sizes; permutation tests make no assumption about sample size, but they require lengthy computation times. permutation test calculations can be hastened by choosing from one of four gene-gene pair subset selection methods . tests can be computed with equal numbers of permutations for each gene-gene pair or with an adaptive method that identifies the minimum number of permutations required for each gene-gene pair. fisher's z-tests of individual pearson correlations within each class or differences in correlation between the two classes can be corrected for multiple testing using false discovery rate  methods  <cit> , q-value methods  <cit>  or bonferroni family-wise error rate  methods using step-up adjusted p-values  <cit> . the same multiple testing adjustments can be applied to the optional permutation tests. researchers can pre-filter individual genes by the coefficient of variation  of their gene expression, by a minimum sample size criteria  or using the internal methods of brb-arraytools. researchers can also upload a specific list of gene-gene pairs for testing. outliers among the individual expression values from each gene can be removed using univariate standard deviation or interquartile range  criteria.

output from dapfinder includes a hyper-text markup language  report and comprehensive output stored as an excel spreadsheet or tab-delimited text file. the html report opens up automatically in a web browser to display the current user settings and diagnostics from the analyses. reported user settings include choices of pre-filtering methods, association metrics and statistical tests, plus the directory location of the results. diagnostics include the amount of missing data, the number of genes and gene-gene pairs used in the calculations and the computation time required. optionally, the  <dig> most significant results from the fisher's z-tests and permutation test can be added to the html report. the comprehensive output includes the unique ids and related annotations for both genes in each gene-gene pair, the individual gene-gene associations for each of the two groups with test statistics and p-values reported for the pearson correlations in each group, the fisher's z-test statistics and p-values for comparisons between the two groups and finally the differences in association and permutation p-values between the two groups . these results can be sorted and reorganized in excel to identify the most significant gene-gene associations in a single group, the most significant fisher's z-test results, etc. results from the comprehensive output file can be directly imported into visualization software packages like cytoscape  to create network graphs using the two columns of unique ids to define nodes and the columns of correlation coefficients or p-values to define edge weights. both the html report and the comprehensive output are automatically saved to the user's brb-arraytools project folder.

dapview
dapview graphs the expression values for two specific genes in a xy scatter plot with the differences in coexpression between two phenotypes displayed in different colors and symbols . typically, a statistically significant difference in gene-gene association would be discovered using dapfinder, then the relationship can be visualized with dapview. the two groups are graphed using different colors and symbols with a figure legend clearly identifying each group. researchers can choose to identify, eliminate or ignore the outlier expression values identified by the same univariate standard deviation or interquartile  range criteria from dapfinder. identified outliers are plotted in red, while eliminated outliers are completely removed from the graph and ignored outliers are plotted in the same colors as the legitimate data. scatter plot graphs are automatically opened in portable document file  format and saved into the user's brb-arraytools project folder.

RESULTS
evaluation of dapfinder with simulated microarray data
the efficacy of the dapfinder procedures was evaluated using simulated microarray data with known gene-gene correlations to ensure its statistical methods can detect known differences in gene-gene association with high levels of statistical power and low levels of false positives. see the supplementary materials  for details on the generation of simulated microarray data and other simulation methods. simulation results were used to create receiver-operator characteristic  curves that explore the relationships between statistical power, sample size and effect strength under several different simulation conditions. other simulations examined the relationship between approximate p-values from the fisher's z-tests and exact p-values from the permutation tests. simulations were conducted entirely in r using the same r source code used to build dapfinder.

examining changes in area under curve  for the roc quickly revealed many properties of the analyses in dapfinder. not surprisingly, results from the simulations show that sensitivity  and specificity  increase as sample sizes  or differences in correlation  increase  when all other experimental conditions are held constant . these results show the dapfinder performs well even for relatively small sample sizes and differences in correlation. increasing as the number of genes on each microarray chip did not affect sensitivity or specificity , supporting our decision to use simulations with a small number of genes per chip because they are more efficient . in the real world, increasing the number of genes per chip would decrease statistical power due to the more conservative fdr- and fwer adjustments for multiple testing and possible due to higher level interactions among large numbers of genes. however, these simulations computed roc curves using unadjusted p-values and fixed numbers of interacting genes. it may be surprising that sensitivity and specificity did not change as the expression variances of individual genes increased  with all other experimental conditions held constant. however, increasing the individual gene expression variance does not affect sensitivity and specificity, because the correlation of two genes is a property of the joint distribution that is not solely dependent on the magnitude of individual gene expression variances. perhaps the most important simulation result showed that sensitivity and specificity increased as correlation coefficients from the two groups changes from perfectly symmetric with ri - rj = + <dig>  -  =  <dig> to increasingly asymmetric coefficients like ri - rj = + <dig>  -  =  <dig> or ri - rj = + <dig>  -  =  <dig> with all other conditions held constant . asymmetric correlation coefficients have more statistical power because the nonlinear fisher's z-transformation used in the fisher's z-test inflates z-scores for strong correlations and deflates z-scores for moderate correlations , creating larger differences in z-scores and more significant fisher's z-tests.

additional simulations showed approximate p-values from the fisher's z-test of differences in pearson correlation are strongly correlated to the exact p-values from the permutation tests, and the correlation between the approximate and exact p-values increases with sample size . similar correlations between approximate p-values and exact p-values are seen for differences in spearman rank correlation and differences in kendall rank correlations . these show the robust results from computationally intensive permutation and resampling tests can be very closely approximated by much faster fisher's z-test and similar methods for spearman and kendall rank correlations with reasonable sample sizes. both options are included to provide researchers the option of faster computation when sample sizes are relatively large or more robust results when sample sizes are smaller.

discoveries from glioma data
to illustrate some possible uses of the dapfinder, we analyzed transcriptional data from glioma samples publicly available in the repository of molecular brain neoplasia data  . we used data from oligodendroglioma  and glioblastoma multiforme  samples representing low and high malignancy primary adult brain tumors, respectively  <cit> . we identified significant differences in pearson correlation  between odg and gbm tumors for  <dig> gene-gene pairs which were consistent in tumors from two independent studies at henry ford hospital  <cit>  and the glioma molecular diagnostics initiative   <cit> . we constructed a gene-gene association network by focusing on a cluster of  <dig> gene-gene pairs  with significant differences in pearson correlation between odg and gbm tumors and an additional  <dig> gene-gene pairs  that are connected to this cluster of  <dig> daps by correlations of similar strength and direction in both classes of gliomas . see supporting materials for details.

we noticed three features in the network that were not necessarily expected. first, more than half of the genes from this network were differentially expressed between the two classes of glioma . this suggests there may be a general correlation between differential expression and differences in association between phenotypes. second, the relationship between differential expression and direction of correlation from consistent edges may represent potential regulatory relationships among genes. positive correlations occur whenever both genes are up- or down-regulated, while negative correlations occur whenever one gene is up-regulated and the other is down-regulated. note, because the correlations are estimated within the same type of samples, either odg or gbm, the fact that genes are up- or down-regulated in gbm relative to odg should not influence the correlation results. this phenomenon is seen in all  <dig> correlations that are consistent between the odg and gbm tumors. third, the significant differences in gene-gene association seem to reflect the biological differences between odg and gbm. correlations that change direction between glioma types typically show strong positive or negative correlations consistent with regulation in odg, while having zero correlation in gbm. this suggests that evolution of the tumor may lead to the loss of regulatory relationships in the de-differentiating tissue. the gene-gene association shrinks from  <dig> genes and  <dig> gene-gene pairs in odg to  <dig> genes and  <dig> gene-gene pairs in gbm, suggesting systems-level network shrinkage from odg to gbm resulting in loss of regulation functions.

among the significant correlation changes in the network, we find three genes  known to have meaningful roles in glioma pathogenesis  <cit> . myelin transcription factor  <dig>  is upregulated in the less malignant odg tumors and it is a major factor necessary for neuronal differentiation  <cit> . the significant difference in pearson correlation between sox <dig> and mytl <dig> in odg and gbm tumors is visualized with dapview . epidermal growth factor receptor  is a famous member of the erbb family of receptors that involved in regulation of cell proliferation and differentiation. deregulation of egfr was shown to have critical role in gliomas  <cit>  as well as in several other malignancies  <cit> . up-regulation in the protein-coding gene postn  is correlated with metastasis in both melanoma and breast cancer  <cit> . although this analysis does not allow for definitive biological conclusions, it finds both previously established genes essential for tumorgenesis as wells as points to a new previously unexplored area of transcriptional regulation of gliomas. these results support the idea that estimating not only the structure but also changes in the co-expression gene networks can be a useful approach for understanding the disease process.

CONCLUSIONS
analyses of empirical and simulated microarray data have shown that dapfinder is a powerful tool to reconstruct and compare gene regulatory networks. its design is not restricted to gene expression data from single channel and dual channel microarray experiments. the tool can also be used with expression data from rna-seq reads or it can analyze complex quantitative biological data like comparative genomic hybridization , metabolome, microbiome and proteome data. dapfinder can also be used to compute gene-gene associations and construct gene coexpression networks, even when there is not a second phenotype for comparisons of gene-gene associations and networks. dapfinder can be used within brb-arraytools by biologists without specific skills in programming and/or direct script usage. indeed, we have recently employed the tool in the meta-analysis of cervical cancer gene expression and comparative genomic hybridization data revealing critical events of tumor progression . future versions may extend the utility of the statistical tests and graphs to problems with  <dig> or more phenotypes, while alternative gene-gene association metrics and statistical tests can also be explored to ensure proper networks construction.

availability and requirements
dapfinder and dapview may be downloaded for free from the niaid exon website http://exon.niaid.nih.gov/dapfinder/index.html. complete installation instructions are provided on the website. dapfinder and dapview requires the installation of brb-arraytools. brb-arraytools currently requires the installation of microsoft excel, java virtual machine, r  <dig> . <dig> or higher and statconndcom on computer using the microsoft windows operating system. dapfinder and dapview are brb-arraytools plug-ins, which mostly utilize open source r script files. a complete description of the dapfinder and dapview files can be found in our supplementary materials . dapfinder and dapview are also available to download as additional files  <dig> and  <dig> 

list of abbreviations
anova: analysis of variance; aracne: algorithm for the reconstruction of accurate cellular networks; auc: area under curve; cgh: comparative genomic hybridization; clr: context likelihood of relatedness; cv: coefficient of variation; dap: differentially associated pair; deg: differentially expressed gene; fdr: false discovery rate; fwer: family-wise error rate; gbm: glioblastoma multiforme; gmdi: glioma molecular diagnostics initiative; html: hyper text markup language; iqr: interquartile range; mr: maximum relatedness or minimum redundancy; odg: oligodendroglioma; pca: principle components analysis; pdf: portable document file; rembrandt: repository of molecular brain neoplasia data; roc: receiver operator characteristic.

competing interests
the authors declare that they have no competing interests.

authors' contributions
js was the primary software developer, critically contributed to the overall concept of the software, performed and analyzed the simulation experiments, and drafted the manuscript. yk analyzed the glioma data and simulation results, drafted part of the manuscript related to the glioma data and provided input on the development of the software. sv assisted with software development, contributed the adaptive permutation test feature to the software, performed and analyzed simulation experiments. klm tested the software and provided input on the development of the software. ay conceived the original idea for the software, provided input on the development of the software and assisted with the generation of simulated microarray data. rs provided formulas for approximate tests of kendall and spearman correlations, contributed the single class correlation selection procedure to select gene-gene pairs for permutation tests. yh supervised the software development project, provided web distribution of the software and provided input on the development of the software. am conceived the original idea for the software, provided the original specifications for the software, analyzed and interpreted glioma data and simulation results, drafted parts of the manuscript and provided scientific leadership of the project. all authors reviewed and approved the manuscript.

authors' information
none.

supplementary material
additional file 1
additional information and supplemental figures not included in the article. additional details about dapfinder methods; development details of dapfinder and dapview; validation of dapfinder with simulated microarray data; discoveries from glioma data.

click here for file

 additional file 2
dapfinder. dapfinder plug-in software for brb-arraytools.

click here for file

 additional file 3
dapview. dapview plug-in software for brb-arraytools.

click here for file

 acknowledgements
this work was supported by funding from the department of intramural research  and the office of the director  at niaid, nih. vivek gopalan, supriya menezes and ming-chung li helped with the initial coding of dapfinder. vijay nagarajan and michael dolan helped produce and edit the figures. natalia shulzenko discussed biological questions motivating our tool.
