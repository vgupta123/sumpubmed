BACKGROUND
cooperation is central to transitions in individuality  <cit> . full individuality is achieved when components cooperate and relinquish their autonomy to the larger whole. depending on the type of transition, this may necessitate the division of labor in growth, reproduction, development, feeding, movement, and protection against external aggression and internal conflict  <cit> . in the evolution of multicellularity, the chain of events from autonomous individuals at one level to the incorporation of these individuals into a more complex entity remains unclear  <cit> . however, some of the putative forces are likely to be general, since multicellularity has arisen many different times in evolutionary history  <cit> . moreover, that many groupings do not show sophisticated specialization and are characterized by substantial levels of internal conflict  <cit> , suggests that incomplete multicellularity may be a frequent outcome. what mechanisms are essential to generate individuality? we believe that a general theory needs to explain both full and incomplete transitions towards multicellular individuals.

previous work highlights group and kin selection  <cit> , organism size  <cit> , and the reorganization of fitness and specialization tradeoffs  <cit>  as playing roles in the evolution of multicellularity. a feature common to these mechanisms is the establishment and maintenance of cooperative behaviors amongst subunits through, for example, conflict mediation . based on a recent literature review, grosberg and strathmann  <cit>  argued that for cooperation to emerge and favor the specialization of subunits, groups of cells need to reduce genetic conflicts arising in cell lineages  <cit> . they conclude that several mechanisms can limit such conflicts, perhaps the most important being development from a single cell .

a key type of subunit specialization in multicellular organisms is the separation of germ and soma  <cit> . separating germ and somatic functions amongst individual cells or cell lineages requires that each sacrifice autonomy. theory predicts that such specialization is promoted by non-mutually exclusive mechanisms such as cooperation and relatedness amongst cell lineages  <cit> , cheater control  <cit>  and adaptive responses to tradeoffs between survival and reproductive functions, i.e. a covariance effect augmenting the fitness of the group over the average fitness of its members  <cit> . it is not known whether the alignment of fitness interests in emerging soma and germ lines tends to occur before, during or after other types of specialization characteristic of multicellular organisms  <cit> .

a pervasive feature in a diverse array of social systems is that individuals not contributing to the common good either act as dispersers, or are either rewarded for, or coerced into, cooperating. examples range from bacteria  through protozoa  to metazoans, like eusocial insects and mammals . for example, in naturally occurring dictyostelium slime molds prespores secrete a chlorinated hexaphenone  inhibiting redifferentiation of prestalk cells into prespores, which would transpose them from "cooperative" stalk building to "cheating" spore production . cheating is further curtailed by pleiotropic effects of a gene required to permit receipt of this signal, which affects also the probability of spore formation  <cit> . in tunicates such as botryllus schlosseri, natural chimeras consisting of genetically nonhomogenous organisms often show reproducible germ cell parasitism that is sexually inherited, with "parasitic forms" being expressed only in the germ line, i.e. in the dispersing entities  <cit> . in the cooperatively breeding cichlid fish neolamprologus pulcher, brood care helpers of both sexes are forced to pay rent for being tolerated in a safe territory  <cit> . to avoid being punished they preemptively appease dominants by cooperative and submissive behavior  <cit> . typically, in these cichlids and in cooparatively breeding meerkats suricata suricatta, subordinates preparing for dispersal reduce helping  <cit> , which might be explained by reduced costs of potential punishment by eviction  <cit> . in eusocial mole rats  non-reproductive helpers and hardly helping dispersers coexist  <cit> . policing of subordinates by dominant breeders may simultaneously maintain social order and stimulate cooperative behaviors  <cit> . this distinction of roles between individuals is particularly obvious in the separation between soma and germ that has apparently evolved many times independently  <cit> . nevertheless, there are examples where cooperative behaviors are associated with enhanced group dispersal . for example, in the soil-dwelling social bacterium myxococcus xanthus, individualistic cell movement  promotes swarming on hard surfaces, whereas swarming on soft surfaces is a group function driven primarily by individually costly s-motility  <cit> .

these empirical patterns merit explanation, and we take a first step by employing optimization techniques to evaluate the conditions leading to associations between dispersal and social strategy. sociality in our models takes the form of cooperation in the production of a public good. previous study of public goods has shown how cheating, if left unchecked, potentially leads to a "tragedy of the commons"  <cit> , whereby individual selection tends to favor exploitation of the public good at some concurrent or future detriment of the group. several non-mutually exclusive mechanisms may promote cooperation and group persistence, including kin selection , rewards and sanctions , spatial and network structure , and signals involving kin or non-kin . recent reviews and perspectives can be found in crespi  <cit> , sachs and colleagues  <cit> , lehmann and keller  <cit> , and west and coworkers  <cit> .

we develop a model based on kin selection that incorporates dispersal specialization, as suggested by the case studies in table s <dig> . we employ the terms "soma" and "germ" to represent the functions of within-group growth and dispersal leading to the founding of new groups, respectively. our use of the terms "cooperators" and "cheaters" refers to social behaviors within the commons , and this should be distinguished from the frequent usage of "cheaters" as cooperative somatic lineages trying to gain access to germ line . specifically, cooperators contribute to the public good within a distinct group at an individual cost, and cheaters exploit the public good. cooperators and/or cheaters may be selected to either remain in a group, or to disperse . our theory proposes a mechanism leading to high overall cooperation, based on dispersal specialization. in addition to increasing our understanding of cooperative and dispersal behaviors, it could apply to the evolution of multicellularity in a range of contexts, including physiologically integrated organisms  <cit> , organisms with both solitary and integrated life-styles , and complex societies  <cit> .

methods
we formalize our verbal arguments given above by developing and analyzing a model of coevolution between exploitation of the commons and dispersal. from the outset, we stress that our model is a highly simplified representation of this process, and not aimed to make quantitative predictions for any given system. rather, our goal is to identify the qualitatively important drivers in the coevolution of individual strategies and the evolution of multicellularity.

in our model the focal units of selection are individuals themselves, rather than the higher-level unit. a transition to multicellularity is favored when the interests of the individual and the higher-level  are aligned  <cit> . previous models investigating the transition to multicellularity invoke a framework where the group is the focal unit of selection . however, focusing on the higher-level as the focal unit does not easily allow the investigation of optimization at the lower level  <cit> , and the individually-selected conditions leading to a major transition  <cit> . grosberg and strathmann  <cit>  have argued that many of the requirements for transitions to multicellularity exist in unicellular organisms . once a transition is in progress, and the "group" begins to behave as an individual entity, one can begin to treat this unit as an evolving individual in itself.

we analyze an optimization model that takes into account the effect of both the phenotype of the focal individual and the average phenotype of the group in which it lives, on the fitness of the focal individual . the approach is based on the direct fitness method  <cit>  in that, by considering the effects of both individual and average group phenotypes on the fitness of a focal individual, we can apply the price equation to partition these effects as weighted by the relatedness of the focal individual to other members of the group  <cit> . we can then assess the relative impacts of  costs and benefits of individual behaviors and  kin structure, on associations between exploitative strategy within a group, and dispersal to found new groups. nevertheless, our model oversimplifies the complexity of social behavior and dispersal decisions , and should thus be viewed as a preliminary attempt to identify patterns.

our model makes several assumptions. first, we do not explicitly consider dynamics, such as group founding, group numbers, individual emigration and immigration, and competition for limiting resources within or between groups. rather, we assume negligible variation in inter-group competition. second, our model does not explicitly incorporate genetic polymorphisms, meaning that the heritable traits are probabilities to adopt alternatives of each strategy  depending on environmental and/or social conditions  <cit> . third, there is a simple direct tradeoff between an individual's viability  within the group and its ability to disperse and found new groups. this is based on the well established life-history trade-off between reproduction and dispersal , probably best studied in insects . whereas growth and reproduction within the group impacts the production and consumption of the public good, the tendency to disperse reduces these impacts because of the limited presence of dispersers in the source group.

life cycle and fitness equations
we assume that a group's life-cycle has three sequential stages: colonization, growth, reproduction and survival of individuals within the group; exhaustion of resources; and the dispersal of survivors. some of the survivors may stay at the same site of the source group, and others disperse as colonists to other sites.

the model tracks the fitness contribution of a mutant individual i, within group j  <cit> . fitness effects are partitioned between cooperators and cheats–who have positive and negative impacts on the public good, respectively–and amongst dispersal strategies. thus four strategies are possible:  cooperate and remain in group,  cooperate and disperse,  cheat and remain in group, and  cheat and disperse. only the first and third strategies affect the public good.

the proportion of cooperators in the group is ni , which can take continuous values between  <dig> and  <dig>  moreover, our model incorporates two dispersal strategies based on whether the dispersing individual is a cooperator or a cheater. we define yi as the investment of a cooperator in dispersal and zi as the investment of a given cheater in dispersal. both of these quantities take on continuous values between zero and one. the mean proportions of dispersing cooperators and cheaters in group j are yjnj and zj, respectively and overall investment in dispersal is dj = yjnj + zj.

the fitness equation takes the form

  wi = d e g, 

where the functions d and e, respectively, represent the contribution of selection on dispersal and the exploitation of the public good of individual i in group j to its own fitness. function g is the overall investment in the public good in group j.

dispersal is modeled by considering the fitness contributions of both individuals that stay at the site previously occupied by the group and others that disperse  <cit> . we assume that the costs of dispersal may differ between cooperators  and cheaters . small costs would indicate abundant new sites for group establishment and high disperser survival. although we consider different cases in the analysis, our general expectation is that the costs of cooperation will extend to dispersal, such that c > e.

the function, d, takes the form

  d =  + . 

the first term in square brackets describes the fitness of a non-disperser  - yi ni) relative to the average non-disperser  - yj nj) and immigrants  z  + y n). the second term describes the fitness of a disperser  zi  + yi ni) given the competition it faces with residents  - y n) and migrants  z  + y n) in another group. the terms n, z and y  are population-wide means. the denominator in both terms represents the amount of competition faced either in the original group, in the case of a non-disperser, or in a new group, in the case of the disperser. note that in the limit of no dispersal, individual fitness can still be positive under the assumption that groups survive indefinitely.

all non-dispersing individuals are selected to exploit, but given our assumption that there is a cost of cooperation , this will weight selection to favoring cheaters, all else being equal. the function, e, describes the contribution of individual i to its own fitness through exploitation of the public good and is given by

  e = /, 

where the subscript j indicates mean group levels, and the constant s measures the cost to individual cooperators in producing the public good.

the overall effect of group investment in the public good on individual fitness is described by

  g =  <dig> + p  nj - q  , 

where it is assumed that non-dispersing cooperators have a positive effect on the public good  as their frequency, nj, increases  <cit> , whereas cheaters have a net negative effect on the public good  as their frequency, 1-nj, increases. note that in the absence of cooperators, cheats can persist as long as their impact on the commons is sufficiently low . alternatively, when group effects are nil , the notion of a group is a collection of autonomous individuals.

relatedness and numerical simulation methods
we analyze the model by employing the price equation, which enables us to express possible fitness maxima as a function of constant parameters and variables, and the relatedness, r, between individuals. taylor and frank  <cit>  give methods for finding the equilibrium, such that for any trait v we have

  dwi/dvi = ∂wi/∂vi + r ∂wi/∂vj 

from which we can find a steady state when dwi/dvi =  <dig> to find any or all v* = y*, z*, n*.

in our model, r can either be a parameter  or can emerge from the underlying structure of the population . in the latter case, we may derive r from the dispersal of individuals in the population with the recursion relation 

  r = 1/k + /k  <dig> r. 

this recursion tracks the probability that a given focal individual is identical by descent to another randomly picked individual at time t. the parameter k is the effective number of individuals in the group, and can be viewed as a measure of genetic diversity due to individual aggregation in group founding and habitat structure. . low k is indicative of group founding by single individuals, group resistance to immigration, and abundant open sites for group founding  <cit> .

in the recursion above, the term 1/k represents the probability that the randomly picked individual is the focal individual itself. the second term represents the probability that the randomly picked individual is different to the focal individual, and that neither have dispersed 2). this is multiplied by the relatedness from the previous round. solving this recursion relation yields the equilibrium relatedness, which is

  r = 1/ 2). 

as we assume weak selection, the probability that a given individual disperses depends on the probability that it is a cooperator and disperses, plus the probability that it is a cheater and disperses, so d = yn+z in this case. under the assumptions of weak selection, we evaluate this recursion for the case when vi = vj = v, where v is the trait in question.

optimal strategies were solved numerically. this consisted of iterating equation  with steps of  <dig>  or smaller for a total of  <dig>  steps, which was sufficient to identify the steady state in all cases. we found that whereas initial levels of evolving variables did not affect the optimal solution when only dispersal frequencies y and z evolved, initial conditions could indeed affect the optimal solution when all three variables evolved. closer examination showed that alternative stable states were possible, one with either all cheaters  or all cooperators , and a second with both strategies persisting . although we cannot exclude the existence of alternative interior equilibria, our numerical studies always yielded at most a single interior solution.

RESULTS
we consider two scenarios. in the first  only dispersal in cooperators  and cheaters  evolves, but not cooperation . this situation would be obtained if mechanisms not explicitly included in the model  controlled the level of cooperation, or if the frequencies of cooperative behaviors were either not subject to evolution, or labile to it over much longer time scales than dispersal. more generally however, empirical study suggests that cooperative behaviors are subject to selection  <cit>  and we consider the case  in which dispersal and the frequency of cooperators  and cheaters  co-evolve.

in addition to optimal levels of dispersal , and of cooperation and dispersal , we examine the effects of model parameters on dispersal specialization σ = y*/, and for model  <dig> only, overall cooperation Φ = n*+z* . note that when σ =  <dig> , although all cooperators  are sedentary it is not necessarily true that all cheats  disperse.

model 1
optimal solutions always yielded partial or complete specialization, with cooperators tending to disperse more than cheaters  for high costs of cooperation  compared to public good's effect , and low cooperator frequencies  . the reverse trends promote relative cheater dispersal . the impact of effective group size  is more complex. higher k tends to polarize dispersal to either cooperators  or cheaters , and increases the parameter space in which cooperators dominate dispersal .

low effective group size  should positively associate with kin competition, and in agreement with previous work  <cit> , we find that low k is associated with higher overall dispersal, d* . not surprisingly, d* increases with lower cooperator frequencies  and public good effects  . however, the effects of k and n on the separate cooperator  and cheater  dispersal frequencies are more complex . in particular, low k was always found to drive cheaters to disperse , whereas the effect on cooperators depended strongly on cooperator frequency  and public good productivity  .

cheater and cooperator dispersal can be understood as follows. when the group is dominated by cheaters  and production of the public good  is small, increasing cooperator sedentariness  has little beneficial effect on fitness , due to insufficient marginal gains via both individual exploitation  and the group effects . as a consequence, cooperators are selected to disperse more, relative to cheaters. cheaters may disperse at high levels nonetheless , because in so doing, they lessen the effects of the tragedy of the commons on individual fitness of their kin. in contrast, when the group is dominated by cooperators  and public good production is high , marginal fitness increases with cooperator sedentariness and, due to kin competition , cheaters are selected to disperse more, relative to cooperators.

model 2
permitting social evolution introduces the possibility that the frequency of cooperators or cheaters fixes to zero or one, in which case associations  between dispersal and social strategies are irrelevant. we find that depending on parameter combinations, either only a single global optimum is obtained, or two alternative local optima are possible. in the latter case, which state is obtained depends on initial levels of y, z and n in the numerical simulations. figure  <dig> shows the fraction of simulations with random initial levels of n, y and z, achieving either an internal equilibrium , or one with all cooperators , or one with all cheaters  for different costs of cooperator dispersal  and effective group sizes . for simplicity in the analyses below, we employ a single arbitrary starting condition .

we observed four basic outcomes :  fixation of cooperators ,  fixation of cheaters , or coexistence of cooperators and cheaters with  the former only being sedentary , or  the latter only being sedentary . when σ * =  <dig> or σ * =  <dig> , we further found outcomes in which all cheaters dispersed  or all cooperators dispersed , respectively. parameter effects are generally similar to model  <dig>  but with some notable contrasts.

whereas in model  <dig>  the relative cost of cooperator  and cheater  dispersal did not yield a simple threshold condition for optimal outcomes , it did so for model  <dig>  we found that when cooperators and cheaters coexisted and e > c, cooperators dispersed and cheaters did not  . the reverse held when c > e . low effective group size  increases cooperator persistence , with the effects on cheater persistence contingent on other parameters . more interestingly, whereas when e > c, lower k shifts the parameter space permitting cooperators and cheaters to coexist and has little effect on the area in which all cooperators disperse , when c > e, it expands the area of coexistence and that in which all cheaters disperse  . finally, relatedness  generally increases with high p:s ratios, low k, and high costs to cooperator dispersal, c, with respect to cheater dispersal, e . interestingly, specialization in dispersal by cheaters and in sedentariness by cooperators tends to associate with high, but not the highest levels of relatedness .

if we define the functional role of a cooperator as contributing to the public good, and that well functioning groups minimize the impact of cheats on the public good, then, trivially, specialization resulting in mobile cooperators and sedentary cheaters corresponds to a non-social, individualistic scenario, and cannot be considered a group related phenomenon. there are however two ways in which the impact of cheaters on the commons can be reduced: either 1-n* decreases and/or z* increases. figure  <dig> presents the effects of model processes on overall cooperation, defined as Φ = n*  +  z*. we see that although high levels of Φ are generally promoted for high p:s ratios, perfect overall cooperation  is most readily obtained at low k and intermediate p:s ratios .

discussion
our results are in broad agreement with the tenets of kin selection theory for explaining dispersal  <cit>  and the maintenance of cooperative behaviors  <cit> . specifically, we found that dispersal specialization leading to high levels of overall cooperation  is promoted by sufficient benefit to cost ratios  of cooperation and by kin selection . the one apparent discrepancy to previous theory is, whereas higher benefit  to cost  ratios promote cooperation, higher kin selection  was sometimes observed to reduce the relative frequency of cooperators  . this can be explained if we consider cheaters dispersing from the group as a type of cooperative behavior. dispersing cheaters are effectively 'cooperative' because of the incurred individual cost of dispersal , and the benefits to the group in having less negative impact on the commons  . moreover, we found that partial or total specialization of otherwise somatic cheats as dispersing germ line occurred without the need for costly modifiers  <cit>  or the repression of cheaters , suggesting that the mechanism identified here is applicable to a wider range of organisms where these mechanisms do not sufficiently reduce somatic cheating, or cannot evolve. conversely, control mechanisms such as rewarding and punishment, which might be operating in many systems , do not preclude the functionality of the mechanism demonstrated in this study .

the examples presented in table s <dig>  and our theoretical findings suggest a common conceptual and mechanistic foundation for the evolution of cooperation and individual functional specialization within groups . most of the empirical examples share the feature that cooperators are less dispersive than more competitive individuals. for instance, low dispersal coincides with physical binding in bacteria that generate biofilms as a public good by polymer production  <cit>  , with alloparental care of offspring in cooperative breeding  <cit> , or with complete genetic altruism in certain eusocial insects  <cit> . it is worth noting that a consistent differentiation of roles regarding sedentariness and dispersal in relation to cooperation and cheating may be much more common in nature than currently believed . because there is no prior formal theory predicting such a relationship, empirical research on this issue is rare and suitable data are therefore scant. we stress that our theory does not elucidate the precise evolutionary pathway leading to complete multicellularity  <cit> , but rather assesses the forces promoting or forestalling different levels of specialization of cooperators and cheaters as functional germ line and soma. as such, the observations of biased dispersal in table s <dig>  have alternative explanations, including forced eviction  <cit>  and individual-based habitat selection  <cit> . experimental , phylogenetic , and theoretical  approaches are fruitful avenues to explore alternative explanations and pathways.

transitions in individuality and social complexity are generally thought to require some form of reduction in genetic variance during the reproductive process  <cit> . genetic heterogeneity can emerge from many sources  <cit> , and the recursive equation  <dig> in our framework greatly simplifies these, only explicitly including the effects of dispersal. our results confirm the importance of relatedness in achieving multicellularity, but also show that the highest levels of relatedness did not necessarily yield full specialization of cooperators or cheaters as dispersers, and that complete specialization could occur at relatedness levels as low as  <dig>  . as such, our findings could extend to some systems in which groups are formed by the initial aggregation of non-kin  <cit> . further study is needed to explore this prediction in detail, since our model did not explicitly account for different lineages, and as such we do not know how spatial heterogeneities in relatedness might influence our results  <cit> .

our findings have precedent, both in the study of symbiotic associations, and investigations of cooperation within species. with regard to host-parasite and symbiotic interactions, previous research has considered how parasite virulence  may evolve spatially . in the case of horizontal transmission in parasites, which is analogous to the level of dispersal in our model , theory generally predicts that increased horizontal transmission  associates with higher parasite virulence  in our model)  <cit> . despite allowing for relatedness between potential cooperators and cheats we have a comparable finding, whereby an increasing tragedy of the commons pushes cheating individuals to disperse; this is both because of increased individual fitness opportunities through dispersal  and increased inclusive fitness through lowered group effects for those related individuals that do not disperse  ).

in a model investigating cooperation in spatially viscous environments, van baalen and rand  <cit>  suggested that non-altruists should disperse more readily than altruists and hypothesized that this could be viewed as a transition towards multicellularity. koella  <cit>  studied the independent dispersal of altruists and of cheaters in a spatially explicit setting and found that a polymorphism could arise in which altruists dispersed and interacted locally, whereas cheaters evolved longer dispersal distances and exploited altruistic clusters. hamilton and taborsky  <cit>  showed that when the propensities to cooperate by generalized reciprocity and to disperse evolve independently, under a wide range of conditions either cooperation or defection is associated with dispersal, depending on the probability of finding new groups and on the costs of being alone. over most of the range of mobility costs examined, cooperation was negatively correlated with mobility, while defection was not. ultimately, this leads to assortment between altruists and defectors in the population , which secondarily can generate group selection effects  <cit> . hamilton and taborsky  <cit>  did not check for linkage effects, however. in another study of the joint evolution of altruism and mobility, le galliard and coworkers  <cit>  found that more altruism enhancing local aggregation can select for increased mobility. the synergistic selective interaction between altruism and mobility may cause dispersal to be considerably higher than that predicted in a purely selfish population, if altruism costs accelerate slowly and mobility costs are moderate. however, their model did not reveal a polymorphism to occur between selfish-mobile and altruistic-sessile phenotypes as found so often in nature, from microbes and unicellular algae to mammals . queller  <cit>  argued that the resolution of within-organism conflicts could occur if an altruism allele is expressed conditional on the environment, the altruistic act being an individual removing itself from the germ line in order to perform an enhanced somatic activity. rainey  <cit>  verbally proposed an idea similar in some respects to these studies, in which group selection acts to promote the functional separation of germ and soma in bacterial biofilms through the dispersal of cheats . finally, michod  <cit>  showed how the specialization of lower level units into germ and soma could be associated with the transfer of fitness from lower units to the new higher individual. a critical feature of his model is the tradeoff between the viability and fecundity of lower level units, which, for convex relationships, creates disruptive selection for cooperative germ and soma. our study, whilst generating congruent results, is to our knowledge the first to demonstrate that the evolution of lower level units based on their effects on the commons can yield dispersal specialization, one of the precursors for selection at the group level and the evolution of full multicellularity.

CONCLUSIONS
our results suggest that the establishment of trait linkage between dispersal and the propensity of within-group cheating may be a general phenomenon promoting complex social organization and multicellularity. importantly, we cautiously suggest this should be operative regardless of whether groups ever achieve higher levels of individuality, because selection on individual components will always tend to increase exploitation, and stronger group structure will tend to increase overall cooperation through kin selected benefits  <cit> . partial or full reduction in the negative effects of cheaters on the commons through their specialization as dispersers offers partial solutions to two problems: the evolution of cooperation in social groups and the origin of the specialization of germ and soma in multicellular organisms. our model is, nevertheless, a highly simplified caricature of real systems and future theoretical and empirical study is needed to explore its robustness.

authors' contributions
meh conceived the study, developed and analyzed the model and wrote the manuscript. djr participated in the design of the study, developed the model and participated in writing the manuscript. mt participated in the design of the study, constructed table s <dig>  and participated in writing the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
. examples of group formation for which there is some information on dispersal, relatedness and punishment/policing.

click here for file

 acknowledgements
we thank daniel blumstein, ross crozier, steve frank, toby kiers, barbara taborsky, peter taylor and don waller for helpful discussions, and steve frank, andy gardner, paul rainey, stuart west and two anonymous reviewers for comments on earlier drafts. meh acknowledges the santa fe institute , the national center of ecological analysis and research , and the centre national de la recherche scientifique for financial support. mt and djr acknowledge the swiss national science foundation for support .
