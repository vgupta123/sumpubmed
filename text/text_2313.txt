BACKGROUND
the rapidly growing amount of genomic sequence information necessitates tools for its annotation. although predicting bacterial genes is in many ways simpler than predicting eukaryotic genes, it is clear that there remains room for improvement in the bacterial case. several groups have undertaken efforts to re-annotate specific genomes  <cit> , often finding a small but significant number of errors in existing annotation of gene loci. the presence of these errors has motivated the effort of some groups to systematically revise the gene annotations in public databases as a continuous process  <cit> .

because technology for genome sequencing is much more mature than proteomic analysis, only a small fraction of annotated bacterial gene products have been detected as protein; most have been annotated using only computational methods. although methods for detecting and identifying all proteins in a cell are being developed  <cit>  and incorporated into annotations of newly-sequenced genomes  <cit> , these techniques are currently limited by the ability to express all of the polypeptides in an organism and separate them into fractions with low enough complexity for analysis. it is still useful to refine our computational predictions so that we can make targeted searches for potential proteins.

accuracy of gene identification is particularly important in studies of the gene content of a genome as a whole. studies of phyletic patterns of gene presence  <cit> , the extent of horizontal gene transfer among genomes, the entire set of protein structures encoded by a genome  <cit> , and the components of a "minimal genome"  <cit>  are all predicated on an accurate catalog of the genes within an organism. because these studies involve comparing the presence or absence of genes among several organisms, it is particularly important that all of the genes present be identified. insights in these areas of study could impact our understanding of bacterial evolution physiology and pathogenicity. as an example, in the initial report of the mycoplasma mobile genome sequence the correlation of presence or absence of certain genes with a presence or absence of a specific phenotypic characteristic  among nine species was used to suggest genes which might confer that phenotype  <cit> .

methods for predicting protein-coding genes are often divided into intrinsic and extrinsic classes  <cit> . intrinsic methods only use evidence from within the primary sequence of a genome. this evidence may include i) the presence of a relatively long frame uninterrupted by a stop codon, ii) the statistical pattern of polynucleotide stretches that match the typical frequencies present in other coding regions of the organism and iii) the existence of appropriate non-coding control elements. it may be difficult to identify some small genes using the first two types of evidence; small genes can be difficult to distinguish from open reading frames that occur by chance, and in such short regions, sequence characteristics may be affected stochastically. gene finding methods which use sequence characteristics or control elements often need to be tuned for the specific organism studied, and in many cases several statistical models of coding regions may need to be developed in a single organism  <cit> .

extrinsic methods use information from comparisons of genomes. these analyses originally used simple pairwise comparisons among potential protein-coding regions. harrison et al.  <cit>  examined orfs of  <dig> or more codons in  <dig> microbial genome sequences, using blast e-value of less than 10- <dig> to indicate similarity suggestive of conserved function. other searches use sequence alignments of a protein family as a query against all possible translations of the genome of interest. this alignment may be specified beforehand  or developed as part of the search as by psi-blast  <cit> . pair hidden markov models use a pairwise sequence alignment coupled to a hidden markov model to more precisely determine the amino termini of protein-coding genes  <cit> . programs have been developed that use pairwise alignment of syntenic regions to predict gene structure in eukaryotes  <cit> . the ratio of synonymous to nonsynonymous substitutions between pairs of putative genes can be used to examine whether there is selection for protein-coding function, but this requires sequences from closely related organisms  <cit> . the majority of bacterial genome annotations have used intrinsic methods at least initially to predict the presence of genes. extrinsic gene prediction methods serve as a useful complement to intrinsic methods because independent information is used to make the same prediction.

in this study we describe a systematic extension to examining similarity shared among several genomes using a modification of the analysis of clusters of orthologous groups . cogs were developed to cluster annotated genes into functionally related groups in order to facilitate the transfer of functional annotations among organisms  <cit> . here we use cogs to cluster open reading frames as a means of recognizing genes. an advantage of the cog analysis is that no explicit threshold for sequence similarity is used; genes that are missed in pairwise comparisons may be detected. because the focus is on annotation of gene location rather than gene function, we are not concerned with finding genes that are strictly orthologous. evidence of homology to another gene is sufficient to imply that a region is a gene, and we make no effort to avoid the joining of cogs which may occur due to a gene fusion  <cit> . the idea of stringency  <cit>  of cogs expands upon the initial cog definition by requiring an adjustable of connectedness for grouping genes. as the number of studied organisms increases, the stringency can further filter some similarities which may have occurred by chance. orfs that do not correspond to annotated genes but that nonetheless have conserved sequences present in several genomes are likely to be protein-coding genes that have been missed by current annotations.

a cluster of orfs can be examined with regards to its multiple sequence alignment, the network of similarities among the orfs, and the respective genomic contexts of the orfs in the cluster. these characteristics of orf clusters can be used to screen existing gene predictions for potential errors. the extrinsic nature of the use of cogs of orfs is complementary to the intrinsic methods that have been used in producing the majority of gene loci annotations. because our strategy has different strengths and weaknesses from the intrinsic methods, it may be expected to pick up some genes that other methods have missed.

in this study we examined open reading frames from the complete genome sequences of  <dig> bacteria . we selected these genome sequences for the following reasons. m. genitalium and m. pneumoniae are model systems for defining the minimal cellular genome. consequently, their proteins became the focus of research at the berkeley structural genomics center  <cit> . other members of the class mollicutes provide a closely related set which may help identify genes specific to this class. the protein products of m. pneumoniae and m. mobile have been recently studied using high-throughput identification using multidimensional chromatography and mass spectrometry  <cit> . we included other small-genome parasitic bacteria to study the extent to which gene content has convergently evolved among this group. we also included a more diverse selection of bacterial genome sequences from major phylogenetic groups to see how robust our strategy would be when examining distantly related organisms.

we wanted to detect fragments of genes and genes which use start codons other than atg, so we used a very general definition of an orf: any frame of length at least  <dig> codons  uninterrupted by stop codons. the software developed as part of this study, sprocket, can be used to detect probable errors in existing gene annotations.

RESULTS
gene discovery using conservation of potential peptide sequence
extrinsic gene-finding methods are based on the duality that, given sufficient evolutionary distance, conserved sequences are likely to be functional and that functional sequences are likely to be conserved. the conserved regions may represent control elements or may encode functional rna molecules or proteins. we examined the extent to which multi-species sequence conservation could be used to detect the presence of protein-coding genes. we considered two systems for classifying orfs as genes or not-genes. the first system was based solely on existence of a cog containing the orf. if we determined that an orf was a member of a cog then we classified it as a gene, otherwise we classified it as not being a gene. our second classification system used existing gene annotations for all genomes except the one containing the orf to be classified, reducing the number of false positives. in this system we classified an orf as a gene if we found it in a cog containing at least one orf from another genome that was annotated as a gene. in both systems the cog stringency controlled the extent of conservation required for classification.

we compared these gene predictions to existing gene annotations using sensitivity/specificity analysis. although there are errors in existing gene annotations  the current annotations represent the expert consensus. sensitivity for a gene classification system is the number of correct gene predictions divided by the number of actual genes. the specificity is the number of true negative predictions divided by the total number of non-genes.

sensitivity and specificity of gene predictions varied at different stringency levels of the cogs used in classification. the accuracies of both classification systems are summarized in figure  <dig>  receiver-operator characteristic  plots show the true positive rate  along the vertical axis against the false positive rate  along the horizontal axis. an ideal test  would be represented by a point plotted in the upper-left corner . figures 1a and 1b show the classifications based solely on cog membership and based on cog membership with an annotated gene from another organism, respectively. each point plotted on this graph represents the sensitivity and specificity of classification at a given stringency. roc curves are shown for a sample of seven of the genome sequences studied and for the pooled results for all of the genomes. the accuracy of tests for each genome sequence and pooled results for all of the genome sequences are summarized across cog stringencies by the area under the roc plots . the sensitivity and specificity values for all of the studied genomes were computed .

"mixed" cogs
cogs formed from orfs can also be used to mine existing gene location annotation for potential errors. cogs in which there are some orfs that correspond to annotated genes and other orfs that do not correspond to annotated genes represent potential anomalies in existing annotations. the number of these mixed cogs at different stringencies is shown in figure  <dig>  also shown in figure  <dig> are the number of cogs at each stringency level which contain only orfs which correspond to annotated genes  or which contain no orfs which correspond to annotated genes . the initial increase in numbers of cogs when moving from stringency two  to three is the result of larger, weakly connected cogs splitting into several smaller cogs. as stringency increases beyond three, the number of cogs in each group decreases exponentially. the "all matches" and "mixed" classes have similar connectedness structures in that the numbers of cogs in these classes decay at similar rates. the number of cogs in the "no matches" class drops more rapidly because the less well-conserved or connected sets of orfs that may not be conserved due to protein-coding function are not present at higher stringencies.

screening existing gene predictions for errors
mixed cogs are attractive targets when looking for errors in existing gene predictions. we examined the genomic context and peptide sequence alignments of the mixed cogs of stringency six to explain the inconsistency of gene annotation within these cogs. in cogs where the majority of orfs correspond to annotated genes, the remaining orfs are likely to represent missed genes or pseudogenes. at stringency six there are  <dig> mixed cogs in which the majority of orfs correspond to annotated genes . at this stringency every member of a cog is in a bidirectional best-hit relationship with at least six other orfs in the cog. these cogs contain  <dig> orfs that are not associated with annotated genes. some of the cogs contained multiple orfs that did not correspond to annotated genes and some orfs were members of multiple cogs.

the potential amino acid sequences of  <dig> of these orfs contain regions that have substantial similarity to the multiple-sequence alignment of the annotated genes that are also members of the cog . we judge that these orfs are likely to represent genes missed in current annotations.  <dig> of the  <dig> candidate genes involve instances where there were two orfs with approximately equal length present in two different strands; however the opposite strand had previously been chosen as coding.

in  <dig>  cases comparison of gene lengths to orf lengths indicates that the orfs that are not annotated as genes may be pseudogenes ; most have frameshifts but some have nonsense mutations.  <dig> of these are annotated as pseudogenes in genome reviews  <dig>   <cit> . it is possible that some of the apparent nonsense or frameshift mutations may be due to sequencing errors.

for cogs in which the majority of members do not correspond to annotated genes, the preponderance of evidence suggests that sequence conservation can be better explained by reasons other than protein coding of the orf. at stringency  <dig> there are  <dig> of this type of cog among the organisms we studied, representing  <dig> distinct annotated genes . the presence of a conserved orf of length sufficient to be a potential gene may be explained by the presence of a gene in the opposite strand. this is particularly likely in species such as those of the mollicutes class that do not use uga as a stop codon. in these organisms, the exclusion of taa and tag in the actual coding frame can be associated with a relative shortage of tan codons in the opposite strand, leading to orfs of substantial length on the non-coding strand. this was the case for  <dig> of the  <dig>  and we predict that the previous annotations are erroneous. three of the annotated genes in majority-unannotated cogs overlap regions that appear to encode non-translated rna genes. the constraints of the rna genes may have reduced the probability of occurrence of stop codons in the region, which lead to orfs of sufficient length that they have been annotated as hypothetical genes in previous annotations.

possible pseudogenes as listed in table  <dig> can be re-sequenced to evaluate whether there is in fact an underlying sequencing error. although this could be done on individual regions of a genome, the recent re-sequencing  <cit>  of mycoplasma genitalium strain g- <dig>  when compared to the original sequence  is illustrative. there are no mixed cogs at stringency  <dig> which contain unnannotated orfs from the original m. genitalium sequence, but there are four such cogs at stringency  <dig> . one of these orfs  is highly similar to sequences from  <dig> other organisms. the other orfs contain apparent frameshifts that are resolved in the new sequence.

discussion
peptide sequence similarity as a gene discovery technique
although studies of intrinsic gene prediction report higher accuracies . our method may be more able to pick up genes that may have been horizontally transferred when compared to intrinsic methods.

a different choice of size cutoff for consideration of orfs would affect the accuracy of our method because longer orfs are more likely to represent genes but genes smaller than the cutoff would be excluded. an increase in orf size cutoff would result in an increase in specificity with a corresponding decrease in sensitivity. the fact that we were able to detect some genes that had been missed in prior genome annotations is in part because we used a very small size cutoff for consideration of which orfs may be genes. the newly detected genes we report are disproportionately small .

a comparison of figures 1a and 1b shows that incorporating gene information from other organisms greatly increases the specificity  of similarity-based gene identification, with a much smaller decrease in sensitivity. classification using stringency  <dig> cogs  is highly sensitive but not very specific. increasing stringency to three  causes the largest difference in specificity. the difference in specificity between stringencies two and three is even more pronounced when incorporating gene information from the other organisms.

the two gene prediction systems shown in figure  <dig> are in general most accurate for the small genomes . the high accuracies for mollicutes may be explained by the presence of many members of this class in the set of organisms studied. the genes for escherichia coli strain k <dig> can also be relatively well predicted, perhaps due to the fact that it is so well studied. classification of e. coli genes performs particularly well in the second classification system, when information about annotated genes from other genomes is included. this may be due to the fact that the characteristics of genes of e. coli have been used to find those other genes in other organisms.

limitations of using sequence conservation for gene prediction
genes with little conservation among the studied genomes or which are only present in a few genomes cannot be detected using sequence conservation, leading to false negatives. sequence similarity can be due to reasons other than selection due to protein-coding function. this can lead to false positive gene predictions. sequences that do not encode protein may be similar because: i) they are conserved for other reasons  or ii) because there is insufficient evolutionary distance between a pair of studied species. the latter can be the case for pseudogenes – a region in one genome may contain a gene while the corresponding region in another genome may not actually code for protein but may not have accumulated enough mutations to prevent detection of homology.

examples of gene prediction inconsistencies in cogs of orfs
the orfs in mycoplasma penetrans from  <dig> to  <dig> on the minus strand and in mycoplasma mycoides from  <dig> to  <dig> on the minus strand do not contain annotated genes. they are however members of a cog at stringency  <dig>  in which the majority of orfs  correspond to annotated genes. the annotated members of the cog encode the 50s ribosomal protein l <dig>  the sequence identities from the m. penetrans orf to the annotated genes in the cog range from  <dig> % to  <dig> %. for the m. mycoides orf the range is from  <dig> % to  <dig> %. neither of the orfs have any interruption in coding potential compared to the annotated genes in the cog. it is likely that these orfs contain genes that were missed in the initial annotations of their organisms. the peptides they encode are less than  <dig> amino acids long, and this may account for the fact that the genes had not been previously detected.

the vibrio cholerae orf from  <dig> to  <dig> in the plus strand of chromosome i is present in a cog of stringency  <dig>  in which  <dig> orfs correspond to annotated genes. the v. cholerae orf is only about 60% as long as the annotated genes, and the potential peptide sequence it encodes aligns to the amino terminal region of the annotated genes. examination of the genomic context of the members of this cog reveals a nearby v. cholerae orf from positions  <dig> to  <dig> which could encode peptide which would align the to carboxy terminus of the annotated genes of this cog. this suggests the presence of a frameshift or sequencing error in the region encompassing the two v. cholerae orfs.

the secg gene annotated in m. genitalium , m. penetrans , m. pneumoniae and u. parvum has homologs in m. gallisepticum , m. mobile , m. mycoides and m. pulmonis . the m. genitalium homolog was detected by curators of the genome reviews database . this group of homologs is present in cog id  <dig> in table  <dig>  the m. gallisepticum homolog is identified as a potential gene, but given the annotation "unique hypothetical". the m. mobile and m. mycoides homologs are not identified as genes. in m. pulmonis , the orf homologous to secg  is not identified as a gene, but overlaps the locus mypu_ <dig> which is on the opposite strand. it is likely that this is an error in the existing annotation – that the secg homolog is a real gene and the mypu_ <dig> locus, while being slightly longer, does not actually encode a peptide sequence in the cell.

detecting pseudogenes
several groups have used computational techniques to find pseudogenes in prokaryotes. intrinsic techniques are poorly suited for identifying pseudogenes. pseudogenes may lack characteristics of protein-coding sequence in a particular organism because they have resulted from recent horizontal transfer  <cit>  or because there is a lack of selective pressure to maintain the characteristics. as a result, extrinsic techniques are common when searching for pseudogenes. liu et al.  <cit>  sought pseudogenes using swissprot entries as queries in fastx searches against genome sequences. they used a fixed similarity cutoff score of  <dig>  to define significant matches. the lack of selective pressure and resulting genetic drift that makes it difficult to find pseudogenes by intrinsic methods can also make it difficult to find homology between a pseudogene and the gene from which it was derived in disparate genome sequences. lerat and ochman  <cit>  considered sets of closely related organisms and used thresholds for inferred homology as strict as tblastn e-value < 10- <dig> and protein identity >79%. by using cogs we were able to detect much more distant homology. there were  <dig> cogs of stringency- <dig> that contained at least one best-hit with a blastp e-value >  <dig> .

potential extensions and modifications to the methods of this study
one obvious extension of this study is to apply the strategy described here to more genome sequences. the scalability of the methods described in this study are limited primarily by the initial blastp searches of translations of the orfs. because all pairwise comparisons are performed, this step scales as the square of the number of orfs among the genome sequences studied, which can be approximated by the square of the number of genome sequences. as of june  <dig>  there are  <dig> bacterial and  <dig> archaeal genome sequences published  <cit> , about  <dig>  times the number of genome sequences analyzed here. the similarity search comparison step is time consuming but highly parallel. because each similarity search is independent of the other searches, the process can be carried out among many cpus. new genome sequences can be added to the study incrementally.

one shortcut that could mitigate scaling issues would be to form a standard set of cogs of the various stringencies among only the annotated genes. all of the orfs in a test genome sequence could then be compared to the members of the standard cogs. the annotated genes of the genomes studied here are only  <dig> % of the orfs of  <dig> or more codons, greatly reducing the number of comparisons that would need to be performed. this shortcut has a few drawbacks: i) it will not be possible to detect genes which are not present in enough of the genomes in the standard set  and ii) it will not be possible to find the 'minority-annotated' mixed cogs that can indicate over-prediction of genes.

the varying stringency cogs produced using the techniques of this study could also be used in other analyses. the multiple sequence alignments of cogs could be used to help define which of several potential translational start sites may be used in a given gene. stringency-three cogs which contain members in many organisms have been used to indicate genes which may be essential on account of their pervasiveness. higher stringency cogs show not only that corresponding elements are present in many organisms but also that between most or all of pairs of organisms the elements are best-hit pairs of each other.

relationship to proteomic studies
jaffe et al.  <cit>  revisited the annotation of genes in mycoplasma pneumoniae , incorporating evidence of peptides detected using multi-dimensional chromatography followed by analysis by mass-spectrometry. they detected evidence for  <dig> proteins which could not be associated with annotated genes. one of these  strand) was present in cogs up to stringency  <dig>  two more  strand) were present in cogs of stringency  <dig>  the others were only present in cogs of stringency  <dig>  the jaffe et al. study was aided by the fact that m. pneumoniae has a simple lifestyle and grows in a relatively static natural environment. although some change in m. pneumoniae gene expression is reported in response to heat shock  <cit> , it is thought that most of its genes are expressed constitutively. in organisms with more complex niches or lifestyles that may involve growing in multiple hosts or environments, the shotgun proteomic approach will require exposing the organisms to multiple conditions in order to induce detectable expression of all proteins.

CONCLUSIONS
in this paper, we describe a method that can be used in combination with existing techniques for detecting protein-coding gene sequences in bacterial genomes. our method is extrinsic an individual in that it incorporates pairwise sequence similarities among several genomes.

the methods we describe can also be used to screen existing gene predictions. the "mixed cogs", in which some open reading frames correspond to annotated genes and some do not, are attractive targets for further study. such cogs exist even when requiring best-hit similarity pairings among many organisms, and we list the cogs of this type that exist at stringency six among  <dig> sequenced bacterial strains. the methods we describe can be used to generate hypotheses about the presence of specific genes that may have been missed in existing annotations. such a hypothesis could be evaluated by a targeted search for the expected protein product based on predicted protein characteristics.

