BACKGROUND
protein multiple sequence alignments are widely used to infer conservation of amino acid residues within an evolutionarily related family  <cit> . highly conserved residues tend to correlate with structural and/or functional importance, and accurate identification of such important residues aids in experimental characterization of protein function.

one commonly used sequence conservation measure is the entropy score. in its simplest form, the entropy score for each aligned column in a multiple sequence alignments can be expressed as:

sentropy=h=−∑inaapilog⁡2pi     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgtbwudawgaawcbagaemyzaumaemoba4maemidaqnaemocainaem4ba8maemicaanaemyeakhabeaakiabg2da9iabdieaijabg2da9iabgkhitmaaqahabagaemicaa3aasbaasqaaiabdmgapbqabaaabagaemyaakgabagaemoba42aasbaawqaaiabdggahjabdggahbqabaaaniabgghildgccyggsbabcqggvbwbcqggnbwzdawgaawcbagaegomaidabeaakiabdchawnaabaaaleaacqwgpbqaaeqaaogaaczcaiaaxmaadaqadiqaaiabigdaxagaayjkaiaawmcaaaaa@52b7@

where naa is the number of residue types in the column representing an alignment position, and pi represents the observed frequency of residue type i in the aligned column. other, more complicated, residue conservation measures derived from the entropy score have been developed and used in identifying functionally important residues  <cit> .

in recent years many sophisticated functional site prediction algorithms have been developed . many of these prediction algorithms implicitly or explicitly analyze the amino acid variations in a given position in multiple alignments. the evolutionary trace method analyzes residue variation patterns within and between protein subfamilies from multiple alignments, and maps important residues to protein structure  <cit> . a further development of this method incorporates entropy information for more accurate ranking of residue importance  <cit> . oliveira et al devised entropy-variability plots that can be used to identify structurally and functionally important residues  <cit> . pei et al used the conservation difference between artificial sequence profiles and naturally occurring sequence profiles to detect homology and identify active sites  <cit> . soyer et al used site-specific evolutionary models for predicting functional sites in proteins  <cit> . wang et al used linear models to analyze multiple alignments for mutated viral proteins to identify amino acid positions important for drug resistance  <cit> . chelliah et al identified interaction sites by separating the structural and functional constraints for each position in multiple alignments  <cit> . greaves et al used geometry-based and sequence profile-based calculation for predicting enzyme active sites  <cit> . cheng et al introduced a hybrid method incorporating both sequence conservation and structural stability to predict functional sites  <cit> . the sift server automatically constructs multiple alignments for query sequence and then predicts amino acid substitutions that are likely to affect protein function  <cit> . the consurf server identifies protein functional region by surface mapping of phylogenetic information inferred from multiple alignments  <cit> . the miner server uses phylogenetic motifs from multiple alignments to identify protein functional site regions  <cit> . besides functional site identification, the residue conservation information can also be used to identify residues determining subfamiliy functional specificity  <cit> . the prevalence of these methods suggests that the extraction of conservation information from multiple alignments is important for the correct prediction of functional residues or regions.

RESULTS
rationale
here, we argue that entropy scores that do not incorporate background amino acid frequencies are not theoretically optimal for calculating residue conservation. to demonstrate this, we rewrite the entropy score using a uniform amino acid frequency distribution pu :

h=−∑inaapilog⁡2pi=−∑inaapi−∑inaapilog⁡2pu=−∑inaapilog⁡2−log⁡2pu=−d−log⁡2pu     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqaaeabbaaaaeaacqwgibascqgh9aqpcqghsisldaaewbqaaiabdchawnaabaaaleaacqwgpbqaaeqaaaqaaiabdmgapbqaaiabd6gaunaabaaameaacqwghbqycqwghbqyaeqaaaqdcqghris5aogagiibawmaei4ba8maei4zac2aasbaasqaaiabikdayaqabagccqwgwbacdawgaawcbagaemyaakgabeaaaoqaaiabg2da9iabgkhitmaaqahabagaemicaa3aasbaasqaaiabdmgapbqabaaabagaemyaakgabagaemoba42aasbaawqaaiabdggahjabdggahbqabaaaniabgghildgccqggoaakcyggsbabcqggvbwbcqggnbwzdawgaawcbagaegomaidabeaakiabdchawnaabaaaleaacqwgpbqaaeqaaogaeyoei0iagiibawmaei4ba8maei4zac2aasbaasqaaiabikdayaqabagccqwgwbacdawgaawcbagaemydauhabeaakiabcmcapiabgkhitmaaqahabagaemicaa3aasbaasqaaiabdmgapbqabagccyggsbabcqggvbwbcqggnbwzdawgaawcbagaegomaidabeaakiabdchawnaabaaaleaacqwg1bqdaeqaaaqaaiabdmgapbqaaiabd6gaunaabaaameaacqwghbqycqwghbqyaeqaaaqdcqghris5aagcbagaeyypa0jaeyoei0yaaabcaeaacqwgwbacdawgaawcbagaemyaakgabeaaaeaacqwgpbqaaeaacqwgubgbdawgaaadbagaemyyaemaemyyaegabeaaa0gaeyyeiuoakigbcygasjabc+gavjabcegannaabaaaleaacqaiyagmaeqaaogaeiikagiaemicaa3aasbaasqaaiabdmgapbqabagccqggvawlcqwgwbacdawgaawcbagaemydauhabeaakiabcmcapiabgkhitigbcygasjabc+gavjabcegannaabaaaleaacqaiyagmaeqaaogaemicaa3aasbaasqaaiabdwha1bqabaaakeaacqgh9aqpcqghsislcqwgebarcqggoaakcqwgqbaudawgaawcbagaemyaakgabeaakiabcyha8jabcyha8jabdcfaqnaabaaaleaacqwg1bqdaeqaaogaeiykakiaeyoei0iagiibawmaei4ba8maei4zac2aasbaasqaaiabikdayaqabagccqwgwbacdawgaawcbagaemydauhabeaaaagccawljagaaczcamaabmgabagaegomaidacagloagaayzkaaaaaa@b4b1@

where d is commonly referred to as the relative entropy or kullback-leibler divergence. therefore, the entropy score is numerically identical to the negative relative entropy between the observed amino acid frequency distribution pi and a uniform distribution pu, minus a constant. in statistics, relative entropy arises as the expected logarithm of the likelihood ratio, and it may be used as a measure of the distance between two probability distributions  <cit> . in the case of residue conservation, the higher deviation from the "background" indicates stronger evolutionary constraint, which suggests that this position may perform an important functional role. however, nature does not sample every amino acid equally when creating proteins. therefore, the simple uniform distribution pu above is not optimal as a reference distribution to evaluate functional importance.

we propose that a relative entropy measure incorporating the observed background frequency from protein sequence databases would be a better measure to capture the functional importance of amino acid residues. more specifically, we propose to use the formula:

srelative_entropy=d=∑ipilog⁡2     
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgtbwudawgaawcbagaemocainaemyzaumaemibawmaemyyaemaemidaqnaemyaakmaemodaynaemyzaumaei4xa8laemyzaumaemoba4maemidaqnaemocainaem4ba8maemicaanaemyeakhabeaakiabg2da9iabdseaejabcicaoiabdcfaqnaabaaaleaacqwgpbqaaeqaaogaeiifawnaeiifawnaemiuaa1aasbaasqaaiabdmgapjabdkgaibqabagccqggpaqkcqgh9aqpdaaeqbqaaiabdchawnaabaaaleaacqwgpbqaaeqaaaqaaiabdmgapbqab0gaeyyeiuoakigbcygasjabc+gavjabcegannaabaaaleaacqaiyagmaeqaaogaeiikagiaemicaa3aasbaasqaaiabdmgapbqabagccqggvawlcqwgwbacdawgaawcbagaemyaakmaemoyaigabeaakiabcmcapiaaxmaacawljawaaewaceaacqaizawmaiaawicacaglpaaaaaa@6c17@

where pib can represent the background amino acid frequencies found in naturally occurring protein sequences, or any other arbitrary set of background frequencies. this measure will increase the scores for aligned columns containing "rare" residues, which are often functionally important. to explain this in a more intuitive way, consider two invariant positions that have only cysteines and only serines, respectively. the position with cysteines is more likely to be functional. the entropy measure will assign the same score to the two positions, but the relative entropy measure assigns a higher score to the invariant cysteine position, since cysteine has a much lower background frequency  than serine .

comparative analysis of entropy score and relative entropy score
to investigate whether our proposed relative entropy measure  is more sensitive than the entropy measure  in detecting functional sites, we evaluated the performance of these measures to identify functionally important residues using the thornton  <cit>  and lovell datasets  <cit> . in addition, to investigate how the use of different background frequencies affects the performance of the relative entropy method, we used two sets of frequencies: the general background frequencies observed in nature and the family-specific background frequencies retrieved from the alignments for each query sequence.

for each protein in the datasets, we built multiple alignments and calculated the entropy or relative entropy scores for each residue and evaluated their performance by two criteria: the first criterion is the roc score, which measures how the quantitative scores correlate with true functional sites. the second criterion is the "top  <dig> hits" score, which counts the number of functionally important residues that are in the top  <dig> highest scoring residues. we found that the relative entropy method significantly outperforms the entropy method under both evaluation criteria for both datasets . in addition, using family-specific background frequencies in the relative entropy method has similar performance to using general background frequencies.

to further investigate why the relative entropy methods perform better than the entropy method, we selected an example from the thornton dataset where both the relative entropy methods accurately identify the active sites in their "top  <dig> hits", but where the entropy method fails to do so. this example protein  is an oxidoreductase, and contains three consecutive active sites . we plotted the structures as ribbon representation and colored the residues by their scores from each of the three methods  . we found that the entropy method incorrectly assigns the highest scores to the region near the c-terminal of the protein  and not for the residues in the active site . the frequencies of these amino acids in nature are approximately 5%, 9%, 5%, 6%, 8%, 6%, 7%, 5%, 4% and 6% for asp, leu, pro, glu, ala, thr, ser, ile, gln and val, respectively, but only 2% and 2% for his and cys, respectively. therefore, by applying the relative entropy measure, we down-weighted the c-terminal region and predicted higher scores for the active sites. for the family-specific relative entropy method, the family-specific frequencies are 4% for his and 1% for cys, so the position with the cys has a higher score  than the neighboring his, but all three sites are still among the top  <dig> hits. our analysis indicates that taking into account background frequencies boosts the scores for positions containing rare amino acids and results in improved performance for identification of functionally important positions.

comparative analysis of entropy scores using more accurate frequency estimates
we further investigated whether entropy-based methods could benefit from incorporating more accurate amino acid frequency information. we compiled a hmm model from multiple alignments for each query sequence, and calculated the positional entropy or relative entropy  for each aligned column, similar to a previous study  <cit> . there are two main advantages of using hmm models:  sequences are weighted so that the effects of uneven or biased database sampling are reduced and  frequencies of unobserved amino acids can be estimated through the use of dirichlet mixtures  <cit> .

we evaluated the performance of the hmm-derived entropy and relative entropy methods, as well as several other residue conservation measures, including three al2co-based methods  <cit>  and the scorecons method  <cit> . al2co is a program that implements an entropy-based method , a variance-based method  and a sum-of-pairs method . the al2co_entropy method is similar to our entropy method; the al2co_variance method uses background frequencies that are estimated from the alignment; and the al2co_sop method uses pairwise similarity scores derived from a given amino acid substitution matrix. all three al2co-based methods apply the default independent count weighting scheme  <cit>  to weight sequences in alignments. the scorecons method generates a composite score that takes into account amino acid frequencies, stereochemical diversity, gap penalties, and sequence weighting. this scoring method has been used as a benchmarking score for protein-dna interaction site identification  <cit>  and protein functional site identification  <cit> . we found that when hmm-derived amino acid frequencies are used, the relative entropy method still outperforms the entropy method , and both methods outperform the three al2co-based methods and the scorecons method. among the three al2co-based methods, the al2co_variance method performs the best, which may be partially due to its use of background frequencies. the scorecons method, which does not outperform the hmm-derived entropy method, was originally developed for scoring conservation in protein-dna interaction sites and therefore may not be well-suited for predicting functionally important residues in general. in summary, our analysis suggests that using more accurate amino acid frequency estimates, together with using appropriate background frequencies, results in improved functional site prediction from multiple alignments.

improvements for functional site prediction can occur by increasing the sophistication of the measures considered: the relative entropy method only scores individual positions without considering neighboring residues. a method that analyzes context  may improve performance. the multiple alignments generated by the psi-blast program may not be optimal, and more accurate multiple alignments  may improve performance. in addition, an appropriate treatment of gaps and sequence weights , consideration of phylogenetic relationships among sequences, and analysis of local structural information when available, is also likely to improve performance. we believe that a hybrid method that incorporates the relative entropy method and all the above improvements will have significantly better performance for functional site prediction.

CONCLUSIONS
in conclusion, the use of background frequency information significantly improves entropy-based functional site prediction. this principle has been advocated before , but its use has been very limited: for example, sequence logo is widely used to visually display conserved nucleotide or amino acid sites in sequence motifs; however, many logo generation programs  <cit>  are unable to accept user-supplied background frequencies.  in addition, several programs for editing or annotating multiple alignments exist  <cit> , but they are unable to use background frequencies to calculate relative entropy for each aligned residue.

the use of background information is limited in other areas of bioinformatics as well. for example, many programs are available to identify "functional enrichment" for a list of genes from microarray experiment, but only a few of them are able to accept a user-supplied list of "background genes". dozens of tools are available to identify transcription factor binding sites  or other functional motifs in a given sequence, but few of them are able to take into account the background frequency of predicted tfbs or motifs in the corresponding genome . fold recognition methods are widely used to assign a query sequence to a structural fold, but few considers the relative abundance  of candidate folds in the corresponding proteome. the broader application of appropriate background information in all areas of bioinformatics will lead to more biologically relevant results.

