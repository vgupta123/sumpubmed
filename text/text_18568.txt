BACKGROUND
the gene expression microarray is an assay that measures expression levels of tens of thousands of genes in parallel on a single chip. microarrays can be performed from a very small amount of a biological sample, thus allowing for an experimental design involving many sample groups, repeats, dense time series, and samples collected at high-granularity from various anatomic locations. today, the cost of microarrays is the principal factor limiting the number of samples that can be examined in a particular experiment. in spite of the high cost of microarrays, two thirds of those surveyed by genomeweb said they performed more than  <dig> microarrays and 57% spent more than $ <dig>  on microarrays in  <dig>  <cit> . sixty eight percent of these chips were oligonucleotide arrays, mostly affymetrix chips. with the widespread use of microarrays in basic research and their increasing use in medical diagnostics, biomedical researchers can anticipate lower costs for chips that will lead to more studies utilizing hundreds, if not thousands, of samples. this expansion in sample size will provide researchers with higher resolution insights into biological processes as they are reflected in temporal, spatial, and functional patterns in microarray data sets. to reveal these patterns, several types of pattern recognition and clustering techniques have been developed and applied to microarray data.

a common task in the analysis of large microarray data sets is sample classification based on gene expression patterns. this process can be divided into two steps: class prediction and class discovery. during class prediction samples are assigned to predefined sample classes; whereas class discovery is the process of establishing new sample classes. for example, when gene expression arrays are used for cancer classification, class prediction assigns tumor samples into pre-existing groups of malignancies, while class discovery reveals previously unknown cancer subtypes  <cit> . the newly discovered tumor subtypes may have different clinical patterns, respond differently to certain drugs, and require more or less aggressive surgical and radiological treatment. class discovery may also reveal previously unknown processes in cancer biology and define more specific indications for certain drugs. specific drugs may be used to target newly discovered tumor subtypes, thus facilitating pharmacogenomic drug design and development. these goals will soon become achievable with the results from microarray studies using large samples. class prediction and class discovery using large data sets will require the evaluation, adaptation, and development of robust mathematical, statistical, and computational tools.

several mathematical algorithms and computational methods have been applied to class prediction and class discovery in large gene expression data sets. the methods most frequently used are based on clustering techniques such as hierarchical clustering   <cit> . hc was used for temporal classification in conjunction with fourier analysis to detect genes that correlate with periodic changes in synchronized s. cerevisiae cells  <cit> . hc was also applied to cancer classification, for example breast cancer classification  <cit> . other clustering techniques applied to microarray data are the unstructured k-means clustering  <cit> , cluster affinity search   <cit> , fuzzy c-means clustering  <cit> , and two-way clustering  <cit>  that was used for the analysis of drug-tumor interactions  <cit> . self-organizing maps  is another technique that is particularly well suited for exploratory data analysis. unlike hc, som does not impose a rigid structure to the data  <cit> . the utility of som was demonstrated in leukemia classification using a weighted voting procedure  <cit> . weighted voting classification was also used for predicting chemosensitivity of the nci- <dig> tumor collection  <cit>  and human breast cancers  <cit> . supervised methods, such as fisher's linear discriminant analysis, artificial neural networks , support vector machines , and boosting, have the advantage that the sample classes are usually defined by another "gold standard" method . in supervised classification, the choice of classifiers is frequently based on other considerations, e.g., genes that play a role in the pathomechanism of a certain disease or are expressed in a particular tissue. these "enrichment" methods can improve the prediction strength of a classification and decrease the sample number necessary for developing a prediction model. however they also introduce bias that may lead to overtraining or lack of discovery of unexpected sample classes. one of the supervised methods, support vector machines , has the advantage that it does not make assumptions about the distribution of the data  <cit> . svm was tested on ovarian cancer, leukemia, and colon tumor data sets  <cit>  and was also demonstrated to be useful for multi-class cancer classification  <cit> . artificial neural networks , another machine learning method, was shown to classify small, round blue-cell tumors   <cit> . tree harvesting, a new method of supervised learning was recently applied for gene expression data  <cit> . in contrast to these complex procedures, much simpler classifiers may also perform equally well on some data sets. for example, nearest shrunken centroids were applied to srbct cells and leukemias  <cit> .

dimensionality reduction methods are useful in predicting the underlying true dimensionality of a microarray data set and reduce the number of variables applied as inputs to any of the classification procedures. multi-dimensional scaling , a linear method, was used for classifying alveolar rhabdomyosarcomas  <cit> , cutaneous malignant melanomas  <cit> , and breast cancers  <cit> . principal component analysis , another dimensionality reduction method, was used for visualizing gene expression maps of central nervous system  development  <cit>  and classifying embryonal cns tumors  <cit> . probabilistic pca, a method incorporating biological assumptions in linear factor models, was recently applied to two yeast microarray datasets  <cit> . another method, singular value decomposition , was applied to soft tissue tumors  <cit> , s. cerevisiae cell cycle, and serum-induced fibroblast data sets  <cit> . generalized svd  was developed to extract conserved gene expression patterns comparable between two different organisms  <cit> . all these linear methods are inherently sensitive to outliers, missing values, and non-normal distribution. a variant of svd, robust svd , was recently developed to minimize the effect of these corruptions in the data set  <cit> . sammon mapping, a nonlinear mapping algorithm  <cit>  was incorporated in the r multiv package as well as gene expression data processing and exploratory analysis software, such as engene  <cit> . to address similar issues, isomap  <cit>  a nonlinear technique of dimensionality reduction originally designed for solving classical problems of pattern recognition, such as visual perception and handwriting recognition, was applied recently to discovery biologically relevant structures in cdna microarrays  <cit> .

we have applied isomap to the analysis of both breast cancer microarray data sets and prostate cancer proteomics spectra  <cit>  and showed that it consistently outperformed pca in revealing biologically relevant low-dimensional structures in high-dimensional data sets. nilsson et al. independently demonstrated the utility of isomap using a lymphoma and a lung adenocarcinoma cdna microarray data set  <cit> . we report here the application of isomap to three independent affymetrix genechip® data sets. we show that isomap is capable of discovering temporally, spatially, and functionally relevant structures in gene expression data. to avoid any kind of bias that may be introduced with gene selection or feature enrichment methods, we did not apply any data scrubbing, filtering, or feature enrichment techniques. we also show that isomap can successfully detect biologically relevant structures even in the background noise of tens of thousands of genes present.

RESULTS
spinal cord injury data set
the isomap algorithm was first evaluated on a large data set consisting of  <dig> rat u34a high density oligonucleotide arrays with  <dig>  genes on each array  <cit> . these data were originally collected for a study on spinal cord injury that illustrated the role of cell cycle in trauma-induced neuronal death  <cit> . compared to earlier microarray studies on experimental spinal cord damage, this study applied a lower level spinal cord injury, used individual rat samples rather than pooled spinal cord tissues, evaluated several time points, employed larger affymetrix arrays, and used both sham-injured and naïve controls.

unlike this original study, we do not make the assumption that only those genes "consistently expressed above background" are important for further consideration. the digiovanni et al. study used a stringent inclusion threshold that included only those genes present in at least 40% of all the samples. in addition to this first filter, a second filter was also applied that eliminated genes that did not have a change in expression level of at least two-fold compared to that of the sham controls, which was determined with welch anova t-test. unlike the digiovanni et al. study, our analysis considers all  <dig>  genes, thus eliminating an important source of potential selection bias. we do not use stringent selection criteria at the level of data scrubbing, because these filters may introduce confounding into the data set, which can lead to separation between sample classes based on subjective filtering criteria rather than existing biological phenomena.

one hundred seventy samples were collected from spinal cords of naïve rats, after sham operations, as well as mild, moderate, and severe injuries. in addition to these five severity classes, samples are also classified into one of three locations, such as below, above, and at the position of the spinal cord injury. the third classification category is the time interval from the injury to the sample collection. these time points are:  <dig> min,  <dig> min,  <dig> h,  <dig> h,  <dig> days,  <dig> days,  <dig> days,  <dig> days, and  <dig> days. all the  <dig> samples were subjected to isomap analysis in a completely unsupervised fashion without the a priori knowledge of which classes the sample belongs to. isomap fits a nonlinear manifold on the  <dig> samples. this manifold is used to express sample-to-sample distances as path distances on the surface of the manifold rather than the direct euclidean distance without considering the existence of the manifold. distances are computed for all pairs of the  <dig> samples and subjected to multi-dimensional scaling. the result of this procedure is presented in figure  <dig> in a three dimensional coordinate system where each sphere represents one sample.

the location panel  shows that samples from regions below and above the injury are at the central core of the model. at the same time, samples from the injury itself are displayed in the peripheral lobes of the model. there is no visible separation between the unaffected samples and those originating from locations other than the injury itself.

the time panel  shows a clear-cut time-dependent separation of the samples along the x-axis. the right-side lobe of the model shows samples at  <dig> min,  <dig> h, and  <dig> h after injury. the earlier samples are at the core of the model. conversely, samples from later time points are found at more distal locations in the right-side lobe of the model. this time-pattern is in agreement with di giovanni et al.  <cit>  who found with temporal clustering that the immediate early genes are over-expressed at  <dig> min after spinal cord injury. this is followed by genes associated with inflammatory and oxidative stress plateauing at  <dig> h after injury, as well as cell cycle and neuronal apoptosis-regulating genes at 4– <dig> h. isomap effectively separates this early active phase of post-injury damage from the later phase of regeneration that takes place at  <dig> h –  <dig> days. samples from this later regenerative phase, at time points of  <dig>   <dig>   <dig>   <dig>  and  <dig> days, are displayed in the left-side lobe of the isomap model. during regeneration, the earlier samples are shown in the more peripheral locations and the later samples are closer to the central core of the model. it is noteworthy that some samples are at the peripheral locations of the model even  <dig> days after the injury, which is explained by incomplete regeneration and permanent damage caused by a more severe spinal cord injury as will be demonstrated later. in the time panel, isomap shows the most striking separation between the early and later phases of post-injury events. the right-side lobe of the model contains samples from the early  <dig> min –  <dig> h phase of the post-injury damage. in these samples, the dominant events are the spinal cord injury, the secondary biochemical changes, and the endogenous autodestructive events. on the other hand, the left-side lobe of the isomap model contains samples from the later  <dig> h- <dig> day phase when the neuroprotective and recovery promoting phenomena overcome the earlier autodestructive events.

the severity panel  shows that samples taken after incremental levels of spinal cord injury appear at increasingly distal locations in the isomap model. the sham-operated samples are located in the central core of the model surrounded by a shell of samples from rats with mild spinal cord injury. the most peripheral samples in both lobes of the model are those representing moderate to severe injury. in the right lobe of the model, which represents the  <dig> min –  <dig> h time points, there is no clear separation between moderate injury samples and those with severe injury. unexpectedly, in the left lobe that represents the later time points, the samples with moderate injury are more distal than those with severe injury. although this separation between the moderate and severe injury was not anticipated, the separation between mild and moderate to severe injury is very clear. this separation also answers a question we raised on the time panel. in the left lobe of the model, six samples are visible at  <dig> days after injury. three of these samples are in a cluster that is closer to the periphery and the other three samples are closer to the core of the model. the severity panel clearly shows that the three distal samples are those that underwent moderate injury and the more central three samples are those with only mild injury. this finding is consistent with our interpretation that the left lobe of the model represents the regeneration process. while three rats were able to partially recover from a mild injury after  <dig> days, the other three animals with moderate spinal cord injury did not recover by this time.

for comparison, in addition to isomap analysis we also used hierarchical clustering  <cit>  to cluster the  <dig> samples based on their gene expression patterns . after clustering, the orientation of the branches of the clustering tree is undefined. therefore, we used som to fold the leaves in an order that places the more similar samples closer to each other  <cit> . although hierarchical clustering and som clusters similar samples into well-defined groups, the result is inferior to the isomap model because the tree structure can display only one-dimensional structures, which is inadequate for displaying complex multi-dimensional phenomena such as spinal cord injury. in this experiment, several modalities are present, such as location and severity of the injury and the elapsed time after injury. unlike clustering, isomap analysis discovers these three major modalities and presents the  <dig> samples in a fashion that the underlying biological processes can be interpreted based on these three modalities.

rat multiple tissue gene expression data set
isomap was applied to another data set containing  <dig> samples from  <dig> peripheral tissues and  <dig> brain regions from three common outbred rat strains, such as wistar, wistar kyoto, and sprague dawley. the original study was performed to characterize physiological expression levels in these anatomical locations, to find genes that are important in certain brain regions, and to explain the phenotypic variations between rat strains  <cit> . this data set consists of  <dig> affymetrix rat u34a arrays with  <dig>  genes on each array.

using affymetrix mas <dig>  walker et al. applied several filters on the genes, such as t-test p-value less than  <dig> , at least two-fold change of expression levels, and minimum expression thresholds. additionally, they used rosetta resolver with two filters such as resolver anova p-value less than  <dig>  and at least two-fold change of expression levels. our isomap analysis of this data set used all genes to compute sample-to-sample differences without the use of input filters. although our approach may increase the noise in the data set, it also eliminates any potential source of selection bias. we also avoided using any tissue-enrichment techniques based on a priori knowledge. isomap analysis was carried out in a completely unsupervised fashion.

we were surprised by the ability of isomap to sort several rat tissue samples in a fashion that reflects the topological anatomy of the source tissues . it is apparent in this figure that duplicate samples from the same tissue are displayed at almost identical locations on the isomap map. for example, on the top left side of the figure, duplicates from small intestine, large intestine, and endothelial samples are presented as three dots. these three tissues are displayed close to each other, which is expected since the primary components of all three are epithelial cells. nearby is displayed the kidney, a large part of which is also derived from epithelial cells. below these samples on the mid left part of the figure close to each other are the spleen and thymus samples, two organs of the immune system. on their right is the bone marrow which is the primary site of blood cell generation and therefore functionally related to the spleen and thymus. on the bottom left part of the figure, close to each other are the two major muscle tissues, such as the skeletal muscle and the heart muscle. at the bottom of the figure is the cornea that is an ectodermal tissue close to the brain samples that are also ectodermal in origin and farther away from the endodermal and mesodermal tissues mentioned above. the two endocrine glands of the brain, such as the pineal and pituitary glands, are somewhat separate from the other parts of the brain.

isomap analysis projects the hypothalamic samples onto two different well-defined locations in the isomap model. this separation of the hypothalamus samples may reflect an unequal contribution of the different hypothalamic regions to the four hypothalamic samples and provides an example of class discovery. the hypothalamus has several anatomic regions, one of which is the periventricular hypothalamus that is functionally related to the pituitary as well as to the autonomic areas in the brain stem and the spinal cord. another hypothalamic region, the medial hypothalamus has several connections with the medial division of the amygdala. the third hypothalamic region, the lateral preoptic hypothalamus, has a very complex anatomy with many fibers passing through this region. these subclasses may be explained by spatial or temporal differences. the hypothalamus samples on panel d close to the pituitary samples may originate from samples that are rich in periventricular hypothalamus. on the other hand, samples on panel e close to the amygdala samples may be richer in medial hypothalamus. the separation of the hypothalamus samples into two well defined classes may be explained by not only anatomical but temporal differences. many of the hypothalamic nuclei synthesize several neurotransmitters and hormones, such as corticotropin-releasing hormone  and other related releasing hormones. the levels of these molecules and the activity of particular hypothalamic neurons may vary by time depending on the circadian rhythm, stress, food intake, emotional state, estrus cycle, and other factors. the two hypothalamic subclasses discovered by isomap may be different because of these temporal variations.

most of the amygdala  samples are projected on the isomap map at a location between the cortical regions and the ventral striatum . two samples, on the other hand, are projected at the ventral tegmental area  and the nucleus accumbens . these two amygdala samples are clearly different from the rest of the amygdala samples. this separation is consistent with anatomical dissimilarities between different parts of the amygdala. the largest portion of the amygdala, the basolateral nuclear complex, primarily consists of pyramidal and stellate neurons similar to those in the cerebral cortex. in fact, isomap found most of the amygdala samples in the proximity of the cerebral cortex. another part of the amygdala, the centromedial group, including the central nucleus , is connected to the bed nucleus through fibers called the stria terminalis. although the bed nucleus is anatomically closer to the hypothalamus, it is histologically very similar to the amygdala. this separation demonstrates a potential class discovery by isomap, where the discovered classes are in agreement with anatomically, histologically, and functionally well defined structures within the hypothalamus and the amygdala. some of the hypothalamus and amygdala samples potentially contain more or less tissue from different parts of these anatomically heterogeneous brain structures, which leads to different classifications based on the major constituent.

as a comparison, we analyzed the multiple tissue dataset also with principal component analysis  . unlike isomap, pca was unable to separate the skeletal muscle, kidney, and bone marrow samples from each other . with pca, the thymus and spleen samples overlap the nucleus accumbens samples ; and the small intestine  and large intestine  samples are mapped at a distance from each other. this comparison demonstrates that isomap outperforms pca in mapping the different tissue samples on a 2-dimensional space. this difference in performance of the two methods is also supported by the higher residual variance of the pca model compared to that of the isomap model .

high throughput drug screening data set
the isomap algorithm was also applied to a high throughput drug screening data set  <cit> . the goal of this study was to develop a general approach for identifying gene expression signatures as surrogates for cellular states in high throughput drug screening experiments. particularly, stegmaier et al. screened  <dig>  chemical compounds to identify those capable of inducing terminal differentiation of acute myeloid leukemia  cells. they exposed undifferentiated hl- <dig> samples  to several chemical compounds. the names and abbreviations of the chemical compounds selected for microarray analysis are listed in table  <dig>  in addition to the hl- <dig> samples, stegmaier et al. also included primary acute promyelocytic leukemia , primary patient aml, normal human neutrophil , and normal human monocyte  cells . this gene expression data set consists of  <dig> human genomic u133a affymetrix arrays with  <dig>  transcripts and variants on each array and  <dig> human  <dig> arrays with  <dig>  genes on each array.

stegmaier et al. computed "monocyte and neutrophil scores" based on four parameters: interleukin  <dig> receptor antagonist  and secreted phosphoprotein  <dig>  for the monocyte signature genes and autosomal chronic granulomatous disease protein  and orosomucoid  <dig>  for the neutrophil signature genes. in a supplementary table, these four values were presented for undifferentiated hl- <dig> cells and cells treated with one of  <dig> compounds. in figure 4e, we present a two dimensional isomap model built only from these four parameters. arrows point to the directions of the granulocytic  and monocytic  differentiation. it is noteworthy that our unbiased model, using the expression levels of all the  <dig>  transcripts and variants as input, offers a very similar result to the model using only four signature genes. in both models, the monocytic and granulocytic differentiations are revealed and the various chemical treatments cause similar changes relative to the two main dimensions. in both maps, caff and scop are proximal and represent only a small change compared to the undifferentiated hl- <dig> cells . perg, 5-fu, and 5-fud cause more change and erythro, apo, egfr, phen, atra, and vitd are all mapped in similar relative locations in panel a and e. the only major difference between the two models is in the location of sulma and methyl. however, in both cases these two compounds are mapped close to each other. all these similarities underscore isomap's ability to recognize treatment-related changes in gene expression patterns even when no a priori information is available about which genes are good predictors of a biological process or difference. isomap can detect changes in gene expression signals in the background noise of tens of thousands of other genes.

discussion
in this study, we use three affymetrix high density oligonucleotide microarray data sets to demonstrate isomap's ability to discover relevant structures in an unbiased fashion. in the rat multiple tissue gene expression data set, the structures revealed correspond to the anatomical topology of the source organs and tissues  <cit> . similarly, in the high-throughput drug screening data set, the structures match the monocytic and granulocytic differentiation patterns of myeloid leukemia cells treated with various chemical compounds  <cit> . we also demonstrate with a complex spinal cord injury data set that isomap reveals the three main modalities  of the experimental design  <cit> . this isomap model  is superior to hierarchical clustering  because isomap can model structures of higher dimensionality while hierarchical clustering is limited to the discovery of only one-dimensional structures. clustering is limited in two significant ways; it requires well-separated data and linear correlation. the only relationship clustering can detect is a one-on-one relationship when pair-wise linear comparisons are made  <cit> . isomap is a nonlinear algorithm capable of analyzing microarray data sets that are nonlinear in nature. the sources of these nonlinearities may originate from outliers, missing values, and non-normal distribution; all common events for measurements in biological systems.

in all of our examples, isomap is applied to the expression level values of all of the genes in the microarray data set. to avoid any kind of selection bias, no filtering or data scrubbing procedures were applied. even under these conditions, we demonstrate that isomap is capable of finding the biologically relevant structures within noisy data sets. the experimental noise may come from the measurement error and the variations of expression levels of tens thousands of genes. when isomap is used in production mode, the experimental noise may be decreased by eliminating the genes that are not expressed in the studied tissues and those which have very stable and unchanging expression levels in all of the samples. these procedures will further improve the resolution of the isomap models and facilitate class discovery by isomap. the classification power of isomap may be improved when it is used in combination with enrichment procedures that weight the gene expression levels of different genes dependent on other surrogate information coming from the knowledge of chemical pathways in which the gene plays a role, the tissues in which the gene is expressed  <cit> , and the gene expression patterns that are evolutionarily conserved between different organisms  <cit> .

in addition to isomap, all the three datasets were also analyzed with pca and mds. residual variance curves are presented for all the three datasets. in all instances, pca and isomap outperformed mds and in most instances, isomap worked the best out of the three methods. in the spinal cord injury dataset, pca and isomap give comparable results . however with 3–4-dimensional models, isomap performs better than pca; and at dimensions over  <dig>  pca worked better. in the multiple tissue dataset, isomap outperforms pca in the range of 2– <dig> dimensions . similarly, in the two drug screening datasets, isomap outperforms pca at dimension  <dig> and over  and at every dimension . typically, isomap has a better performance in explaining the variance of microarray data at lower dimensions . this advantage of isomap is eliminated at higher  dimensions. the presented examples show that isomap works well for datasets with several samples that present gradual changes from one another. however, when a few very distinct classes of samples exist then the more classical methods, e.g., pca work better. isomap needs samples to be present along the geodesic surface of the manifold. in our examples, many severity levels of spinal cord injury were considered, as well as multiple tissues and multiple chemical compounds, which was the source of isomap's success. another prerequisite for a successful application of isomap is a large enough number of samples. isomap will become really useful when datasets with hundreds or thousands of microarrays need to be analyzed.

the structures discovered by isomap help to understand biological phenomena underlying these structures. visualization tools of isomap models may be applied as data mining tools for microarray data sets. similar tools were used for modeling co-regulated genes in c. elegans with vxinsight  <cit>  and generating high-resolution temporal models of cns development  <cit> . moreover, isomap is a promising tool of unbiased class discovery because it is performed in a completely unsupervised manner. this is a key advantage of the isomap algorithm considering the limited number of class discovery tools  <cit>  compared to the abundance of class prediction methods. the isomap algorithm is capable of revealing structures in microarray data sets, which may provide insight into underlying biological networks  <cit> .

another application of the isomap algorithm is predicting class membership. we previously demonstrated the use of isomap for class prediction in a breast cancer outcome microarray data set  <cit> . the selection of good classifiers that are robust, insensitive to outliers, medically interpretable, having high generalization power, and based on the smallest possible subset with the maximal discriminatory features  <cit>  is important and should be evaluated for isomap in the future. aclass prediction model using the isomap algorithm does not need to use all the genes in the microarray. somorjai et al. argue that no matter what feature selection approach is used to the microarray data, generally  <dig> or more features are needed for classification  <cit> . in this paper, we show that only four genes are used as input for an isomap model . isomap is a type of dimensionality reduction method and may be evaluated as input to supervised machine learning techniques, such as ann and svm. besides gene expression microarrays, isomap can be used on other types of biological data, such as genomic, proteomic, and metabolomic data sets to reveal low dimensional structures related to diet-genome interactions, genotype-disease associations, and drug-gene-disease relationships.

CONCLUSIONS
isomap, a nonlinear dimensionality reduction algorithm, discovers low-dimensional structures embedded in high-dimensional affymetrix high-density oligonucleotide microarray data sets. these structures correspond to and help to interpret underlying biological phenomena present in these data. our work provides examples of three experiments with temporal, spatial, and functional processes revealed by the isomap algorithm. visualization of isomap models helps to understand these processes and provides means of data mining from gene expression data sets. the low-dimensional models generated by isomap help to reveal new sample classes and are potentially useful for class prediction. in summary, isomap is a promising new algorithm for the unbiased analysis of high-density oligonucleotide microarray data sets.

