BACKGROUND
nitrogen is a fundamental constituent of the bacterial cell, found in dna, rna, proteins and cell wall components, and its assimilation is consequently essential for bacterial growth. in order to cope with varying availability of nitrogen in the environment, bacteria have evolved a variety of mechanisms for the uptake of nitrogen from the environment, and its subsequent incorporation into biomass, all of which are tightly regulated  <cit> . historically, mechanisms described in escherichia coli have served as the model for nitrogen limitation  <cit> . however, more recent studies of two actinomycetes  have shown that the nitrogen control mechanisms in these bacteria not only differ from those in e. coli, but are distinct from each other  <cit> . it is clear that diverse strategies to respond to changes in nitrogen availability have evolved in the prokaryote kingdom.

mycobacterium smegmatis contains the highest number of predicted nitrogen metabolism genes of any sequenced mycobacterial genome, many of which originate in other bacteria and have been acquired by horizontal transfer  <cit> . this fits with its saprophytic lifestyle, and the slow growing, pathogenic mycobacteria have all lost a proportion of their genes for nitrogen uptake and assimilation  <cit> . however the functions of most of these genes have not been verified experimentally and their roles in nitrogen assimilation and metabolism are currently unknown. ammonium is the preferred nitrogen source for m. smegmatis, which contains  <dig> transporters , but the genome also contains all the components necessary to obtain ammonium from other nitrogenous sources such as urea and nitrite. once inside the cell ammonium is converted into glutamate and glutamine, the building blocks of most nitrogen containing compounds.

modulation of gene expression plays a central role in cellular adaptation to environmental changes. gene expression profiles have been obtained for mycobacteria exposed to numerous different stress conditions, including total nutrient starvation  <cit> , but there is no reported global transcriptional analysis of the nitrogen stress response. in e. coli the nitrogen stress response consists of approximately  <dig> genes, mediated by the two-component signal transduction system ntrb/ntrc and regulatory protein nac  <cit> , but this system is not present in the actinomycetes. in s. coelicolor the nitrogen response regulator is the transcriptional activator glnr, which controls at least  <dig> genes  <cit> . m. smegmatis possesses a glnr homologue , with 55% amino acid identity to the s. coelicolor glnr, with  <dig> glnr binding sites during nitrogen limitation controlling the expression of over  <dig> genes  <cit> . therefore, in order to expand our knowledge of the genes involved in nitrogen metabolism and stress in mycobacteria, a global transcriptional profile of the nitrogen stress response is required.

insights into the metabolic response of interest beyond those available through analysis of individual genes can be extracted from transcriptomic analyses through system level approaches. enrichment analyses based on fisher’s exact test  <cit>  or gene set enrichment analysis  <cit>  are often used to provide such system level insights, but are limited to predefined gene sets and pathways. more sophisticated methods for the analysis of metabolic changes, such as differential producibility analysis   <cit>  and e-flux  <cit>  are based on flux balance analysis  <cit>  and hence depend on a high quality, curated genome scale metabolic network, which is not currently available for m. smegmatis. however there is a freely usable online pipeline  for the automatic production of draft quality metabolic models for any prokaryote with a complete genome sequence. we therefore used ambient  <cit> , which takes advantage of the network structure of metabolism to find non-predefined metabolic pathways affected by nitrogen limitation. since ambient does not use fba, its results are not strongly dependent on the quality of the metabolic network, and the metabolic model produced by model seed for m. smegmatis can be used. ambient was applied in this study to explore the system level adaptation of m. smegmatis to nitrogen starvation. this analysis revealed several key features of the metabolic response of m. smegmatis to nitrogen stress, including areas of metabolism not identified by kegg enrichment analysis.

RESULTS
defining nitrogen stress conditions
optimisation of the nitrogen stress conditions used in this study has been described  <cit> . briefly, m. smegmatis was grown for 24 hours in medium containing either 1 mm ammonium sulphate  or 30 mm ammonium sulphate . ammonium was completely depleted from the 1 mm ammonium sulphate medium between  <dig> and 13 hours of growth, coincident with a reduction in bacterial growth rate . to determine when the nitrogen stress response occurred, transcript levels of genes known to be induced by nitrogen limitation in m. smegmatis <cit>  were monitored over  <dig> – 16 hours. significant induction of the ammonium transporters , gogat small sub-unit , adenyl transferase , glutamine synthetase , and pii  transcript levels were observed once ammonium levels in the external medium were completely depleted after 12 hours .

expression profiling of the nitrogen stress response
rna samples  were taken at four time points  and applied to a microarray to follow the depletion and eventual run out of nitrogen. fully annotated data have been deposited in bμg@sbase  and also arrayexpress , and can be viewed in additional file  <dig>  the data was analysed to determine which genes were significantly differentially expressed at each time point during nitrogen limitation  compared to nitrogen replete . genes were considered to be significantly differentially expressed if their expression changed > 2-fold with a false discovery rate  corrected p-value < <dig> , compared to their expression at 10 hours. a complete list of differentially expressed genes identified by these criteria can be viewed in additional file  <dig>  consistent with the qrt-pcr analysis, there was no significant changes in genes expression until the nitrogen run out; only six genes were differentially expressed  one hour before nitrogen run out . at nitrogen run out over  <dig> genes  changed expression levels by greater than 2-fold:  <dig> genes up-regulated and  <dig> genes down-regulated , with  <dig> genes up-regulated and  <dig> genes down-regulated at 13 hours . although it is convenient to apply a 2-fold cut off for comparison to other published stress responses, the application of an arbitrary cut off can mask less dramatic changes in gene expression and metabolism that may contribute to a coordinated response at the level of the metabolic pathway. therefore, the ambient and kegg analyses used in this study compared the expression levels of all  <dig> genes at 12 hours, during nitrogen stress, compared to nitrogen-replete conditions at 10 hours.

metabolic analysis of the nitrogen stress response
a draft-quality metabolic network for m. smegmatis was generated using the model seed, a webserver for the computerized generation of genome-scale metabolic models  <cit> . regions of this network that were affected by the transcriptional response to nitrogen limitation were identified using ambient  <cit> . these regions correspond to connected metabolic subnetworks that are coherently upregulated or repressed by the measured changes in gene expression and are unbiased by a priori pathway definitions. ambient identified  <dig> candidate up- and down-regulated active modules in the metabolic network, involving a total of  <dig> enzyme-encoding genes  that showed a co-ordinated response to nitrogen limitation . of the  <dig> modules found by ambient, all of the up-regulated modules were significant with a q-value  of <  <dig>  and six down-regulated modules were significant.

up- and down-regulated modules found using ambient in nitrogen stress, in decreasing order of score, indicating the number of reactions and metabolites present in each. scores are calculated by ambient, taking into account the logarithm of the fold-change of the genes associated with each reaction and the connectivity in the metabolic network of each metabolite in the module. the number of genes associated with these reactions according to the model seed m. smegmatis model is also shown. functional assignments are based on manual inspection of the exact function of the member reactions of the modules. diagrams for each module are available as additional files  <dig>  and  <dig> , except for u <dig>  u <dig>  u <dig> and u <dig>  which are combined in uhp.

ambient analysis of metabolism is system wide and as therefore attempts to take into account reactions for which there are no data. due in part to the draft nature of the metabolic model used, and in part to the more general problem of known reactions without known associated enzymes, many reactions could not be assigned scores from the data available. for all reactions without an assigned score, ambient assigned the median reaction score. this approach has been found to be very useful in finding coordinated metabolic changes using ambient, but occasionally it produces modules in which none of the reactions have associated genes with expression change data. in this case, where all of the reactions have been assigned the default median expression score value there is no experimental evidence indicating how that module has responded to the environmental change of interest. ambient found one such down-regulated module that was excluded from further analysis.

the q-value, number of reactions, number of genes and areas of metabolism identified during nitrogen stress are summarised in table  <dig>  all significantly changed network module diagrams, along with a list of genes in each module, can be viewed in additional files  <dig>   <dig> and  <dig> 

reaction directionality
in this work, several areas of metabolism have been highlighted as being significantly affected by transcriptional changes in response to nitrogen starvation. however, due to the unavailability of a high quality curated metabolic model for m. smegmatis it was not possible to apply fba-based analysis  to this bacterium, flux directions or direction changes for any reaction in the metabolic network are difficult to predict. hence here we make no definitive claims about flux changes, except where their directions are obvious from the identity or context of the relevant reaction.

up-regulated active modules
although a general decrease in metabolic activity is expected due to the observed reduction in growth rate upon nitrogen limitation , there were many significant increases in metabolic activity, which are likely to be directly related to nitrogen availability. it can be seen from table  <dig> that twenty active modules involved in distinct metabolic functions were up-regulated when the cells are exposed to nitrogen stress, with another six, the majority of which are associated with the reduced growth rate, down-regulated.

nitrogen metabolism: uptake, assimilation and scavenging
ambient analysis showed that  <dig> of the top  <dig> modules significantly induced in nitrogen stress are involved in nitrogen uptake, scavenging and assimilation, highlighting these reactions as important survival mechanisms. soil is an extremely rich source of inorganic and organic nitrogen and it appears that when nitrogen is limited, m. smegmatis induces a variety of scavenging pathways to utilise other available nitrogen sources in the environment and compete for resources. to assess how the modules identified are interrelated, modules were extended to include all metabolites connected to each member reaction of those modules. the resulting network was plotted and it was seen that many modules were linked by various metabolites. additional file  <dig> shows the largest connected component of this subnetwork. in s <dig>  modules members are coloured the same and it can be seen that many of the modules found are closely associated, where substrates  of reactions in one module are substrates  of reactions in another, especially around ammonium. all of the uptake and scavenging pathways induced produce ammonium as the final breakdown product, which is subsequently assimilated into cellular biosynthetic donors.

nitrate/nitrite uptake and assimilation  is the metabolic module most significantly up-regulated in nitrogen stress . nitrates and nitrites are available in the soil as they are major constituents of organic waste material, and two nitrate/nitrite transporters  are up-regulated upon nitrogen limitation. once inside the cell, nitrate is converted into nitrite by nitrate reductase , narh, nari, narj, msmeg <dig> ), then further broken down by nitrite reductase  into ammonium. both reductase enzymes require the presence of an electron acceptor  for activity, with the menaquinol reaction up-regulated; preferential use of menaquinol in e. coli is associated with anaerobic growth  <cit> , and may be a result of the decreased growth rate seen here. interestingly, msmeg <dig>  is also included in this network module; the predicted reaction of this enzyme is the conversion of nitric oxide into nitrate, identifying another potential source of environmental nitrogen.

pyrimidines, purines, and ethanolamine are present in soil, originating from other microbes. cytosine and uracil uptake pathways, and deaminases to breakdown cytosine to uracil and ammonium  are up-regulated, as is ethanolamine utilization . the fate of the uracil is unclear, since the module utilising it is down regulated . however the enzymatic conversion of uracil into barbituric acid, which can then be metabolised into urea and malonic acid, has been described for mycobacteria  <cit> .

metabolism of arginine/ornithine , histidine , ammonium transport , and thiamine transport  are all shown in additional file  <dig>  ammonium is the preferred nitrogen source in most bacteria and m. smegmatis contains  <dig> ammonium transporters, suggesting that it is also the preferred nitrogen source in this species. amt <dig>  was up-regulated 133-fold, amta  was up-regulated 144–fold and amtb  was up-regulated 16-fold. amtb shows basal levels of transcription when nitrogen is present, whereas the other  <dig> transporters are only transcribed during stress. msmeg <dig> is missing from model seed, but the ammonium transport module  contains the others genes.

the ability to continue growing in the apparent absence of nitrogen  in vitro is an interesting observation. a huge environmental nitrogen source scavenging response is initiated, but nitrogen sources such as urea, nitrate, and ethanolamine are absent from the growth medium. metabolically labelling the nitrogen source and monitoring its utilisation could be used to investigate the pathways. it is possible that mycobacteria break down internal stores of nitrogen, such as dna, protein or cell wall components. this reduction in growth rate may be a general stress response or a pre-requisite to allow the re-allocation of cellular components into nitrogen metabolism. investigations to study this are in progress.

hydrogen peroxide metabolism
four small modules  linked to hydrogen peroxide metabolism show up in the top  <dig> modules list , each containing one reaction and one metabolite. these were combined into the single module uhp  with hydrogen peroxide to connect them, and scored by ambient, at  <dig>  , which would put it second  in the list of up-regulated modules . ambient did not initially pick up this module because hydrogen peroxide is highly connected as the substrate/product of  <dig> different reactions in the metabolic network, and is therefore penalised by the ambient scoring system. up-regulation of peroxide metabolism is a surprising finding, suggesting that pathways normally associated with oxidative stress protection are activated in nitrogen stress. detoxification may form part of a general response to stress with the cell priming itself for survival in harsh environments. however, the most highly up-regulated gene in nitrogen stress  is up-regulated over  <dig> fold, and releases hydrogen peroxide during the breakdown of primary amines into ammonia. if transcript levels translate into enzyme activity then this could explain the observed oxidative stress response identified by ambient, as the cell has to detoxify the ros. the metabolic model generated by model seed does not contain the reactions catalysed by ahpc and ahpd, which are therefore absent from the module although they are both up-regulated at least  <dig> fold  and so could protect the cell from the toxic effects of hydrogen peroxide produced in this metabolic reaction. this highlights a limitation of ambient that can be overcome by studying individual gene expression data directly where gene function is known but the annotation is lacking in the metabolic model generated by model seed.

other modules
another module induced in nitrogen stress is involved in cation transport , with cobalt/zinc/cadmium resistance protein . potassium transport in module u <dig> involves the reaction catalysed by msmeg <dig>  a putative trkb protein. this protein is involved in membrane potential homeostasis and antibiotic resistance  <cit> . this system may prime the bacteria for stress survival by ensuring membrane homeostasis is maintained, or it could be required for the large scavenging response and increased membrane transport observed. inactivation of this gene led to reduced osmotic stress survival  <cit> , but the ability of this mutant to survive nitrogen stress is unknown.

the remaining up-regulated modules are involved in processes induced when m. smegmatis growth rate was reduced in conditions of low energy and hypoxia  <cit> ; adaptation to low growth rate induced the expression of alternative primary dehydrogenases and hydrogenases for energy generation and unique pathways for scavenging carbon. we also observed the up-regulation of a number of modules involved in carbon metabolism/degradation , and fatty acid metabolism , which may also be a consequence of the reduced growth rate observed under nitrogen limitation. module u <dig> highlights a limitation in the genome annotations in the model seed generated metabolic model, incorrectly annotating the gene as a cyanate hydrolyase, converting cyanate to amino-formic acid, whereas the alternative annotation in other databases is a cyanate hydratase catalysing the degradation of cyanate to ammonia and carbamate. this second annotation would seem to make more biological sense.

down-regulated active modules
the decrease in growth rate imposed by nitrogen stress has a general impact on metabolism that is reflected in the large number of reactions  associated with down-regulated genes. it is worth noting that those modules found to be significantly down-regulated at the 5% level show a coordinated response beyond that expected by random chance, implying that they are relevant to the way in which m. smegmatis balances its metabolism in response to a single stress. module d <dig> is the largest metabolic module significantly affected by nitrogen limitation that was identified by ambient. it includes parts of metabolism directly related to growth, such as lps biosynthesis , central carbon metabolism , rna biosynthesis , and dna biosynthesis , with a total of  <dig> reactions and  <dig> metabolites . in addition to the metabolites identified in the module, these reactions link to many other metabolites throughout the metabolic network, totalling between them  <dig> metabolites . however, protein synthesis and amino acid biosynthesis do not appear to be affected by the growth change, or at least they are not transcriptionally controlled under these conditions.

module d <dig> illustrates the capability of ambient to identify modules that contain metabolic reactions for which there is no gene annotation information. there are  <dig> reactions in d <dig> that do not have gene assignments in the metabolic model used in this work. these include the glucosyl transferase reactions converting udp-alpha-d-glucose to udp as well as the ‘dna synthesis’ reaction, which represents the conversion of nucleic acids into the dna molecule as part of normal bacterial growth. two modules related to fatty acid metabolism are down-regulated , while two  are up-regulated, suggesting there may be a redistribution of resources as a consequence of the reduced growth rate and nitrogen stress. the apparently very highly connected negative metabolic response to nitrogen starvation, as opposed to the more fragmented up-regulated response, is probably due to the large number of down-regulated reactions, rather than representing a more coherent down-regulated response.

comparison of modules identified by ambient with those found by kegg pathway enrichment
a variety of methods have been used to assess the enrichment of pre-defined sets of genes with respect to differential expression. as a comparison to ambient, we applied fisher’s exact test to study the enrichment of kegg pathways for up- and down-regulated genes . several pathways were found to be down-regulated, but only two pathways  were significantly up-regulated, highlighting the potential limitations of this type of analysis. the nitrogen metabolism kegg pathway was not identified as significantly induced at a false discovery rate of 5%. up-regulated amino acid metabolism may indicate that the stressed cells are altering their amino acid usage, or scavenging nitrogen from cellular sources. down-regulated kegg pathways are presumed to be a general response to the reduced growth rate, with some pathways  overlapping with the ambient analysis.

kegg enrichment analysis on all de genes at  <dig> vs 12 hours. pathways shown are significant under a one-tailed fisher’s exact test at a fdr of 5%. *size denotes number of genes on the microarray mapped to that kegg pathway.

in this study, the standard enrichment analysis failed to give an adequately specific and flexible picture of general metabolic activity. its reliance on pre-defined pathways  means that it operates at a more coarse-grained level of metabolism, which risks missing species-specific pathways, cross-pathway modules and small modules comprising only a few reactions. ambient addresses this problem by allowing modules to form between any connected reactions, not just those within a predefined set of reactions. additionally, ambient takes advantage of the information on metabolite connectivity available in the metabolic network, favouring metabolites with lower connectivity as pathway members but also allowing those with higher connectivity where it is justified by the data. further, ambient can take into account reactions with unmeasured genes and gene measurement errors to provide a robust approach to finding specific areas of metabolism affected by particular environmental changes. in this study, an additional benefit of ambient over kegg is that the metabolic model used includes many additional genes and gene-reaction relationships. kegg gives an overview of the changes occurring due to nitrogen run-out but cannot  give specific details of the sets of adjacent reactions affected in this environment. by looking at this finer level ambient has shown co-ordinated up-regulation of reactions involved in nitrogen scavenging and metabolism – missed in the coarser grained kegg pathway analysis. the most notable example of this is in module u <dig>  ethanolamine transport and assimilation, in which  <dig> genes out of  <dig> are not present in kegg. there are also several genes identified by the active modules approach that are not annotated in the m. smegmatis genome  such as gamma-glutamyl phosphate reductase  in u <dig> and aconitate hydratase  and 2-methylisocitrate dehydratase  in u <dig>  or that have different annotations compared to smegmalist, for example msmeg <dig> is probably more correctly annotated as an amidinotransferase, rather than a dimethylarginase. these discrepancies are probably due to an out of date annotation on the ncbi website from which the msmeg numbers are acquired, combined with model seed’s own annotation using the rast server. ambient has some drawbacks, such as finding modules without any experimental evidence to support them, but these are trivial to identify and exclude from further analysis. overall the benefits of ambient far out-weigh the limitations, with organism-specific databases and biocyc used to supplement model seed where appropriate.

CONCLUSIONS
the ability to sense and respond to changing environments is crucial for the survival of bacteria, and modulation of gene expression is central to this adaptation; however, to date a study of the global gene expression response to nitrogen limitation in mycobacteria has not been performed. in order to address this shortcoming, we studied the global genetic response to nitrogen stress in m. smegmatis by combining global transcriptional profiling with a network-based approach to search for patterns in gene transcriptional changes in the metabolic network. these combined approaches identified over  <dig> genes and several areas of metabolism that changed significantly in response to nitrogen stress. this included reduced growth rate, lower energy demand in the cell, reduced metabolic rates, carbon catabolism and biosynthesis of rna, protein and lipid, with increased nitrogen uptake and assimilation. growth rate reduction in conjunction with scavenging nitrogen from other sources could represent an important mechanism by which mycobacteria survive nutrient limitation until more favourable conditions arise. the ambient approach provided much more detailed insights than the standard kegg enrichment analysis, proving to be a valuable tool to translate gene expression changes into metabolic responses in the absence of a high quality curated metabolic model, and producing meaningful insights into mycobacterial nitrogen stress survival strategies.

