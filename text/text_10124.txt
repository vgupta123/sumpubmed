BACKGROUND
the mechanisms underlying the evolution of convergent phenotypes in independent natural populations pose long-standing questions in evolutionary biology. the extent to which convergent or parallel changes draw on preexisting genetic variation in ancestral populations versus new mutations is still debated  <cit> . the molecular and genetic changes that underly most convergences are still unknown.

convergence is also of interest to evolutionists because it provides an element of replication to evolutionary studies that is often otherwise absent. replication allows for the powerful testing of evolutionary hypotheses. cave-dwelling organisms provide the best known examples of convergences, sharing similar phenotypes such as loss of eyes and pigmentation across diverse taxonomic groups  <cit> .

the mexican blind cavefish  is nearly unique among cave animals because the cave forms have closely related surface conspecifics and the two forms are fully interfertile  <cit> . the ability to hybridize the cave and surface forms permits the genetic analysis of the factors involved in cave adaptation. there are  <dig> known cave populations of this species dispersed over three geographically distinct areas, thus this group may contain multiple examples of convergence  <cit> .

each population inhabits a food and light restricted cave environment. members of these populations exhibit numerous cave-related evolutionary traits, including reduction in pigment and eye size, hypertrophy of non-optic sensory organs, increased condition factor, and robust patterns of reduced sleep; presumably all are evolved in response to perpetual darkness and reduced food availability  <cit> .

thus, the cave colonizations of astyanax populations provide replicates of an excellent "natural experiment" which allows us to address important evolutionary questions, including the extent to which evolutionary changes in morphology, behavior and physiology are driven by selection versus drift  <cit> . these two alternatives can be distinguished in a number of ways in this system, but any determination will require an understanding of the underlying demography of the populations as well as a clarification of the relationships among them.

previous phylogeographic studies of astyanax cavefish, using microsatellite and mtdna, showed that the cave populations are derived from at least two different surface stocks that inhabited the sierra de el abra and nearby regions in succession  <cit> . the estimates from mtdna suggest that these two groups diverged about  <dig>  mya  <cit> . surface forms of the older stock originally inhabited the rivers in the el abra region and were the likely ancestors of a series of cave populations, which we designate as "old." subsequently, the surface fish of the old stock went locally extinct. the region was then invaded by another stock of a. mexicanus, which gave rise to the current surface populations and a second set of cave populations we designate as "new"   <cit> .

while previous studies revealed that the extant cave populations were derived from a minimum of two ancestral stocks, there may have been more. in addition, the question of how many independent invasions of the underground led to the present day astyanax cave fauna remains unanswered. to understand the demographic component of the phenotypic evolution we studied cave populations from the full extent of their known distribution. we give a detailed description of genetic differentiation in multiple cave populations and their relatedness with surface morphs, and estimate effective population sizes and the rates of gene flow among select populations based on multiple independent markers.

methods
sampling
all fish specimens were collected in march  <dig> and preserved in 70% ethanol. a total of  <dig> astyanax samples were taken from  <dig> cave and  <dig> surface locations. the cave populations sampled can be divided into three geographically distinct regions, which span the full geographic range of the cave forms. the first is the sierra de el abra cave cluster, which is the most extensive of the regions. to its west is the second region, micos, on the western slope of the sierra de colmena and finally, to the north of the el abra, is the sierra de guatemala region.

the el abra cave cluster is represented in our study by eight caves : pachón, yerbaniz, japones, arroyo, tinaja, curva, toro, and chica, respectively. in the sierra de guatemala we sampled two caves, molino  and caballo moro  and in the micos area we sampled one of three closely clustered caves . an overview of the geographical distribution of the sampling area of cave and surface locations is presented in figure 1and the locality abbreviations are shown in table  <dig> 

n = sample size per population; n = mean sample size over all loci; p = proportion of polymorphic loci; a = mean number of alleles per locus; ar = mean number of alleles standardized to the smallest sample. he = unbiased expected heterozygosity standardized according to the *he) formula; ho = observed heterozygosity, lat is the latitude  and long is the longitude .

dna extraction and genotyping were done according to protas et al. . all samples were profiled at  <dig> microsatellite markers with primers previously developed for qtl studies  <cit> . the forward primer of each pair was labeled at the 5' end with a fluorescent dye  and microsatellite amplification products were visualized on an abi  <dig> automated dna sequencer. microsatellite markers were optimized for the allelic range and multiplexed. allele sizes were scored using v <dig>  . we used unlinked markers selected from independent linkage groups, or markers so distant as to assort independently if within the same linkage group  <cit> . in addition, all  <dig> of the markers  were chosen such that they were outside the previously identified qtl regions  <cit> .

the database was optimized for analysis using the coalescent-based program migrate-n  <dig> . <dig>   <cit> . the accuracy of estimates based on the coalescent approach depends more on number of independent loci than on sample size  <cit> . thus, our choice of  <dig> independently assorting loci, biased towards neutrality, maximized the amount of information per unit effort we could extract from the analyses. furthermore, parameter estimates from migrate-n  <dig> . <dig> are uninfluenced by missing data. therefore, we examined all genemapper calls by hand to verify their validity. amplifications that were too weak to resolve the peaks or had extra peaks were reamplified and rerun to resolve the problem. any remaining unresolved were treated as missing data. the overall data set has approximately 20% missing data, but gives unbiased estimates of parameters based on migrate-n  <dig> . <dig>  in order to check for the existence of null alleles, and to evaluate their impact on the estimation of genetic differentiation we used the program micro-checker v <dig>   <cit> .

genetic diversity
we calculated observed  and unbiased expected  heterozygosities  <cit> , number of alleles, and the number of alleles standardized for the smallest sample size for single populations and for the geographic groups. these descriptive statistics were performed in genepop v  <dig>   <cit>  and microsatellite analyzer   <cit> . deviations from hwe were estimated using both the exact test and the fis statistic estimations, using markov chain monte carlo  runs for  <dig> batches, each of  <dig> iterations, with the first  <dig> iterations discarded before sampling  <cit> . whenever multiple testing was performed, probability values were corrected using standard bonferroni corrections  <cit> .

population structure analysis and differentiation
the program structure  <dig> . <dig>  <cit>  was used to infer historical lineages through clustering of similar genotypes. the admixture model of structure and the option of correlated allele frequencies between populations were used. the correct number of clusters  was determined by testing k values from  <dig> to  <dig> and performing  <dig> repeats for each k. the burn-in period consisted of  <dig> ×  <dig> iterations followed by  <dig> ×  <dig> mcmc repeats. finally, estimated log probabilities of data pr  for each value of k were evaluated by calculating Δk, the rate of change in the log probability of data between successive k values  <cit> . we also estimated population structure independently with structurama  <cit>  in order to test the structure inferences.

while these clustering methods can be quite powerful, particularly when there is a high divergence between populations  <cit> , they often make explicit assumptions of demographic history and sometimes are difficult to interpret without background biological information. thus, we complemented the bayesian analysis using other methods to more directly estimate relationships among populations. the proportions of shared alleles between populations were calculated in the r package adegenet  <dig> - <dig> using the propshared function  <cit>  where the average proportions of shared alleles among and within populations are computed over all possible combinations of individuals sampled. the distance matrix based on the proportion of shared alleles was then transformed into a matrix of euclidean distances using the quasieuclid function.

private allele estimates and allele richness were calculated, grouping the independent geographical regions obtained by clustering methods. in order to estimate rarified allelic richness and private rarified allelic richness, the rarified method in hp-rare  <cit>  was used to control for the correlation between observed allelic diversity and sample size  <cit> . the alleles were rarified to a sample size of  <dig>  the smallest sample size of our population groups.

in order to estimate the variance between the groups of populations, pooled sample structuring was estimated using analysis of molecular variance   <cit>  and  <dig>  permutations implemented in arlequin v  <dig> . <dig>   <cit> . missing data as observed in our study could influence amova results. thus, locus-by-locus amova was used to adjust the sample sizes for each locus and the point estimators of variance components to estimate f-statistics more accurately  <cit> . influences of long-term separation and genetic drift were measured by comparative methods of allelic frequency tests for all population combinations using fst pairwise estimates  <cit>  as implemented in microsatellite analyser   <cit> .

migration patterns between populations
the coalescence-based program migrate-n  <dig> . <dig>   <cit>  was used to test for and estimate gene flow between populations. three migration models were evaluated:  a full model with two population sizes and two migration rates ;  a model with two population sizes and one migration rate ;  a model with two population sizes and one migration rate .

migrate-n  <dig> . <dig>  <cit>  also estimated the mutation-scaled effective population size Θ = 4neμ, where ne is the effective population size and μ is the mutation rate per generation per locus, as well as mutation-scaled migration rates m = m/μ, where m is the immigration rate per generation among populations. the model comparison was done using bayes factors that need the accurate calculation of marginal likelihoods. these likelihoods were calculated using thermodynamic integration in migrate-n  <dig> . <dig>  <cit>  .

mantel test
we tested for isolation by distance among populations and sample locations comparing genetic distance ) versus straight line geographic distance by application of the mantel test as implemented in genalex  <cit>  .

eye size measurements
in order to test whether variation in eye rudiment size was correlated with genotype in the caves with phenotypically mixed populations, we analyzed digital images of individuals from three cave populations , n <dig>  and o <dig> . photos were taken in the lab using a digital camera with the fish placed on a cartesian coordinate grid. measurements were made using imagej . in order to correct for individual size differences, relative eye size was standardized as a proportion of standard body length  <cit> .

RESULTS
genetic diversity
we calculated descriptive statistics using  <dig> unlinked microsatellite markers. the number of alleles and proportions of polymorphic loci were generally higher in surface than in cave populations, although there was considerable variability among populations . genetic variability was significantly lower in the cave populations than in the surface . average allelic number  ranged from  <dig>  ±  <dig>  in the guatemala region  and  <dig>  ±  <dig>  in the el abra , to a high of  <dig>  ±  <dig>  in the surface populations. surface ar was significantly greater than ar in the guatemala and in the el abra . the micos cave population  had an intermediate average number of alleles per locus ; previous studies have shown this population to contain both cave and surface-dwelling phenotypes  <cit> . we also detected monomorphic loci , which shared the same alleles among el abra cave populations . unbiased expected heterozygosities  were also higher and significantly different  in surface populations than in the el abra  or guatemala  populations, while the micos population  exhibited intermediate heterozygosities of  <dig>  .

genotypic frequencies
we tested all the loci used in the study for the presence of non-amplifying alleles  as described in micro-checker v <dig>  . this method is mostly based on significant heterozygote deficits relative to hwe . however biological factors such as wahlund effect or inbreeding might be easily misconstrued as evidence for null alleles . null alleles seem to be present mostly in the micos and chica populations . if, however, null alleles were the cause of the lack of heterozygotes, we would expect them to be equally represented in all the other populations, as well as locus-specific; this we did not observe. thus, loci out of hwe owing to heterozygous deficit seem to be caused not by a technical artifact such as null alleles, but rather by population genetic phenomena. only one locus  was out of hwe in many populations  . thus, data were analyzed both including and excluding this locus. this made no difference, so the locus was retained.

we performed  <dig> tests  and detected  <dig> significant departures from hwe . most of the significant loci showed heterozygote deficiency characterized by a positive fis value. heterozygote excess was detected in a few populations, mostly surface, for five loci  . populations previously described in the literature  <cit> , as phenotypically mixed, o <dig> and n <dig>  presented significant deviations from hwe at numerous loci:  <dig> and  <dig> out of  <dig> loci scored, respectively . presumably, this reflects population subdivision. the other cave populations exhibited only small numbers of loci out of hwe and these differed from one population to the next . one locus  was out of hwe in many populations  , which may reflect the presence of null alleles at this locus.

population structure analysis and differentiation
as a starting point to infer the relationships among populations we used the clustering algorithm implemented in the program structure  <cit> . we explored different numbers of populations k to uncover hierarchical population structure . the clear distinction among the two groups when k =  <dig> is consistent with the hypothesis that all of the populations we studied originated from two stocks: a "new" stock including present-day surface-forms and the "new" cave populations from the micos  and guatemala regions , and an "old" stock including the el abra cave populations  and their locally extinct progenitors  <cit> . further structuring represents divergence of o <dig> from the other el abra populations at k =  <dig>  the more recent divergence between the surface populations  and the new cave populations  at k =  <dig>  and the separate origins of the new cave populations at k =  <dig>  optimal k  <cit>  estimated the most likely number of populations at k =  <dig> . we performed a structurama analysis, which estimated the same value of k =  <dig> .

these five independent population groups are: 1) el abra caves , 2) el abra cave mixed population , 3) the new cave populations to the north in the guatemala region , 4) the new cave mixed population in the southwest micos region  and 5) the surface populations . the structure analysis also revealed that four of the cave populations  contained alleles from surface populations at several loci while the surface populations showed a smaller number of the alleles from the caves.

we further tested the genetic distances among populations using the metric of shared alleles. figure 3a illustrates that the entire el abra cluster is the furthest away from the cluster of the "new" caves . genetically, one el abra cave population  was equidistant from the "old" and "new" lineages, while the micos  cave population shared the most alleles with surface populations .

private allele estimates were calculated based on groupings of populations united by geographical proximity, which also corresponded well to the groupings revealed both by structure and the shared allele distance analysis. the private allele content is significantly higher in surface populations than in cave populations  . the shared alleles and private allele proportions between surface and cave populations  suggests that the allelic contents of cave populations are largely subsets of alleles of the surface stock. thus the observed variation in the caves is mostly the result of standing genetic variation from the ancestral surface stock as well as possible gene flow between the populations . however, this result needs to be put into perspective: since the ancestors of the 'old cave fish' in the sierra el abra are locally extinct, one cannot compare their allelic composition with that found in today's el abra cave populations.

in order to determine genetic structuring in the analyzed samples, we performed hierarchical amova analysis . first, we narrowed down the population structuring by grouping populations based on their origins, "old" vs."new"  <cit> . comparison of the el abra populations  vs. the guatemala and micos caves  pooled with surface populations  was significant  and explained  <dig> % of the variance among groups. this supports the hypothesis emerging from the structure analysis that two different stocks of surface fish were ancestral to the present day cave populations. we tested by amova all inferences of structuring that emerged from the shared allele distance and structure analyses. the largest proportion of variance in all of the groups was within individuals . we found no significant structure of the surface populations comparing the regions s <dig> through s <dig> . importantly, the amova analyses supported significant structure among six metapopulations: 1) the el abra cave populations , 2) guatemala populations , 3) micos population , 4) chica population , 5) pachon population  and 6) surface populations.

ss - sum of squares; vc - variance components; % var - percentage of variation; fstat = f-statistics; p = p values.

pairwise fst comparisons of the geographically defined populations typically revealed higher divergences among cave populations, even within a geographical cluster, than between cave and surface populations . fst comparisons revealed less divergence among populations of the two guatemala caves  and micos cave   than was seen in comparisons among caves of the el abra cluster . this low genetic divergence is notable because the sierra de guatemala and micos caves are more than  <dig> kilometers  apart. consistent with the amova analyses, fst values among surface populations were generally low , suggesting that many of these populations from multiple and distant geographical regions essentially have high levels of allelic exchange. on the basis of fst values, general divergence between cave and surface pairs seems to be related to the level of the physical isolation of the particular caves from the surface water. four cave populations  show the highest fst values against the surface populations . the first three of these populations are perched and thus isolated from the underlying aquifer, while the fourth is in an area with no permanent surface streams . results of a mantel test for isolation by distance among populations o <dig> to o <dig> were positive, showing increasingly greater genetic isolation with increasing geographic distance .

boldfaced values are significant after bonferroni correction.

as is the case with o <dig>  all seven fst values between o <dig> and the other old cave populations are significant. in fact, fst analyses reveal that the o <dig> population is significantly diverged from every other population of cave or surface fish we surveyed . the average fst value between o <dig> and the seven other cave populations of the el abra group  was  <dig>  ±  <dig>  , which was significantly higher than the average fst values between o <dig> and the ten surface populations .

effective population size and migration rates in astyanax mexicanus
estimations of effective population sizes  and migration rates among populations were performed with migrate-n  <dig> . <dig>  using bayesian inference and the brownian motion mutation model. the model allows for mutation rates differing among loci by using the number of alleles per locus to estimate locus specific relative mutation rate modifiers. all the estimates of the mutation-scaled effective population size Θ were scaled using a microsatellite mutation rate of  <dig>  × 10- <dig> per locus per generation  <cit>  to calculate the average effective population sizes . effective population sizes varied among different surface clusters  but were generally greater than in cave populations . estimates of ne in most cave populations ranged from  <dig>  to  <dig>  . however, the cave populations from which previous studies reported mixed populations were again an exception, with effective population sizes of  <dig> in o <dig>   <dig> in o <dig>  and  <dig> in n <dig>  we used the migrate-n  <dig> . <dig> models  <cit>  to test for gene flow among individual cave and surface populations, limiting our inquiry to nearby populations or adjacent cave clusters. the summary of all the models is in figure  <dig> . our estimations of migration rates and effective population sizes supported the hypothesis that the genetic diversities of a. mexicanus cave populations are functions of introgression from surface populations, as well their effective sizes.

migration rates between individual populations varied by several orders of magnitude and the rates between cave and surface populations exceed those between caves. this is in accord with calculated fst values. four different patterns of migration were observed: among surface populations, among cave populations, from cave to surface, from surface to cave. migration rates among the four groups of surface populations defined earlier  were the highest we observed and were mostly symmetrical . migration rates between cave and surface populations were largely asymmetrical, with migration from the surface into caves typically greater than in the reverse direction. micos  cave and its nearby surface population was the only case in which migration rates in both directions were nearly equal, a result consistent with the structure results. migration rates among the cave populations were very low, except for caves in the el abra or guatemala clusters that are in close geographic proximity . also, n <dig> - n <dig> seem to have more exchange of migrants with surface than with populations of the old cave cluster . this suggests that proximate caves can exchange alleles through migration, although not nearly to the same extent as the surface populations exchange alleles.

considering only the o <dig> - o <dig>  we see that migration rates decrease with increasing geographical distances among populations . this observation supports the hypothesis of underground connections between nearby populations. thus, o <dig> as the most geographically distant cave has the smallest influx from other cave populations of el abra cluster, while o <dig> - o <dig> and o <dig> - o <dig> show high gene flow in both directions .

in some cases the estimates of gene flow between two caves or cave clusters appear asymmetric. considering both the sierra de el abra and the guatemala, these asymmetries seemed related to relative altitudes. figure  <dig> shows the altitudes above sea level of the fish pools in the various caves; n <dig>  sent more migrants to n <dig>  than vice versa. the same is true for o <dig>  to o2/o <dig> , o2/o <dig> to o4/o <dig> , and o <dig>  to o4/o <dig>  thus, we suggest it is easier for migrants to move downstream than upstream.

it must be noted that many of the estimates of migration rates are associated with large error terms  and are not precise. nevertheless, the overall trends discussed above seem clear.

relationship between eye phenotype and individual admixture proportions
in order to understand the integration of the surface individuals into the cave in our populations we compared phenotype and genotype for individuals collected from the three caves with mixed populations . the phenotype we used was relative eye size and the genotypic designations for each of the  <dig> loci were obtained from the structure analyses . hybrids between cave and surface formes are intermediate in phenotype between the two  <cit> . our results largely represent sorting of the phenotype and genotype into the two main categories, surface and cave. in addition, however, we also observe that there are individuals that are in intermediate states in both genotype and phenotype, the expected state for hybrids between surface and cave  <cit> .

discussion
the origins of the cave populations
our data clearly show that the populations of cave adapted astyanax in ne mexico are derived from two separate stocks. previous studies using microsatellites and mtdna markers had also concluded that the cave populations were derived from at least two surface stocks  <cit> . our results clarify the affinities of the pachón  and chica  cave populations. pachón was previously placed with the new stock based on mtdna data, but our extensive nuclear dna data set clearly places it with the old stock. conclusions based on mtdna may be misleading because the presence of surface fish in cave populations allows for the possibility of the introgression of surface mitochondria  <cit> . the affinities of the chica population are discussed below. finally, the present study covers the full geographic range of the cave populations and reveals no evidence that the cave populations are derived from more than two clades.

although derived from only two separate stocks, there are clearly more than two subterranean invasions that established the extant cave populations. all of our structuring analyses support divergence among five groups and are in accord with the hypothesis that the cave populations n <dig> to n <dig> were established much later than the populations o <dig> to o <dig>  similarities in the microsatellite allele frequencies in the "new" cave populations  and surface populations also confirm that these populations have recently diverged . with the exceptions of pachón  and chica , the shared allele analysis shows that the el abra populations cluster tightly. in the case of pachón  the divergence is minor and it is much closer to the old  cluster than to the new cave cluster. in contrast, the chica population  is not obviously aligned with either cluster in the shared allele analysis.

the origin of the chica population  has been a long standing question in the astyanax literature  <cit> . our data strongly suggest that the chica cave originated from old stock. this interpretation contrasts with a previous one based on mtdna and a small number of microsatellite loci which suggested that it is phylogenetically young and originated from new stock  <cit> . if chica were phylogenetically young, however, the structure analysis should cluster it with the surface populations, a result not observed. furthermore, we should see lower fst values between chica and the new cave populations  than between chica and the other el abra populations , but the opposite is the case  . considering the fst values, the structure analysis, and the shared allele distance analysis , all of which show chica to be considerably differentiated from the rest of the el abra populations, we suggest that it was derived from an independent invasion of old stock. because of its southernmost location, it may well be the earliest established of the cave populations.

geology and geography
knowledge of geology and geography, as well as genetics, is needed to understand the pattern of independent invasions of the underground that established the extant populations. a clear pathway through surface waters from the southernmost end of the el abra all the way to the area of pachón cave existed in the past but at present a surface divide separates the ends of the valley  <cit>  . pachón cave  at the northern end of the el abra is  <dig> km north of yerbaniz cave . while there is at least one other known cave between the two that might have served as a stepping stone, it seems likely that the underground invasion that established the pachón cave population was independent of those that established the more southern populations. this argument is based on the expectation that travel from one region to another is much faster through surface streams than through subterranean passages because open waters contain abundant food and provide direct passage, while subterranean routes have low food reserves and their passages may be maze-like. surface fish can move into caves relatively easily and quickly. we constantly see surface astyanax and other surface species, including tilapia, in certain caves, such as yerbaniz , chica  and micos . the significance of tilapia's presence is that it was introduced into mexican waters and only became common in the late 1980's  <cit> . therefore, its presence in caves shows how quickly underground populations may be seeded from the surface. thus, for the most distal populations of a migratory wave, it is far likelier that surface migrants will have reached and colonized a cave long before the arrival of underground migrants from the same source. all seven fst values between pachón and the other el abra populations are significant , which reflects the current isolation of the cave and, perhaps, a past independent origin.

considering the new cave populations, the distance between the micos  cave and the closest of the guatemala caves, caballo moro , is over  <dig> km and there is one ridge and two open valleys between them. no documented underground route currently exists between the two regions. thus, the micos and guatemala cave clusters likely represent separate invasions.

in summary, we suggest a model with a minimum of five independent origins of cave adapted astyanax in ne mexico. we envision that the area was originally colonized by surface astyanax of the old stock which independently established cave populations in the south of the el abra , in central el abra , and in its north . subsequent to this, the surface stock went extinct locally and was eventually replace by surface fish of the new stock. these gave rise to cave populations in the two geographically distinct regions of the gautemala  and micos  .

allelic diversity, migration and gene flow
allelic diversities were generally lower in cave populations than in surface populations , an observation in accord with previous studies on this species and other fishes  <cit> . lower genetic diversity in cave populations than in related surface populations probably reflects smaller effective population sizes because of food and space limitations, but may also reflect possible bottleneck events due to periodic droughts and other environmental fluctuations  <cit> . it should be noted, however, that the relatively large effective population sizes in micos  and chica  were probably overestimated by migrate-n  <dig> . <dig> because they are admixed with the surface populations.

many of the el abra caves regularly receive migrants from the surface  <cit> , and chica  is the best known of these  <cit> . chica is unusual among astyanax cave populations in receiving a high energy input deriving primarily from two bat roosts located directly above the largest of the fish pools. breder noted, and we still observe today, that the frequency of surface fish in the pools increases as one goes deeper into the cave, and is highest in pool  <dig>  at the level of the aquifer and located about one km from the río tampaón  <cit> . all who have studied this cave have surmised that surface fish get into the cave from the river through the aquifer and are able to survive and breed there because of the high energy input from the bat roosts and from debris washed into the cave during the rainy season  <cit> . thus, chica draws its occupants from two different source populations that are well differentiated from each other. this admixture results in significant heterozygote deficiencies at numerous loci. that these departures from hwe are due to wahlund effect is evident from genotype-phenotype correlations observed in our study .

our collections from the micos cave  also contained both cave and surface forms and, as in chica , we observed departures from hwe due to wahlund effects. in contrast to the situation in chica, food is not abundant in this cave, thus the surface fish are prone to starvation, leading in most cases to reduced fitness and inefficient mating  <cit> . nevertheless, some surface fish washed into this cave may hybridize with the cave population, as revealed by genotype-phenotype correlations . the caballo moro  population exhibits a full range of eye sizes and pigmentation, from typical cave to typical surface morphs . this population is in a karst window, a habitat within a cave exposed to light because of passage collapse; the presence of light facilitates the continued survival of surface and hybrid phenotypes  <cit> .

the migrate-n analysis also detected relatively high rates of gene flow from the pachón cave population  to their nearby surface populations, supporting an earlier suggestion of a route for alleles from cave to surface  <cit>  . estimation of migration rates and effective population sizes supported the hypothesis that the genetic diversity of a. mexicanus cave populations is correlated with the influx of alleles from surface populations, as well as by their effective population sizes  <cit> . the relatively high rates of migration between cave and surface populations here may not be a rule for cavefish. for example, migration between cave and surface populations of poecilia sulphuraria is relatively low, even though there are few physical barriers to movement  <cit> . in the case of poecilia, the barrier seems to be the extreme environment of the sulphidic caves, which requires physiological adaptation to high levels of h2s, a condition to which cave astyanax are not exposed.

the migration rate analysis revealed that surface fish in the region form a metapopulation, with extensive exchange of genetic material among its component populations. thus, there is high genetic diversity within and little genetic differentiation among surface populations. in strong contrast, cave populations live under dramatically different ecological conditions and often have lower population densities. migrate-n results also show that the effective sizes of surface populations are generally larger than those of cave populations, consistent with earlier studies based on estimates of nucleotide diversity  <cit>  . mark and recapture estimates of total population sizes from pachón  and yerbaniz  caves were similar to our estimates, with averages of  <dig>  ×  <dig> individuals and broad 95% confidence intervals ranging from about  <dig>  ×  <dig> to  <dig>  ×  <dig>  <cit> . our estimates of ne in cave population varied from  <dig>  to  <dig>  ×  <dig>  with the exception of curva  and the admixed populations micos  and chica . while consistent with the estimates from mark-recapture studies  <cit> , they are around one order of magnitude higher than previously reported estimates from molecular data  <cit> .

we note that the mutation-scaled immigration rate  from surface populations into cave populations often exceeds  <dig>  . with mutation-scaled effective population sizes  on the order of  <dig>  to  <dig>  mne  can exceed  <dig> , implying that migration from surface to cave populations could significantly affect allelic frequencies at neutral loci  <cit> . nevertheless, cavefish in these populations remain troglomorphic in phenotype in the face of this immigration. this implies that these phenotypes are maintained by selection, although we cannot say whether it is natural selection imposed by the cave environment or sexual selection imposed by mate choice biases against the surface fish  <cit> . selection may generally be sufficiently powerful to allow population differentiation even in situations in which there is high gene flow  <cit> .

finally, we note that the five independent invasions of the subterranean habitat documented here imply five instances of striking phenotypic convergence. this highlights the importance of a change in ecology as a strong driver of evolutionary change. this is in accord with studies of freshwater adaptation in gasterosteus aculeatus that document widespread convergences or parallelisms related to ecological shifts  <cit> .

CONCLUSIONS
our study showed that cave populations of astyanax mexicanus generally have significantly lower genetic variability than surface populations, reflecting the generally lower availability of habitat space and food in the caves. some of the cave populations were exceptional and had higher genetic diversity, which correlated with their receiving relatively high migration from the surface. we documented significant levels of gene flow between surface and cave populations in both directions. that cave populations could maintain a cave specific phenotypic suite of traits in the face of strong migration from the surface implies strong selection for maintenance of cave phenotype. the results also demonstrate that cave populations in the region studied arose at least five times independently and derive from two different ancestral stocks, implying numerous convergences on the cave phenotype driven by the ecological shift from surface to the underground. thus, the astyanax cavefish model will continue to be a rich source for study of adaptive evolution.

authors' contributions
mb designed the study, collected the specimens, performed all the analyses and wrote the manuscript. pb performed the migrate-n analysis and helped with the data interpretation. fjgl and seb collected the specimens and helped with the manuscript preparation. rb contributed to the design of the study, the choice of populations and collection of specimens, and the writing of the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
summary statistics for  <dig> microsatellite loci of astyanax mexicanus populations. table summarizing the microsatellite data. mean sample size over all loci ; ap is the mean number of alleles per locus, expected  and observed  heterozygosity, fis. bold fisvalues are estimates significantly different from zero after bonferroni correction.

click here for file

 additional file 2
migrate-n  <dig> . <dig>  runtime conditions and methods. summary of methods and conditions.

click here for file

 additional file 3
allelic frequencies of  <dig> microsatllite loci in the studied populations. summary of allelic frequencies for all loci and all populations.

click here for file

 additional file 4
a detailed hydrological map of the el abra region. el abra region map with the indication of surface and subsurface water divide. points at, or near, base level  are indicated by solid circles; fish-inhabited pools by solid circles closer to the high water profile  .

click here for file

 additional file 5
genetic isolation by distance. results of the mantel test for correlation between genetic distance ) and geographic distance for populations of the el abra region  .

click here for file

 additional file 6
estimates of gene flow based on bayesian inferences of migration rates and population sizes. results of migrate-n  <dig> . <dig> on astyanax mexicanus population clusters within each geographical region. mutation scaled immigration rate, m, between different population groups. m is the ratio of the immigration rate over the mutation rate. the central box of the plots represents the values from the lower to upper quartile . the middle dot represents the median posterior values over all loci. the horizontal line extends from the  <dig> % percentile to the  <dig> % percentile. populations compared are designated to the left of the boxes.

click here for file

 additional file 7
summary of the proposed models and conclusions of the paper. proposed model with five independent origins of cave adapted astyanax in ne mexico as estimated by the data. the first wave of surface fish led to three independent subterranean invasion events establishing the "old" cave populations. the second wave gave rise to two independent invasions establishing "new" cave populations. the arrows signify that the ancestral stock moved into the area from the south but are not meant as specific routes.

click here for file

 acknowledgements
microsatellite primers were provided by j.gross . we thank the mexican government for providing the collecting permit . this work was funded by a fundação para a ciência e a tecnologia phd grant to m.b , and an nsf ios -  <dig> award to r.b. p.b. was partly funded by the joint nsf/nigms mathematical biology program under nih grant r <dig> gm  <dig> and by nsf grant deb  <dig>  f.j.g.l. was partly founded by the cibnor. we thank paul scheid for technical help, erik duboué and the members of teotónio laboratory at instituto gulbenkian de ciência, portugal for the useful comments on the manuscript. we also thank geoffrey hoese and jean luis lacaille muzquiz for their help during the fieldwork. we thank three anonymous reviewers for their useful comments. this project is in partial completion of requirements for the phd degree at universidade nova de lisboa, oeiras, portugal for m.b.
