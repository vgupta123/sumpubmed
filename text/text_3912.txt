BACKGROUND
genome sequencing  <cit>  and gene expression microarray technologies have, in recent years, enabled systems-level research into the malaria-transmitting mosquito anopheles gambiae. by measuring transcript levels with respect to biological events, such as blood feeding, development, parasite infection and mating, one can identify genes that are likely to be involved in the underlying processes. however, due to the wealth of information produced by individual experiments and the numerous leads that require further investigation, it is understandable that research groups rarely perform so-called meta-analysis of gene expression data, whereby multiple experiments are analysed simultaneously. furthermore, meta-analysis is impeded by incompatibilities between different versions of genome annotations, microarray technologies, file formats, experimental designs, data processing pipelines and statistical analyses. several ongoing projects are aiming to eliminate these inconsistencies and produce uniform processed and analysed data for the end user. human curators at the two major microarray repositories, ncbi geo  <cit>  and array express  <cit> , are working to produce enriched resources known as geo datasets and the gene expression atlas  <cit> , respectively. the vectorbase consortium  <cit>  produces a similar unified gene expression resource for the invertebrate vector community.

web-based expression summaries provide useful and concise biological overviews for individual genes of interest, however a common requirement is to know which other genes are expressed in a similar manner to a particular gene. geo and arrayexpress' curated expression resources provide such "nearest neighbour" gene lists, but within a single experiment only, not across multiple experiments. some years ago, gene expression data from  <dig> caenorhabditis elegans two-colour microarray experiments was clustered simultaneously to produce a 2d map known as topomap  <cit> . it was found that topomap clustered many genes of similar function, such as lipid metabolism, heat shock and neuronal genes. topomap is integrated into the wormbase genomics resource, but the underlying expression data is not available, reducing its utility. to the best of our knowledge, no large-scale meta-analysis of expression data has been made public for any other species.

here we present a simple method for clustering expression data from a diverse set of microarray experiments. we have used data from a. gambiae, but the method is applicable to any organism. the results are visualised on a 2d map, and we show that many regions of the map are strongly linked to biological function. two case studies are presented. one focuses on odorant binding proteins, which can be classified into several functional groups. the second looks at a large number of immunity-related genes, and likewise suggests specialised roles for members of several immunity gene families.

RESULTS
a map of a. gambiae gene expression
using the vectorbase gene expression resource   <cit> , gene-averaged expression values were extracted for  <dig> experimental conditions  derived from  <dig> publications  <cit> . after median-shift normalisation ,  <dig> a. gambiae genes were clustered according to their expression data into a 25× <dig> grid of discrete clusters using the self-organizing map algorithm  <cit>  with a pearson correlation coefficient-based distance measure . the self-organizing map is randomly initialised; its iterative "training" or clustering algorithm is somewhat related to the k-means clustering method. however, unlike k-means, the  <dig> clusters on the self-organizing map are laid out in a meaningful order , although note that the "x" and "y" axes have no predetermined meaning. figure  <dig> illustrates how the high-dimensional expression data has been flattened into a two-dimensional grid, as a result of the competitive learning process. gene expression space is highly convoluted, as indicated by the multiple discrete areas of high expression for many conditions .

the  <dig> experimental conditions used in the vectorbase release  <dig> . <dig> expression map are listed.

given the assumed difficulty of mapping such high-dimensional data into two dimensions, how reproducible are the maps with respect to the random initialisation step? a simulation, based on an additional  <dig> randomly seeded maps , was performed to see how often genes that are co-clustered in the "main" map  would co-cluster in a re-mapping. it was found that  <dig> of  <dig>   randomly selected co-clustered gene pairs co-cluster again in a randomly selected re-mapping, while  <dig>   of gene pairs re-map to the same or "nearby" clusters . this indicates that the general topology of the map is reproducible, although the fine details may not always be.

map nodes and regions are enriched with respect to gene function
the gene sets corresponding to each map node were tested for enrichment in annotated function through a gene ontology  term over-representation analysis  <cit> . a large number of biological processes, molecular functions and cellular components were found to be enriched. genes annotated with a small selection of these go terms are highlighted in figure  <dig>  where the coloured pie slices within the grey circles indicate the proportion of genes with these go terms. components of macromolecular complexes, such as the ribosome and proteasome are among the most highly enriched terms, which is expected since these proteins need to be produced in stoichiometric amounts and are therefore likely to be coregulated. non-complex associated genes are also highly clustered by the map, such as those involved in polysaccharide metabolism and odorant binding. a full list of highly significant go terms is provided in table  <dig> 

a list of go terms found to be over-represented in the genes of at least one of the  <dig> clusters on the map. only go terms associated with four or more genes per cluster and with a corrected p-value less than  <dig> × 10- <dig> are shown. child and parent terms with higher p-values than those shown are omitted for clarity. bp = biological process, mf = molecular function, cc = cellular component.

highly enriched gene functions are frequently found in multiple distinct regions of the map, indicating major differences in their expression and hence the biological context in which the genes operate. some examples are discussed below.

the strongest enrichment of function is seen for the ribosomal proteins on the left hand edge of the map. however, there is a second group of ribosomal protein genes in the centre of the map that is characterised by high expression in ovaries and is therefore likely to be involved in egg production.

genes involved in dna, rna and protein synthesis are generally found above the diagonal from lower-left to upper-right. temporally, spatially or functionally related metabolic functions are often co-located on the map. for example, near the centre of the map, clusters enriched in protein synthesis , protein folding and protein degradation  are found together. additional file  <dig>  figure s <dig> shows a wider selection of dna/rna/protein metabolic functions and their relationships .

one additional gene function analysis was performed. the null hypothesis asserts that the genes annotated with a particular go term are randomly distributed across the map, and this is tested empirically. table  <dig> lists the  <dig> go terms for which this null hypothesis is rejected at p < <dig>  , that is, functions which are non-randomly distributed on the map.

a list of go terms for which the genes annotated with them are found to be non-randomly distributed on the map. only go terms associated with between  <dig> and  <dig> genes were analysed. the test for non-random distribution and multiple testing correction is described in the methods section.

multi- vs. single-experiment maps
some of the experiments included in this analysis, for example the life-cycle series  <cit> , blood meal time series  <cit>  and embryonic developmental series  <cit> , have a large enough number of experimental conditions to allow effective clustering of genes on their own. using an identical self-organizing map approach on data from these individual experiments, we found significant enrichment of gene function in the resulting clusters, as shown in figure  <dig>  however the number of enriched go terms  was lower than that obtained with the all-experiment  map. the difference is particularly clear at the p < <dig> × 10- <dig> threshold.

the mapping was also performed with two older releases of the expression data , which contain fewer experiments . in general there is an increase in the number of enriched go terms as new experiments are added, although there is a small drop in the number of biological process terms from release  <dig> . <dig> to  <dig> . <dig>  from this limited data we tentatively predict that the incorporation of future experimental data will produce increasingly informative maps. further discussion on the inclusion/exclusion of experiments can be found below .

details of the number of experimental conditions, publications , number of mapped genes  and map size are provided as a supplement to figure  <dig> 

case study: odorant binding proteins
odorant binding proteins , which transport odorant molecules through the extracellular fluid of chemosensilla to transmembrane odorant receptor  proteins on olfactory receptor neurons, are found in three main regions of the expression map . one region is characterised by minimal differential regulation and presumably represents constitutively expressed genes . another region rich in obps is characterised by high expression in non-blood fed females, suggesting a role in mating or host seeking for these genes. the third cluster is expressed after blood feeding and may be implicated in locating suitable sites for egg laying. a similar functional hypothesis for obps, based on blood meal data alone, has already been proposed  <cit> , however this only identified three of the most differentially expressed genes, whereas the expression map classifies the majority of this large family into three, or perhaps more , functional groups. in contrast however, the vast majority of ors  appear to be unregulated .

we observe a large degree of overlap between obp expression map clusters and paralogous groups  defined in the vectorbase comparative genomics database . this is to be expected since gene duplication events are likely to involve "upstream" regulatory dna, and so transcripts of duplicated genes are likely to be co-regulated. however, paralogous obps are somewhat divergent  so it is notable that their transcriptional regulation has been conserved. the phylogenetic analysis splits the "high in non-blood fed females" region  into two sub-regions : on the left, two clusters containing most members of obp-pg <dig> and obp-pg <dig>  and on the right, a cluster dominated by obp-pg <dig>  which consists of a tandem array of five hitherto unannotated  <cit>  obps  with no known orthologues in drosophila melanogaster or other mosquitoes. agap <dig> is more highly expressed in males while agap008281-agap <dig> have very much higher expression in females. this combination of sex-specific expression and species-specific phylogeny suggests a role for obp-pg <dig> genes in mating, perhaps supplementary to wing-beat frequency matching  <cit> . given that members of obp-pg <dig> and obp-pg <dig> have drosophila orthologues, these obps may be involved in sugar-based meal seeking rather than blood meal host seeking. obp-pg <dig> members have only mosquito orthologues, which supports the suggestion above that these genes may be involved in oviposition site selection .

case study: immunity genes
in figure  <dig>  immunity-related genes, including toll, imd, jak/stat and sirna pathway members, and anti-microbial effectors such as defensins and cecropins are marked on the expression map. these genes show a very clear non-random distribution , and occupy several distinct regions of the map. genes from the four main immune pathways are generally intermingled, rather than in pathway-specific separate clusters. this possibly reflects the shared or similar biological contexts  in which the various immune challenges are encountered and cleared. the intermingling may also suggest crosstalk between the pathways.

the genes rel <dig> and rel <dig>  encoding the core transcription factors of the toll and imd pathways respectively, have very different expression profiles. this is perhaps expected since rel <dig>  an orthologue of drosophila dorsal, and other toll pathway members have well documented roles in dorso-ventral pattern formation in the early embryo, and indeed we see toll1b, toll5a, rel <dig>  and cact in the early embryo region of the map. notably, toll1a, 1b, 5a and 5b are co-orthologues of drosophila toll, which codes for a transmembrane receptor with developmental and immune roles. one can speculate that, of these four mosquito receptors, toll1b is the most likely functional orthologue of toll as it clusters closely with rel <dig> on the map. however, the location of toll5b close to many other immunity genes  as well as that of toll5a close to toll1b, rel <dig> and cact may imply that at least three of the four co-orthologues of toll play central, but likely distinct, roles in mosquito immunity.

many of the major immunity gene family members are quite widely dispersed on the map. for example, the anti-microbial cecropin genes cec <dig>  cec <dig> and cec <dig> are tightly clustered in a region characterised by strong midgut expression and low expression  <dig> h post blood meal , while cec <dig> is located quite far away in a region with less overall differential expression and a mild positive response at  <dig> h post blood meal . this suggests that cecropins 1- <dig> have similar roles but are perhaps specialised to counter a range of pathogens, while cec <dig> has evolved to perform a different role. the four defensins have a similarly informative distribution: def <dig> is with the main cluster of cecropins suggesting it has a similar function, while the others are in the lower right corner where the  <dig> h post blood meal response is strong. in particular, def <dig> is clustered with a large number of cuticle genes, suggesting a role in immunity during blood meal induced cuticle expansion, perhaps against fungal infection.

the peptidoglycan recognition proteins  are another gene family whose functional diversity is reflected in the map. all pgrps, as their name implies, are able to bind microbial peptidoglycan specifically but some are believed to have catalytic activity due to the conservation of three active site amino acids  <cit> . in a. gambiae, the putative catalytic members of the family are pgrplb, pgrps <dig> and pgrps <dig>  interestingly these three genes all map to the right-most edge of the map. pgrplb lies in a region populated by other effector genes and peptides , lysc <dig>  def <dig> and cecropins 1-3), supporting its proposed role as an antimicrobial agent. pgrps <dig> and pgrps <dig> map close to def <dig> and def <dig> respectively, suggesting parallel but as yet unidentified roles.

the recently described physical interactions between two leucine-rich repeat  proteins lrim <dig>  and apl1c and the complement c3-like protein tep <dig>  <cit>  are mirrored in the expression map; the two lrr genes map to the same grid node while tep <dig> maps to the node below. these proteins are implicated with the activation of the mosquito complement system, with tep <dig> being shown to localise around invading plasmodium berghei ookinetes. this region of the map  has the highest density of immunity genes, including many other teps , clip-domain serine proteases, and one additional member of the recently characterised lrim family  <cit> , lrim <dig> , which has been shown through rnai mediated knockdowns to affect plasmodium ookinete invasion  <cit> .

limitations
although the clustering of genes based on their expression in many different experiments appears to be successful--as assessed by the co-clustering of genes with similar function, at least--the methodology has some potential shortcomings which merit discussion.

since data from so many experimental conditions is presented in one place there is the possibility that users could over-interpret map cluster expression summaries. for example, genes in cluster  <dig>  could be  interpreted as having "high expression in the fat bodies of non blood-fed females". however, the fat body assays used tissue from blood-fed females, so the correct summary should be "high expression in non blood-fed females and the fat bodies of blood-fed females". users should be aware that very few of the possible combinations of experimental conditions have actually been assayed.

the use of different mosquito strains from one laboratory to another may also make interpretation of the map more difficult. first, polymorphisms may differentially alter microarray hybridisation efficiency in one strain relative to another for certain genes. however, this would appear to have a minimal confounding effect, since microarray studies have directly compared different strains and the results have been successfully validated with quantitative pcr  <cit> . second, strains may actually exhibit biologically meaningful differences in expression . on first impressions this may seem like a problem, but it is actually an advantage because the differential  expression resulting from strain differences  simply provides data with which finer-grained clustering can be obtained. the web interface, however, could be enhanced in future versions to display all available sample characteristics. currently only the most pertinent information is available in the experiment titles .

while we have re-analysed all data in order to standardise the statistical treatment there is still a possibility that technical differences between microarray technologies  could affect the meta-analysis. for example, platforms with a wider range of detection are capable of producing data with greater dynamic range. if high and low dynamic range datasets are mapped together, the high dynamic range data will have a greater influence on the clustering of genes. however, the dynamic range of expression data can also be influenced by the relative severity of the experimental conditions being tested . the vectorbase  <dig> . <dig> expression data set contains both high and low dynamic range experiments . the low dynamic range experiments tend to involve less severe conditions, such as strain comparisons. if datasets were range-normalised prior to mapping, the biological relevance of very highly regulated genes would be lost.

another limitation is that we discard/ignore the statistics relating to the mean expression values used as input data to build the map. for instance, the numbers of replicates and standard deviations could be used to filter out bad data or to produce gaussian models for each expression value . such enhancements, if implemented, would likely improve the quality of the mapping still further.

we have tried to keep the number of parameters in our approach to a minimum, however the size and shape of the map has a major effect on the outcome and was decided somewhat arbitrarily. in general, small maps produce large gene clusters, while large maps produce smaller clusters. for any given biological annotation, the extent of its enrichment within clusters will depend on cluster size and the number of genes annotated as such . thus, no map size is optimal in all cases. the dimensions of the vectorbase a. gambiae expression map  were chosen to give an average of  <dig> genes per cluster--a manageable number. alternative map sizes could be provided by vectorbase in the future.

vectorbase strives to be unbiased and include all data for its core species in the expression database, particularly those with raw data deposited in public repositories. however, for technical reasons, total coverage of experiments cannot be guaranteed. furthermore, in the mosquito field there is quite a heavy experimental bias . as the vectorbase resource expands, questions arise as to what to do with largely redundant datasets . multiple assays of similar conditions or tissues  will proportionally shift the focus of the map towards those conditions or tissues; less space will be available for the allocation of genes into clusters based on other expression characteristics. one solution may be to perform some pruning of redundant datasets, another may be to produce specialist maps  in addition to the "all conditions" map.

CONCLUSIONS
one obvious use for the a. gambiae expression map is to short-list potential interaction partners for proteins of interest. for example, one can extrapolate from the recent findings for lrim <dig>  <cit>  that other lrim family members will form heteromeric complexes and perhaps also interact with one or more teps, and that these genes will, like lrim <dig>  apl1c and tep <dig>  probably also be co-located on the map. similarly, we observe a general tendency for clip-domain serine proteases and serpin family serine protease inhibitors  to be clustered together in many areas of the map, which suggests that the experimental elucidation of enzyme-inhibitor relationships can be greatly accelerated using the map.

a further advantage of performing clustering on all available data is that the clusters obtained are likely to be fine-grained enough for promoter analysis aimed at the discovery of cis-regulatory dna sequences responsible for co-regulation. post-transcriptional regulatory mechanisms  will also be responsible for some of the observed co-regulation, so transcript-based signals  might also be detectable in expression map clusters.

finally, we propose a role for expression maps in comparative transcriptomics. current approaches compare data from two or more broadly equivalent experiments that have been performed in two or more organisms . if the experiments are performed in different laboratories and at different times, the experimental designs are likely to be different enough to invalidate or at the least complicate the analysis. however, expression maps tend to smooth out these differences, so that intra-map distances between pairs of orthologous genes should be robustly comparable between species, especially if the maps have been generated using a similar set of experiments. one can also quantify the functional divergence of gene families by measuring their intra-map dispersal, and compare these between species.

availability
the a. gambiae expression map has potential for making expression data more accessible and useful to researchers throughout the field. a web interface is available at http://funcgen.vectorbase.org/expressionmap/anopheles_gambiae/paper -- showing the data presented in this paper. however, as the resource is updated as part of vectorbase's release cycle, newer versions are also available. while this manuscript was being revised an expression map for the dengue vector aedes aegypti was also made available. in addition, the source code for map generation and web visualisation is available under the gnu general public license at https://github.com/vectorbase/expressionmap.

