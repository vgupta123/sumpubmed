BACKGROUND
construction of biological networks  has been of considerable interest amongst computational biologists as is evident by a fast growing literature  <cit> . often, network construction via computational methods is considered to be a faster and more viable alternative to experimental methods, especially, for high throughput studies. it can be argued that, in many genomic studies, it is of even greater interest to see how the network of connected gene pairs change from one experimental condition to another since such changes may offer an important clue regarding an underlying biological process such as identification of pathways that correspond to such a change.

whereas a variety of network construction methods now exist, methodologies for a differential network analysis are few and far between. it is therefore the purpose of this paper to introduce a formal statistical methodology to detect significant changes in two biological networks. we describe and study our methods in the context of gene-gene interaction networks although it is conceivable that the methods can be easily adapted to other types of biological networks. specifically, we are interested in statistical tests for answering the following questions related to networks constructed using the same set of genes under two experimental conditions:  whether the overall modular structures of the two networks are different,  whether the connectivity of a particular set of "interesting genes" has changed between the two networks, and  whether the connectivity of a given single gene has changed between the two networks. the building blocks of all our statistical tests are the set of scores that measure the strength of association/interaction between gene pairs in the two networks. we provide examples of a number of measures of gene-gene association/interaction such as correlation, partial correlation, mutual information, posterior probabilities and so on. another measure that is heavily used in this paper is based on a partial least squares  <cit>  modeling of one gene's expression on the remaining genes. these scores were introduced in our earlier paper  <cit>  on genetic network reconstruction.

an early attempt to study how pairwise correlation between genes in two plants change was presented in  <cit> . a differential network analysis using liver gene expression data in normal versus heavy mice was performed in  <cit>  in an attempt to identify the underlying genetic drivers and pathways, and they also proposed a test for differential connectivity of a single gene. a side by side comparison of gene expression networks for normal versus cfs  patients was performed in  <cit>  through a visual analysis and detected change in connectivity of certain node genes although they did not carry out any statistical significance tests. their association scores were based on a mutual information criterion  <cit> . finally,  <cit>  fit separate structural equations to the two sets of gene expressions and tested the null hypothesis of equality of the coefficients in the two models as an indication of equality in the overall network structures.

in the methods section, we describe an approach of measuring association/interaction using connectivity scores, and we primarily use scores based on pls  <cit> . we also describe how to identify modules and hub genes from these scores in an unsupervised manner. then we formulate the three test statistics to inspect various aspects of how the two networks are different. unlike previous approaches, this approach offers a formal statistical test using each notion of differential connectivity. our simulation results are reported in the results section. we simulate from two different types of models where we know some form of the ground truth. in the results section, we also reanalyze a data set on a mouse obesity study.

RESULTS
we investigate the performance of our testing procedures in a number of simulated data sets as well as one real data set. as can be seen from these studies, the proposed statistical tests are effective in detecting differences between the network structures.

simulated data
we use two types of simulation models to generate data. the first approach uses partial differential equations to model expression levels, and one could generate networks of various structures and complexities that are presumably quite realistic. the second simulation model generates a simple gaussian network where  gene expressions are generated from a multivariate normal distribution. by selecting the variance-covariance matrix, we can induce various types of association/interaction amongst the genes; another advantage of this model is that replicated data sets can be generated with the same network structure so that statistical properties of our tests  can be computed empirically.

differential equation based networks
the syntren software developed by  <cit>  simulates biological networks with known underlying structures based on existing biological subnetworks and are modeled with michaelis-menten and hill kinetic equations. this software was used to generate two networks with ni =  <dig> samples each and p =  <dig> genes. the first network  consists of five separate modules with ten genes each while the second network  has a single module with all  <dig> genes. the software allows the user to specify several tuning parameters which control the noise and complexity in each generated network; all probability parameters were set to  <dig>  for both the treatment and control networks. the two networks are illustrated in figure  <dig> using the cytoscape software  <cit> .

we consider testing for differential modular structures in the two networks as described in the methods section using pls connectivity scores. clearly, the performance of the method will depend on the choice of the minimum module size m and ϵ, which is a user selectable parameter threshold on the connectivity scores to determine if there should be an edge between two nodes  in a network. if ϵ is too large, then the method will find very few interactions between genes and therefore very few  modules; if ϵ is too small, then the method will find too many interactions between the genes and every gene will be in the same large module. as m increases, the number of modules j <dig> and j <dig> decreases. consequently, we performed a sensitivity analysis with respect to the tuning parameters m and ϵ. the p-values were computed using p =  <dig> random permutations each.

in this simulated example, there is a statistically significant difference between the modular structures for a wide range of values of m and ϵ based on the test for different modular structures in the methods section. table  <dig> shows the results for the minimum module size of m =  <dig> with various choices of ϵ, and presents the value of the test statistic  and its corresponding p-value. the results for other values of m between  <dig> and  <dig> are very similar and available on the supplementary website  <cit> .

gaussian networks
we conducted a simulation study based on two networks  each generated from the multivariate gaussian distribution with a zero mean vector. under this setup, we investigate the statistical power of the test for differentially connectivity for each of the genes described in the methods section.

we report the results for two network settings, one with p =  <dig> genes and another with p =  <dig> genes. additional results for other setups, including pls scores, are available on a supplementary website  <cit> . for each monte-carlo sample, the p-value of each test is based on  <dig> random permutations. since each such calculation is based on monte-carlo replications of the original samples whereas the observed level of significance  for each original sample is based on another level of monte-carlo iteration, the total computational demand is fairly substantial. as a result we base our calculations on  <dig> monte-carlo iterates for the 20-gene and 100-gene networks.

the covariance matrix of the control network is taken to be the identity matrix. this signifies a hypothetical situation where none of the genes is interacting with one another. the diagonal elements of the covariance matrix of the treatment network are  <dig>  the off-diagonal elements of the first  <dig> genes are ρ or -ρ depending on whether the sum of the respective indices are even or odd, and the remaining off-diagonal elements are  <dig>  three values of ρ were used where larger ρ indicates higher association so that we may expect the power of our test to increase with ρ. thus, the first  <dig> genes are the "important" genes whose connectivity is present in the treatment network but not in the control network; the remaining genes are "unimportant" which behave independently in both networks. in this study, we selected two sample sizes, n =  <dig> and  <dig>  a reasonable test should have an increasing power function with the increasing sample size.

in each setting, we compute the following quantities:

 sensitivity: this is computed by proportion amongst the "important" genes that were declared to be significantly differentially connected.

 specificity: this is computed by proportion amongst the "unimportant" genes that were declared to be not significantly differentially connected.

 true discovery rate : this is computed by proportion amongst genes declared significantly differentially connected that were amongst the "important" genes.

 true non-discovery rate : this is computed by proportion amongst genes declared to be not significantly differentially connected that were amongst the "unimportant" genes.

high values of each of these measures indicate good performance of the testing procedure in some aspect. note that the sensitivity is the same as the average power; that is, it is the proportion of monte-carlo samples for each given "important" gene in which it is declared to be significantly differentially connected averaged across all ten "important" genes. similarly, one minus the specificity is the average size.

here we report the results for our tests for the correlation scores. since it is a gaussian network that was constructed using various degrees of correlation between the dependent genes, the results using the sample correlation are the easiest to interpret and most natural. the supplementary website lists the results using other scores. results for p =  <dig> are summarized in table  <dig> whereas those for p =  <dig> are listed in table  <dig>  the nominal size for all tests was set at α = 5% which means a gene is declared to be differentially connected if its permutation based p-value is less than  <dig> . the results for α = 10% are provided in the supplementary website  <cit> .

the measures are reported based on both unadjusted p-values and p-values adjusted based on the bh multiplicity correction. the number of "important" genes was  <dig> and the total number of genes was  <dig> 

the measures are reported based on both unadjusted p-values and p-values adjusted based on the bh multiplicity correction. the number of "important" genes was  <dig> and the total number of genes was  <dig> 

for p =  <dig>  the sensitivity of all the tests performed together is close to  <dig>  in order to account for simultaneous testing of multiple hypotheses, we also considered the standard benjamini-hochberg  <cit>  adjusted p-values to declare significance. we also attempted other relatively recent multiple hypotheses adjustment procedures. these include the local fdr due to  <cit> , the q-value due to  <cit> , and the fdrtool due to  <cit> . their performances varied across the different measures but overall, none of them seem to do better than the tests without any p-value adjustments. consequently, these are not reported in the tables.

for p =  <dig>  the sensitivity increased as ρ increased and was lower for the bh adjustments. the procedures have high specificity with the bh adjustment. the tnr is also close to  <dig> and the unadjusted tdr ranges between 60%-70% which suggest that some unimportant genes were deemed to be differentially connected by the procedures which is not unexpected since only 10% of the genes were truly important. the bh adjustment improved the tdr to between 90%-95%.

in this simulation experiment, we were aware of the identity of the important genes. we also investigated the performance of the test for differential connectivity of a class of genes described in the methods section. in each case, the power for detecting the class of important genes is  <dig> when using pairwise correlations. full results are presented in the supplementary website  <cit> .

the analysis for the gaussian simulations is based on the statistical tests described in the methods section. while it is certainly possible to use regularized statistical tests for the gaussian model based on appropriate asymptotic theory, we only present the gaussian model as a simple model for which we can easily conduct a simulation study. the more general statistical tests described in the methods section are not only applicable to the gaussian model, but also to more complex models which are more appealing from a biological perspective.

real data
we illustrate our methodology using a real data set.

mouse data
we apply our tests described in the methods section to a subset of microarray expression data obtained from liver tissue of female mice and corresponding clinical traits for the mice that was analyzed previously by  <cit> . the full data set consists of  <dig> genes and  <dig> mice. the data set was further reduced by removing genes and mice with missing values. for the differential analysis, we selected two networks of mice. the first network consisted of the  <dig> heaviest mice with weights greater than  <dig> . the second network consisted of the  <dig> leanest mice with weights less than  <dig> . we worked with a filtered collection of genes  based on univariate regressions of mouse weights on each individual gene's expressions using all mice; we chose the  <dig> genes with z-scores greater than  <dig> 

using pls connectivity scores and the test for differential structures , the value of the test statistic is  = . <dig> with a p-value of p =  <dig>  based on  <dig> random permutations; thus the modular structures of the two networks are significantly different at a 5% level. the module structures of the two networks are illustrated in the supplementary material website using the cytoscape software  <cit> . in addition we performed a sensitivity analysis with respect to varying ϵ and found that, for any moderate choice of ϵ, the modular structures are statistically significantly different. the complete results for ϵ ∈ {- <dig> ,  <dig> ,  <dig> ,  <dig> ,  <dig> } are presented in the supplementary material website  <cit> .

next, using the test for differential connectivity of individual genes, we found  <dig> genes which are significant at level  <dig>  without any multiplicity correction. the gene names, values of the test statistic, and the corresponding p-values for the  <dig> most differentially connected genes are listed in table  <dig>  a complete list is given on the supplementary material website. below, we give a brief commentary for the biological functions of a select few genes which we mined using the entrez gene tool  <cit> .

the first two genes on this list, anxa <dig> and anxa <dig>  encode members of the annexin family. members of this calcium-dependent phospholipid-binding protein family play a role in the regulation of cellular growth and in signal transduction pathways. this protein functions as an autocrine factor which heightens osteoclast formation and bone resorption.

apolipoprotein m, also known as apom, is a human gene. the protein encoded by this gene is an apolipoprotein and member of the lipocalin protein family. it is found associated with high density lipoproteins and to a lesser extent with low density lipoproteins and triglyceride-rich lipoproteins. the encoded protein is secreted through the plasma membrane but remains membrane-bound, where it is involved in lipid transport.

the gene f <dig> initiates the extrinsic pathway of blood coagulation. in the literature, this gene has been tested for association to various diseases including blood coagulation disorders, hepatocellular carcinoma, cardiovascular diseases, cerebral infarction, coronary disease, and diabetic angiopathies.

the fifth gene on this list, igfbp <dig>  has been tested in the literature for association to various form of neoplasms. it has been proposed to participate in processes such as negative regulation of cell proliferation and regulation of cell growth.

we used david  <cit>  functional clustering with the genes in table  <dig>  the following two functional clusters reported in table  <dig> were identified on the basis of enrichment scores . we also performed  the test for differential connectivity of these functional classes in the two networks of lean versus heavy mice. the corresponding p-values were less than 10- <dig> . figure  <dig> illustrates the connectivity for the heavy mice network of the two functional gene clusters for gene pairs with scores which exceed  <dig>  in magnitude. for the lean mice network, there were no such connections between these gene pairs.

CONCLUSIONS
studying how the network structure changes between two conditions  offers important clues about the underlying biochemical pathways. differential network analysis, as we call it, provides formal statistical tests to undertake such an exploratory investigation. this is often done in conjunction with a differential gene expression analysis and offers a deeper understanding than that obtained by a list of genes that are differentially expressed between the two conditions. indeed such a list can be used as a filtering or selection step where the network structures of these genes are further explored under the two conditions. while the real data example presented in this paper is a fixed-time experiment, the methods could be used to examine whether a network is differentially expressed over two distinct time periods. however, analyzing dynamic networks with multiple conditions is a more complicated topic for future investigation.

we explore the use of connectivity scores in the construction of measures of the strength of a relationship between a pair of genes in a network and how this strength changes from one biological condition to another. simulation investigations of our method are carried out using appropriate sets of scores. although the formulas for the test statistics can easily be adapted to incorporate other measures of association or interaction, it is important to choose an appropriate measure of connectivity. pls scores tend to work well in most circumstances.

while the precise calibration of the statistical level is problematic, the resulting methods using an approximate level of p-value control results in reasonable performance . also, the utility of these methods for exploratory analysis is well demonstrated by the real data application.

there is scope of further theoretical work towards obtaining a better approximation to the statistical null distribution. development of appropriate global error rate control statistical adjustments is another interesting problem in this regard. essentially all the existing procedures rely on the independence  of multiple statistical tests which is not satisfied for testing change of interaction scores of pairs of genes. these issues will be investigated elsewhere.

