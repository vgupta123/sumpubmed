BACKGROUND
polyploidy has played a key role in the evolution of many plants  <cit> , and has important consequences with respect to transcriptional regulation and the silencing of genes  <cit> . however, polyploidy presents a particular problem with respect to genome analysis. polyploid genomes consist of two or more homeologous subgenomes, and sequence relatedness between these subgenomes makes determining the homeoallelic identity of genes and gene transcripts a particular challenge  <cit> .

bread wheat , one of the world’s major crop plants, is an important example polyploid. the bread wheat genome is hexaploid, comprised of three distinct a, b and d subgenomes , and originated from two successive cross-hybridization events. first, ~ <dig>  million years ago, the tetraploid triticum turgidum  arose from cross-hybridization between an a-genome donor diploid  and a b-genome donor diploid . second, ~ <dig>  years ago, t. aestivum emerged from cross-hybridization between t. turgidum and another wild diploid goatgrass   <cit> . the a, b and d subgenomes of bread wheat are themselves derived from a common ancestor  <cit> , and hence share extensive sequence relatedness . this sequence relatedness makes it difficult to precisely assign individual gene fragments or transcripts to their subgenome of origin, and in turn makes determination of an accurate bread wheat reference genome sequence problematic. nevertheless, despite their extensive sequence relatedness, the a, b and d genomes have diverged in sequence from their common ancestor, resulting in homeolog-specific polymorphisms . hsps are the positions in a polyploid genome where the homeologous subgenomes have different bases , and have often been used in transcriptomic and evolutionary studies, and to characterize homeolog-specific gene-expression  <cit> . however, these previous studies have involved only a limited number of genes, with genome-wide approaches being precluded by both genomic complexity and cost  <cit> .

the recent advent of next-generation sequencing technology now makes it possible to survey multiple hsps on a genome-wide basis  <cit> , and to determine the homeologous subgenome-identity of individual bases at those hsp sites . thus, we have developed ‘hsp base assignment using ngs data through diploid similarity’  as a method to characterize hsps in polyploid genomes. in essence, hands involves comparative alignments of next-generation sequencing reads from polyploid and diploid progenitor-relatives onto a suitable reference sequence. similarity of polyploid subgenomes with progenitor-relative diploids has recently been exploited to classify gene assemblies in bread wheat subgenomes  <cit>  and sequencing reads in allopolyploid cotton  <cit> , thus suggesting the viability of this approach for homeolog classification. in contrast, hands classifies individual hsp positions, and provides an added advantage in that it works even if only est or mrna datasets are available for polyploid genomes, thus allowing base characterization without the need of genomic assemblies.

although hands was developed with bread wheat in mind, it is applicable to all allopolyploid genomes, and relies on sequence similarity between the polyploid subgenomes and the corresponding diploid progenitors. in the specific case of wheat hands uses the sequence similarity between the three a, b and d bread wheat subgenomes and the genomes of three extant diploid relatives of the original subgenome donors . when applied to high-throughput rna sequencing  for bread wheat, hands correctly predicts subgenome-specific base-identity at over 90% of assayed hsps. thus hands allows rapid and accurate discovery of homeolog-specific base-identity at a genome-wide level.

RESULTS
the hands framework
hands uses the sequencing alignment/mapping  file  <cit>  of the polyploid genome  obtained using sequence alignment tools such as burrows-wheeler aligner  <cit>  along with the variants lists  for the progenitor-relative diploids) to assign base-identity to the polyploid subgenomes. the variant lists are tab-separated files containing sequence name, position, reference base and consensus base, and can be generated using tools such as samtools  <cit>  .

hands starts by optionally preprocessing the data to validate the hsps and sbss identified in the polyploid and progenitor-relative diploid genomes respectively. the preprocessing step is described in detail in note s <dig> in additional file  <dig>  once the preprocessing is done, hands considers the read alignments  for each gene simultaneously and proceeds in five steps . in step  <dig>  hands creates a base pattern for each read and counts the reads containing a particular base pattern. in step  <dig>  base patterns that are a result of sequencing error or embedded in other base patterns are removed. in step  <dig>  base patterns are assigned to one or more subgenomes based on their similarity with the corresponding diploid. in step  <dig>  base patterns are prioritized based on their percentage identity with the diploids, and bases are assigned to each subgenome iteratively discarding base patterns that contradict with the already assigned bases. in step  <dig>  the base patterns discarded in step  <dig> are re-used to characterize bases at unassigned positions. these steps are described in the next five subsections and are further explained in note s <dig> in additional file  <dig> using a detailed example.

step 1: creation of base patterns from aligned reads
in step  <dig>  hands considers each read aligned against the current gene in turn and creates a base pattern for that read. a base pattern is regarded as the sequence of the pairs  for all hsps found in the read. for paired-end data, alignments corresponding to both reads in the pair are considered together to generate a single base pattern for the pair. read pairs, where a nucleotide discrepancy is found at a particular hsp position in the forward and reverse reads are ignored as this suggests that one of the two reads had a sequencing error . note that this scenario will only occur when reads in a pair have some overlap between them. while creating the base patterns, hands groups the same base patterns together keeping track of the number of reads supporting a particular base pattern. once base patterns are obtained all further processing is done on these patterns and not on reads.

step 2: removal of potential sequencing errors and embedded base patterns
to remove the base patterns arising due to sequencing errors, hands calculates the base pairs  in each base pattern along with the number of reads supporting each pair. base patterns containing a base pair that is present in less than 5%  of the reads at these positions are ignored. hands further removes those base patterns that are embedded within another base pattern.

step 3: assignment of base patterns to individual genomes
once a list of valid base patterns is obtained for the current gene, hands assigns the base patterns to individual genomes using the sbs data for the diploid progenitors. a base pattern is assigned to a genome if at least 50%  of its bases at hsp positions match with the corresponding diploid genome. when calculating the percentage identity, positions with low coverage in the diploid  reads) as well as positions where a unique nucleotide is not present  are ignored.

step 4: assignment of bases to individual genomes
in step  <dig>  hands assigns bases to a genome iteratively using the patterns assigned to the genome in step  <dig>  for each hsp position, hands tabulates all nucleotides that are present in different base patterns assigned to an individual genome along with the base pattern having the maximum percentage identity with the diploid genome containing that particular nucleotide. if only one nucleotide is present at a particular position, it is assigned at that position. otherwise the nucleotide corresponding to the base pattern with the maximum percentage identity with the diploid progenitor is assigned at that position. if multiple nucleotides have a base pattern with the maximum percentage identity with the diploid then no assignment is made. once all the positions have been checked, base patterns that contradict with the assigned positions are removed and the process is continued until no more positions can be assigned.

step 5: assignment of bases to individual genomes using discarded base patterns
hands finally uses the base patterns that were discarded in step  <dig> from different genomes because they contradicted the assigned bases  to correct the bases assigned to the genomes. the base patterns and subsequently bases are assigned to the genome using the same strategy as above but now the percentage identity is calculated using the previously assigned bases instead of diploid data. a nucleotide is only changed at a particular hsp position if the base pattern containing that nucleotide has a better percentage identity than the base pattern corresponding to the currently assigned nucleotide.

provision for distant genomes
hands also caters for the scenario where one diploid progenitor may be relatively distant from the corresponding genome in the polyploid. one such example is the b genome in wheat. the donor of the b genome is unknown but is hypothesized to be similar to aegilops speltoides <cit> . in this scenario, a base pattern may have very low or no identity with the diploids. hands uses the fact that the base pattern must come from one of the subgenomes of the polyploid and consequently assigns the base pattern that is not assigned to any genome  in step  <dig> to the genome designated as the distant genome.

characterization of subgenome-specific base-identity in bread wheat
we used hands to characterize the hsps in bread wheat ). to avoid the complexity due to the large genome size  and high repetitive content  of wheat  <cit> , we sequenced the transcriptomes of t. aestivum , t. urartu , ae. speltoides  and ae. tauschii  using illumina paired-end sequencing technology , and aligned the resultant reads onto a wheat transcriptome reference sequence . this wheat transcriptome reference was constructed using wheat unigene build  <dig>  by concatenating the unigenes such that they were separated by  <dig> ‘n’s . the aligned reads were filtered to remove low quality alignments and variants  were called . hands was then used to characterize the hsps in t. aestivum based on the similarity with the sbss in the diploid progenitor-relatives. out of a total of  <dig>  hsp positions identified in t. aestivum, hands assigned bases at  <dig>  positions  to one or more subgenomes . out of the remaining  <dig>  positions where base assignments could not be made  <dig>   positions were such that one or more diploids had low coverage or an ambiguous base  was present at these positions and were consequently ignored.

assessment of hands base-identity assignment accuracy
to test the accuracy of this approach, we used t. aestivum nullisomic-tetrasomic  lines. nt lines are a set of lines each missing a single chromosome  which is substituted by an additional copy of a homeologous chromosome   <cit> , and provide an ideal framework to characterize wheat hsps at the genome-wide level as described in note s <dig> in additional file  <dig>  we focused our test on two of the seven chromosome groups of bread wheat by analyzing rna-seq data from wheat lines nullisomic for individual group  <dig>  and  <dig>  homeologs using illumina paired-end technology . as before, sequencing reads were aligned and filtered, and variants lists were generated . we then identified the a, b and d subgenome-specific bases corresponding to chromosomes  <dig> and  <dig> using nt lines  and compared these homeologous assignments against those generated by hands . a total of  <dig>  and  <dig>  hsps were identified on chromosomes  <dig> and  <dig>  respectively. positions where the diploid had low illumina sequencing read coverage or an ambiguous base as well as positions where base assignments could not be made using nt lines or the subgenome was silenced  were ignored and remaining positions were used for evaluating the accuracy of hands . hands characterized bases to the subgenomes with high accuracy for both chromosomes  with only a very small fraction of incorrectly assigned positions  and unassigned positions .

hsp bases were characterized for wheat chromosomes  <dig> and  <dig> using the t. aestivum nullisomic-tetrasomic lines and compared against the results obtained from hands. hands assigned the subgenome-specific base-identify with accuracy between 94% and 98%.

we further compared the percentages of bases shared between different subgenomes of wheat, and between wheat subgenomes and corresponding diploid progenitors using the base-identities assigned through nt lines and predicted using hands for chromosomes  <dig> and  <dig> to see if the patterns were consistent. the results are shown in figures 2a and 3a. in both cases, the differences in the percentages were not significant .

discussion
we have presented hands, a method for rapid and accurate characterization of hsps in polyploid genomes. hands uses next-generation sequencing data from the polyploid and the diploid progenitors to characterize bases in the polyploid genome at hsp positions without requiring to sequence a large number of genomes. this not only reduces the cost associated with genome sequencing but also eliminates the need of generating nt lines for each chromosome of the polyploid genome. the current implementation allows characterization of base-identities in any allopolyploid containing up to three subgenomes and is therefore applicable to a number of important polyploid genomes such as brassica napus   <cit> , gossypium hirsutum   <cit>  and avena sativa   <cit> . although, the results are presented in this paper using sam file generated by bwa and variant lists generated by samtools, it is important to note that hands is independent of the sequence mapping and variant calling software, and can characterize hsps using output from any standard mapping/variant calling tool.

when tested on chromosomes  <dig> and  <dig> of bread wheat, hands characterized bases to the subgenomes with high accuracy for both chromosomes. however, for both chromosomes  <dig> and  <dig>  the base assignment accuracy was lowest for the b subgenome . this is likely due to the fact that ae. speltoides, used as the b genome diploid progenitor-relative for base assignments, is actually more distantly related to the t. aestivum b subgenome than is the case for the a and d genome progenitor relatives  <cit> . nevertheless, hands still assigns bases with great accuracy  to the b subgenome, because it caters for the scenario where one progenitor may be relatively distant from the corresponding polyploid subgenome when assigning bases .

given this defined level of accuracy for group  <dig> and group  <dig> chromosomes, it is likely that hands works with >90% accuracy throughout the entire bread wheat genome. to further support this proposition, we calculated the percentage of shared bases between different subgenomes of wheat, and between wheat subgenomes and corresponding diploid progenitors across the whole in silico reference using the base-identities predicted by hands, and compared the results to those obtained for chromosomes  <dig> and  <dig> . no significant difference was found between the full and partial datasets .

we next sought to calculate the percentage of hsps that were tri-homeoallelic  in our datasets. it has been recently reported that the percentage of tri-homeoallelic hsps present in bread wheat is surprising low although it contains three homeologous subgenomes  <cit> . we found that the percentages of tri-homeoallelic hsps in partial  as well as full datasets were comparable to those reported earlier . this further supports the proposition that hands works with high accuracy across the whole in silico reference. moreover, it is possible that hands classification of individual hsps accounts for the greater accuracy of this method  versus the previous gene-assembly based method, which respectively gave accuracies of ~72% for the a, ~85% for the d and ~60% for the b genomes  <cit> .

CONCLUSIONS
in summary, hands allows accurate genome-wide discovery of subgenome-specific base-identity in polyploids. in the specific case of wheat, this advance will enhance our understanding of the complex genome architecture of this important crop plant. in particular, it provides the ability to relate, on a genome-wide basis, specific homeoallelic variants to particular agronomic traits, thus increasing the precision of crop-breeding solutions to address the challenge of global food security.

