BACKGROUND
model-based analysis and synthesis become increasingly important in systems biology . however, a significant obstacle to effective model-based studies comes from the fact that it is highly difficult to achieve the values of model parameters. a straightforward way to address this issue is to fit the model to the measured data by proper experimental design . nevertheless, such a fitting may usually fail, even for quite simple models, because some parameters in the model can be non-identifiable.

there are two major reasons for model non-identifiability. on the one hand, many biological models contain a large number of parameters to be estimated, among which some parameters may have functional interrelationships. this is largely because of the model structure when considering compound reaction networks . more important is that biologists experiment with living cells and therefore the possibilities to stimulate the cells are limited, i.e. the control signals and the initial condition cannot be chosen at will. this limitation leads to challenges in parameter estimation , in particular, the model can be non-identifiable, which is the concern of this paper.

as a consequence, the effect of one parameter will compensate that of another. these parameters are correlated each other and therefore non-identifiable  <cit> . on the other hand, because of limiting experimental facility, the measured data for parameter estimation are incomplete; in particular, in many cases only a part of the variables in the model can be measured. the input-output relations of a partially observed model may become highly complicated and lead to implicit parameter correlations, even if the model structure itself contains no functional relationships between the parameters  <cit> .

the existence of parameter correlations will lead to enormous difficulties in estimating the model parameters. as a consequence, the parameters cannot be correctly constrained, the landscape of the predicting errors is quite flat, and the sensitivities of the resulting parameters are sloppy . therefore, identifiability analysis presents a very important and necessary task before performing parameter estimation. although identifiability analysis of biological models has been extensively investigated in the past, the issue is far from being satisfactorily addressed .

in general, non-identifiable parameters in a model can be classified into structurally and practically non-identifiable parameters. structurally non-identifiable parameters are those which cannot be estimated based on any measurement data with any quality and quantity, since the parameter correlations in effect are independent of the experimental condition. in contrast, the interrelationships of practically non-identifiable parameters are either due to a partial observation or due to inaccurate data  <cit> . as a result, it is possible to uniquely estimate the parameters based on datasets generated in experimental design by properly determining the experimental condition and improving the quality of the measurement. in this way, the non-identifiability of the model can be remedied. the “practical identifiability” in this paper means the case in which a non-identifiable model becomes identifiable if the initial condition and control signals are properly selected and meanwhile if the measured datasets are noise-free. thus this provides a necessary condition for a practically identifiable model, i.e. even if this condition is satisfied, the model can be non-identifiable because of noisy data.

therefore, the aim of identifiability analysis should be not only to figure out the structural and/or practical identifiability of the model but also, most importantly, to find the dependences of the identifiability on experimental conditions, so that proper experiments can be designed to remedy the non-identifiability when indicated. in particular, the impact of control signals and the initial condition of the identifiability has rarely been emphasized in the previous studies.

linear ordinary differential equations  are widely used to describe biological systems  <cit> . many studies on identifiability analysis of linear dynamic models have been made and, in particular, methods for determining the structural identifiability have been developed for partially observed models . the laplace transformation methods were used for identifiability analysis of linear models  <cit> , but these studies did not consider parameter correlations based on analyzing the output sensitivity matrix. another aspect in this area is the detection of explicit identifiable combinations of non-identifiable parameters which can help for model reparameterization . more recently, identifiability conditions of fully observed linear models from one single dataset were presented; these conditions are related to the initial conditions of the system  <cit> .

using differential algebra, a priori methods were proposed to analyze structural identifiability of linear and nonlinear biological models without any requirement of measurements , based on which effective software tools have been established  <cit> . in  <cit>  it was pointed out that problems can arise by using differential algebra methods in testing the identifiability of systems started at some special initial conditions. however, from the previous studies for structural identifiability there are no suitable measures developed for remedying existing non-identifiability of a model. as a consequence, the accessible software tools will fail to run when unexpected but meaningful initial conditions and/or controls are provided, even for very simple linear models  <cit> .

the measured data are always associated with noisiness and limitation of the number of sampling points which also make model parameters non-identifiable  <cit> . therefore, a posteriori methods detect the identifiability of a model by numerically solving the fitting problem based on available data  <cit> . using the method of profile likelihood, it is possible to find pairwise functional relations of the non-identifiable parameters if the corresponding manifold is one-dimensional  <cit> . since the initial concentrations can be regarded as parameters to be estimated, the relation of the non-identifiability to the initial condition can be numerically characterized. as a result, the non-identifiability due to correlations can be remedied by means of defining proper initial conditions.

in a recent study  <cit> , we proposed a method that is able to analytically identify both pairwise parameter correlations and higher order interrelationships among parameters in nonlinear dynamic models. correlations are interpreted as surfaces in the subspaces of correlated parameters. explicit relations between the parameter correlations and the control signals can be derived by simply analyzing the sensitivity matrix of the right-hand side of the model equations. based on the correlation information obtained in this way both structural and practical non-identifiability can be clarified. the result of this correlation analysis provides a necessary condition for experimental design for the control signals in order to acquire suitable measurement data for unique parameter estimation. however, this method can only identify parameter correlations in fully observed models, i.e. it is required that all state variables be measurable, thus leading to limited applications of this method.

in this paper, we propose a simple method which can be used for identifying pairwise and higher order parameter correlations in partially observed linear dynamic models. an idealized measurement  is assumed in this study. it means that we derive the necessary condition of identifiable systems when such data are available. unlike previous approaches, explicit relations of the identifiability to initial condition and control functions can be found by our method, thus providing a useful guidance for experimental design for remedying the non-identifiability if available. our basic idea is to derive the output sensitivity matrix and detect the linear dependences of its columns, which can be simply made by using the laplace transformation and then solving a set of homogenous linear equations. the computations are quite straightforward and thus can be easily implemented into a software packet.

for parameter estimation, different species  measured from experiment leads to different output equations, due to which the model parameters may be non-identifiable. therefore, prior to the experiment for data acquisition, it is important to analyze the identifiability of the parameters, when some certain species will be measured. the method presented in this paper can be used for a priori identifiability analysis. in this way, the question which species should be measured, so that unique parameter estimation will be achieved, can be answered. thus, this is important for experimental design.

both structural and practical non-identifiability can be addressed by using the proposed method. in the case of structural non-identifiability, the identifiable parameter combinations can be determined, while, in the case of practical non-identifiability, this method can provide suggestions for experimental design  so as to remedy the non-identifiability. five linear compartmental models including an insulin receptor dynamics model are taken to demonstrate the effectiveness of our approach.

methods
output sensitivity matrix
in this paper, we consider general time-invariant linear state space models described as  <dig> x˙=ax+bu,x0=x <dig>   <dig> y=cx+du where eq.  and eq.  are state and output equations in which x∈rnx,u∈rnu,y∈rny are state, control and output vectors, respectively. x <dig> is the initial state vector. for the purpose of parameter estimation, the controls u and the initial condition x <dig> are regarded as being defined by experimental design.

the outputs y are considered as variables with available datasets  measured from experiment. in many situations, due to limiting experimental facility, only part of the state variables can be measured, i.e. ny < nx, which means that the model is partially observed. if, in the particular situation, ny = nx, the model is called fully observed. similarly, the initial state vector x <dig> may also be partially or fully observed, depending on the measurement facility. in the following, it will be seen that the impact of the availability of partial or full observations of x and/or x <dig> are significant on the parameter correlations and thus the identifiability of the model under consideration.

it should be noted that, in the case of an observable system, the state profiles can be uniquely reconstructed even if ny < nx. however, such a reconstruction can be made by different value sets of the parameters if there is a parameter correlation. this is due to the fact that the observability of a system depends only on the matrixes a and c, but the identifiability depends not only on a and c but also on the control signal and initial condition.

in eq.  and eq. , a∈rnx×nx,b∈rnx×nu,c∈rny×nx,d∈rny×nu are constant matrices with appropriate dimensions which contain na, nb, nc, nd parameters denoted in the vector form pa∈rna,pb∈rnb,pc∈rnc,pd∈rnd, respectively. then the vector of the whole parameters to be estimated is  <dig> pt=patpbtpctpdt 

it is noted that the corresponding vectors in pt will fall out, when one or more matrices among  contains no parameters to be estimated. to estimate the model parameters, one needs at first to check their identifiability. here we address this issue by identifying correlations among the parameters. to do this, it is necessary to analyze the linear dependencies of the columns of the output sensitivity matrix  <dig> ∂y∂p=∂y∂pa∂y∂pb∂y∂pc∂y∂pd where ∂y∂pa∈rny×na,∂y∂pb∈rny×nb,∂y∂pc∈rny×nc,∂y∂pd∈rny×nd are the matrices of the output sensitivities to the parameters in , respectively. thus the output sensitivity matrix ∂y∂p has ny rows and np = na + nb + nc + nd columns. the necessary condition of completely identifiable parameters of the model is that the columns of this matrix are linearly independent.

solving the state eq.  in the laplace form we have  <dig> xs=si−a−1bus+x <dig> where i∈rnx×nx is an identity matrix. it follows from the output equation eq.   <dig> ys=csi−a−1bus+x0+dus 

from eq. , it is straightforward to achieve the output sensitivities in the laplace form  <dig> ∂ys∂pa=csi−a−1maxs∂ys∂pb=csi−a−1mbus∂ys∂pc=mcxs∂ys∂pd=mdus 

where maxs=∂∂paaxs, mbus=∂∂pbbus, mcxs=∂∂pccxs and mdus=∂∂pddus are partial derivative matrices with ma∈rnx×na, mb∈rnx×nb , mc∈ny×nc and md∈ny×nd, in which the corresponding elements are linear to the elements of x and u, respectively. therefore, the output sensitivity matrix eq.  can be written as  <dig> ∂ys∂p=csi−a−1maxscsi−a−1mbusmcxsmdust 

according to eq.  and eq. , the elements in the output sensitivity matrix eq.  are functions of the parameters in the matrices a, b, c, d, the elements of the input vector u and of the initial condition vector x <dig>  in this way, explicit relationships of parameter sensitivities with the controls and the initial condition can be achieved, base on which both structural and practical identifiability issues can be addressed.

it is noted that in most previous studies on identifiability analysis of linear models only parameters in the matrix a were considered as being estimated. in this case, mb =  <dig>  mc =  <dig>  md =  <dig> and thus only the first term in eq.  remains, i.e.  <dig> ∂ys∂p=csi−a−1maxs 

moreover, in the case of y = x, then eq.  reduces to  <dig> ∂ys∂p=si−a−1maxs 

therefore, the parameter correlations can be determined easily by checking the linear dependencies of the columns of ma). the identification of parameter correlations in the case of y = x was in detail discussed in  <cit> .

identification of parameter correlations
to identify the correlations among the parameters, it is necessary to analyze the linear dependencies of the output sensitivity matrix eq.  which can be expressed as   <dig> ∂ys∂p=1Δ2qasqbsqcsqds where Δ = det and  <dig> qas=q <dig> s⋯q <dig> nasq <dig> s⋯q <dig> nas⋮⋮⋮qny,1s⋯qny,nas,qbs=q <dig> na+1s⋯q <dig> na+nbsq <dig> na+1s⋯q <dig> na+nbs⋮⋮⋮qny,na+1s⋯qny,na+nbsqcs=q <dig> na+nb+1s⋯q <dig> na+nb+ncsq <dig> na+nb+1s⋯q <dig> na+nb+ncs⋮⋮⋮qny,na+nb+1s⋯qny,na+nb+ncs,qcs=q <dig> na+nb+nc+1s⋯q <dig> npsq <dig> na+nb+nc+1s⋯q <dig> nps⋮⋮⋮qny,na+nb+nc+1s⋯qny,nps 

in eq. , each of the elements qi,j,  is a polynomial with the indeterminate s. as mentioned above, the coefficients of these polynomials will be functions of the parameters in pa, pb, pc, pd, the elements in the input vector u and in the initial condition vector x <dig>  it can be shown from additional file  <dig> that the highest order of the polynomials in the  <dig> matrices in eq.  will be  <dig>  2nx −  <dig>  2nx −  <dig>  2nx, respectively. based on eq. , eq.  can be rewritten as  <dig> ∂ys∂p=1Δ2q1sq2s⋯qnps where qjs∈rny,j= <dig> ⋯,np are the columns of the matrices in eq. . to check the linear dependencies of the columns in eq. , we introduce a vector α=α1α2⋯αnpt and let  <dig> α1q1s+α2q2s+⋯+αnpqnps= <dig> 

according to eq.  and eq. , eq.  consists of ny linear equations with respect to α1α2⋯αnp as unknowns. since qj,  are explicitly expressed polynomials, we can reorder the terms in eq.  and present it in the following polynomial form  <dig> γi,1s2nx+γi,2s2nx−1+⋯+γi,2nxs+γi,2nx+1= <dig> i= <dig> ⋯,ny where the coefficients γi,k,  are linear to the elements of α1α2⋯αnp. since s in eq.  is indeterminate, each coefficient of the polynomials in eq.  should be zero, i.e.  <dig> γi,k=βi,k,1α1+βi,k,2α2+⋯+βi,k,npαnp= <dig> where the coefficients βi,k,l,  are some functions of the model parameters, of the elements in the input vector as well as in the initial state vector. therefore, eq.  represents a set of homogeneous linear equations with α1α2⋯αnp as unknowns. the maximum number of the equations is ny.

it is to note that the highest order of the polynomials in eq.  is 2nx when all four matrices a, b, c, d contain parameters to be estimated. if the problem under consideration is not in this case, the highest order in eq.  should vary accordingly. for instance, if the model has parameters only in matrix a, as described by eq. , the highest order in eq.  will be 2nx −  <dig> and thus the maximum number of the equations in eq.  will be ny.

in general, the solution of eq.  consists of the following  <dig> possible cases.all unknowns are zero, i.e.  <dig> α1=α2=⋯=αnp= <dig> 

in this case, there is no correlation relationship among the parameters. it means that all parameters in the model are identifiable and one dataset is enough to uniquely estimate them.

a sub-group of k unknowns αl+1 ≠  <dig>  αl+2 ≠  <dig> ⋯, αl + k ≠  <dig> which lead to  <dig> αl+1ql+1s+αl+2ql+2s+⋯+αl+kql+ks= <dig> 

where l + k ≤ np. this means that the corresponding k parameters  are correlated in one group. if by solving eq. , u and x <dig> are cancelled, the solutions will be independent of the controls and the initial condition. then the corresponding parameters are structurally non-identifiable. this means that the parameters cannot be estimated based on any datasets.

if a model is structurally non-identifiable, there will exist identifiable combinations of the parameters and these combinations may have one or a finite number of solutions  <cit> . identifiable combinations are sub-groups of the correlated parameters expressing their explicit interrelationships, which can be obtained by solving the homogenous linear partial-differential equations  and eq. ) based on the result of αl+ <dig>  αl+ <dig> ⋯, αl+k.

in contrast, if the solutions of eq.  depend on the controls u and/or the initial condition x <dig>  the corresponding parameters are practically non-identifiable. since eq.  describes the parameter correlation based on u and x <dig> which cause a specific dataset, using  datasets from different controls and initial conditions, eq.  can be written as  <dig> αl+1ql+1rs+αl+2ql+2rs+⋯+αl+kql+krs= <dig> 

where  denotes using the dataset r caused by u and x <dig>  in this paper, for one dataset we mean the measured output profiles caused by an initial state condition and constant control signals during the experiment. if nd datasets with different controls and/or initial conditions are used, i.e. r =  <dig>  ⋯, nd, for the parameter estimation, the columns of the following matrix will be independent  <dig> qs=ql+11sql+21s⋯ql+k1sql+12sql+22s⋯ql+k2s⋮⋮⋮⋮ql+1sql+2nds⋯ql+knds 

where qs∈rnd×ny×l+k. the number of datasets nd should be so selected, that the total number of equations ) is greater than k. as a result, there will be αl+1 =⋯= αl+k =  <dig>  this means that the practical non-identifiability described as eq.  is remedied. in this way, the corresponding parameters  can be uniquely estimated.

in eq.  and eq. , the parameters are pairwise correlated if k =  <dig>  whereas there is a higher order interrelationship among the parameters if k >  <dig>  in a model with a large number of parameters to be estimated, there may be many sub-groups with different numbers of correlated parameters. all sub-groups can be determined by solving eq. . we denote nmax as the maximum number of parameters among the sub-groups. therefore, the number of  datasets from different control signals and initial conditions should be equal to or larger than the number of nmax divided by the number of equations in eq. , in order to remedy the practical non-identifiability of the model. the impact of control signals and the initial condition on the linear dependency of the columns in eq.  is implicitly given in eqs. -.



in summary, the method presented above can be used to identify parameter correlations related both to control signals and to the initial condition for partially observed linear systems. this is an extension of the method proposed in  <cit>  where the necessary conditions of parameter correlations were given only based on the model structure and a full state observation. however, the application of the method of this paper is limited due to the computations using symbolic algebra for solving eq. , since symbolic algebra has its limits in the size of the problem  it can solve. during this study, we have solved a series of problems with a maximum size of ten parameters with a commonly used personal computer.

RESULTS
example 1
a linear two-compartment model  <cit>   <dig> x˙1=−p1+p2x1+p3x2+u,x10=x10x˙2=p2x1−p3+p4x <dig> x20=x20y=x1/v 

this model describes a simple biochemical reaction network as shown in fig. 1a. this model is partially observed and the partial observation causes structural non-identifiability. unlike previous studies of this well-known model, the impact of the initial conditions on the identifiability is highlighted here. in this example, there are  <dig> parameters, i.e. pa = t, pc = v and then we have  <dig> maxs=−x1s−x1sx2s00x1s−x2s−x2s,mcxs=−1v2x1s fig.  <dig> biochemical reaction networks of the compartment models used in examples 1— <dig>  a: 2-compartment model in example 1; b: 3-compartment model in example 2; c: 3-compartment model in example 3; d: 4-compartment model in example 4



the laplace form of the state variables can be achieved by solving the state equations in eq.   <dig> x1s=1Δs+p3+p4us+x10+p3x20x2s=1Δp2us+x10+s+p1+p2x <dig> where Δ =  − p2p <dig>  according to eq. , the output sensitivity vector  is expressed as  <dig> ∂ys∂p=−1vΔs+p3+p4x1ss+p4x1s−s+p3+p4x2sp3x2sΔvx1st 

applying the expressions of eq.  to eq. , it follows  <dig> ∂ys∂p=−1v2Δ2vs+p3+p4s+p3+p4us+x10+p3x20vs+p4s+p3+p4us+x10+p3x20−vs+p4p2us+x10+s+p1+p2x20vp3p2us+x10+s+p1+p2x20s+p3+p4us+x10+p3x20Δt 

to analyze the linear dependencies of the  <dig> functions in eq.  we introduce  <dig> unknowns . by using the method described in the above section , we find α5 =  <dig>  i.e. the parameter v is uncorrelated with any other parameters and thus is uniquely identifiable. this result is trivial in fact, since v is immediately fixed if y and x <dig> are known, according to the last line of eq. .

it can be seen from eq.  that u and x <dig> have the same impact on the output sensitivities. thus, to see the influence of the initial conditions on the identifiability of the  <dig> parameters , we let u =  <dig> in the following analysis.x10 ≠  <dig>  x20 =  <dig>  the resulting output sensitivity to the individual parameters has the following relationship   <dig> ∂ys∂p1−∂ys∂p2+p3p2∂ys∂p3−p3p2∂ys∂p4= <dig> 

this means that the  <dig> parameters are correlated in one group and their interrelationship is independent of the value of x10 ≠  <dig>  i.e. they are structurally non-identifiable. by solving eq.  we can find the interrelationships of the sub-groups  of the parameters as {p2p <dig>  p1 + p <dig>  p3 + p4}. this result is the same as reported in the literature  <cit> . in this situation, it is impossible to uniquely estimate the parameters  based on any measured datasets of the output .

x10 =  <dig>  x20 ≠  <dig>  solving the linear homogenous linear equations  in this case leads to α3 =  <dig>  i.e. p <dig> is identifiable. and the output sensitivity to the other parameters has the following relationship  <dig> p4−p1−p2∂ys∂p1+p1+p2−p3−p4∂ys∂p2+p3∂ys∂p4= <dig> 

which means that  are correlated in one group and thus structurally non-identifiable. it is interesting to note from eq.  that the correlation relation of  is also related to the identifiable parameter p <dig> 

x10 ≠  <dig>  x20 ≠  <dig>  according to eq.  and the additional file  <dig>  it can be seen that the functional relationship of the  <dig> parameters  depend on the initial condition  if both x10 ≠  <dig> and x20 ≠  <dig>  in this situation, the parameters are practically non-identifiable. the  <dig> parameters are correlated in one group, i.e., nmax =  <dig>  and the number of equations in the form of eq.  is ny =  <dig>  therefore, the  <dig> parameters can be uniquely estimated based on fitting the model to at least nd =  <dig> datasets )) of the output  from different initial values of x10 ≠  <dig> and x20 ≠  <dig>  respectively.



to verify the above achieved results, we perform numerical parameter estimation by using the method developed in . the true parameter values in the model are assumed to be p1 =  <dig> , p2 =  <dig> , p3 =  <dig> , p4 =  <dig>  and we generate noise-free output data at  <dig> time points by simulation. for case  <dig>  one dataset for y is generated by x10 =  <dig>  x20 =  <dig>  to check the identifiable combinations {p2p <dig>  p1 + p <dig>  p3 + p4}, we repeat the parameter identification run by fixing p <dig> with a different value for each run. figure  <dig> shows the relationships of the parameters after the fitting which illustrate exactly the expected function values, i.e. p2p3 =  <dig> , p1 + p2 =  <dig> , p3 + p4 =  <dig> .fig.  <dig> estimation results of example  <dig>  the identifiable combinations of the parameters are validated by repeatedly fitting the model to one dataset from the initial condition x
10 ≠  <dig>  x
20 =  <dig>  the curves are from the results of  <dig> runs each of which with a different fixed value of p
 <dig>  a: p
2
p
3 =  <dig> ; b: p
1 + p
2 =  <dig> ; c: p
3 + p
4 =  <dig> 



for case  <dig>  one dataset for y is generated by x10 =  <dig>  x20 =  <dig>  indeed, only the true value of p3 =  <dig>  can be identified when fitting the  <dig> parameters to the dataset. for case  <dig>  we generate  <dig> datasets for y by x10 =  <dig>  x20 =  <dig> and x10 =  <dig>  x20 =  <dig>  respectively. then we fit the  <dig> parameters simultaneously to the  <dig> datasets, from which we obtain the estimated values of the parameters exactly as their true values.

furthermore, if the model in eq.  is fully observed, e.g., y1 = x <dig>  y2 = x <dig>  then all parameters in the model are identifiable. this can be easily seen from ma) in eq. , since its columns are linearly independent. as a result, one single dataset including the trajectories of y1 = x <dig>  y2 = x <dig> is enough to uniquely estimate the parameters in the model.

example 2
a linear three-compartment model  <cit>   <dig> x˙1=p13x3+p12x2−p21x1+u,x10=x10x˙2=p21x1−p12x <dig> x20=x20x˙3=−p13x <dig> x30=x30y=x <dig> 

the reaction network corresponding to this model is shown in fig. 1b. this model was studied in  <cit>  to demonstrate the failure of the identifiability test by using the differential algebra methods when x30 =  <dig>  this can be easily recognized by using our method. let pa = t, according to eq. , the functions in the output sensitivity vector will be .  <dig> q1s=s+p13us+x10s2+p12+p13us+x10+p12x20+p13x30s+p12p13us+x10+x20+x30q2s=−s+p13x20s2+p21+p13x20+p21us+x10s+p13k21us+x10+x20+x30q3s=p21x30s+p12+p21s 

according to eq.  and eq.  we obtain the following  <dig> homogeneous linear equations   <dig> us+x10α1−x20α2=0p12+2k13us+x10+p12x20+p13x30α1−p21+2p13x20+p21us+x10α2+p21x30α3=0p13p12+p13us+x10+p12x20+p13x30+p13p12us+x10+x20+x30α1−p13p21+p13x20+p21us+x10+p13p21us+x10+x20+x30α2+p21p12+p21x30α3=0p12α1−p21α2= <dig> 

it can be easily seen that if x30 =  <dig>  then α <dig> will disappear from eq. , i.e. α <dig> can be any value, which means that p <dig> is non-identifiable. on the contrary, if x30 ≠  <dig>  we have in eq.   <dig> linearly independent homogeneous equations with  <dig> unknowns and thus there should be α1 = α2 = α3 =  <dig>  which means that all three parameters are identifiable.

example 3
a linear three-compartment model  <cit>   <dig> x˙1=−p21+p31x1+p12x2+p13x3+u,x10=x10x˙2=p21x1−p12+p02x <dig> x20=x20x˙3=p31x1−p13+p03x <dig> x30=x30y=x <dig> 

the reaction network described by this model is shown in fig. 1c. the parameters to be estimated in this model are pa = t. the solution of the state equations in eq.  leads to  <dig> x1sx2sx3s=s+p21+p31−p12−p13−p21s+p12+p020−p310s+p13+p03−1us+x10x20x <dig> 

similar to example  <dig> we can obtain the laplace functions in the output sensitivity vector as follows  <dig> q1s=−s+p13+p03s+p02x1sq2s=−s+p12+p02s+p03x1sq3s=s+p13+p03s+p02x2sq4s=s+p12+p02s+p03x3sq5s=−k21s+p13+p03x2sq6s=−k13s+p12+p02x3s 

by introducing  <dig> unknowns , the dependencies of the output sensitivities on the control and the initial condition can be derived from eq.  and eq. . if x20 = x30 =  <dig> and u + x10 ≠  <dig>  the resulting homogeneous linear equations in the form of eq.  are as follows  <dig> α1+α2=02a+b+p02α1+2b+a+p03α2+p21α3+p31α4=0a2+2ab+p02+bp02α1+b2+2ba+p03+ap03α2+p212a+p02α3+p312b+p03α4+p21p12α5+p31p13α6=0a2b+p02+2abp02α1+b2a+p03+2abp03α2+p21a2+2ap02α3+p31b2+2bp03α4+2ap21p12α5+2bp31p13α6=0a2bp02α1+b2ap03α2+k21a2p02α3+p31b2p03α4+p21p12a2α5+p31p13b2α6= <dig> where a = p13 + p <dig>  b = p12 + p <dig>  it can be seen that u + x10 ≠  <dig> does not appear in eq. . solving the  <dig> equations for the  <dig> unknowns in eq.  with respect to α <dig>  we find  <dig> α2=−α <dig> α3=p13p31α <dig> α4=−p13p31α <dig> α5=−p12p21α <dig> α6=p12p21α <dig> 

thus the output sensitivities to the parameters has the following relation  <dig> ∂ys∂p21−∂ys∂p31+p13p31∂ys∂p13−∂ys∂p03−p12p21∂ys∂k12−∂ys∂k02= <dig> which means that all  <dig> parameters are correlated in one group and their interrelationship is independent of u + x10 ≠  <dig>  thus the parameters in this model are structurally non-identifiable when x20 = x30 =  <dig>  in addition, we can solve eq.  to obtain its local solutions as {p02 + p <dig>  p03 + p <dig>  p21 + p <dig>  p12p <dig>  p13p31} as well as its global solutions as  <dig> φ1=p21+p31φ2=p02+p12p03+p13φ3=p02+p12+p03+p13φ4=p03p31p02+p12+p02p21p03+p13φ5=p31p02+p12+p03+p21p03+p13+p <dig> which are the identifiable combinations of the parameters, as given in  <cit> . to verify these parameter relations, numerical parameter estimation is carried out by assuming p02 =  <dig>  p12 =  <dig>  p03 =  <dig>  p13 =  <dig> , p21 =  <dig>  p31 =  <dig> as the true values of the parameters. a dataset for y containing  <dig> sampling points in the time period  is generated by x10 = x20 = x30 =  <dig>  u =  <dig>  then we repeatedly fit the parameters to the dataset, except for p <dig> which is fixed with different values in the range . the estimation results are shown in fig.  <dig>  exactly validating the global solutions expressed as eq. .fig.  <dig> estimation results of example  <dig>  the identifiable combinations of the parameters are validated by repeatedly fitting the model to one dataset from x
10 = x
20 = x
30 =  <dig>  u =  <dig>  the curves are from the results of  <dig> runs each of which with a different fixed value of p
 <dig>  a: p
21 + p
31 =  <dig> ; b: the relationship between p
02 + p
 <dig> and p
03 + p
13; c: the relationship between p
 <dig> and p
12; d: the relationship between p
 <dig> and p
13; e: the relationship between p
 <dig> and p
21; f: the relationship between p
 <dig> and p
31; g: p
03
p
31 + p
02
p
21 =  <dig> ; h: p
31 + p
21 =  <dig> 



it can be seen from fig. 3a that the relationship between p <dig> and p <dig> is indeed a straight line, namely p21 + p31 =  <dig> . from fig. 3b, it is interesting to see that the relationship between p02 + p <dig> and p03 + p <dig> is shown by two separate points. this is because both their summation and their product are constant, as indicated in φ <dig>  φ <dig> of eq. . this special property leads to the fact that both p02 + p <dig> and p03 + p <dig> have two solutions, i.e., there are two lines to represent the relationship of p02 + p <dig> as well as p03 + p <dig>  respectively, as shown in fig. 3c and d. correspondingly, the relationship of p12p21as well as p13p <dig> is also twofold, as shown in fig. 3e and f, respectively. the estimated results corresponding to the last two identifiable combinations in eq.  are shown in fig. 3g and h.

to remedy the non-identifiability, let x20 ≠  <dig>  x30 ≠  <dig>  then similar to eq. , there will be  <dig> linear equations with respect to . this means that the  <dig> parameters are correlated in one group, i.e., nmax =  <dig>  since the correlation relationships now depend on u + x10 ≠  <dig> and x20 ≠  <dig>  x30 ≠  <dig>  the parameters are practically identifiable. the number of equations in the form of eq.  is ny =  <dig>  as a result,  <dig> datasets with different values of u + x10 ≠  <dig> and x20 ≠  <dig>  x30 ≠  <dig> are needed to uniquely estimate the parameters of the model.

example 4
a linear four-compartment model  <cit>   <dig> x˙1=−p31x1+p13x3+u,x10=x10x˙2=−p42x2+p24x <dig> x20=x20x˙3=p31x1−p03+p13+p43x <dig> x30=x30x˙4=p42x2+p43x3−p04+p24x <dig> x40=x40y1=x1y2=x <dig> 

figure 1d shows the biochemical reaction network of this model. in this model, there are  <dig> parameters pa = t and  <dig> state variables among which two are output variables. in the case of u ≠  <dig>  x10 = x20 = x30 = x40 =  <dig>  the parameters are structurally non-identifiable where the identifiable combinations of the correlated parameters are expressed as {p <dig>  p <dig>  p04p <dig>  p24p <dig>  p03 + p <dig>  p24 + p42 + p04}  <cit> . the same results of the identifiable combinations are obtained by using our method which is much simpler to deal with, as described in the following.

from eq. , we have  <dig> a=−p310p1300−p420p24p310−p03+p13+p4300p42p43−p04+p <dig> b= <dig> c= <dig> and  <dig> maxs=−x1sx3s0000000−x2sx4s000x1s−x3s00−x3s−x3s000x2s−x4sx3s0−x4s 

since in this example we have two output variables, to determine the parameter correlations we have to consider  <dig> α1∂y1∂p31∂y2∂p31+α2∂y1∂p13∂y2∂p13+α3∂y1∂p42∂y2∂p42+α4∂y1∂p24∂y2∂p24+α5∂y1∂p43∂y2∂p43+α6∂y1∂p03∂y2∂p03+α7∂y1∂p04∂y2∂p04= <dig> where the output sensitivities are expressed in the following form   <dig> ∂ys∂p=1Δ−b11−b13x1b11−b13x300−b13x3−b13x30−b21−b23x1b21−b23x3−b22−b24x2b22−b24x4b24−b23x3−b23x3−b24x <dig> 

it can be clearly seen from the first two columns of eq.  and eq.  that α1 = α2 =  <dig>  which means that p <dig>  p <dig> are uniquely identifiable. from the 5th and 6th columns of the first row in eq.  we have α5 + α6 =  <dig> , i.e.  <dig> ∂y1∂p43−∂y1∂p03= <dig> 

thus p <dig>  p <dig> are pairwise correlated. furthermore, based on the second row of eq.  and eq.  the following results can be obtained :  <dig> p24∂y2∂p24−p43∂y2∂p43= <dig>   <dig> p42∂y2∂p42−∂y2∂p24−p04∂y2∂p04−∂y2∂p24= <dig> 

eq. –eq.  indicate that there exist  <dig> separate correlation groups in this example. the maximum number of parameters among the groups is  <dig>  the  solutions of these  <dig> equations lead to the identifiable combinations of the parameters in the form of p43 + p <dig>  p24p <dig>  p42p <dig> and p42 + p04 + p <dig>  respectively, beside the two identifiable parameters p <dig>  p <dig> 

to numerically verify the results, p31 =  <dig> , p13 =  <dig> , p03 =  <dig> , p04 =  <dig> , p24 =  <dig> , p42 =  <dig> , p43 =  <dig>  are used as the true values of the parameters. one noise-free dataset for y <dig>  y <dig> is generated by x10 = x20 = x30 = x40 =  <dig> and u =  <dig>  through simulation. then we repeatedly fit the parameters to the dataset, except for p <dig> which is fixed with a different value for each run of the fitting. as expected, p <dig>  p <dig> are always at their true values after each run, whereas the other parameters have correlated relationships in the forms of their identifiable combinations. figure  <dig> shows these relationships based on the results of  <dig> runs for the parameter estimation. it can be seen from fig. 4a to d that, indeed, p43 + p03 =  <dig> , p24p43 =  <dig> , p42p04 =  <dig> , and p42 + p04 + p24 =  <dig>  are obtained by the parameter estimation.fig.  <dig> estimation results of example  <dig>  the identifiable combinations of the parameters are validated by repeatedly fitting the model to one dataset from x
10 = x
20 = x
30 = x
40 =  <dig> and u ≠  <dig>  the curves are from the results of  <dig> runs each of which with a different fixed value of p
 <dig>  a: p
43 + p
03 =  <dig> ; b: p
24
p
43 =  <dig> ; c: p
42
p
04 =  <dig> ; d: p
42 + p
04 + p
24 =  <dig> 



also in this example, we can consider x20 ≠  <dig>  x30 ≠  <dig>  x40 ≠  <dig> for remedying the non-identifiability. since the maximum number of correlated parameter groups is nmax =  <dig>  the number of equations in the form of eq.  is ny =  <dig>  therefore, one dataset for y <dig>  y <dig> from an initial condition x10 ≠  <dig>  x20 ≠  <dig>  x30 ≠  <dig>  x40 ≠  <dig> will be enough to uniquely estimate the  <dig> parameters in the model.

example 5
insulin receptor dynamics model  <cit> .

many physiological processes such as glucose uptake, lipid-, protein- and glycogen-synthesis, to name the most important, are regulated by insulin after binding to the insulin receptor. the latter is located in the cytoplasma membrane  <cit> . the insulin receptor  is a dynamic cellular macromolecule. upon insulin binding, a series of processes follow, including endocytosis of the ir-insulin complex, endosomal processing, sequestration of ligand  from the receptor, receptor inactivation as well as receptor recycling to the cell surface  <cit> .

in several early studies, simple models describing insulin receptor dynamics were proposed  where either a subset of the whole process was considered or a few subunits were lumped into single reaction steps. more detailed models of insulin signaling pathways were developed and simulation studies were performed in . however, parameter values such as rate constants in these models were partially taken from literature and partially estimated through experimental data.

a general five-compartment ir dynamics model was developed in  <cit>  and its parameters were estimated based on simultaneously fitting to the measured datasets published in  <cit> . this model describes the endosomal trafficking dynamics of hepatic insulin receptor consisting of ir autophosphorylation after receptor binding, ir endosomal internalization and trafficking, insulin dissociation from and dephosphorylation of internalized ir, and finally recycling of the insulin-free, dephosphorylated ir to the plasma membrane  <cit> . the state equations of the general five-compartment model are given as follows  <cit>   <dig> x˙1=p12x2+p15x5−p21u+p51x1x˙2=p21ux1−p12+p32x2x˙3=p32x2−p43x3x˙4=p43x3−p54x4x˙5=p51x1+p54x4−p15x <dig> where the state variables denote the concentrations of the components, with x <dig> as unbound surface ir, x <dig> as bound surface ir, x <dig> as bound-phosphorylated surface ir, x <dig> as bound-phosphorylated internalized ir, and x <dig> as unbound internalized ir. the control variable u is considered as a constant insulin input , while the initial condition of eq.  is given as x1 = 100 %, and xi =  <dig> for i ≠  <dig>  <cit> .

since the control variable u is a constant, the nonlinear term p21u in eq.  can be regarded as a parameter p21′ to be estimated. as a result, eq.  becomes a linear model which can be analyzed by our method. here, we consider three measured datasets used in  <cit>  for parameter estimation, i.e. ir autophosphorylation from  <cit> , ir internalization from  <cit> , and remaining surface ir from  <cit> . these measured species are mixtures of the components denoted as state variables in eq. , respectively, leading to the following output equations  <cit>   <dig> y1=x3+x <dig>   <dig> y2=x4+x <dig>   <dig> y3=x2+x <dig> where y <dig> is the percentage of total  phosphorylated ir, y <dig> is the percentage of total internalized ir, y <dig> is the percentage of total ir on the cell surface.

we are concerned with the identifiability of the  <dig> parameters in eq. , when one or a combination of the above output equations is used for parameter estimation. based on our method, it is found that, when only eq.  is employed as an output equation,  <dig> parameters  are non-identifiable, while  <dig> parameters  are identifiable. in particular, the relationship of the  <dig> correlated parameters is expressed as follows  <dig> ∂y1s∂p21′+p51p12−p15+p32−p51∂y1s∂p51−p12p21′−p12p32−p15p21′+p15p32+p21′p32−p322+p32p51p21′p12−p15+p32−p51∂y1s∂p12−p32p21′∂y1s∂p32= <dig> 

this means that, using a dataset of ir autophosphorylation , it is impossible to estimate all of the parameters of the model . nevertheless, our computation results show that all of the  <dig> parameters are identifiable, i.e. there is no parameter correlation, when either eq.  or eq.  is used as an output equation. as a result, either a dataset of the ir internalization  or a dataset of the remaining surface ir  is enough for unique estimation of the  <dig> parameters of the model, when the measured data are noise-free. obviously, unique estimation can also be achieved when a combination of the  <dig> output equations are used , as was performed in  <cit> .

CONCLUSIONS
a partial observation of state variables usually leads to non-identifiable parameters even for pretty simple models. to address this problem, a method for identifying parameter correlations in partially observed linear dynamic models is presented in this paper. the basic idea is to derive the output sensitivity matrix and analyze the linear dependences of the columns in this matrix. thus the method is quite simple, i.e. only the laplace transformation and linear algebra are required to derive the results. a special feature of our method is its explicit coupling of parameter correlations to control signals and the initial condition which can be used for experimental design, so that proper  datasets can be generated for unique parameter estimation. in this way, the practically non-identifiable parameters can be estimated. several partially observed linear compartmental models are used to demonstrate the capability of the proposed method for identifying the parameter correlations. results derived from our method are verified by numerical parameter estimation. the extension of this method to partially observed nonlinear models could be a future study.

additional file
additional file 1: 
derivation of the sensitivity matrix and solutions of the homogeneous linear equations in example  <dig>   <dig> and  <dig>  this file contains detailed derivations and descriptions of the methods and associated results of the examples. 



competing interests

the authors declare that they have no competing interests.

author’s contributions

pl developed the methodology, wrote the manuscript and supervised the study. qdv wrote the software and designed the case studies. both authors read and approved the final manuscript.

