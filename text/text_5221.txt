BACKGROUND
cellular development requires the precise control of gene expression states. transcription factors  are involved in this regulatory process through their combinatorial binding to dna. although one factor may be identified as the global regulator of a cell differentiation process, it often works together with other tfs in complexes to achieve precise control of expression at different loci  <cit> . by coupling high-throughput sequencing technologies with chromatin immunoprecipitation , recent studies have identified thousands of regions along the human genome where tfs co-localize to interact and form gene regulatory complexes  <cit> . however, such binding information for any given tf is only available for a limited number of cell types. it is therefore of great theoretical as well as practical importance to ask how far differences in binding patterns between cell types limit our ability to use tf binding patterns from one cell type to explain gene expression in another. can we infer a universal regulatory network from tf binding experiments in a small range of cell types, so that by using just tf expression data we can predict gene expression in other cell types? if this turns out to be difficult, the inference of a universal gene regulatory network for a broad range of cell types from just, say, expression data without detailed knowledge of actual tf binding in each cell type might be impossible.

a variety of computational and experimental approaches can be used to measure the effect of co-localized tfs on a single target gene  <cit> . one way is by exploring the transcriptome over many different conditions, in order to relate gene expression changes to varying levels of tf expression  <cit> . to assess this relationship between tfs and genes, we can measure how well the tf expression levels predict the expression levels of genes whose promoters they bind. quantitative models have been useful for predicting the level of gene expression given a limited set of predictors  <cit> . by assuming that tf binding sites are conserved in the genome of an organism, these models described gene expression as a function of tf binding affinity, which they estimated using tf expression and tf binding motifs  <cit> . however, by using predicted tf binding sites rather than observed sites, these models achieved limited accuracy at predicting human cell type-specific expression changes. some more recent models have used binding sites of multiple tfs observed through chip-seq  <cit> , but they estimate tf binding affinity only for the cell type used in chip-seq, and therefore, cannot predict gene expression in other cell types. furthermore, no existing model incorporates information about the co-localization of tf binding sites, which may help reduce the number of non-relevant tf predictors in the model.

in this study, we used a reduced set of co-localized tfs close to a target gene to select tfs as predictors in a nonlinear regression model for predicting the expression of the target gene from tf expression levels. regression coefficients for the nonlinear regression models were then inferred from gene expression data across different cell types and conditions. expression prediction models were tested for the amount of expression prediction accuracy that can be achieved across  <dig> distinct cell types and  <dig> major tissues, given that tf binding information for the selection of predictors came from only the k <dig> cell type.

as potential predictors we used tfs known to regulate a wide range of cellular processes . for example, gata <dig> and nfe <dig> are known to be involved in the control of hematopoiesis  <cit> , while two widely studied oncogenes, myc and fos, are more ubiquitous tfs  <cit> . for each gene, a nonlinear regression model describing the gene’s expression level is constructed using only tfs that have binding sites co-localized within the gene’s promoter region. in accordance with common terminology, we define these regions of binding site co-localization as cis-regulatory modules . the regression models account for both linear and non-linear effects as well as interactions between tfs. in the case of yy <dig>  the tf is known to co-regulate genes, but may itself be regulated by other tfs  <cit> . the models we show describe combinatorial functions for each set of co-localized tfs, which allowed us to determine whether a tf, such as yy <dig>  enhances, represses, or has no effect in the presence of other tfs. we identified many interacting pairs of tfs not known to co-operatively work together, presumably because they were previously examined in a limited number of cell types or using only linear regression methods.

we took the prediction accuracy of a regression based on tfs in a particular crm for a target gene as an indicator of how much influence this crm exerts over the target. this allowed us to analyse the relationship between the features of crms, such as their tf composition, and their effect on target genes. we compared crms from chip-seq data on the gm <dig> cell line with equivalent crms from the k <dig> cell line for differences in binding tfs, and the effect of these differences on prediction accuracy. our analysis shows how far the extensive collection of gene expression and genome-wide tf binding data across multiple human cell types can be exploited to provide valuable insight about regulators of cell differentiation. it also shows the limitations if binding data are available only for a restricted set of cell types and conditions.

methods
chip-seq data
we obtained chip-seq data of  <dig> tfs in the k <dig> cell line and  <dig> tfs in the gm <dig> cell line from the encode consortium  <cit> . each data set contains a signal map of chip dna fragments, where the signal height is the number of overlapping fragments at each nucleotide position in the genome . enrichment of genomic regions for protein binding was tested against a set of input dna control . peaks indicating regions with sufficient signal above peak height threshold  were identified using the peakseq algorithm  <cit> . after conducting a genome-wide scan for peaks, we examined tracks of putative binding sites for each of the  <dig> tfs . the position of each binding site was defined by the center of each chip-seq peak. adjacent binding sites that are within 500bp of each other are grouped. groups with peaks from two or more different tfs are defined as crms. we mapped a crm to a gene if the centre of the crm is within 1kb of the gene’s transcription start site . all distances reported are from the centre of the crm to the tss. non-specific binding of tfs may cause chip-seq to detect randomly distributed binding signals. to reduce false positives we check that a particular combination of tf binding sites occurs more often than in randomly generated crms. random crms are generated by resampling  random tfs to replace the original tfs at binding sites in each crm. the positions of gene tss are the same as those used in the mapping microarray probe sets to genes. differences in tf binding between crms was measured by the hamming distance, which is the number of tfs that appear in one crm but not the other. the jaccard distance, which is a ratio between the hamming distance and the number of tfs binding in either crm, is also the proportion of tfs that are different between two crms.

gene expression data
cell type specific patterns of mrna expression were extracted from the genome novartis foundation symatlas data set  <cit> , which measured  <dig> human tissue samples and cell lines  using affymetric genechip hg-133u arrays  <cit> . the gene expression profiles of  <dig> distinct populations of human hematopoietic cells were from the broad institute dmap project  <cit> . k <dig> and gm <dig> gene expression data were generated by ernst et al.   <cit> . quantile normalization was applied across expression arrays and the log expression intensities for each gene was mean centered. probe sets were mapped to a gene’s tss via transcript identifiers and probe set annotations provided by the ensembl database . for cases where there are more than one probe set mapping to a gene’s tss, the probe set with the most variable expression profile was accepted. in total,  <dig> genes were profiled in the data sets, but rna genes and other non-protein coding genes were not included in our analysis. for more information on the expression profiles of the co-localized tfs, see additional file  <dig> 

expression prediction model
we employed a simple and flexible modeling framework to describe the relationship between co-localized tfs and target genes  <cit> . the generalized additive model  is interpretable, because each predictor term is simply the expression of a single tf which occupies a crm. the gam implementation in the r package ”mgcv” provides the option of smoothing spline functions for each predictor term, which gives us the flexibility of incorporating non-linear relationships between tfs and genes  <cit> . for each gene-crm pair, we considered a model with one or more additive functions: 

  e=β0+∑j=1nsj+∑1≤j<k≤nsjk 

where e is the expected log expression of the target gene in cell type iβ <dig> is the mean expression set to zero, xijis the log expression of tf j in cell type in is the number of tfs in the crm, and sj is a spline function, where the degree of smoothing is chosen by cross validation in the mgcv package. as opposed to using linear predictors, the estimated non-parametric function can reveal non-linearities in the effect of tf on target gene. in this model we also allow for second-order interactions where sjk is now a set of unknown partial bidimensional functions. this accounts for possible interactions between tfs in a crm, whereby a tf’s effect on gene expression varies according to the effect of another tf in the crm. to ensure that each model does not simply describe the mean expression level of a target gene, we mean centered all the expression profiles.

training and testing
every gene with a crm located within its promoter region  was tested for expression prediction. for each crm-gene pair, we inferred the parameters β <dig>  sj and sjk for the regression equation above using the expression profiles xij of the co-localized tfs j and yi of the gene across samples i∈st from the training set st. we then predicted gene expression across the samples i∈spin the test set sp using the tf expression xijin those samples as predictors. the prediction step gave us a predicted gene expression value ŷi for each target gene in a sample i∈sp. the prediction accuracy was then measured by calculating the square of the pearson correlation coefficient  between the predicted expression ŷi and the observed expression yifor all samples in sp. 5-fold cross-validation was performed to assess how well predictions for each gene would generalize to new sample data sets. the r <dig> statistics reported were averaged over the cross-validations. when predicting expression variation across a single cell types, leave-one-out cross-validation was performed. the r2statistic in this case is the square correlation coefficient between the predicted ŷg and observed yg for a single cell type in spacross genes g∈g, where g is the set of all genes with crms in their promoters. this involved training the models on expression profiles from all cell types except for one and then predicting gene expression for the left-out cell type. since each cell or tissue type has two biological replicates, we used the average r2between replicates. we used the wilcoxon rank sum test to compare the r <dig> and the squared prediction error statistics between models generated by different crms.

assessing expression prediction significance
the r2statistic for prediction by any given model may be biased by the correlation between expression profiles in the training set and test set. therefore, we tested to see if the observed co-localized tfs predict target gene expression better than any other set of tfs. for each gene expression model, we produce two types of null expression models with the same number of predictors, but we resampled the tfs. in one type of null model, instead of using the tfs observed to be in the crm, we randomly resample from the  <dig> different tfs found in k <dig>  for the second type of null model, we randomly resample tfs from a larger set of  <dig> different tfs identified as important for regulators of hematopoiesis  <cit> . a tf is resampled only if it is expressed in k <dig> cells, and if its binding sequence motif is enriched  in the target gene . further details about the six different motif-finding methods and a motif-clustering pipeline used by novershtern et al. can be found from the broad dmap project . finally, we use the  <dig> replicates of null models to bootstrap each r <dig> statistic generated by our expression models. this gives us a p-value for a how well the observed co-localized tfs in a crm predicts target gene expression compared to other possible sets of tfs.

RESULTS
high number of tf co-localization hot-spots along the genome
in order to gain insight into the distribution of tf co-localization across the human genome, we first analyzed the chip-seq data of  <dig> tfs from the k <dig> cell line  <cit> . peaks for dna fragment enrichment in each data set are signals along the genome for where a specific tf binds. by comparing all tf binding sites in a cell type, we identified  <dig> regions where two or more tfs co-localize within 500bp of each other. as shown in figure  <dig>  a high concentration of co-localizations lie within 1kb of the transcription start site . we defined regions of tf co-localization as crms, because they are in the vicinity of gene promoters and may have regulatory potential. each crm contains different combinations of co-localized tfs. in the k <dig> cell, we identified  <dig> crms containing two or more bound tfs, and with  <dig> different binding combinations . we noticed that  <dig> unique combinations of co-localized tfs have a probability of less than 1×10− <dig> of occurring as many times by chance. all known pairs of interacting tfs  appear in significant combinations. only such frequently occurring combinations of tfs in crms were analyzed further to determine if they have potential to influence target gene expression.

co-localized tfs predict target gene expression
we examined  <dig> genes in the k <dig> cell type with crms positioned within their promoter region , and generated expression prediction models for every crm-gene pair. a crm is mapped to a gene if at least one of their tf binding sites is located within the promoter. the co-localized tfs in each crm are the explanatory variables used in each model. we assessed whether a crm is an active gene regulatory region by how well its tfs can predict the expression of target genes.

high accuracy of expression prediction for single samples
we analyzed the k <dig> chip-seq data to identify the co-localized tf binding sites, and assessed the presence of active gene regulatory regions across  <dig> different tissue and cell samples from the novartis symatlas data set. the expression predictions, as shown in figure  <dig>  correlated well with the observed gene expression in cd <dig> t-cells, but less well for pancreatic islet cells. the models predict gene expression more accurately for samples with a single cell type compared to samples composed of many different cell types . given that tf expression levels and tf-tf interactions are cell type-specific  <cit> , the expression prediction models are expected to be less accurate for heterogenous samples. the prediction accuracy for our models also differs depending on the cell type in each sample. compared to other cell types, we observed a significantly higher expression prediction accuracy  for samples containing blood cells or certain neuronal cells. since the prediction accuracy measure is an indicator of how likely the crm is an active gene regulatory region, the results suggest that k <dig> crms may only be active in cell types of a common lineage or with similar phenotypic characteristics.

crms explain cell type-specific expression
since the prediction accuracy for gene expression models is high for blood cell samples in the novartis symatlas, we further assessed differences in prediction accuracy when the gene expression models were applied to distinct hematopoietic cell types   <cit> . co-localized tfs in k <dig> crms were used once again to define the explanatory variables in each gene expression model. we analyzed the predictions made for gene expression in each terminally differentiated hematopoietic cell type . the models show that k <dig> crms explain a higher proportion of expression for b-cells and monocytes compared to other cell types. the high proportion of explained variation may be due to by chance correlation in expression between genes and tfs, or due to low variation in expression for many of the genes. hence, we tested whether a specific set of tf expression profiles predicts a specific target gene’s expression better than a random set of tfs by comparing the r <dig> from our gene expression models to the r2from null models. one type of null model was generated by replacing each tf occupying a crm by a randomly selected one from the list of  <dig> tfs found in k <dig>  the other null model was generated from tfs that were identified as important for hematopoiesis and which have binding motifs enriched in the target gene  <cit> . the null models based on binding motifs show that there are other tfs not profiled in k <dig> which may be important regulators in other cells, like hsc and t-cells. only for monocytic cells did the expression prediction models, generated from k <dig> crms, explain significantly more variation  than the two null models. it has been reported that k <dig> cells have characteristics similar to early-stage monocytes  <cit> , and their gene-tf relationships may too be similar.

dissimilar crms have different regulatory activities
we assessed how robust the tf co-localization patterns are across the different cell types. from the chip-seq data for the k <dig> cell line and the gm <dig> cell line, we compared the binding profiles of  <dig> tfs assayed in both cell lines. of the  <dig> crms detected along the k <dig> genome and  <dig> crms in gm <dig>   <dig> of the regions in both cell types overlap. two crms are considered to overlap if the intervals of the crms both overlap by more than 50%. within these overlapping crm regions, we examined the dissimilarity of tf binding site profiles between the cell types. the dissimilarity between overlapping crms was estimated by the number of changes in the tf binding profile  and by the proportion of different tf binding sites . at the promoter regions, we observed less dissimilarity in crms between k <dig> and gm <dig> than by chance . 62% of the overlapping crms have a difference in binding of one or two tfs between the cell types, and 63% of those contain only three or four tfs in k <dig>  interestingly, at the promoters of genes, which are differentially expressed between k <dig> and gm <dig>  there is a higher than expected proportion of overlapping crms which have no difference in tf binding. when we predicted the level of expression for these genes using the co-localized tfs, we observed a mean squared prediction error  of  <dig>  for expression levels in gm <dig>  but a mpse of  <dig>  for expression levels in k <dig>  although gm <dig> and k <dig> have the same tfs co-localized at the promoters for some differentially expressed genes, it seems that only in gm <dig> are the co-localized tfs showing a regulatory effect on the target gene.

the extensive dissimilarity in tf binding profiles at gene promoters between the two hematopoietic cell types could also influence differential expression. to examine the cell type-specific regulatory effect crms have on target genes, we compared the dissimilarity in tf binding between k <dig> and gm <dig> to any difference in expression prediction accuracy. for each target gene, we constructed two expression prediction models which differ in their predictor terms. one model contains predictors which are co-localized tfs that bind to crms in the k <dig> cell. in the other model, the co-localized tfs are those that bind to crms detected in the gm <dig> cell. both sets of models were trained on the dmap expression data set of  <dig> distinct hematopoietic cell populations. we then assessed how well the two sets of models predicted target gene expression in k <dig>  the models generated from gm <dig> crms that are identical to k <dig> crms had a mspe of  <dig> . in contrast, a mspe of  <dig>  was observed for models generated from gm <dig> crms that are 80% dissimilar in tf binding compared to their corresponding k <dig> crms. the models generated from gm <dig> crms, where more than 50% of the tf binding sites are different from the corresponding k <dig> crms, have significantly higher expression prediction errors . there is no significant difference in expression prediction errors  if less than 30% of the tf binding sites are different. the general trend of expression prediction errors seem to be increasing for gm <dig> crms that are more dissimilar to k <dig> crms . this suggests that prediction of gene expression is sensitive to the cell type-specificity of the tf binding profiles.

tf co-localization patterns specific to differentially expressed genes
the differential expression between genes in k <dig> and gm <dig> seems to correspond to the occurrence of specific tfs in crms . genes that are under-expressed in gm <dig> compared to k <dig> have a higher than expected number of tfs binding promoters only in k <dig>  in contrast, genes expressed higher in gm <dig> compared to k <dig> have a higher than expected number of tfs binding to promoters only in gm <dig>  the absence and presence of tfs that correlate with over-expression and under-expression of genes may indicate the role of these tfs as activators or repressors. this is most apparent for egr <dig>  gabp, and max. however, tfs interact with other factors in crms, so the main effect of a tf is difficult to define. we found that different factors co-localize with yy <dig> and fos in k <dig> and gm <dig> cells , and this could explain why binding by those tfs are associated with both over-expression and under-expression of genes. when we compared how well crms detected in k <dig> and gm <dig> predicted the expression of the top  <dig> genes with the most variable expression across hematopoietic cell types, neither k <dig> nor gm <dig> crms had significantly high prediction accuracy across all cell types . despite this, we still see that some k <dig> and gm <dig> crms can accurately predict the expression of genes in some cell types. in the case of a possible tumor suppressor, bnip3l, the combination of tfs fos and pu <dig> binding to the gene’s promoter  predicted the gene’s expression accurately only in b-cells. differences in the prediction accuracy of a gene exist even between very similar cell types. for example, the expression of another possible tumor suppressor, lrig <dig>  in early-stage erythrocytes and monocytes is accurately predicted  using k <dig> crms, but its expression in late-stage erythrocytes and monocytes is not predicted accurately. when we compare prediction accuracy of k <dig> crms to gm <dig>  we see that lrig <dig> is better predicted by the k <dig> crm across most cell types . this could be explained by the missing egr <dig> binding site and the additional fos, taf <dig>  and yy <dig> binding sites in the k <dig> crm compared to the gm <dig> crm . given that k <dig> cells belong more to the myeloid lineage and gm <dig> cells belong more to the lymphoid lineage of blood cell development, it is surprising that there is no indication of k <dig> or gm <dig> crms predicting expression accurately across genes in their respective blood cell lineages.

non-linear interactions between tfs and target genes
it is necessary to understand the combinatorial relationships between tfs given the high co-localization of tfs in the promoter regions. an advantage of modeling each target gene’s expression using a specific crm is that we can describe the relationship between the target gene and multiple tfs. of the  <dig> total k <dig> crms tested,  <dig> crms  modeled using non-linear spline functions on the tf predictors fit significantly better  compared to linear models. the tf-target expression profiles  clearly illustrates the non-linear relationship that target gene, smndc <dig>  has with its tf predictors, mycmax, and yy <dig>  our model uses myc as a predictor, which is reassuring considering that myc is known to form a complex with max <cit> . furthermore, the u-shaped expression profile of myc when plotted against smndc <dig> suggests that myc has divergent roles in different tissues. this divergent role of tfs not only appears in different tissues, but also in different genes. the smoothing functions from our models suggest that tfs like myc and max may have both repressor and activator functionalities depending on their target gene  . it is interesting to note that yy <dig> and myc also seem to interact differently with the same target gene . non-linear regression allowed us to incorporate tf-tf interactions into our expression prediction models, however, of all the crms we examined in this study, only  <dig> % of them have significant tf-tf interaction terms when used in models to predict target gene expression.

discussion
in summary, we have identified and characterized various regions of co-localized tfs in human k <dig> and gm <dig> cells. the difference in co-localization patterns between gm <dig> and k <dig> cells explains the differential expression in genes that may determine cell states. dynamic crm occupancy have been suggested as a regulator of temporal gene expression during cell development, but it cannot be inferred from tf binding motifs or static expression values  <cit> . subsequently, our gene expression models were unable to predict with high accuracy the gene expression profiles of cell types that do not arise from a lineage similar to that of k <dig>  the systematic analysis of crms dissimilar between k <dig> and gm <dig>  demonstrated that k <dig> gene expression could not be explained using gm <dig> crms if its tf binding profiles are too dissimilar from that of the k <dig> tf binding profiles. nevertheless, we found several cases where tf combinations detected in k <dig> or gm <dig> crms could be used to predict gene expression in other cell types. genes for which we know little about, like lrig <dig>  but associated with poor prognosis of different cancer types  <cit> , have been detected by our method to correlate with the expression of three tfs  across blood cell groups.

this study assumes that expression levels of the tfs explain less target gene expression if their binding locations are found further away from the target gene’s tss. this could be justified by the decreasing affinity and regulatory influence on the target gene as the crm is positioned further away from the tss  <cit> . the observed decrease in prediction accuracy by crms further than 1kb from the tss is the reason for why we considered only crms proximal to the target gene when predicting gene expression in a single cell sample . nevertheless, more distal crms can also have a large effect on target gene expression if dna is folded in a way that distant elements can interact  <cit> . a more complete expression prediction model may be to include co-localized tfs which also bind distal to a target gene.

the tfs examined in this study are involved in many processes and are co-expressed with many different genes. this means that the high prediction accuracy may be due to the by chance selection of tfs which are co-expressed with the target gene. this could result in over-fitting of the models, therefore, it was important to compare the prediction accuracy with null models. we selected crms which describe target gene expression with high accuracy across cell types, and examined features of those models that are indicative of tf binding position. we found that most of these crms contain a high number of co-localized tfs, some of which are known to form heterodimers. for instance, pairs of tfs known to form heterodimers, such as myc-maxnfya-nfyb, and fos-jun, co-occur in many of the detected crms. target genes whose expression is not accurately predicted and have a low number of co-localized tf predictors in their promoters may be better modeled by nucleosome occupancy signals, or other epigenetic determinants  <cit> . these other signals may also explain some of the spatial variability in our expression predictions. for instance, detection of open chromatin in the promoter region of a gene may indicate more tfs that bind to the region and regulate the gene  <cit> .

in this study, we demonstrate that many of the highly predictive expression models describe non-linear interactions between tfs and target genes. this suggests that many tfs have divergent roles in regulating gene expression, for example, a tf may contribute to activating a gene in one cell type but repress it in other cell types. when we modeled the gene expression of smndc <dig>  its tf regulator myc is shown to have repression activity only during low levels of yy <dig>  although we detected co-occurring binding sites for both myc and yy <dig>  our expression model suggests that yy <dig> silences the repression activity of myc. this is consistent with recent findings showing that yy <dig> negatively regulates myc activity in certain tumour cells  <cit> . another example of negative regulation between tfs is the repression of fos by yy <dig>  of the  <dig> crms detected which contain both fos and yy <dig> binding sites, only one of these crms significantly predicted target gene expression. the under-representation of possible regulatory modules containing both fos and yy <dig> may be due to the transcriptional repression of the fos gene by yy <dig> <cit> . this repression activity of other tfs may explain why we cannot clearly define the effect of yy <dig> on differentially expressed target genes. although not captured in our models, the repressor activity of yy <dig> is regulated through acetylation by p <dig> and pcaf <cit> . the lack of post-translational information in our models represents a limitation in the inference of tf activity.

CONCLUSIONS
our simple method of modeling gene expression based on the expression of co-localized tfs have shown that cell type-specific tf binding information is required for determining cell type-specific gene expression. however, by modeling each gene individually, we have shown that tf combinations detected in one cell type could in some cases predict gene expression in other cell types. this could suggest possible regulators of a gene in a cell type for which we do not have tf binding data. further extension of this basic approach may be needed to account for tfs that bind to non-genic regions and interact over a large genomic distance due to tertiary chromosome structure  <cit> . this requires integration of additional genomic markers for identifying target genes of distal regulators. since we expect more cell type-specific data to be generated on tf binding and chromatin structures, our perspective of dynamic crm occupancy will only become more complex. therefore, we hope that this approach of integrating co-localized tfs to predict target gene expression will provide a useful way of capturing the combinatorial effect of tfs in different human cell types.

abbreviations
crm, cis-regulatory module; tf, transcription factor; tss, transcription start site; mse, mean squared prediction error.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
dw, wo, and lw conceived the study. dw, ar, and lw designed the experiments. dw conducted the experiments and performed the analysis. dw wrote the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1:
supplementary methods, figures and tables. contains additional information on methods, supplementary figures 1– <dig> and supplementary tables 1– <dig> 

click here for file

 additional file 2:
supplementary data. contains additional information on supplementary data set of crm locations.

click here for file

 acknowledgements
this work was supported by the european commission marie curie actions fp <dig> grant , by the british heart foundation grant , and by natural sciences and engineering council of canada postgraduate scholarship . we also thank the encode consortium for making their data freely available.
