BACKGROUND
an important goal of modern genomics is to identify interacting proteins and characterize the structure and function of the corresponding complexes  <cit> . there are many complexes in even a simple organism; for example several hundred have been identified in yeast  <cit> . experimental structure determination for all of them is impractical, although determining a representative set should eventually be possible  <cit> . therefore, methods for structure prediction are useful  <cit> . the most tractable situation occurs when the structures of the two partners are known separately. indeed, in many  protein–protein complexes, the three-dimensional structure of each partner is very close to its structure when alone. in this case, the prediction amounts to positioning one protein with respect to the other. the problem can be divided further into two parts: generating a number of reasonable, putative, complex structures , and identifying the correct one  <cit> . the second problem, recognizing the biologically correct complex among a possibly-large set of candidate structures, is referred to as the "scoring" or "interface recognition" problem.

in this work, we develop a series of energy functions for interface recognition. to handle many proteins on a genomic scale, the computational model should be simple and efficient  <cit> . therefore, following many previous workers, we take a coarse-grained view of the protein structures, with interactions described at the amino acid level, and parameterize the model empirically. protein quaternary structure analysis is an active field  <cit> , and several protein–protein interaction potentials have already been developed. information on protein structures has been used, as well as sequence conservation and covariance between interacting partners  <cit> . sequence conservation and three-dimensional structures give different information and should be combined to provide the maximum predictive power. here, we take the view that sequence conservation can be used in a separate step to filter possible models, and we parameterize our model using structural information only.

we pursue two main goals. first, with increased computing power, we can employ larger numbers of structures and more realistic decoys than in previous work, which should lead to improved parameterization. second and more importantly, we consider a series of models of increasing complexity. the simplest one distinguishes just two types of amino acids: hydrophobic and polar. the most complex one distinguishes all twenty amino acid types. the intermediate ones distinguish three, four, and six amino acid types. by deriving a hierarchy of energy functions, we can determine what model complexity is needed to solve the interface recognition problem.

a third goal is to help clarify an important biological problem: what amount of chemical diversity is needed to construct specific protein–protein interfaces. indeed, the structures and interactions of natural proteins are  encoded in their amino acid sequences. however, chemically similar amino acids in a protein can often be interchanged without altering noticeably the structure, and protein engineers have already reproduced naturally occuring protein folds using reduced sets of amino acids  <cit> . very early stages in evolution may have made use of such reduced sets of amino acids.

the energy function tested in this work relies on pairwise amino acid potentials with the simplest possible, stepwise, distance-dependence: the interaction energy between two amino acids is zero above a certain distance threshold and constant below it. potentials with a more complex distance-dependence are known to give superior results  <cit> . nevertheless, we focused on the present, stepwise potentials in order to analyse the effect of reduced amino acid alphabets in a simple context.

to parameterize the energy functions, we use an optimization method introduced earlier for fold recognition  <cit> . the goal is to obtain interresidue interaction parameters that assign a low energy to the correct, native complex structure, and a higher energy to alternate, incorrect structures. a dataset of  <dig> protein–protein complexes of known structure are used to train and test the models. for each one, about  <dig> decoy structures are generated using a realistic docking procedure, in which the protein partners are flexible and interact through a molecular mechanics energy function. the decoy sets will be described in detail elsewhere. half of the structures form an "optimization set"; the others form a "test set". as an additional restraint on the energy function, we include in the optimization criterion its performance for fold recognition, using an analogous dataset of  <dig> monomeric protein structures with associated decoys.

the energy functions are subjected to a series of blind tests. these involve our own test set of native and decoy structures, sets of native and decoy structures made available by sternberg, vakser and coworkers through the world wide web  <cit> , and  <dig> target structures submitted to the capri experiment for protein–protein complex structure prediction . results are comparable to two other, recent, empirical models due to bastolla, lu et al  <cit> . for example, the capri target structure is correctly ranked ahead of 90% of its decoys in  <dig> cases out of  <dig>  however, our hierarchical approach yields valuable additional insights. thus, the hierarchy of amino acid alphabets leads to a coherent hierarchy of energy functions, with qualitatively similar parameters for similar amino acid types at all levels. remarkably, the performance with six amino acid classes is equivalent to that of the most detailed. 20-class energy function, and the performance with four classes is only slightly worse. this indicates that six or even four carefully chosen amino acid classes are sufficient to encode the true complexity of the residue–residue interaction model. it suggests that six amino acid types are also sufficient to provide interface specificity for many protein–protein complexes.

RESULTS
we first describe briefly the optimization of energy functions for fold recognition of monomeric proteins  <cit>  and their behavior with amino acid alphabets of increasing complexity. then we consider the recognition of protein–protein interfaces. finally, we describe the application to a series of blind tests. in supplementary material, we analyze the convergence and robustness of the parameter optimization procedure .

fold recognition for monomeric structures
the energy function is a sum over pairs of residues less than  <dig>  Å apart. each pair of residue types has its own interaction parameter. several parameter optimizations were conducted, using the amino acid alphabets in fig.  <dig>  which contain  <dig>   <dig>   <dig>   <dig>  and  <dig> amino acid types, respectively. we considered  <dig> native protein structures, along with sets of decoys constructed by threading each sequence onto unrelated structures. the structures and their decoys were split into an optimization set  and a test set . the energy parameters were chosen to maximize the q¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgrbqugaqeaaaa@2def@ parameter , summed over the proteins of the optimization set. the quality of each energy function can be measured by the final, optimized q¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgrbqugaqeaaaa@2def@ value, which ranges from  <dig> to 100% and reflects the ability of the energy function to group near-native structures in the low-energy range. a second quality measure is the "discrimination percentage" d: the percentage of native structures in the optimization set that are successfully predicted to be of lower energy than all their decoys. the quality measures are obtained by cross validation; i.e., we compute q¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgrbqugaqeaaaa@2def@ and d for the structures of the test set, which are not used for parameter optimization. the quality of the predictions are summarized in table  <dig> 

the simplest amino acid alphabet is a binary one, with an approximate separation into hydrophobic and hydrophilic amino acids . the corresponding optimal parameters are given in table  <dig>  they assign favorable energies to intraclass contacts and an unfavorable energy to interclass  contacts. this very simple model already gives a respectable discrimination, , partly due to the simplicity of our monomeric decoy set, obtained by a rudimentary threading procedure . the three residue alphabet puts the aromatic residues in a class of their own. the corresponding energy parameters  are qualitatively consistent with the binary ones. the discriminating power is slightly increased .

with four and six classes, the discrimination d increases markedly, to 85% and 89%, respectively . the four-class alphabet puts l, v, i, m and c into a separate group. the parameter values  remain consistent with the simpler alphabets. for example, aromatic–aromatic interactions remain very favorable, while polar–polar interactions remain unfavorable, except for those between the two classes {ednq} and {krh}.

the most detailed energy function, with all twenty amino acid types, is subject to overoptimization, or overtraining: performance on the test set is 3–4% below that on the optimization set . in fact, the performance on the test set is slightly inferior  to that of the best six-class energy function. for the simpler alphabets , the performance on the test set was as good, or slightly better than on the optimization set.

fig.  <dig> shows the discrimination d for different protein size ranges, for all alphabets. for proteins of more than  <dig> amino acids, discrimination is 100% with either four, six, or twenty residue classes. with two and three amino acid classes, discrimination reaches 100% when the protein size reaches  <dig> amino acids, except for a few large proteins. the lower discrimination for small proteins is partly due to their higher number of decoys .

the amino acid groupings used here  were derived from the blosum <dig> similarity matrix by levy et al  <cit> . residues with similar physicochemical properties are clustered together. the parameters show a good consistency with the hierarchy of amino acid types, as discussed above. when an amino acid group is subdivided, the parameters corresponding to the subgroups are usually in qualitative agreement with the parent group. this is not due to bias in the optimization procedure, since the best parameters at each level were usually obtained from a random scan of parameter space . another six-class grouping , proposed by shakhnovich and coworkers  <cit> , gave significantly poorer results, with a d of 71%.

recognizing protein–protein interfaces
characterizing the structures
to parameterize and test the energy functions, we used  <dig> protein–protein complex structures, including  <dig> homodimers and  <dig> heterodimers. we constructed about  <dig> decoys each . the decoys were constructed by a realistic  docking procedure, with flexible proteins interacting through a molecular mechanics energy function. some of the native structures' properties are summarized in fig.  <dig>  the distribution of interface sizes has a peak at about  <dig> Å <dig>  with a broad tail extending up to about  <dig> Å <dig>  the propensities px of each amino acid type x to be found at the interface are also shown. px is defined as

 px=log⁡fxint⁡/fxswp,
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgqbaudawgaawcbagaemiwagfabeaakiabg2da9igbcygasjabc+gavjabceganjabdagamnaadaaaleaacqwgybawaeaacyggpbqacqggubgbcqgg0badaagccqggvawlcqwgmbgzdaqhaawcbagaemiwagfabagaee4uamlaee4vaclaeeiuaafaaogaeiilawcaaa@4371@ 

where fxint⁡
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgmbgzdaqhaawcbagaemiwagfabagagiyaakmaeioba4maeiidaqhaaaaa@3397@ and fxswp
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgmbgzdaqhaawcbagaemiwagfabagaee4uamlaee4vaclaeeiuaafaaaaa@32f0@ are the proportion of amino acid type x found in the protein–protein interfaces and in the swissprot data base, respectively  <cit> . a positive propensity px means that the proportion of x in the interfaces is higher than the overall proportion of x in swissprot. hydrophobic types, especially met, trp, tyr and phe are overrepresented, compared to their natural abundance in proteins. among the polar amino acids, arg and his are overrepresented, and lys is underrepresented. homodimeric interfaces  tend to be larger and more hydrophobic than heterodimers. nevertheless, the trends in fig.  <dig> agree with recent surveys of protein–protein interfaces  <cit> .

to illustrate our decoy sets, fig.  <dig> shows two native structures  along with a simplified representation of their decoy series. the series contain  <dig> and  <dig> decoys each. decoys are produced by fixing one or the other of the partners, and positioning the other using a flexible docking procedure . in fig.  <dig>  one partner  is arbitrarily taken as a reference, and the distribution of the other  around it is shown . partner b is seen to be widely distributed around a, with a wide variety of orientations. by construction, each decoy has a native-like interface size and a limited distortion of the internal structure of both a and b. the energy distributions for these same series of structures are discussed in the next section. the decoy series for a third, typical, dimer is illustrated in fig.  <dig> in a different way. for each amino acid of one member of the dimer, fig.  <dig> shows the number of decoys where it participates in the protein–protein interface. we see, again, that the surface coverage of one partner by the other in the decoy sets is rather thorough.

recognition power with different amino acid alphabets
the energy functions for interface recognition were optimized using a combination of monomeric and dimeric structures . we considered two optimization sets, containing respectively  <dig> and  <dig> dimeric structures and their associated decoys, along with  <dig> monomeric structures and their decoys. we denote them os <dig> and os <dig>  the dimeric structures not belonging to os <dig> form the test set 1; similarly for os <dig>  the amino acid subdivisions into classes are the same as for the monomeric energy functions above. the prediction results are summarized in table  <dig>  the optimized energy parameters are in tables  <dig>   <dig> and in supplementary material . to measure performance, we employ dint, the percentage of native interfaces ranked above all their decoys, and q¯int
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgrbqugaqeamaabaaaleaacqwgpbqacqwgubgbcqwg0badaeqaaaaa@324c@, the average of q¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgrbqugaqeaaaa@2def@ over all the protein–protein complexes. dint and q¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgrbqugaqeaaaa@2def@ are exactly analogous to d and q¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgrbqugaqeaaaa@2def@ , but they only include the interface recognition statistics; fold recognition statistics are not included .

aresults for the parameter sets produced with os <dig>  bresults for the parameter sets produced with os <dig>  cresults on the optimization set. d results on the test set. eq¯int
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgrbqugaqeamaabaaaleaacqwgpbqacqwgubgbcqwg0badaeqaaaaa@324c@ and dint include only the performance for interface recognition . ewith the bastolla or lu energy functions.

the optimal energy parameters with the binary alphabet are consistent with the ones derived for fold recognition . the parameters obtained using os <dig> and os <dig> are almost identical. discrimination is fair, with a dint of 47% and a q¯int
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgrbqugaqeamaabaaaleaacqwgpbqacqwgubgbcqwg0badaeqaaaaa@324c@ of 87% for both the os <dig> and os <dig> sets. the energy parameters with the ternary alphabet are consistent with the binary ones. contacts between members of the two "hydrophobic" classes are stabilizing, for example. the discrimination power has increased: q¯int
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgrbqugaqeamaabaaaleaacqwgpbqacqwgubgbcqwg0badaeqaaaaa@324c@ = 89% and dint = 53% .

with the four-class alphabet, q¯int
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgrbqugaqeamaabaaaleaacqwgpbqacqwgubgbcqwg0badaeqaaaaa@324c@ and dint increase sharply, to 94% and 64%, respectively. consistent with the monomeric results, contacts within and between the {livimc} and {fyw} classes are the most stabilizing. optimal parameters from os <dig> and os <dig> are similar. the rms deviation between the os <dig> and os <dig> energy matrices  is  <dig>  kcal/mol.

performance improves only slightly with six classes: q¯int
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgrbqugaqeamaabaaaleaacqwgpbqacqwgubgbcqwg0badaeqaaaaa@324c@ = 95% and dint = 66%. with the complete, 20-class alphabet, there is almost no further improvement: q¯int
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgrbqugaqeamaabaaaleaacqwgpbqacqwgubgbcqwg0badaeqaaaaa@324c@ is 94% and dint is 68%. it appears that for the simple, residue–residue model used here, 4– <dig> amino acid classes are sufficient to encode the actual complexity of the model.

to illustrate further the behavior of our energy functions, we consider the structures 1ar <dig>  1bjf, and 1fbt, which represent three typical situations. the energy spectra for the three decoy series are shown in fig.  <dig>  using the energy functions with two, six, and twenty amino acid classes.

• 1ar0: with  <dig> classes, discrimination is successful. the native complex is very stable compared to the decoys.

• 1bjf: the native complex is not recognized as the lowest-energy structure, but it has the third-best energy and is well-separated from the rest of the energy distribution .

• 1fbt: this structure illustrates the worst case. the energy function is unable to recognize the native complex at any level of alphabet complexity. the native energy is quite high. the position of the native structure in the energy spectrum is only  <dig>  standard deviations below the average decoy.

to illustrate the diversity of the decoy sets, we also calculated energy spectra with a "random energy" model. decoys are not explicitly built; rather, we count the number of interface contacts in the native dimer a:b, say n contacts; we replace them by n contacts established between n random pairs, where the first amino acid is drawn from the surface of a and the second from the surface of b. given the rather large numbers of interface constants, the corresponding energy spectra are essentially gaussian, with a standard deviation that is easy to compute from the composition in amino acid types . the distribution mean is taken to be the same as that of our decoy sets. the 2-class random energy spectra are shown in fig.  <dig> . we see that our decoy sets lead to more diverse energies than the random energy model.

finally, for 1ar <dig>  1bjf, and 1fbt, fig.  <dig> illustrates our ability to discriminate decoys as a function of their deviations from the native structure. for the best case, 1aro, there is a clear energy increase as one moves away from the native structure . for 1bjf, the native structure has a low energy, while the closest decoy structures are much higher. for 1fbt, the energy/structure correlation is fair, even though the native structure is not well-discriminated; the decoys that have a lower energy correspond to very different structures with a different, competing binding mode. energy/structure correlations will be studied in more detail in future work. notice that the decoy sets typically contain some, but not very many structures that are very close to native. this is not the goal of our docking approach, which focuses on the structural quality of the decoys , the size of the interfaces , and seeks to produce diverse interfaces. for the present class of energy functions, the number and nature of interface contacts are the most important decoy properties, and we believe these are adequately sampled with our procedure; this should lead to a successful parameterization. in contrast, we systematically include near-native structures in the blind testing of the energy functions further on.

analysis of the energy parameters and amino acid classes
the simplified amino acid alphabets used here were derived from a clustering procedure based on the blosum <dig> similarity matrix . an alternative classification can be obtained by performing a clustering based on the optimized energy matrix, constructed with all  <dig> amino acid types . by comparing these two classifications, we can assess the robustness and consistency of the simplified alphabets. the two methods give somewhat different clusters, as shown in fig.  <dig>  at the lowest level, the energy function does not give a meaningful separation into two classes. it gives the same hydrophobic cluster as the blosum <dig> matrix, with a good internal coherence . but the blosum <dig> polar group is split in two by the energy clustering. at the six-class level, the two methods give the exact same amino acid groupings.

fig.  <dig> illustrates the best energy function for each level of complexity, using a contour representation. the functions are seen, again, to form a coherent hierarchy. we note that with three, four, and six amino acid types, the best function was obtained independently of the simpler functions. only the 20-class function was obtained using one of the simpler functions as a starting point . thus, the consistency between the energy functions with the largest and the smaller alphabets is largely independent of the optimization procedure.

to further check the internal consistency of our hierarchy of energy functions, we take a "top-down" approach, using the complete, 20-class function as a starting point to infer simplified functions, which can be compared to the simplified functions described above. to infer a 6-class function, for example, we simply average the appropriate elements in the complete matrix. thus, the lines and columns corresponding to k, r, and h in the complete  <dig> ×  <dig> matrix form a submatrix, which is averaged to give the {krh}{krh} interaction in the inferred 6-class matrix. we also compute the standard deviation over the submatrix, which measures the internal consistency of the {krh} subgroup within the complete matrix. results for  <dig> and  <dig> classes are given in table 5; results for  <dig> and  <dig> classes are qualitatively similar and are not shown. the simplified functions inferred in this way are in general agreement with the functions described above, obtained by direct optimization of q¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgrbqugaqeaaaa@2def@.

evaluating the energy functions in blind tests
a test set of heterodimers
our optimization and test sets are mostly made up of homodimers, due to the relative scarceness of heterodimers in the pdb . to assess the effect of this, we set aside for a blind test  <dig> heterodimers that are not homologous to any structures used in the parameterization. table  <dig> gives the performance for these sets of our best energy functions, as well as the bastolla function. discrimination is about 54% , compared to about 68% for the homodimers .  results are also listed for the heterodimers in the two optimization sets and are quite similar . the weaker discrimination d <dig> gives a success rate of about 71% . clearly, it is easier to discriminate the homodimers, which usually have larger interfaces and stronger binding constants. a similar behavior and discrimination quality are seen below for the other blind tests.

decoys constructed by other methods: sternberg and vakser decoys
limited series of protein–protein structures have been made available by sternberg  and vakser  and coworkers, along with  <dig> high-quality decoys each. they are listed in supplementary material: see additional file  <dig>  supp <dig> ps. these series have been used in the past to assess energy functions, including one function of the same form as ours  <cit>  and some more complicated ones  <cit> . we use them for a blind test of our energy functions. with the sternberg structures, our best energy function ranked the native complex among the top ten structures in just three cases out of ten . our best function is the 20-class function optimized using os <dig> ; the 20-class function optimized using os <dig> gave slightly poorer results. very poor scoring occurred for three complexes . the 1avz complex, for example, has the lowest interface similarity between the top decoys and the native structure . its native interface is unusually small, with an area of just  <dig> Å <dig> and only  <dig> interresidue contacts across the interface. the other failures were for 1brc, 1bgs, 1dfj, 1wq <dig>  2pcc and 2sic. for ibrc, two near-native structures were ranked among the top five. these decoys have rms deviations of just  <dig>  and  <dig>  Å from the native complex, so that 1brc can actually be considered a near-success. for 1bgs, the parameters optimized using os <dig> correctly ranked the 1bgs experimental structure first. for 1ugs, 2pcc and 2sic, a near-native decoy is highly-ranked . for wq <dig>  the native structure is ranked last; however, decoys  <dig> and  <dig> are ranked 6th and 10th. 1dfj gives the worst results. the native structure is ranked last by our energy functions. no decoy ressembling the native structure is ranked among the top ten structures. 1dfj has a native interface that is poor in hydrophobic residues . in contrast, some of its decoys have interfaces rich in hydrophobic residues.

our energy function was more successful with the vakser set, with one failure and four successes . one of the successful vakser targets  is also part of the sternberg set . however, part of the structure is missing in the vakser complex  and the decoy sets are different; therefore, we consider the vakser target to be a separate test. overall, we find that our energy function behaves most successfully when the native interface has a fairly typical hydrophobic/hydrophilic profile. this presumably reflects the predominance of homodimers in the training sets .

we also did calculations with two energy functions developed by bastolla et al  <cit>  and lu et al  <cit> . with our own test sets and the bastolla function, we obtained dint =  <dig> % and q¯int
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgrbqugaqeamaabaaaleaacqwgpbqacqwgubgbcqwg0badaeqaaaaa@324c@ =  <dig> % for test set  <dig>  and dint =  <dig> % and q¯int
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgrbqugaqeamaabaaaleaacqwgpbqacqwgubgbcqwg0badaeqaaaaa@324c@ =  <dig> % for test set  <dig>  with the lu et al function, we obtained dint =  <dig> % and q¯int
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgrbqugaqeamaabaaaleaacqwgpbqacqwgubgbcqwg0badaeqaaaaa@324c@ =  <dig> % for test set  <dig>  and dint =  <dig> % and q¯int
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgrbqugaqeamaabaaaleaacqwgpbqacqwgubgbcqwg0badaeqaaaaa@324c@ =  <dig> % for test set  <dig>  these results  are somewhat poorer than the ones obtained with our own functions, except for the bastolla q¯int
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgrbqugaqeamaabaaaleaacqwgpbqacqwgubgbcqwg0badaeqaaaaa@324c@ with test set  <dig>  the correlation coefficient between our os <dig> 20-class function and the bastolla function is  <dig> . for the  <dig> sternberg and vakser blind tests, the bastolla and lu functions gave six and eight clear successes, compared to seven with our best function . performance for near-native decoys was qualitatively similar for all three functions.

with the sternberg decoys, there are small internal deformations of the two partners, relative to the experimental dimer structure. here, we take these into account, scoring each structure by its binding free energy. in contrast, lu et al  <cit>  employed the interface free energy, which ignores internal deformation. this leads to a better ranking of the native structure, but is physically questionable, since dimerization is governed by the total binding free energy, and not the interface free energy alone.

finally, we note that our best 4- and 6-class functions, remarkably, gave results of practically the same quality as the 20-class functions .

structures submitted to the capri experiment
the capri structure sets are expected to be the most difficult test. indeed, the structures submitted are not decoys in the usual sense, but attempts by the participating groups to predict the target structure. all the target structures were determined by xray crystallography, with an experimental resolution of  <dig>  Å or better. we considered  <dig> of the  <dig> capri targets. the others were discarded for technical reasons . in tables  <dig>   <dig>  we report results with two 20-class energy functions, optimized using os <dig> and os <dig>  respectively. the os <dig> function gave distinctly better results for our own structure sets  and for the sternberg blind tests, above. therefore, we take this as our best energy function.

in four cases, t <dig>  t <dig>  t <dig> and t <dig>  our best energy function correctly identified the native complex within the five lowest-energy structures. in two cases, t <dig> and t <dig>  the experimental complex was ranked within the top ten. t <dig>  t <dig>  and t <dig> are complexes between an alpha-amylase and three different camelide antibodies. t <dig> has slightly fewer polar–polar contacts than t <dig> and t <dig>  t <dig> and t <dig> correspond to the same cohesin-dockerin complex. for t <dig>  capri participants received the unbound cohesin crystal structure and the nmr structure of a homologous dockerin domain, sharing 50% sequence identity with t <dig>  the decoys thus involve a homology-modelling of the t <dig> dockerin moiety. for t <dig>  they received the same, unbound cohesin structure, while the dockerin moiety was from the crystal structure of the complex. although the two complexes correspond to the same native interface, their sets of decoys, submitted by the capri participants, are completely different. therefore, we count them as separate targets. the native interfaces for t <dig> and t11/t <dig> feature similar kinds of interactions, with 45% of hydrophobic-hydrophobic contacts , 43% of polar–polar contacts , and 12% of polar–hydrophobic contacts . the percentage of interface contacts of each type are given in table  <dig>  along with the total number of contacts, relative to the native structure. t <dig> and t <dig> had  <dig> and  <dig> decoys, respectively. our successes for t <dig>  and t <dig>  are notable, as their interface hydrophobicities are distinctly untypical, with a predominance of hydrophobic–polar interactions and a large number of polar–polar interactions.

avalues for the 20cl/os <dig>  os <dig> functions, already given in table  <dig>  bthe percentage of interface contacts of each type, averaged over the  <dig> decoy structures: hydrophobic-hydrophobic , hydrophobic-polar , polar–polar ; values for the native structure in parentheses. cthe relative contact number f = ndec/nnat  of the decoy ranked first by the 20-class os <dig> energy function.

among the failures, t <dig> is the worst case. note that none of the models submitted by the capri participants for t <dig>  were acceptable. thus, the  <dig> t <dig> "decoys" included only a few structures that were at all similar to the native . the best "decoy" submitted for t <dig> was ranked 29th by our energy function. the t <dig>  t <dig> and t <dig> interfaces are rather poor in hydrophobic contacts . their decoy sets all include interfaces with more typical hydrophobic contents. this may explain the poor ranking of the native structure for these three targets .

the other three failed trials, t <dig>  t <dig> and t <dig>  correspond to large decoy sets , all of a very good quality . the t <dig> set includes  <dig> submitted complexes that present at least one native contact. among the decoys closest to the native structure, the best one  is still poorly ranked by our energy function . the t <dig> decoy set is of an even better quality, with half of its  <dig> structures featuring some native contacts. in this case, the decoy that is closest to the native structure is ranked 18th by our best function. our result for the t <dig> complex  is somewhat better. the structure that is closest to the experimental structure  is ranked 2nd by our energy function. overall, the bastolla and lu energy functions performed in a similar fashion . they both failed to correctly rank t <dig>  t <dig>  t <dig>  t <dig>  t <dig> and t <dig> 

finally, to illustrate further the occurrence of false positive and false negative predictions, we considered the nine capri series that contain at least one near-native decoy . for six of these, we ranked at least one near-native decoy among the top ten structures. in all, with the 20-class function, 27% of the native or near-native structures were recognized ; 30% were recognized with the 6-class function.

discussion
the quality of interface recognition
an important goal of modern genomics is to identify interacting proteins and characterize the structure and function of the corresponding complexes. a promising strategy is to assemble putative complexes from individual protein structures and characterize them by computing a binding free energy. here, we have developed simple, empirical energy functions for interface recognition. we used a coarse-grained description, at the residue level, along with the simplest possible, stepwise, distance-dependence. more compex models are known to give superior results  <cit> . here, however, we pursued two more limited goals. first, we examined whether a large computational effort would lead to better parameterization and performance of this simplest class of models. second, we examined what size amino acid library is needed for optimal performance.

thanks to increased computing power, we employed many more structures and many more decoys than previous workers. the decoys were both diverse and structurally-realistic , thanks to a realistic, flexible docking method of construction. in particular, van der waals and electrostatic contacts between partners are reasonable. the decoy set was characterized in some detail; more details will be given elsewhere. our search of parameter space was also considerably more thorough than some past work. this is important for the 6-, and especially the 20-class amino acid alphabets, which have  <dig> and  <dig> adjustable parameters, respectively. for these, we considered a total of over  <dig>  starting guesses for the parameters. we also included fold recognition in the optimization criterion , which should help to restrain the parameters to physically meaningful values. finally, by constructing a hierarchy of energy functions, with amino acid alphabets of increasing complexity, we could focus the parameter search effectively for the larger alphabets. for example, our best 20-class function was obtained using a 6-class function as a starting point. the performance of our method is measured by its ability to identify the experimental, native interface from among sets of decoys.

despite the improvements made here, the performance of our functions is very similar to those  developed by bastolla, lu, and coworkers. for the capri tests, we had six successes out of  <dig> targets with our 6- and 20-class functions, while our 4-class function actually gave a seventh near-success . the bastolla function gave seven successes and the lu function, six. the successful cases are almost the same with all the functions, and behavior for near-native decoys is similar. this is a bit disappointing, given the extensive computational effort in the present work. however, this effort was needed to establish firmly that the performance limit of this class of models has been reached.

a coherent hierarchy of amino acid alphabets and models
our second goal was to examine a hierarchy of amino acid alphabets and models. this analysis has produced new insights into both the similarities and differences among amino acids, and the diversity required for protein–protein recognition. the amino acid groupings were initially obtained by clustering the blosum <dig> similarity matrix  <cit> , which is itself based on the mutational frequencies seen in multiple sequence alignments  <cit> . the mutational frequencies are mainly determined by factors other than interface recognition. presumably, the dominant mutational constraint is the fold and stability of the individual protein  <cit> . protein–protein recognition is one of several secondary constraints, along with folding kinetics and robustness towards mutations  <cit> . nevertheless, the blosum clustering leads to good quality interface recognition. at the 4-class level, for example, two thirds of the native structures in our data set are ranked first, among over  <dig> high-quality decoys. this is consistent with the idea that similar physical-chemical effects operate in protein folding and protein–protein association.

the best energy functions at each level were obtained from random initial guesses, except for the 20-class function, which was obtained from a 6-class function. nevertheless, the energy functions form a consistent hierarchy, with qualitatively similar parameters at all levels. this is especially striking in the contour representation of fig.  <dig>  from the complete energy matrix, we can also infer amino acid groupings . the 20-class matrix gives back the blosum 6-class grouping, as expected . at the 4-class level, there is an interesting difference between the two groupings. blosum splits the aromatics {fwy} into their own group, whereas the energy matrix classification splits the polar amino acids into two groups, based partly on electrostatic charge: {denq} and {hkr}. at the 6-class level, polar–polar interactions are repulsive, except for the {denq}{hkr} interaction, which is reasonable. on the other hand, f, w, and y have much higher interface propensities than the other hydrophobics except met, so that an aromatic group is also reasonable. the 6-class function captures both of these effects. the internal coherence of the 4- and 6-class energy groupings is very high . in future work, it would be interesting to also consider 5-class functions.

CONCLUSIONS
the good performance of the 4- and 6-class functions, compared to the 20-class function, may be partly due to the limited structural data available today for parameterization. if the number of known dimeric structures  were to increase substantially, there may be enough information to parameterize a superior 20-class function. nevertheless, the good performance with four and six classes suggests that a moderate amino acid diversity is sufficient to establish specific protein–protein recognition. one might speculate that this facilitated the emergence of protein–protein interaction networks in the course of evolution. indeed, it seems much easier to perform a "coarse-grained" optimization of an interface, rather than a "detailed" optimization; i.e., it seems easier to optimize the distribution of interface residues among a limited set of four or six groups, rather than optimizing the exact amino acid distribution at the interface.

the present models can serve as the basis for future, more complex models that use a reduced amino acid library but include additional physical effects  <cit> . more complex models are needed to detect transient complexes, which are likely to be missed by the present, coarse-grained model. an improved model could account for the distance dependency of electrostatic interactions, either between polar residues or between polar residues and solvent. backbone contacts between protomers are another possibility. with twenty amino acid types, such models lead to a very large number of adjustable parameters. a high-quality, 6-class grouping could provide a better starting point for a model that balances efficiency and realism. the decoys sets created here are available on request and will also be of use, especially as flexible docking strategies become more common.

the models developed here have already proven useful for the inverse protein folding problem . their good performance for the difficult capri tests suggests that they will also be useful for exploring protein–protein interactions at the proteome scale, particularly for strongly interacting protein–protein complexes such as those used in the model parameterization. improved, more sophisticated models will have an increased ability to detect the weaker, transient complexes that are also common in the proteome.

