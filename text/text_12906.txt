BACKGROUND
homology identification is part of a broad spectrum of genomic analyses, including the annotation of new whole genome sequences, the construction of comparative maps, the analysis of whole genome duplications and comparative approaches to identifying regulatory motifs  <cit> . the general method used to determine the function of newly discovered proteins is to transfer annotation from well-characterized homologous proteins sharing a common ancestry  <cit> . current methods for the identification of homologous proteins can be largely classified into sequence-based and domain-based approaches  <cit> . sequence comparison methods, such as blast and fasta, are the commonly-used traditional approaches to identify homologous genes  <cit> . these methods assume that sequences with significant similarity share common ancestry, i.e. are homologs. however, the existence of multi-domain proteins and complex evolutionary mechanisms poses difficulties for sequence-based methods  <cit> .

domain-based methods use information of the domains contained in proteins  <cit> . domains are the building blocks of all proteins, and present one of the most useful levels at which protein function can be understood  <cit> . although the concept of a 'domain' now permeates biological descriptions, there are several definitions directed at different levels of the protein  <cit> . in structural biology, a domain is defined as a spatially distinct, compact and stable protein structural unit that could conceivably fold and function in isolation. domains are also defined as distinct regions of protein sequence that are highly conserved throughout evolution. these are described as sequence homologs and are often present in different molecular contexts. sequence-based domain definitions represent one of the most convenient and practically important levels at which the evolution and function of both proteins and domains can be understood.

domain-based approaches identify homologous proteins generally by comparing protein domain architecture, which is the linear order of the individual domains in multidomain protein. about two thirds of proteins in prokaryotes and 80% of proteins in eukaryotes are multi-domain proteins  <cit> . studies of domain-based methods indicate that comparing domain architecture is a useful method for classifying evolutionarily related proteins and detecting evolutionarily distant homologs  <cit> . several studies have proposed tools for domain architecture comparison, such as cdart  <cit>  and pdart  <cit> . however, these methods are challenged by large families defined by 'promiscuous'  domains, which combine in many ways with other domains to form different proteins  <cit> . promiscuous domains have typically auxiliary functions to the primary role of protein, acting as signal transducers, or adapters  <cit> . they also play a major role in creating diversity of protein domain architecture in the proteome  <cit> . because they are not directly related by homology, they should be given less importance in homology identification than key domains. another problem inherent to these domain-based measures is that they treat all proteins in a domain architecture equally. they cannot discriminate among proteins belonging to the same domain architecture. since most domain architectures consist of many proteins, identification methods are needed to determine which protein is the most homologous to the query protein within a set of proteins belonging to the same domain architecture.

here we present a measure, called weighed domain architecture comparison , of domain architecture similarity, which can be used to identify homologs of multidomain proteins. the key ideas are the use of weight scores for domain promiscuity and combining domain architecture comparison with sequence similarity method. the weight scores are calculated based on a domain's frequency and versatility in refseq  <cit>  proteins. the effectiveness of our method is evaluated using human and nematode proteomes. we developed a web-based server to allow users to compare their proteins with protein domain architectures. the server is available at http://wdac.kr/.

methods
domain assignment
in this study we used the pfam  <cit>  database to analyze the domain organization of proteins. pfam is a large and widely used database of protein domains and families. pfam contains curated multiple sequence alignments for each family, as well as profile hidden markov models for finding these domains in new sequences. pfam also provides better genomic coverage than structure-based domain assignments, such as cath  <cit>  and scop  <cit> , particularly for membrane proteins.

measuring the strength of domain promiscuity
to measure the strength of domain promiscuity, we considered two features of protein domains, the first of which is domain abundance. compared to non-promiscuous domains, promiscuous domains appear in many proteins because they are needed to perform auxiliary functions. vogel et al.  <cit>  have shown that the combination tendencies of domains can be explained by a random evolutionary process model, in which a highly abundant domain tends to form more combinations. to measure the abundance of a domain, we defined the inverse abundance frequency . the basic concept of iaf is derived from the inverse document frequency , a statistic commonly used in information retrieval. idf is a measure based on the observation that a word that occurs in very few documents is more likely to differentiate between subjects than a word that occurs frequently  <cit> . namely, idf is a measure of the general importance of a term. the idf score is obtained by dividing the number of all documents by the number of documents containing the term, and then taking the logarithm of that quotient. for example, if 'cow' appears in  <dig> documents out of a total of  <dig>  and 'bovine' in  <dig> documents, the idf scores of 'cow' and 'bovine' are  <dig>  and  <dig> , respectively. thus, the word 'cow' conveys less information about the subject of the document than the word 'bovine'. the number of documents containing a term and the number of documents in the corpus are analogous to the proteins containing a domain and the total number of proteins under study in the iaf statistic, respectively. the definition of iaf for a domain, d, is

where pt is the number of total proteins and pd is the number of proteins containing domain d.

the second feature of protein domains that we consider is domain versatility. promiscuous domains occurring in many protein clusters have many partner domain families while highly conserved domains appear in a small number of protein clusters and their neighbor domains are also conserved during evolution  <cit> . thus, domains with the same abundance could have a different number of distinct partner domain families. to measure the versatility of a domain, we defined the inverse versatility  obtained from the inverse of the number of distinct partner domain families at the n- and c-sides adjacent to a domain. the definition of the iv of a domain, d, is

where fd is the number of distinct domain families adjacent to domain d. the weight score of a domain is simply calculated by the product of the idf and the iv of a domain. let us consider the theoretical example , where both domain a and domain b occur three times. domain a has four distinct neighbors and domain b has only one distinct neighbor. since the weight score of domain a is lower than that of domain b, domain a is more promiscuous than domain b.

comparison of domain architectures using weight scores
using the domain weight scores, we compared domain architectures. first, the shared distinct domain families are compared. we represented the two sets of domains derived from two architectures as the indices, which are built using the vector-space model   <cit> . domain architectures were converted into a vector in which each component corresponds to the weight score of a domain. the similarity of the two vectors is measured by determining their cosine similarity, a measure based on the angle between two vectors . if x and y are vectors of two domain architectures x and y, the cosine similarity is defined

the range of the cosine similarity is  <cit> , where  <dig> indicates that x and y have the same domains and  <dig> indicates that they share no domains.

second, domain orders were considered. to measure the order similarity, we compared shared domain pairs between two domain architectures. in domain evolution, two- or three-domain combinations, called supradomain, are re-used in different protein context, and domain pairs in protein domain architecture occur in only one order, with only about 2% of such pairs occurring on both possible orders. the order similarity is measured by dividing the shared domain pairs  by the total domain pairs . the function is defined by

the final similarity score between two domain architectures, x and y, is obtained by combining the indices from equations  <dig> and  <dig>  using a simple linear function.

pipeline for domain architecture comparison
we constructed an automatic pipeline for identifying homologs of proteins . the pipeline programs were written in perl and consist of four main steps. first, the pipeline assigns pfam domains to a query protein and extracts a domain architecture from the pfam annotation. second, the query domain architectures are compared against the domain architecture database. third, the query proteins are compared with refseq proteins using blastp  <cit> . lastly, matched domain architectures and blast results are combined and sorted according to their similarity scores.

web-based server
we developed a web-based server to provide a back-end pipeline for protein homology and to allow users to compare their protein sequences with a domain architecture database. the web interface is implemented with static html and cgi scripts, and mysql dbms is used to store the database.

RESULTS
obtaining weight scores of protein domains
we downloaded  <dig> , <dig> protein sequences from the refseq database . the domain content of the sequences was analyzed with pfam  <dig>  containing  <dig>  families. the pfam domain annotations of all refseq proteins were obtained from the similarity matrix of proteins   <cit>  database. we filtered domain hits in proteins with a cutoff e-value of  <dig>  and excluded proteins without pfam signatures. we extracted all the pfam domains from the pfam-annotated proteins

of the  <dig> , <dig> refseq proteins,  <dig> , <dig>  contain more than one pfam domain. these pfam-annotated proteins were converted into domain architectures, in which we obtained  <dig>  distinct domain architectures. the domain architecture data show that 90% of the domain architectures are kingdom-specific. thus, we classified the  <dig>  domain architectures into three kingdoms: eukaryote, bacteria, and archaea . from these domain architectures, we extracted  <dig>  domains and then divided them into the three kingdoms, where 17% of all the domains are common to all three kingdoms of life whereas 54% appear only in one kingdom.

because domains are differently distributed in the three kingdoms and some domains are absent or present in one or two kingdoms, we assigned three kingdom-specific weight scores to each domain based on its abundance and versatility in the three kingdoms. to measure domain abundance, we obtained the kingdom-specific protein frequency for each domain. most domains occur in a hundred or fewer proteins, but a few domains are highly duplicated and occur in over  <dig>  sequences. the most abundant domain in the three kingdoms is abc_tran , appearing in  <dig>  bacterial proteins. to measure domain versatility, we obtained kingdom-specific n- and c-side distinct domain families adjacent to each domain. we found that most domains have one or two distinct adjacent domain families. the features of the obtained domain versatility are consistent with earlier reports that the number of different partner domains for a single domain or for a domain combination follows a power law distribution: many domains or domain combinations have only very few different n-terminal or c-terminal partner domains. the most versatile domain in the three kingdoms is ank , having  <dig> distinct partner domain families in eukaryotes.

we calculated kingdom-specific idf and iv scores for all domains using eq.  <dig> and  <dig>  and obtained weight scores for each domain by the product of the iaf and iv scores. the scores were multiplied by  <dig> to facilitate computation. these domain's scores represent their importance in the protein universe and are used in the comparison of domain architectures. the analysis of the weight scores indicates that they are distributed  <dig>  to  <dig>  , where most scores are over  <dig> and a small number of domains have scores below  <dig>  top ten domains with lower scores in the three kingdoms are given in table  <dig> and the weight scores distribution over all pfam domains is given at the website.

we examined the weight scores of previously known promiscuous domains to identify relationship between weight scores and domain promiscuity. to do this,  <dig> eukaryotic promiscuous domains published by basu et al.  <cit>  were used. these promiscuous domains consist of  <dig> pfam domains and  <dig> smart domains, and are involved in protein-protein interaction and have crucial roles interaction networks. to facilitate comparison between these known promiscuous domains and the weight scores, we converted the  <dig> smart domains into the corresponding pfam domains, where  <dig> smart domains could be converted. we found that all of the known promiscuous domains have very low weight scores,  <dig>  mostly below  <dig> . it means that the calculated weight scores represent domain promiscuity and importance of protein domains.

performance evaluation
to assess the effect of domain weight scores on domain architecture comparison, the wdac  was compared to the general unweighted domain architecture comparison  method using all complete homo sapiens  and caenorhabditis elegans  protein sequences. in the dac method, domain weight scores are not considered. to implement the dac method, we used jaccard similarity  <cit> , which is commonly used in information retrieval, instead of the measure of cosine similarity used in the wdac method. the jaccard similarity can be calculated by the following equation:

where f <dig> is the number of domains common to both sequences x and y, f <dig> is the number of domains in x, and f <dig> is the number of domains in y.

we extracted all complete human and nematode protein sequences from refseq proteins, yielding  <dig>  human and  <dig>  nematode protein sequences. among these proteins,  <dig>  human and  <dig>  nematode proteins have detectable pfam domain information. among the human proteins, we selected  <dig>  proteins that contain more than  <dig> pfam domains and performed domain architecture comparisons between the selected human proteins  and those from the nematode proteome  using the wdac and dac algorithms.

to validate homologous pairs of human and nematode proteins, we used the homologene database  <cit> , a ncbi dataset that curates sets of orthologs from the annotated genes of several completely sequenced eukaryotic genomes. among the  <dig>  groups in homologene release  <dig>  we selected  <dig>  groups that have both the selected human proteins and nematode proteins. from the comparison results, we extracted the wdac and dac results that have the same homologene id in the query  and the best matched protein . the results show that the number of true positive values in the wdac and dac results are  <dig>   and  <dig>   respectively, which means that considering weight scores in domain architecture comparison can improve homology identification.

in addition, we found that the wdac results have more specific homologs than the dac results. figure  <dig> shows the query results of a human protein np_ <dig> . the best matched protein from the wdac results is np_ <dig> , while dac results have two proteins, np_ <dig> and np_ <dig>  as the best matched protein. the reason that dac cannot discriminate between the two proteins is that dac treats two domains, tpr_ <dig> and siah, equally.

construction of web server
the query interface accepts protein sequences in fasta format, and the maximum number of input protein sequences for a single submission is  <dig> and the length of each sequence is limited to  <dig> residues. the output of the server is an html-formatted file, which consists of three parts: query domain architecture with pfam domains, matched domain architecture, and domain information . for more than two sequences, users must input an email address to receive the wdac results.

CONCLUSIONS
there are several current homology methods which compare domain architectures. however, these methods are challenged by large families defined by promiscuous domains. to cope with the promiscuous domain problem, we present a method for measuring the similarity among protein domain architectures based on their pfam-a domain annotations. the pfam database may contain a small number of false positives and false negatives. nevertheless, it is currently one of the most useful and practical domain annotation databases for protein sequences. in this study, we consider domain weight scores, obtained based on the abundance and versatility of domains. our analysis indicates that considering domain weight scores in domain architecture comparison improves the performance of protein homology identification. the wdac algorithm is also effective in resolving some issues that have baffled traditional sequence-based comparison methods, such as the comparison of proteins with promiscuous domain. the wdac algorithm and its web server could be used to explore the underlying evolutionary relationships among proteins at the level of their whole domain architectures, rather than at the single-domain or protein sequence level.

competing interests
the authors declare that they have no competing interests.

authors' contributions
bl designed the algorithm, carried out the programming, analyzed the results and wrote the manuscript. dl directed the entire study. all authors read and approved the final manuscript.

note
other papers from the meeting have been published as part of bmc genomics volume  <dig> supplement  <dig>  2009: eighth international conference on bioinformatics : computational biology, available online at http://www.biomedcentral.com/1471-2164/10?issue=s <dig> 

