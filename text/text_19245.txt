BACKGROUND
the most widely cultivated potato species, solanum tuberosum group tuberosum, is an autotetraploid  and the world's third most important food crop in overall production, after rice and wheat  <cit> . potato improvement is constrained by numerous challenges and bottlenecks  <cit>  including a high level of heterozygosity, tetraploid genetics, restricted genetic base, biotic and abiotic constraints as well as the need to simultaneously select for market-based quality traits and agronomic performance. while genetic maps and markers have been described in potato  <cit> , they have not yet had substantial impact on potato improvement. mapping studies in potato  have been conducted since the late 1980's  <cit> , but marker-assisted selection  is not widely practiced in varietal breeding. to date, only a few molecular markers for economically important traits have been developed in potato, and most of these are for resistance to pests and diseases, including late blight  <cit> , potato virus y  <cit> , potato cyst nematode  <cit>  and verticillium wilt  <cit> . development of a genome-wide set of markers polymorphic in elite germplasm would allow more cultivars and breeding clones to be genotyped and substantially advance potato breeding.

with the emergence of genomics in the late 1990s, expressed sequence tag  projects were initiated for potato in which sanger-based sequencing was used to catalog transcripts in an array of tissues and genotypes  <cit> . to date,  <dig>  sequences derived by sanger sequencing are available for potato in the national center for biotechnology information  dbest . while prior sequencing has provided a useful starting point for detecting polymorphic loci in potato, the polymorphisms that can be defined at present are restricted to the genotypes sequenced to date and the depth of sequencing performed. three cultivars, 'bintje' , 'kennebec' , and 'shepody' , have substantial sanger sequence datasets, and for all three cultivars, relatively low-coverage sanger sequencing was employed.

due to the high throughput and low costs, next generation sequencing methods provide a powerful means to generate large sequence datasets that can be used to characterize sequence diversity  <cit> . in addition to discovery, next generation sequencing platforms can be used to rapidly generate polymorphisms and genotype data for genetic mapping  <cit> . to increase the number of single nucleotide polymorphisms  available for basic and applied potato genetics, we conducted extensive transcriptome sequencing from three currently relevant potato cultivars, atlantic  <cit> , premier russet  <cit> , and snowden . atlantic and snowden are the two most widely grown public chipping cultivars in north america, while premier russet is a new, promising french fry clone. all three cultivars are used as parents in north american breeding programs. using transcriptome data generated in this study, coupled with available sanger potato ests, we computationally identified a large collection of snps for use in genotyping. we also created a germplasm panel of ~ <dig> potato clones, which includes many representatives of each of the major market classes, solanum species, genetic stocks, and represents a broad genetic base to assess the allelic distribution of a subset of snps and the population structure and relationships between market classes.

RESULTS
sequencing and annotation of the potato transcriptome
the genotypes and sequence datasets used in this study are listed in table  <dig>  using normalized cdna libraries and the illumina genome analyzer  <dig>  platform, we generated  <dig>  gb of sequence increasing by 60-fold the amount of transcriptome sequence available for potato . to reduce the redundancy in both the sanger and ga <dig> derived transcript sequences, we performed de novo assembly of quality-filtered reads. for the ga <dig> transcript data, de novo assembly resulted in a combined total of  <dig>  mb of contigs for potato . singletons  from the ga <dig> platform were not used in downstream bioinformatic analyses due to quality issues associated with single pass short reads. for the three accessions sequenced using the ga <dig> platform, a similar number of reads were available for assembly  and the assembled transcriptome size ranged from  <dig>  to  <dig>  mb . the narrow range of assembled transcriptome sizes within the potato ga2-generated datasets suggests that the underlying cdna populations and the sequencing and assembly process were similar within the potato samples.

athe dm genome is available at http://potatogenome.net.

although we generated a significant amount of non-redundant transcriptome sequence via our ga <dig> platform datasets, this does not represent the complete transcriptome as it is unlikely that all genes were expressed in the tissue samples used for cdna synthesis, transcripts expressed at a low level may have been missed in our sampling, and coverage of the transcript may be insufficient to yield a full length assembly. to assess the representation of the potato transcriptome, we aligned the contigs to the arabidopsis thaliana proteome. for the three ga2-derived transcriptomes, a similar number of total, as well as distinct alignments with the arabidopsis proteome were present with a substantial amount of overlap between the three ga2-transcriptomes . analysis of molecular function gene ontology terms within the three ga2-transcriptomes indicate a similar representation of biological activity .

acontigs were search against the a. thaliana proteome using an e value cutoff of <10- <dig>  only the top alignment was retained.

bmultiple alignments to the same a. thaliana protein were condensed to provide a non-redundant estimation of representation of the a. thaliana proteome.

we compared our ga2-generated assemblies to est collections generated previously using the sanger platform  <cit> . the three sanger est datasets  were more variable in number of reads:  <dig> ,  <dig> , and  <dig> , respectively, and consequently, the sanger-derived assemblies were more variable in representation of the potato transcriptome: bintje , kennebec , shepody . due to smaller sampling of the transcriptome, bintje was under-represented compared to kennebec and shepody as shown by the reduced number of total and non-redundant alignments to the arabidopsis proteome compared to the ga2-generated transcriptomes . when examined for overlap based on alignment to the arabidopsis proteome , these three datasets do overlap with each other, although the skew in total numbers of contigs between the three cultivars is reflected in overlap of non-redundant arabidopsis alignments. the vast majority  of the sanger-generated contigs were represented within the ga <dig> datasets .

snp discovery
snps were abundant within and between the transcriptomes. at the first stage of the snp discovery pipeline with limited filtering,  <dig> , <dig> snps were called by maq in the ga2-generated transcriptomes. application of read depth, density, and quality score filters with the maq snpfilter reduced the snp count among the three ga2-derived transcriptomes to  <dig>  snps . in parallel, with three sanger-derived transcriptomes we identified  <dig>  filtered snps. as these snps were identified on transcript assemblies, there is overlap between the snps in the six cultivars. thus, we used the potato draft genome sequence available from the potato genome sequencing consortium  <cit>  to align the contigs from all six cultivars and identify redundant snps resulting in  <dig>  unique snps among all six cultivars. using a stringent set of filters to address intron/exon boundaries, paralogs, non-biallelic snps and illumina design specifications, we were able to identify  <dig>  high confidence snps from atlantic, bintje, kennebec, premier russet, shepody, and snowden that could be used on a snp genotyping platform . it should be noted that there are additional high quality snps outside of the  <dig>  snps and that this reduced dataset was created solely for generation of an illumina snp genotyping platform.

from these  <dig>  snps,  <dig> were empirically tested using the illumina beadxpress genotyping platform, of which  <dig> were considered high quality . due to the partial nature of transcriptome sequence due to expression levels and sequencing depth, full coverage of each snp for all three genotypes  was not available. rna-seq based genotypes were available for all three genotypes for  <dig> snps, two genotypes for  <dig> snps, and one genotype for  <dig> snps. of the  <dig> high quality snps,  <dig> were congruent for all genotypes between the two platforms,  <dig> were inconsistent for one of the genotypes, and two of the snps failed for one of the alleles in the beadxpress assay or are homozygous for the genotypes used in this study. thus, our computational pipeline to predict snps solely from sequence data is robust. in total, from the  <dig>  sanger and ga2-generated contigs,  <dig>  contigs have at least one high confidence snp. the remaining  <dig>  contigs lack a high confidence snp that meets our filtering criteria.

germplasm population structure
intra- and intervarietal snp diversity exists in elite cultivated germplasm. with the diversity of a germplasm panel and the availability of a set of random snp markers, the opportunity exists to examine population structure in elite breeding germplasm. us potato breeding efforts currently center on improving six distinct market classes , where most  hybridizations for varietal selection are made between clones within a market class. over time one might expect these six market classes to diverge, not only in terms of the few traits that define each class, but also in terms of unlinked, selectively neutral dna markers. to assess whether the market classes have diverged significantly,  <dig> high quality snps  were used to evaluate the  <dig> clone germplasm panel. using the likelihood of the observed genotypes given the number of populations in the model for each of the values of k tested , it was determined that the number of subpopulations in the set of  <dig> diverse genotypes was four . by pedigree, these four groups are comprised predominantly of 1) chip processing germplasm, 2) all other tetraploid market classes combined , 3) wild  species, and 4) diploid breeding lines derived from various solanum species and genetic stocks . it is not surprising that the wild species group is distinct from s. tuberosum germplasm. the 2× breeding lines and 4x s. tuberosum germplasm grouped separately despite our inability to score allele dosage in 4x germplasm . we were initially surprised that the cultivated tetraploid germplasm differentiated into two groups based on market class , rather than one group  or six groups . over the past fifty years, chip processing germplasm has undergone intense selection for processing characteristics such as low reducing sugar content, high starch, shallow eyes and round tuber appearance, which may partially explain why this market class is genetically distinct from all other market classes.

of the  <dig> potato clones genotyped,  <dig> could be readily categorized as either wild species, diploid breeding line/genetic stock, or as belonging to one of the following market classes: french fry processing, table russet, chip processing, yellow flesh, pigmented skin, round white table. using allele frequency-based distances , the genetic similarities between individual market classes, as well as more distant germplasm, were determined for the  <dig> genotypes that could be categorized . similar to what was observed in the population structure analysis, the wild species group is distinct from all s. tuberosum germplasm. the wild species group thus serves as an outgroup for analysis of elite potato germplasm. the diploid breeding line/genetic stock group clustered more closely to the cultivated germplasm, presumably because members of this group often contain substantial amounts of s. tuberosum group tuberosum and/or phureja. even so, the diploid breeding/genetic stock group was still clearly distinct from cultivated germplasm. interestingly, within cultivated germplasm the two russet market classes - french fry processing and table russet - clustered more closely to each other than they did to either the round white chip processing and round white table groups. we had expected the french fry processing and chip processing market classes to group more closely because of similar selection for processing traits. russet germplasm, common in north america but not elsewhere, is characterized by long tuber shape and russet skin. the group with red or purple skin formed its own cluster, while the remaining cluster included various round tuber classes . the yellow flesh, pigmented skin, and round white table groups clustered separately from the chip processing group.

computational snp analysis across six sequenced cultivars
while the beadxpress assay allowed us to examine  <dig> snps across  <dig> germplasm clones, it is also possible to compare a much larger number of snps across the six potato cultivars for which there is available transcriptome sequence. using a separate computational pipeline that mapped sequence reads directly to the dm reference genome  <cit> , we identified  <dig> , <dig> raw snp calls, of which,  <dig>  snps remained after filtering with the bowtie/samtools pipeline. collectively, these mapped to  <dig>  unique genome positions and represented approximately 25% more snps than the maq pipeline described above, which was based on transcript assemblies.

when comparing heterozygous autotetraploid potato cultivars, snps can be intra- or inter-varietal. as shown in table  <dig>  snps were readily detected within all six accessions, ranging from  <dig>  in bintje to  <dig>  in premier russet, reflective of the increased transcriptome data available for premier russet compared to bintje. for all six accessions examined, regardless of platform, approximately half of the snps detected in each transcriptome were restricted to that cultivar . this may reflect true exclusivity of the snps, a lack of sampling depth in the other five transcriptomes sufficient to permit snp detection under our alignment and filtering criteria, and/or lack of expression of some alleles in some cultivars.

total and cultivar-restricted snps were determined by aligning reads to the dm reference genome and calling snps using samtools. cultivar-restricted snps are snps that are found only in a single cultivar with the other cultivars lacking the snp or having no sequence data at that genomic position.

we determined the overlap of snps across all six cultivars in a pair-wise manner as well as the number of snps shared or restricted within market classes. not surprisingly, the total number of snps in any pair-wise comparison was reflective of the initial size of the transcriptome and consequently, the number of snps identified . the largest number of snps identified within a market class was for snowden and atlantic , two chip processing cultivars. of these,  <dig>  snps were restricted to snowden and atlantic; some of these shared unique snps might have originated in lenape, a parent shared by atlantic and snowden. for the french fry processing class,  <dig> snps were common to premier russet and shepody, of which  <dig> were restricted to these two cultivars. for the fresh market class ,  <dig> snps were common with  <dig> restricted to these two cultivars. the 30- <dig> fold less snps common to the french fry and fresh market classes is attributable to the smaller datasets in the sanger-generated transcriptomes . as we have not exhaustively sampled these six transcriptomes, especially those of bintje, kennebec, and shepody, the snp overlap reported reflects trends and not absolute numbers as we are under-estimating the inter-varietal snps. thus, we expect the fraction of cultivar exclusive snps to be reduced as more cultivars are sequenced.

pairwise comparision of snps across the six potato cultivars. cultivar-restricted snps are snps found exclusively in the two cultivars based on alignment to the reference genome.

CONCLUSIONS
by combining rna-seq of three current cultivars  with data mining of existing ests from three older cultivars , we were able to identify an abundance of snps in elite potato germplasm. these snps will facilitate future marker analyses by potato geneticists and breeders alike. breeders, in particular, will soon be able to incorporate large amounts of genotypic data into their decision making. this will lead to deeper understanding of breeding germplasm, as well as more efficient qtl mapping, association mapping and marker-assisted selection, collectively resulting in more predictable and directed breeding.

with stringent filtering of sequence data in combination with alignment to a reference potato genome, we were able to identify  <dig>  high confidence snps for use with the infinium genotyping platform. a subset of these snps was recently used to design a  <dig> marker snp array  <cit> . the current study sought to validate  <dig> of these snps on  <dig> potato clones;  <dig> of these snps  could be reliably scored. genotyping with the validated  <dig> snp markers allowed us to examine population structure and relationships between market classes. even with this small number of snps, we were able to gain insight into the genetic structure of cultivated potato. somewhat unexpectedly, we observed that chip processing germplasm is discernibly different from other market classes, even though intense selection for chip processing traits is a relatively recent phenomenon, only practiced for the past  <dig> years or so, and in a crop where meioses are relatively infrequent. we also found that chip and french fry processing germplasm appear more closely related to round white table and table russet germplasm, respectively, even though the traits required for processing are similar across these two market classes.

materials and methods
germplasm and datasets used in this study
the germplasm panel was compiled from elite potato germplasm from  <dig> breeding programs across the u.s. including six international programs. germplasm panel member names, market classes and species composition are noted in additional file  <dig>  clones in the germplasm panel were assigned to market classes as follows. the long shaped potatoes were classified as table russet or french fry processing based upon their utilization. similarly, the round white potatoes were classified as table or chip processing. the yellow market class is composed of yellow-fleshed clones, but does not include chip processing clones. the pigmented market class combines red and purple-skinned clones, some of which also have red or purple flesh. the diploid breeding lines consist of clones used by breeders for breeding or mapping purposes. the genetic stocks consist of clones used for genetic studies only; these clones have little or no value for breeding. to define the clone's genome composition, contributing breeders were asked to note if a potato clone contains wild species in its background, either as a parent or as a grandparent. a core set of solanum species and accessions  that have previously been used for introgression into tetraploid germplasm were included in the panel to provide a taxonomic perspective. these clones were designated as "species" in our analyses. sequences used in this study are listed in table  <dig>  sanger ests from bintje, kennebec, and shepody were obtained from ncbi dbest  <cit> . genomic sequences for solanum tuberosum group phureja dm1- <dig> 516r <dig>  potato were obtained from the potato genome sequencing consortium .

transcriptome sequencing
rna was isolated from young tuber meristems, leaves, flowers and callus of atlantic, premier russet, and snowden  <cit>  and pooled in equimolar concentration. cdna was synthesized and prepared for paired-end sequencing as described  <cit> . samples were sheared, 300- <dig> bp fragments selected, and were normalized using double-stranded nuclease that digests high copy double-stranded dna during re-association after denaturation. each normalized library was sequenced in two paired-end  lanes of  <dig> bp on the illumina genome analyzer . sequences are available in the sequenceread archive at ncbi .

de novo assembly and annotation of transcripts
illumina rna-seq reads from each cultivar  were assembled separately using the velvet assembler  <cit>  in the paired-end mode with a hash length of  <dig> and a minimum contig length of  <dig> bp. the insert size and expected coverage parameters were  <dig> bp and  <dig> x for atlantic,  <dig> and  <dig> x for premier russet, and  <dig> bp and 33x for snowden, respectively. sanger-generated ests for bintje, kennebec, and shepody were passed twice through seqclean and assembled into contigs using the tgicl clustering pipeline  <cit> .

the contigs  were searched against the a. thaliana proteome  and uniref <dig>  <cit>  using blastx  <cit>  with an e-value cutoff of 1e- <dig>  to annotate the potato contigs, the first meaningful functional annotation was selected from the top  <dig> scoring blast matches to the uniref <dig> database and transitively assigned to the potato contig. if no meaningful annotation was found in the top  <dig> uniref <dig> matches yet there was a match meeting the cutoff criterion, the potato contig was annotated as a "conserved gene of unknown function". if no hits at all were found within the cutoff criterion, the potato contig was annotated as a "gene of unknown function". for representation of the arabidopsis proteome, contigs were searched against a. thaliana proteome  with an e-value cutoff criterion of 1e- <dig> and the best alignment retained. for gene ontology associations, alignments to the a. thaliana proteome  were used to transitively assign gene ontology  terms.

snp discovery and allelic diversity in a potato germplasm panel
we computationally identified snps within our three ga2-generated transcriptomes  and designed a  <dig> snp beadxpress assay to 1) validate our computational predictions and 2) assess allelic diversity and population structure in a diverse set of potato germplasm.

snp selection
intra-varietal and inter-varietal snps were identified by aligning the rna-seq reads from each variety to the velvet-generated contigs using the maq easyrun.pl pipeline in the paired-end mode . we imposed multiple sets of filters for the snps to be included in the beadxpress assay. first, raw snp calls from the pipeline were filtered with the maq.pl snp filter script using a minimum depth of  <dig> reads, a maximum depth of  <dig>  a minimum consensus score of  <dig>  a minimum adjacent consensus score of  <dig>  and a required maximum mapping quality of  <dig>  additional constraints were a maximum of one other snp in a  <dig> bp flanking window and that the snp must be located  <dig> bp from areas identified as indels by the pipeline . second, the snps were filtered to exclude snps near intron-exon junctions by aligning the velvet contigs to the dm scaffolds  <cit>  using gmap  <cit> . only snps located within exons that aligned at >95% identity with no gaps were retained while snps within  <dig> bp of an exon-intron boundary were discarded. third, only biallelic snps were retained. fourth, remaining snps were scored by illumina  for suitability for the infinium beadxpress platform and snps with a score < <dig>  or a fail code were discarded. the final  <dig> snps selected for beadxpress validation originated from atlantic, snowden, and premier russet .

genotyping potato germplasm
dna was extracted from  <dig> potato lines using the qiagen qiaxtractor dx system . samples were loaded at  <dig> ng/μl on an illumina beadxpress analyzer  and data were analyzed using the illumina genomestudio software. cluster positions for three marker classes  were manually determined for each marker within the illumina genomestudio software. due to the difficulty of calling allelic dosage in the tetraploid clones, all heterozygous classes in tetraploids  were scored as ab. of the  <dig> snp markers,  <dig> were of low quality based on the tightness of clusters and/or signal intensity and were removed from downstream analysis . genotypic data for the remaining  <dig> high quality snps is provided . population structure was determined using the structure software  <cit> . three iterations were run per k  for k equals two through  <dig> using an admixture model with a burn-in time and replication number of  <dig> . the population number with the maximum likelihood of the observed genotypes given the number of populations was used to determine population structure. powermarker version  <dig>   <cit>  was used to calculate the allele frequency based genetic distance between the market classes using the rogers distance method  <cit>  for the  <dig> genotypes with defined market classes. an unweighted pair group method with arithmetic mean  tree was constructed based on the rogers distances; figtree version  <dig> . <dig> was used to produce the upgma tree image  <cit> .

cross-comparative analyses of snps across six cultivars
access to large transcriptome sets for six potato cultivars provides an opportunity to examine allelic diversity across a wide range of loci, albeit from a limited set of germplasm. to compare snps across the atlantic, bintje, kennebec, premier russet, shepody, and snowden transcriptomes, we used a computational approach modified from that described above. instead of aligning transcripts with each other, reads were directly mapped to the genome.

illumina transcript datasets 
rna-seq reads from atlantic, premier russet, and snowden were mapped directly onto the dm reference genome sequence  <cit>  with bowtie . only alignments of reads that mapped uniquely to the  <dig> genome were retained. the resulting sam alignment file was processed using the samtools  package and initial snp calls made . the snps were then filtered with the samtools.pl varfilter script  retaining snps with a minimum read depth of  <dig>  a maximum read depth of  <dig>  a minimum distance of  <dig> bp from putative insertions/deletions , and only one other snp within a  <dig> bp window around the snp. further filtering of the snps was done with a custom perl script that removed snps with a consensus score < <dig>  a snp quality score < <dig>  and a minimum mapping score of  <dig>  as a final constraint, snp calls that had greater than 10% of 3' end of aligned reads were excluded to avoid calling alignment errors as snps. the genomic positions of the snps and associated metadata were stored in a postgresql relational database using the chado schema  <cit> .

sanger transcript datasets 
for sanger-generated sequences, snps were called using a custom perl snp-calling script that required an overall read depth of  <dig>  of which,  <dig> reads had to support the snp call. the snp calls were then filtered removing snps with  <dig> bp of an intron and snps with more than one additional snp in a  <dig> bp window surrounding the snp.

authors' contributions
jph, cnh, brw, anm analyzed data. ks and avd generated data. avd wsdj, dsd, and crb oversaw the experiments. all authors participated in writing the manuscript and approved the final manuscript.

supplementary material
additional file 1
functional classification of potato transcriptomes. the distribution of annotated contigs from each of the cultivars, atlantic , premier , and snowden  based on their annotations to terms in the gene ontology molecular function category are shown.

click here for file

 additional file 2
high confidence snps for genotyping. this file lists the high confidence snps with their flanking sequence that were used in the genotyping experiment.

click here for file

 additional file 3
genes and snps represented on the  <dig> beadxpress platform. this file lists the snps and the genes represented by the snp with their functional annotation.

click here for file

 additional file 4
graphical display of population substructure for  <dig> genotypes at variable population numbers . population substructure was determined using structure  <cit>  with  <dig> high quality snp markers. the number of populations with the maximum likelihood of the observed genotypes given the number of populations is indicated by *.

click here for file

 additional file 5
germplasm genotyped with the beadxpress snp assay. population structure was determined using structure  <cit>  with  <dig> high quality snp markers. clones used in the genotyping experiment, their species composition, market class, and their proportion in the groups are shown.

click here for file

 additional file 6
rogers genetic dissimilarity matrix  <cit> between market classes based on  <dig> high quality snp markers and  <dig> genotypes with known market class designations. genetic dissimilarity among market classes are shown.

click here for file

 additional file 7
genotypic data for  <dig> high quality beadxpress snp makers on  <dig> genotypes. genotypes for potato clones with  <dig> snp markers are shown.

click here for file

 acknowledgements
we thank david francis, lukas mueller, and alex stone for contributions to the solcap project. funding for this project was provided by grants to d.d, d.f., a.v d., w. d, l.m., a.s. and c. r. b. by the u.s. department of agriculture national institute of food and agriculture . we acknowledge the provision of the dm genome sequence by the potato genome sequencing consortium.
