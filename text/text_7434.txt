BACKGROUND
clustering is a common technique used in biology, which partitions molecular sequence data or gene expression data into groups such that the data points are highly similar within group but different between/among groups  <cit> . in general, clustering methods are divided into  <dig> categories: the non-model-based  approaches and the model-based approaches  <cit> . the widely used k-means method, as well as its variants, is a non-model based method. model-based clustering techniques can be traced at least as far back as  <dig>  <cit> . in model-based clustering the data are assumed from a finite mixture of different probability models such as the multivariate normal distributions . with the underlying probability models, the number of clusters and the parameters in the probability models are estimated using statistical methods such as the expectation maximization  algorithm. a review of model-based clustering can be found in  <cit> .

the clustering methods can also be divided into partitional clustering and hierarchical clustering  <cit> . a partitional clustering method divides the data objects into m  groups according to some optimization criteria. the k-means algorithm is a classic example of partitional methods  <cit> . a hierarchical method builds a hierarchical set of nested clusters, with the clustering at the top level containing a single cluster of all data objects, and the clustering at the bottom level containing singleton clusters . the resulting hierarchy shows at each level  <dig> clusters are merged together with the inter-cluster distance presented, and thus provides a good visualization tool. the single-link, complete-link and average-link clustering methods are examples of hierarchical clustering.

influenza virus is an important pathogen not only to humans, but also to many other animals such as birds and pigs  <cit> . the influenza virus can evolve rapidly to avoid detection and neutralization by the host immune system. detecting new viral strains is thus an ongoing task for improved influenza surveillance and control. to this end, the who , oie  and fao  h5n <dig> evolution working group developed a clade nomenclature system for eurasian highly pathogenic avian influenza  a  viruses  <cit> . several statistical and bioinformatics issues remain unresolved, including how to cluster the sequences more accurately, how to visualize the clustering results intuitively, and how to evaluate the certainty of the sequences within a cluster and the certainty of a cluster.

in our previous study,  <dig> dimensional scaling analysis was conducted on  <dig> ha sequences of well-represented hpai h5n <dig> viruses to evaluate the above clade designation system by who/oie/fao  <cit> . in this paper, we focused on the model-based clustering approach due to its flexibility in finding meaningful clusters in the data and applied this approach to analyze influenza viral sequences. in addition, we designed a subset bootstrap scheme and applied it to estimate the certainty of a given sequence assigned to a particular cluster as well as the certainty of clustering .

methods
similarity estimation and visualization
in our proposed method, pairwise distances of aligned sequences were computed using the identity matrix. the resulting matrix contains the squared root of pairwise distances. many existing methods cluster sequences by directly applying clustering algorithms  to pairwise distances. we do not recommend this approach since many of such methods  require independence of the data and this requirement is not satisfied due to the dependence of the pairwise distances. instead, we apply the multidimensional scaling  methods to the distance matrix to explore the similarity or dissimilarity features in the data by assigning a location, i.e., the coordinates in a d-dimensional space, to each sequence, where d is specified a priori. the mds method can provide the location data that closely preserves the pairwise distances. the mds is a statistical method often used in data visualization for exploring similarities or dissimilarities of objects in a parsimonious way. other methods that have similar property as the mds methods include the principle component analysis, among others. with the location data available in the d-dimensional space, the corresponding sequences can be visualized using graphical tools.

mixture model analysis
denote the location of a sequence generated by mds in the d-dimensional space by x = . in the multivariate normal mixture model, the location data obtained from mds are assumed from a mixture of multivariate normal distributions where each distribution represents a cluster. the multivariate normality assumption is not a very restrictive assumption. it has been demonstrated in the literature that a non-normal component in the data can often be approximated by several normal ones  <cit> . assume that there are s sequences, and the s data points x <dig> …,xs generated using mds are from a g-variate normal distribution n , where μk is the mean vector and ∑k is the covariance matrix, the likelihood function of x <dig> …,xs is  <dig> lθ <dig> …,θg;π <dig> …,πg|x=∏i=1s∑k=1gπkfkxi|θk, where fk is the d-variate normal density of n , θk =  and πk  is the probability that an observation is from n , the k-th cluster, satisfying ∑k=1gπk= <dig> 

the multivariate mixture model  can be fit by using the r-package mclust  <cit> . the optimal model is selected by comparing the bayesian information criterion  value of each model. the bic is the value of the maximized log-likelihood with a penalty for the number of parameters in the model, and allows comparison of models with different parameterizations and/or different numbers of clusters. as stated in  <cit> , in general the larger the value of the bic, the stronger the evidence for the model and the number of clusters. based upon the fitted multivariate normal mixture model, the sequences can be assigned to the clusters according to their highest posterior probabilities.

certainty estimation
an important question about a clustering method is the certainty in the clustering results. there are actually  <dig> related questions: the certainty in the clustering of individual sequences in a cluster and the certainty of clusters.

the certainty of individual sequences in a cluster
denote by zi =  the conditional  probability vector of the observed sequence i, is classified to the clusters, 1 ≤ i ≤ s, where g is the number of clusters determined. we define the certainty associated with sequence i as max , which is the probability that sequence i belongs to the cluster in which it has been classified. to summarize the certainties in the classification of individual sequences, we use the  <dig> number summary  of {max , 1 ≤ i ≤ s} as an overall measure of certainty in the classification of all sequences. fraley and raftery  <cit>  used the concept of uncertainty instead of certainty which is simply equal to  <dig> minus the certainty. for sequence analysis, it is more convenient to use certainty as a measure of stability in clustering instead of uncertainty.

the certainty of clusters
the subset bootstrap method
bootstrapping is a well-accepted and widely used method based upon random sampling with replacement method to estimate support values for clustering or groupings. it is a method vertically drawing samples with replacement, and hence can mimic molecular evolution events such as substitution, deletion or insertion. the general practice of bootstrapping molecular sequences is to resample the whole set of sequences  <cit> . more specifically, the aligned sequences are formed as a matrix with each sequence as a row of the matrix. the bootstrap method constructs a bootstrap data by re-sampling all columns of the original sequence data matrix with replacement. the standard bootstrap method assumes the independence of the columns of the aligned sequences  <cit> .

the assumption of independence among the nucleotide bases of a dna sequence is obviously questionable. bootstrap methods for dependent data are an active research area. some of the well-known methods are the subsampling method and the block bootstrap method  <cit> , among others. in the subsampling method random subsamples of consecutive observations of length  are taken from the whole sequence. the subsampling method has quite universal applicability. however, a poor rate of convergence has been shown in literature  <cit> . in the block bootstrap method blocks of consecutive observations are drawn with replacement from a set of blocks. the block bootstrap is a very powerful method for dependent data and has a very broad range of applications. nevertheless, it is hard to justify its use for re-sampling dna sequences. in this paper, we argue a more appropriate way to mimic natural evolution is to re-sample only a randomly selected subset of the nucleic acid bases of the sequences while keeping the remaining of the sequences fixed.

we propose a subset bootstrap method, where the practitioner first decides the proportion of the sequence being sampled, and bootstrapping is then conducted by randomly choosing this proportion of the nucleic acid bases of the dna sequences as the subset for re-sampling, while keeping the remaining sequence unchanged. specific to our sequence data, we first randomly select a subset of columns from the aligned sequences according to the pre-determined proportion. then, the standard bootstrap procedure is applied to the positions of the selected columns in the subset to obtain a bootstrap sample. the obtained new matrix is called a subset bootstrap sample. after a subset bootstrap sample of sequences is available, the finite mixture model is fitted to the subset bootstrap sample, and clustering is conducted based on the newly fitted finite mixture model.

a reasonable way to choose an appropriate proportion of subsampling in the subset bootstrap method is to use the average substitution rate among observed sequences under study. more specifically, we calculate the substitution rate from each pair of observed sequences, and then use the average rate as the proportion of sub-sampling in the subset bootstrapping method. a more sophisticated way of determining the proportion of subsampling is to randomly select a value from the rates of changes calculated from each pair of observed sequences, i.e., to apply the bootstrap method to the pairwise rates of changes. however, for simplicity we will only use the average rate as the proportion of subsampling in this paper.

evaluation of the certainty of clusters
one difficulty in evaluating the certainty/uncertainty of clusters is how to define the similarity of  <dig> clusters. well-known similarity measures include the jaccard coefficient , among others. we decided to use the jaccard coefficient due to its simplicity and other appealing features  <cit> . the jacard coefficient is defined as follows: γ=|c1∩c2||c1∪c2|, where c <dig>  c <dig> are any  <dig> clusters and |▪| is the number of elements in the set. it can be easily seen that the jaccard coefficient is  <dig> when  <dig> clusters are the same, is zero if  <dig> clusters are disjoint, and is between  <dig> and  <dig>  otherwise. some theoretical justifications for the use of the jaccard coefficient to compare clusters can be found in  <cit> .

denote by c = {c <dig> …,ci…,ci} the clustering obtained from the original data, where ci is the ith cluster and i is the number of clusters. for any given cluster ci, we evaluate its certainty as follows:

given a pre-determined bootstrapping proportion p and let b be the index of the bootstrap sample from the subset bootstrap sampling, b =  <dig> …,b. for each b,

step 1: simulate the subset bootstrap sequences using the subset bootstrap method.

step 2: apply mclust to the bootstrapping sample to obtain a new clustering, denoted as c~b={c1∗,…,cjb∗},, where cj* is the jth clusters and jb is the number of clusters of the new clustering, which may be different from the number of clusters of the original clustering, it may also be different depending on bootstrap samples.

step 3: calculate the maximum jaccard coefficient between ci and each cluster cj* in the new clustering c˜b and define it as the jaccard coefficient between ci and c˜b, i.e., j=max1≤j≤jb{j}, where i= <dig> …,i;b= <dig> …,b. 

the certainty of cluster ci is defined as  <dig> jci=∑b=1bjcic˜b/b, where i= <dig> …,i. 

to estimate certainty between two clusterings, the jaccard coefficient is the proportion of observation pairs  belonging to the same cluster in both clusterings out of all the observation pairs belonging to the same cluster in at least  <dig> of the clustering. specifically, let c <dig> c <dig> be  <dig> clusterings, and let n <dig> be the number of observation pairs belonging to the same cluster in both clusterings; n <dig> be the number of observation pairs belonging to the same cluster in the first clustering, but not the second clustering; and n <dig> be the number of observation pairs belonging to the same cluster in the second clustering, but not the first clustering. the jaccard coefficient is defined as  <dig> jc1c2=n11n11+n10+n <dig>  

using the clusters obtained from the mixture model analysis of the original sequences of avian influenza viruses, we use the following algorithm to calculate the overall certainty of the clusters. given a pre-determined bootstrapping proportion p and let b be the index of the bootstrap sample, b =  <dig> …,b. for each b,

first, repeat steps  <dig> and  <dig> from the previous algorithm.

step 3: calculate jcc˜b, b =  <dig> …,b, where c,c˜b are defined the same as before, i.e., they are the original clustering and the clustering obtained from the bth subset-bootstrap sample, respectively.

with jcc˜b being defined as , we define  <dig> jc=∑b=1bjcc˜b/b, 

as the overall certainty of clustering c.

data sets and analysis
experimental dataset  <dig>  kindly provided by the who/oie/fao h5n <dig> evolution working group , includes  <dig> ha sequences of hpai h5n <dig> viruses, each with approximately  <dig>  nucleotides. these sequences were selected from vaccine strains, reference strains, human isolates, pathogenesis study strains, and geographically diverse isolates in order to establish a unified system to name existing clades of highly pathogenic h5n <dig> avian influenza a viruses  <cit> .

experimental dataset  <dig> includes  <dig>  ha sequences of all influenza a viruses with a h <dig> subtype, each with approximately  <dig>  bp, downloaded from fludb . the sequences were aligned with clustalw  <cit>  and the alignment was carefully checked and manually edited using bioedit  <dig>  . the clustering analysis was conducted using the r-package. the aligned sequences were analyzed using dist.alignment function in the r package seqinr to compute pairwise distances using identity matrix. the multidimensional scaling  analysis was then conducted using the cmdscale module. we used the function plot3d rgl to display the influenza sequences in 3d space and employed clusteval to calculate the overall cluster certainty.

RESULTS
the experimental dataset  <dig> was studied previous in  <cit> , where a 2d mds was used to visualize structure of hpai h5n <dig> ha sequence data. further investigation identifies  <dig> issues: 1) the 2d mds may not be an optimal way to represent the complexity of the sequence data; 2) there is no estimation of confidence level for individual sequences or specific clusters. to address the first issue, we used the criterion suggested in  <cit>  to select the dimension of mds . the mardia criterion  shows significant increases for d from  <dig> to  <dig> and from  <dig> to  <dig> , and after that the increase becomes less obvious. therefore, we chose d =  <dig>  figure  <dig> shows the corresponding 3d mds plot of the h5n <dig> ha influenza sequences, which obviously provides better separation between clusters . figure  <dig> displays the bic values for different numbers of clusters. it can be seen clearly that the optimal number of clusters according to bic values of vev, vvv, and eev models is  <dig>  with corresponding bic values being  <dig> ,  <dig> , and  <dig> , respectively. figure  <dig> shows the  <dig> clusters identified by mclust for the hpai h5n <dig> ha sequences. figure  <dig> provides a snapshot of the 3d plot, where  <dig> clusters are clearly depicted.fig.  <dig> mardia criterion for selecting d, the number of dimensions for mds

fig.  <dig> the 3d mds plot of highly pathogenic avian influenza  h5n <dig> ha sequences

fig.  <dig> the bic values corresponding to different numbers of clusters for highly pathogenic avian influenza  h5n <dig> ha sequences

fig.  <dig> the mclust results from 3d-mds location data of highly pathogenic avian influenza  h5n <dig> ha sequences

fig.  <dig> the 3d representation of highly pathogenic avian influenza  h5n <dig> ha sequences



we compared the clusters obtained from mclust based on the 3d mds and those from the clade designation of who. there is a general consensus between the clusters obtained in the present study from mclust and designed previously by who . we calculated the certainties of individual sequences in specific clusters using the method described and found that for all  <dig> sequences the certainties assigned to a specific clade are all equal to  <dig> , which indicates that the sequences within cluster are very similar and that the sequences between the clusters are distinct. to summarize the uncertainties in the classification of individual sequences, we obtained the  <dig> number summary  of {max , 1 ≤ i ≤ s} as an overall measure of certainty in the classification of all sequences. not surprisingly, for this dataset the certainties in the  <dig> number summary are all  <dig> .

in order to conduct the subset bootstrap method to evaluate the certainty of clustering obtained from the mixture model method, we first calculated the average substitution rate  from the h5n <dig> ha sequences. then we used this rate for the subset bootstrap. the certainties of clusters and the clustering are then calculated using  and , respectively. the clustering c = {c <dig> …,c9}, the reference clustering in  and  for calculating the certainties, was obtained by applying model based method  to the original data and is reported in the first column of additional file 1: table s <dig>  it can be seen that {c <dig> …,c9} is consistent with the who-curated clade information. each cluster is either a clade, a subclade, a combination of clades, or a combination of subclades of the same clade. we have not observed any case in which  <dig> influenza sequences belonging to the same clade or subclade were assigned to different clusters.

table  <dig> shows that the certainties of given sequences assigned to a specific cluster are high, ranging from  <dig>  to  <dig>  and the overall certainty of clustering is  <dig>  . for comparison, we included the results from the standard bootstrap method  in table  <dig>  apparently, as we expected, the certainty values estimated using the subset bootstrap method are all higher than those estimated using the standard bootstrap method, suggesting our bootstrap scheme is practicable.table  <dig> the certainties of clusters and overall clustering for highly pathogenic avian influenza hpai h5n <dig> ha sequences



it is tempting to fit the mclust directly to the pairwise distance matrix due to its simplicity. however, fig.  <dig> shows that the resulting bic plot of influenza h <dig> ha sequences  does not provide a clear answer to the question, i.e., which model is the best. this may be caused by the noise in the original pairwise distance matrix, as well as the correlation between the rows of the matrix. the mds method, however, provides an approximation to the proximity between sequences by representing them in a lower-dimensional space, while filtering out the noise in the pairwise distances. this motivated us to consider fitting mclust on the location data obtained from mds, instead of directly on the pairwise distance matrix. figure  <dig> provides a snapshot of the 3d plot.fig.  <dig> the bic values corresponding to different numbers of clusters for influenza h <dig> ha sequences

fig.  <dig> the 3d representation of  <dig> clusters for influenza h <dig> ha sequences



we used the 3d mds to obtain the location data of influenza a  ha sequences in a  <dig> dimensional space. by fitting the finite normal mixture model with the 3d coordinates of  <dig>  sequences, we obtained a finite normal mixture with  <dig> clusters. figure  <dig> shows a snapshot of the  <dig> clusters. the clustering result of the sequences is shown in additional file 2: table s <dig>  the vast majority of sequences are assigned to a specific cluster with over  <dig>  certainty, and only  <dig> sequences among  <dig>  whose certainty is less than or equal to  <dig>  . we estimated the average substitution rate from the  <dig>  sequences and used  <dig>  as a threshold for the subset bootstrap. table  <dig> reports the certainties of clusters from the subset bootstrap method and the standard bootstrap method, which shows the subset bootstrap method performs better than the standard bootstrap method. the certainties for cluster  <dig> and  <dig> are both below  <dig> , indicating these  <dig> clusters are not well-supported by the bootstrapping data. we investigated the phylogenetic tree of the sequences in cluster  <dig> and found at least  <dig> subgroups in this cluster . the low certainty values for some clusters might be contributed by the homogeneity variation of sequences within clusters.table  <dig> certainties of influenza a  ha sequences assigned to a specific cluster a



a sequences not listed with a certainty of over  <dig> 



CONCLUSIONS
we formulated a clustering approach with the estimation of certainty and visualization of sequence data in 3d and applied it to analyse  <dig> datasets of influenza virus ha sequences. the results demonstrated the applicability of our approach in evolutionary clade assignment.

additional files
additional file 1: table s <dig>  cluster id from mclust, who designation of hpai  a ha sequences. cluster id from mclust of the influenza a  ha sequences. 

additional file 2: table s <dig>  cluster id from mclust of the influenza a  ha sequences. 

additional file 3: figure s <dig>  phylogenetic tree of influenza a  ha sequences in cluster  <dig>  



