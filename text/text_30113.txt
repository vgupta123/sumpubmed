BACKGROUND
normalization of microarray data is essential for removing systematic variation and biases that are present due to the nature of the assay. in experiments where the goal is to determine differential expression scientists have developed a variety of tests and algorithms to identify differentially expressed genes. one such experiment was the "golden spike" experiments by  <cit> . in the experiment six affymetrix chips were divided into two groups: a control group  and a spike group . the s sample contains the same crnas as the c sample, except for ten selected groups of approximately  <dig> crnas per group that are present at a defined increased concentration compared to the c sample. this results in  <dig> crnas, where  <dig> crnas are spiked in with differing concentrations between the s and c samples. the rest  are present at identical relative concentration between the two sets of microarrays. this type of experiment models the general paradigm of experiments meant to detect differential expression. recently, however, the validity of inference based upon the golden spike experiment has been questioned  <cit> .

a key component to the golden spike dataset is knowledge of the null p-values for tests of differential expression, that is, information of the genes that are present in a 1: <dig> ratio on the s chips and the c chips provides knowledge of which tests for differential expression are truly null. figure  <dig> provides a schematic of the two stage procedure used to obtain the sets of null p-values referenced in  <cit>  and  <cit> . the raw golden spike dataset consists of data generated by the scanning device used to measure the relative spot fluorescence values across each microarray chip. for oligonucleotide  experiments such as the golden spike, the nature of the design demands heavy statistical intervention.

in microarray experiments, the end-stage analysis usually consists of simple two-sample test statistics such as the t-statistic or the wilcoxon rank sum test statistic to test for differential expression. however, it is important to note that these statistics generally operate upon data matrices which have been subjected to potentially significant amounts of pre-processing. with this technology, there are several steps required in order to process the data in order to achieve a single value representing the intensity for a given probe. it is worthwhile to consider the affymetrix data acquisition in two stages. a stage i analysis includes image processing where each spot is deemed to consist of a collection of pixels. from the collection of pixels at a spot an overall signal value is determined by taking a summary measure  of the pixel set at each hybridization location on the chip. in the affymetrix data design there are  <dig> probe pairs spotted for each gene or snp. each probe pair contains two 25-mer dna oligonucleotide probes; the perfect match  probe matches perfectly to the target rna, and the mismatch  probe which is identical to its pm partner probe except for a single homomeric mismatch at the central base-pair position. the mm probe serves to estimate the nonspecific signal. in this stage, the pm and mm signals are combined into one score representing the expression signal for a specific probe. the major software packages for stage i analysis include bioconductor's "affy" package, dchip and mas  <dig>  executables  <cit> . each software package varies in how the image processing is performed and how the pm and mm values are combined. after obtaining a signal for each probe, the next step in the stage i analysis is to "normalize" the data accounting for between chip effects, spatial effects, intensity effects, a possible grid effect, and any nonlinear intensity/variation effects. popular normalizing methods include lowess and loess smoothers to remove systematic sources of noise  <cit> .

the stage i analysis often involves a matrix of dimension p by m where the p rows refer to the different probes, and the m columns refer to the different chips. the general procedure in normalizing this data is to use loess smoothers on the data set. one of the motivations for the golden spike experiment was to examine the numerous and varied normalization methods that currently exist for this data. most of the normalization methods consider the data as a function of the matrix column. the goal of any of these normalization schemes is to reduce the systematic variation that exists in each chip. by considering each column of the data matrix as a separate chip, in each column we can scale and center the values, via loess smoothers so that each column has roughly the same "center" and "scale." this general approach  does not deal well with nonlinear relationships between arrays. another method from  <cit>  is to transform the data via quantile regression so that the distribution of probe intensities is roughly the same across arrays. at this stage, the normalization should result in a dataset where the systematic variation is reduced in order to get a clearer glimpse of the biological variatio that is present in these experiments.

ultimately, the stage i analysis results in an x matrix of dimension p by m for each experiment where the p rows correspond to each  probe value and the m columns correspond to the sample. in the golden spike datasets, numerous options in the stage i analysis were examined, resulting in  <dig> different x matrices with each matrix corresponding to a different set of parameters in a stage i analysis. from these  <dig> datasets,  <dig> "best" datasets were chosen that represented the best combination of processing in terms of detecting approximately  <dig> percent of true differentially expressed genes  with changes greater than twofold, but less than  <dig> percent with changes below  <dig>  fold before exceeding a  <dig> percent false-discovery rate. at this point, each data matrix x represents the input for stage ii analysis. the goal of stage ii analysis is to answer the researcher's questions of the experiment. usually in the microarray setting this consists of a ranked list of genes determined to be differentially expressed between two groups such as treatment versus control. the methods of stage ii generally take in to account facets of the experimental design and allow the user to control for things like the false discovery rate  within a given two sample test environment. often the validity of stage ii analyses depends upon the assumption that the stage i analysis has provided a stage ii data matrix such that the two sample test statistic null p-values are uniformly distributed.

dabney and storey  <cit>  provide a re-analysis of the golden spike dataset in which they consider the most common choices for the stage ii analysis  and demonstrate that the null p-values for the choe et al.  <dig> best datasets were non-uniform in all cases. the authors note that statistical methods to control the fdr require the assumption that the true null p-values are uniformly distributed and hence the golden spike data can not be utilized to assess the performance of such methods. furthermore, dabney and storey conclude that the non-uniform distributions of p-values are the direct consequence of an experimental design which requires that technical replicates adequately approximate biological replicates. the authors provide simulation results which demonstrate that technical replicates analyzed as biological replicates can provide non-uniform null p-value distributions but fail to provide any evidence that the parameter values that evoke this behavior are consistent with the set of conditions under which the golden spike experiment was conducted. presumably the reader is left to infer that because the null p-values are non-uniform and because technical replicates analyzed as biological replicates can provide non-uniform null distributions, then the technical replicates generated by the golden spike experiment do not adequately approximate biological replicates.

we have replicated and extended the analyses of dabney and storey and we agree with the assessment that the null p-values are indeed non-uniform. we also agree with the conclusion that, given current pre-processing  technologies, the golden spike datasets should not serve as reference datasets to evaluate fdr controlling methodologies. however, we disagree with the assessment that the non-uniform p-values are merely the byproduct of testing for differential expression under the assumption that chip data are approximate to biological replicates when, in fact, they are not. whereas dabney and storey attribute the non-uniform p-values to violations of the stage ii model assumptions, we provide evidence that the non-uniformity can be attributed to the failure of the stage i analyses to correct for systematic biases in the raw data matrix.

a recent article by irizarry et al.  <cit>  identifies four characteristics of the feature level data  which offer a possible explanation for the inconsistencies between the conclusions presented in  <cit>  and  <cit> . irizarry et al. argue that the four observed characteristics imply that the assumptions common to most pre-processing algorithms are not satisfied and hence the expression measure methodologies considered in  <cit>  are likely to be flawed. whereas irizarry et al. describe the effect of the experimental design on the feature level data, we consider the effect on the underlying multivariate distribution of putative null p-values. specifically, we demonstrate that the  <dig> best stage i analyses considered in  <cit>  and  <cit>  provide stage ii data matrices in which the columns are neither adequately centered nor adequately scaled. further we note that the observed deviations in centering and scaling are intensity dependent. the intensity dependence of the stage ii data values leads to putative null distributions which are intensity dependent and hence non-uniform. we provide simple diagnostic plots which indicate that the relative center and scales of the underlying distributions for the control and spike-in expression values vary as a function of signal intensity.

although the scope of this manuscript is in large part restricted to the re-analysis of the golden spike dataset, we also apply several of the same diagnostic plots to another affymetrix spike-in experiment. the results suggest that some of the intensity dependent effects may exist in other settings. we relegate the extensive application and the continued development of such diagnostics to future research.

RESULTS
re-analysis of the golden spike dataset
our analysis of the golden spike dataset reveals that the null two sample t-test p-value distributions are non-uniform across the  <dig> combinations of stage i analyses. the fact that all distributions were non-uniform implies that this problem can not be attributed to the procedure utilized to identify the ten best datasets. the two sample test was conducted using the equal variance t-test so that the analysis would be consistent with the one presented in  <cit> . other test statistics  were considered and yielded similar results, a finding which is also consistent with those reported in  <cit> . figure  <dig> contains sample quantile plots for the  <dig> sets of null p-values corresponding to the  <dig> datasets described in  <cit> . the black curves in figure  <dig> correspond to the ten best datasets . the grey curves in figure  <dig> correspond to the remaining  <dig> datasets and demonstrate that non-uniform null p-values were observed in datasets other than the ten best.

observed p-value distributions inconsistent with model of dabney and storey
dabney and storey attributed the non uniform distribution of p-values to the fact that the golden spike experimental design requires technical replicates to masquerade as biological replicates. in their response to  <cit> , the authors of  <cit>  acknowledged that the three spike-in and three control chips were technical replicates but they argued that the differences in the relative concentrations of the fold change one genes within the master spike-in sample  compared to those in the master control sample should have had a negligible impact on the observed expression values.

dabney and storey proposed the following model for i genes, i =  <dig>   <dig> ...m, j treatments, j = c,s and k technical replicates, k =  <dig>   <dig>   <dig> and the stage ii expression data matrix x:

 xijk = μij + εij + φijk 

where

 =
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawadaqaauaabeqaceaaaeaaiigacqwf8oqbdawgaawcbagaemyaakmaem4qameabeaaaoqaaiab=x7atnaabaaaleaacqwgpbqacqwgtbwuaeqaaaaaaogaay5waiaaw2faaiabg2da9maadmaabaqbaeaabiqaaaqaaiabb2gatjabbwgaljabbggahjabb6gaujabbccagiabb+gavjabbagamjabbccagiabbeganjabbwgaljabb6gaujabbwgaljabbccagiabdmgapjabbccagiabbagamjabb+gavjabbkhayjabbccagiabbsha0jabbigaojabbwgaljabbccagiabbogajjabb+gavjabb6gaujabbsha0jabbkhayjabb+gavjabbygasjabbccagiabbohazjabbwgaljabbsha0bqaaiabb2gatjabbwgaljabbggahjabb6gaujabbccagiabb+gavjabbagamjabbccagiabbeganjabbwgaljabb6gaujabbwgaljabbccagiabdmgapjabbccagiabbagamjabb+gavjabbkhayjabbccagiabbsha0jabbigaojabbwgaljabbccagiabbohazjabbchawjabbmgapjabbugarjabbwgaljabb2catiabbmgapjabb6gaujabbccagiabbohazjabbwgaljabbsha0baaaiaawufacagldbaaaaa@8fee@ 

 ~n <dig> σi2)
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawadaqaauaabeqaceaaaeaaiigacqwf1oqzdawgaawcbagaemyaakmaem4qameabeaaaoqaaiab=v7alnaabaaaleaacqwgpbqacqwgtbwuaeqaaaaaaogaay5waiaaw2faaiabc6ha+jabd6eaonaabaaaleaacqaiyagmaeqaaowaaewaaeaadaqadaqaauaabeqaceaaaeaacqaiwaamaeaacqaiwaamaaaacagloagaayzkaagaeiilawiae83wdm3aa0baasqaaiabdmgapbqaaiabikdayaaakmaadmaabaqbaeqabigaaaqaaiabigdaxaqaaiab=f8aybqaaiab=f8aybqaaiabigdaxaaaaiaawufacagldbaaaiaawicacaglpaaaaaa@4ca1@ 

and φijk~n . in the model stated in equation , straightforward calculations show that for gene i we have the following distribution:

 ~n <dig>  )
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawadaqaauaabeqageaaaaqaaiabdiha4naabaaaleaacqwgpbqacqwgdbwqcqaixaqmaeqaaagcbagaemieag3aasbaasqaaiabdmgapjabdoeadjabikdayaqabaaakeaacqwg4baedawgaawcbagaemyaakmaem4qamkaeg4mamdabeaaaoqaaiabdiha4naabaaaleaacqwgpbqacqwgtbwucqaixaqmaeqaaagcbagaemieag3aasbaasqaaiabdmgapjabdofatjabikdayaqabaaakeaacqwg4baedawgaawcbagaemyaakmaem4uamlaeg4mamdabeaaaaaakiaawufacagldbaacqgg+bgfcqwgobgtdawgaawcbagaegonaydabeaakmaabmaabawaaewaaeaafaqabegbbaaaaeaacqaiwaamaeaacqaiwaamaeaacqaiwaamaeaacqaiwaamaeaacqaiwaamaeaacqaiwaamaaaacagloagaayzkaagaeiilawiaeeiiaayaamwaaeaafaqabegacqabbaqbaeqabmwaaaqaaggaciab=n8aznaadaaaleaacqwgpbqaaeaacqaiyagmaagccqghrawkcqwfepaddaqhaawcbagaemyaakgabagaegomaidaaagcbagae83wdm3aa0baasqaaiabdmgapbqaaiabikdayaaaaoqaaiab=n8aznaadaaaleaacqwgpbqaaeaacqaiyagmaaaakeaacqwfdpwcdaqhaawcbagaemyaakgabagaegomaidaaagcbagae83wdm3aa0baasqaaiabdmgapbqaaiabikdayaaakiabgucariab=r8a0naadaaaleaacqwgpbqaaeaacqaiyagmaaaakeaacqwfdpwcdaqhaawcbagaemyaakgabagaegomaidaaagcbagae83wdm3aa0baasqaaiabdmgapbqaaiabikdayaaaaoqaaiab=n8aznaadaaaleaacqwgpbqaaeaacqaiyagmaaaakeaacqwfdpwcdaqhaawcbagaemyaakgabagaegomaidaaogaey4kasiae8hxdq3aa0baasqaaiabdmgapbqaaiabikdayaaaaaaakeaafaqabewadaaabagae83wdm3aa0baasqaaiabdmgapbqaaiabikdayaaakiab=f8aybqaaiab=n8aznaadaaaleaacqwgpbqaaeaacqaiyagmaagccqwfbpgcaeaacqwfdpwcdaqhaawcbagaemyaakgabagaegomaidaaogae8xwdihabagae83wdm3aa0baasqaaiabdmgapbqaaiabikdayaaakiab=f8aybqaaiab=n8aznaadaaaleaacqwgpbqaaeaacqaiyagmaagccqwfbpgcaeaacqwfdpwcdaqhaawcbagaemyaakgabagaegomaidaaogae8xwdihabagae83wdm3aa0baasqaaiabdmgapbqaaiabikdayaaakiab=f8aybqaaiab=n8aznaadaaaleaacqwgpbqaaeaacqaiyagmaagccqwfbpgcaeaacqwfdpwcdaqhaawcbagaemyaakgabagaegomaidaaogae8xwdihaaaqaauaabeqadmaaaeaacqwfdpwcdaqhaawcbagaemyaakgabagaegomaidaaogae8xwdihabagae83wdm3aa0baasqaaiabdmgapbqaaiabikdayaaakiab=f8aybqaaiab=n8aznaadaaaleaacqwgpbqaaeaacqaiyagmaagccqwfbpgcaeaacqwfdpwcdaqhaawcbagaemyaakgabagaegomaidaaogae8xwdihabagae83wdm3aa0baasqaaiabdmgapbqaaiabikdayaaakiab=f8aybqaaiab=n8aznaadaaaleaacqwgpbqaaeaacqaiyagmaagccqwfbpgcaeaacqwfdpwcdaqhaawcbagaemyaakgabagaegomaidaaogae8xwdihabagae83wdm3aa0baasqaaiabdmgapbqaaiabikdayaaakiab=f8aybqaaiab=n8aznaadaaaleaacqwgpbqaaeaacqaiyagmaagccqwfbpgcaaaabaqbaeqabmwaaaqaaiab=n8aznaadaaaleaacqwgpbqaaeaacqaiyagmaagccqghrawkcqwfepaddaqhaawcbagaemyaakgabagaegomaidaaagcbagae83wdm3aa0baasqaaiabdmgapbqaaiabikdayaaaaoqaaiab=n8aznaadaaaleaacqwgpbqaaeaacqaiyagmaaaakeaacqwfdpwcdaqhaawcbagaemyaakgabagaegomaidaaagcbagae83wdm3aa0baasqaaiabdmgapbqaaiabikdayaaakiabgucariab=r8a0naadaaaleaacqwgpbqaaeaacqaiyagmaaaakeaacqwfdpwcdaqhaawcbagaemyaakgabagaegomaidaaagcbagae83wdm3aa0baasqaaiabdmgapbqaaiabikdayaaaaoqaaiab=n8aznaadaaaleaacqwgpbqaaeaacqaiyagmaaaakeaacqwfdpwcdaqhaawcbagaemyaakgabagaegomaidaaogaey4kasiae8hxdq3aa0baasqaaiabdmgapbqaaiabikdayaaaaaaaaagccaglbbgaayzxaaaacagloagaayzkaaaaaa@3554@ 

if we consider the linear combination:

 wi=x¯is−x¯ic
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgxbwvdawgaawcbagaemyaakgabeaakiabg2da9iqbdifayzaarawaasbaasqaaiabdmgapjabdofatbqabagccqghsislcuwgybawgaqeamaabaaaleaacqwgpbqacqwgdbwqaeqaaaaa@395f@ 

where x¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgybawgaqeaaaa@2dfd@is, and x¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgybawgaqeaaaa@2dfd@ic represent the sample mean for probe i under condition s and c, respectively, then it follows that

 wi~nσi2+23τi2).
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgxbwvdawgaawcbagaemyaakgabeaakiabc6ha+jabd6eaojabcicaoggaciab=x7atnaabaaaleaacqwgtbwuaeqaaogaeyoei0iae8hvd02aasbaasqaaiabdoeadbqabagccqggsaalcqaiyagmcqggoaakcqaixaqmcqghsislcqwfbpgccqggpaqkcqwfdpwcdaqhaawcbagaemyaakgabagaegomaidaaogaey4kasyaasaaaeaacqaiyagmaeaacqaizawmaagae8hxdq3aa0baasqaaiabdmgapbqaaiabikdayaaakiabcmcapiabc6cauaaa@4e32@ 

the standard two-sample t-statistic is given by

 t=x¯is−x¯icss2/3+sc2/ <dig> 
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgubavcqgh9aqpdawcaaqaaiqbdifayzaarawaasbaasqaaiabdmgapjabdofatbqabagccqghsislcuwgybawgaqeamaabaaaleaacqwgpbqacqwgdbwqaeqaaagcbawaaoaaaeaacqwgzbwcdaqhaawcbagaem4uamfabagaegomaidaaogaei4la8iaeg4mamjaey4kasiaem4cam3aa0baasqaaiabdoeadbqaaiabikdayaaakiabc+caviabiodazawcbeaaaagccqgguaglaaa@44ef@ 

where ss and sc represent the sample standard deviation of probe i under condition s and c respectively. it follows from  that a t-test statistic calculated with respect to random variables governed by model  constitutes an observation from a distribution which is heavier in the tails than a t <dig> distribution provided 2σi2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfdpwcdaqhaawcbagaemyaakgabagaegomaidaaaaa@30f0@>  <dig>  this follows from the fact that square of the denominator of the test statistic is an unbiased estimator of 23τi2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabikdayaqaaiabiodazaaaiigacqwfepaddaqhaawcbagaemyaakgabagaegomaidaaaaa@32e8@ and hence, a negatively biased estimator of the variance of wi. hence, evaluating t-test statistics such as  against a t <dig> distribution will provide p-values which are negatively biased. this is the crux of the dabney and storey critique of the golden spike experimental design. unfortunately the experimental design does not provide enough data to fit model  and directly estimate the relative magnitudes of σi2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfdpwcdaqhaawcbagaemyaakgabagaegomaidaaaaa@30f0@ and τi2
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaiigacqwfepaddaqhaawcbagaemyaakgabagaegomaidaaaaa@30f2@. however, it is still possible to determine that model  does not adequately explain all aspects of the observed p-value distributions for all stage ii datasets. there is an underlying symmetry to this putative model mis-specification because if the t-test statistic underestimates the actual variance, then the distributions of the one-sided p-values should be parsimonious with the distribution of the two-sided p-values. in actuality, the one-sided p-values for eight of the ten best datasets proved to be inconsistent with the two sided p-values. figure  <dig> contains the sample quantile curves for dataset 10a where solid lines correspond to the two-sided p-values and the dashed and dotted lines correspond to the p-values associated with the one sided tests. the distributions of the one-sided p-values are not in agreement. surprisingly, the set of p-values associated with the "less than" alternative appearing to contain a disproportionate number of large p-values and an insufficient number of small p-values. datasets 9a-d and 10b-d provided results similar to those observed for dataset 10a. figure  <dig> contains the sample quantile curves for dataset 10e in which the two sets of one-sided p-values appear to share the same underlying distribution.

most importantly, the model  does not adequately explain the most intriguing aspect of the observed p-value distributions for all stage ii datasets; that the distributions are not invariant with respect to the overall signal intensity. figures  <dig> and  <dig> contain curves which estimate the underlying population quartiles for the p-value distributions as a function of signal intensity for datasets 10a and 10e. the observed p-values were modeled as a function of a 4th order polynomial for rankit intensity, rank of valuetotal#of values+1
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadawcaaqaaiabbkhayjabbggahjabb6gaujabbugarjabbccagiabb+gavjabbagamjabbccagiabbaha2jabbggahjabbygasjabbwha1jabbwgalbqaaiabbsha0jabb+gavjabbsha0jabbggahjabbygasjabcocajiabb+gavjabbagamjabbccagiabbaha2jabbggahjabbygasjabbwha1jabbwgaljabbohazjabgucariabigdaxaaaaaa@52a7@. the curves were fit using quantile regression  <cit>  where the black lines correspond to the fits for τ =  <dig>   and τ =  <dig> ,  <dig>  . solid and dashed grey lines indicate the theoretical medians and quartiles, respectively. inspection of figure  <dig> reveals that the p-values for dataset 10a are negatively biased across all intensities but that the magnitude of the bias is intensity variant. inspection of figure  <dig> reveals that the p-values for dataset 10e are also negatively biased across all intensities but that the magnitude of the bias does not vary with intensity to the extent which was observed for dataset 10a. figures  <dig> and  <dig> contain curves which estimate the underlying population quartiles for the t-test distributions as a function of signal intensity for datasets 10a and 10e. as in the previous figure, the observed t-tests were modeled as a function of a 4th order polynomial for rankit intensity. the curves were fit using the quantile regression and are coded as in figures  <dig> and  <dig>  for dataset 10a, the test statistics corresponding to the null genes with overall signal intensities falling below the median all appear to be positively biased and exhibit a greater degree of variation than is compatible with the null t <dig> distribution. this observation is consistent with the previous observation that the p-values associated with the "less than" alternative contain an excessive number of large p-values. for dataset 10e, the test statistics corresponding the null genes with overall signal intensities falling in the lower 15–20% appear to be negatively biased while test statistics corresponding the null genes with overall signal intensities falling in the upper 15% appear to be positively biased. the results in figures  <dig> and  <dig> suggest that the effect that these biases have upon the relative distributions of the one-sided p-values appears to wash out across all signal intensities even though the distributions are different for genes with overall signal intensities at the extremes.

re-loessing golden spike dataset improves null distributions
each of the ten best choe et al. stage ii data matrices were obtained using stage i steps that included correcting the observed intensity with a loess curve that was fit to values from an invariant set of genes. this invariant set included present null  as well as empty null  probesets. the inclusion of the empty null probesets appears to have had a deleterious effect on the distributions of the null p-values. we have calculated a new set of ten best datasets in which the invariant set contains only the present null probesets. these calculations were performed at our request by the authors of  <cit>  using analysis scripts which were identical to those used for the original analyses except for passages of the code relating to the identification of the invariant set. the red curves in figures 2– correspond to the sample quantile curves for the re-loessed datasets. the "re-loessed" datasets are still significantly non-uniform, although noticeably less so than the original datasets. inclusion of the empty nulls in the original invariant sets appears to have contributed to the observed biases in the underlying t-distributions as inspection of figures  <dig> and  <dig> indicates that this bias appears to be mitigated in the re-loessed datasets.

other common two sample tests failed to provide uniform null distributions
although removal of the empty nulls from the invariant set provides data that is better centered than the original ten best, the results depicted in figures  <dig> and  <dig> indicate that the p-value distributions are still non-uniform and intensity dependent. we re-analyzed the re-loessed ten best datasets using three other common two sample test procedures and found that none were robust to the problems which remain in the underlying stage ii data matrices. figure  <dig> contains the results of this analysis for re-loessed dataset 10a.

distribution free diagnostic plots
a distribution free analysis of the ten best datasets  reveals that removal of the empty nulls from the invariant set provides for stage ii datasets which are adequately centered but inadequately scaled. we  refer to the analysis as distribution free because it does not include distributional assumptions associated with a test statistic. the adequacy of the centering and scaling of the data is, of course, relative. the re-loessed data appears to be adequately centered in that the probability that randomly selecting a null probeset such that the average expression value for the control samples is larger than that for the spike-in samples is approximately one half regardless of the overall signal intensity. the re-loessed data appears to be inadequately scaled in that the probability that randomly selecting a null probeset such that the variation in the expression values for the control samples is larger than that for the spike-in samples is less than one half. further this variation is dependent on the overall signal intensity. figure  <dig> contains a panel of distribution free diagnostic plots to assess the adequacy of the centering and scaling of spike-in experiment  stage ii data. to evaluate relative centering, we propose modeling the probability that, for a randomly sampled probeset, the control samples will have a median expression value greater than the matched spike-in samples using the logit of a 4th order polynomial for rankit intensity. to evaluate relative scaling, we propose modeling the probability that, for a randomly sampled probeset, the control samples will have a median absolute deviation  greater than the matched spike-in samples using the logit of a function of a 4th order polynomial for rankit intensity. given that there were only three replicates in the golden spike dataset we used the average of the two absolute deviations from the median value in place of the more common formulation of the mad . the curves presented in figure  <dig> correspond to the logistic regression fitted values. note that the curves corresponding to the relative centering of the expression values  are consistent with the biases observed in the t-statistics .

a set of diagnostic plots were created to assess whether the differences in relative centering and variability could be attributed to a one or two rogue samples. figure  <dig> includes an example panel of the diagnostic plots for sample datasets 10a and 10e. these plots constitute a variation on the theme of the plots presented in figure  <dig>  the probability that a given sample will have an expression value greater than the median of the expression values for the balance of samples was modeled as the logit of a 4th order polynomial for rankit intensity. inspection of figures  <dig> and  <dig> reveal that the within subpopulation  logistic model fits are remarkably consistent for dataset 10a and are less so for dataset 10e. none of the plots support the hypothesis that a minority of the samples  are wildly inconsistent with the majority.

diagnostic plots applied to the affymetrix spikeinsubset data
diagnostic plots were created for the affymetrix "spikeinsubset" data contained in the bioconductor  <cit>  spikeinsubset  <cit>  package. the experiment was part of a larger experiment consisting of a series of transcripts spiked-in at known concentrations and arrayed in a latin square format. figures  <dig> and  <dig> contain results for a six array subset  of the original experiment. specifically, diagnostic plots were created for the stage ii datasets created by the application of the rma, threestep, and mas preprocessing algorithms to the raw data.

this analysis does not constitute a thorough investigation of the suitability of the spikeinsubset data for validation of fdr estimation techniques. unlike the golden spike data set, only a few naive "out of the box" algorithms were applied to the raw data . figures  <dig> and  <dig> have been included to illustrate that the diagnostic plots can detect differences between  the underlying putative null distributions associated with different normalization procedures. these figure also highlight the need for the development of formal methods to assess the statistical significance of such results.

CONCLUSIONS
the golden spike dataset was generated to address a dearth of controlled spike-in array datasets. the original analysis of the data was presented in  <cit>  and concluded, among other things, that common methods to control the false discovery rate had failed to control at the nominal level. dabney and storey determined that the failure of the fdr algorithms was not methodological, rather the distributions of the null p-values corresponding to the most common choices for the stage ii analysis  were non-uniform for the datasets which were considered. dabney and storey concluded that the stage ii model assumptions  associated with these tests are not met, as the non-uniform p-value distributions imply that the technical replicates generated by the experiment do not constitute adequate approximations of biological replicates. we note that their simulation parameters are provided without justification and we demonstrate that their model is inconsistent with the observed p-value distributions. in demonstrating that their analysis is flawed, we conclude that the adequacy of the technical/biological replicate approximation remains an open research question. such a result has relevance with respect to the design of future spike-in experiments.

we suspect that the underlying null distributions are adversely effected by failures of the normalization algorithms to properly account for the abnormal feature level characteristics identified by  <cit> . while irizarry et al. speculate that the golden spike data may not be appropriate for the comparison of methods for fdr control, we confirm that this is the case and we demonstrate the failure of the stage i analyses to correct for systematic biases  in the raw data matrix.

our analysis of the golden spike data also reveals that the invariant set of genes used for the pre-processing steps in choe et al. should not have included the empty null probesets. we demonstrate that removing the empty probesets from the invariant set can provide stage ii data which appears to be adequately re-centered, a result which is dependent upon artificial knowledge of the true invariant set. unfortunately, even under these ideal conditions, issues pertaining to higher moments  remain and these issues appear to invalidate the null distributions of commonly used two sample test statistics.

our analysis constitutes proof of principle that the distributions of the p-values, tests statistics, and probabilities associated with the relative locations and variabilities of the expression values can vary with signal intensity. this implies that stage i algorithms do not always adequately adjust for intensity dependent effects. if the variation of the expression values for the null genes is a consequence of the unbalanced design of the experiment, then it is reasonable to speculate the existence of biological conditions which could engender similar imbalances. for example, such imbalances could occur when comparing different tissue types, in cases of immune challenge or in certain developmental time course studies. although it remains an open research question whether our findings apply to other datasets we note the assessment by irizarry et al. that experiments for which normalization assumptions do not hold are becoming more common.

if the diagnostics which we have introduced prove useful for other datasets, then questions of optimality must be considered. for example, one of the diagnostic tests was based upon a 4th order polynomial logistic regression model. the order and nature of the model were chosen for computational convenience. a higher order model or a spline based approach could conceivably provide an improved diagnostic. however, the properties of the diagnostic are dependent on the unknown multivariate distribution of the feature level values for invariant genes. in order to compare statistical tests for intensity dependence of the p-values we would need to characterize the multivariate distribution of the invariant probes. this is very difficult due to the complicated correlation structure among the probes ; a correlation structure that may vary from experiment to experiment. thus the task of optimizing the diagnostics is fraught with challenges and has been relegated to future research.

