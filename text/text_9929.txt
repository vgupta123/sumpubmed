BACKGROUND
large scale sequencing projects of many different species allow us to investigate phylogenetic issues in much more detail and to identify whether certain genes have had an extraordinary evolution in one or more species and thus gain insight into the actions of natural selection. despite the sequencing of an increasing number of mammalian genomes and the implementation of more sophisticated evolutionary models using maximum likelihood and bayesian methodology, the branching order within the mammalian phylum is still not completely resolved. the main reason for this uncertainty is that the diversification of these orders occurred over a short period of time, making the inference of branching order a difficult problem. one of the highly debated issues concerns the relative order of branching among primates, artiodactyls and rodents  <cit> . here, the japanese pufferfish fugu rubrices is used as an outgroup to estimate the branching order of the three species relative to each other.

codon based models  <cit>  allow for powerful analysis of protein coding nucleotide sequences. evolutionary hypotheses may be tested using likelihood ratio tests between nested models. for an introduction to the practical use of these models see  <cit> , for a more thorough review of the methodology see  <cit> . the parameter of primary interest is the ratio of nonsynonymous to synonymous substitutions , also known as the dn/ds ratio. the dn/ds ratio measures the relative importance of evolutionary forces that have shaped a particular protein. a dn/ds ratio significantly larger than one strongly suggests that positive darwinian selection has acted on the protein. different extensions to the basic codon model exist, and these can be divided into three main categories:  lineage-specific models that average ω over sites but differentiate between lineages  <cit> ;  site-specific models that average ω over lineages but differentiate over sites  <cit> ;  branch-site specific models that combine the two previous extensions by allowing ω to vary over sites in all background lineages, but allow for a different value of ω in one or more pre-specified lineages  <cit> . the models we use here and their relationships are shown in table  <dig>  numerous studies have shown the ability of the site-specific and the branch-site specific models to detect positive selection in cases where the branch-specific models did not, indicating that averaging over sites is generally a more serious problem than averaging over lineages and that in many cases using a branch-site specific model increases the power to detect positive selection  <cit> .

in a recent study of cdna trios of human, mouse and chimpanzee a codon based branch-site specific model was used to search for human genes that have undergone positive selection since our divergence from other primates  <cit> . here, a similar search is done on a different phylogenetic level using a collection of porcine genes. while the study by clark and colleagues concentrates on the divergence between humans and chimpanzees  our study searches for genes that have undergone positive selection since the divergence of primates, artiodactyls and rodents. several recent studies have shown that some of the branch-site specific models under certain conditions might have a high false positive rate when used to detect positively selected sites  <cit> . this problem has recently been addressed by yang and colleagues with the implementation of a new bayes empirical bayes  method for predicting positively selected sites. this new method is much better at avoiding false positives while still retaining a high sensitivity . here we use the new and improved beb version of the branch-site specific model originally presented in  <cit>  to detect genes that may have been influenced by positive selection.

RESULTS
the distribution of sequence lengths of the  <dig> three-species alignments is shown in figure  <dig>  since the full length cdnas were assembled from random ests, there is a bias towards assembling relatively short genes. therefore the subset of genes used in this analysis is not a random sample from the pig genome. this decreases the power of our evolutionary tests, since short alignments have less power when testing for positive selection, but we do not anticipate any other systematic bias in our results.

mammalian phylogeny
the relative branching order of the three mammalian species was investigated with the individual genes as well as with a concatenated super gene. using the empirical amino acid substitution model of whelan and goldman  <cit>  we maximized the likelihood under the three conflicting topologies shown in figure 3a–c. in  <dig> of the  <dig> alignments all amino acids are identical in the three mammalian species giving us no information to discriminate between the three topologies. of the remaining  <dig> alignments  <dig> favour topology a, while  <dig> and  <dig> favour topology b and topology c respectively. a concatenated super gene of all  <dig> alignments clearly favoured topology b over topology a, which again has a higher likelihood than topology c, consistent with the results from the individual gene comparisons .

we used the baseml program of paml to compare the three topologies in a nucleotide based framework. different nucleotide based substitution models were used to maximize the likelihood on the three topologies for each of the three codon positions separately. the results of using different models of nucleotide evolution were highly similar so here we only discuss the results obtained with the hky <dig> model  <cit> . the results based on the third codon position shows that fugu is too distantly related to the three mammals to be informative in placement of the root of the mammals . the first and second codon positions do not show such saturation and should therefore be useful in comparing the three topologies. consistent with the results based on the amino acid substitution model we see that topology b is favoured in most genes, followed by topology a and topology c, respectively. the actual numbers from the second codon position are  <dig>   <dig> and  <dig> in favour of topology a, topology b and topology c respectively and  <dig> alignments are uninformative. the corresponding numbers for the first codon position are  <dig>   <dig>   <dig> and  <dig> .

the internal branch is rather short in all cases. therefore in the remaining analyses we treat the mouse, human, pig split as a trifurcation. depending on which topology is actually the right one, the only bias introduced by treating the topology as a star tree, as shown in figure 3d, is a minor overestimation of the branch length of the species that actually roots the other two.

the rates of evolution
the three-species alignments were used to estimate the synonymous and nonsynonymous substitution rates of the three branches under the free ratio model, see table  <dig>  figure 4a–f shows the distribution of the synonymous and nonsynonymous branch lengths for each gene in all three species. the synonymous rates are significantly different between the three species. the average synonymous substitution rate, estimated using the concatenated super gene, is approximately  <dig>  times larger in mouse compared to pig, and approximately  <dig>  times larger in pig than in human. the nonsynonymous rates are more similar among the three species. the corresponding values for the nonsynonymous rates are  <dig>  and  <dig>  respectively. table  <dig> shows the mean, median and variance of both the synonymous and nonsynonymous rate distributions as well as the values obtained from the concatenated super gene. the average values from the individual genes are highly similar to the results obtained from the concatenated super gene.

positive darwinian selection
the dn/ds ratios on the three different lineages were estimated under the free ratio model . most genes in all three species have an average dn/ds ratio very close to zero with the average dn/ds ratio higher in human than in pig, which again is higher than in the mouse lineage.

the one ratio model averages over sites and lineages, which makes this an extremely conservative method of detecting positive selection. only four of the  <dig> three-species alignments have an average dn/ds ratio larger than one, see table  <dig>  and of those only one is significantly larger than one . the free ratio model allows each lineage to have its own dn/ds ratio. this model has slightly more power than the one ratio model due to its ability to find lineage specific signals. the likelihood ratio test  of these two models should not be considered as a stringent test for positive selection, but more as a test for different selective forces among lineages. the lrt shows that  <dig> genes have significantly different dn/ds ratios among lineages at the 5% significance level,  <dig> at 1% and  <dig> at the  <dig> % level of significance. table  <dig> shows the  <dig> genes that have a dn/ds ratio larger than one in one or more lineages as well as the result from each gene of a lrt that tests whether the estimated value of ω is significantly larger than one. as with the one ratio model only one gene shows a result significantly larger than one. the gene is the same one as reported with the one ratio model  and the lineage with a dn/ds ratio significantly larger than one is the lineage leading to pig.

several studies have shown that averaging over sites is more conservative when searching for positive selection than is averaging over lineages. the branch-site specific model a and model b  <cit>  were originally designed to search for genes where only a small fraction of codons in a specific foreground lineage has evolved under positive selection. several studies have shown that the original models are prone to predicting false positives under certain conditions, and one should therefore be very careful drawing conclusions from studies based on those models. here we use a new and improved version of a branch-site model developed for the analyses of human, chimpanzee and mouse gene trios  <cit> . the new model we use here is implemented in paml v.  <dig>  and uses the new and improved bayes empirical bayes approach to predict which sites have evolved under positive selection in the foreground lineage. likelihood ratio tests were done separately with human, pig and mouse as the predefined foreground lineage. the lrt when contrasting the neutral model with the branch-site model has two degrees of freedom. by using the human lineage as foreground lineage we find  <dig> genes that show signals of positive selection . in  <dig> of those genes the branch-site model fits the data significantly better than the neutral model at the 5% significance level. we find  <dig> and  <dig> genes at the  <dig>  and  <dig>  levels of significance respectively. the corresponding numbers of genes using pig as foreground lineage are  <dig>   <dig>   <dig> and  <dig>  using mouse as foreground lineage results in  <dig>   <dig>   <dig> and  <dig>  the genes found to be under positive selection in any of the three species with a lrt significance level of  <dig>  are shown in table  <dig> 

the molecular function of the genes predicted to be under positive selection was determined using the panther server  <cit>  and the ncbi server using the newest build of the human genome. both annotation servers are updated on a regular basis when new information becomes available. during the course of this study the annotation of several genes changed. of our  <dig> alignments  <dig> are currently not annotated as functional genes indicating that they might possibly be pseudogenes in human; see the discussion for more details on this subject. the proportion of genes that we report to have undergone positive selection in the human lineage at the 5% level of significance can therefore be viewed as either 58/ <dig> ~ <dig> % or 43/ <dig> ~ <dig> %, indicating that possible pseudogenes are only slightly overrepresented in the genes predicted to have undergone adaptive evolution. the genes predicted to have been under positive selection in the pig and mouse lineage show a similar trend.

several different models have been developed that allow for heterogeneity of ω over sites in an alignment. we used the m <dig> model  <cit>  which allows each codon to fall into one of  <dig> categories corresponding to ω equal to  <dig>  1/ <dig>  2/ <dig>   <dig> and  <dig>  the first category represents the fraction of codons that have evolved under strong purifying selection allowing no nonsynonymous changes to occur. the next two categories represent different intensities of purifying selection. the category with ω =  <dig> represents neutrally evolving sites, while the last category with ω =  <dig> represents codons that have evolved under positive selection. the results of this analysis on the concatenated super gene can be seen in table  <dig>  only  <dig>  % of all codons appear to have evolved under positive selection, and approximately  <dig> % have been under strong functional constraints.

codon usage bias
the concatenated super gene was also used to investigate the patterns of codon usage in the three species; the results of this investigation are summarized in table  <dig>  a test for equal codon distributions is rejected in all three pair wise comparisons . using nucleotide frequencies to estimate the codon equilibrium frequencies fits the data poorly, so does the equal frequency model . for a description of the codon equilibrium frequency models, see the methods. the f <dig> ×  <dig> model was extended with one extra parameter that accounts for cpg avoidance at the second and third codon position. since all changes in the second position of a codon are nonsynonymous, the frequency of ncg codons is expected to be lower than under the f <dig> ×  <dig> model. the extra parameter introduced improves the log likelihood by approximately  <dig> units . this can be compared to the approximately  <dig> units per extra parameter introduced when going from the f <dig> ×  <dig> model to the codon table model. when analysing the super gene it is still better to use the actual codon frequencies, but with individual genes the number of codons can sometimes be so small that the use of actual codon counts can be problematic. we also implemented a similar model that incorporated the avoidance of cg in first and second position by introducing an additional parameter but this does not improve the fit of the model significantly . this is probably caused by the fact that all four codons with cg in the first and second position code for the same amino acid, arginine. arginine has six different codons and the two codons without a cg pair  are generally favoured over the other four , but this tendency is apparently accounted for when modelling nucleotide frequencies at the three codon positions, so here we only present the model that accounts for cpg avoidance at the second and third codon position. table  <dig> shows that the choice of codon equilibrium frequency model has detectable effects on the parameter estimates. most striking is the apparent overestimation of the transition/transversion ratio and the dn/ds ratio when the model is less parameter-rich.

discussion
the phylogeny of the early mammalian radiation has been extensively debated over the last two decades. the classical view based on fossil evidence states that all major orders of placental mammals first appear right after the cretaceous-tertiary  boundary approximately  <dig> million years ago  <cit> . this sudden appearance of all major placental orders is known as the mammalian radiation. with the use of molecular data this late radiation has been challenged and it is now widely accepted that the radiation of the placental orders probably occurred many million years before the kt boundary  <cit> . molecular data have also been used to investigate the relative branching orders of many of the larger clades of placental mammals  <cit> . one of the issues that have been debated extensively is the placement of rodentia in the placental tree. some studies favour a basal placement of the rodents  <cit>  while other studies favour a sister relationship between primates and rodents  <cit> . recently strong evidence based on insertions, deletions and ancient transposable elements in favour of a sister relationship of primates and rodents has been reported  <cit> .

the incongruence of single gene phylogenies was investigated in a recent study of eight yeast species  <cit> . the phylogeny commonly believed to be correct is completely resolved when concatenating  <dig> or more randomly chosen genes to form a super gene. a concatenated multi gene approach was also shown to resolve single gene incongruences in a recent study on green algae  <cit> . here we use  <dig> full cdna alignments comprising  <dig>  nucleotides to investigate the branching order of the three mammalian species. we present results based on both single gene phylogenies and a concatenated super gene. all genes including the concatenated super gene were analysed with both nucleotide and amino acid based substitution models. all methods favour a primate-artiodactyls clade with rodents as an outgroup but with a relatively short internal mammalian branch, indicating that the mammalian radiation happened within a short period of time. the different methods used in this study have very different assumptions but they all show the same general results. the hky <dig> model takes into account differences in nucleotide frequencies and transition/transversion biases and allows for differences in substitution rates among the lineages. however, it is still possible that complexities unaccounted for such as non-stationarity and irreversibility of the substitution process have created biases that lead to long-branch attraction of fugu and mouse and an erroneous conclusion. furthermore, the incongruence between our analysis and many recent studies is also affected by the following.  the choice of outgroup; bony fishes are believed to have diverged approximately  <dig> million years ago  <cit> , making saturation effects in synonymous sites a real problem. we are therefore forced to only consider nonsynonymous sites or amino acid replacements in the phylogenetic analyses. the recently completed genome sequence of the chicken  shows that the average value of ds between human and chicken genes is approximately  <dig>   <cit> , which indicates that many genes may still be too distantly related for synonymous sites to avoid problems with saturation. a marsupial species would provide a much better outgroup when available  <cit> .  taxon sampling; by only using three species the variance of the parameter estimates can be quite high and the power to discriminate between two conflicting topologies quite low. the sequencing of more species will lessen this problem.  overly simplistic evolutionary models; here we use only nucleotide and amino acid based models. if a more closely related outgroup was available the use of more complex codon based models could be beneficial in resolving the apparent conflict. several extensions have been made to the codon models during the past few years. one obvious extension to the codon models is a model that incorporates cg avoidance within and over codon boundaries. this will clearly improve the fit of the data to the model and therefore give more accurate parameter estimates. including context dependencies over codon boundaries and information about protein structure have also been shown to increase the fit of the models to protein coding data and therefore should result in better parameter estimates  <cit> .  gene trees and species trees can be different; the split between the three groups probably occurred within a very short period of time, allowing for the possibility that different genes actually have different phylogenies due to ancient polymorphisms at the time of the speciation. using even larger number of genes and a sufficiently sophisticated model should lessen this problem  <cit> .

the rate of synonymous substitution was estimated to be almost three times higher in rodents than in other mammals, in agreement with previous investigations that also showed an elevated rate in rodents  <cit> . this has historically often been explained by a generation time effect. species that have short generation times experience more generations in the time span we consider and consequently they will experience more neutral substitutions over time. the fact that the pig, which has a generation time intermediate between mouse and humans, has an intermediate rate of synonymous substitutions, seems to agree with this theory. for a more thorough discussion of the generation time hypothesis in mammals see  <cit> . the nearly neutral theory of molecular evolution predicts that the generation time effect should be smaller for non-synonymous substitutions  <cit> . the simple argument is that animals with short generation times such as rodents often have a very large effective population size. in a population with a large effective population size slightly deleterious mutations will be removed from the gene pool more effectively than in a population with a small effective population size, where genetic drift will reduce the efficiency of natural selection. figure 4g–h shows the distribution of the dn/ds ratio in the three lineages. the average dn/ds ratio is highest in humans suggesting a small effective population size, while it is smallest in mouse suggesting a larger effective population size.

previous studies of the occurrence of positive selection based on pair wise comparisons have revealed a very low occurrence of positive selection. in a study of  <dig> alignments only  <dig> genes showed evidence of positive selection  <cit> . the branch specific models used here only find one gene where the dn/ds ratio is significantly larger than one. the gene reported is xm_ <dig>  xm_ <dig> was originally annotated as being similar to cold shock domain protein a, but it has recently been removed from genbank as a result of standard genome annotation processes.

codon based branch-site models similar to the ones used here were used in a paper based on a three way comparison among chimpanzees, humans and mice  <cit> . they report that approximately  <dig>  % of all the genes studied have been undergoing positive selection in the lineage leading to modern humans. using a similar criterion our study indicates that approximately  <dig>  % of the genes studied have been undergoing positive selection on the lineage leading to humans; the corresponding numbers for pig and mouse are  <dig>  % and  <dig>  % respectively. when comparing these two studies it is important to consider the following three things:  the relatively short average length of the genes studied here decreases the power of the models to detect positive selection;  the use of the new beb method for detecting positively selected sites should reduce the number of false positives, making our estimates more conservative and more accurate;  our study deals with a completely different phylogenetic level, covering a much longer time span than the study by clark and colleagues.

the multiple testing and the small number of taxa used in a study like this imply that the results presented should not be taken as conclusive evidence for positive selection, but more as an approach to searching among the thousands of genes to look for genes that may have evolved in a biologically interesting manner. comparative approaches such as the one we use here can only be a first step towards showing that positive darwinian selection may be a key part in the evolution of many different gene families. further experimental and computational analyses must then be used to investigate the suggested candidates more thoroughly.

during the course of our investigation a large fraction of the genes were re-annotated as putative pseudogenes: 188/ <dig> ~ <dig> %. however, all these genes have uninterrupted reading frames in all three species; only a tiny fraction of all codons seems to have evolved in a neutral-like fashion , and the distributions of the synonymous as well as the nonsynonymous rates of these putative pseudogenes are almost identical to the distributions of the remaining genes . the only difference is a slight increase in the dn/ds ratio in the human lineage, which is actually due to a few genes that experience an unusually high dn/ds ratio. omitting these genes from the analysis removes the observed differences completely. thus, if all these genes are indeed pseudogenes in human, the loss of function must have occurred quite recently and they may not be pseudogenes in pig and mouse.

CONCLUSIONS
the collection of a large set of pig cdna sequences has enabled us to study long term evolutionary trends in mammalian genes. our results indicate that the codon models are able to detect evolutionary signals indicating adaptive evolution in several genes. our phylogenetic investigation of the primate, rodent, artiodactyl split disagree with most recent findings in favouring a primate, artiodactyl clade with rodents as an outgroup. our study indicates that several genes that are not classified as genes in the most recent human annotation might after all be real genes; or at least they have become pseudogenes very recently, and the orthologous genes in mouse and pig might still be functional. this shows the potential of comparative methods in identifying functional regions of the genome.

