BACKGROUND
genetic variations in protein-coding genes play significant roles in many human diseases  <cit>  and are associated with the response to drug treatment  <cit> . whole exome sequencing  targets >95 % of the exons or approximately 1 % of the human genome  <cit> . it has been widely used to identify causal variants  <cit> , uncovering about 85 % of the causative mutations identified in mendelian diseases  <cit> .

multiple bioinformatics methods have been developed to identify variants from whole genome or exome sequencing data. the most dominant ones are based on the mapping of reads to a reference genome  <cit> , which often follow the gatk  best practices  <cit> . the gatk best practices workflows recommend read mapping by burrows-wheeler aligner , post-alignment processing, and then gatk variant calling. compared to the hash-based mappers described below, the burrows-wheeler transform -based mappers like bwa are faster but tend to be less sensitive . they were developed for mapping reads to less divergent regions  <cit> .

divergence level varies markedly across the human genome , which has a profound impact on the outcome of variant calling. while the bulk of the genome has only about  <dig>  % divergence  <cit> , some regions are highly polymorphic  <cit> . the best example is the human leukocyte antigen  region on chromosome 6p <dig> ; this ~4-mb region shows up to 10 % or higher local sequence divergence between haplotypes  <cit> . most importantly, the hla region is associated with over  <dig> diseases, predominantly autoimmune diseases  <cit> , and also with drug response  <cit> . at such high divergence, the bwa mapping rate drops to a few percent  <cit> . thus, accurate identification of sequence variation in this region is clinically important but currently hindered by the extreme polymorphism.

a few mappers have been tailored to aligning reads to more divergent regions, such as gsnap  <cit> , nextgenmap  <cit> , novoalign  and stampy  <cit> . they use 11- to 15-mer hash tables generated from the reference sequence. among them, novoalign and stampy were found to be more accurate than bwa over a wide range of divergence  <cit> . stampy performed similarly as nextgenmap at 10 % divergence  <cit>  but was superior to novoalign at higher  divergence  <cit> . gsnap is capable of mapping reads with multiple mismatches and/or long insertions and deletions   <cit> . the choice of an appropriate mapper has a big impact on variant calling  <cit> . however, previous studies often used simulated data and their primary goal was to evaluate the overall sensitivity and accuracy of different mappers. therefore, for these ‘variation-tolerant’ mappers, it remains less clear which one may strongly enhance variant detection in highly divergent regions.

several popular software packages are available for both single- and multi-sample variant calling, such as samtools  <cit> , freebayes  <cit> , gatk unifiedgenotyper and haplotypecaller  <cit> . packages like gatk haplotypecaller, scalpel  <cit>  and platypus  <cit>  combine mapping and local assembly, which are particularly attractive for indel detection.

numerous studies have compared the performance of variant callers on wes, without focusing on the highly divergent regions . these studies used either bwa or eland <dig> as the mapper that has low sensitivity in mapping divergent reads. moreover, they estimated variant detection accuracy by using single nucleotide polymorphism  sites genotyped on snp arrays that primarily target common variants. a more recent study compared gatk haplotypecaller, gatk unifiedgenotyper and samtools with novoalign as the mapper  <cit> ; however, the estimation of sensitivity was based on the high-confidence call set  <cit>  that is known to have poor coverage in the hla region. two analyses revealed low concordance of different analytical pipelines on wes data, being only 27 %  <cit>  or 37 %  <cit>  for indels among three methods and less than 60 % for snps among five methods  <cit> . these two studies highlight the difficulties in obtaining high-quality variant calls from wes  <cit> . for the whole-genome sequencing, variant calling methods generally agree well with one another in about 90 % of the genome but show marked disagreement in the other ~10 % ‘difficult regions’ of low-complexity and segmental duplications  <cit> . obviously, a better understanding of the factors leading to the low concordance among different approaches is critical for further optimization of variant discovery. furthermore, overall genome-wide performance of a variant detection method may not reflect the local scenario in highly divergent regions.

we seek to develop a workflow for more accurate variant discovery from wes data, especially in highly divergent regions. by simulating reads from chromosome  <dig> exonic regions, we systematically evaluated five popular callers together with five mappers over a wide range of divergence level and coverage depth. taking advantage of the existing call sets generated by whole genome and exome sequencing in na <dig>  we verified the findings on two wes data in this well-studied ceu  sample. our analysis revealed key factors impacting variant discovery accuracy and sensitivity. we identified the best mapper-caller combinations for variant detection in both hla and non-hla regions, and further demonstrated their excellence on wes data from a cohort of chronic lymphocytic leukemia  patients. our strategies are particularly effective for wes and should be applicable to whole genome sequencing data as well.

methods
simulation of exome-seq reads
the variation level in the human genome is typically ~ <dig>  %  <cit>  but can reach over 10 % in some extremely divergent loci like those located in the hla region  <cit> . therefore, in the simulation we defined seven divergence levels between  <dig>  and 15 % and a control with a zero percent divergence . here, divergence level represents the ratio of the number of permuted snps and indels over the total bases of the regions included in the simulation. we compiled  <dig>  non-overlapping exonic regions of chromosome  <dig>  from which 100-base paired-end reads were simulated to an average coverage of 100x using dwgsim . to investigate the impact of coverage depth on variant calling, we randomly sampled six subsets with coverage depth of 80x, 60x, 40x, 20x, 10x and 5x, respectively.fig.  <dig> mapping status of simulated reads. eight datasets were simulated to 100x per-base coverage at seven divergence levels  or without introducing sequence variation . after mapping, the total reads were first broken into those mapping to chromosome  <dig>  those mapping to other chromosomes  and unmapped reads . the reads mapping to chromosome  <dig> were then grouped into five clusters based on the distance  from their original locations to the mapping locations reported by a mapper



mapping simulated reads to the reference sequence
five mappers were selected to align simulated reads against the hg <dig> reference sequence , using the parameter settings in additional file 2: table s <dig>  specifically, we set the divergence level or substitution rate at 10 % for stampy  and gsnap  and at 20 % for nextgenmap . we used the default  for mismatches in the ‘bwa aln’ command. novoalign does not have the parameter for specifying the divergence level. the performance was measured on the basis of mapping rate and accuracy. the former was defined as the ratio of mapped reads over the total number of simulated reads, and the latter as the ratio of reads mapping back to their original locations over the total. to simplify both calculations, the two reads from each pair were treated as single-end reads without considering the pairing information. four of the mappers  use ‘soft-clipping’, which skips unaligned terminal portion from reads and only reports partial alignments between reads and the reference sequence. in estimating mapping accuracy we counted the number of soft-clipped bases shown in the cigar string and added it back to the reported mapping location. this adjusted mapping location was then compared to the original location from where a read was simulated. mapping accuracy was estimated as the ratio of reads mapping back to the original start position over the total simulated reads.

variant calling from simulated data
to reduce erroneous calls, alignments were subjected to duplicate marking and local realignment by following the gatk best practices  <cit> , but without base quality score recalibration . five callers were selected, including gatk unifiedgenotyper and haplotypecaller  <cit> , freebayes  <cit> , samtools mpileup  <cit> , and platypus  <cit> . the command and parameter settings can be found in additional file 2: table s <dig>  parameters were selected to ensure comparability among different callers. for gatk unifiedgenotyper and haplotypecaller, we set the minimum phred-scaled quality score of  <dig>  in variant calling and of  <dig>  in variant reporting. a minimum base quality score of  <dig> was used for four of the callers, except for gatk haplotypecaller that did not provide this parameter in gatk v  <dig> – <dig> used in this study. only variants with a quality score of at least  <dig> were used in the comparison. bedtools was used to identify overlap between permuted and called indels  <cit> . the performance of individual methods was evaluated on the basis of sensitivity, precision rate, and overall genotype concordance .

variant calling from na <dig> exome-seq data
to confirm the generality of the findings made from simulated reads, we tested the same mappers and callers on wes data from dna sample na <dig>  na <dig> is the first genome for which the reference genotype calls  were generated by the genome in a bottle consortium from  <dig> whole genome and three exome sequencing datasets  <cit> . the analysis integrates seven mappers and three callers. this call set covers ‘ordinary’ variants which are more readily to be identified, while the ‘difficult’ ones are largely excluded, mostly in regions of low-complexity, segmental duplications and structural variations  <cit> . in addition, three other call sets were generated by gatk haplotypecaller and two de novo assembly-based callers, cortex and discovar, from 250-base paired sequencing of a pcr-free genomic library  <cit> . they focused more on difficult variants in regions of low-complexity and segmental duplications. the union of these four call sets  was treated as the ‘true’ variants. since this public call set is compiled from variants identified through distinct analytical algorithms, multiple library preparation protocols and sequencing platforms, systematic bias toward a particular method should have been minimized in the assessment .

illumina, inc. generated  <dig> replicates of  <dig> base-pair  paired-end exome data in na <dig> . we downloaded two replicates, each with ~100x coverage on average. considering that the simulated reads have a length of  <dig> bases, pairs with one or both reads shorter than  <dig> bases were filtered out, which excluded  <dig>  and  <dig>  % of the reads, respectively, from the two replicates. from the remainder the first  <dig> bases were extracted for mapping . post-alignment processing was performed as described in the simulated reads, except that the mills and 1000g gold standard indels were used in local realignment. variants were identified using the five callers in single-sample calling mode, quality-filtered  and those matching dbsnp v <dig> were classified as known variants. given that snp clusters are prevalent in the hla region, we did not filter out snp clusters in the comparison. we compared the called variants to the public call set . the sensitivity, precision rate and overall genotype concordance of known variants were estimated as described in the simulated data.

variant calling from chronic lymphocytic leukemia  exome data
finally, we selected four of the mappers  and three of the callers and applied them to wes data from  <dig> cll patients. the selected three callers had relatively high sensitivity in snp calling , indel calling , or both  in the hla region of na <dig> . buccal cell dna was collected with written consent from the patients and approval from the institutional review board at mayo clinic. exome capture was carried out using agilent library capture kit v <dig> or v <dig>  dna was sequenced from both ends to  <dig> bases on a hiseq <dig> machine through the mayo clinic medical genome facility.

mapping, post-alignment processing, variant calling and the classification of variants into known versus novel followed the procedure used for na <dig> wes data. to assess the performance of individual mapper-caller combinations in complex genomic regions, we annotated variants regarding their sequence contexts. specifically, variants were labeled with ‘lcr’ if they were located in low complexity regions   <cit>  and with ‘sd’ if located in regions of segmental duplications . in addition, if three or more snps clustered within a window of 20 bp, they were flagged as ‘snpcluster’.

RESULTS
mapping of simulated reads
we simulated 100-bp paired reads at eight divergence levels  and seven coverage depths  from exonic regions of chromosome  <dig>  five mappers were selected to align the simulated reads to the reference sequence hg <dig> . the mapping performance was assessed on the 100x coverage datasets in terms of the proportion of accurately mapped reads and that of unmapped reads .

at divergence levels of 1 % or lower, the five mappers showed highly comparable mapping accuracy . at 5–15 % divergence, bwa had over 20 % unmapped rate; of the other four, stampy and nextgenmap had relative higher mapping accuracy . on the other hand, novoalign implements more aggressive soft-clipping than the others, which became most evident at 15 % divergence .

impact of coverage depth on variant calling
coverage is another key factor in variant calling. we sought to know how coverage might impact different callers at low versus high divergence. a total of  <dig> cases per coverage depth were evaluated, representing combinations among seven divergence levels, five mappers and five callers, with bwa included at 5–15 % divergence. not surprisingly, in  <dig>  %  of the cases, the full  coverage datasets showed the highest sensitivity in both snp and indel calling.

profiling sensitivity as a function of coverage should reveal the optimal coverage depth for individual callers; beyond which there would be much less gains in sensitivity. at 1 % or lower divergence, increasing coverage from 5x to 10x led to the biggest increase in sensitivity in both snp  and indel calling . in addition, platypus in snp calling and gatk unifiedgenotyper in indel calling required a higher coverage depth compared to the others. overall, at 40x coverage, all callers  reached  <dig> – <dig>  % of the snp calling sensitivity at 100x coverage and  <dig> – <dig>  % of the indel calling sensitivity at 100x coverage, respectively. a similar trend was observed at  <dig> and 10 % divergence , where the sensitivity at 40x reached  <dig> – <dig>  % of that at 100x in snp calling and  <dig> – <dig>  %  of that in indel calling. therefore, 40x coverage seems sufficient for most of the callers across the full range of divergence.fig.  <dig> plotting snp and indel calling sensitivity as a function of coverage depth. x-axis indicates coverage depth in simulation and y-axis denotes sensitivity. a-b snp calling sensitivity at  <dig> and 10 % divergence. c-d indel calling sensitivity at  <dig> and 10 % divergence. the  <dig> mapper-caller combinations are color-coded, using color gradient to differentiate the four mappers combined with the same caller. gatk hc gatk haplotypecaller; gatk ug gatk unifiedgenotyper



performance of the five variant callers
we tried to identify the callers that would perform well at low and high coverage depths, especially at high divergence. we used 10x to represent low and 40x and 100x to represent high coverage depth, respectively. since the change of sensitivity from 40x to 100x was very similar among different combinations , the 60x and 80x datasets were not analyzed here. we also excluded the datasets with 15 % divergence since regions with such high divergence should be rare in the genome.

we analyzed each caller by considering all the mappers together, separately at low  and high  divergence. in snp calling, gatk unifiedgenotyper had the highest sensitivity across all the divergence levels, followed by samtools and gatk haplotypecaller . freebayes is known to be less sensitive to highly divergent regions  <cit> . indeed, freebayes was comparable to the latter two callers at low but was less sensitive  at high divergence. finally, platypus had the lowest sensitivity in all the datasets. the three highly sensitive callers had similar precision rates , which were comparable to that of freebayes and higher than that of platypus .table  <dig> percent of snp and indel calling sensitivity in simulated data

individual datasets are binned into four groups based on coverage  and divergence . the values are the range of sensitivity, calculated per caller from the associated mappers and divergence levels. the five callers within each group are ranked , with “a” indicating the caller with the highest overall sensitivity. gatk ug gatk unifiedgenotyper, gatk hc gatk haplotypecaller, div divergence, cov coverage



in indel calling, overall platypus and gatk haplotypecaller were more sensitive across all the divergence levels. freebayes and samtools were less sensitive than the above two callers at high divergence ; gatk unifiedgenotyper, which requires a higher coverage , was over 20 % less sensitive than the other callers at 10x coverage . in addition, the five callers had roughly similar precision rates  at low divergence, though at 5–10 % divergence platypus and gatk haplotypecaller had reduced precision rates in some cases . below we analyzed these ideal callers individually to infer the best mapper.

performance of different mapper-caller combinations
the performance of a caller often varies over alignments generated by different mappers. thus, we attempted to identify the best mapper for each of the ideal callers identified above, i.e., gatk unifiedgenotyper, gatk haplotypecaller and samtools in snp calling and gatk haplotypecaller and platypus in indel calling.

at  <dig> –1 % divergence, bwa worked the best in most of the snp and indel calling. the other four mappers also performed well in some cases, particularly at high coverage . for example, in snp calling at 40x or higher coverage, gsnap and novoalign performed similarly as bwa for gatk haplotypecaller; stampy had roughly the same sensitivity as bwa for gatk unifiedgenotyper and samtools. in addition, the five mappers had similar precision rates, except that stampy alignment was about  <dig> – <dig>  % lower in snp calling.

for snp calling at 5–10 % divergence, overall the three callers performed best with gsnap and with novoalign and stampy as well in some cases . the precision rate varied slightly, with gsnap being  <dig> – <dig>  % lower than that of novoalign . for indel calling at 5–10 % divergence, gatk haplotypecaller also achieved similar sensitivities with three of the mappers but had lower sensitivity with nextgenmap . in addition, gatk haplotypecaller had roughly the same precision rate over the four mappers; however, its precision rate at 10 % divergence was ~5 % lower than that at 5 % divergence. in contrast, platypus had the highest sensitivity with nextgenmap . for platypus, gsnap alignment had the highest precision rate; however, stampy alignment was over 6 % lower than the other mappers at 10 % divergence. we ranked the performance of individual combinations based on snp and indel calling sensitivity .

simulated and real exome-seq data are different in several key aspects. the former has a relative uniform distribution of coverage and divergence. however, in the real exome-seq data both features vary widely over different regions, and the types and distribution of variants are much more complicated. considering the limitations in simulation, below we assessed the same combinations using na <dig> exome-seq data.

evaluating snp calling in na <dig> exome data
the mapping results suggested that replicates  <dig> and  <dig> had approximately 62- and 70-fold coverage of the capture regions, respectively, with 85–88 % of the bases having at least 20x coverage. in the assessment, both known  and novel variants were compared to the public call set, where methods that showed higher levels of overlap with known variants in the public call set can be reasonably assumed to have higher sensitivities  <cit> . the assessment was done mainly on replicate  <dig>  and that on replicate  <dig> or both replicates was explicitly pointed out. we aimed to sort out the methods that were effective in both highly divergent and typical genomic regions. toward this, chromosome  <dig> was split into two entities: the 4-mb hla region  with the most extreme divergence and the non-hla regions representing typical genomic regions.

in the non-hla regions,  <dig> – <dig>  % of the snps called from stampy alignments and  <dig> – <dig>  % from other alignments matched known snps. the vast majority of the known snps overlapped the public call set . apparently, these methods only varied slightly in the number of known calls , generally in agreement with the assessment made on the simulation data . on the other hand, the public call set had only 13– <dig> novel snps. however, snp calling from stampy alignment had 57– <dig> novel snps, suggesting a reduction of specificity for stampy. among the callers, platypus was enriched in novel snps by about 2-fold. analogous to these observations, we indeed found that stampy mapping and platypus calling tend to generate more false positives in simulation data. first, of the five mappers, only stampy alignment gave rise to false positive calls in the control datasets that have no mismatches with the reference . second, overall platypus had a slightly lower precision rate in snp calling, particularly when combined with stampy .table  <dig> percent of snp and indel calling sensitivity in na12878


hla  <dig> ,000– <dig> ,000 bp on chr6; non-hla other capture regions on chr6; gatk hc gatk haplotypecaller; gatk ug gatk unifiedgenotyper



compared to the non-hla regions, there was much larger between-method variability in the hla region . sixteen methods had relatively lower snp calling sensitivity , involving bwa or nextgenmap as the mapper or freebayes or platypus as the caller. of the other nine methods, gsnap + gatk unifiedgenotyper was about 2–5 % higher in sensitivity than the others . in fact, gsnap + gatk unifiedgenotyper covered up to  <dig> – <dig>  % of the known snps identified by each of the other methods.fig.  <dig> known snps in hla-drb <dig> and hla-dqb <dig> from na <dig>  the hla-drb <dig>  and hla-dqb <dig>  structures are shown at the top, with filled boxes representing the exons  and arrow indicating transcription direction. the exome-seq reads from na <dig> were mapped by bwa and gsnap, respectively, and snps were called by gatk unifiedgenotyper . known snps matching dbsnp v <dig> are showed as ‘circles’ and clustered into three groups. number in parentheses indicates the number of known snps in each group. the two coverage plots depict bwa and gsnap mapping coverage at base-pair resolution



in hla-drb <dig>  the most polymorphic gene out of the five  in na <dig>  the snp calling sensitivity was strikingly variable, ranging from  <dig>  % to  <dig>  %  . for example, gsnap and bwa together with gatk unifiedgenotyper identified  <dig> known snps in hla-drb1; nevertheless,  <dig> of them were unique to gsnap but only  <dig> unique to bwa . notably, the performance of the five callers on hla-drb <dig> is highly comparable with that on the simulated data . a similar pattern was also observed in another highly polymorphic gene, hla-dqb <dig> . in both genes, exon  <dig> is excessively divergent, containing >40 % of the known snps identified in the capture regions . however, bwa missed  <dig>  and  <dig>  known snps in this exon from hla-dqb <dig> and hla-drb <dig>  respectively, arguing for the deployment of more sensitive methods.

method-specific snp calls in na12878
we next examined the known snps that were identified by gsnap + gatk unifiedgenotyper but missed in the public call set , and those that were only present in the public call set . gsnap + gatk unifiedgenotyper identified  <dig> unique snps from the two replicates , with  <dig> shared between both replicates . by blast search of representative reads spanning the  <dig> snps in hla-drb <dig> against the national center for biotechnology information nucleotide collection  database, we found that  <dig> of them showed 100 % and another  <dig> showed 99 % identity with existing hla-drb <dig> sequences.table  <dig> gsnap + gatk unifiedgenotyper specific snp calls

shown is the number of snps in the hla region of na <dig> that were called by gsnap + gatk unifiedgenotyper but missed in the public call set. the gsnap + gatk unifiedgenotyper specific snps included those only identified from replicate  <dig> , from replicate  <dig> , and from both . the number of snps identified by gatk unifiedgenotyper together with the other four mappers was also shown here. the last column is the total number of snps, and those in snp cluster and segmental duplications were shown in parentheses. known snp matching dbsnp v138; novel snp not matching dbsnp v <dig>  rep replicate; hla chr6: <dig> ,000– <dig> , <dig> bp

shown is the number of snps in the hla region of na <dig> that were present in the public call set but missed by gsnap + gatk unifiedgenotyper. cortex, discovar and gatk haplotypecaller  calls were from 250-bp paired sequencing of a pcr-free genomic library  <cit> . the high-confident call set  was from  <cit> . see table  <dig> footnote for additional information



the snps unique to gsnap + gatk unifiedgenotyper were enriched in snp cluster. about three-fourths  were in snp cluster, compared to only  <dig> % of the total snps in the non-hla regions and 38 % in the hla region. misalignments around indels  can lead to high false positives  <cit> . however,  <dig>  %  of the unique snps was at least 50 bp away from known indels, ruling out misalignments as being a major source of these unique calls. also,  <dig>  %  was identified by at least another two mappers with gatk unifiedgenotyper. finally, we manually checked gsnap alignments in regions surrounding the  <dig> snps shared by both replicates. two of them were low-confident calls in both replicates  and another two were each supported by only two reads  in replicate 1; all the others were fully supported by the alignments. we reason that the vast majority of the known snps called by gsnap + gatk unifiedgenotyper but missed in the public call set represent true variants.

on the other hand, in gatk unifiedgenotyper calling, gsnap missed a total of  <dig> known snps present in the public call set , including  <dig> missed by all the five and  <dig> by four of the mappers . over half of the missed snps were in snp cluster. of the five hla genes, only hla-dqb <dig> showed an obvious loss of snp calls . we traced the  <dig> public call set specific snps back to the methods identifying them. while all of them were identified from the 250-bp genomic sequencing data  <cit> , only  <dig> were in the high-confident call set  <cit> .

we manually checked gsnap alignments for reads spanning the  <dig> snps that gatk unifiedgenotyper failed to call in both replicates. two of them appeared to be false negatives, with one overlapping a 3-bp indel in hla-dqb <dig>  twenty-eight miscalls were due to extremely low coverage  or insufficient supporting reads . another  <dig> snps were at sites with high coverage  in both replicates, but only 2–10 % of the reads supported the alternative calls. of the remaining  <dig> snps , five had 31–75x and  <dig> had 142–178x coverage; nevertheless, only 0– <dig> reads supported the snps, raising the possibility that they are platform-specific calls or simply false positives in the public call set. twelve of the  <dig> missed snps were in hla-dqb1;  <dig> of them had two or fewer supporting reads. we argue that a significant proportion of the known snps unique to the public call set is likely identifiable only through whole genomic sequencing, longer reads and/or by de novo assembly-based calling methods. collectively, these results strongly support the findings from the simulated data .

with gatk unifiedgenotyper, gsnap identified  <dig> novel snps that were not in the public call set  but missed  <dig> in the public call set . fifteen of the  <dig> snps were identified by at least three mappers, supporting the reliability of these calls. however, none of the  <dig> snps were detected by any of the mappers; they were all absent from the high-confident call set  <cit> . thus, these public specific novel snps more likely represent platform-specific calls.

evaluating indel calling in na <dig> exome data
as expected, it is more difficult to detect indels from the hla regions than from the non-hla region . gatk haplotypecaller and platypus  <cit>  implement local de novo assembly, a feature that should contribute to indel detection. indeed, the two callers had higher sensitivity in both hla and non-hla regions . in the non-hla regions, freebayes and gatk unifiedgenotyper had similar sensitivities, with samtools being least sensitive ; in the hla region, these three callers had comparable sensitivity. the results largely agree with the findings from simulated data summarized in table  <dig> 

as for the novel indels, we focused on those that were identified by four of the mappers  in combination with platypus and gatk haplotypecaller. overall, the number of public call set-  and method-specific indels  was not markedly different in the non-hla regions. in the hla region, however, there were two to ten times more novel indels unique to the public call set than unique to each of the methods . gatk haplotypecaller identified much more novel indels than platypus in the hla region. about 80 % of the gatk haplotypecaller novel calls were supported by at least two mappers and also overlapped the public call set, supporting their authenticity.

variant calling at different mapping parameter settings in na12878
divergence level between reads and the reference genome is a critical factor in variant discovery. of the five mappers, gsnap, nextgenmap and stampy provide the parameter to specify the level of divergence . to understand how this parameter impacts variant calling efficiency, we tested three different divergence levels,  <dig>   <dig> and 10 %  for these three mappers. in the non-hla regions, snp calling from nextgenmap alignments at the divergence settings of 5 % and 10 % was 11–14 % higher in sensitivity compared to that from nextgenmap using 1 % divergence ; in the hla region, the differences in sensitivity were increased by about 3-fold . for gsnap, the snp calling sensitivity was highly comparable across the three settings in the non-hla regions; while in the hla region, gsnap alignments at the setting of 10 % divergence showed the highest sensitivity . finally, for stampy, nearly no difference was observed in both hla and non-hla regions . therefore, for gsnap, which overall performs the best in terms of snp calling sensitivity and specificity, the 10 % divergence we used throughout the analysis represents the ideal setting. the same trend was observed in indel detection from non-hla and hla regions , where the highest sensitivity was achieved with the parameter of 10 % divergence for both gsnap and nextgenmap.fig.  <dig> variant calling sensitivity in na <dig> at three divergence settings. a snp calling in non-hla regions. b snp calling in hla region. c indel calling in non-hla regions. d indel calling in hla region. the three divergence levels in mapper parameter settings are  <dig>   <dig> and 10 %. reads were aligned to the hg <dig> reference sequence by the three mappers at each of the divergence settings. gatk hc gatk haplotypecaller; gatk ug gatk unifiedgenotyper



variant discovery from cll exome-seq data
finally, in order to ascertain the broad application of the selected variant calling methods , we generated 100-bp wes data from a cohort of  <dig> cll patient samples. reads mapping  and variant calling followed the procedure used in na <dig>  the average per-base coverage varied between 67x and 113x, with  <dig> – <dig>  % of the bases having at least 20x coverage. as demonstrated in both simulated  and na <dig> wes data , gatk unifiedgenotyper and platypus are effective for snp and indel calling, respectively, while gatk haplotypecaller are ideal for both. focusing on known variants, we asked whether these three callers also outperformed the others on the cll wes data, particularly in the hla region that contains cll susceptibility loci  <cit> .

indeed, in the non-hla regions, the number of known snps per sample differed by 35– <dig>  among the  <dig> methods . overall gatk unifiedgenotyper with stampy, gsnap and bwa identified slightly more known snps. in contrast, there were much larger differences  in the hla region, with gsnap + gatk unifiedgenotyper detecting the most and bwa + platypus detecting the least or near the least number of known snps . of the five highly polymorphic hla genes, gsnap + gatk unifiedgenotyper performed the best in hla-a, −b, −c and -drb <dig>  and equally well with stampy + gatk unifiedgenotyper in hla-dqb <dig> . gatk unifiedgenotyper, which had a high specificity , showed the highest sensitivity, followed by gatk haplotypecaller and platypus, consistent with the inference made from both simulated  and na <dig> data .

for indel calling in the non-hla regions, platypus was more sensitive than gatk haplotypecaller and gatk unifiedgenotyper . four of the mappers made nearly no difference, with the exception of stampy that identified about 10 % less indels in gatk unifiedgenotyper calling. reversely in the hla region, with bwa excluded, gatk haplotypecaller identified more known indels than the other two callers . together with gatk haplotypecaller, gsnap identified the most known indels in the hla region from  <dig> of the  <dig> samples, followed by novoalign and stampy. gatk haplotypecaller was also more sensitive to novel indels , as revealed in na <dig> .

in summary, for snp calling, gatk unifiedgenotyper is generally more powerful than gatk haplotypecaller in the hla region, especially with gsnap; in the non-hla regions, these two callers are roughly comparable and both are better than platypus. for indel calling, gatk haplotypecaller and platypus are the two best callers. in the non-hla region, platypus is superior to gatk haplotypecaller; while in the hla region, gatk haplotypecaller is often better than platypus. gsnap and novoalign are ideal mappers for both snp and indel calling. one limitation with gsnap  is that it is over four times slower than bwa . a possible solution would be to first map reads using bwa, extract pairs with unmapped read, and then re-map those using gsnap. we tested its feasibility on the na <dig> wes data. remarkably, in gatk unifiedgenotyper and haplotypecaller calling, this two-step mapping approach recovered > <dig>  % of the known snps previously identified from chromosome  <dig> using gsnap alone. on the other hand, stampy is oversensitive, which results in more false positive calls.

we next focused on one of the five cll samples  with an average per-base coverage exceeding 100x , using four mappers  and three callers . for known snps, the  <dig> methods showed 95–99 % overlap between each other in the non-hla regions , versus 62–98 % in the hla region . as observed in na <dig> , gatk unifiedgenotyper performed better than gatk haplotypecaller and platypus in the hla region, with gsnap + gatk unifiedgenotyper being most sensitive . it covered over 90 % of the known snps identified by five of the methods together in hla and hla-drb <dig> .fig.  <dig> overlap of known variants in the hla region of the cll sample  <dig>  a overlap of known snps. b overlap of known indels. the  <dig> call sets were generated by three callers together with four mappers. number of known variants is shown in parentheses. each non-triangle box is pseudo-colored to signify the proportion of the call set on the left that is overlapped by the call set showed on the top. hc gatk haplotypecaller; py platypus; ug gatk unifiedgenotyper



for indel discovery, platypus performed the best in the non-hla regions  and gatk haplotypecaller in the hla region , as previously revealed across the cll cohort . gatk haplotypecaller together with novoalign or gsnap was ideal for indel detection in the hla region, platypus and gatk haplotypecaller together allowed more complete indel discovery in both non-hla and hla regions .

discussion
accurate variant discovery is crucial for pinpointing the causal mutations underlying human diseases. current computational methods are generally effective in detecting ordinary variants but less so for variants located in difficult regions  <cit> . one of those regions is the hla region, which is clinically important but extremely divergent. focusing on chromosome  <dig> we comprehensively assessed five popular mappers together with five callers on both simulated and real wes data from na <dig>  we have developed an analytical workflow that allows more accurate variant discovery in the hla region and across the genome.

our analysis revealed marked difference among the five callers at high divergence. gatk unifiedgenotyper performed the best in single-sample snp calling, especially with gsnap, on simulated data at 5–10 % divergence. all but platypus had similarly high precision rates. gatk unifiedgenotyper was also about 1–6 % higher in sensitivity than the other callers in vast majority of the cases with low divergence. for indel calling in simulated high divergence data, gatk haplotypecaller and platypus were generally more sensitive, but at the cost of reduced specificity. we revealed a similar trend of performance for these methods in the hla and non-hla regions in na <dig>  in summary, gatk unifiedgenotyper, samtools and gatk haplotypecaller are ideal for snp calling while gatk haplotypecaller and platypus are more effective for indel calling.

the mapping accuracy is often calculated by considering only the alignment start position, which does not always reflect the true alignment status of individual bases. in addition, optimal pairwise alignments between individually mapped reads and the reference sequence may not guarantee high confidence in multiple alignments. therefore, different mappers and callers need to be assessed together in order to identify the best combination. the five mappers are known to vary in mapping highly divergent reads , which we also revealed in our simulated data. even with a similar mapping rate, two mappers can perform quite differently in the context of variant calling. for example, gsnap  <cit>  and nextgenmap  <cit>  are both designed to map highly divergent reads and we observed roughly comparable mapping accuracy at 5–10 % divergence. however, for the three sensitive callers in snp detection, nextgenmap is obviously less suitable than gsnap, evident by a loss of  <dig> – <dig>  % sensitivity in the hla region of na <dig>  to further support this, we found that, of the five gsnap-mapped read pairs that contained six known snps in a 50-bp region within hla-drb <dig> , nextgenmap mapped only one of the ends correctly  but the other end to regions of 36–63 kb away. on the other hand, there is also obvious difference across different callers given the same mapper. using gsnap as the mapper, gatk unifiedgenotyper was  <dig> – <dig>  % more sensitive than gatk haplotypecaller and samtools and 12–14 % more sensitive than the other two in snp calling from the hla region. we analyzed two additional na <dig> wes datasets generated using illumina nextera rapid capture exomes capture kit  and roche life science seqcap ez human exome library v <dig>  . gsnap + gatk unifiedgenotyper also showed the highest sensitivity in snp calling in the hla region . our analysis has identified gsnap + gatk unifiedgenotyper as the most sensitive method for snp detection in both hla and non-hla regions.

strikingly, gsnap + gatk unifiedgenotyper achieved 100 % sensitivity in hla-drb <dig>  hla-a and hla-c, three highly polymorphic genes in na <dig>  in hla-drb <dig>  for example, this method identified all the  <dig> known snps annotated in the public call set  <cit> , plus an additional  <dig> unique known calls. in contrast, the widely used bwa + gatk unifiedgenotyper missed >30 % of the known snps in this gene. comparable results were obtained for gatk haplotypecaller and platypus in indel calling.

besides the hla region, there are many other regions in the human genome that are also highly divergent  <cit> . for example, the  <dig> genomes project identified large regions on chromosomes  <dig>   <cit>  and  <dig> and subtelomeric regions on autosomal chromosomes that have high snp density  <cit> . we have identified a few ideal mapper-caller combinations that are sensitive to both highly divergent regions and regions with low mutation rates, such as gsnap + gatk unifiedgenotyper in snp calling and gsnap + gatk haplotypecaller and gsnap + platypus in indel calling. for indel calling, gsnap + gatk haplotypecaller is more sensitive to the hla region while gsnap+ platypus is more sensitive to the non-hla regions. a joint calling with both methods should be the appropriate approach for genome-wide indel detection.

traditionally, genotyping in the hla region often relies on microarray hybridization  <cit>  or sequencing pcr amplicons that targeted selected exons  <cit>  or entire genes  <cit> , which are costly, time-consuming and low throughput. in addition, current studies often focus on known variants in the international immunogenetics project /hla database without considering novel variants  <cit> . lastly, though wes was used for hla genotyping and variant discovery, the standard mapping-based approaches did not work well  <cit> . our approach represents a more generalized methodology, which is effective for genome-wide variant detection but particularly sensitive in highly divergent regions like hla. though only tested on wes, it should be applicable to whole genome sequencing data as well.

CONCLUSIONS
we aimed to develop a strategy enabling more accurate variant discovery in highly divergent regions. focusing on the hla region that shows extreme divergence across different haplotypes, we revealed marked differences among the methods in snp and indel calling from na <dig> wes data. we captured a similar trend on wes data from a cohort of cll patients. specifically, gsnap and novoalign achieve high sensitivity in mapping divergent reads without losing the specificity. their limitation in speed could be overcome through a two-step mapping approach, in which reads are first mapped by bwa and unmapped ones are then re-mapped by gsnap or novoalign. together with these two mappers, gatk unifiedgenotyper demonstrates its excellence in snp calling, followed by gatk haplotypecaller and samtools; in indel calling, gatk haplotypecaller and platypus outperform the others and their joint calling clearly enhances the outcome. given that highly polymorphic regions are distributed over many chromosomes and are often associated with human disease, our study brings additional options into the current variant calling practice.

additional files
additional file 1: figure s <dig>  accumulative mapping rate of four aligners. figure s <dig>  snp calling sensitivity at  <dig> –1 % divergence. figure s <dig>  indel calling sensitivity at  <dig> –1 % divergence. figure s <dig>  number of known variants in hla and non-hla regions of chr <dig> in na <dig>  figure s <dig>  number of known snps in the hla and non-hla regions of chr <dig> in cll. figure s <dig>  number of known snps in five hla genes. figure s <dig>  heat maps illustrating the overlap of known snps. figure s <dig>  venn diagrams depicting the overlap of known snps. figure s <dig>  overlap of known indels in the non-hla regions of chr <dig>  figure s <dig>  venn diagrams depicting the overlap of known indels. 

additional file 2: table s <dig>  five mappers and five variant callers used in the study. table s <dig>  snp and indel calling precision rate in simulated data. table s <dig>  percent of snp calling sensitivity for three callers in simulated data. table s <dig>  indel calling sensitivity for two callers in simulated data. table s <dig>  known indels in the hla region of na <dig>  table s <dig>  novel indels in the hla region of na <dig>  table s <dig>  number of novel snps in  <dig> cll samples. table s <dig>  number of indels in  <dig> cll samples. 



abbreviations
bpbase pair

bwaburrows-wheeler aligner

chr6chromosome 6

cllchronic lymphocytic leukemia

gatkgenome analysis toolkit

hlahuman leukocyte antigen

indelinsertion and deletion

pcrpolymerase chain reaction

snpsingle nucleotide polymorphism

weswhole exome sequencing

