BACKGROUND
transcription factors  are a family of proteins that regulate gene expression via binding to specific dna sequences  <cit> , accounting for 10% of genes in human genome  <cit> . they play instrumental roles in the regulation of many biological processes, such as development, cell proliferation, cell cycle progression, and apoptosis  <cit> . aberrant expression or activation/inactivation of tfs has been implicated in human diseases  <cit> , particularly, in a variety of different cancer types  <cit> . as a matter of fact, a large number of oncogenes and tumor suppressor genes actually encode tfs. for instance, the most well studied tumor suppressor gene, p <dig>  has been found to be mutated in over 50% of human cancers  <cit> , mostly resulting in impaired capability of transcriptional activation  <cit> .

microarray experiments have been intensively used to investigate the mechanism of cancer and have resulted in the accumulation of enormous amount of data that are available from the public database such as geo   <cit> . the microarray data enable us to identify differentially expressed genes  <cit> , discover cancer associated gene signatures, and classify tumors into different subtypes  <cit> , which have dramatically advanced our understanding about cancer. however, gene expression profiles of tumor samples can only capture the down-stream readout of the driving genetic alterations such as mutations, amplifications and deletions  <cit> . the changes of the regulatory program underlying a cancer type may not be directly detected from the microarray data. for example, although mutation of p <dig> gene is known to be a driving event for carcinogenesis in many cancer types  <cit> , in most cases there is no significant p <dig> expression difference between tumor and normal samples: mutation abolishes its transcriptional activity by impacting its dna binding capacity or protein stability without changing its mrna expression level  <cit> .

although the alteration of a tf cannot be detected directly from the expression changes of its corresponding mrna, we expect that alteration of the tf can be revealed by using the expression changes of its target genes. based on this idea, rhodes et al.  <cit>  proposed to identify conditional regulatory programs by defining gene expression signatures  and putative tf regulatory signatures  and examining their overlap. the tfs with enriched regulatory signatures in gene expression signature of cancer were reported to be cancer associated  <cit> . previously, we also proposed a kolmogorov–smirnov test like method to infer activity changes of tfs based on their binding association with sorted expression profiles  <cit> . all these methods defined tf-gene regulatory relationships by searching putative tf binding sites in promoters of genes, in which the accuracy was affected by both high false positive rate and high false negative rate.

the recent advancement of experimental technologies such as chromatin immunoprecipitation followed by massively parallel dna sequencing   <cit>  or microarray hybridization   <cit>  enables us to more accurately determine genome wide occupation of tfs. given the chip-seq or chip-chip data, we can define a list of target genes for a tf based on the presence of binding peaks in their regulatory dna regions  <cit> . alternatively, we can also quantify the binding potential of a tf to all genes, resulting in a continuous representation of tf-gene regulatory relationships  <cit> . in the past few years, a large amount of chip-seq and chip-chip data for various tfs have been generated by several research consortiums, e.g. encode   <cit> , and by individual laboratories  <cit> .

in this study, we developed a novel method called reactin  to infer tfs that exhibit significantly differential activity in the disease samples versus the normal controls. the reactin algorithm integrates case–control gene expression data with tf binding profiles from chip-seq or chip-chip experiments. to compare the reactin algorithm with the other method, we examined the performance of the gsea method to infer tf activity using the same datasets  <cit> . we found that gsea does not always give rise to biological sensible results and the results were often sensitive to the definition of target gene sets of tfs. further investigation indicated that poor performance of gsea was mainly caused by the target gene sets of tfs, which were often difficult to be determined based on chip-seq or chip-chip data. this motivated us to propose the reactin algorithm, which applied a similar rank based framework as gsea but improved it by defining tf-gene regulatory relationship in a quantitative manner.

we evaluated the performance of reactin in  <dig> breast cancer gene expression datasets, all of them containing both er+ and er- samples. the method successfully identified er alpha as the tf that showed significantly higher regulatory activities in er+ than in er- breast cancer samples. in addition, it also detected the activity difference of two other breast cancer associated tfs, foxa <dig> and gata <dig>  in er+ versus er- samples. using breast cancer as an example, we also demonstrated that the reactin algorithm can be used to investigate regulatory mechanisms governing different breast cancer subtypes by comparison with normal tissues, in addition to identifying tf activity associated with patient survival in their activities. considering the huge accumulation of microarray data that have been accumulated and the increasingly availability of tf binding data, we expect that reactin can be widely used to study the regulatory mechanisms of many human diseases.

RESULTS
overview of reactin algorithm for tf activity inference
to investigate the regulatory mechanism underlying a specific cancer type, we developed a method called reactin  to infer tfs that show significantly differential activity in the tumor samples versus the normal controls. given the case–control gene expression data , we would expect to see the differential expression of target genes of a tf with altered activity in tumor samples. similar to the gsea  method  <cit> , reactin ranks all genes based on the expression changes in case versus control samples, and then examines their potential being bound by a tf by referring to its chip-seq data. here the rationale is that it is often difficult and less effective to define a target gene set for a tf due to the quantitative nature of tf-gene interactions  <cit> . thus, we used a probabilistic model to predict the target genes of a tf: for each gene we assign a score to measure its probability of being regulated by the tf. briefly, reactin takes a three-step procedure to identify significant genes .

step  <dig> the probabilistic measure of tf-gene interactions based on chip-seq data. based on chip-seq data, we calculated the binding affinity of a tf with all human genes using a probabilistic model called tip   <cit> . for a tf, tip builds a characteristic, average profile of binding around the tss  of all genes and then uses this profile to weight the sites associated with a given gene, providing a continuous-valued score of this tf for each gene. the score provides a metric that quantifies the binding affinity of a tf with a gene. we have collected  <dig> human chip-seq samples from the encode project  <cit> , based on which we constructed a tf target database that probabilistically measures tf-gene interactions.

step  <dig> calculation of regulatory activity scores  for all tfs . we calculate the t-scores for all genes by comparing their expression levels in case samples and control samples, and sort them to obtain a ranked list. the ras is calculated by walking down the list and a running-sum statistic is used to capture the correlation between gene expression change  and tf binding potential . if genes with higher ranks in the list tend to have higher binding probabilities by a tf, then the tf will achieve a greater ras score. as a metric, the ras can be regarded as an extended version of the es in gsea analysis.

step  <dig> significance estimation and multiple-testing correction. we estimate the statistical significance of the ras by using an empirical phenotype-based permutation test procedure that preserves the complex correlation structure of the gene expression data. specifically, we permute the case/control class labels and recompute the ras of the gene set in the permuted data, which generates a null distribution for the ras. the empirical, nominal p value of the observed ras is then calculated relative to this null distribution. we calculated the false discovery rate by comparing the distribution of the ras with the null distribution from permutation test.

evaluation of reactin by comparing er+ with er- breast cancer
to test the effectiveness of the reactin algorithm, we applied it to identify tfs with significantly different regulatory activities between er+ and er- breast cancer samples. specifically, we collected  <dig> breast cancer microarray datasets, each containing both er+ and er- samples   <cit> . er is a transcription factor that is active in er+ but not in er- breast cancer, and its binding profile  is included in our chip-seq data collection. if reactin is effective, we will identify er as one of the tfs that shows significantly higher activity in er+ than in er- samples.

strikingly, reactin successfully detected the activity difference of er alpha between er+ and er- breast cancer samples in all of the  <dig> datasets . there are  <dig> er alpha binding profiles in our chip-seq collection, representing binding affinities with human genes in two cell lines  under three different conditions: two steroid hormone treatments  and a control treatment . in all datasets, the er alpha binding profiles haib_t47d_eralphaa_gen1h and haib_t47d_eralphaa_estradia1h were identified to have significantly higher activity in er+ than er- at the  <dig>  false discovery rate  . for example, table  <dig> shows the top  <dig> most differential tfs between er+ and er- in veer and wang datasets. as shown, the ras of haib_t47d_eralphaa_gen1h is  <dig>  in the veer dataset and  <dig>  in the wang dataset, with a fdr of  <dig>  and  <dig> , respectively. more importantly, there is a clear separation between the significant tf binding profiles and the non-significant ones , suggesting a high specificity of the reactin algorithm. as shown in the veer dataset, there are  <dig> significant tf binding profiles, all of them with a fdr< <dig> ; but the fifth most differential  profile haib_t47d_p300_dmso <dig> is with a fdr= <dig> .

the “location” column shows the percentile of genes at which the maximum deviation is observed. tf binding profiles with a fdr< <dig>  are highlighted in bold.

in figure  <dig>  we use haib_t47d_eralphaa_gen1h in the hess dataset as the example to show how the reactin algorithm identifies its activity difference. as shown in figure 3a, when genes are sorted in the decreasing order of their t-scores , genes with higher binding possibilities ) as calculated by tip  <cit>  are more likely to have higher t-scores . this indicates that target genes of er alpha are more likely to have higher expression levels in er+ than in er- samples, implying the regulatory activity difference of er alpha. in fact, the t-score of genes is significantly correlated with tf binding scores calculated by tip with a correlation rho= <dig>  . reactin captures such a relationship by comparing a foreground function with a background function as shown in figure 3c. the maximum deviation of the two functions reflects the activity difference of er alpha between er+ and er- samples .

target genes determined by peak-based method  also tend to have higher t-scores. however, gsea analysis failed to identify er alpha targets  as a gene set enriched in differentially expressed genes between er+ and er- samples in the hess dataset . there are two main causes resulting this phenomenon:  many of the target genes identified by peak-based method may not be er alpha targets according to tip calculated probabilities ;  gene set based inference cannot effectively capture the information provided by tf binding data from chip-seq experiments.

it is interesting to observe the influence of chip-seq cell lines and conditions to the results. the reactin algorithm detected more significantly differential activity of er alpha between er+ and er- for binding profiles in t47d than in ecc <dig> .

although both t47d and ecc <dig> cell lines maintain estrogen receptors and are steroid-responsive, t47d is derived from breast epithelial tumor cells and ecc <dig> is derived from endometrial carcinoma cells. as such, t47d can accurately characterize the er alpha binding affinities to genes in breast cancer samples. this explains why we observed higher regulatory scores for er alpha binding profiles from t47d than from ecc <dig> in all of the microarray datasets . additionally, we observed an obvious condition effect: er alpha activity difference can only be detected when cell lines are treated with steroid hormones during chip-seq experiments, because target gene binding of er alpha can be accurately characterized after treated with hormone than the dmso <dig> control .

in addition to er alpha, we also identified foxa <dig> and gata <dig> as the tfs with significantly higher activities in er+ than in er- breast cancer samples . the association of er alpha and foxa <dig> with breast cancer have been well defined  <cit> . up to now er alpha is deemed to be one of the most important molecular factors in the prognosis and therapy of breast cancer  <cit> . in er+ breast cancers er alpha inhibits apoptosis of tumor cells  <cit> . foxa <dig> is a necessary pioneer factor to mediate er alpha association with compacted dna in breast cancer cells  <cit> . when foxa <dig> is absent, er alpha cannot interact with dna and the expression of er alpha-mediated genes are prevented  <cit> . gata <dig>  has been shown in a recent study to be one of the three genes that are mutated in >10% of breast cancers  <cit> . a recent study  <cit>  has shown that gata <dig> associates directly with er alpha and progesterone receptor. we compared the mrna expression levels of esr <dig> , foxa <dig> and gata <dig> between er+ and er- samples in the microarray data, and found that all of them are more highly expressed in er+ samples. for instance, in the wang dataset, esr <dig>  foxa <dig> and gata <dig> showed significantly higher expression levels in er+ and er- samples with p=3e- <dig>  p=4e- <dig> and p=8e- <dig>  respectively . these results indicate that the activity difference of these three tfs between er+ and er- samples is at least partially caused by the their differential expression at the mrna level. but we cannot rule out the possibility that in certain samples regulatory activity is a result of point mutation instead of expression change.

transcriptional regulatory programs underlying different breast cancer subtypes
we next applied the reactin algorithm to investigate the regulatory mechanisms underlying different breast cancer subtypes. we applied it to the microarray data published by ma et al., which contained expression profiles of  <dig> samples isolated from ductal carcinoma in situ  or invasive ductal carcinoma  biopsies. the samples can be divided into  <dig> categories:  <dig> normal epithelium samples ,  <dig> dcis-associated malignant epithelium samples ,  <dig> idc-associated invasive epithelium samples ,  <dig> normal stroma samples away from the malignant lesion ,  <dig> dcis-associated malignant stroma samples  and  <dig> idc-associated invasive stroma samples .

first, we pooled the samples to obtain  <dig> normal breast samples  and  <dig> tumor samples . we identified tf binding profiles showing significantly differential activities in tumor versus normal breast samples using the reactin algorithm. our results indicate that stat <dig> and stat <dig> are significantly more active  in tumor cells than normal cells . members of the stat family play an important role in regulating breast cancer development  <cit> . the lack of stat <dig> results in aberrant response to ifn signaling and makes the tissue more susceptible to tumor development  <cit> . stat <dig> may function as a tumor suppressor via interaction with p <dig> or brac <dig>  <cit> , or by up-regulating p27kip <dig> expression  <cit> . in addition, stat1-deficient mice can spontaneously develop estrogen receptor α-positive luminal mammary carcinomas  <cit> . at the mrna level, we found that expression of stat <dig> was significantly reduced in tumor cells compared to normal breast tissues . together with the observed activity enhancement of stat <dig>  we posit that stat <dig> might act mainly as a repressor in gene transcriptional regulation.

next, we compared tumor stroma samples  with normal stroma samples . at the significance level fdr< <dig> , we identified baf <dig>  ini <dig>  gr, znf <dig> and fosl <dig>  we also compared tumor epithelium samples  with normal epithelium samples  using reactin. compared to stroma results, more tfs were identified for epithelium comparison . our results indicate stat <dig> and stat <dig> show differential activities between tumor and normal breast epithelium samples. e2f <dig> and e2f <dig> are also identified as tfs with higher activities in tumor epithelium samples, suggesting higher proliferative rate of malignant epithelium breast cells. e2f <dig> and e2f <dig> play the important regulatory role in cell cycle and many studies have demonstrated their importance during tumorigenesis  <cit> . in addition, er alpha shows higher activity in malignant epithelium cells than in normal epithelium cells. however, no er alpha activity difference is observed between malignant and normal stroma cells, suggesting that the roles played by er alpha during breast cancer carcinogenesis is cell type specific.

finally, we inferred the regulatory activity difference of tfs by comparing ise with ne, inve with ne, iss with ns, and invs with ns. this analysis gives rise to the regulatory programs underlying each of the breast cancer subtypes .

our analysis also suggests that the reactin algorithm is more sensitive in detecting the differential activity of tfs when applied to more specified cancer subtypes. for example, when the pooled tumor samples were compared against pooled normal samples, only two tfs  were identified. however, when inve samples were compared with ne samples,  <dig> tf binding profiles showed significant differential activity at the fdr< <dig>  significance level . this is due to the heterogeneous nature of tumor samples. each tumor sample may have its own specific regulatory program, and therefore pooling different tumor samples would reduce the ability of reactin to detect the differential regulatory programs . in contrast, tumor samples of the same subtype are more likely to share common regulatory programs and thus be more amenable to detection by the reactin algorithm.

identification of transcription factors associated with survival of patient with breast cancer
we then adapted the reactin algorithm to identify tfs associated with survival of patients with breast cancer. to achieve this, we modified the reactin algorithm to calculate a regulatory score of a tf for each samples in a microarray dataset , resulting in an activity profile for each tf binding profile in our chip-seq data collection. we calculated the activity scores of all tfs in all samples in the vijv dataset  <cit> .

first, we examined whether the inferred activity score of er alpha reflected its actual activity in a sample. we compared activity scores of er alpha in er+ versus er- breast cancer samples. as shown in figure  <dig>  the activity scores of er alpha are significantly higher in er+ than in er- samples with the exception of ecc1_erapha_dmso <dig>  this suggests that the inferred activity score of er alpha can correctly reflect the er status of a breast cancer sample. we compared the activity scores of all tf binding profiles in er+ versus er- samples using wilcox rank sum test . we find that out of the  <dig> tf binding profiles we collected,  <dig> have significantly higher activity scores in er+ samples and  <dig> have significantly higher activity scores in er- samples. consistent with the results of the reactin algorithm, the top three most significant tfs with higher activity scores in er+ than in er- are er alpha, foxa <dig> and gata <dig> 

we then fitted a cox proportional hazard model for each activity profile to identify tfs that were correlated with patient survival time. we identified a total of  <dig> tf binding profiles that were significantly associated with breast cancer patient survival. most of them were still significant even after considering the er status and node status using the multiple variable model . here we use the sydh_helas3_e2f <dig> binding profile as the example to show the relationship between patient survival and e2f <dig> activity. as shown in table  <dig>  e2f <dig> is significantly associated with patient survival with a hazard ratio of  <dig>   without considering er status. after considering the er status and node status, it is still significant with a hazard ratio of  <dig>  and a 95% ci of . in contrast, the expression levels of e2f <dig> cannot predict patient survival time .

the hazard ratio and 95% confidence interval  are calculated using cox proportional hazards model with single variable or multiple variables. in the multiple cox regression model, esr  and posnodes  are included as variables together with the inferred tf activity scores.

out of the  <dig> breast cancer samples of the vijv dataset,  <dig> have a positive e2f <dig> activity score and  <dig> have a negative e2f <dig> activity score. figure 5a shows two samples with an e2f <dig> regulatory score of - <dig>  and  <dig> , respectively. as shown, in the sample with a negative score genes with higher probability of being e2f <dig> regulated are more likely to have lower expression levels , whereas in the sample with a positive score the opposite is observed. distribution of e2f <dig> activity scores in the  <dig> samples is shown in figure 5b. patients with positive e2f <dig> activity scores  demonstrate significantly shorter survival time than patients with negative e2f <dig> activity scores  with a p-value of 4e- <dig> . we note that the er+ patients show significant longer survival time than er- patients with p-value of 4e- <dig>  in another words, the inferred activity score of e2f <dig> achieves better accuracy than er status when predicting survival time of patients. combining e2f <dig> activity score with er status, we divided samples into four categories as shown in figure 5d. in er+ samples, patients with positive e2f <dig> activity still have significantly shorter survival time than those with negative e2f <dig> activity . in er- samples, the same trend can also be observed, although the difference is not significant due to small sample size.

comparison with other methods
the reactin algorithm extends gsea analysis by adopting a probabilistic representation of gene sets. namely, instead of using a defined gene set, it regards all genes as members of a gene set with different probabilities. this extension is very suitable for the tf-gene regulatory relationships defined by chip-seq or chip-chip experiments. in fact, there exist both strong and weak binding of tfs with their targets. as such tf-gene interactions should be represented in a quantitative rather than in a binary manner. despite of this, we defined a target gene set for all tf binding profiles in our chip-seq collection for comparison purpose. for a tf, target genes are defined as those with at least one binding peak of the tf in its promoter regions . we then applied gsea analysis to identify tfs with target gene sets enriched in differential expression profiles between er+ and er- breast cancers. it is observed that gsea is less sensitive: it identified er alpha as the significant tfs in only  <dig> of the  <dig> datasets. it failed to identify er alpha in the desm, hess and ivsh datasets . it also failed to identify foxa <dig> and gata <dig> in all of the  <dig> datasets.

we also performed gsea analysis using tf target gene sets defined by tip method, which failed to identify er alpha in  <dig> of the  <dig> datasets . in addition, we examined the tf target gene sets defined by the chea database. gsea analysis using these gene sets identified er alpha in only one dataset . thus, we conclude that the reactin algorithm outperforms gsea analysis in identifying regulatory programs underlying cancer.

discussion
in this article, we have introduced a new algorithm named reactin that integrated gene expression data with tf binding data to identify tfs with significantly differential activity between two sample groups. reactin operates under a similar framework to that of gsea, which has been widely used to identify gene sets associated with an interested phenotype. theoretically, we can utilize gsea analysis to identify disease associated tfs, if we define a gene set for each tf. however, we instead adopt a quantitative method to measure tf-gene regulatory relationships in reactin for two reasons. first, as with many biological processes, tf-gene binding events should be regarded as a quantitative and continuous variable rather than a simple on/off switch model. for any given tf, there exists strong and weak binding sites in the genome, both contributing to transcriptional regulation of genes. thus, we believe a continuous representation of tf-gene binding can be more accurately reflect the overall nature of tf-gene regulatory relationships. second, it is often technically difficult to set up a cut-off for defining target genes of a tf based on its chip-seq data. for example, given the chip-seq data of a tf, we usually define target genes as those with one or more binding peaks in their promoter regions. the definition of promoter region is often arbitrary, e.g.  <dig> kb or  <dig> kb around the tss have been used in previous publications. for these two reasons, the gene set based method cannot fully utilize the tf binding information derived from chip-seq data and is ultimately less robust than reactin, as has been shown by our results .

the reactin algorithm calculates a regulatory score and assesses its significance for each tf by comparing and permuting the case and control samples. in this article, we also showed a modified version of this algorithm. in the modified version, we calculated a regulatory score of a tf for each individual sample, yielding an activity profile of the tf. given the profile, we can compare its inferred activities in case and control samples  to examine the activity difference of a tf . then, what is the relationship of the two methods for identifying tfs with significant differential activities between case and control? this is analogous to the problem of identifying differentially expressed genes from case–control microarray data. in general, two categories of methods have been widely used. one is to directly compare expression levels of genes between case and control using t-test or wilcox rank sum test. the other category, typified by sam   <cit> , adopts a permutation-based strategy to take into account correlation structure and correct for multiple testing. the reactin algorithm applies a similar strategy as sam, while the modified method is similar to the test based method for identifying differential expressed genes. practically, the results reactin is much more conservative than the modified method, resulting in only the most confident tfs. the modified version identifies more tfs that show differential activities between case and control . in addition, it is more flexible by providing tf activity information in each individual sample. for example, as we have shown, it can be used to identify tfs associated with patient survival .

in figure  <dig>  we show that the cell line and the conditions governing chip-seq experiments would result in different tf binding profiles and impact the reactin results. in fact, bindings of many tfs are tissue specific and condition dependent. for example, a tf may have different targets genes in tumor and normal tissues. ideally, we should use chip-seq data from tissue and conditions that match with the gene expression data. for example, as shown chip-seq in t47d  can more accurately capture tf-gene binding relations in breast cancer than chip-seq in ecc <dig> cell lines.

CONCLUSIONS
in this study, we proposed a method called reactin to identify tfs that exhibit significantly differential activity between the disease samples versus the normal controls. the method integrates the case-control gene expression data with the tf binding data from chip-seq experiments. we applied reactin to compare er+ with er- samples in ten breast cancer datasets and successful detected the activity difference of er alpha, foxa <dig> and gata <dig> between er+ and er- breast cancer subtypes. we also demonstrated the effectiveness of applying reactin to identify tfs that were predictive to survival times of patients with breast cancer. reactin provides a useful tool to investigate regulatory programs underlying a disease, and more generally underlying any biological processes, providing the related case and control gene expression data. as the available pool of chip-seq data increases, we expect a wide application of the reactin algorithm to the study of regulatory mechanisms governing different human diseases.

