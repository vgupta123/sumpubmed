BACKGROUND
microarray techniques provide a way of monitoring gene expressions on a large scale. biomedical experiments have been designed to discover important genes or gene pathways, that are linked with variations of phenotypes. those genes can then be used as biomarkers in clinical studies and to construct predictive models in downstream analysis. examples of such studies include disease classification studies in  <cit>  and survival analysis in  <cit> , among many others.

statistical analyses using gene expressions as covariates are very challenging due to high dimensionality of gene expression measurements and small sample sizes. consider for example the leukemia data  <cit> , which is used as an example of binary classification in  <cit> . the data contains expression measurements of  <dig> genes from  <dig> samples. we refer to  <cit>  for experimental setup. a typical analysis, as presented in  <cit> , consists of the following three steps.

 <dig>  data organization and unsupervised gene screening. in  <cit> , this step consists of thresholding the raw measurements, filtering genes with small variations across all samples and logarithm transformation.  <dig> genes pass the first stage screening. for other datasets, if severe missingness is present, simple data manipulation, such as filling in missing values, may also be needed.

 <dig>  supervised gene screening. genes passed unsupervised screening are then ranked based on the ratio of their between-groups and within-groups sum of squares . the  <dig> top ranked genes are selected for downstream statistical analysis. we note that the binary outcome is used in computing the b/w ratio.

 <dig>  predictive model building using the  <dig> selected genes. various statistical methods, including classification tree, fisher linear discriminant analysis and nearest neighbor approach, are used.

similar three-step approaches have been extensively used. see for example, classification studies in  <cit>  and survival analysis in  <cit> , among many others.

we now investigate this three-step procedure in more details. steps  <dig> and  <dig> carry our gene screening, which is especially necessary under current "large p, small n" setting. the goal of the screening is three-fold: improving prediction performance by removing noninformative genes; providing faster and more cost-effective predictors; and providing a better understanding of the underlying causal relationships.

step  <dig> is mainly due to technical concerns. for example, most statistical building methods in step  <dig> cannot handle missing data automatically, so we need to either remove genes with missing values or fill in with sample statistics. under certain experimental setup, gene expression measurements above or below certain thresholds are not meaningful, so simple thresholding/flooring may be needed. genes with little variations across samples are not likely to possess any biological functions of interest, so removing such genes may increase the signal to noise ratio. we note that in step  <dig> gene screening and data manipulation, information on the clinical outcome is not used. we hence refer it as the unsupervised gene screening.

in this article, step  <dig> screening is referred as the supervised gene screening. it differs from the unsupervised screening in the sense that the clinical outcome is used in gene screening. a typical supervised screening consists of the following steps:

 compute a marginal statistic for each individual gene. this statistic, for example the t-statistic in binary classification studies, is constructed using both the expression measurements and the clinical outcome.

 rank genes based on their marginal statistics. for this purpose, although distribution of the marginal statistic does not need to be known, we do need to know the qualitative relationship between magnitude of this statistic and importance of corresponding gene, for example whether larger marginal statistics indicate more influential genes.

 select the top ranked genes. we postpone discussion of how many genes need to be selected to the discussions section.

in  <cit> , the screening statistic is chosen to be the between-groups and within-groups sum of squares ratio, and the binary outcome is used to define the grouping. although the distribution and other statistical properties of the b/w ratio do not need to be known, it is reasonable to say that genes with larger b/w can better predict the outcome and hence should be selected. only the  <dig> top ranked genes are used in the statistical model building.

after gene screening in steps  <dig> and  <dig>  predictive models can be constructed in step  <dig>  since the number of genes passed screening may still be much larger than the sample size, feature selection through regularization is usually needed along with estimation. regularization methods used include partial least squares  <cit> , lasso  <cit> , lasso-lars  <cit>  and threshold gradient descent regularization   <cit> , among many others. with the aforementioned regularized estimation approaches, only a small number of representative genes are included in the final models. the biological implications of those representative genes are of great scientific interest, and usually warrant more detailed investigation.

we note that not all three steps are needed in practical data analyses. part of the screening can be omitted. for example, in the boosting study  <cit> , all genes are used in the model building. in the above three-step procedure, step  <dig> is mainly due to technical concerns and is of less statistical interest. step  <dig> has been intensively studied. see the aforementioned publications and references therein. however in previous studies, the supervised gene screening is usually taken for granted and has not been well investigated.

we first present a small numerical study to show the validity of the supervised screening. we consider the colon and leukemia data presented in the results section as examples. if a gene screening method is valid, it should have certain reproducibility property. especially, genes passed the screening in one subgroup should be similar to those screened in another independent subgroup. since independent validation sets are usually not available, we consider the following bootstrap based approach.

 <dig>  randomly select  <dig> n subjects, where n is the sample size.

 <dig>  select 20% genes using the chosen screening method.

 <dig>  repeat 1– <dig>  <dig> times.

 <dig>  for each gene, compute the percentage of times it is included in the top 20% ranked gene lists.

the percentage computed here is closely related to the bootstrap reproducibility index proposed below. we choose statistics  <dig>   <dig> and  <dig>  as examples and show the percentage plot in figure  <dig>  note that in figure  <dig> we sort the genes based on decreasing percentages. we can see from figure  <dig> that the percentages are far from being flat: there are some genes with very high percentages of being selected, which indicates that the supervised screening is reasonably reproducible. studies with other screening statistics and other datasets show similar results and are omitted here.

a motivating example
this article is partly motivated by the following example. consider the leukemia data described in  <cit> . the data contains expression measurements of  <dig> genes for  <dig> samples, among which  <dig> are all and  <dig> are aml. the clinical outcome of interest can be coded as a binary variable with the response equal to  <dig> if it is aml and  <dig> otherwise. we employ the same unsupervised screening as in  <cit>  and  <dig> genes pass the unsupervised screening.

for the supervised gene screening, we consider using the eight different ranking statistics listed in the methods section to select the top  <dig>  genes. in the statistical model building, we assume the commonly used logistic regression models, where the covariates are the  <dig> genes passed the unsupervised and supervised gene screenings and the outcome is the acute leukemia type. since the sample size is much smaller than the number of covariates, we use the tgdr, which is capable of simultaneous estimation and gene selection, for regularized estimation. estimation and gene selection using the tgdr has been studied in  <cit> . the small number genes included in the final models are identified as important genes, and are concluded to be associated with the variations of phenotypes.

eight possibly different sets of  <dig> genes passed the gene screenings are used to construct eight predictive models. since the same unsupervised screening, the same logistic model and the same regularization method are used, differences  in the eight final predictive models must be caused by the differences in the supervised screening. we show in table  <dig> the number of genes included in the eight models constructed by logistic + tgdr, and their corresponding overlaps. for example, by using the difference of mean as the supervised screening statistic and fitting the logistic + tgdr model,  <dig> out of  <dig> genes are included in the final model; while  <dig> genes are included if the simple t-statistic is used as the supervised screening statistic. only  <dig> genes are included in both models.

we can see from table  <dig> that there exist considerable overlaps among genes included in the eight final models, showing moderate concordance of gene discovery results. however with different supervised screenings, the genes in the final logistic models may differ by more than 30%. a total of  <dig> genes are included in at least one of the eight final models, where as only  <dig> are included in all eight. more detailed gene discovery results are available upon request. we can conclude that for the leukemia example, differences of the predictive models caused by differences in supervised gene screenings are significant and cannot be ignored. similar results are observed for the colon data and the estrogen data.

microarray studies like the leukemia example have two main purposes. the first is to construct predictive models based on microarray measurements to guide future treatment selection. the second is to discover a small subset of genes that are accountable for variations of phenotypes. identifying such influential genes may lead to better understanding of human genomics and new directions of gene therapy. from a scientific point of view, the second goal is at least as important as the first one. the leukemia example shows that the effect of supervised gene screening, which has considerable effect on gene discovery results, warrants detailed investigation. concordance problem in gene discovery by using different regularization methods has been studied. for example, several different gene discovery results have been reported for the diffuse large-b-cell lymphoma  data. see  <cit>  for detailed discussions. in this article, we investigate the concordance in supervised gene screening, which has been neglected previously.

another challenging aspect of microarray data analysis is the reproducibility. empirical studies, for example  <cit> , show that genes discovery results in one bootstrap sample are not necessarily reproducible in another one. reproducibility in gene clustering is recently studied by  <cit> ; theoretical framework is established in  <cit> ; in addition  <cit>  presents general reproducibility discussions of feature selection in microarray studies.

the goal of this study is two-fold. firstly, concordance of different supervised gene screenings is investigated. coupled with concordance study of regularized estimation methods, our study provides further insights into concordance of microarray gene discovery results using different statistical approaches. secondly, reproducibility of individual genes in supervised screening is considered. the proposed bootstrap reproducibility index provides more detailed reproducibility assessment than previous ones. we use empirical studies with four public microarray data to investigate the concordance and reproducibility. in the supervised screening, we follow the commonly used three-step procedure: computing , ranking  and selecting . with slight abuse of terminologies, in the paper "different supervised screening methods" in fact means "supervised screening based on different marginal statistics". the rest of the paper is organized as follows. we discuss eight commonly used gene screening statistics in the methods section and propose the bootstrap reproducibility index . empirical studies using four public datasets are provided in the results section. several related open questions are raised in the discussions section. the article concludes with a short summary.

RESULTS
data descriptions
colon data
in this dataset, expression levels of  <dig> tumor and  <dig> normal colon tissues for  <dig> human genes are measured using the affymetrix gene chip. in the unsupervised gene screening,  <dig> genes with the highest minimal intensity across samples are selected by  <cit> . the data is publicly available at  <cit> .

leukemia data
the leukemia dataset is described in  <cit>  and available at  <cit> . this dataset comes from a study of gene expression in two types of acute leukemia: acute lymphoblastic leukemia  and acute myeloid leukemia . gene expression levels were measured using affymetrix high density oligonucleotide arrays containing  <dig> human genes. the data comprise  <dig> cases of all and  <dig> cases of aml. we use the same unsupervised screening as in  <cit> :  thresholding with floor of  <dig> and ceiling of 16000;  filtering by excluding genes with max/min≤ <dig> and max-min≤ <dig>  where max and min refer to the maximum and minimum expression levels of a particular gene across samples, respectively; and  base  <dig> logarithm transformation.  <dig> genes pass the unsupervised screening.

estrogen data
this dataset was first presented in  <cit> . it contains expression values of  <dig> genes from  <dig> breast tumor samples. the expression data were obtained using the affymetrix gene chip technology and are available at  <cit> . for the estrogen data, there are two different response variables available. the first one describes the status of the estrogen receptor .  <dig> samples are er+, whereas the remaining  <dig> samples are er-. the second response variable describes the lymph nodal  status, which is an indicator for the metastatic spread of the tumor. here  <dig> samples are positive  and  <dig> samples are negative . we consider the same gene expression data coupled with the er and ln outcomes, respectively, and refer them as estrogen-er and estrogen-ln hereafter. for the unsupervised screening, we threshold the raw data with a floor of  <dig> and a ceiling of  <dig>  genes with max/min ≤  <dig> and/or max - min ≤  <dig> are also excluded.  <dig> genes pass the unsupervised screening. a base  <dig> logarithmic transformation is then applied.

empirical study i: concordance
in the first empirical study, we consider concordance of gene sets passed the eight different supervised screening approaches. for the four datasets, 20%  top ranked genes pass the supervised screening. we show the concordance results in tables  <dig>   <dig>   <dig> , where we compute the relative fractions of overlapped genes between any two screening methods. for example for the colon data in table  <dig>  we first rank the  <dig> genes using the difference of mean  and the t-statistic  as marginal statistics. then the top  <dig> genes  are selected under each approach separately.  <dig> genes are identified by both methods, leading to 87% overlap.

we can observe that there are considerable overlaps between genes selected under different supervised screening methods. however, the overlaps are not perfect and the differences can be as large as 40% . as m/d increases, the relative fractions of overlaps also increase, which suggests higher degree of concordance. however, even if 60% of genes pass the screening, the concordance may still be as low as ~75% for the estrogen-ln data. similar results are observed for the lymphoma data  <cit> , the nci  <dig> data  <cit>  and others. empirical study i reveals that with commonly used supervised screenings, genes selected under different supervised screenings may be considerably different.

empirical study ii: reproducibility
reproducibility of the supervised screening can be assessed with the proposed bri. as stated in the background section, only genes passed the supervised screening are used in statistical model building. so it is of great interest to see whether those genes are reproducible. although the proposed bri can measure the reproducibility of individual genes, we only present summary statistics  as the overall measurements of reproducibility for those selected genes. results are shown in table  <dig> 

we can see that in general genes screened by the eight different methods are moderately reproducible. for example for colon data when 20% genes are selected in the supervised screening, the medians of bri are ~ <dig>  or  <dig> , which roughly means that for the  <dig> genes passed supervised screenings, on average they pass the corresponding supervised screenings in 70% to 80% of the bootstrap samples. another observation is that as m/d increases, the bris also increase. we can also see that the bris for one fixed data and different screening methods can be slightly different, which is believed to be caused by the underlying gene distributions. we note that our reproducibility results are better than those shown in  <cit> . this is caused by the small m/d in  <cit> , where m =  <dig> and d >  <dig> 

empirical study iii: concordance of screening based on bri
in  <cit> , it is suggested that supervised gene screening should be based on reproducibility, i.e., instead of using marginal statistics based on all observations, a stability index should be computed for each gene based on certain marginal statistics and bootstrap random samples; genes then can be ranked based on this stability index; top ranked genes pass the supervised gene screening. theoretical and empirical studies  <cit>  show that predictive models can be more powerful if genes are screened based on reproducibility.

the focus of our study is the concordance of different supervised screening methods, instead of the predictive model building. however, it is of interest to see if statement in  <cit>  can be extended to supervised screening, i.e, if concordance of supervised screening can be improved if genes are screened based on reproducibility measurement. we consider the following empirical study. for each gene screening statistic, we  compute the bris for all genes based on bootstrap samples;  rank the genes based on the bris;  identify the genes with the highest bris; and  compute the concordance between gene sets identified in . compared with empirical study i, the same eight marginal statistics are used. however, in empirical study i, we compute the marginal statistic once for each gene, and the computation is based on all observations. in empirical study iii, the marginal statistics are computed multiple times: once for each bootstrap sample. the statistic used to rank the genes is the bri.

we show in tables  <dig>   <dig>   <dig>  the concordance results if genes are screened based on the bri. we can see that the results are very similar to those shown in the left panels. we do not observe significant improvement of concordance by using the bri for screening. this observation can be partly explained by the fact that genes screened in empirical studies i and iii are almost identical. for example for the colon data when 20% genes are selected , about 95% of genes passed the screening in empirical study i are also selected in empirical study iii. similar high overlaps are observed for other datasets.

although further theoretical investigation is still needed, our empirical study leads to the conclusion that supervised screening based on reproducibility measurement cannot improve the concordance.

discussion
remark: how to choose supervised screening methods
empirical studies above show that the effect of supervised screening on predictive model building is not ignorable. see table  <dig> for example. our study focuses on concordance and reproducibility measurements. however, we note that our study does not lead to any recommendations on how to choose the supervised screening methods. such a question still remains open. theoretically speaking, validity  of supervised gene screening depends on the unknown underlying model and data distribution. for practical data analysis, universally optimal supervised screening method is not expected to exist.

although screening based on marginal statistics has been extensively used, recent studies  <cit>  show that supervised gene screening should also consider the correlation structures among genes, and marginal methods may not be optimal. in addition,  <cit>  shows that a gene that is 'useless" by itself can be helpful in the joint models. empirical study of adaptive selection of supervised screening method based on reproducibility will be studied in a later article.

remark: how many genes should be selected
our empirical studies show that as m/d increases, the concordance and reproducibility measurements of all eight screening methods increase. so from concordance and reproducibility point of view, larger m is preferred. however with larger m, more genes, including noisy genes, pass the supervised screening. this contradicts the noise-removal and model-reduction purposes of the supervised screening. the predictive models are expected to be less reliable, when more genes are used in the model building. so the number of genes passed supervised screening should balance between the concordance and reproducibility requirement and the predictive model building.

theoretical studies  <cit>  show that the number of genes can at most be in the order of exp for a given sample size n. such results provide an asymptotic guideline for determining the number of genes. however, to our best knowledge, there is no theoretical or empirical studies targeting the optimal choice of m for practical datasets with small n.

remark: effect of unsupervised screening
in our empirical study, unsupervised screening is carried out for all four datasets. our unsupervised screening follows  <cit>  for colon data and  <cit>  for leukemia and estrogen data. it is believed that different unsupervised screenings will affect supervised screening and predictive model building results. unfortunately, as for supervised screening, there has not been enough study of unsupervised screening. previous used unsupervised screenings are case-specific and usually depend on the actual experimental settings. without accessing the experimental setup and interacting with the original researchers, we are not able to provide an honest assessment of the unsupervised screening in our study. we refer to aforementioned publications for rationale of the specific unsupervised screening.

remark: connections with detection of differentially expressed genes
in simple microarray settings such as the apo ai study in  <cit> , the goal is to detect genes differentially expressed. for binary classification problem such as the colon data, we can also lower our goal from statistical model building to detection of genes that are differentially expressed between diseased and healthy subjects. if so, then all the eight statistics discussed in last section can be used to rank and detect differentially expressed genes. the reproducibility of such studies has been investigated in  <cit>  and references therein.

although in our study, supervised screening and detection of differential genes are nearly identical, in general they can be significantly different in the following sense. firstly, detection of differential genes is usually under the simple setting with two sub-populations. the two sub-populations may come from different experimental settings and it is not always reasonable to assume statistical models linking gene expressions with the outcome, i.e, the causality does not necessarily exist. supervised screening is used before a statistical model can be built. it is employed in much more general settings, for example in survival analysis or longitudinal studies. secondly, supervised screening can be based on reproducibility. this has been proposed and proved to function. however, it is not clear whether reproducibility measurement can be used in differential gene detection. thirdly, when defining differentially expressed genes, certain statistical properties of the marginal statistics need to be known. for example for genes not differentially expressed, the p-values for t-statistics are uniformly distributed. with supervised screening, we only need to rank the genes and the top ranked are selected. hence only minimum properties of the ranking statistic need to be known. fourthly, in detection of differential genes, the correlation structure of the genes has significant effect on the distribution of marginal statistics and hence detection results. see  <cit>  for discussions. in the supervised screening, the distribution of the ranking statistics is of less interest: only the relative ranking of those  statistics is used. so as long as the marginal distributions are fixed, the correlation structures among genes have no effect on the supervised screening.

CONCLUSIONS
in microarray studies, supervised gene screening is usually carried out before statistical model building. in this article, we investigate the concordance and reproducibility of supervised screening via empirical studies. our study leads to the following conclusions:  effect of supervised screening on predictive model building and gene discovery should not be ignored. explanations of gene discovery results should be with extra cautions, if supervised screening is used;  genes passed different supervised screenings can be considerably different. the concordance depends on the screening statistics, underlying data structures and number of genes selected;  as measured by the bri, genes passed supervised screenings are only moderately reproducible and the reproducibility also depends on the number of genes selected; and  supervised screening based on reproducibility cannot improve concordance.

the goal of this study is to provide empirical evidence for the concordance and reproducibility problems in supervised gene screening, which has not been detailed studied previously. several related questions still remain open and are listed in last section. although of great importance, they are beyond the scope of this article.

