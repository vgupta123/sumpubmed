BACKGROUND
annotating proteins of unknown biological function is still a major bottleneck in the exploitation of genomic information. the main approaches are all based on the recognition of sequence similarity, from which functional homology is inferred with various levels of confidence. methods such as blast, psi-blast  <cit>  or pfam  <cit>  are used to automatically generate functional annotations to a sizable fraction of the genes in newly sequenced genomes. however, from 20% to 50% of genes  <cit>  are still annotated as being of unknown function, either because they have no statistically significant matches in current databases or because they only match uncharacterized protein sequences from other organisms. to provide putative functional assignments to those proteins, comparative genomic approaches are now reaching beyond the simple recognition of sequence similarity  <cit> . the reliability of these new methods, often referred to as genome context analysis, is now steadily improving, due to the almost exponential increase in the number of fully sequenced genomes. they allow the detection of functionally linked proteins, either physically interacting partners or members of shared metabolic pathways or cellular processes. the functional association of proteins may cause their encoding genes  to be part of a shared transcriptonal unit ,  <cit>  or to exhibit a chromosomal proximity conserved in several genomes   <cit> ,  to have evolved in a correlated manner   <cit>  or  to have fused as a single gene in another organism   <cit> .

here we introduce the new "gene function predictor" of our web software phydbac  <cit>  based on the results given by a combination of these non-homology based methods. this database proposes putative associations between escherichia coli k- <dig> proteins as well as functional go term predictions derived from these associations. a blast mode is also available to apply the method to any protein sequence. in this study, we first describe separate improvements to the three major genomic context methods. an integrated score combining their results is defined and shown to predict protein pairwise associations more accurately than the ones already proposed in established databases such as predictome  <cit> , prolinks  <cit>  and string  <cit> . we then take advantage of the pre-existing functional annotations of the putatively associated proteins to assign them to go categories  <cit> . the "gene function predictor" proved to be particularly useful for the «conserved hypothetical protein» subset, as shown on a specific example.

implementation
this web tool is designed as a cgi script written in perl running on an apache web server. this script first retrieves genes through the process of the information entered into a html form. a target gene can either be retrieved by its name or by the presence of a keyword in its annotation. the putative associations and functional predictions are then extracted by running a number of perl scripts on a database of pre-computed blast hits and auxiliary information. results for the query are then displayed through html pages. the "gene function predictor" is accessible through any browser.

RESULTS
data sources and scoring
in this study, genomic context analysis is applied to the well annotated bacterium escherichia coli k- <dig> . this analysis is performed using the  <dig> completely sequenced organisms available in refseq, including  <dig> bacteria,  <dig> archaeal bacteria and  <dig> unicellular eukaryota. e. coli protein associations available in phydbac's "gene function predictor" are generated by three genomic methods : the phylogenetic profile, the colocalization and the rosetta stone methods. improvements to these different methods and their implementation are described in the following.

consensus phylogenetic profiles 
it is established that proteins evolving in a correlated manner tend to participate in common metabolic pathways or constitute multi-molecular complexes. using the simplest type of phylogenetic profile, the co-occurrence of genes is represented by a string of bits, each bit recording the presence or absence of an ortholog to a given gene in a genome  <cit> . in an earlier work  <cit> , we proposed to replace this binary scale by continuous values derived from alignment scores.

let sab be the best blastp bit score between a target protein a and all proteins of a bacteria b and saa the self-score of the a protein aligned with itself. each point of the phylogenetic profile of a protein a is computed as : rab = sab/saa.

each point of a profile is weighed proportionally to the length and quality of the corresponding alignment. although this method was shown to improve on the binary method of pellegrini et al.  <cit> , the profiles are noisy. as we want no orthologs to be missed, even low sequence similarities are considered, bringing back a certain amount of false positives.

to improve their quality, profiles now use the information contained in the profiles of genes from other species. introduced as a display feature in our web software phydbac  <cit> , consensus phylogenetic profiles  are built from the profiles of a target gene and of its putative orthologs. the cpp of a gene has a non-zero score in a given column  if more than half of its best matches in the other species has a match in this bacterium. the score of the profile for this column will then be the mean of the non-zero scores of the different putative orthologs with the corresponding bacteria. figure  <dig> shows the profile of e. coli protein phor, the ones of its best homologs in different organisms and the cpp of phor built out of all those profiles. we note that the cpp of phor is similar to its simple profile except at the columns corresponding to the two neisseria meningitidis strains. unlike phor for which low sequence similarity matches are found in these strains, its best homologs do not exhibit any matches in these two organisms, suggesting that no orthologs of phor are present in them.

from the cpp of the  <dig> protein coding genes of e. coli, a pairwise p score is then computed. the p score is a correlation coefficient computed without the mean between each pair of profiles, profiles being n-dimensional vectors, with n the number of sequenced genomes . the profiles are stored in a matrix r where rik is the value of the gene i profile at the column k corresponding to bacteria k. the score pij reflecting the coevolution level between two genes i and j is then given by :



pairs of gene products exhibiting the highest p scores are the most likely to be functionally linked.

detection of co-localizations 
the identification of pairs of genes part of the same operon in a genome can also lead to their functional associations. indeed, genes organized into operons, i.e. genes transcribed into a single mrna, are co-regulated and tend to fill related roles in cellular processes of the organism. such genes are identified either by using intergenic distances separating genes  <cit> , by analyzing conserved chromosomal adjacency between genes in a set of genomes  <cit>  or more recently by combining these two sources of information  <cit> . because the assumption that genes separated by small intergenic distances are likely to belong to a shared operon is true in all prokaryotic organisms  <cit> , the intergenic distances in all the genomes are more informative than conserved chromosomal adjacencies. our score c is based on intergenic distances separating colocalized gene pairs across all the genomes. two genes are said to be colocalized in a genome if these two genes and the genes between them on the chromosome are on the same strand and if all adjacent gene pairs of the string are separated by less than  <dig> bp  <cit> . in e. coli, more than 98% of the gene pairs being on an operon described in regulondb  <cit>  are separated by less than this threshold of  <dig> bp. the distance associated to a colocalized gene pair is the maximal intergenic distance found between them. for example, for three adjacent genes a, b and c on the same strand, if a and b are separated by  <dig> bp and b and c by  <dig> bp, we consider a and c to be colocalized with a distance of  <dig> bp.

to avoid artefacts due to the presence of redundant strains and of evolutionary close species in the  <dig> genomes, we restrict our analysis to  <dig> groups of similar organisms, made on the basis of the multiple alignments of the  <dig> homologs of three conserved genes  <cit> . a pair of genes found colocalized in xanthomonas campestris and in the two xylella fastidiosa strains will only be considered as colocalized in the group containing these organisms, the minimal distance separating this couple in a genome of this group being recorded.

the colocalization score c reflects the degree of confidence in the fact that genes are colocalized because of functional relationships, ie that genes are part of an operon in a genome. the score between each gene i and j of a target genome is :



where gij are the groups of genomes where i and j are colocalized and dij the minimal distance in base pairs that separates i and j in a genome of the group g. the definition of c was derived from observed characteristics of colocalized genes. a colocalization score between two genes must always increase as groups in which these genes are co-localized are found. our c score was built in order to verify this point. indeed, c is equal to  <dig> minus a product of elements, each element, involving an intergenic distance, being comprised between  <dig>  and  <dig>  to calculate these elements, an exponential function is used because the information gained from an intergenic distance must not be proportional to the length of this distance. different formulas were tested and this c definition is the one that gives the better results.

in contrast to the operon or gene cluster method, our score c is able to detect gene pairs distant in e. coli that form an operon in other organisms . unlike the gene neighbor method, it can detect operons present in only one organism . of course, not all of the e. coli gene pairs are separated by less than  <dig> bp in at least one genome. only  <dig>  of the possible  <dig> , <dig> gene couples of e. coli are found separated by less than  <dig> bp in at least one genome, with an average score c of  <dig> . a c average of  <dig>  is found when considering the  <dig> pairs of genes present in the same operon described in regulondb  <cit> .

identification of gene fusion events 
associations of genes can also be deduced with the rosetta stone technique  <cit>  by detecting gene fusion events. two distinct genes of a given organism that are found fused as a continuous sequence  in another genome tend to physically interact. non-homologous proteins fused as a single sequence are identified with the aid of the pfam protein domain database  <cit> . rpsblast of all the pfam domains against all the proteins of  <dig> genomes and e. coli were computed, using a threshold of significance of 10e- <dig> for the expectation value of the alignments. two e. coli proteins are determined to be fused if at least one domain of each protein is found separately in a third protein of another organism. as domains are relatively short compared to protein sequences, we did not consider overlaps larger than  <dig> residues between the alignments of the two domains on the rosetta stone sequence. the presence of two domains in different proteins as well as on the same coding sequence is of course not enough to be sure that a real fusion event took place between genes coding these proteins. but as such domains are likely to be functionally linked, it is also true for the proteins in which the domains appear separately. a score f is deduced from the probability that two genes are found fused by chance in another single sequence described in  <cit> . this score f depends on the number of sequences with which the two domains considered exhibit a significant sequence similarity and the number of sequences in which these domains are found fused. the score f is computed for each of the  <dig>  e.coli protein pairs for which a putative domain fusion is detected.

evaluation and comparison between p, c and f and the integrated score
as the three scores p, c and f are based on different concepts, they are supposed to be independent and to provide different valuable information. to integrate them appropriately into a unique score, we have to scale them by their respective accuracy to predict genes that are functionally linked. as p, c and f are continuous scores, a list of ranked significant associations given by each approach allows to calculate the fraction of associations involving two genes annotated in the same cog category among associations linking cog-annotated genes  <cit> .

this success rate also allows us to compare the quality of each score . first of all, we note that the information on coevolution is better retrieved when consensus profiles are used  compared to our previous simple profiles . the increase of accuracy between p and p-old is higher by more than 30% for any number of predicted pairs. c gives even better results than p, with  <dig>  predictions with an accuracy higher than  <dig>  .  <dig>  of the  <dig>  gene pairs in shared operons of regulondb  <cit>  have a c score higher than the threshold corresponding to an accuracy of  <dig> . the score f associates  <dig>  different e. coli protein pairs with a success rate higher than 50%.

the success rate is used to establish normalized scores across the different approaches. this normalization procedure then allows the individual scores to be merged into an integrated score in a simple way :

sij =  <dig> - 

where i and j are two genes and with pij, cij and fij set to  <dig> when no significant score is found for i and j. the quality of predictions made with this integrated score s is significantly better than each of p, c and f on their own . for the  <dig>  best associations between cog -annotated genes given by each method, the score s has a cumulated accuracy 21% better than the score c,  <dig> % better than the score p and more than 60% better than the score f alone. for an expected success rate of at least  <dig> %,  <dig>  pairwise associations are derived from the s score, involving  <dig>  e. coli genes. a coverage of  <dig> %  is obtained when considering an accuracy of  <dig> %.

comparative benchmarking of databases
there are three major databases of putative associations between prokaryotic genes derived from genomic context analysis : predictome, string and prolinks. each one implements different methods with personal flavours. in predictome  <cit> , phylogenetic profiling, gene neighbor and domain fusion are implemented in their traditional way and applied to orthologous families of genes defined in cog. one of its major limitation is the absence of a quality score for each prediction. in the earlier releases of string  <cit> , genomic analysis was also relying on cogs. a protein mode is now available, based on continuous phylogenetic profiling, gene neighbor, fusion, as well as experimental data and literature mining  <cit> . prolinks  <cit>  uses binary profiles not based on cog data. for pairwise alignments, the homology is considered significant if the e-value associated is lower than 10e- <dig>  text mining, gene fusion, gene neighbor as well as a gene cluster method are also implemented. for each method, they developed their own probabilistic score. prolinks and string scale the different methods separately and then compute a confidence score.

to compare those three databases to phydbac, the associations were downloaded from their respective web sites. as the accuracy of the putative links given by each database is tested against gene ontology data  <cit> , we only keep associations involving go-annotated genes.  <dig>  different associations between go-annotated genes are found in predictome,  <dig>  in string and  <dig>  in prolinks. for each database, each target gene annotated in at least a go class has a certain number of go-annotated genes associated to it. we select the same number of our best go-annotated predictions involving this target gene and determine which database has the best accuracy for each gene . associations given by our method more often imply genes belonging to the same go category than associations of other databases.

we can note that predictome gives better results for only  <dig> % of the genes . this point is not surprising as the release of predictome is the oldest of the three databases. string is the database that gives the most different results to ours . as we have seen, additional information, different to genomic information, has recently been added and the gene cluster method is not used. in figure  <dig>  we note that results of phydbac are more accurate than those of string for 54% of the  <dig>  go-annotated genes that have at least one association in string. our putative associations are also better than those found in prolinks. for 46% of the  <dig>  go-annotated genes of prolinks, putative associations predicted by phydbac imply two genes of the same go category more often than those found in prolinks. a surprising result described in the prolinks paper  is the fact that the integration of their  <dig> methods do not give better results than their gene neighbor method on its own. their final score for a gene couple is the maximum value found with the  <dig> methods. as we have seen, the different methods are supposed to give independent information, and although this is not strictly true, a combination of the different scores  works better.

assignment to go categories
in addition to putative associations, we developed an annotation procedure meant to assign genes to gene ontology categories  <cit> . go provides structured classifications that cover several domains of molecular and cellular biology. gene products are described throughout three non-overlapping domains :  molecular function describes activities at the molecular level,  biological process describes biological goals accomplished by one or more molecular functions and  cellular component describes locations at the level of subcellular structures and macromolecular complexes. go can be viewed as a directed acyclic graph that represents a network in which each term may be a "child" of one or more "parents". for example, the function term "peptidyl-serine adp-ribosylation", from the biological process vocabulary, is a child of both terms "protein amino acid adp-ribosylation" and "peptidyl-serine modification".

in our annotation procedure, each term is considered as an independent class. for a target gene and for a fixed accuracy threshold for s, a certain number of genes are potentially linked to the target, associated to a total of t annotations. each go term a appears na times in the t annotations  and na times in the total pool of the t annotations of e. coli genes. the probability to draw at least na annotations of the go term a or of child terms of a by chance out of t annotation is given by :



for each target gene, go terms with a value for this probability lower than 10e- <dig> are considered as putative functional annotations. the same procedure is repeated for decreasing accuracy thresholds of s.

considering e. coli genes already annotated with go terms,  <dig>  go term predictions are derived from the  <dig>  links with expected success rate of 90%. 80% of these  <dig>  predictions are correct, i.e. already appear in the annotations of genes. out of these  <dig>  predictions, the  <dig> best, corresponding to a probability lower than 10e– <dig>  have an accuracy greater than  <dig> %. when using links with an expected success rate of 80% , 70% of the  <dig>  functional predictions are correctly inferred. of course, predicted go terms that do not appear in the gene's annotation cannot be considered systematically as false predictions. annotated genes may have additional – yet unknown – functions or predictions may represent the gene function on another level. for example, yaet, annotated in go term as an "outer membrane"protein, which describes its location, is predicted to participate in lipid a biosynthesis and metabolism, which describes the biological process it may be involved in. for an accuracy threshold of 60%,  <dig>  go term predictions are made for more than  <dig>  e. coli genes.

web interface and example
the "gene function predictor" emulates two main different modes of operation. in the first mode, the predictions can be made for any protein sequence pasted by the user in a similar manner to plex  <cit> . in this blast mode, the consensus profile of the given sequence is dynamically created and the most similar profiles are determined among the genes of the organisms processed in phydbac. the conserved neighbors on the chromosomes are also determined by comparing the sequences found proximate to the pasted sequence in all organisms. genes associated to the query by rosetta stone are identified by the presence of conserved domains in this sequence. if some associated partners are determined, an annotation procedure similar to the one described above is applied, even though all the partners do not come from the same organism. this mode of operation is useful for genes of organisms whose sequence is not complete or not public.

the second mode of operation of the "gene function predictor" is a database gathering the results described in the study for processed organisms. currently limited to e. coli, this mode will be extended to all fully sequenced micro-organisms. e. coli genes can be retrieved by their names or by the presence of a keyword in their annotations. for any gene queried, its most probable association partners as well as its significant go term predictions are displayed on a single page. the confidence we have in the different predictions is depicted through keywords and colours. for example , yjgi, a protein annotated as "putative oxidoreductase"is associated to a reductase  and to other putative oxidoreductase  by coevolution  and  <dig> of its  <dig> best associated partners are acyl-carrier proteins and are significantely linked with yjgi by each of the three methods . as acyl carrier proteins are fundamental components of fatty acid biosynthesis, the best go term predicted for yjgi is "fatty-acid synthase activity"and "fatty-acid biosynthesis". the specific biochemical activity of yjgi cannot be deduced from these results, but like its most probable partners, yjgi is likely to be involved in fatty acid synthesis. furthermore, acyl carrier protein as well as acyl carrier protein synthase are known to be essential for e. coli viability. maybe this is also the case for yjgi. for such proteins annotated as "putative ..."or uncharacterized proteins, our tool provides hypothetical functions, either new or on another level of description. the "function predictor" is fully linked with the software phydbac, as a closer analysis and additional information can be retrieved through the display of the profiles, of the conserved gene neighbors and of the gene fusion.

CONCLUSIONS
although the huge amount of data provided in the past few years from genome sequencing allows a large spectrum of research axes, the most serious problem of modern bioinformatics is still the quality and degree of completeness of the annotation of sequenced genomes  <cit> . earlier versions of phydbac made a step in this direction by providing an interactive resource on prokaryotic proteins and on their context that may help microbiologists. but the different sources of information contained in genomic data may not always be trivially extracted by hand. the new "gene function predictor"integrates the different concepts to automatically predict putative functions for e. coli genes.

we have shown that the integrated score, from which the putative pairwise associations are derived, gives better results than any intermediate approach on its own. we also compared our results to the best associations found in major databases based on the same concepts. our protein linkages proved to be more accurate.

go assignments were also benchmarked and are highlighted with distinct colors when displayed on the web. as go is an annotation standard, the same procedure can be computed for any prokaryotic organism. a future version of the "gene function predictor", currently limited to e. coli, will be extended to all fully sequenced micro-organisms, even though a blast mode of operation is already available.

availability and requirements
project name: phydbac "gene function predictor"

project home page: 

operating system: web server

programming language: perl and html

authors' contributions
fe and ks analyzed the data and designed the methodology. fe developed the programs, the web interface and wrote the manuscript. ks contributed with ideas on overall design, feature requirements, and implementation. jmc coordinated the research and jmc and ks assisted with drafting the manuscript.

