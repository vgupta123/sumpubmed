BACKGROUND
fig. 1a shows the surface image of a hybridized affymetrix genechip expression array. its area of about  <dig>  cm <dig> divides into a grid of nearly one million probe spots of size  μm <dig>  each of them is covered by a 'turf' of 25meric oligonucleotides attached to the chip surface. their sequence is chosen to match complementary oligonucleotide targets which carry fluorescent labels. these targets can be prepared either from messenger rna  to explore the transcriptome in terms of gene and exon expression; or from genomic dna  to discover the genome in terms of protein/dna interactions, copy number variations and single nucleotide polymorphism  genotyping. when present, these targets are assumed to bind to the respective probe oligomers giving rise to a bright spot at the chip image. if absent the respective probe spot is assumed to remain dark. hence, the array experiment translates the abundance of tens of thousands of different targets into an image of intensity spots. in the case of expression arrays the measured intensities thus provide a snapshot of the transcriptional activity of the studied biological sample. the shown image clearly reveals dark and bright horizontal stripes which correlate with the non-random arrangement of probe sequences on the chip: firstly, the vertical position of perfect match probes  alternates with that of paired mismatch  probes. the intensity of the former ones exceeds that of the latter ones on the average due to their altered middle base which mismatches the target. secondly and more importantly, the probe sequences arrange in rows with respect to short motifs. in particular, the position of most of the probes possessing triple degenerated guanines at the solution end of their sequence 1) are found within a horizontal band which exactly matches the brightest stripe of the chip image. the respective intensities exceed the average intensity level of the array typically by a factor of two to ten. it seems unlikely that these strong intensity values are associated with extraordinary large expression levels of the respective target genes. instead the bright intensities can be attributed to probe effects which typically reflect the sequence specifics of probe/target interactions  <cit> . such probe effects must be removed from the data to obtain adequate expression values. this obligate correction of raw intensities prior to downstream expression analysis is called calibration or preprocessing. numerous preprocessing algorithms are presently available to transform raw intensity data into expression measures .

on genechip arrays a certain number of probes  are collected into one probe set which interrogates the same target gene. preprocessing summarizes the probe intensities of each probe set into one expression value. fig. 1b shows the distribution of expression values obtained after calibration of the intensity data shown in panel a using different preprocessing methods . the boxplots are calculated alternately either for all probe sets of the array or for probe sets which contain at minimum two  <dig> probes. the results obtained from most of the preprocessing methods clearly reveal a systematic shift of the expression values of this  <dig> sub-ensemble to higher levels. these calibrations obviously fail to correct the strong intensity bias properly.

as one option to solve this problem one can simply exclude the 'bad'  <dig> probes from further analysis. however, we show below that also other motifs, for example runs of degenerate guanines along the whole sequence, can cause systematic intensity biases. the masking of such 'bad' probes will exclude a significant fraction of the available intensity data from expression analysis and thus reduce the information potentially available from the microarray experiment. we suggest therefore an alternative strategy which intends to correct the probe-related intensity effects. it aims at extracting the 'hidden' information about target abundance in terms of corrected intensities for further use in downstream analysis.

this contribution addresses this issue and presents a systematic study of the effect of short sequence motifs of up to four adjacent nucleotides at all possible sequence positions on the resulting probe intensity. we compare the results obtained for different hybridizations after variation of the sample rna, chip type and/or the amplification protocol. our approach aims at identifying the minimum motif length for appropriate intensity prediction using a positional and motif dependent model. we focus on the effect of runs of degenerated guanines which have been found to behave unusually compared with other motifs in different chip assays including affymetrix expression and snp arrays  <cit> .

the remainder of the paper is laid out as follows. in section  <dig>  public available microarray intensity data are analyzed in terms of positional dependent models of rank  <dig> to  <dig> using single base , nearest neighbor , next nearest neighbors  and quadruple  sequence motifs. we assay experimental factors such as the chip type, the sample rna and the amplification protocol, disentangle the role of specific and non-specific hybridization and compare pm and mm probes. based on the results of these analyses we propose a nn+ggg hybrid model to correct the probe intensities for sequence effects. an implementation of the method can be downloaded from our website http://www.izbi.de. the discussion in section  <dig> compares the performance of different preprocessing algorithms with respect to sequence effects and the potency of different sequence models for use in intensity calibration for microarrays. the methodical section at the end of the paper sets out the basic equations and background theory for the analysis and provides also references for the used array data. the supporting material supplements the main results given in the paper .

RESULTS
positional dependent sensitivity profiles of different rank
we apply the positional dependent sensitivity model descibed in the methodical section below to the intensity data shown in fig. 1a. the model provides sensitivity profiles of rank  <dig> to  <dig>  the maximum rank being limited by the available number of data points. fig.  <dig>  shows the profiles which were obtained using the intensities of 'absent' called pm probes. the sensitivity terms can be interpreted as the logged intensity increment due to the respective sequence motif of r consecutive bases starting a position k of the 25meric sequence .

the shapes of the four single base profiles  virtually agree with previously published data  <cit> : the sensitivities of adenines  and cytosines  are roughly symmetrical with respect to the x-axis and change in a parabola-like fashion, the maximum being near the middle of the probe sequence. the profiles of guanine  and thymine  indicate a more monotoneous dependence. all profiles are asymmetrical with respect to the ends of the probe sequence: they converge towards the surface-attached side at k =  <dig> but differ significantly near the solution end at k =  <dig>  the sensitivities and thus the base- and positional dependent contribution to the intensities increase according to a <t <g <c for most sequence positions. the nearest neighbor model  provides a total of  <dig> profiles. most of them relatively tightly group about the x-axis resembling essentially the parabola-like shape of the single base profiles for a and c. the contributions of the cc-profile however markedly inflates for all sequence positions whereas the gg-profile increases especially at small k. this latter trend is partly counterbalanced by negative values of t-containing nn-termns, especially of tt.

inspection of the  <dig> nnn-profiles  shows that these trends further intensify for stacks of cytosines  and guanines  where the relative level of the latter profile increases compared with that of ccc.

g-quadruples clearly dominate at small position indices k <  <dig> among the  <dig> quadruple profiles of rank r =  <dig>  also other motifs indicate a relatively strong contribution at small k as well . the contribution of gggg-quadruples  markedly drops for k >  <dig>  i.e. for positions closer to the surface end of the probes. note also, that the parabola-like shape of the profile of runs of adjacent cytosines changes into a broad plateau which decreases only near the ends of the probe sequence.

hence, the contribution of a few motifs, especially of degenerated runs of c and g but also of selected gc-rich tuples, increases above average with the extension of the model rank from r =  <dig> to r = 4: more than twofold for cccc and up to tenfold for gggg compared with the respective single nucleotide values. longer homo-motifs obviously adapt to specific intensity effects.

the sequence effect of some of the motifs reaches its maximum in the middle of the sequence. with increasing model rank, these peaks reshape into a broad plateaus of virtually constant sensitivity values which markedly change only near the ends of the probe sequence. in contrast, g-rich subsequences add strong intensity contributions at small position indices especially at the first sequence position. the respective contributions progressively increase for r =  <dig> to  <dig> but then remain virtually unchanged for r =  <dig>  note that also the guanine profiles of lower rank , show exceptional large positive values at sequence positions k <  <dig>  the possible origin of this behavior will be discussed below.

the right part of fig.  <dig> shows the corresponding profiles of the pm probes predominantly with specific hybridization. only 8% - 20% of all probes on the chip meet this criterion. this relative small number of probes restricts the rank of the model to r =  <dig> -  <dig> and, moreover, gives rise to a relatively large level of noise. the specific profiles possess essentially the same properties as the non-specific ones shown in the left part of fig.  <dig> except that for g- and t-rich motifs. in particular, profiles of homo-runs of guanines shift markedly towards smaller values compared with their non-specific values. note also that the  <dig> and especially  <dig> motifs at the solution end contribute much less to the specific profiles.

guanine effects
part a of fig.  <dig> compares the sensitivity profiles of non-specifically hybridized probes of the mouse data set shown in fig.  <dig> with the respective profiles of the encode and hg133a_s data sets. as a general trend, the sensitivity level of poly-c terms nearly linear increases with increasing rank of the model as indicated by the dotted lines. this trend reflects a constant incremental contribution per additional cytosine in the considered motifs. in contrast, the sensitivity of poly-g motifs starting at k =  <dig> steeply gains at r =  <dig>  or, to a less extend, at r =  <dig> . we re-plot the respective sensitivity values in the left part of fig.  <dig>  they reflect an extraordinary strong intensity increment due to three consecutive guanines starting at the first sequence position in the former situation and due to four consecutive guanines along the whole probe sequence in the latter situation. we will call these properties shortly 1- and poly-g effect, respectively.

the 1-effect is further supported by similar values of the sensitivity terms for quadruples starting at k =  <dig> with threefold degenerated guanines gggb  and that of the respective triple-g, i.e. σ <dig> ≈ σ <dig> . it shows that the 1-motif adds the dominating intensity contribution to that of the gggb-quadruples.

note that the 1-effect of the encode-data set largely exceeds that of the mouse data set by nearly one half order of magnitude: an initial run of three g increases the intensity relative to the mean intensity level by the factor of  <dig>  =  <dig> and  <dig>  =  <dig>  in the former and latter data set, respectively. the intensity increment due to a triple-c motif in the middle of the probe sequence is distinctly smaller and amounts to a factor of about  <dig>  =  <dig> . subtle differences between the sensitivities due to the different hybridization chemistries  will be discussed separately below.

in summary, triple degenerated guanines at the solution end of the probe sequences cause exceptionally large intensities in selected data sets. longer runs of consecutive g along the probe sequence are also associated with large intensities, however to a smaller extend.

quality of motif specific fit
the discussed sensitivity profiles were obtained by multiple linear regression fits of eq.  to the intensity data of non-specifically hybridized probes of the respective arrays by minimizing the total sum of squared residuals  ). the fit of models of increasing rank r improves the goodness of fit in terms of the total ssr ). table  <dig> lists the total ssr values of the single base model and the respective f-values for models of rank r =  <dig> -  <dig> ). maximum improvement is observed for the nn model compared to n and smallest for nnnn compared to nnn.

the respective f-values for the higher ranks r =  <dig> -  <dig> evaluate the improvement of the fits with respect to the model of next smaller rank r -  <dig> 

the total ssr was decomposed into motif and positional dependent terms according to eq.  to characterize the model fits of rank r =  <dig> -  <dig> more in detail . in general, the mean level of the ssr-terms decreases with increasing rank of the model indicating the improvement of the fits in parallel with the decrease of the total ssr discussed above. the partial ssr values of selected motifs  are larger than the average level for the n-model. especially the value of the 1-motif largely exceed the total ssr value by nearly one order of magnitude  and by the factor of 2- <dig>  indicating inadequate fitting of this motif . the ssr-values estimate the deviation between the fitted and the experimental data. they can be attributed to two potential origins, namely the systematic bias due to the inadequacy of the model and/or the random scattering of the experimental data. we calculate motif- and positional dependent profiles of the qualitiy of fit ) and of the standard error ) as suited measures to estimate the respective contributions. particularly, one expects vanishing qf-values for adequate fits of the model. the motif and positional data shown in part c of fig.  <dig> reveal that the n-model fails fitting the probe intensities of all considered data sets. the nn-model markedly improves the fit for all motifs except  <dig>  clearly this motif gives rise to residual systematic deviance between the fits and the respective intensities of the mouse and encode data sets. it however largely vanishes for r =  <dig>  this result confirms our hypothesis that the observed intensity effect is related to threefold degenerated guanines  <dig>  the qf-profiles of the hg133a_s data set reveal small systematic deviations of degenerated guanines motifs along the whole sequence for r =  <dig> and  <dig> due to the poly-g effect.

the standard error is relatively invariant for most of the motifs and positions with se <  <dig>  as a rule of thumb . note that selected gc-rich motifs in the middle of the probe sequence are very rare on the mg <dig>  <dig>  and encode arrays with partly less than  <dig> probes containing these motifs . these small numbers gives rise to imprecise estimates of the respective sensitivity terms.

in summary, the decomposition of the total fit statistics into motif- and positional dependent contributions reveals adequate fits of most of the motifs using the nn-model. as a clear exception, the 1-effect requires explicit consideration of nnn-terms for adequate fitting.

chip-type and target effects
the data sets so far address different target samples which are hybridized onto different chip types. both factors potentially affect the motif and positional dependent sensitivity profiles, and, in particular, the poly-g effects discussed above. to discriminate between effects due to target and chip-type we compare the sensitivity profiles for different hybridizations of the same rna sample  to two different chip types, namely the newer hg133plus <dig> and the previous-generation hg 133a array. the nearly  <dig>  probe sets of the former chip integrate the more than  <dig>  probe sets of the latter one and this way allow direct comparison of the intensity of probes of identical sequences on the two chip types after appropriate masking of the additional probes in the hg133p_z data set. the obtained three sets of profiles of rank r =  <dig> -  <dig> are very similar and provide no indication that the two considered chip types strongly modify their shape . for example, the poly-g effect is observed in all three data sets. in the next step we compare the profiles of different rna-hybridizations to the same chip type . also in this case the profiles of most of the motifs look similar for the different hybridizations except the sensitivity terms of homo-g runs at the first sequence position which indicate different amplitudes of the 1-effect. for direct comparison we normalize the respective triple sensitivity term relatively to the maximum sensitivity value of triple-c motifs in the middle of the sequence and calculate the difference Δσ  = σ <dig> - σ <dig> as a relative measure of the amplitude of the 1-effect . part c of fig.  <dig> shows the distribution of the obtained Δσ -values for a series  <dig> independent hybridizations using mg <dig>  <dig>  arrays. the data show that the amplitude of the 1-effect varies over a wide range for different target hybridizations of the same chip type.

in the next step we estimated the amplitude of the 1-effect for eigtheen different array types. fig.  <dig> plots the mean sensitivity amplitudes σ <dig>  σ <dig> and their difference. the considered chip types can be roughly classified into four chip-generations  which use different probe spot sizes, number of probe spots per chip and partly different hybridization chemistries. the spot sizes decrease from 18- <dig> μm , to  <dig> μm  and to  <dig> μm  which results in the marked increase of the number of probes per chip. generation  <dig>  uses a pm-only design without mm-probes and dna/dna instead of dna/rna probe/target-hybridization chemistry. we assign the encode arrays also to generation  <dig> because it applies dna/dna hybridizations as well. however, it still uses mm probes and larger spot sizes  compared with gene  <dig>  st and exon  <dig>  st arrays. 'chipchip' assigns arrays of the encode-type which are applied in chipchip experiments. on chips of generations  <dig> -  <dig> most of the probes containing 1-motifs are located in a row as shown in fig.  <dig> 

it turned out that the 1-effect can be identified for all arrays of generations  <dig> to  <dig>  its amplitude tends to increase for chips of later generations  <dig> and  <dig>  the differences between the chip generations are however moderate without clear indication that type-specific factors such as the arrangement of probes, their spot size, density and number explicitly explain the 1-effect.

interestingly, our data reveal a large difference of the amplitude of the 1-effect between the encode-expression and encode-chipchip hybridizations . both experiments use the same type of encode tiling arrays but different amplification protocols: the former one amplifies sample mrna via t7-priming and subsequent reverse transcription to double stranded cdna whereas the latter one amplifies genomic dna after immunoprecipitation via random priming without the t7-protocol  <cit> . note that fragments of the t7-primers used in the amplification step of mrna-sample preparation partly remain bound to the amplified targets as has been discussed in  <cit> . the respective common g-rich sequence motif of the primer  contaminates a large fraction of the targets at their 5'-end and preferentially bind to probes with complementary c-rich motifs  <cit> . one might hypothize that these fragments are prone to associate also with selected g-rich probe sequences to form mixed probe/target g-quadruplexes which give rise to the strong intensity of the respective probe spots. 

in summary, we found systematic differences between the amplitude of the guanine effects between genechips of different generations which are rather gradual than fundamental. on the other hand, our data suggest that the amplification protocol for the used targets strongly affects the 1-effect. previous studies showed that the targets become contaminated with g-rich primer fragments after t <dig> amplification with possible consequences for their binding affinity to g-rich probes.

perfect match and mismatch probes
each perfect match  probe is paired with one mismatch  probe on most of the affymetrix microarray types. the mm probes use the same 25meric sequence as the respective pm probes except for the middle base, which is substituted by its complement. to extract subtle differences between the sensitivity profiles of both probe types we calculate the logged intensity difference of each probe pair, Δ = log ipm - log imm, and subsequently fitted the nnn-sensitivity model of rank r =  <dig> to the intensity data of the three data sets given in table  <dig> 

a gene expression omnibus  accession number

b number of probes and of probesets per array

c pseudo sets are assembled using five consecutive probes

d percentage of absent probes per array

e mean value of the logged non specific background intensity and logged saturation intensity

f percentage of probes containing the 1-motif and of probe sets containing at minimum one of these probes

the obtained terms characterize subtle intensity differences between both probe types in a motif- and position-dependent way. their amplitudes virtually vanish for k <  <dig> and  <dig> <k . this result seems trivial because the sequences of pm and mm probes are identical at these positions. it clearly indicates, however, that the 1- and poly-g effects apply to the pm and mm probes as well.

the nnn-sensitivity data markedly deviate from the baseline at positions k =  <dig> ...  <dig> at which the triple motifs diverge between the pm- and mm-probes owing to the swapped middle base . here we focus our discussion to triple degenerated homo-motifs in the middle of the pm-  sequence which combine with motifs of broken degeneracy in the respective paired mm-  sequence. for example,  <dig> combines with  <dig>   <dig> with  <dig> and  <dig> with  <dig>  the calculated sensitivity amplitudes consequently characterize the logged intensity difference due to both motifs.

fig.  <dig> sorts the profiles with respect to the central base b of the middle triples in the pm sequence, xby with b, x, y = a, c, g, t. the complete base pairings in the triple motifs are given in the figure. base pairings in dna/dna duplexes are symmetrical with respect to bond reversal  <cit> . one expects therefore a central symmetrical pattern for the profiles of degenerated triples and the triples with swapped central base, e.g. aaa versus ata and ttt versus tat. the obtained sensitivity-profiles indeed show this symmetrical pattern. one expects also equal amplitudes for complementary homo-motifs, e.g. aaa and ttt. the observed effect however ranks according to aaa ≈ t t t <ccc <ggg. the slightly larger peak of  <dig> compared with  <dig> indicates the poly-g effect along the sequence.

the mouse and hg133a_s data sets refer to dna/rna hybridizations. the chemical asymmetry of base-pairings between the dna probes and rna targets  explains the slightly modified pattern of the obtained triple motifs compared with that of the encode data set. particularly, one gets for the mouse data set ggg ≪ aaa <t t t ≪ ccc which is compatible with solution data . it therefore provides no indication of the poly-g effect. in contrast, in the hg133a_s data one observes the reversed relation for guanines and cytosines, ggg > ccc, which indicates a slightly larger intensity contribution of degenerated runs of guanines.

in summary, the joint analysis of the pm- and mm-intensities shows that both probe types are affected by the poly-g and 1-effect to a similar extent. it also reveals a relatively large intensity contribution of poly-g motifs in the middle of the sequence in some cases. the amplitude of this effects is however relatively small compared with the 1-effect.

specific and non-specific hybridization
our analysis so far mainly use the positional sensitivity profiles of non-specifically hybridized pm probes and of the logged pm-mm difference. selected profiles due to specific hybridization revealed a decreased sensitivity level of runs of degenerated guanines and, in particular, of the 1-motif . this result suggests that the 1-effect is only weakly or even not at all associated with specific hybridization.

it should be taken into account, however, that the specific sensitivity profiles are relatively uncertain owing to incomplete correction for parasitic effects such as saturation of the probe spots and bulk hybridization which deform the shape of the profiles and shift their level against each other  <cit> . moreover, the number of probes in the sub-ensembles of probes used for calculating the specific profiles are typically much smaller than that of the non-specific probes. in addition, the specific sub-ensemble of probes is typically contaminated with contributions due to non-specific hybridization. all these factors give rise to relatively noisy profiles which still reflect properties of non-specific hybridization.

we therefore apply a different approach to answer the question whether the 1-effect extends also to specific hybridization or not. part a of fig.  <dig> plots the smoothed probe intensities of the mouse data set as a function of the expression degree which was calculated using the hook method  <cit> . this calibration approach inverts the two-species langmuir hybridization isotherm and estimates the linearized intensity-equivalent due to specific hybridization ls ) using the respective raw intensity values. the graphs in fig.  <dig> thus characterize the mean dependence of the intensity as a function of the specific transcript concentration  which is directly related to ls. these isotherms roughly divide into the n-range which is dominated by non-specific hybridization at small abscissa values; into the s-range in which the intensity is dominated by specific hybridization at large abscissa values and into the mix-range in-between, in which both, specific and non-specific hybridization significantly contribute to the observed intensity .

fig.  <dig> shows two different isotherms for the pm and mm probes each. one was calculated by averaging over all pm-  probes of the chip and the other one by selecting the respective sub-ensembles of probes containing the 1-motif. in the n-range, the intensity level of the 1-containing probes is clearly larger compared with that of all probes. the respective log-intensity increment of about  <dig>  roughly agrees with the sensitivity amplitude of the 1-motifs σ <dig> ≈  <dig>  . the difference between both types of isotherms, however, progressively decreases with increasing expression degree and virtually vanishes in the s-range.

in panel b of fig.  <dig> we plot theoretical isotherms calculated using eq.  with the substitution lp→ l = imax· as a function of the specific transcript concentration . three scenarios,  - , are considered to interpret the experimental data:  the 'reference' case with a parameter set which was chosen to fit the mean isotherms of the array averaged over all pm- or mm-probes; and scenarios  and  which aim at reproducing the behavior of the 1-subensemble. particularly, in scenario  only the value of the non-specific binding constant is increased compared with the reference case  according to  whereas the value of the specific binding constant remained unchanged  = . in scenario  also the value of the specific binding constant is increased by the same factor as kn in case , i.e.  and .

comparison of the theoretical and experimental curves clearly reveals that the intensity increment of the 1-containing subensemble is readily described by the second case  which only assumes the stronger non-specific binding of the probes. case  assumes also an increased specific binding. it clearly fails descibing the data: the inflection point of the calculated isotherms shifts to smaller abscissa values whereas that of the experimental isotherms remains roughly at the same position.

hence, comparison between measured and calculated isotherms provides no indication that specific hybridization contributes to the 1-effect to a similar extent as non-specific binding. instead they show that the 1-effect is mainly associated with non-specific hybridization.

the isotherms of the mm-probes are shown in fig.  <dig> together with the isotherms of the pm-probes. both probe types are equally affected by non-specific hybridization on the average in both considered probe ensembles. particularly, the 1-motif increases the intensity level of the mm-probes in the n-range to the same extent as that of the pm-probes. the slight shift of the mix- and s-ranges of the mm-probes towards larger expression values is caused by the weaker specific binding of the mm due to their swapped middles base which mismatches the target sequence. hence, the mm-probes virtually behave like weak-affine pm-probes with respect to specific hybridization. this difference also implies that the mean saturation intensity of the mm-probes imax is smaller than that of the pm-probes owing to post-hybridization washing  <cit> . the calculated isotherms of the mm-probes clearly show that specific binding is virtually not affected by the 1-motif by the same arguments as for the pm-probes.

the nn+ggg correction
our analysis shows that the quality of fit of sequence models is heterogeneous with respect to the selected motifs and their position along the probe sequence. the positional dependent nn model well describes most sequence-dependent intensity effects due to non-specific hybridization with the exception of motifs of three or more consecutive guanines. higher order models of rank r =  <dig> or  <dig> are able to successfully remove the associated sequence bias, however they are expensive to compute. minimization of the linear regression model eq.  provides a system of  linear equations, the solution of which requires a runtime in the order of o2). in practice, profiles with rank up to r =  <dig> can be computed in minutes per array on a standard personal computer whereas models of rank r =  <dig> and  <dig> run hours or even days, respectively.

we therefore developed a hybrid-rank model based on the positional dependent nearest neighbor approach plus additional higher order contributions for selected 'critical' motifs such as  <dig> which applies to the intensity components due to non-specific binding . the algorithm fits the nn-model of rank r =  <dig> to all probes which do not contain the critical poly-g motifs in their sequence. the intensities of probes which contain such motifs are separately fit to a nnn model of rank r =  <dig> which only considers triple-g motifs at all possible sequence positions. in general, this approach can be modified to apply to other special motifs.

fig.  <dig> compares the performance of the hybrid rank correction with that of the n and nn models using the same type of representation as in fig.  <dig> above. it clearly shows that the latter two models only insufficiently correct the 1-effect as expected. on the other hand, the systematic bias of the 1-containing probes in the non-specific hybridization range almost completely vanishes after applying the nn+ggg correction to the non-specifically hybridized probes using the algorithm described in the methods subsection below.

the residual profiles of the triple-g motifs of the three data sets used in fig.  <dig> are shown in fig.  <dig>  they clearly reveal the strong intensity excess at position k =  <dig> due to the 1-effect . the mean level of the poly-g effect affecting the remaining sequence positions is about σk ≈  <dig>  for these chips. this excess sensitivity value refers to an intensity bias of  <dig>  ≈  <dig>  compared with the nn-model. interestingly, hybridizations of encode arrays using the chipchip technique indicate a negative ggg-level throughout the sequence for k >  <dig>  it indicates an average intensity bias in the opposite direction of about 10- <dig>  ≈  <dig> .

we argued above that the chipchip targets lack g-rich primer fragments which otherwise cause the strong intensity bias due their involvement into g-stack formation on expression arrays. their absence would explain a tiny or even zero but not a negative amplitude-level of the triple-g excess sensitivity. a similar negative sensitivity effect of poly-g motifs has been found recently for snp genechip arrays  <cit> . these arrays also use genomic dna for hybridization after amplification via ligation and not via t <dig> priming  <cit> . this 'dim' effect has been attributed to g-stack formation of four neighboring probes in agreement with previous assumptions  <cit> . such probe quadruplexes reduce the amount of free probe oligomers available for the binding of specific and non-specific targets. this trend then decreases the intensity of the respective probe spots because only targets are labeled with optical markers.

in summary, the nn+ggg hybrid-rank model properly corrects the intensity bias associated with probes which contain poly-g motifs. in addition, the obtained excess ggg-profiles provide further insights into the amplitude of the effects due to degenerated guanines in different hybridizations. it changes sign and switches from positive to negative values for hybridizations which use different amplification protocols.

discussion
preprocessing of microarray intensity data
calibration of microarray measurements aims at removing systematic biases from the probe-level intensity data to get expression estimates which linearly correlate with the transcript abundance in the studied samples. the performance of different preprocessing algorithms to correct intensity data for the 1-effect are illustrated in fig. 1b by means of boxplots which roughly characterize the distribution of the expression values in terms of their median and interquartile range. the results revealed that the strong intensity effect is not removed from the expression data after standard preprocessing using several popular methods.

to get further insights we plot the density distributions of the preprocessed expression values of all  <dig>  probe sets of the mouse data set and of the sub-ensemble of  <dig> probe sets containing at minimum two probes with a 1-motif . the results indicate the systematic shift of the  <dig> sub-ensemble towards larger expression values in decreasing order for the preprocessing methods vsn  <cit> , rma  <cit>  and gcrma  <cit> . note that vsn and rma use global baseline-corrections for non-specific hybridzation which subtracts one common background value from all probe intensities of a selected microarray. clearly these approaches fail to describe the probe specifics of the 1-motif giving rise to a strong bias due to improper background correction.

fig.  <dig> also shows the distribution of the sub-ensemble of 'absent' probe sets  which have been identified using the hook method  <cit> . comparison with the other distributions reveals that the amplitude of the 1-bias decreases with increasing expression value. however, it affects not only the range of non-specific background but extends to probe sets with a significant contribution of specific hybridization. these signals are potentially used in downstream expression analysis. the right tail of the distribution is dominated by specific hybridization which has been shown to remain virtually unaffected by the 1-effect.

the preprocessing methods dchip  <cit> , gcrma, mas <dig>  <cit> , plier  <cit>  and hook  <cit>  apply probe-specific baseline correction algorithms which estimate an individual background value for each probe. the obtained distributions significantly widen, and extend towards smaller expression values offering a larger dynamic range of the obtained expression estimates. the detailed inspection of the density distributions however also reveals a small 1-bias in the left part of the distributions obtained by mas <dig>  dchip and gcrma which is dominated by non-specific hybridization. the version of gcrma used applies a positional dependent sequence correction of rank r =  <dig> similar to ours ) which is obviously insufficient to account for the 1-effect. mas <dig>  dchip and also plier explicitly use the intensities of the mm probes to estimate the non-specific background of the pm signals. pm- and mm-probes are both affected by the poly-g motifs to a similar extent which enables its effective correction by combining pm- and mm-data. finally, hook and plier almost completely remove the 1-bias from the data over the whole width of the distributions.

the shown hook distribution refers to the pmonly variant of the method  <cit>  with implemented nn+ggg sensitivity correction which neglects the intensity information of the mm probes. the so-called 'pm-mm' variant of the method also processes the intensities of the mm probes. fig.  <dig> compares the median position and the width of the distributions of expression values of different versions of the hook method in terms of boxplots. the pmonly and pm-mm standard versions apply the positional dependent nn-model. the pmonly variant only insufficiently removes the 1-bias whereas the pm-mm method provides acceptable results. this finding confirms our suggestion that the explicit consideration of the mm-intensities enables better correction of the sequence bias. the nn+ggg sensitivity model provides acceptable correction also for the pmonly version of the method.

fig.  <dig> reproduces fig.  <dig> for corrected intensity values using the nn+ggg model. panel a shows a pseudo-image of the array using the cel-file of corrected intensities. the bright stripes due to the  <dig> probes evident in fig. 1a clearly disappeared. panel b illustrates the performance of different preprocessing methods with respect to the 1-bias after applied correction. the boxplots clearly show that our correction effectively removes the 1-effect from the resulting expression values. in summary, most of established preprocessing methods only inadequately calibrate raw intensity data for strong sequence effects of the non-specific background contribution. methods which explicitly process suitable reference probes, such as the mm, perform better than pmonly methods. pre-correction of the intensity data using the nn+ggg sensitivity model removes the bias due to degenerated guanines from the data.

sequence-specific intensity corrections
the correction for sequence-specific intensity effects is a crucial step which largely affects the performance of the preprocessing of microarray data. it applies to specific hybridization  and also to non-specific hybridization as well . numerous sequence models have been developed for microarray analysis so far. they can be roughly divided into the following four classes:

 'fully' physical, Δg based approaches   <cit> : these models explicitly and in-detail consider different processes which potentially affect probe hybridization such as probe/target duplexing including their zippering, bulk dimerization of the targets or folding of target and probe in terms of effective reaction constants or statistical thermodynamics. elementary interactions are described on the level of base pairings using stacking free energy parameters which have been estimated in independent dimerization experiments of oligonucleotides in solution  <cit> . such models helped to improve our basic understanding of the functioning of microarrays and also to judge the relevance of different contributions to the observed probe intensities. these approaches often apply special fitting approaches and/or idealized assumptions to describe intensity data of selected microarray experiments . often, the used tools and algorithms however fail in practical microarray analysis because particular factors significantly affecting the performance of chip measurements are either considered in a simplified fashion or even neglected. for example, the lack of knowledge about the exact length, full sequence and concentration of the targets circumvents the detailed estimation of their folding and duplexing products. on the other hand, these 'physical' models clearly showed that microarray hybridization is in agreement with elementary physical rules of interacting probes and targets, which however take place in a complex environment owing to the attachment of probes to the chip surface and the heterogeneous composition of the target solution. the latter conclusion was also supported by the results of reverse top-down studies which extract interaction parameters on the level of base pairings from microarray intensity data. for example, the resulting intensity-based nn parameters in most cases correlate well with the respective stacking free energies of independent solution experiments  <cit> .

the present study confirms this result . in particular, we calculated the sum of all terms of the nn profiles over all  <dig> sequence positions for the selected data sets to obtain positional independent mean sensitivity estimates. the obtained integral nn terms were correlated with the respective nearest-neighbor free energies for dna/dna or dna/rna duplexes in solution which were taken from  <cit>  and  <cit> , respectively. the microarray sensitivities well correlate with the solution free energies . to judge the amplitude of the 1-effect on the integral nn terms we calculated a second data set which omits the first three sequence positions in each sum for the integral nn terms . only the values of the gg terms reduce notably in the mouse and encode data sets accompanied by a small improvement of the respective fits.

the latter result shows that global parameter estimates can mask special intensity effects associated with selected sequence motifs such as runs of guanines, which results in the poor modeling of the intensities of probes containing these motifs.

 positional dependent intensity models with freely adjustable parameters in analogy to the approach used in this study: this class of models was independently introduced by mei et al.  <cit>  and naef and magnasco  <cit>  which originally use single base terms, rank r= <dig>  shortly after the method has been upgraded to nn-terms of rank r= <dig>  <cit>  and successfully applied in different calibration algorithms for microarray data using either n-  <cit>  or nn-models  <cit> . the parameters are estimated individually for each array. the model thus accounts for the specifics of each particular hybridization which potentially varies from chip to chip due to different levels of non-specific hybridization, bulk dimerization, washing and/or saturation. all these effect are shown to modify the respective parameter profiles  <cit> . the obtained parameters are therefore called effective affinities  <cit>  or sensitivities  <cit>  depending on the special experimental setup. moreover, the model also enables to describe subtle differences between non-specific and specific hybridization on the level of base pairings, for example, due to the presence of defined mismatches in the probe/target duplexes  <cit> . the approach successfully applies to chips of different generations and types  <cit>  and it can be combined with elements of model class , for example, to account for probe and target folding  <cit>  or for special motifs and additional factors  <cit> . for example, the pioneering approach of mei et al.  <cit>  combines the positional dependent n-model with special correction terms for intramolecular hairpins and g-quadruplexes. the latter effect was separately assigned to runs of at least four guanines at the beginning, the middle and the end of the probes. here we extended the model to positional dependent triple and quadruplex motifs of rank r =  <dig> and  <dig>  our analyses show that the nn-model well accounts for most of the sequence effects except special motifs such as runs of consecutive guanines. we also demonstrated the diagnostic power of this approach to detect subtle sequence effects in terms of position and motif.

 positional dependent approaches with common 'shape functions': this class of models is closely related to the previous class . in contrast, it however factorizes the positional and motif dependent sensitivity profiles into two independent contributions namely into positional independent but motif specific 'energy' terms and into a positional dependent but motif independent 'shape'-function common for all motifs. this so-called pdnn  model was originally introduced by zhang et al.  <cit> . it is used with modifications in different algorithms and applications  <cit> . the common shape function of the pdnn model considerably reduces the number of adjustable sequence parameters by nearly one order of magnitude and consequently also the computational effort compared with the nn-model with motif specific profiles  +  <dig> =  <dig> pdnn-parameters versus  <dig> nn-parameters, see eq. ). it has however to be asked whether the common shape function adequately reflects the positional dependence of the individual nn-profiles? the inspection of the plots in figs.  <dig> and  <dig> suggests, for example, that the shape of guanine-rich profiles strongly deviates from the shape of other motifs owing to the 1-effect. for a systematic evaluation we make use of the nn-model with adjustable positional sensitivities of class  and compare all pairwise combinations of the  <dig> sensitivity profiles using a simple similarity metrics based on the least squares optimization of a scalable factor a and a shift-term c,   

here b <dig> and b <dig> denote two selections from the  <dig> nn terms. the similarity matrix  indeed reveals that the profile of gg-sensitivities poorly matches the remaining profiles, except tt . bad or only moderate agreement is also observed between the profiles of other nn-motifs such as cc, aa and tt. the similarity matrix of the nnn-profiles of rank r =  <dig> reveals a similar picture with poor matches especially for ggg motifs and partly also for ccc and ccg . hence, the assumption of a common shape fails for selected motifs.

iv) multichip statistical models: these approaches decompose each probe intensity into independent factors due to probe and chip effects. the former factor is assumed to be invariant for each probe in a series of arrays and thus models the respective sequence-specific affinity of the probe. the latter factor is assumed to describe the expression index which usually varies between the chips. the relation between intensity and expression index is either linear  or hyperbolical assuming a langmuir isotherm . the parameters are estimated by fitting the model to the intensities of a series of, at minimum,  <dig> -  <dig> arrays. the approach has the potential to correct the intensities for any probe effect because each probe is handled individually without explicitly processing its sequence in terms of a sequence model as in the alternative approaches of classes  - . on the other hand, chip and probe effects are not independent in real situations due, e.g., to different levels of bulk dimerization and other effects . more importantly, the probe-related affinity correction of the multichip methods in most cases applies to specific hybridization only whereas the non-specific background is corrected using simpler approaches such as global background  or n-profiles . hence, the performance of the method largely depends on the type of background correction .

note that dchip and nlfit assume a probe dependent background which partly removes the the 1-bias from the data .

we conclude that hybrid models of class  are conceptually best suited to account for special sequence effects in single-chip based calibration algorithms for microarrays which use a high number  of short  oligonucleotide probes such as genechips. here the large number of intensity values allows successful fitting of hundreds model parameters. possibly, the performance of models of this class can be further improved using amendments taken from physical models of type , e.g. to consider the folding propensity of the targets and/or their length. the non-linear approach  <cit>  offers an interesting option of models of class  because it allows to apply adequate hybridization laws beyond the linear approximation in combination with sophisticated affinity corrections. its multichip character, however, adds normalization tasks to consider variations between different hybridizations which might produce biased expression estimates  <cit> . models of class  must be complemented with special terms to account for special sequence effects deviating from the mean positional dependence of the array. with this amendment they represent an interesting choice for array-types using long oligonucleotide probes  because it requires fitting of a reduced number of positional parameters compared with models of class .

CONCLUSIONS
we analyzed the specifics of probe intensities on the level of short motifs of one to four adjacent nucleotides along the 25-meric probe sequence using positional dependent sensitivity models. the decomposition of the fit statistics into motif- and positional dependent contributions reveals that most of the motif-specific terms are adequately described using a nearest-neighbor model. in contrast, runs of degenerated guanines require explicit consideration of next nearest neighbor terms for adequate fitting. longer runs of at minimum three consecutive guanines along the probe sequence and especially triple degenerated g at its solution end typically cause exceptionally large probe intensities on expression arrays. this intensity bias affects pm- and mm-probes to a similar extent. our analysis clearly shows that this effect is associated with non-specific hybridization. hence, the interpretation of the extraordinary strong signals of probes containing runs of degenerated guanines in terms of high expression levels of the respective genes seems not justified.

the 1-effect tends to increase gradually for microarrays of later genechip generations. it was detected for hybridizations which use dna/rna as well as dna/dna probe/target-chemistries. different amplitudes of the guanine effect were found for hybridizations which apply different amplification protocols. in particular, the t <dig> amplification step for sample messenger rna is associated with strong amplitudes of the guanine effect whereas amplification protocols for genomic dna lacking t <dig> priming behave differently.

the origin of the very strong 1-effect is unknown. its association with the t <dig> protocol however implies that the t7-amplified targets containing the g-rich primer fragments are prone to form mixed probe/target g-stacks via association with g-rich probe motifs. this effect in combination with the large concentration of g-rich targets in the hybridization solution then would facilitate their strong binding to g-rich probes resulting in their strong intensity. the absence of these g-rich target motifs in the chipchip hybridization possibly explains the much smaller intensity of the respective 1-probes compared with the encode hybridizations. this hypothesis requires further verification using, e.g., methods developed in  <cit> .

established preprocessing methods only insufficiently remove the guanine bias from data. methods which explicitly process the intensities of the mm probes as suitable references perform better than pmonly methods. we propose a positional dependent nn+ggg hybrid-rank model to correct the intensity bias associated with probes containing poly-g motifs. it can be applied prior to established preprocessing methods in a pre-correction step. the positional and motif dependent sensitivity models are conceptually best suited to account for special sequence effects in single-chip based calibration algorithms for microarrays which use a high number of short oligonucleotide probes such as genechips.

the structural rationale behind the guanine effects has been concordantly assigned to the propensity of degenerated g motifs to arrange into of stable stacks of guanine tetrads which bundle four oligonucleotide strands into molecular quadruplexes  <cit> . these structures potentially affect the efficiency of oligonucleotide synthesis and/or the hybridization of the probes to their target sequences accounting for the abnormal performance of g-runs on the array  <cit> . upton et al.  <cit>  suggested a mechanism which increases the intensity of poly-g containing probes via the local opening of regions in the vicinity of quadruplexes formed by adjacent probes.

alternatively one can assume that g-rich probes form g-quadruplexes of different stoichiometry which involve either exclusively adjacent probe oligonucleotides or also non-specific targets containing longer runs of guanines. we suggest that t <dig> amplification contaminates the targets with g-rich primer fragments which drastically increase their propensity to form such mixed probe/target g-quadruplexes. this model predicts that the large concentration of g-rich targets in the hybridization solution gives rise to their strong binding to g-rich probes which finally causes their strong intensity. the absence of these g-rich motifs upon hybridization of genomic dna then explains the much smaller intensity of the respective probes. the more detailed analysis of the structural rationale behind the guanine effect in terms of physical models is beyond the limits of this publication and will be given elsewhere.

