BACKGROUND
to date, about  <dig> bacterial genomes have been fully sequenced. although these sequences provide us with a wealth of information, the functions of the products of many of the genes they contain have yet to be characterized. development of methodologies that can predict their function is an important goal for bioinformatics. the most widely used methods for protein function prediction are based on the detection of homologies via sequence alignments. these approaches are often insufficient, however, as many proteins have no functionally characterized homologs. moreover, it is not possible to completely define the function of an isolated protein as function depends intimately on contextual information such as interactions, pathways, and cellular localizations.

functional characterization of proteins using phylogenetic profiles has emerged as an important technique during the past few years  <cit> . a phylogenetic profile is a { <dig> }-vector that is assigned to each protein within a genome and whose elements indicate the absence and presence of homologs of the protein in other genomes . the underlying assumption of methods that utilize these profiles is that proteins that function together tend to co-occur across organisms. thus, clusters of proteins with similar profiles correspond to pathways and complexes, and participation in such a cluster may be used as evidence that an uncharacterized protein shares this function.

various metrics have been used to quantify similarity between two phylogenetic profiles, including hamming distance  <cit> , probability of matches using the hypergeometric distribution  <cit> , and mutual information  <cit> . however, these metrics do not consider the underlying phylogeny of the genomes in the profile. as figure  <dig> suggests, there is ample reason to believe that accounting for phylogeny should improve our ability to detect truly co-evolving genes  from those that are merely present in a subset of related genomes .

in contrast to these approaches, another class of methods has been developed to account for genome phylogeny when scoring profile similarities  <cit> . these approaches reconstruct phylogenetic trees and estimate gene loss and gain events at branch points to identify proteins that appear to co-evolve. these methods are more complex and computationally expensive than those of the previous paragraph. for this reason, significant computational resources are required to apply these methods to all-versus-all comparisons of proteins in bacterial genomes. as a result, we set out to develop a heuristic approach that is computationally more efficient than existing full tree-based methods and yet partially accounts for phylogenetic relationships among organisms when scoring profile pairs.

our approach involves two components. the first computes the probability of two profiles having a certain number of matches using an extension of the hypergeometric distribution that accounts for the number of proteins in each genome. the underlying assumption is that protein pairs that possess profiles with more matches are more likely to co-evolve. the second component partially accounts for the underlying phylogeny between organisms by first ordering the genomes within the profile by their similarity. we then compute runs of consecutive matched homologs in phylogenetic profiles to distinguish between conservation across disparate species versus conservation of occurrences within clusters of related organisms. each component is described by readily computable formulae, and the two components are easy to mathematically combine to yield a single score that two particular profiles are significantly similar.

we compare our method to several previously published approaches for phylogenetic profile comparison: computing the probability of matches between two profiles using the hypergeometric distribution  <cit> , measuring the similarity of profiles using mutual information  <cit> , using a reduced set of genomes in the profile to eliminate closely related organisms  <cit> , estimating profile similarity while accounting for genome occupancy  <cit> , and estimating similarity by using likelihood ratios to compare two maximum-likelihood models of gene evolution using a full phylogenetic tree  <cit> . we compare these approaches by measuring how often proteins in significantly similar profile pairs share the same gene ontology  terms  <cit> . we demonstrate that our method compares favorably to these other approaches in terms of both performance and computational efficiency.

in conclusion, we have developed an efficient method to account for genome phylogenies when computing phylogenetic profile similarities. we show that this approach improves our ability to reconstruct various pathways and complexes, including, as an example, the subunits of nitrate reductases. in the future, we plan to incorporate this new methodology into the prolinks database  <cit> .

RESULTS
we began with previously computed phylogenetic profiles constructed from  <dig> genomes  <cit> . these profiles had been computed for each reference organism using blast  <cit>  to define the presence and absence of homologs across the genomes. in this paper, we focus our analysis on the approximately  <dig>  genes of the genome of escherichia coli k <dig> as they have the most comprehensive annotations and therefore allow us to more accurately assess the performance of methods. however, there is no reason to expect that the results are specific to e. coli, and we therefore expect the method to perform well if any of the fully sequenced genomes are used as reference.

we computed the similarity of phylogenetic profiles using pairwise scores for each possible pair of distinct proteins in e. coli. we compared several different metrics for computing the significance of the similarity between two given profiles. the first is the p-value for the number of matches  between two profiles being large as computed from the appropriate hypergeometric distribution  <cit> . the underlying assumption is that more matches between two profiles correspond to an increased likelihood that two proteins co-evolved.  this approach assumes that all positions in the profile are equally likely to be populated by 1's  and that the order of the positions in the profile does not matter . hence, phylogenetic relationships between the organisms that make up the profile are not considered in this first method. the second approach utilizes mutual information to estimate profile similarity  <cit>  and is very similar in practice to the first method.

a slightly more sophisticated approach involves a weighted hypergeometric distribution to estimate the number of matches  <cit> . this approach accounts for the different size of each genome by assigning a probability, or weight, of occupancy at each position in the profile.  genomes highly similar to the reference genome have weights near  <dig> while those more distant from it have lower weights. weighted p-values reduce to unweighted p-values when all the weights are the same . as with the previous two methods, however, this does not account for phylogenetic relationships between organisms.

the fourth approach begins to consider phylogeny by utilizing only a reduced set of genomes in the profiles in order to remove highly similar organisms that might confound the comparisons  <cit> . for this, instead of the full 214-dimensional profile vectors, we used only  <dig> organisms by selecting a single representative genome from groups of highly related taxa .

the fifth and final approach we compare against estimates co-evolution between two proteins based on gains and losses on a full phylogenetic tree  <cit> . in this approach, two models of evolution are compared, one model having the two proteins co-evolve and the other having them evolve separately. for each pair of profiles, maximum likelihood point estimates of several parameters describing gene loss and gain rates are determined and then the likelihood ratio of the two models is used as the statistic for the gene pair. a detailed description of this sophisticated approach is beyond the scope of the present paper and may be found in the original publication. due to the high computational cost of applying this approach to our data using the software provided by the authors, we computed likelihood ratios for only a random sampling of  <dig>  go-benchmarkable pairs of proteins  rather than for all  <dig> , <dig> pairs  in all the other methods. with approximately 5– <dig> cpu seconds required per pair on a contemporary pc, a complete all-versus-all run of this method requires more than  <dig> cpu year whereas a full run of the other methods  can be done in under  <dig>  cpu minutes each. hence, this last method is many orders of magnitude more expensive to compute than any of the others.

we compare the five approaches above to a sixth developed here that combines a weighted hypergeometric p-value with a penalty that is a p-value for the number of "runs" being unusually small. the weighted hypergeometric p-value is the same as that described above . the second scoring component is the probability of having the observed number of runs or fewer in the overlap vector. a run is defined as a maximal non-empty string of consecutive occupancy matches between two profiles. an example is provided in figure  <dig>  genes  <dig> and  <dig> share four organisms distributed over three runs, while genes  <dig> and  <dig> also have four matches but only in a single run. we hypothesize that given the underlying phylogenetic tree shown in figure  <dig>  the matches between genes  <dig> and  <dig> are less likely to occur by chance than the ones between genes  <dig> and  <dig>  the reason is that more events are required to account for the pattern seen between genes  <dig> and  <dig>  and, hence, these two genes are more likely to be truly co-evolving and thus related functionally.

the number of runs depends on the ordering of genomes within the phylogenetic profiles. we attempted to establish an ordering that reflects the evolutionary relationships among the organisms. to this end, we first constructed a genome-genome distance matrix based on the phylogenetic profile data itself. if one encodes the phylogenetic profile data as a { <dig> }-matrix whose rows are the proteins and whose columns are the genomes, then the genome phylogenetic profiles are the columns. given their genome phylogenetic profiles, we use jaccard dissimilarity  to measure distance between two genomes.

to identify a good ordering of genomes, we perform hierarchical clustering of them using the genome-genome distance matrix of the previous paragraph. this process generates a dendrogram that represents the evolutionary relationships among organisms  <cit> . however, naïve hierarchical clustering is only topological and there remains ambiguity about the ordering of genomes because at each non-leaf the left and right subtrees may be exchanged or "swivelled." to optimize swivels, we use dynamic programming to minimize the sum of squared distances between adjacent genomes across the leaves of the dendrogram  <cit> . 

having computed a good ordering of genomes, we next compute the probability of obtaining an equal number of or fewer runs than the number actually observed. details are summarized in the methods section and fully explained in additional file  <dig>  in our final model, we combine the weighted hypergeometric p-value with our p-value for the number of runs by dividing the former by the latter . this simple combination was found to work well in practice. as described in additional file  <dig>  our methods permit the incorporation of numerous additional terms into this combination, but we feel this basic two-term model is simple, achieves good performance, and has intuitive appeal.

the relative performance of methods is evaluated using go annotations  <cit> . go is organized into three separate ontologies: cellular compartment, biological process, and molecular function. we use the first two ontologies to evaluate protein pairs since similarities in molecular function are largely determined by conventional sequence alignment-based methods. each ontology is organized as a directed acyclic graph . very general terms at the top are parent terms for more specific terms deeper down in the ontology. the genes themselves are among the leaves of the dag. in each of the ontologies, any two proteins always share at least one term  as long as both have at least one annotation to the ontology. however, proteins with closely related functions will share at least one very specific term while those with only distantly related function will share only more general terms. to determine the functional similarity between two proteins, we therefore compute the probability that the highest specificity of their common terms is as high as it is, as described in detail in methods.

to test the performance of a metric, we compute the cumulative average log <dig> go p-value as we move down the list of protein pairs in the metric's rank order.  as shown in figure  <dig>  we see that our method incorporating runs outperforms both the weighted hypergeometric and the unweighted hypergeometric methods as well as the much more computationally expensive full tree-based method. in particular, we note that the top  <dig>  pairs are significantly more similar in their go terms when we account for runs.

to further analyze the effect of including runs in our analysis, we compared the top  <dig>  pairs generated by the pure unweighted hypergeometric and by the runs-using methods. first, we note that of  <dig>  pairs,  <dig>  are in common while  <dig>  are not, indicating that the resulting networks are significantly different. more importantly, we observe that the distribution of edges in the two networks is quite different. in figure  <dig>  we see that while the pure hypergeometric network contains many nodes with  <dig> or more edges, the runs-informed network has almost none. this is consistent with the pure hypergeometric network containing very large clusters of linked proteins while the runs-informed network is broken down into smaller clusters. this is significant because large clusters are not very useful for functional studies since they bring together proteins with a broad range of functions. in contrast, small clusters can contain proteins with well-defined functional relationships.

as an example, we focus on a small cluster of proteins shown in figure  <dig> that are found in the runs-informed network but not in the pure hypergeometric network. the cluster contains many subunits of two nitrate reductases: narg and narz are the alpha subunits of nitrate reductase i and ii, respectively; nari and narv are the gamma subunits; and narj is the delta subunit. we see that while the number of genomes that contain all these proteins is relatively small , they are scattered positionally throughout the profiles and form many runs . it is clear that these proteins do indeed belong together as they are subunits of a protein complex that catalyzes the reduction of nitrate to ammonia. we also note that the cluster contains two distinct complexes, nitrate reductase i and ii, that are highly homologous. this inability to separate homologous or parallel complexes is one limitation of phylogenetic profile analyses that we have noted in the past  <cit> .

a final example of the different performance of the pure hypergeometric metric versus the runs-based approach is shown in figure  <dig>  here we have selected  <dig> pairs of proteins whose profiles are significantly similar according to the pure hypergeometric criterion but not according to the runs-based method. as expected, we see that most of the matches between these pairs are clustered in just a few runs, thus explaining the difference in significance as computed by the two methods. further, most of these pairs do not appear to be biologically relevant. many of the pairs involve secb, a molecular chaperone involved in protein export. this protein is paired with the nucleotide hydrolase ygdp, the cmp-3-deoxy-d-manno-octulosonate transferase kdsb, and several hypothetical proteins. although we cannot know for sure, it does not seem likely that most of these proteins share a functional relationship with secb. as a result, this example illustrates how pairs of proteins with few runs are less likely to be functionally related.

discussion
there are three general classes of metrics that may be used to compare two binary phylogenetic profiles. the first class is insensitive to the underlying phylogeny of organisms and treats each position in the profile completely independent of the others. members of this class of metrics are highly represented in the literature  <cit>  and are very straightforward to implement. however, these metrics suffer significantly from their underlying assumptions, especially as the number of genomes in the profiles increases.

the second class of metrics assumes that the underlying organismal phylogenetic tree is known and takes advantage of this prior knowledge when computing profile similarities. several examples of this kind of approach have been described in the literature in the past few years  <cit> . although these approaches have been shown to outperform the first type of metric, they do so at considerable computational expense. furthermore, they depend critically on the prior tree, which is only suggestive of historical fact .

the third class of metrics is represented by our heuristic approach that considers only an ordering of genomes and not a full phylogenetic tree. we have shown that this approach is superior to the first type of metric as one might expect and can even outperform the second class of approaches. another advantage is that our approach is intermediate in conceptual complexity between the first and second class of metrics. most significantly, and in contrast to the full tree-based methods, the computational requirements of our approach are modest, and therefore it is suitable for large-scale applications in which hundreds of millions of profile pairs need to be compared. as a result, we believe that the approach described here represents an appealing solution to the problem of phylogenetic profile comparison.

CONCLUSIONS
genomic sequencing is advancing at a remarkable pace as new technologies supplement traditional approaches  <cit> . the number of sequenced organisms, now standing at about  <dig>  will undoubtedly reach into the thousands in a short time. this deluge of data presents us with several challenges and opportunities. one challenge is to understand the function and interrelationships among the proteins coded within these genomes. the opportunity is to develop a new generation of computational approaches that allow us to accomplish this without using expensive and time-consuming experimental techniques.

phylogenetic profiles are one of the approaches aimed at this goal. phylogenetic profiles now represent a fairly mature approach for determining protein function when traditional homology-based techniques fail. nonetheless, current implementations of the technique are either overly simple and do not account for organism phylogenies or overly complex and require very significant computational resources to implement on a large scale.

here we have presented a third type of approach that measures similarity between phylogenetic profiles given only an ordering of organisms and without knowledge of the tree. although the "correct" ordering among organisms within a profile cannot be known exactly, we have shown that easily constructed orderings allow one to significantly improve the performance of phylogenetic profiles compared to naïve approaches and reach a performance that is superior even to that of full tree-based approaches. as the number of available genomes increases, using approaches such as this one will be critical for effective use of phylogenetic profiles and will bring us closer to the goal of developing efficient and accurate methodologies for inferring protein functions from sequence data alone.

