BACKGROUND
the development of reliable methods for de-novo protein structure prediction remains a challenge  <cit>  even for small proteins. heuristic methods, which dominate protein structure prediction contests  <cit> , can generate accurate models  <cit> , but often lack the ability to reliably identify near-native conformations  <cit> . folding simulations using accurate biophysical models demonstrate agreement with experimental investigations  <cit> , but remain limited to small proteins by their large associated computational cost. we have developed an all-atom free-energy forcefield  <cit>  to describe the protein folding process. in our folding studies we exploit the thermodynamic hypothesis  <cit> , which stipulates that many proteins in their native configuration are in thermodynamic equilibrium with their environment. based on this paradigm the native conformation of a protein can be predicted as the global optimum of its free energy surface  <cit> . since the free-energy landscape of naturally occurring proteins is thought to have a funnel-like shape  <cit> , stochastic search methods are guided by the overall gradient towards the global optimum of this landscape. using a variety of different stochastic optimization methods we were able to demonstrate the reproducible and predictive folding of several proteins, including the trp-cage protein   <cit> , the villin headpiece  <cit> , the hiv accessory protein   <cit> , and the bacterial ribosomal protein l <dig>  <cit>  with  <dig>   <dig>   <dig> and  <dig> acids respectively.

while these studies demonstrate the feasibility of all-atom protein structure prediction from random initial conformations, the numerical effort for a predictive simulation still increases steeply with system size. the numerical effort for a predictive simulation increases from about  <dig> cpu days  for a protein with  <dig> amino acids to about  <dig> cpu days for  <dig> amino acids  <cit> . in an alternative, widely pursued approach  <cit> , protein structures are assembled de-novo according to heuristic principles, such as local sequence homology  <cit>  and then ranked with either knowledge based or forcefield based scoring functions  <cit> . heuristic decoy generation eliminates the need to the sample the entire conformational space of the protein or to reconstruct the folding pathway. because large decoys sets of protein-like conformations can be generated much faster than by sampling the free-energy landscape, the decoy selection approach makes it possible to predict the native conformation of proteins that are too large to be folded from completely random initial conformations. of particular interest in this regard are decoy sets that are generated from a completely orthogonal philosophy from folding, e.g. methods that assemble the protein from fragments obtained from local homology or other sources  <cit> .

the goals of this investigation are therefore twofold: first test the accuracy of the free-energy forcefield pff <dig> for proteins that are too large and too complex to fold from random initial conformations. if we find near-native decoys are lower in free-energy than all other conformations, the forcefield is accurate enough to fold the protein. since it is impossible to generate completely exhaustive decoy sets we use  <dig> proteins of the latest rosetta all-atom decoy library as a reference  <cit> . these decoy sets were generated specifically for the purpose of forcefield-assessment and help us to obtain an unbiased assessment of the "universality" of the forcefield.

secondly we develop and validate a protocol, free-energy relaxation, to select the native protein structure from large libraries of protein conformations generated by a heuristic method. free-energy relaxation could be used for protein structure prediction either as a stand-alone method, or as a post-scoring approach for existing techniques. because no fundamentally new conformations are generated in the relaxation protocol, a prerequisite for success is the existence of some near native conformations in the decoy set. this investigation deals only with the validation of a suitable selection protocol, not with the generation of exhaustive decoys sets. our approach will therefore fail for proteins where the decoy set contains an insufficient number of near-native conformations. an overall assessment of the viability of the free-energy relaxation approach for protein structure prediction would additionally require an independent assessment of the likelihood of the decoy-generator to propose near-native decoys.

RESULTS
we investigated  <dig> small proteins  without any stabilizing ligands  <cit>  . the proteins have all-alpha , alpha-beta  or only beta  secondary structure and cover many distinct structural families. previous investigations ranked the decoys and found significant enrichment by several independent descriptors  with z-score ranging from - <dig> to - <dig>  <cit> . the z-scores using the original rosetta energies were reported to be poor, indicating that the development of a scoring function to select near-native decoys from this set poses a significant challenge  <cit> .

the lowest z-scores were reported for side-chain lennard jones interactions, favoring compact structures and side-chain hydrogen bonding. neither main-chain hydrogen bonding, nor coulomb interactions, nor a wide range of implicit solvent models resulted independently in very low z-scores  <cit> . the pff <dig> forcefield  <cit>  integrates exactly such components  but balances them in a fashion that was demonstrated to be highly selective for at least some small proteins. here we investigate the question whether this unique combination is transferable to a larger protein test set and able to select near-native conformations of these independently generated decoy sets. use of all applicable decoys of a protein library generated by an alternate approach ensures that the investigation is not biased towards proteins particularly amenable to relaxation with pff <dig> 

decoy ranking
free-energy relaxation scores the decoys in the set according to their energy in the forcefield pff <dig> without major structural changes. since this approach can only succeed for decoy sets containing near-native conformations we have subdivided the protein targets into two families:  <dig> high-quality decoy sets containing at least 10% near-native conformations and  <dig> low-quality decoy sets which contain few or no near-native decoys. throughout this study we define near-native conformations as those with a cα root mean square deviation  of less than  <dig>  Å to the native conformation, commensurate with the characteristic resolution of the decoys  <cit>  . this measure is commensurate with the quality of the near-native conformations that we find in our folding studies  <cit> , which typically converge to about 3– <dig> Å cαrmsd, owing to the use of an implicit solvent model. implicit solvent models, which are required to estimate the solvent contribution to the free energy of a protein conformation, tend to degrade the accuracy of the simulated native ensemble in comparison to explicit water simulations. as a result, we cannot expect the resolution of the forcefield to be better than 3– <dig> Å cαrmsd in the present relaxation protocol. conformations generated from all-atom models are not trivially transferable from one theoretical model to another. in order to obtain a meaningful energy estimate each of the decoys must be relaxed in the new forcefield to a nearby local minimum. we pursued a low-cost approach , which places the emphasis on the quality of the initial decoy, rather than on the generation of long trajectories that independently sample the conformational space. in such a rapid energy relaxation decoys will not move far from the starting configuration, but will significantly change their energy . the relaxation process leads to a reordering of the decoys and a substantial enrichment of the low-energy subset with near-native decoys. due to the stochastic nature of the annealing process the final energy of each of the decoys samples a probabilistic distribution in energy and cαrmsd, the lowest energy decoy must not be a near-native one .

for  <dig> of the  <dig> high quality decoy sets near-native conformations rank among the  <dig> best conformations ; for ten proteins the native conformation is selected solely on the basis of its energy . even for the proteins with non-native lowest energy decoys the low-energy ensemble is significantly enriched with near-native conformations . a failure to find a native decoy as the lowest energy conformation can have two sources: either it is a failure of the free-energy model/scoring function to identify the correct structure as the global optimum or the near native ensemble was not properly probed in the decoy generation.

forcefield selectivity
in order to discriminate between these two possibilities, we independently generated near-native conformations starting from the experimental conformation. their z-scores  average to - <dig> /- <dig>  for the high-quality/low quality decoy set .

these values are significantly lower than any reported in previous investigations on the same set of decoys using a variety of different scoring methods  <cit> . the very good values for the decoys indicate that sampling or ranking problems, rather than forcefield accuracy limit the selectivity of free-energy relaxation. 5pti is the only protein for which a positive z-score was computed, which is explained by the existence of a large unstructured region in the native conformation that is stabilized by three disulphide bridges. since disulphide bridges are not accounted for in the present version of the forcefield, it is not surprising that the relaxation protocol generates a large number of decoys with better secondary structure and hydrophobic packing. the z-score is a function both of the quality of the forcefield and of the decoy set. the z-scores for low-quality decoy sets are lower than those for high quality decoy sets.

decoy clustering
we have used a low-cost computational protocol in order to develop a method that can be applied to very large decoy sets. the best energy found in the short relaxation simulations thus depends stochastically on the moves chosen in the course of the simulation. in order to reduce such fluctuations one may either sample longer or generate several independent trajectories. while both methods may be successful they would significantly increase the overall computational cost to produce a statistically reliable reduction of the energy fluctuations.

alternatively we can exploit the fact that many decoys are available: we reduce the statistical fluctuations associated with a single short relaxation trajectory by clustering the  <dig> lowest-energy conformations for each of the decoy sets using a hierarchical algorithm  <cit> . when a unique cluster emerges during this operation , we accept the prediction as "decisive", otherwise we rate the simulation as "indecisive". just as the available experimental methods routinely fail for many proteins due to lacking crystal or signal quality, computational procedures that can 'solve' only a limited number proteins would be very helpful, provided that they contain an inherent measure of the likelihood of success. here we use the existence of a 'largest cluster' as a predictor for the decisive simulations.

applying this criterion to the high-quality decoy sets find decisive predictions for  <dig> out of  <dig> proteins. for the decisive simulations we predict near-native conformations  for all but one protein. the single prediction failure  occurred for a dimeric protein. on average the cαrmsd differs by just  <dig>  Å from the experimental conformation. in some cases we approach experimental resolution. three of the four prediction failures are marked as correctly indecisive, indicating that the prediction protocol is able to differentiate between prediction success and failure based on an inherent criterion. following this protocol correct predictions are achieved in 90% of the decisive simulations . figure  <dig> - demonstrates the impressive agreement between the predicted and the experimental conformation for three nontrivial proteins, the presence of the correct secondary structure, stabilizing tertiary contacts and hydrophobic cores.

we have applied the same computational procedure to the  <dig> low-quality decoy sets, which contain few or no near-native conformations . not surprisingly only non-native conformations have the lowest energy for all of these decoy sets, but near-native decoys still rank high in the decoy set. applying the same clustering technique as above, we obtain correct predictions in three of the six decisive cases. the prediction failure for 1hyp is explained by the presence of four disulphide bridges not accounted for in the model and 1csp is an all-beta protein that is problematic to treat with pff <dig>  in addition we find one accurate prediction  that is labeled as indecisive. the quality of the models for representative difficult cases is illustrated in figure  <dig> -, which demonstrates a still significant similarity of the tertiary structure of the models and the experimental conformations. for most of the low-quality decoy sets differences between the model and the biologically active unit are responsible for the prediction failure. the existence of the many of the correct long range native contacts in the predicted structures is demonstrated in the cβ-cβ distance difference matrices shown in figure  <dig>  tertiary contacts are characterized by comparing the difference in distance between pairs of amino acids of two conformations, which correspond to the noe signals in nmr experiments. in the figure we show the cβ-cβ distance comparison between the model and the experimental conformation for the proteins shown in figure  <dig> 

discussion
in order to put these results into perspective we have investigated the enrichment of near native decoys in each decoy set. we computed the fraction of near native  conformations in the top  <dig> decoys that were used for clustering using the free-energy criterion and the cαrmsd to the native conformation as ordering criteria . the latter fraction is a measure of the quality of the decoy set: it approaches one when a sufficient number of near native decoys is present. the first fraction is a measure of the selectivity of the free-energy relaxation protocol. correct predictions are obviously rendered in those cases where all lowest energy decoys are near-native  and in those cases, where near-native decoys dominate the top  <dig> configurations . the clustering scheme gives acceptable predictions even when only 30% of the low-energy decoys are near-native , but routinely fails when the selectivity of the forcefield is insufficient . there is clearly room for improvement in the clustering protocol, because some decoys with a relatively large number of top-scoring near-natives nevertheless fail to generate near-native predictions . for the low-quality decoy sets there is a strong correlation between the fraction of good decoys and the success of the approach. even when the fraction of near-native decoys in the decoy-set drops below 10%, a relatively small number of selected near-natives is sufficient to obtain a near-native prediction. this observation indicates that a search for improved relaxation protocols may help to reduce the required fraction of near-native decoys for a successful prediction below 10% of the overall database.

this observation is also supported when we analyze the top decoy of each decoy set by a variety of measures. following the analysis of tsai et.al.  <cit> , we show the number of proteins for which the top conformation is selected by various scoring methods . ranked by cαrmsd we find that about half of the decoy sets contain at least one decoy with a cαrmsd of less than  <dig>  Å. none of the scoring functions is capable to find this single 'needle in the haystack'. if we look at the error range of 3– <dig> Å cαrmsd, which is commensurate with our folding simulations  <cit> , the relaxation/clustering technique is far superior to any of the other indicators investigated here. the next best scoring function is the lennard-jones energy as was reported previously  <cit> . in comparison, many other indicators that are believed to correlate highly with 'nativeness', such as the existence of secondary structure , solvation terms or sidechain electrostatics, are much less selective. this selectivity of the lennard-jones interaction is presently not understood, because the lennard-jones energy gives only a small contribution to the overall 'folding' energy in our folding simulations. we hypothesized that lennard jones interactions simply measure 'compactness' and ranked the decoys by their radius of gyration as a similar measure. however, the radius of gyration emerged as a much less sensitive measure. the lennard-jones energy also does not remove many clashing conformations, because the decoy sets are of very high quality with regard to steric hindrance. the data compilation with the rosetta scoring function leads to a highly preselected set of conformations, which might bias the results. our observation might be explained by the fact that many decoys are already near-optimal with respect to the other energy terms, so that the lennard-jones term emerges with higher selectivity than with a set of random conformations. we have repeated the analysis also by analyzing the best cαrmsd of the top five decoys in each category to reduce possible scatter and find the qualitatively the same results . the fact that total energy and clustering technique are by far the most selective indicates that it is the combination of terms in the forcefield which results in the high overall selectivity of the method. this is also confirmed by comparing our results with those of rosetta. we have scored all the proteins with the original rosetta  <cit>  scoring function and applied the same clustering techniques as described above . we find that the present method leads to a significant improvement of the cαrmsd for all but one decoy set with decisive predictions. it is therefore the combination of a powerful method for decoy generation in combination with the additional selectivity provided by the all-atom forcefield that generates the high-selectivity of the relaxation approach.

we have also computed the logpb <dig> and logpb <dig> values that were used to characterize the selectivity of the density scoring/self-rapdf function in a recent investigation using the same decoy set  <cit>  . we find average values of- <dig>  for logpb <dig> and - <dig>  for logpb <dig> respectively, which compares with - <dig> /- <dig>  for the density scoring function and - <dig> /- <dig>  for self-rapdf for the same subset of decoys. the ranking of native conformations per se is not important for structure prediction since it may not be an indicator of how well a function can select near-native decoys. in other words, it is relatively easy to design functions that discriminate the native conformation from a set of decoys, but hard to design functions that can discriminate near-native decoys from other decoys. this scenario applies exactly here: as table  <dig> demonstrates, self-rapdf works very well to select the best decoys from decoy sets that contain a significant fraction  of near-native decoys by our definition, while the present protocol may rank the energetically best decoy comparatively badly in a set of only good decoys. due to the inherent limitation of its resolution, pff <dig> is not a good forcefield for the second purpose, we obtain therefore comparatively bad logpb1/ <dig> values for very good decoy sets. if instead we focus on the selection of near-native decoys from decoys sets with large non-native fractions, the present protocol outperforms self-rapdf. in table  <dig> we have marked the decoy sets where a given method select at least one near native decoy in the top ten. using this selection criterion, we find that pff <dig> succeeds in 78% of the cases, in comparison to 50% for self-rapdf. the approach pursued here is useful to select low-resolution decoys from complex decoy sets, which contain many non-native competitors, with high probability  <cit> .

CONCLUSIONS
we have investigated a straightforward all-atom energy-relaxation protocol for protein structure prediction. we scored all conformations in a given decoy set using our all-atom forcefield ppf <dig> after a rapid relaxation procedure, followed by a hierarchical clustering of the  <dig> top-scoring decoys. we label a relaxation as "decisive" if the lowest energy cluster is at least 20% larger than any other.

with this approach we have succeeded to assign all-atom tertiary structure to 78% of the proteins  investigated in this study with an average cαrmsd of  <dig>  Å. exploiting the inherent success criterion of our approach a near-native conformation was predicted in 90% of the decisive relaxation simulations. this high degree of success is rationalized by the high selectivity of the forcefield. we find an average z-score of- <dig>  for independently generated near-native conformations with respect to the decoy sets. pff <dig> stabilizes the native conformation of all but one protein against the decoys in the data set. the protocol investigated here has a success threshold of about 10% of native decoys, but appears to succeed at least occasionally for lower native content of the decoy set. further improvements in the forcefield and the relaxation protocol may be able to push the required fraction of native conformations to even lower values.

the accuracy of the predicted structures appears to be limited 3– <dig> Å by the resolution of the present free-energy forcefield. this resolution is comparable to that of our folding investigations and commensurate with other folding studies using implicit solvent forcefields  <cit> . in order to improve the accuracy further, one can either design all-atom explicit water protocols that start from the predicted structures or rank families of near-native conformations by knowledge based scoring functions such as self-rapdf  <cit>  that are more selective in the near-native conformational space.

energy relaxation emerges as a powerful low-cost approach  toward generic de-novo protein structure prediction. it can be applied to large all-atom decoy sets of any origin and requires no preexisting structural information to identify the native conformation. we have confined the present investigation to the rosetta decoy sets, because the computation of selectivitiy indicators  or the success rate for prediction obviously depend on the methods by which the decoy sets were generated. the rosetta decoy set was explicitely generated for forcefield validation with one coherent protocol and thus gives comparable results for a wide range of structurally distinct small proteins. in addition, the protocol investigated here is based on a generic, publically available technique and can thus be used as the basis of a protocol for protein structure prediction in the casp competition. other decoy sets , which contain also larger proteins, will be investigated in future studies. we stress that only one of two important ingredients to protein structure prediction, the ability of the relaxation protocol to select near-native conformations for diverse decoy sets, was investigated here.

