BACKGROUND
surface-enhanced laser desorption/ionisation  time-of-flight  mass spectrometry  <cit>  allows one to scan the proteome of a biological sample. the sample, e.g., purified serum, is applied to a spot on a chip and repeatedly irradiated by a laser, which causes peptides contained in the sample to desorb from the spot and become ionised , which is crucial for the subsequent process of mass-separation and detection.

the used laser beam has, depending on the machine model employed, either an elliptical or round shape. in any case, its size does not allow for a full coverage of the complete spot in one go. therefore, in order to cover most of it, the laser probes different positions of the spot, resulting in sub-spectra  for each location. by default, a final spectrum is constructed by summing over all sub-spectra, which is then presented to the user.

the individual sub-spectra however, contain a wealth of information, that is normally missed by studying full spectra only. this includes information on spatial differences between sub-spectra, such as the total protein and matrix material content and the amount of noise, which all can vary considerably between sub-spectra due to, e.g., inhomogeneity of the sample and various experimental factors.

this is made more clear in figure 1b. the first two panels show sub-spectra at spot positions  <dig> and  <dig> for the mass region corresponding to the ubiquitin protein. this clearly shows the large possible differences in signal between spot positions. the third panel shows the full spectrum, resulting from averaging over all sub-spectra. indeed, here the ubiquitin peak is not significantly higher than the background.

in case of an inhomogeneous distribution of peptides over the spot, for example in the case of a low abundant peptide, taking the mean over all sub-spectra with these highly varying signal and noise levels can average out peaks, causing only the most abundant peptides to appear in the final spectrum. in additional file  <dig>  section  <dig>  we describe a simple experiment that simulates this behaviour, showing that for arbitrary signals with varying noise levels it is indeed beneficial to study them separately.

we are not alone  <cit>  in believing that the default data acquisition process is sub-optimal and that it is beneficial to analyse individual sub-spectra and combining findings afterwards. sköld et al. have also analysed sub-spectra before, mainly within the scope of imputing missing values, i.e., identifying and recovering saturated spectral peaks. our focus is on peak detection. more specifically, by analysing individual sub-spectra and combining results afterwards, we account for differences in noise levels between spot positions, decreasing the chance of losing peaks from peptides that are present in low abundance or are unevenly distributed over the spot.

furthermore, we are able to quantify the confidence of detected peaks being true positives. the analysis of sub-spectra allows us to test the significance of peaks based on their amplitude in these sub-spectra, largely eliminating the need for  parameter settings during the peak detection process.

RESULTS
the approach we take involves a low-level analysis of individual sub-spectra using wavelets, followed by a method to assess the significance of peaks detected in the sub-spectra. we show that our method compares favourably to a number of existing methods by using spectra resulting from a carefully designed spiking experiment. furthermore, we show that our method offers an implicit deconvolution of peaks through the notion of peak-bags.

analysis of sub-spectra
seldi spectra exhibit much noise, including a strong baseline effect caused by the use of energy absorbing matrix material inherent to the technology. conventionally, this baseline effect is estimated and subtracted from the data explicitly, using ad hoc baseline correction algorithms. methods based on wavelets  <cit>  model this noise implicitly, assuming its frequency and shape is fundamentally different from that of the signal.

we use the algorithm proposed by du et al.  <cit>  to detect peaks in individual sub-spectra. they use an approach based on a continuous wavelet transform. by scaling and translating a so-called mother wavelet function, a spectrum is decomposed into a 'scale space', where low scales model high frequency noise and high scales model low frequency global trends in the data. peaks can be found by identifying ridges in this scale space, corresponding to regions where the spectrum is highly correlated with the wavelet function.

this process is described in more detail in the methods section . although we consider the scale space approach taken by du et al. to be elegant, their algorithm employs a number of fairly arbitrarily chosen parameters to identify ridges as being peaks. for instance, the range and number of scales across which ridges are detected and a signal-to-noise ratio threshold. instead, we consider all ridges detected in sub-spectra to be candidate peaks and use them as input to subsequent analyses, regardless of these parameters.

peak significance
instead of using parameter-based peak-detection, we rely on a significance test for candidate peaks. the wavelet analysis yields, for each sub-spectrum, a set of identified  peak positions and amplitudes in the form of peak signal-to-noise ratios . all these single-peak amplitudes, i.e., from all sub-spectra, form a peak distribution p which roughly follows a gamma distribution . this distribution consists of both real peaks as well as a background distribution. in order to estimate the background distribution, we use an iterative procedure of removing high values, i.e., 'real' peaks, and re-fitting a gamma distribution, until we obtain a distribution q of 'noise' peaks ).

in order to assess peak significance, we aggregate the wavelet analysis results from all sub-spectra. to obtain the aggregate spectrum, we sum the sub-spectral values per m/z value across all sub-spectra . the significance of one particular m/z position is assessed by comparing the value in the summed peak spectrum to a null distribution, yielding a p-value. this null distribution is the probability density function associated with the random variable which is obtained by summing n  random variables distributed according to q. in other words, this null distribution is a summed sampling distribution of q, denoted qΣ. please refer to the methods section  for a more elaborate discussion on this procedure.

mass spectrometers suffer from a limited mass accuracy. to account for small deviations in peak positions across sub-spectra, we extend the significance test to multiple m/z positions simultaneously, i.e., all positions contained in a sliding window of size w. for multiple window sizes, this results in a second scale space of p-values with the m/z positions of the window on the horizontal axis and the window size on the vertical axis. each position contains the p-value of the test result at that m/z position with the given window size. all p-values are corrected for multiple testing per window size  over all non-empty windows using the procedure proposed by benjamini and hochberg  <cit> .

in this second scale space, we now search for clusters containing as many m/z positions as possible that are significant and have at most one contribution from each sub-spectrum. the latter is used to prevent finding clusters containing peaks for actually different peptides; these should result in separate clusters. we start the search from the most significant peak at a minimal window size. in an iterative process, the window size is gradually increased, up to the point where either

• the combined values of peaks within the window are not significant anymore, or

• we include more than one contribution from a single sub-spectrum.

the results of this procedure we call peak-bags and they encompass a central peak position, a range of m/z values in a window centered around this peak position, and a signal level for each m/z value, also registering which sub-spectra contributed to this signal. the signal level is a summation of the wavelet coefficient values for the contributing sub-spectra.

the next significant position is position  <dig> . however, this has two contributions from the same sub-spectrum . position  <dig> alone  is not significant. therefore, no new peak-bag is defined. however, in panel  the appropriate elements in the significance scale space are still greyed out. this is to avoid re-analysis of position  <dig>  position  <dig> at window size  <dig> is significant, contains only single contributions and no larger window exists. it is selected as a second peak-bag. panel  shows the result of greying out the appropriate elements again. no significant elements are remaining, finalising the analysis.

experiments
we performed seldi-tof mass spectrometry twice on  <dig> samples containing a mixture of  <dig> spiking peptides. this way, we obtained  <dig> full spectra and their respective sub-spectra. the spiking peptides used are dynorphin , acth 1– <dig> , β-endorphin , insulin  and ubiquitin .

we employed our sub-spectral analysis method and compared the obtained peak-bags to the results of three methods for analysing full mass spectra. these are the wavelet-based method proposed by du et al.  <cit> , a standard method implemented in the process r-package and another method implemented in the masda r-package. masda implements an elementary seldi-tof analysis pipeline, used for the comparison of normalisation methods  <cit> . except for the approach presented here, all these methods employ a signal-to-noise ratio cutoff in order to detect peaks.

for the comparison of results, we assessed the sensitivity and false discovery rate  with respect to finding peaks corresponding to the five spiking peptides. by varying the parameters that influence the number of detected peaks  over a wide range of values, and computing the sensitivity and fdr at every setting, we can construct and operating characteristic  curve .

ideally, the sensitivity of a method should be as high as possible, while keeping the fdr as small as possible. in other words, we would like to be as much as possible towards the topleft position of the graph in figure  <dig> 

the sub-spectral analysis clearly outperforms the other  methods by achieving both a high sensitivity and low fdr across a relatively large range of p-value thresholds. even when the fdr is high, the sensitivity of the sub-spectral analysis clearly outperforms all other approaches. although it has been shown in the literature  <cit>  that the wavelet-based analysis often outperforms the traditional analysis methods, such as the one implemented in the masda package, here it only seems to outperform the latter in the low fdr range. this is, however, not so bad, as in most proteomics analyses it is actually desirable to keep the fdr at a low level. the process package generally performs the worst. although it displays the lowest fdr, its sensitivity is extremely low.

peak-bags
the methods we compare our approach with do not provide any information on the shape of peaks. our method, based on analysing sub-spectra, yields peak-bags that do provide this information, as well as a confidence measure in the form of a p-value. figure  <dig> shows part of a spectrum of a human serum sample  with one large peak and what seems to be several adduct peaks of the same peptide.

the methods implemented by du et al. and the process package find only one peak here, namely the largest one. the masda package finds some of the adduct peaks as well, albeit at an unrealisticly low signal-to-noise ratio cutoff. sub-spectral analysis however, yields multiple peak-bags. in the figure, each colour represents a peak-bag with its associated peak positions and amplitudes. note that these peak-bags are selected with p <  <dig>  and have at most one contribution from each sub-spectrum, as shown in figure  <dig> 

CONCLUSIONS
we have shown that analysing sub-spectra allows one to find real peaks not found by other methods. our results are not heavily dependent on parameter settings, such as a signal-to-noise ratio threshold for detecting peaks. instead, for the first time, we provide a confidence measure for peaks in the form of p-values, reducing the false positive rate and yielding a better sensitivity.

furthermore, our notion of peak-bags provides information on the variability and distribution of peaks across sub-spectra and their contribution to the aggregate  spectrum. this provides a more complete representation of peaks, impossible to obtain using full spectra. effectively, our approach offers an implicit way of deconvoluting spectra.

