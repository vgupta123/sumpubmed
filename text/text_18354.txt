BACKGROUND
in mammals, the methylated form of cytosine  is hypermutable  <cit> . 5mc is formed by the enzyme dna methyltransferase operating on a cytosine occurring immediately 5' of a guanine. one effect of methylation is to increase the rate of spontaneous deamination of 5mc to form thymine. it has been estimated that transitions in the methylated cpg dinucleotide occur 8â€“ <dig> times faster than non-cpg transitions  <cit> . a smaller elevation of the rate of transversion mutation at the cpg dinucleotide has also been observed  <cit> . it has been suggested that cpg mutability in mammals underwent an abrupt elevation sometime around the mammalian radiation , possibly in response to invasion by rapidly replicating transposable elements  <cit> .

as a result of this hypermutability, molecular evolution studies have frequently attempted to estimate cpg and non-cpg substitution rates by separating observed substitutions into those that are inferred to have occurred within and outside cpg dinucleotides. in many previous studies  <cit> , any nucleotide occurring within a cpg  or opposite a cpg  has been inferred to have been an ancestral cpg site. we hereafter refer to this process as cpg/non-cpg assignment. although cpg/non-cpg assignment is likely to be biased, it is generally assumed that this bias will be negligible if two sequences are closely related. furthermore, some studies that employed this assignment procedure in the analysis of protein-coding sequence have suggested that while the overall rate of substitution is higher at synonymous sites, both cpg and non-cpg synonymous substitution rates are substantially lower than substitution rates in noncoding dna  <cit> . this has been interpreted as evidence of purifying selection at synonymous sites.

however, denoting a site as ancestrally cpg based on the presence of a cpg in one of two extant species is clearly biased: this method of ancestral state assignment implies that misclassification of an ancestral non-cpg as cpg in two lineages requires only a single change whereas a minimum of two changes, one in each lineage, must occur to misclassify an ancestral non-cpg as cpg . this is problematic because the probabilities of each misclassification will rarely equal each other and are conditional on the level of divergence of the two sequences in question. furthermore, this bias may affect fourfold degenerate and noncoding sites differentially, since there are substantial compositional differences between synonymous and noncoding sites that arise, at least in part, because of the constraints imposed by the genetic code. the purpose of this study is to investigate the effects of misassignment of ancestral cpg state on the estimation of nucleotide substitution rates and how the level of misassignment varies with cpg hypermutability and evolutionary divergence. we deal explicitly with rates of nucleotide substitution between species.

RESULTS
cpg/non-cpg assignment bias at mutational equilibrium
we first studied the simplest case of dna sequences that had been evolved to approximate mutational equilibrium. dna sequences were evolved to approximate mutational equilibrium by generating a random sequence and evolving until each site had experienced on average ten substitutions  <cit> . two sequences derived from this ancestor were then evolved to a preset divergence. pairwise divergence at cpg and non-cpg sites was then estimated using cpg/non-cpg assignment. it is clear that cpg/non-cpg assignment seriously compromises the accuracy of estimation of both the number of cpg and non-cpg changes, most notably in minimally-diverged sequences . here, the number of true cpg changes is overestimated and the number of true non-cpg changes is underestimated. the explanation for this effect is as follows. for an ancestral cpg site to be assigned as non-cpg requires the destruction of the cpg site in both derived lineages, necessitating a minimum of two changes across the tree . for an ancestral non-cpg site to be assigned as cpg requires only a single change . the former will occur much less often  in closely related species than the latter . thus many more ancestral non-cpgs will be misassigned as cpg in two closely related sequences than vice versa. however, the key point is that all true non-cpg dinucleotides that are misassigned will, by definition, have experienced at least a single change in one lineage. by incorrectly placing many true non-cpg changes in the cpg class we artificially inflate the estimate of the cpg rate, whilst depressing the estimate of the non-cpg rate. the difference in magnitude of the bias between cpg and non-cpg sites reflects the difference in total numbers of each site type.

cpg/non-cpg assignment bias in coding and noncoding sequences
we next investigated the impact of cpg/non-cpg misassignment in sequence data that were compositionally more realistic than randomly generated sequences at approximate mutational equilibrium. real mouse coding and intronic sequences were used as ancestral sequences and again, two derived sequences were copied, evolved and the number of cpg and non-cpg changes estimated using cpg/non-cpg assignment. the results of this analysis are presented in figure  <dig>  as observed at approximate mutational equilibrium  the number of cpg substitutions tends to be overestimated and number of non-cpg substitutions tends to be underestimated at both fourfold and noncoding sites. interestingly, however, the magnitude of overestimation of the number of cpg changes tends to be larger in noncoding dna. for example, at 10-fold hypermutability and a pairwise divergence of 1%, the number of cpg substitutions in noncoding dna is overestimated by ~50%, whereas the equivalent figure is ~17% at fourfold sites. similarly, the magnitude of underestimation of non-cpg changes is lower at noncoding sites. for the same parameter combination as described above, the number of non-cpg substitutions is underestimated by ~12% in noncoding dna, and by ~20% at fourfold sites.

the difference in level of estimation bias at fourfold and noncoding sites results from a difference in cpg content. because of the structure of the genetic code, fourfold degenerate sites are typically enriched for cpg dinucleotides, whereas noncoding sequences are depleted . with changing cpg frequency, the numbers of misassigned sites will make up different proportions of the total lost or gained from the cpg and non-cpg classes. thus with decreasing cpg content, the overestimation of the cpg substitution rate becomes greater whereas the underestimation of the non-cpg substitution rate becomes less. paradoxically, this result implies that whenever cpg/non-cpg assignment is used to estimate substitution rates between closely related species, cpg-rich sequences will appear to be evolving more slowly than cpg-poor sequences.

cpg/non-cpg assignment bias in real sequence data
we next investigated whether the effects predicted by our simulations could be observed in a real evolutionary setting. as the cpg/non-cpg assignment bias primarily affects closely related sequences, we estimated substitution rates in human and chimpanzee pairwise alignments of coding and noncoding sequence. as we cannot know the true numbers of cpg and non-cpg substitutions in a real alignment, we sought to compare cpg/non-cpg assignment with a bias-free method. previous studies  <cit>  have employed a "prec", "postg" classification in order to remove cpg mutations from nucleotide sequence data. further simulations showed that excluding all sites preceded by c and followed by g , reliably removes the effects of cpg mutation  although this removes a substantial number of sites from our dataset . we compared the non-cpg prone substitution rate with the substitution rate estimated at non-cpg sites identified using cpg/non-cpg assignment. the results of this analysis are presented in table  <dig>  as predicted by our simulations, the substitution rate at non-cpg sites, identified using cpg/non-cpg assignment, is underestimated  when compared with the bias-free method. the difference between substitution rates at non-cpg and non-cpg prone sites is highly significant both in introns and at fourfold sites . the ratio of synonymous to intronic substitution rates is also significantly lower  at non-cpg sites compared with non-cpg prone sites. as in our simulations, this likely results from differences in cpg content between fourfold and intronic sites, that produce different degrees of underestimation of the non-cpg rate when cpg/non-cpg assignment is used. thus, cpg/non-cpg assignment could be potentially misleading when comparing cpg rich and cpg poor sequences, such as synonymous and intronic sites.

non cpg sites were identified using cpg/non-cpg assignment. numbers in parentheses show 95% confidence intervals estimated by bootstrapping the data by gene,  <dig> times.

discussion
reliable, bias-free estimation of nucleotide substitution rates is a fundamental part of molecular evolutionary studies. furthermore in order to test hypotheses about natural selection, underlying neutral processes, such as mutational rate variation, must be accounted for and their effects quantified or removed as efficiently as possible. our study has shown that a commonly used method of effecting such a removal, assigning nucleotide sites to cpg and non-cpg categories, systematically biases the estimation of nucleotide substitution rates. in particular, across small to moderate evolutionary distances, cpg/non-cpg assignment seriously upwardly biases the estimate of the number of cpg changes and downwardly biases the estimate of the number of non-cpg changes. this is due to a simple artefact that causes many more true non-cpg changes to be misassigned as cpg than vice versa. clearly, more reliable removal of the effects of cpg mutation is required prior to any meaningful comparison of rates of nucleotide substitution among different regions of mammalian genomes. our simulations indicated that exclusion of non-cpg-prone sites , is one simple and effective method of removing cpg-derived changes. one possible alternative to this is to employ an outgroup species to improve the accuracy of ancestral assignment. however simulations showed that parsimony-based ancestral assignment can introduce additional biases into the estimation of substitution rates . these effects are consistent with the known problems with parsimony when base composition is biased  <cit> , namely an excess of common-to-rare changes .

the bias we describe here also causes the substitution rate within cpg dinucleotides to be substantially overestimated between closely related species. estimation of the rate of substitution at cpgs has also been attempted using cpg/non-cpg assignment by previous studies  <cit> . it is likely that such studies will have overestimated the rate of substitution at cpg sites, again due to misassignment issues. when estimating the rate of substitution at cpg sites, it is clearly preferable to implement a method that explicitly models context-dependent evolution, such those proposed in refs  <cit>  or  <cit> . our results are supported by recent studies that have demonstrated that methods of "optimal" ancestral state assignment, such as the ad hoc method described here, can be seriously biased and misleading  <cit> .

the results presented here also have implications for previous comparisons of the substitution rate at fourfold and noncoding sites in mammalian genomes  <cit> . as a result of cpg/non-cpg misassignment bias and differences in base composition, typical mammalian noncoding and fourfold degenerate sites are likely to be predisposed to misleading inferences about their relative rates of substitution. the net effect is that fourfold synonymous sites appear to be evolving more slowly than noncoding sites when substitutions are divided into those that have apparently occurred within and outside a cpg dinucleotide. furthermore, fourfold sites will typically have a higher cpg frequency than noncoding sites both during the progression to, and at, mutational equilibrium. because of this, an apparent depression of evolutionary rates at fourfold degenerate sites, when compared to noncoding dna using cpg/non-cpg assignment, is likely to be a general feature of mammalian molecular evolution.

CONCLUSIONS
our study shows that a commonly used method of assigning sites to cpg or non cpg classes in pairwise alignments is seriously biased. we further note that the effects of cpg and non-cpg misassignment at fourfold and noncoding sites are dependent on differential cpg frequencies, and so these results will apply to any comparison of substitution rates where this is the case. our results therefore recommend against the adoption of ad hoc methods of ancestral state assignment.

