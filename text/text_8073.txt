BACKGROUND
defining drug targets and drug design is one of the major goals in biomedical research. in particular, metabolic enzymes have been successfully targeted by specific drugs to inhibit essential processes of pathogenic organisms in the human host  <cit> . analyzing the metabolic network in silico helps to identify enzymes that are essential for the survival of the organism  <cit> . a general model for the metabolic network has been described by graph theoretical approaches and was applied to identify drug targets in pathogenic organisms  <cit> . the term 'damage' was used to assess enzymes that may serve as drug targets when their inhibition influences a substantial number of downstream metabolic reactions and products  <cit> . furthermore, concepts of choke points and load points were successfully applied to estimate the essentiality of an enzyme  <cit> . load points were defined as hot spots in the metabolic network  based on the ratio of the number of k-shortest paths passing through a metabolite/enzyme , and the number of nearest neighbor links  attached to it. this ratio was compared to the average load value in the network  <cit> . choke points uniquely consume or produce a certain metabolite, which may make them indispensable. for example, in plasmodium falciparum d-aminolevulinate dehydratase  has been considered as a choke point  <cit>  and was proven experimentally to serve as a valid antimalarial target  <cit> .

flux balance analyses  is a widely used and well established method to assess the essentiality of genes  <cit> . however, fba approaches need clear definitions of nutrition availability and biomass production under specifically given environmental conditions . high-throughput experiments have been performed to investigate the essentiality of a major portion or all genes in an organism  <cit> . for escherichia coli, the essentiality of virtually all open reading frames was observed by a comprehensive knockout screen . this data enables to test the performance of an in silico metabolic model that predicts essential genes. analyzing flux balances under aerobic glucose condition using the cobra toolbox  <cit>  and a newly reconstructed metabolic network of e. coli yielded 92% accuracy when predicting the essentiality of genes  <cit> . feist and co-workers compared their predictions with the keio collection and yielded 88% for rich media conditions. in another study, fba and the corresponding experimental knockout screen was performed to study the opportunistic behavior of the pathogen pseudomonas aeruginosa with a systems view  <cit> .

in this paper we propose an integrative machine learning approach applying a broad list of the described tools. the machine learning system was supplied with qualitative and quantitative descriptors derived from biochemical knowledge, genomic and transcriptomic data, and flux balance analyses. using the keio collection  <cit>  as the gold standard, we yielded an overall accuracy of 93% for rich media conditions. comparative analysis between the flux balance approach and our machine learning approach yielded some improvements for fba, namely to consider aminyl-trna reactions in modeling. predictions that contradicted the keio collection were experimentally tested and successfully used to detect errors in the experimental data. predicted reactions matching the experimental screen strengthen their candidacy as potential drug targets. supporting this claim,  <dig> out of  <dig> predictions for novel targets were found in other literature with reported experimental evidence.

methods
network reconstruction
the data for the metabolic network was taken from a previous study and reconstructed in the same way . basically, the metabolic network was represented as an undirected bipartite graph consisting of metabolites and reactions as alternating nodes. this network was taken for our flux balance analyses. for all other analyses, unspecific compounds such as water, atp, etc. were discarded.

the gold standard
in order to demonstrate the efficiency of our approach we used data from the keio collection  <cit>  as the gold standard. the dataset consisted of the phenotypic outcomes from a set of knockout mutants of single genes and was used to define the classes "essential" and "non-essential" for our reactions. genes were knocked out by in-frame replacement of a pcr product containing a kanamycin resistance gene. the start-codon and the up-stream translational signal were not replaced and fully intact. after kanamycin treatment, in-frame single gene deletions were verified by pcr with loci specific primers. when they were unable to create a mutant that formed colonies on a plate, the mutated gene was considered to be essential. knockout experiments were performed in lb rich medium and in glucose minimal medium, resulting in two datasets . for the rich medium, out of  <dig>  tested genes, for  <dig> genes no mutants were found and therefore defined as being essential. genes that were considered to be essential under rich medium condition were also considered as essential under glucose minimal medium condition. additionally, to these genes,  <dig> genes were assigned to be essential in glucose minimal medium as they showed very slow growth in minimal media . experimental criteria for gene essentiality on glucose minimal medium are described in detail in  <cit> . genes were mapped to the corresponding proteins, enzymes and reactions using the gene-protein-reaction table from feist et al.  <cit> . the reaction associated with each gene were defined as essential or non-essential if there was no other way to activate the reaction by other genes and if the coding gene was experimentally essential or non-essential, respectively. otherwise they were discarded from our training and testing analysis. furthermore,  <dig> reactions were discarded from the analysis, as the corresponding genes couldn't be defined. finally, from  <dig> essential genes we determined a set of  <dig> essential and  <dig> non-essential reactions under rich medium. out of these  <dig> non-essential reactions under rich medium,  <dig> reactions were defined as essential under glucose minimal medium. in total,  <dig> reactions were used and the experimental results  for their essentiality were taken as class labels of the reactions  for training and validating the classifiers. note that, we didn't use this experimental data for any features of the reactions.

defining the features
a list of relevant features was obtained from three different aspects: network topology, genomics and flux balance analyses. table  <dig> gives an overview of all features and their abbreviations.

athe optimized features, bfeatures from gene expression

topology based features
we set up a breadth first algorithm to investigate the network when a single reaction was blocked. we defined a reaction as essential for survival when basically the mutated network could not yield the products of the reaction from upstream substrates of the reaction. hence, features were defined to describe if the knocked out reaction was substantial for producing its downstream metabolites or if these products could still be produced by other pathways. the investigation for each tested knocked out reaction was performed by the following algorithm.

i. all metabolites acting as input nodes  and output nodes  of the knocked out reaction were selected. the set of substrates s defined the input nodes and the set of products p defined the output nodes. to get a broader list of available substrates we integrated several other substrates into s. we included the substrates of the upstream reactions and the products of the downstream reactions into the sets s and p, respectively. substrates of reactions that had at least one of the substrates s as a substrate was included into s. further, substrates of reactions that had a metabolite out of p as a substrate were also included into s.

ii. reactions were selected which used only available compounds as substrates.

iii. these selected reactions and their products were incorporated into the network. these products were set as new available metabolites in the network.

iv. steps ii and iii were repeated until no further reactions could be identified for incorporation.

v. the output nodes that could be produced were counted .

after finishing the process, we used the number of defined output nodes that could be produced within the mutated network for two features, i.e. a quality feature defining if at least one product could not be produced , and the percentage of products that could not be produced .

we again run a breadth first search on the network to estimate possible deviations. this time we focused on relevant pathways by using the similarity measure from the simcomp software  <cit> . simcomp was used to define the most relevant substrates and products of each reaction. starting from s, the breadth first search explored the network for finding the direct products of the knocked out reaction. when the algorithm visited these products, it stored the corresponding pathway and continued its search to find further alternative paths until the network was entirely explored or a maximal path length of  <dig> reactions was reached. we took the average path length  and the shortest path length  of the deviations as features for the classifier. the deviation features were used to find alternative pathways to produce products of the knocked out reaction by its substrates s. in the metabolic network, these substrates can also be consumed by other reactions yielding their products etc. therefore, we kept track of alternative paths in the metabolic network for the potential of the organism to survive when a reaction was blocked. the organism may have many pathways to produce the products making the system more robust. thus, we counted the number of possible alternative paths yielding feature nd .

choke points, load points and damage
a reaction that uniquely consumes or produces a certain metabolite in the metabolic network is considered a choke point. such a reaction shows high potential for essentiality  <cit> . we checked if an observed reaction was a choke point . according to the concept of load scores from  <cit> , we computed a load score of a reaction from the average number of pathways passing through the reaction, in comparison to the number of pathways for all metabolites in the network. we used the definition of damaged compounds/reactions reported by  <cit> . basically, damage was defined by determining the potentially effected metabolites and reactions downstream of the knocked out reaction. we applied their definition for calculating the features ndr  and ndc . in turn, some damaged compounds/reactions might have been produced from alternative pathways. therefore, we calculated the number of damaged compounds/reactions that did not have an alternative way to be reached from the substrates of the knocked out reaction . in addition to our analysis on damaged compounds/reactions, we also included the number of damaged choke points .

local topology features
the number of substrates and products of the knocked out reaction were counted . further, we defined features for the number of neighbouring reactions , the number of neighbours of neighbouring reactions  and the clustering coefficient   <cit>  of the knocked out reaction. the reaction direction  was taken from the model from feist et al. <cit> .

gene expression data, genomic data and miscellaneous
for our case study, we collected gene expression data from a study observing the regulation during oxygen deprivation  <cit> . this dataset was taken to have a rather unspecific regulation, i.e. not of a small band but of a broad range of effected metabolic pathways. the gene expression data of each data-set was mapped onto the corresponding reactions. for a reaction that was catalysed by a complex of proteins, we took the mean of the gene expression values for the corresponding genes . genes in the same pathway often show co-regulation  <cit> . therefore, the maximum correlation coefficient of all neighboring reactions of the knocked out reaction  and the number of reactions having similar gene expression  were calculated . together with the number of reactions coming from the same gene , these features served the machine for estimating if the knocked out reaction was in a biosynthesis or degradation pathway. we also included the number of homologous genes that might have taken over the function of the knocked out gene. homologous genes were searched using blast  <cit>  against all open reading frames of e. coli with four different e-value cutoffs, i.e. 10- <dig>  10- <dig>  10- <dig>  and 10- <dig> yielding the features h <dig>  h <dig>  h <dig> and h <dig>  respectively. the method of the flux balance simulations is described in results and discussion .

machine learning
we applied support vector machines from the r package e <dig>  <cit>  to classify between essential and non-essential reactions of the metabolic network. a radial basis function was used as the kernel function. parameter optimization was performed for the regularization term that defined the costs for false classifications . the same range was taken for the kernel width γ. this optimization was realized by training with a grid search over all combinations of these parameters  <cit> . the sizes of the two classes differed significantly in our data set . for a broad spectrum of different precisions and sensitivities, we varied the weight factor for the positive instances from the data set with the optimized feature set in the range of  <dig>  to  <dig> . we performed a leave-one-out cross validation to measure the effectiveness of the machine learning method. a single reaction was selected as the validation data to be predicted and the remaining reactions as the training data. this was repeated for each reaction in the data set. for assessing the performance of the classifiers, we calculated the standard measures accuracy , sensitivity ), specificity ), positive prediction value or precision , negative prediction value .

feature selection
the feature selection was done by a top-down approach. we trained the support vector machines in terms of maximizing the overall accuracy using all features. each single feature was discarded from the data set and the performance of the machine was observed. testing the performance of the machine was done by a leave-one-out cross validation. the accuracies of the machines missing one feature were compared and the best machine kept for the next iteration. this was repeated until the accuracy did not increase. the machine with the best accuracy was selected as the best classifier and its features as the optimized feature set.

experimental protocol for the knockout verification
knockout mutations were verified by pcr amplification of genomic loci expected to contain the  <dig> base pair gene replacement cassette with specific primers . primers were chosen to have equal predicted melting temperatures of ~60°c and hybridised at specific distances upstream and downstream of the target gene. pcr reactions were performed directly from freshly grown bacterial colonies for  <dig> cycles at the annealing temperature of 54°c. the product sizes obtained from the keio collection strains were compared to those from the wild-type e. coli strain mg <dig> on 1% agarose gels.

assembling a list of drug targets
to map enzymes with drug targets, drugs and their corresponding drug targets were selected from the drug database drugbank  <cit> . we took drugs into account that affected any organism excepting humans and other mammals. entries that were found as metabolites for a reaction in the kegg database  <cit>  were discarded to restrict our drug list to non-endogenous compounds. the targets' annotated ec numbers of the remaining drugs were collected as our validated drug targets.

RESULTS
an overview of the machine learning procedure is shown in figure  <dig>  the machine learning system was trained and validated with a large set of features. firstly, local topology based features where used to qualitatively describe possible flux deviations. secondly, choke and load points were defined and damage was used to describe the qualitative flux load and down stream effects of the knocked down reaction. thirdly, functional genomics data, such as co-expression of genes for up- and down-stream reactions was used to indicate conjoint reactions in a pathway. in addition to these features, we considered the existence of homologous genes for the corresponding knockout reaction, which may be expected to take over the function of the knocked out gene. finally, we used flux balance analyses to estimate the network's biomass production following knocking out a reaction. a list of all features is given in table  <dig> 

performance of the machine learning algorithm
due to the small data set of  <dig> reactions for training and validation, we performed a leave-one-out cross validation to measure the effectiveness of our machine learning system. using the keio-collection data of rich medium as the reference, we gained an overall accuracy of 92% when all features were taken . to increase the performance, we did a systematic feature reduction within a top-down procedure. we yielded a better result with an optimized feature set of  <dig> features . these  <dig> features may be regarded as the dominating factors for leading to a good performance. to find out which of them are more relevant, we again started the top down procedure, now stopping at the first step. for all features, we compared the accuracy for each classifier lacking of one feature, respectively. it turned out that loosing the feature nnnr yielded the worst classification performance  and therefore hinting for being the most relevant feature. this feature was followed by nrse , bfv , nnr  and h <dig> . interestingly, these first five features span already the whole set of our feature categories .

the sizes of the two classes "essential reactions" and "non-essential reactions" differed significantly in our data set . for obtaining different stringencies, we weighted the positive instances by a factor ranging from  <dig>  to  <dig>  with a step size of  <dig>  . the sensitivity increased significantly from smaller to higher weights, reaching a plateau for weight factors of  <dig>  or more. as expected, with a smaller weight the classifier tended to be overwhelmed by the large negative class. more positive instances were recognized when their weight factor increased. the highest specificity  and the best precision  was yielded by the first data point with a weight factor of  <dig> . this is beneficial when predicting drug targets with high reliability. alternatively, to avoid overlooking potential targets, increased sensitivity can be achieved by raising weight factor to at least  <dig>  . in the following, all analyses were performed with a weight factor of one.

identifying drug targets
we compared the enzymes of our predictions and the results from the keio collection to a comprehensive list of valid drug targets from the drugbank database  <cit>  . surprisingly, 80% of the drug target enzymes were neither found by the keio high-throughput screen nor by our machine. this may be due to the fact that these drug targets are for a broad range of organisms having different topologies of the metabolic networks and may have different alternative pathways for the corresponding drug targets. it should be noted that this study focused on reactions being essential under rich media conditions. we suggest  <dig> promising drug target enzymes that are not in the drugbank database, which are validated by the intersection of our predictions with the results from the experimental keio screen. a list of these reactions with references for reported experimental evidences is given in table s <dig> .

comparing the performance of the machine learning approach to flux balance analyses
we performed a single reaction deletion on the network and calculated flux values by fba using the cobra toolbox  <cit>  to assess essential reactions under aerobic glucose minimal media conditions . in this analysis, a reaction was assessed to be essential if the respective prediction of the mutated network's maximal biomass production was < 1% of the wildtype's biomass production. the biomass objective function used in the analysis was also taken as explained in  <cit> . note that simulating rich media conditions is challenging, as it is difficult to characterize the uptake rates for each compound of a rich medium . because of this, we compared the performances of our approach with the fba on glucose minimal media.  <dig> reactions were found to be essential in glucose minimal medium according to the experimental criteria for gene essentiality under glucose minimal media in the keio collection  <cit> .  <dig> reactions were identified as non-essential. the remaining reactions had no associated gene, were exchange reactions, or could not clearly be identified. the fba approach detected the essentiality of a reaction under aerobic glucose minimal condition with an accuracy of 86%, a sensitivity of 52% and a specificity of 98%. we performed our machine learning under glucose minimal conditions with and without bfv  and found bfv to improve the results . with bfv, our approach yielded 90% precision and 79% recall of experimental results, compared with fba results of 87% precision and 51% recall. results for all reactions are given in table s <dig> .

1machine learning without the feature bfv .

2machine learning including the feature bfv

3flux balance analysis

improving flux balance simulations
using our approach as a means to validate the experimental knockout screen
predicting a different outcome from experimental high throughput screen  may be due to either an error in our algorithm, or an error within the experimental knockout screen. we examined our lists of false positives and false negatives by two experimental set-ups. our list of false negatives contained  <dig> genes which our algorithm predicted to be non-essential under glucose minimal condition in contradiction to the outcome of the keio experiment  <cit> . for  <dig> of them we obtained corresponding knockout clones from the keio library , and grew them on m <dig> glucose medium. indeed, we were able to grow  <dig> out of  <dig> clones with good growth rates  and  <dig> clones with reasonable growth rates . the complete list is given in table s <dig> . in turn, we also tested the list of false positives, for which our algorithm predicted  <dig> genes to be essential, in contrast to the experimental high throughput screen. we assumed that some of these genes weren't knocked out correctly. baba et al.  provided a validity estimation for their clones. we compared our results to their estimations and selected  <dig> genes, for which mutants they estimated to be less than or equal to  <dig> % correct. for  <dig> out of these  <dig> genes  pcr with specific primer pairs  yielded two products with sizes corresponding to wild-type and knockout alleles, respectively. this indicated that the genes were not correctly knocked out and the wild-type gene was still present. no pcr product was observed for the iles knockout. additionally we tested another  <dig> genes out of our list, for which mutations were stated to be 100% correct by baba et al. indeed, for all of those genes  only the correct pcr product corresponding to the knockout allele was observed.

CONCLUSIONS
defining drug targets is a challenging task. many experiments rely on a conditional essentiality screen of genes to define the associated enzymes as possible drug targets. machine learning methods can help to validate this experimental data. our approach used the experimental knockout data for e. coli from keio  <cit> . the machine was trained with this data and predicted quite accurately the experimental outcomes. most methods based on graphical networks aim at finding out weak points in the network. we set up a machine learning system that integrates features describing the network topology and functional genomics properties in an elaborated way. by this we gained two valuable insights. firstly, we could see that the topologic, genomic and transcriptomic data describing the network attributes was sufficient for defining the essentiality of a certain reaction. for pathogens it is often hard to define the environmental parameters which are complex and changeable as e.g. for intestinal infections. our approach can, in principle, handle all media conditions, as shown for rich media conditions in this study. rich media conditions may better reflect the situation of the pathogens in the host , in comparison to minimal media conditions with clearly defined carbon sources for which flux balance analyses can be well adapted. a second benefit of our study is the experimental validation and support for estimations of potential drug targets. when regarding the intersection of our results and the keio collection, we found  <dig> potential targets for novel drugs, for  <dig> out of which we could find some reported experimental evidence in the literature. an advantage of machine learning approaches is to easily change the stringency parameter, e.g. for increasing precision to avoid loosing potential candidates, the weight factor for the positive instances can be increased. we used gene expression data from e. coli wild-type and single knock out strains. the single knock outs were regulators for respiration effecting a large number of genes and also the treatment was rather unspecific . hence, a large portion of network pathways of the metabolic network was differentially expressed  <cit> . within the presented approach, data of such pathway unspecific examinations suited well to let the classifier learn which neighboring enzymes jointly work together. therefore, also multiple gene co-expression datasets for a variety of conditions may suit well for our approach. however, it needs still to be investigated which gene expression data suits best to optimize the performance.

we have presented a system that could be broadly applied to systems seeking potential drug targets for a variety of substantial bacterial infections and other organisms. for e. coli we benefited from a rich data pool including a well elaborated metabolic network, a genome wide knock out viability screen, the genome sequence and a feasible gene expression dataset. nowadays, the genomic sequence may not be the limiting factor for most applications as a remarkable number of genomes has been sequenced or will be sequenced in the next future. as our approach uses unspecific gene expression data also this can be obtained from publically available resources or obtained by rather straightforward experiments. very well elaborated metabolic networks have been assembled for some organisms  to which we expect that our method can be transferred without major difficulties. further networks can be received for a large amount of organisms from existing excellent databases like biocyc  <cit>  and kegg  <cit> . it will be challenging to exploit these networks with our method. finally, until now, for our approach the genome wide essentiality screen is still substantial and laborious. a methodological very challenging task remains to employ our approach across different organisms, by e.g. using the essentiality screen of one organism to infer the information to another.

authors' contributions
kp, j–pm, re and rk put up the general concept and design of the study. kp carried out the data analysis. mo and kp conceptualized and implemented the breath first search algorithm. fs and vs validated the model predictions experimentally in the lab. kp and rk drafted the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
supplementary tables. tables s <dig>  s <dig> and s <dig> 

click here for file

 additional file 2
supplementary table s <dig>  results of all reactions.

click here for file

 acknowledgements
we are very grateful to adam feist for helping us to understand and use the cobra toolbox and his flux balance analyses. we thank christopher dyer for stylistic corrections. this work was funded within the bmbf-forsys consortium viroquant , the deutscher akademischer auslandsdienst, the helmholtz alliance on systems biology of cancer and the commission on higher education  of thailand.
