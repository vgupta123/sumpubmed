BACKGROUND
allele specific expression  is a phenomenon by which the expression of the two parental alleles is unbalanced. over the past decade, the rise of high-throughput sequencing has facilitated the detection of ase via rna sequencing data , allowing for the detection of signals associated with cis-regulatory variation, loss of function alleles, imprinting and other important biological phenomenon . ase has also been implicated in human disease, either as a signal of variable gene expression or via the impact on the penetrance of damaging alleles  <cit> . however, despite its potential use as a key indicator of biological processes, genuine ase events can be difficult to detect without bias. existing experimental approaches such as genotyping arrays or padlock probes still face many challenges  <cit> , and although rna sequencing can be used to identify events transcriptome wide, many factors can influence the detection of ase from rna sequencing data, including both technical and mapping issues  <cit> , which need to be corrected before reliable biological conclusions can be drawn. perhaps the most accessible of these is sequence mapping biases, particularly since correction methods can be used to improve signals within the plethora of pre-existing datasets rather than requiring complete experimental re-design.

in order to detect ase events from rna sequencing data, a binomial test is often implemented to detect significant differences from the expected 50: <dig> ratio of alleles. this approach can be limited by coverage and power constraints, and consequently more advanced techniques are being developed  <cit> . prior to this, all current approaches rely on sequence read alignment and some form of correction procedure. pre-existing mapping correction methods mostly fall into two camps: filtering potentially problematic sites  <cit>  and mapping separately to each parental genome , which is similar in concept to recoding the reference genome with standard ambiguous nucleotide codes prior to mapping  <cit> . the former approach is appealing since it is relatively simple to implement, however it runs the risk of removing problem areas of the genome that could still show biologically relevant signals if handled properly, and also potentially over-generalises effects by relying heavily on known biases and common snps in the genome, missing personal genome effects. mapping to parental genomes, although appearing to be more accurate  <cit> , requires not only assumptions about phasing and snp calling from parental genomes, but also a large amount of complex manipulation and processing time; something not readily applicable to large high-throughput analysis and big data projects. here, we propose a new approach that normalizes mapped rna sequencing data by generating an assumed null dataset that can be used for correction of real data. we find that this approach leads to an improvement in reference allele quantification across a number of different mapping strategies and also compares favourably in either performance or processing time to alternative techniques when calling instances of ase.

RESULTS
typical identification of ase from rna sequencing data involves considering the ratio of reference and alternative alleles within sequencing reads that overlap heterozygous single nucleotide variants , identifying sites that deviate significantly from the expected 50: <dig> ratio. however, mapping biases can lead to observed allele ratios in sequencing data that do not reflect the underlying biological state.

in order to account for these biases we apply the following general approach : first, we map an rna sequencing dataset to a reference genome. second, we map corresponding exome sequencing data and call snvs and indels. in practice, genomic snvs and indels can be obtained from dna via any technology and coded in vcf format. third, we generate a null high coverage rna sequencing dataset that contains all snvs and indels uncovered from the exome data, present at exact 50: <dig> ratios for the two parental alleles at all heterozygous sites. to do this, we sample read pairs from the original mapped rna dataset and then recreate the two parental haplotypes in each case, repeating the process with replacement to generate a high coverage null dataset. since the genetic background of variants is only important within reads for the simulation, variants do not need to be pre-phased. fourth, we map the null sequencing dataset using the same software/pipeline as used in step one. in this way, any biases in the mapping procedure can be uncovered. finally, we use the mapping biases observed in the mapped null dataset to normalize the original data . a software package to generate a null high coverage dataset and to analyse results after mapping is available at https://github.com/ajhodgkinson/ase.fig.  <dig> 
a schematic for the normalization procedure. for a given heterozygous snv the underlying proportion of reference and alternative alleles is unknown. after mapping, the proportion of reference/alternative alleles is observed, but may contain biases. to correct for this, a null dataset is generated for this site containing a 50: <dig> ratio of the two alleles , and this data, together with null data from all other heterozygous sites is mapped using the same procedure as used for the original alignment. the observed proportion of mapped alleles from the null dataset is then used to correct the original data. b generation of the null dataset. all reads and read pairs covering a heterozygous snv are shown in the left hand panel. from these data, read pairs are randomly selected and the second haplotype is generated from known snv data for the individual. in the right hand panel, three examples of this process are shown. at the top, the original read pair contains the reference allele at the snv of interest , as well as the reference allele at a neighbouring snv . the second haplotype is thus generated with the alternative alleles at both positions. in the middle, the original read pair contains two alternative alleles at the snv sites, so an alternative read pair is generated with both reference alleles. at the bottom, the read pair contains the reference allele at the central snv site, and what appears to be a sequencing error upstream at a site where no snv has been identified. as such, a read pair is created with the sequencing error unchanged, and the alternative allele at the snv position. this process is repeated for all read pairs to generate a null dataset with coverage of 4000x, and reads are converted into fastq format for remapping



simulations
to test the performance of our normalization approach, we generated simulated rna sequencing data with gene expression levels and parental allelic ratios at heterozygous sites that matched real data. we then mapped these data using two commonly used aligners, tophat <dig>  <cit>  and star  <cit> , the latter of which is the current gold-standard mapping tool suggested in the gatk  <cit>  pipeline. in each case, we also varied some of the parameters used for mapping to consider which approach was most accurate. for tophat <dig> we used both the default parameters , and also allowed for  <dig> mismatches per read, which is consistent with the default values used in other aligners. for star, we mapped the data using the default parameters and also after disabling soft-clipping of reads. for each simulation, the proportion of reads containing the reference allele at each heterozygous site was varied, generating a unique rna sequencing dataset in each case and allowing for the full spectrum of biases to be explored.

for each of the four mapping approaches, we generated five independent simulated datasets, mapped reads to the reference genome and compared observed parental allele proportions at heterozygous sites to the ground truth. mapping with star after disabling soft clipping performed best  =  <dig> , r2 =  <dig>  for correlation of data points), followed by default mapping with star , mapping with tophat <dig> and allowing for  <dig> mismatches per read  and then default mapping with tophat <dig>  . importantly, the accuracy was significantly improved after applying our normalization approach in all cases  . to explore further whether the number of mismatches allowed influenced our ability to detect the correct proportion of reference alleles in different regions of the genome for each software, we repeated our analysis above and performed a parameter sweep from  <dig> to  <dig> mismatches allowed on average per read for tophat <dig>  star and star  using one of our simulated datasets. in stable regions of the genome  we find that generally there is a good match between the proportion of reference alleles detected across all heterozygous sites compared to the ground truth when  <dig> or more mismatches are allowed per read . for these regions our normalization approach had a similar performance to mapping reads without correction. for highly variable regions , the correlation between mapped data and the ground truth for the proportion of reference alleles at heterozygous sites was much weaker , yet in this case our normalization approach greatly improved the strength of correlations .fig.  <dig> the proportion of reference alleles at heterozygous sites before and after normalization. each plot shows the combined results from five simulated datasets, with the known reference proportion  on the x-axis and the reference proportion obtained from aligning sequencing data  on the y-axis. a shows the results obtained from initial mapping under four different approaches, and  shows the results of the same approaches after normalization. the sum of squared errors  is calculated around the red line , whereas r <dig> is obtained from analysing the correlation between the two variables



following this we considered how well ase events were called in both the original mapping data for the four approaches outlined above, as well as after normalization in each case, by comparing calls to the underlying truth in simulated datasets. to do this we considered only heterozygous sites covered by at least  <dig> sequencing reads  and used a binomial test with p <  <dig>  to define a site as undergoing ase. on average across each of the five simulated datasets, star with no soft clipping  and tophat <dig> with  <dig> mismatches  performed best, followed by default star mapping  and then default tophat <dig> mapping  . again, our normalization approach improved the precision of calling ase events in all cases . overall, mapping with tophat <dig>  and applying our normalization method gave the best precision of  <dig>  % . applying our normalization approach to data mapped with star  resulted in the best sensitivity , although this was only marginally better than after normalising mapping data from tophat <dig> , which was  <dig>  %.table  <dig> a comparison of ase call rates for original mapped data and after normalization, for four different alignment methods

in all cases, the true number of significant ase events averaged across five simulations is  <dig> 



next, we generated an additional  <dig> simulated rna sequencing datasets  and compared our normalization method to both a site filtering approach and mapping to both parental genomes in order to detect ase events. in each case we mapped with both tophat <dig>  and star , given that these approaches performed best during testing on a smaller number of simulated datasets . on average, each simulated dataset contained  <dig>  genuine ase events. using star  mapping and applying our normalization method,  <dig>  true positives and  <dig>  false positives were detected, leading to sensitivity of  <dig>  %, specificity of  <dig>  % and precision of  <dig>  %. mapping to both parental genomes performed marginally better overall with sensitivity, specificity and precision of  <dig>  %,  <dig>  % and  <dig>  % respectively, whereas the filtering method performed worse  . mapping with tophat <dig>  and applying our normalization approach allowed for the detection of  <dig>  true ase events and  <dig>  false positives, leading to sensitivity, specificity and precision of  <dig>  %,  <dig>  % and  <dig>  % respectively. in this case, both the filtering method and mapping to two genomes had a lower precision . overall, mapping with tophat <dig>  and applying our normalization method leads to the best precision.table  <dig> a comparison of ase call rates for three different approaches: a filtering methods, mapping to two parental genomes and our normalization approach



rna sequencing data
we sequenced the whole exomes and transcriptomes of  <dig> individuals from whole blood, called snvs and indels from the exome and rna data and mapped and filtered rna sequencing reads with both tophat <dig> and star, before applying our normalization method to detect ase events . final results obtained were quantitatively similar  for both mapping procedures, so from this point on we discuss the results obtained from tophat <dig> mappings. after initial sequence alignment, each individual had an average of  <dig> heterozygous sites covered by at least  <dig> sequencing reads . of these, an average of  <dig>  ase events were identified per individual, representing  <dig>  % of sites, although clearly this value is highly dependent on the coverage threshold used. after remapping the data to tolerate a higher number of mismatches  and applying our normalization approach,  <dig> sites were covered by at least  <dig> non-overlapping reads  and  <dig>  of these sites were identified as undergoing ase, which is consistent with the removal of false positives as highlighted during the analysis of simulated data.

to confirm the reliability of the data we hypothesised that adjacent heterozygous snvs in each gene should have similar parental allelic proportions in genes predicted to have only one transcript . consistent with this we found that our normalization approach and altered mapping parameters significantly reduce allelic differences at adjacent sites compared to original mapped data . furthermore, we found that our normalized dataset had an average reference allele proportion closer to the expected 50 % for  <dig> out of the  <dig> individuals, compared to original mapped data, and that the mean proportion of reference alleles at heterozygous sites was not significantly different from 50 % for  <dig> individuals after normalization .

finally, in order to consider the biological context of allele specific expression, we compared the proportion of sites undergoing ase in each individual with five lifestyle traits , adjusting for age, sample site and blood cell counts. since it is more likely that ase events are detectable at higher coverage  <cit> , in order to compare across individuals, we resampled each heterozygous site without replacement to a depth of 20x, and relaxed our threshold for detecting ase events to p <  <dig> . on average, each individual had  <dig> sites covered by at least  <dig> rna sequencing reads and of these,  <dig>  showed significant evidence of ase after normalization . comparing these values to lifestyle traits across individuals, we found no significant associations for four of the traits , however we observe that the proportion of sites undergoing ase in whole blood data is significantly associated with smoking . it is worth noting that using the original mapped data the relationship between these two variables is not significant , reinforcing the need for the correct treatment of data for ase analysis when attempting to uncover biologically relevant signals.fig.  <dig> ase calls per individual. the number of sites showing ase per individual after resampling to depth 20x  and the relationship between the proportions of ase events per site, per individual, and smoking status 



CONCLUSIONS
the use of high-throughput sequencing to detect ase is becoming increasingly common. the technique allows for the identification of biologically relevant signals at the level of the individual, many of which may have important implications for our understanding of human disease. however, the mapping of short read sequences has inherent biases, and as data sets grow to unprecedented scales, it is becoming increasingly important to develop fast and reliable methods to identify genuine ase events.

by applying a new approach for the normalization of rna sequencing data to simulated data sets, we highlight two important results. first, selection and fine-tuning of sequencing alignment methods can drastically improve ase analysis, reducing false positives and improving signal detection. the use of higher thresholds for mismatch tolerance, sensible read clipping and rigorous filtering of ambiguously placed reads leads to improved results. second, our normalization approach can be used to further improve the detection of ase. our approach performs better than general site filtering techniques, which while simple and quick to implement, often do not take into account the personal nature of genomes and can also over-filter biologically relevant signals. our approach also performs broadly similar to mapping to two parental genomes , but with far less complex manipulation of data on a per sample basis. in our hands, once the original data is aligned, it can be normalized using snvs and indels from exome sequencing data in ~120 min per sample with star and ~210 min with tophat <dig> , thus allowing this approach to be applied in large-scale sequencing studies.

applying our approach to rna sequencing data from  <dig> individuals we find evidence that suggests a low error rate in calling the ratio of parental alleles at heterozygous sites. first, we find consistency in parental allele biases within genes with single isoforms, suggesting consistent patterns of expression. second, we find that the data conforms more readily to expectations that on average parental alleles should show a 50: <dig> ratio of expression. finally, we identify a relationship between the total proportion of ase events per individual and smoking using rna sequencing data from whole blood. although many previous studies have identified variation in gene expression profiles between smokers and non-smokers , we demonstrate here a non-specific, genome-wide influence of smoking on the biased expression of alleles at heterozygous sites in whole blood data. this serves as an example of how carefully treated analysis of rna sequencing data for ase detection can be used to identify biologically relevant signals.

