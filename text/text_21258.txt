BACKGROUND
the availability of functional genomics data has increased dramatically over the last decade, mostly due to the development of high-throughput microarray-based technologies such as expression profiling. automatic mining of these data for meaningful biological signals requires systematic annotation of genomic elements at different levels. the gene ontology  project  <cit>  is a collaborative effort aimed at providing a controlled vocabulary to describe gene product attributes in all organisms. go consists of three hierarchically structured vocabularies  that describe gene products in terms of their associated biological processes, cellular components and molecular functions. the building blocks of go are terms, the relationship between which can be described by a directed acyclic graph , a hierarchy in which each gene product may be annotated to one or more terms in each ontology.

since its inception, many tools have been developed to explore, filter and search the go database. a comprehensive list of available tools is provided at the gene ontology web site . one of the most common applications of the go vocabulary is enrichment analysis – the identification of go terms that are significantly overrepresented in a given set of genes  <cit> . enrichment may suggest possible functional characteristics of the given set. for example, enriched go terms in a set of genes that are significantly over-expressed in a specific condition may suggest possible mechanisms of regulation that are put into play, or functional pathways that are activated in that condition.

a large repertoire of tools for enrichment analysis has been developed in recent years, including gominer  <cit> , fatigo  <cit> , bingo  <cit> , goat  <cit> , david  <cit>  and others. in general, these tools accept as input a target set of genes that is compared to a given background set of genes, or to a default "complete" background set. some subset of go terms from one or more of the three ontologies is scanned for enrichment in the target set relative to the background set, and terms for which significant enrichment is discovered are reported. the statistical test used for enrichment analysis is typically based on a hypergeometric or binomial model.

the most common form of output is a list of enriched terms. this simple approach allows the user to identify terms that are most significantly enriched but may lose substantial information regarding the relations between these terms. a more informative approach is to present the enrichment results in the context of the dag structure of the respective ontology. in a typical case, the list of significantly enriched go terms may include several related terms at varying significance levels. identifying the clusters of enriched terms in the go hierarchy becomes much simpler if the dag structure is made available. a few tools visualize the results of enrichment analysis in the dag structure, including the downloadable version of gominer  <cit> , the cytoscape plug-in bingo  <cit> , golem  <cit> , goeast  <cit>  and gotm  <cit> . a particularly friendly and useful go enrichment analysis tool is go::termfinder which is provided at the saccharomyces genome database . this tool provides a color-coded map of the enriched go terms. it is, however, limited only to analysis of s. cerevisiae genes and requires specifying an explicit target set.

in many practical cases, functional genomic information used as the input for the go enrichment analysis may be naturally represented as a ranked list. for most applications, the requirement for an input target gene set forces the user to set some arbitrary threshold and define the target set as all genes with ranks above  the threshold. for example, genes may be naturally scored and ranked according to their differential expression between two conditions. however, defining the specific set of genes that are differentially expressed requires setting an arbitrary threshold. unfortunately, the results of the enrichment analysis may often depend on the specific threshold that is set. tools that use the simple hypergeometric distribution require setting such a fixed threshold.

a few tools have been developed that use a threshold free approach including gsea  <cit> , fatiscan  <cit> , go-stat  <cit> , genetrail  <cit>  and iga  <cit> . the widely used gsea tool uses a statistic that is similar to kolmogorov-smirnov but assigns different weights to the occurrences of genes in different ranks in the list. the tool is not specifically aimed at go enrichment, and therefore does not offer visualization in terms of the go dag structure. in addition gsea does not provide an exact p-value and estimates the p-value using permutations. the p-values assigned by gsea are therefore limited by the number of permutations performed. fatiscan is another threshold free tool by the creators of fatigo. it tests a number of thresholds determined by the user  and then corrects for multiple testing using fdr. again, this tool does not provide an exact p-value. the iga method uses an iterative approach that circumvents the need for a fixed cutoff by computing the hypergeometric score at all possible cutoffs. iga does not produce an exact p-value as well. in  <cit>  the authors study the advantages of sample re-sampling. the sample permutation approach is applicable for the analysis of differential gene expression data but not in other applications of gene set enrichment where ranking is inferred otherwise.

as a matter of practicality it is also important for go enrichment tools to perform in an interactive manner. many of the existing tools, in particular those based on flexible thresholds that require time consuming simulations, fall short on this desired property.

in this note we describe a web-server interactive software tool, called gorilla, that enables go enrichment analysis in ranked lists of genes. it is based on previous work  <cit> , in which we describe a statistical framework, called mhg, for enrichment analysis in ranked lists. the method identifies, independently for each go term, the threshold at which the most significant enrichment is obtained. the significance score is accurately and tightly corrected for threshold multiple testing without the need for time consuming simulations. consequentially gorilla performs the enrichment analysis on thousands of genes and thousands of go terms in a few seconds. in the results section we demonstrate how gorilla can capture relevant biological processes and visualize the results with an easy to use graphical representation of the go hierarchy, emphasizing on the enriched nodes.

implementation
enrichment analysis
a standard approach for identifying enriched go terms uses the hypergeometric distribution . given a total number of genes n, with b of these genes associated with a particular go term and n of these genes in the target set, then the probability that b or more genes from the target set are associated with the given go term is given by the hypergeometric tail:

  prob=hgt=∑i=bmin⁡, 

if a ranked gene list: g <dig> ...,gn is provided in place of a target set, we define a label vector λ = λ <dig> ...,λn ∈ { <dig>  1}n according to the association of the ranked genes to the given go term, λi =  <dig> iff gi is associated with the term. the minimum hypergeometric  score is then defined as:

  mhg=min⁡1≤n<nhgt;n,b,n), 

where bn=∑i=1nλi. in words, the mhg score is the optimal hgt probability that is found over all possible partitions induced by the gene ranking. as such, this score must be corrected for multiple testing. in previous work we describe a dynamic programming algorithm for computing the exact p-value of a given mhg score  <cit> . more specifically, given a ranked list of genes, a go term associated with some of these genes and a corresponding mhg score s, the mhg p-value tells us the exact probability of observing an mhg score s' ≤ s under the null assumption that all go term occurrence configurations in the ranked list are equiprobable. we describe various considerations for efficient implementation of the mhg p-value algorithm elsewhere  <cit> .

description of the tool
gorilla is publicly available as a web-based application at: . the application has two modes of operation:

 <dig>  discovery of enriched go terms at the top of a ranked list of genes using the mhg statistics .

 <dig>  discovery of enriched go terms in a target set versus a background set and using a hypergeometric model . in this case the ranking inside these lists is ignored.

the web interface of gorilla is shown in figure  <dig>  the input to the application is a ranked list or two sets  that consist of gene names in the following formats: gene symbol, protein refseq, uniprot, unigene or ensembl. gene duplication often occurs in such lists, which can lead to statistically biased results. gorilla automatically removes duplicates keeping the highest ranking occurrence. this includes dealing with duplicates that hide behind different nomenclatures. gorilla currently supports the following organisms: human, mouse, rat, yeast, d. melanogaster, c. elegans and arabidopsis thaliana.

the output consists of a color-coded trimmed dag of all significantly enriched go terms. the output also includes a table consisting of the enriched go terms , the enrichment p-values  and the relevant annotated genes. the nodes of the resulting dag, which represent go terms, are color-coded according to the significance of the detected enrichment and clickable, leading to the relevant entry in the above table. results can be exported to excel. figure  <dig> depicts an example of the result of enrichment analysis, where the relations between enriched terms can be observed. to generate the go dag visualization, gorilla employs at&t's graphviz tool  <cit> .

RESULTS
to test the performance of gorilla we used the van't veer et al. breast cancer dataset  <cit> , which is a landmark study in clinical use of gene expression data. this dataset consists of expression profiles containing  <dig>  genes measured on  <dig> breast cancer patients. different patients showed various prognostic characteristics,  <dig> with more than  <dig> years survival versus  <dig> patients with less than  <dig> years survival. all genes were ranked according to how well they differentiate between the two groups using a simple t-test. the top of the list contained the genes that were the best separators between the two groups. the ranked list was given as input to gorilla with default running parameters. the result is shown in fig  <dig> and highlights a unique set of enriched go terms that were identified at different cutoffs. the enriched go terms include mitosis , cell cycle  and microtubule cytoskeleton organization and biogenesis . these enriched go terms are attributed to genes that were over expressed in patients with bad prognosis and under-expressed in patients with good prognosis, which is in accordance with biological common sense and supports their relevance. the total analysis running time was less than  <dig> seconds.

a comparison to other web-based tools was performed on the same dataset using each software's default parameters. web-based tools have several advantages over standalone tools  <cit>  and therefore we only compare gorilla to other web-based tools. the flexible threshold tools fatiscan  <cit>  and go-stat  <cit>  were given the ranked list as input while the fixed threshold methods goeast and david were given a target set containing all the genes with t-test p < 10- <dig>  which includes the top  <dig> genes, and a background set containing the rest of the genes. we note that the p < 10- <dig> choice of fixed threshold for cutting the data, which is often used for this type of tasks, is inherently arbitrary.

a summary of the comparison between the different tools is given in table  <dig>  david and goeast which use a fixed threshold based approach, yielded a similar set of enriched go terms to the ones yielded by gorilla. most of these terms were identified with less significant enrichment scores presumably because these methods use an arbitrary cutoff. the flexible cutoff based methods fatiscan did not identify any enriched go term while the go-stat flexible method identified go terms similar to the ones obtained by gorilla. running time of different tools varied considerably ranging from a few minutes up to  <dig> minutes per single analysis, which may be partially due to monte-carlo simulations employed by some of the methods for assessing the p-value.

different go enrichment tools employ a wide range of statistics and yield different performances. the main features of five different web-based tools are compared to gorilla. to enable a fair comparison all tools were used using default parameters via their web interfaces and applied on the van't veer dataset. one exception is the sgd tool that only runs on yeast data and was therefore tested on a set of  <dig> yeast genes and the default background for running time characterization. the gorilla running time for this yeast dataset was also  <dig> seconds. the running time was measured for the entire analysis, including uploading files and getting the results.

CONCLUSIONS
the main contribution of the application presented herein are:

 <dig>  most other approaches to go enrichment analysis assume that a target set and a background set are given or evident to the process. it is often the case, however, that genomic data which is the subject of the enrichment analysis step, is naturally represented as a ranked list of elements. gorilla uses a statistical model that supports the discovery of go terms that are enriched at the top of a ranked list, enabling a threshold to be determined in a data driven manner. it also provides an exact p-value for the observed event, which is not the case for most other available flexible threshold tools.

 <dig>  gorilla provides a simple and informative graphical representation of the significantly enriched terms, in the context of the complete dag representation of the ontology used in the analysis. this graphical representation is color coded based on the p-value attained for each go term.

 <dig>  the application is highly interactive with running time of a few seconds per analysis. this is achieved by using an efficient algorithm for computing the exact mhg p-value, which circumvents the need for simulations, and an efficient software implementation.

availability and requirements
project name: gorilla

project home page: 

operating system:  web-based application

programming language: java

authors' contributions
ee co-developed the methods, wrote the software application and led the writing of the manuscript. rn wrote the software application and contributed to the writing of the manuscript. is wrote the software application and contributed to the writing of the manuscript. dl co-developed the methods, wrote the software application and contributed to writing the manuscript. zy co-developed the methods, advised on design and features and supervised the study and the writing of the manuscript.

