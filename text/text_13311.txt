BACKGROUND
in the statistical literature, a composition is a vector of non-negative elements that are constrained to sum to a constant. compositional data are composed of such vectors. they represent parts of a whole and are typically expressed as proportions or percentages. the variables in a composition are often referred to as components. compositional data arise naturally in many disciplines, such as in plant ecology
 <cit> , archaeometry
 <cit> , and geology
 <cit> . notwithstanding this fact, is not uncommon for statistical analysis to be carried out without regard to the compositional nature of the data. the constant-sum constraint on the data restricts the sample space to a simplex and also induces spurious correlation between components
 <cit> , with the result that traditional statistical methods such as multivariate analysis of variance , pairwise correlations, and discriminant analysis are not directly suitable for these data.

aitchison
 <cit>  provides great insight into the special considerations required in compositional data analysis, advocating the use of a log-ratio approach. this has met with much success, in the statistical and geological communitites in particular. others have since built on his work, making available a collection of methods that are easily accessible for compositional data analysis.

we propose a feature selection method for compositional data. notably little research appears to have been conducted into feature selection for compositions to date. this methodology was developed with a specific application in mind; feature selection for hydrophilic interaction liquid chromatography  data from glycan analysis.

glycans are complex sugar chains that are present in all cells. they can exist either in free form or are covalently bound to other macromolecules, such as proteins or lipids
 <cit> . the diversity and complexity of these structures means that they have a broad range of functions, playing a structural role as well as being involved in most physiological processes
 <cit> . glycosylation is important in the growth and development of a cell, tumour growth and metastasis, immune recognition and response, anticoagulation, communication between cells, and microbial pathogenesis
 <cit> . glycans are generally attached to proteins through a nitrogen atom  or an oxygen atom .

glycobiology has great potential for biomarker discovery, as it has been relatively unexploited in comparison with genomics and proteomics
 <cit> . alterations in the glycosylation profiles of proteins have been observed during the pathogenesis of many different diseases; including cancer, congenital disorders of glycosylation and inflammatory conditions such as rheumatoid arthritis and schizophrenia
 <cit> .

developing analytical methods for the structural characterizations of glycans has proved to be challenging, due to their complex and heterogeneous nature. royle et al.
 <cit>  recently developed a high-throughput n-glycan hydrophilic interaction liquid chromatography  platform and described the detailed quantitative analysis of n-glycan structures from human serum . hilic analysis has emerged as one of the dominant analytical techniques for glycan analysis
 <cit> . chromatographic analysis produces a glycan profile or chromatogram, such as those in figures
 <dig> and
 <dig> . the relative area under each chromatographic peak represents the proportion of a particular subgroup of glycan structures present in the sample. the data are compositional, since each observation consists of the set of relative peak areas from an individual’s glycan profile. often, the objective of conducting glycan analysis is to identify chromatographic peaks that differ between a set of known groups .

a feature selection methodology for these data would provide a useful tool for biomarker research. one reason for this is that it could reduce the time and cost associated with further analysis. to identify the exact glycan structures corresponding to each chromatographic peak, further experimental analysis is required. to reduce the expense incurred from the addition of costly enzymes to the sample and the time required for detailed quantitative analysis, it would be extremely beneficial to be able to select a smaller subset of seemingly informative peaks for further refinement.

the level of refinement of the profile  is dependent on experimental conditions. the datasets demonstrated in this paper are from profiles consisting of  <dig>  and  <dig>  chromatographic peaks. the dimensionality of glycan chromatography datasets is expected to increase in the future, as more advanced techniques have already become available
 <cit> . for the purposes of biomarker discovery, it will become more important to have a methodology available for selecting subsets of chromatographic peaks that differ between control/disease groups.

galligan et al
 <cit>  compared three suitable models for the classification of glycan chromatography data and found that modelling the data using the log-ratio approach of aitchison
 <cit>  gave satisfactory results. a disadvantage is that fitting this model to compositional data requires transformation of the data, making interpretation of the model difficult in terms of the raw data . proposed here is a feature selection methodology based on connor and mosimann’s generalized dirichlet distribution
 <cit>  and its marginal, the beta distribution. this is an extension of the dirichlet distribution that has almost double the number of parameters and allows for more flexible modelling of compositional data. the dirichlet class is a natural parametric family for modelling data in a simplex sample space and therefore, no data transformation is required. there has been much interest in this class of models, and several other extensions of the ordinary dirichlet distribution have been explored, such as the hyper dirichlet
 <cit>  and the nested dirichlet
 <cit>  distributions. the dirichlet class has also been used for fitting regression models
 <cit>  and time series models to compositional data
 <cit> . in addition, wang et al.
 <cit>  proposed a dimension reduction technique for compositional data, using properties of the dirichlet distribution. they project compositional data onto a lower dimensional simplex space, finding an “optimal” projection, defined as that which maximizes the estimated dirichlet precision on the reduced data. a major advantage of modelling compositional data using the dirichlet distribution is that transformation of the data is not required, hence, the results are directly interpretable in terms of the original variables. this is a desirable property for feature selection, as features can be directly selected from the model.

raftery and dean
 <cit>  propose a methodology for variable selection integrated with model-based clustering. they use the headlong search strategy proposed by badsberg
 <cit>  to search over the feature space. they add and remove features during the model-building process using a comparison of the bayesian information criterion 
 <cit>  for proposed models. murphy, dean, and raftery
 <cit>  extend this variable selection methodology for use with supervised learning problems, specifically with model-based discriminant analysis. these approaches formulate the problem of variable selection as a model-selection problem, whereby the features and the appropriate model are selected simultaneously.

we propose a generalized dirichlet feature selection  method, that is an adaptation of the above methods that is suitable for use with compositional data in a supervised learning problem. this method could also be easily adapted for use with unsupervised classification methods, such as model-based clustering. a greedy search algorithm traverses the feature space, selecting a “grouping model” at each step from a set of target generalized dirichlet models, using the bic for model selection and including a backwards step in the algorithm to avoid getting trapped at local maxima. at each iteration, a set of chromatographic peaks are selected as the current optimal set of “grouping variables”. convergence is declared when no further proposed changes in the current set of selected features are accepted. the selected features are those peaks that appear to contain information about the group structure in the data, and further experimental analysis could be carried out to identify the glycan structures corresponding to these chromatographic peaks.

this method is applied to two glycan chromatography datasets; from the lung cancer study conducted by arnold et al.
 <cit>  and from the prostate cancer study of saldova et al.
 <cit> .

the gdfs method is compared with two well-known feature selection techniques: correlation-based feature selection  developed by hall
 <cit>  and a recursive partitioning method  for the construction of classification trees, developed by breiman et al.
 <cit> . neither method makes implicit assumptions about the distribution of the data, so both are suitable for use with compositions. recursive partitioning builds a classification tree using a selected subset of features. it is a non-parametric method that has been used in the past for feature selection in compositional data
 <cit> . correlation-based feature selection, widely used in the machine learning community and elsewhere
 <cit> , is applied to a discretized form of the data. it involves a best first search over the feature space to select the set of features with the highest “merit”, a heuristic used to measure the predictive ability of a feature subset.

methods
described in detail here is the proposed statistical methodology for feature selection in compositional data. this includes an introduction to the dirichlet, beta, and generalized dirichlet distributions, algorithmic details of the gdfs method for feature selection, a brief discussion of the two feature selection methods used for comparison and a description of the statistical classification methods employed for model validation.

relevant information is also provided on the two glycan chromatography datasets used to test the proposed statistical methodology, along with analytical details on the glycan analysis used to collect these datasets.

statistical methods
the generalized dirichlet distribution
connor and mosimann
 <cit>  propose the generalized dirichlet distribution as a more flexible extension of the ordinary dirichlet distribution for modelling compositional data with a unit-sum constraint. this section introduces the dirichlet distribution, followed by a description of how the dirichlet is extended to obtain the generalized dirichlet model.

the dirichlet distribution models proportional data in a simplex space. if a multivariate random vector y=, such that yj≥ <dig> for j= <dig> ,…,p and
∑j=1pyj= <dig>  is dirichlet distributed with parameters α=, then the dirichlet probability density function at y=yi is


  f=1b∏j=1pyijαj− <dig> 

where b is the multinomial beta function defined as


  b=∏j=1pΓΓ 

and


  Γ=∫0∞tx−1e−tdt 

is the gamma function.

the beta distribution is a univariate model that is a special case of the dirichlet distribution . fitting a beta distribution to a proportional random variable y is equivalent to fitting a dirichlet distribution to , since one of the variables in the vector  is degenerate. thus, a beta distribution has two parameters, commonly denoted , and probability density function


  f=1byiα−1β− <dig>  

the log likelihood function for n observations y= of a beta distributed random variable y∼beta is given by


  ℓ=−nlogb+∑i=1nlogyi+∑i=1nlog. 

because of its direct relationship with the dirichlet distribution, maximum likelihood estimates for the parameters of a beta distribution can be obtained in the same manner as for the corresponding dirichlet distribution. the maximum likelihood estimates for these distributions do not exist in closed form, so must be obtained by numerical approximation. the fixed-point iteration method outlined by minka
 <cit>  is used here for the numerical approximation of beta maximum likelihood estimates. reasonable starting values can be obtained using the method of moments . the expectation and variance of the beta distribution are


  e=αα+βv=e1+α+β. 

further details on parameter estimation are given in the next subsection.

connor and mosimann
 <cit>  derive the generalized dirichlet distribution from their concept of neutrality for proportional vectors. a component yj of a random compositional vector y= is defined as neutral if it is distributed independently of the rest of the composition with yj eliminated . they extend this concept to define the idea of complete neutrality. a random compositional vector y=, subject to a unit sum constraint, is said to be completely neutral if the elements of the vector


  y~=y <dig> y21−y <dig> y31−y1−y <dig> …,yp1−y1−…−yp− <dig> 

are mutually independent. the generalized dirichlet distribution results from making the additional assumption that the marginal distributions of the elements of
y~ are beta distributions. note that the last component of
y~ is degenerate since it is equal to one.

let sj=y1+y2+…+yj be the sum of the first j components of y, for j= <dig> ,…,p, and let s0= <dig>  if
y~ follows a generalized dirichlet distribution, then y is completely neutral and
y~j=yj/∼beta for j= <dig> ,…,p− <dig>  the probability density function for
y~j is therefore the product of these p− <dig> marginal beta distributions, since the components of
y~ are mutually independent. making a change of variable from y to
y~  allows the probability density function for
y~ to be written in terms of the probability density function for
y~, at observation i, as


  f=f∏j=1p−111−si,j−1=yipβp−1−1∏j=1p−11byijαj−11−si,j−1βj−1−αj−βj 

where b=ΓΓ/Γ is the beta function, si,j− <dig> is the sum of the first j− <dig> compositional components for observation i, and
∏j=1p−11/ is the jacobian term resulting from the change of variable. for a full derivation of this probability density function, please refer to appendix b. derivation of the generalized dirichlet probability density function. in the special case where βj−1=αj+βj for j= <dig> ,…,p− <dig> and writing αp=βp− <dig>  this model simplifies to the ordinary dirichlet distribution given by equation  <dig> 

the generalized dirichlet log likelihood for a set of n generalized dirichlet samples y={y <dig> y <dig> …yn} follows from its probability density function;


  ℓ=log∏j=1p−1f=∑i=1nlogyip−n∑j=1p−1logb+∑i=1n∑j=1p−1logyij+∑i=1n∑j=1p−1log 

where θ= is the generalized dirichlet parameter vector.

note that the ordering of generalized dirichlet components is important. a particular ordering of compositional variables may be completely neutral, while another ordering of the same variables may not be
 <cit> . therefore, if a compositional vector  follows a generalized dirichlet distribution, a permutation of its components such as  may not.

the generalized dirichlet model is more intuitive when viewed as a tree structure. this is well explained by null
 <cit> , who relates the generalized and nested dirichlet distributions. representing a generalized dirichlet random vector as a tree structure, the compositional components are assigned to be leaves in the tree and a set of p− <dig> interior nodes are introduced. each “nest” in the tree comprises of a leaf node  and an interior node  whose value is the sum of the leaf nodes nested below . the first component of the generalized dirichlet vector is at the top of the tree structure, and successive components are nested underneath. for example, the third component is nested under the second. the nest at the bottom level of the tree consists of two leaf nodes only. the variables in each nest are beta distributed, conditional on the value of the parent  node above.

figure
 <dig>  illustrates this concept of a tree structure with an example, where the composition  is modelled by a generalized dirichlet distribution. in this example, p =  <dig> so there are three leaves, p −  <dig> =  <dig> nests and p −  <dig> =  <dig> interior node in the tree. y <dig> is at the top level of the tree, nested with the interior node taking the value , that is the sum of the leaf nodes nested below. the bottom nest contains the two leaf nodes, y <dig> and y <dig>  each nest is modelled by a beta distribution, conditional on the value of its parent node. the nest at the top level of the tree, comprising of  is modelled by a beta distribution with parameters  . the nest at the bottom level of the tree is modelled as beta, conditional on the interior node above, y2+y <dig> 

the probability density function for this generalized dirichlet model is the product of the  beta distributions for each nest in the tree,


  y <dig> y2+y3∼betay2y2+y <dig> y3y2+y3∼beta 

and the jacobian term 1/ for the change of variable.

another generalized dirichlet model for the same components could be fitted to , as depicted in figure
 <dig> . note that figures
 <dig>  and  are not the same. the probability density function for the model in figure
 <dig>  is derived from the product of


  y <dig> y1+y2∼betay1y1+y <dig> y2y1+y2∼beta 

and the jacobian term 1/.

maximum likelihood estimation for the generalized dirichlet distribution
the maximum likelihood estimates for a generalized dirichlet distribution with p components are obtained via the estimation of parameters for the p− <dig> independent beta distributions from which the probability density function is comprised. as mentioned in the previous section, parameter estimates for the beta distribution can be obtained in the same manner as those for a dirichlet distribution, since the beta distribution is a special case of the dirichlet distribution.

since maximum likelihood estimates for a dirichlet distribution cannot be obtained in closed form, the fixed-point iteration method proposed by minka
 <cit>  is used here to numerically approximate the beta mles.

for n observations y= of a beta distributed random variable y∼beta, maximum likelihood estimates of the parameters,
α^ and
β^, can be obtained by a fixed-point iteration in the following manner. at each iteration t of the fixed-point iteration, updated parameter estimates  are calculated from


  Ψ=Ψ+1n∑i=1nlogyi 

  Ψ=Ψ+1n∑i=1nlog 

where


  Ψ=dlnΓdx 

is the digamma function; and then by numerical inversion of Ψ and Ψ using a newton raphson iteration. the fixed point iteration maximizes a lower bound on the log likelihood, and so, is sure to increase the log likelihood function at each iteration. starting estimates for the fixed point iteration are estimated using a variant of the method of moments originally suggested by ronning
 <cit> . for a beta distributed random variable y, with parameter vector , starting values for the parameter estimates at t= <dig> are calculated by first estimating the sum of the parameters and then obtaining estimates for each parameter,


  α0+β0^=evα^0=eα0+β0^β^0=eα0+β0^. 

the relative change in parameter estimates or the relative change in the log likelihood function is often used to test for convergence during parameter estimation algorithms. however, lindstrom and bates
 <cit>  highlight that this provides a measure of lack of progress, rather than lack of convergence. the aitken acceleration-based stopping criterion proposed by böhning et al.
 <cit>  is preferred here, as a test for the convergence of a log likelihood function. the log likelihood for the beta distribution is given in equation  <dig>  for a linearly convergent series of log likelihood estimates, böhning et al. suggest that an asymptotic estimate of the log likelihood at iteration  is


  ℓa=ℓ+11−cℓ−ℓ. 

where ℓ and c denote the log likelihood and the aitken acceleration at any iteration k, respectively, where the aitken acceleration is defined by


  c=ℓ−ℓℓ−ℓ. 

lindsay
 <cit>  suggests that the optimization algorithm should be terminated when the difference in the projected and current log likelihoods is less than than some specified tolerance level,


  ℓa−ℓ<tol. 

a similar criterion, proposed by mcnicholas et al.
 <cit>  is used here as a stopping criterion:


  ℓa−ℓ<tol. 

a tolerance level of  <dig>  was used here, as it appeared sufficient for convergence upon examination of log likelihood sequences.

the parameter vector for a generalized dirichlet distribution for a composition with p components is written , where each pair  are the parameters for the beta distribution of the jth nest in the tree structure, with j= <dig> corresponding to the top level and j=p− <dig> corresponding to the bottom level.

feature selection using the generalized dirichlet distribution
this section describes the gdfs method for compositional data. let y= denote a unit-sum compositional random vector. let z be a random variable indicating the group to which an observation y=yi belongs, so that zi=g if yi belongs to group g. components in y that contain group information will therefore be dependent on z.

the compositional variables y are partitioned into three sets, as follows: 

 <dig>  y: variables that contain group information 

 <dig>  y: variables that do not contain group information 

 <dig>  y: the proposal variable )

the objective of feature selection is to choose the set of features, compositional components in this case, that differ across known groups in the data. therefore, the final objective is to find the optimal partition {y,y} of grouping and non-grouping variables. a greedy algorithm is used to search efficiently through the space of all possible partitions of
y~ for the optimal partition. at each iteration of the greedy algorithm, the current state is defined by some partition of
y~, and it is proposed to add or remove a variable to or from the grouping set y. the decision to accept or reject this proposal is made by examining whether the proposal variable, y contains group information or not; that is, whether or not it depends on the group indicator variable z. the probability density function at an observed value of y=yi can be factorized into parts corresponding to the partition of x using standard laws of conditional probability,


  f=f,yi,yi|zi)=f,yi|zi)fyi,yi)=f|zi)︸f|yi,zi)︸fyi,yi)︸. 

when proposing to add  y to  the grouping model, two models can be considered; the first is a model where part  of equation  depends on z, indicating that y contains group information. the second is a model where the density function in part  does not depend on z, indicating that the proposal variable, y, does not contain group information and should be excluded from the grouping set.

the proposed gdfs method chooses a set of “grouping variables” via the construction of a generalized dirichlet model. if it is assumed that the partition {y,y,y} follows a generalized dirichlet distribution , then the distribution of
y~=y/) is a beta distribution. denoting the probability density function of
y~ by
fy~, the conditional distribution of y given y and z is derived using the change of variable rule in appendix a. change of variable rule, as


  f|yi,zi)=fy~|zi)11−si, 

which is independent of y since ,y,y) is completely neutral. therefore, the density of the proposal variable y is the product of a beta distribution and the jacobian term, 1/).

interestingly enough, the notion of partitioning variables into independent subspaces of components has previously been considered in independent subspace analysis , which has been applied to feature extraction problems in the past
 <cit> .

proposal to add a component to y
at every iteration of the greedy search algorithm, it is proposed to add a component to the grouping set, considering each of the currently omitted components. the decision of whether a proposed component y contains group information is made by comparing a grouping and non-grouping model for y. in the grouping model, y is dependent on z, and in the non-grouping model it is not.

in terms of equation , these models will be identical except for part . thus, the proposal to add y to the set of grouping variables is considered via a comparison of a grouping and non-grouping model, denoted mgr and mngr respectively, where


  mgr:fy~y~izi11−simngr:fy~y~i11−si. 

the jacobian term, 1/), can be neglected in this comparison since it is common to both models. since
y~ is beta distributed, the fitted grouping and non-grouping models for the proposal variable will be:


  mgr:y/)z=g∼betamngr:y/)∼beta 

the parameters for the grouping model are group dependent and must be estimated separately for each group.

if the grouping model for the proposal variable provides a better fit than the non-grouping model, then the proposal variable should considered for addition to the grouping set, y. note that if it is added to y, it should be added to the end of y rather than the beginning, to indicate that it is nested underneath variables that were added before it. this is necessary for the model to be a generalized dirichlet distribution, considering the specified grouping and non-grouping model structure.

proposal to remove a component from y
a proposal to remove a variable from the grouping model is also included at each iteration. this could potentially reduce the possibility of getting stuck at a local maxima. the decision of whether to remove a proposed component y from the grouping set y is made by comparing a grouping and non-grouping model for y. in the grouping model, y depends on the group information vector z, and in the non-grouping model it does not.

for the remove step, the “grouping model” considered is the generalized dirichlet model fitted to the current set of grouping variables, denoted here as y. this notation is used here to indicate that y is included amongst the grouping set, in the ordering specified by the currently fitted generalized dirichlet model for the grouping set. it differentiates from the notation ,y), which indicates that component y is definitely at the end of the vector . if y follows a generalized dirichlet distribution, this does not imply that ,y) is also generalized dirichlet distributed. when proposing to remove a component from the grouping set, the generalized dirichlet model fitted to y must also be considered in the comparison of grouping and non-grouping models. this is because removing the proposal variable from the generalized tree structure could result in a different generalized dirichlet tree structure for the set of grouping variables.

in terms of the second line of equation  <dig>  the density function for the grouping model can be factorized as


  f=f|zi)︸fyi,yi)︸. 

for the remove step, the density for the non-grouping model can be factorized as in the third line of equation  <dig>  where the proposal variable is not dependent on z,


  f=f|zi)f|yi)︸fyi,yi)︸. 

component  of the grouping and non-grouping models are the same and can be omitted from a comparison of the two models. neglecting component  results in a simplified comparison of a grouping and non-grouping model for y, denoted mgr and mngr respectively, where


  mgr:fyizimngr:fyizify~py~i1/) 

where
1/) is the jacobian term resulting from the change of variable from
yi to
y~i . letting a denote the parameter vector for the generalized dirichlet model fitted to the compositional components in set j, the grouping and non-grouping models to be fitted at the remove step may be written,


 mgr:yizi∼gd) 

  mngr:yizi∼gd)yi|yi∼beta, 

and the probability density functions for each are calculated from equation  <dig>  for the set of grouping variables, the parameter vector is indexed by g to indicate that they are estimated separately for each group g. at every remove step, each of the components currently in the grouping model are considered as remove proposals. if the grouping model provides a better fit than the non-grouping model, this can be considered as evidence for retaining the proposal variable in the grouping set. if the converse is true, there is evidence for removing the proposal variable from the grouping set.

selected feature model
when the partition {y,y} is found that is considered to be optimal, the “grouping model” is the generalized dirichlet model currently fitted to y. note that this is equivalent to fitting a generalized dirichlet model to ,1−s), since the component 1−s is degenerate .

the parameters for this grouping model should be estimated separately for each group, since these are the components that are considered to be dependent on z.

bayesian information criterion 
the bayesian information criterion  is a model selection criterion that was proposed by schwarz
 <cit>  and was used by raftery and dean
 <cit>  for model selection in variable selection for model-based clustering. the bic is also used here for model comparison. for a beta distribution, the bic is given by


  2ℓ−2logn 

where
ℓ is the log likelihood function given in equation  <dig>  evaluated at the maximum likelihood estimates of the parameters,
α=α^ and
β=β^. the bic prevents model overfitting by using a penalty for model complexity, number of parameters× logn. in comparing two models, that with the larger bic is preferable.

the bic in equation  <dig> is used to compare beta distributions for the proposal variable in the grouping and non-grouping models specified in equation  <dig>  the bic for the grouping model is computed as the sum of the bic values obtained from fitting a beta distribution to each group. then the decision of whether the proposal variable y contains group information is made by examination of the difference in bic for the grouping and non-grouping models.


  bicdiff=bicgr−bicngr 

a positive value for bicdiff provides evidence in favour of grouping model, mgr, over the non-grouping model, mngr. the larger the difference in bic, the more statistical evidence there is in favour of including y in the set of grouping variables.

for a generalized dirichlet distribution, the bic is calculated by


  2ℓ−2logn 

where
ℓ is the log likelihood function of the generalized dirichlet distribution given by equation , evaluated at
θ=θ^, the maximum likelihood estimate for the parameter vector,  <dig> is the number of estimated parameters, and n is the number of samples. this bic can be used to compare generalized dirichlet distributions fitted to different orderings/permutations of the grouping variable set y, as outlined in the following section.

algorithm outline
this section outlines the proposed feature selection algorithm for compositional data. the model is initialized by adding two compositional components to the grouping model. the algorithm iterates over three steps until convergence, the first step being the proposal to add a component to the grouping model. greedy searches can get trapped at local maxima, so the second and third steps are included to avoid this. the second step is a proposal to remove a component from the grouping model, while the third is a proposal to permute the order of nesting in the generalized dirichlet grouping model i.e. to permute the ordering of components in y. each step proposes a “move” that is either accepted or rejected. the algorithm terminates when an add, remove, and permute proposal are rejected in succession. 

 <dig>  initialization: initially assign all variables to the non-grouping set, and then add a single variable to the grouping set. the decision of which variable to add is made via a comparison of bic differences for grouping and non-grouping models for each variable. the variable with the maximum bic difference is added to the grouping model. if all of the bic differences are negative, the variable with the least negative bic difference is added. add a second variable to the grouping model in a similar manner. if this second add move is not made, the algorithm will terminate after the first iteration if the bic difference was negative for the first variable added .

 <dig>  add step: propose to add a variable to the grouping model. the decision of whether to add a variable to the grouping model is made via a bic comparison for grouping and non-grouping models for each variable in y, the non-grouping set. if any of the bic differences for these models is positive, add the variable with the largest positive bic difference to the grouping set. a positive bic difference provides evidence that a variable contributes group information to the model. if all bic differences are negative, reject the proposal to add a variable to the grouping model. if the proposal to add a variable is accepted, this variable is added to the end of y. this means that it will be located in the bottom nest of the generalized dirichlet tree structure fitted to the grouping variables.

 <dig>  remove step: propose to remove a variable from the grouping model. the decision of whether to remove a variable is made via a bic comparison for grouping and non-grouping models for each variable currently included in the grouping set, y. a negative bic difference provides evidence that a variable does not contribute group information to the model. if the bic difference is negative for any of these variables, remove the variable with the largest negative bic difference from the grouping set, and add it to the non-grouping set y. if all bic differences are positive, reject the proposal to remove a variable from the grouping model.

 <dig>  permute step: if there are two or more variables in the grouping model, propose to permute order of the components in y. permuting the order of y will change the generalized dirichlet tree structure and will result in a different generalized dirichlet model for the set of grouping variables. set maxperm to be the maximum number of permutations to be considered at any iteration. used here was a maximum of  <dig> permutations. setting a maximum is necessary for computational efficiency, because if there are m variables in the grouping set, the number of possible permutations is m! and increases quickly as more variables are added to the grouping set. the number of permutations, nperm, considered at a particular iteration is defined as the minimum of m! and maxperm. calculate the bic for the currently fitted generalized dirichlet model, and then fit generalized dirichlet models to nperm randomly generated permutations of the grouping variables, y. let the permutation with the largest bic be the proposal model. if the proposal model has a larger bic than the current generalized dirichlet model, let the proposal model be the current model for the grouping variables. as an example, if  is the current grouping set, evaluate the bic of the current generalized dirichlet model, fitted to . consider the permutation . evaluate the bic of a generalized dirichlet distribution fitted to . if this is larger than the current bic, then let the current grouping set be .

 <dig>  termination: iterate over steps  <dig> to  <dig> until an add, remove, and permute proposal are rejected in succession. the selected components y at this point, and their selected ordering, are the optimal feature set to be returned from the algorithm.

figure
 <dig> demonstrates a possible initialization step as well as an iteration over an add, remove, and permute step of the above algorithm, for a composition y with five components. depicted are some possible generalized dirichlet tree structures that could be obtained if the proposals to add, remove, and permute are all accepted.

competing feature selection methods
two alternative methods for feature selection were applied to the glycan chromatography data for comparison with the proposed gdfs method. the first is the correlation-based feature selection  algorithm developed by hall
 <cit> , while the second is a classification tree method developed by breiman et al.
 <cit> . these methods do not make implicit assumptions about the distribution of the data, and so they are both suitable for compositional data analysis. a brief outline of each method is provided here.

cfs: hall
 <cit>  proposed a correlation-based feature selection method, involving a best-first search over the feature space, evaluating subsets of features based on their “merit”. continuous features are first discretized using the mdl method of fayyad and irani
 <cit> . the degree of association between each pair of features, as well as the association between each feature with the class variable, is calculated by symmetrical uncertainty. that is, for any two nominal variables x and y,


  symmetrical uncertainty=2×h−hh+h 

where


  h=−∑y∈yplog2p 

is the entropy of y, with the proportion of observations at level y of y denoted by p and


  h=−∑x∈xp∑y∈yplog2p 

is the conditional entropy of y given x. cover and thomas
 <cit>  provide a comprehensive review of information theory, including a detailed discussion on entropy. here, p is the proportion of observations observed at level y of y, within level x of x.

the “merit” is a heuristic measuring the predictive ability of a feature set, divided by the redundancy of that feature set. for a selected set of features s, the merit is calculated by


  merits=krcf¯k+krff¯ 

where
rff¯ is the average symmetrical uncertainty between all pairs of features in s,
rcf¯ is the average symmetrical uncertainty between the features and the class variable, and k is the number of features in s. the idea behind using the merit as a heuristic for feature selection, is that a “good” set of features will be highly correlated with the class variable, but not highly correlated with each other.

the best-first search algorithm starts at an empty node . predecessors of the current node, s, are the set of nodes generated by adding each of the currently omitted features to the feature set at the current node. the algorithm terminates when five consecutive fully expanded nodes have provided no improvement in the merit score, or when all nodes have been visited . in the case where the merit score does not improve from zero, an empty feature set should be returned. pseudocode for the correlation based feature selection algorithm is provided in appendix c. construction of classification trees using recursive partitioning. further technical details are given by hall
 <cit> .

to obtain measures of classification performance for the chosen feature set, dirichlet distributions are fitted to each group, using the selected feature set. posterior probabilities are calculated using a maximum a posteriori  classification rule. further details are provided in the section below.

rpart: baxter and jackson
 <cit> , ranganathan and borges
 <cit> ], and vermeesch [ <cit>  use classification tree methods for compositional data analysis. the method used here is the same as that applied by baxter and jackson
 <cit> , a recursive partitioning algorithm developed by breiman et al.
 <cit> . model fitting is carried out by the rpart package in r
 <cit> . a brief summary of the methodology employed by rpart is included in appendix b. derivation of the generalized dirichlet probability density function. more technical details of the recursive partitioning algorithm and the software implementation may be found in the technical report by therneau and atkinson
 <cit> .

classification and selection bias
each of the feature selection methods described above choose a set of “grouping” features and return a set of posterior group probabilities for the observations in y. statistical classification is used to measure how well a selected feature set separates the set of known groups, to determine whether the feature selection algorithm has chosen a “good” feature set. maximum a posteriori  classifications, calculated from the selected feature set, are used assign observations to groups.

in feature selection, where a classification rule is formed on the selected feature set, using the same samples that were used to select those features, there are two major sources of bias that can be introduced. the first is classification bias, where a classification rule is trained and tested on the same dataset. the second is selection bias, arising where the classification rule is tested on observations that were used to select the set of features that form the classification rule. ambroise and mclachlan
 <cit>  review this problem and suggest two alternative means of overcoming such bias in feature selection problems. their recommendation of calculating the misclassification error external to the feature selection process is followed here. leave-one-out  cross-validation is used during the feature selection process to avoid the introduction of selection bias. statistical classifications obtained during the gdfs method are carried out in the following manner: for each observation j, 

 <dig>  observation j  is omitted from the data, and feature selection is carried out on the remaining observations .

 <dig>  for each group of observations in the training data, a generalized dirichlet distribution is fitted to the selected feature set, y.

 <dig>  using the fitted generalized dirichlet models fitted to y for each group defined by z, posterior group probabilities are calculated for observation i using bayes rule:


  p)=τgfzi=g)∑j=1gτjfzi=j)forg= <dig> ,…,g 

where g is the number of groups in the data.

 <dig>  observation i is classified to some group g using the map classification rule, so observation yi is assigned to group g if


  g=argmaxjp)forj= <dig> ,…,g. 

because the glycan chromatography datasets are from observational studies, the number of patients in each group is not representative of the general population, and so we assume here that the prior probability of group membership is equal across all groups. selection bias is avoided, since observation j is not used in the selection of the feature set that it is classified under.

the above procedure is repeated for each observation i. the cross-validated error rate is then calculated as the proportion of observations that were incorrectly classified by the above method.

for correlation-based feature selection, classifications are obtained in the same manner, except that the assumption is made that the selected grouping features are distributed according to a dirichlet distribution, rather than a generalized dirichlet distribution. then in step  <dig>  a dirichlet distribution is fitted to the grouping features with observation i omitted, and at steps  <dig>  the probability density functions in equation  <dig> correspond to the dirichlet rather than generalized dirichlet distributions fitted to each group.

for the recursive partitioning  method the same steps for the classification of observations are used, with the exception of steps  <dig> and  <dig>  posterior probabilities for a classification tree are defined within the tree construction process. each leaf in the tree has an associated set of posterior probabilities for each group, corresponding to the proportions of observations in the training data that belonged to each group, that were classified to that leaf node. posterior group probabilities are obtained for a new observation by dropping it down the tree until it reaches a leaf node. the posterior group probabilities for that observation are the class proportions assigned to that leaf during the building of the tree. these probabilities are used in place of those obtained from steps  <dig> and  <dig> in the above algorithm.

measures of classification performance
classification results for each feature selection method are reported via a cross-tabulation of the true and predicted group memberships. also included are the following measures of classification performance:


cross-validation error: the proportion of observations incorrectly classified, calculated by the proportion of observations on the off-diagonal of the confusion matrix.


kappa: cohen’s kappa statistic
 <cit>  is another measure of class agreement, recording the proportion of observations correctly classified, corrected for classification by chance. it is calculated as κ=/, where o is the observed or actual proportion of observations correctly classified and echance is the expected proportion of observations that would be classified correctly by chance. if all observations are correctly classified, then κ= <dig>  if the classification performance is no better than what one could expect by chance, κ≤ <dig> 


sensitivity: the proportion of true positives. in assessing the diagnostic accuracy of a test, the sensitivity is measured by the proportion of disease cases correctly diagnosed by the test. for life threatening diseases, a test with high sensitivity is vitally important.


roc curves: roc curves allow for the visualization of the true positive rate  against the false positive rate  of a classifier, where the probability threshold for classification is varied over the interval  <cit> . roc curves and their corresponding auc  values are commonly reported in the biological sciences, so these are also included as performance measures for each of the feature selection methods.


auc: area under a roc curve. values range between  <dig> and  <dig>  with larger values indicating better classification performance. fawcett
 <cit>  gives a useful interpretation of the auc, as being equivalent to the probability that a randomly chosen disease case will be ranked higher than a randomly chosen control, by the classifier.

software
all statistical analyses were carried out using r version  <dig> 
 <cit> . roc curves were constructed and auc values estimated using the rocr package in r
 <cit> , while classification trees were fitted using the rpart package.

n-glycan analysis
n-glycan analysis was carried out on two datasets, from a lung cancer study and a prostate cancer study. samples were obtained with ethical consent from their respective sources. the glycan analysis was carried out using hilic. details on experimental conditions are provided below.

lung cancer serum samples
serum samples from preoperative patients diagnosed with lung cancer and cancer-free healthy volunteers were obtained from fox chase, cancer center, philadelphia, usa under irb approved protocols. they were from both males and females. patient sera  were examined alongside  <dig> age-matched control sera from donors who did not have cancer.

n-glycan analysis was carried out by hilic flouresence using a 60-minute method. the glycan hilic profiles produced were integrated over a set of  <dig> glycan peaks, resulting in a  <dig> part compositional vector for each observation. an example of one such glycan hilic profile is shown in figure
 <dig>  further details on the analysis may be found in arnold et al.
 <cit> .

prostate cancer serum samples
samples were collected with consent from prostate cancer patients before undergoing radical prostatectomy and from men with benign prostate hyperplasia  following a standard operating procedure, which is part of the prostate cancer research consortium bioresource. ethical consent was granted from respective hospital ethics committee of the consortium. blood samples  were collected into anticoagulant-free tubes. samples were coded and transported on ice to the laboratory. the tubes were centrifuged at  <dig> rpm at 20°c for  <dig> min. within a  <dig> min. time frame. serum from each patient sample was then collected, aliquoted, and stored at –80°c until time of analysis. each serum sample underwent no more than three freeze/thaw cycles prior to analysis. n-glycan analysis was carried out by hilic fluorescence using a  <dig> minute method. the glycan hilic profiles produced were integrated over a set of  <dig> glycan peaks, resulting in a  <dig> part compositional vector for each observation in our data. an example of one such glycan hilic profile is shown in figure
 <dig>  further details on the data collection and analysis may be found in saldova et al.
 <cit> .

n-glycan analysis for patients with lung and prostate cancer
n-glycans were released from serum using the high-throughput method described by royle et al.
 <cit> . briefly, serum samples were reduced and alkylated in 96-well plates, and then they were immobilized in sds-gel blocks and were washed. the n-linked glycans were released using peptide n-glycanase f  as described previously
 <cit> . glycans were fluorescently labeled with 2-aminobenzamide  by reductive amination
 <cit>  . hilic was performed using a tsk-gel amide- <dig> column  on a  <dig> alliance separation module  equipped with a waters temperature control module and a waters  <dig>  or  <dig>  fluorescence detector. solvent a was  <dig> mm formic acid which was adjusted to ph  <dig>  with ammonia solution. solvent b was acetonitrile. the column temperature was set to 30°c. gradient conditions were as follows:  <dig> min. method - a linear gradient of  <dig> to 47% solvent a over  <dig> min. at a flow rate of  <dig>  ml/min, followed by  <dig> min. at  <dig> to 100% a and  <dig> min. at 100% a, returning to 35% a over  <dig> min., and then finishing with 35% a for  <dig> min.
 <cit> . samples were injected in 80%  or 65%  acetonitrile. fluorescence was measured at  <dig> nm with excitation at  <dig> nm. royle et al.
 <cit>  described the n-glycosylation in human serum in detail and showed that there are  <dig> n-glycans present.

this method enables the analysis of glycan isoforms based on sequence and linkage . glycan size and linkage result in a specific elution position that can be converted to glucose units  using a dextran hydrolysate standard ladder
 <cit> .

glycan hilic peaks were integrated and relative peak areas calculated using the waters empower  <dig> chromatography data software. thus, each serum sample generates a data observation, consisting of the set of relative proportional peaks areas from a glycan hilic profile.

RESULTS
the proposed gdfs method was applied to the lung and prostate cancer datasets. the results are compared with those of two well-established feature selection methods; correlation based feature selection and recursive partitioning .

for the lung cancer dataset, the group structure is redefined as control versus cancer. all three feature selection methods perform reasonably well. the gdfs method gives the best performance with a classification rate of approximately 75% and an aucvalue of  <dig> .

two different group structures are considered for the prostate cancer dataset. feature selection was carried out on the data, with cases grouped as control or prostate cancer, to determine whether any features could have diagnostic value for prostate cancer. however, none of the feature selection methods were successful at classification. cfs chooses no features most of the time, while the other two methods produce feature selection with very poor classification performance.

the other research question of interest for the prostate cancer dataset was whether glycosylation could be used as a marker of disease progression. thus, feature selection was also applied to the prostate cancer samples, classified as into gleason  <dig> and gleason  <dig> cases. a gleason score of  <dig> indicates a more advanced cancer of the prostate.

the results from these analyses are shown here. following the discussion of these feature selection results is a note on the computational complexity of the gdfs method used and its behaviour in moving to higher dimensions.

lung cancer data
jemal et al.
 <cit>  reported that lung cancer is the most common cancer globally, responsible for  <dig>  million deaths each year. it has a very poor 5-year survival rate of 8–16%, that is mainly attributable to the disease only presenting symptoms when it reaches an advanced stage
 <cit> . early stage detection of lung cancer could greatly improve the outlook of patients. ghosal et al.
 <cit>  highlight that, in an attempt to reduce the mortality rates of this disease, much research has been carried out in the area of lung cancer screening and biomarker discovery. serum biomarkers would provide a non-invasive method for cancer diagnosis. however, although a number of potential biomarkers have been identified, none to-date seem to have adequate sensitivity, specificity or reproducibility to be used in clinical diagnostics.

arnold et al.
 <cit>  conducted a study to investigate alterations or irregularities that occur in the serum n-glycome of lung cancer patients. the main objective was to identify a set of glycan structures that have biomarker potential.

feature selection was carried out on the glycan chromatography dataset from this study using the proposed gdfs method, as well as two competing methods, cfs and rpart. the results are compared here.

feature selection for lung cancer data
as it is extremely difficult to distinguish between different stages of lung cancer, all  <dig> stages of cancer were combined for statistical analysis. feature selection was carried out to identify a set of features  that differ between the chromatograms of the control and lung cancer cases. since all models were fitted using leave-one-out cross-validation, feature selection was carried out  <dig> times for each model, omitting a different observation each time. this means that the same set of features were not picked out in each cross-validation run. figure
 <dig> shows the proportion of times each feature  was selected by each feature selection method.

all three methods are quite consistent in the features they select. the gdfs method  identifies  <dig> peaks, cfs  identifies  <dig> peaks, and rpart  identifies only one peak in all class validation runs. all three methods select peak  <dig> as being an important feature for differentiating between control and lung cancer cases. table
 <dig> lists features that were selected at least 90% of the time for each method. tabulated alongside are the predominant glycan structures associated with the selected glycan peaks. these were identified from royle et al.
 <cit>  and verified by exoglycosidase digestions, as described by arnold et al.
 <cit> .


features selected from the lung cancer dataset  by the proposed gdfs method , correlation-based feature selection , and recursive partitioning . features that were selected in 90% or more of the cross-validation models are marked with
✓. also listed are the predominant glycan structures corresponding to each selected peak. detailed n-glycan composition of human serum was described in
 <cit>  and these peaks were also assigned in
 <cit> . nomenclature has been used according to
 <cit> : all n-glycans have two core glcnacs; f at the start of the abbreviation indicates a core fucose α1- <dig> to inner glcnac; man , number  of mannose on core glcnacs; a, number of antenna  on trimannosyl core; b, bisecting glcnac linked β1- <dig> to β1- <dig> mannose; f, number  of fucose linked α1- <dig> to antenna glcnac, g, number  of galactose on antenna;  <cit> g <dig> and  <cit> g <dig> indicates that the galactose is on the antenna of the α1- <dig> or α1- <dig> mannose; s, number of sialic acids on antenna.


structural assignments of n-glycans to the peaks on a hilic chromatogram are made using the glycobase software . campbell et al.
 <cit>  provide further details.

table
 <dig> shows cross-tabulations of the true group membership with the classifications assigned by each feature selection method using a map classification rule. table
 <dig> lists measures of classification performance for the three methods. the gdfs method outperforms both cfs and rpart on all measures of classification performance, with a cross-validation error of  <dig> , compared with  <dig>  for rpart and  <dig>  for cfs. it has a sensitivity rate that is 8% higher than the sensitivity rate for rpart and 9% higher than for cfs. figure
 <dig> shows roc curves for the gdfs method , the cfs , and rpart . the  <dig>  thresholds for each are marked “x” and correspond to classifications obtained from a map classification rule. the auc for the gdfs method  is larger than for the other two methods , reflecting its superior classification performance.


statistical classifications of the lung cancer dataset  from the proposed gdfs method , correlation-based feature selection , and recursive partitioning . in each case, posterior group probabilities were calculated for each observation j using features selected, and model parameters estimated, with observation j omitted . observations were then classified using a map classification rule. this table shows the cross-tabulations of true group membership with the assigned classifications from gdfs, cfs and rpart.


evaluation of classification performance from feature selection in the lung cancer dataset  for the proposed gdfs method , correlation-based feature selection , and recursive partitioning . reported are the cross-validation error , cohen’s kappa statistic, sensitivity, and auc  for the statistical classifications from each method.
 <cit> . ‘x’ marks the  <dig>  classification threshold on each roc curve.

prostate cancer data
jemal et al.
 <cit>  observed that, globally, prostate cancer is the second most frequently diagnosed cancer in males and is the sixth most common cause of cancer death in males, based on figures from  <dig>  prostate cancer is one of the most commonly diagnosed cancers in men. prostate specific antigen  is a glycoprotein that is currently used as a clinical biomarker for this disease, but this glycoprotein is lacking in sensitivity and specificity. in fact, the u.s. preventative services task force  have recently issued a draft recommendation against psa screening
 <cit> , after concluding that psa-based screening for prostate cancer results in little or no reduction in the prostate cancer-specific mortaility. they also suggest that the screening may do more harm than good, due to the harms associated with evaluations or treatment carried out subsequent to screening. several other potential biomarkers for this disease have been identified, but none that appear to be sensitive or specific enough for clinical use. thus, there is an urgent need for further developments in this area.

saldova et al.
 <cit>  conducted a study to investigate whether patterns of glycosylation are useful in differentiating between cases of prostate cancer and benign prostate hyperplasia . bph is an enlargement of the prostate gland and is very common in men, especially as they age. bph can present similar symptoms to prostate cancer and is also associated with elevated psa levels. it would be extremely useful to identify a biomarker that can distinguish between these conditions. the study by saldova et al.
 <cit>  was carried out using  <dig> prostate cancer cases  and  <dig> men with bph. the gleason score is a currently used measure of disease severity. it ranges from  <dig> to  <dig>  with a higher score indicating a more advanced stage of disease.

variable selection for prostate cancer data - cancer vs. bph
feature selection was performed to select a set of features  that differ between the chromatograms of the  <dig> prostate cancer cases and the  <dig> bph cases in the prostate cancer dataset. three methods are compared here; the proposed gdfs method, correlation-based feature selection , and recursive partitioning . since the models were fitted using leave-one-out cross-validation, feature selection was carried out  <dig> times in each case. figure
 <dig> shows the proportion of times each feature  was selected out of the  <dig> cross-validation runs, for each feature selection method. correlation-based feature selection consistently selects no features for this dataset. this is due to the fact that when each of the compositional components are discretized according to the method of fayyad and irani
 <cit> , all features are assigned to be single level factors. where this is the case, the “merit” of any selected feature set is equal to zero, and hence an empty feature set is returned. table
 <dig> lists the peaks that were identified 90% of the time or more for each method. the gdfs method most commonly selected peaks  <dig>  and  <dig>  the rpart method chose peak  <dig> most frequently, but for less than 90% of the cross-validation runs. table
 <dig> also lists the predominant glycan structures corresponding to these most commonly selected glycan peaks.


features selected from the prostate cancer dataset  by the proposed gdfs method , correlation-based feature selection , and recursive partitioning . features that were selected in 90% more of the cross-validation models are marked with
✓. also listed are the predominant glycan structures corresponding to each selected peak. detailed n-glycan composition of human serum was described in royle et al.
 <cit> , and peak  <dig> was also assigned in saldova et al.
 <cit> . *peak  <dig> was the most commonly identified feature by the rpart method, although it was selected less than 90% of the time. **peak  <dig> was selected more than 60% of the time by the gdfs method.

table
 <dig> shows cross-tabulations between the true group membership and the classifications assigned by each feature selection method using map classifications. no classifications were obtained for correlation-based feature selection, since most of the cross-validation models returned no features.


statistical classifications of the prostate cancer dataset  from the proposed gdfs method , correlation-based feature selection , and recursive partitioning . in each case, posterior group probabilities were calculated for each observation j using features selected, and model parameters estimated, with observation j omitted . observations were then classified using a map classification rule. this table shows the cross-tabulations of true group membership with the assigned classifications from the the gdfs, cfs, and rpart methods.

table
 <dig> compares the feature selection methods on four different measures of classification performance. neither the gdfs search or the rpart method classify the data well, but the gdfs method outperforms rpart at a  <dig>  probability cut-off, having a slightly lower cross-validation error rate and a higher sensitivity rate.


evaluation of classification performance from feature selection in the prostate cancer dataset  for the proposed gdfs method , correlation-based feature selection , and recursive partitioning . reported are the cross-validation error , cohen’s kappa statistic, sensitivity, and auc  for the statistical classifications from each method.

figure
 <dig> shows roc curves for the gdfs method  and rpart . the  <dig>  probability threshold is marked “x” on each and correspond to classifications obtained from a map classification rule. the roc curve for the rpart method has a higher auc value  than the auc value for the gdfs method . again, both methods perform poorly, suggesting that there is little difference between bph and cancer groups for this dataset.
 <cit> . ‘x’ marks the  <dig>  classification threshold on each roc curve.

variable selection for prostate cancer data - disease progression
in addition to the separation of bph from prostate cancer samples, it is desirable to see whether the serum n-glycan profile changes as prostate cancer progresses. gleason scores are assigned to prostate cancer cases based on the microscopic appearance of the cancerous tissue. they range from  <dig> to  <dig>  with grade  <dig> having the worst prognosis. feature selection was carried out on the prostate cancer samples from the study by saldova et al.
 <cit> , to investigate whether there differences in the chromatograms of the  <dig> gleason  <dig> and  <dig> gleason  <dig> cases. three feature selection methods are compared; the proposed gdfs method, correlation-based feature selection , and a recursive partitioning .

since all models were fitted using leave-one-out cross-validation, feature selection was carried out  <dig> times for each method, omitting a different observation each time. figure
 <dig> shows the proportion of times each feature  was selected for the three feature selection methods. the gdfs search and cfs methods were very consistent in the features selected over the cross-validation runs, while the rpart method was somewhat less consistent. table
 <dig> marks the glycan peaks that were selected in 90% or more of the cross-validation runs. also tabulated are the predominant glycans that correspond to these selected peaks. the gdfs method consistently selects  <dig> peaks, and cfs frequently selects the same peaks, with the exception of peak  <dig>  the rpart classification tree method is not very consistent and does not select any peak more than 80% of the time.


features selected from the prostate cancer dataset  by the proposed gdfs method , correlation-based feature selection , and recursive partitioning . features that were selected in 90% more of the cross-validation models are marked with
✓. also listed are the predominant glycan structures corresponding to each selected peak. detailed n-glycan composition of human serum was described in royle et al.
 <cit> , and these peaks were also assigned in saldova et al.
 <cit> . *peak  <dig> was the one most frequently selected by rpart, but less than 80% of the time.

table
 <dig> shows cross-tabulations between the true group membership and the classifications assigned by each feature selection method , while table
 <dig> compares the methods on four different measures of classification performance. the gdfs search gives the smallest cross-validation error of  <dig> . it also has higher sensitivity for detecting more severe cases of prostate cancer . figure
 <dig> shows roc curves for the gdfs method , cfs , and rpart . the  <dig>  thresholds for each are marked “x” and correspond to classifications assigned by a map classification rule. from the roc curves, it is clear that the gdfs method markedly outperforms the other two methods, with a larger auc of  <dig>  .


statistical classifications of the prostate cancer dataset  from the proposed gdfs method , correlation-based feature selection , and recursive partitioning . in each case, posterior group probabilities were calculated for each observation j using features selected, and model parameters estimated, with observation j omitted . observations were then classified using a map classification rule. this table shows the cross-tabulations of true group membership with the assigned classifications from the gdfs, cfs and rpart methods.


evaluation of classification performance from feature selection in the prostate cancer dataset  for the proposed gdfs method , correlation-based feature selection , and recursive partitioning . reported are the cross-validation error , cohen’s kappa statistic, sensitivity, and auc  for the statistical classifications from each method.
 <cit> . ‘x’ marks the  <dig>  classification threshold on each roc curve.

search strategy and computational complexity
for a dataset of dimension p, the cardinality of the feature space increases exponentially with p. an exhaustive search over this space would involve an evaluation of all possible solutions and for this problem has complexity 2p. that is, for p variables, there are 2p possible solutions to the feature selection problem. an exhaustive search would certainly be possible for a relatively small number of variables, but the computational complexity increases quickly. a dataset with  <dig> variables has  <dig> , <dig> possible solutions in the feature selection problem!

glycan chromatography data being produced is of a relatively low dimensionality at present. it has been found that there are  <dig> glycans in human serum
 <cit> , and therefore, it can be expected that the number of variables in the glycan chromatography data will increase as technology becomes more advanced. for example, bones et al.
 <cit>  recently showed that ultra performance liquid chromatography  allows for the quantification of the glycan pool by a chromatogram consisting of  <dig> glycan peaks, under certain experimental conditions.

table
 <dig> shows the expected behaviour of the gdfs algorithm with increasing data dimensionality , using datasets simulated from dirichlet distributions. the parameters for a subset of the compositional variables  were set to differ across two groups of  <dig> observations each. reported are the run times  for the gdfs, correlation-based feature selection, and recursive partitioning methods. the gdfs and correlation-based feature selection methods were implemented manually in r, while recursive partitioning was implemented using the rpart package in r
 <cit> . alongside the run times are the discrepancies between the true and selected feature sets, calculated as the sum of the number of incorrectly selected features and the number of true features that were not selected. from this table, it is clear that while the gdfs algorithm is less efficient computationally, it has a much higher accuracy than the other two methods for our simulated datasets.


time taken  to carry out feature selection using a greedy search approach for simulated datasets of increasing data dimensionality, p. tabulated alongside are the run times for cfs, and rpart corresponding to these same datasets. data were simulated from ordinary dirichlet distributions across two groups, with  <dig> observations in each group. approximately one third of the variables were set to differ between groups . reported in brackets beside the run times are the number of discrepancies between the true set of grouping variables and the selected feature set. the number of discrepancies was calculated as the sum of the number of variables that were incorrectly selected as features and the number of true grouping variables that were not selected by the selection algorithm.

murphy, dean, and raftery
 <cit>  used the headlong search strategy proposed by badsberg
 <cit>  in their variable selection. they add  the first variable whose bic difference is greater than  a pre-specified value. this removes the necessity to search through all variables at each iteration, reducing computational time dramatically over an ordinary greedy search strategy. however, they state that the variables selected using this method may change depending on the initial ordering of variables in the dataset. they preferred this approach, as they had over  <dig> variables to consider in their application. since glycan chromatography datasets are relatively low-dimensional, we avoid this issue by using considering all possibilities of variables to add or remove at each iteration.

CONCLUSIONS
biomarker discovery is of the utmost importance for disease discovery and treatment. the field of glycobiology shows great potential in this area and is continually improving technologies to advance research into the identification and validation of glycan biomarkers. glycan analysis is commonly carried out using high-throughput chromatography techniques, that give rise to compositional data. the compositional nature of the data is commonly ignored in statistical analysis, mainly due to lack of awareness of the special considerations that are required for the analysis of such data.

there is a substantial need in the field of glycobiology for a statistical toolbox of suitable methods for dealing with the compositional glycan chromatography data. this article hopes to contribute a novel method for feature selection that could be used for identifying sets of potential biomarkers. the method carries out a greedy search over the space of all possible sets of features, seeking the set of features that best discriminates between a set of defined groups in the data. the generalized dirichlet distribution and its marginal, the beta distribution, are used to model compositional components , since they suitable for proportional data. the bic is used for model selection.

this methodology was tested on two glycan chromatography datasets, from the lung cancer study by arnold; et al.
 <cit>  and the prostate cancer study by saldova et al.
 <cit> . two other well-established methods were applied to these datasets for comparison - correlation based feature selection  and a recursive partitioning method for classification tree construction . for the lung cancer dataset, a set of  <dig> peaks are consistently identified by the gdfs method as differing between the lung cancer and clinical control cases . peaks  <dig>   <dig>  and  <dig>  included in this selected feature set, contain the sialyl lewis x  epitope, which is known to be increased in cancer and important for cancer progression
 <cit> . for the prostate cancer dataset, peaks  <dig> and  <dig> are consistently identified by the gdfs method as potential glycan biomarkers for differentiating between bph and prostate cancer. peak  <dig> contains core-fucosylated bi-antennary glycans, and peaks  <dig> and  <dig> contain bisected bi-antennary glycans. our findings are consistent with previous results showing that core-fucosylation is altered in cancer and bisects are decreased in cancer
 <cit> . regarding separation of different disease stages, five n-glycan peaks were selected by the gdfs method  as differing between gleason  <dig> and gleason  <dig> cases. this indicates a decrease in triantennary trigalactosylated glycans and in tetraantennary tetrasialylated outer arm fucosylated glycans and an increase in tetraantennary tetrasialylated glycans in gleason  <dig> compared with gleason  <dig> prostate cancer patients
 <cit> .

in general, the proposed gdfs method outperformed both cfs and rpart on classification performance, although it is somewhat slower computationally. importantly, the sensitivity of the classifiers was largest for the gdfs method in all cases, meaning that more of the actual lung cancer cases were detected. from our results, we conclude that the proposed gdfs method provides a useful tool for feature selection in compositional glycan chromatography data.

this method has been developed specifically with glycan chromatography data in mind and accounts for the special constraints on a compositional dataset, since the data are modelled in a simplex sample space. it has been used for feature selection in the context of supervised learning, where the data have a known group structure, but may easily be extended for use with unsupervised learning methods, such as model-based clustering, as in raftery and dean
 <cit> .

appendix
a. change of variable rule
let y be a continuous random variable with probability density function fy, and let
y~=g be an invertible function of y, with inverse function
y~=h. then the probability density function of y may be written in terms of the probability density function of
y~ as:


  fy=fy~)|h′| 

where h′ is the derivative of
y~=h with respect to y.

b. derivation of the generalized dirichlet probability density function
if y= is a unit-sum composition following a generalized dirichlet distribution, then
y~ is a completely neutral vector, meaning that the components of the vector


  y~=h=y11−s <dig> y21−s <dig> …,yp1−sp− <dig> 

are mutually independent, where s0= <dig> and
sj=∑m=1jsm for m= <dig> ,…,p. note that the last component of
y~ is degenerate, since it is equal to one. since y is a generalized dirichlet random vector, the marginal distributions of the elements of
y~ are beta distributions, so that
y~j∼beta for j= <dig> ,…,p− <dig> 

denote the probability density function of yj, conditional on , by fj for j= <dig> ,…,p− <dig>  the probability density function for
y~ is the product of p− <dig> independent beta distributions. thus, the probability density function for y may easily be derived in terms of the probability density function for
y~. firstly, the density function for y can be written as the product of p− <dig> conditional distributions


  f=fyi <dig> yi <dig> …,yi=f1f2…fp−1|yi <dig> yi <dig> …,yi), 

using the rules of conditional probability and because one component of a compositional vector is degenerate, conveniently chosen here to be yp. making the change of variable
y~ij=h=yij/ for j= <dig> ,…,p− <dig>  gives rise to jacobian terms


  ∂∂yijyij1−si,j−1=11−si,j− <dig> 

for j= <dig> ,…,p− <dig>  denoting the probability density function for each
y~j by gj, and noting that
y~j∼beta, distributed independently of  gives


 f=g1yi11−si,0g2yi21−si,j−1yi1…gp−1yi1−si,p−2yi <dig> yi <dig> …,yi×11−si,011−si,1…11−si,p− <dig>  . . jacobian terms=∏j=1p−1gjyij1−si,j−111−si,j−1=∏j=1p−11byij1−si,j−1αj−1×1−yij1−si,j−1βj−11−si,j−1−1=∏j=1p−11byijαj−11−si,j−11−αj−βj1−si,j−1−yijβj−1=∏j=1p−11byijαj−11−si,j−11−αj−βj1−si,jβj−1=∏j=1p−11byijαj−1∏j=1p−11−si,j−1βj−1−αj−βj×βp−1− <dig> 

since 1−si,0= <dig>  note that 1−si,p−1=yip, and then the probability density function for y∼gd is


 f=yipβp−1−1∏j=1p−11byijαj−1×1−si,j−1βj−1−αj−βj 

c. construction of classification trees using recursive partitioning
briefly, the classification trees fitted here are constructed by splitting observations into subsets that give the best separation between the set of known groups in the data. subsets of observations are represented by nodes in the classification tree. each node is labelled by the predominant class of observations at that node, and the misclassification error for any node is then the proportion of observations at that node that don’t belong to the predominant class.

all observations are included in the root node. a binary split of the observations at a given node is made by selecting the feature , and the split threshold for that feature that give the best separation of the classes. here, the feature set and cut threshold are selected to minimize the gini index, a measure of “impurity”, or the average misclassification error for the child nodes resulting from a binary split. then the observations at this node are split into two child nodes according to whether their observed values of the selected feature lie above or below the split threshold. the process is then repeated for the resulting child nodes.

the tree is expanded recursively in this manner until some stopping criterion is met, for example, until only observations in the same class are present at leaf nodes. to avoid over-fitting, the tree is then pruned back by snipping off nodes from the bottom up, selecting the branches to be pruned using a cost complexity measure:


  rα=misclassification error+ 

where α is a penalty term that controls the size of the tree. the final tree is then chosen as the “pruned” version of the full tree, that minimizes the cost complexity, rα. the value of α is estimated using the “1-se” rule proposed by brieman et al.
 <cit> . if α∈, then this interval may be partitioned into a set of sub-intervals , such that any value of α in the interval ij will give rise to the same subtree obtained from pruning the expanded tree by minimizing rα. the rpart function provides the cross-validated risk  along with its standard error, evaluated at the range of complexity parameters α equal to geometric means of the maximum and minimum values for each interval . any cost complexity score within one standard error of the minimum is then marked as being equivalent to the minimum. the optimum value of the complexity parameter α is the one the gives is the simplest of set of models at the “minimum” cost complexity .

d. pseudo-code for correlation-based feature selection
pseudocode for carrying out correlation-based feature selection for a set of variables .  

abbreviations
hilic: hydrophilic interaction liquid chromatography; cfs: correlation-based feature selection; rpart: recursive partitioning method for the construction of classification trees; gdfs: generalized dirichlet feature selection; bic: bayesian information criterion

competing interests
the authors declare that they have no competing interests.

authors’ contributions
mg performed the statistical analysis and drafted the manuscript. rs carried out the experimental analysis and assisted with the drafting of the manuscript. mpc assisted with the interpretation of the data and critically revised the manuscript. pmr conceived of the scientific studies and participated in their design and coordination. tbm conceived of the statistical methodology and helped to critically revise the manuscript. all authors read and approved the final manuscript.

