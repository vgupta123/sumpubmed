BACKGROUND
viruses outnumber all other known life forms on earth. furthermore, viruses in general and rna viruses in particular have a huge genetic diversity, which is the driving force of their evolutionary success. viral genomic diversity is well captured in the term ‘quasispecies’. the term ‘quasispecies theory’ was first introduced by manfred eigen as a theoretical model to study molecular evolution by mutation and selection in self-reproducing macromolecules  <cit> . later, the term was also used to describe an rna virus population consisting of a mixture of related genomes  <cit> . a viral quasispecies is defined as a proliferating population of non-identical but closely related viral genomes in a mutation-prone environment subjected to continuous competition and selection  <cit> . biologically, the quasispecies is the level at which selection takes place  <cit> . human influenza viruses represent a prototypical example of rapid virus evolution facilitated by error-prone genome replication combined with the selection pressure imposed by host immune responses. this situation favors the emergence of fit mutant viruses that escape the herd immunity induced by infection with parental viruses or by vaccination  <cit> .

influenza is an acute and highly contagious viral disease of the respiratory tract in humans. it is caused by influenza a and b viruses and occasionally by influenza c virus. these viruses represent three of the five genera of the orthomyxoviridae family, which is characterized by enveloped viruses that have a segmented, single-stranded, negative sense rna genome  <cit> . replication of the rna genome of influenza viruses is associated with a relatively high mutation rate  because the viral rna-dependent rna polymerase lacks 3′-5′-exonuclease activity and therefore has no proof-reading function  <cit> . mutations that are introduced during replication are tolerated because they are neutral for virus fitness in a particular environment, rapidly lost because they reduce fitness, or expanded because they are advantageous  <cit> .

the mutation rate of influenza a viruses has been traditionally determined by sequencing different cdna clones obtained from multiple plaques descending from a plaque-purified influenza a virus  <cit> . in other words, viral genomes that are fit enough to generate plaques were sequenced. this approach revealed a mutation rate of approximately  <dig>  × 10− <dig> per nucleotide per infectious cycle. sequence analysis of multiple clones of cdna fragments derived from one or more gene segments has also been used to study sequence variation of influenza virus derived from clinical samples  <cit> . in addition, deep amplicon sequencing of one or two gene segments from avian h7n <dig> and equine h3n <dig> influenza viruses has been applied to study within and between host genetic variation  <cit> . however, identification of the extent of genetic variation in a viral quasispecies under a given condition requires a highly accurate sequencing method that does not rely on molecular cloning, or a phenotypic selection method such as plaque generation. next-generation sequencing  seems to fulfill this requirement  <cit> . however, experimental errors are introduced during the preparatory steps, i.e. reverse transcription and pcr amplification, and the ngs method itself is also an error-prone process  <cit> .

ngs enables sequencing of multiple gigabases of dna in a single run; the output size depends on the sequencing instrument  <cit> . consequently, because the influenza genome consists of only  <dig>  ribonucleotides, it is straightforward to sequence it at high coverage . however, its segmented rna genome makes it technically challenging to obtain full genome coverage. stoichiometric rt-pcr amplification of each of the eight genomic rna segments is difficult, in particular when starting from ex vivo samples such as nasal swabs or bronchoalveolar lavage from experimentally infected animals. ngs studies of influenza virus reported to date did not start from the amplification of all eight full-length genomic segments in sufficient amounts in a single reaction, and homogeneous coverage across all eight segments was not always obtained  <cit> .

here, we compared the suitability of two ngs methods to determine the influenza a virus quasispecies diversity. we deep-sequenced a/puerto rico/8/ <dig>  influenza virus, which is used extensively in many research laboratories for in vitro and mouse experiments. in addition, pr <dig> virus is used as a donor to generate egg-grown reassortant viruses for seasonal influenza vaccine production. importantly, we also took advantage of the available plasmid-based reverse genetics system for pr <dig> virus because it is a genetically stable equivalent of the virus  <cit> . we compared the quality of the primary sequence data, the read length, the coverage across the viral genome, the method-associated error rate, and the sensitivity of two modern ngs platforms: the illumina miseq sequencing-by-synthesis and the ion torrent pgm semiconductor sequencing technique. for both sequencing platforms, we used the latest available software and the most recent chemistries available.

RESULTS
high-throughput sequencing of plasmid samples
our aim was twofold:  to compare the performance of two high-throughput sequencing instruments;  to determine the complexity of an influenza a virus quasispecies . we selected the illumina miseq and the ion torrent pgm sequencing platforms because the accuracy of single nucleotide polymorphism  identification of these two popular ngs platforms is unclear. a study by quail and colleagues concluded that the overall snp calling rate is slightly higher for the data generated by ion torrent pgm than for illumina miseq data  <cit> , whereas loman and colleagues reported a lower substitution error rate for the illumina miseq  <cit> .

we first compared the accuracy and sensitivity of these two sequencers. we used plasmid dna to compare the accuracy of the sequencing output because it is genetically very stable. we also generated a plasmid with two tracer mutations, which allowed us to prepare mixtures with different, defined amounts of wild type and mutant plasmid before sequence analysis, in order to determine the sensitivity of the sequencers for picking out the occurrence of the introduced snps. for this comparison, we chose plasmids that also allowed us to generate pr <dig> virus with or without the introduced tracer mutations  <cit> .

we generated a mutated version of plasmid phw197-m . this mutant has two silent mutations in the influenza virus m <dig> open reading frame  that served as tracers when mixing phw197-mmut and phw197-m plasmids at different ratios. because we intended to perform such mixing experiments with both plasmids and viruses generated from these plasmids, we carefully selected two silent mutations that most likely would not affect virus fitness. we chose these mutations based on their prevalence in human h1n <dig> virus isolates . we selected two silent mutations in m <dig>  which at the same time also added a restriction site to facilitate screening . these mutations were introduced in phw197-m at positions  <dig>  and  <dig> . so the resulting plasmid, phw197-mmut, had additional hindiii and pvuii restriction sites. the presence of these mutations was verified by restriction analysis and conventional sanger sequencing .figure  <dig> 
introduction of synonymous tracer mutations in gene segment  <dig> of pr <dig> virus.  schematic representation of the influenza m segment present in phw197-mmut. the open reading frames of m <dig> ) and m <dig>  are indicated. the resulting hindiii and pvuii restriction sites are indicated.  fluorograms showing the synonymous substitutions in phw197-mmut relative to phw197-m at positions  <dig>  and  <dig> . the predicted amino acid sequence is shown underneath the nucleotide sequence.



sequence read length
assuming an equal error rate per base, longer read lengths are preferred for the de novo sequence assembly. in addition, longer read lengths increase the likelihood that one can conclude whether mutations observed in a genomic segment are linked or not. the two point mutations that we introduced in the m gene segment are  <dig> nucleotides apart. therefore, to confirm the presence of these two mutations on the same dna molecule, read lengths after processing should be at least  <dig> nucleotides long. such a length should be obtained when using the ion torrent pgm  <dig> base-pair sequencing kits. the length distribution of the sequencing reads of the plasmid samples generated by both sequencers is shown in black in figure  <dig>  plasmid samples were fragmented with nextera xt transposase for illumina miseq and mechanically sheared by covaris, followed by adaptor ligation before ion torrent pgm sequencing. nearly 70% of the unprocessed reads obtained on the illumina miseq  have a length of 250 bp, and the mean read length is  <dig>  bp ±  <dig>  bp . the length of the unprocessed reads generated by the ion torrent pgm  follows a gaussian distribution with a peak around 280 bp and a mean read length of  <dig>  bp ±  <dig>  bp . these values are lower than expected since the ion pgm template ot <dig>  <dig> kit, ion pgm sequencing  <dig> kit and ion  <dig> chip v <dig>  that we used should offer sequence reads of 400 bp according to their manuals. as analyzed on a high sensitivity dna chip on the agilent bioanalyzer, the peak fragment size before emulsion pcr  was situated around 450 bp , indicating that covaris shearing and subsequent size selection did not account for this relatively short average sequence length. we note that junemann et al. also obtained fragments with the ot <dig>  <dig> kit that were shorter than expected  <cit> .figure  <dig> 
quality of sequencing reads obtained on the illumina miseq and ion torrent pgm platforms. the phw197-m and phw197-mmut plasmids  were fragmented with the nextera xt dna sample preparation kit  or with covaris mechanical shearing followed by adaptor ligation . distribution of the read lengths obtained on the illumina miseq  and ion torrent pgm  before processing  and after processing  the obtained sequencing reads. processing implies removal of adaptor contamination, quality trimming , the removal of ambiguous bases and removal of reads shorter than  <dig> bases. for the illumina miseq reads, broken pairs after read processing were also removed during the processing. error bars represent the standard deviation.  per-base quality distribution of sequencing reads. the phred score distribution  relative to the processed reads obtained after sequencing on the illumina miseq  and ion torrent pgm . x% ile = xth percentile of quality scores observed at that position.



in silico processing of the sequencing reads
accurate analysis of viral quasispecies composition has to be based on high quality reads to ensure that snps and insertions and deletions  can be confidently counted, because low quality reads could lead to over-interpretation of the number of mutations. in addition, high quality reads will lead to a higher accuracy of de novo sequence assembly. therefore, we performed a quality control using the clc genomics workbench software; we also propose a ngs data analysis pipeline that is generally applicable . first, we removed adaptor contamination and the low quality ends of the sequencing reads from the data generated by the two deep sequencing techniques. it was recently reported that applying a phred score of  <dig> or higher to filter illumina miseq ngs data dramatically reduces the noise in snp calling  <cit> . hence, we applied this quality threshold to all our plasmid-derived sequencing reads. a phred score is logarithmically related to the base-calling error probabilities. when a phred score of  <dig> is assigned to a base, it means that the chance that this base is called incorrectly is  <dig> in  <dig>  we also discarded ambiguous bases and read lengths below  <dig> bases, which further reduces the background because such short reads are often mapped inaccurately. this quality trimming and read length filtering retained  <dig> % ±  <dig> % of the illumina miseq and  <dig> % ±  <dig> % of the ion torrent pgm reads. on the other hand,  <dig> % ±  <dig> % of the bases sequenced on the illumina miseq and  <dig> % ±  <dig> % of the bases sequenced on the ion torrent pgm were retained. this indicates that the greatest loss of bases was due to quality trimming rather than read length filtering and that illumina miseq sequencing provides higher sequencing quality than ion torrent pgm. the resulting read length distribution after this in silico filtering is shown in orange in figure  <dig>  where the mean read length is  <dig>  bp ±  <dig>  bp on the illumina miseq and  <dig>  bp ±  <dig>  bp on the ion torrent pgm after processing of the reads.figure  <dig> 
next generation sequencing data analysis pipeline. schematic representation of the analysis pipeline for in silico processing of next-generation sequencing data.



quality of the sequencing reads
the per-base quality distribution on both sequencers, using the plasmid samples as template, is shown in figure  <dig>  bases with a phred score of  <dig>  are a measure of high quality data. for the processed reads obtained on the illumina miseq, the 25th percentile of the phred scores is ≥  <dig> until position  <dig>  and thus most of the sequencing reads are without sequencing error . for the reads obtained on the ion torrent pgm, the median of the phred scores is ≥  <dig> until position  <dig> . therefore, we conclude that the overall sequencing quality of the reads obtained on the illumina miseq is higher than that obtained on the ion torrent pgm.

mapping of the sequencing reads
to evaluate the accuracies of both sequencers, the processed reads were mapped to the plasmid reference sequence . the percentage of unmapped bases was lower for the illumina miseq  than for the ion torrent pgm . this is due to the lower quality of the ion torrent pgm sequencing reads, which reflects the intrinsic sequencing errors that lead to reduced alignment and a higher number of unmapped bases, particularly at the ends of the longer reads.table  <dig> 
alignment metrics for illumina miseq and ion torrent pgm sequencing runs


illumina miseq
ion torrent pgm
phw197-m
phw197-mmut
phw197-m
phw197-mmut
s1
s2
s1
s2
s1
s2
s1
s2

minimum coverage

maximum coverage

average coverage

standard deviation

unmapped reads 

unmapped bases 
wild type  and mutant  plasmids were sequenced in duplicate  on both sequencers and the processed reads were mapped to the plasmid reference sequence.



for both sequencers, we observed a striking fluctuation in coverage depth  . the largest fluctuation was seen for the illumina miseq . it is known that illumina miseq and ion torrent pgm sequencers perform rather poorly when sequencing dna with very low or very high gc content, which leads to low sequencing coverage of at and gc rich regions  <cit> . in addition, the nextera transposon-based fragmentation that we used for the samples sequenced on the illumina miseq has some sequence preference, which can lead to a fragmentation bias, particularly in small genomes  <cit> .figure  <dig> 
next generation sequence analysis of phw197-m.  schematic representation of phw197-m. hcmv: human cytomegalovirus promoter, t7: t <dig> rna polymerase promoter, m1: matrix protein  <dig> open reading frame, m2: matrix protein  <dig> open reading frame , hpoli: human rna polymerase i promoter, pmb <dig> ori: origin of replication, ampr: ampicillin resistance gene.  mean sequencing depth after mapping the processed reads  to the reference plasmid genome. the phw197-m plasmid was fragmented with the nextera xt dna sample preparation kit before illumina miseq sequence analysis or by covaris mechanical shearing, followed by adaptor ligation before ion torrent pgm sequence analysis.  percentage gc distribution in the phw197-m plasmid reference sequence. the peak after position  <dig> corresponds to the origin of replication.



since the plasmid reference sequence is known, we were confident that any mismatching nucleotide variant could be reported as a sequencing error. the error rate per read position was  <dig> % ±  <dig> % for the illumina miseq and  <dig> % ±  <dig> % for the ion torrent pgm. the error rate increases slightly with the read length for both sequencers, with a pronounced rise at the end of the reads on the ion torrent pgm . for the illumina miseq, substitutions are the dominant error type with a-to-c and t-to-g being the most prevalent , which is consistent with an earlier report  <cit> . in contrast, indels are dominant on the ion torrent pgm , and most of them are single nucleotide insertions or deletions . nearly all of these indels occur in homopolymeric regions. since these regions require multiple incorporations of identical nucleotides, this increases the chance of non-linearity between the signal intensity and homopolymer length, explaining the higher indel error rate of the ion torrent pgm.figure  <dig> 
comparison of nucleotide variants revealed by illumina miseq and ion torrent pgm sequencing. the phw197-m and phw197-mmut plasmids were fragmented with the nextera xt dna sample preparation kit  or by covaris mechanical shearing, followed by adaptor ligation . the samples were sequenced in duplicate and the sequence reads were processed . for reads obtained on the illumina miseq: broken pairs after read processing were also removed. the relative percentages of substitutions, insertions and deletions were determined after mapping the processed illumina miseq  and ion torrent pgm  sequencing reads to the phw197-m  or phw197-mmut  reference sequence. bars represent averages from  <dig> samples and error bars represent the standard deviation.



variant detection
we considered the frequency of a given nucleotide significant  when it was higher than twice the sequencing error background, i.e. above  <dig> % for the illumina miseq and above  <dig> % for the ion torrent pgm. since we are dealing with proportions very close to zero, the proportion of variants that could be miscalled at this threshold was estimated using the agresti-coull interval as an approximate binomial confidence interval  <cit> . setting twice the background error rate as upper bound of the binomial confidence interval, only  <dig> % and  <dig> % of the variants are expected to be miscalled as true variant on the illumina miseq and ion torrent pgm, respectively. despite this stringent cut-off, false positive errors were still detected, mostly as a consequence of the sequence specific error profiles of both sequencers . the largest number of variants was deduced from the ion torrent pgm data, and all of them were indels . in contrast, the variant calls on the illumina miseq were mainly snps . to eliminate false positive variants, we applied extra in silico filtering parameters. we set the forward/reverse balance between  <dig>  and  <dig> , meaning that the minimum ratio between the number of forward and reverse reads that support the surmised variant should be at least  <dig> . in addition, a nucleotide variant should be counted at least  <dig> times independently and should have an average phred score of at least  <dig>  . applying these variant filters removed most of the false positive variant calls and retained one variant from the illumina miseq and six or five variants from the ion torrent pgm data . so applying the variant filtering parameters has the largest impact on removing false positive variants detected in the ion torrent pgm data. regardless of the sequencing method used, all false positive indels were present in homopolymer regions . these variants can be excluded by using a homopolymer indel filter. however, homopolymeric regions are also the sites were the viral rna polymerase may have the highest error rate. therefore, applying this homopolymer indel filter to analyze viral rna sequences  could lead to underestimation of the number of variant genomes. alternatively, the number of called variants based on the ion torrent pgm data can be reduced in order to exclude likely false positive variants, by increasing the average phred score for a registered variant to  <dig>  however, this also increased the number of false negative variant calls .table  <dig> 
number of detected variants in the phw197-m sample before and after filtering


illumina miseq
ion torrent pgm
before
after
a
before
after
a
s1
b
s2
b
s1
b
s2
b
s1
b
s2
b
s1
b
s2
b

snp
c

insertion

deletion

athe filtering parameters used were average quality threshold > q <dig>  forward/reverse balance >  <dig> , and independent counts of variant >  <dig> 


bsequencing was performed in duplicate .


csnp = single nucleotide polymorphism.



to determine the sensitivity for variant calling, we mixed phw197-m and phw197-mmut plasmids in ratios of 95: <dig>  99: <dig> and  <dig> : <dig>   and then sequenced the mixtures on both platforms. on both sequencers, the calculated frequency of phw197-m or phw197-mmut based on the output data closely resembled the used ratios . nevertheless, the average quality  of the tracer mutations was higher on the illumina miseq  than on the ion torrent pgm , making the detected variants on the illumina miseq more reliable. since the mutations are physically linked on one plasmid, both mutations should be present at similar frequencies in a single sample. this was indeed the case: the observed frequencies of the linked tracer mutations varied only slightly with on average  <dig> % ±  <dig> % on the mapped illumina miseq reads and  <dig> % ±  <dig> % on the mapped ion torrent pgm reads. finally, we found that the  <dig> : <dig>  plasmid input ratio could not be resolved because it is too close to the intrinsic error rate of both sequencers. overall, the illumina miseq is more accurate than the ion torrent pgm sequencer but they have similar sensitivities for detection of snps in plasmid dna.table  <dig> 
sensitivity of illumina miseq and ion torrent pgm


illumina miseq
ion torrent pgm
797
1088
797
1088

phw197-m
phw197-mmut
c
t
a
t
c
t
a
t
the observed mutation frequencies  after mapping the reads to the reference sequence of phw197-m are shown. < d.l. = mutation frequency falls below detection limit . the phw197-mmut plasmid contains the tracer mutations c797t and a1088t.



sequencing of influenza virus samples
to compare the efficacy of the sequencers for detecting mutations in an influenza a virus sample, we generated influenza virus starting from eight plasmids, including phw197-m or phw197-mmut. this resulted in wild type pr <dig> and mutant pr <dig> , respectively, the latter carrying two silent mutations in the m <dig> orf . these mutations did not seem to affect viral fitness because pr <dig> and pr8mut replicated equally well in vitro . in addition, sanger sequencing and restriction analysis of the mutant m segment after rt-pcr revealed that the introduced tracer mutations in pr8mut were uniformly present in the stock preparation . these viral samples were sequenced in duplicate  to evaluate the consistency of the two ngs methods. in addition, wild type and mutant viruses were mixed at a ratio of 99: <dig> before rna isolation to compare the accuracy of the two ngs sequencing methods to resolve this ratio. finally, we also wanted to quantify the number of differences, if any, between the plasmid encoded influenza virus information and the in vitro cultured virus samples. this quantification would reflect the baseline quasispecies diversity, in the absence of exogenous selection pressure.figure  <dig> 
comparison of the
in vitro
replication of pr <dig> and pr8mut influenza viruses.  individual plaques of pr <dig> and pr8mut. plaques were revealed by immunostaining with an anti-m <dig> ectodomain-specific monoclonal antibody.  multi-cycle growth analysis of pr <dig> and pr8mut viruses. mdck cells were infected in triplicate at a moi of  <dig>  of pr <dig> or pr8mut virus. every twelve hours after infection, samples in the cell supernatant were analyzed for the presence of infectious virus by plaque assay. error bars represent the standard deviation.



amplification of the genomic influenza virus segments
ensuring sufficient coverage across all segments requires an rt-pcr protocol that amplifies all eight influenza genome segments with equal efficiency. we used an rt-pcr protocol based on the conserved termini of the influenza genome segments, which allowed us to amplify all eight segments in sufficient amounts   <cit> . surprisingly, next to the eight genomic segments, an unexpected band with a length of about 850 bp was also amplified. this band was identified by conventional sanger sequencing after blunt-end cloning in pbluescript and corresponded to the first  <dig> nucleotides of ha. its amplification in the rt-pcr reaction was probably due to partial overlap of the commonuni12g primer with a nine-nucleotide perfect match in the coding region of ha . by lowering the concentration of the commonuni12g primer, we could avoid this extra band and obtained the eight amplicons of the expected size . overall, these results show that this rt-pcr protocol based on the conserved termini of the influenza a genome segments is suitable for amplifying all eight segments simultaneously and efficiently.figure  <dig> 
rt-pcr amplification of influenza a virus pr <dig> and pr8mut genomic rna.  electrophoretic analysis of rt-pcr products of pr <dig> and pr8mut separated on a  <dig> % agarose gel and subsequently stained with ethidium bromide. pb1: polymerase basic  <dig>  pb2: polymerase basic  <dig>  pa: polymerase acidic, ha: hemagglutinin, np: nucleoprotein, na: neuraminidase, m: matrix, ns: non-structural. the amplified pb <dig> and pb <dig> rt-pcr products run at the same position in the gel. * = aspecific amplification product of 847 bp.  optimized rt-pcr product resolved as in a.



de novo assembly of sequencing reads derived from viral rna
accurate de novo nucleotide sequence assembly is essential to identify the viral quasispecies that is present in  samples. the viral rt-pcr products were purified and subjected to ngs on the illumina miseq and the ion torrent pgm platforms. before assembly, the reads were processed in silico as described above for the plasmid-derived sequences . afterwards, the sequencing reads were assembled de novo using de bruijn graphs  <cit> . this assembly method is ideally suited for high coverage next-generation sequencing data since the computational burden is lowered by first subdividing all sequencing reads in all possible subsequences with a certain short length , followed by looking for all neighbors with k- <dig> overlap. the consensus sequence is then constructed as being the alignment of k-mers that follows the shortest path connecting all overlap sequences  <cit> . in this way,  <dig> % ±  <dig> % of the reads on the illumina miseq and  <dig> % ±  <dig> % of the reads on the ion torrent pgm were assembled in eight contigs corresponding to the eight genome segments of the pr <dig> virus. these eight contigs had a mean coverage depth of 23020 ±  <dig> on the illumina miseq and 13768 ±  <dig> on the ion torrent pgm. all viral genome segments were almost completely covered by the consensus contigs . only the extreme 3′ and 5′ ends of each segment were not covered in all consensus sequences. this is partly due to the high sequence similarity and partial complementarity of the 5′ and 3′ ends of the influenza virus genome, making those reads more difficult to assemble de novo. in addition, the transposase-based fragmentation and tagging of the samples sequenced on the illumina miseq disfavors coverage of free ends, making de novo assembly at these ends more difficult. for the ion torrent pgm samples, the adaptors were ligated to the dna fragments that had been generated by sonication, with the free ends of the influenza genome dna segments favoring adaptor ligation, resulting in higher coverage of the segment termini and making full-length de novo assembly easier. nevertheless, in all viral contigs, the coding sequences were highly covered and entirely present. in summary, both sequencers are equally suited for de novo assembly of the influenza virus genome, and transposase-based fragmentation should be avoided when high coverage of the influenza virus genome ends is desired.table  <dig> 
percent coverage of the influenza pr <dig> reference sequence after
de novo
assembly



segment
illumina miseq
a

ion torrent pgm
a


pb2

pb1

pa

ha

np

na

m - mmut

ns

aviral rt-pcr product sequencing reads obtained on illumina miseq and ion torrent pgm were de novo assembled, followed by alignment of the obtained consensus sequence to the pr <dig>  or pr8mut  reference genome. for each segment, the percentage of the influenza reference sequence  that is covered by the assembled contigs is given.


bsd = standard deviation.



mapping of sequencing reads
mapping of the above-mentioned reads to the viral reference genome  resulted in sufficient full-length coverage of the entire influenza genome . this allowed us to study the viral quasispecies, i.e. to determine the number of variable nucleotides at each position in the viral genome. when mapping was done with the illumina miseq data, we noticed a significant coverage dip near the middle of the np segment as well as a dip around position  <dig> of the pa segment, but this did not occur when the ion torrent pgm data were used . these parts of np and pa are not particularly gc-rich or at-rich, and these coverage dips therefore likely reflect a sequence dependency of the nextera transposase  <cit> . indeed, when we used mechanical shearing to fragment the rt-pcr products before illumina miseq sequencing, coverage of the np and pa segments was high and consistent over the entire length of all pr <dig> genome segments . for the viral samples sequenced on the ion torrent pgm, the sequencing depth is more homogenous across the segments, and the regions close to the ends of the viral segments are slightly overrepresented. this overrepresentation is probably due to mechanical shearing and subsequent adaptor ligation. the inadvertent rt-pcr amplification of the 847-bp ha fragment mentioned earlier was clearly reflected in the sequence read coverage of that segment, which showed a higher coverage for the 5′ half of this segment . moreover, the gradual versus steep drop of coverage near position  <dig> in the ha segment reflects the different chemistries of the nextera transposase and the covaris shearing/adapter ligation methods. homogenous coverage across the ha segment was evident with the optimized rt-pcr method in which the extra partial ha-fragment was not present .figure  <dig> 
sequence coverage of the influenza virus genome. sequence coverage for the different genome segments of wild type pr <dig> virus sequenced on illumina miseq  or ion torrent pgm . the obtained sequences were mapped to the reference genome .
alignment metrics for illumina miseq and ion torrent pgm sequencing runs



illumina miseq

pr <dig> s1

segment
length
mapped reads
minimum coverage
maximum coverage
average coverage

pb2

pb1

pa

ha

np

na

m

ns

pr <dig> s2

segment
length
mapped reads
minimum coverage
maximum coverage
average coverage

pb2

pb1

pa

ha

np

na

m

ns

ion torrent pgm

pr <dig> s1

segment
length
mapped reads
minimum coverage
maximum coverage
average coverage

pb2

pb1

pa

ha

np

na

m

ns

pr <dig> s2

segment
length
mapped reads
minimum coverage
maximum coverage
average coverage

pb2

pb1

pa

ha

np

na

m

ns
wild type pr <dig> virus was sequenced in duplicate  on both sequencers and the processed reads were mapped to the reference sequence .
coverage of pr <dig> virus genome with the optimized rt-pcr protocol. sequence coverage for the different genome segments of wild type pr <dig> virus sequenced on illumina miseq  using two different fragmentation methods: nextera xt transposase-based fragmentation  and mechanical covaris shearing followed by adaptor ligation . the obtained sequences were mapped to the reference genome .



analysis of the viral quasispecies
after mapping the reads to the reference genome, we called the variants using the optimal parameters described above . since we started with viral rna, we increased the background threshold for variant calling to  <dig> %, what we believe is the biologically relevant frequency threshold. this value is above the estimated total error rate  obtained after mapping all sequencing reads to the pr <dig> reference genome, which is  <dig> % ±  <dig> % on illumina miseq and  <dig> % ±  <dig> % on ion torrent pgm.

pr <dig>  pr8mut and a mixture of pr <dig> and pr8mut , were used to prepare rt-pcr products that were subsequently sequenced on both platforms  . all obtained sequences were aligned to the pr <dig> reference genome. the output data of both sequencing platforms were processed in silico as described above and used to count the number of reads with c/t at position  <dig> and a/t at position  <dig> in the m segment. illumina miseq slightly overestimated and ion torrent pgm slightly underestimated the expected percentage of tracer mutations in the pr8:pr8mut mix . as the two introduced mutations are linked, we expected to retrieve them with the same frequency. this was indeed the case, and the observed frequencies of the linked tracer mutations differed on average by only  <dig> % on the mapped illumina miseq reads and by  <dig> % on the mapped ion torrent pgm reads.table  <dig> 
sensitivity of illumina miseq and ion torrent pgm to detect mutations in viral samples


illumina miseq
ion torrent pgm
354
645
354
645

pr8
pr8mut
c
t
a
t
c
t
a
t
the observed mutation frequencies  after mapping the reads of the pr <dig> and pr8mut viral samples to the wild type pr <dig> viral reference genome  are shown. the pr8mut virus contains the tracer mutations c354t and a645t.



next, we determined the number of variants at each nucleotide position in the virus-derived sequences, which would reflect the quasispecies diversity of in vitro grown pr <dig> and pr8mut virus. sequencing each sample in duplicate and simultaneously on the same machine also allowed us to determine and compare the intrinsic variability of the two platforms. the number and types of nucleotide variants that were retained after applying the variant filter are presented in table  <dig>  most variants were present in both sequencing duplicates, with the highest proportion of shared variants on the illumina miseq . however, the variants that were identified in only one of the duplicates were actually also detectable in the duplicate sample, but just below one of the four variant filtering parameters. as for the plasmid samples, all of the indels in the samples sequenced on the illumina miseq and most of the indels in the samples sequenced on the ion torrent pgm were present in homopolymer regions. the frequencies of the sequencing variants detected by both sequencers in duplicate are presented in tables  <dig>  and  <dig> . this revealed  <dig> mutations  for wild type pr <dig> and  <dig> snps for pr8mut. nearly all snps were detected with a higher average phred score on the illumina miseq  and were thus more reliable than on the ion torrent pgm .table  <dig> 
number of variants detected in wild type and mutant pr <dig> quasispecies after filtering


illumina miseq
ion torrent pgm
shared
s1
a
s2
a
shared
s1
a
s2
a
shared

pr8
snp
b

insertion

deletion

pr8mut
snp
b

insertion

deletion
the filtering parameters were: average quality threshold > q <dig>  forward/reverse balance >  <dig> , independent counts of variant >  <dig>  and frequency >  <dig> %.


athe wild type and mutant pr <dig> quasispecies were sequenced in duplicate . bsnp = single nucleotide polymorphism.
wild type pr <dig> quasispecies sequenced in duplicate on both illumina miseq and ion torrent pgm


frequency 

segment
position
type
reference
allele
aa change
illumina miseq
ion torrent pgm
function/location

pb1
1486
snp
a
g
lys481arg

ha
607
snp
a
g
silent
ha#

ha
747
snp
a
g
glu232gly

ha
765
snp
a
g
asp238gly

ha
823
snp
a
g
ile257met

ha
#
1199
snp
a
g
ser383gly

ha
1330
snp
a
g
silent

#not present in genbank or influenza research database.

bold = variant also present in pr8mut quasispecies.

ha segment = numbering of ha amino acid residues is based on the pr <dig> ha open reading frame with the starting methionine as position =  <dig> 



the average difference between the frequencies of a variant in pr <dig> sequencing duplicates was only  <dig> % ±  <dig> % for the illumina miseq and  <dig> % ±  <dig> % for the ion torrent pgm, again indicating that both sequencing platforms provide reproducible output . however, the frequency of occurrence of the variants differed substantially between sequencers. for example, the mean variant frequency differed between  <dig> %  and  <dig> %  for the same viral sample sequenced on both sequencers. in addition, most detected variants were present at a lower frequency based on the ion torrent pgm output. similar results were obtained for the pr8mut samples . to determine whether this difference in frequencies is significant between the sequencing platforms, variant frequencies obtained in pr <dig> and pr8mut were analyzed using logistic regression, considering loci with low  and high  minor variant frequencies as separate classes. this analysis clearly indicates that when the minor variant is present at a low frequency, the illumina miseq systematically detects the minor variants at significantly higher frequencies than the ion torrent pgm .table  <dig> 
mutant pr <dig> quasispecies sequenced in duplicate on both illumina miseq and ion torrent pgm


frequency 

segment
position
type
reference
allele
aa change
illumina miseq
ion torrent pgm
function/location

pb1
1486
snp
a
g
lys481arg

ha
607
snp
a
g
silent

ha
747
snp
a
g
glu232gly

ha
765
snp
a
g
asp238gly

ha
823
snp
a
g
ile257met

ha
#
1199
snp
a
g
ser383gly

ha
1330
snp
a
g
silent
np#
ns#

#not present in genbank or influenza research database.

bold = variants also present in pr <dig> quasispecies.

ha segment = numbering of ha amino acid residues is based on the pr <dig> ha open reading frame with the starting methionine as position =  <dig> 
low frequency minor alleles are detected at significantly higher frequencies by illumina miseq compared to ion torrent pgm. nucleotide variants were subdivided in two frequency classes: high  and low . mean proportions ± s.e. of the minor variants detected in pr <dig> and pr8mut viral samples by the illumina miseq and ion torrent pgm are shown. minor allele proportions were analyzed by logistic regression . significance levels of pairwise comparisons were assessed by a fisher’s protected least significance difference test * = p <  <dig> , ** = p <  <dig> .



almost all mutations detected in the wild type and/or mutant pr <dig> quasispecies are also present in h1n <dig> viral sequences retrieved from the influenza research database and/or genbank. the exceptions are indicated with a number sign  in tables  <dig> and  <dig>  these sequence variants  might exist in nature but have not been reported yet. most of the detected mutations are present in the ha segment, which is also the most variable influenza protein in nature  <cit> . most of the detected mutations were substitutions occurring at a frequency < 5%. however, three mutations in ha and one in np of pr <dig> as well as four mutations in ha and one in ns of pr8mut were present at a frequency > 10%  . of all detected variants, only seven  were shared by both pr <dig> and pr8mut and present in all samples sequenced. these were all in the ha segment, except for one variant in pb <dig> .

taken together, these results show that both the wild type and mutant pr <dig> virus behave as a fairly heterogeneous virus populations even in the absence of external selection pressure.

discussion
next generation sequencing  has become increasingly valuable to study virus diversity. ngs instruments have a very high sequencing capacity and therefore allow a very high coverage of the relatively small genome of rna viruses. ngs analysis is thus in principle well suited for determining the genetic heterogeneity of rna viruses. unfortunately, in many research articles on viral quasispecies diversity there is little information on how the raw data were processed. furthermore, the performance of different commercially available ngs platforms for quasispecies analysis has not been evaluated. here, we compared the quality of the sequencing output obtained on the illumina miseq and ion torrent pgm benchtop sequencers. we also propose an analysis pipeline for in silico processing of the sequencing data that allows identification and frequency determination of nucleotide variants in the influenza a virus . this analysis pipeline will help to standardize variant calling in small rna genomes based on ngs data.

to determine the influenza genome diversity by ngs technology, different hurdles have to be overcome. first, it is technically challenging to obtain high quality full-length rt-pcr products that cover the complete segmented rna genome of influenza viruses. we optimized an rt-pcr protocol with primers based on the conserved 3′  and 5′ ends  of the eight genome segments  <cit> . critical steps in this protocol are primer concentration and annealing and elongation times. because the sequence of these segment ends is conserved, this rt-pcr should be applicable to different influenza a virus strains.

a second hurdle is to distinguish between mutations that truly represent the viral genome diversity from errors introduced by rt-pcr amplification and the ngs chemistry. the first step is to filter the output sequence data in silico to retain only high quality reads. however, the available software and filtering parameters vary and are not always clearly described in the literature, making comparison of results very difficult. to reduce false positive variant calls introduced by the sequencing method, we applied specific trimming, filtering and variant calling parameters in the clc genomics workbench software. we first applied this bioinformatics analysis pipeline to sequencing reads derived from plasmid dna samples. we removed adaptor contamination, ambiguous nucleotides and trimmed low quality bases at the end of the reads by applying a phred score of  <dig>  then, we excluded reads shorter than  <dig> bases to avoid unspecific mapping of these short reads. trimming eliminated relatively more bases from the ion torrent pgm, meaning that the base quality of sequencing reads from the ion torrent pgm is lower than that from the illumina miseq. in other words, the potential advantage of longer read lengths obtained with the ion torrent machine was cancelled by their relatively low quality. together this resulted in a higher relative loss of bases for the ion torrent pgm data than for the illumina miseq data . furthermore, the phred score distribution across the reads, a measure of the intrinsic sequencing quality, was higher for the illumina miseq data than for the ion torrent pgm data, resulting in a lower error rate. after this quality control, the sequencing reads were mapped to the reference sequence, resulting in a higher percentage of mapped reads for the illumina miseq. the total mapping error rate of the illumina miseq  was lower than that of the ion torrent pgm . this finding is in agreement with loman and colleagues  <cit> . however, for plasmid dna analysis the substitution error rate on the ion torrent pgm appeared to be lower than that of illumina miseq . after variant calling, the resulting hits were filtered based on frequency, forward/reverse balance, average quality, and independent counts to remove false positive variants. after filtering, both sequencers detected the tracer mutations we had introduced with excellent accuracy and sensitivity. nevertheless, the average quality  of the detected variants was higher on the illumina miseq than on the ion torrent pgm, making the variants detected on the illumina miseq more reliable. the number of false positive variants can be further reduced by cross-platform replication, but the different biases of the sequencing platforms may cause many true variants to be overlooked when cross-platform replicates are compared  <cit> .

we then applied the analysis pipeline outlined in figure  <dig> to pr <dig> and pr8mut virus, which were generated by a plasmid-based reverse genetics system and amplified in mdck cells. in our opinion, variants in the influenza virus genome that appear with a frequency below  <dig> % are very difficult to distinguish from the background noise that is cumulatively introduced by rt-pcr and the inherent variation due to the chemistry of currently available illumina and ion torrent sequencers. we propose that a similar threshold of  <dig> % should be applied to interpret the genetic diversity of rna viruses. nevertheless, mutations with a frequency as low as  <dig>  −  <dig> % in chikungunya virus have been reported in the literature as meaningful based on illumina gaiix sequencing  <cit> . given the error rate of the influenza virus polymerase, resulting in approximately one mutation per  <dig>  nucleotides, together with the errors introduced during rt-pcr and the technical background error rate of the ngs platforms applied in this study, it is not straightforward for both the illumina miseq and the ion torrent pgm to identify each variant in the viral quasispecies. nevertheless, even with the threshold of  <dig> % proposed here, ngs will enable studying of the viral diversity in much more detail than in the past.

our analysis showed that the de novo assembled pr <dig> and pr8mut sequences correspond very well to the plasmid-derived reference genome. we detected  <dig> mutations in pr <dig> and  <dig> mutations  in pr8mut with a frequency of  <dig> % or higher. when a variant was present at low frequency , the illumina miseq detected it with significantly higher frequency than the ion torrent pgm. most of the detected mutations were transitions and appeared with a frequency below 5%. however, three mutations in ha and one in np of pr <dig>  as well as four mutations in ha and one in ns of pr8mut, were present at a frequency > 10%  . we detected only one single nucleotide deletion in the pr <dig> virus. this deletion was in a homopolymer at position  <dig> in pb <dig> but was detected with a frequency of 2 − 3% by both sequencers, in both duplicates of pr <dig> virus. in addition, this deletion was also detected with a similar frequency in both pr8mut samples sequenced on the illumina miseq and in one of the duplicate samples sequenced on the ion torrent pgm. this deletion disrupts the open reading frame, leading to premature termination of pb <dig>  this detrimental mutation is in line with the finding of brooke and colleagues, who showed that most of the infectious influenza a virions fail to express detectable levels of one or more viral proteins  <cit> .

we focused on the mutations detected by both sequencers with a frequency > 5% and on the mutations that appeared in both wild type and mutant pr <dig> viruses. there are three such mutations in the ha head domain of pr <dig> and four in the ha head domain of pr8mut, and all of them are part of or close to the antigenic sites . the shared asp238gly mutation  is associated with enhanced virion binding to the avian-type siagal and was reported previously as a position that is selected by egg-adaptation of influenza viruses  <cit> . the ser158arg mutation  in pr8mut has been described as a compensatory mutation in pr <dig> virus possessing the lys165glu mutation in ha , which decreases the receptor binding avidity and replication kinetics of the virus  <cit> . the two mutations in the stem domain are relatively conservative  and therefore might not affect virus replication. remarkably, the g-to-a substitution at position  <dig>  leading to the val458met change in ha, had a frequency close to 100% in the pr <dig> ha segment but was absent in pr8mut . this mutation was probably fixed in the wild type virus genome at a very early step, e.g. during plaque purification of the pr <dig> seed virus we used to prepare stock virus. we also picked up two other codon changes in the ha stem region of pr8mut: asn460asp  and asn460ser  . based on pyrosequencing of the ha segment, the asn460asp mutation has been observed in  <dig> % in pr <dig> virus grown on mdck cells  <cit> . in addition, the pr8mut caries the ile353val  mutation in the ha fusion peptide at a frequency of about 60%. a valine at this position has been observed in a pr <dig> pseudo-revertant after introducing the ile10ala mutation. a valine at this position is compatible with the α-helical structure of the fusion peptide  <cit> . both pr <dig> viruses also contain mutations in other segments. for example, both viruses share the conservative lys481arg mutation in pb <dig>  this lysine at position  <dig> is crucial for the polymerase function of pb <dig> in vivo but mutating it to alanine was tolerated in vitro  <cit> . in wild type pr <dig>  the asn395ser variant in np is in a domain involved in np − np and np − pb <dig> interactions   <cit> . the gln121his variant detected in ns <dig> of pr8mut is situated just before a human ctl epitope   <cit> . remarkably, none of the variants we observed correspond to the variants described in an earlier study, in which a pr <dig> strain  was adapted for growth on mdck cells  <cit> . however, we used mdck cells only to expand our virus stock, which corresponds to about six cycles of pr <dig> virus replication. furthermore, we generated our pr <dig> virus starting from eight plasmids, indicating that the passaging history is a determinant of the variants detected in an influenza virus quasispecies.figure  <dig> 
position of variants present in pr <dig> and pr8mut quasispecies in the ha, np and ns <dig>  the variants in ha , np  and ns <dig>  detected in the pr <dig> and pr8mut quasispecies were modeled with pymol , using the ha from a/puerto rico/8/ <dig>  , the np from a/wilson-smith/ <dig>   and the effector domain of ns <dig> from a/puerto rico/8/ <dig>  .  top  and lateral  view of the surface exposed amino acids of the ha trimer. the cb, ca, sa and sb antigenic sites are shown in green. the mutations that are present in both pr <dig> and pr8mut are shown in red or in magenta if they overlap with the antigenic sites. mutations in pr8mut that are present at a frequency > 5% are shown in blue or in yellow when overlapping with the antigenic sites or in purple when overlapping with the fusion peptide . the mature h <dig> amino acid numbering of the variants is provided in superscript.  lateral view of the np monomer with the n395s mutation present in pr <dig> shown in brown.  the effector domain of ns <dig> with the q121h mutation in pr8mut shown in blue.



both sequencers are highly effective for accurate detection of low frequency mutations, but each one has its advantages and limitations. on the one hand, the illumina miseq platform has about three times higher output capacity than the ion torrent pgm, enabling sequencing of more samples in parallel on the illumina miseq. on the other hand, the ion torrent pgm is significantly faster: its time from sample preparation to data analysis is one day less than for the illumina miseq. after the in silico quality control, the two sequencers produced reads of comparable lengths. the illumina miseq had a higher intrinsic sequencing quality than the ion torrent pgm, presumably because detecting incorporated bases based on a coupled fluorescent dye  gives less noise than a change in ph caused by release of a proton after incorporation of a base . however, the ion torrent pgm had a lower false-positive rate for detecting snps. another interesting observation is the lower coverage of the ends of the viral segments on the illumina miseq due to the transposase-based fragmentation. nextera transposase-based fragment library preparation is convenient and fast but results in low coverage of segment termini. we also noticed some sequence bias of this transposase-based fragmentation approach . mechanical fragmentation followed by adaptor ligation enables comparable coverage of all bases of the influenza virus genome, and is therefore the preferred method for library preparation .

the proposed rt-pcr protocol and subsequent analysis pipeline for influenza viruses is widely applicable, e.g. to study vaccine composition, analyze virus evolution under selection pressure, monitor mutations associated with antiviral resistance, and assemble the reference genome of new viral isolates. for clinical samples, the shorter turnaround time of the ion torrent pgm  is clearly advantageous to the illumina miseq . in contrast, when analyzing many viral samples at high coverage, the greater output of the illumina miseq is an important advantage.

CONCLUSIONS
our study underlines the power and limitations of two commonly used next-generation sequencers for the analysis of influenza gene diversity. we propose an in silico pipeline for selecting high quality reads obtained by ngs platforms. this pipeline is also more widely applicable. due to the lower total error rate and the higher sequencing quality of the reads, we conclude that the illumina miseq platform is more suited than the ion torrent pgm for detecting variant sequences, whereas the ion torrent platform has a shorter turnaround time. in addition, we found that the detection limit for reliable recognition of variants in the viral genome required a frequency of  <dig> % or higher.

