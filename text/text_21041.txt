BACKGROUND
most eukaryotic genes contain spliceosomal introns, which are removed from mrna after transcription by the rna splicing apparatus. the biological origins of introns are uncertain. since the discovery of introns, there has been significant debate as to whether introns in modern-day organisms were inherited from a common, ancient ancestor, the intron-early hypothesis  <cit> , or whether they appeared in genes more recently in the evolutionary process, the intron-late hypothesis  <cit> , or indeed whether they result from a mixed model  <cit> . the mixed model suggests that most introns were gained very early in the evolution of eukaryotic genes, followed by intron loss/gain during the course of eukaryotic diversification. the details of such processes, however, remain elusive.

one way to understand the process is to examine the size distribution of internal translated exons, referring to exons that are fully translated and referred to as itexon in  <cit> . however, to avoid introducing an unfamiliar term, we will simply refer to itexons as “exon” within this communication unless specified. although the distribution of exons is just a snapshot of the present day world, fitting it to a model based on well characterized mathematical functions may provide insights into the evolution of exon-intron structure. in a previous study, gudlaugsdottir et al.  <cit>  have suggested that the size distribution of exons can be approximated with a combination of weibull  <cit>  and exponential distributions. the weibull distribution is a particular case of the generalized extreme value distribution. it is widely used in survival analysis, describing the size of particles generated by grinding, milling and crushing operations, etc. the exponential distribution can be used to describe the length of intervals between uniformly distributed points. therefore, gjudlaugsdottir et al. hypothesized that the exponential distribution is the outcome of random insertion of introns . however, they then related the weibull distribution to the intron-early theory without providing a stochastic model that explains the observed distribution.

in later work, ryabov and gribskov  <cit>  showed that a combination of two lognormal distributions gives the best fit quality to the size distribution of exons. the lognormal distribution could result from a random kolmogoroff fractioning process  <cit> , which assumes that the chance of fragmentation is independent of exon size. inserting an intron into an exon is equivalent to fragmentation  of the exon. therefore, they hypothesized that the process of intron insertion is independent of exon size.

on the other hand, tenchov and yanev  <cit>  demonstrated that the weibull distribution could result from a uniform random fragmentation process. here, “uniform” means that the chance of fragmentation is linearly proportional to the size of the particle . under certain conditions, the resulted weibull distribution is indistinguishable from lognormal distribution. hence they concluded that the model of random fragmentation could not be inferred based on the basis of fit quality. therefore, the hypothesis that intron insertion is independent of exon size is debatable.

one assumption made in the exon size based approaches  <cit>  is that introns are inserted into exon randomly. the notion of random insertion of intron has also been proposed based on the analysis of intron distribution in ancient paralogs  <cit> . others have argued that there exist certain favored sites for intron insertion - the so-called proto-splice sites  <cit> . unfortunately, none of the size-based approaches provide evidence to support the assumption of random intron insertion.

in this work, we aim to revisit these competing hypotheses by addressing the following open questions: do longer exons have an increased chance of gaining a new intron? for intron gain events, will the intron be inserted into exon randomly or at some proto-splice sites? is there an intron gain/loss bias? are intron insertion events independent of each other? is there a common mechanism to explain intron gain/loss in different species? in order to answer these and other related questions, we propose a general random fragmentation process  to characterize the evolution dynamics of exon-intron structures. the parameters of grfp are determined by combining simulation and analysis of real genomic data.

methods
grfp model
the model of grfp is motivated by generalizing both kolmogoroff fractioning process and the uniform random fragmentation process. in grfp, the probability for an exon to split  is assumed to be exponentially proportional to the length of the k-th exon  as lka. under such a generalization, the kolmogoroff fractioning process, in which insertion events are independent of exon length, is a particular case of grfp with α =  <dig>  while the uniform random fragmentation process, in which insertions are linearly proportional to exon length, is another special case with α =  <dig>  the generalization not only allows grfp to model either kolmogoroff or uniform fragmentation process but also allows it to model the fragmentation process of exons  with varying α. in the results section, we will use the empirical size distribution of exons to determine the value of α. grfp also assumes that introns insert into exons randomly and independently, and these assumptions are confirmed by the analysis of real genome data.

the model of grfp, illustrated in figure  <dig>  is summarized below:

 <dig>  given a set of n exons, the opportunity for k-th exon to acquire a new intron is proportional to its size to the α-th power:

  psk=lka/∑k=1nlka 

 <dig>  within k-th exon, the new intron insertion loci follow a normal distribution:

  pix~lk*nμi,σi,x∈ <dig> lk 

 <dig>  intron gains are independent of each other.

where РЅ denotes the probability for k-th exon to obtain an intron; Рi, probability of inserting an intron after x-th position within k-th exon; lk, length of the exon k; α, dependency value; μi and σi, mean and standard deviation of the distribution of insertion loci. the model of grfp has three unknown parameters to be determined, α, μi and σi.

simulation testing
we start each simulation with a long exon. the diagram in figure  <dig> shows how the splitting of a long exon during evolution is simulated. the diagram shows intron gains in the following order. after inserting the first intron, ΡЅ denotes the picking probability between l <dig> and l2; assuming l <dig> is selected and split by a new intron; the next exon to be split will be chosen from l <dig>  l <dig> and l <dig> with probability ΡЅ; assuming l <dig> is selected, and so on.

for simulations, sequence of pseudorandom number is obtained using the mersenne twister algorithm  <cit>  implemented in standard matlab  <dig> . in this study, all of the simulations start with one single exon. this simplifies the simulation, but it does not imply that the evolution of eukaryotic genes always starts with one long exon. under such simplification, two more parameters are the initial size of starting exon  and the number of splitting . for a given species, we can estimate them from the annotated gene sets.

we evaluate the properties of grfp using three simulation experiments. in each, we simulate a set of ordered fragments and quantify their statistical characters given different parameters. the three sets of quantifications listed below are used to justify the three assumptions of grfp respectively for both simulated fragments and real exons.

 <dig>  mean and standard deviation of the size distribution by fitting it with lognormal distribution ) or weibull distribution ):

  dn=n/σe2πe−1ne−μe/2σe2dlne 

  dn=nkzk−ie−zk/λdlne 

where z=e/λ, e is exon length, dn the number of exons in a bin , n the amplitudes of the peak; k shape parameter, and λ scale parameter of the weibull distribution; μe the mean position, and σe the standard deviation of the lognormal distribution. these and subsequent fittings in this study are performed using the nonlinear trust-region-reflective curve-fitting algorithm  <cit>  implemented in matlab  <dig> . simulation demonstrates that σe is primarily determined by the choice of α ).

 <dig>  mean and standard deviation of the insertion ratio defined below:

  xi=li/li+li+ <dig> 

where li and li+ <dig> are the length of two adjacent fragments . this is an indirect estimation of insertion loci ). both simulation and real genome data indicate that x follows a normal distribution .

 <dig>  correlation between xi and xj defined by equation :

  ρi,j=σxi+xj2−σxi2−σxj22σxiσxj 

where σx is estimated from fitting the histograms of ratio x with a normal distribution. in theory, xi + xj is still normally distributed, and the mean value is the sum of the means. however, the variances are not additive if xi and xj are correlated. we can estimate the relationship between xi and xj with equation .

in the first experiment, we examine the relationship between grfp parameters and the size distribution of the simulated fragments. with fixed μi, σi, initial size of starting exon , and the number of splitting , one long exon is fragmented with different choices of α. μe and σe are estimated through fitting a lognormal distribution to the size distribution of the resulted fragments. the correlation between μe, σe and α is examined. then, with fixed μi, σi, and α, the relationship between μe, σe and initial size of starting exon , the number of splitting  is examined through similar simulations.

in the second experiment, we examine the relationship between real σi ) and estimated σx ). by fragmenting a long exon, we construct a binary tree to track the splitting process. we classify the adjacent fragments pair  into four groups based on whether they have the same parent nodes, or if not same parents, comparing their depths. the size distribution of each group and the mixture ) is examined. with fixed μi, l <dig>  m, and α, the correlation between σi and σx is examined by simulations with different choices of σi. then, by coupling with empirical observations, we use expectation-maximization  iteration to determine the value of α and σi.

in the third experiment, we examined the effects of intron loss on the statistical characters of resulted fragments. by introducing various percentages of intron loss after intron gain, we evaluate how σe, σx, and ρ of the resulted fragments are changed.

empirical data analysis
in this study, we obtained the cdna sequences of  <dig> species , mus musculus , rattus norvegicus , danio rerio , caenorhabditis elegans , drosophila melanogaster , bos taurus , pan troglodytes , gallus gallus , sus scrofa , arabidopsis thaliana , oryza sativa , sorghum bicolor , zea mays ) from ensembl and plant ensembl database  <cit> . to ensure the quality of the data, we only use the cdna sequences of protein coding genes with both refseq mrna id and the known status of both gene and transcript. to examine the size distribution of exons, we extracted the genomic positions of the exons from cdna sequences to compute exon sizes. we also extracted the genomic positions of the 5′ and 3′ utrs and used them to identify internal translated exons.

for testing the first assumption of grfp, we fitted both weibull and normal distribution to the size distribution of vertebrate exons . we also grouped exons by positions for testing position bias of intron gain/loss. for the second assumption, we fitted a normal distribution to x ). for the third assumption, we computed ρ for exon pairs at i-th and j-th position in all protein coding genes. finally, we examined the differences in the parameters fitted to vertebrate and non-vertebrate species.

RESULTS
empirical data analysis
statistical counts of empirical data
statistical counts of the extracted data are shown in table  <dig>  the transcript with the longest cds  for each gene is used for counting the number of protein coding genes, number of splitting, and total cds length. in these counts, a coding gene is excluded if it does not contain any internal translated exons. the total cds length is the summation of the length of all exons. the number of splitting events is the total number of exons minus one . the last two columns of table  <dig> are estimated through grfp simulations that will be discussed later.

annotation data for each species is extracted from ensembl database. protein coding genes are counted only if they contain at least one internal translated exon. total cds length is the summation of all internal translated exon length in these genes. number of splitting is estimated by the number of internal translated exons minus one. estimated splitting is determined from grfp simulation.

in this study, we ignored non-internal translated exons considering the rate of indels  is significantly lower in the coding region than the non-coding region  <cit> . it is true that introns can be inserted anywhere, including non-coding exons or even another intron, but their size distribution is confounded by the appearance of more frequent indels.

size distribution of exons
figure  <dig> shows the histograms of exons for eight vertebrate species. both weibull  and normal  functions provide a reasonable fit to the histograms of exons, with the fitted parameters shown in table  <dig>  notably, in table  <dig>  the fitted parameters are almost identical across species , which might indicate that these vertebrate genomes have undergone a similar stochastic process on the exon-intron structure during evolution. for the six non-vertebrate species, a mixture of two normal functions  fits the histograms well . this might suggest that the evolution of non-vertebrate exon-intron structure has undergone other processes.

λ
κ
μ


e

σ


e

the size distribution of exon  for each vertebrate species is shown in figure  <dig>  each distribution is fitted with equation  and  separately. the normal function fitting is shown as dashed line. the weibull function fitting is shown as a solid line.

in order to assess whether the size distribution of vertebrate exons is position-dependent, we grouped their exons from all protein coding genes according to their positions relative to 5′ utrs/3′ utrs. for the five well annotated vertebrates, the standard deviations  of the fitted normal functions at each position  are shown in the left panel of figure  <dig>  the right panel shows corresponding α values calculated using equation . the mean values of these distributions are almost constant at all positions . figure  <dig> shows that σe is almost constant for exons across gene body, with exceptions of the first three exons right after 5′ utr , where it increases markedly. for exons next to the 3′ utr , no similar trend is observed.

these observations suggest that the size distribution of vertebrate exons could be properly fit with either weibull or normal distribution. the weibull distribution gives a better fit to both left and right tails  because the distribution is skewed to the left. for numerical simulations, we will show that similar size distribution of fragments will be generated based on grfp model.

distribution of insertion ratio
for every gene of the selected species, we calculated the insertion ratio x ) for each adjacent exon pairs li and li+ <dig>  figure  <dig> shows the histograms of the ratios for the  <dig> species. the histograms are fitted well with a normal distribution, and the fitted parameters are shown in table  <dig>  the fitted parameters are almost identical across vertebrate species with μx=  <dig>  and σx=  <dig> . the insertion ratio for non-vertebrates fits a normal distribution reasonably well but with much larger σx.

μ


x

σ


x

the distribution of insertion ratios ) for each species is shown in figure  <dig>  each distribution is fitted with a normal distribution ).

another interesting observation in figure  <dig> is the sharp spike at  <dig> , which suggests that there are excessive adjacent exons pairs with the same length. this is consistent with the observation of tandem exon duplication  <cit> . because the spikes are located right on the center, mathematically such deviation has little effect on the fitting of the histogram.

the normal function fitted in figure  <dig> describes where introns get inserted into an exon. to assess whether it is consistent or against the hypothesis of proto-spliced sites, we calculate the position distribution of four possible proto-splice sites  within human coding sequences, and the results are shown in additional file 1: figure s <dig>  the position for each of the four sites ag) is calculated by dividing the distance between the intron starting site and start codon by the length of the coding sequence. all coordinates are extracted from ensembl annotation of h. sapiens. the symbol “|” stands for the intron position and “/” indicates wo alternative states of one nucleotide site. additional file 1: figure s <dig> shows that these proto-spliced sites are distributed nearly uniformly within cds. if introns strongly prefer to be inserted into these sites, the insertion ratio should follow a uniform distribution instead of normal distribution as we observed. therefore, the analysis here does not favor the proto-splice site hypothesis.

correlation between insertion ratios
the correlations calculated using equation  are shown in figure  <dig>  for better visualization purpose, we set the correlation between x and itself to zero . the color bar on the right indicates the correlation value between insertion ratio and ratios with i or j distance to it. figure  <dig> shows that ρ is significantly negative if |i - j| =  <dig>  while ρ is close to zero for vertebrates if |i - j| >  <dig>  the negative correlation between adjacent insertion ratio is not surprising since the calculation uses the same exon length as dividend ) but with opposite signs. for example, considering three exons in order with length p, l-p, and q, the insertion ratios are x1= p/ = p/l and x <dig> = / ≈ 1-p/l if p ≈ q; both x <dig> and x <dig> are proportional to p but with different signs.

the key observation in figure  <dig> is that nonadjacent insertion ratios are nearly uncorrelated for vertebrate genomes. however, the correlation between intron insertion ratios has quite different patterns for non-vertebrates. their insertion ratios are more negatively correlated with each other than those for vertebrates, especially for c. elegans, d. melanogaster, and o. sativa.

in summary, analysis of empirical data reveals three significant differences between vertebrate and non-vertebrate genomes. first, a mixture of two normal functions gives a better fit to the size distribution of non-vertebrate exons, instead of one normal function for that of vertebrate exons; second, the insertion ratio of non-vertebrates also follows a normal distribution but with larger standard deviation than that of vertebrates; third, the insertion ratios of non-vertebrates are more negatively correlated than that of vertebrates.

simulation testing
default values for l <dig>  m, σi, and μi
as mentioned before, we start each simulation with a long exon. using the counts for h. sapiens , we set the initial exon size and number of splitting to following values for all simulations unless specified:

  l0= <dig> × <dig> m= <dig> × <dig> 

for the remaining unknown parameters of grfp, α, σi, and μi, we chose to examine α first with following values for σi and μi:

  σi= <dig> ,μi= <dig>  

these values are determined through an em iteration process that will be discussed in the simulation testing section. the em iteration uses observed values of σx and μx for vertebrates . the simulation described below shows that σx overestimates but is linearly proportional to σi, while μx approximates μi extremely well.

relationship between α, l <dig>  m and σe, μe
using the values of l <dig>  m, σi and μi in equations  and , we performed three grfp simulations with α values of  <dig> ,  <dig> and  <dig>  the size distributions of the grfp fragments are shown in additional file 1: figure s <dig>  both the weibull and normal functions were used for fitting to the logarithm size distribution. fitted parameters are shown in table  <dig>  numerically the weibull function is unstable for fitting the histogram when α is close to zero. therefore, we picked α =  <dig>  to mimic a random kolmogoroff fractioning process. α =  <dig> would correspond to a uniform random fragmentation process, and α =  <dig> will generate size distribution similar to that of real exons for the vertebrate genomes . we found that although the weibull function fits the tails of the distributions better, the fitted parameters for weibull are extremely sensitive to the minimum size of the grfp fragments. therefore, in this study we use σe of the fitted normal function to characterize the peak width of the size distribution. it is worthwhile reemphasizing that both empirical and simulated distributions are skewed to the left; thus both tails of the peak are better fitted by the weibull distribution.

λ
κ
μ


e

σ


e

the size distribution of simulated exon  for each choice of dependency value  is shown in additional file 1: figure s <dig>  each distribution is fitted with equation  and  separately. the normal function fitting is shown as dashed line. the weibull function fitting is shown as a solid line.

these simulations show that σe  decreases as α increases. to quantify how σe is dependent on α, we performed three grfp simulations for each α value range from  <dig> to  <dig>  the size distribution of grfp was fitted to a normal function, and the fitted σe and μe values  were plotted against α in figure 6a. for α values ranging between  <dig> and  <dig>  we found that the relationship between σe and α can be fitted with the following equation:

  σe= <dig> /a <dig> + <dig>  

from equation , we estimate that α ≈  <dig> gives the observed σe ≈  <dig>  . this suggests the chance of intron gain is proportional to the exon length to the 3rd power, which disagrees with the independency hypothesis of earlier work  <cit> .

similarly, we performed a series of grfp simulations with different choices of l <dig> and m, and the results are shown in figure 6c-f. figure 6c and 6e show that the estimated σe is independent of both l <dig> and m, while figure 6d and 6f demonstrates that the mean value  of the resulting size distribution is dependent on both l <dig> and m. from figure 6f, we can estimate m via the grfp simulation given σe and l <dig>  using the intersection between the dashed line  and the solid curve. given that μe is approximately  <dig>  across vertebrate genomes, we used grfp simulation to estimate the number of splitting  for each species . the percentage of intron loss is estimated by comparing me with m. for other species, the corresponding l <dig> in table  <dig> is used to estimate me. me and the percentages of intron loss are calculated in the same way. note that here we use the same μe value of  <dig>  for invertebrates although the size distributions of their exons  are quite different . these estimations show that there are approximately 24% intron loss in o. sativa, 28% intron loss in c. elegans, and 57% intron loss in d. melanogaster, relative to what is predicted by grfp model based on cds length.

  m= <dig> l0+ <dig> 

in figure  <dig>  we plot me  against cds length and fit it with a linear function ). the observed number of splitting  events is also plotted for comparison. the first observation from figure  <dig> is that, under the grfp model, number of splitting is linearly proportional to cds length. on average,  <dig> splitting events will occur in an exon with length of  <dig> bps . the second observation is that the observed number of splitting agrees well with the estimation from grfp model, with the exception of non-vertebrates, especially o. sativa, c. elegans, and d. melanogaster.

parameterizing grfp via em iteration
in the previous simulation studies, with the assumption of known σi, we have shown that σe is dependent on α but not on l <dig> and m, which suggests that the value of α can be estimated from σe. however, simulations show that σe is also dependent on σi. to derive the values of α and σi simultaneously without assuming knowing any one of them, here we determine their values through em iterations, by combining simulations with empirically observed σi , μx, and σx  for vertebrate genomes.

before performing em iteration, we need to quantify how σi is related to σx. we performed a series of grfp simulations with σi ranging from  <dig>  to  <dig>  and α =  <dig>  for each simulation, we calculate the insertion ratio ) from the resulted fragments, and estimated σx from fitting a normal function to the histogram of insertion ratios. σx is plotted against given σi in additional file 1: figure s5a. the plot shows that there is a linear relationship between the two. from this relationship, we estimate that real σi is closer to  <dig>  than the  <dig>  estimated from figure  <dig>  to see the over estimation of σi, we show the simulation process and results in additional file 1: figure s <dig> and additional file 1: figure s <dig>  by classifying adjacent exon pairs into four different groups, we show that the mixture of these four groups still follows a normal distribution but with larger σx.

for em iteration, we use σi to estimate α, then use estimated α to re-estimate σi. the iteration start with σi = σx =  <dig>  .

 <dig>  given σi, determine the relationship between α and σ using simulation 

 <dig>  with observed σe  and the estimated relationship ), estimate α

 <dig>  with α, determine the relationship between σx and σi 

 <dig>  with the relationship and σx =  <dig> , estimate σi

 <dig>  return to step , iterate until convergence

the results of the em iteration are shown in additional file 1: figure s5b and additional file 1: figure s5c. at the end, σi converges to  <dig> ; α converges to approximately  <dig>  again, α ≈  <dig> suggests that, during evolution, longer exon has much higher chance to gain an intron than the shorter one, with a probability proportional to its size to the 3rd power.

intron losses accounting for increasing σi, σe and more negative ρ
in table  <dig> and figure  <dig>  we show that σx of non-vertebrates is significantly larger than those of vertebrate genomes. in figure  <dig>  we also observed more negative correlation between insertion ratios for non-vertebrates. additional file 1: figure s <dig> also shows that the size distributions of non-vertebrate exons are different from those vertebrates . in table  <dig>  we have estimated that there is a significant amount of intron losses in non-vertebrate genomes. next, numerical simulations indicate that these three differences could result from excessive intron loss during the evolution of non-vertebrate genomes.

with simulated grfp fragments, we gradually introduce 5-50% of “intron loss” by randomly reconnecting adjacent fragment pairs. the size distributions of the resulted fragments are fitted with a normal function,  and the fitted σe is plotted against percentage of intron loss in additional file 1: figure s9a. the insertion ratio between each adjacent fragment pairs is calculated using equation . their histograms are fitted with a normal function  with the fitted σx plot against intron loss in additional file 1: figure s9b. in additional file 1: figure s9c, we calculate the correlation of insertion ratios between i and i+ <dig> sites using equation  for each of the intron loss simulations and plot them against intron loss. results in additional file 1: figure s <dig> suggest that intron loss might account for increasing σx , and more negative correlation between non-adjacent insertion ratios .

additional file 1: figure s <dig> also shows that the size distribution of exons no longer can be fit properly to a normal function. as the percentage of intron loss increases, a second peak is appearing, as the size distribution of exons for non-vertebrates in additional file 1: figure s <dig> 

discussion and 
CONCLUSIONS
in this study, we analyze the size distribution of exons for  <dig> species, including eight vertebrates and six non-vertebrates. our approach overcomes the limits of using orthologous genes, thus allowing us to infer evolutionary processes affecting the exon-intron structure across widely divergent species. the use of size distributions is more reliable than alignment based approaches if considering the accumulation of repeating intron gain/loss. based on the size distribution of exons, we propose grfp to characterize the evolution of eukaryotic genes. the solid agreements between grfp simulations and observations on genomic data provide several key findings on the evolution of exon-intron gene structures.

chance of intron gain is proportional to exon size to the 3rd power
grfp reveals that longer exons have a higher chance to gain an intron during evolution, and reveals the novel finding that the chance of intron gain is proportional to the exon length to the third power. this finding was derived after investigating real genome data, comparing with numerical simulations, and excluding various effects on grfp through em iterations. this finding might explain why long exons are rare in modern organisms. e.g., statistical study has shown that only  <dig> % of the primate exons are longer than  <dig> nt  <cit> .

the “third power” is derived from σe  of the exon size distributions. the model of grfp indicates that σe will remain constant given the same dependency value α. thus, the nearly identical σe  in table  <dig> suggests the existence of a common dependency value  across vertebrate species. however, the 5′ deviations of α value might indicate that intron is less preferred there. for non-vertebrate species, α cannot be directly estimated since their exons follow a mixture of two lognormal distributions  possibly due to excessive intron loss. for estimation of intron loss in table  <dig>  we simply assume that α ≈  <dig> holds for non-vertebrates.

why is the probability of intron gain proportional to the exon length to the third power? given that the third power is usually related to volume, it might be possible that exon occupies a volume proportional to its length to the third power due to dynamic movement, and the chance of an intron attacking it is proportional to this volume. further investigation will be needed to support this hypothesis.

no evidence for site-specific bias of intron insertion
we derive this finding from indirectly estimating the position distribution of intron insertion loci. we demonstrate that the insertion loci follow a normal distribution, peaking around the center of the exon with a standard deviation  of  <dig> . this observation does not support the proto-splice site hypothesis. if there were proto-splice sites in the exon, the insertion loci would follow the position distribution of these sites, which will most likely be a uniform distribution .

in figure  <dig>  we also demonstrate that, for vertebrate genomes, intron gains are independent of each other. this observation is also one of the core assumptions of grfp simulation. it holds on vertebrate genomes and non-vertebrate genomes if the effect of intron losses is considered. another simplification of grfp is that the effect of exon duplications is ignored. as mentioned earlier, the sharp spikes in figure  <dig> are related to tandem exon duplication  <cit> . such effect is not considered since overall their contribution is not significant in estimating either insertion loci or the chance of intron gain. this is illustrated in additional file 1: figure s <dig> and additional file 1: figure s <dig>  where no such spikes are observed.

the assumption behind the estimation of insertion ratio ) is that the order of the exons within each gene is maintained during evolution. in the cases of tandem exon duplication, exon shuffling, or intron loss, the order is just locally disrupted. simulation also shows that the estimated insertion ratio is a mixture of four different groups of adjacent fragment pairs , but σx is linearly related to σi .

suggesting 5′ intron gain/loss bias
by grouping exons by positions within a gene, we demonstrate that exons next to the 5′ utr have bigger standard deviation  than other exons. one may argue that the deviation near the 5′ utr is caused by the fact that on average exons are longer for genes contain fewer exons. if this is the case, similar trend near the 3′ utr should have been observed. from equation , bigger σe indicates smaller grfp dependency value . the dropping of α values for exons adjacent to the 5′ utr implies that introns are not favored there; in the grfp model ), a smaller dependency value indicates a lower chance in acquiring introns during evolution. alternatively, it might be explained as intron loss bias, that is, introns right after 5′ utr has a tendency to lose than other introns. certainly such comparison is limited to introns in the coding region and debatable due to the unclear stochastic process of intron loss.

excessive intron losses accounting for deviations from grfp
in this study, we show that exons of non-vertebrates are different from those of vertebrates in three aspects. first, the size distribution of their exons fit a mixture of two normal distributions  instead of one for vertebrates . second, their insertion ratios have much larger standard deviations  as shown in table  <dig>  third, their non-adjacent insertion ratios are more negatively correlated as shown in figure  <dig> 

the estimations in table  <dig>  suggest that there are excessive intron losses in non-vertebrate genomes. based on this, we performed simulations of intron loss after grfp fragmentation. additional file 1: figure s <dig> demonstrates that, with increasing intron losses, σe increases, σi increases, and ρ decreases from zero, consistent with the observation on empirical data analysis here. therefore, grfp model holds on non-vertebrate genomes when the effect of intron loss is considered. comparative approaches also show that frequent intron loss has been inferred during the evolution of nematode  <cit>  and drosophila genomes  <cit> , though they cannot provide a genome wide estimation of percentage of intron losses.

here, the excessive intron loss hypothesis in non-vertebrate genomes is interpreted as breaking the equilibrium between intron gain and intron loss. although grfp model is built on modeling intron gain events, it does not assume that introns in vertebrate genomes are never lost. instead, we interpret the straight line in figure  <dig> as a “dynamic equilibrium line for vertebrates”, where the genome reaches a state of stability for its intron count. in additional file 1: figure s <dig>  we observed the similar linear relationship between intron counts and cds length by grouping genes by chromosomes for h. sapiens. this further proves that the “equilibrium” is reached in each chromosome and the linear relationship is independent of lineage . if there are many intron losses during evolution, subsequent gains must have also occurred to bring the genome back to the equilibrium line. therefore, the statistical measurements of the exons can remain the same across examined vertebrate genomes. for the non-vertebrate genomes that fall below the line, equilibrium is shifted to intron loss relative to vertebrates. the shifting  might be related to the differences in the generation time of each species  <cit> .

the size distribution of exons , the insertion ratios  and the correlation map  suggest that a. thaliana, s. bicolor, and z. mays underwent intron loss during evolution though not as significant as o. sativa. the estimated intron losses are around 7% for a. thaliana and s. bicolor, and 4% for z. mays . however, such percentage of intron loss is not significant enough to justify the size distribution of exons for these three plant species, a mixture of two gaussians instead of one as shown in additional file 1: figure s <dig>  another possible explanation is that plants have undergone significant genome duplications and the rate of indels is higher for the duplicate genes  <cit> . the reason is that one copy of the duplicate genes is freed from the selection pressure.

weakness and strength of grfp
in this work, we propose the grfp model to capture the dynamic processes describing the evolution of exon-intron structures. for vertebrate genomes, the model fits well with the well annotated genome data, including exon size distribution, distribution of insertion loci, total cds length, number of introns, independency among intron gains, and 5′ intron gain bias. for non-vertebrate genomes, simulations show that the deviations from the vertebrate genome can be explained by excessive intron loss. the grfp model implies that the evolution of gene structure is purely random, from picking which exon to split  to picking intron insertion loci on the selected exon. the solid agreements between grfp simulations and real genome data confirm that grfp model provides one possible explanation on the exon-intron structure evolution.

it is well known that a modern genome is a collection of introns that have accreted  over at least a billion years. here, by considering the whole process as a black box, we reproduce the output of this box  with numerical simulations. the size distribution of exons serves as the key component in building grfp model because of two reasons. first, the dominant factor that can shape such distribution is intron gain/loss . second, the most prominent cofounding factor on exon sizes - the rate of indels in them during evolution is low. certainly, the mechanism of intron gain is complicated considering differences across lineage, differences in rates of insertion across sites, the age of introns, the possibility of indels to maximize fit to epigenomic structures that can occur following intron gain, alternative splicing, the different models of intron gain, and so on. the process of exon fragmentation  might be as straightforward as the model of grfp describes. by focusing on internal translated exons only, we have demonstrated outstanding agreements between empirical observations and grfp simulations.

it is crucial to note that grfp does not make any assumptions on the rate of intron gain/loss. recent studies  <cit>  have suggested that the early eukaryotes experienced a rapid burst of intron gain. in later evolution, intron loss dominates the landscape, with occasional bursts of intron gains. this does not contradict the results presented here since grfp makes no assumptions about the rate of intron gain or loss during evolution, but instead estimates the chance for an exon to gain an intron somewhere along its length and predicts the distribution of those insertion events.

one may argue that the agreement between the grfp model and well annotated genome structure could be fortuitous. while we cannot rule out that other models might reproduce the exons of modern genomes, the predictive power of grfp is striking, and we believe that it is a promising approach to understanding the evolution of exon-intron structures, and an excellent starting point for new models for revealing the hidden stochastic processes of evolution.

unanswered questions and future studies
grfp model provides explicit rules on the exon-intron structure evolution. however, it does not address the origin of introns, the mechanism of intron insertion, and the rate of intron gain/loss. in other words, grfp addresses where introns are inserted , but not when and how introns are inserted. future research will focus on extending grfp to model the evolution of noncoding exon, and developing grfp-based methods for comparative genomics studies.

abbreviations
grfp: general random fragmentation process; utr: untranslated region; cds: coding dna sequence; em: expectation maximization.

competing interests
the authors declare that they have no competing interests.

authors' contributions
lw developed the model, performed the data analysis and designed the simulation experiment. lw and lds wrote the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1: figure s1
has the size distribution of non-vertebrate exons. figure s <dig> has the size distributions of h. sapiens exons grouped by position, supporting the plot in figure  <dig>  figure s <dig> shows that the distribution of proto-splice sites within h. sapiens coding sequences is uniform. figure s <dig> shows the size distribution of simulated exons with different dependency values. figure s <dig> shows the linear relationship between expected and observed standard deviation of insertion ratios. figure s <dig> illustrates four different groups of insertion ratios. figure s <dig> shows the distribution of insertion ratio for each of the four groups and their mixture. figure s <dig> shows the distribution of fragment size after a certain percentage of intron losses, supporting figure s9a. figure s <dig> shows the distribution of insertion ratios after a certain percentage of intron loss, supporting figure s9b. figure s <dig> shows the linear relationship between the number of splitting and total cds length for each h. sapiens chromosome.

click here for file

 acknowledgements
we thank the national science foundation  and national institute of health  for funding aspects of this work.
