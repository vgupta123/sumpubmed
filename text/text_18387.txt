BACKGROUND
in the nucleus of eukaryotic cells specific regions of the dna are attached to the nuclear matrix. these regions are called matrix attachment regions . it is thought that there are tens of thousands of s/mars in the genome of higher eukaryotes  <cit> , which assigns a major role in the organisation of the chromatin within the nucleus to the s/mars. there is a category of s/mars that function as boundary elements when they separate a gene from other genes' regulatory modules  <cit> . s/mars can activate enhancer regions  <cit> , and determine which one of a class of genes to transcribe  <cit> . they also have a strong effect on the level of expression of transgenes  <cit> . therefore, s/mars are of intrinsic interest for the understanding of gene regulation in eukaryotic cells.

reliable predictions of s/mars by computer would be very valuable, as they would facilitate the design of experiments and improve our understanding of regulatory mechanisms. in genome-wide applications, such methods could allow insights into the number of s/mars  <cit> , their distribution in the genome, their position relative to genes, and the functional classifications of s/mars. however, while a number of methods have been proposed, their predictive power has so far not been put under detailed scrutiny and is therefore uncertain. there has also been very little analysis of the respective strengths and weaknesses of the proposed methods which could facilitate the design of better methods.

a considerable amount of research has been focused on computational predictions of the position of s/mars and several methods of s/mar prediction have been proposed. the mar-finder method scores sub-sequences of dna by the abundance of dna-motifs thought to be correlated with s/mars  <cit> . particular motifs have been suggested by experimental groups: the recognition signature  consisting of two consensus sequences  <cit>  and a "consensus" sequence by wang et al.  <cit> . it has also been found that a long run of bases that do not contain a g binds to the matrix  <cit>  and this is the basis of the h-rule  <cit> . two methods which have attempted to learn motifs from a training set are smartest  <cit>  and chrclass  <cit> , the latter also attempting to classify s/mars.

it has been recognised that s/mars are often at-rich and this has lead to the idea that strand separation  is important for s/mar binding. the program thermodyn  <cit>  makes a simple calculation of the free energy of strand separation and this program has received a fleeting mention in the s/mar literature  <cit>  where its results correlated with the s/mars observed in that experiment.

sidd  is a more complicated calculation of the potential of dna strands to separate in a given region  <cit> . this calculation takes into account the torsional stress on the dna and uses a thermodynamic model of energy states. a long series of papers  <cit>  has drawn attention to correlations between s/mars and sidd results in particular situations and experiments. other authors such as krawetz et al.  <cit>  have included sidd in their list of possible tools for finding s/mars. however, the latest thinking of the sidd team  <cit>  is that sidd calculations do not  form the basis of an s/mar predictor for wild type s/mars in genomic dna. in view of the obvious interest in this approach, the following analyses include our own interpretation of the method which we call "duplex destabilisation".

it is not surprising that the original authors make encouraging statements about their own methods but a number of authors have praised competitor methods, for example:- the authors of smartest say mar-finder gives 80% precision and 32% sensitivity  <cit> . rogozin et al.  <cit>  say that both mar-finder and chrclass  can be recommended for analysing eukaryotic genomes even if caution must be exercised. a paper from the sidd team  <cit>  compared mar-finder, smartest and sidd on one sequence and said "we have applied all three algorithms in parallel and found a reassuring amount of coincidence for a thoroughly studied example." the experimental paper by purbowasito et al.  <cit>  complimented the good performance of chrclass with 85% sensitivity and 50% precision. another experimental paper  <cit>  found the mrs signature to be a good indicator.

there have however been a handful of negative results in the literature. the experimental paper by ostermeier et al.  <cit>  failed to find any correlation with predictive methods. liebich et al.  <cit>  suggested that many motifs associated with s/mars were merely a consequence of the fact that many s/mars were at-rich. although purbowasito et al.  <cit>  complimented the performance of chrclass, other methods were not found to be so successful. krawetz et al.  <cit>  give a small tutorial example on the use of computer methods where it is notable that the methods give different results and the advice is "to compare the results obtained from several different algorithms".

on balance the tone of the literature is very positive, even if this does not reflect the views of many workers in the field, especially for the prediction of at-poor s/mars. the situation calls for a comprehensive statistical evaluation especially since these methods are used by biologists to plan their experiments. our analysis uses relatively large datasets and in particular measures performance against negative control sets.

we have put together a positive test set of experimentally verified s/mars of known position within the mouse or human genome as well as negative test sets and applied all the methods mentioned above to this data. our evaluation reveals that these methods have little predictive power. moreover, we show that a simple rule based on at-percentage generally achieves the same level of accuracy as the other methods. it is well known that many s/mars are at-rich but it is still a surprise that such a simple method compares well with the current state of the art.

a point of practical importance to the user is that the methods will largely predict different sub-sequences. this result might be exploited to design a stronger method for s/mar prediction, but we believe further insights based on the biological mechanisms involved will be needed.

although none of the methods analysed could serve as a practical prediction tool, our analyses suggest several reasons for thinking further research on the h-rule would be valuable.

extensive additional material has been deposited .

RESULTS
we have applied each of the methods to each sequence in the positive and control test sets as explained in the methods section–figures  <dig> and  <dig> give examples of successful and unsuccessful predictions of two methods for sequences in the positive dataset. the vertical lines give the extent of the s/mar and the horizontal line a representative threshold .

mar-finder  includes the "at-richness rules", and mar-finder  excludes this rule. two or more hits for the same s/mar counted as one. this table shows that there is little difference between the results for the positive and background datasets. the ranking of the methods depends on the chosen background discovery rate .

we have found the proportion of true positives and false positives for each method. the trade-off between finding more true positives at the expense of finding more false positives is given by the "receiver operator characteristic"  and figure  <dig> gives a roc curve where the true sequences are taken from our dataset of positive sequences and the false sequences are taken from our preferred control dataset, the background dataset. this graph shows that the discrimination of all the methods is very low. the curves barely rise above the diagonal which represents a random classifier. table  <dig> gives results for methods with a variable threshold where the threshold has been set to give a background "discovery rate" around 10%, and table  <dig> for the other two methods. these predictions are of questionable practical use.

two or more hits for the same s/mar counted as one.

results have also been obtained for a number of different combinations of the data –but no method can be said to be good in any of the conditions tested.

analyses using three other control sets have also been performed. a complete set of graphs for these other control data is available . the results for these three datasets are very similar to each other and we have chosen the coding dataset used in figure  <dig> to illustrate these other results. if this result is taken at face value then the h-rule would be the best and the at-method next best. however, we doubt the value of this result: figure  <dig> shows how effective these predictors are in distinguishing background mouse/human dna from coding dna and this graph shows that the predictors are doing little more than this.

in practice the methods will find different sequences: this can be seen from figure  <dig> where the venn diagram shows the overlap of the sets of positive sequences predicted to contain s/mars by three methods, at the thresholds used for table 1: chrclass, the h-rule and mar-finder –the mar-finder rules are explained in reference  <cit>  and summarised in table  <dig> below. the additional material contains a table showing which s/mars were found . results for other combinations of methods or thresholds will lead to the same conclusion.

each rule is based on a set of motifs thought to be related to a biological feature which itself is likely to be indicative of an s/mar. in standard use, rules 1– <dig> are used.

however, because of the small sample size, we prefer the following presentation. each method ranks each s/mar in the positive test set according to the threshold at which it is detected: if two methods are finding the same s/mars then a plot of the ranks of the two methods against each other will be a straight line. figure  <dig> shows an example: it compares thermodyn with mar-finder –the high ranks  are the points which the methods predict as the most likely s/mars. the correlation of the points in this plot is  <dig> . other pairs of methods give similar results.

the length of the s/mar, as defined in the database, is a feature which makes s/mars easier to predict. figure  <dig> gives a histogram of the lengths of the s/mars in the positive test set. these lengths have a median of  <dig> bases and a mean of  <dig> bases. however, the median lengths of s/mars identified for the thresholds in tables  <dig> and  <dig> are much longer: these medians range from  <dig> to  <dig> which are the values for the at-method and chrclass respectively. this is not a consequence of the fact that a random sequence is more likely to be found if it is longer: figure  <dig> shows the roc curve for s/mars of  <dig> bases or longer in the positive dataset and both the discovery rate and the discrimination improves.

we have considered how the at% of the  <dig> kb region affects the results: we have used a median value of 58% for the at% as the cut off and divided positive and background datasets into at-rich and at-poor. the results for finding s/mars in at-rich regions compared with the results for pseudo s/mars in at-rich regions are given in figure  <dig> and the corresponding results for at-poor regions in figure  <dig>  the general result is that all methods perform slightly better in at-rich regions than in at-poor regions. these results do not support the suggestion that rule  <dig> of mar-finder should be used for at-rich regions and not for at-poor regions. the h-rule is best or near the best in both circumstances. however none of the results are indicative of a good predictor.

we have also looked at the at% of the s/mar itself to see how this affected the success of the predictor: of course the at% of the s/mar is not known until it is found. for this comparison no attempt was made to control for the at% within the background s/mar. figure  <dig> shows that at-rich s/mars are easier to find–a result in line with expectations. the h-rule, thermodyn, the at-method and smartest are the best methods in this analysis. however, the results for at-poor s/mars in figure  <dig> are worse than random predictions: only mar-finder  remains above the diagonal. given that all the methods are looking for some definition of at-richness this result is understandable even if figure  <dig> exposes the problems of the methods.

mar-finder uses the base frequencies of the local sequence in its calculations and this may be relevant to its performance in figure  <dig>  conversely, as explained in the methods section the h-rule is based on an absolute count of motif occurrences. we therefore tested if the mar-finder interpretation of the h-rule would be better–figure  <dig> shows the results for this version . we see that judged on the total dataset it gives a poor result even by the standards of the methods available. however, for the at-poor s/mars it gives surprisingly good results, even if for at-rich s/mars the results fall below the diagonal. some insight into this result can be gained from figure  <dig> which shows the average value of the absolute h-rule score by distance from the centre of the s/mar: also shown is the average value of the background dataset. the s/mar average shows a peak above the background but away from the s/mar this average value falls below the background average. the s/mar average in fact remains below the background average for a few tens of kilobases each side of the centre of the s/mar .

to see the effect of using lis–see the discussion of experimental protocols in the methods section–we give figures  <dig> and  <dig> which show the results for the s/mars confirmed with and without lis. there are some indications that some methods differ in their ability to find these two types of s/mars: for example smartest, the h-rule and thermodyn seem to be better at finding lis verified s/mars. although we were unable to find any combination of results which was statistically significant in the dataset, it is possible that this is because the dataset is too small. we also considered if the in vitro verified s/mars gave different results to the in vivo verified s/mars, but could not find such an effect. for both comparisons it is necessary to control for the different lengths of the positive s/mars in the subsets of the data.

discussion
we have evaluated the predictive power of the available methods for s/mar prediction on positive and background test sets using straightforward analytical techniques. the results lead us to four main conclusions: the methods analysed have little predictive power; a simple rule based on at-percentage does just as well especially at low false discovery rates; in practice, the different methods will identify different sub-sequences; several aspects of the h-rule have been observed which deserve further investigation.

these results are different from those claimed by the original authors and this needs some explanation. we think that the main reason for these conclusions is that much previous analysis did not include a comparison against negative/background test sets and in particular a control based on the length of the putative s/mar. several of the original studies are based on only a handful of positive test sequences. their results cannot be generalised to these larger human/mouse test sets. we also question if some of the analyses in the literature have not been biased by a concentration on one or two of the best cases effectively using very stringent thresholds. as an aid for future work we have included the  <dig> kb sequences for both the positive and control sequences in the additional material .

we have explored changes in the details of the analyses. for example we tried doubling/halving the window sizes. for mar-finder we have tried other combinations of rules, alternatives in defining the base probabilities and how the signals for the two strands are combined. the thrust of our conclusions is unchanged. we are therefore confident that our conclusions are robust against technical changes and definitions. the purbowasito data  <cit>  formed about a third of our dataset. in case this affected the results, we repeated our analyses without this data and our conclusions are unaffected.

while all methods have little predictive power, some comments on individual methods can be made. in general mar-finder performs better when rules 1– <dig> are used than when only rules 1– <dig> are used. this is true for regions which are at-rich as well as those that are at-poor. exploratory analyses suggest that mar-finder might perform better when the base frequencies are defined from a very long sequence which contain the candidate s/mar, but this alternative does not turn the method into a strong predictor. the chrclass method does not come with strong claims from its authors but purbowasito et al.  <cit>  found good performance for s/mars in one megabase of dna sequence. for the same data we find that it detects a high proportion of true s/mars but also has a high false positive rate: for the other s/mars in our dataset it does not perform well . we find the mrs signature to have very moderate predictive power–less than expected  <cit> . the smartest method tends to find a smaller proportion of real  s/mars than either the mrs or chrclass methods. we also find its performance comparable to mar-finder at comparable levels of sensitivity. thermodyn turns out to be as good as some of the more established methods.

the h-rule may not be of practical use but it is the best predictor of those examined. figures  <dig> and  <dig> show aspects of this idea which might be exploited to improve the measure. figure  <dig> and the fact that the s/mar average remains below the background average for tens of kilobases from the s/mar centre invites interpretation. a typical s/mar may be in a large distinctive region which presumably contains more than one s/mar. regions between the s/mars  may be under selective pressure not to bind to the matrix to allow for proper looping of dna. therefore, one way to improve s/mar prediction may be to incorporate features of the neighbouring, non-binding regions into the model.

in framing the duplex destabilisation method, we have followed the ideas and calculational technique of the sidd calculations  <cit> . we have tried variations in the method, e.g. of window sizes and the use of the p-graph instead of the g-graph and have found that they all lead to the same conclusions. we have also experimented with alternatives such as area measures  and length measures . for some area measures there was a small improvement in predictive power but nothing to alter the main conclusions. we did not try the complexities of the method described in general terms in  <cit>  but we see no reason to dispute their conclusion that a sidd predictor of wild type s/mars in genomic dna has not yet been developed.

it is of course possible that these principles might be used successfully but we foresee difficulties and do not share the hopes expressed in  <cit> . the purpose of sidd calculations is to calculate where torsional stress causes dna to separate. it is still not obvious that either torsional stress or strand separation is relevant to s/mar binding. in vivo the salt concentration is comparatively high and dna would relieve torsional stress by twisting about itself rather than melting  <cit> . the presence of nucleosomes also relieves torsional stress. several s/mar proteins bind to double stranded dna and satb <dig> in particular does not bind to single stranded dna  <cit> . the main problem that we have found is that for any sequence the duplex destabilisation method searches for the weakest point. there is therefore a tendency for the duplex destabilisation method to predict exactly one s/mar in any sequence of any length. to some extent this is avoided by the use of the g-graph rather than the probability p-graph–but it remains a difficulty of the method. this explains its poor performance on the coding, negative and e. coli test sets. it also explains the purpose behind the procedure described in  <cit>  of obtaining a standardised measure for a sub-sequence by splicing it into a standard plasmid.

our use of at-percentage as a prediction rule is not intended to suggest that at-richness of  s/mars is a new result. on the contrary, most authors who write on the subject explain that many s/mars are known to have a high correlation with at-rich regions or have runs of as, but the situation is more complicated. the current methods of s/mar prediction have a correlation with at-richness built in: mar-finder has several rules correlated with at-content and the duplex destabilisation calculations are heavily influenced by at-content. indeed as noted below when rule  <dig>  "at-richness", is included in mar-finder it dominates the other rules. however, we do find it striking that our simple at-percentage-rule is competitive with published methods.

one notorious problem for research in this area is the choice of a control set. there are a number of features of the genome which have been annotated–for example transcription start sites–but it does not follow that these regions are free of s/mars. on the contrary these may be regions where s/mars are to be found. the approach that we prefer is to use real dna sequences chosen randomly from the mouse genome. the disadvantage is that the real proportion of s/mars within this test set is unknown. however, if a predictor cannot make a clear distinction between the real s/mars and the background set it must mean that either the predictor is very poor or that the definition of an s/mar is nearly meaningless–a random piece of dna is just as good. we have constructed three other control datasets: the coding, the negative and the e. coli dataset. the advantage of these three sets is that it is almost certain that there are no s/mars in these datasets: both the function and sequence of coding sequences make them unlikely to contain s/mars; the negative dataset consists of an entirely artificial sequence; and e. coli has no nucleus which implies that no specialised s/mars can have evolved. the disadvantage of these datasets is that they can easily be distinguished by statistical methods from mouse/human sequences and if the evaluation is set up in this form it is not clear whether a successful measure is doing anything more than distinguishing the type of sequence rather than finding s/mars. our reading of figures  <dig>   <dig>   <dig> is that this is all these measures are doing. however, if these control sets are regarded as giving a proper evaluation then the h-rule and the at-method are superior to the other methods. it is also true that if one used a threshold which found only a fifth of real s/mars then most of the methods would find a negligible number of s/mars in these three control sets. however, on the same basis, the same threshold would identify at least a tenth of random sequences of mouse dna as containing an s/mar.

users will also need to bear in mind that different methods will predict different sub-sequences as s/mars. at one level this is obvious in that the default parameters of the different methods operate at regions along the roc curve. it is also a corollary of the with-lis/non-lis results . other evidence that the methods will in practice identify different sequences was given in figures  <dig> and  <dig> 

a number of roles for s/mars have been proposed in the literature  <cit> , and this suggests it might be possible to predict the function or type of an s/mar as well as its presence. however, there is not yet sufficient data for such an analysis. the chrclass method  <cit>  is an attempt at this, but the authors themselves stress the difficulties of their analysis. we examined the notes in smart db and it is possible that the different methods are in fact predicting s/mars with different features, e.g. duplex destabilisation for s/mars with bent dna and mar-finder with clusters of motifs, but with the current limited data we can only leave this as a question for further work. the analysis splitting the data by lis and non-lis s/mars fell short of giving statistical significance, but it would be interesting to see if a larger dataset could settle the question of whether some methods were better at finding lis confirmed s/mars.

using background sequences allows one to see how many hits a method will generate on average in a length of sequence. unfortunately the poor predictive power of the methods means that we cannot go on to estimate the number of s/mars in the genome, and we have therefore not reported these results.

however, two points may be made. firstly, as could be deduced from the results section, there are many hits in the background sequences. secondly, sequences containing a known s/mar contain more hits than background sequences do–suggesting that s/mars come in clusters. this possibility is not unexpected given the work of  <cit>  and  <cit> .

it is also revealing to examine individual plots of  <dig> kb sequences. figure  <dig> gives an example of the results for one sequence of  <dig> kb: this happens to be of the mar-finder  measure but similar examples could be given for any of the measures. the known s/mar is of length  <dig> bases in the centre of the sequence where there is a small local peak whose height is lower than the many other peaks in the figure. one possibility is that for this sequence this method simply gives the wrong results. another view is that the rule gives a near miss or there are several s/mars in the region. this figure is typical of dozens that we have examined. the implication is that s/mars may come in clusters which are spread over many kilobases and that the existing methods do not get to the root of the matter.

CONCLUSIONS
we have been invited to comment on where progress might be made in this field. we do not share the view that s/mars are no more than an experimental artefact but we do suspect that the term is too broad and useful categories need to be identified either by function or more probably by the protein  that binds to the s/mar. we also expect that experiments of wild type s/mars will be more useful than in vitro ones. a corrollary of s/mars coming in clusters is that a biologically relevant feature might be a long region  that contains a cluster of s/mars. support for this idea comes from the behaviour of the h-rule measure which takes several  <dig> kb to return to the background level. if the biology is to be explained in terms of strand separation then the in vivo mechanisms need to be better understood. on present evidence it looks more likely that the h-rule is closer to the biological mechanisms and that progress may be made by a better mathematical formulation of the h-rule.

it appears that existing methods can pick out a few extreme candidates for s/mars and that these can be expected to be true positives. however, a method which identifies s/mars with good precision is still needed. it is clear that a new insight is needed: perhaps then we will be able to identify some sequences as forming–for example–insulators between genes and others as framing regulatory cassettes.

