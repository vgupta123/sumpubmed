BACKGROUND
hematopoietic stem cells  have been in the focus of research since the beginning of last century  <cit> . easy accessibility and handling, in combination with elegant experimental techniques like clonal assays  <cit>  made the hematopoietic system the best studied mammalian stem cell system. as a consequence, the first models were designed in the 1960s  <cit> . the process of hematological homeostasis is characterized by a relative stability of the  stem cell pool and a massive amplification along the differentiation process, leading to a daily production of about 1011- <dig> mature blood cells  <cit> . this observation led to the so called pedigree concept, which postulates that stem cells originate only from stem cells, i.e. either maintain the stem cell state or lose it irreversibly  <cit> .

this concept represents a core assumption of most mathematical models for hematopoiesis that have been formulated complementary to experiments. some do not explicitly model stem cells but include them as a source of cellular influx into the modeled differentiation stages of hematopoiesis  <cit> . models that explicitly model the hematopoietic stem cell population mostly focus on the cell number of one  <cit> , or more populations  based lineage models of human granulopoiesis, erythropoiesis and thrombopoiesis  <cit> . all these models are supplied by the same stem cell model. they describe the dynamic regulation of hsc, proliferating and maturing progenitors, mature blood cells and cytokines of the hematopoietic system and aim at predicting the complex dynamics of hematopoiesis during combined chemotherapy and growth factor applications. a number of feedback loops control differentiation and amplification, e.g. via the probability of stem cell self-renewal, amplification rates and maturation times of committed cells. models of pharmacokinetics and -dynamics of growth factor and chemotherapy applications were introduced recently, allowing precise predictions of clinical data in numerous scenarios  <cit> .

the strictly hierarchical pedigree concept was challenged as experimental evidence for stem cell flexibility was found at the end of the last century. cells from neural  <cit> , skeletal  <cit>  and vascular tissue  <cit>  were shown to be capable of engraftment in irradiated hosts and to contribute subsequently to the production of mature blood cells. most likely this flexibility is induced and controlled by the stem cell environment  <cit> . our formerly developed agent-based model  of hematopoietic stem cell organization incorporates such a context dependent stem cell regulation by considering two stem cell growth environments   <cit> . in one of these two ge, which can be interpreted as a stem cell niche <cit> , the stem cells are quiescent and regenerate their ability to remain in the niche, while in the other ge they proliferate and lose this niche affinity. the broad range of successful applications of this modeling concept includes modeling of clonal competition  <cit> , age-dependent repopulation potential after irradiation  <cit>  and treatment of chronic myeloid leukemia with imatinib and interferon-α  <cit> .

certainly, the aim of systems biology and modeling is generation of consistent explanations for as many scenarios as possible. therefore, the following natural question arises from the diversity of individual models and the different scenarios they explain: can we assume their compatibility and even expect synergistic advantages from their combination? desirably, the combined models should cover  complementary scenarios for maximal synergistic effects, but apply for the same scenarios for compatibility. due to this premise, we pursue this question with an attempt of second-level modeling: a combination of our ode model of human granulopoiesis that follows the hierarchical paradigm and our agent-based stem cell model. both models were developed on the basis of different biological evidence, experiments and data and are well established. thus our effort was to combine them without changing their assumptions, equations, parameters and application scenarios as far as possible.

if the models prove to be compatible, we can expect the mentioned synergistic effect for a set of reasons. the ode model turned out to be highly sensitive to changes in its stem cell compartment   <cit> . exchanging its homogeneous stem cell population for a structured stem cell model enables modeling of phenomena caused by heterogeneity within the scc, such as lineage priming of stem cells, clonal competition like leukemia development and treatment or cell-cycle specific susceptibility to chemotherapy or radiation. although ode model simulations of granulocyte dynamics under chemotherapy agree well with clinical data, predicted reduction of stem cell numbers appears to be over-estimated  <cit> . on the other hand, the abm does neither consider effects of growth factors nor their pharmacokinetics. as a result, the abm is not able to correctly account for short-term effects in the reconstitution of blood cell number after chemotherapy which is often supported by growth-factor applications. besides, abm simulations for realistic cell numbers from stem cells to differentiated cells are computationally expensive.

therefore, we here propose an integration of these model concepts guided by the motivation that systems-biologic modeling is an iterative process. we substitute the ode stem cell model by a difference equation-based formulation of the abm describing continuous cell numbers  <cit> . by this approach, we expect to construct a more comprehensive model with a broader range of possible applications, e.g. in the context of planning of clinical trials.

the adaptations necessary to combine the models will be discussed in detail. we compare the new hybrid model with the former ode model in a number of qualitative tests, e.g. with respect to chronic irradiation or bleeding. finally, we used the hybrid model to simulate four different chemotherapy regimens comprising both, dose and time intensifications of therapy and growth-factor applications as well.

methods
in the following, we briefly explain our ode model for human granulopoiesis, our abm stem cell model and its difference formulation. building on this background we then establish our hybrid model.

ode model for human granulopoiesis
we here summarize the central features of the ode model of human granulopoiesis. the complete set of equations and parameters is given in the appendix . all model assumptions are comprehensively discussed in scholz et al.  <cit> . the model describes the dynamics of concatenated cell compartments by a set of odes . cell compartments represent cell numbers of morphologically distinguishable cell stages of granulopoiesis, namely hsc, colony-forming units, maturing blasts in the bone marrow and mature granulocytes in peripheral blood   <cit> . the two growth factors granulocyte-macrophage colony stimulating factor  and granulocyte colony stimulating factor  are also explicitly modeled and regulate amplification and transit times in bone marrow compartments.

in all individual cell compartments, except for stem cells, a general balance equation reflects the dynamics of growth, differentiation and cell death due to chemotherapy: change in compartment size = influx × amplification - efflux - cell loss.

influx is given by the efflux of the upstream compartment, while amplification and efflux of compartment x are computed from the amplification-related parameters proliferative fraction ax and amplification ax and the residence-related parameters transit times tx . the stem cell compartment represents the root of the hematopoietic tree without influx. in this case, the first term of the balance equation is simply replaced by proliferation/amplification.

amplification and differentiation is controlled by the four feedback loops sketched in figure  <dig>  amplification and self-renewal in the stem cell compartment are regulated by stem cell number cs  and the number of granulopoietic bone marrow cells cg . a decrease/increase in both cell numbers cs and cg results in an increase/decrease, respectively, in proliferation, while the effects of cs and cg on self-renewal are contrary: low stem cell numbers cs result in high self-renewal with higher priority than low bone marrow cell number cg causing increased differentiation. these two feedback functions are adopted from wichmann and loeffler   <cit> .

the remaining two feedback loops  control maturation and amplification in the whole bone marrow except for the scc. they are mediated by the growth factors g-csf and gm-csf   <cit> . g-csf acts in different modes: it increases proliferation, maturation and the release of bone marrow cells to the blood. gm-csf regulates amplification in cg. endogenous production of both growth factors depends on cell numbers in the bone marrow and the blood. subcutaneous and intravenous g-csf applications were included by a simple pharmacokinetic model. we model a delayed influx from the subcutaneous compartment by a two-compartment system. degradation in the central compartment is assumed to happen unspecifically and specifically with the specific degradation being proportional to the number of circulating granulocytes. we assumed that applied g-csf acts in the same way as endogenous g-csf, i.e. novel g-csf pharmaceuticals such as pegylated g-csf with different pharmacodynamics were not considered here.

according to mouse data, chemotherapy was modeled as an acute transient depletion of bone marrow cell stages following a first order kinetics depending on the drugs applied and the cell compartments affected.   <cit> .

all cell compartments are normalized with respect to the setting cs =  <dig> in steady-state. hence, all subsequent compartments are given in units of equilibrium stem cell number. furthermore, we usually present relative compartment sizes cxrel = cx / cxnor. the steady-state values cxnor for all compartments x are given in the appendix .

the agent-based stem cell model
in contrast to the representation of the stem cell population in the ode model, our agent-based stem cell model represents each cell individually. a general scheme of the model is given in figure  <dig>  each cell is characterized by the growth environment ge that accommodates the cell and a niche affinity a∈  <cit> . in each simulation step the cells can either remain in or switch between the two ges. ge Α and Ω represent functionally distinct signaling contexts and may be interpreted as a niche and a non-niche environment, respectively. in the niche environment Α, cells are quiescent and regenerate niche affinity a, while in the non-niche ge Ω they proliferate and lose niche affinity. if a cell acquires an affinity lower than amin, it loses its ability to switch back to Α, to regenerate affinity a and to self-renew. then it leaves the stem cell compartment and enters further differentiation and amplification stages. when a cell switches ges, its affinity a remains constant. the evolution of each cell’s affinity a at time t is given by:

  at+1=minat⋅r,amaxat/datinainΩfortransistionsa→Ωand 

here r >  <dig> and d >  <dig> are the regeneration and differentiation coefficients, respectively. the cells at amax in ge Α conserve their state unless they switch ges.

the transitions between the ges happen randomly with transition intensities  that depend on cell numbers in the target ges and the individual cell’s affinity. these dependences introduce an intrinsic regulation of stem cell proliferation and differentiation. for a cell of affinity a and a hsc population of nΑ cells in ge Α and nΩ cells in ge Ω, they are given by:

  αa,na=aamaxfαnaandωa,nΩ=aminafωnΩ 

where α and ω are the intensities of transitions Ω → Α and Α → Ω, respectively. the functions fα and fω model a limited capacity of both ges approaching zero for increasing cell numbers in the target environment. their definition is given in the appendix .

because at amax the cells are quiescent and the probability of their transition to Ω, and with it activation, is minimal, these cells can be interpreted as dormant stem cells  <cit> .

proliferating cells in Ω are additionally characterized by their cell cycle position c. in each simulation step it is simply increased by the time step: ct+1 = ct + Δt. the established parameter set for human hsc assumes 48 h for a complete cell cycle, which is divided into two sub-phases: an intermediate g1-phase of 32 h  and a mitotic phase of 16 h , subsuming s/g2/m-phases  <cit> . during mitotic phase, no transitions to ge Α are allowed. at the end of cell cycle, a cell divides into two daughter cells. they inherit the affinity of their mother cell and start cell cycle in g1-phase . if a cell switches to ge Α, it always becomes quiescent. if a cell switches to ge Ω, it enters the mitotic phase at c =  <dig> 

a summary of all parameters of the stem cell model is given in the appendix .

difference equation formulation
when considering realistic cell numbers, simulations of individual cells are computationally expensive. to replace the ode scc we thus decided to use a difference formulation of the abm introduced in the last section which was established by kim et al.  <cit> . this difference formulation is based on exactly the same equations and parameters as the abm. it reduces computational effort by defining a discrete set of affinities and describing numbers of cells of those affinities instead of individual cells of arbitrary affinities  <cit> . considering eq.  this discrete set is constructed as follows:

 <dig>  if a cell in ge Ω starts with maximal affinity amax = a0 =  <dig> and does not change ge, it will adopt the affinities ak = d −k ; k∈ℕ <dig> and eventually leave ge Ω at amin. hence, defining kdmax=maxk|d−k>aminℕ, its niche affinities in ge Ω are fully described by the set k∈ <dig> ,…,kdmax with the associated affinities ak = d −k . analogously, all niche affinities in a can be mapped onto  <dig> ,…,krmax with krmax=maxk|r−k>aminℕ and the affinities ak = r−k.

 <dig>  if a cell switches ges, its affinity is conserved  and to set up the difference equations formulation two matching sequences of affinities are required in the two ges. this is not the case in general, if d ≠ r. but if ln r / ln d is a rational number with ln r / ln d = v/w, the set of all possible affinities is given by e−kρ,k∈ℕ0+ with ρ = ln r / v = ln d / w. the established parameters of the human system are r =  <dig>  and d =  <dig>  with ln r / ln d ≈  <dig>  setting ρ =  <dig>  results in the slightly modified coefficients r = e2ρ =  <dig>  and d = eρ =  <dig> . together with amin =  <dig>  from the human parameter set, this results in kmax =  <dig> 

hence, the difference formulation describes the number of cells Αk and Ωk in compartments that are associated with the affinities

  ak=e−kpwithk∈ <dig> ,…, <dig> 

while the quiescent cells in ge Α are fully characterized by their affinity a, in ge Ω the cellular state is given by the combination of affinity a and cell cycle position c. the number Ωk of cells of affinity ak in Ω is subdivided into the number of cells Ωk,c of cell cycle position c. with c running from 0h to  <dig> h and a simulation time step of Δt = 1 h this leads to  <dig> steps, a cell cycle duration of τ = 49 h and a 128 ×  <dig> matrix Ωk,c of cellular states. thus, the cell numbers nΑ and nΩ that determine the transition characteristics are given by:

  nat=∑k=0127akt 

  nΩt=∑k=0127∑c=048Ωk,ct, 

where ak is the number of cells of affinity ak in ge Α and Ωk,c is the number of cells of affinity ak and cell cycle position c in ge Ω. for each value of ak, the transition probabilities α and ω are given by eq. . for computation time, we approximated the binomially distributed number of cells that switch ges with their expectation values ω) · ak and α) · Ωk,c for c = 0… <dig>  these settings finally result in the following set of difference equations:

  Αkt+1=Α0t1−ω <dig> nΩt+Α11−ωe−ρ,nΩt+Α21−ωe−2ρ,nΩt,k=0Αk+2t1−ωe−k+2ρ,nΩt+∑c=031Ωk,ctαe−kρ,nΑt,k= <dig> …,125∑c=031Ωk,ctαe−kρ,nΑt,k= <dig>  

  Ωk,ct+1=Α0tω),2Ωk− <dig> t,Ωk− <dig> c−1t)),Ωk− <dig> t))+Αkω),Ωk− <dig> c−1t, <dig> k= <dig> c=32k> <dig> c=0k> <dig> c= <dig> …,31k> <dig> c=32k> <dig> c= <dig> …,48else 

construction and implementation of the hybrid model
in the hybrid model, the difference formulation of the abm introduced in the last section replaces the ode scc. accordingly, stem cell number cs is now given by ns = nΑ + nΩ  and ). naturally, the new scc must comply with the coupling of scc and other compartments in the ode model regarding cell fluxes, chemotherapy effects and feedbacks .

cells passing the threshold amin lose the ability to return to ge Α and to self-renew which means that they enter subsequent maturation stages. they constitute the efflux of the stem cell compartment nsout and the influx into the committed progenitor compartment cg. the equilibrium efflux of the abm stem cell compartment n^sout relative to equilibrium stem cell number n^s is n^sout/n^s= <dig> h‒ <dig> and, thus, considerably smaller than in the ode model . however, the stem cell uncertainty principle  <cit>  makes is hard to identify stem cells and, thus, their total number precisely. on the other hand, the ode model normalizes all cell numbers with regard to stem cell number, while the abm uses the parameters ÑΑ and ÑΩ for scaling stem cell number which have no influence on qualitative model behavior. thus, we consider the discrepancy in output as a scaling problem and decided to match equilibrium efflux of the abm with the one in the ode model by using the scaling parameter kscaling. therefore, in the hybrid model the efflux from s and influx to cg given by:

  csoutt=kscalingnsouttnstΔtabmwithkscaling=n^sc^soutn^sout 

for the interval of one abm simulation step tiabm;tiabm+Δtabm it is assumed to be constant.

in the ode model, chemotherapy causes a general reduction of the homogeneous stem cell population. the difference equations model distinguishes between proliferative and non-proliferative cells. hence, it is possible to model the effect of chemotherapeutic drugs by cell-cycle specific toxicities  <cit> . in analogy to the ode model, we model chemotherapy as a transient first order loss, but limited to proliferating cells in ge Ω. this is implemented by an intermediate state Ω′k,c in each simulation step:

  Ωk,c'tn+Δt=1−ksΨcxΩk,ctn, 

where Ψcx is the characteristic chemotherapy function of the regimen considered . subsequently, all other processes such as transition between ges, cell divisions, differentiation and regeneration are computed from this intermediate state.

finally, feedback loops  <dig> and  <dig> of the ode model  remain to be integrated into the hybrid model. loop  <dig> is replaced by the intrinsic regulation of the new scc. to implement the effect of feedback loop  <dig> in the hybrid model, we considered two alternative mechanisms using the number of granulopoietic cells in the bone marrow as regulator. in analogy to an increased proliferative fraction, the first one is based on an activation of quiescent stem cells by regulation of the transition probability ω. the second increases activity in the scc by a general acceleration of all processes. both concepts were tested extensively with various feedback functions. it turned out that this feedback loop, which is of clear importance for the ode model, can be dropped in the hybrid model without loss of accuracy for the scenarios considered .

we like to emphasize here that constructing the hybrid model we did not perform any parameter fittings, i.e. all parameter values derived from the ode and abm model were preserved. this also applies for parameters required only for certain model scenarios such as pharmacokinetic and –dynamic parameters of g-csf applications or chemotherapy toxicities.

implementation and simulations
the hybrid model was implemented in simulink  <dig>  and matlab  <dig> . <dig>  . using the simulink interface of user defined s-functions we implemented the difference equation formulation of the stem cell model as a matlab s-function. simulations of the hybrid model were carried out on suse linux enterprise server  <dig> . all parameters for the ode model, the difference formulation of the abm and toxicities of drugs are given in a <dig> , a <dig>  and a <dig>  respectively.

RESULTS
a number of qualitative and quantitative simulations were performed to study the behavior of our hybrid model in comparison to the former ode model. if not stated otherwise, we present normalized cell numbers crel in all figures.

qualitative model behavior
depletion of the granulocyte compartment
first, we considered an initial depletion of granulocytes setting cgra=10−15cgranor and initializing all other compartments with their equilibrium number cnor. we compared the two models regarding dynamics of granulocyte recovery. in both models, the depleted granulocyte compartment is quickly repopulated after about 8 h and equilibrates after a short overcompensation. equilibrium is reached after about 1d. since the loss in granulocyte numbers is signaled only via g-csf to pgb and mgb, the feedback to the scc is not involved. consequently, the results of hybrid and ode model are virtually identical .

depletion of the granulocyte and maturing granulopoietic precursor compartment
next we simulated repopulation after a depletion of the two latest stages of granulopoiesis . after initially setting the cell numbers in gra and all mgb subcompartments to 10- <dig> of their equilibrium values and all remaining compartments to cnor, the resulting repopulation dynamics are more complex compared to the previous scenario. in the ode model, the loss in compartment mgb is transmitted to the scc  and results in both, an increased proliferative fraction and a decreased self-renewal in s . this induces an increased efflux and a reduction of s. in consequence, the ode model quickly repopulates after about 3d, but the feedbacks cause damped oscillations for approximately 80 days. without the stem cell activation via feedback  <dig>  the hybrid model shows a very similar first response except for the stem cell compartment, but no oscillations occur.

simulations of bone marrow transplantation
because the differences between the models lie in the two scc, we addressed them directly by simulations mimicking bone marrow transplantation with g-csf support after myeloablative conditioning. for this purpose we initialized all bone marrow compartments with 1% and gra with 50% of their equilibrium values. in all simulations g-csf was applied until recovery of granulocyte number is achieved. in the ode model, g-csf was applied for 8 days. under these conditions, the scc regenerates 50% of its equilibrium value after 18 days and 100% after 61 days . due to the feedback mechanisms small oscillations in stem cell number occur. repopulation of progenitor compartment cg is similar to s. the more mature compartments pgb and mgb recover faster than stem cells s and progenitors cg. mature granulocytes gra recover 25% of their equilibrium value after  <dig>  days, 50% after 6 days and repopulate completely after 7 days. if g-csf application is extended to 20 days, recovery dynamics does not change in gra, but clearly in the scc despite of no direct effects of g-csf on s. regeneration in the scc is accelerated considerably, repopulating 50% after  <dig>  days and 100% after only 19 days .

analogously, we tested the performance of the hybrid model in this scenario . in both ges Α and Ω of the scc the content was reduced to 1% of its equilibrium value. here, recovery is very slow compared to the ode model and not completed after 100d. initially, only gra and cg decrease clearly. stem cell number s decreases only slightly, because the cells found at low affinities a in ge Ω rarely switch to Α, but rather leave the scc. after these cells have left the scc, the intrinsic regulation of the scc first repopulates s before it generates progenitor cells again. initially maximal amplification allows cell numbers in pgb, mgb and gra to grow. then the efflux of progenitor cells from s drops to only approximately  <dig> % of its equilibrium value and causes a decline of all subsequent cell numbers. the nadir propagates through all compartments eventually reaching gra, which starts to regenerate at d <dig> 

if only Ω is reduced in the scc, 82% of the stem cells remain in ge Α, repopulate ge Ω and restore the efflux of progenitors . reduced transit times in later departments and increased amplification lead to a repopulation of gra after only 10 days.

hence, fundamentally different behavior arose from those three scenarios. while recovery is fast in the ode model, in the hybrid model it is not achieved within a reasonable time frame, if all stem cells are reduced. if only ge Ω is affected, maximal reduction of gra is similar to the ode model, but stem cell dynamics are largely different.

preliminary adaptations of the hybrid model to this scenario were motivated by the effect of myeloablation on the bone marrow environment . we altered the transition characteristics of the scc that model limited capacities of both ges. without changing their values at the equilibrium cell numbers, the feedback was made more sensitive by increasing the sensitivity of the sigmoidal transition characteristics to cell number . this resulted in much faster repopulation dynamics after reduction of both ges . higher values of the transition characteristics at small cell numbers resulted in stem cell repopulation after 31 days and recovery of 25% of granulocytes after 36 days. in these simulations the fast repopulation dynamics of the stem cell compartment results in oscillations, too. however, we have not elaborated this approach for application to bone marrow transplants, because here we limit ourselves to the combination of the two models as a proof of principle.

chronic irradiation
after single initial reductions we were interested in the behavior of the system when exposed to a continuous damage as in the case of chronic irradiation. in mice irradiated with a daily dose of up to  <dig>  gy/d this continuous damage results in a strong, dose-dependent decline of cfu-s numbers during the first days of irradiation. then cfu-s numbers were found to stabilize at a lower level . cell numbers of later cell stages also decrease in a dose-dependent way, but until a dose of about  <dig>  gy/d their cell numbers are less sensitive compared to cfu-s. then they decline rapidly and the animal dies. these results suggest that until a certain threshold of damage, the system can compensate the decline of cfu-s. we expect a similar behavior for human hematopoiesis and checked whether the hybrid model can reproduce this behavior, too.

following wichmann and loeffler, chronic irradiation is modeled as a constant first order kill with rates ks in s and kcg = kpgb =  <dig>  ks in cg and pgb  <cit> . in the hybrid model, we consider applications of the kill rate ks to either both ges or only to the proliferative ge Ω. for each scenario, we recorded the contents of cell compartments after 100d. in the ode model, s and cg show the same dose dependence . at small doses, their cell numbers are highly sensitive to small dose-increments. at higher doses the scc responds to the stem cell loss by higher proliferation and self-renewal and stabilizes at low stem cell numbers until the system dies for kill rates ks >  <dig>  h- <dig>  at stem cell kill rates lower than  <dig>  h- <dig> the rapid loss of s and cg is compensated by increased proliferative fractions and amplifications resulting in only slightly reduced cell counts of circulating granulocytes . for doses of  <dig>  h-1 < ks <  <dig>  h- <dig> the loss can no longer compensated and gra starts to decline rapidly.

in contrast, in the hybrid model reduction in s is smaller than in all other compartments and the greatest cell loss is always found in cg . during the differentiation process the amplifying compartments compensate this loss to some extent, too. if both ges are damaged, the system is more sensitive to the chronic damage and collapses at kill rates an order of magnitude smaller than the ode model . at a kill rate ks ~ 10-3 h- <dig> proliferation in ge Ω fails to counterbalance the losses in both ges, the scc cannot stabilize anymore and dies. if only ge Ω is affected, s itself is very robust against irradiation, but the kill in ge Ω minimizes progenitor efflux. yet at intermediate kill rates, this strong reduction of efflux cannot be compensated at later cell stages .

quantitative modeling - application to chemotherapy data
after studying the behavior of the hybrid model qualitatively in comparison to the ode model, we now apply it quantitatively to clinical data provided by the nhl-b trial of the german high grade non-hodgkin-lymphoma study group  <cit> . since one of us  is the responsible biostatistician of this trial group, we have access to raw patient data for our modeling purposes. leukocyte counts were determined in patients receiving one of four chop-like multicycle polychemotherapy regimens. the schedules differ in application of etoposide  and duration of therapy cycle . the time-intensified regimens require g-csf support. for comparison with the normalized simulation results leukocyte number is assumed to be proportional to granulocyte number with normal value of  <dig> leukocytes per μl blood  <cit> . details of therapies can be found in the appendix, table  <dig>  the pooled patient data is available online as supplemental data .

chemotherapy regimen without g-csf
the hybrid model distinguishes between proliferative and quiescent stem cells. for the mitosis-related effect of the applied drugs we restrict their toxic effect on proliferating stem cells. the effect of the three cytotoxic drugs applied in the chop regimen is modeled by a single set of toxicity parameters, one parameter for each compartment Ω, cg, pgb and mgb. toxicity parameters were taken from  <cit> . in particular, we used the same parameter value for toxicity in Ω as for our former stem cell toxicity. the effect of prednisone is modeled as a prolongation of granulocyte half-life according to bishop et al.  <cit>  and dale et al.  <cit> . the results of the simulation of chop- <dig> in comparison to clinical data are shown in figure 6a. after an initial increase of leukocytes due to prednisone application, the cell counts decrease to about 10% of their normal value until day  <dig>  followed by a recovery phase until the start of the next cycle. model results fit well to the clinical data in the sense that the model prediction is in the interquartile range of the clinical data for almost all time points. for the choep regimen, an additional set of toxicity parameters representing the toxicity of the drug etoposide is used. again, model predictions fit well to clinical data applying the same toxicity parameters as used in scholz et al.  <cit>  .

chemotherapy regimen with g-csf
the chop- <dig> and choep- <dig> regimen use the same schedule of drug administration, but reduce regeneration time. the damage caused by this intensification is counterbalanced by application of the growth factor g-csf between day  <dig> and day  <dig> of each cycle. therefore we have used the same toxicity parameters as for a cycle duration of 21 days. g-csf applications are covered by the pharmacokinetic and -dynamic model of g-csf provided by the ode model and given in the appendix a <dig>   <cit> . again, for both scenarios a good agreement of hybrid model simulations and data was found for the original toxicity parameters and without other adaptations . even though a completely different model of stem cell organization and regulation was used in the hybrid model, the resulting leukocyte dynamics under chemotherapy is consistent with both, the ode model and the clinical data.

comparison of stem cell dynamics during chemotherapy
to explain this phenomenon, we had a closer look at the behavior of both sccs and their effluxes in the course of chop- <dig> simulations . during chop- <dig> application, total stem cell numbers in ode and hybrid model are reduced . but while the ode scc is almost eliminated, the scc of the hybrid model maintains the quiescent population and, thus, more than 80% of its total number due to the limitation of cytotoxicity to proliferating cells. although proliferative cells are equally reduced in both models, in the hybrid model the quiescent cells quickly repopulate the proliferative ge after the cytotoxic effect of drug administration has passed, and facilitate a nearly complete recovery in each cycle. in contrast, the scc of the ode model has to regrow from only  <dig> % of its equilibrium population. therefore it maximizes its proliferative fraction as and puts all cells to proliferation, but even so it only restores about 20% of its equilibrium population until the beginning of the next cycle.

despite the huge differences in the dynamics of stem cell numbers after chemotherapy, the effluxes of both scc show similar dynamics . in the beginning of each cycle both almost vanish and around day  <dig> both increase rapidly to more than 50% of their equilibrium value. at this time efflux is almost restored in the hybrid model, because ge Ω recovered almost completely. in the ode model the feedback loops regulating proliferative fraction as and probability of self-renewal p allow an increase of efflux to about 50% of its equilibrium value although stem cell number cs is still around 10% of its equilibrium value csrel. in consequence, on the level of mature granulocytes, both models agree with each other and the clinical data as well, because the differences in efflux from the stem cell compartment are sufficiently small to be compensated by the feedback controlled amplification in subsequent bone marrow compartments.

discussion
the number of attempts to model hematopoiesis or hematopoietic sub-processes is considerable . usually established models are extended to cover new scenarios  <cit> . however, despite the often complementary scenarios covered by yet existing models, little effort was made to unite them in order to show their compatibility/consistency, to seek confirmation or to address open questions. here, we pursue such a cross-validation of two established models for hematopoiesis developed in different contexts and on the basis of different experimental data by combining them into one comprehensive hybrid model for human granulopoiesis. the two models were chosen for their range of clinically relevant applications, established parameter sets, in particular for human hematopoiesis, and their complementary level of description. rather than constructing a model from scratch, we rely on these complementary modeling works by adopting all their model assumptions, equations and parameter settings. therefore only adaptations necessary to combine them were made. due to the different contexts in which the models were developed, it was by far not clear whether such an attempt will be successful. our approach can therefore be understood as a second level of modeling by combining established models in order to construct more comprehensive ones. to solve this task, we examined different hypotheses for model combination and performed a number of qualitative and quantitative benchmark simulations to compare the hybrid model with the established ode model, to test whether the combined models are compatible and to check whether the new hybrid model has potential to explain a broader range of scenarios.

the ordinary differential equation-based lineage model for granulopoiesis developed by scholz et al.  <cit>  served as the backbone of our hybrid model. this model describes the dynamics of cell stages from stem cells to circulating granulocytes and the granulopoietic growth factors g-csf and gm-csf. it succeeded in modeling and prediction of a number of clinically relevant scenarios of chemotherapy and g-csf applications  <cit> . the model of chemotherapy is based on transient cell depletions of bone marrow compartments in dependence on drugs and drug doses. alternative approaches to model chemotherapy are based on assumptions regarding increased apoptosis and impaired proliferation. we relied on our approach since our former modeling proved to be successful in explaining clinical data sets of different chemotherapies  <cit> .

because stem cells are represented as a homogenous population, modeling of processes influenced by stem cell heterogeneity such as cell cycle dependent drug toxicity is difficult in the ode framework. this was motivation for us to combine it with a more detailed model of hematopoietic stem cells which was developed to understand e.g. clonal competition and immune-chemotherapy effects in leukemia treatment  <cit> . combination is realized by replacing the stem cell compartment of the ode model by a difference equation formulation of the agent-based model of hsc organization  <cit> .

most of the hematopoietic models published so far do not provide a detailed view on the stem cell level, since they either do not model stem cell dynamics  <cit>  or treat them similarly simple as the ode model  <cit> . we chose the abm for hsc introduced by roeder and loeffler  <cit>  to replace the stem cell compartment of our ode for two reasons: it represents the stem cell population in a highly structured way  and has been proven successful in a broad range of scenarios relevant for clinical applications such as imatinib-treatment of chronic myeloid leukemia in humans  <cit> . replacement is performed on the basis of a difference equations formulation of the abm proposed by kim et al.  <cit> . because the difference formulation conserves the ideas and behavior of the abm, combination of these different types of models  at different scales  is also interesting from a general systems-biological point of view. the stem cell models of adimy  <cit>  and mackey  <cit>  describe the stem cell population with less detail, but are continuous alternatives for substitution of the stem cell compartment of our ode model. we have also experimented with ode compartment models of proliferating and dormant stem cells in the framework of a murine model of haematopoiesis under chemotherapy with fairly good results .

for similar computation times in both sub-models, we chose to take advantage of two simplifications of the abm:  a difference formulation, which does not deteriorate accuracy  <cit>  and  the approximation of the probabilistic transitions between ges by their expectation values. the first simplification impedes the analysis of individual cell fates and clonal contributions, but separate matrices and parameter sets allow modeling of limited numbers of stem cell subpopulations, such as leukemic and normal cells. the second makes the model deterministic and results in continuous cell numbers, but eliminates stochastic variation among realizations that could be interpreted as variation among individuals. however, if desired, stochastic transitions can be easily re-established by using binomially distributed random numbers.

a major challenge of our approach was to substitute the feedback-loop signaling from more mature bone marrow compartments back to stem cells. in the ode model this and the internal stem cell feedback control proliferative fraction  and self-renewal probability  in the scc . because the abm provides an intrinsic regulation of proliferation and stem cell maintenance, the stem cell feedback is replaced by this internal regulation. to translate the feedback of the bone marrow to stem cells into the hybrid model, we re-interpreted the stem cell parameters as and p of the ode model in terms of the new stem cell model. in the abm the proliferative fraction is given by the fraction nΩ/ of stem cells in ge Ω and is regulated by the transitions between the ges. these in turn are controlled by the transition intensities α and ω. accounting for experimental results on activation of dormant hsc after g-csf stimulation  <cit> , we first tested a dependence of the probability ω for a transition Α → Ω on the number of granulopoietic cells in the bone marrow. however, simulations showed a long delay between stem cell activation and increase of progenitor efflux. this delay led to overcompensation at the level of granulocytes and, thus, a clear deviation from the clinical data. alternatively we considered stem cell activation as an acceleration of all processes in the abm scc. the resulting shorter cell cycle and faster differentiation leads to an increase in cell divisions in ge Ω and also progenitor efflux from ge Ω. in combination with the regulation of transition intensity ω, it reduces the overcompensation mentioned above, but it does not eliminate it. independent of this combination, it shifts the granulocyte nadir after chemotherapy by an earlier increase in production of progenitor cells. this causes additional deviation from the clinical data. both, regulation of ω and acceleration, were implemented as continuous piecewise functions of the bone marrow cellularity g. in the sensitive range around equilibrium conditions we tested linear and quadratic dependences on bone marrow cellularity g. outside this range we assumed constant minimal and maximal values. various ranges and sensitivities of both feedback functions and their combinations were tested, but it turned out that the hybrid model agrees best with the quantitative data after chemotherapy if the native stem cell regulation of the abm is used without an additional feedback. therefore, we decided to perform all simulations only with the original stem cell regulation of the abm.

except for this elimination of a feedback and the restriction of the effect of chemotherapy to proliferating cells, we did not introduce any modifications of both sub-models, in particular with respect to parameter settings. however, this substitution altered the number of model parameters. with the ode stem cell compartment we eliminated eight parameters of the former ode model including those of loop  <dig>  but introduced  <dig> parameters with the abm model. because these parameters were neither fitted nor adapted, we added no additional degrees of freedom to achieve a better fit to the data. a fine tuning is possible, but contradicts the idea of combining the models as a proof of compatibility and confirmation. it might be necessary when applying the hybrid model to new and more complex scenarios not yet covered by both submodels, e.g. more complex chemotherapies, diseased granulopoiesis and bone-marrow transplantation , which is planned for the future.

in our qualitative simulations, we observed that after damaging mature compartments, the recovery of circulating cells is similar under the former ode model and the new hybrid model. but at early cell stages, the ode model shows damped oscillations which do not occur for the hybrid model. lack of data prevents us to decide which behavior is in better agreement with biological reality.

main differences between the hybrid and the ode model arose after perturbations of the stem cell pool itself. in our ode model simulations of myeloablative bone marrow transplants, the scc repopulates completely within approximately 50 days and gra recovers its equilibrium value after only 7 days. this is well below the lower boundary of the wide range of recovery times for absolute neutrophil count after bone marrow transplantation  <cit> . while repopulation in the ode model is too fast, in the hybrid model it is far too slow. only if damage in the scc is restricted to proliferating cells, reconstitution is completed within reasonable times. however, the latter is not comparable to myeloablation since about 82% of the stem cells remain unaffected. myeloablation very likely triggers a wide destruction of bone marrow structure and the niche environment as is known for irradiation in mice  <cit> . hence, our model does not cover this scenario so far. it would require adaptations of the model mechanisms that consider changes in environment and signaling context. one approach could be a stronger dependence of transitions on the capacity of the damaged bone marrow niche after conditioning and, consequently, a higher fraction of proliferative cells until the niche is restored. in preliminary simulations we used different transition characteristics with higher values for low cell numbers without changes for equilibrium numbers . consequently, cells are more likely to switch ges, which can be interpreted as a reduced ability of each ge to keep hsc in a stable state. driven by the instable quiescence the stem cells enabled a recovery of 25% of granulocyte number within 36 days. this is close to the upper boundary found in clinical studies  <cit>  and demonstrates the potential of the hybrid model for applications to high-dose chemotherapy and stem cell transplantation. the transition characteristics of the new stem cell compartment control the activation of stem cells and capacity of the two ges. they also determine the ratio of dormant and active hsc and their rate of exchange. hence, a detailed elaboration on changing growth environments and its application to high-dose chemotherapy is possible, but goes beyond the scope of this article.

similar arguments hold for our qualitative simulations of chronic irradiation. but here neither a relation of experimental irradiation dose and model toxicity parameters nor a clear matching of model compartments and cfu-s exists, so our results can only be interpreted in a qualitative way. the compensation of stem cell loss by regulated amplification in more committed compartments observed for radiation experiments in mouse  <cit>  is conserved in the hybrid model if one identifies cfu-s with the compartment cg.

despite the differences in stem cell dynamics for bone marrow transplantation and chronic irradiation, quantitative application of the hybrid model to clinical data of four scenarios of conventional chemotherapies with and without g-csf treatment was successful. here, we restricted the damaging effect of chemotherapy to the proliferating stem cell sub-compartment of the hybrid model and applied the stem cell kill rates estimated for the former ode model. this biologically more plausible approach of cell cycle specific chemotherapeutic drugs in the hybrid model avoids the apparently unrealistic reduction that is predicted by the ode model  <cit> . we chose the chop-like scenarios of the nhl-trial, because they can serve as benchmark scenarios for the modeling of general, more complex chemotherapies  <cit> . agreement of hybrid model and data was good for all chemotherapy regimens without any adaptation of parameters and only the minute change of model structure that were necessary for the combination of the submodels.

the decision to drop the feedback of bone marrow cellularity to stem cells was based on the comparison with quantitative data of the chop-like chemotherapy regimens. these regimens intend to maximally affect tumors at the lowest toxicity for normal tissues. hence, it is conceivable that under these therapies, the bone marrow environment remains widely intact. our results therefore suggest that hscs, in particular the dormant subpopulation, represent an important population that is highly protected and only activated after more severe damage than done by these four damage-optimized regimens. activation of dormant hscs only after heavy damage also explains why diseases involving hscs require myeloablative therapies. for such strong damage, our preliminary model simulations suggest a reduced stability and activation of the dormant state due to this environmental destruction, which is reflected in transition characteristics that are more sensitive to bone marrow cellularity.

the reason for the agreement of the two models for the four chop-like regimens is the similarity of efflux dynamics of the two scc. both models agree on a proliferative fraction of about 15% of the stem cells at equilibrium, too, but assume different cycle times . proliferative activity in the stem cell compartment is computed from proliferative fraction and cycle time. in both models, it covers a similar range, but follows opposite dynamics during chemotherapy. the ode scc activates all stem cells in order to regenerate the nearly eliminated scc and sends them into proliferation , but is unable to recover within one chemotherapy cycle. in contrast, the hybrid model predicts also a nearly elimination of proliferating hsc  by the cytotoxic drugs, but quickly repopulates them from quiescent cells without activating more hsc than in equilibrium. hence, the two model scenarios suggest contrary hidden dynamics, but both explain the clinical data equally well.

to evaluate which model better resembles biology in the situation at hand, measurements of stem cell numbers during chemotherapy would be required, which is impossible for humans. even if biopsies would be available for analysis, the problem of identifying quiescent and proliferative hsc subpopulations and their cycle times remains. generally, the question of the ratio of quiescent and active stem cells and their switching frequency is heavily discussed  <cit> . in the present situation, there are various estimates, but mainly for mouse hsc which seem to differ in many aspects from the human system  <cit> . hence, for the better availability of experimental data, an adaptation of the model concept to the murine system is planned for the future. the advantage of the hybrid model to distinguish between the two populations of quiescent and proliferating stem cells becomes more powerful for murine hematopoiesis and related experimental possibilities. here it provides a well suited tool to study the equilibrium of dormant/active hsc and its impact on hematopoiesis. insights from mouse modeling could later improve our modeling in humans. this could result in a more universal model of human granulopoiesis, whose clinical applications could go beyond existing models. additionally, the hybrid model will serve as the basis for a comprehensive model of complete hematopoiesis by integrating the model of stem cell lineage commitment and the other models of hematopoietic lineages developed by our group since they rely on the same stem cell model  <cit> .

CONCLUSIONS
in our hybrid model we have successfully combined two complementary models for stem cell organization and granulopoiesis by replacing the former stem cell compartment of the lineage model and corresponding regulations. the hybrid model features a novel combination of both, a detailed representation of stem cells and the description of later cell stages of granulopoiesis including the effect of growth factor signaling. in particular, its representation of stem cell states allows the modeling of cell cycle dependent cytotoxic effects of chemotherapy. a number of qualitative and quantitative simulations of the hybrid model revealed very different behaviors of the former and the new stem cell model. nevertheless, quantitative application of the hybrid model to four chop-like chemotherapy regimens showed that the hybrid model explains the clinically observed dynamics of leukocyte numbers equally well. model validation would require more detailed experimental data on human hsc.

this novel combination paves the way for studying not yet addressed scenarios such as high-dose chemotherapy, radiotherapy and diseased hematopoiesis. it serves as another step towards a comprehensive model of hematopoiesis comprising models of stem cell regulation, lineage commitment, bone marrow cell populations, growth-factors and chemotherapy actions.

appendix
a <dig>  details of the ode model
a <dig>  model equations
the regulatory z-function
 this regulatory function is used to calculate amplification a in cg, pgb and sub-compartment g <dig> in mgb as well as the transit time in mgb. it also determines the endogenous production of the growth factors.

 zycxrel=ymax−ymax−yminexp−lnymax−yminymax−ynorcxrelby 

this representation allows regulating the quantity y=zcxrel between a minimum and a maximum in dependence on cxrel. in steady-state cxrel= <dig> it is equal to ynor. the parameter by allows choosing different degrees of sensitivity. details can be found in  <cit> .

characteristic function of chemotherapy
chemotherapy is modeled in all compartments as a transient depletion of cells following a first order kinetics. the rate of this kinetics is given as the product of a kill rate kx  and a characteristic function Ψcx modeling its time dependence:

 Ψcxt=ffc10fort1<t≤t1+1dforti<t≤ti+1dotherwise, 

where ti are the time points of chemotherapy application. if drugs are applied at different schedules, the different chemotherapy functions are added.

probability of self-renewal in s
the probability of self-renewal in the stem cell compartment s is controlled by numbers of stem and granulopoietic cells in the bone marrow:

 p=pδtanh−ϑscsrelt−1−ϑgcgrelt−1+ <dig> . 

 ϑs=2csrelt <dig> forcsrel≤1forcsrel> <dig> 

the representation of p by tanh was used to regulate the quantity symmetrically between a minimum and a maximum and to guarantee maximum sensitivity in steady-state. see wichmann/loeffler for further details  <cit> .

proliferative fraction ax in compartments s and cg
also the proliferative fraction ax in the compartments s and cg is regulated by the numbers of stem and granulopoietic cells in the bone marrow:

 x=ωgincgrelt+ωs⋅incsreltcsrelt−1forcsrel≤1csrel> <dig> 

 y=12ln2lnaxint−axmaxaxmin−axint−lnaxnor−axmaxaxmin−axnorx+12lnaxnor−axmaxaxmin−axnor 

 ax=axmaxe−y+axmineye−y+ey 

this regulation was also adopted from wichmann/loeffler p. <dig>  <cit>  and scholz et al.  <cit>  respectively. in compartment x  the proliferative fraction ax is regulated between a minimum and a maximum value, axmin and axmax. the quantity x represents the weighted logarithmic relative size of the regulating compartments . the normal value axnor and the value for intensified stimulation axint corresponding to x = −ln <dig> are fixed parameters, too.

amplification splitting in all proliferating compartments
according to scholz et al. amplification is always divided into an amplification of the influx  and the efflux  respectively .

stem cell compartment s
 ddtcs=2p−1csasτs−ksψcxcscsout=21−pcsasτs 

granulopoietic progenitor cells cg
 acg=zacgcgm−csfrelddtccg=csoutacgin−ccgacgtcg−kcgΨcxccgccgout=ccgacgoutacgtcg 

proliferating granulopoietic precursor cells pgb
 apgb=zapgbcg−csfrel 

 ddtcpgb=ccgoutapgbin−cpgbapgbtpgb−kpgbΨcxcpgb 

 cpgbout=cpgbapgboutapgbtpgb 

maturing granulopoietic precursor cells mgb g4-6
to guarantee distributed transit times, the compartments g4- <dig> are further subdivided into ng <dig>  ng <dig> and ng <dig> subcompartments . while the maturing time is regulated in all subcompartments, amplification is regulated only in g <dig>  which reflects post-mitotic apoptosis, while a =  <dig> in g4/g <dig>  below the equation for g <dig> are given. the corresponding equations for g5/g <dig> are obtained by replacing g <dig> with g5/g <dig> and pbg with g4/g <dig>  respectively.

 tg4=ztg4cg−csfrelregulationonlying6:ag6=zag6cg−csfrelcg4=∑i=1ng4cg4_iddtcg4_1=cpgbout−cg4_1ng4tg4−kmgbΨcxcg4_1ddtcg4_i=cg4_i−1out−cg4_ing4tg4−kmgbΨcxcg4_ifori= <dig> …,ng4cg4_iout=ag4_icg4_ing4tg4fori= <dig> …,ng4cg4out=cg4_ng4out 

granulocytes gra
 ddtcgra=cmgbout−cgratgratgra=tgranor1+tgrapredΨpred 

Ψpred is the characteristic function of prednisone administration analogous to the characteristic function of chemotherapy  but without first cycle effect .

granulocyte-macrophage colony stimulating factor gm-csf
 pgm−csfendo=zgm−csf×ωcgccg+ωpgbcpgb+ωg4cg4+ωg5cg5+ωg6cg6ωcgnorccgnor+ωpgbnorcpgbnor+ωg4norcg4nor+ωg5norcg5nor+ωg6norcg6norddtcgm−csf=pgm−csfendo−cgm−csftgm−csf 

granulocyte colony stimulating factor g-csf
the model includes two g-csf compartments: cg-csf representing blood concentration and csc for subcutaneous g-csf administration which is subdivided into csc_ <dig> and csc_ <dig> to model delayed absorption.

 pg−csfendo=zg−csfω˜g6cg6+ωgracgraω˜g6norcg6nor+ωgranorcgranorddtcg−csf=pg−csfendo+pg−csfexo−cg−csftg−csfddtcsc_1=cscexo−ksccsc_1ddtcsc_2=ksccsc_1−csc_2pg−csfexo=ksccsc_2cscexo=dg−csf0ti<t<ti+tinfotherwise 

where ti are the times when the infusions start and tinf is the duration of g-csf application. degradation is modeled by two independent processes, one dependent on gra and another independent of gra  <cit> :

 1tg−csf=1tg−csfren+cgrareltg−csfgra 

a <dig>  model parameter
here we provide the full set of parameters established by scholz et.al.  <cit>  and used in the simulations of the ode model. the identical set was used without any adaptation in the simulations of the hybrid model.

a <dig>  equilibrium values of all compartments
evaluation of the parameters given in table  <dig> leads to the equilibrium numbers given in table  <dig>  please note that these numbers are given in units of equilibrium stem cell number.

s
δ
min
nor
max
a
min
nor
max
a
g4
min
nor
max
g5
min
nor
max
t
g6
min
nor
max
a
min
nor
max
t
nor
pred
max
nor
min
p
gm-csf
max
nor
min
p
sc
g-csf
inf
cg

nor


nor


nor


nor


nor


nor


nor

a <dig>  details of the difference model
a <dig>  model equations
transition functions
the general class of sigmoidal functions used for calculation of transition characteristics and transition intensities is given by:

 fn=1v1+v2expv3⋅nÑ+v <dig> 

it is defined by a scaling parameter Ñ and four shape parameter νi, i =  <dig> …, <dig>  which can be expressed more intuitively by f , f , f  and f  by

 n1=h1h3−h22/h1+h3−2h2n2=h1−n <dig> n3=lnn4=f∞, 

with the auxiliary quantities

 h1=1/f0–f∞h2=1/h3=1/ 

a <dig>  model parameter
the set of parameters used in the simulations of the hybrid model is given in table  <dig>  please note again that this is exactly the same parameter set as used in the leukemia simulations of the abm except for the small changes in differentiation coefficient and regeneration coefficient  <cit> .

a <dig>  chemotherapy and toxicity parameter
a <dig>  schedule of the considered regimen
for quantitative simulations we have considered four established chemotherapy regimen that serve as benchmarks, because they comprise dose- and time-intensification of therapy. their schedules and cycle as applied in the nhl-b trial  <cit>  numbers are provided in table  <dig> 

in the table the following abbreviations and related units are used: c: cyclophosphamide , d: doxorubicin , v: vincristine , e: etoposide , pred: prednisone ).

a <dig>  toxicity parameter
scholz et.al. established the toxicity parameters given in table  <dig> for their simulations of the four chop-like chemotherapy which are summarized in table  <dig> <cit> . we use exactly the same parameters in our hybrid model simulations, including the first cycle effect .

k


s

k


pgb

k


mgb

a <dig> preliminary simulation of high-dose chemotherapy with bone marrow transplant
the damage induced by the chop-like chemotherapy regimen appears to be small enough to render the feedback from bone marrow cells to stem cells not only unnecessary, but even distorting. for the stronger damage conferred by myeloablative therapies the response of the hybrid model can be accelerated by an adaptation of the transition characteristics that makes them more sensitive to changing cell numbers . this adaptation does not influence equilibrium cell numbers, because values at equilibrium are kept constant.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
model development: ak, ir, ml, ms, design of simulation scenarios: ak, ml, ms, model simulations and data analysis ak, paper writing: ak, ms, contribution to paper writing: ir, ml. all authors read and approved the final version of the manuscript.

supplementary material
additional file 1
pooled patient data of the nhl-b trial of the german high grade non-hodgkin-lymphoma study group for the four considered chemotherapy regimen chop- <dig>  chop- <dig>  choep- <dig> and choep- <dig>  for each of the four regimens, median and quartiles are supplied for each day for the duration of the protocol as given in appendix, table  <dig> 

click here for file

 acknowledgements
ak was funded by a grand of the federal ministry of education and research of the federal republic of germany . m.s. was funded by life - leipzig research center for civilization diseases, university of leipzig. life is funded by means of the european union, by the european regional. development fund  and by means of the free state of saxony within the framework of the excellence initiative.

the authors want to thank i. glauche for helpful discussions. we also like to thank the german high grade non-hodgkin-lymphoma study group  for the kind permission to use the data.
