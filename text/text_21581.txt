BACKGROUND
second-generation sequencing technologies are creating new opportunities as well as new challenges for genomics research. while first-generation genome projects focused primarily on established model organisms such as drosophila melanogaster <cit> , caenorhabditis elegans <cit> , and mus musculus <cit> , falling sequencing costs are allowing second-generation genome projects to focus on more exotic and phylogenetically isolated organisms. the large volumes of data produced by second-generation sequencing technologies also create difficulties for data management not encountered by first-generation projects. together, these factors can spell disaster for second-generation genome projects.

the first-generation of genome projects benefited greatly from large bodies of pre-existing knowledge regarding their organisms' genomes. for d. melanogaster, c. elegans, and homo sapiens <cit> , for example, hundreds of published gene models already existed before these genomes were sequenced. these pre-existing published gene models were critical for annotation and analysis, because they allowed researchers to train and optimize gene prediction and annotation tools for each genome. they also provided a standard by which to judge the accuracy of annotations. second-generation projects rarely have access to such information. this severely limits their ability to train ab initio gene-finders, the result being  low-quality gene predictions. the lack of pre-existing gene models also leaves many second-generation projects with no objective standards with which to gauge annotation accuracy. quality control is thus a significant issue for these projects; data management is another.

new techniques such as high-throughput transcriptome sequencing  have great potential to improve annotation quality, but they produce enormous amounts of data; likewise, the existence of legacy annotations for a large number of both first and second-generation genomes is also creating data management challenges. thus, it is essential that the output of an annotation pipeline be easily converted into a genome database.

maker <dig> builds upon maker <cit> , an easy-to-use genome annotation pipeline that has seen wide adoption <cit> . maker <dig> improves upon the de novo annotation capabilities of the original maker and integrates support for multiple ab initio prediction tools. major additions to maker <dig> include integration of the annotation edit distance  <cit>  metric for improved quality control and downstream database management, support for mrna-seq to allow researchers to leverage second generation sequencing technologies, and gene model pass-through capability; thus creating a first of it's kind tool for updating and reannotating existing model organism databases. the pipeline also supports distributed parallelization on computer clusters via mpi which means maker <dig> can scale to datasets of virtually any size. maker <dig> can run on unix-like operating systems such as linux and darwin in mac os x. maker <dig> thus provides straightforward solutions to the problems facing today's second-generation genome projects. here, we demonstrate maker2's ability to overcome handicaps resulting from a lack of pre-existing gene models with which to train gene-predictors for use on novel genomes; its ability to use mrna-seq data to improve annotation quality; and its ability to update legacy annotations and in doing so significantly improve their quality.

maker <dig> is not only an improved annotation engine; it is also a new kind of annotation management tool. throughout these analyses, we measure maker2's performance using the integrated annotation quality-control measure aed, developed by the sequence ontology project <cit> . we show that maker <dig> can both evaluate the global quality of genome annotations, and identify and prioritize problematic annotations for manual review; these are functionalities offered by no other annotation tool.

implementation
de novo annotation of first-generation genomes
d. melanogaster chromosome 3r and gff <dig> annotations for release r <dig>  were downloaded from flybase. c. elegans chromosome v and gff <dig> annotations for release ws <dig> were downloaded from wormbase. arabidopsis thaliana <cit>  chromosome  <dig> and gff <dig> annotations were downloaded from tair. each set of reference gene annotations were passed to maker2's model_gff option with all prediction and evidence alignment options turned off. this has the effect of repackaging the reference gene models into more standardized gff <dig> files compatible with downstream analysis scripts.

ab initio gene predictions were produced by the programs snap <cit>  version 2010-07- <dig>  augustus <cit>   <dig> . <dig>  and genemark-es <cit>   <dig> a, using the d. melanogaster, c. elegans, and a. thaliana parameter files pre-packaged with each algorithm . to produce all predictions in standardized gff <dig> format, these algorithms were run through maker <dig> with all evidence alignments options turned off and the keep_preds flag set to  <dig>  this has the effect of only producing raw ab initio gene predictions in standardized gff <dig> format.

evidence-based gene annotations in maker <dig> were produced using default settings. the species parameter files were the same as those used for the ab initio gene-predictors. est and protein homology datasets were provided for each organism. for d. melanogaster, the est dataset consisted of all d. melanogaster ests available from dbest <cit> , and the protein homology input consisted of all anopheles gambiae <cit>  proteins from ncbi together with all of the uniprot/swiss-prot <cit>  database proteins . for c. elegans, the est dataset consisted of all c. elegans release ws <dig> ests available from wormbase, and protein homology input consisted of all caenorhabditis briggsae <cit>  ws <dig> proteins from wormbase together with all of the uniprot/swiss-prot database proteins . the est dataset for a. thaliana consisted of all a. thaliana ests from dbest, and the protein homology dataset consisted of all oryza sativa <cit>  release  <dig>  proteins from plantgdb and all of the uniprot/swiss-prot database proteins . for a. thaliana, maker <dig> was also provided with the arabidopsis transposable element fasta file available from tair .

the reference gene models, ab initio gene predictions, and evidence-based gene annotations were converted to gtf format using the maker2eval script packaged with maker <dig>  values for sensitivity and specificity were then produced using eval <cit> .

de novo annotation using unmatched species parameters
to simulate non-optimal training of the ab initio gene-finders, ab initio predictions and maker <dig> annotations were produced for d. melanogaster, c. elegans, and a. thaliana using unmatched species parameter files. this was done by running snap, augustus, genemark, and maker <dig> on c. elegans and d. melanogaster using the a. thaliana parameter files. these programs were then run on a. thaliana using the c. elegans parameter files. all other steps and procedures were identical to the previous analysis.

de novo annotation of second-generation genomes
schmidtea mediterranea <cit>  assembly  <dig>  and linepithema humile <cit>  assembly  <dig>  were used to evaluate the performance of the ab initio gene-predictor snap and the annotation pipeline maker <dig> on second-generation genome projects. to produce snap required parameter files for each species, we first ran cegma <cit> , which produces gene models that can be used for training snap from a core set of universal genes that should be found in all eukaryotes. cegma gene models were converted to snap's required zff format using the cegma2zff script that comes bundled with maker <dig>  snap was then trained in accordance with its documentation. to produce all predictions in standardized gff <dig> format, snap was run via maker <dig> with all evidence alignments options turned off and the keep_preds flag set to  <dig>  this has the effect of only producing raw ab initio gene predictions in standardized gff <dig> format.

maker <dig> was run on s. mediterranea using an est dataset consisting of all ests available for s. mediterranea found in dbest together with the smedgd est dataset. the protein homology dataset consisted of all proteins in the uniprot/swiss-prot protein database, all schistosoma mansoni <cit>  v <dig>  proteins from sanger, and all genbank <cit>  proteins for nematostella vectensis, h. sapiens, c. elegans, and s. mediterranea. the smedgd repeat library was also used. short read mrna-seq transcriptome datasets for s. mediterranea were downloaded from the ncbi sequence read archive . tophat <cit>  v <dig> . <dig> and cufflinks <cit>  v <dig> . <dig> were used to align and process these short reads. the script tophat2gff <dig> and cufflinks2gff <dig> were then used to process the results into gff <dig> format. the resulting gff <dig> files were provided to the est_gff option in maker <dig> 

maker <dig> was run on l. humile using the published genome project est dataset together with all apocrita and formicidae ests available from dbest. the protein homology dataset consisted of all of the uniprot/swiss-prot protein database, d. melanogaster r <dig>  proteins, nasonia vitripennis <cit>  ogs  <dig>  proteins, apis mellifera <cit>  ogs  <dig> proteins, and all formicidae proteins from genbank. a combined repeat fasta file from the published l. humile and pogonomyrmex barbatus <cit>  genomes was also provided.

pfam domain analysis
interproscan <cit>  was used to identify pfam <cit>  domains for all gene prediction/annotation datasets. domains were filtered to remove reverse transcriptase, integrase, and virus related protein domains. any domain listed as unknown, uncharacterized, or null was ignored.

to explore the upper bound of expected pfam domain content in a newly annotated genome, we used interproscan to identify pfam protein domains in h. sapiens release  <dig> , m. musculus release  <dig> , d. melanogaster r <dig> , c. elegans ws <dig>  and saccharomyces cerevisiae <cit>  . domains were filtered as before . the average domain enrichment for these reference genomes was then calculated for comparison.

calculating annotation edit distance
sensitivity, specificity, and accuracy are commonly used metrics for evaluating the performance of gene prediction algorithms by comparing the resulting gene prediction to a well-supported reference annotation <cit> . sensitivity is defined as the fraction of a reference overlapping a prediction; specificity is defined as the fraction of a prediction overlapping a reference; and accuracy is commonly defined as the average of sensitivity and specificity . both sensitivity and specificity can be calculated for any feature in the genome at different levels of stringency .

given a gene prediction i and a reference j, the base pair level sensitivity can be calculated using the formula sn = |i∩j|/|j|; where |i∩j| represents the number overlapping nucleotides between i and j, and |j| represents the total number of nucleotides in the reference j. alternatively, specificity is calculated using the formula sp = |i∩j|/|i|, and accuracy is the average of the two.

when calculating aed, we adapt the calculation of sensitivity and specificity to account for the fact we do not have a reference gene model for comparison; instead, we cluster experimental evidence aligned against the genome to approximate the reference. so for sn = |i∩j|/|j|, the value |i∩j| represents the number of nucleotides in a gene prediction overlapped by experimental evidence, and |j| represents the total base pair count for experimental evidence in that cluster. because we are not comparing to a high quality reference, it is more correct to refer to the average of sensitivity and specificity as the congruency rather than accuracy; where c = / <dig>  the incongruency, or distance between i and j, then becomes d = 1-c, with a value of  <dig> indicating complete agreement of an annotation to the evidence, and values at or near  <dig> indicating disagreement or no evidence support.

aed evaluation for the human and mouse genomes
h. sapiens annotations for releases  <dig> and  <dig>  as well as m. musculus annotations for releases  <dig> and  <dig>  were downloaded from ncbi in genbank file format. they were converted to gff <dig> format using the genbank2gff <dig> script available in the bioperl <cit>   <dig>  distribution. the resulting gff <dig> files were passed to maker2's model_gff option with all prediction and evidence alignment options turned off. this has the effect of repackaging the gene models into more standardized gff <dig> files compatible with downstream analysis scripts.

the standardized gff <dig> files were then provided to maker2's model_gff option once again together with protein and est datasets to produce downstream quality control metrics for each gene model. the human reference gene annotations were processed using all human ests from dbest and a protein dataset consisting of all mouse proteins together with all of uniprot/swiss-prot , and the genome was masked using the mammal subset of repeats from repbase <cit> . the mouse reference gene annotations were processed using all mouse ests from dbest and a protein dataset consisting of all human proteins together with all of uniprot/swiss-prot , and the genome was masked using the mammal subset of repeats from repbase.

the presence/absence of human release  <dig> genes in release  <dig>  and mouse release  <dig> genes in release  <dig>  was determined using blastp <cit>  and reciprocal best hits analysis . a threshold e-value of  <dig> × 10- <dig> was required for all hits. pfam domains were also mapped to all genes using the previously described methodology.

re-annotation of the maize genome
to demonstrate maker2's ability to re-annotate existing genomes with respect to legacy annotations, we re-annotated a  <dig> megabase region of the zea mays  inbred line b <dig> chromosome  <dig> <cit> , available from http://maizesequence.org. we then used the subset of reference annotations that are also included in the maize classical gene list <cit>  as a 'gold standard' set to evaluate maker2's performance.

we first produced a standardized gff <dig> file for the maize reference annotations by using the map2assembly script bundled with maker <dig> to map maize reference transcripts onto the genome. we then provided the resulting gff <dig> file to maker <dig> via the model_gff option and provided an est dataset consisting of all ests/cdnas for maize available from the maize full length cdna project <cit>  and dbest. the protein homology dataset we used consisted of the a. thaliana proteome and all of the uniprot/swiss-prot database . maize specific repeats were acquired from the maize transposable element database <cit> . the resulting maker <dig> output was a gff <dig> file containing aed quality control values for all reference transcripts. the aed distribution of the reference was then graphed together with the aed distribution for the 'gold standard' genes identified as overlapping the maize classical gene list.

next we produced de novo annotation and a re-annotation dataset using maker <dig>  the de novo annotation dataset was produced using the maize prediction parameter file that comes bundled with snap. we also provided maker <dig> with the same est, protein, and repeat datasets used in the previous analysis. to produce the re-annotation dataset, we again used the same est, protein, repeat, and snap files; however, we also passed maker <dig> all legacy annotations by indicating the location of the reference gff <dig> file in the model_gff option. we then graphed the aed distributions as was done previously for the reference dataset.

evidence alignment and analysis of published ant genomes
to demonstrate how maker <dig> can be used to add experimental evidence and quality control statistics to existing genome databases , we used maker <dig> to add cross-species homology data to six published ant genomes. we downloaded annotations for atta cephalotes <cit>  ogs  <dig> , l. humile ogs  <dig> , p. barbatus ogs  <dig> , camponotus floridanus <cit>  v <dig> , harpegnathos saltator <cit>  v <dig> , and solenopsis invicta <cit>  v <dig> . <dig> from the hymenoptera genome database <cit> . most species had gff <dig> format annotations that were passed to maker2's model_gff option, with all prediction and evidence alignment options turned off. this has the effect of repackaging the gene models into more standardized gff <dig> files compatible with downstream analysis scripts. for s. invicta, however, we used the map2assembly script bundled with maker <dig> to map transcripts onto the genome assembly .

we next ran maker <dig> on each of the six ant species. standardized gff <dig> files were passed to maker2's model_gff option. we used an est dataset consisting of all apocrita and formicidae ests available from dbest . we used a protein homology dataset consisting of all of the uniprot/swiss-prot protein database, d. melanogaster r <dig> , n. vitripennis ogs  <dig> , a. mellifera ogs  <dig>  and all of the published ant proteomes . a combined ant repeat fasta file from the published l. humile and p. barbatus genomes was also provided.

orthology of the six ant species was explored using blastp and reciprocal best hits analysis. a threshold e-value of  <dig> × 10- <dig> was required for all hits. we also used interproscan to identify pfam domains for all proteins using the previously described methodology.

evaluation of high through-put parallelization
the parallelization performance of maker <dig> was evaluated on a server with four, twelve-core amd opteron  <dig> processors  running red hat enterprise linux server release  <dig> . maker <dig> was configured with default settings and the ngasp <cit>  protein, est, and genomic sequence datasets available from wormbase. the ngasp genomic sequence is a selected  <dig> megabase sampling of the c. elegans genome . we ran maker <dig>  using  <dig>   <dig>   <dig>   <dig>  and  <dig> cpu cores under mpich <dig>  <dig> . <dig>  the linux time command was used to evaluate process run time.

RESULTS
genome annotation in model organism genomes
the performance of de novo annotation tools such as hmm based ab initio gene-predictors and evidence based annotation pipelines have previously been explored in competitions such as egasp <cit>  and ngasp, which looked at gene prediction and annotation accuracy in the human and c. elegans genomes, respectively. from these competitions, the metrics sensitivity, specificity, and accuracy have emerged as the standard methods for evaluating the quality of gene predictions <cit> . these measurements require a set of reference gene models that are assumed to be correct, as gene predictions are compared to the reference models to generate sensitivity, specificity and accuracy values .

for reference purposes, we first compared the performance of maker <dig> to the ab initio gene prediction programs snap, genemark, and augustus on three different first-generation genomes. we used the organism specific parameter files that come bundled with each of these algorithms to produce ab initio gene predictions for d. melanogaster chromosome 3r, c. elegans chromosome  <dig>  and a. thaliana chromosome  <dig>  for comparison, we then produced evidence-based genome annotations by running the same three algorithms  inside of the maker <dig> genome annotation pipeline. sensitivity, specificity, and accuracy values were then calculated against the respective reference genome using the program eval .

reference
comparison of gene model accuracies in first-generation genomes for the ab initio gene predictors augustus, genemark, and snap in comparison to gene model accuracies produced by the same predictors when ran as part of the maker <dig> gene annotation pipeline.

as seen in table  <dig>  the base pair and exon level accuracy values for ab initio predictions produced by snap, augustus, and genemark are very similar, generally within a few percentage points of each other. in c. elegans, for example, the difference between low and high base pair level accuracies is only  <dig> % . the corresponding maker <dig> annotations have similar accuracies relative to the ab initio gene predictions, and more often than not, they are slightly improved over the ab initio gene predictions, but the improvements are small. in c. elegans, for example, base pair level accuracies in maker <dig> range from  <dig> % to  <dig> % which is comparable to the  <dig> % to  <dig> % range for the ab initio gene predictions. this is not the first time that this trend has been observed <cit>  -- given large enough training sets, ab initio gene prediction programs can match or even outperform annotation pipelines. augustus, for example, achieved an exon-level accuracy in c. elegans of  <dig> %, compared to maker2's  <dig> % .

the relative similarity of accuracy measurements for ab initio prediction methods vs. maker <dig> suggests that maker <dig> is performing on par with these ab initio tools . however, as we show below, such comparisons can be quite misleading from a second-generation genome perspective. the key to understanding why is grasping that table  <dig> reports the performance of the ab initio predictors after they have been trained using each genome's existing annotations -- datasets containing tens of thousands of often hand-curated gene models. data such as those shown in table  <dig> thus represent the upper bounds for performance of the ab initio prediction algorithms. as we demonstrate below, when training sets decrease in quality and/or size, the accuracy of ab initio tools drops dramatically; in contrast maker2's accuracy, however, remains high. this feature of maker <dig> makes it especially useful for second-generation genome projects as these projects generally lack large enough training datasets for ab initio predictors to achieve accuracies comparable to those shown in table  <dig> 

genome annotation using unmatched species parameters
to better understand how these algorithms perform using poor quality training data, we repeated our analysis shown in table  <dig> using the same portions of d. melanogaster chromosome 3r, c. elegans chromosome  <dig>  and a. thaliana chromosome 4; but this time we intentionally ran the gene-predictors using the wrong species file for each organism. d. melanogaster and c. elegans were analyzed using the parameter file for a. thaliana, and a. thaliana was analyzed using the parameter file from c. elegans. each ab initio gene prediction program was then run inside of the maker <dig> annotation pipeline using the same incorrect parameter files for comparison.

as expected, the accuracy of the ab initio prediction algorithms is reduced substantially . the reduction in accuracy is most notable at the exon level where all accuracies were approximately half of what was seen in the previous analysis shown in table  <dig>  however, when each ab initio prediction program was run inside of maker <dig>  accuracies dramatically improved for every organism at both the base pair and exon levels. the degree of improvement was most notable for snap, where exon level accuracies for a. thaliana increased from  <dig> % to  <dig> %. in fact, snap's performance inside of maker <dig> using the incorrect parameter files often matched or even exceeded the levels of performance delivered by all three ab initio gene-predictors when run using the correct parameter files. for example for d. melanogaster, when using the incorrect snap parameter file, maker <dig> produces exon level accuracies of  <dig> %; whereas when using the correct parameter files outside of maker <dig>  the programs genemark, snap, and augustus produce exon level accuracies of  <dig> %,  <dig> %, and  <dig> %, respectively. these data show that maker <dig> can substantially improve the performance of ab initio gene-predictors in situations where training data may be of poor quality.

reference
the effect of limited/insufficient training data on ab initio gene prediction is simulated by providing the algorithms augustus, genemark, and snap with incorrect species parameters files . in comparison, the same predictors, when ran as part of the maker <dig> gene annotation pipeline, perform substantially better, even with the same incorrect species parameter files.

gene prediction/annotation in second-generation genomes
when analyzing the performance of gene-predictors in sequenced second-generation genomes, the same metrics of sensitivity, specificity, and accuracy used for first-generation genomes cannot be applied . this is because second-generation genomes lack the high-quality reference gene models required to calculate these values .

in the experiments below, we use pfam domain content  as a proxy metric for annotation quality. although expansion and contraction of gene families can be an important mode of organism evolution, previous work has shown that the high level of domain content of eukaryotic proteomes is relatively invariant <cit> ; this fact can be clearly seen in additional file  <dig> table s <dig>  which documents the high-level pfam domain frequencies for six different well annotated eukaryotic model organisms . thus at the grossest level of resolution, the percentage of annotations containing one or more pfam domains provides an indication of annotation accuracy.

for reference purposes, figure 1a provides high-level breakdown of domain contents for six reference genomes. on average, 68% of annotations in these six genomes contain a pfam domain. for individual proteomes, the percent enrichment ranges from a low of 57% for c. elegans to a high of 78% for m. musculus.

to compare the performance of ab initio gene prediction algorithms to that of maker <dig> on second-generation genomes, we performed a proof-of-principle genome annotation of linepithema humile , and updated the genome-annotations of the schmidtea mediterranea  genome. for these analyses, we used the ab initio gene-predictor snap because it can be easily trained for new genomes using cegma . the gene models produced by cegma then serve as the initial training set for snap.

even after training using the cegma gene models, we found that only 15% of snap ab initio gene predictions in l. humile contain a pfam domain . the maker2-generated proteome, by comparison, is highly enriched for domains . in total, 56% of the l. humile maker2-supervised snap predictions contain pfam domains.

we also performed a proof-of-principle annotation update of the s. mediterranea  genome using transcriptome  data deposited in the ncbi sequence read archive . maker <dig> uses its gff <dig> pass-through capability to integrate mrna-seq data into the annotation process. the mrna-seq reads are first pre-processed by the user's algorithm of choice , and then converted to gff <dig> files for use with maker <dig>  maker <dig> provides easy to use utilities for converting the outputs of tophat and cufflinks to gff <dig> files. the mrna-seq data can then be used by maker <dig> in combination with ab initio gene predictions, est and protein alignments to inform maker2's gene annotations. for s. mediterranea, when annotated using a version of snap that was trained using the cegma s. mediterranea gene models, only 6% of the snap gene predictions encode a pfam domain . by comparison, using the same version of snap, in conjunction with mrna-seq data, 47% of the maker <dig> supervised snap gene predictions encoded a domain, demonstrating the ability of maker <dig> to use mrna-seq data to improve the quality of the predictions.

transcriptome data alone, however, is unlikely to capture all protein coding genes, and the  <dig>  genes models produced by maker <dig> using only mrna-seq data likely represent around 80% of all genes within this genome. when using all available ests together with mrna-seq reads and the uniprot/swiss-prot protein database , maker <dig> produced  <dig>  gene models, 52% of which encode pfam domains and have overlapping support from multiple data sources, indicating that that these  <dig>  gene models represent a more complete model of the genome than can be obtained from transcriptome data alone.

interestingly, not only are domain enrichments low for the l. humile and s. mediterranea snap ab initio predictions, the gene counts are also greatly inflated. approximately  <dig>  genes are expected for s. mediterranea and approximately  <dig>  are expected for l. humile  <cit> , both values well below the  <dig>  and  <dig>  gene predictions produced  when running snap on its own . ab initio gene-predictors have a recognized tendency to over predict <cit> , and as these results demonstrate, this tendency can be greatly exacerbated by the limited training data usually available for second generation genomes. in contrast, maker2's supervised snap-based gene counts are dramatically more consistent with the published expected counts. maker <dig> produced  <dig>  gene annotations for l. humile and  <dig>  for s. mediterranea .

these results stand in stark contrast to the great accuracy obtained by snap on model organism genomes presented in table  <dig>  they also make it clear that when training data are limited or of low quality, ab initio gene-predictors produce much more reliable results when supervised by maker <dig>  this conclusion is also consistent with our earlier analyses where we annotated three model organism genomes using unmatched species parameter files . additionally maker2's use of mrna-seq reads for annotating s. mediterranea demonstrates that these next-generation data can be effectively utilized by maker <dig> to greatly improve the final gene models.

annotation edit distance as a quality control metric
as the number of published genomes continues to expand, manual curation and validation of every annotation in every genome is simply infeasible. a more practical approach is to dedicate limited resources and manpower to curation and validation of only those gene annotations most in need of improvement. as we demonstrate below, maker <dig> provides an effective means for automated quality control of genome annotations. even in cases where the administrators of genome databases have no plans to undertake manual curation, quality control measures are still desirable, as they provide a means for downstream users to judge the quality of an annotation before proceeding with experiments that depend upon the annotation's accuracy for success.

identifying low quality gene annotations is a challenge not well addressed by existing annotation tools. while quality metrics such as sensitivity, specificity, and accuracy are convenient for evaluating the performance of gene-predictors, they presuppose the existence of reference gene models, which are not available for many newly sequenced genomes. researchers working with second-generation annotations are thus in need of new quality control measures and annotation management tools.

to address this issue, we have adapted the annotation edit distance  measurement, developed by the sequence ontology, for use in maker <dig> as an annotation quality-control metric. aed is similar to the sensitivity and specificity measures used to judge gene-finder performance <cit> , but it differs in that no reference gene-model is used. instead aed measures the distance between two annotations , and it makes no assumptions as to which one is the more correct. as originally formulated, aed provides a means to measures changes to a gene annotation from release to release. we have adapted aed for use in maker <dig> as a means to quantify the congruency between a gene annotation and its supporting evidence - est, protein, and mrna-seq alignments . as we show in the analyses presented below, maker2's aed values provide a very useful measure for annotation quality control.

aed values are bounded between  <dig> and  <dig>  with a value of  <dig> indicating an exact match between the intron exon coordinates of an annotation and its aligned evidence and  <dig> indicating no evidence support. thus, database managers can use aed to sort gene models from best supported to worst in order to prioritize them for downstream manual review; maker2's aed values can also provide a rational basis for how much faith a researcher should put in an annotation before proceeding with downstream bench experiments where success will hinge upon the gene model being correct.

as proof-of-principle, we compared maker <dig> produced aed scores for every annotation in release  <dig> of the m. musculus reference annotations  to those of release  <dig>   . we also performed the same analysis using reference annotations from human release  <dig>  compared to human release  <dig>   . in order to perform these analyses, we first used maker <dig> to align est and protein homology evidence against reference genome assemblies, and then compared these data to the mouse  <dig> and  <dig>  and human  <dig> and  <dig>  gene-models . we then plotted the cumulative distribution of aed for each dataset .

as can be seen in mouse release  <dig> , there exists an abundance of genes in this early release with limited evidence support; in other words, a large portion of genes have high aed values). in contrast, for the more recent mouse release  <dig> , the aed distribution is shifted toward lower aed  values. these two curves thus provide a high-level quantitative overview of the genome-wide improvements to the mouse gene-annotations between  <dig> and  <dig> 

notably, many of the release  <dig> mouse annotations nearly or completely lack support from est and protein homology . in contrast, for the more recent mouse release  <dig> , there is nearly a complete elimination of the spike due to genes with aed scores near  <dig>  this suggests that the earlier releases contained an abundance of false positive gene predictions that were deleted by release  <dig> .

to further explore the extent to which aed scores are indicative of annotation quality, we also investigated the aed distribution of the highest quality subset of reference genbank annotations from each of the mouse and human genome releases . the refseq nm prefix provides us with an independently identified 'gold-standard' dataset of best quality annotations for comparison. for all releases, we see that the 'gold-standard' nm annotation datasets produce cumulative aed distributions that are shifted toward lower aed scores than the reference sets they are derived from . this indicates that maker <dig> is able to verify the higher quality of these genes, and quantify the differences in quality, providing further support for the use of aed and maker <dig> as tools for annotation quality control.

we also investigated how well aed scores agreed with pfam domain content. as can be seen in figure 2a and additional file  <dig> figure s1a, aed scores accord well with domain content. in mouse release  <dig>  for example, 87% of genes with aed scores from  <dig> to  <dig>  contain a known domain, whereas only 44% of genes with an aed score ranging from  <dig>  to  <dig>  contain a domain. the trend is even more striking in human release  <dig> where only 15% of annotations with aed scores between  <dig>  and  <dig>  contain a domain, again suggesting there is a greater fraction of false positive gene predictions in that subset of genes . tracking these annotations across releases supports this hypothesis: 86% of genes from human release  <dig> with aed scores between  <dig>  and  <dig>  are absent by release  <dig>  . the same trend is observed in mouse: 59% of annotations in release  <dig> with aed scores between  <dig>  and  <dig>  were deleted by release  <dig>  . in comparison, only 14% of genes with aed scores between  <dig> and  <dig>  were deleted between mouse release  <dig> and release  <dig> .

collectively, these results show that gene annotations judged to be of low quality by maker <dig> were also judged to be of low quality by genbank and preferentially deleted . these facts demonstrate the utility of maker <dig> as an annotation management tool.

re-annotation of existing genomes and legacy annotations
while there are a large number of second-generation genome projects underway, falling sequencing costs are also leading many researchers to revisit published genomes to improve gene models in light of new evidence,  or to take advantage of newer, more complete genome assemblies. there are also instances where researchers are sequencing individual strains/mutants of organisms where a published reference genome is already available or where multiple sets of legacy annotations exist and they wish to carry over annotations from the reference genome and merge them into a non-redundant consensus dataset. maker <dig> provides a simple method to perform these tasks via its external annotation pass-through mechanism that accepts as input any pre-existing genome annotations as well as aligned experimental evidence provided in a gff <dig> formatted file.

when using this gff <dig> pass-through mechanism, maker <dig> takes the user-provided gene models , aligns any additional experimental evidence against the genome , and then calculates quality control statistics such as aed. if the user supplied maker <dig> with more than one legacy annotation dataset , maker <dig> chooses the one model most consistent with the evidence for each locus and carries it forward to produce a consensus  dataset. researchers can also select to run ab initio gene-predictors  in addition to providing a gff <dig> file of legacy annotations. in this case, maker <dig> can produce new gene models for regions where the evidence suggests the existence of a gene that was not found in the legacy set, and with the help of the gene-finders maker <dig> will automatically update/revise the legacy annotations to better account for features suggested by aligned evidence.

as proof-of-principle of maker2's model pass-through and re-annotation capabilities, we used the pipeline to process a  <dig> megabase region of maize inbred line b <dig> chromosome  <dig> together with version 5a. <dig> of the http://maizesequence.org working gene set. for maize chromosome  <dig>  we produced a de novo annotation gene set, a pass-through dataset , and a re-annotation dataset . the cumulative distribution of aed scores for these three datasets was then graphed and is shown in figure 3c. we also plotted the aed distribution of the high quality subset of reference annotations from the maize classical gene list for comparison as an independently identified 'gold-standard' control dataset .

during re-annotation,  <dig> out of  <dig> version 5a. <dig> reference gene models were altered/updated to reflect features suggested by evidence alignments;  <dig> new gene models were produced for regions where the evidence suggested the existence of a gene but no model existed; and  <dig> reference gene models were left unchanged. a total of  <dig> of the unmodified reference gene models had no evidence support and were prioritized by maker <dig> for manual review as possible false positive annotations. alterations to gene models during the re-annotation process caused the aed distribution curve for the re-annotation dataset  to shift towards lower aed values  relative to the reference annotation set . this shift suggests that re-annotation using maker <dig> successfully brought gene models more in line with experimental evidence, thus improving their quality. a further comparison of both the re-annotation dataset and the unmodified reference dataset to the 'gold-standard' annotation set  supports this conclusion, as these high quality gene models also tend to be distributed around lower aed values . the spike in the aed distribution for both the unmodified reference dataset and the re-annotation dataset represents gene models that have little-to-no evidence support and are prioritized by maker <dig> for manual review. in comparison, the de novo annotation set  has an aed distribution shifted toward lower values than either the re-annotation or reference dataset; this is primarily due to the exclusion of unsupported gene models as the average aed for both the de novo and re-annotation datasets is identical when unsupported models are excluded .

managing existing annotation databases
with the proliferation of existing sequencing data, researchers have access to published genomes of multiple related species that may have been annotated using very different methods and to varying degrees of quality. here, we evaluate how maker2's annotation pass-through option can be used to map cross-species data to multiple related genomes. we also explore how these data can be used to fuel downstream analyses such as cross-species orthology.

we used maker <dig> to map experimental evidence as well as reference annotations to six published ant genomes: a. cephalotes, p. barbatus, l. humile, h. saltator, c. floridanus, and s. invicta. the protein datasets provided to maker <dig> consisted of all proteins from uniprot/swiss-prot, d. melanogaster, n. vitripennis , a. mellifera , and each of the previously mentioned published ant species . we also included all apocrita and formicidae ests in dbest with the est dataset. resulting cumulative aed distributions were then plotted for each ant species; average percent orthology and domain content were also evaluated for each quartile of the aed distribution .

low aed scores indicate gene models with better agreement with evidence alignments, while higher values mean less evidence support. the cumulative distribution of aed scores for the six ant species can be seen in figure 4c. for each ant species, there is a spike in the distribution curves around aed score  <dig>  this spike represents genes that maker <dig> has prioritized for manual review. we see in figure 4a that pfam domain content is well correlated with aed score, and an average of 63% of genes with scores between  <dig> and  <dig>  contain a pfam domain compared to only 11% of genes with scores between  <dig>  and  <dig> . the low domain enrichment suggests that genes prioritized by maker <dig> are most likely false positive gene predictions--a conclusion supported by our earlier analyses of the mouse and human annotation datasets shown in figure 2-- but there is also the potential that these represent novel genes with domains that would not be found in the pfam domain database.

if we further expand our analysis to look at orthology among the ant species, we see that percent orthology between the six ant species is also well correlated to aed. using reciprocal best blast hits as a rough definition of orthology, 94% of genes with aed scores between  <dig> and  <dig>  have orthology to at least one protein in another ant species , whereas only 26% of genes with aed scores between  <dig>  and  <dig>  have at least  <dig> ortholog in another ant species . together with the domain analysis, the association of aed and orthology suggests that genes with aed scores near  <dig> are either recently evolved genes or false positive gene predictions; in either case, these genes should be targeted from manual review. thus supporting the use of the aed statistic for quality control.

the ability of maker <dig> to align cross-species data to multiple genomes in this way demonstrates how maker <dig> can be used to generate common resources even when genomes are annotated using very different methods. because all annotations and experimental evidence have been processed into a common format, they can now be easily loaded into downstream gmod tools for analysis and data distribution. maker <dig> thus provides an efficient automated mechanism for research communities and organizations to manage shared genome database resources.

high-throughput parallelization
maker <dig> has been optimized to support high-throughput parallelization using message passing interface , a distributed cluster communication protocol. to explore how data throughput in maker <dig> scales with processor usage, we annotated the  <dig> megabase ngasp dataset for c. elegans using an increasing number of processor cores . as can bee seen, data throughput scales linearly with processor usage: annotating the entire  <dig> megabase dataset in just under  <dig> hour on  <dig> cpu cores; this means maker <dig> should be able to annotate the entire c. elegans genome in less than  <dig> hours using similar settings. researchers with access to distributed computer clusters  could expect to annotate even human-sized genomes  in less than  <dig> hours, while smaller fungal sized genomes  could easily be annotated on laptop or desktop machines in the same time period. the scalability of data throughput for maker <dig> therefore allows researchers to process datasets of virtually any size or to process multiple datasets in a timely manner. maker2's high-throughput parallelization also provides a potential solution to the problem of annotating ultra large genomes such as pine trees, which have genomes in the 20- <dig> gigabase range <cit> .

it is important to note that much of maker2's computation time is spent aligning experimental evidence to the genome and analyzing the results. for this reason, the overall time required for genome annotation is expected to vary not only with genome length but also with the size of the input experimental evidence dataset. this upfront investment in computation time, however, provides enormous benefits downstream as all supplied est reads, protein homology data, and gene predictions are available as searchable features in the final output. by loading maker2's output into gmod tools like chado <cit> , galaxy <cit> , and gbrowse <cit> , researchers can quickly perform downstream analyses such as exploring protein orthology and analyzing sequence conservation. they can also identify cross-species changes in intron exon structures with the advantage of having all the information available directly from maker2's output without having to perform any additional computation.

CONCLUSIONS
the performance of ab initio gene-predictors is heavily dependent on the availability of extensive training data. first-generation genome projects such as d. melanogaster thus benefitted greatly from the extensive knowledge of genes and gene structure that was already available before the genome projects even began. unfortunately, second-generation  genomes generally lack pre-existing 'gold standard' gene models with which to train gene finders. these same projects, however, often do have on hand mrna-seq data, a resource of obvious utility for annotation. our results show that maker <dig> provides an easy means to integrate these and other data into the gene prediction and annotation process, resulting in dramatic improvements to annotation quality even when gene-finders are poorly trained.

by aligning evidence from ests, mrna-seq, and protein homology, maker <dig> also provides a convenient way to add these types of experimental data to new and existing annotation datasets for purposes of quality control, and as a means to update and revise legacy annotation datasets automatically. as proof-of-principle, we demonstrated that maker <dig> was able to prioritize genes for review from mouse release  <dig> and human release  <dig>  this prioritization is well correlated with the deletion and revision of the same genes in subsequent mouse release  <dig>  and human release  <dig> , indicating that maker2's aed-based prioritization method closely emulates the quality control decisions used for these genomes. likewise, our re-annotation of portions of the maize genome demonstrates the ability of maker <dig> to automatically revise and update existing genome annotations. maker <dig> thus provides an automated means of quality control for both new and existing genome annotations; this in turn will allow researchers to make more informed decisions when designing experiments whose success is dependent upon the correctness of the annotation as incorrect annotations poison every experiment that uses them.

availability and requirements
maker <dig> is a perl-based application, is freely available for academic use. source code, documentation and a user tutorial are available at

http://www.yandell-lab.org/software/maker.html

links to a bug tracker and users' email list are also available on the download page.

authors' contributions
ch and my conceived the study and wrote the manuscript. ch carried out experiments and wrote software for the analyses. all authors read and approved the final manuscript.

supplementary material
additional file 1
supplementary tables and figures. contains supplementary tables  <dig>   <dig>  and  <dig> as well as supplementary figure  <dig> 

click here for file

 acknowledgements
this work was supported by the grants nih/nhgri-r01-hg <dig> and nsf ios- <dig> to my. ch was partially supported by the nih genetics training grant t32-gm <dig>  an allocation of computer time from the center for high performance computing at the university of utah is gratefully acknowledged. the authors would like to thank c. robin buell and john hamilton of michigan state university, and carolyn lawrence of usda-ars and maizegdb for her assistance with the maize genome re-annotation, as well as alejandro sánchez alvarado and eric ross of the university of utah for their assistance in collecting the datasets to annotate the schmidtea mediterranea genome. finally, the assistance provided by christopher smith  in gathering the necessary datasets for analysis of all six published ant species is also gratefully recognized.
