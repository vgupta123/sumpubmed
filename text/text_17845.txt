BACKGROUND
next generation sequencing  gene expression measurement methods simultaneously quantify tens of thousands of unique ribonucleic acid  molecules extracted from biological samples. these rna sequencing  methods produce data that can be transformed into numerical values that are proportional to the abundance of rna molecules and reflect the expression and turnover of those molecules. identifying differentially expressed  genes is an important step to understanding the molecular mechanism of disease. as with any statistical analysis, the underlying structure of the data dictates appropriate methodology. the ngs methods provide a count of rna molecules that do not follow a normal distribution. the negative binomial  distribution appropriately models the biological dispersion of a gene, and nb regression has been used to analyze rna-seq data. when y, a random variable, follows a nb distribution with mean  and dispersion , the parameterization of the probability mass function, expected value, and variance of y are y∼nb,whereμ≥0andϕ≥0suchthatf=ΓΓΓϕ−1y,e=μ,andvar=μ+μϕ <dig>  


because the total number of reads of each sample will likely be different, a normalization step is required prior to performing differential expression inferences between two conditions. normalization approaches have been evaluated elsewhere  <cit> . based on these evaluations, we implemented the deseq normalization approach in this study  <cit> .

estimation of the dispersion parameter  of each gene is challenging with the small number of observations typically available in rna-seq studies. an overestimated dispersion may result in loss of power to detect de genes and an underestimated dispersion parameter may increase false discoveries. two of the most sophisticated and widely used software packages for identifying de genes are deseq <dig> and edger  <cit> , which estimate the dispersion parameter of each gene using empirical bayes shrinkage and cox-reid adjusted profile likelihood methods, respectively.

many rna-seq analysis methods have been evaluated in different settings including multi-group study designs . soneson et al.  <cit>  compared performance of rna-seq analysis tools  using real and simulated data sets. they reported that when sample size is small, the results should be cautiously interpreted. however, when sample size is large, the limma using variance stabilizing transformation method performed well. seyednasrollah et al.  <cit>  evaluated eight computational methods such as edger, deseq, bayseq, noiseq, samseq, limma, cuffdiff <dig>  <cit> , and ebseq using publically available human and mice rna-seq data. they concluded that no method fits for all situations and results from distinct methods could be largely different. rapaport et al.  <cit>  assessed commonly used analysis packages  for rna-seq data. they analyzed human rna-seq data with those methods and emphasize the importance of large sample replicates to accurately detect association with genes. tang et al.  <cit>  included tcc  <cit> , edger, deseq, deseq <dig>  voom  <cit> , samseq, poissonseq, bayseq, and ebseq in their evaluation with multi-group data. the edger and deseq <dig> packages were recommended in their assessment. deseq <dig> and edger are generally accepted in the analysis of rna-seq data because these packages are designed to properly handle studies with small sample size and lowly expressed genes. however, the appropriateness of the nb model compared to the logistic model has not been exhaustively evaluated. because many rna-seq studies are designed to compare cases and controls, we explore logistic regression as an alternative approach, in which disease status is modeled as a function of rna-seq reads. this is a reversal of the experimental and explanatory variables in the nb model in the rna-seq setting. an attractive feature of the logistic framework is that the estimation of a dispersion parameter for gene expression is not necessary. although some studies analyzed their data modeled as a function of gene expression  <cit> , a comparison to standard nb methods was not conducted. we evaluate logistic regression models in which the dependent variable is disease status and gene expression is the independent variable.

because of the substantial costs associated with rna-seq technology and the challenges in obtaining appropriate tissue sample sizes may be limited in some studies. when sample size is small the distribution of test statistics may not achieve the expected asymptotic distribution. hence, we incorporated the data adaptive method into nb and logistic regressions because this approach estimates a re-calibrated distribution of test statistics. we evaluated the validity of the data adaptive method in rna-seq studies.

another important feature of differential expression analysis is covariate adjustment. adjustment for confounders is crucial in protecting against spurious associations. we define a confounder as a covariate that is associated with both the experimental and explanatory variables. covariates in rna-seq analysis are associated with disease status, technical artifacts from experimental methodology, or intrinsic biological properties of a system in rna-seq models. if these covariates affect the abundance measurements of rna-seq data, then the covariates could significantly confound the association between rna-seq and disease status. again, we considered two approaches for differential expression analysis: 1) nb regression where gene expression values are the outcome variable and case–control status is the predictor variable and 2) logistic regression where case–control status is a function of gene expression values. if disease-associated covariates are not associated with gene expression, then these covariates are non-predictive  covariates in models with rna-seq as the outcome. the effect of adjusting for covariates, when the relationship between covariates and gene expression is not assessed through statistical tests or prior studies, has not been extensively evaluated in rna-seq studies using the nb framework. if we alternatively consider a logistic model, the np covariates in the nb model become non-confounding predictive  covariates in the logistic model, because the covariates are not associated with the independent variable  but are associated with the dependent variable .

we use both simulated data sets and an application to a real huntington’s disease  rna-seq data set  <cit> . the results of this study will guide the selection of an appropriate regression model and guide decisions regarding covariate adjustment in rna-seq studies.

methods
this study focuses on a gene as a unit; hence various gene-based scenarios are considered.

regression methods for analyzing rna-seq data
negative binomial  regression
nb regression uses the maximum-likelihood  fitting process  <cit> . the generalized linear model  framework is used by deseq <dig> and edger. in the current study, glm was implemented using the glm) function in the r-package “mass” and utilized either the estimated dispersion from ml, quasi-likelihood  or the true dispersion value from the simulation scenario. ml and ql methods are described in additional file 1: supplementary method section  <dig>  in our real data application, the original data and permuted data sets were analyzed with deseq <dig>  <cit> .

classical logistic  regression
we conducted glm in a logistic regression framework using the logit link function using the glm function in r. in the rna-seq setting cl regression may be limited by small sample size and complete separation. if the expression values of a gene are completely or nearly completely separated between case and control groups, which may occur when the effect size is large, the ml estimation from cl regression may fail to converge. because complete separation may be an indicator of differential expression, we implemented bayes and firth’s logistic regressions, which overcome complete separation bias.

bayes logistic  regression
gelman et al.  <cit>  proposed a prior to estimate stable coefficients in a bayesian framework, when data show separation. the proposed prior is the cauchy distribution with center  <dig> and scale  <dig> . they demonstrated that this flat-tailed distribution has robust inference in logistic regression and is computationally efficient. the procedure is implemented by incorporating an em algorithm into iteratively reweighted least squares, using the bayesglm function in the r-package “arm”.

firth’s logistic  regression
the ml estimators may be biased due to small sample size and small total fisher information. firth proposed a method that eliminates first-order bias in ml estimation by introducing a bias term in the likelihood function  <cit> . heinze and schemper demonstrated that firth’s method is an ideal solution when the data show separation  <cit> . the logistf function in the r-package “logistf” was used.

simulation study
the performance of statistical models was evaluated through type-i error and power scenarios using combinations of the parameter values in table  <dig> table  <dig> parameters and their values in simulation scenarios

mean expression value in controls 
dispersion 



generating simulated rna-seq data
for each scenario, the read counts  were sampled from the nb distribution with mean  and dispersion  as specified in table  <dig>  we simulated  <dig>  independent replicates per scenario using the following steps and evaluated type-i error rate and power per scenario based on results from these  <dig>  independent replicates.

first, we generated simulated sample  data with their case  and control  statuses determined by the study design shown in table  <dig>  then, a gene  expression value for each sample  was generated following the nb distribution conditioning on the disease status. the log2fc determined the mean expression value for cases  in power scenarios. when simulating under the null hypothesis  log2fc =  <dig> and the mean expression value  was equal for cases and controls. we considered only up-regulation of genes, and assumed the dispersion was the same for cases and controls. the simulation model for the rna-seq count data is: yig~nbμgdϕg, where μ
gd
≥ <dig>  ϕ
g
≥ <dig>  d is the binary case–control status of a sample , μ
g is mean expression value of a gene g. μ
gd= <dig> is the mean expression value for cases for gene g and is calculated as 2
log2fc 
× μ
gd= <dig> 

generating simulated covariate data
the binary covariates  were simulated to follow a binomial distribution conditioning on case–control status of each sample. the conditional probability was calculated based on the covor. x|d~bndpd, where d is disease status , n
d is sample size of d, p
d=0 =  <dig> , and p
d=1 
= covor/. when the number of cases is  <dig>  covor of  <dig> is not considered. for every  <dig> replications among  <dig>  replications in a scenario, a new covariate set was generated to incorporate between and within variance of covariates. all covariates in a model were independent and had the same covor.

analyzing simulated data
we performed nb regression with model a and conducted the cl, bl, and fl regressions with model b. modela:logey=β0+β1d∑k=1cβk+1xkmodelb:logited=β0*+β1*y+∑k=1cβk+1*xk where y is read count, d is case/control status and c is the number of covariates. models without covariates were analyzed using all regression methods in order to compare the performances of unadjusted models. models adjusting for covariates were analyzed only using nb and fl regressions to evaluate different types of covariate effects.

scenarios for which log2fc =  <dig> are type-i error studies. otherwise, the scenarios are power studies. type-i error rates, at significance  levels  <dig>  and  <dig> , were calculated based on replicates with converged results. for power studies, because different type-i error rates were observed among the distinct regression methods, comparing the power of different regression methods using the same threshold is not appropriate. for fair comparison, an empirical threshold for each regression method was calculated. then, we computed the empirical power of each regression method using their empirical thresholds. although only positive log2fcs were simulated in those scenarios in which power was evaluated, we consistently used two-sided tests for both type-i error and power studies. the equations for type-i error rate and empirical power are shown in additional file 1: supplementary method section  <dig> 

validation of data adaptive  method using cross-validation technique
the da method re-estimates a distribution of test statistics under the null hypothesis of no association  <cit> . the da approach enables one to obtain a recalibrated distribution of test statistics because when sample size is small, the asymptotic distribution may not be appropriate. this method also avoids heavy computing burden compared to implementing permutation tests with all possible permutations. the results from the da method are validated using a cross-validation technique. detailed procedures are provided in additional file 1: supplementary method section  <dig> 

huntington’s disease  study
a real rna-seq data set was analyzed using the deseq <dig> r-package, which implements a nb glm. the data set was also analyzed utilizing r  to implement cl, bl, and fl regressions. the logistic regressions modeled case–control status as a function of normalized counts of a gene and covariates. the publicly available hd data set  <cit>  was downloaded from the geo database . this data set contains  <dig> hd cases and  <dig> neurologically normal controls. details of the hd data set are provided in additional file 1: supplementary method section  <dig> 

generating permuted hd data
the original hd study used rna integrity number  and age at death  as covariates. rin was included due to the potential confounding effect between hd and the abundance of rnas. to remove the effect of rin in our permutations, at first, samples were divided by rin categories. then, each gene was resampled within each category of rin. because aad was included in the regression model due to its association with hd, the relationship between hd and aad was preserved during the permutation process. we generated  <dig>  monte-carlo permutations.

analyzing permuted hd data
for the original hd data and each permutated data set, de genes were identified using the nb model  as implemented in deseq <dig>  we also implemented the cl, bl, and fl regressions  to compare statistical models. in logistic models, we used normalized counts from deseq <dig> as an independent variable. for these analyses, we adjusted for aad and rin.

the type-i error rates at our alpha levels using supplementary equation , and the exact p-values  <cit>  were calculated with the results from the  <dig>  permutations. the da method was applied using our permutation results  <cit>  to measure type-i error rates and to obtain adjusted p-values of each gene.

for hd data analysis, asymptotic p-values, exact p-values using  <dig>  permutation results, and da using  <dig> p-values were calculated and corrected for multiple testing by imposing a false discovery rate  of  <dig> . to assess the model adequacy, qq-plots of original, exact and da p-values were generated, and genomic inflation factors, λ
gc, were calculated. this λ
gc is the ratio of the median of the observed test statistics divided by the expected median of an asymptotic distribution. if a λ
gc is greater than  <dig>  this may suggest inflation in the test statistics and may indicate the presence of systemic bias such as hidden population structures, latent covariates, technical artifacts, etc.  <cit> .

analyzing hd data with simulated covariates
to evaluate the effect of covariates in a model, the same method for generating covariates in our simulation study was applied to the hd data set to create simulated covariates. in this real data application, we focused on a moderate covariate effect on hd status . the hd data were analyzed using the nb glm in deseq <dig> with model a and using the fl regression with model b with  <dig> replicated sets of simulated covariates . the change of λ
gc with the addition of a varying number of simulated covariates in a model was evaluated.

RESULTS
simulation results of nb vs. logistic regressions
type-i error simulations
type-i error rates from the simulated results of the scenarios at two alpha levels are presented in table  <dig>  all analyses presented in table  <dig> were converged. the nb regressions using ml, ql and true dispersions show almost identical levels of performance . when the sample size is small or the dispersion is high, nb regression shows inflated type-i error rates but the cl and bl regressions are conservative . large sample size and low dispersion generally yielded type-i error rates that were close to the specified alpha levels as shown in additional file 3: figure s <dig>  the increment of μ
d= <dig> is not influential. the fl regression performs well or presents moderate conservativeness at both alpha levels. the type-i error rates of the fl regression are less affected by the small sample size and the large dispersion than other logistic regressions. the type-i error rates of additional scenarios exhibit patterns that are consistent with results in table  <dig>  the unbalanced design results shown in additional file 4: table s <dig> are consistent with the balanced design results in table  <dig> table  <dig> type-i error rates of regression methods from the balanced design having μ
d=0 = 1000

n
d=1



in most scenarios, the da method reduces the inflation observed with nb regression and the controls conservativeness observed with the cl, bl, and fl regressions. however, with small sample size, conservative results are still observed at alpha level  <dig>  for the cl and bl models. the da method with nb and fl regressions showed well-controlled type-i error rates at all alpha levels even with small sample size.

power simulations
we summarize the empirical power results from the balanced design with  <dig> cases in fig.  <dig>  the performance of the nb regressions with ml, ql and true dispersions are almost identical, as seen in additional file 5: table s <dig>  larger sample sizes increase power for all regression methods. the influence of mean expression in controls appears with small log2fc in fig.  <dig>  when sample size, log2fc, and dispersion are small, increase of mean expression in controls leads to an increase of power at both alpha levels. when log2fc is large and dispersion is small, the cl regression shows very low power. the nb, bl, and fl regressions gain power with large log2fc and low dispersion. these three regression methods have comparable empirical power and cl regression results in lower power in all scenarios.fig.  <dig> empirical power of regression methods from the balanced design with n
d=1 =  <dig>  power of the negative binomial with true dispersion , classic logistic , bayes logistic , and firth’s logistic  regressions at alpha levels of  <dig>  and  <dig>  are shown. the black dotted horizontal lines represent  <dig> and 90% power. mean expression values  are separated by black dotted vertical lines. four dispersion values  are placed within each mean expression value. dotted lines within each symbol imply 95% confidence interval. a the figure represents the results from the balanced design with n
d=1 =  <dig> and log2fc =  <dig> . b this figure shows the summary from the balanced design with n
d=1 =  <dig> and log2fc =  <dig> 




application to rna-seq data in huntington’s disease
type-i error permutations
the type-i error rates from the permuted data sets at two alpha levels are shown in figs.  <dig> and  <dig>  we categorize genes in  <dig> groups by the estimated dispersion of a gene: , , , , and . we define genes with dispersion > <dig>  as largely dispersed.fig.  <dig> type-i error rates from deseq <dig> analysis of the permuted hd data. type-i error rates from the deseq <dig>  analysis of the permuted hd data at alpha levels of  <dig>  and  <dig>  are presented in the figure. each black empty dot represents the type-i error rate of a gene. the red dots denote average values of type-i error rates in each category of dispersion groups. the black dotted horizontal lines are our alpha levels. a shows type-i error rates of genes having mean expression value of greater than  <dig> at alpha level of  <dig> . b displays type-i error rates of genes having mean expression value of greater than  <dig> at alpha level of  <dig> 


fig.  <dig> type-i error rates from logistic regressions of the permuted hd data. figure  <dig> contains type-i error rates from classical logistic , bayes logistic , firth’s logistic  regressions of the permuted hd data at alpha levels of  <dig>  and  <dig> . each empty dot represents type-i error rate of a gene. the dots filled with colors inside of boxes denote average values of type-i error rates in each category of dispersion groups. the black dotted horizontal lines are our alpha levels. a shows type-i error rates of genes having mean expression value of greater than  <dig> at alpha level of  <dig> . b displays type-i error rates of genes having mean expression value of greater than  <dig> at alpha level of  <dig> 




in the nb results from deseq <dig>  as dispersion increases, the type-i error rates increase when genes are in the categories of , , and . however, genes in the , and  categories exhibit decreasing type-i error rates . genes in the , and  categories largely have very low mean expression values. after excluding genes having mean expression values less than  <dig>  type-i error rates increase as the estimated dispersion increases as shown in fig.  <dig>  these increasingly liberal type-i error rates are observed at both alpha levels and are consistent with our simulation results.

in the cl, bl and fl regression results, we observe that genes in the categories of , , and  produce increasingly conservative type-i error rates at both alpha levels, as presented in fig.  <dig>  however, these increasingly conservative type-i error rates are attenuated in the , and  categories . because we observe this inconsistent pattern of type-i error rates among extremely lowly expressed genes in the deseq <dig> results, we also examined the set of genes excluding those with mean expression values less than or equal to  <dig>  after exclusion of genes with low expression, the remaining genes show consistent increasingly conservative type-i error rates as dispersion increases as shown in fig.  <dig>  although type-i error rates from the fl regression are also more conservative when dispersion is large, type-i error rates are relatively well controlled compared to cl and bl regressions. the type-i error rates observed in the real data set using logistic regression confirm our simulation results.

the da method controls type-i error rates well for the deseq <dig> results  and the fl regression results  at both alpha levels, regardless of dispersions of all genes. the type-i error rates from cl and bl regressions at significance level of  <dig>  are conservative as seen in additional file 9: figure s <dig> 

we also observed the bias of the regression methods using permuted hd data sets. as shown in additional file 10: figure s <dig>  fl regression revealed the smallest bias.

hd results from the nb vs. logistic regressions
we analyze the hd data using nb glm in the deseq <dig> r-package, and using cl, bl, and fl regressions with the r-functions described in the methods section. all regression results are corrected with the da method using  <dig> permutation results, and are adjusted for multiple testing using an fdr of  <dig> . the q-q plots and λ
gc are shown in additional file 11: figure s <dig>  the da method reduced the mean λ
gc from the results of deseq <dig> and increased the mean λ
gc from the results of the cl, bl, and fl regressions. as shown in additional file 12: figure s <dig>  we identified  <dig>  genes that were significant across all methods. the fl regression also identified  <dig> genes as de genes that were not identified by the other methods. the deseq <dig> approach identified  <dig> genes that were not significant using the other methods. the  <dig> most significant genes  from fl regression that are not significant  in the deseq <dig> but significant in cl, bl and fl regressions are shown in table  <dig>  the most significant gene is slc1a <dig> with p-value equal to  <dig> e- <dig> from fl regression. of the genes that are not significant  in the cl, bl and fl analyses, the  <dig> most significant  from deseq <dig> are shown in additional file 13: table s <dig>  the genes that are significant in fl analysis are listed in additional file 14: table s <dig> table  <dig> top  <dig> significant genes from fl regression among genes not significant in deseq2


slc1a6

serhl2

kcnk9

disp2

spock2

c20orf27

ist1

arc

stradb

pcp4



simulation results of various covariate models from the nb and fl regressions
the properties of the nb regression that are shown in simulation results of nb vs. logistic regressions are also presented in the simulation results with various covariate models.

type-i error simulations
type-i error rates from the simulated data to evaluate the inclusion of covariates in the models are presented in table  <dig>  when dispersion is small, an increasing number of np covariates do not increase type-i error rates in the nb models. although the number of covariates appears to increase type-i error rates when dispersion is  <dig>  and covor is  <dig> , this slightly increased type-i error rate is close to the type-i error rates in the model when dispersion is  <dig>  and covor is  <dig> . adding more np covariates when the dispersion is large increases type-i error rates. the effects of large covor on type-i error rates are not notable in nb models. large sample size weakens the inflation that arises from a large number of np covariates within large dispersion in the nb model. type-i error rates with distinct dispersions are almost identical at both alpha levels .table  <dig> type-i error rates with covariate models from balanced design of n
d=1 =  <dig> and μ
d=0 = 1000




the same covariates that are non-predictive  covariates in a nb model are non-confounding predictive  covariates in logistic models. unlike the nb regression, even with small sample size , when the covor is small, the fl regression is robust regarding the increment in the number of ncp covariates. when covor is large, type-i error rates from fl regression become very conservative as the number of ncp covariates increase. type-i error rates are not affected by large dispersion. when sample size is increased, type-i error rates are less affected by increased number of ncp covariates with large covor.

in all scenarios, the da method controls type-i error rates well in the nb and fl regressions at both alpha levels. the newly approximated distribution of test statistics diminishes deviated type-i error rates that were not controlled when many covariates were included in the nb and fl models.

in addition to type-i error rates, the bias is also calculated for each scenario. as shown in additional file 16: table s <dig>  as dispersion increases, bias from nb regression increases. however, the bias from fl regression is robust with increasing dispersion. the bias does not change much for any of the models, as covor and the number of covariates changes.

power simulations
the results of the power simulations to evaluate the inclusion of covariates in the models are summarized in fig.  <dig>  the empirical power of the nb regressions using different dispersion estimation methods was similar for all power scenarios . when sample size is increased the overall power is increased in both nb and fl regression.fig.  <dig> empirical power of covariate models from balanced design with n
d=1 =  <dig> and μ
d=0 =  <dig>  the power of negative binomial with true dispersion , and firth’s logistic  regressions at significance level  <dig>  and  <dig>  is shown in the figure. black dotted horizontal lines represent  <dig> and 90% power. the odds ratios between covariates and case–control status  are partitioned by vertical black dotted lines. the number covariates ) in the model are positioned within each covor. dotted lines within each symbol represent the 95% confidence interval. a balanced design from n
d=1 
=  <dig>  μ
d=0 =  <dig>  dispersion =  <dig> , and log2fc =  <dig> . b balanced design of n
d=1 
=  <dig>  μ
d=0 =  <dig>  dispersion =  <dig>  and log2fc = 2




in our simulation, the power of nb and fl regression is affected by three factors 1) dispersion, 2) covor, and 3) number of np/ncp covariates in a model, when sample size is fixed. large dispersion, large covor, and increasing number of np/ncp covariates in a model decrease power. nb regression is less sensitive to an increase of np covariates with small dispersion. as shown fig. 4a, nb regression results in marginally more power than fl regression when the number of covariates is large and dispersion is small. when dispersion is large but covor is small, the loss of power in nb regression is more sensitive to the increase in number of np covariates than in fl regression as seen in fig. 4b. especially, in fig. 4b with the covor of  <dig> , the power of fl regression with  <dig> covariates in a model is more powerful than nb regression with  <dig> covariates. regardless of dispersion, when covor and the number of covariates in a model are large, nb regression shows slightly better power than fl regression. this is demonstrated in fig.  <dig> with covor equal to  <dig> 

hd results from covariate models
the hd data were analyzed using deseq <dig> and fl regression with additional simulated covariates. a summary of λ
gc is presented in table  <dig>  an increase of the np/ncp covariates leads to a marginally lower median of the λ
gc. the standard deviations of the λ
gc are increased with the increase of np/ncp covariates.table  <dig> summary of λ
gc from hd analyses with simulated covariates




discussion
in this study, we propose using a logistic regression framework as an alternative to nb regression to analyze rna-seq data for case–control studies. we have shown in our simulations that fl regression performs well in terms of controlling type-i error rates and shows comparable empirical power. the dispersion is not estimated in the logistic framework, thus avoiding potential false association resulting from incorrectly estimated dispersion. the simulations presented focused on single genes varying relevant parameters ; transcriptome-wide data were not simulated.

the type-i error simulations presented demonstrate that nb regression has inflated type-i error rates with small sample size. the degree of inflation is varied by the scale of the dispersion parameter with constant sample size. the relationship between increased type-i error and dispersion was confirmed through permutation of a real data set. although large sample size reduced the inflation from nb, the high cost of rna-seq technology and difficulty of obtaining certain sample tissues may preclude a larger sample size in some studies. the distinct type-i error rates observed with varying dispersion parameter values may violate the general assumption that p-values from non-de genes follow a uniform distribution. however, the current simulation and permutation studies validate that the da method is a suitable alternative approach that controls type-i error rates in all regression methods.

the empirical power of the nb, bl, and fl regressions are comparable across all scenarios. lower power was observed for cl regression, which appears to be driven by scenarios of complete separation and a failure to converge. with large log2fc and small dispersion, simulated data are likely to show complete separation; in these scenarios the nb, bl and fl regressions are more powerful. for many circumstances with small sample size, the cl regression demonstrated the lowest empirical power among all methods because the cl regression is not able to accommodate complete separation.

analysis of the hd data showed λ
gc was decreased after applying the da method to the results from nb glm in deseq <dig> but was increased after applying da method to the results from cl, bl and fl regression. the exact p-values from  <dig>  permutations revealed the same pattern. this pattern is consistent with our simulation results where type-i error rates were inflated in the nb framework and conservative in the logistic framework when test statistics were compared with a theoretical asymptotic distribution.

although it is unknown which genes are truly de in the hd data set, we compared de genes identified in the hd data by different statistical approaches. we found that slc1a <dig>  did not show evidence of association with hd when using deseq <dig>  but was highly significant when using fl regression, as shown in table  <dig>  slc1a <dig>  which is highly expressed in the cerebellum of human brain compared to other regions  <cit> , showed lower levels of expression in prior studies of mood disorder diseases such as bipolar and major depression disorders in the striatum in situ hybridization study  <cit> . in addition, utal et al.  <cit>  showed that purkinje cell protein  <dig> , also known as pep- <dig>  had dramatic reduction in hd. this gene was not significantly associated with hd status when using deseq <dig>  but showed strong association when using fl regression . we also found that some genes expressed highly in both cases and controls may not be detected in the nb framework, because it utilizes the ratio of mean expressions of cases and controls. for instance, the normalized mean expression value of spock <dig> is  <dig>  in cases and  <dig>  in controls. although the difference of the means is large, the gene might not be statistically significant due to the small effect size  in the nb framework. however, this gene is strongly associated with hd in our logistic framework . spock <dig>  also known as sparc/osteonectin and testican- <dig>  plays an important role in the central nervous system  <cit> . as a member of the testican group, the expression in various neuronal cell types including cell types cerebral cortex, thalamus, hippocampus, cerebellum was reported by in situ hybridization  <cit> . several studies showed evidence of associations with prostate, colon, and breast cancer and bronchopulmonary dysplasia  <cit> .

the top genes that showed associations exclusively in nb glm, except for gene s100a <dig>  have low average counts as shown in additional file 13: table s <dig>  the estimated dispersions for these genes are also fairly large suggesting that they may be false positives.

the effect of including covariates has not been investigated for rna-seq studies. identifying relationships with covariates for all genes is computationally demanding and existing software do not allow for defining gene-wise models for all genes, which makes this approach challenging. therefore, rna-seq studies that include covariates in a single model applied to all genes will likely result in some gene expression models that include unassociated covariates. hence, it is important to investigate the effect of np covariates in rna-seq analysis.

simulations that included np covariates in the nb model showed inflated type-i error rates and a loss of power. with large dispersion, this inflation and loss of power becomes severe. the type-i error in the fl regression is not notably affected by the increment of number of ncp covariates when the covor is small. with large covor and increased number of ncp covariates, conservative type-i error rates are observed. the da method effectively controls the increase of type-i error rates even with larger covor and high number of np/ncp covariates. our empirical power results show that the fl regression is more greatly influenced by the increase of covariates than the nb regression, when covor is large.

our hd analyses with simulated np/ncp covariates demonstrated that an increase in the number of np/ncp covariates results in a less stable λ
gc. adding more np covariates in an nb model slightly decreases the median of λ
gc, and hence an increased in the median of p-values. in other words, many p-values in a set are generally increased. based on our simulation results with np covariates, type-i error rates of largely dispersed genes are likely to be inflated and power of differentially expressed genes are likely to be decreased. therefore, this slightly decreased median may indicate that the loss of power is greater than the gain of type-i error rates.

adding more ncp covariates in a model also slightly decreases the median of the λ
gc in fl regression. this decreased median might be caused by the loss of power, and this loss may occur from ncp covariates in a model according to our simulation results. under a moderate covor, the number of ncp covariates in a model does not affect the type-i error rates.

the change in the median λ
gc with additional covariates is larger in fl regression than in nb regression because the fl regression results are solely affected by the loss of power. nb regression results are influenced by both increased type-i error and decreased power. the standard deviation of λ
gc is increased with adding np/ncp covariates in a model. this means that the results generated from a model that includes many covariates is not likely to be reliable, even if these covariates are associated with case–control status but not gene expression.

CONCLUSIONS
in conclusion, unlike nb, cl and bl regressions, fl regression controls type-i error rates well and maintains comparable power even with small sample size. firth’s logistic regression is an excellent alternative to nb regression for analysis of rna-seq data in case–control studies. we recommend implementing the da method in analysis of rna-seq data to appropriately control type-i error rates. if computational burden of permutations required for the da method precludes using this approach, fl regression is the best option for controlling type-i errors with comparable power to nb regression. however, a parsimonious model is necessary to obtain robust results in the fl regression setting. this approach can be extended in multiple classes of disease status using a multinomial logistic regression method.

additional files

additional file 1: supplementary method. this document provides detailed descriptions of the dispersion estimation method, type-i error rates and empirical power calculations, procedures of data adaptive method using cross-validation technique, and huntington’s disease data. 


additional file 2: table s <dig>  type-i error rates of the nb regression from the balanced design with n
d=1 =  <dig>  mean: the mean expression values in cases and controls, disp: dispersion, nb: negative binomial regression, mld: maximum likelihood estimated dispersion, qld: quasi-likelihood estimated dispersion, td: true dispersion specified in the simulation. 


additional file 3: figure s <dig>  type-i error rates of regression methods from the balanced design. type-i error rates of the negative binomial with true dispersion , classic logistic , bayes logistic , and firth’s logistic  regressions at alpha levels of  <dig>  and  <dig>  are shown. the black dotted horizontal lines represent  <dig> and 1% of type-i error rates. dispersion values  are separated by black dotted vertical lines. four values of the number of cases  are placed within each dispersion value. dotted lines within each symbol imply 95% confidence interval. figure s <dig> : the figure presents the type-i error rates when μ =  <dig>  figure s <dig> : this figure shows the type-i error rates when μ =  <dig>  


additional file 4: table s <dig>  type-i error rates of regression methods from the unbalanced design with μ
d=0 =  <dig>  alpha: significance levels, n
d=1: the number of cases, n
d=0: the number of controls, disp: dispersion, nb: negative binomial regression with true dispersion, cl: classical logistic regression, bl: bayes logistic regression, fl: firth’s logistic regression. 


additional file 5: table s <dig>  empirical power of nb regression from the balanced design with n
d=1 =  <dig> and log2fc =  <dig> . mean: the mean expression values in cases and controls, disp: dispersion, nb: negative binomial regression, mld: maximum likelihood estimated dispersion, qld: quasi-likelihood estimated dispersion, td: true dispersion specified in the simulation. 


additional file 6: figure s <dig>  type-i error rates from deseq <dig> analysis of the permuted hd data. this contains type-i error rates from deseq <dig>  analysis of the permuted hd data at alpha levels of  <dig>  and  <dig> . each black empty dot represents type-i error rate of a gene. the red dots denote average values of type-i error rates in each category of dispersion groups. the black dotted horizontal lines are our alpha levels. figure s <dig>  shows type-i error rates of all genes at alpha level of  <dig> . figure s <dig>  displays type-i error rates of all genes at alpha level of  <dig> . 


additional file 7: figure s <dig>  type-i error rates from logistic model analyses of the permuted hd data. figure s <dig> contains type-i error rates from classical logistic , bayes logistic , firth’s logistic  regressions of the permuted hd data at alpha levels of  <dig>  and  <dig> . each empty dot represents type-i error rate of a gene. the dots filled with colors inside of boxes denote average values of type-i error rates in each category of dispersion groups. the black dotted horizontal lines are our alpha levels. figure s <dig>  shows type-i error rates of all genes at alpha level of  <dig> . figure s <dig>  displays type-i error rates of all genes at alpha level of  <dig> . 


additional file 8: figure s <dig>  type-i error rates from deseq <dig> analysis with the da method using the permuted hd data. figure s <dig> contains type-i error rates from deseq <dig>  analysis with da method of the permuted hd data at alpha levels of  <dig>  and  <dig> . each black empty dot represents type-i error rate of a gene. the red dots denote average values of type-i error rates in each category of dispersion groups. the black dotted horizontal lines are our alpha levels. figure s <dig>  summarizes type-i error rates of all genes with da method at alpha level of  <dig> . figure s <dig>  displays type-i error rates of all genes with da method at alpha level of  <dig> . 


additional file 9: figure s <dig>  type-i error rates from logistic model analyses with the da method using the permuted hd data. figure s <dig> presents type-i error rates from classical logistic , bayes logistic , firth’s logistic  regressions with the da method of the permuted hd data at alpha levels of  <dig>  and  <dig> . each empty dot represents type-i error rate of a gene. the dots filled with colors inside of boxes denote average values of type-i error rates in each category of dispersion groups. the black dotted horizontal lines are our alpha levels. figure s <dig>  shows type-i error rates of all genes with da method at alpha level of  <dig> . figure s <dig>  represents type-i error rates of all genes with da method at alpha level of  <dig> . 


additional file 10: figure s <dig>  bias from regression methods using the permuted hd data with μ
g >  <dig>  figure s <dig> contains bias from negative binomial regression using deseq <dig>  classical logistic regression , bayes logistic regression , and firth’s logistic regression . each black empty dot represents the bias of a gene. the black dotted horizontal line is no bias point. the bias of each gene is calculated using effect sizes of  <dig>  permutations. 


additional file 11: figure s <dig>  q-q plots of the hd analyses. figure s <dig> exhibits the q-q plots from the hd analysis adjusting for age at death and rin from deseq <dig> , and classical , bayes , and firth’s  logistic regressions. each regression method contains three different ways of calculating p-values . “original” p-values  are estimated from asymptotic distribution. “da” p-values  are evaluated from data adaptive asymptotic distribution using  <dig>  permutations. “perm” p-values  are calculated using  <dig>  permutations. 


additional file 12: figure s <dig>  venn diagram of hd analysis results using da method. each colored circle represents a different regression method. the numbers inside of the circles are the number of genes significant at fdr  <dig>  based on p-values adjusted using the data adaptive  method. there were  <dig>  significant genes in common across all the methods. the fl identified the largest number of significant genes compared to cl and bl. the nb independently identified  <dig> genes. 


additional file 13: table s <dig>  top  <dig> significant genes from deseq <dig> among genes not significant in logistic regressions. mean.exp.case: normalized mean expression value in cases, mean.exp.cont: normalized mean expression value in controls, disp: dispersion, nb.pval: p-values from negative binomial regression with true dispersion, cl.pval: p-values from classical logistic regression, bl.pval: p-values from bayes logistic regression, fl.pval: p-values from firth’s logistic regression. 


additional file 14: table s <dig>  all significant genes in fl regressions using the da method. mean.exp.case: normalized mean expression value in cases, mean.exp.cont: normalized mean expression value in controls, disp: dispersion, nb, cl, bl, fl: p-values from negative binomial regression, classical logistic regression, bayes logistic regression, firth’s logistic regression. 


additional file 15: table s <dig>  type-i error rates of the nb regression from the balanced design with n
d=1 =  <dig> and μ =  <dig>  disp: dispersion, covor: odds ratios between covariates and case–control status, ncov: the number of covariates in a model, nb: negative binomial regression, mld: maximum likelihood estimated dispersion, qld: quasi-likelihood estimated dispersion, td: the dispersion is used for the sampling. 


additional file 16: table s <dig>  bias with covariate models from the balanced design of n
d=1 =  <dig> and μ
d=0 =  <dig>  disp: dispersion, covor: odds ratios between covariates and case–control status, ncov: the number of covariates in a model, nb_td: negative binomial regression with the dispersion is used for the sampling, fl: firth’s logistic regression. 


additional file 17: table s <dig>  type-i error rates of the nb regression from the balanced design with n
d=1 =  <dig>  μ
d=0 =  <dig>  and log2fc =  <dig> . disp: dispersion, covor: odds ratios between covariates and case–control status, ncov: the number of covariates in a model, nb: negative binomial regression, mld: maximum likelihood estimated dispersion, qld: quasi-likelihood estimated dispersion, td: the dispersion is used for the sampling. 


additional file 18: r code. this r code regenerates the simulated data sets. 




abbreviations
aadage at death

blbayes logistic

clclassical logistic

covorcovariate or

dadata adaptive

dedifferentially expressed

fdrfalse discovery rate

flfirth’s logistic

glmgeneralized linear model

hdhuntington’s disease

log2fclog <dig> fold-change

mlmaximum-likelihood

nbnegative binomial

ncpnon-confounding predictive

ngsnext generation sequencing

npnon-predictive

qlquasi-likelihood

rinrna integrity number

rnaribonucleic acid

rna-seqrna sequencing

