BACKGROUND
the intriguing phenomenon of cooperation has fascinated experimental and theoretical researchers for decades, as it is essential for understanding the complexity of life, and life itself  <cit> . a dilemma derives from the fact that selfish individuals have an advantage over those who act cooperatively, by which we mean a costly act that can benefit others  <cit> . although selfish 'defectors' interacting with their own kind have a lower 'payoff' than cooperators, defectors would eventually totally replace cooperators in the population  <cit> . however a wide variety cooperative behaviour can be observed in nature  <cit> . moreover, it is a common observation that humans  <cit>  and some animal populations such as lions   <cit>  are polymorphic. individuals that have a high tendency to cooperate live together with those that have a high tendency to defect. the proportion of these 'laggards' can be high in certain societies and they are not being punished, as in the case of lions  <cit>  or in a number of human hunter-gatherer societies  <cit> . observations suggest that the average tendency for cooperation in these populations appears to be stable in the long term. this is a perplexing set of observations, not yet fully understood. existing explanations rely either on the snowdrift game  <cit>  with homogeneous population structure, punishment  <cit> , or spatially explicit population structure  <cit> . none of these explanations can be applied perfectly here as for example lion and human populations are neither completely well-mixed, nor spatially explicit in a sense as sedentary organisms, and punishment is also not common in these instances.

majority of the current evolutionary game theoretical studies that shed light on the mechanism behind many cooperative phenomena in biological systems concentrated on pair-wise interactions between individuals  <cit> . arguably numerous examples of group interactions found in nature however can be described as n-person games  <cit> , in which more than two 'players' interact with each other at the same time in the form of group actions  <cit> . during group interactions individuals typically invest into common goods or common goals  <cit> . in most of the cases this is available for everyone, that is the common good is non-monopolizable  and non-rival   <cit> . this raises a collective action problem, where non cooperators, often termed as free riders, can reap the benefit of the common good without investing into it  <cit> .

in many cases of a collective action the achieving the group goal, for example capturing prey depends on the number of encircling hunters  <cit> , and not necessarily on their individual efforts . during numerous instances of cooperative hunting several individuals simply fill the position of blocking, diverting, flushing the prey. this threshold effect is documented for cooperative hunting situations in various social carnivores including lions  <cit> , african wild dogs   <cit> , chimpanzees   <cit> , harris' hawks   <cit>  and humans  <cit> . for example when lions are hunting small prey, each lion pursues its own animal. however with larger, faster or more difficult prey  <cit>  the cooperation of a group of hunters is needed to encircle, split the herd, to spot, surround and kill the animal  <cit> . in order to make the hunt successful several lions have to work together   <cit> , get close to the prey before starting the attack   <cit>  and cut off its escape routes by encircling the prey from different points and filling the roles of "centers" and "wings"  <cit> . below a threshold group size it is not only hard to capture the prey but to defend it against hyenas  <cit> . chimpanzees  <cit>  or wild dogs  <cit>  sometimes use similar encircling tactics. harris' hawks either perform surprise attacks on lagomorphs from different directions, or use flush-and-ambush tactics to capture hidden prey  <cit> . some other bird species also hunt cooperatively larger prey, such as brown-necked raven  on egyptian mastigure , in which case two birds fill the tasks of blocking the escape routes of the prey while several others attack it from several directions, always performing the direct attack on the most exposured part of the lizard  <cit> . many sea mammal species, such as killer whales , humpback whales , bottlenose dolphins  and spotted dolphins  chase school of fish into a tight ball, sometimes driving it into a rock or to the water surface with coordinated group action, some performing tail slaps, creating a curtain of air around the fish ball or performing feeding bouts  <cit> . moreover some whales may use their acoustic "trumpets" creating a "wall sound" combined with the bubble net, as recently suggested by leighton and colleagues, to trap the fish inside the curtain  <cit> . cooperative hunting in human hunter-gatherers societies has been common, as coordinated action of several hunters was necessary to chase larger preys into a natural trap and to hunt them down   <cit> . there are numerous examples of threshold effects in the operation of modern human societies and in economics  <cit> . take as an example the requirement of a minimum number of hunters on the boat during traditional whale hunting  <cit>  or the necessity of collective mass for successful employee strikes  <cit> . finally, threshold effects in group cooperation can appear not only in human and animal hunting societies. there are well documented examples of a lower group size threshold in some cooperatively breeding species  <cit> . evidence from microbial cooperation suggests, that in some cases a threshold number of cooperators, that is bacteria which produce extracellular chemical components, is crucial in producing a public good  <cit> . also, at the dawn of life the first protocells were most probably composed of cooperative elements, rna molecules, which could have controlled the metabolism of the protocell acting like enzymes, and the complete metabolism most probably required the cooperation of sufficient number of elements, or at least the elements of an autocatalytic core  <cit> .

models of public good game nicely capture the main features all of the above described cooperative phenomena. but the traditionally used linear benefit return function is insufficient in capturing the threshold effect for the optimal number of individuals that is necessary to perform the given group action, as close to the threshold joining one or few more cooperators disproportionally increases the success of the group action  <cit> . so instead a nonlinear return paradigm is more appropriate  <cit> , such as in the n-player threshold public good game  <cit> . in this version of the public good game  a successful cooperative effort is achieved only if the number of cooperating individuals reaches a given threshold, just like in the above described situations. different levels of cooperation can be evolutionary stable outcome in such games, depending on the cost of cooperation, and the proportion of initial cooperative decisions in the population  <cit> .

while these situations assume that groups of individuals engage in an interaction which may or may not end in successful cooperation these groups themselves often compete with each other  <cit> . for example, in one of the most studied group behavioural biological systems lioness form a pack to hunt together yet they are in direct competition with other lion packs with which they share common borders  <cit> . the same holds for all group hunting territorial species from hyenas through whales, african wild dogs to humans  <cit> .

here we study the interaction of selection acting on the level of individuals engaged in a threshold pgg and selection acting on these groups while competing for territories. thus, our model differs from previous models of tpggs  <cit>  and that of multi-level selection  <cit>  by explicitly integrating these two components. we do so first by giving analytical solutions for the evolutionarily stable level of cooperation for various group sizes and threshold levels at first assuming only individual selection; then by studying the interaction of individual and group level selection with a series of computer simulations validated by the numeric results. we study  <dig> basic setups in the computer simulations:  individual selection only ,  group selection only, , and  the combination of both, in which case first we assume that  all individuals are obliged to participate in group defense , then we relax this assumption by allowing  voluntary participation . individual selection in our model allows individuals to compare their success with other individuals, or compete for resources, while group selection based on the idea that stronger groups may outcompete weaker ones by overtaking their territories. the structure of the game is described in the methods section.

RESULTS
effect of different threshold functions
first we study the effect of the benefit function shape on the level of cooperation in the population  by means of ibm simulations . for this we substitute the threshold benefit function with a sigmoid function , which gives the probability of achieving the group goal, that is receiving the benefit for different levels of cooperative effort. a good indicator of the cooperativeness in the system is the position of the hysteresis point  <cit> , which above the proportion of cooperators drops to zero in all cases. below the hysteresis point, we always find a stable level of cooperation, while if the cost of cooperation moves above the hysteresis point the population rapidly evolves to zero cooperativeness. the positions of the hysteresis points for different threshold values assuming sigmoid functions  don't change significantly for a wide range of s parameter . for high values of s , the hysteresis point appears at the same cost values ) for cases tâ‰ n , as with the strict deterministic step-wise function . for t = n, this parameter range is narrow , and a slight change in the steepness of the benefit function results in major changes in the cooperative equilibrium. our results indicate that the dynamics of the system remains the same for relatively steep sigmoid functions than for a step-wise function. in the following we will use the later one in our simulations.

results for individual level selection
next we employ the method described in bach et al.  <dig>  <cit>  to find the stable and instable equilibria of the model for individual selection only . we also run a series of simulations in our individual based model  for comparison with the analytical model . the equilibrium level of cooperation depends both on the size of the group  and on the threshold level  . figure  <dig> a depicts the resulting fixed points of the system for given group size and for increasing t, from the analytical model , and from individual based simulations , which show a close fit. the higher the threshold value the higher is the ratio of cooperators at a given group size . not surprisingly the highest level of cooperation can be achieved when the threshold value equals the size of the group, and for small group sizes, the average level of cooperation is higher . the unstable fix points separate the attractors of the interior stable fixed points of cooperation from the attractors of zero cooperativeness . above the separatrix, cooperation prevails, below this boundary, cooperation diminishes. all results from ibm model show a perfect fit for the predictions of the analytical model.

introducing multilevel selection
in the following we explore the individual based model with well-mixed and spatial population structure. in the first step, we introduce group level selection to the individual based model  keeping the participation in the group defense compulsory. figure  <dig> depicts the cases of only group selection , and the combination of group and individual selection when group defense is compulsory . the most striking effect of introducing group level selection is that the hysteresis effect disappears in all cases. in the well-mixed case  the level of cooperation is higher than without group selection, however, aside from the case t = n, the population is still polymorphic. it means that groups with higher number of cooperators do not necessarily enjoy a competitive advantage. groups in general respond in proportional manner to the threshold value, i.e. they optimize resource allocation. this can be best seen from the spatially explicit simulation with only group selection  as in this case the average equilibrium level of cooperation is exactly the threshold level. this implies that any deviation from the optimal group composition results in a disadvantage for the group, not only if the number of defectors is higher, but also if the ratio of cooperators and defectors differs from the optimal in any ways . introducing individual level selection decreases the level of cooperation in the well-mixed case , however interestingly and somewhat counter intuitively it increases the level of cooperation in the spatially explicit case . equilibrium populations are still polymorphic aside the case t = n. figure  <dig> c and  <dig> f depicts the case when participation at the group competition stage is voluntary. when group defense is cost-free  = 0) the level of cooperation in the public goods game is the same as in the previous cases . when group defense is costly  = 1) then the level of cooperation in the pgg is lower  and the hysteresis effect reappears in the well-mixed case , but not in the spatially explicit model . note, however, that when cooperation is present the polymorphic nature of the equilibria is preserved , that is, resource allocation is still optimized, groups with higher number of cooperators do not win out by default.

finally figure  <dig> depicts the results as a function of the two kinds of costs and the initial number of the cooperators in the pgg when both the participation in the hunt and in the group defense is voluntary . we can observe four types of dynamics in our simulations . if the costs of cooperation , c) are high, individual willingness to cooperate evolves to zero . individuals willingly cooperate in group defense  only if there are high levels of cooperation with regard of group hunting  on figure  <dig> e-h, figure  <dig> c). however, cooperation in the public goods game can stay at high levels even if the propensity to participate in group defense is low  . polymorphism of different cooperative efforts in the public goods game is still present at many of the equilibria , and interestingly division of labour evolves at medium values of costs in the well-mixed case . in these cases, polymorphism occurs on the population level, where individuals cooperate strictly in one of the collective actions, but never both .

our results also indicate, in line with the general conclusion of previous models that spatial structure favours cooperation  <cit> , as high values of cooperation evolve for both public actions  even at high cost values . we observe division of labour in the spatially explicit model only under given circumstances , which suggests that this outcome is unstable in these cases with small group size. note that when c >  <dig> cooperation evolves only if the initial proportion of cooperation is not zero in the population with well-mixed structure, which indicates a separatrix in the system. however, spatial population structure promotes cooperation and it allows cooperators to invade at higher cost values with regard of both types of costs .

discussion
here we show that multilevel selection in threshold pgg can maintain stable levels of polymorphism  without the need of punishment or spatially explicit population structure. we give a primary demonstration that the described dynamics holds not only for step-wise benefit function , but for a wide range of sigmoid curves between the step-wise and the linear benefit functions . our results further indicate that polymorphism in group hunting and defense can be adaptive in case of multilevel selection, and to our knowledge, we provide a pioneer report on the division of labour in multiple public good games. we conclude that what was regarded as cheating at the individual level is in fact can play a significant part in the optimization at the group level, which optimization is provided by the described mechanisms working on behavioural polymorphism.

many of the collective actions produce goods that are non monopolizable, meaning that no one can be excluded from benefiting  <cit> , thus free riders can exploit this collective good without paying the cost of production  <cit> . threshold effects in public good games can provide an often neglected, yet powerful explanation for the observed polymorphism in the population, as an alternative to punishment  <cit> , spatial structure  <cit>  or various payoff functions  <cit> .

population level polymorphism is a stable outcome in threshold public good games, where cooperators and free riders stably live together in the population  <cit> , as long as the cost of cooperation doesn't exceed a limit cost value, the hysteresis point. our model predicts that for an increased group size this hysteresis, that is a sudden drop from cooperation to defection, appears at lower cost values, compared to smaller groups . to put it in a different way, with large groups cooperation can be maintained only if the cost of cooperation is relatively low. also for higher cost values the instable fix points move closer to the stable fix points, which means that the invasion of cooperators in a population of defectors becomes harder, while the invasion of defectors into a cooperative population becomes more likely.

introducing multilevel selection into the model is a logical step towards reality, as in many biological and human examples where collective hunting occurs intergroup conflicts can be also observed  <cit> . when group level competition introduced explicitly into the model population level polymorphism is stabilized both in well-mixed and spatially explicit populations. thus, multilevel selection need not select for the groups with the highest number of cooperators as it is often assumed. groups that optimize the number of hunters enjoy an advantage over those groups that hunt  on a higher, unnecessary level. thus, defection of a given proportion of individuals during one specific cooperative group action can be an adaptive strategy for the group depending on the cost values. because group level performance  determines both individual and group level success any deviation from the optimal group composition would cause a disadvantage in some way or other. if the number of cooperators is lower than the threshold value then the collective action  is unsuccessful, thus neither cooperators nor defectors gain anything, and these groups are being replaced by successful groups. on the other hand, if the number of cooperators is higher than what is required for providing benefit for the whole group , the energy loss of unnecessary effort would cause a disadvantage when the group faces a conflict . hence our novel result is that laggards, who were previously seen as exploiters of the common goods provided by cooperators  <cit> , do actually contribute to the fitness of the group by keeping the group level allocation at the optimum level.

our results also verify that if participation in two distinct collective actions which produce shared benefits is costly, such as hunting and territory defense, then selection pressure on cooperators can result division of labour to evolve, predicting that it will evolve only for a narrow range of cost values. interestingly, behavioural polymorphism first appears at the individual level, that is all of the individuals participate in both collective actions with intermediate probabilities. however, this state is not stable and evolution drives the system towards division of labour at the population level, where individuals mostly participate only in one of the collective actions . this result is robust in our simulations at medium cost values, and turns out to be stable on the long term. experimental support for this context dependent role specialization is poor yet , however the idea that cooperators and 'free riders' switch roles in different contexts is not obscure  <cit> , as long as there is a trade off situation between two energy consuming group actions  <cit> .

our model has a simplistic assumption, that individuals have only two heritable traits that describe their behavioural decisions, this two are sufficient for maintaining polymorphism in the population. obviously regularly many genes effect behaviour, which explains higher polymorphism, still there is evidence suggesting that some may play disproportionally important role in behavioural switches  <cit> . accordingly, our model can provide a potential explanation for the observed polymorphism in lions in threshold game like situations  <cit>  and the presence of laggards in the population  <cit> .

the importance of intra group conflict in human evolution seems to gain a new currency  <cit> , however since the technology of hunting humans changed a lot in the last  <dig>  years , it is more difficult to evaluate whether a threshold effect existed in hominid plio-pleistocene group hunting. the conception of hunting large preys would inevitably suggest so and the fact that hunting of medium-sized and large ungulates started long before stone-tipped and bone-tipped weapons were widely used strongly suggests that cooperation amongst hunters was essential for the capture of large games  <cit> . if it did so, then our model applies and has the potential to explain the observed polymorphism in humans as well. interesting implication of our results is that once human societies become larger and more fluid in composition this polymorphism was no longer necessarily adaptive and definitely was not looked upon as desirable. this, in turn could have triggered the evolution of cultural norms and institutions that attempts to obtain an universally high level of cooperation from all the members of the society regardless of their predispositions.

CONCLUSIONS
here we present a multilevel selection model of interdependence in group living species, where cooperation is modelled as an n-player threshold public good game and where selection acts both at the individual and at the group level. we have found that the population can evolve into stable levels of cooperative polymorphism, where cooperators and free riders -laggards- can stably live together. our results indicate:  that the described dynamics holds for a wide range of probabilistic sigmoid benefit functions, not only for strict deterministic step-wise function;  that multilevel selection need not select for the highest number of cooperators within groups but instead it may selects for polymorphism depending on the details of the tpgg;  that defectors contribute to the group fitness as much as they help the group to achieve the optimal amount of investment at the group level;  that division of labour might evolve with regard of the participation in the two collective actions for medium cost values of cooperation;  and that spatial population structure promotes cooperation in tpggs.

