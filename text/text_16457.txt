BACKGROUND
rna-binding proteins  play essential cellular roles that range from co- and post-transcriptional regulation of mrna transcripts  <cit> , to stabilization of macromolecular complexes such as the ribosome  <cit> . in this genomic era, the imperative to utilize primary sequence data to elucidate the relationship between an rbp, its recognition site, and its function, is only growing  <cit> . identifying the binding sites for rbps is an important task toward unraveling gene regulatory networks  <cit> . however, prediction of rbp interaction sites remains a challenge. unlike dna-binding proteins , rbps may recognize features of single-stranded rna, double-stranded rna, or even three-dimensional tertiary structures  <cit> . therefore, rna structure must be taken into account in assessment of potential binding-sites. one method of experimentally identifying the constraints on an dbp or rbp recognition site is selex   <cit> . selex is an iterative in vitro selection technique that allows researchers to identify nucleic acids that interact with a target ligand. analysis of the sequences resulting from a selex experiment can be used to confirm the specificity of a binding site, or illuminate how rna structural plasticity may enable multiple sequences to present a similar three-dimensional motif to the protein  <cit> .

with the advent of next-generation sequencing, high-throughput sequencing-selex  has become an even more powerful approach to explore rna-protein interactions. sequence conservation within the selected population gives insight into important nucleotides, circumventing the need for laborious follow-up experiments to identify key regions of the selected sequences. the nucleotide differences between closely related sequences effectively explore local sequence space , and highly conserved areas point toward functionally important positions. using such patterns of variation and conservation, information about the critical sequence motifs responsible for binding is revealed. furthermore, sequencing intermediate rounds of the selection process allows ancestral sequences to be determined rather than inferred, and sequences that enrich over several selex rounds are more likely to be high affinity binders  <cit> . in addition, due to the high diversity of sequences undergoing selection, multiple possible and distinct binding motifs or structures can be discovered in a single experiment.

one downside of ht-selex approaches is the size and complexity of data that may be generated, especially from large randomized nucleotide populations. typically, the rna selection process starts with a pool of molecules on the order of 1012− <dig> sequences, which can still be dwarfed by the total number of possible sequences . in the ideal circumstance, over the course of a selex experiment, the sequence pool will converge on a small number of sequences that reflect a shared potential binding motif. if the entire sequence pool is sequenced, then these features should stand out as prevalent and enriching sequences within the population. in practice, given the size of the populations, under-sampling remains a significant hurdle. thus, often only a sparse view of the rna-binding pool is provided  <cit> , potentially obscuring patterns that might be apparent from more thorough analysis.

typical analysis of ht-selex data involves the identification of the rna-protein binding motif. this analysis is distinct from transcription factor identification in that there can be multiple potential binding motifs and these motifs are likely to have a secondary structure context . programs found in the meme suite  <cit>  such as meme, glam <dig>  <cit> , and dreme  <cit>  can be applied to the hts data to identify binding motifs. meme and dreme are designed to find contiguous sequence motifs. glam <dig> identifies motifs that can include short-gaps. however, there are a some of drawbacks to using these tools. due to their algorithmic complexity, meme and glam <dig> are not equipped to use large magnitudes of sequence data  <cit> . dreme’s run time scales linearly with the data set size, but this is still not sufficient to keep pace with larger hts data sets. additionally, these programs ignore any potential secondary structure, which can hinder their ability to find the putative binding motifs.

to identify sequence-structure motifs, there are programs such as memeris  <cit> , rnacontext  <cit> , aptamotif  <cit> , mpbind  <cit> , graphprot  <cit> , rck  <cit> , aptani  <cit> , and aptatrace  <cit> . memeris specifically identifies motifs found in the loop regions of the secondary structure, but like meme, it is not designed for hts data. rnacontext and rck use sequence and structure information to find rna binding motifs, but they require a large number of both binder and non-binder motifs in order to determine the motif enrichment because it is assumed that the binding motif is contiguous and is present in majority of binders and not in the non-binders. mpbind uses a k-mer approach to identify contiguous binding motifs by identifying prominent subsequences that are enriched between selection rounds. graphprot leverages secondary structure to identify binding motifs, but it also requires data on binders and non-binders alike. aptamotif is designed to analyze low throughput selex data, but it has been extended in the form of aptani, which restricts the motif search to loop regions of the structure. aptatrace is a state-of-the-art ht-selex motif identification tool that takes into account both sequence and structure to identify binding motifs. overall, many of these programs focus on identifying contiguous motifs while using secondary structure to restrict the search to single stranded regions.

ht-selex analysis techniques have been successfully applied to identify short sequence motifs responsible for rna-protein interactions  <cit> , typically located in internal loop regions  <cit> . while this type of analysis is effective for many rbp binding-motifs, particularly those that involve recognition of single-stranded regions of rna, not all rbps conform to such recognition patterns  <cit> . in many cases an rbp may interact with complex tertiary structure motifs, and in some cases with multiple complex structures. some rna binding proteins, such as adar or staufen, specifically recognize double stranded rna. these binding proteins target a structure containing  <dig> or  <dig> base-pairs, such as a single stem or co-axially stacked stems  <cit> .

in escherichia coli, several ribosomal proteins interact not only with the rrna, but also with structured portions of their own transcripts. these interactions allow stoichiometric production of ribosomal proteins by inhibiting transcription or translation  <cit> . while in some cases the mrna structures are apparent mimics of the rrna-binding sites, in other cases similarity is not obvious  <cit> . in addition, many of the mrna structures responsible for this regulation in e. coli are narrowly distributed to only a few bacteria  <cit> .

ribosomal protein s <dig> is a particularly interesting example of ribosomal protein regulation. s <dig> is a conserved protein across bacterial phyla, and in some bacteria it is auto-regulated at the translational level  <cit> . however, species within different bacterial phyla use distinct mrna structures to accomplish the same regulatory task  <cit> . there are at least four distinct mrna secondary structures that regulate in response to s <dig>  each constrained to a single bacterial phyla. each structure likely evolved independently, thus mrna interactions with homologous s <dig> proteins are not necessarily conserved. in contrast, both the s <dig> protein and its 16s rrna binding site are highly conserved among different lineages of bacteria. while previous work has identified the critical motifs in the 16s rrna  responsible for efficient s <dig> binding in e. coli and thermus thermophilus, various mrna structures can bind s <dig> despite containing some but not necessarily all of the 16s rrna binding determinants . furthermore, not all homologous s <dig> proteins are interchangeable regulators between different bacterial species, indicating some target specificity  <cit> . recently, we identified a set of selex derived rna structures that bind geobacillus kaustophillus s <dig>  <cit> . the identified rnas are distinct from known natural regulators, but several still regulate gene expression in response to s <dig>  just as in nature, a high degree of sequence and structure diversity was found in this study, suggesting that the natural diversity of rna regulation is not solely due to differences between s <dig> protein homologs.

in this work, we analyze the intermediate and final rounds of selex against g. kaustophilus s <dig> using high-throughput sequencing in order to better understand the diversity of potential rna structures that interact with s <dig>  the complex nature of the s15-binding site is a likely factor contributing to the high sequence diversity observed in our data. to elucidate any sequence-structure motifs, we developed an analysis approach that simultaneously considers the sequence and structure to identify a discontinuous double-stranded binding motif. by treating rna structure as a set of discrete substructures, we identify enriched structure elements associated with the rna-s <dig> binding site. in particular, we find many potential binding motifs that are significantly enriched over the course of selection. combining these motifs and experimentally validated binders, we build a model to separate specific and non-specific s <dig> binders. overall, we find that s <dig> heavily relies on the structure for recognition of its target.

RESULTS
characterization of selected population
we characterized the reads resulting from sequencing reverse transcribed and amplified products of selex rounds  <dig>   <dig>   <dig>  and  <dig> by examining read lengths, sequence enrichment, and diversity. there were  <dig> , <dig> total pair-end reads of which  <dig> , <dig> reads were forward strand and passed quality filters  . most of the reads are the expected length of  <dig> nt . the reads tend to become shorter in rounds  <dig>   <dig>  and  <dig> compared to round  <dig>  additionally, we noticed there was an increase in fragments of approximately  <dig> nt . these shorter fragments are most likely preferentially amplified during pcr compared to longer fragments. however, such individuals examined using filter-binding assays do not bind s <dig> specifically. we found that ≈2% of sequences from rounds  <dig> and  <dig> were enriched during the selex process  indicating the selection is likely enriching for specifically binding sequences. finally, there was significant sequence diversity in the sequence pool.  <dig> % of sequences appeared only once  and of the sequences that appeared more than once ,  <dig> % were seen fewer than  <dig> times .
fig.  <dig> 
a distribution of read lengths shows most reads are the expected length of  <dig> nt. b distribution of sequence enrichment of multiton sequences in rounds  <dig> and  <dig>  the enrichment is normalized to the total number of reads in the round. the red line indicates no enrichment . c majority of the sequences in our total sequence pool are singleton sequences





identification of global similarity between clusters
despite the large number of singleton sequences present in our data, there may be a large number of similar or related sequences  present. therefore, to reduce the complexity of our data and identify related sequences, we grouped sequences with high sequence identity together. due to the number of sequences, identification of common sequence or structure using pairwise comparisons is computationally prohibitive. there are several readily available programs that cluster based on sequence, such as cd-hit  <cit> , or cluster based on sequence and structure, such as rnaclust.pl + locarna  <cit> . however, most structure clustering tools are not applicable to the hts data. rnaclust.pl is designed to cluster <  <dig> sequences and locarna  are designed to simultaneously use sequence and structure to create multiple sequence alignments from homologous sequences, not the large and diverse set of sequences we obtained through selex. while cd-hit only compares sequences, similar sequences are likely to fold into similar structure. therefore, we used cd-hit, a fast and widely-used program for nucleic acid clustering that utilizes heuristics to significantly reduce run time.

we established a clustering threshold by examining sequence similarity to high frequency sequences. examining the distribution of sequence distance around high frequency sequences shows a clear separation at 10% normalized edit distance, which is equivalent to 90% sequence identity . clusters formed around the most frequent sequences are distinct, as seen by having lower within-cluster distance than between-cluster distance. this trend continues to be true for all high frequency sequences . because cd-hit run time increases proportionally to the number of clusters , we reduced the run time by using an 85% sequence identity as the clustering threshold.
fig.  <dig> 
a histogram of normalized levenshtein distance from the top  <dig> high frequency sequences  shows a clear cluster cutoff at distance 10%. within the cluster, there is a decrease in the frequency of sequences further from the center indicating sequence clusters containing high frequency sequences are valid. b plot of the cd-hit clustering data represented as cluster size vs mean percent identity to cluster seed . in red are the clusters containing high frequency sequences with more than  <dig> read counts. in blue are clusters containing high frequency sequences with more than  <dig> read counts, which have been experimentally examined for binding to s <dig> . in green are sequences experimentally tested that are from the clusters that do not contain high frequency sequences




given the observed sequence diversity across our clusters, we also assessed whether any similar global secondary structures were shared between clusters. clustering similar sequences together reduces the number of structure prediction operations because a representative cluster structure can be quickly determined by sampling and folding a small number of sequences . therefore for these comparisons, we focus on clusters with > 90% similarity . using this method, we find that sequence clusters are also effective structure clusters because the intra-cluster structure distance  is lower compared to the inter-cluster structure distance . additionally, pairwise comparisons of the clusters shows higher inter-cluster structure distance, indicating there is no globally similar structure shared between clusters. while some clusters appear to have similar structure , upon closer inspection, this similarity is an artifact caused by comparing a limited number of structures from each cluster .
fig.  <dig> 
a distribution of inter-cluster ensemble distances from cluster  <dig>  which contains the most frequent sequence. clusters selected for comparison included clusters with > <dig> distinct sequences, >90% mean identity to the seed. to get a distance distribution when comparing clusters to cluster  <dig>  individual sequences of the same length from the given cluster and cluster  <dig> were compared in an all-against-all fashion. as a reference, the median intra-cluster distance for cluster  <dig> was  <dig>   and the first-quartile was  <dig>  . b representing all selected cluster pair-wise comparisons distance distributions in a heatmap shows that on average, clusters differ from other clusters by  <dig> . in general, many of the structures are distinct from those of other cluster structures




identification of sequence motifs
the high cluster count made it difficult to extract meaningful sequence or structure patterns in the data. in order to identify any common short sequence motifs, we started with sequence based approaches for motif identification because there are a variety of existing tools . many tools for motif identification are found in the meme suite . in particular, meme and glam <dig> are not designed to process hts data. to overcome the large number of sequences in our dataset and differences in the number of sequences in each round, we repeatedly sampled  <dig> sequences from each round for a total of 4∗ <dig> sequences. this sample size represents approximately 20% of rounds  <dig>   <dig>  and  <dig>  but only  <dig> % of round  <dig>  such sampling allows us to compare a number of different methodologies for analyzing the data, regardless of whether they are explicitly designed for large data sets. however, while meme is powerful and can identify transcription factor binding sites, in practice the algorithmic complexity limits the data to <  <dig> sequences  <cit> . glam <dig> is able to identify gapped motifs and tolerates larger data sets, but it does not find any significant motifs  in our data . we also applied dreme to find short k-mers , and some of the top motifs with more than  <dig> occurrences are significant . these motifs are repeatedly found in multiple resamplings of the data; however, they are only found in  <dig> -5% of the total sequence pool.
unless noted otherwise, all software were run using a sample size of 4∗ <dig> sequences


where r = a or g; y = c or t; w = a or t




additionally, we applied other state of the art programs for identifying binding motifs in ht-selex data . aptatrace returned no significant results with our sampled data . upon increasing the sample size to 33% of each round, aptatrace returned a set of significant motifs, the top five of which are shown on table  <dig> . notably the top motif is similar to the top motif identified by dreme . however, all the seed sequences are present at < 10% of the final population , and even partially degenerate motif sequences typically represent < 15% of the population . resampling the data did not substantially alter the top motifs identified or the frequencies with which they appeared in the data. we subsequently ran aptatrace on our entire data set and obtained a slightly different set of motifs . none of these seed sequences are present at > 3% of the final population, and all motif frequencies were < 10%. intriguingly, aptatrace did highlight that many of our more frequently identified motifs occur in paired regions as opposed to loop regions . this finding suggests that methods analyzing pairing elements specifically may be more useful in understanding our data.



due to our lack of non-binder data, we could not directly leverage all of the features in rnacontext or rck. to allow application of these tools to our data, we created a background data set  to use as non-binder data . we applied rck to our binder and background data set, which identified motifs located in paired regions . for k =  <dig> and k =  <dig>  the motifs identified appear to be biased toward sequence that occurs in our non-constant region . the k =  <dig> motif identified does not obviously share this bias. this motif occurs in  <dig> % of the final data. of note, this motif occurs in a paired region, further suggesting that examining paring elements more closely may be useful for this particular data set.

identification of structure motifs
the lack of enriched sequence motifs and global secondary structure conservation indicates the binding likely occurs in a substructure of the selected rna sequences. the existence of a substructure is further supported by motifs identified by existing motif finders that appear to be in paired regions, and only account for a small fraction of the sequence pool. to identify potentially important substructures, we developed a novel approach that differs from existing methods by specifically focusing on stacking base-pairs. we represent stacked base-pairs as 2_ <dig> nucleotide cyclic motifs    <cit> . in this representation, each base-pair within a pairing region is part of two 2_ <dig> ncms, one with the base-pair above, and a second with the base-pair below. therefore the sequence 5’-agg-3’ base-paired to 5’-ccu-3’ would contain two ncms: au/gc and gc/gc. this representation is advantageous because ncms discretize the secondary structure into smaller components and they have been used to great effect in improving rna tertiary structure predictions  <cit> .

ncm enrichment is calculated as the ratio of the mean ncm frequency for later rounds  relative to earlier rounds  or background . as described for other methods above,  <dig> sequences were repeatedly sampled from each round to determine ncm frequencies. since this approach depends on structure predictions, we calculated ncm enrichment using both the minimum free energy  and the centroid structure, which better represents the ensemble of structures. both structure representations have associated values for the free energy of the structure, which is inversely proportional to the thermodynamic stability . thus, both representations capture trends such as increasing stability in later rounds. the ncm enrichment values derived from using the mfe structure and the centroid structure are moderately correlated . using the centroid structure reduces the ncm frequency, but the reduced frequency has small impact on enrichment. therefore, we carried out the remaining enrichment analysis using the mfe structure.

to identify significantly enriched ncms, we also calculated the expected enrichment by comparing the ncm frequencies of the sampled sequences to background sequences, either created using uniform base frequencies  or base frequencies based on our total sequence pool  . our criteria for enrichment is that the ncm ratio of round  <dig> to round  <dig> must be significantly greater than the ratio of round  <dig> to background. many ncms are significantly enriched , while some are depleted  when compared against bg samp . there is significant overlap of enriched and depleted ncms when comparing against bg uni . interestingly, many of the enriched motifs contain a gu wobble pair, which could be a potential recapitulation of the natural binding site. despite the lower percentage of round  <dig> sequences sampled, the enrichment analysis is robust to the sampling and identifies similar enriched, depleted, and unchanged ncms relative to round  <dig> . gu/ug and ug/gu appear to be highly enriched and have larger standard error. however, these ncms are not significantly greater than background, and the high variability is due to low frequency, thus these are considered spuriously enriched ncms.
fig.  <dig> 
a log <dig> fold change of ncms averaged over  <dig> resamplings. the round  <dig> enrichment trends are consistent with the round  <dig> and round  <dig> enrichment. b log <dig> fold change of ncms averaged over  <dig> resamplings comparing the enrichment of round  <dig> vs. round  <dig> and round  <dig> vs. background created with sampled base frequency . error bars represent standard error




the ncm enrichment in later rounds suggests selection for particular motifs. by treating clusters as “sequence families,” we used lasso logistic regression to identify ncms associated with cluster enrichment. since the analysis depends the clustering, we re-clustered our sequence pool multiple times and found the clustering is relatively stable . for each repeated clustering, we carried out lasso regression and reduced our ncm predictors to those that appeared in majority of the models with p-value <  <dig> . using this method on both round  <dig> to round  <dig>  and round  <dig> to round  <dig>  we identified positive predictors cg/gu and gu/gc as well as negative predictors au/gc and cg/ua that are found in both models . cg/gu was identified by enrichment analysis as well, further indicating its importance.



given the overlap of predictors, we tested whether the logistic regression model for round  <dig> enrichment could predict future cluster enrichment . ideally, the same ncms are selected throughout the selex process. after training on round  <dig> enrichment data, we tested the model by using cluster enrichment from each of the re-clustered data sets. however, this model offers a limited prediction accuracy , indicating some predictors are not readily identified .

in order to ensure the 2_ <dig> ncm was not part of a larger base-pair stack, we used spearman correlation to identify any ncms that often appear with each other. there is moderate correlation between some ncms  . however, this correlation is most likely spurious because repeated analysis with 3_ <dig> ncms does not show higher enrichment of these ncms relative to bg samp .

experimental assessment of s <dig> binding affinity
in order to ensure our selex data provided an accurate reflection of binding sequences, we assayed a variety of sequences for binding affinity for s <dig> . we find many high frequency sequences had moderate affinity for s <dig> ranging from 19- <dig>  nm . given the high diversity of the sequence pool, we also tested singleton sequences for binding, which revealed  <dig> of  <dig> singleton sequences also bind s <dig> . previous literature suggests that sequence enrichment is a better predictor of binding affinity  <cit> . we find that there is no correlation between the degree of enrichment and binding affinity . both depleted sequences tested bind s <dig> with moderate affinity .



we also tested sequences from clusters that are centered on high frequency sequences. when a sequence represents a large fraction of the cluster, we hypothesize that this sequence binds with high affinity while the remaining sequences “explore” the local sequence space. fitting with our hypothesis, many high frequency sequences specifically bind s <dig> and are found in high mean pairwise identity cluster . as a control, sequences from clusters with low mean pairwise identity not centered on high frequency sequences were also examined . we find half of these sequences bind specifically, which suggests high identity clusters are more likely to contain s <dig> binders.

we use the enriched/depleted ncms with our experimental data to build a model to identify potential binders . due to the limited number of negative test cases, we use additional sequences from our background set to build a logistic regression model. the model suggests using enriched and depleted ncms are good predictors of binding  .

discussion
the rna binding sites of many proteins are complex in terms of both sequence and structure. in this work we sought to understand the pool of potential rna-binding sites for g. kaustophilus ribosomal protein s <dig> using in vitro selection coupled with high-throughput sequencing . the high-throughput sequencing revealed a diverse population of sequences with over  <dig> % of our sequences appearing only once in the population. we were able to cluster our data using a number of different methods. however, the large number of unique clusters produced did not share any obvious global structure or sequence characteristics. existing strategies that have been applied to the analysis of other rbps were unsuccessful at identifying any features that would explain a significant portion of our data. many programs are not designed for the number or diversity of our sequence data. aptatrace and rck, which take rna structure into account, both return motifs that show a tendency toward regions involved in base-pairing rather than single stranded regions. however, the proportion of the data explained by any of these motifs is typically quite small.

ht-selex experiments often produce diverse sequence pools, and in many cases singleton sequences are regarded as “noise”. however, we examined several individual sequences from our population to show that both frequent sequences and those that only appear once in the population display specific binding with physiologically relevant dissociation constants . furthermore, no clear relationship between frequency, or degree of enrichment and dissociation constant was identified. this finding suggests that the diversity we observe may not be due to noise introduced by the selection process, but rather be a result of the large diversity of sequences with which g. kaustophilus ribosomal protein s <dig> may interact.

we developed a novel approach to analyzing ht-selex data for motifs that incorporate rna structures. our approach borrows from three-dimensional structure prediction  <cit> , by considering all potential substructures or nucleotide cyclic motifs  of a certain length. this approach is further necessitated by the complexity of the known rna binding sites for s <dig>  <cit> . we repeatedly sampled sequences from each round to carry out our analysis. there are many enriched or depleted 2_ <dig> ncms relative to earlier rounds, with many of the enriched ncms containing a gu wobble base-pair, which could be a potential recapitulation of the natural binding motif. by using lasso regression, we effectively reduced the number of ncms to potential predictors of enrichment.

our algorithm is easily parallelized and the run time is increased proportionally to the number of secondary structure predictions. the run time falls on the shorter end of the spectrum compared to existing software, which can sometimes take a week to finish . we have also demonstrated that the algorithm is robust to structure representation. additionally, the ncm data is easily integrated into models to predict potential binders. despite a limited number of validated binders and non-binders, the model accurately distinguish binders from background sequences. surprisingly, our limited model classifies only  <dig> % of the total sequence pool as potential s <dig> binders, suggesting many potential non-binders. considering the proportion of binders found within our limited population of verified binder sequences, it appears that only a subpopulation of binding sequences can be identified using ncms alone and that s <dig> likely can recognize additional features that are not captured by this data.

CONCLUSIONS
our analysis of the ht-selex data for the g. kaustophilus s <dig> suggests that this protein can bind a large diversity of sequences in vitro and our previous work demonstrated that half of the rnas examined allowed regulation  <cit> . the analysis also suggests that the recognition motif is located in a combination of structure elements with little requirement on the sequence itself. this finding also illuminates a possible reason for the large sequence and structure diversity in natural s <dig> mrna secondary structures. the approach we developed to analyze our data is broadly applicable to many other rbps that have complex noncontiguous recognition motifs. by considering rna secondary structure elements as building blocks , we bring a novel approach to analyzing in vitro selection data for rna-protein interactions that may primarily rely on specific local features in the context of a larger secondary structure.

