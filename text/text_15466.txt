BACKGROUND
outer membrane proteins  of pathogenic bacteria are widely recognized as crucially involved in bacterial interactions with eukaryotic hosts  <cit> . they have thus been the subject of extensive studies aimed to clarify how they evolve and whether their patterns of divergence are informative about the biology of host-bacteria dynamics. omps are involved in a large repertoire of functions, including bacterial invasion and defense, transportation of various molecules, adhesion and signaling pathways  <cit> . omps of mammalian pathogenic proteobacteria often function as antigens  <cit> , and several of these proteins are currently targets for vaccine development against important human pathogens, such as ehrlichia, rickettsia, haemophilus influenzae, and neisseria meningitidis  <cit> .

omps are highly variable and among the fastest evolving microbial proteins  <cit> . despite a large diversity of composition and function, they do share genetic and structural features that allow their identification as surface proteins, primarily via bioinformatic prediction  <cit> . omps show a characteristic transmembrane β-barrel structure, formed by an even number of antiparallel sheets, connected to loops of variable length at the extracellular side and to short turns containing both n and c termini at the periplasmic side. given the key role of omps in the interactions with the host, a large number of studies have been devoted to uncover trends in the molecular evolution of these proteins  <cit> . typically, residues in the β-barrel show the highest conservation, while variability mainly affects the conformational domains located in the extracellular loops, which can function as receptors and can be highly antigenic - e.g. p <dig> omps of ehrlichia, opa proteins of neisseria and msp <dig> proteins of anaplasma  <cit> .

while considerable attention has been given to omps of vertebrate pathogens, the role and evolution of omps in the establishment and persistence of both pathogenic and non-pathogenic microbial associations found in invertebrates remain largely unknown. recent studies have shown that both the vertebrate and invertebrate immune systems can confer specific protection against bacterial infections and share comparable defensive solutions  <cit> , making omp of invertebrate pathogens important candidates for investigating host/symbiont interaction dynamics. in addition, for those vertebrate pathogens that are vectored by arthropods, selection by the invertebrate innate immune system could shape the virulence of vertebrate pathogens vectored by invertebrates  <cit> . therefore, studies of omps in bacteria that infect invertebrates, but not vertebrates, could reveal to what extent selection in invertebrates shapes omp diversity and evolution.

the wolbachia surface protein  is an omp found in the intracellular bacteria of the genus wolbachia  <cit> , a very widespread and important group of endosymbionts of arthropods and filarial nematodes. current estimates indicate that around 60% of arthropod species worldwide are infected with this intracellular bacterium  <cit> . wolbachia belong to the rickettsiales and relatives are important vertebrate pathogens within the genera rickettsia, ehrlichia and anaplasma  <cit> . however, in contrast to some notable members of these related genera, wolbachia are not pathogens of vertebrates. instead, theyare mostly known to be "reproductive parasites" of arthropods  <cit> , while in filarial worms and some insects they are required for their hosts' survival and provide them with some benefits  <cit> .

the function of wsp in wolbachia remains unknown, although several lines of evidence suggest that it may be an important mediator of the host/symbiont interaction. first, wsp is a dominant protein constituent of infected drosophila eggs  <cit> . experimental studies have shown that wsp can activate the innate immune response in humans via interaction with toll-like receptors  <cit> , and trigger a potent inflammatory response in both human and canine filariasis  <cit> . recently, wsp has been shown to delay apoptosis in human polymorphonuclear cells , typically involved in the innate immune response against microbial pathogens  <cit> . finally, inoculation of wsp in balb/mice induces the expression and production of nitric oxide, an important toxic component used by the immune response against bacteria  <cit> . the above studies indicate that wsp can induce host immune responses and recent hypothesis predicts wsp as an important player in the establishment and persistence of the symbiosis via apoptosis inhibition  <cit> .

wsp shows a heterogeneous pattern of amino acid diversity characteristic of other omps, marked by four distinct hypervariable regions  interspaced by conserved strings of amino acids   <cit> . variants at each hvr have been frequently exchanged across bacterial strains, generating highly chimeric proteins  <cit> . while shuffling of hvr motifs is apparent, the primary source of such remarkable amino acid diversity at hvrs remains unknown. furthermore, it is unclear whether this genetic diversity is adaptive; because arthropod wolbachia do not infect vertebrate hosts, selection acting on the protein is not due to a response to the vertebrate adaptive immunity . other forces, therefore, are likely to be shaping the evolution of this protein.

here we investigated structure and molecular evolution of wsp using  <dig> distinct alleles found in  <dig> host isolates, representing the largest sequence dataset available to date for wolbachia. the first an in silico prediction of the three-dimensional structure of wsp is presented. using the predicted structure as framework, we investigated the microevolutionary forces that drive the early diversification of wsp proteins by means of clusters of closely related proteins based upon haplotype categories for individual hvrs. this approach eliminates the problems of alignment due to extensive divergence within the hvrs, and allows identification of closely related hvrs , thus providing a ready classification of variation generated via point mutation versus recombination in recently divergent proteins. we found that wsp shows a rapid turnover of amino acid sequences via both high rates of recombination and positive selection typical of immune antigens under strong selection for diversification. these appear as hallmarks of an ongoing arms race between the host and wolbachia and identify wsp as a strong candidate for future studies of host-wolbachia interactions.

methods
in silico prediction of wsp structure
discrimination of wsp among globular, inner and outer membrane proteins was assessed based on a position specific scoring matrix  profiles approach, implemented in tmbetadisc-rbf  <cit> . prediction was confirmed by querying the complete wsp sequence from wmel to the hhomp database, available at http://toolkit.tuebingen.mpg.de/, which detects sequence homology to known outer membrane proteins  based on sequence-profiles identified with hidden markov models . the wsp two and three-dimensional structures were then predicted using hhpred  <cit> , which uses structurally related proteins as template. results were inputted into modeller  <cit>  using a multiple alignment for modeling of the tertiary structure. the three-dimensional model was visualized in cn3d version  <dig>   <cit> . hhpred has been shown to perform better over simpler approaches  when template-target similarity is lower than 40%  <cit> , as is the case with wsp and homologous proteins. to correct for diversity among wsp proteins, we also generated three-dimensional models using a diverse set of divergent wsp genotypes, besides wsp from wmel. wsp topology with respect to the outer membrane lipid bilayer was predicted by the posterior decoding method using pred-tmbb, software based on hidden markov model  <cit> . analysis of the hydrophobic and hydrophilic indexes was performed using the kyte and doolittle scale  <cit> .

sequence mining
the nucleotide sequences were either generated during this study or retrieved from genbank. new sequences were obtained using standard primers and protocols available at http://pubmlst.org/wolbachia/wsp/info/protocol.shtml. the procedure for genbank retrieval was as follows: all nucleotide wsp sequences present in genbank were downloaded and redundancy discarded. the set of unique wsp sequences that met the length requirement to be assigned to an allele  and that showed no ambiguous sites were retained. together with the sequences generated in this study a total of  <dig> distinct alleles were obtained. all sequences were then compared against the ncbi nucleotide database with blastn. for all exact matches , all available host taxon and country of origin information were collected. multiple entries having the same host species and same wsp allele were retained if they differed by locality information. several alleles were sequenced during this study and their host information was combined with information collected from genbank. overall,  <dig> distinct records were collected .

sequence typing
all  <dig> alleles were characterized according to the wsp typing system previously developed  <cit> . briefly, each unique nucleotide sequence within a defined range of nucleotides was assigned an allele number and translated into amino acids. the amino acid sequence was partitioned in four consecutive peptides, each encompassing one of the four hvrs and a short portion of the two flanking conserved regions. for convenience here we refer to each of these four sections as hvr . each unique hvr peptide was assigned a number, thus a protein haplotype is identified by a profile of four peptide numbers . each wsp allele is always associated with a single wsp profile; however, the same wsp profile can be associated to different alleles . this typing method was developed to overcome the difficulty of managing wsp nucleotide sequences, which are highly variable in length and show extremely low homology at the four hvrs, thus making alignment reconstructions impracticable . moreover, the four hvrs of wsp undergo extensive recombination, which results in mixing hvrs peptides among proteins  <cit> . such a typing system, therefore, provides a useful means for spotting recombination events involving divergent hvrs among otherwise closely related wsp sequences . all  <dig> alleles and corresponding hvr haplotype profiles were uploaded into the wsp database  <cit> .

analysis of nucleotide genetic diversity and gc content was performed using dnasp version  <dig>   <cit> . gc content at the third  position was calculated for each of the six largest wsp complexes  and for the five mlst genes. amino acid divergence was calculated in paup version  <dig> b <dig>  <cit> .

to explore whether additional intragenomic sources might contribute to wsp variability , complete wsp and single hvr nucleotide sequences from drosophila melanogaster and culex pipiens were blastn against the wolbachia genomes from these two host species.

identification of protein complexes
we identified complexes of closely related wsp proteins using the clustering program eburst v <dig>  <cit>  and employing the matrix of wsp profiles to depict evolutionary relationships among wsp genotypes. this approach is superior to conventional phylogenetic analyses, in this case, because it reveals localized recombination  among otherwise similar wsp sequences, without incorrectly inferring such sequences as phylogenetically distant. the program eburst is typically used for analysis of mlst allelic profiles  and assumes an epidemic model of population structure for building the clusters: that is, it assumes that a founder genotype  initially rises in frequency and subsequently diversifies to produce minor variants , hence producing a "clonal complex" of closely related genotypes. given a matrix of allelic profiles, eburst predicts the ancestral genotype to be the profile with the greatest number of single locus variants. often the founder is also the most frequent profile in a complex .

here we applied the same clustering algorithm to a single locus, thus using wsp profiles. wsp profiles were clustered into "wsp complexes", where a wsp complex is a group of related wsp profiles that differ at a single hvr peptide  with respect to the ancestral profile. the ancestral profile of each complex is predicted by eburst to be the wsp profile with the highest number of shvs. profiles that could not be assigned to a group were named singletons.

recombination versus mutation estimates
we used the complexes identified by eburst to estimate the relative contribution of recombination versus mutation that give rise to new proteins. within complexes, mutant profiles were discriminated from recombinant profiles  by assessing whether shvs diverged by mutation or recombination. the procedure was as follows. first, within each wsp complex, all wsp profiles were compared to the ancestral profile and the number of amino acid changes at their shv was annotated. in case of complexes of two profiles we performed a simple pairwise comparison. this allowed a first screening for major recombinant proteins, defined as the wsp profiles that showed  <dig> or more amino acid polymorphic sites at their shvs  with respect to the ancestral type. all other profiles within a complex, which then showed  <dig> to  <dig> polymorphic sites at their shvs, were compared to the whole dataset and nucleotide substitution patterns inspected. if a shv peptide was shared among profiles in different complexes, then mutation was assumed when the nucleotide substitution patterns at their shv differed. in cases of matching substitution patterns, a) a single nucleotide substitution  was assumed to be arisen by convergence and the profiles retained as mutants, b) multiple shared nucleotide substitutions were considered sign of recombination and the recombinant profile was predicted to be the one with highest number of amino acid changes with respect to its ancestral profile. if equal, both profiles were labeled as recombinants. the relative contribution of recombination to mutation in generating protein diversity was measured as a ratio of recombination to mutation per protein and per hvr. we are aware that this approximation does not take into account mutation and recombination events that did not result in amino acid changes ; indeed our goal was to explore the contribution of the two forces in promoting protein diversity, and not synonymous allele diversity. in addition, we have also examined recombination occurrence among distinct alleles carrying only synonymous substitutions . the recombination analyses were also expanded to profiles members of subgroups and subgroup founders .

prediction of the ancestral alleles
ancestral proteins predicted by eburst can be coded by multiple alleles within a complex. to identify the ancestral allele and confirm eburst prediction we proceeded as follows. first, within a complex, all alleles associated to mutant profiles, including synonymous alleles, were further analyzed at the nucleotide level to exclude recombination occurrence using the method of betran et al  <cit> , implemented in the dnasp. second, the ancestral allele of each complex was predicted using a statistical parsimony method  <cit>  carried out in tcs software version  <dig>   <cit> .

analysis of selective pressures
selection on mutant alleles was investigated using the complexes previously detected. for complexes that included at least four sequences  all alleles were tested for neutrality, using the tajima's d  <cit> . for complexes of three or more alleles for which the ancestral allele was identified , rates of non-synonymous substitutions  and synonymous substitutions  per codon were estimated using the codeml program in paml package  <cit> . specifically, for each complex we generated a simple star tree with a bifurcation at the deepest node to assign the root  and used it as input file for codeml. four models were tested: the nearly neutral model , which assumes a proportion p <dig> of conserved sites with ω <dig> <  <dig> and p <dig> =  <dig> - p <dig> of neutral sites with ω = 1; the positive-selection model , which includes an additional class of sites with frequency p <dig> =  <dig> - p <dig> - p <dig> and with ω <dig> estimated from the data; the model m <dig>  which assumes that ω is β-distributed and provides a flexible null hypothesis for testing positive selection; and the model m <dig>  which includes one additional ω class of sites with respect to m <dig>  estimated from the data. we performed two likelihood ratio tests  comparing likelihood scores of m <dig> vs m <dig> and m <dig> vs m <dig>  the presence of positively selected sites within each complex was determined by concordance between the two best-selected models using the bayes empirical bayes analysis .

to explore selective pressures acting on partitions of wsp, the nucleotide alignment including the  <dig> alleles was divided into seven sections corresponding to hvr <dig>  cr <dig>  hvr <dig>  cr <dig>  hvr <dig>  cr <dig> and hvr <dig>  for this particular analysis, each hvr  comprises only the strings of hypervariable amino acids, thus excluding any portions of the flanking conserved regions. section boundaries for hvrs were based on the alignment in baldo et al.  <cit> , where a similar analysis was performed using a much smaller dataset. within each of the seven sections, redundancy of nucleotide sequences was discarded and sequences were grouped using blastclust, available at http://toolkit.tuebingen.mpg.de/, based on 95% cutoff of nucleotide identity and 100% matching length. this clustering approach considers related regions of wsp even if inserted in a recombinant background. for each wsp section, dn/ds ratios were estimated at each cluster of three or more sequences using the method of nei and gojobori   <cit> , implemented in dnasp. average values across groups within each section were then calculated. for few groups within hvrs, dn/ds values were not available, as sequences diverged only by nonsynonymous substitutions returning no ratios; although suggestive of positive selection, these groups were conventionally assigned dn/ds =  <dig> as a conservative estimate.

analysis of synonymous allele variants
for each of the  <dig> proteins in our dataset, number of allele variants, average synonymous diversity and number and type of polymorphisms were estimated using dnasp. as a control, we compared these estimates to those obtained for the five mlst housekeeping genes, using a dataset of published and partly unpublished data. statistical significance of difference in values between wsp and each of the five mlst genes was inferred performing a wilcoxon two-sample test.

statistical association of wsp sequences with host taxa
the rarefaction curve was built using the online calculator available at http://www <dig> biology.ualberta.ca/jbrzusto/rarefact.php. curve fitting to predict the asymptotic number of wsp proteins was performed using the on-line regression analysis at site http://www.xuru.org/rt/nlr.asp#manually. the  <dig> points along the curve were used for curve fitting to formulae allowing for three parameters.

we tested whether genetic distances between wsp protein sequences that are found in hosts within the same genus were more similar than they would be by random chance. we choose to analyze proteins instead of nucleotide sequences to facilitate generation of alignments and because wsp amino acid diversity largely reflects the nucleotide diversity. the procedure was as follows: the  <dig> wsp sequences were translated into amino acids, aligned using clustalx  <cit>  and manually curated in bioedit vs <dig> . <dig>   <cit> . the hvr <dig> was eliminated from the analyses as difficult to align and highly recombinant. a distance matrix was generated based on the amino acid alignment using paup version  <dig> b <dig>  <cit> .

to determine whether wsp sequences were significantly associated with host genera, we sub-sampled the initial dataset to comprise only one host species per wsp allele, that is, the dataset included multiple representatives of the same species only in case they carried distinct wsp alleles. this avoids overrepresentation of a single wsp sequence found in the same host species but from different geographical regions. the final dataset included  <dig> entries. in order to create a null distribution, we generated  <dig> pseudoreplicates by randomly resampling host taxa without replacement across all wsp sequences. for each pseudoreplicate we calculated the mean and median pairwise distances between wsp sequences within the taxonomic group being tested. we then compared the original mean and median values with the resulting pseudoreplicate distribution in a one-tailed test to determine p-values. for this association study we first performed a global analysis resampling all wsp pairwise distances within and between host genera separately and averaging the two sets of values; we then tested the association within individual genera.

RESULTS
three-dimensional structure prediction of wsp: an eight β-barrel omp
wsp was identified as an omp by the pssm profiles approach and by blast search against the hhomp database . the best blast match outside wolbachia was the major outer membrane protein p28- <dig> of ehrlichia muris , and second best match was the surface antigen msp <dig> of ehrlichia canis str. jake . among proteins with characterized three-dimensional structure, hhpred search identified the outer membrane protein nspa from neisseria meningitidis as most resembling wsp . use of a set of divergent wsp sequences also returned the same best hits. based on a concordance of structure prediction between the two programs, wsp of the wmel strain was then modeled based on nspa. results of the modeling showed an eight β-barrel structure with four extracellular loops . although overall identity between wsp and nspa is only 23%, much of the variability between the two proteins is associated to the hypervariable loops, much longer in wsp, while secondary structure and amino acid strings interspacing the hypervariable loops are quite conserved. in general, hypervariable loops are not conserved among predicted eight β-barrel omps or among wsp sequences, signifying that loops do not greatly contribute to the folding and stability of the protein.

the analysis of the hydrophilic and hydrophobic pattern  and prediction of wsp position on the lipid bilayer  confirmed that wsp shows a typical eight b-barrel structure with four hydrophilic extracellular loops and periplasmic turns connected to a β-barrel core containing predominantly the neutral or polar residues valine, alanine, glycine and tyrosine, in accordance to the typical composition of β-barrel proteins  <cit> .

this computationally based structural analysis provided a framework to compare the patterns of protein evolution in different predicted functional domains.

genetic diversity of wsp
based on the  <dig> alleles analyzed, wsp proteins can differ by as much as 43% of their amino acid content and 13% in length . this variability is largely associated to the hvr motifs, contained in the loops, which show little homology and are rich in indels . in particular, hvr <dig> sequences  can differ by up to 42% in length and are thus responsible for a large part of this protein diversity. the number of distinct peptides is similar across the four hvrs, ranging from  <dig> to  <dig> . in contrast, the short regions interspacing hvrs  show an average amino acid homology >90% and no indels, likely due to structural constraints. the crs largely form the β-barrel scaffold in the predicted three-dimensional structure, suggesting strong sequence constraints on this structure.

*whole protein, excluding the first 51- <dig> amino acids of the 5' end and the last  <dig> amino acids of the 3'end.

because wsp sequences show very low homology across the diversity within their individual hvrs, global phylogenetic reconstructions or a distance-related approach for studying wsp evolution is not practical. to circumvent the problem of such extensive variation among proteins and hvrs, we focused on recently diverged proteins that still retain true homology. this approach allowed us to identify recent events of recombination and mutation in evolving proteins.

clusters of closely related wsp
the  <dig> alleles analyzed correspond to  <dig> distinct proteins . among these, the clustering program eburst identified  <dig> complexes of closely related proteins , grouping  <dig> out of the  <dig> proteins . the remaining  <dig> proteins did not show a clear affiliation to any complex and were excluded from this analysis. the major complexes identified were c <dig> to c10; complex c <dig> and c <dig> were the largest, each comprising  <dig> distinct profiles/proteins.

among identified complexes,  <dig> contained at least three distinct but related proteins for which the putative founder protein could be predicted . we note that assignment of the founder genotype by eburst does not take into account the number of allele variants coding for it, nor its genotype frequency across isolates. nevertheless, within each complex, typically the predicted founder was also the protein with the highest number of allele variants, and the one found in the largest host taxonomical range . these lines of evidence further support the accuracy of the founder sequence assignment. we used these complexes and predicted founders to assign directionality to the evolutionary changes and to estimate relative rates of mutation and recombination.

recent evolution of wsp sequences: interplay of mutation and recombination
within complexes, examination of the number of amino acid changes between single hypervariable region variants  and the founder protein indicates that the majority of new hvrs arose by point mutation , and none by indels. this is true for all four hvrs. overall,  <dig> % of the newly evolved proteins arose by point mutations. nevertheless recombination was responsible for generating a substantial amount of the new proteins . among hvrs, hvr <dig> was the least recombinant, with no events detected in our dataset . hvr <dig> showed the highest number of both recombination  and mutation  events, suggesting it is either a hot spot for both processes or variants in hvr <dig> are more often selectively advantageous. it should be noted that we are not observing the actual frequencies of recombination and mutation, but rather those that have persisted long enough to be detected. therefore, these mostly represent variants that are either neutral or selectively advantageous.

in terms of the relative contribution of recombination versus mutation to wsp genetic diversity , it is notable that in half of the recombinant cases detected  recombination introduced more than  <dig> amino acid changes. as a result, although mutation contributes the most to generating new proteins/hvr peptides , the contribution of the two forces to wsp amino acid diversity is almost equal . as a striking example, although the relative contribution of mutation and recombination to hvr <dig> haplotype diversity is approximately 3: <dig> , the relative contribution to hvr <dig> amino acid diversity is 1:  <dig> : 75% of the observed hvr <dig> amino acid diversity is in fact due to recombination.

when analyses were expanded to include subgroups within complexes , the proportion of recombinants increased from  <dig> % to  <dig> %:  <dig> out of  <dig> subgroup profiles were recombinants at one hvr at least, all  <dig> showing more than  <dig> amino acids changes with respect to the ancestral hvr.

a large impact of recombination among more divergent wsp
estimating recombination between complexes was more challenging, as without a common founder genotype we could not assign directionality to recombination events. however, the sharing of identical hvrs among distinct complexes with little similarity at the remaining portion of the protein suggests that recombination is also fairly common among more divergent proteins. among the most common hvrs in the dataset, for example, peptide hvr1- <dig> is found in  <dig> distinct proteins  spanning six wsp complexes ; the average amino acid pairwise divergence among these proteins, excluding hvr <dig>  is  <dig> %, suggestive that hvr1- <dig> was acquired in different wolbachia via recombination. the sharing of the same hvr among otherwise different proteins could also be due to it being an ancestral conserved motif. to investigate this issue, we examined synonymous diversity  of the specific hypervariable motif across all alleles in which it was present and comparing this to that of crs for the same set of alleles . on average pi-syn per hypervariable motif was significantly lower than the average pi-syn values calculated for crs . this argues against the hypothesis that common hvrs found in diverse wsp proteins are ancestral and supports, in several cases, their recent shuffling via recombination.

 <dig> excluding the shared peptide

 <dig> average synonymous diversity  of the hvr, excluding the short strings of flanking crs

 <dig> average pi-syn at the three crs

diversifying selection acting on hvrs
to further investigate whether wsp is target of positive selection during early stages of diversification, we analyzed the selective pressures acting on a) the overall wsp sequence during early divergence, and b) single partitions of the gene over longer evolutionary times. for the first approach we identified the ancestral allele from the sets of mutant alleles within each complex. in all but three cases, the ancestor predicted by tcs corresponded to the protein founder identified by eburst, confirming the above prediction . for the three cases of incongruence, tcs prediction was considered the most reliable because it is based on nucleotide substitutions. we used the ancestral alleles to assign directionality to the nucleotide substitutions and to investigate selection on the alleles. for recently diverged alleles, average dn/ds within complexes ranged from  <dig>  to  <dig> . the null hypothesis of neutral evolution could not be significantly rejected for  <dig> out of  <dig> complexes examined , indicating that recently diverged alleles do not typically experience strong selection. to test for positive selection acting at specific sites, we estimated dn/ds values per codon for  <dig> complexes that each contained at least three sequences. previously identified allele founders were used for rooting the trees input into codeml and for analysis of the mutational pattern during early allele divergence . for the majority of the complexes  the lrts between the two model comparisons were not significant. only five of  <dig> complexes showed evidence of positive selection at a few sites . these positively selected sites mostly fall within hvr motifs and involved alleles coding for double hypervariable region variants  founders and dhvs, suggesting that a signature of positive selection becomes visible with an increase in sequence divergence.

 <dig> p of parsimony of mutational steps >95%

* the corresponding profile did not match eburst prediction

in the second approach, we considered hvrs and crs individually and identified sets of closely related sequences within each of the seven sections of wsp, separately . we then estimated the average dn/ds for each group within single sections and averaged these values across groups. this global analysis of dn/ds showed that the average dn/ds values for each hvr is typically > <dig> , implying diversifying selection. the exception was hvr <dig>  for which the average falls below  <dig>  although several groups of related sequences within hvr <dig> showed dn/ds >> <dig>  in contrast, each cr appears to be under strong purifying selection, with dn/ds<< <dig> . therefore, when comparing sequences among closely related wsps  we find only a weak signature of diversifying selection. however, when comparing similar hvr variants that occur in different wsp proteins, we find a strong signature of selection for amino acid substitutions. this finding suggests that those hvr variants that spread via recombination into different wsp proteins can become targets of diversifying selection.

wsp synonymous variants are evolutionary unstable
we finally tested whether protein genotypes are typically stable over long evolutionary times by investigating the diversity of nucleotide variants coding for a single protein sequence. the rationale is that, if a particular protein genotype is evolutionarily stable over time, it will progressively accumulate synonymous substitutions while discarding amino acid changes. therefore, the occurrence and genetic diversity of synonymous variants should reflect how long a protein type has been around.

the analyses showed that the majority of wsp proteins exist as a single allele variant in our dataset , with only  <dig> % having multiple allele variants . of these proteins, most had only two variants , while six proteins had at least four allele variants. interestingly, each of these six proteins corresponded to the predicted ancestral protein of a complex, confirming their ancestral status. on average wsp proteins are coded by  <dig>  allele variants, with an average synonymous diversity  of  <dig> % . when compared to any of the five mlst gene datasets, wsp showed the lowest number of allele variants per protein variant and values of psyn among them . specifically, the average psyn value among wsp variants is at least half that of any of the mlst genes. such a difference is even more striking considering that the wsp dataset is much larger in terms of allele diversity than any mlst locus dataset.

 <dig> average allele synonymous diversity per protein

analysis of the polymorphic pattern within groups containing three or more allele variants per wsp protein type showed, in all cases, that all polymorphisms are unique to a single allele,  indicating independent evolution through radiation from the ancestral allele.

host population structure of wsp
the  <dig> wsp alleles were found in overall  <dig> wolbachia isolates, spanning all major arthropod host taxa and continents . specifically, the  <dig> were distributed in  <dig> orders,  <dig> families,  <dig> genera and  <dig> species. in terms of variety of wsp alleles collected, a rarefaction curve indicated that we are still far from saturation of global diversity of this gene . fitting the data to a nonlinear function gave a best fit three-parameter curve that is continually increasing, but with and asymptotic rate of increase of approximately  <dig>  new allele variants for every  <dig> additional sequenced strains, signifying that wsp variants in nature are potentially infinite. the allele and protein curves almost perfectly overlap , supporting the above evidence for shorter persistence of synonymous variants due to accelerated microevolution of the protein .

based on the global analysis, there is a strong support for a non-random association of wsp with host genus. the results suggest that wsp as a gene or associated wolbachia strains are preferentially found in similar hosts. specifically, the amino acid pairwise distances among wsp sequences found in the same host genus  are, on average, significantly lower than they would be by random chance . we further explored this association for individual genera focusing on those that were highly represented in our dataset. results indicated that within most of the genera, the wsp sequences were significantly more similar than expected based on a random sampling . among others, a significant association was found within drosophila hosts , the spider mites tetranychus, the wasps trichogramma and pegoscapus, and the mosquitos culex. this is the result of either the presence of a single wsp allele across species within a genus, as in the case of anastrepha, or more often the presence of several wsp alleles sharing high similarity within a genus, as in the case of drosophila, trichogramma, tetranychus and culex.

we also investigated whether there was any evidence for some wsp sequences and thus potential strains to be generalist, while others to have a more restricted range of distribution. we thus looked at the most common wsp alleles in the dataset and their distribution among hosts . among all alleles, wsp- <dig> was the most widespread in the dataset, in terms of number of distinct host species , genera , families  and orders  in which it was found. among the six orders, wsp- <dig> is prevalently found in lepidoptera and hymenoptera. similarly wsp- <dig> occurs in  <dig> distinct species,  <dig> genera,  <dig> families, although it is restricted to two orders, diptera and hymenoptera.

of the  <dig> most common alleles in fig.  <dig>   <dig> are predicted founders of wsp complexes . because of the accelerated evolution of this gene, such a broad distribution of a single allele variant appears to be the result of either a recent wsp lateral transfer coding for a particularly adaptive wsp haplotype or the rapid host-range expansion of a wolbachia strain associated to such wsp sequences, rather than the persistence of an ancestral genotype.

discussion
surface proteins found in intracellular bacteria are extremely interesting candidates for the study of symbiotic interactions, given their location at the interface between the bacteria and the host cell environment. nevertheless functions and molecular processes driving their evolution in invertebrate hosts have been poorly investigated. only recently, studies are providing examples of how adaptive immune response in insects can be linked to specific omp polymorphic variants found in their bacterial symbionts  <cit> , thus unveiling a largely underestimated specificity of the invertebrate immunity  <cit> .

here we investigated the molecular processes driving diversification of the outer membrane protein wsp, one of the most abundant wolbachia proteins found in drosophila eggs. based on protein folding prediction, we have shown that wsp presents a typical eight β-barrel structure spanned through the outer membrane and connected to four extracellular loops. the four loops face on the same side of the barrel, and presumably make contact with the host cytoplasm or the vacuole intermembrane space that envelops wolbachia. the lack of strong compositional and conformational constraints at the loops is consistent with their impressive diversification and putative function as receptors, as shown in several omps  <cit> . on the other hand, the large conservation of the wsp transmembrane core  likely reflects structural constraints, providing the architectural anchor of the protein to the membrane.

microevolution of wsp is largely driven by recombination
wsp shows the most remarkable pattern of recombination seen among the wolbachia proteins studied so far  <cit> . while recombination involving shuffling of hvr motifs across wsp sequences has been well documented and explains the existence of a remarkable repertoire of wsp protein variants, it remains unclear how this motif diversity is generated and whether it is functional. here we attempted to reconstruct the microevolutionary steps in wsp early diversification with the aim of uncovering the major forces at the basis of this variation. the dataset used, which comprises  <dig> alleles found in more than  <dig> isolates spanning a great taxonomical host range, reflects a substantial sampling diversity of wsp and allowed grouping of recently diverged wsp proteins and hvr motifs.

the reconstruction of wsp relationships presents several technical issues that are common to the analysis of other recombinant omps . in particular there are challenges to detecting true homology via straightforward alignments, due to the high level of sequence and length variation, and issues relating to correcting for the recombination bias while attempting to detect and measure selection acting on the molecule  <cit> . indeed, most wsp and other omps-based studies have excluded the hvrs to avoid alignment issues, although this resulted in exclusion of crucial functional domains of the protein. on the other hand, studies that have relied on global alignments have faced extreme alignment problems, making assumptions on true homology difficult or impossible. here we approached these issues using a profile-based method for proteins grouping, which does not base on alignments. this clustering method allowed the identification of several sets of recently diverged wsp proteins and their ancestral genotypes, thus providing statistical power to investigate sequence evolution on relative short-time scales. specifically, by grouping similar haplotypes at hvrs we were able to discriminate between amino acid changes introduced by mutational versus recombinational events and analyze the contribution of the two forces to the actual protein  diversity, and not to allele diversity. results indicated that while mutation in wsp occurred at a higher frequency than recombination, as expected, recombination has had a remarkable impact both on the emergence of novel protein types and on the very rapid increase of genetic diversity among proteins, being responsible alone for about 50% of the total amino acid variation observed among recently diverged proteins. shuffling of wsp portions among more divergent sequences is also frequent, as indicated by the sharing of identical hvrs among otherwise very divergent alleles. such a pattern strongly suggests that recombination is ongoing and largely contributed to both the short- and long-term diversification and evolution of wsp.

how did this wsp mosaicism generate? a similar pattern of diversification is observed in other omps of vertebrate pathogens, such as in neisseria opa proteins  <cit>  and msp <dig> of anaplasma  <cit> . variability in these proteins is typically generated via a process of gene conversion involving modular cassettes of hvr motifs located in pseudogenes within the same genome  <cit> . unlike these proteins, wsp occurs as single copy in the genome, based on all published wolbachia genomes and evidence from pcr amplifications using universal wsp primers, which typically return clear single sequences. we searched for presence of additional single hvr motifs in the published wolbachia genomes from drosophila melanogaster and culex pipiens, but failed to detect any significant homology to full or partial hvr motifs . this suggests that wsp chimeric structure is primarily due to recombination events involving foreign dna rather than a modular exchange of hypervariable regions within a single genome. modes of dna transfer across wolbachia strains remain unknown, although the widespread occurrence of coinfections of a single host clearly provides a suitable arena for dna exchange.

loop diversity is adaptive
the predicted four extracellular loops, which accommodate the hvr motifs, show an extreme plasticity and a mutational pattern that appears largely unpredictable. indels, which represent one of the major sources of diversity among wsp sequences and only occur at hvrs, were absent among recently diverged proteins  but numerous among recombinants, suggesting that they are normally introduced via recombination. among the four loops, l <dig> presents the largest variation, due to both mutation and recombination. there is no apparent restriction in l <dig> size, which can vary by as much as  <dig> amino acids in length. this loop versatility does not disrupt the reading frame, which was always conserved, and thus strongly suggests that this diversification is adaptive. in contrast, l <dig> showed the lowest variation in length  and the lowest dn/ds ratio, which could be due to larger structural constraints or simply to a lower recombination impact. regardless of length plasticity, it is, however, interesting to note that all four loops show similar haplotype diversity , with a potential to accommodate a very large repertoire of distinct peptides. nevertheless, some compositional constraints are expected: 1) at-biased codons are strongly favored, as indicated by the high at content at third  codon positions of wsp  as well as of wolbachia housekeeping genes , and 2) amino acid composition should account for a high percentage of hydrophilic amino acids, given that these sites are extracellularly exposed.

what are the types of selective pressures acting during the early diversification of wsp? alleles appear to be under neutrality during recent divergence, although we cannot exclude statistical limits in detecting positive selection in very closely related sequences. a signature of selection becomes visible with increasing sequence divergence. hvrs and crs are clearly evolving under very different selective pressures, as shown by average dn/ds values typically > <dig> for hvrs, and << <dig> at the crs. although average dn/ds values for some hvrs approximate  <dig>  thus suggesting neutrality, we note that these dn/ds values are averaged across codon sites, as well as across groups of sequences within single hvrs. on the other hand, crs are clear targets of strong purifying selection, likely due to structural constraints.

concordant with a large impact of recombination and diversifying selection, allele diversity per protein type indicates that wsp is a highly unstable protein. wsp shows the lowest number of synonymous variants per protein type and the lowest synonymous diversity when compared to any of the five mlst housekeeping genes, despite the use of a much larger dataset for wsp. this suggests that any single protein haplotype does not persist for long periods of time and that selection for amino acid diversification is likely ongoing. indeed, all nucleotide substitutions observed among synonymous allele variants are unique, with no homoplasic events, supporting their recent and independent divergence. similarly, identical hvrs motifs found in distinct proteins typically show a very low synonymous divergence, which suggests that either they have recombined quite recently, or more likely that hvr synonymous variants are particularly unstable after settling into a new allele and are soon target of nonsynonymous substitutions. this implies that those hvr variants that spread via recombination into different wsp proteins can rapidly become targets of diversifying selection and are thus adaptive to some extent. evidence that omp genetic diversity can play a crucial role in host-symbiont interaction comes from the native symbiont sodalis of the tsetse fly glossina morsitans, where polymorphisms at the exposed loop of the outer membrane protein ompa were shown to mediate host tolerance, determining the host/symbiont type of interaction   <cit> . we speculate that the extensive variation at wsp extracellular loops could also play a similar role in escaping or down-regulating the immune system by means of rapid turnover of exposed amino acids.

population structure of wsp
previous studies have shown that wsp-based relationships are typically incongruent with inferences based on other wolbachia housekeeping genes, suggesting that wsp is often horizontally transferred as a single gene, uncoupled from the rest of the genome  <cit> . while the same or similar wsp alleles can often occur in otherwise very divergent strains, and therefore reconstructions of strain relationships based solely on wsp should not be trusted, on average closely related host taxa tended to harbor strains with significantly closer wsp sequences than observed between strains from more phylogenetically distant hosts. this appears the result of a preferential transfer of the entire wolbachia strain among closely related hosts  rather than wsp alone, as supported by previous studies using mlst data  <cit> . however, because wsp represents the only genetic information for the majority of isolates included in this study, the two scenarios cannot be discriminated at this time.

despite an overall non-random association of wsp with the host genus, few wsp haplotypes  were widespread across a large host taxonomical range. it is noteworthy that wsp- <dig> and  <dig> alleles are typically found in two of the most widespread wolbachia strains identified by mlst , suggesting that wsp distribution in this case largely reflects the distribution of these two wolbachia strains.

CONCLUSIONS
large recombination impact, diversifying selection, lack of strong compositional and structural constraints in wsp extracellular loops, and frequent horizontal gene transfer are signature features of adaptive evolution. these features are typically found in proteins targeted by the adaptive immune system   <cit> ; however, wolbachia infect invertebrates only. there is growing interest in understanding whether and how wolbachia escape or down-regulate the host immune responses so that they can exist within host cells. by combining the structural analysis with the microevolutionary analysis of wsp, we can speculate that the extracellular loops contain peptide motifs that serve to evade or inhibit host detection, aiding in the early settlement and persistence of wolbachia into a new host. biochemical investigations exploring binding properties of wsp are currently ongoing and will help elucidating the role of wsp in the invertebrate hosts.

authors' contributions
lb conceived of the study, carried out the molecular genetic analyses, and drafted the manuscript. jhw participated in the design of the study and helped to draft the manuscript. cad provided the statistical tool for the sequence-host association analysis. jar and jks contributed in the acquisition of data and provided comments to the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
the  <dig> wolbachia isolates studied.

click here for file

 additional file 2
wsp profiles of the  <dig> alleles.

click here for file

 additional file 3
positive selected sites within wsp complexes, as detected by codeml.

click here for file

 additional file 4
dn/ds values estimated for hvrs and crs of wsp. the graph shows differential rates of evolution along the gene. each value was averaged across dn/ds values calculated for groups of related sequences at each of the seven sections of wsp . groups of sequences were defined by 100% matching length and at least 95% of nucleotide identity.

click here for file

 additional file 5
relative frequency of wsp sequences per host country  and taxonomic order . all major arthropod orders and continents are represented. nam: north america; eur: europe; afr: africa; neas: north east asia; cam: central america; sam: south america; aus: australia; pac: pacific ocean islands; seas: south east asia; cas: central asia.

click here for file

 acknowledgements
we would like to thank thomas girke  for the valuable help with bioinformatic tools. this project was funded by the u.s. national science foundation grant ef- <dig> to john h. werren.
