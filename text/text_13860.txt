BACKGROUND
since nicholson et al. introduced the terminology  <cit> , metabonomics evolved into a rapid development period. metabonomics is now widely applied in research areas such as drug toxicology, biomarker discovery, gene function study, functional genomics, natural products research, and molecular pathology etc.  <cit> . metabonomics studies strongly rely on multiple analytical techniques. these techniques afford a wide range of information for metabolic characterization of biological samples  <cit> . based on the acquired spectra, data models can be constructed by statistical analysis, pattern recognition methods, and machine learning methods to explain the dynamic activities of metabolites in organisms. due to the significant quantity and complexity of the spectroscopic data, a major challenge of metabonomics studies is data processing and data interpretation  <cit> . therefore, software tools play a significant role in metabonomics studies, and plenty of efforts have been made on software development  <cit> .

nuclear magnetic resonance  is widely used in metabonomics studies. compared to other analytical techniques, nmr has the advantage of fully quantitative analysis and minimal requirement for sample preparation  <cit> . for the "classical" nmr-based metabonomics approach, after nmr experimental data collection, post-experimental data handling including nmr spectral processing, data pre-processing and data analysis, is critical for obtaining good results. to assist these procedures, several software tools have been released, such as: amix , knowitall , chenomx nmr suite  and hires  <cit> . nmrpipe, a widely used traditional nmr data processing software tool  <cit> , also provide some metabonomics related features now. most of the existing metabonomics tools are commercial products, except hires, which is free licensed to our knowledge. these software tools provide plenty of functions involving spectral processing, comprehensive identification and quantification of metabolites. some of these software tools also provide features for basic data analysis, such as principal component analysis . however, due to the complexity of nmr data and different application purposes, further data analysis procedures, such as filtering out unwanted variations  in a dataset, generating and applying predictive classification or regression models, are usually required. to complete these tasks, researchers usually have to invoke other advanced chemometrics tools or statistical tools. commercial software packages such as matlab , simca-p  and spss  are frequently used by researchers.

in this report, we introduce a new software tool, automics, the first highly integrated open source software designed specifically for metabonomics to our knowledge. automics runs on the microsoft windows platform, and it is developed with visual c++. automics provides features for almost all stages of metabonomics studies, including: nmr spectral processing , data organization, data pre-processing , and data analysis , along with other useful functions such as statistical total correlation spectroscopy method , expression calculator and database resource exploring. automics enables researchers to carry out most of their studies within only one software tool, and thus avoid extensive training on different software tools in order to use them properly. furthermore, with the keen interest of researchers in developing new algorithms for spectral processing, data pre-processing and data analysis, automics can serve as a framework for quickly implementing these new data processing algorithms and other useful features, due to its open source architecture. as it provides basic data structures, data management and low-level functions, automics enables interested developers to focus on kernel algorithmic approaches instead of implementing infrastructure within this framework.

implementation
overview of software system
automics contains modules for almost all stages of post-experimental spectral processing and data handling for nmr-based metabonomics . the features and the workflow of modules are shown in figure  <dig>  a major goal in the design of automics is to provide a ready-to-use tool for metabonomics researchers and those who are interested in metabonomics from other fields. batch spectral processing features, supported by a set of automatic algorithms, have been implemented in order to accelerate the processing procedures and to achieve high efficiency. to facilitate usability, we have developed a user-friendly graphical interface in automics. furthermore, to ensure a wide adaptability to different metabonomics applications and to strengthen its data analysis ability, we have integrated nine different data analysis methods into the data analysis module of automics.

the main interface and some of the feature windows of automics are shown in figure  <dig>  automics works in the following steps: nmr spectral processing can be carried out manually in the spectral processing window  or automatically using the high throughput custom wizard module. after spectral processing, a data matrix  is produced by bucket/binning module, and it can be then saved into a text file or exported to a worksheet directly . based on the worksheet, data pre-processing procedures can be carried out. finally, data analysis methods are applied to the pre-processed data. the results of analysis and parameters of data models, such as scores and loadings of principal component analysis  or partial lease squares  models, can be plotted . in addition, a general plot tool can be launched for visualizing vectors in a data matrix . in order to give the software a good expandability for the future development, automics was designed with client/server architecture. it is subdivided into several layers. at the very bottom are the foundation classes that implement low-level functions and data structures. the kernel modules that implement data processing algorithms and spectral visualization are built on the low-level dynamic link libraries .

spectra format conversion
automics takes bruker  format raw fids and xwin-nmr processed spectra by default. for nmr data collected on spectrometers from other venders, fid format conversion should be carried out with a conversion module. before conversion, a meta-data file is first created in a format definition module, which contains parameters for the source format: fid filename, acquisition parameter filename, spectral width , chemical shift of spectral center , observe frequency, optional fid file header size, byte order  and variable type of data points in computer memory . based on these parameters, automics can convert raw fids of a variety of existing nmr fid formats, such as those from varian  and jeol , to bruker fid data format and rewrite them in bruker style directories.

manual spectral processing
although high throughput automatic spectral processing is one of the major goals and an important feature of automics, we believe a powerful and convenient manual processing module is still necessary. for situations when the automatic method does not work well , the manual method may be an effective way to correct spectra.

automics provides an easy to use manual spectral processing module. for spectral visualization, features such as spectral editing, peak labeling, peak information browsing, moving and zooming, are supported. to change the display properties of the visualized spectrum, a dialog can be used to set properties such as line color, line width, line style and background color. for spectral processing, floating tool bars can be used to continuously adjust zero-order and first-order phases for the interactive phase correction, or adjust coefficients of a selected fitting function  for the interactive baseline correction. other commonly used features, such as referencing, peak picking and spectral derivative, are also supported.

high throughput automatic spectral processing
1d nmr spectra can be automatically processed in batch mode in five steps: fast fourier transform , phase correction , baseline correction, peak alignment , and bucket/binning . these features are implemented in five dialogs. they can be launched either individually or through a step-by-step custom wizard from popup menu. the names of selected spectra are shown in a list control, allowing multiple selections.

fast fourier transform
fft converts nmr signals from time domain to frequency domain. this module can perform both complex fft and real fft. in addition, dc offset, zero filling, window function with a specific line broadening factor and removal of a potential digital filter imposed on fid  are also carried out in this module.

automatic phase correction
traditionally, phase correction is generally accomplished manually by trial and error until the real part of the fourier transformed spectrum appears globally as a pure nmr absorption spectrum. the corrected spectrum is dependent on one's experience. several automatic methods have been proposed to estimate zero-order and first-order phases  <cit> . the global methods, such as maximization of the spectrum integral, minimization of the spectrum entropy  <cit> , and a recently patented method by bruker , require extensively iterative computing and are time consuming. other methods, such as methods based on dispersion versus absorption relationship   <cit> , method based on symmetrizing lines  <cit>  and method based on phase angle measurement from peak areas   <cit> , share the common feature that they determine zero-order and first-order phases by linear regression of a set of selected peaks. for these methods, it is critical to find a set of appropriate isolated individual peaks. however, in metabonomics studies, nmr signals from hundreds of metabolites in the samples often cause severe peak overlap, which may affect the accuracy of the phase correction.

besides two global methods  implemented in automics, we have introduced another easier to implement method for automatic phase correction. this method does not require detection of isolated individual peaks and is efficient for processing large quantity of similar spectra in metabonomics studies. considering a 1d 1h nmr spectrum with good baseline, the regions near the two ends of the spectrum are normally free of signals. these regions usually belong to the baseline, and they should have nearly horizontal straight line shape after correction. based on this principle, enough information can be acquired to calculate the zero-order  and the first-order phases . this method consists of the following steps:

 define two pairs of small regions ti and tj, tk and tl with a certain window length l . ti and tj belong to the higher frequency baseline region of the spectrum, and tkand tl are in the lower frequency baseline region of the spectrum. sum up each region and get their real parts  and imaginary parts ;

 determine two phase errors  at positions of / <dig> and / <dig>  because these four regions all belong to the baseline, and the distance between two regions of each pair is very small, the two regions of each pair should have approximately the same phase errors . therefore, ti and tj should have nearly the same intensity after correction, so do tk and tl. the two phase errors can be thus calculated with the following equations:

  ricos+iisin = rjcos+ijsin 

  rkcos+iksin = r1cos+i1sin 

therefore, the phase errors can be expressed as:

  θ <dig> = arctan/)+mπ 

  θ <dig> = arctan/)+nπ 

 calculate the zero-order and first-order phases using the follow equations:

  θ0=phc0+i+j2nphc <dig> 

  θ1=phc0+k+l2nphc <dig> 

 correct the spectrum with the determined phc <dig> and phc <dig> 

automatic baseline correction
current version of automics provides two methods for automatic baseline correction: linear fitting and non-parametric recognition. linear fitting method uses pre-defined positions of the spectrum to calculate coefficients of a linear function, which are then used to construct a baseline. our experience has shown that this method works well in most cases, despite its simplicity.

a non-parametric method was implemented with a variant of sergey's algorithm  <cit> . it includes two steps. first is baseline recognition. to decide whether a data point belongs to the baseline, the first derivative of the spectrum is calculated, which can be used to distinguish sharp peaks from hump regions in the spectrum and helps to recognize baseline regions. a data point is considered to be on the baseline if the absolute intensity of the corresponding point in the derivative spectrum is below a pre-defined noise threshold. the second step is to construct a smoothed baseline from those recognized data points using a moving convolution window. then the baseline is subtracted from original spectrum, resulting in baseline corrected spectrum.

peak alignment
frequency shifts due to unstable experimental and instrumental conditions are one of the main sources of unwanted variations for further data analysis. these variations obscure the process of pattern discovery and impede the performance of data analysis. peak alignment is an essential step to remove effects of such variations from the spectral datasets. spectral referencing, which sets the inner reference peak  of each spectrum to  <dig> ppm, can be regarded as a simple global method for peak alignment. this method shifts the entire spectrum based on the same reference peak position. thus, all the spectra with global peak misalignments are well aligned. however, it is not sufficient for correcting individual peak misalignments in spectra, such as those from urine samples with variant solution conditions. several methods have been proposed to solve this problem. a genetic algorithm can align peaks in automatically selected segments of each spectrum to the corresponding peaks in a pre-selected reference spectrum  <cit> . a principal component analysis method can identify and adjust individual peak variations through examining the correlation between peak-derivative shapes and the second or higher order principal components   <cit> . as these two methods deal with every data points in the interested regions, both of them are time consuming. automics implements a fuzzy wrapping method  <cit> . this method detects the maximal position of peaks in each spectrum and aligns them to a reference spectrum using their similarity determined using a fuzzy gaussian function. it is more efficient than the above mentioned two approaches due to the reduced data size of processed peaks vector.

bucket/binning and normalization
bucket/binning is a commonly used technique for digitizing a spectrum into a row vector. it has the advantages of minimizing misalignment effects and reducing data dimensionality  for further analysis. however, it also leads to a lower data resolution. an extreme case of bucket/binning is that each bin contains a single data point, thus it has a full resolution. however, the quality of data generated in this way highly relies on accurate peak alignment, and this method may bear heavy computing burden such as calculating element-based leave-one-out cross validation.

automics provides both full resolution  bucket/binning and traditional bucket/binning with equal bin width options . for the second option, we implement a method to determine an appropriate bin width for balancing resolution and dimensionality. first, peak widths for all identified peaks of each spectrum are determined. then, the average peak width of the "sharper peaks" half is used as bin size. the peak finding and peak width determining are carried out as following:

 noise filtering: use a savitsky-golay filtering window to smooth the spectrum by removing high frequency noise with a pre-defined noise threshold.

 peak finding: among the data points whose intensities are above the threshold, find all maximal points. a maximal point is defined as a point with a number of adjacent consecutive data points on both sides that all have smaller intensities than this point; meanwhile, the intensities of these points on each side are in descending order.

 peak width determining: for each side of a maximal point, the total number of data points whose intensities are in descending order is counted. the sum of the two numbers for both sides is used as peak width for this peak.

in addition to the above mentioned two methods, an intelligent adaptive binning method was also implemented in automics  <cit> . this method recursively identifies bin edges in existing bins and requires minimal user input, and it can largely circumvents problems such as the loss of information due to low resolution, the occurrence of artifacts caused by frequency shifts and the presence of noise variables. generally, normalization of each row vector produced from bucket/binning is required before further data analysis. four normalization methods are available in automics: normalizing against the total spectral area, normalizing against the maximum peak area, normalizing against the inner reference peak area, and normalizing against a specific peak area. after bucket/binning and normalization, the produced data matrix can be saved into a comma-delimited text file, or can be exported to a worksheet directly for further analysis in automics.

data organization and data pre-processing
a worksheet module was developed in automics for data organization. data pre-processing and data analysis procedures are all based on data in the active worksheet. automics can import/export data files in text format or microsoft excel spreadsheet format. commonly used editing functions and some basic statistical analysis  are supported.

to remove undesirable systematic variations in the spectroscopic data before data analysis, four commonly used data filter methods were integrated into automics: multiplicative signal correction   <cit> , standard normal variate transform   <cit> , direct orthogonal signal correction   <cit>  and orthogonal projections to latent structures   <cit> . dosc is a variant algorithm of the well-known orthogonal signal correction   <cit> . it is a powerful method for removing structured variation which is orthogonal to the response variables , from the observation variables . however, in some cases, not all the structured y-orthogonal variations need to be removed. only those irrelevant variations that create problems for pls  should be removed. o-pls is a generic hybrid osc+pls method which takes the objective of the pls regression model into account and removes y-orthogonal variations when necessary.

data analysis module
after data pre-processing, data analysis modules can be invoked to analyze the data and build data models. automics provides nine different pattern recognition methods for data analysis. these methods include feature  selection method   <cit> ), data reduction method , linear discriminant analysis   <cit> , uncorrelated linear discriminant analysis   <cit> ), unsupervised clustering method   <cit> ), and supervised regression and classification methods   <cit> , k nearest neighbor classification   <cit> , soft independent modeling of class analogy   <cit>  and support vector machine   <cit> ).

fc
fisher's criterion method is a feature selection technique. the general purpose of the feature selection is to find significant features  from the original data space in order to produce a better prediction result. irrelevant features that introduce noises should be eliminated. the importance of an individual feature for discriminating different groups in the training dataset is expressed by the fisher's ratio, which is the ratio of between-class variance to within-class variance for the training group. a feature with larger fisher's ratio means that it is more important for classification. users can select a number of features with the largest fisher's ratios for further analysis.

pca and pls
these are two commonly used multivariate analysis techniques in metabonomics studies. the main purpose of pca is to eliminate the collinear problem and then reduce the dimensionality of the original feature  space. it is an unsupervised method used to reveal the internal structure of datasets in an unbiased way. pls is a supervised method for regression. the overall goal of pls is to maximize the covariance between the predictor space and the response space, and then use the predictor matrix to predict responses in the population. with a cutoff for predicted responses, pls regression can be used for classification and discrimination analysis . pca and pls reveal the variable contribution for the separation between different groups by loadings or regression coefficients.

lda and ulda
lda is a well-known technique for the dimension reduction and the feature extraction closely related to pca. differing from pca, lda is a supervised method. it aims to find an optimal transformation that maps the data into a lower dimensional space with minimized within-class distance and maximized between-class distance, thus achieving the best separation between two or more classes of observations. a variant algorithm, ulda, was proposed for solving singular problem limitation in lda. ulda employs the generalized singular value decomposition method to handle singular data. the advantage of this method is that features in the transformed space are uncorrelated, which makes it attractive for the feature dimension reduction. the work on plasma fatty acid metabolic profiling analysis by yi et al.  <cit>  showed that a better discrimination is achieved using ulda feature reduction comparing with that using pca and pls data reduction methods, which suggests that ulda is a good complement for commonly used pca and pls methods.

k-mean
k-mean is an unsupervised method for grouping samples into a fixed number  of groups in a dataset by their similarity. the similarity is defined by the distance. several distance measures can be used in k-mean method, such as euclidean distance, manhattan distance, or correlation coefficient. k-mean method implemented in automics can be used as an initial step to quickly detect outliers and assign class indicators of observations  in metabonomics studies.

knn and simca
knn and simca are two supervised methods for classification using data similarity. in knn method, the test dataset is classified by a majority vote of its neighbors, with a sample being assigned to the class most common amongst its k nearest neighbors. the k value is a positive integer, typically small . if k =  <dig>  then the sample is simply assigned to the class of its nearest neighbor . simca works as following: pca is first performed on each independent group in the dataset, and a sufficient number of principal components are retained to account for most of the variations within each class. hence, a principal component model is used to represent each class in the dataset. finally, samples in the test dataset are classified to one of the established models on the basis of their best fit to the respective model.

svm
it was integrated into automics as another powerful classification tool. svm is based on rigorous statistical learning theory, and it has been used in a wide range of problems for the classification of datasets such as proteomics data and genomics data. svm takes a set of features  as input and outputs a classification or a regression vector. it maps input vectors into a higher dimensional feature space using a kernel function. the training procedure leads to the finding of a hyper plane in the feature space, which optimally separates training vectors of two classes. then, it finds several support vectors that contribute most for the classification. when a new feature vector  is input, its class membership is predicted on the basis of which side of the plane it maps.

before invoking data analysis methods, new datasets must be created based on the data in the active worksheet by a dialog interface . this dialog is used to construct training dataset, testing dataset and define variables in them . four options, central scaling, auto scaling , pareto scaling and no scaling, are available for users to scale variables .

in addition to the implementation of these data analysis algorithms, automics provides a convenient way to visualize parameters of data models in 2d scatter plot, line plot, or column plot. these parameters usually include scores, loading, explained variances , residual matrix, hotelling's t <dig> etc. plot properties  can be conveniently changed. these features in automics are comparable to those in commercial statistics software.

the performance of many pattern recognition methods are related to the inner data relationship and the data structure. automics is flexible enough to combine different data pre-processing methods  with different classification methods, and produce different classification methods such as fc/knn, ulda/knn, fc/pls-da, o-pls/pls, and fc/dosc/svm etc., to facilitate different metabonomics applications and achieve better results.

RESULTS
automatic spectral processing
automics provides an efficient way for processing a large number of nmr spectra in batch mode by a series of automatic methods, and produces reasonably well corrected spectra. figure  <dig> shows an example for displaying multiple processed spectra in automics. for metabonomics studies, spectral processing results may have a significant impact on data analysis. the automatic spectral processing in automics has the advantage that all nmr spectra are processed under the same criteria. this will potentially reduce systematic error due to the inconsistency of manual operations.

for several different spectral datasets, the new automatic phase correction algorithm we proposed worked well. we have also examined this method on a set of spectra that contained significant zero-order and first-order phase distortions ranging from 20° to 300°, and we achieved less than 8° errors for the two phase values . as our method does not use peaks for determining phases, our method has no weaknesses due to peak shape, digitization rate or peak overlap. the signal-to-noise ratio of a spectrum has little influence on phase determination, owing to our summation procedure. in practice, the baseline regions of a spectrum selected for determining phase errors are not always in a horizontal straight line, sometimes they could be a little tilted and have small slope angles. however, the angles can be determined from a corrected reference spectrum and then be applied to uncorrected spectra as a prior knowledge for compensation. the main drawback of this method is that it relies on a not severely distorted baseline. nevertheless, the fact that a spectrum can not be phased correctly due to severe baseline problem may indicate an abnormal situation in the nmr experiment, which should not happen very frequently. therefore, this drawback will not be a significant problem in metabonomics studies.

a metabonomics application using automics
we have tested automics for several application datasets. here, with an example on the study of metabolic profile in type  <dig> diabetes, we provide an overview of the validity and the ability of automics.

sample preparation
human blood samples were collected from  <dig> healthy adults and  <dig> patients with type  <dig> diabetes mellitus from no.  <dig> hospital in beijing. the ages of patients were between  <dig> and  <dig> years . all the samples were collected under the same clinical condition before breakfast. the plasma samples were first allowed to clot in plastic tubes for about  <dig> hour at room temperature, and then aliquots of serum were collected and stored at -80°c until assayed. right before the nmr experiment, each serum sample  was diluted with  <dig> μl of  <dig> mm pbs buffer , along with addition of  <dig> μl d2o and  <dig> μl dss.

nmr experiment
all the 1d 1h nmr spectra were collected at a temperature of  <dig> k on a bruker avance  <dig> mhz nmr spectrometer using bruker pulse sequence noesy presat, which can be depicted as: rd-90°-t1-90°-tm-90°-acquisition. rd represents a relaxation delay of  <dig>  s during which the water resonance is selectively irradiated, and t <dig> is a fixed time interval. during the mixing time tm , the water resonance is irradiated for a second time. for each sample,  <dig> scans were collected into  <dig> k data points with a spectral width of  <dig>  hz.

spectral processing
raw nmr fids from  <dig> healthy samples and  <dig> diabetic patient samples were processed in automics using automatic spectral processing module, including fast fourier transform , phase correction , baseline correction  and peak alignment . these automatic spectral processing procedures produced a good result  and no further manual correction was carried out. all the processed spectra were data reduced to  <dig> segments between  <dig>  ppm and  <dig>  ppm using bucket/binning module with a bin width of  <dig>  ppm. due to the strong solvent signal, the spectral region between  <dig>  ppm and  <dig>  ppm was excluded.

pls analysis together with dosc and o-pls
to determine whether it is possible to distinguish healthy and diabetic samples based on the nmr spectra, we carried out pca and pls analysis using data analysis module on the mean-centered data. pca analysis showed that the two groups are severely overlapped. the pls score plot of the second and the third principal components  show that some clustering is evident even though there is overlap between the two groups . the regions of the nmr spectrum that most strongly influence the separation between the two groups can be indicated by the regression coefficients. however, the regression coefficients of this model  can not give an exact explanation due to overlap. to improve the performance of the data analysis and filter out unwanted orthogonal variations, dosc or o-pls was first applied to the dataset before pls analysis. after application of dosc  or o-pls , the healthy group  and the diabetic group  were well separated by the first pls component . regression coefficients indicate the regions that most strongly influence the separation between the two groups . each column of the regression coefficient plots represents a spectral region covering  <dig>  ppm. notice that we have defined a y class indicator vector as response variables before analysis , positive regression coefficients indicate that there are relatively higher concentrations of metabolites present in type  <dig> diabetes, while negative values indicate relatively lower concentration. from regression coefficients , it is found that signals significant to the separation mainly lie around  <dig>  ppm,  <dig>  ppm,  <dig>  ppm,  <dig>  ppm,  <dig>  ppm, a small region near  <dig>  ppm,  <dig>  ppm and  <dig>  ppm. these signals can be tentatively assigned according to previous reports  <cit> . signals near  <dig>  and  <dig>  ppm are mainly assigned to ch <dig> groups from fatty acid side chains of lipids, in particular ldl and vldl; signals at  <dig>  and  <dig>  ppm are assigned to n groups from fatty acid side chains of lipids ; the signal at  <dig>  ppm is assigned to lactate; the small region near  <dig>  ppm should contain a set of signals from ch groups of glucose, sugars, glycerol and amino acids; the signals around  <dig>  and  <dig>  ppm are from ch groups of α-glucose and lipid, respectively. as this was a demo study, we did not investigate other signals. most of the above mentioned regions have been assigned to glucose, lactate and lipids. they have positive regression coefficients, indicating that concentrations of these metabolites are higher in the diabetic group than those in the healthy group . diabetes mellitus is a prevalent metabolic disorder disease characterized by elevated blood glucose. it has been demonstrated that the diabetes mellitus is associated with metabolism disorder of lipids and fatty acids  <cit> . our results are consistent with available knowledge about diabetes mellitus from previous studies and clinical information of the samples.

in figure  <dig>  scores and regression coefficients of pls models are shown in 2d scatter plots and column plots. as researchers usually need to identify corresponding peaks of loadings or regression coefficients, automics supports overlay display of regression coefficients and the corresponding spectrum in a spectral window . researchers can also take advantage of spectral visualization features, such as zooming and peak information exploring, to investigate loadings or regression coefficients conveniently.

comparison of different classification methods in automics
classification is an important objective in some metabonomics applications. pls-da, knn, simca and svm implemented in automics were applied to the dataset for predicting the class membership of unknown samples. approximately two-thirds of the samples  were randomly selected to build a training model. the prediction ability of a model was calculated by cross validation. after training, the constructed model was then used to determine the class membership of the remaining one-third samples . we have used different combinations of data pro-processing methods and classification methods to compare their prediction abilities. for example, fc/dosc/svm means fisher's criterion is first used to select an appropriate number of features from the original feature space; then direct orthogonal signal correction is applied to the selected features to filter out unwanted variations; finally, svm is applied to the corrected data for classification. the results of different combinations are shown in table  <dig> 

prediction results were from different classification methods . recognition rate is the correctly classified rate in the training set. prediction rate is the correctly classified rate in the testing set. sensitivity is the rate of true positive classified as positive. specificity is the rate of true negative classified as negative .

without data pre-processing, the number of correctly classified samples in the testing set  decreases in the following order: svm gives the best result ; simca and pls-da show similar results ; and knn produces the worst result . with data pre-processing methods  applied to the dataset, all the classifiers show better prediction performance. for example, dosc/pls-da gives an improved prediction rate of  <dig> %; o-pls/pls-da, dosc/svm and fc/svm also show improved prediction rates of  <dig> %,  <dig> % and  <dig> %, respectively. these demonstrate the general ability of dosc and o-pls for removing noise from data set. as shown in table  <dig>  fc/dosc/svm has the best prediction result , indicating that combining different data pre-processing techniques can improve the prediction ability. although o-pls together with pls analysis has advantages such as improved interpretability and informative orthogonal variations explain  <cit> , it shows nearly the same prediction rate as dosc processed pls model on this dataset.

whether using data pre-processing or not, svm gives the best prediction result compared with pls-da, knn and simca on this dataset. the superiority of svm in prediction suggests that not only well known collinear relationships, but also nonlinear relationships may exist in this dataset. to our knowledge, there are very few applications of svm in metabonomics studies. the better performance of svm on our dataset is consistent with the result from bullinger et al  <cit> . in their study, svm also showed a better performance for prediction of breast cancer. although the classification ability of different classifiers is related to inner data structure of the dataset, we believe svm is a competitive classifier in metabonomics studies and will be widely used in this field. in this example, simca and knn did not show better performance than the commonly used pls-da classifier, presumably due to that they put a focus on the similarity within a class. in addition, uv scaling on the data has better prediction ability than mean-centered scaling in pls-da model .

other related aspects and the future of automics
currently, automics provides a module for conveniently exploring database resources. this function is helpful when researchers want to explore the structure and chemical shift information of metabolites from available database such as madison metabolomics consortium database   <cit>  and the human metabolome database   <cit> . statistical total correlation spectroscopy  analysis method has also been implemented in automics. this method takes advantage of the multi co-linearity of the intensity variables in a set of 1d 1h spectra to generate a correlation matrix about the intensity correlations among various peaks across the whole dataset  <cit> . 2d contour plot implemented in automics can be used to display and analyze the correlation matrix as a pseudo 2d nmr spectrum.

there is still plenty of room for improving the functionality and usability of automics. for example, some commonly used data analysis approaches such as o2-pls will be implemented in the near future. a more user-friendly interface is also in our plan for the future development. as automics was designed with a free open architecture, interested researchers are encouraged to implement new algorithms and extend the software based on the existing infrastructure. we also expect that applications of automics by metabonomics researchers will help us to get valuable feedbacks and suggestions for improving the platform.

CONCLUSIONS
in this paper, we introduced automics, the first open source software tool with highly integrated modules specifically designed for nmr-based metabonomics applications. this tool covers almost all stages of the nmr-based metabonomics study workflow. the spectral processing modules in automics are efficient and convenient for either processing a large number of spectra or processing single spectrum offline without commercial software. in addition, features such as data organization, data pre-processing and a wide range of data analysis techniques for multivariate data analysis, classification and regression have been implemented in automics. some of the useful data analysis methods in automics  are not available in widely used commercial software tools, such as simca-p . automics enables researchers to complete spectral processing and data analysis in one software package. moreover, automics could be applied to metabonomics data generated from other analytical techniques , owing to its flexible and independent module designs. more details about the usage of automics can be found in the well-documented html help .

availability and requirements
project name: automics

project home page: 

operating system: windows 2000/nt/xp/2003

programming language: visual c++

license: open source under gnu license

abbreviations
nmr: nuclear magnetic resonance; msc: multiplicative signal correction; snv: standard normal variate transform; dosc: direct orthogonal signal correction; o-pls: orthogonal projection to latent structures; fc: fisher's criterion; pca: principal component analysis; lda: linear discriminant analysis; ulda: uncorrelated linear discriminant analysis; pls: partial least squared; knn: k nearest neighbors; simca: soft independent modeling of class analogy; svm: support vector machine; stocsy: statistical total correlation spectroscopy.

authors' contributions
bx, cwj and tw suggested desired features and algorithmic approaches. tw carried out the designing and implementation. ks, qyc, yfr, ymm, ljq and jh provided samples or experimental data and helped in the evaluation of the package. the online documentation and the manuscript were written by tw with inputs from all co-authors. all authors have read and approved the final manuscript.

supplementary material
additional file 1
software package of automics. this compressed file contains executable installation package, source code package, html help file, test dataset and readme file of automics. the latest version is available at automics homepage .

click here for file

 acknowledgements
all nmr experiments were carried out at the beijing nuclear magnetic resonance center , peking university. this research was supported by grant 2009cb <dig> from  <dig> program of china and grant  <dig> from nsfc to bx.
