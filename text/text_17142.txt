BACKGROUND
the physical interactions between proteins and other molecules in protein crystal structures provide crucial insights into protein function. it is precisely these structures that enable researchers to study interactions in atomic detail, and find out, for example, how a specific mutation in a protein affects its function, or how a few atom modifications in a small molecule might lead to a more effective drug. with the large number of available crystal structures , it is of great importance to improve the tools available for study of these interactions.

moreover, a powerful method of inference can be used to predict function and interactions. it is based on the observation that homologous proteins have similar functions and often interact with their small molecules in a similar manner. thus it is possible to infer protein-small molecule interactions even if there are no crystal structures available for a particular protein of interest, as long as there are structures of sufficiently close homologs. recent estimates suggest that the majority of entrez protein sequences have homologs with a known structure  <cit> , thereby providing a reasonable chance to find relevant interactions via structures for protein sequences.

homology inference methods, although powerful, have certain limitations. common descent does not necessarily imply similarity in function or interactions; and annotations transferred from one protein to a homolog may result in incorrect functional or interolog assignment at larger evolutionary distances  <cit> . to verify and guide annotations, it is often essential to ensure close evolutionary relationships, and at the same time characterize the details of interactions in terms of binding site similarity. current binding site prediction methods can be subdivided into several major categories: those which use evolutionary conservation of binding site motifs  <cit> , those which use information about a structure of a complex  <cit> , and docking and other methods  <cit> . structure-based methods use detailed knowledge of the protein structure to identify binding sites on the basis of the physico-chemical properties of individual residues, their electrostatic contribution, and their location in the 3d structure  <cit> .

a number of methods and servers have been developed for predicting protein function by identifying similarities in sequence and structural features of binding pockets in homologous proteins, or evolutionary constraints on residues  <cit> , or by using threading and other approaches  <cit> . the main goal of these methods is to provide functional annotation for proteins out to the most distant homology relationships. findsite  <cit> , for example, looks for structural templates with bound small molecules for a query protein using threading. the templates are superimposed and the centers of mass of the bound small molecules are clustered to annotate putative binding sites on the query. threading based methods, although capable of recognizing distant functional relations, are limited by the complexity of model building and low reliability of function transfer associated with distant homology  <cit> .

firestar  <cit>  predicts functionally important residues based on psi-blast  <cit>  alignments between the query sequence and structures with functional information derived from the pdb and the catalytic site atlas  <cit> . phunctioner  <cit>  uses sequence profiles based on clustered sequences with matching go  <cit>  terms; potential binding sites are detected from sequence conservation. this method is capable of inferring the location of highly conserved small molecule binding sites, but might be questionable if the conservation of sites is caused by factors other than binding.

transitive annotation of small molecule binding sites is also possible by detection of functional domains in the query protein sequence through blast heuristics and mapping the functionally important residues and/or features from the domain family members  <cit> .

there are a few other methods that directly detect small molecule binding sites via geometric analysis of protein structures. these methods include ligsitecsc  <cit> , cast  <cit> , pass  <cit> , surfnet  <cit> , screen  <cit> , and concavity  <cit> . all of these algorithms attempt to identify solvent-accessible pockets formed by surface residues on the protein, and to rank those pockets , in order to assign the most highly ranked pockets as the predicted/putative small molecule binding sites. ligsitecsc, surfnet, and concavity use a more complex ranking function that takes into account residue conservation of binding site residues. these geometric methods are reasonably accurate, achieving success rates of 60-70% in correctly identifying small molecule binding sites. in their evaluation of ligsitecsc, the authors showed that their algorithm outperformed the other three methods on a test set of  <dig> structures  <cit> . the screen method identifies binding sites geometrically, and also computes feature vectors that are used by machine learning techniques. screen is included in a suite of powerful modeling tools for functional annotation  <cit> 

recently we have developed a new database and method called "ibis"  which enables researchers to conveniently study biomolecular interactions that have been observed in protein structures and through inference by homology to formulate predictions/hypotheses for biomolecular interactions, even if the data for specific biomolecules is not available. therefore, ibis can be considered a resource for functional annotation of proteins that have relevant homologs in the pdb  <cit> . an input protein sequence may or may not have a structure itself; if not, it is assigned to the most closely related structure using blast. ibis can identify and infer a protein's interaction partners together with the locations of the corresponding binding sites on the protein query. it provides annotations of binding sites for proteins, small molecules , nucleic acids, peptides and ions. in this paper we describe the method used in ibis to annotate protein-small molecule interactions. to ensure biological relevance of binding sites, ibis clusters similar binding sites found in homologous proteins based on conservation of sequence and structure of the binding site residues. binding sites which appear evolutionarily conserved among non-redundant sets of homologous proteins are given higher priority. additionally, binding site clusters are validated by comparing them with available binding site annotations from a manually curated subset of the cdd database  <cit> , and sites with non-biological small molecules are excluded. after binding sites are clustered, position specific score matrices  are constructed from the corresponding binding site alignments. together with other measures, the pssms are subsequently used to rank binding sites to assess how well they match the query, and to gauge the biological relevance of binding sites with respect to the query.

a critical difference between our method and others is that ibis pays particular attention to ensuring the biological relevance of binding sites, and homology between the unknown query sequence and the known structures of protein complexes. our method might miss some remote similarities which could be detectable, for example by findsite, but in exchange ibis's top ranked annotations should be considered highly reliable. unlike other methods, ibis does not filter out similar structures to speed up the search process, but accounts for all structures so that interesting small molecule binding complexes are easily accessible. our method derives the actual binding sites from observed structures, and groups them to account for variations in the binding site residues due to differences in small molecule size and conformations. this is essential for proteins which are important drug targets, as they have often been co-crystallized with a great variety of inhibitors. the clustering  of binding sites by similarity is very important because it identifies the distinct binding modes and allows for an easier interpretation of the results, despite the great growth in the amount of structure data over the last several years. as we have shown, it is possible to do the clustering automatically and in a biologically meaningful way.

RESULTS
annotation of protein chains with observed and inferred binding sites
there are about  <dig> pdb entries with observed small molecule binding sites and about  <dig> protein chains. the total number of observed small molecule binding sites is about  <dig> and approximately  <dig> of these represent biologically relevant small molecules. small molecule binding is a specific feature that plays a crucial role in the protein function. about 64% of protein chains in the pdb bind to a single small molecule and 95% bind to no more than four small molecules . likewise, the binding site pockets are rather small compared to the size of their functional domains. the binding sites are usually less than  <dig> residues and 55% of the binding sites in the current study are smaller than  <dig> residues . our algorithm inferred binding sites for  <dig> protein chains and the overall average number of binding site clusters inferred per chain is  <dig>   whereas the average number of biologically relevant binding site clusters inferred per chain is about  <dig> 

one of the important features of this method is that it does not exclude redundant sequences bound to different small molecules. for example, to account for all specific interactions of various drugs targeting the kinase atp binding site, it is imperative to consider all the protein sequences even if they are identical.

we validated the ibis method by comparing the obtained annotations to the manually curated cdd annotations and to other different methods which use geometry of binding pockets and/or sequence conservation of binding sites. it should be mentioned that since the ibis method is based on different types of structural evidence, the notion of false positives might not be valid in many cases.

validation of the ibis method using the conserved domain database
to test the ability of our method to successfully infer the biologically relevant binding sites, a validation procedure was implemented using the manually curated conserved domain database   <cit>  alignments and the functional features recorded in it as a standard of truth. manually curated functional site annotations in cdd have been extracted from the published literature or derived from manual interpretation of individual three-dimensional structures. altogether 49% of the proteins with observed small molecule binding sites have cdd small molecule binding site conserved annotations whereas over 55% of the proteins with inferred binding sites have at least one site overlapping with cdd annotated binding site annotation.

in our analysis we used the cdd release  <dig>  containing  <dig> protein chains. we chose representative protein chains purged at the 25% sequence identity level. in this jackknifing experiment, the query protein and its identical homologs are omitted from clustering. altogether  <dig> representative chains had at least one structurally similar non-identical homolog which had observed protein-small molecule binding sites. figure 2a shows how well our method can retrieve the cdd annotated binding sites at the top ranks by calculating the fraction of true positives  or percentage of correctly annotated binding sites . for  <dig> of these there was only one inferred binding site  detected, and by default these will always be ranked first. there remain  <dig> examples which have at least two ibis binding sites,  <dig>  of these were ranked first, and  <dig> were ranked second, so that  <dig>  were ranked either first or second .

since there are a number of proteins which do not have cdd annotations, ibis inferred binding sites may be biologically relevant in these cases.

validation of ranking scheme: discriminating between biological and non-biological chemicals
we used the same set of protein queries  to evaluate our method using structures which contained both biological and non-biological small molecules . our goal is to assess how well our ranking scheme distinguishes between the two groups of binding sites: those containing biological versus non-biological small molecules. if all the bound small molecules in an inferred binding site are non-biological, it is deemed as non-biological. to address this, we applied a linear discriminant analysis which constructs a discriminant function that divides the parameter space into regions so as to separate the groups as distinctly as possible. the method computes the posterior probability of group membership for each observation, and assigns the observation to the group that has the highest probability. as a result, a classification matrix is produced, which gives the fraction of observations correctly assigned to each group by the discriminant function. in our case, a good classification would be quantified by high fractions for both correctly predicted biological binding site clusters and correctly predicted non-biological binding site clusters. we found that our method correctly classifies 87% of biological clusters and 85% of non-biological clusters.

validation of ibis method by comparison with - geometric methods
to further validate the prediction ability of our method we compared it with several widely used geometry and energy-based approaches discussed in a recent study  <cit>  which includes ligsitecsc  <cit> , pass  <cit> , q-sitefinder  <cit> , surfnet  <cit> . we used  <dig> out of  <dig> proteins from this paper which have structure homologs with at least 30% sequence identity and also have both small molecule-bound and unbound structures.

for each method tested, the top ranked predicted sites for the unbound structure are compared with the observed binding sites in the bound structure of a protein-small molecule complex of a homolog. table  <dig> shows the sensitivity of retrieval of the true observed sites at the top three ranks. to measure the sensitivity of retrieval of bound structures at different levels of similarity between the unbound query and bound structure from the database, we selected from the test set only those unbound-bound pairs which are within a given similarity range  and denoted them ibis <dig>  ibis <dig> and ibis <dig>  for example, the ibis <dig> dataset contains unbound query proteins for which the average sequence identity between the unbound protein and members of the binding site clusters containing the bound homolog is no more than 90%. it is difficult if not impossible to define false positives in our case since there are many binding site clusters which are biologically relevant  but at the same time do not match the binding site of the bound form of the protein from the test set. this happens if, for example, there are multiple binding sites/pockets in the protein which bind different small molecules and have distinct functions. as can be seen from this table ibis performance is similar to the ligsitecs method which uses sequence conservation and reaches about 72% sensitivity. overall we found that a total of  <dig> proteins  from the test set have at least one of their ibis predicted sites overlap with cdd binding site annotation. this suggests that ibis successfully uses the knowledge of the structure complexes of homologs to predict and rank the relevant sites. the complete details of the prediction results can be seen in additional file  <dig> table s <dig> 

*ibis <dig>  ibis <dig>  ibis <dig> dataset contains unbound query proteins for which the average sequence identity between the unbound protein and members of the binding site clusters containing the bound homolog is no more than 100%, 90% and 80% respectively.

all of these approaches, although they perform reasonably well, are limited by the requirement of differentiating true positives from false positives. introducing sequence conservation need not necessarily improve the prediction accuracy and could be a source of error, leading to over prediction of the binding site area  <cit> . ibis on the other hand predicts only a handful of small molecule binding sites with high probability of being biologically relevant. on average our method predicts  <dig> 'biologically relevant' binding sites per protein chain and over half of all predicted sites map to cdd curator annotations.

knowledge-based docking using ibis, an example
to demonstrate the effectiveness of ibis as a knowledge-based prediction system, we compared our method with an established reverse docking approach. cai and coworkers  <cit>  employed a reverse docking method to find a potential target protein for a natural product: n-trans-caffeoyltyramin in the genome of helicobacter pyroli. initially all potential binding proteins of n-trans-caffeoyltyramin were screened from a database of potential drug targets with known structures from the protein data bank using the reverse docking approach tarfisdock  <cit> . only two proteins from the h.pyroli genome were found by the tarfisdock method: diaminopimelate decarboxylase  and peptide deformylase . after enzymatic validation, only the pdf protein was found to be a probable drug target. the crystal structure complex of n-trans-caffeoyltyramin with pdf suggested a highly selective binding in the pdf binding pocket.

we attempted to identify the binding sites of n-trans-caffeoyltyramin on the pdf protein sequence. the closest homolog for h.pyroli pdf is p.aeruginosa pdf which has 45% sequence identity and has been used as a template for inferring the interactions by ibis. the top ranked and highly conserved inferred binding site of p.aeruginosa pdf when mapped onto h.pyroli pdf is in complete agreement with the native/experimentally determined binding site of the n-trans-caffeoyltyramin - pdf complex .

discussion
a researcher interested in the function of a specific protein will usually be concerned not only with the availability of any functional annotation, but also with the reliability of such information. the most reliable source is experimental data on the protein function but despite the growth of the protein sequence and structure databases, there remains only a small fraction of proteins whose functions have been experimentally characterized. in this paper we present a method which provides the information on protein function annotation through the identification of protein binding sites. the current approach attempts to interlink sequence conservation with structural diversity in deciphering protein function. we specifically focus on protein small molecule binding sites and their biological relevance for protein function. our method derives the actual binding sites from the structures of all the homologs and groups them based on sequence and structural similarity. for example, to account for all specific interactions of various drugs targeting the kinase atp binding site , it is imperative to consider all the protein sequences even if some of them are identical. such grouping ensures their biological relevance and at the same time accounts for variations in the binding site residues due to differences in small molecule sizes and conformations. by using all available structures of close homologs, ibis provides a great opportunity for analyzing the diversity of binding modes. figure  <dig>  for example, shows the conserved tyrosine kinase fold with varying degrees of sequence similarity but sharing a highly conserved atp binding site occupied by different small molecules.

recently, it was estimated that over two-thirds of all protein sequences in the genbank database have at least one structure homolog  <cit> . as the on-going structural genomics initiative continues to close the sequence-structure gap, our method might be very useful for annotating proteins with unknown function and structure. moreover, the location of putative binding sites provides guidance for the protein docking methods for drug design. we have assessed the reliability of our method by direct comparison with the binding site annotations from literature and manual curation and have shown that in the great majority of cases, the method detects and ranks the manually annotated binding site cluster at the first or second rank. this is achievable for a number of reasons, such as using a sufficient level of similarity between the unknown query and its homologs with the known binding sites, accurate clustering of small molecule binding sites using a reasonable similarity measure, and applying a deliberately designed ranking scheme that distinguishes the non-biological from the biologically relevant binding sites.

we have also compared our method with several widely used geometry and energy-based approaches to predict small molecule binding sites. as we have shown, the performance of our prediction method is very similar to popular geometric approaches. moreover, one of the advantages is that our method can be applied even for a query sequence without structure, which is not the case for those binding site prediction methods which explicitly rely on the specific features of binding pocket geometry.

using remote homology for functional inference is often based on the general assumption that there is a negative correlation between small molecule binding site similarity and overall sequence similarity. however, small molecule binding site similarity is much more complicated with many examples of strikingly similar binding sites with low  overall sequence identity and also very weakly similar binding sites with high overall sequence identity  <cit> . likewise, the similarities of small molecule binding sites across different protein folds, although providing new insights, leads to new challenges in deciphering the functional relevance. large-scale automated function prediction methods are often limited by the lack of sufficient understanding of biological function and also by the quality of structure data. hence, through the ibis approach, we strive to limit the false positive rate by employing a conservative sequence similarity threshold of at least 30% over the structurally superimposed regions of homologs. it is often possible that the protein-small molecule crystal state may correspond to a global minimum of free energy where biologically relevant interactions are difficult to distinguish from non-specific contacts. for example, a recent estimate suggests some 20% of dimeric structures in pdb may be crystallization artifacts  <cit> . the elaborate scoring scheme of our method based on recurrence and evolutionary conservation, along with the list of non-biological small molecules, tends to de-emphasize the artifactual interactions and ranks such sites near or at the bottom of the list.

furthermore, the chemical properties of small molecules bound to the inferred binding sites can be used as a starting step in small molecule virtual screening. the pubchem compound database  <cit>  mapping of ibis small molecules accomplishes a preliminary step in small molecule virtual screening by clustering the similar chemicals into structurally unique compounds. the functional groups of the small molecules binding in a common binding site of evolutionarily related proteins are likely conserved. recently it was shown that sequence and structure conservation of the binding site residues contacting these anchor functional groups is significantly higher than those contacting variable regions  <cit> . ibis, thus provides a common platform for function prediction, knowledge-based docking and also for small molecule virtual screening.

CONCLUSIONS
finding small molecule binding sites that specify protein function is of great importance in drug development. here we proposed a method to decipher the function of an unknown protein by interlinking sequence conservation with structural diversity of its homologs. to facilitate validation of the inferred binding sites from homologs, we developed an elaborate scoring scheme that can accurately distinguish biologically relevant sites. the method has been implemented as a web server, ibis  to facilitate accurate, efficient and high-throughput function prediction.

