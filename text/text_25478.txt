BACKGROUND
initiation of transcription is regulated by a coordinated binding of many transcription factors to the core promoter region. the initiation process is further modulated by binding of activators and repressors in more distal regions  <cit> . the core promoter is the region  around the transcription start site , which is vital for initiation of the basal transcription. the core promoter contains several transcription factor binding sites that facilitate transcription initiation, such as the tata box, the gc box, inr  <cit> , and the recently discovered mte  <cit>  and dpe  <cit> . in human, the tata box is the most abundant, present in 25–30% of promoters within the entire genome  <cit> . the process of predicting the core promoter can therefore be summarized as using these characteristics to locate the tss.

to understand eukaryotic transcriptional regulation, accurate identification and localization of core promoters are important  <cit> . the difficulty in identifying eukaryotic core promoters is that unlike in prokaryotes, eukaryotic promoters are sometimes located several hundred kb away from the translation initiation site . the eukaryotic promoters are usually identified by detecting full-length cdna, e.g., oligo-capping  <cit> . however, such experimental methods are laborious, time-consuming and expensive. de novo computational promoter prediction programs  show great potential in this regard and have achieved moderate success in the past  <cit> . nevertheless, promoter prediction at high resolution, especially for promoters that are not associated with cpg islands , remains unsatisfactory  <cit> .

it is widely recognized that promoter regions are correlated with cpg islands. cpg islands are regions of dna longer than  <dig> bps with a g+c content of at least 50%, and the number of cpg dinucleotides being at least 60% of what could be expected from the g+c content  <cit> . cpg islands are well known to be highly associated with many mammalian gene promoters ; about 50~60% of the promoters are associated with cpg islands  <cit> . the first generation ppps, such nnpp  <cit> , tssg and tssw  <cit> , promfd  <cit> , and proscan  <cit>  did not use cpg island as a landmark and thus showed poor results in large-scale evaluations  <cit> . a consensus program, conpro  <cit> , combined features of these ppps and other genomic information for promoter prediction. tested on a small dataset, conpro showed improvements over individual ppps. various other techniques were also employed with varying success. homology-based promoter predictions have achieved moderate success  <cit> . promoterinspector  <cit>  improved prediction accuracy by allowing variable gaps between fixed oligomers, and implicitly using cpg island information  <cit> . zhang's group  <cit>  was the first to classify explicitly the promoters into cpg-island-associated and the non-cpg-island-associated. they implemented this notion  in their recent promoter prediction program – firstef, and achieved significant improvement  <cit> . since then, all the high performing programs, such as dragongsf  <cit> , mcpromoter  <cit> , and pspa  <cit>  use cpg islands as landmarks to make a prediction.

to evaluate fairly the performance of the ppps, we separated promoters into two subtypes – cpg-rich and cpg-poor, depending on whether they are cpg-island related or not  <cit> . to ensure that a cpg-poor promoter does not relate to any cpg island, we classified each promoter as follows. if a cpg island is present within the ±  <dig> kbps sequence of a promoter, we classified the it as cpg-rich, otherwise cpg-poor  <cit> . this classification adopts a more stringent criterion for a tss being non-cpg-related . thus, in our study, the proportion of cpg-rich promoters is higher than the previous estimates  <cit> .

different programs utilize different characteristics of the genomic sequence near the promoter to make predictions. for example, dragongsf and dragonpf use cpg islands as a global landmark and integrate additional attributes using an artificial neural networks  to predict tsss within the ±  <dig> bps of cpg islands  <cit> . firstef first scans - <dig>  to + <dig> bps to detect a cpg island, then uses two different quadratic discriminant functions in a - <dig> to + <dig> bps window for tss prediction  <cit> . these attributes include the frequencies of fixed-length motifs in different windows in the - <dig> to + <dig> bps region. the fprom program uses a linear discriminant function to make prediction based on the characteristics in the - <dig> to + <dig> bps region of the tss  <cit> . mcpromoter focuses on the - <dig> to + <dig> bps region and uses a generalized hidden markov model, with six interpolated markov chain submodels representing different segments of the promoter region  <cit> . the recently improved version of mcpromoter classifies drosophila promoters into  <dig> subtypes and uses one model for each subtype to make a prediction  <cit> . pspa uses - <dig> to + <dig> bps around the tss and uses a strict position-specific and variable-length motif propensity model. it shows a superior performance on cpg-poor promoters  <cit> . based on a large-scale evaluation on the human genome, a recent review  <cit>  showed that dragongsf and firstef performed better at a low resolution . another recent evaluation  <cit>  showed that their performances deteriorated sharply at a more stringent resolution . the study showed that dragongsf made virtually no predictions on the cpg-poor promoters and firstef made no prediction on 85% of the cpg-poor promoters. even though pspa improved prediction on the cpg-poor promoters, its overall performances on cpg-poor promoters remained unsatisfactory. a focus on high resolution and on cpg-poor promoter prediction is needed  <cit> .

the previous evaluations  <cit>  were limited to the most upstream tss  or the most frequent tss as defined by dbtss database  <cit> . recent studies showed that there were several hundred thousand tss in the human and mouse genomes, and 58% of the mammalian genes have alternative transcription start sites   <cit> . the presence of multiple atss for a single gene is related to tissue-specific gene expression. for example, the udp-glucuronyl transferase gene has seven alternative promoters, each responsible for expression in a certain type of tissue  <cit> . the more recent encode region study showed that the regulatory elements distributed symmetrically around the tss, with no bias towards the upstream regions  <cit> . as more and more experimentally validated atsss become available, it is necessary to evaluate the ppps on all tsss , not only the mutsss. furthermore, promoters predicted by various ppps do not overlap. at a prediction resolution of - <dig> to + <dig> bps, the correct predictions from different programs are largely distinct  <cit> . if a meta-predictor could combine the correct predictions from each ppp, it would achieve a much higher performance.

in this paper, we first describe the relationship between cpg island and promoters. we then evaluate the performance of ppps on a large set of atss, which includes mutss as well as the other promoters, including the middle tss  and the most downstream tss . finally, we introduce a meta predictor that combines promoter predictions from top-performing ppps using artificial neural networks, as well as the genomic information such as cpg island . our large-scale tests on the human genome show that the meta predictor is significantly superior in terms of sensitivity and specificity, as compared to the individual ppps.

RESULTS
alternative promoters are symmetrically distributed
we used tss annotations from dbtss <cit>  and refseq  <cit>  as our reference. since dbtss includes alternative tss, we extracted the must upstream tss as a subset, named dbtss 5'. we compared the distance between mutss and the upstream coding sequence  documented in these databases and found no significant difference . both dbtss 5' and refseq annotated tsss were upstream of the cds, and about 67% were within  <dig> kb upstream. however, when dbtss atsss were counted, only 30% of the atsss were within  <dig> kb upstream of cds, and the rest distributed symmetrically around this region.

we then integrated the tsss from the two datasets into one and clustered them based on their genomic locations. if twotsss are less than  <dig> bps apart, we take the upstream one as a representation of the cluster. after removing the redundant tsss, we obtained  <dig>  distinct atss. we pooled these atss together and clustered them into  <dig>  clusters . for each cluster, we extracted the region spanning  <dig> kb upstream of the mutss to the end of the gene . we thus obtained  <dig>  sequences, with a total of  <dig>  ×  <dig> bps, which equaled approximately 30% of human genome. these sequences were used for promoter prediction. among the  <dig>  atss, there are  <dig>  mutss,  <dig>  mdtss, and  <dig>  mtss. the distance distribution among these tsss is shown in additional file  <dig> 

upstream promoters are more frequently associated with cpg islands
since cpg islands play a vital role in promoter prediction, we analyzed the correlation between cpg islands and human gene promoters. to illustrate the relationship between different types of promoters, we classified the promoters as mutss, mdtss and middle promoters , depending on their locations in the cluster. we used a less stringent cpg island detection program  <cit> , which were used in our previous study  <cit> . among the  <dig>  sequence, the program detected  <dig>  cpg islands. figure  <dig> shows the distance between cpg islands and the three types of atss. 74% of the mutss were within a cpg island, approximately 81% were within  <dig> bps, and about 95% were within  <dig> kbps of a cpg island. the numbers for mdtss were substantially lower, only 41% were within a cpg island and 54% within  <dig> bps of a cpg island. the corresponding numbers for all promoters were 55%, 65%, and 94% respectively.

we also used the cpg islands that were annotated in ucsc genome browser  <cit>  and observed the same pattern . the database included  <dig>  cpg islands in our promoter sequences. of the mutss, 60% were within a cpg island, approximately 70% were within  <dig> bps, and about 78% were within  <dig> kbps of a cpg island. in contrast, of the mdtss, only 31% were in cpg islands, 37% were within  <dig> bps, and 54% within  <dig> kbps.

statistics of promoter prediction by individual ppp
the  <dig>  sequences were used for promoter prediction by each ppp. we obtained a total of  <dig>  tts-predictions from six ppps. we then classified the predictions into two categories. if a prediction was within ±  <dig> kb of a cpg island, it was classified as a cpg-rich prediction otherwise a cpg-poor prediction. the classification resulted in  <dig>   cpg-rich predictions and  <dig>   cpg-poor predictions. the composition of the predictions contributed by each ppp was shown in table  <dig>  fprom made the majority of the predictions, 77% of the total cpg-rich predictions and 92% of the cpg-poor predictions. each of the other ppps made about 5% of the total cpg-rich predictions. three ppps, dragongsf, firstef and mcpromoter made few cpg-poor predictions.

with total  <dig>  predictions in 30% of human genome by six ppps,  <dig>   are cpg-rich predictions and  <dig>   are cpg-poor predictions.

we then looked at the average number of predictions made by each ppp per promoter. as shown in table  <dig>  fprom was very lenient in making predictions; it made on average five predictions for each cpg-rich promoter and  <dig> predictions for each cpg-poor promoter. the other five programs were comparable on cpg-rich promoters. on average, they make about  <dig>  to  <dig>  predictions per true cpg-rich promoter. on cpg-poor promoters, pspa made about  <dig>  predictions per true cpg-poor promoter, and dragonpf made about  <dig>  predictions.

performance evaluation of individual ppp
we evaluated the performance of six ppps on cpg-rich and cpg-poor promoters separately. the sensitivity and specificity of each ppp were reported at three levels of resolution – high , intermediate  and low . all the predictions were subject to the same evaluation criteria and the results were shown in figure 4a–f.

for cpg-rich promoter evaluations, we added a baseline prediction as a control. to perform the baseline prediction, we picked a random location near each cpg island   <cit> , and used it as a prediction. a total  <dig>  random predictions were evaluated by the same criteria as other ppps, and sensitivity, specificity were reported. to evaluate the variation of the random baseline prediction, we repeated the process  <dig> times. the standard deviations for sensitivities and specificities were also reported in the figure legend. figure 4a–c showed the performance of six ppps and the baseline prediction on cpg-rich promoters. pspa and firstef performed better at high resolution, whereas firstef and dragongsf performed better at low resolution. firstef, pspa and mcpromoter performed better at intermediate resolution. fprom had a higher sensitivity, but a lower specificity at all resolutions. firstef and pspa both performed relatively well with a balanced sensitivity and specificity. the baseline prediction, though randomly selected within a cpg island, performed very consistently, with standard deviation of only ±  <dig> % to ±  <dig> % for both sensitivity and specificity.

we evaluated the performance of dragonpf, fprom and pspa on cpg-poor promoters . we excluded other ppps from this evaluation because they virtually did not make predictions on the cpg-poor promoters. in general, the performance on cpg-poor promoter was much lower than that of the cpg-rich promoter. at a low resolution, dragonpf showed a higher specificity and fprom a higher sensitivity. pspa showed a higher sensitivity at high resolution and had a balanced sensitivity and specificity in all ranges of resolutions.

to evaluate the similarity of these ppps, we compared the correct predictions from each pair of ppps at medium resolution  and the results were shown in tables  <dig> and  <dig>  the overlaps in cpg-rich promoter  were substantially larger than that of the cpg-poor . for promoter predictions in cpg-rich sequences, fprom and dragonpf had the highest overlap at 81%, and mcpromoter and dragongsf had the lowest at only 38%. for promoter prediction in cpg-poor sequence, fprom and pspa had the highest overlap at 26%, and firstef and fprom had the lowest overlap at 12%. the overlaps at high and low resolutions were shown in additional file  <dig>  with less restricted resolutions, we observed a sharp increase of overlaps from the high to low resolutions for cpg-rich sequences. the overlaps are 11%~52% for the high resolution, 38%~81% for the medium resolution, and 66%~89% for the low resolution. however, the trend was not as significant for the cpg-poor sequences, where predictions overlapped at 6%~32%, 12%~31%, and 18%~35% for the high, medium and low resolutions, respectively.

the number in parenthesis is the count of correctly predicted promoters; the percentage number is calculated by the count of the overlap divided by the mean of both ppps. the overlaps at high and low resolutions are shown in additional file  <dig> 

cpg islands is key to prediction accuracy
another notable feature in figure  <dig> was that the baseline prediction, particularly at the low resolution, performed as well as the other ppps. this result showed the power of using cpg-islands as a landmark for promoter prediction, and how current ppps relied on cpg island critically. even though they would miss the promoters that were not associated with cpg islands, ppps that made prediction exclusively on regions near cpg islands were bound to perform better than those ppps that did not use cpg islands as a landmark.

the promoter prediction problem was much harder for cpg-poor sequences. since there was no cpg island to serve as the landmark, the ppps had to consider a much larger region for prediction. an alternative approach was to use the feature of a gene as a landmark, since gene prediction programs use context information derived from a higher degree of conservation in the encoding region. it was shown that integration of gene prediction and est information improved promoter prediction  <cit> . a recent study  <cit>  showed that cpg-poor promoters were more conserved and had fewer alternative start sites than the cpg-rich promoters. this observation was further confirmed  <cit> . the observation implied that the signal around cpg-poor promoters was stronger, and was independent of cpg islands. the promoter prediction on cpg-poor promoters was thus likely to be more accurate. however, most state-of-the-art ppps used cpg islands as a primary landmark, which reduced the search scope by about 50-fold. as a result, prediction accuracy on cpg-rich promoters was far higher than that on the cpg-poor promoters.

evaluation of metaprom
next we used a neural-network-based approach to integrate the predictions made by individual ppps to improve the overall prediction accuracy. we included the performance of the different ppps at the intermediate resolution of  <dig> bps. the performance of metaprom was based on 10-fold cross-validation. the sensitivity~specificity coordinate of each ppp was shown in figure  <dig>  metaprom was effective on cpg-rich promoter prediction. at a specificity of 60%, metaprom boosted the sensitivity from 26% to 46% as compared to firstef. at a specificity of 50%, it improved the sensitivity from 29% to 52% as compared to pspa. on cpg-poor promoter predictions, metaprom made only marginal improvements upon the current best performer, pspa  <cit> . this was because only three programs make predictions on cpg-poor promoters, and they made very few predictions. the evaluations of metaprom at the high and low resolutions were shown in additional file  <dig> 

discussion
it is widely recognized that promoter regions are correlated with cpg islands. cpg islands were originally found around tsss in about 55% of the human promoters, based on hundreds of experimental screening of human genes  <cit> . since then, cpg islands have been used as landmarks in many promoter prediction programs  <cit> . recent large-scale oligo-capping of full-length cdna techniques provided a large set of experimentally validated promoter data, which enable us to evaluate the links between cpg islands and promoters in much greater detail  <cit> . using an older version of refseq, previous study showed that 34% of the refseq annotated tsss could be extended towards the 5' ends  <cit> . here we used a recent version of refseq database  <cit> , which was substantially enhanced and includes most of the tss from dbtss. our study showed that there was not a significant difference between the refseq and dbtss mutss annotations in terms of distance to the translation start site.

since the discovery of the close association between cpg islands and promoters, this association has been widely utilized for promoter and gene prediction. previous studies showed that about 50~60% of the promoters are associated with cpg islands <cit> , we found the association is stronger. by using a recently developed cpg island calculation program  <cit> , we showed that more than 65% of all promoters are within  <dig> bps of a cpg island, and 95% of all promoters are within  <dig> kbps of a cpg island.

more importantly, we found that the 5' alternative promoters were more closely linked to cpg islands than the 3' promoters of the same gene. consistent with the role of cpg islands in the recruitment of chromatin modification enzymes, it is conceivable that the most upstream promoters represent the broadly used substrate in a hierarchical regulation of gene transcription, whereas the downstream, non-cpg-associated promoters are used in a tissue-specific fashion in conjunction with the upstream promoters. we hypothesize that most polymerase ii transcription complexes are assembled at the vicinity of a cpg island. it then either starts transcription, or slides to another active promoter to initiate transcription.

our results also showed that improvements on cpg island prediction can further reveal the relationship between cpg islands and promoters. since the new cpg island program detects substantially more cpg islands, not surprisingly, we found more promoters are associated with cpg islands. it also provides us a challenge to develop cpg island detection programs that can help identify promoters. we believe this is especially important in the current context of dna methylation and histone modification studies  <cit> . the cpg island detection program will give us more opportunity to understand not only genetics, but also the epigenetic regulation of genes. similar to the discovery of the higher proportion of promoters associated with cpg islands, we might find that more dna methylation and histone modification events are associated with cpg islands.

different ppps capture different characteristics of mammalian core promoters. because most ppps are based on machine learning approaches, the genomic attributes captured by the ppps are not thoroughly investigated. these attributes will be important in understanding mammalian promoters and in return help us to develop a better ppp. as a first step, we propose a metaprom tool that integrates the predictions by individual ppps using an artificial neural network. by combining these predictions, our metaprom showed significant improvement over the individual ppps. liu and states  <cit>  have developed a consensus method -conpro. the authors were able to improve the prediction accuracy by combining results from five ppps and one gene prediction program. however, the five ppps  used were shown to perform poorly  <cit> . in contrast, the ppps used in our meta-predictor are relatively new and all are different from the ones conpro used, except fprom, which is an improved version of tssg.

several reasons contribute to metaprom's lack of improvement on cpg-poor promoter prediction. first, only three ppps make predictions on this type of promoters and the number of predictions is much lower comparing to the cpg-rich promoters. second, the overlaps between the three ppps are also substantially lower than that of cpg-rich promoters. third, the proportion of overlap does not increase as we go from a high resolution to a low resolution . since metaprom does not make new predictions, it relies on the context information from other ppps in the surrounding region. for cpg-rich promoters, the overlaps are as high as 80% in medium and low resolution, and the model can use context information from other predictions and thus works better. however, for cpg-poor promoters, 1) we do not have sufficient predictions to use and 2) these predictions usually do not overlap in the  <dig> kb base pair region, which is the maximum context information that our model uses. therefore, the improvement is not significant.

the recent large-scale determination of full length cdnas has generated large amount of reliable promoter data, and has led to some novel insights. for example, recent data shows that 58% of genes have multiple alternative start sites and these often correspond to tissue-specific expression of the transcript  <cit> . in this study, we have included alternative tss to evaluate the current ppps for the first time. not surprisingly, as more and more annotated tsss are considered, we get higher specificity and lower sensitivity. we are aware that most ppps were trained and tested only for mutss prediction, which may underestimate their performances. however, since the biological paradigm is shifting from one gene, one promoter to one gene, multiple promoters, it also imposes computational challenge to the promoter prediction field.

even though the large-scale experimental data provide us with a large number of cdnas, these cdnas are by no means comprehensive and exhaustive. some false positive predictions by the metaprom program might prove to be true positives once the experimental detection of promoters becomes more sensitive. the core promoter prediction programs also provide a basis for designing the whole-genome promoter array. furthermore, algorithms that are successful on human promoter prediction can hopefully be used in other mammalian genome promoter prediction, and thus guide experimental studies.

previous evaluation on mutss reports greater variability of the performance on different chromosomes  <cit> . our evaluation on atss shows that most ppps have consistent performance on different chromosomes . every ppp seemingly captures slightly different attributes of the promoter sequences and thus makes predictions that are largely unique to the ppp  <cit> . a recent paper discussed extensively the attributes used by each of these ppps  <cit> . dragonpf, dragongsf and firstef incorporate both promoter region and part of gene structure to make a prediction, and thus require a relatively longer sequence . fprom, mcpromoter and pspa use shorter sequences  flanking the promoter region to make predictions. they do not depend on protein-coding region thus can be used in predicting rna gene promoters. until we gain a better understanding of the biological signals encoded in the promoter regions that are recognized by the transcriptional machinery, our machine-learning approach to integrate the predictions made by different ppps will provide a valuable resource.

while this manuscript was under review, another promoter prediction program  <cit>  was published, with focus on non-cpg-related promoter prediction. the program adopted a logitboost procedure to make prediction based on features such as position-specific elements, tfbs, and k-mer frequencies. this study differs from our study in the following: 1) similar to other state-of-the-art ppps, this study focuses on mutss prediction, whereas our study focuses on atss prediction; 2) the assessment of the program is performed on a limited length of sequence . we focus on the whole genome prediction, with about 30% of the human genome sequences; 3) the assessment is based on a smaller dataset . our study uses  <dig>  cpg-rich promoters and  <dig>  cpg-poor promoters. this new program gains significant improvement on both cpg-related and non-cpg-related promoter predictions. incorporating this ppp into our meta predictor has the potential to improve overall prediction performance.

CONCLUSIONS
our genome wide evaluation was based on all available promoters, including alternative promoters. we discovered that promoters at the 5' end of the gene are more likely to be linked to a cpg island. evaluation based on the human genome shows that metaprom performs better than any of the individual ppp both in terms of sensitivity and specificity. this meta prediction method should be useful in locating the promoter region of a gene, and thus facilitating the analysis and understanding of gene regulation. the metaprom program and the genome wide predictions are available upon request.

