BACKGROUND
in europe, agriculture represents approximately  <dig> % of the total added gross value  <cit> . this share differs greatly among member countries, ranging from  <dig> % in luxembourg to 13% in romania. european livestock output is estimated to be worth approximately  <dig> billion euros  <cit>  per year. although the number of animals for all livestock species has decreased steadily since the  <dig>  increased farming efficiency and genetic improvement of animals have led to overall increasing yields. research on genetic characteristics of livestock species has increased since the availability of genome sequences of major livestock species and the consequent availability of snp arrays. livestock genetic improvement, breeding, conservation and many other related sectors now rely on snp array technology, as it provides rapid access to highly accurate genome-wide information on individuals at relatively low cost. thousands of individuals have been genotyped worldwide  <cit> , and this information has been used mainly for selection in breeding programmes. however, the amount of genomic information available on each animal differs depending on the type of genotyping array used. furthermore, the number of snp arrays available is rapidly increasing. it is common practice within all major livestock species to periodically exchange genotype data, which might be obtained from different snp arrays. imputation methods may then be used to predict the missing data  <cit> . although exchanging information is routine, the difficulties in comparing and merging data is usually an underappreciated burden. there is an urgent need for standardization and tools to integrate snp data and related information. in addition accessory information including annotation, allele formats, flanking sequences, etc. is often difficult to retrieve, especially for snp arrays that are no longer commercially available. integration and standardization difficulties are compounded as basic information such as snp ids  are not consistent across array suppliers, and in some cases, not even between array releases from the same supplier. in addition, snp ids are not always searchable in public databases and in particular ensembl and ncbi. even when snp related information is available, it often requires the download of large datasets and extensive data manipulation to obtain the required information. moreover, reference genome assemblies are regularly updated, with consequent changes in snp coordinates and occasionally in the allele orientation coding. cattle is the most extreme example for this, where there are currently two reference genome assemblies   <cit>  being used in parallel. snp producers usually provide snp coordinates quoting the umd <dig>  assembly. the cattle genome was one of the first livestock genomes to be published  <cit>  and the subsequent releases have greatly increased quality and stability of the sequence. the reference genome assemblies on other livestock species are more recent and still relatively unstable  <cit> , with ongoing work to improve the draft assemblies. the snpchimp v. <dig> presented here is the first tool able to tackle all the above problems for livestock species in an integrated, user-friendly and open-access fashion.

implementation
data
the snp data contained in snpchimp v. <dig> can be divided into two main categories: the original data coming from the producer and the information from public databases. current and historical original data free from intellectual property was collected directly from producers  and international genome consortia . some of the information contained in snpchimp v. <dig> is directly available from the manufacturers/consortia websites  <cit> .

as a result of extensive data collection, a total of  <dig> snp arrays  are currently stored in snpchimp, with a total of  <dig> , <dig> snp and their cross-references.

public database information was handled in two ways: i) dbsnp database builds from june  <dig>  <cit>  onwards for all six livestock species were downloaded and stored on a local server; ii) tools to interrogate ensembl databases directly through the web were built, either for querying information for single snp or to access the ensembl biomart  <cit>  and/or vep  <cit>  tools.

a key feature of snpchimp, which is essential to integrate all above sources of information, was obtaining the links between commercial snp ids and dbsnp refseq  ids. affymetrix already provides such association in its snp knowledge base, whereas all other companies and consortia, which use illumina-based technology and software, do not provide such information. for these, associations for all species were obtained by matching commercial snp ids against the “submitter id” or flanking sequences in the locally stored dbsnp database, following a similar procedure as specified in  <cit>  for cattle. however, full flanking sequence blast  <cit>  against the reference genomes of the six species was not performed, as this procedure was proven to be considerably time- and resource-consuming, and redundant with respect to independent checks performed over the whole dataset.

database
snpchimp v. <dig> stores the data on a mysql server instance version  <dig> . <dig>  data are internally organized as shown in the entity-relationship shown in figure  <dig>  the different species were considered separately, by replicating the same set of tables for each using a naming scheme . the core data was simplified in order to require only four tables:<spec > _arrays contains general snp array information, including official snp array name, the assembly used for the design, and the number of snp contained.

<spec > _snpall contains the original snp information provided by producers for all arrays. this table includes commercial snp names and rs ids , all possible alleles coding for that snp, the interbull index  and a code for the taxa .

<spec > _allmap contains all available assembly mapping for all snps. as such, it is in a one-to-many relationship with < spec > _snpall, as a snp can be mapped on more than one assembly .

<spec > _ssinfo contains snp ids submitted to dbsnp . this table is in a one-to-many relationship with < org > _snpall, as each rs id usually contains several ss ids . a boolean flag  was added to identify which of the ss ids was used to link the commercial snp name to the refseq id.



two additional redundant tables were created for each species, for performance purposes:<spec > _snp_across_arrays records the presence  of snp across arrays. as such, the table structure is species-specific and the number of columns differs depending on the number of available snp arrays. the table has two columns that describe the snp  and one boolean column for each array, recording the presence/absence of that snp in the specified array, respectively.

<spec > _join_ < assembly > is a set of tables. for each species, there are as many of these tables as the number of available assemblies. each table represents a join between the four core tables, restricted to a single assembly. this data design enhances data compartmentalization with respect to assemblies.



query engine
the query engine relies on a php application programming interface  written ad hoc to facilitate dynamically built sql queries of the snpchimp v. <dig> database . each user input is validated and translated into a sql query. a conservative approach was applied to ensure the security of the information contained in the database, such that a user request that fails validation returns an error status and a set of case-specific error messages. for valid requests, the engine works in two different modes: one to produce a “preview” of the data requested by the user and one to perform the full query of the database. in the first mode, the engine interrogates the mysql database, parses a subset of  <dig> elements of the result and returns a properly formatted php object. in the second mode, when a full query is requested, the engine returns the mediated user-defined sql query using a pipeline, which directly connects the database output to the user. this facilitates massive downloads of data to the web-server with no need for pre-processing.figure  <dig> schematic view of query engine and user interface functionalities.



extensive testing is performed before releasing new information. this is carried out using ad hoc development environments built specifically to avoid any conflict or unpredicted modifications to the production environment, which is publicly accessible.

RESULTS
the tool presented here is the evolution of two previous versions. snpchimp v. <dig>  <cit>  was specifically focused on bovine cattle and contained only  <dig> snp arrays. snpchimp v. <dig>  <cit>  was a first attempt to enlarge the included set of species and snp arrays. these two previous versions of snpchimp were progressive upgrades, useful to gradually improve the tool and to generate interest among stakeholders and researchers. since then, the strong interaction and collaboration with major industries and international genome consortia was the basis of the version presented here. in fact, snpchimp v. <dig> includes a notable growth in the amount of data regarding new species and chips . more than just a quantitative improvement, this was also a major qualitative change allowing a wider audience addressing common problems in multiple species. from the technological point of view, the whole tool has been completely rebuilt. performance, database structure and technology and languages behind the user interface were highly improved to allow current and future scalability and reliability. in addition, this version includes a completely new functionality for direct interrogation of the biomart and vep ensembl resources .

the key to ensure data reliability was to obtain current and historical original data directly from producers and international genome consortia. as snpchimp v. <dig> aimed at the animal genetics community as a whole, only snp arrays  that were free from intellectual property  were considered. once the data was obtained, a specific design of the mysql database was chosen. the strong compartmentalization between different species was one of the most important design choices. this ensured smaller table size, and thus easier updates and additions. moreover, it reduced the probability that corruption in one dataset propagates to others, thus providing higher structure stability. in any case, the original data was stored in the database without modifying the data itself , thus users are not forced to store large annotation files anymore. in fact, users do not need to build cross-reference or cross-snp array files anymore, as all these are already included in the functionalities of this tool . another important design choice was the creation of two  redundant tables per species. these tables were useful to enhance the performance of the most common queries  and, hence, runtime.

the choice of producing a “preview” page of the queries was also linked to high performance, as php objects are easy to render graphically and parsing time is very short. specifically, the “preview” functionality was included to reduce the number of unwanted downloads, which would be both tedious for the user and resource-consuming for the server.

a strong effort was put into the design of an appealing, user-friendly and easy-to-manage website that included the interface to interrogate the database. differently from previous versions, the snpchimp v. <dig> website was built using the joomla content management system  v. <dig> . <dig>  <cit> . it was functionally and structurally divided in three main areas: a documentation section, a software section and the database interface.

the documentation area was highly improved from previous versions. now it contains general information on the snpchimp, the data used, news with an rss feed  and contact details.

the new software section  consists of a webpage that points to useful tools, usually linked to snpchimp v. <dig> outputs  and either produced in-house or by third parties. all software present in this section is open-access, and all contributors are encouraged to make their scripts open-source. currently, the tools menu contains software to extract affymetrix axiom genotypes   <cit> , to convert illumina-like allele coding and map information   <cit>  and a multi-purpose software for snp data management and analysis   <cit> .

the database interface is the true core of snpchimp v. <dig>  and of course was present in the other two versions of the tool. although background functionalities were completely rebuilt, special attention was taken to maintain user experience as similar as possible to earlier versions. user access to the database is driven by two functions, specifically designed to efficiently query either all snp array information  or a subset of snps . after selecting the desired species, a series of dialog forms and jquery-javascript functions  help users perform the required query of the database in a user-friendly fashion. no sql coding skills or knowledge of the underlying database is required. user choices consist of the selection of the desired snp array, genome assembly and the level of detail required for the expected results. for both download and browse functions a subset of the first  <dig> rows of the query results is shown in a preview table. after being previewed, the resulting dataset can be downloaded by simply clicking on a “download” button.

three specific features are available when the browse feature is used to query a subset of snps. firstly, the preview page with results that contains links to related external resources/databases. on each row of the snp table, two links for snp specific ensembl locations/variations and ncbi dbsnp pages are displayed. the second feature included in this section, which was not available in earlier version of this tool, was included in response to requests from the animal genetics community, and is the possibility to perform a straightforward snp array specific annotation. snpchimp v. <dig> facilitates this by direct use of the ensembl biomart resources, using a “url based access” interface to the biomart central portal  <cit> . the snpchimp v. <dig> interface prepares the biomart url, containing the specified query parameters, in order to visualize the required subset of data. this avoids any need for programming or specific knowledge of the data-mining tools involved. more advanced users can refine their queries with an additional set of options as required. the third feature facilitates the direct interrogation of ensembl’s variant effect predictor  tool using a representational state transfer  interface. a python cgi script was created to submit the data to ensembl’s vep rest api and visualize the results within the snpchimp v. <dig> interface. results are displayed in a table where ensembl vep annotations are reported for each snp. this solution ensures the stability of the service provided, as it avoids the need to install and update data and/or software for each new ensembl data release as the rest interface automatically accesses the most up-to-date ensembl version.

CONCLUSIONS
the need for snp data standardization and integration is underappreciated. here we present a tool that allows users to avoid performing the long and time-consuming series of steps required to integrate, standardize, and annotate snp array data in the major livestock species.

from its initial release  <cit> , this tool was completely rebuilt both on the back- and on the front-end, in order to enhance manageability and user-friendliness. snpchimp v. <dig> now considers six livestock species, for a total of  <dig> snp arrays and allows direct and easy annotation of snp array data in multiple species using ensembl resources. it also provides standalone software for basic snp data management. its maintenance and constant update is ensured by the strong collaboration between snp array producers, international genome consortia and the animal genetics community. in recognition of the open-access use of ensembl resources, snpchimp v. <dig> was officially credited as an ensembl e!mpowered tool  <cit> .

availability and requirements
project name: snpchimp v.3

project home page:http://bioinformatics.tecnoparco.org/snpchimp

operating system: platform independent

programming language: php, jquery-javascript, sql, python

other requirements: none

license: gnu gpl

any restrictions to use by non-academics: none

ezequiel l nicolazzi, andrea caprera and nelson nazzicari contributed equally to this work.

competing interests

the authors declare that they have no competing interests.

authors’ contributions

eln, ac, nn, fs, jlw and as conceived the study. eln retrieved the data, integrated the snp array information and coordinated the activity. nn built the database structure and the engine for the web-tool. ac built the user interface, and the connection to external databases, including ensembl biomart. pc built the scripts to link this tool to ensembl variant effect predictor. cs, cl, ap, fb, hj, ge, gtk, rb and bs provided current and historical original data, helped in the revision of the manuscript and in the improvement of functionalities of the tool. eln, ac, nn and pc drafted the manuscript. all authors reviewed, gave useful comments and approved the final manuscript.

