BACKGROUND
the process by which information from a gene is used in the synthesis of a functional gene product is called gene expression. the process of gene expression is used by all known life including eukaryotes, prokaryotes, and viruses to generate the macromolecular machinery for life. gene expression analysis is essential for biomedical research. the introduction of microarray technology has helped biomedical research make significant advances in the last decade by allowing high-throughput gene expression screening on all known genes. recently, the introduction of rnaseq technology has had a revolutionary impact on the field of expression research. rnaseq refers to the use of next-generation sequencing  technologies to sequence cdna in order to get information about a sample's rna content. compared to microarray technology, the rnaseq method offers several distinct advantages. first, the detection range of rnaseq is not limited to a set of predetermined probes as with microarray technology, so rnaseq is capable of identifying new genes. second, the resolution of a microarray is limited to the gene level for most arrays and the exon level for specially designed exon arrays. on the other hand, rnaseq can detect expression at the gene, exon, transcript, and coding dna sequence  levels. finally and most importantly, rnaseq can detect structural variants such as alternative splicing and gene fusion. with the maturity of ngs technologies, the price of rnaseq has become comparable to microarrays. many researchers have predicted the inevitable replacement of microarray by rnaseq  <cit>  based on the competitive price and additional genomic information contained in rnaseq data.

with the rich genomic information rnaseq technology brings, it also comes with complication in the analysis phase. to date, the research community has not yet come to a consensus on the best approach for analyzing rnaseq data. the most popular normalization method for microarray data is robust multi-array average   <cit> , a form of quantile normalization. for rnaseq, one of the popular normalization methods is reads per kilobase per million mapped reads   <cit>  or fragments per kilobase of transcript per million mapped reads   <cit> . the rpkm of a gene is computed as follows: rpkm=109×cn*l, where  c is the number of reads mapped to the gene,  n is the total number of reads mapped to all genes, and  l is the length of the gene. fpkm is computed similarly to rpkm, except it accounts for the scenario in which only  <dig> end of a paired-end read is mapped. in addition to rpkm and fpkm, other read count methods based on possion, negative binomial, and bayesian methods also exist. each method has unique strengths and weaknesses. in this study, we focus on read count-based methods and systematically evaluate  <dig> rnaseq r packages including deseq  <cit> , degseq  <cit> , edger  <cit> , bayseq  <cit> , tspm  <cit>  and nbpseq  <cit>  using both real and simulated data. bayseq is considered an empirical bayes approach to detect patterns of differential expression, deseq and nbpseq are based on a negative binomial model, degseq and tspm are based on a poisson model, and edger uses empirical bayes estimation and exact tests based on the negative binomial.

method
the real rnaseq datasets were selected from the cancer genome atlas   <cit> . tcga is a massive, comprehensive, and collaborative project to catalogue genomic data for over  <dig> types of cancers by the national cancer institute , the national human genome research institute , and  <dig> institutes and centers of the national institute of health . gene expression profiling by rnaseq is one of the major components of genomic data collected by tcga. breast cancer is the only cancer type in tcga that collected expression data on a large quantity of tumor-normal paired samples. thus we selected breast cancer tumor-normal paired data  as our primary source of real rnaseq data. differentially expressed genes between tumor and normal were identified using all six methods at the significance level of  <dig>  with benjamin-hochberg false discovery rate  adjustment. to evaluate the consistency between the six methods, we computed pairwise spearman's correlations as well as intraclass correlation  for fold change values of all genes, along with the corresponding p-values. in addition, we evaluated each method's running time.

for each gene, the count is drawn from the negative binomial distribution with the mean and dispersion parameters estimated from the tcga breast cancer dataset. for a given gene m, the fold change is calculated as dm where ρm is drawn from the gamma distribution with shape parameter  <dig>  and rate parameter  <dig>  , ρ* is the lower bound of fold change, and

 dm= <dig> ifgenemisupregulated- <dig> ifgenemisdownregulated <dig> otherwise. 

we evaluated the methods using datasets simulated to present different scenarios corresponding to a given combination of the following parameters: sample size , proportion of differentially expressed genes , ratio of up-regulated vs. down-regulated , lower bound of fold change , and lower bound of depth . a total of the seven most representative scenarios are shown in table  <dig>  for each scenario,  <dig> datasets were simulated from a negative binomial distribution. to evaluate the performance of the six methods, we calculated the number of genes that are significantly differentially expressed , the rate of false positives , and the rate of true positives  across  <dig> simulation datasets for each scenario. false discovery rate  at levels of  <dig> ,  <dig>  and  <dig>  were used as the cutoffs. in order to measure the overall performance, we also computed the area under the curve  across  <dig> simulation datasets under each scenario.

RESULTS
we performed differential expression analysis on the  <dig> tumor-normal paired samples from tcga using all six methods. out of  <dig>  genes, degseq identified the most number of significant genes at  <dig> . that is,  <dig> % of all genes were identified by degseq as statistically significantly differentially expressed between tumor and normal, which implies that degseq is over-sensitive. deseq on the other hand identified the least number of differentially expressed genes with  <dig> , which is still too many to be biologically plausible. nbpseq, edger, tspm, and bayseq identified  <dig> ,  <dig> ,  <dig> , and  <dig>  differentially expressed genes respectively . in terms of up-regulated genes vs. down-regulated genes, deseq, edger, and nbpseq identified more up-regulated genes, while tspm and degseq identified more down-regulated genes. bayseq does not provide fold change or test statistics, thus no direction of gene expression change can be determined through p-value alone. a unique characteristic associated with bayseq is that there is a randomization factor built into its computation model. using bayseq to analyze the same dataset on same parameter settings twice will generate slightly different results. in our scenario, the difference can be as many as  <dig> genes.

next we computed the overlap of differentially expressed genes between methods for both up-regulated and down-regulated genes. bayseq was excluded from this analysis due to its lack of directionality . for down-regulated genes,  <dig>  were identified by the rest of five methods, and for up-regulated genes,  <dig>  were identified by all five methods. deseq, edger, and nbpseq observed the fewest singleton genes  in terms of both up-regulated and down-regulated genes. tspm observed a moderate number of singleton genes, and degseq observed the most, which is also a reflection of its over-sensitivity.

we studied the relationship of fold change and p-value vs. identification frequency of significantly expressed genes detected by the six methods . as expected, genes identified by all six methods had a stronger signal  than genes identified by fewer methods. the singleton genes had the lowest fold change values . however, for p-value the pattern was not clear. no significant association between p-value and identification frequency was observed.

we also tested the consistency among the six methods at overall significance levels. pair-wise spearman's correlation coefficient of fold change values was computed . most correlation coefficients are very close to  <dig>  which indicates that the six methods are highly consistent in terms of ranking genes according to fold change despite difference in normalization method. we also computed intraclass correlation coefficients  using both fold change and p-value as well. the icc based on fold change was  <dig>  which strongly suggests that a high degree of agreement among the five methods  as the fold change value is only affected by different normalization techniques used by different methods  however, the icc for p-value was only  <dig> , indicating that these methods have a low agreement in terms of ranking the differentially expressed genes. in addition, bayseq produced the worst p-value correlation with regard to the other methods. to assess accuracy, one has to know a priori which genes are differentially expressed between normal and tumor. hence, we can only calculate it in a simulation.

for simulated data, we compared the number of genes that are significantly differentially expressed. in contrast to the results from real data, bayseq identified the smallest number of differentially expressed genes, while degseq identified largest number of differentially expressed genes, significantly more than other methods . deseq, edger and nbpseq identified similar numbers of differentially expressed genes. the similar performance of deseq, edger, and nbpseq is probably due to the fact that these methods are based on similar principles except the estimation of the dispersion parameter. among all six methods, bayseq has the smallest fpr, and degseq has the largest fpr. this indicates that bayseq was more conservative compared to other methods. among deseq, edger and nbpseq, the largest fpr was found by nbpseq, followed by deseq or edger. in general, the fpr of deseq was smaller than the fpr of edger. for tpr, the largest tpr was found by degseq , followed by tspm. as expected, deseq, edger and nbpseq obtained similar results in tpr. after comparing the results under scenarios i and ii, we found that sample size has a large effect, especially for tpr. as sample size decreases, ns decreases, fpr increases, and tpr decreases, respectively. tspm shows the strongest effects on sample size among the methods. after comparing the results under scenarios i and iii, we found that the proportion of differentially expressed genes has a relatively small effect on fpr and tpr for all methods. as the proportion decreases, all of ns, fpr, and tpr decrease. after comparing the results under scenarios i and iv, we found that the proportions of up-regulated and down-regulated genes have a large effect on ns and fpr for tspm and nbpseq. after comparing the results under scenarios i, v, and vi, we found that the level of treatment effects and depth of reads have small effects for all of the methods under reasonable sample size. comparing the results under scenarios i and vii, all methods are sensitive to the sample size, level of treatment effects, and depth.

in table  <dig>  we summarized the average auc-roc for each scenario. for each scenario, degseq has less satisfying performance compared to the other methods. under scenarios ii, v, and vii, the average auc-roc of bayseq was the largest. those three scenarios were simulated for the dataset with small sample size or small treatment effects. this indicates that bayseq is the best performing method when the dataset has a small sample size or small treatment effect. under other scenarios , the best performance was generally obtained by edger and deseq, followed by nbpseq and tspm.

we also measured the runtime for each method running on the tcga breast cancer dataset. on a dell  <dig> with a  <dig> ghz cpu and  <dig> gb ram, deseq took the most time to finish with over  <dig> hours followed by nbpseq , bayseq . tspm and edger took significantly less time in comparison with  <dig> and  <dig> minutes, respectively. degseq was the speediest of the six, finishing in only  <dig> seconds. combining information from both runtime and auc, edger performed best with relatively short runtime and good auc-roc.

CONCLUSIONS
in this study, we systematically evaluated six read count-based rnaseq analysis methods using both real and simulated data. bayseq is the most unique method out of the six, because it is based on an empirical bayesian approach which produces no fold change or test statistics to infer the direction of the gene expression difference. this inconvenient feature of bayseq forces users to go back to the raw expression value to determine the direction. another unique characteristic of bayseq is the randomization steps involved in its model. for the same data with the same parameter settings, bayseq produces slightly different results. granted, genes with the strongest fold change will always be detected by bayseq, but this minor inconsistency between runs of bayseq does produce some inconvenience. from our simulation study, we found that the performances of deseq, edger, and nbpseq are similar in most cases. this result is expected because all three methods are based on a negative binomial model and differ principally in the way the dispersion parameter is estimated.

one of the issues we observed with these six read count-based rnaseq analysis methods is that they tend to be over-sensitive. for a traditional microarray study, the number of differentially expressed genes identified by a simple method such as a t-test is highly dependent on the sample size. we have tested these six methods using smaller sample sizes such as  <dig> vs.  <dig>  but the majority of the methods still produced huge amounts of differentially expressed genes , which is a clear sign of over-sensitivity. through more thorough analysis, we found that the five methods  produced very similar fold changes but less similar ranks of p-value. given these facts, we would recommend using the combined criteria of fold change and p-value to filter out more false positives. combined with evaluation of runtime from real data and auc-roc from simulated data, edger achieved a good balance between speed and accuracy.

we are far from reaching a consensus on the best rnaseq analysis approach. several unique characteristics of rnaseq data contribute to the difficulty of rnaseq data analysis. the value for non-expression in rnaseq is zero, which means there are no reads aligned to the gene. in microarray, there is always background intensity for non-expressed genes, thus we can always take log transformations of the intensity data. in contrast, due to the large number of zeros in rnaseq data , we cannot take a log transformation. the range of rnaseq data is between  <dig> and  <dig> , compared to microarray's  <dig> to  <dig> after rma normalization. this huge range of rnaseq data can result in many false high fold changes. also, there are many sequencing and alignment artifacts that can skew rnaseq data. for example, gc content plays an important factor in the sequenceability of a gene, and the exon's length has a large effect on alignment accuracy. to date, only  <dig> rnaseq package, deseq takes the paired data information into consideration. in summary, even though there are a large number of rnaseq analysis tools at our disposal, given the uniqueness of rnaseq data and the number of unsolved problems, there is still much room left to improve rnaseq analysis.

competing interests
the authors declare that they have no competing interests.

authors' contributions
yan guo and chung-i performed the analysis and wrote the manuscript. fei ye and yu shyr provided significant scientific input. all authors read and approved the final manuscript.

declarations
the publication fee of this manuscript is provided by harold l. moses chair in cancer research fund, vanderbilt university.

this article has been published as part of bmc genomics volume  <dig> supplement  <dig>  2013: selected articles from the international conference on intelligent biology and medicine : genomics. the full contents of the supplement are available online at http://www.biomedcentral.com/bmcgenomics/supplements/14/s <dig> 
