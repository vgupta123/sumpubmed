BACKGROUND
the computational analysis of dna, rna and protein sequences is a cornerstone of bioinformatics, enabling the study of genomes and protein families and providing the scaffold for a broad range of algorithms used in the analysis of biological data  <cit> . at the molecular level, many biological processes rely on the recognition of specific sequence patterns, or motifs, that define specific interactions between biological molecules  <cit> . the ubiquity of these motifs has led to the proliferation of a vast array of bioinformatics algorithms dedicated to the discovery and study of these sequence elements and their evolution . transcription factors modulate gene expression by binding to dna in the promoter region of regulated genes. this binding relies on the specific recognition of short  dna sequence motifs by the transcription factor  and, therefore, the discovery and characterization of tf-binding motifs is essential to our understanding of transcriptional gene regulation  <cit> .

the discovery of tf-binding motifs is based on the elucidation of statistically overrepresented sequence elements within a set of sequences known or suspected of harboring tf-binding sites . many algorithms for motif discovery have been developed over the years, but they can be broadly divided into word-based and probabilistic approaches  <cit> . word-based methods rely on the enumeration of oligonucleotides  <cit> , whereas probabilistic and machine learning approaches use models of varying complexity to represent tf-binding motifs, estimating model parameters through sampling or optimization techniques . central to these approaches is the definition of a robust statistical framework, a tf-binding motif model and its enhancement with heuristics based on knowledge of the underlying biochemistry. most motif discovery methods, for instance, can enforce symmetry in tf-binding motifs to enhance performance when the tf is known to bind as a homodimer  <cit> . similarly, the canonical position-specific weight matrix  model for tf-binding motifs, which assumes positional independence in the motif, can be extended to accommodate variable spacing or positional dependencies . determining the proper model for tf-binding motifs also plays a pivotal role in other aspects of their analysis, such as the search for tf-binding sites or the use of simulations to analyze tf-binding motif evolution .

in principle, many properties observed in experimentally determined collections of tf-binding sites could be used to enhance algorithms involved in the discovery, search and evolutionary simulation of tf-binding motifs through the inclusion of heuristics or the adoption of expanded models. a principled introduction of such enhancements, however, requires that the properties of naturally occurring tf-binding motifs be contrasted with those of random ensembles of motifs matching some of their defining statistics. indeed, the practice of comparing empirical data to the statistics of random ensembles is common in other fields such as complex network analysis  <cit>  and systems biology  <cit> . comparatively little attention, though, has been paid to the problem of defining such ensembles for biological sequence motifs and designing algorithms to sample them efficiently.

as a measure of the optimal mean message length required to encode samples from a probability distribution, information content  serves as a unifying statistic of sequence conservation  <cit> . here we propose and characterize two different algorithms to sample from the set of dna motifs matching a desired value of this most fundamental statistic.

we demonstrate their use by analyzing the informational gini coefficient  of tf-binding motifs. assuming that transcription factor binding motifs require a certain amount of information in order to effectively address their regulated genes, it is an open question how this information should be distributed among the positions of the motif.

researchers have long noted disparity in the degree of conservation between the columns of prokaryotic transcription factor binding motifs  <cit> . a theoretical rationale for this disparity has been proposed based on the observation of sine wave-like patterns in motifs bound by multimeric transcription factors. regions bound through direct readout by each tf monomer require a higher degree of conservation than “spacer” regions involved primarily in backbone contacts, leading to wave-like differential patterns of information content in collections of aligned sites . the variability in spacing between the monomer binding sites of different tfs  complicates the analysis of such patterns and the evaluation of their statistical significance. igc measures the degree of departure from uniformity in the distribution of positional information content across a motif, without any assumptions on the particular shape of such distribution. igc therefore provides a formal and generic statistical framework to analyze deviations from uniformity in the positional distribution of information of biological binding motifs, such as those imposed by multimeric binding.
fig.  <dig> distribution of igc values. for prokaryotic and eukaryotic motif collections, the distribution of igc is approximated by kernel density estimation. for each collection, the minimum, modal and maximum elements are depicted in sequence logos. prokaryotic motifs:  ompr,  lexa,  ntac. eukaryotic motifs:  nfat,  repo,  macho-1




importantly, the distribution of information across a motif is a global property of a motif  and, therefore, it cannot be analyzed via column-wise methods. hence, the use of random ensembles constitutes, to our knowledge, the only means of rigorously assessing the distribution of information content in tf-binding motifs. our results show that the degree of disparity in information content across positions, as measured by igc, is significantly higher in transcription factor binding motifs than in null ensembles with matched ic, and that higher igc is not consistently associated with motifs bound by multimeric tfs. this indicates that the higher unevenness in the distribution of information observed in biological motifs, as measured by igc, is an intrinsic property of tf-binding motifs, suggesting that this statistic could be exploited as a signature of biological authenticity in applications such as motif discovery.

methods
definition of the motif sampling problem
formally, we consider a motif to be a matrix of gaplessly aligned sequences. let us fix the length l of the sequence  and the number of sequences n, and consider the set ℳ of all motifs with dimensions n×l, which has 4nl elements. the choice to consider motifs extensionally as collections of sequences, rather than intensionally   <cit> , is motivated by the fact that any model of the data other than the sequences themselves is necessarily a lossy representation whose appropriateness depends on scientific context. in the interest of providing the most generally applicable results, we do not wish to commit ourselves to any particular representation of a sequence motif. instead we prefer to work with the sequences themselves. it is also important to note that our definition of a motif technically assumes some ordering on the sequences, whereas it is more natural in most sequence analysis applications to assume that the sequences are unordered. we opt for the above definition solely to simplify the combinatorics, and our results do not depend on a choice of ordering in any way.

a motif statistic is any function f:ℳ→ℝ. the motif sampling problem is then the following: given a motif m and a set of motif statistics {f
i}, sample motifs m
′ with matched values of the motif statistics, i.e. so that f
i=f
i for all i.

not all sampling schemes are good solutions to this problem—consider for example the trivial algorithm which returns only m itself with probability  <dig>  to exclude these trivial solutions we require that the values of the motif statistics be jointly sufficient statistics for the sampling probabilities, i.e. that the probability of sampling a given motif should depend only on its values of the motif statistics, and not on any other of its properties.

furthermore, some motif statistics may permit only the trivial solutions m≡m
′ identically, whereas we are really interested in the set of motifs whose statistics are approximately that of m. we therefore consider two relaxations of the motif sampling problem. on one hand, we may require the equalities to hold only in expectation, i.e. to satisfy f
i=〈f
i〉 when m
′ is sampled according to the desired algorithm. on the other hand, we may permit a small error tolerance and require only |f
i−f
i|<ε
i for specified values of ε
i.

in this work we consider several motif statistics. the first is the total positional entropy of the motif, given by: 
 h=−∑c∈m∑b∈{a,c,g,t}pclog2)),  where p
c is the sample frequency of base b in column c.1


second, we define the information content  of the motif to be the difference of the prior and posterior positional entropies, i.e.: 
  <dig> ic=hprior−h. 


this quantity can be interpreted as the reduction in uncertainty as to the identity of a nucleotide sequence of length l, given the knowledge that it is a functional binding site. supposing that the genomic background is well-approximated by a uniform random mononucleotide model, the prior genomic uncertainty is  <dig> bits/base, and eq.  <dig> reduces to: 
  <dig> ic=2l−h. 


the modern framework of information theory is due to shannon  <cit> , and the universality of motif ic as a measure of sequence conservation was first noted by schneider and co-workers  <cit>  in the context of transcription factor binding motifs. through an information-theoretical argument under certain simplifying assumptions, the latter showed that the ic of a transcription factor binding motif relates the specificity of the motif to the genome size g and regulon size n through the inequality, 
 ic≥log2gn,  with the bound expected to be sharp in prokaryotic tfs operating without co-factors, due to evolutionary optimality. although the bound may not universally hold in eukaryotic binding motifs due to the presence of co-factors and enhancers, ic has nevertheless become a basic statistic of interest in the bioinformatics of transcriptional regulation and molecular recognition generally .

lastly, we consider the informational gini coefficient  of the positional information, a measure of the disparity of conservation between columns. if c
 <dig> c
 <dig> …c
l are the ics of each column of m, sorted from least to greatest, then the igc is given by: 
 g=2∑j=1ljcjl∑j=1lcj−l+1l. 


geometrically, the gini coefficient may be interpreted as the area of the deficit between the cumulative distribution function of a given distribution and that of a uniform distribution over the same support. it ranges between zero in the case of a uniform distribution, and unity in the case of a degenerate distribution  <cit> .

on account of the centrality of ic in quantifying conservation in sequence motifs, we now turn to the problem of sampling motifs according to a specified value of that statistic.

maximum entropy approach
maximum entropy distributions
the problem of sampling motifs from a distribution whose desired value of entropy is fixed in expectation can be approached through the principle of maximum entropy   <cit> , a fully general probabilistic modeling technique only recently applied to nucleic acid motifs  <cit> . supposing a random variable of interest x with unknown distribution but the following observable constraints: 
  <dig> yi=〈fi〉,i∈{ <dig> …,n} 


the probability distribution over x with maximum entropy subject to these constraints is given by: 
  <dig> p=1zexp−∑i=1nλifi, 


where the conjugate variables λ
 <dig> …,λ
n must be tuned to match the expected values y
 <dig> …,y
n, and the partition function z ensures normalization. distributions of this form are maximally unassuming in the specific sense that no other distribution satisfying the constraints of eq.  <dig> can have greater entropy.

in this application, we choose the maximum entropy distribution over the set of motifs of given dimension, subject to a constraint on the expected value of the motif entropy itself. in practice one may consider constraining the ic instead, but this is equivalent to constraining entropy on account to of the definition of ic in eq.  <dig>  the resulting density takes the form of a boltzmann distribution with shannon entropy in place of energy: 
  <dig> p=1ze−λh, 


where, 
  <dig> z=∑m∈ℳe−λh 


is the partition function and λ is tuned so that 〈h〉p, the expected value of entropy when m is distributed according to p, attains the desired value.

this distribution satisfies the stated requirements of the first formulation of the motif sampling problem. the average value of the motif ic is respected, and the probability of a motif depends only on its ic and not on any of its other properties.

the description of a probability distribution, however, does not by itself suffice to sample from it. we complete this section by introducing an exact algorithm for effective sampling from distributions of this type.

maximum entropy sampling
in principle, any discrete maxent distribution can be sampled rather mechanically: one need merely compute the partition function in eq.  <dig> and employ the inverse transform method to obtain samples. in this application, however, z contains  <dig> terms and will be impossible to enumerate directly for all but the smallest dimensions.

distributions with intractable normalization constants are often approachable via markov chain monte carlo techniques . in the absence of an explicit convergence criterion, however, the practitioner must rely on heuristics or visual inspection to gauge approximate stationarity of the chain. for this reason, we are motivated to derive an exact algorithm instead.

let us first consider the set of motifs of dimension n× <dig>  i.e. those consisting of a single column of length n. the probability assigned to each motif in that set must depend only on its entropy, and hence only on the frequencies of each nucleotide. this observation permits us to partition the set of motifs into a smaller set of equivalence classes defined by equality of entropy. to understand this equivalence relation, we can define a counting function κ that takes each motif to the vector of its nucleotide counts 〈n
a,n
c,n
g,n
t〉. two motifs are then equivalent with respect to entropy if their count vectors are permutations of one another. to efficiently compute the partition function, then, it suffices to compute the entropies of each unique vector of counts  and weight them by the cardinality of their equivalence classes.

in detail, the entropy associated with a count tuple n→ is: 
 h=−∑b∈{a,c,g,t}nbnlog, 


next, define a weight function w by,





where ℳ is the set of n× <dig> motifs and ∼ denotes equivalence under permutation. informally, w counts the number of motifs that map to each distinct tuple. for ease of reference, when we consider equivalence classes of count tuples we will take the first element of the class, sorted lexicographically, as its distinguished representative. now it is possible to obtain a convenient closed form. to do so, we first define:





informally, m counts the multiplicities of each element of the count tuple. then we have: 
  <dig> w=4!∏b∈{a,c,g,t}mb!n!∏b∈{a,c,g,t}nb!. 


this formula has an elementary interpretation: the first term counts the permutation-equivalent count vectors, and the second term counts the number of motifs associated with each count vector.

at end, we need only compute the sum: 
  <dig> zc=∑n→∈n/∼we−λh, 


where n/∼ is the quotient of the set of count vectors by permutation equivalence, n→ ranges over the distinguished representatives of all equivalence classes, and we write z
c to remind that this is the partition function for a single column. in this way we can reduce the sum to a tractable number of terms that can be computed exactly. for n= <dig>  for example, there are fewer than 6× <dig> terms in the sum over equivalence classes, as opposed to approximately 2× <dig> in the full sum.

finally, having treated the single-column case, let us now consider multiple columns. because positional entropy is additive with respect to columns, we can rewrite the expression in eq.  <dig> as: 
 p=1zcle−λ∑j=1lh=1z∏j=1le−λh, 


where m
j denotes the jth column of m, and z≡zcl. the maxent distribution over motifs therefore factors into the product of maxent distributions for the columns. sampling a multiple-column motif is then only a matter of sampling l columns independently and adjoining them.

the expected entropy of a motif as a function of λ is given by: 
  <dig> 〈h〉λ=l∑n→∈n/∼hwe−λhz. 


the appropriate setting of λ for a desired value of entropy h
∗ can be found by solving: 
  <dig> 〈h〉λ−h∗= <dig> 


via standard root-finding algorithms  <cit> .

runtime analysis
the runtime of the algorithm described in the previous section is dominated by the task of estimating the parameter λ, which requires evaluation of the weight function in eq.  <dig> for every count vector as well as computation of the sum in eq.  <dig>  both of these tasks are linear in the size of the count vector quotient n/∼ defined in eq.  <dig>  the size of the count vector quotient is just the number of integer partitions of n having at most  <dig> parts. this quantity has a convenient closed form  <cit> , 
 |n/∼|=round3+32−9mod2) <dig>   which is o. once λ has been fixed, the remaining sampling steps require o) operations. the total runtime is therefore linear in l and cubic in n. although the time complexity of the algorithm is polynomial in both n and l, we caution as a practical matter that runtimes may still be long when n is large.

truncated uniform approach
truncated uniform distributions
while the maxent distribution described in the previous section is the maximally unassuming model for motifs of a given mean ic, the user might find it more convenient in some cases to explicitly define the range of permissible ic values to sample from. we therefore consider the task of sampling uniformly from the set of all motifs having a given ic of i±ε bits. this distribution has the form: 
 p=1z,|i−ic|≤ε <dig> otherwise  where z normalizes. this distribution satisfies the stated requirements of the second formulation of the motif sampling problem.

truncated uniform sampling
to sample from the truncated uniform distribution on ic we propose a rejection sampling algorithm  <cit>  that employs the maxent distribution as a proposal. fixing the desired ic i±ε, let 
 q=eλiczq  be the p.m.f. of a maxent proposal distribution with mean ic i. 

now let, 
 p=zp  be the p.m.f. of the target distribution. if there exists a positive constant c such that pcq≤ <dig> for all m, then it is possible to sample from p by drawing a sample m from q and a uniform random variate r from u <cit> , accepting m only if pcq≤r.

although both p and q contain intractable normalization constants, we can nevertheless write: 
 pq=p^/zpq^/zq=e−λiczqzp, 


and absorb the ratio zqzp into the constant c. from then on, we may simply consider the ratio of the unnormalized densities, 
 p^q^=1eλic,  which is maximized for i
c=i−ε≡i
min. therefore we set c=e−λimin. altogether, the acceptance ratio ar for a motif m drawn from q is given by: 
 ar=eλ) 


in particular, the acceptance ratio is never less than e
−2λε.

the total time required to draw one motif from p therefore goes as the product of t
q, the time required to sample from q, and 〈1ar〉q, the mean number of trials required in order to accept a sample. if ε is small, then we have tq∝1ε, whereas the mean number of proposals will be bounded above by e
2λε. hence the cpu time will go approximately as e2λεε, which is minimized for 
  <dig> ε=12λ. 


therefore, although it is possible to set ε to any desired value, an approximately optimal error tolerance follows directly from the runtime analysis.

parametric bootstrapping
for any motif m and motif statistic f, we may compute the bootstrap percentile of y=f in the following way. first we compute i=i
c, then sample m1′,…mn′∼i.i.d.p, for p the parametric density of our choice . setting yi′=f for each i, the bootstrap percentile of y is given by, 
 pbs=|{yi′|y′<y}|n,  or the fraction of observed bootstrap replicates having a value of the motif statistic f less than f  <cit> .

information content p-value calculations
maxent distributions subject to mean entropy may be exploited in order to estimate the p-value of a motif’s information content. in this application, the task is to determine the probability of observing a motif of given dimension with ic of at least i bits by chance. although exact algorithms for this problem have proven elusive,  <cit> , we suggest an application of the maxent framework to this problem, yielding an importance sampling estimate that may be bounded analytically, approximated by moment matching, or estimated efficiently through a monte carlo importance sampling estimate.

formally, the p-value of the information content i of a motif m is given by, 
  <dig> pval=1zp∑m∈ℳ, 


where z
p=4n×l. let q=1zqeλic be the maxent distribution subject to mean ic such that the expected ic under q is i. then eq.  <dig> can be recast as an importance sampling estimate, 
  <dig> pval=zqzp〈e−λic〉q. 


with the expectation taken according to q.

analytic upper bounds
we can obtain an upper bound on the p-value by noting that the expression inside the expectation, [i
c>i]e
−λic, will never be greater than e
−λi. under the assumption that the induced distribution on ic is symmetric about i, we can reduce this bound further by a factor of two since half of the samples will not contribute to the sum, yielding: 
  <dig> pval≤zqzp12e−λi. 


moment-matching estimates
it is also possible to estimate the expectation analytically. the distribution q over motifs induces a distribution i
c on information content which is approximately normal. the mean of that distribution is just i, by construction. the variance σ
 <dig> can be computed exactly by summing over count vectors in the fashion of eq.  <dig>  the expectation can therefore be recast as the integral, 
  <dig> 〈e−λic〉q≈∫i∞e−λxϕdx, 


where ϕ is the normal probality density function. this integral has an exact solution  <cit> , allowing the p-value to be written altogether as: 
  <dig> pval≈zqzp12e−λierfcxλσ <dig>  


where erfcx is the scaled complementary error function  <cit> . in fact, eq.  <dig> can be read as eq.  <dig> adjusted by a factor of erfcxλσ <dig>  which is bounded in the unit interval for positive arguments and captures the effect of the dispersion of the ic values from q about i.

importance sampling
finally, we note that the accuracy of these methods may be checked by simply taking an importance sampling estimate, drawing m
 <dig> m
 <dig> …m
n∼i.i.d.q and replacing the expectation in eq.  <dig> with a sample mean: 
  <dig> pval≈zqzp1n∑i=1ne−λic. 


conversion to e-values
to convert from p-values to e-values, which are more common in the context of motif discovery, we simply multiply the p-value by the number of alignments possible under the given data model   <cit> , various results for which are collected in  <cit> .

gc-content adjustment
as eq.  <dig> suggests, the maxent framework permits the incorporation of as many mean constraints as the modeler sees fit. we have chosen to focus on information content as a universal statistic of sequence specificity, but other constraints may sometimes prove desirable as well. in the context of transcription factor binding motifs, which draw their instances from typically at-rich promoter regions, one may prefer to control for gc-content as well as ic.

formally, this amounts to finding parameters λ and μ so that the system: 
 p=1zexpλic+μgc),〈ic〉=i,〈gc〉=g, 


is satisfied for desired ic i and gc g. in general, a system with multiple constraints might be solved by generic optimization techniques such as stochastic gradient descent. in this case, however, we can exploit the fact that the computation of λ is independent of gc in order to first fix mean ic, and then fix mean gc conditional on mean ic. in this way, we preserve both the exactness of the parameters and the efficiency of the sampling algorithm.

in particular, the expected gc-content of a column is given by: 
  <dig> 〈%gc〉=∑n→p∑g∈n→g·ue−μgz, 


where g∈n→ ranges over the possible gc-contents derivable from the count vector n→, u is the base probability of selecting a gc content of g from n→, , and z=∑g∈n→ue−μg is the partition function over gc levels for a given count vector n→. finding the value of μ that yields the desired mean gc-content is a one-dimensional root-finding problem that may be solved on analogy with eq.  <dig> 

we caution that ic and %gc are not independent: it is impossible, for example, for a column to be fully conserved while maintaining a %gc of  <dig> . in general, the minimum  %gc is given by ∑n→pmin{g|g∈n→}, . if desired %gc exceeds these bounds, then there will be no values of λ and μ that simultaneously satisfy the constraints. in our implementation, we check for existence of the solution and warn the user if necessary.

data curation
in our analysis we examined naturally occurring, experimentally validated transcription factor binding motifs from both prokaryotic and eukaroytic organisms. prokaryotic motifs were accessed from the collectf, mtbreglist, regtransbase, regulondb, dbtbs, and coryneregnet databases . eukaryotic motifs were accessed from the jaspar vertebrate database  <cit> . motifs that had fewer than ten sites, inconsistent lengths, fewer than five bits of ic, or which were derived from selex were excluded. motifs with more than  <dig> sites were randomly subsampled without replacement to a final depth of  <dig> sites.

provided that this down-sampling is performed at random, the only potential concern is small sample bias. the sample-size correction for ic is o  <cit> , amounting to less than  <dig>  bits per position when n= <dig>  since igc is a function of the positional ic values of a motif, its own small sample size correction is also negligible. statistics for down-sampled motifs can therefore be confidently imputed to the originals.

summary statistics are given in table  <dig> and presented graphically in an additional file .
minimum, median and maximum statistics are presented separately for prokaryotic and eukaryotic motifs. maximum statistics for number of sites refer to values prior to subsampling




hardware
all timing simulations were performed on a desktop workstation, using a single  <dig>  ghz intel xeon core with an 8mb cache, and  <dig> gb ddr ram.

software
algorithms described in this study are implemented in a python  <dig>  library available at github.com/poneill/formosa.

RESULTS
validation and performance
we begin by validating the output of both algorithms. figure  <dig> shows the distribution of ic of motifs sampled via both the maxent and tu distributions  under various parameter settings. in particular, the length of the motif was fixed at  <dig> bp; the number of sites in the motif n varied from  <dig> to 200; and the desired ic varied between  <dig> and  <dig> bits with a tolerance of ± <dig>  bits for the tu distribution. in each case we find good agreement between the desired and obtained ic values.
fig.  <dig> algorithm validation and runtime study.  sampled motif ic for maxent and truncated uniform algorithms, zeroed by desired ic. for a motif of length  <dig> and number of sites varying from  <dig> to  <dig>  each algorithm was called  <dig> times each with a target ic value of  <dig>   <dig> or  <dig> bits.  runtime per motif, using same parameters as above. times were averaged over three trials




in the lower panels we display cpu times required to perform the sampling. depicted for each parameter setting is the mean time required to sample a motif when requesting  <dig> random motif variates, with each call averaged over three trials. in all cases, the required time is less than 1s per motif.

to compare the distributions on igc induced by the maxent and tu distributions, we fixed motif parameters l= <dig> and n= <dig> and then sampled from each distribution, with desired ic increasing from  <dig>  to  <dig>  bits over  <dig> steps. results, shown in fig.  <dig>  show that the maxent and tu distributions have quite similar distributions of igc conditional on ic. in agreement with intuition, igc approaches  <dig> as ic approaches a maximal value of  <dig> bits per column, as all columns become fully conserved. as ic decreases , mean igc increases. to assess whether the distribution of igc conditional on ic differed between the two algorithms, maxent and turs igc values for each ic step were compared via kruskal-wallis test  <cit> . to account for multiple hypothesis testing, the significance level was adjusted via the benjamini-hochberg procedure  <cit>  to hold the false discovery rate  to  <dig> %. to within the limits of statistical power, there is no detectable difference in the distribution of igc conditional on ic between the two algorithms .
fig.  <dig> conditional distribution of igc given ic. for l= <dig>  n= <dig> and ic varying uniformly from  <dig>  to  <dig> bits,  <dig> motifs were sampled from the maxent and tu distributions for each ic value, and igc plotted against ic




igc in biological motifs
we then explore how the igcs of biological motifs compare to those from matched synthetic motifs. we separately considered the prokaryotic and eukaryotic collections of naturally-occuring, experimentally validated transcription factor binding motifs. for each motif we generated  <dig> matched motifs according to both the maxent and tu distributions, then compared the observed igc to the mean of the synthetic motifs. to explore the possibility of a relationship between igc and basic motif structure, we classified each motif as an inverted repeat, direct repeat or monomer. the results are shown in fig.  <dig> 
fig.  <dig> distribution of igc in biological vs. synthetic motifs. for both prokaryotic and eukaryotic motifs , observed igc is plotted on y-axis against mean sampled igc given ic on x-axis under maxent and tu distributions  colors and markers denote motif structure . the identity function y=x is plotted as a dashed line to guide the eye, and the axes have been truncated as an aid to legibility




for prokaryotic motifs, the pearson correlations between biological and synthetic igcs are statistically significant for both the maxent and tu distributions . for eukaryotic motifs, the correlations are even higher . it is clear that our model is capturing some fraction of the variation in igc. we also observe, though, that the biological values of igc are typically higher. this is especially true of eukaryotic motifs. the basic motif structure is indicated in the style of the marker, showing no clear relationship between structure and igc. for reference, the ic values of the biological motifs are also shown against the mean ic values of their matched replicates. these plots indicate good agreement in all cases.

to ensure that the effect observed in fig.  <dig> was not due merely to systematic differences in %gc between transcription factor binding motifs and random controls, we generated for each motif an ensemble of randomised motifs matching mean ic only, and a second ensemble matching mean ic and mean %gc. we then compared their distributions of igc in order to test for possible bias in %gc-controlled motifs towards higher igc values. in fig.  <dig>  we compare mean igc for each pair of ensembles, finding excellent agreement .
fig.  <dig> igc of maxent replicates vs. %gc-controlled maxent replicates. for each transcription factor binding motif, the mean igc of an ensemble of maxent replicates is compared to the mean igc of a second ensemble additionally matched for %gc. for each plot, pearson r> <dig> . the identity function y=x is plotted as a dashed line to guide the eye, and the axes have been truncated as an aid to legibility




igc as a signature of biological origin
noting that the igcs of biological motifs are generally higher than those of synthetic motifs with matching ic, we consider next whether this phenomenon could be employed as a predictor of biological origin. for each biological motif we compute the bootstrap percentile of its igc value from a sample of  <dig> maxent motifs. these percentiles are typically high; in the prokaryotic collection, for example,  <dig> of  <dig> motifs were found to have igcs greater than all  <dig> of their bootstrap replicates, whereas the number of such motifs expected by chance is less than one.

to construct a negative set, one maxent motif was sampled from each biological motif, and igc bootstrap percentiles were computed similarly. figure  depicts the resulting receiver-operating characteristic  curve for igc percentile as a predictor for distinguishing biological from synthetic motifs. an roc curve can be used to describe the performance of a binary classifier with a tunable threshold by comparing the true positive rate  to the false positive rate  over all possible values of the threshold. a perfect classifier can simultaneously achieve a tpr of  <dig> % and a fpr of  <dig> %, whereas for an arbitrary random classifier the tpr will generally be equal to the fpr for any threshold value. by integrating the roc curve, one obtains the “area under curve”  statistic, which will vary between unity for a perfect classifier, and  <dig>  for a random classifier  <cit> . in this case, the auc statistic is approximately  <dig> .
fig.  <dig> roc curve for igc as a predictor of biological origin. for all biolgical motifs in this study, the igc bootstrap percentile was estimated using a sample of  <dig> maxent motifs each, and compared to the igc bootstrap percentiles of an equal number of maxent negative controls. auc ≈ <dig> 




motif ic p-values
turning to the problem of estimating motif ic p-values with the maxent framework, we validate our methods in fig.  <dig>  fixing l= <dig> and varying n between  <dig>   <dig> and  <dig>  we estimate p-values according to the bounding and moment-matching approaches discussed above  for ic ranging between  <dig> and  <dig> bits. for further comparison, the cumulative density function  of the null ic distribution for each value of n was estimated empirically from  <dig> samples each. for ic values beyond the detection limit of direct sampling, p-values were computed by importance sampling , with  <dig> samples per data point.
fig.  <dig> ic p-value estimates. upper bounds and analytic estimates for motif ic p-values are shown for the parameter values l =  <dig>  n =  <dig> , <dig>  also shown is the empirical complementary cumulative distribution function of  <dig>  <dig> randomly sampled motifs, as well as p-values derived from importance sampling. inset: same data




the inset plot shows good agreement between both methods and the empirical complementary cdf, up to the event detection limit of 10− <dig>  beyond this limit, the methods continue to agree with the importance sampling p-values past 10− <dig> with the upper bound typically holding to within a single factor of ten. in fact these trends persist over the full domain of ic, though we have truncated the y-axis for clarity.

false-positive identification in motif-finding settings
in the previous section, we introduced methods to estimate the p-value of a given motif. conversely, these methods can also be applied to the problem of estimating the length of a collection of sequences to be input into a motif-finding algorithm in order to yield one motif of given dimensions and ic. this allows us to benchmark the advantages of the igc percentile as a potential filter for false positives in motif-finding algorithms. to this end, we considered another classification task similar to that of fig.  <dig>  but in which the negative set is drawn from motif-finding algorithms rather than from maxent distributions. for each motif in our collection we constructed random sets of sequences drawn either from a mononucleotide model or from the coding sequences of the escherichia coli k <dig> mg <dig> genome  <cit> . eukaryotic motifs were excluded due to the difficulty of generating synthetic false positives of such characteristically large size. e. coli genomic sequences were restricted to coding regions in order to preclude the possibility of recovering a genuine transcription factor binding motif. one motif of equivalent dimensions was then extracted from each collection using a gibbs sampling approach  <cit>  under the assumption of a one-occurence-per-sequence model. considering these motifs as false positives, we then attempted to discriminate them from true tf binding motifs as in fig.  <dig>  constructing  <dig> maxent replicates for each and measuring their igc percentiles. auc values range from  <dig>  for e. coli sequences to  <dig>  for synthetic sequences. we note in particular that for motifs drawn from e. coli sequences, classifying power is greatest for high igc percentiles and falls off to approximately random chance as the threshold decreases, whereas for random sequences the classifying power is approximately constant with respect to threshold. results are shown in the left panel of fig.  <dig> 
fig.  <dig> igc percentile roc curves in gibbs sampling and meme. prokaryotic motifs are distinguished from synthetic motifs on the basis of igc percentile. synthetic motifs were derived either from gibbs sampling  or meme , performing motif discovery on either e. coli coding sequences or a random mononucleotide model. for gibbs sampling, auc values are approximately  <dig>  for e. coli sequences and  <dig>  for synthetic sequences. for meme, auc values are approximately  <dig>  for e. coli sequences and  <dig>  for synthetic sequences




we next performed an analogous experiment with synthetic motifs drawn this time from the meme algorithm  <cit> . due to the computationally intensive nature of meme, seven large prokaryotic motifs timed out and were excluded from further analysis, leaving  <dig> motifs in total. the results, shown in the right panel of fig.  <dig>  indicate that the igc percentile criterion yields auc values of less than  <dig>  when used to discriminate tf binding motifs from false positives produced by meme.

to explore this last unexpected result, the distribution of igc percentiles for synthetic motifs drawn from randomized sequences through gibbs sampling or meme  are compared in fig.  <dig>  there we see that while the percentile distribution is roughly uniform for motifs found through gibbs sampling, there is a pronounced peak in high igc percentiles for motifs found through meme, indicating a bias in meme towards high igc, relative to expectation.
fig.  <dig> distribution of igc percentile for synthetic motifs. kernel density estimates of the distributions of igc percentiles are shown for synthetic motifs derived from random sequences via gibbs sampling and meme 




discussion
in this study we present a general framework for analyzing the properties of biological sequence motifs. this method arises from the general problem that, given a motif with some seemingly unusual feature, we often wish to know whether that feature is remarkable in the statistical sense. the question then arises of what to compare the given motif to. the most natural null distribution is the set of all motifs with comparable ic, but it is not obvious how to obtain them.

consider a motif of modest dimensions l= <dig> and n= <dig> with  <dig> bits ic, for example. there are 4200≈2× <dig> motifs of this size, of which we can calculate that approximately 2× <dig> have 10± <dig>  bits ic. the probability of obtaining one such motif by sampling uniformly at random is therefore on the order of 10− <dig>  implying runtimes longer the timescale of the universe. alternately, one could construct high ic motifs heuristically, but there is no guarantee that the resulting replicates would satisfy the requirements of the motif sampling problem as stated. to our knowledge, prior to this study the problem of sampling a motif with a desired quantity of ic has never been addressed.

the algorithms developed here allow users to sample from the space of all motifs of given dimension so that the generated variates have i bits of ic on average  or all have ic within ε bits of i .

validation and performance
while validating the methods, we noticed that although the agreement between specified and sampled ic in fig.  <dig> was generally good, the truncated uniform distribution was biased towards the lower endpoint of the ic interval, especially for large n. this is an expected consequence of the fact that the base density of motifs is approximately inversely exponential in ic. thus a distribution which assigns equal probability mass to all motifs in a given range of ic will be biased towards the lower end of the interval simply because there are more motifs there to be sampled.

due to the fact that the algorithm for the tu distribution employs a maxent sampler as a proposal for a rejection sampling scheme, tu runtimes are never lower than maxent runtimes for the same parameters. specifically, the tu runtimes go inversely with the acceptance ratio. for ease of comparison between parameter settings, we set ε= <dig> throughout and found acceptance ratios typically not less than 10− <dig>  this will naturally degrade, however, as ε→ <dig>  the user who wishes to maximize the acceptance ratio may set ε according to the heuristic we describe in eq.  <dig> 

when we examined the relationship between ic and icg generated by the maxent and tu distributions in fig.  <dig>  we saw that mean igc increases as ic decreases, a phenomenon due simply to the greater number of ways to satisfy the required ic with high disparity of conservation between columns, relative to the number of low-disparity solutions. the variance also increases with decreasing ic, indicating that low-ic motifs admit a wider variety of solutions in terms of columnar conservation.

igc in biological motifs
comparing biological motifs to random ensembles of synthetic motifs with matched ic in fig.  <dig>  we find that the ensemble statistics account for some fraction of the observed variation, leading to statistically significant correlations in both the prokaryotic and eukaryotic collections. on the other hand, we also find that biological motifs typically show higher igc than would be expected by chance. moreover, this phenomenon is independent of the choice of null distribution.

the conventional explanation for the inequal distribution of information content in tf-binding motifs is based in the informational footprint associated with sites bound by tfs in multimeric conformation  that is observed in a large fraction of prokaryotic tfs. the combination of low specificity binding at spacer regions with highly specific readout at monomer-binding sites leads to a characteristic wave-like pattern in the distribution of information content on aligned binding sites. we do not, however, observe any clear trend between motif structure and igc. furthermore, the pattern of greater than expected igc persists in eukaryotic motifs, where the large majority of transcription factors are monomeric  <cit> . comparisons between biological motifs and the synthetic replicates used to assess igc differences show good agreement in ic. hence the observed discrepancy in igc cannot be attributed to any discrepancy in ic introduced by the sampling process, nor to multimeric binding mode, and comparison of igc values for maxent ensembles with and without controlling for %gc in fig.  <dig> confirms that this deviation is not caused by %gc bias in tf-binding motifs. this suggests that the uneven pattern of information encoding seen in tf-binding motifs is the result of other biochemical or informational constraints on tf-binding site evolution.

dna accessibility on the axis of binding impacts the ability of proteins to specifically recognize individual dna bases, both across grooves and between them  <cit> , providing a potential explanation for the deviation in ic distribution observed in tf-binding motifs, independent of binding mode. the uneven encoding of binding information, however, can also provide advantages from an informational point of view. theoretical analyses have shown that the short length of tf-binding sites enhances their mutational robustness  <cit> . deviation from uniformity in the distribution of information across a tf-binding motif effectively translates into a form of site compression for mutational purposes, with conserved positions acting as hubs in the space of viable tf-binding sites, and hence provides an informational basis for the observation that tf-binding sites are both more mutationally robust and evolvable than one would expect by chance in sequences of similar length  <cit> .

igc as a signature of biological origin
as an illustration of possible applications, we have shown that the bootstrap percentile of igc is an effective feature for discriminating biological motifs from synthetic motifs of comparable ic. as a proof of concept, we consider the task of distinguishing biological motifs from ic-matched maxent control motifs. we employ maxent distributions as negative controls precisely because they are least assuming distributions that satisfy the expected ics. using only igc as a predictor to identify the biological motifs, we find that such a classifier achieves an auc of approximately  <dig> . crucially, this feature is orthogonal to ic, and can therefore provide an independent signal of biological authenticity in transcription factor binding motifs for ensemble classifiers. for example, consider the problem of prioritizing further research into putative motifs found through a motif discovery application. among motifs with equal e-values, there is no a priori reason to prefer one to another. by ranking the motifs according to their igc bootstrap percentiles, however, one can prioritize a random biological motif before a random false positive with about  <dig> % probability. this scenario suggests that the igc is a fairly robust signature of biological provenance in transcription factor binding motifs, and may therefore prove useful in the context of motif discovery as an adjuvant to conventional e-value-based methods of assessing significance.

motif p-values
next we turn to the exploration of motif p-value estimates depicted in fig.  <dig>  the problem of motif p-value estimation is central to the task of motif discovery, helping workers to distinguish between motifs likely to possess biological relevance and spurious results due to chance. the problem of statistical significance is especially acute in this setting since the search, being np-hard, takes place over a necessarily combinatorial space of possible motifs  <cit> . accordingly, motif p-value calculation algorithms tend to invoke the machinery of generating functions  <cit> , dynamic programming  <cit> , or related methods such as branch-and-bound algorithms implemented with fairly sophisticated data structures  <cit> . of interest to us was the question of whether the maxent framework could be pressed into service of the motif p-value problem in order to yield a conceptually simple monte carlo calculation or some related estimators.

comparing our methods to simulations in fig.  <dig>  we find strong agreement between the upper bound of eq.  <dig> and the analytic estimate of eq.  <dig> on one hand, and the empirical p-values found by direct sampling and importance sampling on the other. the strategy of bounding the p-value from above is an analytic result requiring no further assumptions, and in particular holds over all possible distributions on ic which satisfy the constraint on the mean. despite this generality, it appears to hold consistently within a factor of ten of the true p-value over a hundred orders of magnitude. the moment-matching estimate is more precise, but assumes that the distribution induced on ic is approximately normal. this assumption is easily granted when the dimensions of the motif are large, but even for modestly sized motifs  we found excellent agreement with empirical simulation. these estimators fall out more or less naturally from the maxent framework, and illustrate its utility in rare-event estimation.

after developing this application we noticed an interesting congruence between our rejection sampling algorithm and the method of hertz and stormo  <cit> ; the latter approached the p-value problem via large deviations theory and the method of exponential tilting, whereas we were motivated by the general task of sampling motifs via the principle of maximum entropy. ultimately, however, our approach allows us to derive p-value estimates and upper bounds which agree well with experiment over the entire domain of ic values without having to perform piece-wise approximations.

false-positive identification in motif-finding settings
when we considered the problem of distinguishing true tf binding motifs from synthetic motifs of equivalent dimensions generated by gibbs sampling, as in the left panel of fig.  <dig>  we found that the igc percentile method can discriminate true positives at a rate consistently better than chance. this was true of synthetic false positives generated both from e. coli coding sequences and a random mononucleotide model, although the asymmetric nature of the roc curve for synthetic motifs derived from e. coli suggests a depletion of low-igc motifs in that negative set. we note that this may be an artifact of the use of coding sequences, where the degeneracy of the wobble position in-frame may increase the variance of conservation by column, relative to what would be expected by chance  <cit> .

however, when we attempted to reproduce the performance of the icg percentile classifier with synthetic motifs inferred by meme , we found that igc percentile performed no better than chance at eliminating false positives. the reason for this result becomes clearer when we compare the distributions of igc percentiles for synthetic motifs generated by meme and gibbs sampling in fig.  <dig>  while the igc percentiles for gibbs sampling motifs are roughly uniformly distributed, those for meme motifs are strongly peaked about the maximum percentile value. this suggests a systematic bias in meme towards motifs with higher igc values, relative to what would be expected by chance, given ic.

this last finding should be interpreted as a caution, as it suggests that meme may be less suited than methods based on gibbs sampling to the discovery of low-igc motifs. in the context of the tf binding site motif discovery problem which originally motivated the development of the meme algorithm and provided its early test cases, such a bias is in fact generally helpful because tf binding motifs are also so biased . in other motif-finding applications, however, the benefits of a bias towards high-igc motifs is not as obvious, and might be taken into account when deliberating between meme and gibbs sampling methods which sample more evenly with respect to igc.

limitations and future directions
sample size
the runtimes of the algorithms presented in this work are cubic in the size of the motif, and this can present challenges for analyzing very large dna motifs. in practice we have elected to downsample such large motifs to a regime where the algorithms are tractable, yet the small sample noise for the statistics of interest is negligible. for column-wise information content , this trade-off is not difficult to negotiate. for other choices of motif statistic, however, it is incumbent upon the user to ensure that the distribution of the statistic under downsampling is comparable to the statistic of the full motif.

extension to the amino acid alphabet
in principle, the algorithms described above go through just as well for arbitrary alphabets other than nucleotides, including the standard amino acid alphabet. although we have described the algorithms in this study in terms of the dna alphabet for clarity, one may adapt them to any alphabet a rather mechanically, iterating over the elements of a where appropriate and replacing factors of  <dig> by factors of |a|.

we caution, however, that the time complexity is o in general, so that sampling for protein alignments in the standard amino acid alphabet goes as a 19th degree polynomial. this may render analysis of large protein alignments quite taxing.

extension to the continuous limit
the algorithms presented here are entirely discrete. when n is very large, however, it is tempting to pass to the continuous limit and treat the columns of a motif as elements of a probability simplex rather than as raw counts. maxent distributions subject to mean ic over probability simplices are formally equivalent to the “entropic priors” of the form p∝e−βh sometimes used in bayesian inference  <cit> . however, to our knowledge there are no exact sampling algorithms for such distributions.

another possibility is to construct a rejection sampling algorithm using a symmetric dirichlet distribution as a proposal, since it is straightforward to sample  <cit>  and the expected value of entropy can be found analytically  <cit> . rejection sampling, however, requires the ratio of target and proposal densities to be globally bound by a known constant that, while empirically well-behaved, appears difficult to obtain in closed form.

CONCLUSIONS
at root, bioinformatics is the study of patterns in biological sequence data. such patterns appear largely as conserved elements in collections of sequences, with the degree of conservation quantified in terms of positional entropy. the description of such patterns has two essential aims, one basic and the other applied. in terms of basic research, one would often like to infer the existence of a biological mechanism from an unusual pattern in sequence data. in terms of applications, one often seeks to find more instances of a motif in a database of sequences, given a few positive examples. searches based on information scores often suffer from large numbers of false positives, motivating the incorporation of additional features to further constrain a probabilistic model of the motif. both of these tasks assume, however implicitly, that the practitioner can recognize an unusual feature of a collection of sequences, over and above what might be expected simply by chance from any collection with a similar degree of conservation. to our knowledge the statistical problem of sampling such collections has never been formally addressed.

in this study we provide algorithms for sampling from the maximum entropy distribution over nucleic acid motifs of a specified dimension given mean ic, as well as from the truncated uniform distribution over all motifs of a given dimension having ic within a given interval. our methods allow researchers to ask, for any motif and motif statistic of interest, “how unusual is the observed value of the motif statistic among all similarly conserved motifs?” we note that in contrast to other strategies for sampling high-dimensional objects such as markov chain monte carlo methods, which generally provide samples from an approximation to the distribution of interest after long and typically uncertain runtimes, the algorithms described in this work are exact and efficient.

as one proof of concept, we investigated the distribution of igc in a large and diverse collection of transcription factor binding motifs. the marked disparity of conservation between columns of binding motifs has long been noted, but until now there has been no principled way of quantifying the excess over what is due to chance. this would be especially difficult for igc because it is a global statistic of a motif that does not reduce to lower-order functions of columns or column-pairs. its null distribution is analytically intractable, and thus it illustrates the advantages of the parametric bootstrap framework. as another potential use-case, we show that the igc percentile statistic can be used to help refine false positives from certain motif-finding algorithms. as a last illustration of the framework, we consider the motif p-value problem and show that it offers simple derivations of two powerful p-value estimators, as well as new interpretations of existing approaches.

additional file

additional file  <dig> contains a figure entitled “motif summary statistics”, being a graphical representation of the data in table  <dig>  




abbreviations
aucarea under curve

cdfcumulative distribution function

erfcxcomplementary scaled error function

fdrfalse discovery rate

fprfalse positive rate

gc% guanine + cytosine content

icpositional information content

igcinformational gini coefficient

maxentmaximum entropy distribution given information content

p.m.f.probability mass function

pswmposition-specific weight matrix

rocreceiver operating characteristic

tprtrue positive rate

tutruncated uniform distribution given information content

