BACKGROUND
computational complexity of molecular processes
bioinformatics researchers are concerned with discovering the structure and interactions of molecules, dna, and proteins. in this paper we refer to all major structures analyzed by researchers as molecules. each molecule is composed of specific substructures that are called domains. the interactions between molecules are caused in fact by interactions among the domains of those molecules.

cell-signaling systems involve an intricate network of protein-protein interactions. these interactions can have a number of consequences, including the post-translational modification of proteins, the formation of heterogeneous protein complexes in which enzymes and substrates are co-localized, and the targeted degradation of proteins. for understanding the system dynamics, the details that are most relevant are typically found at the level of protein sites or domains that are responsible for protein-protein interactions. despite the high relevance of the site-specific details of protein-protein interactions for understanding system behavior, models incorporating these details are uncommon. models that incorporate protein-site details are generally difficult or impossible to specify and analyze using conventional methods, largely because of the combinatorial number of protein modifications and protein complexes that can be generated through protein-protein interactions   <cit> .

rule-based modeling of molecular processes
the limitations of conventional approaches to model specification have prompted the development of formal languages specially designed for representing proteins and protein-protein interactions  <cit> . bionetgen is a language and software framework that uses graphs to represent protein-protein interactions  <cit> . bionetgen allows site-specific details and dynamics of protein-protein interactions in a systematic fashion. new algorithms permit efficient simulation of rule-based networks of virtually any size and complexity  <cit> .

a bionetgen input file contains definitions of molecules, reaction rules, chemical and mathematical constants, initial molecule populations, and simulation instructions. the models include definitions for the molecule itself, and also its domains and any associated bonds. domains may also have associated states, e.g. phosphorylated or unphosphorylated. each rule is defined by a set of reactants that are composed of molecules, domains, and states; followed by the post-reaction product which may include new bonds, broken bonds, or changed states of domains. in these rules, the molecules, domains with states, and bonds that are required for the reaction but are not changed by it are called the reaction context. conversely items that are changed by the reaction are termed the reaction center.

in bionetgen rules are applied iteratively to species to generate the partial or full set of reachable species and reactions. the resulting reaction network, composed of these species and reactions, is then simulated to obtain the population of each species as a function of time using for example numerical integration of ode's or stochastic simulation methods. an alternative approach is the so-called network-free method that performs a discrete event simulation on an instantiated set of molecules  <cit> .

related work
graphical representations of molecular processes -- primarily state-transition diagrams -- have been in use in biology textbooks as early as  <dig>  <cit> , and later on transitioned in the same diagram form into database systems such as kegg, emp, and ecocyc  <cit> . software systems for pathway design such as netbuilder, patika, jdesigner, or celldesigner  <cit>  have introduced additional notations for the same basic graph structure, while with the development of genomics new notations -- such as arcs, edges, and glyphs -- have been proposed for signaling pathways, and for incomplete or indirect information  <cit> .

kohn added a formal syntax to the set of symbols above that describes interactions and relationships of molecules in a rigidly defined schema known as molecular interaction maps   <cit> ; mim's provide guidelines and approaches to drawing static, schematic representations of signaling pathways. kohn's mim notation was followed by additional proposals  <cit>  describing process diagrams with both standard symbols and defined grammars. in a recent effort, the systems biology graphical notation  proposal  <cit>  is attempting to establish a community standard for biological notation.

the important observation here is that, while many graphical representations of molecular processes have been proposed, the construction of these representations is not automated, and the diagrammatic representations themselves are either non-computable or have limited computability due to combinatorial complexity. in other words, novel software tools are needed that can convert a graphically represented model into mathematical formulas for analysis and simulation.

a large number of systems have been developed to facilitate pathway construction and analysis, most notable among them genmapp  <cit> , cytoscape  <cit>  and its recent extensions  <cit> , pathwayassist  <cit> , patika  <cit> , gscope  <cit> , geneshelf  <cit>  and genespring  <cit> . for an extensive review of many of these systems, see saraiya et al.  <cit> . while many of these systems have complementary strengths in terms of the user requirements identified by saraiya et al.  <cit> , such as collaboration, context overlay, assistance for pathway construction, highlighting temporal information, etc., they are generally designed to facilitate integration of experimental data into the analysis process, with no emphasis on computational simulation. recent commercial attempts at combining visualization with simulation and modeling  <cit>  have employed rule-based languages, although the resulting visual representations are minimalistic and, to the best of our knowledge, not formally specified.

novel techniques are needed to integrate modeling, computational simulation, and visual analysis of biochemical systems in order to construct models of signaling pathways that are accurate, visually understandable, computable, and multi-scale.

workflow and task analysis
our first contribution is an analysis of the typical rbm workflow; of the tasks associated with this type of modeling, simulation and analysis; and finally an analysis of the potential modeling error sources. these analyses are based on on-site interviews conducted with rbm researchers.

the typical rbm workflow starts when a modeler is assigned a particular biological system and is asked to investigate certain properties of the system . the modeler begins by performing a literature search for the model; the required inputs are a set of molecules, their interactions, and parameters that quantify the concentration and strength of the interactions . biological databases have considerable information about biomolecules and their interactions but contain little information about parameters, which must be obtained from manual searching of the literature. the modeler then proceeds to write the system components and the set of rules describing the behavior of the system. once a working model has been defined, an rbm can be simulated using a number of different approaches including ordinary differential equations, stochastic simulations, or particle-based stochastic simulations. the output must be then analyzed and compared against other results. the typical workflow relies on an external plain text editor, command console, and external plotting tools for displaying simulation results, which is inconvenient because it requires modelers to switch between different tools over repeated cycles of model editing and simulation. the process gets further complicated when exploring alternative simulations and models.

to design our system, we extracted first the list of eight most frequently performed rbm tasks shown in table  <dig> . this set of tasks informed our system specification: at a minimum, the system needs to provide debugging capabilities, it needs to bridge model construction, simulation, and analysis, and needs to provide parameter scanning capabilities. next, prototyping revealed the necessity for clear yet concise visual abstractions that scale well with the possible sizes of the data sets to be visualized. finally, the interviews revealed additional system requirements such as an efficient workflow; a stand-alone system as opposed to a web-based one, on account of latency concerns; a system that is cross-platform and easy to install; and a tool that is usable with minimal training.

in attempting to provide debugging capabilities for such a system, we next discussed potential modeling pitfalls with our systems biology collaborators. three types of errors became apparent: syntactic, semantic, and biological errors. syntax errors are typos or incorrect usage of the modeling language. these syntax errors are the easiest to detect and repair, by using an appropriate editor with syntax checking, syntax highlighting and valid parameter name recognition. the second class of errors, semantic errors, occurs when a modeler produces code that is syntactically correct but is not the intended structure regardless of whether the intended model is biologically correct. for example, the model syntax is correct, but one rule introduces an unwanted complex; multiple rules interact, creating an unwanted effect; or the modeler simply misunderstood the model syntax/semantics. according to our end users, almost all interesting errors were of this second, semantic type. finally, biological errors occur when a user misinterprets the literature and aims to create a model that is incorrect with respect to known network structure; alternatively, the user may create a correct model but does not include the correct initial concentrations or reactions rates. due to the size and complexity of some models it may be impossible to detect such biological based errors without expert knowledge. however, the difficulties of detecting semantic and biological errors can be alleviated with visual representations of the model that focus on the molecule structure and interactions.

rulebender
to address the current difficulties of model creation and repair, simulation, and analysis we pursue an integrated design that includes  an editing environment,  built-in simulation execution,  complementary visual representations of models, and  simulation analysis capabilities in a multi-pane visual framework that collects the entire rbm workflow. given the complementary nature of the information involved in rbm, our top design uses a linked multi-view approach. the views are organized according to the workflow we identified earlier.

the visual interface incorporates text editing, visualization, and simulation execution in order to facilitate a faster and more productive rbm workflow. three main vertical panes are used. the first pane  provides a text-based model editor and a console window. in addition to standard text editor capabilities, the model editor provides a number of useful features for creating and editing rbms in bionetgen language  format.

the second main pane, the visualization viewer, is reserved for global and local visual representations of the rbm; its purpose is to assist the modeler in the process of debugging the rbm. these interactive visual representations help modelers form complex model structures and internal interactions progressively, rather than trying to build and keep track of a complete mental model from the start. the visual representations are generated automatically from the text-based representation , and updates in the model editor are reflected in the visualization viewer. logic errors in the rbm that cause parsing errors in the visualization viewer are reported in the console window of model editor . the human closes the loop, by repairing in the model editor the errors reported in the console, as well as any semantic errors detected via visual analysis.

after the first iteration of model construction, the modeler can generate an explicit network of the modeled system, and then run multiple simulations based on the generated network. the model editor provides integrated execution of bionetgen simulator commands through menus and toolbar buttons; these actions include parameter scanning operations that allow the interactive study of the effects of varying the value of a single model parameter. at this point, the visualization viewer pane is replaced by the third pane, the simulation results viewer. the two viewers can also be laid side-by-side. based on the analysis, the modeler could start a new iteration of modeling and simulation in order to revise the model or explore the effects of small model changes.

below we detail the data abstractions and algorithms specific to the model editor, visualization viewer, and the simulation results viewer. design decisions and revisions of these abstractions and algorithms were made in close collaboration with our expert end-users.

model editor
the model editor window provides an environment for creating and editing rbms in text-mode - the traditional approach to specifying biochemistry rule-based systems. the window is composed of a fully featured text editor and a console for reporting model syntax errors and simulation logs to the user. to facilitate comparative model exploration the model editor supports simultaneous editing of files through tabbing.

in order to expedite model construction, the model editor includes a bngl model template for creating new files. following the current specification of the bngl language, each bngl file must define a text block for parameters, molecule types, seed species, reaction rules, observables, and simulation actions. the parameters block holds numerical constants or equations that define concentrations of chemicals or rates of reaction rule occurrence. the molecule types block allows the user to declare the basic molecules that will appear in the model. in contrast, the seed species block states the starting collection of molecules for simulation and network generation. the reaction rules block is a collection of all of the possible chemical behaviors of the system. the observables block provides the user with the ability to mark certain molecules or collections of molecules for observation in the results of a simulation. finally, the simulation actions block comprises a list of instructions for how to execute a model. bngl simulation instructions support generating and simulating a network, managing molecule concentrations and parameter values, and saving models. code folding hides details of completed text blocks so that the unfinished features become more visually salient. syntax highlighting of keywords and language features - one of the earliest user-requests - also assists with understanding and debugging the syntax of the model. text selection results in an automatic search for the selected text and all found occurrences are highlighted.

in the process of incremental model construction modelers make syntax errors that are easily detected by a parser and reported through the console. however, semantic and biological errors are difficult to detect based on the textual representation only. to further support model exploration and debugging the visualization viewer provides both global and local views of the model currently loaded in the model editor: interactive contact maps and influence graphs.

interactive contact map
the first visual encoding we propose is the interactive contact map , a concise, scalable representation that provides a global view of the rbm. this encoding is an interactive graph representation of the molecules and the reaction rules governing the system. recall that in rbm, molecules are described as structured objects that are composed of domains that can have states and can bind to each other, both within a molecule and between molecules. also, reaction rules are the generators of species and reactions, which define all the interactions. given that reaction rules are an essential part of the model, the contact map needs to show not only the involved molecules, but also an overview and details of the various reaction rules.

data abstraction and representation
to keep the contact map concise and scalable, the molecules and internal domains defined in the model are displayed only once in the graph. molecules are rendered as large gray nodes and domain sites are smaller internal nodes. domain states , may be specifically required in certain reaction rules, and so are also displayed as nodes cascading from the domain sites to which they apply .

to add rule information to this representation, we next analyze the various reaction rules and find they fall into three categories. the most common and simple type of reaction rule defines bond creation or destruction between domains. a bond can only exist between two domains. for this type of rule, an edge connecting two domain nodes is created in the contact map. reaction rules that involve the same bond will be mapped to the same edge in the graph. in certain rules, specific domain states may be required in order to create or destroy the bond. in those cases the state node instead of the domain node is connected by an edge.

the second type of reaction rule defines state changes of domains. a domain can only have one state at a time, and the state can be changed based on reaction rules. adding an edge between two state nodes is not a good solution, because mapping two types of rules in the same way would cause confusion and adding more edges will increase clutter since the state nodes of one domain are positioned very close to each other in the graph. given these limitations and the importance of the state information, this type of rule is mapped to the target state node via color: domains that have their states changed via a rule are shown in purple as shown in figure  <dig>  the last type of rule defines molecular level interactions without domains involved, such as the degradation of proteins. in this situation, a hub node and several edges will be created to connect each reactant and product molecule in the rule .

next, we note that each rule has its own reaction center  and reaction context . we use bubble sets  <cit>  to display this information. the bubble sets algorithm draws an isocontour around all of the items in a particular set in order to more easily see set membership .

finally, feedback from more recent end-users revealed the need for a visual representation of the various molecule compartments  shown in figure  <dig>  the compartmental localization of model domains can be displayed when this information is provided by the modeler.

layout
we use force-directed layout algorithms  <cit>  to draw the contact map in an aesthetically pleasing way while minimizing edge crossings. a small overview window of the contact map helps the modelers to navigate large graphs.

the different types of nodes were assigned colors using colorbrewer  <cit> , which in turn follows tufte's principles for information encoding  <cit> . the primary nodes are shown in yellow , orange , or purple . domain states are shown in green , or gray  .

following the basic visual information seeking mantra  <cit> , the contact map first gives an overview of the model. pop-up menus provide filtering options such as showing or hiding state nodes in which case the endpoints of edges switch between domain node or state node accordingly. details of molecules and reaction rules are shown on demand. selecting an edge, a state node, or a hub node brings up a list of reaction rules, and selecting one of these rules brings up the bubble sets overlay highlighting the reaction context in blue and the reaction center in pink. selecting a molecule brings up a list of external links of available online resources in an annotation panel .

influence graph
while the interactive contact map shows in a compact manner the connectivity between the molecules within a model, the relations among the reaction rules may provide further insight into the model behavior. an influence graph  is an abstraction of complex reaction networks; influence graphs were originally introduced for the analysis of gene expression in the setting of gene regulatory networks. we extend this concept to rule-based modeling. rule-based influence graphs give an overall view of the activation/inhibition relation between the reaction rules that describe the behavior of a system.

data abstraction and representation
we identify four types of relations between reaction rules: full activation, full inhibition, partial activation and partial inhibition. the difference between the full and partial is that full means the firing of the influencing rule will definitely affect the rate at which the second rule fires, whereas partial means the firing of the influencing rule may or may not affect the rate at which the second rule fires depending on which specific species or agents are transformed by the influencing rule.

there are generally two steps to get the relation between two rules. the following description refers to the relation from rule  <dig> to rule  <dig>  recall that rules are composed of required reactants and post-reaction products. we use patterns to describe a component of the reactants or products that may overlap with another rule. figure  <dig> shows an example of pattern relations and rule relations that can be used to construct an influence graph:

step 1: attempt to match all of the reactant patterns of rule  <dig> onto the reactant patterns of rule  <dig>  if there is a full match, for example, from pattern  <dig> of rule  <dig> onto pattern  <dig> of rule  <dig> , then there is a full inhibition, as indicated by the red arrow in the left hand panel of figure  <dig>  a partial match indicates a partial inhibition. if there is no match of a reaction center element or conflict between any elements of the two patterns, then there is no inhibition. similarly, pattern matching from product patterns of rule  <dig> to reactant patterns of rule  <dig> can be performed to obtain the activation information.

step 2: with the relation information between the patterns of the  <dig> rules acquired in the previous step, we can summarize the information to get relations between the two rules. in the reduction a full influence should have higher priority than a partial influence.

through iteration of the above two steps between all pairs of reaction rules within the model, the influence graph information is algorithmically constructed. then we display the influence graph as a directed graph with nodes representing rules and edges representing relations between rules.

layout
similar to the contact map, we use colors, filtering, zoom in/out, focus plus context, and details on demand to design the visualization. different colors  <cit>  and shapes are applied to the edges to distinguish the types of relations: green was chosen for activation and magenta was chosen for inhibition. dashed lines represent partial inhibition/activation and solid lines represent full inhibition/activation. decorated edges were preferred to styled arrow heads to make the edge characteristics more easily visible at lower zoom levels. activation and inhibition filtering operations are also provided. selecting a rule node displays the rule text and filters the influence arcs related to this node .

we note that there are no certain patterns or obvious hierarchical structure among the relations. therefore we chose a linear arc diagram design. all the nodes are arranged in a horizontal line, with nodes sorted according to their connectedness, and arcs connect nodes representing relations symmetrically. the length and height of an arc depends on the horizontal distance between two nodes. the direction of an arc becomes very clear in this layout. the arcs above the horizontal line point to the right while the arcs below the horizontal line point to the left. a small overview window of the influence graph is also provided in the visualization viewer to help the modelers to navigate large graphs.

several graph-drawing approaches were attempted  for rendering the influence graph - including circular layouts, force-directed layouts, and several variations of the linear display. many of these attempts suffered from scalability problems. in the end, traits of the winning design were the linear, bilayered output , interactive filtering, providing the appropriate amount of detail , and the ability to link back to the textual representation.

simulation and simulation journaling
rulebender provides flexible support for multiple simulation modules, including parameter scanning, and for simulation journaling. a results viewer and a species browser further allow interactive plotting of simulation results, including comparisons of multiple datasets, and visual exploration of the resulting species.

simulation can be initiated after an rbm model has been constructed or loaded in the text editor. certain rbm simulation techniques require that the full reaction network for the model be first generated. during network generation, the rules defined in the model are applied to the initial species until a user-defined maximum number of iterations is reached or until no new chemical species are produced. after a network has been generated, simulation of the network can be carried out by either numerical integration of ode's or through a stochastic simulation of the model.

in contrast, on-the-fly simulation does not require a pre-existing network and generates the full network using the model rules as the simulation takes place. rulebender supports network-free simulation through the nfsim package  <cit>  which works entirely without network generation by using discrete-event particle-based techniques.

simulation actions can be listed and executed in order. intermediate versions of models that have been partially simulated or that are at equilibrium can also be saved for later use. notably, rulebender allows model-changing commands to be introduced in between these simulation actions. examples of model-changing actions include altering the concentrations of species or setting new parameter values for the rates at which rules occur. for example, a network can be generated, simulated to equilibrium with a subset of its species, and then simulated again after introducing a predetermined concentration of another species.

rulebender also supports a simulation technique called parameter scanning. in a parameter scan, the starting value of a single parameter is varied over many simulations in order to measure the effect of changing that parameter. visually mining the relationships between parameter values and outcomes is a direction of future work.

to support simulation journaling, simulation run results are stored in individual directories. each results directory is labeled with the model name and the time of the execution; the collection of results directories forms the model simulation journal. each directory includes log files, a copy of the exact model and parameters that were executed, the generated network, and the results of the simulation. time-series data resulting from simulations are stored in two files: cdat files contain concentration data over time for all of the generated species individually, and gdat files contain concentration data over time for the modeler-defined observables. an additional net file contains supplemental information about the fully generated network.

simulation results and species browser
results viewer
the simulation results viewer  provides support for exploring simulation journals, for interactive plotting including comparisons of multiple datasets, and for visual exploration of the resulting species.

the upper left pane of the of the simulation results viewer contains a tree-based structure corresponding to the journal of the simulation results. each node in the first level of the tree represents a single run of a simulation. when the user selects either of the simulation result files, the data are displayed in an interactive line or point chart in the large right pane. the modeler can analyze the results of multiple simulation runs using text, charts, and graphs. following the end-user requirements, the charts support both line and point representations of the data and can be rendered with linear or log scale on both axes. mouse brushing is used in order to zoom in and out on the chart. below the results file tree viewer, the list of generated species or observables is displayed with a check box next to each element. only the selected elements are shown in the chart.

species browser
the simulation results viewer is linked to a species browser  in the visualization viewer in order to further help examine the resulting species. the species graph abstraction is constructed similarly to the interactive contact map and alleviates the task of analyzing resulting species. specifically, the full network generation of a model creates many new chemical species. when a cdat file is opened in the simulation results viewer, the list of all of these species is displayed below the results file tree viewer. species from the list can be selected and visually represented in the species browser. similarly, when viewing the list of observables associated with a specific gdat file, nodes associated with an observable can be expanded to see all the species that contain the chemical species used to define that observable. selecting any of these species will also cause them to be displayed in the species browser. finally, right click context menus can be used to select text in the net files and then to display the selected species.

linked-views for visual debugging
based on our on-site workflow analysis, rulebender was designed to assist in the  <dig> phases of rule-based modeling  using at most two panes at once: the model editor and the visualization viewer for model construction, or the simulation results viewer plus the visualization viewer for results analysis. during modeling, the complementary views interact in order to assist with model exploration and debugging, whereas in the results analysis phase the species browser is used to visually show the chemical compounds that are being observed and the species that are created during network generation.

during the modeling phase the model editor is used in conjunction with the visualization pane. the user edits the text model in the model editor while the visualization pane displays the contact map and influence graph visual representations of the model. in addition to concurrent viewing of representations, interactions with the visualizations are propagated to the other views in order to visually link the model elements. selections of model elements in the contact map, including compartments, molecules, domains, domain states, rules, and multiple rules , result in model editor selections of the text that define the selected element . simultaneously, the contact map selections of rules result in the selection of the nodes and associated edges that represent those rules in the influence graph. similarly, selecting rule nodes in the influence graph causes model editor text highlighting of the rule text and the displaying of the bubble sets overlay that represents the rule in the contact map.

detail view
while the visualization of the textual model helps with global knowledge of the system being created, the specific details of model elements are important during debugging and exploration. for this reason, the detail pane, shown in the upper right of figure  <dig>  displays relevant textual data in a table format for the currently selected visual element. the selection of any visual element displays the name, bngl text definition for that element, and containing element where appropriate. the details table for molecule selection also shows a list of external links to online databases, such as uniprot and pathway commons, which have more information about that element. domain site selection also gives information about existing states, and state selection shows a list of rules that can affect the states. rule information is also shown in the details view, such as the rule identifier and rates.

linking the model editor, the contact map, the influence graph, the species browser, the detail view, and the results view assists the modelers in creating and debugging rule-based models. the multiple representations have complementary strengths in debugging model construction, as shown in our next section. additionally, both the contact map and influence graph visualizations enable quick identification of orphan molecules or rules that do not interact with other molecules/rules, thus further supporting understanding and debugging of the models.

validation and 
RESULTS
our next contribution is an evaluation of the utility and usability of rulebender, with the following three components:  a demonstration of rulebender's debugging capabilities on two case study models from our target user collaborators, who are systems biology researchers;  a qualitative evaluation of the system at a biology research lab, gathered through surveys and interviews; and  feedback from usage of the system as an educational tool.

case studies
egfr
this model describes early events in biochemical signaling through the epidermal growth factor receptor  which leads to differentiation and growth signals in cells. dysregulation of signaling pathways activated by egfr occurs in nearly all forms of cancer and mutations of egfr and molecules activated downstream of egfr are found in cancer cells at high frequency.

a senior systems biology researcher constructed an rbm model that is capable of predicting the dynamics of  <dig> molecular species, which are connected through  <dig> unidirectional reactions. the researcher commented on the usefulness of the compact contact map visualization for showing what molecules can be connected in a complex, while still capturing the complexity of the system. he then noted that the visualizations highlighted the importance of the shc aggregate  for recruitment: the key molecule sos can be recruited to receptor in two different ways, through egf-induced formation of egfr-grb2-sos and egfr-shc-grb2-sos assemblies at the plasma membrane . the highlighted rule also indicates that egfr dimerization  is a necessary condition for this recruitment to take place. according to the researcher, these observations were tricky to see from the text-based representation, and easily missed without rulebender. the researcher has adopted rulebender as a research tool and is using it as their primary interface to rbm.

lyn-binding
the lyn-binding represents early events in the antibody biochemical signaling process and is typically introduced as an exercise to junior researchers. the processes in the model are characteristic to allergic reactions, as well as to a system's response to injury or inflammation. rbm researchers have built a detailed mathematical model of reactions involving the receptor fcεri , the enzyme lyn, syk, and a bivalent ligand  that aggregates fcεri  <cit> , all shown in figure  <dig>  the model makes it possible to test the consistency of mechanistic assumptions with data that alone provide limited mechanistic insight. the signaling network triggered by fcεri plays a critical role in allergic responses and contains several targets for existing and proposed therapies for allergies.

in the model, signaling is initiated by the binding of ligand lig to the receptor rec, which leads to the formation of an aggregate containing two receptors. lyn is recruited to these aggregates through binding to one of the receptors. there are two modes by which lyn can associate with the receptor, one weak and one strong, depending on whether the receptor is already phosphorylated or not. several novice researchers were given a partial model of this network, and asked to add the correct rule for the low-affinity binding of lyn to the unphosphorylated b subunit via its u  domain. to prevent a single lyn molecule from bridging two separate receptors, they need to prevent the lyn-receptor binding from occurring if the lyn sh <dig> domain is already bound.

the researchers used rulebender to debug their construction and simulation of this process. the contextual information, as well as the state information, turned out to be essential in constructing the lyn-binding rule. without making sure that the rules require that the other site be unbound, it would be possible for lyn to bridge two separate receptors, thus potentially forming an infinitely binding chain . this small error was not readily visible in the text-based model without careful review, and was thus a major source of frustration. although the researchers routinely praise the benefits of rulebender syntax highlighting, integrated execution of simulations and result viewing, in this instance they were only able to track down the error-source through the bubble-set reaction center and context visualization. table  <dig> shows the correct and incorrect rule formulation, while figure 9a and 9b show a reduced view of the resulting contact map for both the correct and incorrect formulation . however, by using the bubble sets representation to explore the context and center of each reaction rule, the researchers noticed the missing context information in the incorrect rule formulation .

the bold domains are omitted in the incorrect rules.

junior researchers in the lab found the contact map and species browser visualizers "most useful." at the time, they commented that the influence graph had a nice look as well, but its main limitation were that the rules were difficult to track. the feedback led to several new iterations through the prototype, in particular, to the current influence graph visualization, in which nodes are labeled with rule mnemonics, as well as to the current design of linked views, where interacting with a graph node highlights the corresponding rule information in the text editor view.

qualitative evaluation
a series of interviews, as well as a pilot survey were conducted among four expert rule-based modelers from the department of computational biology in order to evaluate the relative merits of the various rulebender components. three of the expert users had already adopted rulebender as their primary tool for research, while the last one had used the system for less than one month. based on our analysis of the tasks typically performed in rbm, as well as on our analysis of error sources, the users were asked to rate on a scale of  <dig> to  <dig>  the usefulness of rulebender compared to command-line rbm with respect to the tasks listed in table  <dig>  the feedback shows that all the expert users found rulebender significantly easier to use compared to bionetgen command-line mode without visual interface, especially for tasks that require integration of the rbm workflow. the expert users were also asked to rate the relative usefulness of the various components of rulebender, also on a scale of  <dig> to  <dig> . the visual representations and linked views were rated as useful, while syntax highlighting/checking, journaling of results, integrated execution of simulations, displaying the reaction center/context via bubble sets and interactive plotting in the result viewer were uniformly rated as very helpful or even essential. in particular, we note that adding the bubble sets capability increased the rating of the contact map from useful to very useful. in addition, the expert users highly recommended rulebender as a teaching aid as opposed to bionetgen in command-line mode.

interview feedback remarked that rulebender was easy to use, it was lightweight and cross-platform, and required minimal installation. researchers commented that, based on their  <dig> year-long experience, tools lacking the above characteristics would just not be used. they also insisted on the benefits of a standalone system as opposed to a web-based application on account of latency; they explained that, unlike bioinformatics applications, systems modeling is typically cpu-bound.

educational use
rulebender has been successfully deployed and used as a rbm educational tool in undergraduate/graduate classrooms at pitt, cmu, and yale, as well as in a number of rbm workshops. feedback from the instructors regarding the value of rulebender was extremely positive . rulebender had "a nice feel and interface", and was "incredibly easy  to download and use". the system was "definitely simpler than running simulations through the other  interface, and could do just about everything we needed for the class assignments." finally, comments delivered the instructors' and students' excitement about rulebender , as well as wish-lists for future features.

we note that in the  <dig> months following the open source release of rulebender to the biology community, the system has been downloaded by  <dig> unique page visitors. the number of downloads comprises both research and educational use, however  <dig> downloads originate from outside of the united states and typically the temporal access patterns do not tightly coincide with classroom use.

discussion and 
CONCLUSIONS
the user feedback  emphasizes that any tool that supports rbm must allow the user to build, simulate, and analyze models in an efficient workflow. we found that our visual framework efficiently creates such an rbm workflow by integrating model creation, simulation and analysis. as a measure of success, our users quickly adopted the tool as their main interface to rbm. further feedback from the survey and interviews emphasizes that rulebender is a user-friendly research and educational tool.

the results shown in the egfr and lyn-binding case studies demonstrate the benefits of visualization in exploring and explaining modeling errors. in these instances, rulebender helped the researchers correctly and accurately gather observations and insights that were difficult to make otherwise.

the contact map visual representation helped the users see the model that they had written in a way that clarified its physical structures. bubble sets made a major difference in how useful the users found this representation. the influence graph, in turn, was praised for its ability to identify orphan nodes and subsets of rules, and give insight into the signal firing process. the combined representations thus have complementary strengths. although the local and global views of the models and their results are fragmented across multiple views, when combined in linked views and with details on demand, these views allowed the users to overcome several modeling pitfalls.

the contact map and influence graph representations were regarded as helpful additions to the tool, however, these visualizations may be further improved with biologically motivated or feature emphasizing layouts. in terms of scalability, models range in size from a few molecules and rules to dozens of molecules and hundreds of rules. contact maps are reasonably scalable, but for large models the global influence graphs can become overwhelming despite zooming and drill-in capabilities. furthermore, some biologists prefer symbolic forms to diagrammatic representations. future work will focus on these areas with particular emphasis on scalability.

in terms of limitations, although our task analysis identified several types of errors in model construction, from the syntactic level to the biological level, rulebender focuses primarily on detection of syntactic and semantic errors, with support for parameter scanning. detection of biological errors is a far more difficult task, and may require the development of expert systems.

furthermore, we note that rulebender responds satisfactorily to all the tasks identified through our rbm task analysis, with the exception of t <dig> "parameter estimation". although journaling  and the species and results browsers are  correct steps into alleviating this task, seamless integration with parameter estimation scripts appear to be important here and a direction of future work. a step further, and beyond the current scope of this work, is using the visual interface to create models, not only to debug them.

in terms of lessons learned from this collaboration, we found that a tight iterative prototyping loop was essential. the end users of rulebender  were also enthusiastic testers, and the cross-pollination of ideas is leading to further extensions of both the modeling language and the visual tools. furthermore, we emphasize that essential traits of such tools include engineering characteristics such as cross-platform, stand-alone, and ease of installation. in introducing rulebender to novice users, recording the steps taken to perform various designed exercises may be a valuable way to identify potential recurring user issues.

rule-based modeling of systems arises in other domains outside of biology, for example state-machine specification, process calculi, or semantic-web applications. solutions to scalability issues such as modularization or the development of typed systems transcend the specific domain boundaries, and are complementary to our visualization approach. we expect, however, that because of the complexity of biological networks  effective visualization will be an integral element of rule-based modeling frameworks.

in conclusion, we introduced a novel, powerful tool for the development of rbms. the tool makes rbm accessible to users with a wide range of computational experience, while providing a uniform interface across computing platforms. the support of rbm creation, debugging, and interactive visualization expedites the rbm learning process and reduces model construction time; while built-in model simulation and analysis with multiple linked views streamline the execution and analysis of newly created models and generated networks. a development cycle that includes close interaction with expert users allows rulebender to better serve the needs of the systems biology community.

list of abbreviations used
rbm: rule-based model; bng: bionetgen; bngl bionetgen language; egfr: epidermal growth factor receptor.

competing interests
the authors declare that they have no competing interests.

authors' contributions
ys wrote the initial bngl editor and contact map prototype. wx implemented the interactive influence graph, results analysis capabilities, and details view. ams designed and implemented the user interface, and implemented the interactive contact map and linked views. jrf provided expert systems biology feedback and helped direct the design of the tool. gem conceived of the project, designed user studies, and directed design and implementation of the tool. ams, wx, jrf, and gem contributed to the manuscript.

