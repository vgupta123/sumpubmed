BACKGROUND
the study of phylogenetics has a long tradition in evolutionary biology and countless statistical, mathematical, and bioinformatic approaches have been developed to deal with the increasing amount of available data. the different statistical and computational methods reflect different ways of thinking about the phylogeny itself, but the issue of "how to treat data" has often overshadowed another question, i.e., "where to collect data from?". we are not talking about the various types of phylogenetic information, such as molecular or morphological characters, but rather we refer to which samples should be analyzed.

in phylogenetic studies, investigators generally analyze subsets of species. for example, a few species are chosen to represent a family or another high-level taxon, or a few individuals to represent a low-level taxon, such as a genus or a section. as a general practice, choices are driven by expertise and knowledge about the group; key species and taxa of interest are determined and, possibly, sampled. for example, if a biologist is choosing a group of species to represent a given class, species from many different orders and families will be included. we term the degree to which this occurs the "phylogenetic representativeness" of a given sample.

this issue is rarely formally addressed and generally treated in a rather subjective way; nevertheless, this is one of the most frequent ways incongruent phylogenetic results are accounted for. it is sufficient to browse an evolutionary biology journal to see how often incorrect or biased taxon sampling is hypothesized to be the cause . we therefore aim to set up a rigorous taxon sampling method, which can be used alongside expertise-driven choices. many theoretical approaches have been proposed to drive taxon sampling: see  for a keystone review.

the concept of "taxonomic distinctness" was developed in the early 1990s among conservation biologists  <cit> , who needed to measure biodiversity within a given site or sample so to assess further actions and researches. basic measures of biodiversity take into account species richness and relative abundance  <cit> . however, it is clear from a conservationist point of view that not all species should be weighted the same. the presence and relative abundance of a species cannot capture all information on the variation of a given sample, and therefore a taxonomic component must also be considered in evaluating the biodiversity of a given site. this allows more realistic specification of the importance of a species in a given assemblage.

similarly, resources for conservation biology are limited, and therefore it is important to focus on key species and ecosystems according to a formal criterion. for this purpose, several methods have recently been proposed  <cit> . despite recent progresses in sequencing techniques, it is still worth following a criterion of "maximizing representativeness" to best concentrate on key taxa . nevertheless, this typically requires a well established phylogeny, or at least a genetic distance matrix, as a benchmark. these data are indeed generally available for model species or taxa with key ecological roles, but they are often unavailable in standard phylogenetic analyses. typically, if we want to investigate a phylogeny, it has either never been resolved before, or it has not been completely assessed at the moment we start the analysis. further, if a reliable and widely accepted phylogenetic hypothesis were available for the studied group, we probably would not even try to attempt to formulate one at all. this means that, while the above-mentioned methods may be useful in the case of well-characterized groups, an approach using taxonomic distinctness is more powerful in general phylogenetic practice.

our basic idea is that estimating the phylogenetic representativeness of a given sample is not conceptually different from estimating its taxonomic distinctness. a certain degree of taxonomic distinctness is required for individual samples chosen for phylogenetic analyses; again, investigators attempt to spread sampling as widely as possible over the group on which they are focusing in order to maximize the representativeness of their study. a computable measure of taxonomic distinctness is required to describe this sampling breadth.

in this article we propose a measure of phylogenetic representativeness, and we provide the software to implement it. the procedure has the great advantage of requiring only limited taxonomical knowledge, as is typically available in new phylogenetic works.

RESULTS
algorithm
clarke and warwick  <cit>  suggest standardizing the step lengths in a taxonomic tree structure by setting the longest path  to an arbitrary number. generally, this number is  <dig>  step lengths can be weighted all the same, making the standardized length measure to equal:  

where t is the number of taxonomic levels considered in the tree and n =  <dig>   <dig>  ..., n, where n is the number of steps connecting a pair of taxa . all taxa in the tree belong by definition to the same uppermost taxon. therefore, two taxa can be connected by a maximum of  <dig> steps.

however, it is also possible to set step lengths proportionally to the loss of biodiversity between two consecutive hierarchical levels, i.e., the decrease in the number of taxa contained in each one, as measured on the master list. branch lengths are then computed as follows: we indicate s as the number of taxa of rank t, with t =  <dig>   <dig>  ..., t from the lowest to the highest taxonomic level. two cases are trivial: when t =  <dig>  s equals to s ; when t = t, s equals to  <dig> . the loss of biodiversity from level t to level t +  <dig> is:  

the step length from level t +  <dig> to level t is the same as from level t to level t +  <dig>  therefore, path lengths are then obtained as:  

where lt is the path length from level t to level t +  <dig> and lt* is the reverse path length.

clarke and warwick  <cit>  found the method of weighting step lengths to have little effect on final results. however, we find that standardizing path lengths improves the method in that it also complements subjectivity in taxonomies; rankings are often unrelated even across closely-related groups. to us, this is the main reason for standardizing path lengths. moreover, adding a level in a taxonomic tree does not lead to changes in the mean or standard deviation of taxonomic distance  if we adopt this strategy. in addition, the insertion of a redundant subdivision cannot alter the values of the indices  <cit> . all these analyses are carried out by our phyre script .

our method based on clarke and warwick's ecological indices has the main feature of being dependent only upon a known existing taxonomy. this leads to a key difficulty: taxonomic structures are largely subjective constructions. nonetheless, we think that taxonomists' expertise has provided high stability to main biological classifications, at least for commonly-studied organisms, such as animals and plants. the degree of agreement which is now reached in those fields allows us to consider most systematics as stable. in our view, large-scale rearrangements are becoming more and more unlikely, so that this argument leads us to state that present taxonomies do constitute an affordable starting point for methods of phylogenetic representativeness assessment.

however, this is not sufficient to completely ensure the reliability of our method. knowledge is growing in all fields of evolutionary biology, and the increase in data results in constant refinement of established classifications. in fact, even if large-scale changes are rare, taxonomies are frequently revised, updated, or improved. therefore, we implemented an algorithm that allows for testing the stability of the chosen reference taxonomy.

essentially, our procedure can be described in two phases. in the first one, the shuffling phase, master lists are shuffled, resulting in a large number of alternative master lists. in the second, the analysis phase, a phylogenetic representativeness analysis is carried out as described above across all simulated master lists rearrangements. the shuffling phase is composed of three moves, which are repeated and combined ad libitum . these moves simulate the commonest operations taxonomists do when reviewing a classification. a large number of "reviewed" master lists is then produced, repeating each time the same numbers of moves. finally, the shuffling phase ends with a set of master lists. standard phylogenetic representativeness analyses are performed on each master list, and all statistics are computed for each list. in this way, a set of measurements is produced for each indicator. therefore, it is possible to compute standard 95%  confidence intervals for each one. this analysis phase gives an idea of the funnel plot's oscillation width upon revision. phylosample and phyloanalysis  are specific scripts dealing with the shuffling analysis: the former generates the new set of master list, whereas the latter performs phyre operations across them all.

all scripts are available online, and a windows executable version of the main script is also present: the software can be downloaded from the mozoo lab web site at http://www.mozoolab.net/index.php/software-download.html.

testing
in order to evaluate the method, we analyze phylogenies of bivalves  <cit> , carnivores  <cit> , coleoids  <cit> , and termites  <cit> . our reference taxonomies are millard  <cit>  for mollusks, the termites of the world list hosted at the university of toronto http://www.utoronto.ca/forest/termite/speclist.htm: consulted on 03/23/ <dig> and reference therein), and the online checklist of the mammals of the world compiled by robert b. hole, jr. .

results from avtd and vartd are shown in figures  <dig> and  <dig>  respectively. funnel plot are based arbitrarily on  <dig> random samplings from the master list for each sample size. table  <dig> summarizes these results, showing also results from ie.

dimension, number of taxa; avtd, average taxonomic distinctness; vartd, variation in taxonomic distinctness; ie, von euler's  <cit>  index of imbalance.

to assess the stability of our taxonomies by performing shuffling analyses on them, we fixed the amount of "moves" to be executed according to our knowledge of each master list ;  <dig>  new "reviewed" datasets were generated and then  <dig> replicates were again extracted from each master list for each sample size. funnel plots for avtd and vartd are shown in figures  <dig> and  <dig>  respectively.

each set of splits, merges, and transfers was repeated independently  <dig>  times on the relative master list. moves were applied to the specified taxonomic level. master list's size is reported to inform about the entity of the "reviewing" shuffle. size in operational taxonomic units  of the global taxonomic tree.

we conducted additional analyses on the dataset of bivalves with real and simulated data . data from bivalve phylogenies obtained in our laboratory at different times from different samples have been tested along with imaginary samples of different known representativeness. we use the letter r to denote real data sets analyzed in our laboratory. datasets from r <dig> to r <dig> are increasingly representative. in r <dig>  the subclass of protobranchia is represented by just one genus, and the subclass of anomalodesmata is completely missing. in r <dig>  we add one more genus to protobranchia  and one genus to anomalodesmata . in r <dig>  the sample is expanded with several genera from unionidae , heterodonta , protobranchia , and more anomalodesmata . while all high-level taxa were already represented in r <dig>  r <dig> is thus wider and more balanced in terms of sampling. r <dig> is identical to r <dig> with the exception of genus cerastoderma, which was excluded due to technical problems.

simulated data sets are indicated by the letter s. s <dig> is an "ideal" data set: all subclasses are represented with  <dig> species and  <dig> families, although the number of represented orders is different across the subclasses. s <dig> is biased towards less biodiversity-rich subclasses: it comprehends  <dig> anomalodesmatans,  <dig> palaeoheterodonts, and  <dig> protobranchs, along with only  <dig> pteriomorphian and one heterodont. s <dig> is strongly biased towards heterodonts, with  <dig> genera. pteriomorphians, palaeoheterodonts, and protobranchs are represented by one genus each, and there are no anomalodesmatans here. s <dig> is an "easy-to-get" sample, with the commonest and well-known genera , and therefore it is composed only by pteriomorphians  and heterodonts .

for this entire group of samples, from r <dig> to r <dig>  and from s <dig> to s <dig>  we conducted phylogenetic representativeness analyses to find out whether the method can describe samples following our expectations. funnel plots were constructed on  <dig>  replicates. results are displayed in figure  <dig> and table  <dig> 

dimension, number of taxa; avtd, average taxonomic distinctness; vartd, variation in taxonomic distinctness; ie, von euler's  <cit>  index of imbalance.

implementation
the distribution of avtd from k random subsamples of size s is typically left-skewed . this is not an effect of a low k, as increasing the number of subsamples the shape of distribution does not change. we follow azzalini  <cit>  in describing the skeweness with a parameter λ. the further is λ  from unity, the more skewed is the distribution. using the master list of bivalves and a dimension s of  <dig>  we estimated an absolute value for λ which is very close to unity , confirming that the distribution only slightly differs from the normal one. however, this was done only for one sample, and distributions vary across different taxonomies and organisms. similar considerations can be applied to vartd.

we represent in our avtd plots the lower 95% confidence limit . the maximum value obtained across all replicates for that dimension is also shown because it converges to the upper absolute limit as k increases. conversely, in vartd plots the upper 95% confidence limit and minimum observed value are shown, as lower values of variation are preferable . phyre produces funnel plots showing results from a range of dimensions s. this helps in evaluating the global situation and is very useful for comparing homogeneous samples of different sizes.

for the shuffling analysis, similar funnel plots are produced. the main difference is that for avtd the lower 95% confidence limit is not a line: here is shown the area which comprises 95% of values for each dimension across all shuffled master lists. the same applies for the avtd and vartd means, and the vartd upper 95% confidence limit.

output from phyre can easily be imported into a graph editing software like microsoft excel®.

discussion
"taxon sampling" is not a new topic by itself and several strategies have been proposed from different standpoints. as mentioned above, several criteria have been appraised, especially when an established phylogeny is present. long-branch subdivision , for example, has been proposed as one strategy; see hillis  for more strategies. much experimental interest has been focused also on outgroup sampling  and its effects. finally, whether it is preferable to add more characters or more taxa is a vexing question; several authors highlight the importance of adding new taxa to analyses . however, rokas and carroll  <cit>  point out that an increase in taxon sampling does not have an improving effect per se. nevertheless, they suggest several factors which may influence the accuracy of phylogenetic reconstructions, and among them the density of taxon sampling.

rannala et al.  <cit>  obtained more accurate phylogenetic reconstructions when they sampled  <dig> taxa out of  <dig>  rather than when  <dig> taxa out of  <dig>  were chosen for analyses, although in the latter case the taxon number was higher. this is rather intuitive, indeed, as taxon sampling is denser in the former case. each taxon was sampled with the same probability ρ in a birth-death process . interestingly, this is somewhat similar to our random subsampling process: the more dense is a sample, the more likely is it to be representative of its master list, despite the absolute number of included taxa.

however, our approach is very different, because it is completely a priori. the method can always be applied to any phylogeny, given the presence of a reference taxonomy and a master list of taxa. we find useful to start from the zero point of no phylogenetic information except for the available taxonomy. evolutionary systematics does indeed capture some phylogenetic information, because all taxonomic categories should correspond to monophyletic clades. we employ this preliminary phylogenetic information to assess taxon sampling .

this method can be applied to every kind of analysis, from molecular to morphological ones. furthermore, even extinct taxa can be included in a master list or in a sample: for example, the bivalve list from millard  <cit>  does report fossil taxa, and we left those taxa in our reference master list, as these are part of the biodiversity of the class. in fact, a good sample aims to capture the entire diversity of the group, thus including extinct forms. therefore, we suggest that molecular samples should be better compared to complete master lists, which comprehend both living and fossil taxa .

moreover, evaluating phylogenetic representativeness as described here has the great advantage of being largely size-independent: this is well shown by funnel plots of avtd and vartd . the mean is consistent across all dimensions s and it is very close to avtd or vartd values obtained from the whole master list . this fact, along with setting path lengths proportionally to biodiversity losses and rescaling their sum to  <dig>  has a very useful and important effect: adding new taxa or new taxonomic levels does not change any parameter in the analysis. this means that more and more refined analyses can always be addressed and compared with coarser ones and with results from other data.

most importantly, we checked the significance of both avtd and vartd results with one-tailed tests. the original test was two-tailed  <cit> , and this is the greatest difference between the original test and our implementation for phylogenetic purposes. in the ecological context, these indices are used to assess environmental situations, to test for ecological stresses or pollution. in such a framework, the index must point out assemblages which are either very poor or very rich in terms of distinctness. the former will constitute signals of critically degraded habitats, whereas the latter will indicate a pristine and particularly healthy locality, and ecologists seek explanations for both results.

in our applications, we want our sample to be representative of the studied group, so that a sample significantly higher in taxonomic distinctness than a random one of the same size can be very useful; indeed, it would be even preferred. for this reason, we state that a one-tailed test is more appropriate for our purposes.

all case studies rely on samples with good phylogenetic representativeness. nevertheless, one sample  is relatively small to represent its master list; this is shown by quite large funnels at its size. on the other hand, one sample  turned out to be strikingly representative of its groups: the avtd is higher  than the highest  found in  <dig> random subsamples. we recommend the former sample be taken with care for phylogenetic inferences . conversely, the latter sample is extremely more representative than the other three. highly representative samples are readily individuated by avtd and vartd funnel plots  as dots above the highest avtd and below the lowest vartd found across all random replicates.

this is naturally influenced by the number of such subsamples: the more subsamples that are drawn, the more likely is to find the absolute maximum  possible value. if k is sufficiently high, the absolute maximum  possible value is found for any dimension s, and no sample can appear above  those lines . therefore, we suggest to draw an intermediate number of replicates  to avoid this widening effect and identify more optimal phylogenetic samples.

shuffling analysis assesses the complex issue of master list subjectivity and, as such, taxonomy itself. master lists turn out to be substantially stable upon simulated revision, as shown in figure  <dig> and  <dig>  95% confidence areas are indeed generally narrow and the position of experimental dots is never seriously challenged. we used  <dig> replicates from  <dig>  master lists: this turned out to be sufficient to draw clear graphs, where borders are accurately traced.

an objective criterion to describe the amount of shuffling needed for this analysis is still lacking; however, each group of living beings has its own taxonomic history and its own open problems, therefore we think it can be very difficult to find an always-optimal criterion. an expertise-driven choice cannot be ruled out here. we suggest that, given the contingent conditions of a study, phylogeneticists choose the best degree of shuffling to describe their master list's stability. some taxonomical situations are much more consolidated than others; in some cases higher-level taxa are well-established, whereas in others agreement has been reached on lower-level ones. a formal criterion, like moving 10% of species or merging 5% of genera, will necessarily lose this faceting and complexity.

interestingly, the coleoid master list revealed itself to be the most sensitive to shuffling. the avtd funnel plot places the sample of  <cit>  exactly across the mean line, whereas it is close to the maximum line in the shuffling analysis . this means that avtd is globally lowered upon shuffling on the coleoid master list. in fact, whereas mean avtd on the original master list was close to  <dig> for all s, the 95% confidence interval on shuffled master lists is always slightly under  <dig>  conversely, vartd is over the mean in standard phyre computations, whereas it is across the minimum line in shuffling analysis : vartd mean changes from about  <dig> in the former case to around  <dig> in the latter one. the amount of shuffling we applied  is evidently heavy in this case. therefore, upon a taxonomic review, we would recommend to reconsider this sample and to perform a new phylogenetic representativeness analyses.

our method is also descriptive for comparing similar samples; this is a smart way to test the improvement of a phylogenetic study while adding one or more taxa to a given sample. it is clear from our r1-r <dig> example  the importance of adding just two taxa to the initial sample. the improvement is well depicted by avtd and vartd funnel plots: whereas r <dig> is just across the avtd lower 95% confidence limit of avtd, r <dig> is well above; whereas r <dig> is outside the vartd upper 95% confidence limit, r <dig> is inside it. while vartd remains close to the confidence limit, r <dig> and r <dig> are nevertheless even more representative in terms of avtd, as they lie precisely on the mean of  <dig>  replicates. this reflects the increase of sampled taxa with respect to several under-represented groups.

s <dig>  the "ideal" sample, turns out to have the highest avtd  and the lowest vartd . in this case, we have  <dig>  replicates; thus, the above considerations hold true and we do not expect our dot to be neither above nor below the funnel plot for avtd or vartd, respectively. sample s <dig>  biased towards less biodiversity-rich subclasses appears to be representative: it is well inside both funnel plots. three subclasses out of five are well represented here; this sample is therefore rather informative. however, it is clearly less preferable than sample s1; whereas the former lies always across or next to the mean line, the latter is always close to the observed extreme values. sample s <dig> seems reasonable in terms of vartd, but the avtd funnel plot identifies it as the worst of all. nevertheless, sample s <dig>  turned out to be even worse than s <dig> : it is below the 95% confidence limit of avtd and above the 95% confidence limit of vartd.

thus, joint analysis of avtd and vartd provides discrimination between samples. an avtd/vartd plot shows that these measures are generally negatively correlated, even if some exceptions are possible: good samples have high avtd and low vartd values; the opposite is true for bad samples .

along with the two main measures, ie can give an approximate idea of the shape of the tree. values >  <dig>  are often associated with biased samples , and thus we suggest this as a rule of thumb for directly discarding imbalanced ones. however, this cut-off value is only a rough guide in estimating phylogenetic representativeness: sample r <dig> has an ie of  <dig>  , but funnel plots identify it as a good bivalve sample.

CONCLUSIONS
phylogenetic representativeness analyses can be conducted at every taxonomic level, and including any taxonomic category. moreover, inclusion or exclusion of taxonomic categories does not influence results across analyses . although we did not present it here, the index can also potentially take relative abundance data into account . thus, it may be implemented for population-level analyses as well, depicting sampling coverage among different populations from a given section, species, or subspecies.

the main strength of phylogenetic representativeness approach lies in being an a priori strategy of taxon selection and sampling. therefore, it cannot take into account several empirical and experimental problems, which are not guaranteed to be avoided. for example, long-branch attraction depends essentially upon a particularly quick rate of evolution in single taxa  <cit> , which is only a posteriori identified. moreover, topology alteration due to outgroup misspecification remains possible, as phylogenetic representativeness deals only with ingroup taxa.

each particular study copes with specific difficulties strictly inherent to contingent conditions; for example, as a result of an unexpected selective pressure, one particular locus may turn out to be completely uninformative, even if the taxon sampling is perfectly adequate. nevertheless, in r1-r4/s1-s <dig> examples , our knowledge of bivalve evolution and systematics allows us to discriminate between suitable and non-suitable samples, and phylogenetic representativeness results matched perfectly with our expectations.

moreover, being understood that expertise is always expected in planning taxon sampling, we strongly suggest to set phylogenetic representativeness alongside a formal criterion for profiling phylogenetic informativeness of characters . put in other words, phylogenetic representativeness is a guarantee of a good and wise taxonomic coverage of the ingroup, but evidently it is not guarantee of a good and robust phylogeny per se. for this reason, we would suggest it as a springboard for every phylogenetic study, from which subsequent analyses can proceed further towards an affordable evolutionary tree.

