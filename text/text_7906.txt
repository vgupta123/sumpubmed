BACKGROUND
archerfish have the ability to down aerial prey by shooting precisely aimed jets of water according to size, distance and weight of the prey
 <cit> . as archerfish are swarm fish and compete for food, they need to calculate the impact point of shot down prey on the water surface, turn towards it, and match the swimming speed in order to be the first reaching the impact point. this calculation has to take place in the first few milliseconds of the prey falling and includes the trajectory of the prey, as well as the needed turning angle and the distance to the estimated point of impact. behavioural experiments show latencies down to  <dig> ms for the first motor reaction after presentation of a falling prey
 <cit> . fast turning and acceleration might be achieved by the archerfish’s c-start escape network, which involves large, reticulospinal neurons associated with the mauthner cells, and which shows fast responses to visual stimuli for life saving purposes
 <cit> .

throughout different species retinal ganglion cells are well known to process motion-related information like speed
 <cit>  or direction
 <cit> . in turtle and rabbit retina, for example, the firing rates of direction sensitive ganglion cells depend on a combination of both direction and speed of a movement
 <cit> . many of these studies focused on changes in the firing rate
 <cit> , where the number of spikes induced in a certain period of time conveys the necessary information. more recently, spike timing
 <cit>  with temporally precisely fired spikes increasingly attracted attention for understanding the neural code
 <cit> .

as archerfish show very short behavioural latencies to moving stimuli they are ideally suited to compare rate coding versus latency coding. in this study we, therefore, analysed archerfish ganglion cell responses to stimuli moving with various velocities and tested stimulus reconstruction quality using a maximum likelihood estimation procedure. we found that velocity reconstruction was superior using first spike latency in the reconstruction procedure, compared to first inter-spike interval and to spike rate.

RESULTS
the retina was stimulated with a black and white grating . the grating constantly illuminated the retina, with the contrast borders aligned to the electrode rows of the multi-electrode array . stimulation started by moving the grating up or down with one of  <dig> different, randomly chosen velocities. stimulation paused when the contrast borders reached the neighbouring electrode rows . movement direction changed after every second movement step. this ensured that the grating reversed in half of the stimuli.

generally, the recorded ganglion cells showed precise spike timing with short latencies after movement onset when stimulated with the different velocities. this is depicted in the example shown in figure
 <dig>  the raster plots show that all units elicited only a few spikes within a small time window . in this example spontaneous activity was completely absent, and at movement offset no responses were observed. the population psth of all units illustrates the sharp response peaks for all velocities .

comparison of stimulus reconstruction with latency, first inter-spike interval and rate
to see which response component conveys most information about the  <dig> velocities, we calculated latencies, the first inter spike interval  and the rate in a  <dig> ms time window after stimulus onset. in addition to the latencies calculated with respect to the known stimulus onset  we also calculated the population responses to the various velocities and determined the latencies of the single ganglion cell responses with reference to these population response onsets. this will be termed relative latencies in the following.

the tuning curves of the whole population in figures
 <dig> a – d show the velocity dependence of the respective response component. for absolute latencies the shortest median values of  <dig> ms occurred at stimulus speeds around  <dig> and  <dig> m/s in both directions . this is comparable to the response latencies to light flashes of the same intensity with an average value of  <dig> ms . latencies increased towards both higher and lower velocities. for the first isi no velocity dependence of the median values could be observed . however, the response variability for all cells taken together differed between downward and upward movements. the 50% percentiles increased for the upward directions. the same was true for the spike rate . response rate variability was smaller for downward movements compared to upward movements.

velocity estimation with the maximum a posteriori  estimator on basis of the respective response component is shown in figures
 <dig> e – h. estimations using absolute latencies yielded nearly perfect stimulus reconstruction . errors occurred mainly in mistaking the different velocities producing similar latencies, e.g. - <dig> m/s and - <dig> m/s or the same velocities for different directions, e.g. - <dig> and  <dig> m/s. this has an influence on the centre of mass for all estimations, which is mainly shifted to lower speeds both for downward and upward movements. the best estimation by a single trial was able to correctly reconstruct all velocities .

in contrast to absolute latency, the overall estimations based on first isi  or rate  were not able to reconstruct the stimulus velocity. the best trial yielded five correct velocity estimations out of  <dig> for the rate , but none for the first isi . in addition, the centres of mass showed clear direction dependence in case of the rate , yet within each direction velocity could not be discriminated. weak signs of direction discrimination were also found for the first isi, but the centres of mass were always in the region of estimated positive direction, independent of whether the stimulus direction was upwards or downwards .

absolute latencies versus relative latencies
these results show that velocity estimation with absolute latencies is superior to estimation with the first isi or the spike rate. the brain, however, has no knowledge about stimulus onset – information that is contained in absolute latency determination.

therefore, we compared velocity estimation based on the known stimulus  and the population response .

since the population response results from the addition of the single responses, the population response onset latencies consequently showed a similar behaviour as the average of the single ganglion cell response latencies . consequently, the tuning curve of the relative latencies of all ganglion cells, calculated with respect to the population response onsets, were rather constant around  <dig> ms . despite the fact that the tuning curve of the relative latencies of the whole population showed no velocity dependence, the accuracy of the overall velocity reconstruction was still acceptable . compared to estimation with absolute latencies , however, the centres of mass were more deteriorated, especially at higher velocities. the best trial still yielded  <dig> correct estimations out of  <dig> .

velocity tuning curve types for the different response components
the tuning curves of the whole population from figures
 <dig> a – d potentially mask ganglion cell subpopulations with differing tuning curves that might be important for stimulus reconstruction. therefore, cluster analysis was applied to separate the single cells into distinct types of velocity tuning functions based on their individual tuning curves. the median values of the relevant response components for each velocity were used from each individual cell, respectively.

three w-shaped tuning curve types could be discriminated for absolute latencies . they were symmetrical  or asymmetrical with shortest latencies for upward movement  or with shortest latencies for downward movement .

two tuning curves types were identified based on the first isi . one had very short first isi for all velocities  and the other type had short isi for downward movement and long first isi for upward movements , indicating directional tuning. the latter tuning curve type showed very high variability among cells for upward movement. both types exhibited little variability among cells for downward movements.

four tuning curves types were separated based on rate . three of them showed a similar asymmetry in variability among cells: high variability for upward movements, very precise rates among cells for downward movements . two of these tuning types  showed directional tuning and one had a flat tuning curve . the remaining tuning curve type is also flat, however, it exhibited similar variability among cells, both for upward and downward movements and a slightly lower average rate .

four tuning type clusters were identified for relative latencies . all of them showed directional tuning: one of them with longer relative latencies for upward movement , and three with longer latencies for downward movements . the latter three types were discriminated mainly based on the duration of the relative latencies: short latencies , intermediate latencies , and long latencies .

these results show that subpopulations of ganglion cells with different tuning curves exist for the various response components. by comparison of figure
 <dig> with figure
 <dig> these results also qualitatively explain the differences in stimulus reconstruction using the different response parameters. the good velocity tuning in all three tuning curve types for absolute latencies is in accordance with the good velocity reconstruction using this parameter . for rate the directional selective tuning curves of about half of the recorded cells are in accordance with the good reconstruction of movement direction , but since no velocity tuning exists in the tuning curves, velocity could not be reconstructed. in the case of the first isi only  <dig> out of  <dig> cells showed directional tuning, with high variability for upward movements among cells. in the reconstruction this obviously led to some degree of direction reconstruction, as indicated by the centres of mass in figure
 <dig> f, however, with a shift in the reconstruction to upward movement. for the case of relative latencies the tuning curves are qualitatively in good agreement with the centres of mass for velocity reconstruction shown in figure
 <dig> h. it remains still unclear, however, how the remaining velocity reconstruction, indicated by the diagonal in figure
 <dig> h, is accomplished.

comparison of individual experiments
the ability to reconstruct the different velocities on the basis of latencies differed between the individual experiments. whereas three of the five experiments showed a very good reconstruction using latency as response parameter , two experiments performed significantly worse , independently whether reconstruction was based on absolute or relative latencies .

when using absolute latencies for estimation obviously some information about stimulus velocity was retained in experiments  <dig> and  <dig> . most errors occurred in mistaking different velocities producing similar latencies or mistaking velocities for opposite directions. this information was gone when using relative latencies, where only estimation of the correct direction was possible in experiment  <dig>  and no correct estimation at all was possible in experiment  <dig> . the tuning curves of the population response onsets showed clear velocity dependence in all experiments , but the variability in experiments  <dig> and  <dig> was considerably higher. since the population response onset is determined by the sum of the single cell responses this led us to the suggestion that precision of single cell responses might vary between experiments.

precision of single cell latencies
the temporal difference between population response onset and the following spike of each individual cell, respectively, is the relevant parameter for the map estimation based on relative latencies. therefore, global tuning curves from all cells , and average tuning curve types from subpopulations of cells as shown in figure
 <dig> k - n, potentially mask important information retained in single cell tuning curves. an example is shown in figure
 <dig> for one cell from experiment  <dig>  the tuning curve for absolute latencies from this cell is symmetrical and belongs to the tuning type shown in figure
 <dig> a. however, the individual tuning curve shows considerable differences in the variability of the absolute latency between upward and downward velocities, not retained in the average tuning curve from figure
 <dig> a. a raster plot of the responses of this cell to all presentations of the stimuli with velocities of - <dig> m/s and + <dig> m/s illustrates this differing behaviour for upward and downward movement . this difference in variability is also visible for the tuning curve based on relative latencies , which belongs to the tuning curve type shown in figure
 <dig> m. in addition, this cell still exhibits shallow velocity tuning for upward movements, the region of the tuning curve with low variability.

this observation suggested that the estimation quality might correlate with the precision of the latencies of individual cells, which in turn might be different for upward and downward movements. with high precision latencies even a shallow velocity dependence will contribute to correct velocity reconstruction. therefore, we determined the quartile ranges as a measure of precision for each velocity and for each cell separately and plotted these values against the number of correct estimations for each cell. this was done for absolute and relative latencies, and the results are shown in figure
 <dig>  separately for the different experiments  <dig> to  <dig>  in the experiments  <dig> –  <dig>  with good reconstruction, quartile ranges were in most cases below  <dig> ms. in addition, the number of correct estimations correlated with the quartile range. a smaller quartile range correlated with a higher number of correct estimations, a larger quartile range with a lower number of correct estimations. this was independent whether absolute or relative latencies were used or whether upward or downward movement was applied. the difference between absolute and relative latencies was, however, that even for similar quartile ranges the number of correct estimations was always smaller when based on relative latencies . in contrast to experiments  <dig> to  <dig>  quartile ranges were mostly above  <dig> ms in experiments  <dig> and  <dig>  this correlated with low numbers of correct estimations.

when iteratively increasing the number of ganglion cells used for estimation, the calculated mean of the root mean square error  for stimulus reconstruction with relative latencies decreased for all individual experiments . experiment two  with the largest number of recorded cells  performed best with a mean rmse of  <dig>  m/s. in experiment  <dig> the mean rmse stayed almost constant at a high level . when estimating the stimulus velocity with all  <dig> units of the combined experiments, the mean rmse decreased to  <dig>  m/s with a parallel decreasing standard deviation.

discussion
archerfish ganglion cells are potentially able to contribute to the high speed calculation of a prey impact point on the water surface by coding different speeds and directions with precisely timed spiking. ganglion cell responses show a very low noise level and response rate. with latencies down to  <dig> ms after the onset of a moving stimulus some responses are faster than recorded latencies to light flashes of the same intensity and to ganglion cell latencies of other species to comparable moving stimuli e.g.  <dig> ms in turtle or  <dig> ms in rabbit and salamander
 <cit> .

precisely timed and directed motor reactions in archerfish can occur at latencies down to 40ms after presentation of falling prey
 <cit> . it is likely that this motor reaction is triggered by the mauthner cells
 <cit>  because these are directly electrically coupled to motorneurons over descending interneurons and hence permit very fast signal transmission of only a few milliseconds
 <cit> . mauthner cells are also involved in other visually evoked behaviour like looming, where latencies of  <dig> ms have been observed, and feeding
 <cit> . compared to sound induced responses with latencies of  <dig> to  <dig> ms
 <cit> , these longer latencies in these visually evoked behaviours reflect the comparably slow phototransduction and probably the increased amount of pre-processing, that might be involved to calculate the transformation of size and velocity and the potential time to collision with an approaching object, e.g. a predator. similar stimulus parameters must be estimated by the archerfish nervous system to calculate the point of impact of the prey on the water surface, but the behavioural response takes place on a much shorter timescale, suggesting a time-optimized neural code.

in this study the best velocity reconstruction could be achieved on the basis of absolute latencies. in the case of the reconstruction with rates performance was overall very poor, and in the case of reconstruction with first isi only some reconstruction of stimulus direction was possible.

therefore, archerfish ganglion cells might encode information about stimulus speed and direction through the precise timing of first spikes. since the brain has no knowledge about the stimulus onset, latency can only serve as a coding parameter when information about the stimulus onset is represented by the response of a cell population. precision of the single cell responses with respect to the population response onset becomes then an important parameter too. when taking the population responses of all recorded cells into account estimation of the  <dig> velocities with relative latencies was possible far above chance level and above the level achievable by estimating velocities on the basis of rates or first inter spike intervals. the results clearly depend on the amount of cells involved in the estimation and on the precision of the recorded ganglion cell response latencies.

comparison of our single experiments shows that under favourable conditions  on the average 63%  correct estimation could be obtained, compared to a chance rate of  <dig> %. the fact that single cell precision was less precise in experiments  <dig> and  <dig> supports the notion that spiking precision is very critical for this task. it is unclear why less precise cells were recorded in experiments  <dig> and  <dig>  it could of course be that the quality of the experiments was inferior in experiments  <dig> and  <dig>  but this seems unlikely to us since we recorded more cells in experiment  <dig> than in experiments  <dig> and  <dig>  it could as well be that by chance more cells with intrinsically less precise responses were recorded in experiments  <dig> and  <dig>  we took care to align the retina dorso-ventral in our experiments. however, we had no good control how far dorsal or ventral the recordings took place. since the archerfish retina is not homogeneous, with a ventral region of increased photoreceptor and ganglion cell density
 <cit>  it could be that we recorded more cells from one region or the other region in the different experiments.

in a competition model, based on directionally selective ganglion cells in archerfish, simulated reaction times for the decision to move to the left or to the right were in good accordance with behavioural data
 <cit> . in this study directionality was based on rate, leading to about 42% directionally tuned cells, which is similar to our number of 51% directionally tuned cells when using rate as response parameter . therefore rate might be an additional possibility for making the decision to move left or right. however, the authors also showed that directional selectivity based on rate is invariant to changes in velocity, the same result we obtained . the task for the archerfish is, however, to calculate the impact point of shot down prey before it reaches the water surface
 <cit> . for doing this, knowledge of the speed of the prey in addition to its direction is indispensable. from our results only latency can serve as response parameter for this task.

generally, population response onset is a good indicator of stimulus changes, even in cases with ongoing spike activity
 <cit> . therefore, it seems reasonable to use this as a time reference for relative latency determination that could be used by the nervous system. the definition of population response onset is, however, arbitrary. in the case of archerfish, with low spontaneous spike rate under our experimental conditions, relative latencies could also be calculated with respect to the first spike within a cell population. this is basically the same as lowering the threshold of the population response onset to one spike. for comparison, we therefore also estimated the stimulus velocities based on relative latencies with reference to the first spike for each stimulus presentation. velocity estimation was, in this case, comparable to estimation based on absolute latencies .

we do not know whether the task of velocity estimation is based on the activity of all cells in a certain retinal region or the activity of a subset of cells responding very precisely. it is also not clear whether the brain uses the population response as reference signal, and if yes whether it uses the population response from all retinal ganglion cells or from a subset of very precisely responding cells. even the spike of the fastest responding cell could serve as a reference signal as long as the ongoing activity is low. the question is, however, how the ganglion cell activity looks like under natural viewing conditions and how reliable the different reference signal then are.

CONCLUSIONS
the results presented in this study show that reliable and fast velocity reconstruction can be obtained with latency as response parameter of retinal ganglion cells. this is true for absolute as well as relative latencies. the latency available for the archerfish is composed of the population response latency  plus the relative latency  and, therefore, in the range of  <dig> –  <dig> ms. since the transmission from the optic nerve to a mauthner cell response takes only about  <dig> ms
 <cit> , this is in good agreement with the fastest reaction times of  <dig> –  <dig> ms measured in behavioural experiments
 <cit> .

