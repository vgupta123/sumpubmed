BACKGROUND
simulated data sets of known disease-predisposing loci  have been widely used in the development and application of statistical methods that detect susceptibility genes for human genetic diseases  <cit> . whereas simple samples simulated under idealized assumptions can be used to validate properties of statistical gene mapping methods, only samples that reflect the complex structure of the human genome and the genetic basis of human genetic diseases can be used to evaluate and compare the statistical power of these methods and to compare various sampling designs under realistic conditions. otherwise, a gene mapping method may perform well in theory and on simulated datasets, but poorly on real datasets  <cit> .

thanks to rapid advances in genotyping technology, genome-wide association studies  have been increasingly used to decipher multiple interacting genetic and environmental factors that are responsible for complex human diseases  <cit> . the increased use of gwas has fostered the development of statistical methods and software applications for the simulation of genetic samples with high-density markers over long genome regions  <cit> . such simulations have been used to compare the power of popular study designs and statistical methods for gwa studies  <cit> , to simulate case-control samples for evaluating the power of new statistical methods  <cit> , and to study the performance of statistical tests under different disease models  <cit> .

several programs have been developed to simulate genetic data for gwas. excluding specialized methods that simulate genetic data for particular types of samples, currently available simulation methods can be categorized roughly as resampling-based  <cit> , backward-time-based   <cit> , and forward-time-based  <cit> . resampling methods permute or sample from existing genome sequences. although these methods excel at retaining allele frequency and linkage disequilibrium  information from existing sequences, they are limited in their ability to introduce new genetic features  and new haplotypes. for example, from a sample of  <dig>  simulated sequences of  <dig> tightly linked markers over a 100-kbp region on chromosome  <dig> that we simulated using hapgen  <cit> , only  <dig> unique haplotypes exist because all the haplotypes are derived from the  <dig> unique haplotypes that exist in the european hapmap sample   <cit>  using an imputation approach.

coalescent methods excel at simulating random samples, but it is difficult to use these methods to simulate case-control or other types of samples with genetic diseases because a coalescent simulation constructs a genealogical tree from samples with unknown genotypes and cannot effectively control the number of affected individuals once the genotypes of these samples are simulated  <cit> . if a large number of samples are simulated before a disease model is applied, the coalescent method becomes inefficient, especially when long genomic sequences are simulated, unless special algorithms are used to approximate the standard coalescent process  <cit> . in addition, many coalescent method-based programs simulate samples with random marker locations, which makes defining a genetic disease with consistent dpl difficult. finally, most of these methods were designed to simulate case-control samples of relatively simple disease models and therefore have limited applicability to important research areas such as the detection of gene-environment interaction, admixture mapping, or family-based associations.

forward-time simulation methods evolve a population forward in time, subject to arbitrary genetic and demographic factors. because such a simulation can closely mimic the complex evolutionary histories of human populations that harbor the genetic diseases of interest, these methods can, in theory, simulate genetic samples with arbitrary complexity. arbitrary disease models could be applied to the resulting population from which samples based on different study designs can be drawn and analyzed  <cit> . however, this method is inefficient because ancestors who do not have offspring in the resulting population are simulated, and a large population must be simulated before samples can be drawn from it. in addition, the properties of populations simulated using a forward-time approach depend heavily on the initial populations, which are often simulated under arbitrary equilibrium assumptions. even if the same initial populations are used, the resulting populations will vary because of random genetic drift. finally, existing implementations of forward-time simulations  <cit>  vary in their abilities to simulate high-density genetic markers with realistic ld patterns and none of them can readily simulate samples that use existing genetic markers in the human genome.

this paper presents a forward-time simulation approach that addresses most of these problems. to retain the complex genetic structure of human populations, this algorithm creates an initial population of selected markers from a real sample. it then evolves this population forward-in-time, subject to mutation, recombination, natural selection, and rapid population expansion. this process uses an optional scaling algorithm to improve its performance when weak additive selection forces are used and uses a trajectory-simulation method to control the frequency of disease-predisposing alleles . depending on specific applications, the last step of this process involves different post-processing steps. for example, a rejection-sampling algorithm can be used to simulate case control samples or trio families  with rare diseases. we validated the properties of this simulation method by comparing simulated samples with real data and demonstrated the wide applicability of this simulation method using four examples, including a simulation of case-control samples with a disease caused by multiple interacting genetic and environmental factors, a simulation of trio families affected by a dpa that has been subject to either slow or rapid selective sweep, and a simulation of a structured population resulting from a recent population admixture. the new simulation approach and all examples were implemented using a general-purpose forward-time population genetics simulation environment simupop  <cit> , which has been used to implement other forward-time simulations  <cit> .

methods
because of the complexity of human genomes and their largely unknown evolutionary histories, it is infeasible to simulate samples that closely resemble human populations by evolving a simulated initial population. therefore, our simulation method uses real empirical data sets to simulate large populations with additional genetic variations while retaining key features of the empirical data sets. thanks to rapid advances in genotyping technology, the genotype data of millions of single nucleotide polymorphism  markers of hundreds or even thousands of individuals are currently available  <cit> , and higher density data will become available in the near future  <cit> . the availability of data facilitates the creation of an initial population with selected markers that match an existing sample, which usually contains markers from commercially available genotyping platforms.

the first step of our simulation method is to create an initial population from a real sample with selected markers. depending on the application, one may want to start from an existing gwa study with thousands of controls, such as the control data from the wellcome trust case control consortium  <cit> , or from a publicly available data set, such as phase  <dig> or phase  <dig> of the hapmap data set  <cit> . our study used  <dig> unrelated individuals  in  <dig> populations of the phase  <dig> hapmap data set because these data are readily available. depending on the specific application, markers can be chosen according to markers used in real-world studies  or by marker distance and minor allele frequency; individuals from one or more hapmap populations can be selected either as separate populations or as a single population.

we consider the initial populations as small, isolated populations before the expansion of a typical human population   <cit> . we then expand these populations linearly to a larger population of  <dig> individuals by adding the same number of individuals each year, subject to mutation, recombination, and natural selection. we use linear population expansion instead of a more commonly used exponential expansion model because a linear model expands the initial population faster at first, thus better preserving genetic diversity in the initial population and resulting in a final population with a larger effective population size. for example, if we start with  <dig> individuals from the phase  <dig> hapmap sample and expand the population for  <dig> generations using linear and exponential population expansion models, the effective population sizes of the expanded populations with  <dig> individuals would be  <dig>  and  <dig>  respectively  <cit> . the former is comparable to the effective population size of real human populations.

during evolution, we mutate all snp markers according to a symmetric diallelic mutation model with a mutation rate of 10- <dig> per basepair per generation. at each generation, parents are chosen at random and pass their genotypes to offspring according to mendelian laws. parental chromosomes are recombined according to a fine-scale genetic map estimated from the hapmap data set  <cit>  before one of the recombinants is passed to an offspring. if a selection model is specified, parents are chosen with probabilities that are proportional to their relative fitness values. our simulation method supports both single-locus and multilocus natural selection models, including models that involve multiple interacting dpl. if multiple populations are simulated, a stepping stone migration model with a low migration rate is applied to control the genetic distance between the populations  <cit> .

a scaling approach is used to improve the efficiency of our simulation  <cit> . compared to a regular simulation that evolves a population of size n for t generations, a scaled simulation with a scaling factor λ evolves a smaller population of size n/λ for t/λ generations with magnified  mutation, recombination, and selection forces. this method could be justified by a diffusion approximation to the standard wright-fisher process  <cit> ; however, because the diffusion approximation only applies to weak genetic forces in the evolution of haploid sequences, it cannot be used when nonadditive diploid or strong genetic forces are used. our simulation program simulates populations with specified population size so a population simulated using a scaling factor λ would be comparable to an unscaled simulation of a population that is λ times larger.

to simulate a genetic disease, we control the frequencies of dpas at dpl using presimulated allele frequency trajectories  <cit> . either a forward-time approach or a backward-time approach can be applied. more specifically, if we assume that a dpa existed before population expansion, we simulate the frequency of the dpa forward in time until it reaches the present generation. the simulation starts from the frequency of the dpa in the initial population and is restarted if the allele frequency at the present generation falls out of the desired range  <cit> . if the mutant is recent , we simulate from the frequency of the dpa at the present generation backward in time until the allele gets lost. multilocus natural selection models are supported with the restriction that dpas have to be unlinked. after the allele frequency trajectories of dpas are simulated, we use a special random mating scheme to evolve the population forward in time while following the simulated trajectories at these loci  <cit> . this mating scheme simulates large intermediate populations and forms offspring populations with desired allele frequencies by selecting offspring according to their genotypes at controlled loci.

the final postprocessing step of the simulation process will vary depending on the individual application. to simulate a common disease with enough affected individuals in the simulated population, we can draw samples directly from the population after the affection status of each individual is determined, usually using a penetrance model that yields the probability that an individual is affected with a disease according to his or her genotype ). alternatively, a rejection-sampling algorithm could be used to draw case-control samples or samples with independent offspring  of a rare disease. more specifically, we choose parents from the simulated population and produce offspring repeatedly, apply the penetrance model to determine the affection status of each offspring, and continue the process until enough samples are collected.

we implemented the proposed simulation method using several simupop scripts  <cit> , including scripts to download and select markers from phase  <dig> and phase  <dig> of the hapmap data set, a main script  to evolve a population forward in time with customizable demographic and genetic features, and postprocessing scripts for the examples presented in this article. the use of scripts in this implementation makes it easy to adapt the examples for other simulations or even to customize the evolutionary process using alternative genetic features. the amount of time required to perform a simulation depends on the size of the simulation and scales roughly linearly with the number of markers and individuals. for example, the simulations in example  <dig>  and example  <dig>  took  <dig> and  <dig> minutes, respectively, on a macintosh workstation with a  <dig> -g intel xeon processor and  <dig> g of random access memory.

RESULTS
example 1: typical simulations with or without scaling
we created an initial population with the  <dig> independent individuals of the hapmap phase  <dig> data set, using  <dig> markers on region 2p <dig>  . this region spans  <dig>  mbp with a genetic distance of  <dig>  cm. it contains the enr <dig> encode region and has an average marker distance of  <dig>  kb. we evolved this population for  <dig> generations until it reached  <dig>  individuals, subject to mutation , recombination , no selection, and linear population expansion.

in order to evaluate the quality of simulated populations and the impact of the scaling technique, we simulated three expanded populations of sizes  <dig>   <dig>  and  <dig> using scaling factors  <dig> ,  <dig>  and  <dig> respectively, and an expanded population of  <dig> individuals using a scaling factor of  <dig>  whereas the first three populations are scaled versions of the same evolutionary process, the last one is comparable to an unscaled simulation of a population of size  <dig>  compared to the first three simulations, genetic drift has a smaller impact on the last simulation because of its larger population sizes during evolution. this is demonstrated in figure  <dig> where the allele frequencies at  <dig> markers for all simulated populations are compared with those of the initial population.

the evolution of ld in such an evolutionary process is more complicated. according to figure  <dig>  all simulated populations had lower ld than those of the initial population. although populations simulated using a scaling approach tended to have lower ld than those from unscaled simulations, the differences between mean r <dig> values were negligible especially for markers that are less than 200kbp apart. a more detailed analysis showed that average ld increased and then decreased during the evolutionary process of all simulations. this phenomenon could be explained by the fact that our simulation started from a relatively small population, so ld first built up because of a bottleneck effect. with increasing population size, the natural decay of ld through genetic recombination gradually prevailed at a rate accelerated by the impact of rapid population expansion  <cit> . the simulation with a scaling factor of  <dig> and population size  <dig> had the lowest ld values because it had a relatively short period of bottleneck and a faster rate population expansion than other simulations.

example 2: a genetic disease with two dpl
we extracted  <dig> markers  on chromosomes  <dig> ,  <dig>  and  <dig>  of  <dig> independent individuals from phase  <dig> of the hapmap sample. we selected markers from a commercially available genotyping chip  to match markers used in real-world gwas. the average distance between adjacent markers was  <dig>  kb. two markers, rs <dig>  and rs <dig> , were selected to be the dpl of a genetic disease. the first marker was assumed to be under purifying selection, with fitness values of  <dig>   <dig> , and  <dig>  for genotypes aa, ag, and gg, respectively. the second marker was assumed to be under positive selection, with fitness values of  <dig>   <dig> , and  <dig>  for genotypes cc, ct, and tt, respectively. a multiplicative multilocus selection model was used. because these two loci reside on different chromosomes, we considered natural selection to be applied to these loci independently  <cit> . we assumed that the dpas existed longer than  <dig> generations, and we used a forward-time simulation method to simulate trajectories of the frequencies of the minor alleles at both loci, starting from their frequencies in the chosen hapmap sample . the ending allele frequencies were  <dig>  for marker rs <dig> and  <dig>  for marker rs <dig>  which were chosen in concordance with the selection pressure that was applied to each marker. we did not scale this simulation because of the use of a nonadditive diploid selection model.

we used a logistic model with gene-gene and gene-environment interactions to model a disease that involves these two genetic markers and a random environmental factor with two states  <dig> and  <dig>  we assumed that the disease was mild and was not the source of the selection pressure on the two dpl. the model can be expressed as logit ) = α+β1g1+β2g2+β3g1g2+γ1g1e+γ1g1e + γ2g2e where y is the disease status, g <dig> and g <dig> are number of dpas at two markers respectively, and e is the random environmental factor. this model is an extension of the one-gene, one-environmental model used in li and conti  <cit> . we chose positiveα, βi, and γi values so that the presence of each dpa increases the probability that an individual is affected with the disease. we chose β <dig> = β2/ <dig>  γ <dig> = γ2/ <dig>  so that the dpa at marker rs <dig> had less impact on the disease than the dpa at marker rs <dig>  finally, we controlled parameters α, βi, and γi so that the prevalence of the disease was 1%. because there were less than  <dig> affected individuals in the expanded population, we used a rejection-sampling algorithm to populate an offspring population with exactly  <dig> cases and  <dig> controls from the expanded population.

we counted the number of alleles in cases and controls, created a  <dig> by  <dig> contingency table and used a χ <dig> test to test the association between the disease status and alleles at each marker. the negative of the base  <dig> logarithm of the p-values at all markers were plotted in figure  <dig>  although the χ <dig> tests detected both genetic factors correctly, more sophisticated statistical methods or larger samples would be needed to detect the gene-gene and gene-environment interactions in this data set.

example 3: simulations of slow and rapid selective sweep
in example  <dig>  natural selection was not expected to have a strong impact on ld patterns around dpl because it changed frequencies of both dpas slowly over a long period of time. in contrast, strong selection can bring a new beneficial mutation to high frequency or fixation in a population in a relatively short period of time. this phenomenon, also called selective sweep, has a profound impact on patterns of linked genetic variation through the hitchhiking effect. the signatures of selective sweep have been used for the development of statistical methods to identify chromosomal regions that have been under positive selection  <cit>  and for the identification of dpl in genome wide association analysis  <cit> . although theoretical models of selective sweep have been simulated for methodological development using coalescent approaches  <cit> , explicit simulation of selective sweep using a forward-time approach can be used to study the impact of different levels of natural selection on different regions of the human genome and to produce realistic samples to assess the power of statistical methods.

in order to closely examine the impact of selective sweep on existing ld patterns of a chromosomal region, we extracted  <dig> markers on a short region on chromosome  <dig>  from  <dig> independent individuals from the jpt+chb population of phase  <dig> of the hapmap data set. we selected this region because it belongs to the enr <dig> encode region with a mean distance of  <dig>  kb between markers. we selected marker rs <dig> with alleles c and t from one of the two haplotype blocks in this region and applied different levels of positive selection during the evolution of this population.

in our first simulation, we assumed that allele t at this marker was introduced more than  <dig> generations ago. this allele had a frequency of  <dig> % in the initial hapmap population and reached a frequency of 99% after  <dig> generations due to positive natural selection with fitness  <dig>   <dig> , and  <dig>  for genotypes cc, ct, and tt, respectively. a forward-time trajectory simulation algorithm was used to control the frequency of allele t at the present generation. in our second simulation, we cleared allele t at this marker from the initial population and introduced it as a new mutant during the evolutionary process. using a backward-time trajectory simulation process, an allele t was introduced at generation  <dig> and was brought to a frequency of 99% using a stronger force of natural selection with fitness  <dig>   <dig> , and  <dig>  for genotypes cc, ct, and tt, respectively.

we drew  <dig> trios from the simulated populations using a rejection-sampling algorithm. more specifically, we repeatedly chose parents and produced offspring. we determined the affection status of each offspring using a logistic regression model logot)= - <dig> -gi, where gi is the number of allele t at locus rs <dig>  we kept only affected offspring and their parents in the sample until  <dig> trios were collected. we used lamp  <cit>  to analyze the data set.

the simulated populations could be used to test the performance of statistical tests designed to detect signals of positive selection along the human genome  <cit>  and to detect dpl if the dpa was under positive selection  <cit> . for example, when we applied family-based association tests to two samples of trio families drawn from the simulated populations, the signals from rapid selective sweep  appeared to be wider than those from slow selective sweep . this phenomenon could be explained by stronger ld between the dpl and its surrounding loci for the simulation with rapid selective sweep, but a quantitative analysis using a large number of simulations would be needed to draw a definitive conclusion.

example 4: simulation of admixed populations
population structure has been known to cause spurious associations in case-control association studies  <cit> , so several statistical methods have been developed to reduce the impact of population structure on gwa studies  <cit> . on the other hand, population admixture causes long-range admixture ld that could be used to map diseases in admixed populations  <cit> . although simulations have been used to evaluate the performance of these statistical methods, they have not been complex enough to challenge the statistical methods under realistic situations  <cit> . for example, pfaff et al.  <cit>  broke existing ld of the founder populations from hapmap samples by sampling alleles instead of haplotypes so that only admixed ld existed in the simulated sample.

we aimed to simulate realistically admixed populations by mixing populations simulated from the hapmap populations. we extracted  <dig> markers with minor allele frequency greater than or equal to  <dig>  from chromosome  <dig>  using  <dig> and  <dig> independent individuals from the phase  <dig> of the hapmap japanese in tokyo, japan and han chinese in beijing, china  and maasai in kinyawa, kenya  populations. the two populations were expanded to a total size of  <dig>  individuals. a low-level migration rate of  <dig>  was applied to keep the genetic distance between these two populations around its original level of  <dig>    <cit> .

to control the levels of true ld and admixture ld, we mixed large populations to avoid elevated ld caused by a founder effect. we mixed these two populations using a continuous gene flow model where 5% of individuals from the mkk population migrated to the jpt+chb population for  <dig> generations  <cit> . at the beginning of population mixing, we assigned an ancestral value of  <dig> to individuals from the jpt+chb population and a value of  <dig> for individuals from the mkk population. during the admixture process, the offspring ancestral values were recorded as the mean of parental ancestral values. we used a positive assortative mating scheme to mix individuals because migrants usually do not mate randomly with natives during a real-world admixture process, and individuals would be efficiently mixed and have similar ancestral values after only a few generations if the standard wright-fisher random mating process were used to mix parents regardless of their ethnicity. more specifically, we divided individuals into two groups according to their ancestral value, one with ancestral values greater than or equal to  <dig>  and another with ancestral values less than  <dig> . during the population of an offspring generation, 80% of all mating events happened within the these two groups and the rest of the mating events happened with parents chosen randomly from the whole population  <cit> . this process slowed down the admixture process and resulted in a distribution of individual ancestry values that is closer to that of real populations, such as the mixture distribution of european ancestry among all african americans  <cit> .

we applied to the population a penetrance model in which individuals' probability of being affected equals  <dig>  + ancestry/ <dig>  where ancestry is the individual's mkk ancestry value. individuals with higher mkk ancestry values were more susceptible to this disease, but none of the  <dig> markers caused the disease directly. because there were enough affected individuals in the simulated population, we drew  <dig> cases and  <dig> controls directly from the simulated population. we used the structure program to estimate the ancestry values of cases and controls from their genotypes  <cit>  and plotted the estimated mkk ancestries against the recorded ancestry values for each individual . because individuals with high mkk ancestry values are more likely to be affected, cases on average had higher mkk ancestry values than controls.

in order to demonstrate the impact of population structure on association analysis, we applied allele-based χ <dig> tests and structured association tests proposed by pritchard et al.  <cit>  to detect the association between disease status and  <dig> simulated markers . although the disease is not directly caused by any of the simulated markers, a large number of spurious associations were detected by the χ <dig> tests. in contrast, the structured association tests estimated individual ancestry values to control the impact of population structure and successfully removed most spurious associations.

discussion
the genetic composition of a human population is the result of a long and complex evolutionary process. the demographic and genetic features of this process have profound implications in the mapping of susceptibility genes responsible for human genetic diseases  <cit> . whereas resampling-based methods capture the complexity of existing genome sequences with no control over the impact of additional genetic and demographic forces, and the coalescent methods simulate simple samples based solely on a few theoretical models, the forward-time simulation method described in this article retains key properties of human genomes by evolving a population from real human sequences while allowing the introduction of additional genetic forces such as natural selection. because this method is not constrained by any theoretical limit, it can be used to simulate realistic samples for a variety of research topics for gwa studies.

in order to retain key features of real human genomes during evolution, this method expands the founder population rapidly. because the size of the founder population is likely to be small, this evolutionary process currently suffers from a bottleneck effect during the initial stage of population expansion, resulting in a loss of rare haplotypes and reduced genotype diversity. during rapid population expansion, common haplotypes are maintained in the population with stable frequency, whereas new haplotypes are constantly introduced by mutation and recombination  <cit> .

consequently, common haplotypes in the initial population are preserved in the simulated population, but many rare haplotypes will be replaced by new haplotypes. because mutation has a relatively small impact on common alleles, an increased mutation rate can be used to generate more new haplotypes in the simulated populations without markedly affecting other population properties such as allele frequency and ld patterns. this limitation will become less of a challenge as more human data become available .

because a larger initial population size would reduce the bottleneck effect and help preserve uncommon haplotypes, we combined all independent individuals from  <dig> populations of the phase  <dig> hapmap data set for examples  <dig>   <dig>  and  <dig>  the sudden population admixture caused long-range admixture ld in the combined initial population. such admixture ld decayed gradually during evolution and did not lead to elevated long-range ld in the simulated population . nevertheless, the availability of high-quality sequences of larger samples will allow us to generate population-specific samples and further improve the quality of our simulated data sets.

we evaluated the quality of simulated data sets by comparing allele frequency and ld patterns between the simulated and the hapmap samples. however, we did not attempt to tweak our evolutionary process so that the simulated samples resembled the hapmap sample closely because we aimed to simulate larger populations with more genetic diversity than the founder population and because we wanted to use a realistic evolutionary process so that additional genetic or demographic features could be added. if we consider the method to randomly split and join pieces of chromosomes used by hapsample  <cit>  as a special form of recombination, hapsample could be considered a one-generation forward-time simulation method with magnified recombination rates. our simulation method would yield results similar to those of the resampling methods if we used an extraordinarily high scaling factor so that all sequences were essentially derived directly from haplotypes of the initial population.

we used a fine-scale genetic map to determine the recombination rate between adjacent markers  <cit> . this map generally has a higher recombination rate between markers from different haplotype blocks and a lower recombination rate between markers from the same haplotype blocks. because recombinations happened mostly between existing haplotype blocks, this genetic map helped us retain the haplotype blocks and therefore the ld structure of the founder population. however, due to the relatively short evolutionary time, the type of genetic map does not have a strong influence on the simulated population. for example, there is no discernible difference between ld patterns  of simulated populations if we use a physical map with a recombination rate of  <dig>  per mbp instead of a genetic map to recombine parental chromosomes during evolution .

our simulation program allows the simulation of arbitrarily chosen selection models with multiple interacting genetic factors and at the mean time allele frequencies at the present generation. if inappropriate parameters are chosen, it is likely that the specified selection model would result in allele frequencies higher or lower than expected so that no valid trajectory of allele frequency could be simulated. if this is the case, our trajectory simulation function will print the average ending frequency for a forward-time simulation or length of trajectory for a backward-time simulation so that the simulation parameters can be adjusted accordingly. this is especially useful if a gene-gene interaction model is used so that marginal selection pressure can interact with allele frequency and drive the allele frequency of dpa in unpredictable directions.

due to different requirements of different applications, the flexibility of this simulation method is difficult to harness using a traditional single-execution implementation. this is why we divided our simulation approach into three steps and implemented different preprocessing and postprocessing scripts for different applications. these scripts were written in python and can be executed on any platform where python and simupop are installed. the scripts provide both command line and graphical user interfaces and could be used to simulate samples for applications similar to those described in this paper. for these reasons, it is relatively easy to adapt these scripts for specific applications if different evolutionary processes and/or processing procedures are needed. we provide these scripts through a wiki-based system  so that users can share their experiences and improvements of this simulation approach. we expect that more scripts will be contributed as users apply our proposed forward-time simulation approach to a wider variety of gwa studies.

CONCLUSIONS
this paper describes a forward-time simulation algorithm to simulate large populations from an initial population that is created from selected markers of an existing genetic sample. during rapid population expansion, common haplotypes in the initial population are well preserved, whereas new haplotypes are constantly introduced by mutation and recombination, thus add more genetic variations to the simulated population. compared to other simulation methods, our method simulates samples with existing genetic markers that resemble the human populations well in terms of marker allele frequency and ld structure, with additional flexibility to simulate genomic regions with signals of natural selection. because of the use of a scripting language design, our implementation of this algorithm can simulate different types of samples with arbitrary disease or quantitative trait models, making it an ideal tool to evaluate the statistical power of a wide variety of statistical gene mapping methods for gwas.

abbreviations
chb: han chinese in beijing, china; dpa: disease-predisposing allele; dpl: disease-predisposing loci; jpt: japanese in tokyo, japan; ld: linkage disequilibrium; gwas: genome-wide association study; mkk: maasai in kinyawa, kenya; snp: single nucleotide polymorphism.

authors' contributions
bp conceived of the study, implemented the method and wrote the manuscript. cia participated in the design of the method, helped to draft and revise the manuscript. both authors read and approved the final manuscript.

