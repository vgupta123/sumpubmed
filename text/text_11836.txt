BACKGROUND
dna methylation is an important epigenetic mechanism that is involved in the regulation of gene expression  <cit> . in humans, methylation occurs most frequently at cytosine  nucleotides preceding a guanine  nucleotide, referred to as cpg sites  <cit> . owing to its role in numerous physiological processes and disease states including cancer, changes in dna methylation introduced by lifestyle factors and disease-related phenotypes have received increasing attention  <cit> . high-throughput array technologies such as the illumina infinium humanmethylation450k beadchip  <cit>  have enabled epigenome-wide association studies  to explore the relationship between phenotypes and dna methylation in large population-based studies  <cit> .

the statistical analysis of genome-wide dna methylation data entails specific challenges. most commonly, methylation signals from the infinium humanmethylation450k beadchip are summarized as β-values, the proportion of methylated in relation to the sum of methylated and unmethylated signals at a specific genomic site in a biological sample  <cit> . methylation β-values are bounded in the unit interval, with values occuring between  <dig>  and  <dig> . as typical for proportion data, their distributions display substantial heteroscedasticity  <cit> . specifically, they tend to show smaller variances when located near the boundaries  <dig> and  <dig> as compared to the center of the unit interval. in addition, their distributions are typically skewed. therefore, when using β-values as response variable in a statistical regression model, traditional modeling strategies that assume a normally distributed response might be inappropriate  <cit> . to solve this problem, it has been proposed to use the less heteroscedastic m-values for gaussian regression, which are approximately equal to binary logit transformed β-values  <cit> . an alternative transformation for proportion data, which is often used in ecology to achieve variance stabilization, is the arcsine square root transformation  <cit> . this transformation has also recently been applied to methylation data  <cit> . in addition, beta regression, a statistical regression technique that is tailored to bounded response variables, has been proposed as a “natural” modeling strategy for proportion data  <cit> . currently beta regression is beginning to find application in methylation data analysis  <cit> . although improved performance of beta regression as compared to traditional approaches was reported  <cit> , a thorough comparison of these competing approaches for the purpose of univariate screening for genome-wide phenotype-methylation associations is lacking.

furthermore, there is increasing evidence that not only mean differences but also variability of methylation plays a role in disease processes, including cancer  <cit> . this enhances the need to screen for an effect of lifestyle factors and disease-related phenotypes on dna methylation level and variability  <cit> . in these studies, variability was either modeled isolated from the mean, in a combined test together with the mean, or not explicitly modeled as a function of covariates at all.

here we propose generalized additive models for location, scale and shape   <cit>  as a flexible approach to model methylation data. gamlss can be specified such that a regression model is estimated for the mean , and another model for the variability , so that covariate effects on both parameters can be quantified simultaneously. joint modeling of location and scale is preferable to separate modeling since mean and variance of bounded β-values are not independent  <cit> .

the purpose of this study was to compare model performance as well as the performance of downstream hypothesis tests of  beta regression as compared to gaussian regression on raw, binary logit or arcsine square root transformed β-values,  with and without simultaneous modeling of covariate effects on the scale parameter within the gamlss framework. using simulated and real data sets from the large population-based research platform cooperative health research in the region of augsburg  , we demonstrate that models for location and scale, specifically the gaussian model on m-values, increase predictive performance as compared to models for location only, while being more sensitive towards violations of the distribution assumption and towards the presence of outliers in the methylation data. to address this problem, we propose and evaluate a resampling-based strategy based on parametric bootstrapping followed by rank-based reassignment of the original data. all findings concerning model performance and evaluation of the resampling-based strategy are subsequently validated in an independent data set of acute lymphoblastic leukemia patients and healthy controls. finally, an application in an ewas of bmi and age is presented.

methods
data sets
our study is based on two large data sets of  <dig> and  <dig> subjects from the f <dig> and f <dig> studies, respectively, of the population-based research platform kora  <cit> . these data sets have been used in published ewas before  <cit> , and study design and data collection have been described in detail  <cit> . methylation measurements from whole blood were obtained from the illumina infinium humanmethylation450k beadchip  <cit> , as described in  <cit> . raw methylation data were preprocessed and quality controlled as described in additional file  <dig>  subjects with missing or outlying  covariate information were excluded from the analysis, so that the final f <dig> methylation data set comprised  <dig>  autosomal sites, mainly cpg sites, and  <dig> subjects. similarly, data from  <dig> f <dig> subjects were available for analysis. a phenotypic description of both data sets is provided in tables s <dig> and s <dig> in additional file  <dig>  for the f <dig> data, genome-wide single nucleotide polymorphism  data were obtained using the affymetrix genechip array  <dig> , and genotypes were imputed with impute v <dig> . <dig> using the hapmap <dig> reference panel  <cit> . in the f <dig> population, genotyping was performed with the illumina humanomniexpress beadchip and the illumina  <dig>  beadchip, followed by imputation with impute v <dig> . <dig> using the 1000g phase <dig> reference panel .

modeling strategies for dna methylation data
the illumina infinium humanmethylation450k beadchip assay provides a readout of methylated and unmethylated signal intensities from hybridization of dna fragments from a biological sample to oligonucleotides attached to beads on the chip. for a given cpg site j, the methylated  and unmethylated  signal intensities are combined to methylation β-values  <cit> : 

 β-valuej=maxmax+max+αβ 

 where the inclusion of an offset αβ= <dig> is recommended as as a stabilization in the situation when both methylated and unmethylated signal intensities are small  <cit> . since the total number of signals exceeds  <dig> in the majority of cpg sites, the offset does not induce much bias. by definition, β-values are bounded to the unit interval. ignoring the offset, they can be interpreted as proportion of methylation at a specific cpg site in a biological sample. typically, β-values at specific cpg sites tend to have a skewed distribution, centered at either a low or a high methylation state, with variances smallest for cpg sites centered close to the bounds of the standard unit interval .

we consider regression models with β-values as response variable, and disease-related phenotypes as explanatory variables. when modeling proportions as a function of covariates, their boundedness as a function of covariates, their boundedness implies that the conditional mean must be a nonlinear function of the explanatory variables, since a linear combination of the explanatory variables would not be restricted to values within . in addition, it implies that the conditional variance must be a function of the conditional mean, i.e. the distribution is heteroscedastic  <cit> . both conditions are not met when gaussian regression is used, so that both the expectation and the variance structure are misspecified, potentially resulting in biased and inconsistent estimation.

to overcome these problems, it was proposed to use the log <dig> ratio of the methylated to unmethylated signal intensities: 

 m-valuej=log2maxmj,0+αmmaxuj,0+αm, 

 where αm= <dig> is typically used. m-values are defined on  and are less heteroscedastic than β-values  <cit> . they are also more symmetric than β-values . ignoring the offsets αβ and αm, the m-value is approximately equal to the binary logit of the β-value: 

 m-valuej≈log2β-valuej1-β-valuej. 

 when using binary logit transformed β-values as response variable in gaussian regression, the corresponding model is specified as follows: let y=t be the vector of β-values corresponding to n independent observations, and h the binary logit transformation. then the transformed response y~=,h,…,h)t is modeled as a function of covariates: 

 y~=xγ+ε;ε∼n <dig> σ2ie=xγ 

where x represents the n×p matrix of covariate values, γ=t a vector of regression coefficients corresponding to p covariates, ε the n× <dig> vector of independently normally distributed error terms with variance σ <dig>  and e the expectation. note that this model formulation also comprises gaussian regression with untransformed β-values as response variable. in that case h would be the identity function. in addition, the model can be extended to facilitate explicit modeling of σ as a function of covariates .

in a titration experiment by du et al. <cit> , m-values outperformed β-values in terms of power and precision when identifying differentially methylated sites based on methylation differences between two groups. however, when differential methylation was defined based on test statistics, superiority of m-values was only observed in small sample sizes, when regularized t-statistics were used  <cit> . in multivariate feature selection, β-values tended to better preserve the correlation structure of methylation signals  <cit> . generally, due to the logit transformation, the interpretation of a regression model based on m-values is less intuitive than the interpretation of a corresponding model based on untransformed β-values, since covariate effects have to be interpreted with regard to the expectation of the transformed response y~ rather than y itself.

in ecological applications, proportions are often transformed using the arcsine square root transformation 

 a-valuej=sin-1β-valuej 

 to achieve homoscedasticity  <cit> . the transformed values are then for instance modeled with a gaussian regression model as described above, specifying h as the arcsine square root transformation. however, the arcsine square root transformation maps  to , so that values are still bounded.

a natural alternative to the gaussian models considered above is beta regression, which explicitly takes into account that β-values are proportions  <cit> . the beta distribution has the density function 

 fy;μ,σ=Γ1σ2-1Γ1σ2-1μΓ1σ2-1·y1σ2-1μ-1·1σ2-1- <dig>  

where y∈ represents the response vector, μ∈ a location parameter, σ∈ a scale parameter, and Γ the gamma function. typically, f is skewed . expectation and variance of a beta distributed random variable y are given by e=μ, andvar=μσ <dig>  thus, beta regression incorporates boundedness and skewness of a proportion response  <cit> . also, because var explicitly depends on μ, heteroscedasticity of the response can be modeled via beta regression.

the beta regression model is defined analogously to a generalized linear model and is formally given by 

 g=g)=xγ 

 where μ represents the mean of a beta distributed response vector y, and g a strictly monotonic and twice differentiable link function that maps the open unit interval into  <cit> . in practice, the logit function is commonly chosen for g. note that in case of y∈ <cit> , values can be rescaled to lie in   <cit> . in our methylation data, zeros did not occur after preprocessing.

to model the effect of the explanatory variables on var , a “variable scale beta regression model” has been proposed as an extension. thereby, location  and scale  parameter are both modeled, with a possibly distinct set of covariates  <cit> .

despite these appealing properties and modeling options, beta regression has been considered in few studies on dna methylation data so far  <cit> . a thorough examination of its performance in comparison to competing modeling strategies, and specifically the relevance of modeling the scale parameter in beta and gaussian regression models, has not been conducted.

generalized additive models for location, scale and shape 
gamlss provides a flexible modeling framework for responses from a large class of distributions, including gaussian and beta distributions  <cit> . it extends generalized linear and additive models first, by relaxing the distribution assumption, and second, by allowing for modeling not only the mean  but also other distribution parameters  as a function of explanatory variables. consequently, beta regression is a special case of a gamlss. moreover, the gamlss methodology allows for modeling the residual error variance σ <dig> of the gaussian models described above. together, this makes gamlss highly relevant for modeling dna methylation data. specifically, it provides a unique framework for the comparison of the different approaches to model methylation data considered in this study.

in this article we focus on the fully parametric gamlss with linear covariate effects and two submodels: 

 g1=x1γ1g2=x2γ <dig> 

where x <dig> and x <dig> are matrices of covariate values, γ <dig> and γ <dig> the respective vectors of regression coefficients of lengths p <dig> and p <dig>  and μ and σ the location and scale parameters as defined above within the context of gaussian and beta regression. in “fixed scale models”, i.e. models for location only , x <dig> reduces to an all-ones vector, and γ <dig> to a scalar intercept. for beta regression models, the link functions g <dig> and g <dig> were both chosen as the natural logit. for gaussian regression models based on raw β-values, m-values and a-values, they were chosen as identity and log links, respectively.

analysis of model fit and predictive performance
model comparisons were conducted on the kora f <dig> data set . we compared eight different modeling strategies: four fixed scale models, i.e. gaussian regression on raw data , on binary logit transformed data  and on arcsine square root transformed data , as well as beta regression , and the corresponding four variable scale models  that additionally regressed the scale parameter on the covariates . the variable scale models and the fixed scale beta regression model were fitted as gamlss   <cit> , whereas the remaining fixed scale models were fitted as generalized additive models    <cit> .

in location and scale submodels, the respective parameter was specified as a linear function of covariates that are known to have an effect on methylation levels, including age  <cit> , sex  <cit> , smoking state   <cit> , alcohol intake   <cit> , physical activity   <cit> , body mass index   <cit> , white blood cell count  and estimated proportions of six white blood cell types as derived using the method by houseman et al. <cit> . in the location submodel, the first  <dig> control probe principal components  were included to avoid technical confounding .

model performance was investigated in a random set of  <dig>  cpg sites. repeating analyses in newly drawn sets of cpg sites showed that results were stable towards the cpg sites chosen. we fitted every model to a random subsample comprising 50% of the observations as a training set, drawn anew for each cpg site, with the remaining 50% left out as a test set. the pseudo r  <dig> criterion  <cit>  was then calculated from both training and test sets as a measure of model fit and predictive model performance, respectively. the pseudo r  <dig> criterion has been used to compare beta and gaussian regression before  <cit> . it measures the improvement of the likelihood of the fitted as compared to the intercept-only model, and is therefore more appropriate in the context of models for location and scale than measures based on correlation or deviance of fitted versus observed response values, since it better accounts for the fit of the scale submodel. the precise definition of the pseudo r  <dig> criterion for the different models is given in additional file  <dig>  the analysis was repeated in a smaller sample size of  <dig> observations, randomly drawn for each cpg site, to evaluate the impact of sample size on model performance.

residual model fit was assessed using shapiro-wilk tests on normalized quantile residuals  <cit> .

simulation study
to assess type i error and power of downstream hypothesis tests of the competing models, and the sensibility towards violations of the distribution assumptions, a data-driven simulation study was conducted comprising beta distributed and real-data distributed methylation responses. all data were deliberately simulated to be close to the observed methylation data, in terms of average location and scale, as well as in terms of the size of observed covariate effects, aiming to approximate the real-data scenario as closely as possible.

beta-distributed data setting
for each cpg site j, j= <dig> …, <dig>  real methylation data were modeled using variable scale beta regression with covariates as described above. from these models, the fitted distribution parameter vectors μ^j=g1-1x1γ^j <dig> and σ^j=g2-1x2γ^j <dig> were obtained, where γ^j <dig> and γ^j <dig> represent vectors of the estimated covariate effects. then, the entries of γ^j <dig> and γ^j <dig> corresponding to the effects of one covariate, bmi, were manipulated to values given in table  <dig>  to represent zero, moderate and strong covariate effects on location and scale. thereby, the moderate effect size was chosen such that observed effects of age, sex, smoking state, alcohol intake and physical activity, bmi and wbc were rarely stronger in absolute terms.

the simulated effects for the tested parameters are displayed in bold font.

finally, beta distributed data were simulated as a parametric bootstrap sample  <cit> yj∗∼be for each cpg site. the resulting data were beta distributed with known effects of the covariate bmi on location and scale, in absence or presence of nuisance effects on the respective other parameter.

the eight competing models  were fitted to these data, and observed type i error rate and power of the test with the null hypothesis h0:γbmi= <dig> were estimated as the proportion of p-values below  <dig> , given γbmi= <dig> or γbmi= <dig> , respectively. the analysis was conducted at n= <dig> and n= <dig> as before.

real data setting
to investigate the influence of the response distribution on test performance, data were generated having the distribution of the real β-values, while covariate effects were maintained. this was achieved by reassigning the originally observed methylation values to the subjects, according to the ranks of the subjects’ simulated response values. thereby, the simulated covariate effects were largely maintained, while the original response distribution was reconstructed. the eight competing models were fitted to these data, and observed type i error rates and power were estimated.

RESULTS
comparison of competing models for methylation data
model fit and predictive performance were compared in terms of the pseudo r  <dig> criterion evaluated in training and test data, respectively, as described in detail above . among the fixed scale models, the beta regression model  performed worst on average  and for the majority of cpg sites  according to both criteria. for the gaussian regression models, performance improved when also the scale parameter was modeled as a function of covariates, suggesting that effects of the modeled covariates on methylation scale are present. this was not as clearly observed for the beta regression model , which performed considerably worse than the variable scale gaussian regression models on raw  or transformed  data. among the variable scale models, the gaussian model on binary logit transformed data , i.e. on m-values, showed the best model fit  and predictive performance  on average  and for the largest proportion  of cpg sites .

when the analyses were repeated with a reduced sample size , training set r  <dig> values indicated a substantial increase in model fit for variable scale as compared to fixed scale models . at the same time, test set r  <dig> values were strongly deflated for a part of the cpg sites, indicating diminished predictive performance in the presence of overparametrization.distribution assumption in the competing models was checked through residual normality tests. as shown in figure 2a, a significant deviation from residual normality was indicated for more than 94% of cpg sites for all fixed scale models, and for more than 88% of cpg sites for all variable scale models. in contrast, parametric bootstrap draws from the fitted variable scale beta regression model showed a deviation from residual normality for 5% of the cpg sites in the be+ model, as expected . thus, none of the competing models fitted well to more than 12% of cpg sites, suggesting that at the majority of cpg sites, methylation followed neither a beta distribution, nor a normal distribution after any of the investigated transformations.

the unexpectedly bad beta distribution fit might be attributed to an error component arising from the microarray experiment  <cit> . of note, the two assay designs present on the infinium humanmethylation 450k beadchip differed in the severity of the deviation from beta distribution fit.

when we compared the eight models in terms of severity of deviation from residual normality, model fit was improved when also the scale parameter was modeled as a function of covariates . overall, the variable scale gaussian model on m-values  showed the best residual normality fit in the majority  of cpg sites.

performance of hypothesis tests
next, we investigated how strongly the violation of the distribution assumptions of the competing models, specifically the beta regression model, affected the performance of downstream t-tests for covariate effects. specifically, we explored the impact of known covariate effects on one distribution parameter on the performance of tests for the effect of this covariate on the other distribution parameter. for this purpose, in a simulation study beta distributed and real-data distributed methylation responses were generated with known covariate effects on location and/or scale .

observed type i error rates in beta distributed data
first, observed type i error rates of tests for covariate effects on the location parameter μ  were investigated in beta distributed data at full sample size . here, all models met the nominal level α= <dig>  on average if no effect of the same covariate on the scale parameter σ was present . in the presence of a weak covariate effect on σ, which was chosen to be within the range of actually observed covariate effects on the methylation data, all models adhered to their norminal level. when strong effects of the same covariate on σ were present, the models be, lo and lo+  and ar as well as ar+  showed severely inflated type i error rates. in contrast, the models be+ and ra showed moderately inflated type i error rates , whereas the nominal level was met in the case of the model ra+.

next, we investigated tests for covariate effects on the scale parameter σ in beta distributed data . the models be+ and ar+ almost adhered to their nominal level irrespective of covariate effects on μ, whereas ra+ and lo+ showed a mild inflation of type i error rates  in the presence of weak effects on μ, which increased to above 88% when the covariate effect on μ was strong .

exemplarily, we provide theoretical considerations explaining the increased type i error rates observed for the different models in the σ|μ setting. since the simulated data were beta distributed, their variance depended on the mean, with var=μσ <dig> . in the variable scale gaussian model on raw data , the parameter 

 σ~i=varyi=μi1-μiσ2=σμi1-μi 

 is modeled. in the setting where covariate effects on μ are present but not on σ, σ~i would still depend on covariates through μi, so that effects on μ might be falsely attributed to σ, explaining the increased type i error rate. similarly, in the gaussian model on binary logit transformed data , applying the delta method yields 

 σ~i=varn2yi1-yi≈varyi·1logμi1-μi=σ·1logμi1-μi 

which depends on μi as well. again, this explains an increased type i error rate for σ. in the special case of arcsine square root transformed data, 

 σ~i=varsin-1yi≈varyi·12μi1-μi=σ· <dig>  

here, σ~i is approximately independent of μi, explaining the good performance of the ar+ model in the σ|μ setting.

observed type i error rates in the real-data scenario
next, analyses were repeated with real-data distributed methylation responses, which had exactly the same marginal distributions as the original data. in contrast to beta distributed data, none of the models adhered to the nominal level in the presence of strong covariate effects on the other distribution parameter , with type i errors of above 40% observed for all models in both μ|σ and σ|μ settings.

although methylation data are bounded in the unit interval with a dependency between mean and variance, they show deviation from the beta distribution  so that the relation between mean and variance might not be correctly reflected by var=μσ <dig>  consequently, effects on either location or scale parameter might be falsely attributed to the other during model fitting.

in addition, in the σ|μ setting, type i error rates larger than 15% were observed for all models, even in absence of covariate effects on μ. they were largest  for the ra+ model . this suggests that tests on the scale parameter are more sensitive towards violations of the distribution assumption than tests on the location parameter.

in our simulated data, two reasons seemed to be mainly responsible for this observation: missing covariates such as snps , and outliers in the data . it is not uncommon that snps located in close proximity to cpg sites strongly affect their methylation level  <cit> , at some cpg sites resulting in multimodal marginal distributions of methylation values . when these effects are not modeled and genotypes are unevenly distributed among the subjects with low and high covariate values - by chance or through a true snp effect on the covariate - a falsely significant effect of the covariate on methylation scale is sometimes observed. also, the fact that the investigated data were derived from whole blood might contribute to the increased type i error rates. whole blood represents a mixture of different blood cells, which are known to show cell-specific methylation patterns  <cit> . the applied method to estimate and then adjust for selected white blood cell proportions might not fully remove the mixture effect from the methylation data. furthermore, tests for covariate effects on σ are specifically sensitive towards outliers in the methylation data . a potential solution to these problems is presented in the next section.

when the analyses were repeated in a smaller sample , an additional trend emerged: observed type i error was systematically larger for variable scale than for fixed scale models even in absence of covariate effects on the other distribution parameter . this was observed for both beta distributed and real-data distributed methylation responses, and was in line with the reduced predictive performance of variable scale models in the smaller sample . together these findings suggest overfitting.

observed power
finally, we compared the models in terms of their power to detect existing covariate effects of moderate strength. we observed that power of downstream t-tests was generally smaller to detect similarly sized covariate effects on σ than on μ . however, none of the models clearly outperformed the others in terms of power in absence of covariate effects on the other distribution parameter. the presence of weak effects on σ tended to reduce power to detect effects on μ for all models. when strong effects on σ were simulated, type i error superimposed power, so that results are difficult to interpret .

resampling procedure for models for location and scale
since asymptotic inference for variable scale models for methylation data is associated with inflated type i errors, we next considered resampling-based modes of inference. standard parametric bootstrap is not an option for dna methylation data, since we do not know the true distribution of the data. in non-parametric bootstrap, i.e. sampling of observations with replacement, the problem arises that the mean-variance structure within each observation is maintained, and false positives due to identifiability problems between covariate effects on the two distribution parameters would not be corrected for. this problem might occur in a reverse manner in permutation testing. therefore, we developed a resampling procedure for models for location and scale , which provides a solution for both the unknown distribution of methylation data and false positives arising from covariate effects on the respective other distribution parameter.

to evaluate the performance of the developed resampling procedure, we applied it to the real-data distributed methylation values generated in the simulation study for  <dig>  cpg sites , for the variable scale models lo+ and be+, with b= <dig>  in addition, we identified for each cpg site the three snps from a ± <dig> mb window around the cpg site showing successively the strongest correlation with methylation at this site  <cit> . these snps were then included as additional covariates in the model. for both lo+ and be+ models, this combined strategy substantially reduced type i error rate close to the nominal level, as long as covariate effects on the other distribution parameter were moderate .   

validation in a data set of acute lymphoblastic leukemia patients and healthy controls
an important question is whether our observations are valid also for methylation data from cancer patients and healthy controls, which might differ fundamentally from population-based data in terms of their distribution and outlier structure. these aspects might have an impact on the performance of the different models, as well as on the performance of the proposed resampling strategy. therefore, we repeated all performance comparisons and evaluations on a publicly available data set comprising infinium humanmethylation 450k methylation data from bone marrow samples of  <dig> acute lymphoblastic leukemia  patients of two different types , as well as  <dig> healthy controls .

in these data, we were able to confirm our main findings: first, models of location and scale outperformed models of location only in terms of model fit and predictive performance . second, the gaussian variable scale model on methylation m-values most often showed the best residual model fit . third, we again observed increased type i error rates for tests of covariate effects on the scale parameter, and on both distribution parameters in the presence of strong effects on the respective other parameter . finally, although genetic confounding could not be accounted for due to lack of snp data, the proposed resampling precedure performed considerably well in the moderate effect size scenario .

it remains a challenge to improve the method to control type i error in the presence of strong covariate effects on the other distribution parameter. in the population-based kora data, effects of lifestyle and phenotypic factors were rarely stronger than the simulated moderate effect size. in contrast, in the investigated cancer data set, case-control effects were sometimes larger than the simulated moderate effect size, so that the proposed resampling procedure will not be capable of clearly separating effects on location and scale. a similar issue might arise when investigating the effect of proportions of white blood cell types, which tend to have strong effects on specific cpg sites, affecting both mean  <cit>  and variability  <cit> . however, we would like to emphasize that a clear separation of covariate effects on location and scale in the presence of a strong  relation between the two is a major challenge to any parametric or nonparametric approaches.

application to an ewas of bmi and age in the kora study
our results have shown that it is worth to examine covariate effects on dna methylation variability, since model performance was improved by modeling the scale parameter. therefore, we undertook an ewas of bmi and age in the large population-based kora f <dig> sample. we used the gaussian model on m-values  which achieved the best model fit and predictive performance in our model comparisons. bmi was chosen since obesity has been reported before to associate with dna methylation variability at specific cpg sites  <cit> . in addition, we were interested in age since a recent investigation has revealed the presence of regions in the genome that are characterized by an increased methylation variability in an age group specific manner, where significantly more of these regions were observed in older age groups  <cit> .

to avoid inflated type i errors of tests for covariate effects on location and scale, we included snps as additional covariates as described above. otherwise, all covariates were included that were also included in the model comparisons. in addition, we used the resampling procedure described above for the significant associations.

before the resampling procedure was applied,  <dig> and  <dig> genome-wide significant associations between bmi and methylation level  as well as variability  were observed, respectively  . we term these cpg sites differentially methylated cpg sites  and differentially variable cpg sites , respectively, in accordance with xu et al. <cit> . larger numbers of significant associations  were observed for age . as expected from the test performance results, the percentage of cpg sites for which significance was “confirmed” using the resampling procedure was larger for dmcs  than for dvcs . specifically in the case of bmi, the majority of dvcs seemed to be false positives according to the resampling procedure.

for bmi dvcs, age dmcs and age dvcs, we observed that associations with significant resampling-based p-values could be validated significantly more often in the independent kora f <dig> study . this observation was stable to the threshold of significance in the replication study. for instance, when the threshold was changed from nominal significance  to a bonferroni-corrected threshold  which is often used, enrichment results essentially did not change. assuming that validation in an independent study is an indicator of trueness of an effect , these results suggest that the resampling procedure filtered out false positives. note that the replication study was smaller  than the discovery study , so that not all true effects can be expected to validate.

investigating the observed effect directions, we noted that for the majority  of bmi dvcs that were not confirmed by resampling, associations were positive . this was not observed for the dvcs significant after resampling. a plausible explanation might be that the variable scale model is more susceptible towards methylation outliers at larger bmi values where bmi density is sparser. interestingly, xu et al. <cit>  reported an enrichment of positive associations of obesity and methylation variability in a study population of  <dig> obese and  <dig> lean subjects, where the standard deviation of bmi in the obese group was fivefold that of the lean group. the identified dvcs were often characterized by one or several outliers occuring in the obese group. the authors used the parametric bartlett’s test to identify dvcs. to evaluate this test procedure using our own data, we subjected the  <dig> initially discovered bmi dvcs to bartlett’s test after dividing the study population into two groups by the median bmi. although this approach differs considerably from ours, for instance since bartlett’s test does not include covariate information, and the variability is modeled separately from the mean, bartlett’s test indicated genome-wide significance for  <dig>  of the dvc initially identified by gamlss,  <dig> % of which were positive associations. this suggests that bartlett’s test might share the susceptibility to outlier values and likely also to genetic confounding in the methylation data, and might have increased type i error rates in that case.

in the ewas of age, a substantial number of dmcs  and dvcs  passed both resampling-based correction and validation step . the vast majority of validated dvcs  showed positive associations , indicating increased methylation variability with increasing age. this observation fits well with the previous finding of larger dna methylation variability in adult as compared to newborn blood  <cit> . it is also in agreement with an increased number of age group specific highly variable cpg sites in older as compared to younger age groups  <cit> . specifically, we also observed dvcs at neurotransmission-related genes. in addition, highly variable cpg sites were enriched in the vicinity of genes involved in developmental and morphogenetic processes  <cit> , suggesting a role of methylation variability during development. age-related increases in methylation variability at specific cpg sites might be attributed to both stochastic events  <cit>  as well as accumulating environmental and lifestyle influences. we also have to acknowledge the possibility that the observed age effects on methylation variability are partially attributed to changes in white blood cell proportions with age  <cit> . white blood cell types differ strongly in methylation variability  <cit> . although we included estimated white blood cell proportions as covariates, residual confounding might occur  <cit> .

CONCLUSIONS
we have addressed two challenges arising from the characteristics of methylation data: first, the appropriate treatment of methylation β-values as a proportion response, and second, the difficulty of assessing covariate effects on both location  and scale  of these data. the latter issue has become important because recent findings suggest a role of methylation variability in addition to methylation level in disease processes, including cancer  <cit> . in contrast to recent strategies to assess associations between methylation variability and disease-related traits  <cit> , we propose simultaneous modeling of location and scale using the gamlss framework  <cit> .

a key result of our study is that simultaneous modeling of mean and variability of dna methylation data improved the predictive performance as compared to modeling the mean only. a particularly good performance was observed for the gaussian model on methylation m-values. to avoid false positives arising from violations of the distribution assumption, we proposed and applied a resampling procedure as a mode of inference for models for location and scale. in our experiments, this procedure substantially reduced type i error rates so that they became close to the nominal level in practically relevant settings. the validity of this approach could be confirmed both in population-based data and in a data set of cancer patients and healthy controls. moreover, the application of our methodology to an ewas of bmi and age in the large population-based kora f <dig> study revealed biologically plausible positive effects of age on methylation variability. these effects were stable towards validation in an independent study.

our findings suggest that gamlss is a useful tool to explore environmental and lifestyle effects on methylation variability, simultaneously to effects on the mean. since the investigated models for location and scale were susceptible towards overfitting when sample size was moderate, it could be promising to investigate extensions based on regularization techniques such as boosting . in addition, in our data, methylation at the majority of cpg sites follows none of the compared distributions. thus, it might be relevant to explore robust methods such as quantile regression  <cit> .

competing interests
the authors declare that they have no competing interests.

authors’ contributions
sw, nf and ms devised the basic idea for the manuscript. sz performed the laboratory measurements. sw performed the statistical analyses with contributions from nf and ms. ks, cg, mw and hg contributed data and obtained funding. sw, nf, sz, ks, cg, mw, hg and ms wrote the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
supplementary methods. dna methylation data preprocessing; definition of the pseudo r  <dig> criterion for the competing models. data preprocessing and methods for the all data set.

click here for file

 additional file 2
supplementary tables.table s <dig>  description of the kora f <dig> study population. table s <dig>  description of the kora f <dig> study population.

click here for file

 additional file 3
supplementary figures.figure s <dig>  distribution of β-, m- and a-values. figure s <dig>  performance of competing models for dna methylation data . figure s <dig>  simulation study: distribution of type i error rates of hypothesis tests for covariate effects in beta distributed methylation responses . figure s <dig>  simulation study: distribution of type i error rates of hypothesis tests for covariate effects in real-data distributed methylation responses . figure s <dig>  simulation study: average estimated type i error rates of hypothesis tests for covariate effects . figure s <dig>  simulation study: average estimated power of hypothesis tests for covariate effects . figure s <dig>  performance of competing models for dna methylation data in a data set of acute lymphoblastic leukemia  patients and healthy controls . figure s <dig>  residual normal fit of competing models for dna methylation data in a data set of acute lymphoblastic leukemia  patients and healthy controls . figure s <dig>  simulation study: average estimated type i error rates of hypothesis tests for covariate effects . figure s <dig>  type i error control through the resampling procedure in a data set of acute lymphoblastic leukemia  patients and healthy controls .

click here for file

 acknowledgements
the kora research platform and the kora augsburg studies are financed by the helmholtz zentrum münchen – german research center for environmental health, which is funded by the german federal ministry of education and research  and by the state of bavaria. we thank all kora study participants and all members of the field staff in augsburg who planned and conducted the study. the german diabetes center is funded by the german federal ministry of health and the ministry of school, science and research of the state of north-rhine-westphalia. additional support was given by the bmbf . the work of ms was supported by deutsche forschungsgemeinschaft , grant schm 2966/1- <dig>  ks is supported by ‘biomedical research program’ funds at weill cornell medical college in qatar, a program funded by the qatar foundation. the funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript. we thank nadine lindemann, franziska scharl and nicole spada for excellent technical support.
