BACKGROUND
allele frequency denotes the relative frequency of an allele compared with the total frequency of all alleles at a marker locus. it is one of the most important population indices and has been broadly applied to genetic/genomic research  <cit> . the generalized concept of allele frequency has two aspects: individual-level allele frequency and population-level allele frequency. the former represents a within-individual relative frequency of alleles and its standard error reflects inter-cell variability in an individual; the latter represents a within-population relative frequency of alleles and its standard error reflects inter-individual variability in a population  <cit> .

using the most abundant genetic marker in the human genome, namely the single-nucleotide polymorphism , both individual-level and population-level allele frequencies can be estimated using a  allele-counting approach and an  intensity-measuring approach . this paper focuses on the intensity-measuring allele frequency because this allele frequency estimate is insensitivity to genotyping errors and preserves data information that might be lost in conventional genotype-based analyses. for instance, the genomic abnormality of a particular sample, for instance na <dig> from the japanese in population in the international hapmap project  <cit> , can be easily observed by individual-level allele frequencies using an intensity-measuring approach  but not by using an allele-counting approach . the finding motivated us to analyze intensity-based allele frequencies for extraction of information lost in conventional genotype-based analyses.

an intensity-measuring approach can accurately estimate allele frequencies with the aid of an adjustment for preferential amplification/hybridization  <cit> . the coefficient of preferential amplification/hybridization  is used to quantify preferential amplification/hybridization and reduce the estimation bias of allele frequency  <cit> . consider a snp with genotype aa, aa or aa. in comparison with an unadjusted individual-level allele frequency , a cpa-adjusted frequency of allele a moves toward the expected values of  <dig>   <dig>  and  <dig> for snps with genotypes aa, aa and aa, respectively . in comparison with an unadjusted population-level allele frequency from a dna pool of  <dig> individuals , a cpa-adjusted frequency of allele a moves toward the true allele frequencies obtained from an individual genotyping experiment   <cit> . the results demonstrate the important role of cpa adjustment in allele frequency estimation, thereby expanding applications of allele frequency in various genomic science disciplines. the features of cpa have been studied, but not exhaustively  <cit> . therefore, we undertook an in-depth investigation of the relationship between cpa and important factors including sample size, time of data acquisition, effects of laboratory site, type of gene chip, ethnicity effects, and phenotypic status, and we constructed new public cpa and allele frequency databases.

population-level allele frequency has many important applications and has been well discussed  <cit> . this paper mainly focuses on individual-level allele frequency and investigates its applications in genetic/genomic studies, including the discovery of allele frequency patterns, identification of chromosomal aberrations , and allelic imbalance ), outlier detection, and sample classification . this is the first time that these important genetic/genomic applications have been simultaneously conducted based on individual-level allele frequencies estimated by a unified intensity-measuring approach.

methods
samples
this study analyzes genotype and intensity data from several large genomic projects. the first dataset consists of  <dig> and  <dig> taiwanese samples genotyped using the affymetrix human mapping 100k set and 500k set , respectively, from the taiwan han chinese cell and genome bank  <cit> . the second dataset consists of  <dig> and  <dig> hypertension patients genotyped using the affymetrix human mapping 100k set and 500k set, respectively, from the academia sinica multi-centered hypertension genetic study. the third dataset consists of  <dig> african trios of yoruba in ibadan ,  <dig> caucasian trios of residents in ceph utah , and  <dig> asians  and  <dig> japanese in tokyo ) from the international hapmap project  <cit> , where all  <dig> samples were genotyped using both the affymetrix human mapping 100k set and 500k set. the fourth dataset consists of  <dig> and  <dig> leukaemia cancer patients who were genotyped using the affymetrix human mapping 100k set and 500k set, respectively; in addition,  <dig> normal controls were genotyped with the affymetrix human mapping 100k and 500k sets from an acute lymphoblastic leukaemia  project  <cit> . all participants involved in the genomic projects signed informed consent forms.

genotyping
all samples were genotyped with the affymetrix human mapping 100k set and/or 500k set , which contain  <dig>  snps with a median inter-marker distance of  <dig>  kb and  <dig>  snps with a median inter-marker distance of  <dig>  kb, respectively. the data sheets and genotyping manuals for the two snp chips can be downloaded at http://www.affymetrix.com/. for details of the snp genotyping experiments refer to yang et al.  <cit>  for the taiwanese normal samples and hypertensive patients, the international hapmap consortium  <cit>  for the international hapmap project samples, and mullighan et al.  <cit>  for the all project samples. snp genotype calling algorithms, dm   <cit>  and brlmm   <cit> , were used for the affymetrix human mapping 100k set and 500k set, respectively.

allele frequency estimation
an individual-level allele frequency is the proportion of a specific allele in a genotype. here we formulate the existing procedures of allele frequency estimation. consider an example of a snp with genotype aa, aa or aa. two methods can be used to estimate an individual-level allele frequency. first, the allele-counting approach uses genotype data from an individual genotyping experiment . the number of allele a is counted and then used to calculate the proportion of allele a in a genotype. besides no calls, there are only three possible outcomes of an allele frequency estimate for a snp. therefore, allele frequency estimates are  <dig>   <dig>  and  <dig>  corresponding to genotypes aa, aa and aa, respectively ). second, the intensity-measuring approach uses intensity data from an ige. the frequency of allele a is estimated by calculating the ratio of intensities pertaining to allele a relative to the total intensity of two alleles, where intensities are adjusted by considering a cpa. the ratio reflects a relative amount of allele a compared with the total amount of two alleles at a snp for an individual ).

in contrast to an individual-level allele frequency, a population-level allele frequency is the proportion of a specific allele in a study population. the allele frequencies can be estimated based on data from an ige or a pooled allelotyping experiment . in an ige, individual-level allele frequencies are estimated by using genotype data or intensity data as mentioned above. then a population-level allele frequency is estimated by taking an average over individual-level allele frequencies from genotype data ) or intensity data ). in a pae, intensity data are available, but individual genotype data are not. a relative intensity of allele a in a dna pool, which is constructed by mixing genomic dna from multiple samples, is calculated to estimate a population-level allele frequency ). the detailed procedures for allele frequency estimation and cpa adjustment are described in appendix a.

identification of chromosomal aberrations
we develop multiple chromosomal aberration indices and a sliding-window approach in concert with a standard individual-level allele frequency plot to identify chromosomal aberrations such as aneuploidy, ai, loh, long-contiguous-stretch-of-homozygosity , and so on. for an individual and a snp, individual-level allele frequency is compared with genotype-specific reference confidence intervals. index  is used to detect ai genomic segments characterized by snp points with allele frequencies outside the allele frequency confidence intervals of three genotypes. index  is used to detect loh or lcsh, genomic regions characterized by snp points with contiguous homozygous calls . the two indices are used to identify unusual snps point by point. furthermore, based on all patients and normal controls, two multipoint indices, ) and ) are calculated in each window using a sliding-window approach. in addition, the smoothed indices,  and , are also calculated using a spline smoothing technique. we identify chromosomal aberrations by pinpointing the genomic regions where the indices of a patient are higher than the 95%-quantile indices of normal controls. detailed procedures for identifying chromosomal aberrations are described in appendix b.

sample classification and outlier detection
we apply an allele frequency biplot based on individual-level allele frequencies to classify samples and detect outliers. an allele frequency biplot, which uses a singular value decomposition to decompose an allele frequency matrix into a sample matrix and a snp matrix  and ), projects samples and snps onto a two-dimensional plane simultaneously. the first dimension is a sample coordinate constructed by the first two columns of the sample matrix, and the second dimension is a snp coordinate constructed by the first two columns of the snp matrix. the rank- <dig> biplot configuration can be utilized for sample classification, outlier detection and snp clustering. first, sample classification allows for samples with a similar allele frequency distribution to be clustered and used to study population stratification and gender grouping. second, outlier detection identifies samples far away from the majority of samples for a further examination prior to downstream analyses. third, snp clustering identifies a collection of snps physically close to specific sample groups. the snp patterns are used to separate sample groups and explain sample characteristics. detailed procedures for constructing an allele frequency biplot are described in appendix c.

RESULTS
coefficient of preferential amplification/hybridization
we characterize genomic patterns of cpa based on the three genome projects, the taiwan han chinese cell and genome bank  <cit> , the academia sinica multi-center hypertension genetic study, and the international hapmap project  <cit> . both affymetrix 100k and 500k sets are considered. this work extends our previous study by using richer study samples and denser snp chips  <cit> . we calculate cpa based on an unbiased estimator  <cit>  and construct public cpa databases for the taiwanese population, ethnic-specific populations , and a cross-ethnicity group . the cpa databases are available online at http:// <dig> . <dig> /index.htm. three cpa query methods  are provided. in addition, we examine the relationship between cpa and important factors including:  sample size ;  time of data acquisition  and effects of laboratory site ;  gene chip type ;  ethnicity effects ; and  phenotypic status . results of the investigation of these issues are summarized in order they are presented here.

first, cpa can be estimated well for a moderate sample size , but its variance decreases significantly with increasing sample size . based on a total of  <dig> taiwanese samples that were genotyped with the affymetrix human mapping 100k set,  <dig>   <dig> and  <dig> samples are randomly selected from the  <dig> samples. pairwise correlation coefficients of log <dig> obtained from different sample sizes are calculated, and the lowest correlation coefficient is greater than  <dig> . in the fitted quadratic regression, an intercept term is close to  <dig> , and the regression coefficients of the linear term and quadratic term are close to  <dig> and  <dig>  respectively. in other words, cpas are close even when they are calculated from a relatively small sample size, implying that cpa can be estimated well even for a moderate sample size . note that, with respect to each snp, only heterozygous individuals have been used to estimate cpa. the expected number of heterozygous individuals is the number of total samples multiplied by the probability that a snp is heterozygous. cpa variances pertaining to the four sample sizes are calculated. the overall snp averages of ratios of cpa variances of  <dig> versus  <dig> samples ,  <dig> versus  <dig> samples , and  <dig> versus  <dig> samples  are  <dig> ,  <dig> , and  <dig> , respectively. the larger the sample size, the smaller the variability of cpa .

second, cpa is insensitive to data from different genotyping time periods  and different laboratories . to evaluate time effect on cpa, cpas are calculated based on data from the same genotyping laboratory but from four time periods of data acquisition , and sample sizes in experiments are close . all the pairwise correlation coefficients of log <dig> are greater than  <dig> , and quadratic regression curves act like a linear regression line passing through the origin and having a slope of  <dig>  implying that cpa is robust to data from different genotyping periods . we also examine the effect of genotyping sites on cpa. cpas are calculated based on data from the  <dig> asian samples in the international hapmap project and  <dig> taiwanese samples. these two datasets with similar sample sizes were collected from asian populations but genotyped at different times and sites. a high correlation of cpa between the two datasets is found across chromosomes, implying that cpa is robust to data from different genotyping sites .

third, cpas from the affymetrix human mapping 100k and 500k sets yield similar genomic patterns . means  of log <dig> for 100k and 500k sets are  <dig>   and  <dig>  , respectively. the majority of log <dig> are bounded by ± <dig>  moreover, we examine genome-wide distributions of cpa for different ethnic groups , taiwanese samples and their combination) and different snp chips . the results show that genome-wide cpa can be well modeled by using log-normal distributions, where the results of taiwanese samples are shown . the finding is useful for discussions of theoretical sampling distribution of cpa-adjusted allele frequency estimates and statistical tests.

fourth, genomic distributions of cpa between ethnic groups may differ . cpas are calculated based on data from different populations, including  <dig> han chinese ,  <dig> japanese ,  <dig> africans ,  <dig> caucasians ,  <dig> asians , and  <dig> combined samples . results show that correlation of cpas among populations is dependent on the ethnic populations selected . among all pair-wise comparisons, two asian populations, chb and jpt, have the highest correlation , depicted by a flat ellipse; the two asian populations and caucasian populations have the lowest correlation , depicted by round ellipses. note that comparison of the caucasian and the combined asian populations present a nephroid ellipse, where the 95% confidence interval of the mean regression curve does not pass through the origin, and the slope term deviates from unity. this suggests a relatively large discrepancy of cpas between asian and caucasian populations. cpas of the african population are located in an intermediate position between the asian and caucasian populations, and the order is shown in a tree diagram .

finally, cpa distributions between hypertension patients and normal controls are similar . cpas are calculated based on a total of  <dig> taiwanese normal control samples and  <dig> taiwanese hypertension patient samples that were genotyped with the affymetrix human mapping 100k set in the same laboratory. a high correlation  is observed. this result implies that the pooled dna association mapping of a taiwanese hypertension study may use the same cpa for case and control groups.

allele frequency
based on our cpa databases, we estimate individual-level allele frequencies using the intensity-measuring approach for samples from different populations, including  affymetrix human mapping 100k set:  <dig> taiwanese samples and  <dig> hapmap samples, and  affymetrix human mapping 500k set:  <dig> taiwanese samples and  <dig> hapmap samples. the pattern of allele frequency can be observed in a standard allele frequency plot. for example, for a normal female sample  from the yri population in the international hapmap project , with the exception of some noisy snp points, an allele frequency plot exhibits three bands formed by snps with an individual-level allele frequency close to  <dig>   <dig>  or  <dig> ). allele frequency plots of cancer patients with chromosomal aberrations will be shown later in identification of chromosomal aberrations. in addition, we establish individual-level allele frequency databases that provide snp annotation, allele frequencies and the summary statistics for the hapmap samples for both the affymetrix human mapping 100k and 500k sets. the databases are available online at http:// <dig> . <dig> /index.htm. three allele frequency query methods  are provided. the individual-level allele frequency estimates and databases are applied to genomic pattern detection, chromosomal aberration analysis, classification analysis, and outlier detection.

identification of chromosomal aberrations
individual-level allele frequency can be used to identify chromosomal aberrations, such as aneuploidy, loh, ai, and so on, which contribute to the complex genomic profiles of many cancer patients. based on our constructed databases of cpa and individual-level allele frequency, we apply the developed sliding-window loh and ai detectors to identify chromosomal aberrations for the  <dig> and  <dig> all patients that were genotyped with the affymetrix human mapping 100k set and 500k set, respectively, in the all project. two examples are given here to demonstrate whole-chromosome aberration and segment aberration. the first example is a male leukaemia patient with hyperdiploidy . his genome exhibits ai on chromosomes  <dig>   <dig>   <dig>   <dig>   <dig>  and  <dig> and loh on chromosomes  <dig>   <dig> and  <dig> . the second example is a male t-cell all patient . three chromosomal regions, 2p, 6q, and 9p, of ai are identified, with chromosomes 6q and 9p also show loh .

high proportions of loh and ai are found in the all study. in the analysis of  <dig> patients genotyped with the affymetrix 100k set,  <dig> samples  with ai are found, and  <dig> of these  have whole-chromosome ai. among the  <dig> patients,  <dig> samples  with loh are found, and  <dig> of these  have whole-chromosome loh. in the analysis of  <dig> patients genotyped with the affymetrix 500k set,  <dig> samples  with ai are found, and  <dig> of these  have whole-chromosome ai. among the  <dig> patients,  <dig> samples  with loh are found, and  <dig> of these  have whole-chromosome loh.

group classification and outlier detection
based on individual-level allele frequencies, an allele frequency biplot is developed to classify samples belonging to different ethnic groups and gender groups and identify outlier samples.

first, in an unsupervised cluster analysis of the international hapmap project data, the majority of samples from african , caucasian  and asian  populations are clearly classified into three groups in an allele frequency biplot . furthermore, samples from chinese  and japanese  populations are also accurately classified as two distinct groups . the results illustrate that individual-level allele frequencies are not only useful to distinguish the genetic differences of the asian, caucasian and african populations, but also able to distinguish the small differences between asian subpopulations.

second, allele frequencies can be used to judge the gender of a person from which a sample was obtained. genetically, a female has two x chromosomes and a male has only one x chromosome. high homozygosity on the x chromosome should generally be observed in a male sample . our analysis shows that an allele frequency biplot for the x chromosome can classify the gender of samples donors .

third, allele frequency biplots can be used to detect outliers. for example, a jpt sample  is some distance away from all other samples in a biplot of chromosome  <dig>  because this sample has a lcsh on this chromosome.

discussion
we apply individual-level allele frequencies, estimated using an intensity-measuring approach, to genetic and genomic studies. under the framework, statistical inferences are drawn based on intensity data instead of genotype data. compared with a genotype-based analysis that estimates allele frequencies via an allele-counting approach, our method has three advantages. first, the method can analyze data from dna samples reflecting clonal heterogeneity and containing dna from contaminating "normal" cells, which is often the case in cancer studies. second, the method can be used to analyze data from mixed dna of multiple samples for cost savings. third, the method is insensitive to genotype calling errors, which frequently occur in aberrant chromosomal regions, such as segments with aneuploidy, loh, ai, and so on. the performance of the methods developed for amplification/hybridization calibration, allele frequency estimation, group classification, outlier detection, and genomic aberration identification are examined comprehensively based on the data from large-scale genomic projects.

the proposed methods are not restricted to the affymetrix genechip, but also are adapted to the illumina beadchip. for example, the individual-level allele frequency plot of a normal sample genotyped with the illumina humanhap550-duo beadchip also yields the expected three-band pattern similar to what is obtained with the affymetrix genechip . in addition to applications for individual-level allele frequency, the proposed intensity-measuring approach can be easily applied to study population-level allele frequency. for example, in a pooled allelotyping experiment  <cit> , individual genotype information is not available, thereby the allele-counting approach fails to be applied; the proposed intensity-measuring approach, however, works well in this type of experiment . allele frequency estimates of the pooled allelotyping experiment of a pool size of  <dig> are quite accurate compared to the true answers obtained from the individual genotyping experiment of all  <dig> samples  . pooled dna is constructed by mixing dna from multiple individuals; therefore, allelotyping of pooled dna provides a cost-saving alternative to an individual genotyping experiment and has been recognized as an efficient tool for identification of polymorphisms and mutations, homozygosity mapping, genetic association, and so on.

we have constructed large ethnicity-specific and cross-ethnicity cpa databases. compared with our previous database  <cit> , the new databases are improved by increased sample size and the addition of a dense snp chip platform. researchers may use our free database, thereby curtailing study costs. the characteristics of cpa extracted from our databases are summarized as follows. first, cpa variance decreases significantly as sample size increases; thus, a cpa database should be based on a large number of samples. second, cpa is independent of the time and laboratory where the genotyping took place, and therefore the cpas provided in our databases are applicable to studies carried out at different times and places. third, the 100k and 500k gene chips yield similar cpa patterns. fourth, discrepancies of cpas in ethnic groups discourage the direct use of cpa from different ethnic groups. fifth, most snps have a strongly positively correlated genomic distribution of cpa between phenotypic groups of hypertension. sixth, log-normal distributions capture the genomic distributions of cpa well, and cpa is associated with gc content and genotype. these findings broaden our understanding of preferential amplification/hybridization and will benefit a wide variety of genetic/genomic studies. in addition, we also constructed a database of individual-level allele frequency, which provides useful materials for genetic/genomic research discussed in this paper.

interestingly, when compared to the result of dna copy number changes in t-all-snp-# <dig> reported by mullighan et al.  <cit> , ai of chromosome 2p correlates well with amplification, whereas ai and loh of chromosomes 6q and 9p are the result of deletions. these results demonstrate the feasibility of applying individual-level allele frequencies to identify chromosomal aberrations. our method can be jointly used with some of the existing copy number analysis tools such as lb  <cit> , penncnv  <cit> , quantisnp  <cit> , dchip  <cit> , and genocn  <cit>  to move toward a more complete understanding of the mechanisms underlying chromosomal abnormalities.

in addition to identification of chromosomal aberrations, individual-level allele frequency can also be used to identify an occurrence of cell mixture. jpt sample na <dig> is an example with "abnormal" genomic patterns  that obviously deviate from the three-band pattern of a normal sample . the individual-level allele frequency plot of sample na <dig> shows that the majority of this individual's genome have five allele frequency bands with the exception that some autosomal regions have two or three bands and the x chromosome has four bands, indicating that this sample may reflect a mixture of dna samples. in addition, we show that individual-level allele frequency can also be used to estimate the level of contaminating "normal" cells . in the example of t-all-snp-# <dig>  the average allele frequencies  of the abnormal regions of 6q and 9p were as follows: f <dig> =  <dig>  for 6q, and f <dig> =  <dig>  for 9p, implying an estimated range of contaminating "normal" cells of  <dig>  -  <dig> , which is close to the reported sample purity  reported by mullighan et al.  <cit> .

our analyses show that individual-level allele frequencies and allele frequency biplots are useful for distinguishing genetic differences among ethnic populations. on the one hand, the method can be applied to examine population stratification, which is one of the most common factors underlying false positives in case-control association studies, through the identification of subgroups. on the other hand, the method is potentially useful to assign ethnicity for individuals with unclear ancestry information by superimposing a new sample point to the established ethnic groups using an allele frequency biplot, or to assign unknown forensic individuals to pre-study groups. compared with a principal component analysis that can also be applied to study sample classification, an allele frequency biplot provides a more detailed visual appraisal of the relationship between snps and samples .

CONCLUSIONS
allele frequency has been studied for many years. with the aid of whole-genome snp chip technology, high-throughput snp data have become available. based on the individual-level allele frequencies obtained from the unified estimation procedure, we developed new methods/software/databases to extract hidden genetic information and broaden the potential application of allele frequency to genomic research. our new analysis tool, aloha , written in r and r gui, provides for genome-wide analysis of allele frequency and detection of both loh and ai. an allelefrequency biplot is also provided for sample classification, outlier detection, and snp clustering. the software can be downloaded at http://www.stat.sinica.edu.tw/hsinchou/genetics/aloha/aloha.htm. new allele frequency and cpa databases have been created. functions for data query modes  and data downloads are provided. the databases are available at http:// <dig> . <dig> /index.htm. we expect that additional practical applications of allele frequency will be found and allele frequency analysis will continue to play a key role in genetic/genomic research.

abbreviations
ai: allelic imbalance; all: acute lymphoblastic leukaemia; aloha: allele-frequency/loss-of-heterozygosity/allele-imbalance; ceu: ceph utah residents; chb: han chinese in beijing; cpa: coefficient of preferential amplification/hybridization; ige: individual genotyping experiment; jpt: japanese in tokyo; lcsh: long contiguous stretch of homozygosity; loh: loss of heterozygosity; pae: pooled allelotyping experiment; snp: single nucleotide polymorphism; yri: yoruba in ibadan.

authors' contributions
hcy conceived of the study, developed statistical methods and prepared the manuscript. hcl and mch programmed aloha software and analyzed the data with hcy. lhl contributed to discussion. whp, jyw and ytc provided genetic data of taiwanese samples. all authors read and approved the final manuscript.

appendices
appendix a. allele frequency estimation
we summarize the estimation procedures for two types of allele frequencies, individual-level and population-level allele frequency, in this appendix. this summary focuses on the most abundant genetic marker, the snp, in the human genome. snp data can be generated from two types of snp typing experiments, namely an individual genotyping experiment  and a pooled allelotyping experiment , which can be carried out using a customized platform  or a genome-wide platform .

an ige collects intensity data  and then uses a snp calling algorithm to assign genotype calls to snps based on intensity data. both individual-level and population-level allele frequencies can be estimated by using an allele-counting approach based on genotypic data and an intensity-measuring approach based on intensity data.

in contrast to an ige, which analyzes dna from each individual, a pae analyzes mixed dna from multiple individuals. with pae it is difficult to extract genotype information for individuals although the same genotyping platform is employed for pae as ige. a pae collects intensity data but cannot determine individual genotypes, and is therefore unable to estimate individual-level allele frequency; nevertheless, a pae provides a cost-efficient way to estimate population-level allele frequency by using an intensity-measuring approach.

we introduce the estimating procedures as follows. suppose that there are n independent individuals in total. consider a snp with genotype aa, aa or aa. let  denote individual-level allele frequencies for n individuals and p denote a population-level allele frequency of allele a. in an ige, we collect two types of data for each individual:  genotypes , and  pairs of intensities of two alleles {,i =  <dig> ...,n}. in a pae, we collect a pair of intensities of two alleles  in a dna pool with a pool size of n.

first, we introduce the estimating procedures for an individual-level allele frequency, which is a proportion of a specific allele in a genotype. an individual-level allele frequency can be estimated using an allele-counting approach based on genotypic data and an intensity-measuring approach based on intensity data from an ige.

the allele-counting approach uses genotype data from an ige. the number of allele a is counted and then used to calculate the proportion of allele a in a genotype. under the assumptions of hardy-weinberg equilibrium and random sampling, the formulae of the estimator of allele frequency of allele a and its expectation and variance can be written as follows:   

where i is an indicator taking a value of  <dig> if event e holds; otherwise, the value is  <dig> 

the intensity-measuring approach uses "adjusted" intensity data from an ige, where intensities are "adjusted" by considering a coefficient of preferential amplification/hybridization . based on intensity data from individuals who are heterozygous at the snp, cpa can be estimated as follows  <cit> :  

where  are the sample means of intensities of individuals and nheter is the number of individual heterozygous for the snp. for each individual, the frequency of allele a is estimated by calculating the ratio of adjusted intensities pertaining to allele a relative to the total intensity of the two alleles. the estimator and its expectation and variance can be written as follows:   

where a first-order taylor expansion is used to calculate of the approximate expectation and variance,  is the coefficient of variation of cpa, and σ <dig> is the experimental variation.

second, we introduce procedures to estimate a population-level allele frequency, which is a proportion of a specific allele in a study population. the allele frequencies can be estimated based on data from an ige or a pae. in an ige, a population-level allele frequency can be estimated by taking an average over individual-level allele frequencies from genotype data ) or intensity data ). the estimators and their expectations and variances can be written as follows:      

in a pae, relative intensities of allele a in a dna pool, which is constructed by mixing genomic dna from n samples, are calculated to estimate a population-level allele frequency. the estimator and its expectation and variance can be written as follows:   

appendix b. identification of chromosomal aberrations
a sliding-window approach, aided by individual-level allele frequency plots, is developed to identify chromosomal aberrations. all snps are arranged in order of physical position on a study chromosome. let  and denote the genotype data and the individual-level allele frequency of the mth snp of the ith snp chip. for any snp m, the genotype-specific reference mean and standard deviation of the individual-level allele frequency can be calculated based on a large number of reference samples as follows:  

where gm is aa, aa or aa. then three genotype-specific reference confidence intervals can be written as follows:

. the first single-point index  is used to detect an allelic-imbalance  snp with allele frequency outside the allele frequency confidence intervals of the three genotypes. the second single-point index  is used to detect a loss-of-heterozygosity  or long-contiguous-stretch-of-homozygosity  snp with allele frequency outside the allele frequency confidence intervals of a heterozygous call. in other words, snp m of individual i is identified as an ai snp point if ai,m =  <dig> and identified as an loh/lcsh snp point if li,m =  <dig>  two multilocus sliding-window chromosomal aberration detectors are developed as follows. the ai index can be written as   

and the loh/lcsh index as   

where  denotes a study window with an anchor snp m and  denotes the window size, i.e., the number of snps within the window. the indices are calculated for all normal controls and patients. we calculate a 95%-quantile of normal samples for index  and for index . the smoothed indices,  and , are calculated using a spline smoothing or local fit technique, such as a penalized regression  <cit> . we identify unusual genomic regions where the indices of a patient are higher than the 95%-quantile indices of normal controls in the human genome. the methods are useful for quickly scanning the human genome and accurately determining the starting and ending positions of chromosomal aberration regions for every patient.

a chromosomal aberration plot consisting of three components is used to detect special genomic patterns such as aneuploidy, loh, and ai . the first component is an extended allele frequency plot where ai snps  are depicted by red points and non-ai snps  are depicted by blue points. the second component is an ai plot where index  of a patient and the 95% quantile of  of normal samples are displayed as light-red points and light-blue points, respectively, and smoothed versions are displayed as deep-red points and deep-blue points, respectively. the top panel shows a red bar that denotes an ai region if  is greater than the 95% quantile of  of normal samples; otherwise, a blue bar is shown. the third component is a loh plot where index  of a patient and the 95% quantile of  of normal samples are displayed at light-red points and light-blue points, respectively, and smoothed versions are displayed as deep-red and deep-blue points, respectively. the top panel shows a red bar that denotes an loh region if  is greater than the 95% quantile of  of normal samples; otherwise, a blue bar is shown.

appendix c. allele frequency biplot
the biplot invented by gabriel  <cit>  was applied to explore microarray gene expression data  <cit>  and loh  <cit> . this paper first applies a biplot to visualize individual-level allele frequency data for hundreds of thousands of snps and large samples. let a denote the individual-level allele frequency matrix with r rows  and c columns . let f = a - ·a· <dig>  where  <dig> is a c ×  <dig> column vector with cell values of  <dig>  the matrix f is decomposed into a multiplication of an r × k snp-effect matrix  r and a c × k sample-effect matrix  c using a singular value decomposition as outlined below. first, allele frequency matrix f is decomposed by a singular value decomposition as follows:   

p is an r × r orthogonal matrix , and the columns of p are eigenvectors of ff'; q is an  orthogonal matrix  and the columns of q are eigenvectors of f'f; d is an r × r diagonal matrix having w nonnegative elements as the square root of nonnegative eigenvalues of ff' and f'f, where . second, allele frequency matrix f is further partitioned into row-effect and column-effect matrices as follows:   

where r = p and c = dq for a snp-effect biplot, and r = pd and c = q for a sample-effect biplot. note that ff' = rr' for a snp-effect biplot and ff' = cc' for a sample-effect biplot. for the convenience of visualization, a rank- <dig> approximate biplot is considered. namely, the first two columns of r and c with the largest singular values are selected to approximate the allele frequency matrix f. a higher-rank approximate biplot is also plausible by visualizing more than two components pairwise.

appendix d. estimation of the level of contamination by "normal" cells
individual-level allele frequency can also be used to calculate the level of contaminating "normal" cells. by extending the previous method  <cit> , we derive a general formula to estimate the proportion of contamination by normal cells for tumor cell samples using individual-level allele frequencies. suppose that the study dna is composed of 100% tumor cells and 100p% contaminating "normal" cells. in normal cells without ai, the ratio of two alleles of a heterozygous snp is  <dig> : 1; in cancer cells with ai, the ratio of two alleles is a : b, where a and b are the copies of the two alleles. then the frequency of the first allele is f1=/{×p+} and the frequency of the second allele is f2=/{×p+}. note that p, a, and b cannot be zero simultaneously. using simple algebra, the normal cell contamination proportion is derived to be p=/ if ×f <dig> ≠ ×f <dig>  as an example of a hemizygous deletion of the first allele , then f1=p/, f <dig> = 1/ and p = f1/. as an example of a single copy gain of the first allele , then f1=/, f <dig> = 1/ and p=/.

supplementary material
additional file 1
figure s <dig> --allele frequency of an individual  from the jpt population based on the affymetrix human mapping 100k set. this figure consists of  <dig> subfigures. each subfigure presents an allele frequency plot of one chromosome. the vertical axis is the estimated allele frequency, and the horizontal axis is physical position . each point denotes a snp, and the gap in each subplot represents the centromeric gap.  estimated allele frequency using an intensity-measuring approach.  estimated allele frequency using an allele-counting approach.

click here for file

 additional file 2
figure s2--unadjusted and adjusted individual-level allele frequency of a sample  from the jpt population based on the affymetrix human mapping 100k set. this figure consists of  <dig> subfigures. each subfigure presents an allele frequency plot of one chromosome. the vertical axis is the estimated allele frequency, and the horizontal axis is physical position . each point denotes a snp, and the gap in each subplot represents the centromeric gap.  unadjusted individual-level allele frequency estimates.  cpa-adjusted individual-level allele frequency estimates.

click here for file

 additional file 3
figure s <dig> --unadjusted and adjusted population-level allele frequency of an artificial dna pool with a size of  <dig> individuals based on the affymetrix human mapping 100k set. the vertical axis is the estimated allele frequency, and the horizontal axis is the true allele frequency.  unadjusted population-level allele frequency estimates.  cpa-adjusted population-level allele frequency estimates.

click here for file

 additional file 4
figure s <dig> --genomic distributions of cpa in log <dig> scale and standard error of cpa for four sample sizes.  this figure consists of  <dig> subfigures. the four diagonal subfigures are the histograms of log <dig> for sample sizes of  <dig>   <dig>   <dig> and  <dig>  the off-diagonal subfigures are scatter plots of log <dig> for pairs of sample sizes, where each blue point denotes a log <dig> value of a snp. a quadratic regression curve is fitted. the mean regression curve is plotted in red, and the corresponding 95% confidence interval is plotted in green.  the figure contains ratios of cpa standard errors of  <dig> versus  <dig> samples ,  <dig> versus  <dig> samples  and  <dig> versus  <dig> samples . the red reference line denotes the ratio of  <dig>  i.e., equal to the cpa standard error of  <dig> samples.

click here for file

 additional file 5
figure s <dig> --genomic distributions of cpa in log <dig> scale for different data acquisition times  and experimental sites .  this figure consists of  <dig> subfigures. the four diagonal subfigures are the histograms of log <dig> for the genotyping done on the time 2005/05/ <dig>  2006/01/ <dig>  2006/03/ <dig> and 2006/06/ <dig>  the off-diagonal subfigures are scatter plots of log <dig> for pairs of genotyping periods, where each blue point denotes a log <dig> value of a snp.  this figure consists of  <dig> subfigures. each subfigure shows a scatter plot of cpas in log <dig> scale of one chromosome based on  <dig> asian samples in the hapmap project  and  <dig> taiwanese samples . a quadratic mean regression curve  and the corresponding 95% confidence intervals  are calculated.

click here for file

 additional file 6
figure s <dig> --genomic distributions of cpa in log <dig> scale based on the affymetrix human mapping 100k and 500k sets. this figure consists of  <dig> subfigures. each subfigure shows a scatter plot or histogram of cpas in log <dig> scale of one chromosome.  scatter plots of cpas in log <dig> scale for the affymetrix human mapping 100k set based on  <dig> asian samples.  histograms of cpas in log <dig> scale for the affymetrix human mapping 100k set based on  <dig> asian samples.  scatter plots of cpas in log <dig> scale for the affymetrix human mapping 500k set based on  <dig> asian samples.  histograms of cpas in log <dig> scale for the affymetrix human mapping 500k set based on  <dig> asian samples.

click here for file

 additional file 7
figure s <dig> --lognormal distribution of cpa based on taiwanese samples. cpas are fitted using log-normal distributions by chromosome. the green curve is a fitted curve, and the purple curve is a theoretical lognormal curve.  taiwanese samples  that were genotyped with the affymetrix human mapping 100k set.  taiwanese samples  that were genotyped with the affymetrix human mapping 500k set.

click here for file

 additional file 8
figure s <dig> --genomic distributions of cpa in log <dig> scale for different ethnic groups and a tree diagram.  this figure consists of  <dig> subfigures. the six diagonal subfigures are the histograms of log <dig> for  <dig> chb,  <dig> jpt,  <dig> ceu founders,  <dig> yri founders,  <dig> asians , and  <dig> combined samples. the off-diagonal subfigures are scatter plots of log <dig> for pairs of groups, where each blue point denotes a log <dig> value of a snp. a quadratic mean regression curve  and the corresponding 95% confidence intervals  are provided.  the studied populations are clustered according to between-population proximity  via an average-linkage clustering analysis.

click here for file

 additional file 9
figure s <dig> --genomic distributions of cpa in log <dig> scale for hypertensive case group and normotensive control group. this figure consists of  <dig> subfigures. each subfigure shows a scatter plot of cpas in log <dig> scale of one chromosome based on data from  <dig> hypertension patient samples  and  <dig> normal control samples . a quadratic mean regression curve  and the corresponding 95% confidence intervals  are shown.

click here for file

 additional file 10
figure s <dig> --allele frequency biplots of sex chromosomes of hapmap samples based on the affymetrix human mapping 500k set.  allele frequency biplots of sex chromosomes for yri populations in hapmap .  allele frequency biplots of sex chromosomes for ceu populations in hapmap .

click here for file

 additional file 11
figure s <dig> --allele frequency of a normal sample based on the illumina humanhap550-duo beadchip. this figure consists of  <dig> subfigures. each subfigure presents an allele frequency plot of one chromosome. the vertical axis is the estimated allele frequency, and the horizontal axis is physical position . each point denotes a snp, and the gap in each subplot represents the centromeric gap. the allele frequencies were estimated using an intensity-measuring approach.

click here for file

 acknowledgements
we thank ms wen-ting fan for constructing cpa and allele frequency databases. we also thank mr. edward cheng for his assistance with the linux pc cluster system. we are grateful to dr. charles g. mullighan for the provision of the acute lymphoblastic leukaemia project data. we gratefully acknowledge the national clinical core and national genotyping center at academia sinica for providing dna samples and genotyping support. the work was supported by a grant from the national science council of taiwan  and the national research program for genomic medicine .
