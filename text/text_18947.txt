BACKGROUND
molecular interactions and regulatory networks underlie the development and functioning of biological systems  <cit> . these networks reliably and robustly coordinate the molecular and biochemical processes inside a cell, while remaining flexible in order to respond to physiological and environmental changes. the changing nature of regulatory and signalling interactions is beyond doubt, and a dynamical point of view is already deeply enshrined into cell and molecular biology. illustrations of such time-varying biological systems can be provided for instance by the development of the fruitfly drosophila melanogaster - which is segmented into different life stages: embryogenesis, larva, pupa and adult, or the adaptation of cellular organisms  to growth defects and cellular damages induced by environmental stresses. because they are extensively studied, considerable large-scale functional screening data exist for these examples. but while a growing number of studies report detailed and time-resolved analyses of regulatory and signalling processes  <cit> , mapping these temporally changing networks systematically remains a major and increasingly pressing challenge.

from available data, in-silico methods can generate hypotheses about biochemical and molecular mechanisms  <cit>  and guide further experimental and theoretical investigations into regulatory interactions underlying biological systems. biological networks are usually described mathematically in a way where each gene is represented by a node and the interactions  between genes as edges. a range of approaches has been proposed, which learn or infer correlative and causal relationships among the genes from high-throughput, in particular gene expression, data. however most of these approaches assume that the topology of the network, i.e. the sets of nodes and edges, stays constant over time. inferring the temporal changes in biological networks is an important statistical challenge  <cit> , but it does open up new perspectives for biological data analyses and will aid the generation of hypotheses about the dynamics of biological systems.

serious attempts to reconstruct dynamic networks whose topology changes with time started in  <dig>  <cit> . yoshida et al.  <cit>  employed a dynamic linear model with markov switching for estimating time-dependent gene network structures from time-series gene expression data. although promising this approach assumes that there is a fixed  number of distinct networks or phases, and the switching between phases is modelled via a stochastic transition matrix that requires an estimation of many parameters. talih and hengarten  <cit>  developed a markov chain monte carlo  methodology to recover time-varying gaussian graphical models in a financial context. again the total number of distinct network topologies is assumed to be known a priori and the network evolution is restricted to changing at most a single edge at a time. more recently  methods in which the number of distinct regulatory phases is determined a posteriori have been proposed. fujita et al.  <cit>  developped a dynamic vector autoregressive model to estimate time-varying gene regulatory networks. notably, only the values of the network parameters change over time, meaning that the global topology of the network remains constant. xuan and murphy  <cit>  introduced an iterative procedure based on a similar modelling ansatz, which switches between a convex optimization approach for determining a suitable candidate graph structure and a dynamic programming algorithm for calculating the segmentation of the time into distinct phases, i.e. the sets of successive time-points for which the graph structure remains unchanged. this time, the number of phases is explicitly determined, but it requires that the graph structure is decomposable. finally, robinson and hartemink  <cit>  used a mcmc sampler for the inference of non-stationary dynamical bayesian networks, with the attractive feature that the network structure within a temporal phase depends on the structure of the contiguous phases.

the approaches cited so far produce global network topologies with global changes, meaning that all the genes of the network change their regulatory inputs simultaneously. in reality however, we would rather expect that each gene  has its own and characteristic regulatory pattern. to that end, rao et al.  <cit>  developed a method called regime-ssm, which is divided into two steps. the main idea is to first cluster the genes that share the same temporal phases before inferring, in a second step, the network topology describing the regulatory associations between genes within each cluster using an expectation-maximization  algorithm. ahmed and xing  <cit>  introduced in  <dig> a machine learning algorithm  to infer time evolving networks , by solving a set of temporally smoothed l1-regularized logistic regression problems via convex optimization techniques.

the challenge of inferring time-varying structures of gene regulation networks is only starting to be adressed and in this paper we present the artiva algorithm  that is particularly well-suited for addressing the issues raised above. starting from time-course gene expression data, artiva performs a gene-by-gene analysis and infers simultaneously  the topology of the regulatory network, and  how it changes over time. in order to strike a balance between model refinement and the amount of information available to infer the model parameters, the artiva model delimits temporal segments for each gene where the influence factors and their weights can be assumed homogeneous. for that we use a combination of efficient and robust methods: dynamical bayesian networks  to model directed regulatory interactions between genes and reversible jump mcmc for inferring simultaneously the times when the network changes and the resulting network topologies. we evaluate the performance of artiva on simulated data and illustrate our approach in the context of two different biological systems. we start by analyzing a commonly used dataset related to the developmental stages of drosophila melanogaster and demonstrate the utility of our approach by a comparative analysis of the artiva results with the tesla results  <cit> . next, we analyze the response of the yeast saccharomyces cerevisiae to benomyl poisoning. this dataset represents an important challenge for the inference of time-varying networks since  the number of time-points is extremelly small  and  the expression values combine measurements obtained in wild-type and knock-out yeast strains. the biological relevance of the results obtained with artiva are finally assessed using functional annotations and transcription factor binding information.

methods
graphical models
bayesian networks  have become a popular framework for representing regulatory networks  <cit>  as they offer both a probabilistic interpretation of dependencies among expression of genes and a graphical representation that is more readily accessible than mathematical expressions . for example if the expression level of gene i, here denoted by xi, determines the expression level of genes j and k, a diagram such as

 j←i→k 

can be drawn and the joint distribution of gene expression levels written,

 p=ppp, 

where p denotes the probability of a conditional on b. because bns aim to represent the joint probability distribution  the corresponding graphical representation is limited to graphs which contain no cycles . this means that closed loops or complex feed-back structures  cannot faithfully be represented, whereas they are known to pervade regulatory networks  <cit> .

with time-course measurements, this limitation can be overcome by employing a dynamical bayesian network  formalism  <cit> , where the expression levels of all the genes in a system are modelled as a generally discrete-time stochastic process . for p genes and n measurements the expression levels are written as xi, with  <dig> ≤ i ≤ p and  <dig> ≤ t ≤ n. the joint probability distribution over the expression levels of all genes and at all times is then partitionned, p, ..., xp, ..., x <dig>  ..., xp), into a product of conditional probabilities of the markov form:

  p|xr, ..., xs) 

this means that the expression level of gene i at time t depends on the expression levels of genes r, ..., s at time t -  <dig>  genes r, ..., s are called the 'parents' of gene i and denoted by pai . by making the time dependence of expression levels explicit, loops and feedback interactions can be represented simply by requiring only that the expression of gene i at time t is independent of all other genes at the same time t. in conventional dbn inference approaches it is assumed that the conditional dependencies in eqn. , and hence the set pai, are independent of time t. of course it is possible to allow xi to depend on expression levels xr with τ > <dig>  i.e. allow for higher order dependencies. for computational reasons, however, our analysis is restricted to first order markov processes.

artiva network model
let p be the number of observed genes and n the number of time-points at which expression levels are measured for each gene. in this study, the discrete-time stochastic process x = {xi;  <dig> ≤ i ≤ p,  <dig> ≤ t ≤ n} is considered, taking real values and describing the expression level of the p genes at n time-points. we start by modelling the gene expression levels at time t probabilistically by a vector-autoregressive process:

  ∀t≥ <dig>  x=ax+b+ϵ with ϵ~n), 

where x = )1≤i≤p and n ) is the multivariate normal distribution centered at  <dig> with diagonal covariance matrix Σ. note that diagonality of Σ ensures that the process describing the temporal evolution of gene expression -- here a first order autoregressive process -- can be represented by a directed acyclic graph  as in figure 1c, i.e. no edges between nodes at the same time, and where the edges from time t -  <dig> to time t are defined by the set of non zero coefficients in matrix a  <cit> . furthermore the error in expression measurements of gene i does not affect the expression measurements of the other genes and off-diagonal elements in Σ can be set to  <dig> 

crucially, the coefficient matrix a = )1≤i, j≤p -- which is the adjacency matrix of the gene regulatory network  <cit>  -- and the column vector b = )1≤i≤p -- which is the baseline gene expression that does not depend on the parent gene regulatory controls -- are allowed to vary explicitly with time. this could for example reflect switching on or off of regulatory interactions, e.g. in response to developmental, physiological or environmental signals .

for each gene, i, a set of time-points for which the regulatory inputs of the gene change is determined. these time-points are referred to as 'changepoints' and delimit homogeneous phases, i.e. sets of time-points for which the local network topology  remains unchanged. assuming k changepoints, the changepoints are denoted by ξi=, where ξ0i= <dig>  and ξk+1i=n+ <dig> . the distinct phases are labelled by the index of their respective right changepoints. for all times t in the phase h of gene i , the i-th row of matrix a and coefficient bi are assumed constant:

  ∀ξh−1i≤t<ξhi,bi=bhi,∀1≤j≤p, aij=ahij 

for phase h of gene i, the parents pahi of gene i include every gene j such that the coefficient ahij differs from 0: pahi={j;∀1≤j≤p, ahij≠0}. hence for ξh−1i≤t<ξhi the expression of gene i is modelled in a regression framework as:

  xi=∑j∈pahiahijxj+bhi+ei,with ei~n2), 

where xj is the expression level of gene j at time t -  <dig>  this defines a multiple changepoint regulatory network, with changepoint positions ξ=1≤i≤p, and the phase-specific regression model parameters, {ahij, bhi, σhi} for all h, i, j. all non-zero coefficients, ahij, indicate relationships between expression levels of genes i and j, and hence are good indicators of putative biological interactions between those genes.

model inference via reversible jump mcmc sampling
general principle
we want to infer the autoregressive time-varying network model, which belongs to the overall parameter space that is the union of the parameter spaces of all phases delimited by k changepoints . furthermore, for each phase the number of incoming edges on each node  is unknown. adding or removing a changepoint results in a change in the dimension of the system's state-space: for each additional changepoint a new network topology has to be estimated, and for each deleted changepoint the results previously obtained for the two distinct phases have to be reconciled. thus, the dimension of the model is unknown and can vary substantially. in order to infer the posterior distribution pr given the observed data x over all of the system's parameters, we used a reversible jump markov chain monte carlo  procedure. the principle of rj-mcmc lies in constructing a reversible markov chain sampler that can jump between parameter subspaces of different dimensions; thus allowing the generation of an ergodic markov chain whose equilibrium distribution is the desired posterior distribution  <cit> .

presented in figure  <dig>  our inference procedure allows us to simultaneously consider all possible combinations of changepoints and network topologies within the different phases. in the rj-mcmc procedure, the likelihood of the expression measurements x observed at time-point t =  <dig> is denoted by pr). from the hierarchical structure of the overall parameter space, the joint probability distribution over all parameters can thus be written as the product:

  pr  =pr)∏i=1p{pr}. 

posterior distribution
for each gene, i, we construct a rj-mcmc sampler that directly samples from the joint distribution:

  pr=prkªpr                                                                                        ∏h=1ki+1prpr, 

where prk¯ pr and are respectively the prior probabilities of the number of changepoints ki and of the changepoint position vector ξi for gene i, and where pr is the prior probability of the parameters defining the regression model of the phase h of gene i. finally:

  pr=∏ξhi≤t<ξh+1ipr|ξh−1i, ξhi, shi, pahi, θhi, σhi) 

is the likelihood of the expression levels xhi=)ξhi≤t<ξh+1i of gene i observed during phase h, and is a realization of the gaussian distribution defined in equation.

priors
in order to reinforce sparsity of the network and following multiple changepoint approaches involving rj-mcmc  <cit> , we assume the number of changepoints ki to be distributed a priori as a truncated poisson random variable with mean λ and maximum k¯,

  ∀ki≤k¯, prk¯∝e−λλkiki!1{ki≤k¯}. 

similarly, the prior probability for the number of parents is a truncated poisson distribution prsª with mean Λ and maximum s¯. here λ and Λ can be interpreted as the expected number of changepoints and parent variables, respectively. following  <cit> , λ and Λ are drawn according to a gamma distribution: λ, Λ~ga where the shape parameter α and the scale parameter β are chosen so that the prior probability decreases when the numbers of changepoints or parents increase . conditional on there being ki changepoints, we assume that the changepoint positions vector ξi takes only non-overlapping and uniformly distributed integer values. the prior for the regression model parameters  are chosen following andrieu and doucet' rj-mcmc procedure for regression model selection  <cit> , based on a work proposed in  <cit> . the sets of parents pah are assumed to be uniformly distributed conditional on |pah| =shi. the variance, σhi, is assumed to be distributed according to a conjugate inverse-gamma prior distribution with shape parameter υ0/ <dig> and scale parameter γ0/ <dig>  2~ℐg. by choosing υ <dig> =  <dig> and γ <dig> =  <dig> , we set up to jeffrey's vague prior, pr2)∝1/ <dig> <cit> . finally, conditional on σhi, the prior distribution for the regression model parameters can be written as,

  pr=prsªprpr. 

given the parent gene set pahi of size shi, the shi+ <dig> regression coefficients, θpahi=j∈pahi), are assumed to be drawn from zero-mean gaussian distributions with covariance 2Σpahi,

  pr=|2π2Σpahi|−1/2exp, 

where the symbol † denotes matrix transposition, ∑pahi= δ−2dpahiˆdpahi and dpahi is a matrix of size mi×, whose first column is a vector of  <dig> when the regression model includes a constant, and each j + 1th column contains the observed  value ≤t<;1≤l≤m for all parent gene j in pahi. we did not use shrinkage priors here because the truncated poisson prior for the number shi of parents already favours dimension reduction. the term δ <dig> represents the expected signal-to-noise ratio and is sampled according to an inverse gamma distribution δ2~ℐg with αδ2= <dig> and βδ2= <dig> .

a noticeable advantage of the model is that the marginalization over the regression parameters  in the posterior distribution is analytically tractable,

  pr=∫∫prdθidσi 

. then the proposals are sampled from the analytical expression of the network topology posterior distribution  -- which is proportional to pr -- and the acceptance probability depends on the network topology  only.

moves
in order to traverse the parameter space of unknown dimension we propose here four different update moves : birth of a new changepoint ; death  of an existing changepoint ; shift of a changepoint to a different time-point ; and update of the regression model defining the network topology within the phases . these moves occur with probabilities bk for b, dk for d, vk for s and wk for r, depending only on the current number of changepoints ki and satisfying bk + dk + vk + wk =  <dig>  the changepoint birth and death moves represent changes from, respectively, ki to ki +  <dig> phases and ki to ki -  <dig> phases. we impose d <dig> = v <dig> =  <dig> and bk¯= <dig> to preserve the restriction on the number of changepoints. otherwise, these probabilities are chosen as follows:

  bk=cmin{ <dig>  prkªprkª}, dk+1=cmin{ <dig>  prkªprkª} 

where prk¯ is the prior distribution for the number of changepoints and the constant c is chosen to be smaller than  <dig> so that the regression model updates and changepoint position shifts are proposed more frequently than births and deaths of changepoints. this improves our ability to infer changepoint positions and the network structures  within the different phases. proposed shifts in changepoint positions are accepted using a standard metropolis-hastings step, while regression model updates within phases invoke a second rj-mcmc criterion, which was adapted from the model selection approach of andrieu and doucet  <cit> . as proposals are sampled from the analytical network topology posterior distribution , the generation of the regression model parameters  is optional. together the four moves b, d, s and r allow the generation of samples from probability distributions defined on unions of spaces of different dimensions for both the number, ki, of changepoints and the number shi of parents within each phase for gene i.

model selection
given a priori probabilities, the artiva algorithm produces posterior probability estimations over the algorithm iterations for changepoint vectors and network topologies. these posterior probabilities give a detailed picture of all the results and allow in depth analyses of the entire regulatory network architecture. in this study we use in complement to posterior probabilities, the bayes factor, i.e. the ratio of the posterior odds of an hypothesis over its prior odds  <cit> . the bayes factor has the advantage to consider the posterior distribution with respect to the priors and to obtain quantitative measurements of the statistical significance of the artiva results which are comparable between different datasets. as an indication, according to kass and raftery  <cit> , a proposition is  not supported when it has a bayes factor below  <dig>   positively supported for a bayes factor between  <dig> and  <dig> and  strongly supported for a bayes factor over  <dig>  the performance of artiva is evaluated on synthetic and real data  by selecting the network structure according to the following procedure. for each gene i we first choose the number ki of changepoints having the greatest bayes factor. then the ki changepoint positions having the highest bayes factors are selected, and for each resulting phase we finally compute the bayes factor for the possible parent genes and choose the ones with a bayes factor greater than  <dig> .

simulation study
in order to evaluate the accuracy of the artiva algorithm to recover changepoints and network topologies correctly, expression data for randomly defined dynamic networks were generated. with respect to the experimental datasets analyzed later , two types of expression data were produced. the first type -- referred to wild-type  simulations -- match the 'drosophila life cycle' data. this dataset contains time-series expression data of several genes and the algorithm must find the correlations between unknown parent genes and each target gene. the second type -- referred to as knock-out  simulations -- is equivalent to the 'benomyl' dataset. this dataset only contains time-series expression data of target genes in different genetic contexts: wild-type and knock-out mutants for several transcription factors .

the simulation procedure for a given target gene, also presented in detail in additional file  <dig>  involves three main steps. first, the structure of the dynamic regulatory network is defined. this consists of randomly setting the number and the localization of changepoints, thereby defining regulatory phases. then the parent genes and the corresponding coefficients are chosen for each phase. once the regulatory network is defined, expression data can be generated from this network model. the expression values of the parent genes are first generated randomly  and subsequently used to calculate the target gene expression according to the autoregressive model presented in eqn. . the whole procedure is repeated  and noise is added . because the simulations use the artiva hypothesis concerning the expression associations between parent and target gene expression profiles , we expect all the results to be correct under ideal conditions . therefore, this simulation protocol evaluates the artiva performance and studies the influence of the following parameters:

• the quantity of noise in the data. for all phases h of gene i, the noise ei is drawn from a gaussian distribution n2) with standard deviation σhi,

• the size of the temporal phases , and

• for wt simulations only, the number of potential parent genes . this is not necessary for ko simulations because the potential parent genes are obviously restricted to the transcription factors for which ko data is being generated. regardless of the number of potential parent genes, a maximum of  <dig> edges from parent genes to a target gene is allowed.

for each parameter value,  <dig> gene time-series of length =  <dig> timepoints were randomly generated with  <dig> and  <dig> replicates for wt and ko data respectively. note that ko simulations present less replicates because each replicate already comprises the measurements of the gene expression levels for each knock-out mutant. all other parameters were set to their default values and are specified in table  <dig>  the artiva algorithm was run on each expression data set and we compared the proposed network model  with the original one. the ability of the algorithm to recover changepoints was evaluated via the positive predictive value  and the sensitivity,

to evaluate artiva performances, two types of data were used: wt simulations corresponding to time-series expression data with no knowledge of potential transcription factors and ko simulations corresponding to several time-series expression data of a simulated wild-type strain and knock-out strains for each known transcription factor . the default values of the parameters used for the simulation study are: # of timepoints n = 12; # of changepoints k~u; maximal # of edges = 5; parent to target coefficient ~u; phase sizes ~u;# # of replicates r =  <dig> for wt simulations, r =  <dig> for ko simulations; noise standard deviation ~n; total # of simulations =  <dig> for each condition. in this table, the value of noise intensity, phase size and number of parent genes change according to the parameter under study . in each condition, the ability of artiva to detect all true phase changepoints and model edges  and to detect only true positives  was calculated. overall, this simulation study allows us to gain confidence in artiva results  for a given set of parameters .

  ppv=tp sensitivity =tp 

with tp = true positives, fp = false positives and fn = false negatives. the edges ppv and sensitivity was computed for the phases whose changepoints were correctly inferred.

microarray data
the first microarray dataset -- referred to as 'drosophila life cycle' data -- was produced by arbeitman et al.  <cit> . it includes the mrna expression levels of  <dig> genes at  <dig> successive time-points spanning the four stages of the d. melanogaster life cycle: the embryonic , larval  and pupal stage  and the first  <dig> days of adulthood . expression data were collected from the gene expression omnibus database: http://www.ncbi.nlm.nih.gov/geo/.  <dig> genes with consistent annotation are used for the analysis. potential parent genes were restricted to genes with known transcriptional activity based on gene ontology information  <cit> . hence,  <dig> genes were selected as potential parents. they belong to one of the four following gene ontology molecular functions: 'transcription activator activity' , 'transcription repressor activity' , 'transcription factor activity'  and 'transcription cofactor activity' . for each target gene, we gave priority to the  <dig> potential parent genes with the most highly correlated gene expression profiles over any successive  <dig> time-points.

the second microarray dataset -- referred to as 'benomyl' data -- was published by lucau-danila et al.  <cit> . in this study, the authors measured the changes in mrna concentrations for each gene at successive times after addition of benomyl  in the growth media of saccharomyces cerevisiae cells. parallel experiments were conducted in different genetic contexts: the wild type strain and knock-out  strains in which the genes coding for different transcription factors connected to drug response, yap <dig>  pdr <dig>  pdr <dig>  and yrr <dig>  were deleted. for each yeast strain, the measured expression values for  <dig> time-points  were obtained from the website: http://www.biologie.ens.fr/lgmgml/publication/benomyl. we only considered genes that  showed significant changes in mrna levels during the time-course analysis in the wt strain , and  had less than 20% of missing expression measurement data in the four ko strains. the resulting expression table comprised data for  <dig> genes . hierarchical clustering was performed applying the 'hclust' function available in the r programming langage http://cran.r-project.org/, using euclidean distance between gene expression profiles and the 'ward' method for gene agglomeration .

technical information
the artiva algorithm is implemented in r programming language. the source code is freely distributed to academic users upon request to the authors. a  <dig>  iterations procedure lasts around  <dig> min times the number of genes for the analysis of  <dig> time-course measurements  with a  <dig>  ghz intel xeon cpu and  <dig> g ram.

RESULTS
evaluation of the algorithm performances
to evaluate the performance of our artiva approach, simulations are run in order to assess the impact of three major factors on the algorithm performances: noise in the data, minimal length of phases, and number of proposed parent genes . sensitivity and positive predictive value  calculated for the detection of changepoints and of models, i.e. the topology of the network within the phases, are presented in table  <dig>  in wt simulations, the changepoint sensitivity is greater than 80% when the noise standard error reaches σi =  <dig>  as noise increases further, the ability of the algorithm to recover changepoints decreases in terms of sensitivity, but still, the changepoint sensitivity remains greater than 70% when the noise standard deviation reaches σi =  <dig>  . the wt data was generated with r =  <dig> repeated measurements for each time point, whereas the ko data were simulated with only  <dig> repeated measurements for each time point . that is the reason why the changepoint sensitivity with ko simulations starts to decrease with smaller noise standard deviation compared to wt simulations. nevertheless, the changepoint sensitivity is still greater than 80% even when noise reaches σi =  <dig> . the number of measurements for each phase also plays an important role for the changepoint detection sensitivity. indeed, during a phase reduced to a single timepoint, there are only r repeated measurements to estimate the autoregressive models. interestingly, the artiva algorithm here succeeds in finding the correct dynamic networks with a sensitivity value of 79% for a phase size of  <dig>  in both wt and ko simulations . with phases of size  <dig>  the changepoint sensitivity is greater than 90%. for all noise levels considered here the changepoint ppv is greater than 95%; furthermore changepoint ppv appears to be stable and not to be affected by the phase size either. knock-out data are usually collected for a restricted number of knock-out genes and the number of possible parents is limited. however, wild-type experiments give expression time series data for a large number of genes at once. the number of proposed parents increases the dimension of the model and the estimation procedure accuracy is expected to be affected as the dimension increases. here, the changepoint sensitivity obtained with artiva is still 54% when the parent genes are chosen from among a set of  <dig> proposed parents. the changepoint sensitivity goes up to 81% when the number of potential parents is reduced to  <dig>  the changepoint ppv is only slightly affected by the number of proposed parents. the ppv is still greater than 75% when the number of potential parents is  <dig> 

the edge detection in table  <dig> was evaluated when the correct changepoint segmentation was recovered. once the correct changepoints are recovered, neither noise nor short phases appear to strongly affect the detection of edges. the edge sensitivity deteriorates for extreme situations only. indeed, the edge sensitivity is equal to 18% when phase size is  <dig> for ko simulations. for wt simulations, the edge sensitivity is about 50% when phase size is  <dig> or when the number of proposed parents is  <dig>  in all other cases, the edge sensitivity is greater than 75% and the edge ppv is greater than 95%.

simulation studies such as the one performed here do, of course, only provide a partial insights into an algorithms performance and robustness. they are nevertheless essential to gain confidence in the performance of novel algorithms and to develop understanding of their likely limitations. together these results serve to illustrate of the robustness of the artiva algorithm. in particular, artiva can deal with some of generic problems encountered in real experimental data. it still performs well when noise standard error is on the order of the mean value of the regression coefficients, when the number of measurement per phase is reduced to  <dig> or when the number of possible parents reaches  <dig>  at some point, the artiva algorithm misses some changepoints, but the ppv is still very large, meaning that we can have great confidence in the changepoints having a high posterior probability.

temporal variation of the drosophila development transcriptional program
in light of the simulation analysis, we then apply our method to the well-studied expression datasets produced by arbeitman et al.  <cit> . in this study, the authors report gene expression patterns for nearly one-third of all d. melanogaster genes during a complete time-course of development. the artiva algorithm is run for each gene for  <dig>  iterations, looking for parental relationships with the  <dig> transcription factors for which gene expression profiles were most highly correlated over any successive  <dig> time-points . out of the  <dig> analyzed genes,  <dig>  were found to be involved in the time-varying networks spanning the whole drosophila life-cycle . interestingly,  <dig> changepoints were also identified. the distribution over the time-points and with respect to the developmental stages is shown figure  <dig>  we observe that time intervals { <dig> to 19}, { <dig> to 33}, { <dig> to 43} and { <dig> to 61} contain more than 40% of the changepoints. notably the intervals { <dig> to 33}, { <dig> to 43} and { <dig> to 61} include the developmental stage transitions from embryo to larva, from larva to pupa and from pupa to adult, respectively. the high number of changepoints at mid-embryogenesis  corresponds to a major morphological change related to a modification of transcriptional regulations, as described in  <cit> .

to further evaluate artiva, we compared our results with those obtained using the tesla algorithm  <cit> . tesla has been recently published  and to our knowledge it is with artiva, the only other procedure which recovers time varying regulatory networks where the changepoints are gene specific. as described in  <cit> , we first discretized the expression measurements into two levels:  <dig> for up-regulation and  <dig> for down-regulation. the tesla procedure requires specification of two parameters, λ <dig>  which is a sparsity coefficient, and λ <dig>  which is a smoothness penalty coefficient. several combinations of  parameters were tested , and we finally retained the average values presented by the authors in their simulation study  <cit> , i.e. λ <dig> =  <dig> , λ <dig> =  <dig>  the tesla analysis was run using the same subset of drosophila genes used with artiva, and the  <dig> most significant temporal changes identified with tesla are compared to the  <dig> artiva changepoints . in agreement with the artiva results, an important number of regulatory changes  occurred during the developmental stage transitions , but notably this number is significantly lower than the one obtained with artiva . this is especially remarkable considering the last phase transition from pupa to adult. the observation of a significant number of changepoints at developmental stage transitions lends credibility and supports our artiva results. our method appears powerful in inferring the timepoints at which transcriptional control of individual genes switches.

time-varying regulatory network involved in the response of saccharomyces cerevisiae to benomyl poisoning
in our second example, we apply artiva to a selected set of  <dig> gene expression profiles from saccharomyces cerevisiae cells grown under benomyl-induced stress conditions  <cit>  . a hierarchical cluster analysis identifies  <dig> clusters of genes with concordant transcription profiles . for each cluster, time varying networks are inferred using the included gene expressions measured in the wild type and four deletion strains , running the rj-mcmc scheme for  <dig>  iterations. regulatory associations between parent and target genes are proposed if the deletion of a parent gene significantly alters the expression measurements of its target genes  . the results are presented in figure  <dig> and dataset s <dig>  as an illustration, the cluster # <dig> comprises  <dig> genes  for which two changepoints are detected at the  <dig> and  <dig> minute time-points , when these genes fall under the regulatory control of yap <dig> . even if yap <dig> is the only transcription factor identified here, its regulatory interactions with the target genes in the third phase are highly significant  compared to those in the second phase . this explains the detection of two changepoints. the results obtained for all other clusters are combined to obtain a global view of the time-varying regulatory network involved in benomyl stress response . in agreement with the pioneering study of lucau-danila et al.  <cit> , the transcription factor yap <dig> appears to have the predominant role in the benomyl stress response as artiva identified edges with 79% of the analyzed genes . also pdr <dig>  being the parent gene of 24% of the genes, exerts significant control . pdr <dig> and yrr <dig> present only a small number of target genes .

furthermore, our artiva model provides a dynamic classification of the benomyl responsive-genes, based on their time of induction. such a dynamical point of view can elucidate the chronology of events, especially regarding the yap <dig> activity. artiva identified three classes of yap <dig> targets, depending on their time of induction:  <dig> minutes ;  <dig> minutes ; and  <dig> minutes . almost all the genes included in the earliest group are known to be transcriptionally controlled by yap <dig> . they encode proteins involved in redox control  or vacuolar transporters . the middle group contains also an important rate of yap <dig> targets , which act at the level of the plasma membrane  or encode proteins involved in response to toxins . yap <dig> activity in the last group is partially overlapping with the actions of pdr <dig> and pdr <dig>  most of the genes in this group have unknown functions, but some of them are still labelled in the yeastract database as being targets for yap <dig> , pdr <dig>  and pdr <dig> . finally, yrr <dig> deserves a special mention. unlike the genes that encode the transcription factors yap <dig>  pdr <dig> and pdr <dig>  the yrr <dig> gene is transcriptionnally activated during the benomyl response. as a consequence, artiva identified yrr <dig>  as a yap <dig> target whose expression was induced  <dig> minutes after benomyl addition in the cell growth culture ; and  as a parent for genes sng <dig> and yll056c at  <dig> minutes. interestingly these observations highlight a sequential activity of yap <dig> and yrr <dig> transcription factors together with an overlap of their targets . this regulatory model, in which yrr <dig> seconds yap <dig>  is fully supported by recent experimental data  <cit> .

discussion
artiva: a new statistical modelling framework to learn temporally varying gene-regulation networks
the artiva approach allows us to reverse engineer the temporally varying structure of transcriptional networks by inferring simultaneously the times at which regulatory inputs of genes change and the nature of these incoming inputs. our approach is computationally efficient and can exploit powerful search heuristics to scan the space of potential incoming edges. compared to others methodologies recently proposed in the literature, artiva has the major advantage of combining efficient and well-tried techniques  in order to solve several related problems. first, with artiva there is no need for prior information regarding either the number of regulatory phases or the number of regulatory interactions between parent and target genes. starting from uninformative priors , the posterior distribution for the number of changepoints, their positions and the regulatory models within each recovered phase is directly obtained from the artiva runs. also, artiva allows the detection of regulatory phases for individual genes. finally, whereas many approaches -- like bayesian dirichlet equivalent  score in a dynamic context  <cit>  or the tesla framework  <cit> -- require the expression measurements to be discretized, the artiva procedure has the advantage to work directly with continuous datasets. thus there is no need to set arbitrary thresholds to define up- and down-regulated groups of genes.

we demonstrate the performance of the artiva algorithm by  applying it to simulated data  and  performing a comparative analysis of the artiva and tesla  <cit>  results . because the simulations were such that they mirror the biological data analyzed afterwards as much as possible, we gain considerable confidence in the output of the artiva approach when used on the two datasets considered here. overall, the algorithm shows very good performance in retrieving the simulated dynamic networks, except in extremely unfavourable conditions, such as too much noise in the data or time series that are not sufficiently long and dense. these exploratory studies allow us to interpret the artiva outputs more reliably.

new biological insights into the drosophila development and the yeast stress response
the two biological networks presented in this study  are very different, both from a biological and a technical point of view. their respective analyses represent different challenges for the application of the artiva algorithm. the 'drosophila life cycle' data is representative of data used for classical regulatory network inference; successive gene expression measurements spanning a given biological process - here the drosophila development - in order to detect potential regulatory interactions from gene expression profiles. this data is particularly suited for the inference of a temporally varying regulation network, since  the number of time-points is large  and  the transitions between the distinct stages of drosophila development {embryo , larva , pupa , adult } are well-described in the literature  <cit> . we can thus reasonably expect to identify changepoints precisely at transitions between life stages . on the other hand, discrimination between parent and target genes represents an important additional step towards a complete description of the genetic networks that control development. these inferred temporal changes can form hypotheses as to how we can interfere rationally with developmental processes; e.g. arresting development in a given state by selectively knocking down transcription factors or targets at a given developmental stage.

the 'benomyl' dataset represents a particular challenge for artiva to retrieve a dynamic regulatory network for two reasons. first, the number of time-points is extremely small , and no replicate data points are available. to manage the lack of data, we cluster genes with concordant transcription profiles and analyze them jointly with artiva. this cluster analysis was possible because the maximal intracluster variability did not exceed  <dig>  , a value that artiva is able to manage based on our simulation results . second, in this s. cerevisiae dataset, it is known that the genes coding for key regulators of the stress response system, i.e. transcription factors yap <dig>  pdr <dig> and pdr <dig>  exhibit flat expression patterns during stress condition ; this prevents the use of correlation measures with their expression profiles to identify causal relationships with their potential target genes. in this context, we needed to adapt the artiva inference procedure in order to integrate gene expression profiles measured in the wild type and ko strains. regulatory associations between parent and target genes are thus proposed if the deletion of a parent gene significantly alters the expression measurements of its target genes . compared to the previous study of lucau-danila et al.  <cit> , the main benefit of artiva analyses is that it provides a dynamic classification of the benomyl response genes . it also points out contributions of the yrr <dig> and pdr <dig> transcription factors, which were ignored in previous analyses. interestingly, the versatile and non exclusive joint action of pdr <dig> and pdr <dig> in chemical stress response, together with the overlap with yap <dig> activity, is supported by recent experimental data available on these two factors  <cit> .

CONCLUSIONS
the comprehensive analysis suggests that the artiva approach allows us to describe and reverse-engineer the dynamic aspects of molecular networks. such time-varying networks provide a middle ground between networks homogeneous in time and explicit dynamical models. the latter require substantial further information in order to model the dynamics of biological systems  <cit> . inferring such systems is a considerable statistical challenge and it has recently been shown that some parameters cannot be inferred with any degree of certainty from time-course data. this so-called sloppy behaviour  <cit>  has been identified even in very simple dynamical systems. in contrast to classical network reverse engineering approaches such as dynamic bayesian networks  <cit>  and graphical gaussian models  <cit> , artiva also allows us to construct more complex hypotheses where interactions may depend on time.

as no particular constraint is imposed to the changepoint positions or to the succession in network topologies within phases, the artiva model appears to be highly flexible. the results are not a priori directed toward any particular regulatory associations between genes. this flexibility can be extremely valuable, especially when no information regarding the studied biological process is available. but the rapid accumulation of data obtained with different experimental approaches gives the opportunity to acquire a more comprehensive picture of all the interactions between cellular components. to understand the biology of the studied systems better, the trend is clearly towards the aggregation of multiple sources of information. a natural future direction in the development of artiva will be to incorporate data originating from different sources in the model. in particular, protein/dna interaction data  could be effective by replacing the uniform prior for the edges with a prior favouring edges that correspond to the experimentally identified interactions . also, artiva assumes independent network topologies within successive phases and can identify very different regulatory associations between two phases, even if the time delay between the phases is very short. this assumption was appropriate in case of biological models like the drosophila development and the yeast stress response, mainly because those are processes in which transcriptional regulations are highly dynamic. however, when considering systems that evolve more smoothly or in case of datasets with a small number of time points, it would be interesting to incorporate a regularization scheme into artiva in order to favour slight changes from one phase to the next one. such an approach has already been initiated in  <cit>  for discretized data and in  <cit>  where the regularization scheme is based on a common network structure. there are still huge gaps in our knowledge of biological networks and of the dynamics they mediate. what triggers whether or not an interaction is present depends subtly on the cellular context, the complement of molecules inside a cell  and their respective molecular interactions. understanding all of these factors and their interplay will ultimately be crucial in order to design biological interventions rationally. but statistically inferring them poses a set of formidable challenges. the use of relatively simple mathematical models  allows us to distil the essential dynamics of complex temporal processes in biological systems. thus artiva provides a platform for the analysis of transcriptomic data, which could be straightforwardly expanded to include other data, e.g. transcription factor activities or other proteomic measurements.

authors' contributions
sl conceived, implemented the first version of artiva algorithm and drafted the manuscript. jb optimized the artiva source code and performed simulations. fd provided help with data analysis. mphs and gl contributed equally to this work. mphs provided help with the model selection formalism and drafted the manuscript. gl designed the experiments, performed data analysis and drafted the manuscript. all the authors read and approved the final manuscript.

supplementary material
additional file 1
supplementary text s <dig> - priors illustration and complete mathematical description of the rjmcmc procedure and of the bayes factor computation.

click here for file

 additional file 2
supplementary figure s <dig> - principle of the simulation study.

click here for file

 additional file 3
supplementary dataset s <dig> - full edge list of the inferred time varying networks of the 'benomyl' data.

click here for file

 additional file 4
supplementary text s <dig> - supplementary results related to the 'benomyl' analyses.

click here for file

 additional file 5
supplementary figure s <dig> - expression measurements for the  <dig> clusters used in the 'benomyl' analyses.

click here for file

 acknowledgements
we thank liam kelly and tina toni for helpful comments on this manuscript, catherine etchebest for helpful discussions and the anonymous reviewers for their constructive advices. sl and mphs gratefully acknowledge support from the bbsrc. jb and gl gratefully acknowledge support from the institut national de la transfusion sanguine. mphs is a royal society wolfson research merit award holder.
