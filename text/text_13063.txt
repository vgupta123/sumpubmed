BACKGROUND
codon bias, the preferential use of subset of synonymous codons, has been documented in a wide variety of organisms, from prokaryotes, to unicellular and multicellular eukaryotes  <cit> . while codon bias appears to be almost universal, the magnitude of codon bias largely depends on the effective population size, with codon bias being higher in species with larger effective population sizes  <cit> . evolution of synonymous codon usage is a process where natural selection is sufficiently weak  that the outcome is influenced by both selection, mutation and genetic drift  <cit> . at the same time, synonymous changes within and between species are sufficiently common that abundant data is available for testing evolutionary hypotheses of synonymous codon usage, explaining why much attention has been directed to understanding the relative contributions of mutation, genetic drift and natural selection to the patterns of codon bias seen within and between species.

the most common model of synonymous codon usage, the "major codon preference model", assumes that one or a few synonymous codons are preferentially used in genes with high codon bias  <cit> . such codons are usually termed "preferred codons" and often end in either c of g. in most cases preferred codons correspond to the most abundant trnas from each codon family and codon bias is therefore thought to have arisen in response to natural selection favoring transcriptional accuracy or efficiency  <cit> . under the assumption of a balance between weak selection and genetic drift, the expected proportion of sites fixed for the preferred codon is

  e=11+e−4ns 

where μ and ν are the mutation rates from and to preferred codons, respectively, and 4n s is the scaled selection coefficient acting on preferred codons  <cit> . equation  suggest that changes in evolutionary parameters, such as population size or mutation rate, can have large effects on the evolution of synonymous codon usage even in closely related species. while major shifts in codon preferences are unlikely between closely related species, changes in evolutionary parameters, particular in effective population sizes, are relatively common even over short evolutionary time scales  <cit> . population size changes are expected to affect codon usage across all synonymous codon families and results in enhanced codon bias following a population size increase and an erosion of codon bias after a population size decline  <cit> . for instance, several studies have documented reductions in codon bias in drosophila melanogaster and an increased fixation rate of unpreferred codons compared to the closely related species d. simulans and this has been attributed to a reduction in the effective population size of d. melanogaster and a relaxation of selection on codon bias  <cit> . reductions in codon bias, likely driven by reductions in effective population sizes, have also been documented in d. miranda  <cit>  and several species from the d. virils group  <cit> . mating system is another potential factor affecting effective population sizes. for instance, self-fertilization is associated with a reduction in the effective population size  <cit>  and caenorhabditis species which have experienced a transition from obligately outcrossing to selfing show a concomitant decrease in codon bias  <cit> .

i have recently shown that patterns of synonymous codon usage in the long-lived tree populus tremula is consistent with weak natural selection acting on translational efficiency as evidenced by a strong positive correlation between gene expression and codon bias  <cit> . in this paper i extend my earlier studies of codon bias in p. tremula to five species covering most of the phylogenetic diversity found within the genus populus. using a greatly expanded set of genes and species allows for more thorough studies of the molecular evolution of synonymous codon usage across lineages with the hope of answering questions pertaining to the stability of evolutionary parameters, such as mutation rates, population sizes and patterns of natural selection.

RESULTS
identification of optimal codons
optimal codons were identified for all five species based on differences in relative synonymous codon usage  between genes with high and low levels of gene expression . using this approach i identified  <dig> codons showing significant Δrscu values between low and high expression genes in four or more species. an additional four codons showed Δrscu values that were significant in three or few species. some of the codons that do not show significant differences between high and low expression genes in all species nevertheless have positive Δrscu values in all species . these are likely optimal codons  but where power might be too low to achieve statistical significance in one or a few species. on the other hand, some codons show reversal of Δrscu between high and low expression genes across species . whether these codons truly represent differences in codon preferences between species or simply represent statistical artifacts is not clear. based on the results from the Δrscu analysis, i identified  <dig> codons from  <dig> different amino acids that were used to calculate the frequency of optimal codon usage in all genes of the different species . most, but not all, of these codons end with either a c or a g, as have been observed in many other species  <cit> .

in a recent study i estimated optimal codons in p. tremula based on correspondence analysis of codon usage in  <dig> different genes using the program codonw  <cit> . the results presented here are both based on more species  and substantially more genes from each species . nevertheless there is a large degree of overlap between optimal codons i identified in p. tremula  <cit>  and those identified in this study. in fact, the  <dig> codons identified as optimal in p. tremula  <cit>  represents a subset of the  <dig> codons identified in this study. the greater number of optimal codons identified here is likely the result of a greater power to identify subtle differences in codon usage between high and low expression genes due to the substantially larger data set used in this study.

factors explaining variation in synonymous codon usage
there is a significant positive correlation between gene expression, measured as the number of hits from the est data, and codon bias, measured as the frequency of optimal codon usage . these correlations are independent of base composition and sequence lengths and are consistent with natural selection on translational accuracy and/or efficiency having shaped codon usage. there are large differences among species in the amount of variation in codon usage explained by gene expression, ranging from  <dig> % in p. trichocarpa to  <dig> % in p. deltoides . the base composition of sequences also explain a sizable fraction of the variation in codon usage, ranging from  <dig> % in p. deltoides to  <dig> % in p. euphratica. interestingly, gene length appears to have little effect on codon usage and so do interactions between gene expression, base composition and gene length . these results differ to some degree from those i obtained in my earlier study of codon usage in p. tremula  <cit> . the main difference is that base composition explain a large fraction of the variation in codon usage in the current data set whereas the effect of gene length is weak and non-significant. the main conclusion remains the same, however, namely that codon usage in all species is, to a large degree, shaped by translational selection. as an overall index of codon usage bias i calculated the average of all positive Δrscu values   <cit> . there is a strong correspondence between Δrscu+¯ values and the strength of the association between gene expression and codon usage across species .

see text for further detail.

phylogeny of the five species
putative one-to-one orthologous genes were identified from the five different species using the program orthomcl  <cit> . this search identified a total of  <dig> orthologous groups that had all five species represented. the average length of the aligned regions was  <dig> bp and the concatenated data set contained a total of  <dig> bps of coding sequences per species. the concatenated data set was used to estimate the phylogeny of the five species and the phylogenetic tree obtained is depicted in figure  <dig>  the support for the tree topology in figure  <dig> is strong, with 100% bootstrap support for all branches when using the concatenated data. this tree is also consistent across different substitution models and tree inference methods , all of which yielded the same tree . the tree in figure  <dig> is also consistent with earlier phylogenetic studies of the genus populus and the salicaceae family using both morphological data  <cit>  or cpdna and its data  <cit> . however, because of the low sequence divergence among the species and the stochastic nature of the coalescent, there are possibilities that trees estimated for individual genes are not congruent. to test this, i estimated the likelihood for a number of variants on the trees depicted in figure  <dig> for each of the  <dig> genes separately. the tree in figure  <dig> was found to be the most likely tree for approximately 57% of the genes, but several other trees were recovered for between  <dig> and 15% of the genes. similar results were recently obtained for a number of species of drosophila, where trees showing incongruent phylogenies were found to be clustered across the genome, leading pollard et al.  <cit>  to suggest incomplete lineage sorting as the likely cause for these observations. it is not known to what degree the genes having incongruent trees are clustered in the genome, but the results suggest that incomplete lineage sorting could be quite common in populus. this is not surprising, since the radiation of the genus populus appear to be relatively recent, within the last  <dig> myr  <cit> . since the generation time in populus is quite long , the time since the radiation of the genus, in generations, is rather low.

substitution rates at synonymous and non-synonymous sites
initially i tested for rate heterogeneity among lineages using only synonymous sites by contrasting a model assuming a single molecular clock for the entire phylogeny with a model assuming no clock. these analyses show overwhelming support for a model without a clock, , suggesting that the molecular clock hypothesis of a constant substitution rate across the genus populus can be rejected. i then used relative rate tests  <cit>  to compare substitution rates as synonymous sites between pairs of lineages. these tests show significant rate heterogeneities between p. deltoides and p. trichocarpa  and between the p. nigra and the p. tremula-p. euphratica lineages . to test for lineage specific effects on synonymous and non-synonymous substitution rates i contrasted a model with a single dn/ds ratio  with a model allowing for different dn/ds values across branches of the phylogenetic tree . in general, the log-likelihood values were greater for the free-ratio model than for the one-ratio model and in six of the  <dig> genes this difference is statistically significant at p <  <dig> , suggesting significant heterogeneity in selective constraint at these genes. however, none of the genes remain significant after multiple test correction is applied. there was, however, evidence for significant heterogeneity in selective constraint in the concatenated data set . the median dn/ds ratio was lowest in p. trichocarpa  and highest in p. nigra  . the internal branches leading to the p. tremula-p. euphratica lineages and the p. tremula-p. euphratica-p. nigra lineages have substantially greater dn/ds ratios . however, these branches are very short and dn/ds ratios are subject to a large degree of uncertainty. nevertheless, all dn/ds ratios are substantially lower than one, suggesting strong purifying selection across all genes.

i also used likelihood ratio tests to test for the presence of heterogeneous selection pressures among sites within individual genes. the null model , assumes a single dn/ds ratio across sites which is calculated from the data. this model is contrasted with two alternative models; m1a  <cit> , which assumes two classes of sites, one class which is neutral dn/ds =  <dig> and one class where  <dig> <dn/ds <  <dig>  and model m2a that in addition to the two classes defined for model m1a allows for a third class of sites with dn/ds >  <dig>  <cit> . a total of  <dig> genes show evidence for heterogeneous selection pressures across codons as evidenced by likelihood ratio tests that were significant at a nominal p-value of  <dig> . again none of these tests are significant after multiple test correction. however, this test is known to have low power to detect the action of positive selection when few, relatively closely related sequences are compared in each test, so the results should be interpreted with caution  <cit> . the concatenated data set provides a more robust test of heterogeneous selection pressures across sites. here model m1a provides a substantially greater fit to the data, compared to model m <dig> . furthermore, model m2a is significantly better than model m1a , conclusively demonstrating that there is heterogeneity in selection pressures among sites. under model m2a, the majority of sites  are under strong purifying selection  and another large class of sites are evolving neutrally . finally, a small fraction of sites  appear to be evolving under the action of relatively strong positive selection . these sites appear to occur randomly across the genes, with no apparent clustering.

changes in codon usage
ancestral and derived codons were identified across a total of  <dig> codons from  <dig> genes using maximum likelihood methods. a total of  <dig> synonymous and  <dig> non-synonymous changes were recorded across all lineages . the low levels of sequence divergence ensured that ancestral codons could be identified with high degree of certainty and in all cases did the most likely ancestral codon have a probability that exceeded 95%. the estimated number of synonymous and non-synonymous changes in each lineage of the phylogeny are summarized in table  <dig>  following akashi et al.  <cit> , synonymous substitutions were further classified into changes that occurred from preferred to unpreferred codons  or from unpreferred to preferred codons  and deviations from equilibrium codon usage was scored as dup-pu = /  <cit> . preferred and unpreferred codons were taken from the Δrscu analysis described above.

a heterogeneity of p → u and u → p mutations in each lineage

b heterogeneity of s → w and w → s mutations in each lineage

u → p mutations shows as slight, but significant excess across the entire phylogeny, suggesting that codon usage has not reached an equilibrium in populus. the excess of u → p mutations can, however, largely be explained by the excess of u → p substitutions in the p. tremula and the p. deltoides lineages . both of these lineages do show a consistent excess of u → p mutations across loci . the remaining lineages appear to have reached a stationary distribution of codon usage and show no significant deviation from an equal number of p → u and u → p mutations. taken together, the changes observed in the p. tremula and p. deltoides lineages suggest that selection on synonymous codon usage codon bias has increased in these two lineages. the degree of codon bias, measured using fop, is higher in p. tremula that in both the most closely related species  or in the inferred ancestor, consistent with the observed increase in selection on codon usage. although these differences are small  they are consistent and highly significant across loci . comparisons of fop for p. deltoides with either p. trichocarpa or their most recent common ancestor are not significant however.

there is also a significant negative correlation between dup-pu and fop across loci over the entire phylogeny , as would be expected if selection is shaping synonymous codon usage  <cit> . i did not detect any correlations between ds and codon bias within any of the lineages. although codon bias is expected to be negatively correlated to ds when selection on codon bias is strong, theory shows that weak selection  actually has little effect on synonymous substitution rates  <cit> .

estimating selection on synonymous codons
the full model of nielsen et al.  <cit>  allows for estimation of independent mutation rates, dn/ds ratios and selection coefficients at synonymous sites in all lineages . with  <dig> species there are  <dig> ×  <dig> -  <dig> =  <dig> branches to estimate these parameters for. the full model outperforms both models assuming strand symmetry, i.e. where mutation rates from nucleotide i to j is equal the mutation rates from j to i or models assuming the same mutation rate matrix in all lineages . i calculated the expected equilibrium gc content  from the stationary distribution of nucleotide frequencies obtained from the first normalized eigenvector of the mutation matrix estimated from the data. in all species, except p. trichocarpa, the predicted πgc is substantially larger than the observed values . for p. trichocarpa the predicted πgc =  <dig> % vs. observed πgc =  <dig> %. however, small lineage-specific differences in the estimated mutation rates can translate in to substantial differences in the expected πgc for these lineages, so these differences should be interpreted with caution. when the complete data set is used to estimate a single mutation matrix the expected πgc is substantially closer to the observed values .

acomparison with the full model

the concatenated data, including data from all  <dig> genes, show significant evidence for weak, but positive selection on synonymous sites only in the p. tremula lineage, with the estimated 4nes =  <dig>  . the selection coefficient in p. deltoides is also marginally significant , but with selection only about half as strong as in p. tremula .

the gene-specific analyses identify a total of  <dig> genes that show significant evidence for selection on synonymous codon usage in p. tremula at a false discovery rate  <cit>  of 5%. for genes with evidence for significant selection in p. tremula,  <dig> have estimates of s >  <dig> and  <dig> have s <  <dig>  this suggests that although selection on synonymous codon usage favors preferred codons in the majority of cases, there are genes for which there is active selection against preferred codons. this mirror results from drosophila, where the majority of genes show evidence for selection favoring preferred codons but where a few genes show significantly negative estimates of 4nes  <cit> .

changes in base composition across lineages
although the changes in codon usage observed in the p. tremula lineage are consistent with an increase in the strength of natural selection acting on codon usage, an alternative explanation is a change in base composition driven by changes in mutational biases. one way to test this assumption is to compare mutational changes from a/t to g/c and vice versa across the phylogeny and in the individual lineages. since preferred synonymous codons predominantly end with g/c , synonymous sites cannot be used for such comparisons as it would be difficult to disentangle mutational biases from natural selection on codon usage. ideally, non-coding regions in the vicinity of each gene could be used for such a comparison, since this would account for chromosome-wide differences in base composition. however, since the sequences used for the current analyses are derived from est projects, non-coding sequences are not available. i have therefore used non-synonymous mutations to infer mutational changes in different lineages.

following akashi et al.  <cit> , i classified mutations as s → w  or w → s  across lineages and deviations from equilibrium base composition were quantified as dws-sw = /. the data show that there are no significant departures from an equilibrium base composition, either across the entire phylogeny or within any of the individual lineages . there is also no correlation between dup-pu and dws-sw across loci  or between dws-sw and fop .

discussion
selection on synonymous codon usage appears to be common among higher eukaryotes  <cit>  but the efficacy of such selection is usually thought to be lower in species with lower effective population sizes  <cit> . nevertheless, even long-lived species like populus show ample evidence for selection having shaped synonymous codon usage.

optimal codons appear to be largely the same across the five species used in this analysis, and most of the differences between species can be explained by codons with low Δrscu values, where the statistical power to detect changes in codon usage between low and high expression genes may be low. also, the Δrscu analyses are based on publicly available est-collections and the sets of genes used for the different species are likely very different thereby contributing to the slightly different sets of optimal codons identified in the different species . the codons identified as optimal in this study also correspond well with optimal codons identified in an earlier study of codon bias in p. tremula where optimal codons were identified using substantially less data and slightly different methods  <cit> . the  <dig> codons identified as optimal in p. tremula  <cit>  actually form a subset of  <dig> optimal codons identified in the Δrscu analyses. the estimates of Δrscu+¯ for the different species, which provides rough estimates of the overall strength of selection for preferred codons in the different species, is similar to what has been previously observed in arabidopsis, but is lower than observations from either drosophila or caenorhabditis  <cit> . i have used est data as a proxy for gene expression in this study and this is known to be associated with a lot of problems, like relatively shallow and biased library coverage  <cit> . however studies that have estimated codon bias parameters using expression profiles from either est data or other methods, such as mpss or microarrays, have yielded similar results despite the uncertainties associated with the est data  <cit> . codon usage bias can in principle be driven by natural selection or by mutational pressure and/or gene conversion  <cit> . although both of these forces are likely operating, there are unequivocal signs of natural selection having shaped codon usage biases in populus. there are strong positive correlations between gene expression and the degree of codon bias across individual genes in all five species . the gene expression-codon bias correlations are independent of base composition differences , indicating that natural selection, operating through translational efficiency or accuracy, has been a significant force shaping synonymous codon usage in populus. the lack of association between ds and codon bias suggest that selection on synonymous codon usage is strong enough to influence rates of synonymous divergence among species. a significant correlation with ds is only expected when natural selection on codon usage is strong. when selection on codon bias is weak, theory shows that it has only small effects on the rate of synonymous substitutions even if the effects on codon usage can be significant  <cit> .

interestingly, gene length appears to have virtually no effect on codon bias, except in p. trichocarpa . earlier studies in p. tremula have suggested a weak, but significantly negative effect of gene length on codon bias  <cit>  and negative correlations have been found in other eukaryotes as well  <cit> . several reasons can explain the lack of a correlation between gene length and codon bias in the present study. first, there might be genuine differences between species in the effect of gene length. cutter et al.  <cit>  found that for some species of caenorhabitis gene length had a significant effect on codon bias whereas for other species no such effect were found, suggesting that the effects of gene length might differ even between closely related species. alternatively, different sets of genes were used for the different species and it is conceivable that this could explain why an effect of gene length is lacking in some species. however, the number of genes used is quite large for all species , so if gene length has an effect the sample sizes are likely large enough that it would be detected. finally, gene lengths were taken from the annotated genome of p. trichocarpa but were assumed to be representative of the corresponding gene from the remaining species. it is possible, although perhaps unlikely, that gene lengths differ substantially between species. nevertheless, the effects of gene length on codon bias clearly deserves further attention.

at first impression, codon usage does not appear to have reached an equilibrium in populus as there was an excess of u → p substitutions across the entire phylogeny . however, the excess of u → p substitutions could largely be explained by significant excesses in two different lineages, p. deltoides and p. tremula, with the remaining lineages showing no deviations from an equal numbers of p → u and u → p substitutions. in addition, the maximum-likelihood estimates of the selection coefficient acting on synonymous codons are positive in both of these lineages .

the 4ne estimate for p. tremula is significantly greater than zero whereas the estimate for p. deltoides is approaching significance . the estimate of selection in p. tremula  is only slightly lower than estimates of selection from drosophila simulans and d. yakuba  <cit> , two species for which there are abundant evidence for selection on synonymous codon usage  <cit> . in addition, p. tremula has also significantly higher fop than both the most closely related species  or their common ancestor, supporting an increase in the degree of codon bias as a result of ongoing selection for preferred codons in p. tremula.

for the remaining lineages of the phylogeny the maximum-likelihood estimates of 4nes are either close to zero or even negative, although none of these estimates are significantly different from zero . these results suggest that the strength of selection acting on codon usage has increased independently in two different lineages in the genus populus, with natural selection favoring preferred codons in p. tremula and p. deltoides. despite lacking evidence for selection on preferred codons, the remaining species show signs of past selection on codon usage as evidenced by the positive association between gene expression and codon bias discussed above. finally there is no evidence for changes in base composition across lineages , although these conclusions are based on changes at non-synonymous sites. there are significant differences in the gc content of coding regions and surrounding non-coding regions in p. tremula  <cit>  but also no apparent correlation between gc contents of coding and non-coding regions, suggesting that non-synonymous sites might provide an accurate picture of the patterns of mutations in coding regions in populus.

what accounts for the increase in the strength of selection acting on synonymous codons in p. tremula ? one thing that distinguish p. tremula from many other species of populus is its very wide distribution, ranging throughout eurasia, from western europe to eastern asia. therefore based only on the distribution range, p. tremula likely has a substantially greater effective population size than other species of populus, that in many cases have both geographically more restricted ranges and more fragmented distributions where they do occur  <cit> . it is interesting to note that p. deltoides also have a relatively wide distribution range  <cit> , suggesting that the ne could be relative large also in p. deltoides. sequence-based estimates of the effective population size of p. tremula suggest that ne is at least  <dig>  <cit> . this estimate of ne is heavily dependent on the genome-wide mutation rate in populus and this has not been characterized in great detail  <cit> . however, estimates of ne are lacking for other species of populus, and the conclusions regarding the relative population sizes of the different species are clearly tentative.

in other species, population size in known to have a large effect on the strength of selection acting on preferred codons. as mentioned above, the effective population size appears to have been reduced in d. melanogaster and this have resulted in reduced selection on synonymous codons at least when compared to the closely related species d. simulans  <cit> . a similar picture is emerging from data on synonymous codon usage in nematodes where species that have evolved self-fertilization and/or have a parasitic life-style have experienced a reduction in ne which translates into lower selection on codon bias  <cit> . these results suggest that changes in effective population size are perhaps the most important parameter explaining differences in codon bias between closely related species. interestingly, selection on codon usage does not differ dramatically between arabidopsis thaliana and a. lyrata, despite the the former bing highly selfing and the latter obligately out-crossing. this mirrors data on rates of protein evolution which also does not differ between the two species and which suggest that the effective population sizes are not dramatically between a. thaliana and a. lyrata  <cit> .

CONCLUSIONS
this study conclusively demonstrates that natural selection on synonymous codon usage is occurring also in a long-lived, perennial plant species like populus. data on synonymous codon usage suggest both ancient selection on synonymous codon usage in the genus populus and current selection in p. tremula. the data also show that there has been a shift in the strength of selection acting on preferred codons in the p. tremula lineage and possibly also in p. deltoides. the analyses of the present data make shifts in mutations rates among species unlikely, suggesting that increases in the effective population size in these lineages can explain the observed increase in selection on synonymous mutations.

