BACKGROUND
differentially expressed genes between two or more samples may be of interest to researchers for different reasons, for example, looking at causes of or treatments for diseases such as cancer. given appropriately processed data, the researcher needs a methodology for assessing the genes in order to separate out ones of interest, i.e. genes with "significantly" different levels of expression in different samples. widely used methods for single slide data include examining the ratio of expression levels for the gene in each of the two samples/channels , which was the quantity examined in one of the first statistical analyses for differential expression in cdna microarrays  <cit> . one of the earliest uses of this quantity for determining differential expression was the "rule of two", where if the gene's ratio of expression levels in the two channels/samples is greater than two or less than half, it is considered to be differentially expressed  <cit> .

methods for data with replicate slides include the standard t test, which requires adjustment for the multiple comparisons being made. modifications of this approach to account for multiple comparisons include the approach of dudoit, yang, callow and speed  <cit> , which used a permutation analysis on welsh's t-statistics, and the significance analysis of microarrays  method, which modifies the t-statistic by adding a constant to the denominator  <cit> . a good summary of multiple testing adjustments is given by  <cit> .

the idea of modeling the data as two groups of genes, one differentially expressed and one not, seems to be a natural and intuitive approach. this approach has been used in the context of a bayesian analysis  <cit> , ebarrays, assuming that the observed ratios had a gamma distribution the reciprocal of whose scale parameter itself had a gamma distribution, or, as an alternative assumption, that the observed log ratios were normally distributed and the prior for the mean was normal also. a two-component mixture model was used to model the two groups and the posterior probability was used to make inference about differential expression. this follows from work done for single slide data with a gamma-gamma hierarchical model  <cit> . another approach using mixture models is given by pan, lin and le  <cit> .

this paper presents a very simple methodology based on mixture models called normal uniform differential gene expression  detection. it is applicable to both single slide and replicated cdna microarray datasets, produced by two of the more widely used experimental setups. after standardizing, the log ratio  observations are modeled with a two-component mixture model; a normal component for those genes that are not differentially expressed and a uniform component for those that are. the mixture gives posterior probabilities of differential expression which do not need to be adjusted for multiple testing. this methodology is applied to three different experiments. the experiments include single replicate data , multiple replicate data , experiments with different samples being labeled with their own dyes  and experiments with all samples being labeled with one dye and compared to a reference sample . the results given by nudge are compared with those given by some other methodologies for these types of cdna microarray experiments . an r package called nudge to implement the methods in this paper will be made available soon at  <cit> 

RESULTS
hiv dataset
the hiv dataset that we analyze consists of four replicate experiments comparing cdna from cd4+ t cell lines at  <dig> hour after infection with hiv-1bru with non-infected cell lines on each slide; see  <cit>  for details. there were four slides in total with the same rna preparations hybridized to each. this dataset is useful in testing the specificity and sensitivity of methods for identifying differentially expressed genes, since there are  <dig> genes known to be differentially expressed  called positive controls, and  <dig> genes known not to be  called negative controls. there are  <dig> gene expression levels recorded in each replicate. the four replicates have balanced dye swaps, so no mean normalization of the  log ratios was necessary provided we always used one sample  in the numerator of the log ratio and the other  in the denominator regardless of which dye was used to label which sample in each array/slide.

nudge took a few seconds to run. all  <dig> positive controls, no negative controls and three other genes were found to be differentially expressed .

it is clear from figure  <dig> that the rule of two under any normalization gave less than optimal results. in all cases the rule of two correctly found the positive control genes to be differentially expressed. however, in the unnormalized case it also incorrectly found  <dig> of the  <dig> negative controls to be differentially expressed, as well as  <dig> other genes . in the variance-normalized case, it incorrectly found one of the  <dig> negative controls to be differentially expressed, as well as  <dig> other genes . even though the rule of two is suboptimal, its performance can be improved through the use of the normalization methods suggested here.

in order to assess the stability of the different methods, the four replicates were split into two different subsets of two replicates each , and the agreements and disagreements between the genes found to be differentially expressed in each of the two datasets was calculated for each of the methods. a summary of the results is given in table  <dig>  the number of genes found to be differentially expressed in each of the datasets by each method is given in table  <dig> 

comparison of results depends on how one weights agreement  against disagreement . nudge had more agreement and less disagreement than ebarrays-lnn, and thus dominated it on both these criteria. the t test, both raw and corrected, and sam, had more agreement, but at the cost of a much higher level of disagreement than nudge. nudge had more agreement, but also significantly more disagreement, than ebarrays with a gamma-gamma model.

finally in order to check the empirical fit of the model to this data  we plot the model's fitted density over a histogram of the normalized log ratios in figure  <dig>  the model seems to fit the normalized data fairly well.

like-like dataset
this dataset is from a microarray experiment where the same samples  were hybridized to an array with  <dig> genes. the expression levels in the red and green dyes were extracted from the image using customized software written at the university of washington . the genes should be equally highly expressed, as each sample is the same, so ideally we should find few differentially expressed genes.

the results are summarized in table  <dig>  nudge found  <dig> differentially expressed genes . this is a false positive rate of  <dig> %. with no normalization, the rule of two declared  <dig> genes to be differentially expressed,  <dig> % of the total; clearly this is not appropriate. after the data had been mean-normalized, the rule of two found  <dig> differentially expressed genes, a false positive rate of  <dig> %. when the data have been mean- and variance-normalized, the rule of two finds  <dig> genes, a false positive rate of  <dig> %, still higher than nudge. since there is only one replicate in this case, neither t tests, sam nor ebarrays can be used to test for differential expression.

sam, ebarrays and t tests are not applicable to single slide data.

apo ai dataset
this dataset was analyzed in  <cit>  and  <dig> genes were suggested to be differentially expressed. the data was obtained from  <dig> mice with the apo ai gene knocked out and  <dig> normal mice. however the replicates were not created simply by comparing samples from control labeled with one dye versus knock-out mice labeled with the other. instead, cdna was created from samples from each of the  <dig> mice  and labeled with a red dye. the green dye was used in all cases on cdna created by pooling all  <dig> control mice. the statistic used in  <cit>  was



we used the numerator of this statistic, which is the same as m defined in equation  below, in place of ordinary average log ratios, as detailed in the methods section. again the method took only a few seconds to run. figure  <dig> shows the data at different stages of normalization along with the genes found to be differentially expressed in  <cit> . table  <dig> shows the gene position numbers of those genes whose posterior probability of being differentially expressed was in the top sixteen found by nudge. all eight of the genes found by  <cit>  to be differentially expressed were also found to be differentially expressed with high probability by our method. the lines in figure  <dig> indicating the rule of two cut-off appear either to miss genes that are differentially expressed , or to give a large number of possible false positives .

for application of sam, the data were normalized in the standard way, by centering the log ratios across genes within a replicate about zero. two different levels of the sam control parameter delta gave reasonable answers when using sam on this data set. the first level  found  <dig> genes to be differentially expressed, including the eight genes found in  <cit>  and by nudge, and the false discovery rate was estimated to be  <dig> %. if we assume that only these eight genes are correct, this would actually correspond to a false positive rate of  <dig> %. the second level  found six genes to be differentially expressed, a subset of the eight genes found by  <cit> , and the false discovery rate was estimated to be  <dig> %. assuming that only those eight genes are correct, this corresponds to a false positive rate of 0% but a false negative rate of 25%. these were the best results we obtained using sam.

for similarly normalized data, both the t test and the bonferroni adjusted t test found the  <dig> genes identified by  <cit>  to be differentially expressed. however, the t test found an additional  <dig> genes to be differentially expressed at the 5% significance level , and the bonferroni adjusted t test found an additional two genes to be differentially expressed. a summary of the results for the apo data is given in table  <dig> 

CONCLUSIONS
we have proposed a simple method for detecting differentially expressed genes that is fast and can be applied to single-slide and multiple-replicate experiments, as well as to log ratio difference experiments. it accounts for the multiple comparisons involved, and produces a posterior probability of differential expression for each gene, rather than just a yes/no testing result. the posterior probabilities can be used either to declare which genes are differentially expressed, or to produce a ranked list of genes for further analysis. the method worked well for the three datasets that we analyzed. in terms of known false positives and false negatives, the method outperforms all multiple-replicate methods except for the gamma-gamma ebarrays method to which it offers comparable results with the added advantages of greater simplicity, speed, fewer assumptions and applicability to the single replicate case.

our method can be seen as a parametric alternative to adjustment of tests for multiple comparisons using false discovery rate ideas  <cit> , or empirical bayes formulations  <cit> . a similar idea was proposed in  <cit>  for large numbers of tests, in which the distribution of the test statistic was modeled as a mixture of two normals, one corresponding to the null hypothesis being true, and the other to its being false. this differs from our approach in that we use a uniform distribution for the mixture component that corresponds to departures from the null, rather than a mean-shifted normal. because of this, a method such as  <cit>  could not find both over- and underexpressed genes.

a similar idea with different distributional assumptions, using only normally distributed components is given in  <cit> . instead of the average log ratios used in the method presented in this paper,  <cit>  use a t-type statistic using the difference of average gene intensities. a more complex approach given by  <cit>  involves modeling each level of differential expression with its own normal component.

in our approach the important aspect of the mixture is the cutoff points where the weighted normal density falls below the height of the weighted uniform density. points beyond the cutoff are declared to be differentially expressed . these cut-off points are relatively unaffected by outliers which affect the range of the data and thus the range and height of the uniform component, because the normal density falls off very rapidly towards the tails, and also because the estimated mixture weights change accordingly.

an important part of the method is normalization in terms of variance as well as mean. this extends the original lowess normalization in  <cit> . as a preprocessing step, it improves the performance not only of nudge, but also of other methods, including the simplest of all, the rule of two. thus, this normalization method may be useful as a preprocessing tool for analysis of differential gene expression, regardless of which method is used to draw final inferences.

