BACKGROUND
the category of long non-coding rnas  is composed of non-coding rnas  with long transcript length 
 <cit> . the lncrnas may carry out a variety of functions, e.g. scaffolding multiple proteins to form a complex, and regulating gene expression
 <cit> , however, most lncrnas’ functions remain to be specified. during the past decade, a growing number of newly detected lncrnas have been reported thanks to the development of relevant biotechnology and computational methods
 <cit> . early tiling microarrays were used to detect the lncrnas in the mammalian transcriptome
 <cit> , however, they could not detect precise gene structures and exon linkages of the lncrnas
 <cit> . subsequently, this problem was tackled by high-throughput rna sequencing , which presented its advantage of revealing the whole transcriptome
 <cit> , including detailed gene structures and expression levels. so far, the rna-seq has been the major biotechnology for lncrna study
 <cit> . for example, by using rna-seq, guttman et al.
 <cit>  obtained detailed information of over a thousand large intergenic ncrnas  in three mouse cell types
 <cit> .

however, studying lncrnas based on rna-seq encounters several technical problems. first, the assembled transcriptome may include partial transcripts and artefacts caused by rna-seq problems, such as low sequencing depth, sequencing biases
 <cit>  and short read alignment errors
 <cit> . for lowly expressed transcripts, the sequencing biases may introduce undesired gaps in the assembly, resulting in partially assembled transcripts
 <cit> , which may be mistakenly identified as lncrnas. the similar mistakes could also be introduced by low sequencing depth for lowly expressed transcripts. moreover, the incomplete and erroneous assemblies can affect downstream analysis
 <cit> . second, transcriptome reconstruction
 <cit>  based on rna-seq reads may produce a variety of transcripts, e.g. completely assembled transcripts, intronic rnas
 <cit>  and antisense transcripts
 <cit> , which are classified by comparing to the known gene annotations. thus it is not trivial to identify lncrnas from such complex assemblies. third, it is still difficult to distinguish the lncrnas from the protein-coding mrnas
 <cit>  or short peptides. a protein-coding mrna can be defined by open reading frame  greater than  <dig> amino acids  or  <dig> nucleotides 
 <cit> , but this is arbitrary and incorrect
 <cit> . here we present a computational pipeline to address these problems.

although thousands of lncrnas have been identified
 <cit> , only a handful of them were functionally characterized. given the difficulty to experimentally characterize the biological functions of the lncrnas
 <cit> , and given the growing body of genomics and epigenomics data becoming available relevant to lncrnas’ biological functions, it is interesting to predict lncrnas’ functions computationally. we applied our computational method to an rna-seq dataset derived from a klf <dig> gene knockout study on mouse fetal liver tissue
 <cit> . previous studies based on the klf <dig> knockout study manifested that klf <dig> is the founding member of a family of  <dig> transcription factors in mammals
 <cit> . klf <dig> knockout mice die from anemia by embryonic day  <dig> , with severe defects in differentiation, hemoglobinization, enucleation, and membranecytoskeleton organization of red blood cells
 <cit> . however, very little is known of the lncrnas regulated by klf <dig> or that participate in the development of erythroid cells. here, we recruit the differential expression analysis to explore the lncrnas that may function in the erythropoiesis.

methods
datasets
the rna-seq dataset for the klf <dig> knockout experiment on mouse embryonic day  <dig>   fetal liver tissue can be obtained from ncbi gene expression omnibus 
 <cit>  database with accession number gse33979
 <cit> , and it includes  <dig> replicates  totalling  <dig> million 76-base single-end reads generated by illumina gaiix sequencing on polyadenylated selected  rnas. bowtie
 <cit>  index of mus musculus genome , ensembl
 <cit>  and ncbi reference sequences  mouse gene annotations
 <cit>  are all available on cufflinks’ website
 <cit> . university of california santa cruz  mouse known gene annotations
 <cit>  can be downloaded from the ucsc genome browser
 <cit> .

pipeline for predicting novel lncrnas
there are two parts in our pipeline for predicting novel lncrnas from the rna-seq data .

initial assembly
initial assembly  represents a genome-guided strategy for transcriptome reconstruction
 <cit> . the raw rna-seq reads were first mapped onto the mm <dig> genome by tophat  <dig> .3
 <cit> . after that, the un-mapped reads were trimmed to  <dig> nt before re-mapping. the final mapped reads of each replicate include two parts, namely ‘mapped reads 1’ and ‘mapped reads 2’. moreover, the ‘-g’ option of tophat together with the gene transfer format  file of the ensembl gene annotation was used for read mapping. with the read alignments, we calculated the overlap ratio  between the replicates of each condition . to increase the read coverage, we merged the read alignments of all six replicates into one binary version of sequence alingment/map  using samtools  <dig> .18
 <cit> . then the mapped reads were assembled by cufflinks  <dig> .2
 <cit> . in the transcriptome assembly, we performed reference annotation based transcript  assembly
 <cit>  with the refseq gene annotation to compensate incompletely assembled transcripts caused by read coverage gaps in the regions of refseq genes.

novel lncrnas detection
novel lncrnas detection  is aimed at detecting novel lncrnas from the initial assemblies. specifically, the initial assemblies were first compared to a set of combined gene annotations  using cuffcompare
 <cit> . as a result, not only the assemblies that completely match the annotations will be detected, but also the novel transcripts can be categorized into different categories according to their locations compared with the reference genes. notably, only multi-exon transcripts were retained for the comparison and downstream processing. then low-quality assemblies were filtered according to the optimum fragments per kilobases of exon per million fragments mapped 
 <cit>  threshold . after that, we used a newly-developed program called lncrscan  to detect novel lncrnas.

combined gene annotations of refseq, ensembl and ucsc mouse known genes
the cuffcompare program
 <cit>  was used to merge the refseq, ensembl and ucsc mouse known genes into one set of gene annotation for comparing with the assembled transcripts.

fpkm threshold for classifying complete and partial transcripts
based on the merged read alignments, we conducted an experiment to evaluate the performance of fpkm in classifying complete and partial transcripts. specifically, we first ran cufflinks on the merged read alignments with default options. then the output assemblies with fpkm values estimated were categorized using cuffcompare, compared with the combined gene annotations. with the results, we evaluated the performance of different fpkm thresholds in classifying the complete and partial transcripts by receiver operating characteristic 
 <cit> .

calculating optimum fpkm threshold
the optimum fpkm threshold for classifying the complete and partial transcripts were calculated by training the fpkm values estimated from the experiment above. the index of the optimum fpkm threshold can be obtained by optimizing the sensitivity and specificity in classifying the complete and partial transcripts with formula  <dig>  

  i∗=arg mini∈i2+ <dig> 

where i∗represents the index of the optimum fpkm threshold. on the right of formula  <dig>  sensitivitiesi and specificitiesi respectively denote the ith sensitivities and specificities, given an index i. the i is enumerated in i, ranging from  <dig> to the size of a fpkm threshold set. then we can get the optimum fpkm threshold using formula  <dig>  

  t∗=t 

where t∗ denotes the optimum fpkm threshold. the fpkm threshold set t were generated by proc
 <cit> , given the fpkm values of the complete and partial transcripts.

lncrscan
to detect novel lncrnas from a set of high-quality assemblies, a five-step program named long non-coding rna scan  was designed . step  <dig> ‘extract_category’ is used to extract five candidate categories of transcripts, including ‘i’, ‘j’, ‘o’, ‘u’ and ‘x’, which may contain novel lncrnas. specifically, the ‘i’ category may contain the lncrnas falling entirely within an intron of known genes. and the ‘j’ category may include alternative long non-coding isoforms of known genes as they share at least one spliced site with reference transcripts. the ‘u’ category may involve the intergenic lncrnas . the ‘o’ category may contain the lncrnas having generic exonic overlap with a known transcript while the ‘x’ transcripts also have exonic overlap with reference but on the opposite strand. therefore, the five categories defined here may include novel lncrnas potentially. on the other hand, all categories of transcripts extracted have not been annotated by either of refseq, ensembl and ucsc known genes, so the predicted lncrnas can be ‘novel’. step  <dig> ‘extract_length’ is used to extract the transcripts having long exonic length  according to the lncrna’s definition. step  <dig> ‘extract_orf’ is set to exclude the assemblies that have long  putative orf. then steps  <dig> and  <dig> are used to exclude the transcripts of protein-coding potential. in step  <dig> ‘extract_phylocsf’, phylogenetic codon substitution frequency 
 <cit>  is recruited to filter the transcripts of protein-coding potential from an evolutionary view. briefly, phylocsf conducts a comparative genomics method for classifying protein-coding and non-coding sequences
 <cit> . since the sequence alignments are required for running phylocsf, we used galaxy
 <cit>  to ‘stitch’  <dig> mammalian alignments according to the input transcripts. in step  <dig> ‘extract_pfam’, the amino acid sequences of the remaining transcripts are searched in pfam
 <cit>   for comparing to known proteins or protein domains, and the transcripts with significant domain hits are excluded.

to evaluate the performance of lncrscan in identifying lncrnas or filtering mrnas, we ran the steps 3- <dig> of lncrscan on four datasets respectively. the first dataset  contains  <dig> multi-exon refseq ncrnas with length > 200nt and the second one  records  <dig> mrnas randomly sampled from  <dig> refseq mrnas. the other two datasets  include  <dig> and  <dig> mrnas sampled from the refseq mrnas respectively. the numbers of the retained and filtered transcripts through the steps 3- <dig> of lncrscan are summarized in table
 <dig>  we can see that  <dig>  lncrnas of d- <dig> were retained after the steps 3- <dig>  in contrast, most  of the mrnas  were filtered by the steps 3- <dig>  the result indicates that the filters of lncrscan can dramatically reduce the number of mrnas. notably, the step  <dig> adopting the orf threshold can filter a large proportion of mrnas thereby alleviating the overload of phylocsf and pfam calculation. however, some true lncrnas were filtered through the pipeline, which made the final lncrnas prediction much stringent.

in addition, lncrscan is available to the scientific community and it can be obtained by svn checkouthttp://lncrscan.googlecode.com/svn/trunk/lncrscan-read-only. other details about lncrscan can be found on
http://code.google.com/p/lncrscan/.

differential expression analysis
the cuffdiff
 <cit>  program was performed to conduct differential expression  tests between the wild-type  and klf <dig> knockout  samples . the fold changes were calculated via
log2fpkmwtfpkmklf1ko. a transcript will be reported de significant if the test gives that the fdr-adjusted p-value after benjamini-hochberg correction
 <cit>  for multiple-testing represent statistical significant 
 <cit> .

comparisons of transcript length, exon number, orf length and expression level
the novel lncrnas we detected were compared to  <dig> refseq protein-coding transcripts  and  <dig> refseq non-coding transcripts  in terms of transcript length, exon number and orf length. since a real ncrna does not have an orf, a putative orf of the ncrna candidate is defined by the longest consecutive codon chain of the ncrna candidate for comparing with the protein-coding genes. moreover, for both of the wt and klf <dig> ko conditions, we compared the quantified expression levels  of the novel lncrnas to that of the known protein-coding transcripts, which were extracted from the refseq and ensembl gene annotations. the novel lncrnas and protein-coding transcripts used for fpkm comparison all have enough expression levels .

RESULTS
initially assembled transcripts
we started our analysis with short read mapping , and approximately  <dig> million reads were successfully mapped onto the mm <dig> genome . with the merged alignments of six replicates,  <dig> multi-exon transcripts  were assembled in total, compared with  <dig> transcripts of the combined gene annotations. then we obtained the categories of the initial assemblies by comparing to the combined gene annotations . it is notable that the initial assemblies include several categories of transcripts, e.g. transcripts that have complete match intron chain compared with known genes  and those contained by known genes . of the initial assemblies,  <dig>  transcripts have been annotated by either of refseq, ensembl and ucsc known genes.

filtering low-quality assemblies with optimum fpkm threshold
fpkm can unbiasedly represent quantified expression level of an assembled transcript, and it can be estimated by maximum likelihood estimation  under a statistical model of cufflinks
 <cit> , which also corrects sequencing biases
 <cit>  in the estimation. figure
 <dig> shows the fpkm distributions
 <cit>  of the complete  and partial  transcripts assembled from the experiment of fpkm threshold  while figure
 <dig> shows the corresponding roc curve. notably, the complete transcripts represent much larger fpkm than the partial ones on average . according to the significant difference of fpkm distributions of complete and partial assemblies, we calculated the optimum fpkm threshold  based on our data . we assumed that the artificial transcripts represent either similar fpkm distribution to the partial transcripts or lower fpkm than the partial ones, thus the optimum threshold can be used to filter both of the partial assemblies and artefacts from the  <dig> novel assemblies.
 <cit>  represents the performance of fpkm in classifying the complete and partial transcripts. the corresponding area under curve  is  <dig> .

identification of high-quality assemblies
we pooled a set of high-quality assemblies  for downstream analysis. the high-quality assemblies consist of two categories. one category contains the  <dig> initial assemblies that completely match the combined gene annotations . the other category refers to the  <dig> transcripts extracted from the  <dig> novel assemblies , which satisfy the expression criterion .

novel mouse embryonic lncrnas
we applied our newly developed lncrnas detector lncrscan to the high-quality assemblies and detected  <dig> novel mouse embryonic lncrnas . the novel lncrnas were further classified into  <dig> categories by comparing with the known gene annotations . specifically,  <dig> lncrnas were assigned the ‘u’ classcode since they were located in the intergenic regions. and  <dig> lncrnas with the ‘i’ classcode fall entirely within the intron of known genes. the other lncrnas all have exon overlap with known genes. specifically,  <dig> lncrnas with the ‘o’ classcode have generic exonic overlap with known genes and  <dig> ‘x’ lncrnas also have exonic overlap with known genes but on the opposite strand. the  <dig> lncrnas with ‘j’ can be long non-coding isoforms of known genes. in addition, the  <dig> novel lncrnas we predicted were compared with  <dig> ones annotated by noncode  <dig> 
 <cit> . of the  <dig> novel lncrnas,  <dig>  ones have the same structure as noncode lncrnas  and another  <dig>  ones partially overlap the noncode lncrnas . by excluding the  <dig> lncrnas that overlap the noncode annotation, we can get a more stringent set of novel lncrnas.

novel lncrnas have shorter transcript length, fewer exons and shorter putative orf than protein-coding transcripts
previous studies in mammals have shown that lncrnas are shorter in length and fewer in exon number than are protein-coding transcripts
 <cit> . to determine whether the embryonic lncrnas we detected have the same features, we compared the  <dig> novel lncrnas to not only  <dig> protein-coding transcripts, but also  <dig> known non-coding ones, annotated by refseq . as shown in figure
 <dig>  the novel lncrnas represent much shorter transcript length on average than either refseq protein-coding  or non-coding transcripts  while the lncrnas also show fewer exons than either of the refseq protein-coding  and non-coding transcripts , agreed with a previous report
 <cit> . in addition, we also compared the putative orf lengths of the lncrnas to that of the refseq genes . as a result, the novel lncrnas represent shorter putative orf length than either refseq protein-coding rnas  or ncrnas , consistent with a previous report on zebrafish embryonic lncrnas
 <cit> . although the novel lncrnas candidates are to be ncrnas, they can differ from the refseq ncrnas used for comparison in some features due to several reasons as follows. first, the refseq ncrnas do not only include lncrnas, but also other categories of ncrnas, e.g. micrornas and small nucleolar rnas. second, the lncrnas can be further classified according to their biological functions, thus the features of different categories of lncrnas may differ from each other. the lncrnas we detected may not come from the same category as that annotated by refseq. third, the unbalanced population sizes can affect the comparison between the two categories of ncrnas. last, the putative orf length of the lncrnas we predicted were limited , which can affect the orf comparison. therefore it is reasonable to see that the two categories of ncrnas represent slight statistical difference, which is far less than that between the mrnas and ncrnas.

novel lincrnas have lower expression level than protein-coding transcripts
previous studies also showed that lncrnas are expressed at significantly lower levels than are protein-coding transcripts
 <cit> . to determine whether the embryonic lncrnas we detected have the same expression feature, we compared the quantified expression levels  of the  <dig> novel lncrnas to that of the known protein-coding transcripts . in the wt condition , the protein-coding transcripts represents slightly higher expression than the novel lncrnas on average . similarly, in the klf <dig> ko condition , the protein-coding transcripts also show slightly higher expression than the lncrnas on average . the comparison result indicates that the total novel lncrnas do not show significant lower expression than the protein-coding ones. moreover, we extracted the  <dig> lincrnas  from the  <dig> lncrnas for the expression comparison. the result manifests that the lincrnas we predicted represents significant lower expression than the protein-coding ones in either wt or klf <dig> ko condition .

differentially expressed lncrnas
using cuffdiff, we conducted the differential expression  tests between the wt and klf <dig> ko samples for analysing the function of the novel lncrnas. at the gene level , klf <dig> represents like an activator since more assembled genes are significantly repressed  after klf <dig> is knocked out than the activated ones . at the transcript level , klf <dig> also behaves like an activator since more transcripts are significantly repressed  after klf <dig> is knocked out than the activated ones . moreover, we detected  <dig>  novel lncrnas with de significant. notably, klf <dig> still functions like an activator for the  <dig> lncrnas . thus it is obvious that klf <dig> can function as an activator globally, regulating the expression of a number of genes or transcripts including the lncrnas we detected. the detailed categories of the  <dig> lncrnas of de significant can be seen from table
 <dig> 

however, cuffdiff does a length correction that has a tendency to inflate the fpkm counts for small transcripts, which can interfere the differential expression analysis. to alleviate this problem, we re-ran the de tests with the “–no-effective-length-correction”parameter. as a result, we obtained the same results as that without the parameter, which represent the robustness of our predictions.

discussion
rna-seq has been revolutionizing the transcriptome study as it can effectively capture the whole transcriptome of various cell types under different conditions. here we predicted  <dig> novel mouse embryonic lncrnas from the rna-seq data of wt and klf <dig> ko samples using a computational pipeline. the novel lncrnas we detected represent shorter transcript length, fewer exons and shorter putative orf length, and the  <dig> lincrnas of the lncrnas show lower expression level, compared with known protein-coding transcripts. moreover, we identified  <dig> differentially expressed novel lncrnas, which may be regulated by klf <dig> and play functional roles in the development of erythroid cells potentially. notably, two lncrnas  we predicted represent almost the same structures as another two lncrnas predicted by tallack et al.
 <cit>  based on the same dataset. specifically, most exons of 2_ <dig> and 2_ <dig> match that of their ‘lincred1-giant’ and ‘lincred1-dwarf’ lncrnas respectively. the slight difference may be caused by both of the strategies of transcriptome reconstruction and program versions used. despite of that, the differential expression of the two lncrnas we detected can be explained by tallack et al.’s validation using real-time quantitative pcr 
 <cit>  on their ‘lincred1’ lncrnas.

on the other hand, our pipeline followed a similar strategy for predicting human lincrnas
 <cit> , but we differ in three aspects. first, we used fpkm as a feature for filtering low quality assemblies instead of the read coverage
 <cit>  due to the fact that fpkm can unbiasedly represent the expression level of a transcript and the read coverage does not show better performance than fpkm in classifying the complete and partial transcripts assembled from our data . second, we excluded the transcripts having long putative orf length , which was previously used by the fantom consortium
 <cit> . this arbitrary cutoff makes our predictions more stringent, but it must omit the lncrnas having long putative orf . last, we detected several de significant lncrnas, which composed a subset of the total lncrnas we detected and they are more worth being investigated by loss and gain of function studies than the other novel lncrnas in our scenario. consequently, our computational methods can effectively alleviate further experimental work for studying the lncrnas that may participate in the development of erythroid cells.

although our method presented its ability in detecting novel lncrna candidates, its prediction accuracy can be improved from several aspects, such as using more reliable reads generated by high-quality deep sequencing, paired-end sequencing and strand-specific sequencing. and recent single-molecule sequencing technologies can provide more unbiased ways to capture the transcriptome
 <cit> . the sensitivity of transcriptome reconstruction can also be improved by using various strategies, such as integrating assembly results from scripture
 <cit> . in addition, the novel lncrnas predicted from our computational pipeline should be validated by biological experiments, such as cloning and pcr-based techniques
 <cit>  as several ones have been tested in the original study by tallack et al.
 <cit> . furthermore, additional genetic and/or epigenetic data sources, e.g. chromatin immunoprecipitation-sequencing  on chromatin signatures, can be valuable sources providing useful information for characterizing functions of the novel lncrnas. and the loss and gain of function studies can be conducted for exploring regulatory mechanisms of the lncrnas.

CONCLUSIONS
we predicted a set of novel lncrnas using our computational pipeline from the rna-seq data of klf <dig> knockout study, and the de significant lncrnas are worth being further studied with regard to their biological functions.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
ls designed and implemented the method. acp and mrt provided the raw datasets. ls carried out the experiments and analysis. ls, zz, tlb, zx and hl wrote the paper. all authors read and approved the final manuscript.

supplementary material
additional file 1
supplementary materials. it contains supplementary materials supporting the main text.

click here for file

 additional file 2
gtf of high-quality assembled transcripts. it is a gtf file recording the  <dig> high-quality assemblies, which were used in the differential expression tests. and their structures can be visualized by ucsc genome browser.

click here for file

 additional file 3
gtf of novel lncrnas. it is a gtf file recording the  <dig> novel lncrnats detected by lncrscan. the transcript structures can be visualized by ucsc genome browser.

click here for file

 additional file 4
gtf of differentially expressed lncrnas. it is a gtf file recording the  <dig> differentially expressed lncrnas between the wt and klf <dig> ko samples. the transcript structures can be visualized by ucsc genome browser.

click here for file

 acknowledgements
the authors would like to acknowledge fabian a. buske and other members of the bailey’s group at imb of the university of queensland for helpful discussions. the authors would like to thank the reviewers giving helpful suggestions on the paper. this work was supported by china postdoctoral science foundation 2012m <dig> and 2012m <dig>  the central special fund for operating expenses of college basic research 2010qna <dig> and 2010qna <dig> and fok ying-tung education foundation for young teachers . ls was partially supported by china scholarship council  scholarship.
