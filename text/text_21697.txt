BACKGROUND
time-resolved measurements are performed to study the dynamics of biological processes e.g. the dynamics of gene expression in response to treatments, upon induction of a transcription factor, during cell cycle or embryonic development. the temporal response patterns may shed light on coordination and regulation of the genes, aiding the inference of gene regulatory networks. several methods for the analysis of the time-course gene expression data were developed, reviewed in  <cit> , however, major challenges remain. the time courses are mainly short, hindering the inference of complex models with many parameters. the markov model-based methods  <cit>  rely on the assumption that the underlying process is a) markovian and b) stationary: a) the state of a gene at each time-point depends only on the state of the system at the previous time-point and b) the probability of a transition from one time-point to the next is constant for all time-points. the biological relevance of these assumptions is questionable. the gene regulatory circuits permanently rewire – the genes switch between different regimes of activity, whereas the durations of the regimes may have different length. in fact, these are the turning points of gene behaviour that have biological relevance and are important to elucidate. the gene expression data is likewise sampled at the irregularly spaced time-points with a hope to capture real biological events. the sparse irregular sampling generates spiky, saw-toothed data, presenting a difficulty for smooth interpolations. to overcome this, in  <cit>  the use of piecewise constant functions was advocated.

the most common purpose of the time-resolved gene expression data analysis was to derive groups of genes with similar dynamical responses. model-based clustering  <cit>  executes simultaneously two tasks: fitting a model to gene expression profiles and grouping the genes based on the parameters of the fitted models. however, relations between genes across time may have only a fragmentary character like e.g. immediate-early responses to stimulation. modeling the expression profile of an individual gene might be more appropriate. even at the risk of over-fitting, this has an advantage of capturing unique features of the gene temporal behaviour. in  <cit> , a mathematical model of response dynamics - the impulse model - was proposed for fitting the individual gene profile. the model contains seven biologically relevant parameters, emphasizing important aspects of the gene dynamics e.g. point of induction. in  <cit> , the model was used in an integrative clustering-modeling approach.

in the present approach, called switchfinder, a time-series model is proposed that explicitly assumes the existence of the switch-points  between intervals of increasing and decreasing activities, which are interpolated with linear or generalized logistic function. fitting the model to the time-resolved gene expression data implies the prediction of the switch-points of individual genes.

our approach has origin in the change-point modelling, that has been widely applied in engineering, ecology, economics and finance . the fundamental idea is: the model is characterized by a number of discrete regimes, within which different model parameters apply. the model switches from one regime to another and the characteristics of the observations change according to the particular regime. assessing the locations of the change-points  may give valuable insights into the modelled process. various approaches to the change-point problem for models with different assumptions were proposed. to mention are diagnostic methods based on testing with e.g. schwartz’s bayesian information criterion   <cit> , iterative fitting procedures for segmented regressions  <cit> , non-parametric smoothers  <cit>  and dynamic programming algorithms . bayesian approach to multiple change-points problem dates back to  <cit>  and was further elaborated by e.g.  <cit> . in  <cit> , the product partition model was used in the bayesian framework, see also  <cit> . in  <cit> , the multiple change-points model was formulated in terms of a latent discrete-state variable indicating the regimes and evolving as a discrete time, discrete-state markov process governed by a transition probability matrix. the model was estimated with markov chain monte carlo  sampling. bayesian methodology is valuable for the inference of the change-point models, since it treats the change-points locations as parameters to be estimated in the same framework as the other model parameters. a mcmc technique gibbs sampling proved to be especially attractive for the bayesian inference  <cit> .

the central interest of the present work was the inference of the switch-points indicating changes between the regimes of the gene activity. our model represents a series of switch-points , joined by lines or logistic curves. we developed a gibbs sampling procedure for the bayesian inference of the model.

the switch-points elucidated by the analysis may indicate an onset of features like growth or decay, introduced here to capture substantial dynamic properties of the gene behaviour. knowing onset-times of the dynamic features enables to represent the gene profiles in a qualitative manner. this is utilized in our approach to perform partitioning of the genes into groups with common dynamic patterns. the present approach inspires to put queries to the gene set like for example: which genes have peaks/troughs of their activity at certain time points? which genes exhibit growth or decay at the particular onset-times? the web application of the approach provides the query interface and grants to a human expert a possibility to query the time-resolved data, facilitating the biological discovery process.

the present approach decouples the two tasks – statistically fitting individual genetic profiles and grouping of them. we do not regard the gene data set as multivariate time-series data, as was done in  <cit> . the rationale behind this is that an individual gene dynamics is not only governed by the system dynamics, but by some external factors remaining “behind the scene” . in  <cit> , the authors segmented multivariate biological time-series with the help of the fused lasso regression, based on the assumption that the data at each time-point  is explained with the preceding time-points , except at the breakpoints, for which the preceding time-points have negligible explanatory power. the authors then clustered the gene profiles in each segment. to the contrary, we first seek to detect the change-points in each gene behaviour, then the change-points can be used to get insights into the dependency structure of the system.

in the next section, we introduce the model and its bayesian formulation.

methods
the modelfig.  <dig> illustration of the modeling. a example of a model with four regimes and five switches. b when the switch locations are known, the data within each regime is fitted with a line - linear interpolation. c design matrix for the model in a, calculated using linear factors, specifies the linear regression needed to determine the switch heights. d roulette method for sampling of a switch location between the neighbouring switches, based on the calculated probabilities of four possible locations




let r be the regime index: r= <dig> …,n− <dig>  we denote the locations of the switches with l
r  and the y-values at these locations  with h
r. the model assumes that the data values at time-points between the switches are determined by the linear interpolation. figure  <dig> b displays one time interval with time-points t∈{l
r,…,l
r+1}. the interpolated value at the time-point t is denoted by y
t. due to the linearity property, the following proportion is valid: t−lrlr+1−lr=yt−hrhr+1−hr. solving this equation for y
t, while denoting with lf:=lr+1−tlr+1−lr , we get: 
  <dig> yt=hr·lf+hr+1·1−lffort∈lr,…,lr+ <dig>  


if y=t= <dig> …,t is the data, the set of eq.  for all intervals r specifies a linear regression model with the n-dimensional vector of parameters h=r= <dig> …n. so the model underlying our approach is specified as: y=x·h+e, where x is the -dimensional design matrix, defined with the help of the linear factors for all t and all r . vector e is the error term, which can be written as: e=σ·e
t, e
t∼n, where σ is the standard deviation of the error term. the parameters of the model to be estimated in course of the model inference are: locations of the switches l
r, r= <dig> …,n− <dig>  the heights of the switches h
r,r= <dig> …,n and σ. .

if switch locations l
r are known, the linear regression model is specified and can be fitted to the data y by the ordinary least squares  method. then, the parameters of the model  can be determined by: h=−1
x
t
y. the fitted values under the model are calculated by: y
fitted=x·h.

in the following, for the sake of simplicity, we use a common notation for the linear regression model: β instead of h. let the linear regression model be formulated as follows: 
  <dig> y=xβ+e,e∼n <dig> σ2i. 


the n-dimensional vector of regression coefficients β and the standard deviation σ are parameters to be estimated.

model inference
probabilistic inference of the model  was facilitated by the bayesian methodology. within a bayesian framework, inference about parameters of a model, θ, is made based on its posterior distribution given the data, p, using the proportionality: p∝lp, where l is the likelihood function and p is the prior distribution of the parameters. since the direct bayesian inference of the present model is infeasible, the markov chain monte carlo  technique gibbs sampling presents an attractive possibility. gibbs sampling reduces a problem of sampling from a complex posterior distribution to a series of more tractable subtasks of sampling from simpler, lower-dimensional distributions, simulations from which can be done using standard functions  <cit> . namely, gibbs sampling iteratively generates samples from full conditional posterior distributions as outlined below.

suppose the model has k parameters θ=. given an arbitrary set of starting values ,…,θk), consider the following steps: 
 step  <dig>  drawθ1frompθ1θ <dig> …,θk,ystep  <dig>  drawθ2frompθ2θ <dig> θ <dig> …,θk,ystep  <dig>  drawθ3frompθ3θ <dig> θ <dig> θ <dig> …,θk,y⋮step k. drawθkfrompθkθ <dig> …,θk− <dig> y 


steps  <dig> through k are repeated j times, where j is the number of iterations, to obtain the samples ,θ <dig> …,θk),j= <dig> …,j. the distribution p,…,θi− <dig> θi+ <dig> …,θk,y) is called the full conditional posterior distribution. if j is large enough, after some l, the gibbs sampler has converged  <cit> . then the joint and marginal distributions of θ
 <dig> …,θ
k can be approximated by the empirical distributions of the simulated values. e.g. the mean of the marginal distribution of θ
i may be calculated by: 
 ∑j=1j−lθil+jj−l. 


in the following, we derive the conditional posterior distributions of β and σ
 <dig> 

conditional distribution of β, given σ <dig> 
assume σ
 <dig> is known. we prescribe a multivariate normal distribution for the parameter β. let the prior distribution of β is given by:


β|σ
2∼n, where the vector β
 <dig> and the covariance matrix Σ
 <dig> are known. the prior density can be written as: 
 pβσ2=2π−n2Σ0−12exp−12β−β0Σ0−1β−β0∝exp−12β−β0Σ0−1β−β <dig>  


because of the assumption of normality in , the likelihood function is given by: 
  <dig> lβ,σ2y=2πσ2−t2exp−12σ2y−xβty−xβ∝exp−12σ2y−xβty−xβ. 


combining the prior density and the likelihood function, the posterior distribution of β, conditional on σ
 <dig>  is specified by the following normal distribution : 
 βσ <dig> y∼nβ <dig> Σ <dig> whereβ1=Σ0−1+σ−2xtx−1Σ0−1β0+σ−2xty,Σ1=Σ0−1+σ−2xtx− <dig>  


in case of an uninformative prior i.e. when β
 <dig> is the vector of nulls and Σ
 <dig> contains big values, the bayesian estimate of the probability distribution of β is analogous to the distribution of the best linear unbiased estimator of β obtained by the ols method. namely, the unbiased estimator of β is a normally distributed random variable  <cit> : 
 βunbiased∼nxtx−1xty,σ2xtx− <dig>  


so, we can use β
fitted=−1
x
t
y and Σ=σ
2− <dig> as the mean and the covariance matrix for sampling the values of β.

if the mean vector μ and the covariance matrix Σ of the multivariate normal distribution are known, a commonly used method for generating values from this distribution is the following. identify matrix a, which is the cholesky decomposition i.e. aa
t=Σ, then the sample value is calculated as: μ+ae, where e is an n-dimensional vector of standard normal variables sampled from n.

while sampling β, rejection sampling was used to ensure the validity of the new model: only models with alternating troughs and peaks and non-degenerate  are admissible.

conditional distribution of σ <dig>  given β
assume β is known. the usual specification for the distribution of σ
 <dig> is the inverted gamma distribution . so, 1σ <dig> should be gamma-distributed. let the prior distribution of 1σ <dig> has the form: 1σ2β∼Γν <dig> δ <dig>  where ν
 <dig> and δ
 <dig> are known, so 
 p1σ2β∝1σ2ν02−1exp−δ02σ <dig>  


the likelihood function is given by . multiplying the prior density and the likelihood gives the following posterior density: 
 p1σ2β,y∼1σ2ν12−1exp−δ12σ <dig>  that is also of a gamma form, suggesting the following posterior distribution of 1σ2: 
 1σ2β,y∼Γν <dig> δ <dig> whereν1=ν0+t,δ1=δ0+y−xβty−xβ. 


it can be shown that in case of uninformative priors  this distribution is analogous to the distribution of the unbiased estimator of σ
 <dig>  determined by the ols method. if σunbiased2is the unbiased estimator of σ
 <dig>  then it is distributed as : 
 σunbiased2∼σfitted2t−mχ2t−m,  where m is the number of regressors in the model , χ
 <dig> is the chi-squared distribution. so, we can use σfitted2t−1χ2t− <dig> for sampling the values for σ
 <dig>  where σ
fitted is calculated from data.

sampling switch locations, given all the other information
while sampling a location for a switch r, we assume that the locations of the previous and the subsequent switches are known, so the possible choices lie in the interval i∈{l
r−1+ <dig> …,l
r+1−1} representing a finite number of possibilities. figure  <dig> d illustrates the approach. for each possible value i, by bayes theorem, the posterior probability of the switch taking the particular location is the following: plr=iy=lylr=iplr=ip,where p is the prior probability, l is the likelihood of data, given the particular location. it can be written: p=∑jlylr=jplr=j. if we assume the uninformative prior, the probabilities p are the same for all ji.e. p=p. thus, the following formula for the calculation of probabilities of the possible switch locations results: 
 plr=iy=lylr=i∑jlylr=j. 


the likelihood of data, given the particular location, can be calculated as the product of the probabilities of making the error ett∈lr−1+ <dig> …,lr+1− <dig>  where each error is calculated as: et=yt−yfittedtσ. note that the error is standard normal distributed: e
t∼n, so we can use the r function pnormto obtain the individual probabilities .

once we have p i.e. the probabilities of each possible location given all the other information , we can sample an integer value with these probabilities by the roulette selection method . i.e. a random value rand is generated from the uniform distribution and i:=1+maxmΣi=1mprobsi<rand will be taken as the sampled value for the switch location.

the workflow of the algorithm in fig.  <dig> represents the repeated sampling of the model parameters in course of the mcmc iterations. in each run, the algorithm first allocates the switch-points and then fits the model, providing necessary quantities for the sampling of new values for the model parameters. only switch locations that generate valid models are accepted.
fig.  <dig> workflow of the algorithm. the algorithm presents the iterative sampling of the model parameters in the gibbs procedure. parameter values  and fitted data are stored for each current model. the generated switch locations are accepted only if they produce a valid model. the parameters of the fitted model  are used to generate new sample values for the switch heights. then, upon model fit, the fitted standard deviation is used to produce a sample value for the standard deviation. the next iteration with the updated model proceeds, new switch locations will be generated




the number of the switch-points, with which the mcmc procedure is initialized, is calculated with the exploratory non-parametric technique loess  <cit> , originally lowess . it is a method for fitting a smooth curve between two variables. the procedure performs weighted polynomial regression for only a subset of observations i.e the fitting at point t is weighted toward the data nearest to t. the distance to t, that is considered near to it, is controlled by the parameter span. when span is less than  <dig>  it represents the proportion of the total data included within each subset. more details can be found in the description of the r function loess, used in this work. the polynomial for the regression equations here was quadratic . loess fits a non-linear smoothing curve to the data, helping to reveal structural patterns in it. we use the fitting data to calculate local minima and maxima along the curve suggesting the number of the switch-points. higher values of the span produce smoother curves, hence, the number of the switch-points decreases. setting for the span is found in an iterative procedure. starting with the small span  <dig> , a curve is fitted to the data while increasing the span by a small amount  until none of the local minima and maxima are located immediately adjacent. the last number of the minima and maxima  yields the number of the switch-points.

we call the presented model model_lin to distinguish it from the model_logit described in the next section.

modeling with the generalized logistic function 
sometimes the increasing/decreasing activity of a gene exhibits a saturated behaviour, stabilizing with time. to model this, the generalised logistic function was used. we assume that in each time interval {l
trough,l
peak}between two switch points, which are a trough and a peak, the fitted data lies on a logistic  curve and is calculated as follows: 
  <dig> yfitted=htrough+flpropt·hpeak−htrough 


where h
trough and h
peak are switch heights, prop
t is the proportional location of the time-point t with respect to the trough and is calculated as propt:=t−ltroughlpeak−ltrough. fl is the generalized logistic function defined as : 
 y=k1+qe−abt−t01b,  which is the solution of the differential =y
 <dig>  where q=−1+ky0b.

the parameter b allows the shape of the sigmoid curve to vary flexibly. k is the maximum observable value of y, in our case k= <dig>  in the present work, we used the following parameterization : 
 flpropt:=11+−1+ <dig> κ·exp−1·propt·bκ 



b plays a role of the growth rate. note that the linear transformation of a logistic curve in eq.  is also a logistic curve. with this transformation the lower and upper asymptotic heights of the logistic curve fl  are moved to be the trough and the peak values, respectively. equation  can be rewritten as:


y
fitted=)·h
trough+fl·h
peak. then 
  <dig> y∼1−flpropt·htrough+flpropt·hpeak 


represents a linear regression model . fitting the model to the data y  facilitates calculation of the switch heights, analogously to the model_lin described above. the generalized logistic transformation of the proportional location of each time-point between the neighbouring trough and peak allows for flexible modelling of the gene expression increase/decrease within time intervals of different length. sampling of the logistic function parameters b and κ was executed with the help of bootstrapping  as follows. first, when switch locations and heights are known, eq.  is rewritten as: y−htroughhpeak−htrough=flpropt. denoting the left-hand side with propy
t yields: 
  <dig> propyt=flpropt. 


thus, the parameters b and κ are estimated with the nonlinear least squares method  - by fitting the nonlinear function fl to the data x=prop
t, y=propy
t. so, for the current model in each mcmc iteration, the design matrix is constructed and the linear regression model  is fitted to the data y to calculate the switch heights h. then y
fitted is calculated by . further on, the residuals et=yt−yfittedt are calculated and the bootstrap samples of the residuals eb=eb <dig> …,ebt are used to calculate the bootstrapped values y
b=y
fitted+e
b, which are then fitted by  to obtain the samples of the parameters b and κ. apart from that, the workflow of the mcmc-based inference of the model_logit is analogous to that of the model_lin depicted in fig.  <dig>  one-regime models, presenting just logistic increase or decrease, are termed here logit_up and logit_down.

switchfinder as web application
we developed a web application of the method switchfinder, which provides the user-interface for uploading the time-series data, executing the algorithm and performing queries to the results of the data analysis, thus maintaining a feedback-loop between generation and interpretation of the results. we propose the concept of features, assigned to the inferred switch-points, which capture meaningfull properties of the time-series. the basic features peaks and troughs are the switch-points of the genetic activities deduced by the method directly. the queries are supported: which genes have peaks/troughs at the given time points?. hence, early, middle and late responses can be elucidated. the user can input thresholds on values of the peaks and troughs to select stronger effects and focus on fewer genes. further features – growth and decay – designate those troughs and peaks that represent onsets of significant growth or decay of the gene activity as defined with the help of the slope . by increasing thresholds for the slopes, stronger effects can be selected. the next-level features - spikes and clefts - are defined based on the previous-level features using three switch-points . the query result i.e. the set of genes, which exhibit the given features at the given time-points, is downloadable as the list of genes or the plot . single queries can be logically combined. the default values suggested by the web application for the thresholds of the slopes are computed as 25%-quantile of the distribution of the slopes over the data. with the default thresholds, the application computes features and represents each gene in form of a qualitative profile – as the set of features with their respective onset-times . for a location, its highest-level feature is stored. the profiles that were fitted with a one-regime logistic model additionally obtain features logitup or logitdown. grouping of the genes is executed by k-means clustering of the qualitative profiles using the jaccard similarity  <cit> . jaccard measure is especially appropriate for the calculation of similarity between two sets containing different numbers of elements. the concepts of features and qualitative profiles help to reveal groups of genes, organized around remarkable properties of the dynamic behaviour. the suggested grouping is only a platform for further investigations and exploration of the data set. by querying the data set and grouping, meaningful patterns of the dynamic gene expression can be deduced.
fig.  <dig> features of the switch-points defined in switchfinder: growth, decay, spike and cleft. features are assigned to the switch-points to capture meaningfull properties of the time-series. the feature growth is assigned to the switches of types trough, if the corresponding slope is greater than the threshold with the default value threshold_growth. the user is able to adjust the threshold for selecting more striking growth-effects. the feature decay is defined similarly. the higher-order feature spike is assigned to the switch, designated with decay, if its left-hand side neighbour has the feature growth and the absolute difference dif in the gene expression levels of the neighbouring switches is smaller than the threshold with the default threshold_dif. the aim is to select a really spiking behaviour: after a rapid growth, rapid decay to almost the same level occurs. the feature cleft designates the opposite behaviour: after a decay, growth to almost the same level occurs


fig.  <dig> switchfinder query interface. snapshot of the user interface demonstrating the result of the query - gene profiles with the feature growth at the switch-point at time t= <dig>  the slope of the growth was greater than the treshold. it is possible to download the result and to store the query




RESULTS
application of switchfinder to simulated data
to test robustness of the algorithm switchfinder, especially with respect to short time-series data, we generated  <dig> data sets, each containing  <dig> synthetic gene expression profiles of the length t= <dig>  the simulation scheme for a data set was the following. the profiles were generated with standard deviation sigma= <dig>  from the following models: a) logit_up  and logit_down  using  <dig> different combinations of the parameters κ and b: , , , , , , , , ,  including extreme values that challenge the fitting procedure; b) models model_lin with one internal switch point of the type peak located at t=2/4/ <dig>  and of the type trough located at t=2/4/ <dig> ; c) models model_lin with two internal switch points of the types  located at time-points t= <dig>   and of the types  located at t= <dig>  ; d) model model_logit with parameters κ= <dig> b= <dig> and one internal switch at t= <dig> . the parameters  of the models were simulated to obtain realistic gene expression values as commonly produced by agilent technology: sampled from log-normal distribution  and truncated to the interval . the scheme produces biologically realistic data sets with rich dynamic responses. table  <dig> demonstrates the results of the application of switchfinder to  <dig> artificial data sets. the goodness-of-fit of a model fitted to a gene expression profile was assessed with the residual standard deviation . the descriptive statistics of the rsds for each data set is displayed. the statistics are very stable across the data sets. for the data cases originating from model_lin and model_logit models, precision and recall were calculated , recall:=tp/), to evaluate the accuracy of the prediction of the switch-points. the values were stably good. a small number of functions mismatches occurred .



application of switchfinder to human cell cycle data 
to verify that the algorithm is suitable for long time-series, we applied it to the gene expression data from  <cit>  measured at  <dig> time-points during cell division cycle in human cancer cell line hela. we used the profiles of  <dig> known cell cycle regulated genes measured upon release of double thymidine block till  <dig> hours. the fitting results can be observed in additional file  <dig>  the mean of the residual standard deviations was  <dig>  . figure  <dig> demonstrates examples of the fitted profiles.
fig.  <dig> examples of the fit. switchfinder was applied to the time-series of the cell cycle regulated genes from whitfield et al. the fitted data is presented with dashed lines/curves, the switch-points are depicted in black. the time-course of the gene mcm <dig> is fitted with model_lin, the gene cdc <dig> showed better fit with model_logit




we sorted the genes by the time-points of their first peaks over the time, peaks with expression around  <dig> were neglected. the ordering revealed a clear picture of the cyclic activity of the genes and a good separation of g1/s and g2/m cell cycle phases . note that the present analysis did not use the assumption of periodicity of the gene expression, which was explicitely introduced into the analysis by  <cit> . thus, the use of switchfinder allows for explicit temporal ordering of biological events like gene activity peaks. the reconstructed temporal order of the gene activities during the cell cycle demonstrated e.g. that the genes slbp, mcm <dig>  msh <dig>  nucks for their activation need earlier signals.

application of switchfinder to data from neuroblastoma cell line treated with atra 
neuroblastoma is an embryonal tumor arising from the neural crest precursors of the peripheral nervous system. it is supposed that a mechanism underlying this malignancy is the block of cell differentiation, which promotes maintenance of cell stemness and cell proliferation  <cit> . differentiation therapies attempt to rescue the suppressed function i.e. to induce differentiation of neuroblastoma cells  <cit> . the aim of the present application of switchfinder was to identify genes involved in neuroblastoma differentiation and to study their expression patterns over time.

we applied the approach to our original data: the gene expression time-series measured at  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig> hours  in neuroblastoma cell line be-c after treatment with the differentiation agent all-trans retinoic acid . be-c  is a clone of the sk-n-be neuroblastoma cell line established in  <dig> . the agilent whole genome 4x44k microarray raw data was background-corrected and quantile-normalized . a probe was selected for further analysis if the standard deviation of its expression profile was greater than  <dig>   and the gene expression in the respective non-treated control was stable. in total,  <dig> probes  were selected and fitted by switchfinder, from them  <dig> probes were assigned to  <dig> groups representing meaningful dynamic patterns .
fig.  <dig> dynamic patterns of the gene expression response in neuroblastoma cell line to treatment with atra. a induced_immediately genes in this group were induced immediately upon treatment with atra. b induced_ <dig> the activation of these genes by atra started at  <dig> hrs. c induced_ <dig> genes in this group were induced in response to atra after  <dig> hrs. d induced_late genes in this group showed late induction: after  <dig> or  <dig> hrs. e repressed these genes responded to atra immediately with the decrease of expression. f repressed_cyclic these genes, involved in the cell-cycle, were repressed by atra. g spiked genes in this group responded to atra with increase and then decrease of their activity, revealing a peak between  <dig> and  <dig> hrs. h clefted this group summarizes the genes with a transient response to atra i.e their expression declined and then increased. the average gene expression profile for each group is depicted in black





eight groups of genes, delineated by the analysis, reflect the time-resolved transcriptional response of neuroblastoma genes to the treatment with atra. four groups comprise the activated genes, which were induced: immediately , after  <dig> hours , after  <dig> hours  and after  <dig> hours . the group g  summarizes genes with spiked behaviour, mostly at  <dig> or  <dig> hrs. three groups comprise genes repressed by atra: the group e  with declining gene expression pattern, the group f  with a cyclic decrease and the group h  with genes having clefts at different time-points, mostly at  <dig> hrs. each group/pattern is characterized by one or more features e.g. onset of growth at the first time-point for the group a. however, the patterns were delineated not solely by the features-based clustering, but also by some additional considerations. many genes from the group f were fitted with the model logit_down as the genes from e, however, their declining cyclic pattern was further discerned by the additional condition: if the expression value at  <dig> hrs. was lower than at the neighbouring time-points. further on, the logit_up model was a good fit for many activated genes. however, to elucidate the time of induction more precisely, we sorted the profiles by decreasing k and decreasing b , thus obtaining the temporal ordering of the genes starting from steep, early responses via s-formed  to convex, late responses.

the functional annotation of the gene groups was executed with the program david . table  <dig> displays important genes from the group a of immediately induced genes, together with their gene ontology annotations. in suppl. tables s1-s <dig> , the genes and their functional annotations are presented for each group. our results indicate that the transcriptional response of neuroblastoma cells to the treatment with atra is the time-resolved realization of the bmp, wnt, notch and fgf signalling, as well as of the g-protein coupled and neurotrophin trk  receptor signalling. this coincides with the gene regulatory programs during differentiation of the neural crest  cells in course of the development of the sympathetic nervous system  <cit> .
the table displays exemplary the genes from the group a and their functional annotations. the group a contains genes that demonstrated immediate increase of expression in response to atra




the groups of immediate and early  responses are very rich on transcription factors involved in determination of cell fates and regulation of embryonic development: hoxd-genes, sox4/8/ <dig>  foxc <dig>  foxo1a, bmp <dig>  tle <dig>  tlx <dig> etc., see table  <dig>  as expected, early induced were the genes involved in retinoic acid metabolism and signalling: rara, rbp <dig>  rdh <dig>  sp <dig>  crabp <dig>  cyp26a <dig> and rdh <dig> 

the gene snai <dig>  playing a role in the epithelial-to-mesenchymal transition , is over-expressed  accompanied with the down-regulation of adherence junction genes like cadherins cdh4/7/ <dig>  claudin cldn <dig>  cingulin cgn, catenins ctnna1/ <dig>  as well as of tight and gap junction genes tjp <dig> and gja <dig>  <cit> . interestingly, the gene snai <dig>  initially over-expressed as compared to the control, decays under the influence of atra. the mesenchymal markers were induced immediately or at  <dig> hours: fibronectin fn <dig>  fibronectin receptors itgb1/3/ <dig>  fndc4/ <dig>  vitronectin vtn and vimentin vim. cell polarity regulator ppard and a member of crumbs complex, crb <dig>  belong to the group a. the metalloproteinases mmp2/11/ <dig> and adam19/22/ <dig>  which facilitate degradation of the extracellular matrix, were active immediately or at  <dig> hours. thus, the results indicate a contribution of atra to the migratory phenotype of neuroblastoma cells.

induced immediately were the receptors ntrk <dig> and ngfr - regulators of the nerve growth factor signalling known to be responsible for the maturation of the peripheral nervous systems through regulation of proliferation, differentiation and survival of neurons  <cit> . activated early were the genes responsible for the axon guidance, axonogenesis, neuron projection, neurite outgrowth etc., which participate in the ephrin, semaphorin, plexin and roundabout signalling: efnb <dig>  efna2/ <dig>  epha <dig>  ephb <dig>  sema4c/6c, plxna2/4a, slit <dig>  slitrk <dig>  interestingly, the semaphorin sema6a, known to control cell migration, was repressed, although its receptor plxna <dig> was activated after  <dig> hrs. previously, sema6a was found upregulated in undifferentiated embryonic stem  cells  <cit> . further observation: the neuropilin signalling  was repressed, together with the ephrin ligand efna <dig>  in general, a complex spatio-temporal expression of guidance molecules and genes involved in neuron migration was observed. vast transcriptional changes were induced by atra at genes involved in cytoskeleton organization, cell polarization and immune processes. e.g. the chemokine receptor cxcr <dig> was induced at  <dig> hrs. it represents a positive cue for the migration of the nc cells . we suppose that canonical wnt signalling is repressed or delayed upon treatment with atra, with non-canonical wnt signalling taking place: ppard/g and tle <dig> were induced, tcf <dig> and tcf <dig> were repressed, dact <dig>  and further genes annotated with negative regulation of canonical wnt signaling pathway were induced: ankrd <dig>  dkk1/ <dig>  sfrp <dig>  the gene wnt <dig> was activated lately .

a clearly observable effect of atra-treatment on nb cells is the repression of genes involved in cell cycle regulation, particularly in g1/s and g2/m transitions of mitotic cell cycle, in cell proliferation, dna metabolic process, dna damage response, dna repair signalling: mycn, aurka/b, birc <dig>  cdc2/ <dig>  cenpf, pcna, plk1/ <dig> etc. . furthermore, genes responsible for negative regulation of cell proliferation e.g. cdkn1a were active at  <dig> or  <dig> hrs. notably, the gene alk, an important unfavourable prognostic marker in neuroblastoma, was repressed.

to summarize, our study documented a powerful transcriptional effect of atra on nb cells. a complex gene regulatory machinery controls the two properties of neural crest cells: ability to extensively migrate and differentiate into numerous derivatives and to maintain multipotency  <cit> . the role of retinoic acid hereto even in normal organism is still not well understood. in neuroblastoma, the normal properties interfere with the abnormal emt and migratory characteristics, acquired by tumor cells due to the genomic lesions in several developmental and guidance molecules genes  <cit> . we suppose that the dynamics of gene expression in neuroblastoma neurogenesis is influenced by the genetic aberrations inherent to this malignancy.

CONCLUSIONS
identifying dynamic patterns under various biological conditions is crucial for the understanding of a biological system. the patterns reflect the coordination, co-regulation and control of the system components. identifying temporal changes and patterns of gene expression is important for the inference of gene regulatory networks. we developed a method switchfinder for the analysis of time-resolved data, applicable to the gene expression data. the change-point model at the core of the method represents a series of the switch-points between regimes of increasing and decreasing activities, captured by linear or generalized logistic functions. switchfinder fits the model to the gene-expression profiles, inferring the switch-points inherent to the gene dynamics. the method exploits bayesian model inference with the mcmc technique gibbs sampling. to note, the method is suitable for long, as well as for short time-series.

the advantage of the present approach is the inference of biologically justified and interpretable features of the genetic activity, as well as the possibility of their subjective exploration by researchers with different goals and background knowledge, in different biological scenarios. the web application of the approach provides the user interface for querying the gene time-series. a flexibility is given to the user to adjust the selection criteria for restricting the results to substantial dynamic phenomena. actively guiding the data analysis is valuable for biologists, as opposite to an automatic, unsupervised application of a statistical/bioinformatics method. some features of the data might be designated as important by an expert subjectively - beyond those obtained by statistical learning based on statistical characteristics. the features, in a next level of abstraction, can constitute further features or patterns. such a qualitative approach should overcome over-fitting and lead towards biologically meaningful results.

the features-based clustering is preferrable than clustering methods based on distance measures like euclidian distance or correlation. the latter ignore the dynamic nature of the temporal data and overlook single data points, which represent important changes in the gene behaviour associated with the events of the gene regulatory control.

to mention, the present method is independent of the quantitative expression levels of different genes. it would not miss a relation between the genes with different abundance, but with the same qualitative pattern.

previously, a platform pests was created, making the analysis of some statistical features of the gene profiles accessible via the user interface  <cit> . qualitative representation of the gene expression profiles was performed in  <cit>  by the trend temporal abstraction, which transforms the time-series into series of intervals with increasing, decreasing or steady trends. however, the dominant points, defining the intervals, were determined by the approximation of the data curves based on thresholds chosen by the user. this makes the algorithm sensitive to noise. the method concentrated on shapes of the gene profiles, rather than on proper timing of the dynamic events. to emphasize, the statistical inference of the prominent time-points in the temporal profiles is of advantage. the temporal abstraction clustering was implemented in the software timeclust  <cit> , together with other clustering methods. also, hvidsten et al.  <cit>  performed qualitative representations of the gene expression profiles in terms of templates  over sub-intervals. the authors used such descriptions as attributes in the rough-sets based classification system to relate genes to biological processes. parameter values for the identification of the templates were chosen experimentally with a purpose to maximize the performance of the whole system. unlike previous approaches, our qualitative descriptions of the gene-expression profiles are based on the labelling of the switch-points – not of the intervals. with this, gene profiles with activity intervals starting at the same time-point, but having different durations would still have a chance to be assigned to the same group. this might be important for the elucidation of those gene regulatory events like e.g. when the gene group is controlled by a transcription factor. furthermore, we are able to define higher-order qualitative features of the switch-points like spikes and clefts.

the present method combines quantitative and qualitative characteristics: statistically inferred timing of dynamic events and the qualitative dynamic features.

the approach offers a great flexibility in the induction of biological knowledge from time-series data: the user may explore the gene set by clustering  or interactively  by putting queries and experimenting with the qualitative features of particular time-points.

the results of the method provide a platform for studying temporal relations like e.g. time delays with the goal to deduce dependencies between the genes. modelling cellular dynamic responses on the level of pathways and networks can be considered as possible extensions of the approach. our next goal is to adapt the switchfinder to the analysis of rna-seq time-series.

additional files

additional file  <dig> this file contains supplementary text and figures with additional explanations to the model_logit, as well as the supplementary figure  <dig> with the heatmap, displaying the profiles of the cell cycle regulated genes ordered based on the results of the switchfinder. 





additional file  <dig> results of the application of switchfinder to the cell cycle regulated genes. the gene expression profiles are plotted in black, the fitted lines - in blue, the fitted logistic curves - in red. the switch-points are depicted as dots. 





additional file  <dig> additional file a-h. these files contain the fitting results for the genes from the groups a-h, deduced by switchfinder, which represent eight dynamic patterns of the gene expression response to atra in neuroblastoma cell line. 





additional file  <dig> tables s1-s <dig>  demonstrating genes from the groups a-h and their functional annotations. 




abbreviations
atraall-trans retinoic acid

bicbayesian information criterion

emtepithelial-to-mesenchymal transition

esembryonic stem

lassoleast absolute shrinkage and selection operator

loesslowess, locally weighted scatterplot smoothing

mcmcmarkov chain monte carlo

ncneural crest

olsordinary least squares

rna-seqrna sequencing

