BACKGROUND
the molecular basis for cancer evolution and metastatic spread remain largely unknown. the formidable complexity and evasive nature of tumor biology are the major reasons for the slow progress in implementing effective modalities of prevention and treatment of most cancers. tumor populations are evolutionarily advantaged because they are dynamic aggregates of constantly evolving subclones, each carrying a variety of genomic aberrations  <cit> . to date copy number alterations, such as deletion, duplications and amplifications, or spatial genomic re-arrangements, such as translocations and inversions, have been characterized and associated with several different types of cancers  <cit> . in addition, certain sets of aberrations present at diagnosis are expected to be associated with disease recurrence  <cit> . identification and characterization of these alterations is of great relevance in understanding the underlying biology of cancer, as well as the design of clinically useful biomarkers of cancer relapse or metastases.

karyotyping is a standard and effective single cell screening approach that has been used to detect significant genomic aberrations in cancer and in normal populations. resolution is the main limitation of this technique; the coarse aberration profile obtained by karyotyping is not sensitive enough to detect short, yet relevant, abnormalities  <cit> . array-based techniques, such as comparative genomic hybridization  and single nucleotide polymorphisms  arrays, have been used as an alternative to conventional cytogenetic approaches in the study of copy number alterations  in cancer  <cit> . snp-arrays generally have a higher resolution than cgh-arrays and can also be used to detect allele-specific information. in addition, genome-wide association studies have employed snp-arrays successfully to identify copy number variation  in normal and diseased populations  <cit> . in contrast to traditional karyotyping, snp-arrays offer the possibility of investigating up to  <dig> loci at once for several million cells in a single experiment. however, these high-throughput approaches do not reveal the full genealogical perspective of the tumor biopsy. instead, they measure aggregate signals of multigenerational progeny. while this is not an issue when analyzing a homogeneous population of cells, it negatively affects the feasibility of correct cna identification and classification of tumor samples. in contrast to germline samples, aggregate signals of tumor biopsies exhibit a higher degree of complexity due to the extent, variety and frequency of aberrations, contamination from stromal cells and the intrinsic heterogeneity of cancer  <cit> . heterogeneity, in particular, reflects the dynamic nature of tumors as aggregates of different subclones, each carrying a continually varying number of genomic aberrations. progress in effective treatment of early stage cancers will likely be restricted by this immense complexity until we are able to find new methods to separate, catalog and classify the subclones that are responsible for invasion and metastases.

in order to systematically investigate the effects of subclonal heterogeneity in the quantitative analysis of cancer biopsies, we studied the feasibility of uncovering subclonal components and their relative abundance from aggregate signals using linear algebra. motivated by the need of cna detection measures that are robust to tumor heterogeneity we defined a class of measures that can be used to classify cnas from tumor biopsies into three categories: gain, loss and normal. we extended the application of this class of measures to demonstrate how heterogeneity is reflected in data derived from transcriptome massive parallel sequencing . altogether, our study addresses some of the challenges arising in analyses of aggregate signals at the dna and rna levels of heterogeneous tumor samples. to our knowledge, the present work is the first to explicitly address the limitations imposed by subclonal heterogeneity in high-throughput experiments and to discuss the tractability of copy number inference from aggregate signals of subclones in mathematical terms.

methods
de-mixing of samples
in a homogeneous sample s, the exact genotype of each cell in the sample can be represented by the pair of vectors, a and b, containing respectively the number of copies of the a- and b-allele at each locus. for the sake of simplicity, we assume that each locus is at most bi-allelic, namely that only two variants, a and b, can occur. in the case of tumor biopsies, or studies in which cells from several individuals are pooled together, the measured  and  vectors correspond to the average copy number of the a- and b-alleles at each locus across all cells in the sample. when studying heterogeneous samples, it is very unlikely to find any cell in the sample whose genotype corresponds exactly to the measured profile.

the "de-mixing problem" is the task of recovering the fraction xi, called the mixing coefficient, and the genotype gi = {ai, bi} of each i-th homogeneous group of cells in the sample . this problem corresponds to solving the linear system

   ,

where xi is an element of the vector x, j is the locus index, aji and bji are elements of the matrices a and b respectively, and n <dig> is the set of all non-negative integers.

deconvoluting genotyping data signal from heterogeneous cell population
the de-mixing problem is trivially solved when only two independent components  are mixed together, and their copy number, aji + bji, is measured using independent experimental approaches in at least two loci. however, in general, deconvolution of cna signals from a heterogeneous sample to its homogeneous components is an ill-posed mathematical problem. linear algebra solution approaches will encounter non-unique solutions corresponding to a non-unique combination of possible discrete vectors representing different subclonal aberration profiles.

regularization methods  are often employed to reduce the number of feasible solutions in underdetermined problems. the underlying assumption of applying regularization in this context is that a sample will not generally contain all theoretical subclones, defined by all possible combinations of aberrations. instead, a few subclones arising during cancer progression will be selected. this assumption is also consistent with the possibility that subclones' viability may be hindered by the lethal synergy of some of their aberrations. donoho and tanner reported key results on regularization methods from counting faces of randomly projected polytopes when the projection radically lowers dimension  <cit> . it is possible to show that even in the simplified problem with aji ∈ { <dig> } bji ∈ { <dig> }, the required condition for sparse reconstruction,   

is not fulfilled for any s >  <dig>  where 2s- <dig> is the size of the search space, with s equal to the number of loci measured, k is the number of components  and s+ <dig> is the maximum number of equations, corresponding to the number s of unique measurements , including the additional constraint that the sum of mixing coefficients is  <dig>  thus, a mixture of  <dig> or more components, which is typical in tumor biopsies, cannot be uniquely deconvolved solving the linear system, or using sparse reconstruction methods. in the presence of heterogeneous samples no inference can be made of the exact copy number from the aggregate signal of the subclones.

to illustrate these points, we provide a detailed example of the conditions and solution of copy number inference for a mixture of a tumor subclone component with its matched stromal component. in this scenario, de-mixing is elicited by additional constraints on the copy number of the stromal and of the tumor components. the stromal component is assumed to have no cna, thus its number of copies is constant and equal to  <dig>  the linear system in eq. <dig> of the measured aggregate genotypes  at the j-th locus is reduced to:

   ,

where x is the mixing coefficient of the stromal component, aj <dig> and bj <dig> are the a- and b-allele copy number of the tumor, aj <dig> is the a-allele copy number of the stromal component and n <dig> is the set of all non-negative integers. in addition, we include the equation aj1+bj <dig> = mj in the system in order to restrict the copy number of the tumor component at the j-th locus to an integer mj. we consider only the loci harboring deletion events with an aggregate copy number smaller than two, where mj - the copy number of the tumor component - can take one of two values: one if the deletion in the tumor cells is hemizygous, or zero if it is homozygous. we then solve the system at each locus independently for the two possible values of mj and determine the two corresponding possible values of x. since there is only one tumor component, there must exist one value of x to solve eq. <dig> for all loci simultaneously. the mode of all values of x across all loci corresponds to this value. the corresponding value of mj at the j-th locus is then the exact copy number of the tumor component.

a simple framework for cna analysis
cna analysis encompasses the tasks of detecting and classifying copy number aberrations. current hmm based applications for cna analysis rely on the assumption that increasing the number of hidden states, thereby increasing the complexity of the underlying model, will eventually result in higher cna classification accuracy  <cit> . as detailed above, determination of the exact number of copies is an ill-posed problem in the presence of heterogeneous samples. therefore, we propose to detect substantial deviation from the normal diploid state by classifying the aberrations as gains or losses inferred from the dominant component in the mixture. the goal of cna analysis then becomes to infer the most recurring aberration that would be observed in a hypothetical, high-resolution karyotyping of the same heterogeneous sample, if it were available.

peiffer et al.  <cit>  employed a convenient transformation of a- and b-allele copy numbers to b-allele frequency β and the total-dna enrichment ρ. for clarity of discussion, we use a simpler version of this transformation for each snp defined as:

   ,

where n is the total number of cells in the sample,  are the allele counts estimated from the snp-arrays. peiffer and et al. suggest estimating this quantity from the signal of a normal population . in general, occurrence of cna is reflected in the total-dna enrichment. in the presence of heterogeneous samples, these changes can be difficult to detect due to the high level of noise. as expected, in heterogeneous samples, aberrations also lead to allelic imbalance at positions of heterozygous snps . we thus propose to base cna detection in heterogeneous samples on measures of allelic imbalance.

one such measure of allelic imbalance is

   ,

where w corresponds to a window of appropriate size. this quantity is an aberration score for each snp, based on the measure of allelic imbalance in its neighborhood. we denote this measure as the m-measure and use it for the remainder of the analyses with w =  <dig>  w =  <dig> is an arbitrary choice of a window large enough to have a reasonably robust estimate of the m-measure. the m-measure is insensitive to hemizygous deletion events if they occur in the majority of cells in the sample. we address this issue by testing whether the total-dna enrichment ρ, also known as r-ratio, is significantly below its expected value of  <dig>  we use the m-measure to classify snp cna profiles into three states: gain, loss and neither. the m-measure is a measure of deviation from the expected state of normal non-tumor sample. in order to have a measure that is robust to noise, we chose trigonometric functions such that their product is close to zero in a wide region around the value of the expected state of a normal, non-tumor sample. these trigonometric functions have a non-linear rapid change of the deviation score once the threshold of having a true gain or loss is crossed. as previously discussed, in this context there are numerous solutions to the problem of inferring the exact number of copies consistent with the measured aggregate cell population signal . as none of the possible solutions can be preferred to the others, characterization of cnas in terms of gain and loss is a practical alternative.

the three-state m-measure classification can also be used in a three-state viterbi algorithm whose hidden states are normal, deletion, and duplication segments. we name this classification approach 3smm. we use 3smm only in our simulated scenarios. in order to use the best parameters for our simulations, we determined transition and emission probabilities from the underlying true copy number status of the simulated data for each run.

simulated data
we randomly generated two haplotypes of  <dig>  loci to simulate a mixture of a homogeneous tumor subclone and its matched stromal cells. a haplotype is a vector of zeros and ones, representing the two alleles respectively. our random generation process ensures that at each locus, the germline had a  <dig> % probability of being homozygous and a  <dig> % probability of being heterozygous. the stromal  component of the mixture was obtained by combining the two haplotypes as described in eq. <dig>  the tumor  component was obtained by adding aberrations to the two haplotypes. to have a unique profile of aberration status, we excluded simultaneous occurrence of different kinds of aberrations  at the same locus. we mixed the normal and aberrant components with proportions of α and  respectively. gaussian noise with a signal-to-noise ratio of  <dig> was used to simulate experimental noise.

we then simulated samples comprising two tumoral subclones and their matched stromal component. as in the case with one subclone, we excluded simultaneous occurrence of different kind of aberrations  at the same locus in the same subclone ; however, the two tumor components were generated such that their aggregate signal contained all combinations of aberrations . the three components were then mixed by a linear combination with proportions of α, 2/ <dig> and / <dig> corresponding to the normal component and the remaining two tumoral subclones respectively. as in the case with two components, gaussian noise with a signal-to-noise ratio of  <dig> was used to simulate experimental noise.

we tested four different types of aberrations: homozygous deletion, hemizygous deletion, a gain of one copy, and a gain of two copies. we did not test neutral loh since it is not an event that would affect the copy number. each aberration covers  <dig>  loci . aberrations were separated by  <dig>  aberration-free loci . our aim was to test the classification performance of different approaches to heterogenous-like data rather than testing the sensitivity to detect short focal events. this motivated our choice of aberrations of  <dig> loci each.

measure of performance
to assess algorithmic performance we used the area under the receiver-operator characteristic curve  measure. in the present study, which is different from the usual formulation, in which the classification task is to distinguish between a set of positive instances and a set of negative instances, we had three class labels: gain, loss and normal. in a typical machine learning scenario in which there is no parameter to vary, the aucroc in the operative point  is computed as

   ,

where tp is the number of true positives, p is the number of positives, tn is the number of true negatives and n is the number of negatives. similarly, in our three-classes scenario, the aucroc can be computed as

   ,

where tpgain is the number of snps that are amplified and correctly inferred as such by the algorithm, pgain is the total number of snps that are amplified in the sample, tngain is the number of snps that are not amplified and that are correctly inferred as such by the algorithm, ngain is the total number of snps that are not amplified in the sample; tploss is the number of snps that are deleted and correctly inferred as such by the algorithm, ploss is the total number of snps that are deleted in the sample, tnloss is the number of snps that are not deleted and that are correctly inferred as such by the algorithm, nloss is the total number of snps that are not deleted in the sample; tpnormal is the number of snps that are not aberrated and that are correctly inferred as such by the algorithm, pnormal is the total number of snps that are not aberrated in the sample, tnnormal is the number of snps that are aberrated and correctly inferred as such by the algorithm, and nnormal is the total number of snps that are aberrated in the sample.

snp profiling using microarrays
dna from  <dig> melanoma cell lines were hybridized to illumina's human1m beadchip . we generated b-allele frequencies and log-r ratios using standard procedures included in the illumina beadstudio package. we normalized with respect to the population of western european ancestry  from the hapmap project that was analyzed on the illumina human1m beadchip.

design, probe annotation, and data processing of the arrays for detection of genome-wide gene expression
we used nimblegen genome-wide human expression arrays  with a total of <  <dig>  probes for <  <dig>  transcripts and <  <dig>  known genes, as of nimblegen annotations. nimblegen provides design and probe annotation. standard methods for one-channel and two-channel microarrays from the r statistical software were used as previously described  <cit> .

transcriptome profiling using next-generation sequencing
we re-analyzed the rna-seq sample mewo from a recent study  <cit> . namely, the reads were aligned to the reference genome using bowtie  <cit>  with standard parameters. nucleotide variations were determined after pileup using samtools  <cit> , and the frequency of the variant, β, was calculated as in eq. <dig> 

fluorescent in situ hybridization 
fluorescence in situ hybridization  was performed using probes from the bacterial artificial chromosome  clones  containing the selected genes e2f <dig> , etv <dig> , ezh <dig>  and fam84b . all bac clones were cultured in  <dig> ml lb media supplemented with chloramphenicol at 37°c shaker incubator overnight, and cell pellets collected by centrifuge were used for dna extraction using the large-construct kit . two bac clones for the 5'-end or the 3'-end of each gene were labeled differently by spectrumgreen-dutp or spectrumorange-dutp using the nick translation kit . probe hybridization on slides of interphase cells was performed following the laboratory's standardized protocol. hybridization signals were visualized and captured using an olympus bx <dig> fluorescence microscope with cytovision software version  <dig> . <dig> . in each sample,  <dig> nuclei were inspected and the signal patterns were documented.

RESULTS
the measure of allelic imbalance  is robust to heterogeneity
we performed simulations to study the behavior of the allelic imbalance m-measure in presence of aberrations . a simple threshold procedure can be used to identify high confidence cna loci. an arbitrary choice of  <dig>  for the cutoff of the m-measure and window size w =  <dig> is sufficient to achieve satisfactory accuracy . remarkably, the m-measure is robust in detecting aberrations even when the aberrated component is present at low concentrations .

comparison of the performance of the m-measure to that of state-of-the-art hmm-based cna methods requires data in which the subclonal composition and copy number of each subclone are known. currently, there is no practical solution to catalog all aberrations in all clones in a given sample, and we therefore used simulated data to test the accuracy of cna classification of complex mixtures. following the binary mixture procedure described in the methods section, we generated  <dig> independent datasets for selected values of the mixing coefficient α to simulate a scenario of contaminating a homogeneous tumor sample  with stromal cells. this binary mixture scenario should not be confused with the one used by peiffer et al  <cit> . peiffer et al. mixed tumor samples of one individual with normal cells from another individual, generating a mixed sample that was not reflective of clinical settings. in our simulations, we mixed components from the same individual, reflecting stromal contamination, which is often present in tumor samples. deconvolution strategies to analyze mixtures comprising one normal and one homogenous tumor component have been proposed by others  <cit> .

we tested penncnv  <cit> , genocna  <cit> , the m-measure and the three-state viterbi algorithm based on the m-measure  using the mixture scenario of a stromal contamination with a "pure" tumor sample. we used default parameters for both penncnv and genocna. as a measure of performance, we calculated the average of the areas under the receiver-operator characteristic curve  at the operative points , reducing the classification task to the correct classification of gain, loss and normal states . as expected, penncnv performed the worst. penncnv is not designed for tumor copy number inference. its poor performance indicates that algorithms that do not take into account the possibility that the data could be a mixture of more than one component will perform worse than algorithms that do not ignore this possibility. given the low performance, penncnv was not included in any further analysis. overall, the m-measure performed as well as, or better than, the state-of-the-art hmm-based methods. remarkably, it exhibited higher robustness to the mixing coefficient. interestingly, 3smm shows no evident improvement compared to the m-measure . we also compared the actual value of the mixing coefficient to the value inferred by solving the linear system, as described in the methods, and to the value returned by genocna, as described in the genocna documentation. as shown in figure 2b, our solution obtained using linear algebra is close to the actual solution , even when the normal component was overwhelmingly abundant. the main effect of increasing stromal contamination seems to be reflected in a slightly larger variance of the estimated mixing coefficient, which is particularly visible in the inference based upon the 3smm algorithm. this increase in the variance reflects the overall decrease in performance in terms of aucroc . the surprisingly weak performance of genocna in inferring the correct mixing coefficient is probably linked to the non-uniqueness of solutions in the problem of inferring exact copy numbers. as the use of viterbi decoding did not significantly improve algorithmic performance, we did not use 3smm for further analyses.

to test classification performance in more heterogeneous conditions, we generated  <dig> independent datasets of a tumor sample with two subclones contaminated by a stromal component for selected values of the normal component mixing coefficient α, as described above. in this scenario, the m-measure clearly shows its superior robustness in the inference of cna status from heterogeneous samples with an aucroc above  <dig>  for mixtures in which the tumor components together constitute at least half of the sample . the classification performance of the m-measure decreases as the total fraction of stromal cells increased, suggesting that the decreasing signal-to-noise ratio of allelic imbalance, as already shown in figure  <dig>  is the main cause for misclassification. further comparison using real snp-array tumor data revealed higher robustness of the m-measure in identifying de novo aberrations during tumor progression .

in general, the linear relationship between probe signal and allelic content shown in equation  <dig> recapitulates that pooling and counting the number of occurrences of each allele from a biological sample follows basic algebraic relationships. this is the case in karyotyping, fish experiments, exome sequencing, dna-seq and many other experimental procedures. equation  <dig> does not refer to a specific technology; instead, it reflects basic statistics notions and is, in its theoretical formulation, exact. it has been shown that snp-array data may require preprocessing steps involving non-linear transformations  <cit> . we have shown that copy numbers cannot be inferred at the linear level and that a fortiori cannot be inferred after applying the non-linear transformations required to faithfully analyze snp-array data.

experimental validation of robustness of the allelic imbalance measure to heterogeneity
we sought to demonstrate that the allelic imbalance measure can detect cna in highly heterogeneous tumor samples. for this purpose, we selected loci from melanoma tumor samples  that exhibited deviations relative to normal melanocytes in terms of cna and mrna expression. we identified  <dig> genes that were over-expressed in more than  <dig> melanoma samples  relative to normal melanocytes. we selected the  <dig> most frequently over-expressed genes for further analyses by intersecting these genes with all aberrant genes whose m-measure and log-r were indicative of gain in copy number. fluorescent in situ hybridization  analysis of four genes, e2f <dig>  etv <dig>  ezh <dig> and fam84b, which show the most recurring gains, revealed remarkably complex mixtures with varying gains and number of subclones . the prevalence of copy number gains of etv <dig> and fam84b suggests that aberrations involving these genes may be functionally involved in maintaining the disease, or that they occurred early in tumor genesis and inherited by most subclones during tumor expansion. this finding is consistent with melanoma cytogenetic reports of recurring early aberrations of their hosting chromosomes  <cit> .

samples have been characterized by disease status, stage and braf or nras mutation.

high-resolution profiling of heterogeneity using next-generation sequencing
allelic imbalance can also be used to detect heterogeneity using next-generation sequencing, in particular genomic dna sequencing, mrna sequencing  and whole-exome sequencing. similar to the cna analysis, allelic imbalance at the single nucleotide level can give insights into tumor heterogeneity, provided that there is sufficient sequencing coverage to reliably identify variations distinctive of subclonal populations. a recent study produced an in-depth sequencing profile of melanoma samples  <cit> . we re-analyzed sequencing data from the mewo melanoma cell line, which had the highest sequencing depth, to identify patterns associated with subclonal heterogeneity. inferring heterogeneity from rna-seq is very difficult due to the co-occurrence of numerous effects, such as allele-specific expression, varying expression levels across subclones, and alternative splicing, all of which can alter the allelic balance. to overcome the presence of confounding effects, we focused on the variation of single nucleotide allelic imbalance along exons. we argue that in the absence of subclonal heterogeneity and of cna at the level of dna, allelic imbalance is expected to be constant along the entire exon. on the other hand, in the presence of subclonal heterogeneity, acquired variations in some subclones will introduce allelic imbalance at a population level with significant fluctuations between neighboring loci . this imbalance is not associated with differential expression between paternal and maternal alleles, but rather with the co-occurrence of subclonal variants whose observed expression level may reflect their relative abundance. in addition, large fluctuations between contiguous nucleotides can exclude the presence of focal cna, which would instead result in highly correlated fluctuations at each nucleotide along the aberration. given the lack of independent cna information for the mewo sample, we studied heterogeneity in rna-seq using single-nucleotide mutations. however, the proposed approach is general enough to be extended to the study of cna heterogeneity in next-generation sequencing.

as proof of concept, we examined all nucleotide variants occurring along any exon. to achieve statistical significance, we discarded all nucleotide variants that were supported by less than  <dig> reads in each sample. we identified several genes in different samples that had signs of significant allelic imbalance at the rna level. in particular, we observed significant fluctuations in allelic imbalance at different consecutive positions within the same exon that were not associated with indels . rna-editing and short cnas could be considered an alternative explanation for the observed imbalance. one approach to exclude the occurrence of rna-editing would be to sequence the genomic dna of these exons. however, we note that the majority of the reported examples did not correspond to the typical c→u and a→i rna-editing modifications. in principle, the presence of very short cnas can be excluded, verifying the signal obtained on high-resolution snp-arrays. notably, in some cases, the distance between loci with significantly different allelic imbalance is shorter than the rna-seq read length; the presence of a cna common to all subclones would simultaneously affect both loci, leading to similar allelic imbalances. taken together, these results suggest that these base variations affect only a fraction of the subclones in the sample . in conclusion, allelic imbalance measures, besides being robust to heterogeneity in high-throughput analyses, can also be used to detect heterogeneity and uncover specific subclonal markers from next-generation sequencing.

the majority of these mutations are not indels or typical rna-editing substitutions, supporting the idea that these point mutations occur in a fraction of the subclones from the heterogeneous melanoma sample.

discussion
high-throughput technologies can effectively replace cytogenetics to generate high-resolution maps of chromosomal aberrations. cataloging potential markers at different length-scales, such as whole chromosome deletions, to few genes, or even to specific nucleotide mutations, has enabled the association of important biological mechanisms with tumor formation and progression. however, the caveat of interpreting data generated by these techniques is that signals measured from tumor biopsies can be an aggregate profile of different cells. to better understand the potential of high-throughput technologies, our study addresses two issues: i) the effects of subclonal heterogeneity on cna analysis; ii) the identification of copy number alteration measures that are robust to heterogeneity.

in our work we show that heterogeneity has a hindering effect on cna analyses. currently there is no direct mathematical procedure to correctly infer the copy number of a heterogeneous sample when the number of homogeneous components is greater than two. even in toy-models, in which the main focus is on the aberration status rather than on the actual copy number , the search space of aberration profiles grows exponentially with the number of measurements.

on the other hand, at this point, it is important to note that most aberrations span several loci; thus, measurements from snp-arrays, or from next-generation sequencing techniques will be grouped in clusters of statistically indistinguishable numerical values. as a result, the number of unique measurements is generally smaller than the total number of snps on an array, or than the number of base pairs sequenced using next-generation sequencing techniques. the search space of aberration profiles, however, is too large to lead to a unique solution, even using powerful regularization methods. to address this issue, one has to impose additional mathematical constraints motivated by the specific properties of the biological system under investigation.

currently, state-of-the-art cna detectors are model-based, i.e. they attempt to predict the exact copy number status and the genotype by fitting the measured quantities with pre-coded models  <cit> . the underlying models have been designed to improve sensitivity. however, when hmm-based approaches are employed in simulated scenarios representing optimal signals, the underlying aberrations are not properly inferred . we propose to reduce the cna analysis to discrimination between three distinct states, gain, loss, and normal, to detect the presence and type of the state of the strongest aberrant component in the aggregate signal.

we present a simple and biologically motivated framework to design measures of cnas based on alteration of total dna, and allelic balance at heterozygous loci. these measures can be easily implemented for three-state classification tasks using thresholding. our m-measure is one example selected from a family of measures, and it clearly showed unparalleled robustness to sample heterogeneity, thus leading to improved performance in detecting the presence of cnas. interestingly, the three-state viterbi algorithm based on the m-measure did not show a significant improvement in terms of performance over the m-measure alone. this reflects the fact that the decay in performance as the mixing coefficient of the stromal component increases is mostly due to the decreasing strength of the aberrant signal in the mixture, relative to the constant level of experimental noise. clearly, the simpler goal of three-state classification based on measures such as the m-measure is easier to meet; the advantage is that this type of measure is also more robust when put to test.

our proposed framework for detecting cnas in high-throughput snp-profiling is a conceptual generalization of a class of empirical measures used to identify cnas  <cit>  and sample heterogeneity  <cit>  employing massive parallel sequencing of genomic dna. here, we seek to demonstrate that they can be used to analyze signals in other types of sequencing experiments such as rna-seq, exome sequencing or chip-seq. high-throughput mrna profiling of tumors has shown dependency between the copy number status and the expression level of the mrna product  <cit> . measuring allelic imbalance from rna-seq experiments is partially associated with copy number status of the underlying genomic dna, yet, as mentioned above, it is not feasible to correctly infer the exact cna status due to a variety of confounding effects, including heterogeneity. we therefore do not expect rna-seq alone to be useful in inferring focal copy number aberrations in cancer samples. next-generation sequencing signals, however, are suitable for studying heterogeneity and characterizing subclonal components by their collection of specific markers. subclonal heterogeneity is not reflected in cna exclusively; it is also reflected in other somatic mutations  and other traits, such as dna methylation and histone modification.

we analyzed rna-seq experiments to unravel subclonal heterogeneity. we show that some of the measured allele-specific expression patterns result from differences in the abundance of subclonal populations, each harboring different acquired mutations . the reported loci are remarkable examples of novel candidate somatic polymorphisms, likely associated with subclonal populations. this approach has striking conceptual and methodological simplicity, and in the near future deviations in the distribution of allelic imbalances along exons might be used to infer the extent of the sample's heterogeneity. the possibility of identifying novel candidate somatic mutations associated with subclonal populations requires experimental strategies that will enable separating different subpopulations for further analyses.

our results uncover a large degree of heterogeneity at the level of genomic dna, both in terms of cna and point mutations. interestingly enough, heterogeneity is present in both primary and metastatic tumors, suggesting that the variety of underlying mutations may already be overwhelming at diagnosis. the identification of driver mutations, which typically requires examination of dna at high resolution, is linked to our ability to detect subclones capable of escaping the selective survival pressure and metastasizing. detecting potentially rare subclones at this resolution requires very deep sequencing of large cohorts of patients.

CONCLUSIONS
subclonal characterization of cancer samples is crucial to understanding disease progression  and to studying the presence or emergence of resistant subclones in metastatic cells after drug exposure  <cit> . to have a clinical impact, such characterization should not only identify markers for specific subclones in the sample, as we have shown above, but to estimate the relative subclonal abundance as well. some remarkable attempts have been made in the direction of characterizing subclones from heterogeneous tumor samples  <cit> . these pioneering efforts are promising and important undertakings addressing the difficult problem of subclonal de-mixing. however, due to the non-unique number of solutions of the underlying linear system , reported results have to be interpreted cautiously, more as a suggestive and intuitive representation of one possible evolutionary summary of the sample, rather than the true representation of the subclonal composition of the sample. while we recognize the potential relevance of novel markers reported in these studies  <cit> , neglecting the effect of cna may lead to incorrect inference of the order and the co-occurrence of genomic aberrations.

exact assessment of copy number in heterogeneous samples using high-throughput or next-generation sequencing technologies is an ill-posed task. however, characterizing cna in terms of states of deletion or amplification is still feasible. to achieve this goal, we provide a measure that can robustly characterize the dominant aberrations present in heterogeneous tumor samples. as described above, similar measures to the one we use to characterize heterogeneity in the cna analysis can be applied to data obtained in next-generation sequencing. understanding the effect of subclonal heterogeneity on measurements and analysis of tumor biopsies is a necessary step to understanding etiology and evolutionary dynamics of tumors. the ability to decipher subclonal composition from tumor biopsies will likely have a major impact on the development of personalized medicine.

authors' contributions
fp and yk designed the study. fp and yk performed the bioinformatics analysis. sa and dn collected the tumor biopsies. kh and ec performed the snp-array experiments. fx and pl performed the fish validation analysis. ab and rh supported genomic analysis. fp and yk wrote the manuscript. all authors have read and approved the final manuscript.

supplementary material
additional file 1
detecting copy number status and uncovering subclonal markers in heterogeneous tumor biopsies. comparing the m-measure-based approach to a state-of-the-art cna algorithm by testing their ability to identify de novo aberrations in snp-array signals from an evolving tumor at two time points.

click here for file

 additional file 2
evidence of subclonal heterogeneity from rna-seq data across a collection of melanoma samples. allelic imbalance along each gene demonstrates subclonal heterogeneity. the score of the non-reference nucleotide has been calculated as  <dig> - |  <dig>  - ) |, where #a and #b are the numbers of reads hosting the reference and non-reference nucleotide respectively. however, all the reported genes have a multimodal distribution of b-allele frequencies along at least one exon. the b-allele frequencies close to  <dig>  have been marked in grey, b-alleles that significantly deviate from this cluster are considered acquired somatic mutations  and can be explained by subclonal heterogeneity. vertical bars represent 95% confidence intervals. all non-reference nucleotides shown are supported by at least  <dig> reads. vertical dashed lines mark the boundaries between exons in the transcript.

click here for file

 acknowledgements
this work was supported by the yale spore in skin cancer funded by the national cancer institute p <dig> ca <dig> .
