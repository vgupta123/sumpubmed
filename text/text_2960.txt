BACKGROUND
over the past decade, a significant proportion of the protein structures deposited in the protein data bank  have come from the advanced high-throughput methods of various structural genomics initiatives <cit> . although the themes of these funded post-genomic projects differ at many levels, there is a central problem which is: how these sequences and structures are related to their functions. by increasing the structural repertoire, it is hoped that we will be able to improve our understanding of fold space and how proteins evolve new functions <cit> . this structure-function relationship is especially essential in the drug design field where researchers try to target specific proteins involved in disease mechanisms by using structure-based drug design methods  <cit> .

the number of in silico methods which can infer protein functions has grown enormously in the recent years. they can be categorized as sequence-based and structure-based <cit> . powerful blast-like sequence-search methods are able to transfer the function of a well-defined protein family to a protein with a high sequence similarity <cit> . for lower sequence similarity instances, more subtle methods such as "profile" or "hidden markov models" can be constructed from multiple sequence alignments and applied to find obscure patterns in the protein sequences, thus assigning a function to them  <cit> . all of these algorithms above assume that similar sequences are derived via divergent evolutions. however, this is limiting, as demonstrated by numerous studies showing that evolution in structure space is much more conserved than in sequence space <cit> . this has spurred researchers to develop methods to infer functions directly from structural information. many structure fold/domain classification databases have been compiled in efforts to build a basis for such algorithms  <cit> . although they have assisted researchers in assigning functions to proteins with similar folds, these fold information based methods also have their drawbacks, as it is shown that sequence/structure can also dynamically change due to convergent evolution <cit> . this is exemplified by many proteins involved in metabolism pathways, which although they do not have any fold similarity, all process similar metabolites. one explanation could be that they have a similar spatial arrangement of key residues in their catalytic binding sites. such limitation further encourages researchers to develop methods based on key residues or local structural motifs.

searching for similar local spatial patterns in structure databases is an especially challenging task, since it involves a large searching space and is usually time-consuming. given its importance both in basic biology research and drug design, several algorithms have been devised to tackle this difficult problem of finding similar functional sites in structures  <cit> . among these local spatial similarity detection methods, some rely on the curated local structure patterns, like in tess and spasm systems, and identify the similar local structures by comparing these curated structure templates with the query. others are more flexible and able to take many structures into account, then build the structure patterns during the process and detect the similar local structures on the fly as exemplified by hamelryck's multidimensional index tree method <cit> . these methods not only give hints about structure evolution and protein functions, but also play a significant roles in predicting drug side-effects caused by ligand cross binding to similar surface patches on various target structures. at the fundamental level, the elementary searching algorithms used in these methods are usually based on geometric hashing and graph clique detection. due to the significant computational expenses of these algorithms, they typically rely on previously calculated data sets and it would be nontrivial to apply them within the whole structure space represented by the pdb. users can only visualize and analyze results stored in a pre-compiled database. while as a consequence of structural genomics research, there is a continuously increasing demand for performing binding site similarity searches with user input structures in order to find possible functions for these binding sites as well as for the proteins in a large scale and fast way.

here we present a new ultrafast binding site similarity search method along with a simple analysis of occurrences of gene ontology  term and enzyme commission  numbers in hit list <cit> . our method was inspired by the fingerprint and pharmacophore concepts commonly used in chemoinformatics <cit> . we first systematically extracted possible binding sites from protein structures, mapped pharmacophore properties to the binding sites and calculated fingerprints for later database searches. to enable users to identify subtle similarity between binding sites, a panel of fingerprint measurements was tested to find the optimal solution. further, a statistics-based score method was developed to evaluate hits with the aim of eliminating false positives. this novel binding site similarity search method should enable researchers in the structural biology field to examine in detail for possible binding sites in an ultrafast large scale way. also it will benefit researchers in the field of drug development by allowing them to predict and investigate possible side effects due to ligand cross binding events.

methods
extract possible binding sites from pdb database
first, a total of  <dig> protein structures were gathered from the rcsb pdb  <cit> . then, a geometry-based protein binding site detection method, named pass  <cit> , was adopted to extract possible binding sites from every polypeptide chain in the database of protein structures. this tool is able to characterize concave regions of a protein surface and to identify positions likely to represent binding sites based upon the size, shape, and burial extent of these volumes <cit> . the output spherical probes of pass were processed with an in-house program based on a minimum spanning tree algorithm to split the probes around the protein surface into clusters at least  <dig> Å apart. this resulted in  <dig>  probe clusters, which were further filtered so that only probe clusters containing  <dig> to  <dig> probes were considered as binding sites. these feasible binding sites were used to extract protein residues within  <dig> Å of these probes. these binding site probes along with the identified binding site residues were stored into the database for later visualization and fingerprint calculation. two other datasets which compiled with known small molecular binding sites were also constructed for a better evaluation of our method. first, the hetatm residues in pdb database were filtered such that only the ones which have molecular weights between  <dig> and  <dig> were retained. also, if one residue shows up for more than  <dig> times in pdb database, then it will be regarded as a common molecule and discarded. finally,  <dig> pdb structures were subjected as a database for later geometric hashing and fingerprint calculation. in geometric hashing calculation, only the backbone ca atoms and centroids of functional fragments of side chains of binding site were retained. . we named this dataset gh validation dataset. the other dataset is fp validation dataset, which use the known binding sites of these  <dig> pdb structures to calculate the fingerprint with the method describe below.

fingerprint calculation
a fingerprint, commonly utilized in chemical similarity research, is a string representation of molecular structure and properties. normally, fingerprints take account for atomic distance or connectivity patterns. and a comparison of fingerprints can provide an inexpensive way to obtain similarity comparisons between query and reference structures. given that the aim of the present work is to develop a fast method for binding site similarity searches, we borrowed the concept of fingerprint to characterize binding site in proteins. generally, each amino acid was split into several fragments , and these fragments were classified according to  <dig> physicochemical types: hydrogen bond donor/acceptor, hydrogen bond acceptor, hydrogen bond donor, aromatic, lipophilic, positive charged, negative charged. the fragments of the binding site residues were mapped into these pharmacophore-like types and the centroid of each fragment was calculated. the distances between each fragment-fragment centroid were binned into 0- <dig> Å categories with a  <dig> Å stepsize .

fingerprint scoring function
the heart of any similarity comparison system is the measurement method for quantifying the degree of resemblance between two objects. several binary and quantitative fingerprint scoring functions were assessed including tanimoto distance, euclidean distance, canberra distance and angular separation. the canberra distance  was identified as giving the best performance measurement:   

which denotes the dissimilarity score between fingerprint i and j, both of which have n bins.

obviously the number of fragments in a binding site will affect the score of the fingerprint similarity function . the relationship between fragment number and the dissimilarity score should be investigated. in the present work, we first randomly selected  <dig> binding sites from our database and then calculated the dissimilarity scores between these fingerprints. let the fragment numbers of two binding sites i and j be denoted as numi and numj. considering the algorithm of the scoring method, we calculated a new fix_numij for each two binding sites:   

scores  below  <dig>  were eliminated and remaining scores were stored into bins of fix_numij , where for each bin the averages and standard deviations  were computed. this is similar to the procedure of regress  <dig> in pearson's fasta sequence alignment scoring function <cit> . then least square fitting was carried out for the histogram data of the averaged scores and sd against the fixed fragment number fix_numij. the fitted meanfit and sdfit can be calculated for each fix_numij using the parameters obtained from the fitting. now the z-score for every pair ij can be defined as:   

thus, a comparable z-score is available for selecting similar binding sites from the fingerprint database.

RESULTS
analysis of possible binding sites
the goal of structural biology is to investigate and understand protein functions through three dimensional structures. proteins execute their functions via binding to other cellular components such as ligands. the contact points located on the protein surface are commonly known as binding sites. although it still remains a challenge to identify binding sites solely from a three-dimensional structure, several computational methods have been developed to detect such spatial motifs. one of them, pass <cit> , is a binding site detection program based on an analysis of the geometric features of the protein surface. due to the great difficulty of identifying biologically meaningful binding sites, we decided to gather all possible binding sites for the analysis. at first, a total of  <dig> structures were retrieved from the pdb <cit>  database and filtered to remove all non-standard amino acids. next, each chain containing more than  <dig> amino acids was saved as a file to be used in binding site detection using the pass program, which resulted in  <dig> possible binding sites, or roughly two binding sites per polypeptide chain. a detailed analysis of these possible binding sites shows that the average size of a binding site is  <dig> amino acids . mapping the binding site residues to pharmacophore fragments identifies about  <dig> fragments per binding site. by analyzing the pharmacophore type distribution in the binding sites, it is clearly shown that both hydrogen bond donor/acceptor and aromatic fragments are enriched in the binding sites compared to the whole proteins, while not the lipophilic pharmacophores.

to further examine the amino acid distributions in binding sites, we also investigated the amino acid occurrence both for all the residues in binding sites  and only solvent accessible residues. as shown in figure  <dig>  the amino acid distribution pattern of whole binding sites is consistent with the fragment types found in the binding site, while the distribution of solvent-accessible residues are quite different. in binding sites, the positively/negatively charged residues  occur more frequently, while the amino acids cys and pro are rarely found. this is consistent with an analysis of the catalytic residues in enzyme binding sites. although in enzymes, histidine is also a critical player in catalysis <cit> .

similarity scoring system
due to the difficulty of obtaining a gold standard benchmark of similar binding sites in a meaningful scale, we use simulated datasets described below as a control to identify the most appropriate measurement for those fingerprints containing modest similarity. we first grouped the binding sites in the database according to their fragment numbers, denoted as groupn . for each group5×i, we selected  <dig> binding sites randomly. two synthesized binding site datasets were created with the following strategies.

dataset i
for each binding site s , we created  <dig> new structures denoted as . in each , the previous structure of s was kept and  random points were added with the follow procedure:

• fragment types are selected randomly from  <dig> to 7;

• two farthest points in binding site are located, and then two spheres of  <dig> Å radius are created centred by these two points;

• randomly set point coordinates inner the spheres until certain number of points have been got, every point should be separated by at least  <dig>  Å.

dataset ii
this dataset is derived from dataset i. the atom types in  are re-defined randomly while the coordinates of binding site structures are retained. we consider this dataset as a random dataset.

several binary and numerical fingerprint similarity measurement methods were assessed using these two datasets with the aim of finding one that could separate the similar binding sites from the random ones. the influence of bin step size  in the fingerprint calculation was checked, and it showed that a  <dig> Å bin size was detailed enough to give a good description of binding site shape. after investigating the similarity measurement methods, the canberra distance  was found to be the most appropriate scoring function in our case. as shown in figure  <dig>  this similarity measurement method is capable of separating partially similar binding sites from random binding sites when they have similar sizes, especially when the fragment number in the original binding site is less than  <dig>  even when the binding sites are large, this scoring function still worked if the fragment numbers added do not exceed 50% of the original fragment number.

although the canberra distance scoring method outperforms other fingerprint scoring methods in this simulation, it was clearly not feasible to separate similar binding sites from random ones if the binding sites were in different groups. this spurred us to devise a z-score function to correct the similarity score calculated for different binding sites.

for the sake of generalization, we randomly selected  <dig> binding sites from our binding site fingerprint database and calculated similarities for each pair . after removing obviously similar pairs , the histograms of the mean and standard deviation versus the fix_numij were calculated with the procedure of regress  <dig> in pearson sequence alignment score function <cit> . only the number of score data points in the histogram which are larger than  <dig> were considered reliable and used in later fitting. as depicted in figure  <dig>  the smooth line for the mean value is obtained from the cubic polynomial fitting with an r-square value of  <dig> . the standard deviation fitting is slightly worse with an r-square value of  <dig> .

with the parameters obtained above, the mean and standard deviation of the score at a given fix_numij can be defined as the following:      

the z-score can then be computed with equation  <dig> 

to evaluate the z-score performance, dataset i and ii were used again to recalculate the z-score for them. it was found that the z-score for the similarity of the random binding sites were around  <dig> , except for the case of very small binding sites. this should allow users to better judge the results from database search.

in general, throughout the analysis of the simulated datasets, the more points added to the original binding sites, the more difficult it is to detect the subtle similarity between them. also, the z-score scheme needs a cut-off value to indicate cases of reliable similarity when searching the binding site database. to accomplish this critical assessment for the boundary of the z-score function, the receiver operating characteristic  curve method was adopted <cit> . in order to calculate the roc curves, we randomly chose  <dig> binding sites from the simulated dataset i and labelled these binding sites as the true similar group. another  <dig> binding sites randomly chosen from dataset ii were labelled as the false group. we then varied the z-score cut-off  to calculate true positive , false positive , false negative  and true negative  values. after that, the true positive rate  and false positive rate  were calculated following equation  <dig>  and plotted as a roc curve .      

the tpr represented the sensitivity while the fpr is the 1-specificity.

as demonstrated in figure  <dig>  it is not surprising that the classification ability is limited in some cases. although at lower z-score cut-offs  the tpr is dominant, the similarity detection ability falls off as long as the z-score cut-off rose up. to take account of the effects of added points on z-score performance, we also randomly chose  <dig> binding sites from dataset i and converted binding sites with an added point percentage larger than 80% to the false group. combined with another  <dig> randomly chosen binding sites from dataset ii, the roc curve was calculated again and plotted as the 80% line in figure  <dig>  similarly, we calculated 60%, 50%, 40% and 30% lines and plotted them in figure  <dig>  clearly and intuitively, the power of the classifier increases as the more subtly similar binding sites are assigned to the false group. from the roc curve, it was illustrated that even when we added 50% random fragments to the binding sites, the z-score scheme was still able to give encouraging results. with a z-score cut-off of - <dig> , the true positive rate is about 50% and the false positive rate is only 10%.

assessment with known ligand binding sites
to validate our fingerprint scoring strategy, a geometric hashing based similarity measurement was implemented for a comparison. geometric hashing is a well known sequence-independent 3d similarity searching method, which has been adopted as a basis by web servers like sitesbase <cit> .  <dig> pdb entries were randomly selected from known binding site dataset. then they were searched by both geometric hashing and our fingerprint scoring method, against gh and fp validation dataset respectively. totally  <dig> pdb binding sites were successfully processed by both methods..

the output from geometric hashing method was categorized into three levels of similarities according to the percentages of matched points with the query . in this test,  <dig>   <dig>   <dig> pairs of similar pdb entries were found at 1/ <dig>  1/ <dig> and 2/ <dig> levels respectively.

we also defined a manner to classify the results from fingerprint based method. for each query, first, we counted pdb entries which were found as similar by geometric hashing method in certain level, this number was set as nsim. then the searching result of fingerprint method was sorted by the z-scores from lowest to highest. after we get the numbers, the sorted list of fingerprint search result will be truncated so that only the first nsim × nfold  entries will be kept. then the truncated list was investigated by counting the pdb entries which were considered as similar in geometric hashing measurements. finally, the number nfound/nsim was used as a success ratio to assess the fingerprint z-score strategy.

as demonstrated in figure  <dig>  even when truncated at  <dig> fold, the fingerprint result is still promising. if we use the geometric hashing level 2/ <dig> as the positive data, at nfold =  <dig>  the fingerprint method can detect about 87% pdb entries from the geometric hashing similar list. at nfold =  <dig>  it can detect about 92% pdb entries. if lower similarity level in geometric hashing method was selected as positive data set, the pdb entries detected by fingerprint method also diverge gradually. through figure  <dig>  one can found that the results from nfold =  <dig> are almost the same as the five fold, which clearly shows the nature of rapid convergence of this fingerprint method. we also checked the average z-scores among the truncated list. for the truncated list from nfold =  <dig> fold, they are - <dig> , - <dig>  and - <dig>  at the 1/ <dig>  1/ <dig>  2/ <dig> level respectively. while for the fold two truncated list, the average z-score values are slightly up to - <dig> , - <dig>  and - <dig> .

taking a close look at the results from geometric hashing and fingerprint methods, it is clear that they can complement each other. for example, according to the pdb annotation, the entry 3h4a is e.coli 6-hydroxymethyl- <dig> -dihydropterin pyrophosphokinase  complexed with ampcpp <cit> . from the geometric hashing searching, total  <dig> pdb entries were found having similarities better than 1/ <dig> level . blast searching the sequence of 3h4a against these  <dig> pdb also shows that all of them have blast e-value which are lower than 1e- <dig>  this demonstrated our geometric hashing procedure is capable to find the similar binding sites. interestingly, after investigating the fold two truncated list from fingerprint method, we found this list not only covers the  <dig> entries found above, but also includes some other entries, like 1cbk and 2bmb , 1c <dig>  1c <dig> and 1c <dig>  <cit> . all of these extra entries have low fingerprint raw scores and z-scores but not show up in either geometric hashing.

we also incorporate scop classification and blast e-values to check the sensitivity and robustness of our fingerprint z-score method, since both of topology and sequence similarities can partly imply a possibility of binding sites similarity. pdb entries from known binding site data set were grouped based on sequence identities and scop family terms. then for each of the  <dig> pdb entries, we checked the results from our method with these reference groups for overlaps. as shown in figure  <dig>  at low z-score value, the similar pairs found indeed have high sequence similarity. this further demonstrated the ability of our fingerprint scoring system in detecting the obviously similar cases. at z-score cutoff - <dig> , about 80% predicted similar pairs are either contained in the same scop family or have the sequence blast e-value lower than 1e- <dig>  however, the other 20% cases, which also have strong similarity z-scores, can not be simply regarded as false positive, because two proteins may have similar shape of binding sites but don't have much similarity at the overall level. for example, in this study, from the result list of pdb entry 1djy, 1pcm has a z-score - <dig> . but these two proteins do not show any relation on either sequence similarity  or scop classification. through detailed examination of their active sites, it was found that both of them contain a metal atom and phosphate sugar-like ligands, which implies that their binding sites have certain similarity.

comparison with other servers/softwares
finding similar binding sites is an important issue in the field of computational structural biology. it is not only useful in rational drug design, but also can provide information on protein functions. to evaluate the performance of our fingerprint scoring method, we also compared it with several web servers and softwares. the pocketmatch dataset was used in this comparison <cit> . as listed in table  <dig>  the fingerprint z-score method is effective in all the cases except the 1zid_zid-2cig_1dg pair, for which pocketmatch has a low pmcmin score. also, the comparison shows that in several cases, the sumo and geometric hashing method used in sitesbase fail to identify the similarity of the pairs. while the fingerprint z-score method is able to find the relations. clearly, the z-score scheme is necessary in fingerprint method. for example, the 1gjc_ <dig> and 1v2q_anh have a raw fingerprint score  <dig> , which is high enough to recognize as similar. but the z-score method normalizes this raw score and gives the - <dig> , a value strongly suggested the similarity relationship between two binding sites.

web server
a supporting website http:// <dig> . <dig> :8080/bssf/ was constructed for user-defined calculations and predictions. the web site was built with java jsp technology and the analysis and prediction procedure consist of four steps: 1) the user supplies a newly determined crystal structure or a pdb entry id to conduct the analysis. following submission of the data, the binding site detection and fingerprint calculations are initialized. 2) the user can visualize the binding sites in the crystal structure using the web embedded jmol <cit>  program. 3) the user can select the binding site to perform a database search with the z-score scheme. after finishing this fast database search , the result will appear in a table on the web page for inspection. the user can download the result for later analysis or further query the ncbi with blast program, checking the pdb entry in pdb database. also, the user can take further steps to analyze the hit list to check the occurrences of some basic information such as go terms and ec numbers. these metric may benefit researchers to design new experiments to study the query protein at hand.

discussion
a major goal of structural biology is to understand cellular functions in the context of the atomic details of molecules. with increasing deposits of three-dimensional structures in the rcsb protein data bank through structural genomics initiatives, there is a pressing requirement for experimental or computational methods to correlate functions to these structures. this sequence-structure-function relationship underlies the numerous investigations aimed at dissecting the biological properties of proteins.

in the present work, we describe a fast method for detecting similar binding sites in protein structures in the whole pdb database. this may shed light on protein function and possible drug side-effects due to ligand cross binding to similar sites. our method is developed for 3d local structure similarity detection and complements sequence-based or fold-based methods. it can uncover similarities in small spatial surface regions on protein structures and provide additional evidence for inferring protein functions <cit> . in contrast to many 3d motif similarity searching methods, we use a fingerprint approach to represent the binding sites. the fingerprint concept is heavily implemented in the chemoinformatics field for small molecule database searching and has been proved to be fast and useful in ligand similarity research. we have extended it to label binding sites in macromolecules. to simplify the large number of atoms in binding sites and to implicitly add flexibility for fingerprint representation, every residue in each binding site was fragmented into subgroups and mapped to  <dig> properties similar to the pharmacophore concept. this fingerprint representation not only eliminated the sequence order dependence usually encountered in sequence/structure similarity measurements, but also enabled an ultrafast method of searching a comprehensive binding site database. the time consumed to perform a single query with our binding site database  is approximately  <dig> minute on an intel xeon  <dig>  g processor. this gives researchers tremendous opportunities to conduct large scale comparison studies to elucidate functions for any possible binding site.

the method described here differs substantially with structure-template based methods. in these methods, local structure-template are curated from the protein structures and usually only contains very few residues, exemplified in tess system three residues catalytic traid "o-his-o" <cit> . although the method presented here also needs to extract the binding sites from pdb structures in advance, the binding sites are not limited to a fixed number of residues. based on the fingerprint concept, variable binding sites can be represented and compared without any difficulty. such circumstances would be very time-consuming with the graph clique algorithm or geometric hashing algorithm based methods  <cit> . recently, xie and bourne, based on the weighted graph maximum clique detection algorithm, devised a method soippa, which can find the similar functional sites through sequence order-independent profile-profile alignment <cit> . through implemented several heuristic rules, authors accelerate the functional matching phase and simultaneously found and aligned the similar binding sites. but due to that the intrinsic algorithm is based on the graph maximum clique detection, the running time still beyond the routine database search for the whole pdb database with all the possible binding sites, especially in the situation of fast growing of the structures out from the structural genomics project.

in comparison to the similar very fast method pvsoar <cit> , which also extracts possible binding sites with an automatic alpha shape method, our method is sequence-order independent and does not take into account the local sequence similarity between the two binding sites. this represents a more natural way to describe the shape and properties of a binding site, especially where two binding sites only share sub-pocket similarity. webfeature is another ultrafast binding site similarity comparison and functional annotation system <cit> . it uses the calculated biophysical properties of binding sites to represent the binding site and utilizes a machine learning method to train the system and predict the function for the query. compared to their approaches, our method is merely based on the original pdb structure data and does not go through the training phase. also the webfeature method is based on the already determined functional motif stored in prosite database, then may not cover all the possible binding sites represented in the pdb structures.

the binding site database in our method could be further improved to expand coverage and accuracy. in the current implementation, only binding sites that involve single polypeptide chains are taken into account. we do so mainly because it is very difficult to separate true multi-chain complexes from artefacts due to crystal packing interactions in a unit cell. nevertheless, including such binding sites in our database will expand its coverage and enhance function inference. another drawback of our method is that the pass predicted binding sites may not be the true binding sites on the protein surface. this may increase the false positive rate and reduce prediction power. although there exists such computational methods to identify the true binding sites, this shows to be a very difficult task due to the limitation of our knowledge of possible protein-ligand interactions which exist in nature.

a major challenge in analyzing local spatial patterns is how to assess the significance of the detected similarity. due to the difficulty to obtain the gold standard of the binding site data sets, we decided to use the simulated binding sites as the representation for later statistical judgement. to overcome the limitations of the original fingerprint canberra distance score function, we devised a z-score scheme and investigated its boundary in detail by gradually changing two variables, namely z-score cut-off number and fix number. it was found from the roc curve that the performance is promising even at a z-score cut-off value of - <dig>  and with less than 50% added random points. this validation strengthens the utility of our method and provides guidelines for later database searches. as demonstrated by the roc curve, our method has the capability to detect sub-pocket similarity. it is very important in drug design, to detect such weak similarity, since a ligand may only interact with a few key residues in a binding site to execute its biological role. this will help researchers to identify possible targets similar to known drug targets and to predict side-effects for certain drugs.

in future, one important further extension of our method is to combine it with other sequence-based or structure-based function inference methods to enhance accuracy in assigning functions. recently brylinski and skolnick provided a method named findsite <cit> , which can locate the binding sites in protein structure through a threading alignment of distant homologies. their method can successfully identify  <dig> % binding sites in the top five predicted binding sites. although the prediction power dropped down when the sequence identities of homologies are below 35%, combinations with the fold information or sequence information could improve the prediction accuracy <cit> . like in the comprehensive protein functional annotation database proknow <cit> , pal etc. integrate information about the query protein and then weighted the information in a bayes framework. their investigation clearly demonstrated that the multiple sources of information will enhance the prediction power. given the ability of our ultrafast binding site similarity method, it could be assembled with others sequence and structure similarity measurement and improves the prediction for the binding site functions.

CONCLUSIONS
it is well recognized that sequence and structural fold are dynamically changing under evolutionary pressure over long time scale. these diverging and converging evolutionary phenomena produces a challenging problem of how to infer the functions of newly discovered genes from their sequences and structures. many sequence-based and structure-based methods have been developed to correlate functions to sequences and structures and to extend our ability to understand the fundamental relationship between sequence, structure and function. although some cases can be easily solved, some more difficult cases often just contain very weak sequence and structure similarity with proteins with known functions in curated databases. as a consequence, there is an ongoing need of novel methods to broaden our capability to predict function in this post-genomics era. here we presented a novel and fast binding site similarity detection and function inference system. by utilizing fingerprint representations of binding sites, we are able to conduct an economical similarity measurement. furthermore, for the accurate detection of similar binding sites, especially ones where there is only weak or sub-pocket similarity, a statistical validated z-score scheme was devised to improve sensitivity. this system could be used in the drug design field to identify promising targets for drugs by using the binding site of its known target as a query. it could also benefit researchers in the field of structural biology field by allowing them to find similar structures at binding site level.

authors' contributions
bx and js performed the design of the study. bx and jw programmed the software and constructed web site. jw and mx performed the pdb structures processed and extracted binding sites. dlb, hj and js performed analysis, test the web site and conducted the case study. bx, jw and dlb wrote the draft. finally, all the authors read and approved the final manuscript.

supplementary material
additional file 1
supporting material. it includes the fragment types in geometric hashing method and pharmacophore fingerprint. also it contains the properties of binding sites.

click here for file

 acknowledgements
we thank dr. albert m. berghuis  to provide critical comments and suggestions. this work was financially supported by national natural science foundation of china  and state key program of basic research of china .

funding: this work was financially supported by:

 <dig>  national natural science foundation of china grant  <dig> 

 <dig>  state key program of basic research of china grant 009cb <dig> 
