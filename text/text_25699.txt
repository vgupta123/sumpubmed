BACKGROUND
dating divergences between populations/taxa is of considerable value in phylogenetic/phylogeographic studies because of the importance of an absolute time-scale when assessing hypotheses of lineage diversification, e.g.,  <cit> . bayesian markov chain monte carlo  methods have become widely used for this purpose  <cit> . the bayesian approach is well-suited to dating because it naturally incorporates different sources of information and associated uncertainties through the priors. most significantly, time calibrations are incorporated through the prior on divergence times. this represents a more robust solution to that offered by current maximum likelihood alternatives, which do not appear to correctly account for all sources of uncertainty and therefore underestimate confidence interval widths on divergence times .

bayesian mcmc dating incorporates models that allow the rate of molecular evolution to vary across the tree, through the prior on substitution rates. to date, rate variation is generally modelled using a relaxed or local clock approach in which the rate on a branch is either correlated with the rate on its ancestral branch or is independent of rates on other branches  <cit> .  under the independent rates model, a rate is assigned to each branch from a single lognormal distribution. the program mcmctree  <cit>  assigns both the mean rate and the variance of the log transformed rate, σ <dig>  from gamma distributions specified by the user. this model is also implemented in the program beast  <cit>  although the standard deviation of log rate, rather than σ <dig>  is assigned from a user-defined distribution. under the correlated rates model, rates on branches are dependent on branch durations and the rate on the ancestral branch. the mean of the normal distribution for log rate is obtained from the log of the rate on the ancestral branch. the variance of this distribution is the product of the branch time duration and a parameter ν that is specified from a gamma distribution  <cit> . hence, rates on shorter branches will show greater similarity with the rate on their ancestral branches than rates on longer branches. finally, strict clock models generally assign a single rate to the entire tree from a lognormal distribution with a mean and variance specified from a gamma or other distribution.

a comparison of the models discussed here indicated that the independent rates model performed well overall for simulated data, possibly because it can accommodate homogenous and correlated rates  <cit> . nevertheless, this model contains more parameters and provides wider posterior intervals than the strict clock. furthermore, the strict clock has been shown to perform well on data that show quite clock-like evolution  <cit> . an investigation of the impact of increasing levels of rate variation on the performance of the strict clock is therefore of considerable practical use. the correlated rates model has a large number of parameters but is also more restrictive than the independent rates model. it may therefore be a less suitable option than the other two models, under most conditions. ho et al.  <cit>  found that exponential and lognormal independent rates models performed well when rates were correlated or uncorrelated, but found little support for the correlated rates model . in contrast, lepage et al.  <cit>  compared the fit of several different models to three real datasets and argued for correlated rates particularly in large datasets . here, our primary aim was to compare independent rates with strict clock models, but we also examine the performance of the correlated rates model. we achieve this by analyzing divergence times of sequences using a strict phylogenetic approach, as opposed to divergence times of species using a phylogenetic-coalescent approach  <cit> . also, we use programs that were designed for dating single topologies, rather than programs such as beast  <cit> , because integration over topological uncertainty can have undesirable effects on the specification of priors on times  <cit> . our approach attempts to simplify the analysis while still providing general findings concerning the suitability of the clock models and natural levels of rate variation.

this paper considers dating of shallow trees, which we broadly define as phylogenies with a miocene or more recent root. there is good reason to believe that rates should be similar among recently diverged lineages. rates may vary due to both stochastic effects and inherited or other lineage-correlated factors such as environment. among the inherited effects, body size  <cit> , mass-specific metabolic rate  <cit> , but see also  <cit>  and generation time  <cit>  have all been suggested as partial explanations of rate variation. the similarity of these characteristics in closely related species leads to the expectation of lower rate variation in these phylogenies, which may favour use of a strict clock.

the decision to use a strict or relaxed clock needs to be informed by a suitable test. although new methods are being developed  <cit> , the likelihood ratio test  has traditionally been used for testing for clock-like evolution  <cit> . it compares a tree with no branch rate constraints with the same tree in which rates on branches are constrained to be equal. the lrt is powerful when rates vary between, but not within, branches  <cit>  as modelled in the relaxed clock analysis. one disadvantage is that it may have low power when there are few taxa and sequences are short, leading to type ii errors . in addition, it will not detect rate variation if tips are all equidistant from the root, which could occur for example if equivalent rate changes occurred synchronously across all branches. there appears to be a paucity of detailed studies that consider the performance of the lrt. hence, a secondary aim of this work was to consider its performance across different levels of rate variation.

this paper reports on the effects of rate variation on the recovery of node ages using strict and relaxed clock approaches as well as the ability of the lrt to detect this rate variation.

RESULTS
simulated data
1) rate heterogeneity
the relaxed and strict clock analyses recovered all internal node ages on the tree in the majority of analyses when the sequences were evolved with σ ≤  <dig>  . strict clock analyses performed poorly when σ >  <dig> . note that we use the term 'coverage probability' to describe the proportion of analyses that recover all node ages on the tree . coverage probabilities for relaxed clock analyses were high for all levels of σ under the independent rates model , but were significantly lower under the correlated rates model  when σ> <dig> . posterior intervals on selected nodes were wider for relaxed clock analyses, markedly so when σ was high . this effect was more noticeable under the independent rates than the correlated rates model. in contrast, the intervals remained similarly narrow for all levels of rate variation when analysed using a strict clock in mcmctree .

mcmctree analyses of replicates simulated under σ =  <dig> that used the correlated rates instead of the independent rates model provided very similar results to the correlated rates multidivtime analyses. node ages were recovered for all nodes on the tree in only 4% of analyses, compared with recovery by 5% of analyses in multidivtime. this contrasts with a recovery of all nodes in 67% of analyses under the independent rates model in mcmctree .

the frequency of rejection of the clock by the lrt showed a sharp transition around σ =  <dig> - <dig> , which paralleled the performance of the strict clock analyses. the clock was rejected for less than 10% of the datasets evolved with σ <  <dig> , but was almost always rejected when σ >  <dig>  .

2) number of taxa
the independent rates analyses recovered all node ages in the  <dig> species tree for all replicates. recovery of all nodes ages in the  <dig> species  and the  <dig> species replicates  was also high. the corresponding recovery of node ages under the correlated rates model was generally lower . slightly lower recovery of node ages was obtained under the strict clock, as would be expected given the previous results. the lrt rejected the clock for 11% , 16%  and 26%  of replicates.

3) age of root
the performance of the strict clock implemented in multidivtime was strongly dependent on root age, with lower recovery of all node ages for older roots  and 29% of replicates for  <dig> ma root). there was slightly poorer recovery of all node ages under the correlated rates model at the oldest root age  compared with trees with 5- <dig> ma roots . the pattern was different in mcmctree. strict clock analyses seemed to perform slightly better when the root age was older . the relaxed clock independent rates model performed more consistently over the four root ages . however, coverage probabilities were generally higher under relaxed compared with strict clocks over all root ages, for both programs. posterior intervals on nodes became narrower, as a proportion of node age, with increasing root age under all relaxed clock analyses, but this trend was clearer in mcmctree. the lrt rejected the clock on slightly fewer occasions for  <dig> ma  and  <dig> ma  root ages, than for  <dig> ma  and  <dig> ma  root ages.

4) number of loci
increasing the number of loci had no strong effect on the suitability of strict or relaxed clock analyses. for multidivtime, recovery of all node ages was slightly higher for five independent loci under both the strict clock  and correlated rates , when compared with fewer loci . posterior interval widths were similar for different numbers of loci. results differed for mcmctree, where an increased number of loci had no discernible effect on the frequencies of analyses recovering all node ages. there was a trend for narrower posteriors with increased numbers of loci for the mcmctree relaxed clock analyses but not for the strict clock analyses.

real datasets
1) black bass
the lrt indicated violation of the clock for codon position  <dig> , but not for codon positions  <dig>  or  <dig> . the mcmctree independent rates analysis provided 95% posterior intervals for the variance in log rate, σ <dig>  that included zero for codon position  <dig> . the intervals were slightly higher for codon position  <dig> , and indicated considerable rate variation at codon position  <dig> . the posterior means for σ <dig> corresponded to quite high values of σ ranging from  <dig> - <dig> .

posterior node ages differed considerably between the strict and relaxed clock analyses with 95% intervals being wider and means lower under the relaxed clock for both programs . multidivtime posterior means were lower under the strict clock and higher under the correlated rates model, relative to the strict and independent rates models in mcmctree.

posterior means and 95% intervals are given for nodes shown in figs. 5a-e.

2) primate-sucking lice
the lrt did not indicate violation of the clock for mtdna codon positions 1-3: x <dig> =  <dig> ; p =  <dig> ; x <dig> =  <dig> , p =  <dig> ; x <dig> =  <dig> , p =  <dig> , respectively, or for nuclear codon positions  <dig> or  <dig> . however, the clock was rejected for nuclear codon position  <dig>  and the 18s rrna gene . the lower posterior limit on σ <dig>  approximated to zero for mitochondrial codon positions 1-3: , , , and for nuclear codon positions  <dig> and 2: , . evidence of higher rate variation was detected for nuclear codon position  <dig>  and 18s rrna , closely reflecting the lrt results. the posterior means corresponded to a range of σ from  <dig> - <dig> .

for mcmctree, the ages of the two selected nodes differed between strict and independent rates analyses in the same way that they differed for the black bass data, i.e., higher posterior means and wider posterior intervals for independent rates . posterior node ages were lower for both models in multidivtime, relative to mcmctree.

3) podarcis
the lrt did not support violation of the clock for any of the partitions . the 95% posterior intervals on σ <dig> also indicated low rate variation with lower posterior limits tending to zero in all cases: cytochrome b, codon  <dig>  ; cytochrome b, codon  <dig>  ; nd <dig> and nd <dig> codon  <dig>  ; nd <dig> and nd <dig> codon  <dig>  ; 12s rrna, ; control region , respectively. posterior means were equivalent to a relatively narrow range of σ from  <dig> - <dig> .

relaxed clock analyses again provided slightly wider posterior intervals on node ages than the strict clock . posterior means were lower under the strict clock compared with the relaxed clock but differences between these clock models were smaller than found in the black bass and lice data. again, posterior mean node ages were lower in multidivtime than in mcmctree.

4) the gallotiinae
similar to podarcis, the lrt did not indicate violation of the clock for any of the mtdna partitions  which was consistent with the lower limits of the posteriors on σ2: codon position  <dig>  ; codon position  <dig>  ; codon position  <dig>  ; rrna loops ; rrna stems . posterior means on σ <dig> were quite low and equivalent to a relatively narrow range of σ from  <dig> - <dig> .

the posterior means showed generally the same patterns as those detected for podarcis, i.e., relaxed and strict clock analyses gave quite similar mean node ages for both programs with slightly wider posterior intervals under the relaxed clock. unlike podarcis, there was no clear trend for the strict clock to always give lower posterior means than the relaxed clock or vice versa .

we also explored the sensitivity of the posteriors to the prior on σ <dig> using these data. the data were analysed with  <dig> different priors that ranged from the wide g to the unsuitably narrow g. the three widest gamma distributions were all found to give similar results, indicating a considerable influence by the likelihood on the posterior for σ <dig> in these cases.

posterior means and 95% intervals  on σ <dig> are shown for each data partition.

5) caprinae
the lrt indicated considerable violation of the clock at codon positions  <dig> and  <dig> , but not at codon position  <dig> . estimates of σ <dig> do not reflect these results as clearly as for other datasets. the posterior intervals for σ <dig> were quite low for all three codons: position  <dig>  ; position  <dig>  ; position  <dig> . posterior means were low with a narrow range, equivalent to σ =  <dig> - <dig> .

posterior node ages from relaxed and strict clock analyses were quite similar for each program . differences between programs were also quite small for these data.

discussion
analyses of our simulated data confirmed that the strict clock is useful for analysing shallow phylogenies. it provided relatively narrow posterior intervals and good recovery of node ages when rate variation between branches was low, that is, when the standard deviation of log rate on branches  was ≤ <dig> . to better illustrate this: 95% of rates fall within the range  <dig> - <dig>  subs/site/ma when σ =  <dig>  . the strict clock did not perform well when rate variation was higher. relaxed clock analyses with independent rates showed a different performance profile. coverage probabilities were similar or only slightly higher than the strict clock analysis when σ <  <dig>  but were notably better when σ ≥  <dig> . at the highest level of rate variation , all internal node ages were recovered by 67% of analyses under the relaxed clock, compared with none under the strict clock. these results are partly explained by increased posterior intervals widths under the relaxed clock. the relaxed clock posteriors are substantially wider than corresponding strict clock intervals . for this reason, the strict clock is preferable when rate variation is low but rapidly becomes unsuitable as rate variation increases.

unlike the independent rates analyses, the correlated rates model did not perform well at higher levels of rate heterogeneity . this is attributed to the relaxed clock model rather than some other aspect of the programs because similarly poor performance was obtained when the correlated rates prior was tested in mcmctree. our results strongly favour the independent over the correlated rates model when rate variation is high and not time-correlated between branches. however, correlated rates may be preferable to a strict clock at intermediate levels of rate variation.

we assessed performance in terms of coverage probabilities and posterior interval widths. these are the principal arbiters of a successful analysis because the aim is to achieve a high probability of capturing true ages within narrow posteriors. accuracy of the posterior mean was not considered here, but it is worth noting that a small upward bias is evident in the posterior means of relaxed relative to strict clock analyses. this has been observed previously and seems to be associated with an increased influence by the prior on divergence times  <cit> . why it might have greater influence at higher levels of rate variation will be explored in future work.

we demonstrate that robust assessment of the clock model is required prior to dating. the lrt is appropriate for this purpose when applied to the simulated data. it tended not to reject the clock when the strict model performed well  and almost invariably rejected the clock when the strict clock model performed poorly . this finding changes a little for different numbers of species. the coverage probability averaged over all nodes remains quite similar for 5- <dig> species trees. however, the clock rejection rate by the lrt, shows more than a two-fold increase  indicating that the clock is more likely be rejected for larger trees, even when the strict clock model is appropriate. more species on the tree increases the degrees of freedom in the lrt and increases statistical power. hence violation from the clock is more likely to be detected even when rate variation is so small that the strict clock model is quite suitable. in contrast, the number of species on the tree should have no noticeable influence on σ.

an increased number of loci leads to a small improvement in performance. this result is specific to phylogenetic dating of sequences but not to phylogenetic-coalescent dating of speciation times, e.g.,  <cit> . a small improvement could be expected in a phylogenetic analysis because a 'rate-outlier' on a branch will tend to have a significant impact when only one single locus is included. in a multilocus analysis the impact of such an outlier will be mitigated by rates at other independent loci on the same branch. these analyses also suggest that a strict clock may be suitable at slightly higher levels of rate variation when multiple independent loci are available.

from the simulations we expected that strict and relaxed clocks should perform similarly well when the lrt does not reject the clock. this is largely supported by the analyses of real datasets. relaxed and strict clock analyses provided quite similar divergence time estimates for the gallotiinae and balearic podarcis datasets, where rate variation was low for all data partitions. the clock was rejected for some sequence partitions in the other  <dig> datasets. relaxed and strict clock analyses provided different divergence time estimates for two of these datasets, the black bass and lice data, in which two or more partitions showed significant rate variation. the caprinae data were an exception to these findings. the lrt rejected the clock for  <dig> out of  <dig> equally-sized partitions. in contrast, bayesian estimates of σ <dig> indicated relatively little rate variation which is consistent with the similarity of the strict and relaxed clock estimates of divergence times. this demonstrates the utility of the marginal posterior on σ <dig> as a measure of rate variation across the tree. unlike the variances in rates specified by the correlated rates model, which depend on branch duration, σ <dig> provides a simpler estimate of rate variation. it could be more generally applied to compare across datasets. in beast  <cit>  this could be achieved by examining the posterior on the standard deviation in log rate. variance/standard deviation in rate will of course depend on mean substitution rate at the locus, and so comparisons would assume similar rates between loci.

rate variation seems to vary quite widely between different genes and partitions in real datasets. posterior means were equivalent to a range of σ from  <dig> - <dig> , which spans the range of σ examined in the simulations. partitioning the data allows not only small improvements in divergence time estimation, as described here, but also detection of quite considerable differences in rate variation that can occur between partitions. our analyses of real data indicate that significant rate variation in one partition justifies use of the relaxed clock, even though our more general conclusion is that the strict clock can be superior for analyses of recently diverged sequences.

CONCLUSIONS
the strict clock is shown to have significant advantages over relaxed clocks because it provides good recovery of node ages and narrow posterior intervals when rate variation is low. rate variation in three out of five shallow  phylogenies was within the range of rate variation over which the strict clock model performed well, supporting the applicability of the simulation results. the lrt is a generally suitable way to test the suitability of the strict clock, although examination of posteriors on σ <dig> may be more informative.

