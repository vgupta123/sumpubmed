BACKGROUND
identifying conserved genomic features  as well as their relative ordering in genomes  is important in comparative genomics to understand genome evolution and pinpoint functionally important genomic elements  <cit> . computational tools have been actively developed for synteny identification, e.g., mcscan  <cit>  and i-adhore  <cit> . however, since patterns of genome conservation and rearrangements can be very complicated, visualization tools are critical to reveal those patterns. a variety of web-based synteny visualization tools exist for this purpose . compared to standalone bioinformatics software, those web-based analysis tools are more convenient for users since no local software installation or maintenance is necessary. in addition, web-based tools allow users to easily share their results with others  by simply sending the web urls of the result pages. such result-sharing capability is particularly critical for synteny analysis since other people may need to see the results for themselves with the same view of the data. using standalone software, different users have to install the same software and load the same data set in their local computers, which may be impractical in many situations. for example, the data is too large to be efficiently distributed via internet, or the software installation requires a special system some biologists do not have .

although the existing web-based synteny visualization servers are of great value to the research community, they cannot always satisfy biologists’ growing needs. except for the coge server , none of the other existing web-based tools allow users to upload their own data for synteny visualization . instead, those tools often only allow users to analyze a small number of pre-selected genome sequences available at those web resources. this limitation is becoming a serious issue since biologists often need to examine synteny for their own sequences of interest that are typically not available at those web resources. this scenario is already a reality because individual biologists can now sequence a large variety of species, strains or specific genomic regions of interest using the latest generation of dna sequencing technologies that are accessible to them . centralized web databases normally do not have the resources for displaying such highly individualized datasets to satisfy users’ diverse needs.

therefore, we have recently published a web-based genome synteny viewer , which enables biologists to upload their own synteny and annotation datasets for synteny analysis  <cit> . however, gsv can only display synteny between two genomes, which makes it difficult to keep up with the demand of biologists to compare multiple genomes. in this study, we have extended gsv into a multi-genome synteny viewer . similar to gsv, mgsv is a web-based tool that allows users to upload their own synteny and annotation data files for visualization, but multiple genomes can now be displayed in a single integrated view using either of two viewing modes. besides serving users who manually interact with the web server, mgsv also provides web services for machine-to-machine communication to accept data sent by other remote resources. the entire mgsv package can also be downloaded with easy local installation.

implementation
mgsv was implemented with free open-source software under linux environment. php  and mysql  were used to implement the web interface and backend database, respectively. javascript, jquery  and raphael  were extensively embedded in the php code for interactive browsing features.

input data
a mandatory genome synteny data file is required to use mgsv along with an optional genome annotation data file: both are tab-delimited text files as described in the original gsv package  <cit> . the synteny data file allows users to specify the genomic location of each conserved region in each pair of genomic sequences. one noteworthy characteristic of the synteny data file is its open-ended format, in which users can provide additional information such as alignment score or percentage of similarity or identity to characterize each of the conserved regions. such additional information can be used for selecting regions of interest for visualization in the synteny browser described below. an optional genome annotation file can also be submitted to list the accompanying genomic features  to be displayed as annotation tracks along with the reference genomes. users can define how each feature is displayed, i.e., the shape and color of each annotation track, in the annotation file. such display settings can also be dynamically changed in the synteny browser. in addition, if an html-style hyperlink is provided to annotate the feature name, then clicking on that feature in the synteny display will open the url in another tab. this would be useful to link to external information about a particular genomic feature. the mgsv/gsv data formats were developed because none of the existing formats can achieve the above goals easily. additional details about the input file format are available at http://cas-bioinfo.cas.unt.edu/mgsv/tutorial.php. the input files can be either submitted in plain text or in compressed format  to facilitate fast file uploads in mgsv. besides file upload, the input files can also be accessed through a user-specified url.

backend database
after users have submitted their data through mgsv, the data will be stored in a mysql relational database as described in revanna et al. <cit> . for each submitted dataset, a separate set of synteny and annotation tables is created so that different datasets are stored separately without interfering with each other. such design allows the backend database structure to easily support the “open-ended” format of the synteny file. for example, if a synteny data file is uploaded with additional columns such as “score”, “evalue” or any other columns, the dynamically generated database synteny table will contain these additional columns as fields, specifically matching the columns in the submitted data file. additional details about the mgsv database architecture can be found in the architecture file in the mgsv downloadable package.

synteny browser
after the data upload, users are first presented with a summary page , in which all the input genomes are arranged in a circle showing the overall conserved regions among each other . an “associations provided” chart is also shown in the overview page listing all pairs of genomes specified in the user-uploaded input data and the number of conserved regions for each pair. below this chart are buttons allowing the user to select either the pairwise or multiple viewing mode.

the pairwise viewing mode displays the conserved genomic regions between adjacent genomes . at the top of the synteny browser, multiple pull-down menus are available that allow users to select specific genomes to display in the order of their choice. additional pull-down menus can be added and removed, so that each genome can be displayed more than once if necessary. for example, to compare a genome a to three other genomes b, c, and d, the display can be ordered as ‘b-a-c-a-d’ by using the multiple pull-down menus. note that there is no designated “reference” genome, which allows for any order of the displayed genomes under the full control of users. buttons at the top left corner allow users to control all the genomes displayed by zooming in/out, moving left/right or viewing entire genomes on all genomes. mgsv is then divided into two main display windows with control panels  on the left and synteny displays on the right. in the synteny display window, each selected genome is represented as a horizontal ruler with tick marks showing its genomic position. the conserved regions between adjacent pairs of selected genomes are displayed as colored translucent blocks. when users click on a conserved region, a pop-up menu appears showing its numerical start and end positions. users can zoom in/out, move left/right or select specific regions on individual genomes for display by using the embedded control panels on the left of the view. users can also filter the conserved regions based on their associated characteristics listed in the synteny files such as length of the conserved regions, similarity score, and so on. selecting and filtering allow users to focus on the regions of interest that meet certain criteria. for example, by applying a stringent similarity cutoff users can choose to only display highly conserved regions. by default, each conserved region is colored differently, but users can change all the displayed regions in a synteny track to be uniformly colored via the colors option. if an annotation file is also provided, a selected annotation track  will be displayed inside each selected genome. if multiple types of annotations are provided in the annotation file , only one track per genome can be displayed at a time to avoid overcrowding the display in the current implementation. however, users can easily switch among the tracks or change the colors and shapes of the selected tracks on the fly.

the multiple viewing mode  differs from the pairwise viewing mode in several ways. most importantly, by default conserved genomic regions are shown among all displayed genomes, rather than just between adjacent tracks. the display of the conserved regions between any pair of genomes can be switched on and off, by clicking on the highlighted synteny pairs displayed above the synteny view. any genome can be included or removed from the display, provided that each genome is shown only once. because of the overlapping nature of the conserved region blocks in this view, genome annotations are not shown. the conserved regions in each synteny track have the same color so that overlapping regions can be discerned. all conserved regions can be filtered using a single filter panel above the synteny view.

as mentioned above, mgsv provides two different viewing modes because each method has its own advantages to address specific needs of the user. for example, when many conserved regions are shown, the pairwise viewing mode can appear less crowded. it also allows genome annotations to be shown in each genome block. users have more control over filtering in this mode, since each synteny track can be filtered independently. on the other hand, the multiple viewing mode can show synteny for more genome pairs in the same viewing window, since all pairwise combinations of the on-screen genomes can be visible. an example of preference to this compactness is seen with just a few genomes allowing the user to visualize all the conserved regions in the same screen. because the conserved regions for any pair of genomes can be selectively turned off, even complex patterns may be explored in this mode.

improving the genome display order
by default, mgsv displays the genomes in the same order as they are specified in the user-supplied synteny files. however, such order may not always be optimal, i.e., the display of the conserved regions may be improved if different adjacent genomes are chosen. although users can manually adjust the order, we have developed greedy heuristic algorithms for both the pairwise and multiple viewing modes. the algorithmic details are described in the additional file . although the algorithms do not guarantee to always generate the most optimal orders, they can be used for improving visual clarity by re-arranging the order of the adjacent genomes based on the total size of the conserved genomic regions between each genome pairs. the algorithms involve graph theory and sorting techniques, thus they can be time consuming for datasets with many genomes . if the optimization can be done rapidly , the button “optimize order” will appear in the synteny browser as an option for users to select .

web service for machine-to-machine communication
besides allowing users to manually specify input files to the mgsv web server, we have also implemented a web service to allow machine-to-machine communication so that other programs  may automatically send input data to the mgsv server and obtain the results. the mgsv web service is based on standard soap specification . a standalone server application is implemented in java and runs alongside the mgsv web server as a background process. the web service listens to the port  <dig> for the requests from remote client programs, which make standard xml-soap requests by providing either the synteny and annotation data or urls pointing to the data files. after receiving the data, the web service responds back with a unique id, which can be used to access the visualization results in the mgsv web server. the binary and source files for both the server and client programs are distributed in the mgsv downloadable version with a detailed documentation on their installation and usage. the documentation also includes the mgsv web service protocol specification that is provided as a wsdl file .

utility programs
the mgsv package also provides scripts for converting outputs of blast  <cit>  and blastz  <cit> , as well as gff <dig>  format files into mgsv input files.

additional features
if the user submits an email address, an email will be sent immediately to the user with two urls. one url links to the current mgsv submission, and the other url is the access to all the results associated with that email address obtained in the last sixty days.

RESULTS
the rapid advances of dna sequencing technologies are enabling biologists to generate genomic sequences from a variety of species or strains. analysis of the systemic relationships among those genomic sequences is often important, yet the available synteny visualization tools associated with centralized web databases often do not provide the flexibility for displaying highly individualized data. therefore, we had developed the gsv server that allows users to upload their own genomic data files for visualization. however, gsv software can only display synteny between two selected genomic sequences at a time. often, biologists are interested in comparing more than just two sequences. in this study, we have extended gsv into mgsv.

to our best knowledge, the genome evolution analysis tool  in the coge package is the only other web-based synteny visualization tool that also allows users to upload their own data for analysis in the context of a genome browser. however, there are some fundamental differences between coge and mgsv regarding their designs and implementations. the actual dna sequences, i.e., genomic sequences from several species that users want to compare are required for using the coge server, which identify the conserved genomic regions from the input sequences via the embedded sequence comparison software . although embedding sequence comparison software may facilitate users, we have chosen not to do so in mgsv mainly for three reasons:  sequence comparison among large genomes is not often practical at a web server due to heavy computational demands. such computations are better carried out off-line.  identification of synteny is a complicated research challenge. it is unrealistic for a centralized web server to decide which software or methods users should use for their data set. in addition, desired results may only be obtained by combining different software in a highly customized way.  sequence comparison is not the only means for synteny identification. other types of data  may also provide synteny information. therefore, we have decided to leave the synteny identification to users. instead, mgsv focuses on being a visualization tool to display user-specified conserved regions along with submitted annotations. users can apply any third-party software to generate conserved regions and gather annotation data. this approach leads to greater flexibility and customization of the displayed information.

for biologists who have no programming skills at all, it may be a hurdle to create mgsv-format data files from the outputs of third-party software. however, we have decided not to provide web-based parsers for format conversion for the following reasons:  although converting any third-party software output into mgsv-format is theoretically easy, in practice we may not be able to cater to all the needs of biologists from various backgrounds with their own research interests. for example, when deriving synteny information from blast output files, some users may consider e-value alone, some may prefer bit score, and some may use coverage, while others may consider any combination of these or other attributes available in the blast output. such a decision is highly specific for different researchers and it is not practical for us to develop customized parsers for biologists. in addition, there are many software programs that biologists may use for producing synteny regions and annotation, so we prefer not to pick and choose a few for the community.  nowadays, biologists who are involved in large-scale genome analysis usually either have some basic programming skills or collaborate with people who have basic programming skills. anyone who has basic programming skills, e.g., collaborators in the local bioinformatics center or computer science department, can easily help biologists reformat any raw outputs produced by other programs into mgsv formats . our sample perl scripts for converting blast output, blastz output, and gff <dig> format data files are meant to be examples to show users how to reformat their data files from other formats.

CONCLUSIONS
bioinformatics tools must be upgraded to accommodate biologists’ increasing needs for analyzing multiple genomes. mgsv is a web-based synteny visualization tool that enhances the original functionalities of gsv by allowing biologists to upload their own datasets and visualize the synteny among multiple genomes simultaneously in a single integrated view. the novel design and the implementation of mgsv provide the research community with an important alternative to currently available tools.

availability and requirements
the mgsv web server can be accessed at http://cas-bioinfo.cas.unt.edu/mgsv. the entire package is also free for local installation as open-sourced software from the web site under the terms of the gnu general public license . mgsv is portable across linux distributions and compatible with php  <dig> . <dig>  and mysql  <dig>  . the mgsv web service requires jdk  <dig>  . mgsv installation has been tested on debian lenny and ubuntu lynx. mgsv can be viewed with firefox  <dig> . <dig>  safari  <dig> , internet explorer  <dig>  and chrome  <dig> .

competing interests
the authors declare that they have no competing interests.

authors' contributions
qd conceived the project. qd, kr, dm and cc contributed most of the design. cc implemented an initial version of the software for the pairwise viewing mode. kr revised and developed the final version for both the pairwise and multiple viewing modes. ag developed the algorithms for optimizing genome order for display. ap developed the web service. qd and dm wrote the manuscript; kr, cc, ag and ap also contributed to the writing. all authors read and approved the final manuscript.

supplementary material
additional file 1
a microsoft word document for describing the detailed algorithms for adjusting the display order of the genomic sequences.

click here for file

 acknowledgements
this work was supported in part by nih grant 1rc2hg005806- <dig> and the research initiative grant at university of north texas awarded to qd. dm was supported in part by a grant to the university of north texas from the howard hughes medical institute through the precollege and undergraduate science education program. ag was supported by the tams research fellowship. we would also like to thank ann price for critical reading of this manuscript.
