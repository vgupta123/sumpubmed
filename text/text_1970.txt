BACKGROUND
complex microbial communities drive the earth's biogeochemical cycles  <cit> . in spite of their importance, the biochemical interactions within these communities are not yet well understood, nor have in silico methodologies for studying them matured. an improved understanding of how natural microbial communities mediate biogeochemical cycles will augment predictions of how these processes respond to disturbances from climate change to anthropogenic chemical deposition. improved understanding may also provide a rational basis for using microbial consortia to produce biofuels and biomaterials from renewable resources  <cit> .

microbial communities described in terms of their environmental chemistry, ecophysiology, and phylogenetic diversity can be used as a foundation to develop, test, and compare in silico tools for analyzing community interactions. the phototrophic microbial mats of octopus and mushroom springs of yellowstone national park  represent an ideal test case due to the extensive available data . these alkaline siliceous hot spring mats  are inhabited predominantly by unicellular cyanobacteria related to synechococcus spp. and filamentous anoxygenic phototrophs  related to chloroflexus and roseiflexus spp. the community also contains sulfate-reducing bacteria  and other prokaryotes sustained by the primary productivity of the photosynthetic bacteria  <cit> .

previous studies of the mat have revealed diel  metabolic variation in various community members, driving shifts in the concentration and fate of dissolved metabolites  <cit> . organic metabolites including glycolate and other acids, along with hydrogen, form the basis for mass and energy exchanges between community members . for example, during the day, the photosynthetic cyanobacteria consume co <dig> and produce o <dig> as a by-product of photosynthesis. high levels of o <dig> relative to co <dig> promote oxygen competition at the ribulose- <dig> -bisphosphate carboxylase/oxygenase  active site, leading to the production of glycolate  <cit> . other community members, including the photoheterotrophic fap, can use glycolate as a carbon and energy source  <cit> . the cyanobacteria can also store excess photosynthate as polyglucose  <cit> . this carbon and energy storage material is fermented at night to organic acids   <cit> . fap can incorporate fermentation products photoheterotrophically  <cit> , while srb appear to oxidize some of these products under anaerobic conditions  <cit> .

molecular level metabolic models were constructed to represent the central metabolism of three functional guilds thought to be important to material and energy flows through this community  <cit> . a guild is a group of species that exploit the same class of environmental resources in a similar manner  <cit> . oxygenic photoautotrophs related to synechococcus spp. were selected to represent the mat's primary source of fixed carbon and nitrogen. fap from the family chloroflexaceae, an important structural component of the mat community, were incorporated as metabolically versatile heterotrophs, capable of capturing light energy as phosphodiester bonds , but requiring externally supplied reducing equivalents. an srb guild was included as a consumer of the metabolites produced by photosynthetic guilds. other sub-dominant organisms  present in the mat  <cit>  were not included in this first in silico representation of the system .

metabolic networks were studied using the stoichiometry-based network analysis approach known as elementary mode analysis   <cit> . ema evaluates a metabolic network by decomposing the system into a complete set of the simplest biochemical pathways satisfying steady state conservation constraints with enzymatic fluxes occurring in physiologically reasonable directions . these explicitly defined pathways are known as elementary modes and are frequently represented as vectors containing relative rates for every reaction in the metabolic network. the approach permits the description of any sustainable physiological behavior as a linear combination of the simplest biologically meaningful metabolic pathways  <cit> .

metabolic network modeling methodologies have been used extensively to analyze single organisms and monoculture systems . an alternative stoichiometry-based technique, flux balance analysis, has been applied to a two-species laboratory microbial system  <cit> . that study used a compartmentalized approach analogous to strategies for modeling metabolic fluxes between organelles in eukaryotic organisms  <cit> . topological approaches to metabolic network analysis have also been used at tree of life scales to analyze evolution of metabolism and the interactions of metabolic networks among species and with the environment  <cit> . however, these solely topological studies implicitly assume all genome encoded genes are simultaneously active with no consideration of critical reaction quantitative aspects like carbon and electron conservation relationships.

in the present study, novel methods for handling multispecies ema are developed and applied to a microbial consortium representing a well-studied thermophilic community from yellowstone national park . to the best knowledge of the authors, this is the first time a stoichiometry-based network analysis approach has been applied to a natural, in situ microbial community and the first time these approaches have been used to analyze microbial biofilms/mats. mass and energy fluxes were investigated using three different approaches each representing different levels of detail and computational complexity. the three approaches provide a general set of tools for studying microbial communities that can be selected based on the levels of available knowledge and community complexity. each approach has advantages and disadvantages which are discussed along with examples illustrating how these methods can be used to gain insight into basic community metabolic processes. in particular, our work demonstrates a trade-off between knowledge of the distribution of metabolic capabilities between guilds in a consortium and the ability to conservatively predict and interpret limits for that community's behavior.

RESULTS
development and implementation of three consortium analysis approaches
the primary aim of this theoretical study was to develop, analyze, and compare different in silico approaches for molecular-level analyses of mass and energy flux through a microbial community. the following section details three distinct approaches, using the yellowstone thermophilic phototrophic mat system as a test case. advantages and disadvantages of each technique are highlighted and discussions detailing which approach is most appropriate for a given set of microbial data are provided. for each of the three methodologies discussed, both day and night scenarios were considered . all metabolic models, including an explicit listing of the reactions and metabolites, can be found in the additional file 1: supplement.

compartmentalized consortium analysis approach
a compartmentalized model was constructed in which each of the three guilds was a distinct compartment and exchangeable metabolites were transferred through a fourth compartment representing the extracellular environment . this strategy has been used in the past for spatially and chemically segregated eukaryotic and microbial systems  <cit> . the approach was implemented by assigning reactions and metabolites to a network representing each guild , while explicit transport reactions accounted for the exchange of metabolites between guild members and the extracellular space. a short illustration of the separation mechanism is provided in additional file 1: supplement.

the compartmentalized modeling approach has the advantage of conceptual tractability. dividing the community into guild-level compartments linked by transferred metabolites  is an intuitive way to represent interactions within a consortium. it is also an ideal method for understanding which guild performs a particular metabolic transformation. for example, the fraction of total biomass  or total maintenance atp  produced by each guild is clear from the output.

one drawback to the compartmentalized approach is the sheer quantity of unique interactions possible. the size of the resulting network can lead to a 'combinatorial explosion' of elementary modes  <cit> . to address this limitation, the models for each guild member were constructed to capture the necessary metabolic capabilities while maintaining computational tractability . a second drawback of the compartmentalized method is the requirement for significant a priori information or assumptions, as enzymes must be assigned to each separate guild. the octopus and mushroom spring phototrophic mats are well-studied, permitting the use of compartmentalized results as a benchmark for the other two methodologies.

pooled reactions consortium analysis approach
the second approach, referred to as the pooled reactions consortium analysis, treated the consortium as a single entity . all metabolic reactions and metabolites from the three guilds were combined into a single compartment. reactions catalyzed by more than one guild were only considered once. the method captures the metabolic constraints of the overall matter and energy transformations without the need for detailed knowledge of every organism in the community.

the pooled reactions approach is ideally suited for investigating the metabolic potential of a community based solely on metagenomic data because the assignment of each reaction to a constituent guild is unnecessary. the technique is quite flexible and can be scaled to different levels of detail. an additional advantage of the pooled reactions approach is the reduction of computational burden. with these advantages, the method is uniquely suited for initial and exploratory analyses of diverse or poorly understood communities. for scientists accustomed to well-documented laboratory microbes, this approach may seem coarse however, the vast majority of organisms on the planet have not been cultured in the laboratory, much less isolated to purity  <cit> . this method represents a flexible starting point for analyzing such systems.

a weakness in the pooled reactions approach is that model output does not specify which guilds employ a particular enzyme or produce biomass and maintenance atp. instead, the results describe potential performance of the entire consortium. the method also neglects the logistics associated with transferring metabolites between organisms, including conversion of the given metabolite into one for which transporters are available. the approach is presented here using the well characterized cyanobacterial mats to highlight strengths and drawbacks to the method.

nested pathway consortium analysis approach
the third approach, termed the nested consortium analysis or ema 'squared', uses successive rounds of ema to analyze potential interactions within a consortium . the first round of ema is applied to each guild model in isolation. the output data are mined for ecologically relevant elementary modes, such as efficient biomass production from sunlight or efficient atp generation from lactate and sulfate. the selected elementary modes are then compiled and used as input reactions for a second round of ema to examine the potential for interactions between guilds. conceptually, the first round of ema provides guild-level stoichiometries relating substrates to products. these stoichiometries can be further processed in the same way that traditional ema uses enzymatic stoichiometries to consider inter- and intraguild interactions. an example of the process is provided in additional file 1: supplement.

the first round model output was explored for metabolic strategies representing 'selfish' and 'altruistic' operation of each guild. selfish selection criteria were based on the efficient production of biomass and maintenance atp. altruistic selection criteria were based on efficient production of metabolites that could be consumed by other guilds, including for instance h <dig>  nh <dig>  acetate, and glycolate. efficiency was evaluated by normalizing the amount of production by the required input . a list of the ecological criteria considered can be found in additional file 1: supplement.

stable numerical implementation of the nested approach using cellnetanalyzer v  <dig>  required some heuristics. elementary modes from the first round of analysis were normalized to vectors of unit length prior to the second round of ema; without this step, errors occurred during calculation of elementary modes; specifically, the attempted inversion of matrices that are very nearly singular. normalized coefficients were rounded to two decimal places to prevent similar problems. when rounding converted an otherwise non-zero coefficient to zero, the entire elementary mode was scaled so the smallest coefficient was equal to  <dig> . the matlab script used for normalizing and rounding intermediate results is provided in additional file 1: supplement. this step was necessary although it introduced a modicum of error. error analysis is included in the following sections. these steps are not necessary if ema is performed using the new bit pattern tree algorithm which is numerically more stable  <cit> .

the nested pathway approach allows for the analysis of more complex metabolic networks and larger communities than the compartmentalized approach because each guild is initially considered separately. it also has the advantage of retaining guild-specific output lost in the pooled technique. the manual selection of specific modes permits a guided community analysis based on ecological strategies of interest for each guild; results can then be re-examined in light of the selection criteria used, relating community stoichiometry and guild strategy. the ability to assemble multiple sets of first-round output and concatenate the results allows the system to expand freely. the nested approach is unrelated to the decomposition approach for the analysis of large cellular networks with ema  <cit> , but is well-suited for reconnecting the output of the resulting subnetworks tractably.

the nested pathway analysis approach has the disadvantage of requiring two rounds of processing. in addition, manual selection of ecologically interesting modes from individual models requires a priori knowledge and can significantly influence the solution space. finally, intermediate processing introduces some rounding error.

comparison of consortium analysis approaches
two test cases were analyzed to compare the three approaches in terms of their ability to describe and explain the flows of carbon, nitrogen, and energy through the mat community. the first case study considered daylight production of biomass fueled by solar energy, while the second case study considered the fermentation of stored polyglucose to drive nitrogen fixation during the night. table  <dig> highlights key model outputs associated with the different daytime simulations, including the number of modes identified as well as important parameters like maximum yield of biomass or maintenance atp per photosynthetically-available photon. table  <dig> shows similar results for the nighttime simulations.

n/a = not applicable.

a 'yi/j' is the yield of i on j . 'x' represents cmoles of biomass and 'hv' denotes moles of photosynthetically-available photons.

b 'atp' represents moles of atp available for cellular maintenance.

c 'syn' designates a parameter associated with the synechococcus guild. 'fap' indicates a parameter associated with the filamentous anoxygenic phototroph guild and 'srb' denotes a parameter associated with sulfate-reducing bacteria guild.

d 'phb' represents cmoles of polyhydroxybutyrate .

n/a = not applicable.

a 'yi/j' is the yield of i on j . 'cypc' denotes moles of nitrogen fixed and stored as cyanophycin, while 'pg' represents cmoles of polyglucose.

b 'so4' represents moles of sulfate used as an oxidant.

c 'x' represents cmoles of biomass.

d 'atp' represents moles of atp available for cellular maintenance.

e 'syn' designates a parameter associated with the synechococcus guild. 'fap' indicates a parameter associated with the filamentous anoxygenic phototroph guild and 'srb' denotes a parameter associated with sulfate-reducing bacteria guild.

case one: consortium photo-efficiency
the relationship between solar energy input and community productivity is a fundamental subject of ecological inquiry, as is the relative abundance of various species. the model community is an example of how metabolic knowledge feeds into these questions, providing a natural point for comparison of the three methods. oxygenic photosynthesis drives primary productivity in the community by splitting water into reducing equivalents and o <dig>  the reducing equivalents can be used to fix co <dig> via the calvin-benson-bassham cycle. the o <dig>  however, can compete with co <dig> for the rubisco active site, resulting in the production of glycolate instead of an additional cmole of reduced carbon . a cmole is a mole of carbon atoms; one mole of glucose  is equivalent to six cmoles of glucose.   

experimental characterization of these fluxes from the octopus and mushroom spring microbial mats has been reported. the o2/co <dig> flux ratio at the rubisco active site is estimated to be approximately  <dig> - <dig>  when dissolved gas concentrations represent mid-afternoon conditions at the springs  <cit> . the derivation of these estimates from the reported data is demonstrated in additional file 1: supplement.

the output from the three in silico community analysis approaches was plotted using two physiological variables thought to be important to community interactions: 1) o <dig> competition at the rubisco enzyme  and 2) the quantity of biomass  synthesized per mole of absorbed photons . relationships between these properties are examined below as a vehicle for comparison of the three modeling approaches.

compartmentalized consortium analysis
the compartmentalized approach, wherein guilds interact through a mass-balanced external compartment , served as a basis for comparison of the community modeling techniques. this method revealed only two elementary modes  producing cyanobacterial biomass. these modes, highlighted with arrows in figure 3a, differ based on atp production strategy. the higher-yielding elementary mode generated atp by oxidizing reducing equivalents from non-cyclic photophosphorylation, while the lower-yielding elementary mode produced atp through cyclic photophosphorylation.

all other biomass-producing elementary modes generated fap, srb, or a combination of fap and srb biomass. at low levels of o <dig> competition at the rubisco enzyme, figure 3a illustrates that optimal fap and srb biomass synthesis efficiency increases with oxygen competition . this is due to an increase in glycolate production, shuttling electrons either directly or indirectly to the other guilds. the trend continues until a rubisco o2/co <dig> flux ratio near  <dig>  is reached. at o <dig> competition levels greater than about  <dig> , o <dig> interferes with the efficient photon-based production of cellular carbon .

theoretical ecological studies have suggested that organisms adapted to a biofilm or mat lifestyle will draw on available resources in a manner which maximizes yields and thus favors the whole community  <cit> . combining this theory with the experimentally determined o2/co <dig> competition at the rubisco enzyme made it possible to predict relative yields of the cyanobacteria and fap. two different cases were considered. the first case  examined the ramifications of each guild striving to maximize its own biomass yield and the second case  examined different guilds working in concert to maximize biomass for the entire consortium .

cellular metabolism can be expressed accurately as a linear combination of distinct elementary modes  <cit> . it is hypothesized that a consortium's metabolic activity can also be described using linear combinations of the elementary modes . when exactly two elementary modes are considered, the contribution of each mode to the overall metabolic process  is fixed by the ratio of any two fluxes for which the constituent modes have non-identical ratios. that relationship is demonstrated in additional file 1: supplement. for each considered case, a combined metabolism was identified using the ratio of fluxes through rubisco  derived from experimental data  <cit> . the derived values were used to bound the solution space .

this relationship was applied to the highest-yielding biomass-producing modes from the compartmentalized model to predict the relative abundance of cyanobacteria and fap for a fixed photon input budget . modes producing srb biomass could easily be combined in the same way, but were not among the highest-yielding strategies. the scenario normalized biomass to a per photon basis. the case i scenario predicts ratios of cyanobacteria to fap biomass production ranging from  <dig> : <dig> to  <dig> : <dig>  based on the experimentally determined oxygen competition at the rubisco enzyme. the case ii scenario predicts ratios from  <dig> : <dig> to  <dig> : <dig> on the same basis. the numerical procedure is demonstrated in additional file 1: supplement. the analysis control volume consists of the top  <dig> mm of mat. the control volume growth is exactly equal to the rate at which biomass leaves the control volume. physically speaking, this represents the new growth burying the old growth.

the ratio of cyanobacterial to fap biovolume in a mushroom spring mat sample was experimentally measured to be  <dig> : <dig>  <cit> . it is assumed here that biomass and biovolume are related in the same manner for both species. the relative abundances of metagenomic reads suggest biomass ratios for these guilds between about  <dig> : <dig> and  <dig> : <dig> in the top  <dig> mm of octopus and mushroom spring mats, assuming no bias in the sampling and sequencing pipeline . the reported ratios are closer to the modeled scenario where each individual guild seeks to maximize its own biomass yields rather than the scenario optimizing biomass yield of the entire consortium. a potential explanation for the modest discrepancy between prediction and experimental data is the experimental underestimation of glycolate production due to consumption of radiolabeled photosynthate during incubation. increasing the flux ratio  at rubisco  drives the solution space for the case i scenario into stronger agreement with experimental values much more quickly than for the case ii scenario. it should also be noted that in situ environmental systems vary considerably in both space and time, and the flux ratios were derived from measurements at a single condition.

pooled reactions consortium analysis
the same variables were plotted for elementary modes identified with the pooled technique, wherein all reactions and metabolites were combined into a single metabolic unit . the predicted maximum community biomass efficiency was  <dig> % higher for the pooled approach than the compartmentalized approach. the cyanobacteria  do not possess a full citric acid cycle; with the pooled treatment, however, the entire cycle becomes available, efficiently catabolizing photosynthate without the usual logistical costs of metabolite transport between guilds. the genome of rs- <dig>  a fap isolated from a hot spring microbial mat, appears to code for the enzyme missing from os-a and os-b', sequenced cyanobacteria from octopus spring.

contrary to the compartmentalized approach, the pooled output suggests that oxygen competition at the rubisco active site does not necessarily affect the biomass yield per photon . this represents an uncoupling of heterotrophy and photorespiration, neglecting the role of glycolate as a transfer metabolite. these seemingly contradictory elementary modes all utilized the srb-associated reductive acetyl-coa co <dig> fixation pathway, and are striped gray in figure 3b. this pathway is metabolically inexpensive in the pooled approach due to the direct availability of reducing equivalents derived from oxygenic photosynthesis. these enzymes are generally very sensitive to o <dig>  <cit> , calling the feasibility of these particular elementary modes into question. srb activity has been reported in the upper  <dig>  cm of the mat during day  <cit> , but the activity may be limited to small anoxic microenvironments and is unlikely to represent a major daytime co <dig> fixation strategy.

filtering out elementary modes using the reductive acetyl-coa pathway leaves a trend of decreasing optimal biomass per photon yields with increasing o2/co <dig> flux ratios at the rubisco enzyme. the trend appears very similar to case ii from the compartmentalized analysis as a result of the pooled approach's treatment of biomass. a non-guild-specific biomass term means that maximizing the yield optimizes production of biomass for the consortium as a whole, the same criteria used to generate the case ii scenario.

this analysis highlights potential challenges associated with the pooled community approach. first, pooled reactions can result in higher predicted yields than compartmentalized reactions because there are no logistical costs associated with inter-guild metabolite transfer. the second challenge is the combination of enzymatic activities that are not compatible. the use of oxygenic photosynthesis to drive extremely oxygen-sensitive enzymes, for instance, seems unreasonable. the pooled analysis generates more appropriate trends if a priori information regarding the oxygen sensitivity of the reductive acetyl-coa enzymes is applied as a filter. in addition, because enzymatic activities are shared rather than apportioned between individual guilds, maximizing any yield does so for the entire consortium rather than a single guild. this approach is well suited for initial work on systems lacking sufficient a priori data to construct a compartmentalized model. the fact that such data is lacking for the vast majority of all natural ecosystems emphasizes the usefulness of this approach.

nested consortium analysis
the nested approach produces similar results to the compartmentalized method. while this may not be readily apparent from a cursory comparison of figures 3a and 3c, connecting the extreme upper-left and upper-right points on each subfigure shows that the limits of the solution space  are quite comparable, although the nested approach identifies fewer suboptimal solutions. the biomass yield on photons decreases with increasing o2/co <dig> flux ratios at the rubisco enzyme. the initial increasing trend seen in the compartmentalized model consisted of suboptimal solutions not identified as ecologically relevant in the first-round processing. those metabolic behaviors are all outperformed by linear combinations denoted by the case i line in figure 1a. the optimal biomass yield on photons is equivalent  to the compartmentalized prediction. combination of modes, as in the case i compartmentalized scenario, identifies very similar ratios of biomass productivity for cyanobacteria to fap  at the o2/co <dig> flux ratios of  <dig> - <dig>  suggested by experiment . the total number of elementary modes is lower than the compartmentalized approach  because the initial round of ema selects only strategies deemed ecologically competitive or relevant. the first round of processing removes many mathematical solutions that are not necessarily of interest for additional analysis. caution is required; neglect during first-round selection can prevent discovery of interactions or cause underestimations of metabolic potential.

any system characterized well enough to construct a compartmentalized model can also be analyzed using the nested approach. the approach is best suited for complex systems that prove computationally difficult to analyze using a compartmentalized simulation. in addition, the nested community analysis approach facilitates interrogation of the competitive strategies employed by individual guilds to produce a compartmentalized modeling result. for instance, the experimentally relevant case i results shown in figure 3a  require the fap guild to maximize biomass yield  for the strictly heterotrophic co-metabolism of glycolate and acetate. the cyanobacterial guild must concurrently operate a metabolism comprised of three distinct elementary modes: the highest yielding strategies for biomass, glycolate, and acetate production all based on photons. this information is embedded in the criteria used to select the first-round elementary modes.

the nested community analysis approach requires the elementary mode coefficients to be normalized and rounded. error analysis was performed to gauge the effect of this processing on the results. each mode was examined for the error in carbon fixed and the amount of absorbed energy. the maximum error introduced was  <dig>  cmoles per mole of photons. the complete error results from both case studies are included in additional file 1: supplement.

case two: nitrogen fixation
nitrogen fixation fueled by the fermentation of polyglucose is thought to be an important process in the mat during night and early morning  <cit> . the presented models only consider nitrogen fixation at night, since the oxygen sensitivity of nitrogenase should render it inoperable during the day when the mat is superoxic. future modeling efforts will consider the morning separately, acknowledging evidence that suggests a large fraction of nitrogen fixation in situ occurs after sunrise but before o <dig> production exceeds consumption  <cit> .

the second case study examined the efficiency of n <dig> reduction with polyglucose and the corresponding production of five potentially inhibitory or toxic fermentation by-products: formate, acetate, ethanol, lactate, and propionate. their toxicities have not been explicitly characterized in this system, but their total molar yield on polyglucose represents a convenient 'toxicity parameter' for comparison of modeling approaches. it should be noted, however, that nitrogen fixation and the incidental production and fate of fermentation products are separately questions of ecological interest.

the fap guild was included in the night-time simulations. they were inactive however, because unlike the srb, they are incapable of drawing on sulfate as an electron acceptor. while the fap guild can jettison electrons as hydrogen, this requires energy input from light or an alternative oxidant .

the pooled results in figure 4b demonstrate the effects of neglecting constraints on the exchange of metabolites between guilds. the results suggest, in contrast to predictions by the other two models, that nitrogen fixation at night is possible without associated production of potentially inhibitory or toxic fermentation products . similar to the photo-efficiency test case, the pooled analysis provides a less conservative solution space than the other approaches. less information is required to build the pooled model, but predicted yields have to be viewed as theoretical upper limits, with the actual consortium probably operating at lower yields. the approach offers a rational, constraint-based approximation to the metabolic potential of a poorly characterized microbial consortium.

the night nested results have nitrogen-fixing efficiencies similar to the compartmentalized approach. the similarity of the shape and size of the solution spaces between nested and compartmentalized techniques  indicates that modes of interest were selected appropriately during first-round processing. considering the corresponding first-round criteria allows mapping of results into ecological strategies for individual guilds. for example, in the elementary mode resulting in the highest yield of fixed nitrogen on polyglucose, the cyanobacteria guild uses two strategies, maximizing production of free nh <dig> and cyanophycin and co-producing acetate, formate, and ethanol. three distinct srb physiologies are employed, maximizing biomass production on each fermentation product individually. error analysis on the night nested model was performed by comparing error in the carbon balance with polyglucose consumption for every mode. the largest error due to rounding was a reasonable  <dig>  cmoles for every cmole of polyglucose consumed. the complete error results from both case studies are included in additional file 1: supplement.

consortium food web robustness analysis
the compartmentalized consortium analysis approach was used to explore additional community properties. metabolic networks within individual cells are highly branched, forming robust and decidedly redundant systems thought to be resilient to perturbations and disruptions  <cit> . figure  <dig> details how the  <dig>  unique daytime elementary modes can be divided into  <dig> different inter-guild mass and energy exchanges. interactions associated with a large number of elementary modes are more likely to remain functional during environmental perturbations  <cit> .

discussion
three in silico consortium analysis methods were developed and applied to a thermophilic phototrophic mat community from yellowstone national park as a test case. the results of this systems ecology study demonstrate the applicability of consortium ema, explicitly mapping the genes-to-function emergent properties associated with the connectivity of metabolic reactions via the exchange of mass and energy. since the presented techniques are culture-independent, they are compatible with metagenomic approaches and other studies in which culturing or isolation has proven difficult. this study provides a foundation for further work to refine and test the models using co-culture studies; potential inquiries include the measurement of substrate uptake and growth rates, biomass compositions, mrna and protein expression, and quantification of internal fluxes. toxicity profiles of the various fermentation products to representative microbes would also be of interest. representative organisms or enrichment cultures are available for each guild, and the results of such experimentation will be quite useful for model validation and improvement. that work, however, is beyond the scope of the current study, which seeks only to provide methods for the extension of ema to microbial consortia.

an alternative approach to the mass-balance-based analysis of large networks, flux balance analysis <cit> , has been applied to genome-scale metabolic networks <cit> , which is currently not possible with ema  <cit> . flux balance analysis has been used to investigate central carbon and energy metabolism of a two species consortium  <cit> . flux balance analysis could likely be applied to the presented model system and could be used to ask similar questions. the output, however, would be a single flux distribution denoting an optimal use of the network as defined by an objective function, rather than a generating set for all flux distributions allowed by the network . as the choice of an appropriate objective function is not always clear prior to extensive experimentation  <cit> , a generating set is useful for exploratory modeling. the utility of a generating set for explanatory modeling has also been recently demonstrated  <cit> . these benefits justify the development of methods for the application of ema to multispecies systems alongside large-scale network methods. it is worth considering how the methods developed here will be affected by larger network sizes. this is important because potential applications include more diversified communities and more complex cellular metabolisms. systems cast as compartmentalized models which prove to be too computationally heavy for current ema algorithms can be analyzed using the nested approach.

the compartmentalized community analysis method has the advantage of intuitive tractability and separates activity and function by guild, but requires substantially more knowledge of the community than the pooled reactions approach. tables  <dig> and  <dig> illustrate how the energy added to electrons during oxygenic photosynthesis is dissipated with the movement of mass and energy through the consortium. the cyanobacteria exhibit a predicted maximum biomass yield of  <dig>  cmoles for each mole of photons absorbed by the mat. this value is  <dig>  for the fap guild, with the difference providing a rough measure of the cost of transferring reducing equivalents between guilds. the srb also rely on the by-products of the primary producer guilds for electrons, but are further constrained by an inability to derive energy from light or respiration on o <dig>  the highest srb biomass yield predicted by the daytime compartmentalized model is  <dig>  cmoles per absorbed mole of photons, slightly more than one tenth of the cyanobacterial yield. the ratio between theoretical optima for photosynthetic and srb biomass yields is similar to observed ratios between primary producers and the secondary productivity of consumers in macroscale ecological systems  <cit> .

the compartmentalized method also lends itself uniquely to investigation of the robustness of specific consortium interaction types . investigating interactions in the model showed that the fap are central to the metabolic capabilities of the consortium as a whole; fap involvement was required for the vast majority  of elementary modes. finally, the highest-yielding biomass-producing modes from the compartmentalized approach were combined to show that experimental data supports strategies optimizing productivity by individual guilds more strongly than strategies optimizing productivity for the entire consortium .

the pooled reactions consortium analysis method modeled community metabolic potential by treating all enzymatic activities and metabolites as residents of the same physical space, without membrane boundaries. the pooled reactions approach represents the coarsest-scale methodology, requires the least a priori information, and is easier to implement than alternative approaches. the pooled approach can often be used when other approaches cannot  or should not . these advantages are balanced against a tendency to overestimate the metabolic potential. this is unsurprising, as real communities are not super-organisms; individuals are membrane-separated and must contend with the logistics associated with matter and energy transport. the pooled technique is best for initial work on 'poorly' characterized systems. the vast majority of ecosystems are not characterized to a level permitting a compartmentalized analysis, suggesting the pooled approach will be relevant for a long time to come.

finally, the nested community analysis has properties very similar to the compartmentalized approach, but with the important advantage of easy scalability, achieved by concatenating multiple rounds of ema analysis. the approach also provides additional ecological insight into the competitive strategies underlying each guild's function. this information is contained within the criteria used to select first-round building blocks. the nested method also easily captures interactions between different guilds as well as between members of the same guild expressing different physiologies. for instance, different cyanobacterial elementary modes can combine, representing exchange of metabolites between cyanobacteria expressing different metabolic activity due to differing positions across spatial gradients of light, temperature, and concentration. this type of exchange appears to be very relevant to actual mat function, as other work suggests the presence of functionally distinct synechococcus populations that are adapted to particular microenvironments  <cit> . as with the compartmentalized approach, the daylight case study found that optimal guild strategies were more strongly supported by experimental data than optimal consortium strategies.

combinations of the pooled and compartmentalized methods can be used to provide information not easily obtainable with any single approach. as an ecologically relevant example, a cost-benefit relationship was quantified for a complete citric acid cycle in the cyanobacterial guild, as opposed to the incomplete cycle indicated by the genomic sequence of relevant isolates. synechococcus spp. os-a and os-b' genomes do not contain the oxaloacetate-producing malate dehydrogenase. the pooled reactions modeling approach identified a cluster of optimal elementary modes using a primarily cyanobacterial metabolism along with the missing citric acid cycle enzyme, which is fap-derived. the biomass yields in this cluster are a  <dig> % improvement relative to purely cyanobacterial metabolic potential, given by the compartmentalized methodology. this is a large difference in yields and laboratory evolution experiments have shown that much smaller differences  are selectable under competitive conditions  <cit> . these hot spring mat communities are thought to be modern derivatives of ancient prokaryotic communities, and the long history of cyanobacterial and fap cohabitation suggests the potential for horizontal gene transfer. evidence for actual horizontal gene transfer events between cyanobacteria and fap has been published elsewhere  <cit> . the cyanobacteria in our study have not acquired and passed on the missing krebs cycle gene, suggesting that the costs of production, maintenance, and regulation for malate dehydrogenase are unlikely to be offset by the benefit of a  <dig> % improvement in biomass yield.

CONCLUSIONS
each of the three in silico modeling approaches developed in this study provides a mathematical description of physical constraints on metabolic activity in a consortium. these techniques allow the extension of ema to ecologically relevant multi-species, biofilm systems. their contrasting strengths can be combined to arrive at a more holistic description than is possible with any of the methods alone, allowing a broad perspective from which to frame observations and base predictions. these approaches can be adapted to a wide range of microbial communities including both natural and anthropogenic systems. potential applications include modeling communities involved in wastewater treatment, bioprocess engineering, and environmental remediation, as well as the study of host-pathogen interactions in medicine and symbiotic relationships such as nitrogen-fixing root communities.

