BACKGROUND
the important role of kinases in cancer biology  <cit>  has spurred a considerable effort towards the synthesis of libraries of fully profiled kinase inhibitors, providing a map of the strength of each compound on a large number of its potential targets  <cit> . in particular, a recently published dataset has profiled several hundred kinase inhibitors using a panel of more than  <dig> kinases  <cit> . these profiled libraries define a network of interactions between drugs and their kinase targets  <cit> , and represent a valuable resource for the development of new therapies. in this paper, we introduce a novel computational method that incorporates profiled libraries and in vitro measurements to predict the response of cells to previously untested drugs. besides making prediction about the cellular response to drugs, the method identifies critical kinase targets and pathways that are statistically associated to drug sensitivity in a given cell line.

statistical inference and regression methods in conjunction with gene expression or mutations have been used to identify specific biomarkers associated with an increased sensitivity/resistance to drugs. for instance, the sensitivity to parp inhibitors of ewing’s sarcoma cells with mutations in the ews gene and to mek inhibitors in nras-mutant cell lines with ahr expression have been predicted using analysis of variance and the elastic net method  <cit>  and then experimentally validated  <cit> . in these analyses, the statistical variable associated to drugs was represented by the half maximal inhibitory concentration  in different cell lines. however, besides the ic <dig>  there are many other types of information that characterize chemical compounds. these types of information can enhance the statistical analyses and improve the accuracy of predictions. for instance, a method to predict drugs sensitivity in cell lines based on the integration of genomic data with molecular physico-chemical descriptors of the drugs has been recently proposed  <cit> . another useful type of information is the residual activity of kinases after interacting with a compound. kinase profiling, patient genetic profiles, and sensitivity of primary leukemia patient samples to kinase inhibitors were recently used by tyner et al. <cit>  to identify functionally important kinase targets and clarify kinase pathway dependence in cancer.

in this paper, the residual activity of kinases upon drug interaction is used to make predictions of the cellular response for in vitro experiments using an elastic net  <cit>  regression approach. this regression method reduces the number of predictors to a minimum set, providing a clear picture of the kinases involved in the response of cell lines. a primary screen  and a secondary screen  are used as the training set for the regression. the two-drug screening exhibits a broader distribution in the response and provides a good level of predictability. in fact, the model based only on single drug response did not pass the statistical cross-validation test.

we are applying this kinase inhibitor elastic net  method to predict cell viability of a lung cancer cell line  and a normal fibroblast cell line  after drug treatment. we found that the regression can be improved through a logarithmic transformation on the data. using the results of the regression, we identified a set of kinases that are strongly associated to a selective response of a <dig> and not imr- <dig>  then, a pathway-based enrichment using reactome  <cit>  revealed ten significant pathways using this set of kinases, including axonal guidance and related semaphorin interactions as top hits.

this paper is organized as follows: section in vitro screen of the kinase inhibitor library contains the experimental results of the primary and secondary in vitro screening corresponding to single drugs and two-drug combinations. these experimental results and residual kinase activity are analyzed with pearson’s correlation in section analysis of correlations. this simple correlation analysis gives a first glance of the kinases that are statistically associated to a significant change in the viability of cancer and normal cell lines. in section elastic net regression, we introduce the elastic net approach and we present the results of a leave-one-out cross validation for predictions on single and pairs of drugs. we also present in this section the results obtained using the logarithmic transformation on the variables and a pathway enrichment analysis using reactome  <cit> . the discussion of the results is in section discussion, conclusions in section conclusions, and materials and methods in section materials and methods.

RESULTS
in vitro screen of the kinase inhibitor library
our methodology begins with the high-throughput screening of single drug and drug pair experiments. the  <dig> kinase inhibitors  of the emd drug library were screened at  <dig> nm individually and the treatment lasted for  <dig> hours. to quantify a selective response of a cancer cell line with respect to a control normal cell line, we define the selectivity s of a single drug or drug combination as

 s=vnvc 

where v
n
 indicates the viability of normal cells  after treatment, and v
c
 the viability of cancer cells  after treatment. from the screening of the  <dig> kis, the top hit was pdk1/akt1/flt <dig> dual pathway inhibitor  as ranked by selectivity . for the secondary screen, we used the pdk1/akt1/flt <dig> dual pathway inhibitor as the starting point and combined this compound with the other kis as a drug pair combination. the dose of pdk1/akt1/flt <dig> dual pathway inhibitor was studied to ensure proper dosing range and minimize toxicity. we used  <dig> nm, which maintains the normal cell line imr-90’s viability >90% . for the other  <dig> kis we used the standard dose of  <dig> nm. several pairs in the secondary screen showed very high selectivity. the top hit from the secondary screen of the library was alsterpaullone 2-cyanoethyl  with a selectivity of s =  <dig>  for the pair .

analysis of correlations
in our second step, we analyzed the pearson’s correlation of the primary and secondary screening with a published dataset  <cit>  containing target profiles for  <dig> kinase inhibitors. therefore, even though we had a library of  <dig> kis in the experimental screening, we were limited to utilizing  <dig> kis for the analysis. for each inhibitor, the dataset provides the residual activity  of  <dig> kinases after drug treatment. this quantity is a measure of the strength of inhibition of a drug on each kinase.

for each kinase k, we calculate the pearson’s correlation, c
k
, between the selectivity s
i
  and the activities a
k, i
, with i ∈ { <dig>  …, m} indicating the single drug or drug pair in the set. for drug pairs, the activity is estimated as a product of the residual activities of the two drugs. the kinases are then ranked based on the p-value of their correlation with selectivity, and we calculate the false discovery rate  adjusted p value  <cit> . the list of kinases mostly correlated to the selectivity from the primary and secondary screen are listed in table  <dig>  we also did calculations of the correlation between the normal or cancer cell viability and the activities. the results for the top kinase-viability correlations for the primary and secondary screen are shown in the supplementary materials .

a negative correlation indicates that inhibition of that particular kinases is associated to a higher selectivity. the top two hits with negative correlation, tgfbr <dig> and cdk <dig> are known to have an important role in cell proliferation, invasion and metastasis in lung adenocarcinoma  <cit> .

elastic net regression
next, we build a regression model that predicts the response of a cell line to a drug or drug combination i. the response we predict is the normal and cancer cell viability, from which the selectivity can be derived. for this purpose, we define a regression problem in which we use the residual activity of the kinase k under the effect of drug i, which we indicate as a
k, i
, as predictors of the viability. the response can be written as

  vi=β0+β1a <dig> i+…+βpap,i. 

a fitting procedure based on a training set of measurements produces the coefficients . equation  can then be used to predict the viability of a new drug that has not been tested, but of which the profiling information is available. note that we are integrating two different types of data: kinase profiling data is obtained through enzymatic assays that probe directly the interaction between drug and kinases, while the in vitro cell response data is the result of complex signaling that involves many pathways downstream of the affected kinases. the coefficients β
k
 can be seen as a measure of the sensitivity of a given cell line due to alterations in the activity of kinase k.

it is well known that the least square method does not perform well in the case of linear regression with many predictors. in our case, we would like to use a database of drugs that have been profiled on about  <dig> kinases. however, it would be desirable to select and keep in the final model a minimal set of the kinases that provide a simple model, useful to gain biological insight. the lasso technique  <cit>  is a powerful method to reduce the number of predictors by imposing a penalty on the regression coefficients. however, in the presence of a group of kinase predictors with strong mutual correlation, the lasso could select only one kinase predictor from the group while missing the others. to prevent this problem, our method uses the elastic net approach. this method incorporates the lasso penalty as well as a ridge penalty to keep the regression coefficients small without completely removing them  <cit> . the weights of the ridge and lasso penalties in the least square procedure can be optimized for best performance of the method.

we show in figure  <dig> and  the results of a leave one out cross validation  method for the primary  and secondary screen . for each of the  <dig> drugs, we apply the elastic net method using the remaining  <dig> drugs and then we compare the result to the measured value. this cross validation method is a particular case of the more general k-fold cross validation procedure in which k is equal to the size of the training set  <cit> . the cross loocv shows that the information contained in the primary screen is not sufficient to define a predictive model. the fact that some kinases in table  <dig> show some significant correlation with the response when considered individually is in general not a sufficient condition for defining a predictive, multiple regression model. on the other hand, the secondary screen is able to reproduce the viability of many drugs, especially the ones with the stronger effect on both cell lines. overall, the data from the secondary screen presents a much broader distribution with a tail representing a few drug combinations particularly effective. the regression works better in identifying these highly effective pairwise combinations and the relative ranking of their strengths. data is not particularly informative for drugs and drug pair combinations that are not effective, which concentrate in the neighborhood of ~  <dig> 

data transformations can represent a powerful strategy to improve regression. we applied a logarithmic transformation, which is consistent with the hypothesis of an independent action on the different kinases on the total viability. in this case we assume that the viability can be rewritten in the form

  vi=eβ0a <dig> iβ1⋅a <dig> iβ2⋅…⋅ap,iβp. 

by applying a log transformation on both sides of eq.  we reduce the problem to a linear regression, to which the elastic net strategy can be applied. we show in figure  <dig> the results of the loocv for the primary and secondary screen using the logarithmic data transformation. as in the linear case, we find that the method fails the cross validation procedure if we use data from the primary screen, while the secondary screen with log transformed data gives better r
2
.

in addition to a regression model that can be used to predict the efficacy of drugs that have not been tested, the β
i
 coefficients can be used to rank kinases in terms of their relevance in the regression. therefore, these coefficients identify the kinases whose inhibition is associated to a decrease in the cell viability. a ranking based on the differential βic-βin, where the index n and c identify the regression model of the cancer and normal cells, gives insight on specific pathways important for a selective response of cancer cells. table  <dig> shows a list of kinases ranked in terms of βic-βin, where the coefficients have been obtained using the logarithmic data transformation on the secondary screen.

a larger difference is associated with a selective response of a <dig> upon inhibition. note that in addition to tgfb2r and cdk <dig>  which were identified with the correlation approach of table  <dig>  additional kinases known to have an important role in lung cancer such as egfr  <cit>  and phkg <dig>  <cit>  are found using the elastic net approach.

in order to test whether selected pathways were significantly enriched for the identified kinase genes in table  <dig>  a pathway-based enrichment analysis was conducted using the results from the elastic net kinase analysis and fisher exact tests. ten pathways from reactome were identified as significant  using this kinase list, including axon guidance, activation of rac, and semaphorin interactions as top hits .

s
t
ns indicates the number of kinases that are found significant in the regression analysis, while nt is the total number of kinases in the pathway. the top ten pathways with fisher exact test p < = <dig>  are shown. these pathways are identified from  <dig>  reactome pathways containing at least one of the kinases identified in table  <dig>  the  <dig> kinases in the axon-guidance pathway are egfr, pak <dig>  erbb <dig>  cdk <dig>  gsk3b, pak <dig>  rps6ka <dig>  fgfr <dig> and pak <dig> 

discussion
drug-kinase profiling represents a controller-target network  <cit>  that when combined with in vitro testing, can be used in regression models to predict drug response and to identify pathways statistically associated to drug sensitivity. network methods in biology are often based on the analysis of large datasets from high-throughput experiments. an example is given by gene regulatory networks, which presents many challenges either when restricted to a homogeneous set of data  <cit>  or when it includes different classes of data  <cit> . in our kien method, information from the drug-target network and experimental query of the biological system are integrated. the goal is not a reconstruction of a regulatory network, but to identify a set of kinases linked to a therapeutic response in a given cell line. in order to establish associations, the system has to be perturbed by the use of kinase inhibitor drugs. the response to these single drugs or drug combinations becomes a training set that when combined with the kinase profiling, can lead to predictions.

the elastic net method is one of the most widely used regularization techniques. regularization techniques are used in statistical and machine learning models to achieve an optimal tradeoff between accuracy and simplicity. simplicity makes a model less prone to overfitting and more likely to generalize. in our analysis, we found that the elastic net regressions based on single drug responses were not successful, while drug pair data provided statistically significant predictions. a possible explanation for this finding is the following: single drugs might be less able to overcome the robustness of biological networks  <cit> . the phenotypic signal is therefore blunted and not easily measured. if a second drug is added, any compensatory capacity is already stretched and the effects from the inhibition of each kinase can be seen more clearly. using data from drug pairs, we found that noise can be better filtered out and stronger statistical associations between kinases and therapeutic response are revealed. clearly, if a different training set with higher variance in efficacy measures were used in the primary screen, it is likely that also single drug in vitro response would have given a significant predictive model.

we identified several kinases that are implicated in lung cancer that gives biological significance to our kien method. in particular, tgfbr <dig> appears as a top hit both in the correlation and in the elastic net methods. this finding is consistent with recent sirna experiments on a <dig> cell lines  <cit> , which demonstrated that silencing of this receptor reduces cell proliferation, invasion, and metastasis. the cyclin-dependent kinase  <dig>  appears as a second top target in the correlation analysis, and is also highly significant in the kien analysis. experiments using lentiviral-mediated shrna to inhibit cdk <dig> in a <dig> have shown inhibited cell cycle progression, suppressed cell proliferation, colony formation, and migration  <cit> , and there is an ongoing clinical trial using a cdk4/ <dig> inhibitor in lung cancer  <cit> . the kien analysis identified egfr, which is known to be overexpressed in the majority of non-small cell lung cancers  <cit> . furthermore, rnai experiments targeting egfr demonstrated cancer growth suppression in a <dig> xenograft in mice  <cit> . the third kinase in table  <dig>  phkg <dig> has also been found to be upregulated in human tumor samples, including lung adenocarcinoma, and aberrations in its gene copy number is a feature of many human tumors  <cit> .

the pathway-based enrichment provides a broader view on the role of the kinases identified by our method in table  <dig>  among the top three pathways shown in table  <dig> are activation of rac and semaphorin interactions. rac proteins play a key role in cancer signaling and they belong to the ras superfamily  <cit> . we also identified a set of semaphorins in our analysis that is represented in the top significantly enriched pathways. semaphorins, previously known as collapsins, are a set of proteins containing a 500-amino acid sema domain among others , which can be transmembranous or secreted  <cit> . it is known that sema3e cleavage promotes invasive growth and metastasis in vivo <cit> . these genes also have selective targeting by rac and rho family members. this generates hypotheses of possible pathways that could be targeted therapeutically. however, these hypotheses need to be validated by further experiments with different inhibitors for the same targets or with alternative methods, e.g. using sirna.

CONCLUSIONS
we have introduced an integrated experimental and computational methodology that identifies the role of specific kinases in the drug response of a given cell line. the key element of our kien methodology is a multiple regression procedure that uses in vitro screen data as a training set. if a new library of kinase inhibitor compounds were to be synthetized and profiled, then our model would be able to immediately estimate the effect of these drugs on in vitro experiments on a given cell line. we have shown an application to a lung cancer cell line, but our method can be extended to different cell lines. the method will facilitate the design of new kinase inhibitors and the development of therapeutic interventions with combinations of many inhibitors  <cit> . the procedure could be extended to three drug combinations, if measurements for these larger combinations were available. finally, the method could be extended to regression models that are specific of cancer cells with the same set of mutations, or it could be directly used with patient-derived primary cells to identify a personalized treatment.

materials and methods
materials
the primary screening of a kinase inhibitor  library comprised of  <dig> kis was purchased from emd chemicals, and diluted with dmso to  <dig> mm concentrations for high-throughput screening purposes. the ki library was stored at -80°c. additionally, pdk1/akt1/flt <dig> dual pathway inhibitor  was ordered from emd. only  <dig> out of  <dig> were used in the drug-target network reconstruction because the drug profiling information was available only for these compounds. one kinase inhibitor known to affect the kinase targets indirectly was excluded. we provide in additional file  <dig> the chemical structure of kinase inhibitors with highest selectivity in the primary and secondary screening.

cell culture
cell lines imr- <dig>  and a <dig>  were cultured in rpmi  <dig>  supplemented with 10% canadian characterized fetal bovine serum , 1%  <dig> mm l-glutamine , and 1% penicillin/streptomycin . the media for the cells were renewed every  <dig> days and kept at 80-90% confluency. cells were maintained in a humidified environment at 37°c and 5% co <dig> 

kinase inhibitor experiments
imr- <dig>  and a <dig>  were seeded on 384-well microplates  and incubated for  <dig> hours before the addition of kinase inhibitor. the reason that imr- <dig> was seeded at double the cell density of a <dig> is due to the difference in cell division. imr-90’s doubling time is 36– <dig> hours whereas a549’s is  <dig> hours. we wanted to make sure that the cells have divided at least once during the  <dig> hr drug treatment. furthermore, both a549’s and imr-90’s final confluency at  <dig> hrs is 90-95% and within the range of the atplite 1step assay. additional file 1: figures s <dig> and s <dig> show the growth curve for both cell lines. imr- <dig> and a <dig> cell lines were tested on the same day with three replicates and the experiment was repeated three times with randomized well positions to reduce biases. echo  <dig> liquid handler  was used to dispense nanoliter volumes of each ki to 384-well plates with cells attached . the final volume in the plate is 40ul and cells were incubated for  <dig> hours with ki treatment.

atp measurements
atplite 1step  was used to evaluate the cell number and cytotoxicity. atp measurements were done by dispensing  <dig> ul of the atplite 1step solution to each well to a final volume of  <dig> ul. the plate was placed on a shaker at  <dig> rpm and the luminescence activity was detected by analyst gt plate reader. the percent  of control is the quantity of atplite 1step measurement of the treated versus the untreated wells of each individual cell type. the atp standard was prepared with culture media to final volume of  <dig> ul, and  <dig> ul of atplite 1step reagent was added. additional file 1: figure s <dig> shows the atp standard curve. the plate was read immediately.

computational methods
correlations between selectivity/viability and kinase activity were calculated using the python scipy linregress function, which also provide p-values. ranking the p-values and directly applying the benjamini–hochberg procedure gave us the fdr values. the elastic net regression was carried out using the scikit-learn package  <cit>  which finds the coefficients β that minimize the function

 f=12m|v-aβ|22+αρ|β|1+12α1-ρ||β|| <dig> 

where v is the vector of the observed viabilities and a is the matrix containing the residual activity of the kinases from the profiling, and m is the total number of drugs or drug combinations used. the parameters α and β determine the relative weights of the lasso and ridge penalties quantified using l1  and l2  norm, respectively. we used α =  <dig>  and ρ =  <dig>  in the results of figures  <dig> and  <dig> and in table  <dig>  we also tried other values of these parameters, which did not give a significant difference in the results.

pathway-based enrichment
reactome pathways were downloaded using a newer build of the 'biomart’ library  in bioconductor/r . gene symbols from the kinase list were converted to entrez gene identifier numbers  and mapped against the gene ids in each reactome pathway. for each pathway, the set of significant genes enriched within any given pathway was computed using a fisher exact test. the procedure computes the significance  of observing significant kinases, as deemed significant by our method, within the selected pathway. these pathways are identified from  <dig> reactome pathways. given that our gene set consists entirely of kinases and would be generalized towards kinase-specific effects, the set of all kinases  were selected for background adjustment and more sensitive enrichment of the pathways. this procedure was repeated for each pathway to generate p-values and pathway rankings. false discovery rate  values were later generated to further restrict significance.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
gp and cp proposed the concept, eo and cp wrote the software and analysed the results, aph performed the reactome analysis, tt performed all experiments, cp and gp. wrote the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 2
chemical structure of drugs with the highest selectivity in the primary and secondary screen.

click here for file

 additional file 1
prediction of kinase inhibitor response using activity profiling, 
in-vitro 
screening, and elastic net regression.

click here for file

 acknowledgements
we thank dr. anthony  polverino for many discussions. we would like to acknowledge the nsf grant  and the dod/cdmrp lung cancer research program  for support.

the data sets supporting the results of this article are included within the article. correspondence and requests for materials should be addressed to giovanni@sanfordburnham.org or carlo@pa.msu.edu.
