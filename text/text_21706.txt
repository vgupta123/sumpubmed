BACKGROUND
mirnas are nowadays recognized as a class of evolutionally conserved, single-stranded, 19– <dig> nucleotides  long non-coding rnas acting, both in plants and animals, as post-transcriptional regulators. genes codifying for mirnas can be localized at different sites into the genome even if, in humans, the majority of them have been detected into the transcripts intronic regions. the involvement of mirnas in almost every physiological process such as cell fate determination, proliferation, cell death and in many cellular activities among which immune response, insulin secretion, neurotransmitter synthesis, circadian rhythm and viral replication is widely proven . furthermore, recent researches have shown deregulated mirnas expression in many pathologies such as cardiovascular diseases  <cit> , autoimmune disorders  <cit>  and cancers with implications in numerous oncogenic or tumor suppressor pathways .

recently, thanks to the advent of next generation sequencing  technologies, it is possible to carefully detect and quantify the amount of both known and novel mirnas in rna-seq samples, accounting also for single nucleotide polymorphisms  . the high quality of data coming from ngs technologies has been exploited to gain novel insights into mirnas variants called isomirs. isomirs are mirnas variants that originate from mirnas loci as consequence of specific processes as exoribonucleases or nucleotidyl transferase activity, rna editing, snps or imprecise cleavage by the ribonucleases drosha and dicer  <cit> . accordingly to neilsen and colleagues research  <cit> , isomirs can be distinguished into three main classes: 3’ isomirs, 5’ isomirs and polymorphic  isomirs. specifically the first have been identified in different studies  as the most common and abundant variants in both plants and animals. recently the functionality of 3’ isomirs has been investigated with regard to compensatory base pairing at the 3’ end  <cit>  and distinct silencing functions attributed to different mirna family members with shared seed sequences but divergent  <dig> ends  <cit> . fernandez and colleagues  <cit>  proven the variation of isomirs expression levels in drosophila melanogaster, depending on the developmental stage and the specific tissue, thus suggesting a role for these mirnas variants in different biological processes. in  <dig> li and colleagues  <cit>  pointed out different isomirs expression patterns in normal and tumour gastric tissues calling for isomirs relevance during mirnas analyses. moreover, results from these studies seem to account for an impact of isomirs on target selection, mirna stability or a different loading into the risc complex. in particular, with respect to isomirs target selection, evidences of an impact of mirna sequence variations on target mrna selection have been recently experimentally validated by tan and colleagues  <cit> .

both mirnas and isomirs act at the post transcriptional level via base-pairing with complementary sequences on target mrnas. as a result, the target mrna molecules are silenced by one of the following mechanisms: i) cleavage of the mrna strand, ii) destabilization of the mrna through the removal of its poly tail, or iii) translation of the mrna into proteins by ribosomes. the capability of a mirna in bounding a specific target depends on the conservation, onto the mirna structure, of particular nucleotide sub-sequences called mirna-mrna interactions sites, among which of fundamental importance the seed sequence . however, additional mirna-mrna interactions sites have been recently identified in bartel researches  <cit>  as able to guarantee high specificity in mirna-mrna interaction and have been adopted as central features by the most of the target prediction tools to avoid false discoveries .
fig.  <dig> interaction sites scheme. reported, respectively with red, green, blue and brown colors, the possible mirna-mrna interaction sites known as seed , offset , supplementary  and central 




many software tools have been developed during the last decade to extract mirnas expression levels from rna-seq data. among them, mirdeep  <cit> , miranalyzer  <cit> , mirexpress  <cit> , mirtrap  <cit> , dsap  <cit> , mirtools  <cit> , mirena  <cit> , mirnakey  <cit>  and mireap  <cit>  have been recently compared showing quite different performances in terms of sensitivity and accuracy levels as well as poorly overlapping mirnas output sets  <cit> . being developed on top of general purpose alignment algorithms as bowtie  <cit>  or bwa  <cit> , these tools are not able to evaluate the encountered mismatches accordingly to their positions on mirna sequence. this accounts for reduced sensitivity and accuracy levels in mirnas detection and for their incapability in distinguishing between the different isomirs and modifications in mirna-mrna interaction sites. for instance, a complete and uncorrupted seed sequence is fundamental to ensure the mirna:mrna complex stability  <cit> . differently from state of the art tools, isomir seed extension aligner  exploits a mirna specific alignment algorithm, able to correlate the encountered mismatches with their positions on the mirna sequence and then to produce accurate mirnas expression level quantification and both isomirs and mirna-mrna interaction sites precise classification. all this information is collected during the alignment procedure, thus avoiding additional filtering stages potentially responsible for the loss of useful data. it is worth noting that the evaluation of the impact of isomirs on the conserved mirna-mrna interaction sites has two main consequences. on the one hand it allows to clarify the impact of isomirs on mirnas functionalities thus gaining novel insights into mirnas regulative behaviour. on the other hand, on the basis of the observed results, it is possible to decide whether to include or not detected isomirs in the calculated mirnas expression level.

in the “implementation” section additional algorithmic implementation details are provided. isomir-sea performances, assessed on two different public datasets, will be presented and discussed in the “results and discussion”. this section is organized as follows: the details concerning the experimental set-up adopted to perform the analysis are given in the “testing procedure” subsection. in “isomir-sea isomirs and interaction sites detection” subsection are provided results obtained on the first dataset, that highlight the variety of information extracted by isomir-sea. the comparisons, in terms of computed expression levels between isomir-sea and two state of the art tools, performed on the second dataset, are shown in isomir-sea comparisons. finally in “computational costs” the computational costs proper of the three tools are discussed. in the “conclusions” section the final remarks deriving from the proposed work are highlighted.

implementation
the isomir-sea tool exploits a mirna-tailored alignment procedure, named mir-sea  <cit> , that implements an accurate mirna model derived from experimental evidences  <cit> . the model is built upon the main features characterizing the seed sequence , which is nowadays recognized to play a fundamental role in target recognition and, as consequence, in genes regulation  <cit> . isomir-sea keeps track of the results achieved at each step of the alignment procedure and analyses them in order to recognize mirnas variants and characterize mirna-mrna interaction sites.

the tool is designed to distinguish among four mirna variations with respect to the exact mirna sequence . as shown in fig.  <dig> isomir-sea is able to classify the aligned tags as: i) mirna_exact; ii) iso_5p resulting from insertion or deletion in the 5p-end; ii) iso_snp or iso_multi_snp harbouring one or more mismatches wherever in their sequences ; iv) iso_3p arising from insertions or deletions in the 3p-end.
fig.  <dig> isomirs scheme. in figure are reported the different mirnas variants, namely isomirs, detected by isomir-sea. tags exactly matching a mirna  identify a mirna molecule, those with 5p , 3p , snp  or multi snp  variations, respectively isomirs 5p, 3p, snp and multi-snp



as a consequence of the addition or deletion of nucleotides and the presence of snps, remarkable effects on mirnas target selection can be observed  <cit> . then the conservation in the tag sequence of mirna-mrna interaction sites is checked during isomir-sea alignment procedure. figure  <dig> reports on the four interaction sites evaluated by isomir-sea: i) the seed sequence, a region located at nucleotides 2– <dig> shared by all the mirnas belonging to the same family and known to be the most important interaction site between mirna and its mrna targets; ii) the 3’-supplementary site, a sequence corresponding to nucleotides 13– <dig> on the mirna structure and characterized as sensitive to pairing geometry preferring at least 3– <dig> contiguous watson-crick pairs not interrupted by bulges, mismatches or wobbles; iii) the central site, a region on the mirna corresponding to nucleotides 4– <dig> and iv) the offset site, at nucleotide  <dig> on the mirna sequence. moreover, in order to further improve the accuracy of the calculated expression levels and to correctly distinguish among mirnas belonging to the same family, ambiguously mapped tags , are evaluated on the basis of their alignment scores and assigned to a unique mirna.

from an implementation view point, the accurate mirna model proper of isomir-sea guarantees the deletion of those tags not compatible with mirnas structure, thus reducing the computational costs required for the following steps of the pipeline. in particular, those tags that show an incomplete or corrupted or shifted seed sequence are removed. finally, isomir-sea standalone c ++ implementation supported by seqan library  <cit> , makes the proposed pipeline user-friendly and easy to customize. specifically, isomir-sea algorithm starts with the search into the tags for mirnas seeds located in positions compatible with mirna structure to discard sequences not accounting for mirnas molecules. the remaining tags are progressively extended in 3’ direction allowing for mismatches. mismatches positions are evaluated during each performed extension to check whether or not occurring within a selected nucleotide interval. tags satisfying this last criterion are divided into two groups on the basis of their attribution to a single or multiple mirnas. sequences belonging to the second group are scored using specific alignment parameters and finally assigned to a specific mirna . finally isomirs and interaction sites are annotated by evaluating the mismatches detected during tags alignments. the whole work-flow is basically constituted of the three main blocks depicted in fig.  <dig> with letters a, b and c. each of them will be detailed in the following.
fig.  <dig> isomir-sea work-flow. in figure are reported the three main blocks which constitute isomir-sea. block  reports on parameters setting and input files preprocessing, block  on the alignment procedure and finally block  on the output files generation



a. parameters setting and input files pre-processing
twelve parameters allow users to trigger isomir-sea behaviour. specifically, tags can be aligned on one or more species by imposing a minimum alignment length and the start/end positions where the seed has to be searched into the tag sequence. moreover users can decide which alignments to discard by changing the value of a specific parameter introduced to evaluate mirna-tag identity.

two input files have to be provided to isomir-sea tool for the detection of mirnas expression levels as shown in fig. 3a. the first file contains mirnas reference sequences while the second stores the input tags table of counts  on which the analysis has to be carried out .

mirnas reference sequences have been downloaded from mirbase  <cit> , a well known mirnas repository currently at version  <dig>  the file containing mirnas sequences, downloaded from mirbase database, has to be processed in the so called mature db seed-based sorting step, where all the seeds are firstly extracted from the mirnas reference sequences, then classified depending on the species and finally grouped together. the obtained groups, sharing the same seed sequence, are then stored in an optimized data structure allowing its efficient access during the alignment procedure.

the second input file is the standard tags counts file. generally this file is obtained by means of freely available tools performing the following steps: i) trimming of adapter sequences on raw fastq or fasta reads, output of sequencing machines; ii) grouping in unique sequences called tags; iii) calculation of the occurrence of reads supporting the various tags. the output file, reporting tag sequences followed by their occurrence, is stored by isomir-sea in the main memory.

b. isomir-sea alignment procedure
each mirna seed is searched, in this phase, into each stored tags . tags harbouring the seed are extended without gaps allowed in both directions . this procedure is done for all the mirnas sharing the same detected seed in a position compatible with mirna structure  <cit> . tags not satisfying these conditions are currently discarded and will be not considered in the further steps of the analysis increasing, in this way, the computational speed. as future work, we are planning to re-map these tags on pre-mirna sequences by adopting an accurate local aligner implementing dgs model  <cit> .

the selected tags are further extended in 3’ direction allowing for the presence of a second mismatch. at this point, the distance of the second encountered mismatch with respect to the previous found, is evaluated. tags characterized by two mismatches in the first  <dig> aligned nucleotides are discarded, whereas the others are further extended until the end of the alignment or a third mismatch. this threshold parameter can be modified by the user. however the default value has been chosen according to experimental insights  <cit> .

finally, each aligned tag is scored as reported in eq.  <dig> where mirsize is the length of the mirna on which the tag has been aligned, #gaps the number of gaps detected in the alignment and alignsize the length of mirna-tag alignment. thanks to this measure it is possible to evaluate the quality of the different alignments. lower values are associated to better alignments. 
  alignscore=mirsize−mirsize <dig> 

furthermore, to take into account also the tag length  during tags alignment assessment, a second measure has been introduced as shown in eq.  <dig>  the lower mirtagdiff, the higher the comparability between the tag and the mirna. 
  mirtagdiff=mirsize−tagsize 

these two scores can be adopted to select the most reliable alignment in case of tags ambiguously assigned to more than a mirna.

as last step, the isomirs, as well as the interaction sites, are annotated according to the position of the mismatches found during the alignment procedure.

c. isomir-sea output files generation
nine output files are generated at each isomir-sea run in order to allow users to deeply investigate the performed alignments. output files provide information both from a tag and from a mirna view point.

in particular, if a tag has been mapped on a unique mirna its information will be stored in a unique tag file, while if the tag aligned on more than a mirna its data will be reported in a specific file storing the so called ambiguous tags. some of these ambiguous tags will be then re-evaluated using the quality parameters  and assigned to a unique mirna. these tags are then stored in a third file.

these tag-related files provide users with all the isomirs and mirna-mrna interaction sites detected starting from the same tag, the unique or multiple mirnas on which the tag has been mapped and the two mapping parameters values previously described in eqs.  <dig> and  <dig>  furthermore, in case of multi-mapped tags, indications relative to the different detected mirnas are reported, such as the number of families to which they belong, the number of mirnas on which the tag has been mapped and the scoring distance of the second best alignment detected from the best one reported.

from a mirna point of view, two main outputs have been adopted to summarize the detected expression levels, according to the format used by the most known mirnas discovery tools. the first file aggregates for the different mirnas the information collected from the unique mapped tags whereas the second file, derived from the selected tags, reports on those tags that have been re-evaluated thanks to the alignment score parameters. even in this case the information related to isomirs and interaction sites is reported, together with data concerning the number of supporting reads and the computed alignment scores.

it is worth noting however that users are free to either consider only the mirnas expression files to acquire the overall expression of the detected mirnas and isomirs, or to look at the tags files introducing the preferred filtering stages or grouping data according to their needs.

concerning the implementation, isomir-sea tool has been developed in c++ programming language, taking advantage of the open source seqan library  <cit> . this library provides users with algorithms and data structures for the analysis of biological sequences that ensure high performances and, at the same time, ease of integration in analysis pipelines.

RESULTS
we report here the results of isomir-sea performance assessment on two datasets extensively analysed in previous researches by somel and colleagues  <cit>   and li et al.  <cit>   for which mirnas and mrnas sequencing data have been freely provided on geo database repository  <cit> . these two studies proven respectively the regulative roles of mirnas in gene expression modulation throughout the entire life span of both humans and macaques and the general or cancer-specific involvement of different genes and mirnas in the carcinomas of bladder, kidney and testis.

the experiments performed allowed us to show the capability of isomir-sea tool in providing a detailed picture of mirnas, isomirs and conserved mirna-mrna interaction sites characterizing the samples under investigation.

finally isomir-sea performances have been compared with two state of the art tools, i.e. miranalyzer  <cit>  and mirexpress  <cit> . in the comparison, both mirnas expression levels quality and computational times have been evaluated.

testing procedure
both datasets have been analysed by: i) adopting mirnas reference databases, the mirbase release  <dig> , used in the aforementioned works, and the latest release  <dig> that stores  <dig> mature mirnas sequences from  <dig> species; ii) using as an input the datasets reads trimmed allowing  <dig> or  <dig> mismatches in the adapter sequence; iii) setting the isomir-sea running parameters, i.e. seed length and minimum alignment threshold, respectively to  <dig>  and  <dig>  in the following, where not explicitly stated, the reported results were obtained using human mirbase  <dig> as reference. furthermore results reported in this section have been produced from reads trimmed allowing a maximum number of mismatches equal to  <dig> and collapsed to get the tags table of counts. further details are reported in additional file 1: text s <dig> 

isomir-sea isomirs and interaction sites detection
concerning somel dataset, mirnas reads were collected from the superior frontal gyrus of  <dig> healthy humans and  <dig> rhesus macaques of different ages, selected in a cohort of individuals. in agreement with previous somel et. al researches  <cit> , we will refer in the following to human developmental and ageing stage samples, respectively for data collected from < <dig> years old and > <dig> years old humans. this threshold has been fixed at  <dig> years for macaques.

since the considered dataset includes two different species, in order to perform a more specific evaluation of human mirnas expression levels, the reads alignment has been performed by adopting as reference the union of human and macaque mirbase sequences. this allowed to discard from the computed human mirnas expression levels those tags better aligned on macaques mirnas.

results shown in the following have been obtained by adopting this experimental set-up and are discussed in this section to highlight trends associated to exact mirnas, to different isomirs, conserved mirna-mrna interaction sites and overall reads counts. in particular we report the results of the analysis of these behaviours in relation to ageing and developmental stages in both the species, pointing out the differences and similarities between them where present.

the overall amount of mapped reads and the detailed isomirs spectrum of six different mirnas are reported in fig.  <dig>  these six mirnas have been selected since characterized by heterogeneous isomirs and mirna-mrna interaction sites spectrum trends that allowed us to widely describe the isomir-sea features. each bar of the six stacked histograms in fig.  <dig> describes, for a selected mirna, the percentage  of read counts assigned by isomir-sea to the exact mirna sequence  or to the different detected isomirs accordingly to the legend reported in fig.  <dig>  these percentages are computed as the ratio between the read counts attributedby isomir-sea to each isomir type and the total reads count for the specific mirna. the notation used to identify the different samples on x-axis is in the form sampleid-age where sampleid contains the character h or m respectively for human or macaque samples and age is expressed in years in order to allow the identification of the transition age from the developmental to the ageing stage . as a consequence, the first seven bars in the stacked histograms represent, for a given mirna, the associated trends in the developmental human brain, whereas the following seven the associated trends in the ageing stage. a similar representation stands for the bars related to the macaque samples, for which the transition age has been fixed at four years old. in fig.  <dig> groups of samples belonging to the two different species are separated by a wider white bar. the trend curve, depicted in figure with a black line, reports on the right y-axis read counts for the specific mirna in the different samples under analysis.
fig.  <dig> isomirs percentages. subfigures , , , ,  and  show respectively for human mir-181a-3p, mir-154-3p, mir-29a-3p, mir-664a-5p, mir-34c-5p and let-7e-5p, the isomirs percentages detected in the samples on x-axis. in particular the left y-axis reports on the percentages of isomirs, whereas the right y-axis on the absolute reads counts. in each subfigure the first  <dig> bars are relative to human samples, whereas the last  <dig> to the macaque ones. moreover the development and ageing stages are divided by a dark-grey bar. the different samples are labelled with a unique identifier in the format speciesnumsample-age: the character h and m identify respectively human or macaque samples, numsample ranges from 01– <dig> for both the species and the age is in the form of years. the bold line, that separates in two groups the analysed samples in both the species, represents the transition age that divides the developmental from the ageing stages. isomirs are depicted with different colors according to the legend of fig.  <dig>  the black trend curve reports on isomir-sea reads counts

fig.  <dig> isomirs legend. the table reports, for both the tags exactly aligned on mirna structure or deriving from isomirs , the colors adopted for their representation in the different graphs  and the description of the detected mutations 



with reference to mir-181a-3p in fig. 4a it can be observed that the percentage of reads attributed to iso_3p-only increases during ageing, reaching a peak of  <dig>  % in sample h <dig> at  <dig> years. an analogous trend can be pointed out in relation to iso_5p-iso_3p with a maximum of  <dig>  % in h07- <dig>  while a decreasing trend can be pointed out for mirna_exact mapped reads. for the safe of clarity, mirna_exact, iso_3p-only and iso_5p-iso_3p trends are highlighted also in fig.  <dig> for mir-181a-3p accordingly to the legend reported in fig.  <dig>  the analysis of the same mirna in terms of read counts values is reported in the additional file 1: text s <dig> 
fig.  <dig> hsa-mir-181a-3p isomirs trends. in figure are reported accordingly to the legend of table  <dig>  the trend lines of mirna_exact, iso_5p-iso_3p and iso_3p-only percentages  detected for human mir-181a-3p in the different analysed samples 

fig.  <dig> interaction sites: subfigures  and  report, respectively for hsa-mir-29a-3p and hsa-let-7e-5p, the percentages of tags accounting for the conserved interaction sites on the left y-axis and the absolute reads counts on the right y-axis. each interaction sites is coloured according to the legend reported in fig.  <dig>  the first  <dig> bars are relative to human samples, whereas the last  <dig> to the macaque ones. each sample is labelled with a unique identifier in the format species_numsample-age: the character h and m identify respectively human or macaque samples, numsample ranges from  <dig> to  <dig> for both the species and the age is in the form of years. the bold line, that separates in two groups the analysed samples in both the species, is located at the transition age. the black trend curve reports on isomir-sea reads counts



the account of isomir types and their percentage is important in order to check the impact of the detected mismatches in the stability of mirna-mrna interaction sites . these mismatches can compromise the effectiveness of mirna activity. after this evaluation, the user can decide to discard those tags supporting isomirs that can lead to unstable or weak interactions, thus obtaining a lower mirna expression count.

expression trends depending on the life stage are pointed out also in fig. 4b relatively to mir-154-3p: the percentage of mirna_exact reads in humans decreases during the developmental stage until a minimum equal to  <dig>  % for sample h09- <dig>  at  <dig> years old and starts growing again during ageing. furthermore, an interesting behaviour in iso_snp can be identified during the different stages: their percentages grow until the transition point while they become smaller in the ageing stage.

similar isomirs percentages in humans and macaques can be detected for mir-29a-3p, as highlighted in fig. 4c. indeed the overall amount of reads attributed to isomirs is respectively equal to  <dig>  % for humans and  <dig>  % for macaques. somel et al. proved that this mirna has a role in the strictly developmental regulation in both human and macaque species where it acts by down-regulating cell proliferation-associated genes. furthermore in humans also cell proliferation proteins appear as down-regulated, strengthening the identified correlation. the analysis of the conserved mir-29a-3p-mrna interaction sites reported in fig. 7a can be useful to check if aligned tags, even if related to isomirs, conserve the mirna interaction sites and, as a consequence, if the mirna is able to exploit its function. the representation adopted to describe conserved mirna-mrna interaction sites in fig.  <dig> is similar to the one reported in fig. 4: the left y-axis in this case reports the percentages of reads accounting for the different interaction sites detected, the right y-axis reports on the mapped reads counts whereas bar colors describe the  <dig> different combinations of mirna-mrna interaction sites accordingly to fig.  <dig>  the most of the tags attributed to mir-29a-3p retains all the possible mirna-mrna interaction sites accounting for the conservation of mirna function in down-regulating its target genes coherently to  <cit> .
fig.  <dig> interaction sites legend. the table reports, for tags harbouring in their sequences the interaction sites types , the colors adopted for their representation in the different graphs  and the description of the detected sites 



coming back to fig. 4d, it can be seen for mir-664a-5p, various isomirs trends. in particular, human samples are characterized by an higher average percentage equal to  <dig>  % of iso_snp-iso_3p with respect to macaques, where this percentage is  <dig>  %. a similar behaviour, even if less evident, can be also detected for those isoforms classified as iso_5p-iso_snp-iso_3p. furthermore, a relatively small number of mirna_exact reads contribute to the total reads number. this isomirs spectrum is conserved in both species independently from age and developmental stage. the inter-species average values for mirna_exact reads are indeed equal to  <dig>  % for both humans and macaques.

mir-664a-5p has not been identified by somel as implicated in regulative processes occurring during development or ageing. the reduced percentages of exact mapped reads provided by isomir-sea could explain missed interaction sites and as a consequence justify mir-664a-5p limited regulative role. two state of the art tools, i.e. miranalyzer and mirexpress, which performances will be extensively discussed in the following subsection, provided for the considered mirna an expression level higher than the one calculated by isomir-sea: tags attributed by these tools to mir-664a-5p probably derive from isomirs and so the produced expression level can not be correctly correlated to mirna regulative functions.

the percentage of reads attributed to mir-34c-5p isomirs  increases during ageing in humans, whereas a quite stable behaviour can be pointed out in macaques. mir-34c-5p, that has been proven to be differentially expressed during the developmental stage in humans, acts by down-regulating a group of genes involved in neuronal functions  <cit> . the analysis of the mirna-mrna interaction sites in humans, as already observed for mir-29a-3p, highlighted the presence in the tags of almost all the interaction sites explaining mirna capability in down-regulating target genes consistently with  <cit> . in fact this mirna is mainly identified by tags with exact mapping or tags with mismatches in 3p region that do not impact the interaction sites.

finally, fig. 4f describes let-7e-5p isomirs spectrum. an increasing percentage of reads attributed to iso_snp can be detected in older human samples, whereas quite stable trends are associated to the other identified isomirs. in order to investigate to what extent mirnas variations determining isomirs impact on mirna-mrna interactions sites, we report in fig. 7b the percentages of reads accounting for let-7e-5p conserved interaction sites. a reduction of the percentage of reads attributed to all the three possible interaction modes is observed as age increases. the loss of interaction sites can be attributed to the presence of snps in the mirna region corresponding to the central site thus highlighting a possible role of snps in target selection.

isomir-sea comparisons
the second analysed dataset is composed of  <dig> patient-matched tumor-normal mirna-seq samples with ages varying from 30– <dig>  in particular  <dig> samples derive from transitional cell carcinoma ,  <dig> from testicular germ cell tumor  and the last  <dig> from clear cell renal cell carcinoma   <cit> .

the results obtained by isomir-sea on this dataset have been compared to those provided by three state of the art tools, namely miranalyzer  <cit> , mirexpress  <cit>  and mirdeep <dig>  <cit> , running with the default configurations. the proposed analysis has been performed in order to show how the strategies implemented by the tools impact on the computation of mirnas expression levels. in particular, mir- <dig> has been selected over the other mirnas because its alignment results in several isomirs, and for this reason, mir- <dig> is characterized by high variability in the expression levels provided by the various tools. moreover, its observed low reads counts allowed to easily analyse the tags alignments and highlight the different characteristics of isomir-sea and the other two tools.

the mir- <dig> tags aligned with the three tools have been extracted and mapped on the mirbase  <dig>  the three compared tools provided quite different results. figure  <dig> reports on the y-axis the reads counts provided by isomir-sea , miranalyzer  and mirexpress  for mir- <dig> in the control samples of li dataset. analogous considerations can be made for mirnas expression levels in tumor samples. furthermore, isomir-sea reads counts attributed to mir- <dig> and its isomirs are described in each sample by the bars on x-axis accordingly to the legend reported in fig.  <dig> where, as seen in the previous subsection, the bars represent the percentage of tags attributed to a specific isomir or supporting an exact matching. for the sake of clarity, the expression levels computed by mirdeep <dig> on a subset of samples from li dataset are reported in additional file 1: text s <dig> 
fig.  <dig> hsa-mir- <dig> isomirs. in figure are reported for mir- <dig> on the y-axis the reads counts associated to the different detected isomirs in the samples under examination . colors associated to each isomirs are reported in fig.  <dig>  three trend curves account respectively for isomir-sea , mirexpress  and miranalyzer  reads counts


fig.  <dig> analysis of isomir-sea, miranalyzer, mirexpress and mirdeep <dig> mapping results for hsa-mir- <dig>  in figure are reported on the left side the tags and their relative occurrence  assigned by isomir-sea, miranalyzer, mirexpress and mirdeep <dig> to mir- <dig> in five different samples . the d character accounts for the detection of the tag, the u for its undetection and finally the f  for its filtering. the underlined characters identify mismatches in the tag with respect to mirna sequence. tags with green background possess a complete seed sequence, whereas those with a red background an incomplete or corrupted seed



referring to sample t27n, all the tools have been able to attribute to mir- <dig> those reads characterized by the presence of a complete seed sequence with exception of miranalyzer that discarded those alignments having different nucleotides inserted in tag 5’-end, even in the presence of a complete seed sequence. on the other hand deletions in tag 3’-end in presence of complete seeds did not caused tags to be discarded. furthermore, the first two tags characterized by the lack of a complete seed  are detected by all isomir-sea competitor tools. isomir-sea instead, being implemented to report tags alignments characterized by the presence of a complete seed sequence, discarded the last three alignments that present mismatches or deletions in the seed. the last red alignment highlights mirexpress sensitivity to mismatches: the tag has been indeed discarded because of a mismatch in the 5’-end.

in sample t04n it is possible to note how tags discarded by isomir-sea, because they are missing the complete seed sequence, are instead identified by competitor tools even in presence of only two seed nucleotides. miranalyzer discarded, also in this case, tags with nucleotides inserted in 5’-end even if characterized by a complete seed sequence. mirexpress as well as mirdeep <dig>  reported all the tags containing seed sequence with exception of the fifth, probably because of the high number of mismatches encountered during its alignment on the whole mirna sequence.

in sample b05n mirexpress filtered out  <dig> out of  <dig> tags harbouring the seed because of a high number of mismatches. however, being these mismatches localized in the 3’-end of tag sequences, they do not account for the loss of interaction sites. as a consequence they cannot be considered responsible for changes in mirna regulative behaviour and so could be counted, more properly, among mir- <dig> supporting tags. conversely, mirdeep <dig> detected all the alignments characterized by a complete seed sequence. the two green alignments in position one and three are detected by isomir-sea tool but then filtered out because their alignment size was shorter than the aforementioned threshold of  <dig> nucleotides. indeed mirna length is equal to  <dig> nucleotides whereas tags are respectively  <dig> and  <dig> nucleotides long.

however, being isomir-sea able  to report in detail during all the alignment phases encountered matches/mismatches and insertions/deletions and to annotate the identified isomirs, the combinations among them and the conserved interaction sites, the users can select: i) which tags filter out, ii) which kind of isomirs consider for mirna expression evaluation and iii) how to group the data and perform statistics on the basis of the observed results.

all the alignments of sample k07n are discarded by isomir-sea because tags missed the seed. whereas concerning sample b20n, two tags harbouring the seed have been detected by isomir-sea even in presence of snps.

differences in the results provided by the compared tools on li and colleagues dataset, have been further investigated performing cross-correlation analyses. subfigures  <dig> a and  <dig> b report, respectively for isomir-sea:mirexpress and isomir-sea:miranalyzer, the logarithmic cross-correlation  of the different mirnas reads counts detected by each couple of tools. for the sake of clarity, the point  corresponds in the plots of fig.  <dig> to the  coordinate. each dot, representing the reads counts of a mirna in a specific sample, assumes near blue colors if the percentage of isomir-sea exact mapped reads accounting for its expression is low, whereas reddish colors represent higher percentages. note that this color annotation is relative to isomir-sea tool only because the other tools do not provide this kind of information. the different values in the plots can be further explained in terms of coordinates by sectioning the area in five main portions: i) dots located on the x-axis account for reads assigned to a given mirna by x-tool that are not assigned by y-tool; ii) dots placed on the y-axis represent reads mapped on a given mirna only by y-tool; iii) the 45° line reports those mirnas identified as equally expressed by the two compared tools; iv) the area above the 45° line includes all the mirnas detected as more expressed by y-tool with respect to x-tool; v) the zone under the 45° line reports on those mirnas detected as more expressed by x-tool with respect to y-tool.
fig.  <dig> logarithmic cross-correlation values. subfigures  and  report respectively on the lccs calculated for isomir-sea:mirexpress and for isomir-sea:miranalyzer reads counts. the color bar depicts the percentages of mirna exact mapped tags detected by isomir-sea tool. this color annotation is relative to isomir-sea tool only



with respect to fig. 11a, isomir-sea results account for a relevant number of mirnas characterized by expression levels two order of magnitude higher than those provided by mirexpress tool. these mirnas, detected as more expressed by isomir-sea tool, are supported by reads harbouring in their sequences the seed, but in the most of the cases present sequence variations with respect to the exact mirna sequence. they are evaluated as isomirs by isomir-sea. otherwise, probably because of the high number of mismatches detected with respect to the mirna sequence, they are not considered by mirexpress due to the inability proper of this tool to detect iso-snp variants .

the lcc relative to miranalyzer and isomir-sea read counts are reported in fig. 11b. differently from what was previously highlighted in relation to mirexpress and isomir-sea comparison, it is not possible here to detect a significant imbalance in the expression of the mirnas detected by the two tools on the considered dataset. however miranalyzer produces slightly higher expression levels because, as shown in the analysis reported in fig.  <dig>  it counts among mirnas supporting tags also sequences characterized by the absence of seed sequence.

it is worth noting that, in the reported analysis, all the isomirs were counted by isomir-sea in order to evaluate the mirnas expression, filtering out only those tags with an incomplete seed sequence. however, differently from miranalyzer and mirexpress, the user can decide to weight the different isomirs in the expression evaluation or totally exclude some of them. moreover, the prevalence of blue dots accounts for reads not exactly attributed to mirnas and probably deriving from isomirs. thus, in order to discriminate between the different isomirs and mirnas and to correctly evaluate the conservation of mirna-mrna interaction sites and, as a consequence, the mirna regulatory activity, it is necessary to use a tool able to provide accurate information about tags mapping.

different mirnas expression levels can be furthermore pointed out when the couple mirexpress:miranalyzer lccs is considered, as shown in additional file 1: text s <dig>  in this case, it is not possible provide information about isomirs and thus the tags supporting the different mirnas have been considered as the exact mirnas sequence and tags with mismatches in the seed have been also kept. the same analysis is reported in additional file 1: text s <dig> for somel dataset.

computational costsfig.  <dig> computational times comparisons. in figure are reported, for the different tools on x-axis, the overall times required for the analysis of three mirna-seq samples



as it is possible to note from fig.  <dig> the most expensive tool, from a computational point of view, is mirexpress that required about  <dig> h to complete the test. computational times significantly lower can be pointed out for miranalyzer, that took about  <dig> h to finish the analysis. further lower computational costs have been observed for isomir-sea that required about  <dig> h of computation.

CONCLUSIONS
in this paper we proposed a novel methodology and tool, named isomir-sea, able to provide users with a complete and accurate picture of the mirnas, isomirs and conserved mirna:mrna interaction sites characterizing the tissue under examination. differently from state of the art tools that rely on general purpose alignment algorithms, isomir-sea is built on top of mirnas specific features, among them, the seed sequence. its work-flow basically consists in mirnas seed sequence match followed by a series of ungapped extension in both 5’ and 3’ directions. being able to keep track of all the performed alignment steps, the tool can evaluate all mirnas variants, namely isomirs, and to characterize mirnas interaction sites.

concerning isomirs, isomir-sea provides the expression levels of iso_5p, iso_3p, iso_snp, iso_multi_snp or combinations of them and allows to distinguish which among supplementary, offset and central interaction sites are conserved in the tags.

isomir-sea provides as output two main types of files: the first contains information organized from a tag point of view whereas the second reports results sorted according to the specific mirna. the proper format of both of them allows to easily process data for i) performing further statistical analyses, ii) filtering specific isomirs, iii) implementing an isomir-weighted expression analysis of the detected mirnas.

tests performed on the labelled data by somel and colleagues  <cit>  and li et al.  <cit>  allowed to highlight isomir-sea potential in extracting novel information related to well known mirnas behaviours as well as its possible applications in different mirnas studies, such as multi-species, developmental or cancer studies. isomir-sea results have been moreover compared to those provided by two well known tools, i.e. miranalyzer and mirexpress, to prove the proper advantages of a mirna specific alignment procedure. finally the reduced computational costs make isomir-sea tool a viable solution for the analysis of large dataset and, as a consequence, a great alternative to design wide mirnas studies.

availability and requirements
project name: isomir-seaproject home page:http://eda.polito.it/isomir-seaoperating systems: linux, windows, mac os xprogramming language: c, c++license: freely available for academic purposes

additional file
additional file  <dig> 
supplementary material. this is a composed pdf file containing supplementary discussions, tables, and figures related to validation tests performed using isomir-sea. 

 competing interests

the authors declare that they have no competing interests.

authors’ contributions

gu developed the algorithm, wrote the software and design the validation tests. gp contributed to discussions on algorithm and test presentation. gu and gp collected the results. gp, gu, aa and ef wrote the manuscript. all authors read and approved the final manuscript.

