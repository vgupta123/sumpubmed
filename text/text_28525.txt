BACKGROUND
new high-throughput technologies are being used to generate large quantities of data detailing interactions between genes, molecules and biological systems. there is a critical need for informatics tools that can integrate both chemical and biological knowledge with these datasets to gain a deeper understanding of biological networks  <cit>  and to stimulate drug discovery  <cit> . one informatics resource that has transformed the analysis of large biological datasets is the gene ontology   <cit> , which provides a computable description of the functional aspects of an increasing number of genes and gene products spanning a diverse range of species. the go is used by gene product annotators to assign attributes to protein and functional rna gene products based on experimental reports in the primary literature  <cit> . these annotation sets are used for large dataset interrogation to determine similarities and differences in the attributes of gene products within those datasets. for example, the go has been used to look into the function of genes that may contribute to adaptation of humans to high altitudes as well as to find correlations between gene function and diseases or disorders such as cancer or autism  <cit> .

at the core of the go is a collection of over  <dig>  terms, connected by more than  <dig>  relationships. for ontology curators to maintain accuracy and consistency in a structure this large and complicated, it is critical to incorporate automated methods to check for integrity and to help build the ontology graph  <cit> . to this end, the go has been adding computable definitions for many of its terms  <cit> . automatic reasoners can then use these logical definitions to check for logical inconsistencies in the graph, to infer additional relationships, and to automatically classify new terms within the hierarchy. this approach becomes even more powerful when the definitions include components both from within the go and from specialized external ontologies, as it allows for the resources to build on the information contained within the other ontologies.

a complementary resource for chemists is chebi . chebi consists of approximately  <dig>  terms organized along similar principles to the go  <cit> . chebi acts as a reference for chemical entities across multiple domains and includes in its repertoire a wide range of entities from the subatomic scale to complex polymers. a growing number of bioinformatics resources are utilizing both the go and chebi as part of a substantial effort to integrate a large set of biological ontologies for community use  <cit> .

the go and chebi have been constructed largely for different purposes and, until recently, have only been loosely connected. previous efforts to align information between these resources have used semantic similarity and string matching methods  <cit> . here we describe the first stages of a process to fully dovetail the two ontologies, achieved through a combination of automated tools and the considerable efforts of domain experts in biology, biochemistry and chemistry working to reconcile multiple organizational views to achieve an integrated whole. as a result of this work, we have new interoperable versions of each of these two ontologies and a collection of relationships that bridge them. this combined resource has already been used to automatically generate and classify new terms within the go using a web ontology language  representation of the go in conjunction with some specifically designed tools like the obo ontology release tool  and termgenie , which make use of powerful owl reasoners such as elk and hermit  <cit> . we hope that this approach and the lessons learned during our collaboration will provide other ontology developers with a basic roadmap to integrating other ontologies more efficiently.

RESULTS
inherent go chemical ontology
before comparing the go to an external chemical ontology, the inherent chemical representations in the go were checked for internal consistency. we identified inconsistencies that existed within the go using a combination of automated and manual methods. first, we generated a graph in which the chemicals in the go were separated from processes and functions and represented as stand-alone chemicals with relationships that followed the is_a hierarchy in the go . this allowed us to extract the implicit chemical ontology embedded within the go.

we determined that there were eight sub-ontologies in the go where chemical names were frequently used: ‘response to chemical stimulus’ , ‘transport’ , ‘transporter activity’ , ‘metabolic process’ , ‘biosynthetic process’ , ‘catabolic process’ , ‘catalytic activity’  and ‘binding’ , as well as the sub-ontologies representing types of regulation of these processes and functions. when possible, these chemical names were cross-referenced to the chemicals in chebi. relationships in this ‘go chemical ontology’ represented the union of all of the is_a relationships for each sub-ontology of the go.

previous work in deductive and abductive reasoning over relationships asserted between terms from the go and other ontologies has revealed a large number of inconsistencies within the go itself. for example, inconsistent representations of chemicals were found among biological processes and molecular functions   <cit> . this type of error and inconsistency identified in the go’s representation of chemicals during manual review were corrected. this corrected go chemical ontology was then used as a template for coordination with chebi.

differences between the go and chebi
adjustments resulting in concordance of the implicit go chemical ontology with the chebi ontology required two processes. initially, cross-references between the go and chebi were generated by a string-matching algorithm between go terms and synonyms and chebi terms and synonyms. those cross-references were then checked manually during the curation of the go chemical ontology. terms that were not cross-referenced—that is, the implicitly represented chemicals in the go terms for which corresponding terms in chebi were not found—fell into three categories:

 <dig>  terms in the go chemical ontology that referred to existing terms in the chebi ontology, but for which the matches were not detected automatically due to naming differences. during this analysis both term names and synonyms are utilized to determine matches. for example, the go chemical ‘butanoic acid’ should be cross-referenced to the chebi entry ‘butyric acid’ . these terms were identified and cross-referenced manually.

 <dig>  chemicals in go terms that were not represented in chebi.  <dig> temporary terms with internal identifiers were created to represent these chemicals, which have subsequently been incorporated into chebi, where appropriate, via the chebi online submission tool  <cit> .

 <dig>  terms that represented axes other than that of structural chemical classification, e.g., function, disposition or role axes of classification.

resolution of differences between the go and chebi
in addition to cases where chemicals implicitly represented in go terms were not represented in chebi, we also found cases where the chemicals were represented in both the go and chebi, but the representation of chemicals did not match due to differences in the terms themselves or in the hierarchical relationships. these discrepancies reflect deeper differences in the use of chemical terminology and classification between biologists and chemists.

case 1: singular vs. plural terminology
the use of plurals in class names is not generally recommended in ontology construction because it can introduce ambiguity in the meaning of a term and cause problems with string matching when used in conjunction with other ontologies  <cit> . however, chebi uses plural term names to designate families of structurally related molecules that are named after a specific molecule from which they are formally derived. plural names used in this way follow international union of pure and applied chemistry  recommendations and are therefore the accepted way for chemists to refer to these families of structures. for example, ‘pyridines’  encompasses all molecules that contain a pyridine ring, whereas ‘pyridine’  specifically represents the molecule that contains a pyridine ring and has the formula c5h5n. in vernacular english usage, however, a singular noun such as ‘pyridine’ can be ambiguous between the specific sense, corresponding to either ‘pyridine’ in chebi  and to the exact reading in the notation of corbett et al <cit> , or the collective sense corresponding to ‘pyridines’ in chebi  and the class reading. as a result of this ambiguity, the go contained definitions that refer to both class readings, as in ‘phenol metabolic process’ , and to exact readings, e.g. ‘benzene metabolic process’ .

we decided to reconcile this difference in nomenclature by renaming the plural terms as 'x-containing compound' for go chemicals. in the example above, go: <dig> is renamed 'phenol-containing compound metabolic process'. terms of equivalent meaning to the plural terms in chebi can now easily be created in the go. so far,  <dig> terms in the go have been renamed to reflect the new convention.

case 2: representation of complex molecules such as nucleotides and nucleosides
the representation of complex molecules such as nucleotides, nucleosides or liposaccharides was another area that posed problems for the coordination of chebi and the go. the issue arose because there are two main strategies used by chemists to classify molecules. the natural product strategy predates the acceptance of the atomic theory by organic chemists and involves classifying molecules according to their biological histories; hence alkaloids were those nitrogenous molecules extracted from plants, terpenoids are those molecules that have been derived from terpene molecules by chemical modification and so forth. they share a family resemblance, although there is no single structural signature for a given class that allows for its classification. the functional strategy, conversely, involves identifying functional groups, such as carboxy groups or carbon–carbon double bonds within a molecule and assigning the molecule to a functional class such as, in this case, the carboxylic acids or the olefins, respectively. the choice of the name 'functional' is significant because the functional groups pick out those parts of a molecule that are disposed to react in a particular way. but because there is no limit to the number of functional groups within a molecule, there is in principle no limit to the number of functional classes to which a molecule can belong. from a structural point of view, describing these complex chemicals is similar to the story of the blind men and the elephant, where each man describes the elephant as something different depending upon the part he is touching. that is, classification is based on specific parts of the molecule that are attached at different positions. for example, a nucleotide that contains a nucleobase, a sugar and at least one phosphate group would be described as a carbohydrate by a carbohydrate biochemist, who is primarily concerned with the reactivity of the carbohydrate moiety of the molecule, whereas general organic chemists might classify it as a phosphoric ester.

both of the above classifications are correct chemically, but they can lead to incorrect inferences when extrapolated to the process hierarchy in the go. consider ‘nucleotide metabolic process’ , ‘carbohydrate metabolic process’  and ‘phosphate metabolic process’  in the go. if ‘nucleotide metabolic process’  were classified as both is_a ‘carbohydrate metabolic process’  and is_a ‘phosphate metabolic process’  to parallel the structural hierarchy in chebi, then the process that results in the addition of a phosphate group to a nucleotide diphosphate would be misleadingly classified as is_a ‘carbohydrate metabolic process’ . this is misleading because, since the carbohydrate portion of the nucleotide is not being metabolized, biologists would not typically consider this to be a carbohydrate metabolic process.

to avoid this kind of misleading inference, the constituent parts of a nucleotide in chebi are now represented using has_functional_parent assertions instead of explicitly asserted is_a relationships. chebi uses the has_functional_parent relationship to denote the relationship between two molecular entities , one of which possesses one or more characteristic groups and from which the other can be derived by functional modification. thus a nucleoside will be defined as ‘an n-glycosyl compound that has both a nucleobase and either a ribose or deoxyribose as functional parents’. as an extension, both chebi and the go will define a nucleotide as ‘a phosphate ester that has a nucleoside moiety and has at least one phosphate moiety attached to the c- <dig> carbon of the ribose or deoxyribose moiety’.

case 3: representation of acids and their conjugate bases in the go and chebi
another area where the go chemical ontology and chebi failed to agree was in the representation of acids and their conjugate bases. chebi has a detailed representation of acids and conjugate bases with the inclusion of ‘is_con-jugate_acid_of’ and ‘is_conjugate_base_of’ relationships in the ontology. so ‘carboxylic acid’ is_conjugate_acid_of ‘carboxylic acid anion’ and ‘carboxylic acid anion’ is_conjugate_base_of ‘carboxylic acid’. in contrast, in the go, acids and their conjugate bases are often conflated. for example, in the go ‘nitrilotriacetate metabolic process’ is_a ‘carboxylic acid metabolic process’ . the implicit go chemical ontology therefore states that ‘nitrilotriacetate’ is_a ‘carboxylic acid’. from a chemical viewpoint, this is incorrect. ‘nitrilotriacetate’ is the conjugate base of a member of the class ‘carboxylic acid’, ‘nitrilotriacetic acid’. this inaccurate representation in the go reflects the conflated use of nomenclature for acids and their conjugate bases in the biological community because these molecules often readily interconvert as they participate in biological processes. to resolve this issue we have decided to combine the terminology for oxoacids and their conjugate bases in the go, and make these combined entities equivalent to the union of the acid with its conjugate base or bases in an internal file, biochebi . this reflects the convention that when ‘acids’ are referred to in the biochemical literature, they most often refer to molecules that are playing the role of an acid and as such are deprotonated at physiological ph. it also allows for the integration of the go chemical ontology, which is blind to the conjugate acid/base distinction, with a single is_a hierarchy in chebi.

a similar strategy could also be used for terms in other areas of chebi where two chemicals are related to each other using a non-is_a relationship. for example tautomers in chebi are distinguished by the relationship is_tautomer_of and could be treated in a similar manner as the acids and bases. however, we did not find it necessary to implement this strategy since we did not find a confusion of tautomeric structures in the inherent go chemical structure. similarly stereoisomers and salt forms did not present a problem. stereoisomers were already distinguished in the go and the corresponding chebi terms were mapped 1: <dig> 

logical definitions for go terms using chebi terms
go terms were deconstructed and represented as intersections between go terms and relationships to chebi terms. for example, ‘carbohydrate binding’  is represented as the intersection of the generic go molecular function class ‘binding’  and a has_input relationship to the chebi class ‘carbohydrate’ , while ‘carbohydrate metabolic process’  is represented as the intersection of the generic go biological process class ‘metabolic process’  and a has_input relationship to the chebi class ‘carbohydrate’ . as of mid-october  <dig> there are  <dig>  terms in the go that have been defined using chebi chemical entities .

the logical definitions of go terms that reference chemical entities in chebi are maintained in an extended version of the ontology . when a new go term is requested that involves a chemical entity not currently described in chebi, that chemical entity is first given to chebi to be reviewed for inclusion. only when the new class is subsequently added to chebi is the corresponding go term created. it will not be necessary to incorporate every chebi term into the go hierarchy because many chebi terms will not be relevant in the description of natural biological processes. for example, the chebi term ‘nucleoside triphosphate analog’  which includes many chemicals used in biochemical inquiry, but will likely not be incorporated into the go because they do not play roles in natural biological processes.

CONCLUSIONS
in this manuscript we have described the process of resolving two independently developed ontologies for the purpose of knowledge integration and sharing. the integration of chebi and the go benefits both ontologies since it allows for the consistent and accurate representation of chemicals in the go, and for the chemicals represented in chebi to be placed in the natural biological contexts of go processes. this interoperability of ontologies is one of the primary goals of the coordinated development of the group of ontologies that make up the obo foundry  <cit> .

as a result of this work and the close ties that were established between the go and chebi during this process, all new go terms that involve the transport, metabolism, response to chemical entities and homeostasis can be added to the ontology via a new web-based tool called termgenie . termgenie is a template-based, reasoner-assisted term-generation tool. annotators can generate these terms directly by selecting the broad go category  and any term from chebi. missing chebi entities need to be requested from chebi before proceeding. labels, synonyms and textual definitions are generated automatically, using the grammar described above. the new term is placed automatically into the go subsumption hierarchy using the elk reasoner  <cit>  without the need for curator review.

we identified various underlying reasons for most of the discrepancies between the inherent go chemical ontology and chebi. many of the challenges in making separate ontologies such as the go and chebi parallel result from different fields of study having different viewpoints about the importance of certain characteristics that are represented in their terms and about the axis of classification that they use.

another issue we encountered in the alignment of the go and chebi is classification by biological role. chebi contains a ‘biological role’ hierarchy that is separate from its structural, ‘chemical entity’ hierarchy. this hierarchy includes terms such as ‘hormone’ and ‘toxin’, and chemical entities are linked to these roles via the has_role relationship. many of these biological roles are also referenced by the go in terms such as ‘hormone secretion’. however, unlike the structural classification axis, using the ‘biological role’ hierarchy from chebi for the classification of terms within the go subsumption hierarchy is not straightforward because roles are context-specific. for example, in chebi, ‘acetylcholine’ has_role ‘neurotransmitter’ and has_role ‘hormone’. this is because in the brain acetylcholine can act as a neurotransmitter, while in other tissues it can act as a hormone. if this role relationship were to be propagated in the go, that is, asserting ‘acetylcholine secretion’ is_a ‘neurotransmitter secretion’, the go would be in error for instances where acetylcholine was secreted but was acting as a hormone. the alignment of the classification of the go with the chebi roles will be undertaken in a separate project.

the go and chebi also differ when chemicals in the go are classified based on a process in which they are involved. for example, in the go there are terms like ‘aspartate family amino acid biosynthetic process’ that represent the metabolism of amino acid families. these families are not based on the chemical similarities of the amino acids in them, but instead are grouped because they share similar biosynthetic pathways. participation in related pathways is not essentially a structural feature of the molecules involved, and these processes cannot be represented by the chemical structural hierarchy of chebi. however, neither do such groupings easily correspond to chebi role terms, since the chemicals are not necessarily active in the pathways involved, as they might, for example, be created by the relevant pathway, and be otherwise quite inert themselves with respect to the operation of the pathway. these pathway-derived chemical classifications will remain in the go, and for the time being will not be cross-referenced with chebi, although such cross-referencing could constitute a task for the future.

we have described here a generic approach to integrating two ontologies that will be used for future projects coordinating the go with other external ontologies. before examining relationship concordance, ontology terms should be compared to ensure that the entities that are common to the two ontologies represent the same things and that all of the entities that are implicitly represented in the ontology whose terms are being formally defined are explicitly represented in the external ontology whose terms are being used in the definitions. next, systematic differences in the construction rationale of the ontologies should be identified and a rational strategy should be put into place where those differences will be retained. finally, coordinated curation should be used to identify or question relationship differences in the two ontologies. the final process is continuous and mechanisms should be put into place that will allow inconsistencies that crop up to be resolved.

this work is the first part in the integration of chebi and the go. the next stage will be to describe the enzymatic reactions in the go in terms of the chebi entities that participate in them. for example, the molecular function ‘aspartate dehydrogenase activity’ is defined as ‘catalysis of the reaction: l-aspartate + h2o + nad+ = oxaloacetate + nh <dig> + nadh + h+’. we intend to leverage the data in rhea, a manually curated reaction database in which all reaction participants are chebi entities  <cit> , to create the logical definitions of go molecular functions. these definitions will allow us to classify enzymatic reactions automatically based on the chemicals that participate in them; to make better links between biological processes and the reactions that are their parts; and to import new, manually curated reactions directly from rhea into the go, and allow them to be automatically classified.

