BACKGROUND
transcription regulatory networks can be represented as directed graphs in which a node stands for a gene  and an edge symbolizes a direct transcriptional interaction. recurrent patterns of interactions, termed network motifs, occur far more often than in randomized networks, forming elementary building blocks that carry out key functions. this is a convenient representation of the architecture of a set of regulatory boolean  networks, in which each gene is either fully expressed or not expressed at all, or that it has a binding site for a transcriptional regulator or lacks such a site. however, this approach has serious limitations because most genes are not expressed in a simple boolean fashion. indeed, genes that are co-regulated by the same transcription factor are often differently expressed with characteristic expression levels and kinetics. therefore, a deeper understanding of regulatory networks demands the identification of the key features used by a transcriptional regulator to differentially control genes that display distinct behaviours despite belonging to networks with identical motifs.

the identification of the promoter features that determine the distinct expression behavior of co-regulated genes is a challenging task because: first, these features are often short combinations of a constrained four-symbol dna alphabet. therefore, it is not clear how to distinguish a sequence pattern that could affect gene expression from a just slightly different random sequence  <cit> . second, the sequences recognized by a transcription factor may differ from promoter to promoter within and between genomes and may be located at various distances from other cis-acting features in different promoters  <cit> . third, similar expression patterns can be generated from different or a mixture of multiple underlying features, thus, making it more difficult to discern the causes of analogous regulatory effects.

in this study, we present a method specifically aimed at handling the variability in sequence, location and topology that characterize gene transcription. we decompose a feature into a family of models or building blocks that uncover important differences among observations that are often concealed when using global patterns that tend to average sequences between promoters and even across species. this approach maximizes the sensitivity of detecting those instances that weakly resemble a consensus  without decreasing the specificity. in addition, features are considered using fuzzy assignments, which allow us to encode how well a particular sequence matches each of the multiple models for a given promoter feature. individual features can be linked into more informative composite models that can be used to explain the kinetic expression behavior of genes.

we applied our method to analyze promoters controlled by the phop/phoq regulatory system of escherichia coli and salmonella enterica serovar typhimurium. this system responds to the same inducing signal  in both species  <cit> . moreover, the e. coli phop gene could complement a salmonella phop mutant  <cit> . the dna-binding phop protein appears to recognize a tandem repeat sequence separated by  <dig> bp  <cit> , consistent with being a dimer  <cit> . the phop/phoq system is an excellent test case because it controls the expression of a large number of genes, amounting to ca. 3% of the genes in the case of salmonella  <cit> . furthermore, the phop/phoq regulon has been shown to employ a variety of network motifs including the single-input module , the multi-input module , the bi-fan , the chained , and the feedforward loop   <cit> . our analysis uncovered the salient features that distinguish genes co-regulated by phop belonging to similar networks. gene transcription measurements provided experimental support for the investigated predictions.

RESULTS
approach
we investigated five types of cis-acting promoter features by extracting the maximal amount of useful information from datasets and then creating models that describe promoter regulatory regions. this entailed applying three key strategies: first, we conducted an initial survey of the data provided from different available sources, capturing and distinguishing between broad and easily discernable patterns. we then used these patterns as models to re-visit the data with greater sensitivity and specificity. this allowed us not only to recognize those instances with a low resemblance to consensus models, but also to reflect and annotate the diversity of the observations . second, we utilized fuzzy clustering methods  <cit>  to encode promoter matching to multiple models for a given promoter feature, which avoided having to make premature categorical assignments, and producing an initial classification of the promoters into multiple subsets. finally, we applied fuzzy logic  <cit>  to relate some basic features into more informative composite models that may explain the distinct expression behavior of genes belonging to similar networks . a distinguishing characteristic of our approach is that promoters for orthologous genes are considered individually. this is in contrast to some phylogenetic footprinting methods  <cit>  that often ignore regulatory differences among closely-related organisms due to their strict reliance on the conservation of regulatory motifs across bacterial species.

activated/repressed promoters
gene expression data normally allow clear separation of genes into those that are activated and those that are repressed by a regulatory protein. because the expression signal is sometimes absent or too low to be informative, we considered the location of a transcription factor binding site relative to that of the rna polymerase to separate promoters into activated and repressed subsets   <cit> .

we determined that the location of binding sites functioning in activation is different from that corresponding to sites functioning in repression , being centered ~ <dig> and ~ <dig> bp upstream of the transcription start site, respectively. this allowed us to distinguish among phop-regulated promoters that have apparently similar network motifs . for example, we identified a phop binding site at a relative distance to the rna polymerase consistent with repression in the promoter region of the hila gene, which encodes a master regulator of salmonella invasion and had been known to be under transcriptional repression by the phop/phoq system  <cit> . several promoters, including those of the salmonella pipd and nmpc genes, were classified as candidates for being both activated and repressed, because the distance between the predicted transcription start site and the phop box is consistent with either activation or repression. gene expression experiments conducted in e. coli indicate that nmpc is a phop-repressed gene  <cit> . other promoters were predicted to have more than one phop box , where by their location one could correspond to an activation site and the other to a repression site  <cit> .

transcription factor binding site orientation
functional binding sites for a transcription factor may be present in either orientation relative to the rna polymerase binding site  <cit> . this is due to the possibility of dna looping and to the flexibility of the alpha subunit of the bacterial rna polymerase in its interactions with transcriptional regulators  <cit> . yet, promoters harboring binding boxes in different orientation can be controlled by phop using the same network motif. that is the case of the yobg, and slyb , compared to pagk and pagc  salmonella promoters . analysis of phop-regulated promoters revealed that the phop box could be found with the same probability in either orientation in the intergenic regions of the e. coli and salmonella genomes . for example, the e. coli ompt and yhiw promoters and the salmonella mig- <dig>  pipd, pagc and pagk promoters harbor putative phop binding sites in the opposite relative orientation to that described for the prototypical phop-activated mgta promoter  <cit>  . yet other promoters  contain sequences resembling the phop box in both orientations. the demonstration that phop does bind to the mgtc, mig- <dig> and pagc promoters  <cit> , which harbor the phop binding site in the opposite orientation as in the mgta promoter, validates our predictions and argues against alternative network designs where these promoters would be regulated by phop only indirectly  <cit> .

transcription factor binding site patterns
many genes are controlled by a single-input network motif where the affinity of a transcription factor for its promoter sequences is a major determinant of gene expression. thus, co-regulated genes displaying distinct expression patterns are likely to differ in the binding site for such a transcription factor . methods that look for matching to a sequence motif have been successfully used to identify promoters controlled by particular transcription factors  <cit> . however, the strict cutoffs used by such methods increase specificity but decrease sensitivity  <cit> , which makes it difficult to detect binding sites with weak resemblance to a global sequence pattern  <cit> .

we decomposed set of binding site sequences corresponding to a transcription factor into several patterns and then combined them to increased the sensitivity to weak sites without losing specificity . in the case of phop, we used this approach to search both strands of the intergenic regions of the e. coli and salmonella genomes . this allowed the recovery of promoters, such as that corresponding to the e. coli hdea gene or the salmonella pmrd, that had not been detected by the single position weight matrix model  <cit>  despite being footprinted by the phop protein  <cit> . the use of four patterns instead of a single consensus increased the sensitivity for phop binding sites from 46% to 74%; yet, the specificity remained essentially the same . importantly, this approach is not exclusive to binding sites recognized by the phop protein, but for other transcription factors reported in the regulondb database  <cit> , where we could increase the sensitivity in an average of 35%, while retain almost the same sensitivity than a single position weight matrix .

riboswitch site patterns
riboswitches are structured domains that usually reside in the non-coding regions of mrnas , where they bind specific metabolites and control gene expression. the most common effects occur at the level of premature termination of transcription  or translation initiation. upstream regions of phop regulated genes were screened for riboswitches by analyzing the presence of segments with conserved secondary structure across genomes and thermodynamic stability; because rfam  searches did not produce significant hits. then, we evaluate if these candidate segments could be either small non-coding rna or riboswitches, depending on their relative location to the beginning of the gene. those candidates with conserved helixes, stable thermodynamically energy, and located close  to the translation start site of the closest gene, were further inspected as possible riboswitches. we found several genes with a long utr region as possible candidates . one of these genes is the salmonella mgta promoter, which has been experimentally validated   <cit>  showing that the dna corresponding to a  <dig> nucleotide riboswitch confers mg2+ regulation when cloned in front of a reporter gene and behind a derivative of the lac promoter. again, phop uses a similar network architecture to control promoters with differentially arranged regulatory regions .

rna polymerase binding site patterns and location
the distance of a transcription factor binding site to the rna polymerase binding site and the class of sigma  <dig> promoter are critical determinants of gene expression  <cit> . these classes correspond to the different types of contacts that can be established between a transcription factor and rna polymerase. we identified six patterns among phop-regulated promoters of e. coli and salmonella  that combine promoter class and distance between the phop box and the rna polymerase site . these patterns may correspond to a similar network motif, as it is the case of the ugtl and pagc promoters, which share the orientation of the phop box but differ in the distance of the phop box to the rna polymerase binding site  <cit>  .

some phop-regulated promoters  contain several putative rna polymerase binding sites located at different positions and belonging to different classes, suggesting that such promoters may be regulated by additional signals and/or transcription factors  <cit> . the rna polymerase site feature was evaluated using  <dig> rna polymerase sites from regulondb as positive examples and  <dig> random sequences as negative examples. we obtained an 82% sensitivity and 95% specificity for detecting rna polymerase sites. these values provide a false discovery rate < <dig>  and a correlation coefficient of 82%. in addition, we selected  <dig> examples of rna polymerase sites reported to be of class ii, which all differ from the typical class i promoter by exhibiting a degenerate - <dig> sequence motif  <cit> , and obtained 74% sensitivity and 95% specificity.

binding sites for other transcription factors
certain promoters harbor binding sites for more than one transcription factor. this could be because transcription requires the concerted action of such proteins, or because the promoter is independently activated by individual transcription factors, each responding to a distinct signal.

we analyzed the intergenic regions of the e. coli and salmonella genomes for the presence of binding sites for  <dig> transcription factors  <cit> . we then investigated the co-occurrence of  <dig> sites with the binding site of the phop protein in an effort to uncover different types of network motifs involving phop-regulated promoters. for example, the salmonella pmrd, ugd and yrbl promoters and the e. coli yrbl promoter harbor phop- and pmra-binding sites, consistent with the experimentally-verified regulation by both the phop and pmra proteins that can be described by the bi-fan network motif  <cit>  . in addition, the relative position of transcription factor binding sites  can play a critical role because the pmra-box in the salmonella pmrd and yrbl promoters is located closer to the phop-box  than in the udg promoter . by analyzing both the binding site quality and the location of transcription factor binding sites, we increase the chances of identifying co-regulated promoters.

by considering the presence of binding sites for multiple transcription factors, it is possible to generate hypotheses about potential network motifs. for example, the promoters of the phop-activated gada, dps, hdea, yhie and yhiw genes of e. coli also have binding sites for the regulatory proteins yhix and yhie  <cit> , raising the possibility that some of these genes might be regulated by feedforward loops where both the phop protein and either the yhiw or the yhie proteins would bind to the same promoter to activate transcription. this notion was experimentally verified  <cit> , validating our prediction.

evaluating the effect of distinct cis-regulatory features within a network motif
gene expression is often measured by binary assays that evaluate differentials between wild-type and mutant strains . these experiments always help to differentiate activated from repressed genes, and sometimes very low from very highly expressed genes. however, these approaches often conceal quantitative differences between true expressed genes. we hypothesize that distinct promoter features may affect gene expression even in similarly arranged network motifs. to test this notion, we compared the gene expression patterns of wild-type salmonella harboring plasmids with a transcriptional fusion between a promoterless gfp gene to different phop-activated promoters .

we found that promoters that differ in the orientation of the phop binding site and are arranged in a similar network motif such as slyb and pagc produce a complete different patterns of expression . moreover, single-output network motif including the phop and the pmrd genes , which exhibit different phop box patterns, reveal a substantial different levels of promoter activity as measured by gfp kinetics . within the same network motif, we also evaluated the mgta promoter and found that without specific primers for the 5'-utr region the gene is unable to transcribe . this suggests that the riboswitch located in the promoter region of mgta is a critical feature that distinguishes promoters within the similar network . the ugtl and pagc promoters share the orientation and the phop box but differ in the distance of the phop box to the rna polymerase binding site . this may account for the different kinetic behavior of these promoters when tested in a wild-type strain harboring plasmids with promoter fusions to the promoterless gfp gene .

we also realized that the expression patterns differ in other types of network motifs such as the bi-fan. the salmonella pmrd and ugd promoters harbour experimentally validated phop- and pmra-boxes  <cit>  , and both promoters confer distinct levels of expression as well as kinetic patterns . although it is hard to discern the specific and individual influence of each type of cis-feature, the preliminary results obtained by gfp experiments suggest that those regulatory elements described above can effectively produce differential gene expression even within similar network motifs.

CONCLUSIONS
we demonstrated that a transcription factor could mediate differential expression of genes described by the same network motif. this is because of the functional significance of variability in sequence, location and topology that exists among promoters that are co-regulated by a given transcription factor. we developed methods that encode and combine these promoter features, which allows matching of cis-observations to multiple models for a given promoter feature, into flexible databases constituting annotations of genome regulatory regions. these annotations cannot be uncovered by simpler sequence analysis approaches . indeed, the developed methods can be used to search and predict regulatory features even in incompletely characterized organism. notably, these features do not constitute a computational artifact, but reflect different kinetic behaviours of co-regulated genes.

global transcriptional regulators control multiple promoters by a variety of network motifs  <cit> . this is clearly the case for the regulatory protein phop . in this work, we studied this regulatory protein and demonstrated that understanding gene expression does not only require identifying a set of connexions or network motif, but also the cis-acting elements participating in each of these connexions.

materials and methods
our method consists of three phases: first, encoding the available information into preliminary model-based features, which includes identifying cis-features from dna sequences and information from available databases; performing initial modeling of each individual feature, allowing the process of multiple occurrences of a feature and using relaxed thresholds and permitting missing values. a model-based feature is generated by the identification of a feature in a subset of observations  in the dataset, based on measuring the degree of match  between an observation and a model, or a family of models , at some degree  defined in a unit-interval scale )  <cit> . second, grouping the results into subsets, thus, decomposing the preliminary models into a family of models or building blocks by using fuzzy clustering . third, composing the building blocks by either combining the same or different types of features by using fuzzy logic expressions . and fourth, describing new promoters using the resulting models.

network motifs
in theory, the term "network motifs" is related to a statistical significant subgraph; however, in practice, they are treated as an over represented subgraph  <cit> . for example, a motif termed "single input motif " of three/four nodes in the e. coli  or saccharomyces cerevisiae network  <cit>  is not recognized as significant, while the only motif that exceeds the standard threshold is the "feed forward motif".

activated/repressed
we modeled phop-regulated promoters as activated or repressed based on examples reported in the regulondb database  <cit> .  we separately grouped activated and repressed promoters, and plotted histograms for each group corresponding to the distances between transcription factor binding sites and the transcription initiation  site.  we distinguished two non-disjoint distributions in each group and built models for these distances by fitting histograms with fuzzy membership functions  <cit>   , which do not force promoters to be exclusively activated or repressed.  finally, we connected  and sigma  <dig> promoters previously detected to select the most representative candidate for each promoter condition  by using fuzzy logic-based operations , which also have a probabilistic interpretation ), to characterize relationships between predicted phop and rna polymerase binding sites detected in candidate promoters . simple features, such as activated and repressed can be combined in more complex composite models to represent divergently transcribed genes  using fuzzy logic expressions .

binding site patterns and orientation
 we built an initial model for the phop binding site by learning a position weight matrix  <cit>   based on the upstream sequences of genes corresponding to the training set of the e. coli and salmonella genomes .  we searched the intergenic regions of the genes in both orientations, using low thresholds corresponding to two standard deviations below the mean score obtained with the initial model  <cit> . multiple phop binding site candidates were allowed in a given promoter operator region.  after transforming nucleotides into dummy variables  <cit> , we grouped sequences matching the phop position weight matrix using the fuzzy c-means clustering method with the xie-beni validity index  to estimate the number of clusters  <cit> .  we built models for these clusters using position weight matrices  and searched the e. coli and salmonella genomes to characterize each gene according to its similarity to each model as a fuzzy partition .

riboswitch site patterns
 we employed upstream regions of phop regulated genes to create conserved sequence aligments by comparisons against representative proteobacterial genomes. we used wu blast  <dig>   <cit>  with a word hit of eight, and using default parameters otherwise.  we selected alignments with an e-value ≤  <dig>  and a length ≥  <dig> nt; and divided alignments longer than  <dig> bp into windows of  <dig> bp with  <dig> bp of overlap.  these windows fed the programs eqrna and rnaz following the protocol described in  <cit>  using a window size of  <dig> nucleotides and a window slide increment of  <dig> nucleotides. qrna analysis was performed with eqrna version  <dig> .3c. ().  we classified the alignment as rna, coding, or other, according to the bayesian posterior probability of each model. rnaz was used with its version  <dig> . <dig> . we only considered overlapping eqrna and rnaz predictions for the upstream regions of phop regulated genes as candidates for small non-coding rna or riboswitches.  we encoded the conservation identity of the segments and their distance to the translation start site of the closest gene as fuzzy sets; and aggregated them using fuzzy expressions .  all fuzzy expressions of a single gene were combined using the maximum t-conorm .

rna polymerase sites
 we gathered sigma  <dig> class i and class ii promoters  <cit>  from the regulondb database and  <cit> . then, we built models of the rna polymerase site using a neuro-fuzzy method , and used the resulting models to perform genome-wide descriptions of the intergenic regions of the e. coli and salmonella genomes with a false discovery rate < <dig>  .  we used an intelligent parser to differentiate class i and class ii promoters that evaluate the quality of the - <dig> motif  <cit> , based on fuzzy logic  and genetic algorithms techniques .  to characterize the distance relationship between transcription factors binding sites and rna polymerase binding sites, we built models of such distances from the examples reported in the regulondb database.  we modeled activated and repressed promoters .  we re-built histograms for each group of distances , distinguishing three overlapping distributions for each of them. we built models for distances by fitting their distributions into models based on fuzzy membership functions  <cit>  , which were termed close, medium and remote distances for each set of activated and repressed genes . finally, to characterize the distance relationship between the phop box and putative rna polymerase binding site, we connected  and  by using fuzzy logic-based operations .

this process allowed us to retrieve the most representative rna polymerase binding site candidates for each promoter region relative to the phop binding site , which were arrayed and constituted the value of the rna polymerase site feature in fig.  <dig>  the probabilistic interpretation of the former process is usually the posterior probability  that, given a close promoter, it comes from class "class ii" by following bayes' rule  <cit> ). this process is analogous to classification methods termed naïve bayes  <cit>  if the t-norm and the t-conorm  are restricted to the product and the maximum.

binding sites for other transcription factors
we developed models for different transcription factor binding sites from the regulondb database as follows:  we built position weight matrices for each transcription factor using the consensus/patser program, choosing the best final matrix for motif lengths between 14– <dig> bps if the corresponding length had not been previously specified . we accounted for the motif symmetry  if available .  we searched the intergenic regions of the e. coli and salmonella genomes with these models, using the correlation coefficient measure  and additional  <dig> promoters from the regulondb database  <cit>  to establish a threshold  for each matrix  <cit>  .  we accounted for the distances between distinct transcription factors binding sites occurring in the same promoter region  in promoters reported in regulondb database and built a histogram with the obtained results .  we fitted the histogram using a fuzzy membership function  and used this model as a fuzzy cluster to characterize the distances between a putative phop box and another putative transcription factor binding site detected in the same region.  finally, we connected  and  by using fuzzy logic-based operations , which can also have a probabilistic interpretation  upstream of the prop open reading frame of e. coli), to characterize phop regulated candidates promoters.

dataset
we initially used the intergenic regions of e. coli and salmonella operons from - <dig> to + <dig> because > 5% are larger than  <dig> bp in bacterial genomes   <cit> ; however, predictions have been performed in whole coding and non coding regions . the promoter and transcription factor information was taken from regulondb database. we compiled from the literature and our own lab information  genes whose expression  differed statistically between wild-type and phop e. coli strains experiencing inducing conditions for the phop/phoq regulatory system  <cit> , as well as a list of genes known/assumed to be phop regulated  <cit> . however, this information did not explicitly indicate whether these genes were regulated directly or indirectly by the phop protein. the learned features were used to make genome-wide predictions in the e. coli and salmonella genomes.

programming resources
the scripts and programs used in this work, some of which are accessible from  web site, were based on perl, matlab r2006a and c++ interpreters/languages, and the visualization routines were performed on spotfire decisionsite software  <dig> . data and predictions for e. coli and salmonella genomes are available at supplemental table s <dig> in additional file  <dig> and at .

bacterial strains, plasmids and growth conditions
bacterial strains and plasmids used in this study are listed in table s <dig>  additional file  <dig>  salmonella enterica serovar typhimurium strains used in this study are derived from strain 14028s. bacteria were grown at 37°c in luria-bertani broth   <cit>  or n-minimal medium ph  <dig>   <cit>  supplemented with  <dig> % casamino acids,  <dig> mm glycerol, mgcl <dig>  kanamycin was used at  <dig> μg/ml.

constructions of gfp reporter plasmids
promoter regions  were amplified using pcr. a list of the promoter-specific primers used in the pcr reactions is shown in table s <dig>  additional file  <dig>  the pcr fragment was digested with bamhi and xhoi, purified, then introduced to the cloning site of pms <dig> . sequences of promoter region were verified by nucleotide sequencing.

measurements of promoter activity and growth kinetics for gfp reporter strains
promoter activity and growth kinetics of wild-type salmonella strain harboring gfp reporter plasmid was measured in parallel using automated microplate reader   <cit> . overnight cultures of strains in n-minimal medium with  <dig> mm mgcl <dig> and  <dig> μg/ml of kanamycin were washed with the same medium without mgcl <dig> then diluted  to 96-well plate  containing  <dig> μl of n-minimal media supplemented  <dig> μm mgcl <dig>  after overlaying the wells with  <dig> μl of mineral oil  to prevent evaporation of media, the plate was inserted in the victor <dig> machine pre-warmed to 37°c. the fluorescence and optical density  of cells were recorded with shaking of the plate , and this protocol was repeated every  <dig> min for  <dig> times. the background fluorescence was measured using a strain carrying empty vector and subtracted from the test values. each experiment was conducted independently twice, and a representative is shown in the figures.

data preprocessing
the raw gfp and od signals were used to calculate the promoter activity as /odi. the activity signal was then smoothed by a shape-preserving interpolant  fitting algorithm that finds values of an underlying interpolating function at intermediate points that are not described in the experimental assays. then, we applied a polynomial fit  on each expression signal. this smoothing procedure captures the dynamics well, while removing the noise inherent in the differentiation of noisy signals.

competing interests
the authors declare that they have no competing interests.

authors' contributions
oh and iz designed and implemented the methods and wrote the manuscript; cv designed and implemented the riboswitch identification methods; rrz coded the perl scripts and the web page; ds performed the experimental validation using gfp technology; hh provided advice on the project and revised the manuscript; eag supported the project and drafted the manuscript.

supplementary material
additional file 1
supplemental tables. table s <dig> provide the features describing phop regulated promoters and raw data used to build them. table s <dig> details the bacterial strains and plasmids used in this study, and table s <dig> the primers used to construct the promoters in gfp reporter plasmids.

click here for file

 acknowledgements
we thank u. alon  for plasmid pms <dig>  and elena rivas  for providing the computational tools to identify riboswitches. this research was supported in part by the spanish ministry of science and technology under project tin2006- <dig> and by consejería de innovacion, investigación y ciencia de la de la junta de andalucía under project tic <dig>  e.a.g. is an investigator of the howard hughes medical institute.

this article has been published as part of bmc bioinformatics volume  <dig> supplement  <dig>  2009: proceedings of the ieee international conference on bioinformatics and biomedicine   <dig>  the full contents of the supplement are available online at .
