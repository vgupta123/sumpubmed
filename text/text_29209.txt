BACKGROUND
although the costs of genome sequencing have declined dramatically, full genome sequencing efforts are still impractical for many nonmodel species. in such cases, transcriptome sequencing provides a greatly informative and cost effective alternative  <cit> . expressed sequence tag  sequencing has been used in a variety of species for single nucleotide polymorphism  discovery  <cit> , gene discovery and annotation  <cit> , and expression analysis  <cit> .

while previous studies relied extensively on available genome or transcript data generated by sanger est sequencing, more recent results have used  <dig> technology to perform de novo assembly of transcriptomes. in  <dig>  vera et al. sequenced ests of melitaea cinxia using  <dig> gs <dig> technology, producing  <dig>  contigs and singletons , or "unigenes," representing an estimated 50% of the transcriptome  <cit> . novaes et al. and cheung et al. in the same year reported  <dig> est assemblies for eucalyptus grandis  <cit>  and the plant pathogen, pythium ultimum  <cit> . in  <dig>  meyer et al. assembled the transcriptome of larval coral, acropora millepora, to an average contig coverage of 5×  <cit> , and roeding et al. assembled the the transcriptome for the emperor scorpion, pandinus imperator, to an average contig coverage of 9×  <cit> , the highest of  <dig> transcriptome studies to date. these assemblies reinforce previous results that suggest  <dig> est sequencing produces evenly covered transcripts with error rates mitigated by deep coverage  <cit> .

other published lepidopteran est projects include those for wing discs of adult heliconius erato  <cit>  and foreleg tarsi of papilio xuthus  <cit> ; both used sanger based sequencing. in this paper, we present de novo larval full-body transcriptome assemblies for two butterflies: the propertius duskywing, erynnis propertius , and the anise swallowtail, papilio zelicaon .

study species
e. propertius is in the family hesperiidae , a distinct branch of the butterflies called "skippers." p. zelicaon is in the family papilionidae  and is more closely related to all other butterflies than to any skipper. erynnis propertius and p. zelicaon co-occur in coastal, oak  habitats containing native wildflowers that range from baja california, mexico northward into southwestern british columbia  <cit> . erynnis propertius, an oak specialist, is restricted to this range, whereas p. zelicaon also occurs further eastward and northward in the rocky mountains feeding on plants in the family apiaceae  <cit> .

previous studies suggested that these species are differentiated across their range with populations at the northern range boundary being diverged from more central populations  <cit> . zakharov and hellmann  <cit>  suggested that these differences could allow local adaptation of northern populations, possibly to local climatic conditions, and that these local adaptations could undermine the assumption that northern populations will increase under climate warming. hellmann et al.  <cit>  and pelini et al.  <cit>  investigated this possibility with a series of translocation experiments and found greater evidence for local adaptation of northern populations in e. propertius than p. zelicaon. pelini et al.  <cit>  also found that climate affects fitness on alternate host plants, switching the relative value of host species under different climate treatments in p. zelicaon.

before we performed  <dig> sequencing, there were no genetic data for these species with the exception of microsatellites  <cit> , mitochondrial genes, and select genes identified in other papilio . when compared to other transcriptomes or genomes of lepidoptera that have been entirely sequenced, e. propertius and p. zelicaon can offer new insights into the systematics and genomics of a group that has been widely recognized for its utility in ecology and evolutionary biology  <cit> . in addition to advancing comparative genomics in lepidoptera, sequencing the transcriptomes of two co-occurring species with known ecology offers many future research opportunities in ecology and ecoinformatics.

the mrna of whole larvae were extracted for sequencing for two reasons: 1) because larvae are a key bottleneck in the population dynamics and fitness of individual butterflies  <cit>  and 2) to complement previous studies by our group that measure larval fitness under differing climatic conditions  <cit> . the immediate aim of transcriptome sequencing was construction of a microarray enabling comparison of transcribed genes under alternate climate treatments and of populations from differing geographic locations.

adult females were collected from  <dig> and  <dig> populations of e. propertius and p. zelicaon, respectively, near the latitudinal center of the species' distributions . in total,  <dig> larvae of e. propertius and  <dig> larvae of p. zelicaon were pooled prior to sequencing, representing a minimum of  <dig> and a maximum of  <dig> wild mothers in e. propertius and exactly  <dig> wild mothers for p. zelicaon. to build a robust microarray for the study of larval biology, steps were taken to maximize gene discovery within the larval stage. multiple larval instars were sampled, and individuals were exposed to a variety of stress and host plant treatments to elicit genes important in the life history of larvae .

RESULTS
sequencing and assembly
half of one picotiter plate of a  <dig> flx sequencing run generated  <dig>  ests of e. propertius. reads were cleaned and vector trimmed with standard seqclean  <cit>  protocol . in total,  <dig>   e. propertius ests passed the cleaning process, with an average length  <dig> bp and median length  <dig> bp.  <dig>   ests of p. zelicaon passed cleaning, having an average length of  <dig> bp and median length  <dig> bp. these data are publicly available at the ncbi sequence read archive .

we ran the cleaned est datasets through cap <dig> as well as the celera assembler, experimenting with parameter settings for each . using default parameter settings, cap <dig>  <cit>  produced fairly large assemblies-- <dig>  mbp for e. propertius. although we wish to avoid collapsing paralogs, large assemblies indicate separately assembled alleles  <cit> . using custom parameters for cap <dig>  we reduced assembly sizes somewhat, but this still produced a large percentage of singletons . celera assembler  <cit>  produced a  <dig>  mbp assembly for e. propertius using the recommended settings for  <dig> flx titanium reads  <cit> . using custom settings with the celera assembler produced assemblies with the smallest overall assembly size and highest average ortholog hit ratio, a measure of assembly quality . the size of this final assembled e. propertius transcriptome  is similar to that previously produced for the related butterfly species m. cinxia . while the final p. zelicaon assembly is somewhat larger , differences in assembly size between assemblers and parameter sets were similar to those seen for e. propertius.

the custom celera assembly for e. propertius resulted in  <dig>  contigs and  <dig>  singletons, for a total of  <dig>  unigenes. both the average contig length and average singleton length are noticeably larger than previous studies  <cit>  at  <dig> bp and  <dig> bp, respectively. cleaned p. zelicaon ests assembled into  <dig>  contigs  and  <dig>  singletons . the larger number of unassembled singletons for p. zelicaon may be due to mitochondrial rrna sequences . figure  <dig> shows the distributions of contig and singleton lengths for both species; other detailed assembly statistics also are found in table  <dig> 

average  contig coverage was 10×  for e. propertius and  <dig> ×  for p. zelicaon. figure  <dig> shows the contig coverage distributions for the two transcriptomes and the average sequence length for contigs within each coverage bin on a log scale. as expected and as found in previous studies  <cit> , there was a positive correlation between contig length and the number of reads incorporated . figure  <dig> also shows that contigs with very high coverage  tend to be shorter in length.

annotation
bombyx mori, gene assembly completeness
we compared the unigene sets to the predicted protein database for bombyx mori, the silkworm, for which full genome data are available . this reference dataset contains  <dig>  predicted b. mori proteins. of the  <dig>  e. propertius unigenes,  <dig>  had blastx  <cit>   hits to  <dig>  unique b. mori predicted proteins.  <dig>  unigenes hit more than one b. mori protein .  <dig>  b. mori proteins were hit by more than one unigene . of the  <dig>  p. zelicaon unigenes,  <dig>  hit  <dig>  unique b. mori predicted proteins;  <dig>  hit more than one protein , and  <dig>  proteins were hit by more than one unigene . figure  <dig> shows the distribution of  <dig> categories for gene ontology terms, each categorized into three higher level categories, associated with the unigenes and the b. mori dataset .

for the purposes of this study, we consider each unigene and its best b. mori blastx hit to be orthologs, and we consider the hit region in the unigene to be a conservative estimator of the "putative coding region." thus, we can compute the percentage of a unigene found by dividing the length of the putative coding region by the total length of the ortholog. this ratio, which we call the "ortholog hit ratio," is described in figure  <dig>  the assumption is that the unigene and its best hit are orthologs and not paralogs or some other mis-association. using the conservative, blast based annotation to find putative coding regions, as opposed to non-comparative methods such as estscan  <cit> , ensures that hit ratios are not overestimated.

the ortholog hit ratio gives an estimate on the amount of a transcript contained in each unigene. if there are relative insertions in best hit b. mori proteins, this will tend to lower ortholog hit ratios, whereas relative insertions in unigenes will artificially inflate ortholog hit ratios. ortholog hit ratios greater than  <dig>  likely indicate large insertions in unigenes.

figures  <dig> and  <dig> show ortholog hit ratio in terms of assembly coverage of unigenes . for e. propertius contigs with less than the median assembly coverage of  <dig> ×, the average ortholog hit ratio was  <dig> . for those with greater than median coverage, the average ratio was  <dig> . the corresponding averages for p. zelicaon were  <dig>  and  <dig> , respectively. thus, completeness of unigene assembly is partially governed by assembly coverage as expected.

figures  <dig> and  <dig> relate ortholog hit ratio to the length of the b. mori ortholog. as found in other studies  <cit> , completeness of gene discovery decreases as length of the gene increases. vertical tracks in figures  <dig> and  <dig>  comprised mostly of singletons, likely indicate regions of the genome that failed to assemble . finally, figures  <dig> and  <dig> show the overall distributions of ortholog hit ratios for contigs and singletons. overall,  <dig>  of the  <dig>  e. propertius unigenes having a hit to b. mori had ratio >  <dig> , and  <dig>  had ratio >  <dig> . of the  <dig>  p. zelicaon unigenes with b. mori hits,  <dig>  had ratio >  <dig>  and  <dig>  had ratio >  <dig> .

other lepidoptera and insecta
we also compared unigene sets to protein databases for drosophila melanogaster , containing  <dig>  sequences and heliconius erato , containing  <dig>  sequences. drosophila melanogaster proteins represent a well annotated insect transcriptome, and the h. erato database represents protein predictions based on tissue-specific sanger est data obtained from the wing discs of adults  <cit> . while this tissue-specific dataset is not as complete as the d. melanogaster protein dataset, comparison to the more related p. zelicaon and less closely related e. propertius reveals interesting differences.

 <dig>  e. propertius unigenes had blastx hits  to h. erato proteins.  <dig>  had hits to d. melanogaster proteins.  <dig>  p. zelicaon unigenes hit h. erato proteins, a much larger percentage , and  <dig>  hit d. melanogaster.

the bars in figure  <dig> show the relative proportion of high coverage contigs , low coverage contigs , and singletons for each area in the venn diagram.

unigenes that hit to all three databases tend to have high coverage, while those that only hit the most related species  tend to have low coverage or are singletons.  <dig>  e. propertius singletons and  <dig>  contigs with average coverage of 8× had no hits to these protein databases. for p. zelicaon,  <dig>  singletons and  <dig>  contigs with average coverage of  <dig> × had no hits.

we also compared the unigene sets to recently sequenced whole larval melitaea cinxia ests  <cit>  and foreleg tarsi papilio xuthus ests  <cit> . although there is no protein, assembly, or annotation information publicly available for these datasets, we expect some similarity given phylogenetic distance.  <dig>  e. propertius unigenes had tblastx hits  to  <dig>  unique m. cinxia ests.  <dig>  p. zelicaon unigenes had hits to  <dig>  unique m. cinxia ests . as expected, many more p. zelicaon unigenes had hits to p. xuthus-- <dig>  e. propertius unigenes hit  <dig>  unique p. xuthus ests, while  <dig>  p. zelicaon unigenes hit  <dig>  unique p. xuthus ests .

clustering
to test whether incomplete assembly could account for the large proportion of singletons that hit only h. erato , we aggressively clustered unigenes by creating "association graphs" of best hits of unigenes to unigenes, unigenes to h. erato proteins, and unigenes to b. mori proteins. unigenes in the same connected component were considered a cluster . e. propertius unigenes produced  <dig>  clusters,  <dig>  of which contained only a single unigene. the largest e. propertius cluster contained  <dig> singletons  and  <dig> contigs . p. zelicaon unigenes produced  <dig>  clusters,  <dig>  containing only a single unigene. for this species, a single very large cluster of  <dig>  singletons and  <dig> contigs was produced. as with e. propertius, most of these singletons  and contigs  had hits only to h. erato proteins.

most of the unigenes in the very large cluster for p. zelicaon were similar, though it appeared that a large amount of sequence diversity prevented their assembly into contigs. as mitochondrial genomes are frequently diverse in populations  <cit> , we compared unigenes to papilio xuthus mitochondrial genes and ribosomal rnas . of the  <dig>  unigenes in the largest p. zelicaon cluster,  <dig> had a blastn hit to p. xuthus mitochondrial genes  and  <dig>  hit ribosomal rna. we also identified  <dig> unigenes not present in the largest cluster that hit mitochondrial genes, and  <dig>  that hit ribosomal rna. all but a few ribosomal hits were to the 16s ribosomal rna. similar analysis of e. propertius unigenes revealed  <dig> hits to p. xuthus mitochondrial genes and  <dig> hits to ribosomal rna, none of which occurred in the largest cluster.

to validate clustering results, we used tblastx  to search for five single-copy genes from b. mori: cad carbamoylphosphate synthase domain , pgd 6-phosphogluconate dehydrogenase , aats alanyl-trna synthetase , snf sans fille , and tpi triosephosphate isomerase   <cit> . because these genes are single copy, a correct clustering should identify unigenes orthologous to them as being related. pgd and snf each had hits to a single contig in the e. propertius unigene set ; neither of these contigs were clustered with any other unigenes. the tpi gene had a hit to a contig  that also was clustered with one other singleton. the other genes, cad and aats, had no hits in the e. propertius unigene set.

for p. zelicaon, the pgd gene had hits to three contigs ; these were clustered together along with one other singleton. the tpi gene hit a single contig  that also was clustered with one other contig. the aats gene hit three contigs representing two full clusters . the snf and cad genes had no hits to the p. zelicaon unigene set.

to investigate the absence of cad and aats for e. propertius and cad and snf for p. zelicaon, we searched for evidence of these genes in the m. cinxia est dataset  <cit> . of the  <dig>  uncleaned m. cinxia ests,  <dig> hit snf,  <dig> hit aats, and  <dig> hit cad. thus, although these genes appear to be expressed in a lepidopteran larval transcriptome, they appear to be present at low levels in est collections, particularly for cad.

metatranscriptomic contamination
because material was sampled from whole larvae, we expect some unigenes to represent species other than e. propertius and p. zelicaon. of the  <dig>  e. propertius unigenes with no hits to d. melanogaster, b. mori, h. erato, m. cinxia, or p. xuthus,  <dig> had hits to other metazoa .  <dig> e. propertius unigenes hit viridiplantae,  <dig> hit bacteria,  <dig> hit fungi, and  <dig> unigenes hit species in various other kingdoms.

of the  <dig>  p. zelicaon unigenes with no hits to the five species mentioned above,  <dig> hit metazoa .  <dig> hit viridiplantae,  <dig> hit bacteria,  <dig> hit fungi, and  <dig> hit other kingdoms. for both species, the bacterial hits included one singleton which hit to wolbachia .

genetic diversity
snp detection
single nucleotide polymorphisms  were identified by analyzing the multiple alignments produced during the assembly process using both a "loose" criterion to maximize the discovery of rare alleles, and a "strict" criterion to minimize the possibility of false positives due to sequencing error .

for e. propertius, strict criterion snps were found in  <dig>  contigs, comprising  <dig>  mbp of sequence. thus, we estimate at least  <dig>  snps in  <dig>  mbp or  <dig>  snps per  <dig>  bases for e. propertius. similar calculations for p. zelicaon discover at least  <dig>  snps per  <dig>  bases. in comparison, vera et al. estimated  <dig>  snps per  <dig>  bases in probable coding regions of the m. cinxia transcriptome using similar source data and similar conservative criteria for identifying snps  <cit> .

we also can label snps that appear in putative coding regions  as non-synonymous or synonymous . strict criterion snps occurred in  <dig>  putative e. propertius coding regions, representing  <dig>  mbp of sequence. thus, we estimate at least  <dig>  × 103/ <dig>  ×  <dig> ≈  <dig>  non-synonymous snps and  <dig>  × 103/ <dig>  ×  <dig> ≈  <dig>  synonymous snps per  <dig>  base pairs in coding regions of the e. propertius transcriptome. for p. zelicaon, strict snps occurred in  <dig>  putative coding regions representing  <dig>  mbp of sequence, for an estimate of  <dig>  non-synonymous and  <dig>  synonymous snps per  <dig>  base pairs in coding regions of the p. zelicaon transcriptome.

celera variant detection
recent versions of the celera assembler cluster co-occurring snps and indels together into "variants"--polymorphisms that may include more than a single nucleotide but yet are not large enough to be considered haplotypes. these variants also inform the celera assembly process, so that chimeric contigs containing nearby allele combinations not found in nature are avoided  <cit> . by default, variants are identified by grouping polymorphisms together so long as a stretch of at most  <dig> non-polymorphic sites occur between them, and each allele is supported by at least two reads. quality values are also used.

not counting single nucleotide length variants , the assembly produced  <dig>  variant regions in  <dig>  e. propertius contigs, with an average length of  <dig>  bp . the average number of variants per region was  <dig> , with a maximum of  <dig>  consistent with the maximum number of genotypes sequenced. in this case, the largest variant region of  <dig> bp was also the region with the most number of variants,  <dig>  the vast majority of ests  in this region supported a single variant, with the second most frequent variant occurring in only  <dig> ests.

for p. zelicaon, there were  <dig>  variant regions in  <dig>  contigs, with average length  <dig>  bp . the average number of variants per region was  <dig> , with a maximum of  <dig> . this large number of variants is inconsistent with the fact that only  <dig> genotypes were sequenced, and may indicate paralog collapse during assembly or sequencing error. alternatively, it is possible that one or more of the p. zelicaon mothers was fertilized by more than one male, resulting in more genotypes present in the data than female lines  <cit> . this is the only variant region for p. zelicaon with more than  <dig> variants.

β parameter
because ests were sequenced from a number of genotypes and because assembly coverage varies among contigs, standard measures of nucleotide diversity such as θ  <cit>  can not be calculated. instead, we consider a relative measure of nucleotide diversity βt developed by novaes et al.  <cit> , defined for contigs with average coverage at least 2×.  however, for all that follows, we compute β statistics only for those contigs with at least 6× average coverage to avoid biases caused by contigs that represent diverse sequences but are expressed at low levels. for contigs that also have a b. mori best hit , we can compute βn, a diversity estimate for non-synonymous sites, and βs, a diversity estimate for synonymous sites  <cit> . βt, βn, and βs are formally defined as follows:  

in the above, st is the number of snps in the contig , sn is the number of non-synonymous snps in blast annotated putative coding regions, ss is the number of synonymous snps in putative coding regions, lt is the total length of the contig, lc is the length of the putative coding region, d is the average coverage depth, and hn is the nth harmonic number. table  <dig> shows average and median values of βt, βn and βs amongst contigs with at least 6× coverage for both species.

novaes et al. note that because β statistics are conditioned on coverage depth rather than the actual number of haplotypes sampled, care must be taken in comparing to more traditional diversity estimates such as θ  <cit> . however, these statistics do enable the study of relative genetic diversity within each transcriptome  <cit> , and may speak to comparative diversity estimates for e. propertius and p. zelicaon if allele sample rates are equal .

the average coverage for e. propertius contigs in the top 1% of βt was relatively low at  <dig> × . the average βt for e. propertius contigs in the top 1% of coverage also was low at  <dig>  × 10- <dig>  for p. zelicaon, average coverage in the top 1% of βt was  <dig> ×, and the average βt in the top 1% of coverage was  <dig>  × 10- <dig> 

thus, for both species, very diverse contigs tend to have less than or near average coverage; conversely, highly covered contigs have low diversity. in the presence of large scale paralog collapse, we would expect to see many contigs with high coverage and high β, which we have not found.

discussion
for e. propertius, the large sequences produced by the  <dig> flx titanium allowed for the formation of a  <dig>  mbp assembly from  <dig> mbp of est sequence, with average contig coverage of 10× and average contig length of  <dig> bp. similar results were obtained for p. zelicaon.

comparisons to bombyx mori suggest that our final assemblies are of high quality. because βt was generally low for highly covered contigs, and nearly all variant regions had fewer variants than the number of genotypes sequenced, we see little evidence for over-assembly and paralog collapse. further, the fact that amongst the assemblies tested we have not seen a point of diminishing returns in terms of average ortholog hit ratio  suggests that even more aggressive assemblers may produce more accurate assemblies for such diverse datasets.

clustering results and comparison to the p. xuthus mitochondrial genome indicate the presence of ribosomal rna in at least the p. zelicaon dataset. although mitochondrial genes  are polyadenylated and appropriately found in our datasets, ribosomal rnas are not, and hence should be considered contamination. while such unigenes can easily be filtered after assembly, the fact that many of these were clustered via hits to a protein predicted dataset  highlights the need for well annotated and curated reference datasets.

clustering results also reveal that greater than 90% of unigenes had no similarity with other unigenes, indicating thorough assemblies. we searched for five single copy genes present in b. mori  <cit> . for those e. propertius homologues we found, assembly of unigenes was fairly complete  and clustering was accurate . for p. zelicaon, assembly was less complete , although in only one case were contigs split across two clusters. coverage of found genes was around 50%, with the exception of the low coverage for pgd. for both organisms, no evidence was found for two of the five genes; based on similar analysis for m. cinxia ests, this appears to be the result of low expression in larval samples.

determining the breadth of coverage of the transcriptomes is difficult, given how little is known about butterfly genomes. unigenes for both e. propertius and p. zelicaon hit ~  <dig> k  unique b. mori predicted proteins. for both species, at least  <dig> k unigenes hit one of b. mori, h. erato, or d. melanogaster. excluding the largest clusters, these hits were distributed roughly evenly between high and low coverage contigs and singletons, supporting previous studies suggesting that singletons and low coverage contigs are biologically valuable  <cit> . gene ontology term analysis reveals that  <dig> high level categories are present for both species in levels similar to that for b. mori. thus, although we cannot speculate on how many transcripts exist in these transcriptomes, they appear to be sampled broadly.

as expected in whole larval samples, we identified unigenes representative of plants, bacteria, fungi, and other non-lepidopteran sources  <cit> . interestingly, a single est from both species hit to wolbachia, a symbiotic bacteria known to affect population dynamics and hypothesized to be present in e. propertius populations  <cit> .

vera et al. compared unigene length to length of the best hit protein to estimate completeness of transcript discovery  <cit> . unfortunately, this also includes untranslated regions in unigenes, artificially inflating the desired measure. our alternative, the ortholog hit ratio, provides a more conservative estimate of the effectiveness of gene discovery and speaks to assembly quality. greater than 5% of unigenes had a ratio >  <dig>  and greater than 10% of unigenes had a ratio >  <dig>  for both species. we conclude that at least ten percent of our putative b. mori orthologs capture approximately 50% of their corresponding silkworm genes.

the effects of alternative splicing on the ortholog hit ratio depend on the abilities of the assembler, as well as on whether the reference b. mori protein set contains orthologs to alternatively spliced transcripts. since many assemblers split contigs at ambiguous or repetitive regions  <cit> , alternative splicing will likely result in a low ortholog hit ratio for the alternative version, even if the alternative ortholog exists in the reference dataset. if the alternative ortholog does not exist in the reference dataset, either the alternative segment will match a subregion of the original transcript form , or there may be no hit at all . since these issues serve to reduce ortholog hit ratios rather than inflate them, the conservativeness of the ortholog hit ratio approach is preserved.

while estimating genetic diversity accurately  is difficult given the essentially unknown number of natural alleles contributing to the population sample for each contig, some relative comparisons between species should be possible. for example, using a snp calling criterion similar to our strict criterion and a source dataset similar to ours, vera et al. estimate  <dig>  snps per  <dig>  base pairs in the m. cinxia transcriptome  <cit> , whereas we estimate  <dig>  snps/ <dig>  bp for e. propertius and  <dig>  snps/ <dig>  bp for p. zelicaon.

while novaes et al. caution against comparing β diversity estimates across assemblies--as they depend on sequencing depth, snp calling criteria, and other factors--the e. propertius and p. zelicaon datasets were collected and processed in nearly identical fashion. average β statistics were higher in p. zelicaon than in e. propertius, despite smaller sample sizes for p. zelicaon . these comparative diversity results, both in terms of raw snp counts per  <dig>  bases and β, support previous findings that overall genetic polymorphism is higher for p. zelicaon than e. propertius  <cit> .

as was found for eucalyptus grandis, the β distributions are all right-skewed , suggesting purifying selection for the majority of genes  <cit> . βt is slightly negatively correlated with the number of species hit  for e. propertius, suggesting that lineage and species specific genes are more diverse for e. propertius . a similar, but weaker and non-significant, trend is found for p. zelicaon .

as has been noted before  <cit> , different assembly programs can produce very different results, as seen in table  <dig>  while none of the assembly programs currently in widespread use are designed for ecoinformatics, liang et al. have suggested that cap <dig> is the best choice for ests  <cit> . however, liang et al. did not consider the celera assembler, and our results suggest that new versions of the celera assembler may be more appropriate for data containing a diversity of genotypes.

for further comparison, we also assembled the e. propertius and p. zelicaon est sets with the recently released newbler assembler version  <dig>  , which has options specifically for transcriptome data. for e. propertius, newbler produced  <dig>  contigs of average length  <dig> bp and  <dig>  singletons with average  length  <dig> bp. for p. zelicaon,  <dig>  contigs of average length  <dig> bp and  <dig>  singletons of average  length  <dig> bp were produced. newbler version  <dig>  also produces a set of sequences known as "isotigs," arrangements of contigs meant to represent splice forms . for e. propertius,  <dig>  such isotigs with average length  <dig>  bp were produced.  <dig>  isotigs of average length  <dig>  bp were produced for p. zelicaon.

another factor in successful transcriptome assembly is the sequencing technology used. in our application, the  <dig> titanium chemistry sequencer produced average read lengths of about  <dig> bp. in contrast, the older  <dig> gs- <dig> platform used by vera et al. produced reads averaging  <dig> bp for the m. cinxia transcriptome  <cit> . to assess the effects of sequencing technology, we obtained m. cinxia ests from the sequence read archive  and cleaned and assembled them similarly to our datasets.  after cleaning,  <dig>  ests of average length  <dig> bp remained. our assembly produced  <dig>  contigs , and  <dig>  singletons . the fact that this assembly size is different from that produced by vera et al. indicates that reanalysis of data may be important as new bioinformatics tools and assemblers become available.

comparison between the above m. cinxia assembly and that for p. zelicaon or e. propertius is complicated by multiple factors. first, these are different species with different patterns of diversity and expression. second, even though the number of cleaned ests is similar, the shorter read lengths for m. cinxia ests provide less total sequence data, affecting the number of contigs obtained. nevertheless, the similar aspects of these datasets  does suggest that longer read lengths can improve assembly quality.

CONCLUSIONS
we reported larval transcriptome sequences and assemblies for butterflies of ecological importance: erynnis propertius  and papilio zelicaon . as the immediate aim was construction of a microarray enabling comparison of transcribed genes under alternative climate treatments and of populations of differing geographic locations, steps were taken to maximize gene discovery within the larval stage.

long read lengths produced by the  <dig> flx titanium sequencing platform and experimentation with assembly techniques produced high quality assemblies with few singletons. over ten percent of putative b. mori orthologs in e. propertius and p. zelicaon cover at least 50% of the corresponding silkworm gene, as measured by ortholog hit ratio. gene ontology annotation suggests that transcripts were broadly sampled, and comparisons with bombyx mori and other related model species indicate that many genes were found--both species had hits to over 50% of the b. mori protein dataset.

although the ortholog hit ratio does not consider the effects of alternative splicing , it appears to be an excellent method for the comparative assessment of assemblies. using this measure, as well as simpler measures such as contig and singleton count, we found the celera assembler to be an effective tool for handling population-level datasets, particularly when custom parameters are used.

 <dig> sequencing and assembly has proven an effective platform for snp discovery  <cit> . variant regions detected with the celera assembler may prove useful for population-level studies, further supporting celera assembler for this type of data. significantly, the discovery of ~  <dig> k high quality snps for e. propertius and ~  <dig> k snps for p. zelicaon will facilitate future studies of population structure and genetic causes of functional differences already found between populations  <cit> .

