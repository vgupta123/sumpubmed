BACKGROUND
in his seminal paper homage to santa rosalia or why are there so many kinds of animals?  <cit> , george e. hutchinson addressed the determinants of biodiversity in light of a renewed concept of niche. hutchinson’s question has an interesting challenge in the microbial world. understanding the determinants of bacterial niches can open new perspectives on plant and animal evolution as well, since bacteria co-evolved with multicellular eukaryotes for hundreds of millions of years mutually influencing each other  <cit> , and it may have important biomedical applications. an increasing quantity of data from high-throughput experiments is now available for large scale ecological studies of bacterial communities, in particular for the human microbiome  <cit> . early analysis suggested that ecological patterns are qualitatively similar for macro- and microorganisms  <cit>  and allowed identifying taxa-area and distance decay relationships  <cit>  and the influence of environmental variables such as depth  <cit>  or salinity  <cit> , stimulating the emergence of prokaryotic biogeography  <cit> .

data on presence or absence of species in different locations are used by biogeographists to infer ecological processes  <cit> . similarly, presence-absence matrices obtained by sequencing environmental samples or by mining abstracts of scientific papers  <cit>  offer new opportunities to shed light son bacterial ecology. recently, several groups used large-scale data to study bacterial associations  <cit> , reviewed in  <cit> . in the present work, we analyse bacterial species associations for a comprehensive collection of samples from a large variety of environments classified at the three hierarchical levels of environmental subtype, type and supertype  <cit> . we assess the significance of their associations by means of a recently proposed null-model  <cit>  that optimally reproduces the global distribution of taxa across samples, and that we modified to take into account environmental preferences. to this end, we exploited the hierarchical classification of samples into environmental groups developed by tamames et al.  <cit>   and developed a new analytical pairwise score.

we are interested in pairs of taxa that aggregate and segregate, which means that they co-occurr significantly more often and less often than expected based on the null model. aggregations and segregations can be attributed to habitat preferences, to direct ecological interactions  or to indirect interactions with another species or group of species. we consider environmental preferences in our null model, with the aim to reduce the number of aggregations that are due to common preferences. we try to estimate how many aggregations may be due to environmental preferences that are not removed by the null model by differentiating associations that occur in a specific environment from those that are not specific. another way to perform this analysis consists in focusing on cosmopolitan taxa that do not show apparent environmental preferences but are found in many diverse environments. the previous work of tamames et al.  <cit>  found that, at the genus level that we consider here, cosmopolitanism is not rare among bacteria. we aim at investigating in which way ecological associations may contribute to this property.

in this work, we assess all possible segregations and aggregations of  <dig> bacterial taxa corresponding to the genus level, observed in  <dig> samples from different environments, and we analyse the relationship between these environmental associations on the one hand and cosmopolitanism and known ecological associations on the other hand.

RESULTS
constructing networks of bacterial associations
our first aim is to construct a null model that optimally represents the global distribution of taxa across samples, considering their habitat preferences at the level of environmental subtypes, but assuming that taxa do not interact between themselves. this approach is different from most current approaches to microbial community studies in that it explicitly considers habitat preferences, and in that the association score of a pair of taxa depends on the observed distribution of all other taxa.

since for many samples abundance information is not present, the  <dig> samples were transformed into the binary presence-absence matrix xia∈{ <dig> }, where i labels one of the n taxa and a labels one of the m samples. to limit the bias caused by the choice of primers in sequencing experiments, we excluded experiments targeted at detecting specific taxa . we adopt the probabilistic null model proposed by navarro-alberto and manly  <cit> , in which the probability πia that taxon i is observed at sample a in the absence of taxa interactions is parametrized as πia=1− exp where the parameter pi is related with the abundance of taxon i and qa is related with the biodiversity supported by sample a, respectively.

the m+n parameters pi and qa are determined by maximum likelihood, so that the resulting null model is most difficult to reject. we take into account that each taxon has a preference for some habitat by assuming that the taxa parameters pi are specific for each environmental subtype a . if taxon i is never found in environment a, then pi= <dig>  implying that πia= <dig> if a∈a, i.e. the taxon is never found in samples of environment a simulated through the null model either.

the significance of the observed co-occurrences is analytically assessed through the aggregation scoresija=−logpijn≥nij, where nij is the observed number of samples where taxa i and j co-occur and pij is the null-model probability that taxa i and j co-occur at n locations . similarly, we compute the segregation score as sijs=−logpijn≤nij. these computations are performed analytically and they last few minutes on an ordinary computer even for large systems.

we compute the significance of n/2= <dig> potential associations between all pairs of taxa for the observed matrix as well as for  <dig> random realizations generated through the null model. to correct for multiple testing and reduce the dependence on the number of samples where i and j are present, scores are transformed into z scores over random realizations of the null model. . large z scores are found with the observed matrix but not with realizations.

number of aggregations and segregations for comparable significance thresholds
the reconstructed association network depends on the threshold above which associations are considered significant. in order to choose these thresholds in a comparable way for aggregations and segregations, we generate random realizations of presence-absence matrices using the null model πia, and we treat them in the same way as the observed matrix, computing their null model πia′, the association scores and the number of inferred associations for given threshold. since in the null model taxa do not interact, these inferred associations represent false positives. in this way, we estimate the false positive rate  and the positive predictive value  as a function of the threshold.

we plot in figure  <dig> the number of inferred associations versus the ppv. for equal ppv, the number of aggregations is larger than the number of segregations. the same qualitative result is found using the fpr as control variable .number of significant aggregations  and segregations  found in the observed presence-absence matrix versus the positive predictive value .




a possible artefact that can produce this result is that our method does not allow to detect significant associations for all pairs of taxa. for instance, if two taxa never co-occur in the same environmental subtype, they never co-occur in the null model as well and their segregation score is zero. in general, two taxa can have a significant aggregation  score only if the probability that they always  co-occur is smaller than the chosen threshold. to take this into account, for each threshold we consider only pairs of taxa for which both segregation and aggregation can be detected . also in this case aggregation prevails over segregation: for ppv= <dig> , which represents a good compromise between completeness and accuracy, we find  <dig> aggregations and  <dig> segregations . the results shown in the following are obtained using these thresholds but considering also pairs for which only one association type can be detected.properties of networks obtained with positive predictive value
 <dig> 



type
pairs
threshold
fpr
associations


we compared our predicted associations with those obtained by freilich et al.  <cit> . these authors predicted potential cooperative and competitive interactions of bacterial species based on the simulation of their metabolic networks in different environments, and complemented these associations through the analysis of pairs of species that co-occurr in metagenomic experiments more and less often than expected by chance. this study differs from ours in three important ways:  it assesses the significance of aggregations and segregations through the hypergeometric distribution, which only depends on the pair of taxa examined, instead of using a global null model that also accounts for the absence/presence of other taxa;  more importantly, it only examines pairs of species that show the same environmental preferences, while our method takes care of removing environmental preferences through the null model  finally, it considers the species level, whereas we detect associations between genera.

despite these differences, the results are strikingly similar. out of  <dig> genera for which we could identify a correspondence with  <dig> species studied by freilich et al., we found  <dig> aggregations and  <dig> segregations over  <dig> possible associations  and they found  <dig> aggregations and  <dig> segregations over  <dig> possible associations . nine of our aggregating taxa were associated with different environments, so that their co-occurrence was not tested by freilich et al. of the remaining  <dig>   <dig> were co-occurring also in freilich et al. study . this is a very significant overlap, since the overlap expected by chance is 17×49/2628= <dig> . note that  <dig> out of  <dig> pairs co-occurring in their study were not significantly aggregated in ours, presumably because they are associated to the same environment and were filtered out by our null model. none of the segregating pairs coincided in the two studies. we conclude that our method is effective in filtering out pairs that aggregate because of environmental preferences, and that most of the aggregating pairs that it identifies agree with freilich et al.’s method. on the contrary, segregations do not agree between the two methods , perhaps because they are more difficult to detect.

control network
to take into account possible biases caused by our computational procedures, we constructed a control network. we used as the starting point a random presence/absence matrix extracted with the probabilities computed with the null model for each combination of samples and taxa. we computed association scores for all pairs of taxa exactly as for the observed matrix and we assigned associations using thresholds lower than for the observed network  in such a way that the number of associations is the same for networks obtained from the two matrices. one should keep in mind that this control network is not a random network, since its construction produces correlations. for instance, since taxa appearing in many samples tend to co-occur with many other taxa, when we decrease the significance threshold they tend to form many aggregations, which produce aggregation propensity .

community structure
association propensity. we investigate the community structure of the observed and the control network by measuring the propensity  that two taxa associate given that they both associate with a third taxon k. this measure is analogous to the clustering coefficient, but it is clearer to interpret since it is negative if the association with k disfavors the association between i and j. there are two types of associations, aggregation  and segregation , and three conditioning associations: both i and j aggregate with k , both segregate , and one aggregates and the other segregates . we obtain six propensities, which are reported in table  <dig>  even the control network generates significant propensities, since taxa present in many samples tend to form many associations and produce positive propensities. however, propensities are much stronger for the observed network, suggesting that they provide non-trivial information on the community structure. the favored triangles are aaa and ass, whereas it is disfavored that two segregating taxa aggregate with the same taxon . these patterns are compatible both with the ecological and with the environmental interpretation of aggregations, and they suggest the existence of separate communities such that taxa of the same community aggregate between themselves and segregate from taxa in other communities.association propensities for the observed and a random network



propensity
observed network
control network
 represents propensity of aggregation given two aggregations, and so on .



nestednessν  is a property related with the aggregation propensity that has been shown to be enhanced in mutualistic networks  <cit> , although it may also arise from habitat filtering. strongly nested pairs share many common aggregations, and they are more frequently observed in the observed than in the control network, see additional file 1: figure s <dig>  the medians of the two distributions are different at the 1% significance level .

habitat filtering or ecological interactions?
significant associations may be attributed either to ecological interactions or to habitat preferences. the null model reduces the second possibility by taking habitat preferences into account, since the taxon-specific parameter pi vary for each subtype a of the environmental classification so that preference for the same subtype would not necessarily result in significant aggregation. nevertheless, the environmental classification is necessarily coarse, and we cannot exclude that aggregations are due to habitat preferences that the null model fails to reproduce, such as for instance ph, oxygen or light. disentangling environmental and ecological preferences is very difficult, since interactions in large natural communities of bacteria cannot be directly observed on a large scale. therefore, in the following we examine indirect evidences that support one or the other interpretation.

environmental and phylogenetic relatedness favor aggregation and disfavor segregation
firstly, we examined the propensity  between aggregation and shared habitat preferences. a positive propensity means that pairs of taxa that share the same habitat preference tend to aggregate more often than generic pairs of taxa or, conversely, that aggregated taxa tend to share habitat preferences. this relationship is expected even for a random presence-absence matrix. therefore, we compared the observed aggregation network with the control network described above.
figure  <dig> 
propensity to association versus environmental relatedness  and versus phylogenetic relatedness . in the top figure the x axis labels environmental relatedness at the three levels of subtype, type and supertype. for each level, three values of relatedness are possible: ’same’ if the preferred habitat is the same, ’und’ if it is undetermined for one or both taxa, and ’diff’ if it is different.



as expected, one can see from figure  <dig> that environmentally related taxa have a strong propensity to aggregate. nevertheless, in the control network  the maximum environmental relatedness  does not produce significant propensity for aggregation, indicating that the null model is effective in reducing aggregations caused by environmental preferences at the subtype level. at the type and supertype level, small but significant propensities arise even in the control network. similarly, different supertypes generate a small but negative propensity to aggregate.

these propensities are much stronger for the observed network  than for the control network, in particular taxa with the same habitat preferences at the supertype level are more prone to aggregate. the most parsimonious interpretation of this observation is that these aggregations are caused by habitat filtering, through environmental preferences that the null model does not take into account. under this respect, habitat filtering is the preferred explanation for the two points corresponding to share subtype and shared type. nevertheless, the possibility that some aggregations come from ecological interactions cannot be conclusively rejected either, as discussed in the following sections.

furthermore, the aggregation propensity is significantly larger for pairs of taxa that are both environmentally and phylogenetically related. this relationship between aggregations and phylogeny goes beyond shared habitat preferences, since pairs of taxa belonging to the same order  and family  are prone to aggregate even in the absence of a common environmental preference. the propensity for aggregation increases with the phylogenetic relatedness  and the propensity for segregation decreases , in agreement with the results by chaffron et al.  <cit> , and also reminiscent of the results by tamames et al.  <cit> , who found that the environments can be classified based on the affinities that different phyla have with different environments.

the propensity for segregation gives little information, since the number of significant segregations is small. although we require that significantly segregating taxa co-occur in at least one subtype, we do not find any pair of segregating taxa with the same habitat preference at subtype level, which suggests that the data that we use cannot effectively identify competing taxa. however, most of the segregating pairs that we identify coexist in at least one sample, and the fact that their preferences are different can be also due to the high threshold that we choose to assign habitat preferences.

aggregated taxa co-occur in very different environments
to distinguishing habitat filtering from ecological interactions, we envisage two scenarios in which an association due to environmental preferences is not recognized by our null model. the first scenario is that aggregated taxa share a preference for a habitat that occurs in different environmental subtypes, such as nitrite rich habitats found in wastewater treatments and agricultural samples classified in different subtypes, so that the preference is underestimated by the null model. we would expect that this scenario is more likely if the habitat occurs in similar subtypes belonging to the same type , rather than in different supertypes . the second scenario is that the same sample contains many micro-habitats , and the apparent aggregation stems from specialization to different habitats found in the same sample. if this is the case, most of the samples where the taxa co-occur should contain the same micro-habitats, which is more likely if the samples belong to the same subtype or the same type , but not if they come from different supertypes . in both cases, taxa that co-occur in similar samples are more likely to aggregate because of habitat filtering.

to test these scenarios, for each pair of significantly aggregated taxa we measured the number of different subtypes, types and supertypes to which the samples where they co-occur belong. this number was measured as the exponential of the shannon entropy, −∑ifilogfi, in order to reduce the impact of unfrequent environments. we found that 77% of the significantly aggregated pairs co-occur in samples from more than two different subtypes, 60% from more than two types, and 57% from more than one supertype. these data support the view that most aggregations cannot be explained by habitat preferences. the distribution of the number of different environments shared by each pair of significantly aggregated taxa is shown in figure  <dig> distribution of the number of significantly aggregated pairs of taxa that coexist in
n
 different subtypes, types and supertypes. the number of environments is computed as the exponential of the shannon entropy. the maximum possible number of environments is  <dig> at supertype level,  <dig> at type level and  <dig> at subtype level.



cosmopolitan taxa are prone to aggregate
the study of tamames et al.  <cit>  found that cosmopolitanism, i.e. the fact that some taxa occurr in very diverse environments, is relatively common in the bacterial world, in particular if higher order taxonomic groups are considered. we set up to further investigate the relationship between cosmopolitanism and aggregations because of two reasons: first, since cosmopolitan taxa do not possess environmental specificity, they may allow distinguishing between habitat filtering and ecological interactions; second, this investigation may give hints on whether aggregations play a role in the cosmopolitanism of some bacterial taxa.

we measured taxa cosmopolitanism in two ways:  as environmental cosmopolitanism, i.e. the number of different environmental subtypes in which a taxon is present, and  as community cosmopolitanism, i.e. the number of different communities in which a taxon is present  in methods). to investigate possible methodological artefacts, we compared the observed aggregation network and the control network.

the number of aggregations of a taxon is positively correlated with its cosmopolitanism both for the control and for the observed network, but in the latter case the correlation is much stronger . if we normalize the number of aggregations dividing it by the number of samples in which the taxon is present, called prevalence, the relationship with cosmopolitanism remains positive for the observed network whereas it becomes negative for the control network . this qualitative difference suggests that the observed relation between aggregations and cosmopolitanism goes beyond the trivial effect that more common taxa are more likely to co-occur. since cosmopolitan taxa do not present well-defined preferences, it seems unlikely that the excess aggregation is due to habitat filtering. for instance, flavobacterium and pseudomonas are present in  <dig> different subtypes such as arctic, mouse gut, food treatment or mines among others. the hypothesis that their cooccurrence is explained by habitat preferences would imply that these hypothetical preferred properties co-occur in such a wide variety of environments. a more economical hypothesis is that the excess of co-occurrence is explained by cooperative interactions. another possible hypothesis is that two cosmopolitan have an indirect relationship, due to the fact that there are specialist taxa that, if present, exclude both of them. our data do not allow distinguishing between direct and indirect relationships, therefore we cannot judge how likely is this hypothesis.number of aggregations of bacterial taxa divided by number of samples in which the taxon is present versus community cosmopolitanism eq.. the black lines are obtained for the observed network, the red lines are obtained for a control network. each point represents the average of all taxa in the same bin of cosmopolitanism.



known cooperative pairs are found to aggregate
the hypothesis that some of the aggregations that we find are due to cooperative interactions can be tested examining pairs of taxa for which such interactions are known. they fall into three main cathegories: syntrophy  <cit> , in which one taxon is metabolically dependent on reactions carried out by a different taxon; biofilms  <cit> , in particular those formed by pathogenic bacteria, which cooperate to promote the chronic nature of the infection  <cit> ; mutualistic interactions with a shared host  <cit> . many pairs of taxa for which there are hints of a cooperative relationship show significant aggregation, as described below.

an important example of syntrophy are methanogenic environments in which organic acids are degraded by syntrophic associations of acetogenic bacteria and methanogenic archaea. hydrogen consumption by methanogens allows acetogenic bacteria to convert organic acids to acetate and hydrogen  <cit> . consistently, we find significant aggregations between acetobacterium and the methanogen archaea methanolobus and methanocalculus. in a similar context, an experimental study of methanogenesis from ethanol identified a three species mutualistic coculture with desulfovibrio as the ethanol-degrading species producing acetic acid and hydrogen, which was converted to methane by a methanobacterium sp. while the ph was maintained by the acetate-utilizing methanosarcina mazei  <cit> . the two latter taxa show significant aggregation. in another study it was demonstrated that “the coexistence of two types of methanogens, i.e. hydrogenotrophic  and acetoclastic  methanogens is necessary to respond successfully to perturbation and leads to stable process performance”  <cit> . these taxa are significantly aggregated. similarly, the persistence of pseudomonas putida in an environment with benzyl alcohol as the sole carbon source is dependent on the presence of acinetobacter. experimental evolution of this community in a biofilm lead to establish a structured community in which interactions between the two species evolved, enhancing productivity and stability  <cit> . this is the strongest association that we detect. nitrosomonas and nitrospira are two significantly aggregated nitrifying bacteria frequently found in wastewater treatment plants, where they oxidize ammonia and nitrite, respectively  <cit> . in this case, the aggregation seems to result from habitat preferences and specialization rather than syntrophy.

another very interesting example of syntrophy are chemolithotrophic bacterial communities that oxidize iron and sulfur leading to the formation of metal-rich acidic water. in these peculiar ecosystems, whose best known example is the acidic river rio tinto in spain, the energetic cycle is characterized by several types of bacteria that act cooperatively  <cit> : sulfur- and iron-oxidizing bacteria, such as acidithiobacillus ferrooxidans and leptospirillum ferrooxidans, acidiphilium, which removes organic compounds toxic for leptospirillum and reduces iron even in the presence of oxygen, and acidithiobacillus spp. and members of the acidimicrobiacea family, which can facultatively reduce iron under anoxic conditions. these taxa have large aggregation scores.

other interesting examples are related to the ability of bacteria to adapt to environmental conditions that change due to human activity. for instance, sphingomonas sp. tfee and burkholderia sp. mn <dig>  isolated in soils treated with the pesticide fenitrothion, were shown to be able to degrade the pesticide jointly but not alone  <cit> , and they aggregate.

another important class of examples concern biofilms of pathogenic bacteria. pseudomonas aeruginosa and burkholderia, the main pathogens in cystic fibrosis, form mixed biofilms in the lungs of patients. they have frequently exchange genetic material and communicate through a common quorum-sensing system  <cit> . their aggregation score is lower than the conservative threshold that we adopt, but it is large . other associations between pathogenic bacteria are frequently observed in chronic wounds biofilms, in which bacteria cooperate to promote the chronic nature of the infection  <cit> . the seven taxa most frequently observed in these biofilms break down in two communities, one in which pseudomonas and enterobacter are significantly aggregated with serratia although they are not aggregated between themselves  and another one in which staphylococcus and stenotrophomonas are significantly aggregated with finegoldia and marginally aggregated between themselves , while peptoniphilus is marginally aggregated with both finegoldia and streptococcus.

finally, an important type of indirect interactions are mutualistic interactions with a common host. such aggregations can be viewed both as an example of habitat filtering and as an indirect cooperative interaction over evolutionary time scales mediated by the host. gut and root microbiota constitute the most studied examples and present interesting common features  <cit> . for instance, rhizobium tropici and devosia form a symbiosis with the same aquatic legume host, they have been shown to have interchanged symbiotic genes by horizontal transfer  <cit>  and they are significantly aggregated. photobacterium and vibrio, two taxa present in the light organs of some fishs  <cit> , are significantly aggregated.

summarizing, excluding nitrifying bacteria that are a likely example of habitat filtering, we have examined  <dig> pairs of experimentally known associations that have different feature that suggest a synergistic relationship, finding that  <dig> of them  show significant aggregations. note that two more pairs have large aggregation scores but smaller than our chosen threshold, which indicates that the threshold that we have chosen is strict.

network analysis
we now concentrate our attention on a portion of the aggregation and segregation network  related with animal guts, given the major interest on understanding the ecological determinants underlying the assemblage of human gut communities. indeed, it has been suggested that a better understanding of gut communities may be achieved considering samples from environments different than human gut in order to identify the facultative or obligatory nature of the different taxa  <cit> . with this motivation, we selected a subnetwork containing taxa that has been observed not just in the human gut, but also in other guts such as cattle or mouse . in addition, and for the sake of comparison, we also selected two more subnetworks related with the saline and plants environments , which are shown in additional file 1: figure s <dig> and briefly commented in additional file 1: supplementary text s <dig> 

the gut related network shown in figure  <dig> comprises  <dig> subtypes, and we require taxa to be present in at least  <dig> of them. this condition selects  <dig> taxa, which are not necessarily preferentially associated with the gut environment. for most of them the association is strong, since 87% are found in at least  <dig> gut-related samples and 58% in at least  <dig> samples. note that, selecting taxa that are observed in at least three gut subtypes, we underscore ecological relations that may prevail in the gut independently of the host at the expense of losing some taxa only found in the human gut. the  <dig> selected taxa are related through  <dig> aggregations and  <dig> segregations that are computed from the entire data set, so they may co-occur in environments different from the gut. we can visually distinguish two large groups of strongly aggregated taxa  and an intermediate group that links them through transitive aggregations. one of the large groups is constituted by taxa preferentially found in the supertype “host” , and the other is constituted by generalist taxa . the two groups are mostly related through segregations  in figure  <dig>  to quantitatively confirm this structure, we have analysed the modularity of the aggregation network with the modularity algorithm proposed in ref.  <cit>  implemented in the program gephi  <cit> . this algorithm subdivided the gut related network into five communities: the two large groups clearly seen in the main figure, two intermediate communities connected to both of them and between themselves, and a small community  only connected to the generalist community. they are represented in additional file 1: figure s <dig>  there are two possible interpretations of this pattern: associations may be mainly attributed to habitat filtering, which would explain why generalist taxa tend to segregate from gut taxa. alternatively, associations may be attributed to ecological interactions, and in this case the observed pattern would suggest antagonistic interactions between the gut community and opportunistic invaders.networks obtained for taxa present in a group of samples related with animal guts. solid lines represent aggregations, dashed lines represent segregations. circles represent taxa, coloured according to the supertype to which at least 50% of the samples belong. . red lines connect taxa belonging to the same family. the graphs have been plotted with the program pajek  <cit> .



finally, we have also compared the network in figure  <dig> with independent data obtained sampling the gut microbiota at  <dig> time points during the first year of life of  <dig> infants  <cit> . interestingly, members of the host-related group appear and remain until the last time point, whereas generalist taxa are intermittently observed at different time points, supporting their interpretation as opportunistic invaders.

discussion
bacterial communities can be very diverse. hundreds of species have been found in animal gut  <cit> , vagina, mouth, and other organs. however, the global extent of bacterial diversity is currently debated. estimates based on species-area curves  <cit>  and on the depth of bacterial divisions on the rrna tree of life  <cit>  anticipated a huge number of bacterial species, but extrapolations from higher taxonomic levels were much lower than expected  <cit> . this discrepancy is due at least in part to the fact that the definition of bacterial species is artificial  <cit> , and very important differences in gene content may exist between individuals classified as the same species, so that the concept of ecotype may be more relevant for bacteria than the rrna-based species definition  <cit> . unfortunately, the resolution of the data does not allow us to address the ecotype level, and we had to conduct this study at the somehow artificial genus level . it is therefore reassuring that a recent study argued that the bacterial genus level is ecologically coherent  <cit> , supporting the approach undertaken here.

we performed a large scale survey of significant aggregations and segregations of bacterial taxa, adopting a maximum likelihood null model that takes into account environmental preferences at the environmental subtype level. we found a large number of significant aggregations, which may be attributed either to shared habitat preferences that are not taken into account by the null model or to cooperative ecological interactions. both explanations are at least partially valid. the null model almost eliminates the aggregation propensity of pairs of taxa that share habitat preferences at the subtype level, but not at the type and supertype level . on the other hand,  <dig> out of  <dig>  known examples of cooperative interactions are recovered by our analysis as significant aggregations, and some others have large scores that fall below our chosen threshold, suggesting that the threshold that we use is strict.

in order to quantitatively assess the two kinds of explanation, we examined two main mechanisms that may lead to environmentally driven aggregations:  the preferred habitat may be distributed between several environmental subtypes so that the null model does not detect this preference;  the same sample may contain several micro-niches, so that the taxa aggregation is only apparent. both mechanisms are plausible if the aggregated taxa co-occur in very similar environments. therefore, we conservatively attribute to habitat filtering the aggregation or pairs of taxa with shared environmental preferences. however, we found that most significantly aggregated pairs coexist in more than two different subtypes  and types  and more than one supertype  of the environmental classification, and in these cases habitat filtering appears a less likely explanation of the aggregation.

cosmopolitanism offers another indirect evidence of the mechanism underlying aggregation. cosmopolitan taxa, which live in very diverse environmental conditions and communities, present many more aggregations than specialist taxa. the number of aggregations increases with cosmopolitanism faster in the real network than in the network that we use to control methodological artefacts. if shared habitat preferences are the main source of aggregation, we would expect fewer aggregations for cosmopolitan taxa, which lack well defined preferences. thus this result is consistent with the view that many aggregations are due to ecological interactions.

cosmopolitanism is apparently at odds with the view that biodiversity is maintained by distinct ecological niches that avoid the competitive exclusion of species. the fact that cosmopolitan taxa tend to aggregate suggests the interesting possibility that cooperative interactions may favor the remarkable cosmopolitanism of some bacterial taxa. of course, this hypothesis needs to be tested experimentally. we hope that the statistical signal presented here will stimulate such a test. to this end, we provide here examples of groups of cosmopolitan taxa that show strong aggregations between themselves in many diverse environments and can be interesting candidates for experimental studies.  the four taxa pseudomonas, acinetobacter, stenotrophomonas and sphingobium strongly aggregate; interestingly, cooperative interactions between pseudomonas and acinetobacter have been observed in experimental evolution  <cit> .  the group of the plant-associated taxa rhizobium, arthrobacter, sphingomonas and nocardioides, which also co-occur within several scientific papers;  the group devosia, rhizobium, lysobacter and sphingopyxis, the first two associated with plant symbiosis;  streptococcus, staphylococcus and propionibacterium, associated with many infectious processes;  the aquatic genera flavobacterium, acidovorax, rhodoferax and polaromonas;  the soil bacteria bradyrhizobium, rhodoplanes, conexibacter, gemmata, isosphaera and stella. some of these taxa, like nocardioides, conexibacter, rhizobium or byssimonas, are highly promiscuous, forming more than  <dig> aggregations each.

the aggregation network identified in this work has a marked community structure, in particular it is significantly clustered and nested. the triangles where all three taxa aggregate  and those where two aggregated taxa segregate from another one  are statistically favored, suggesting the existence of different communities characterized by intra-community aggregation and inter-community segregation. these data are compatible both with ecological interactions and habitat filtering as the basis of the community structure. similarly, pairs of aggregated taxa share more common aggregations than expected at random . although habitat filtering can explain this property, it is interesting to note that nestedness is also observed in mutualistic networks of plants and pollinators  <cit> , and it has been suggested to reduce effective competition and favor structural stability and biodiversity  <cit> .

when we compared significant aggregations and segregations, taking care that the comparison is performed at equal false positive rate, we obtained the surprising result that aggregations are more frequent than segregations in the bacterial world. this comparison may be biased by the fact that sparse binary data are little effective at detecting segregation, or that the broad phylogenetic range of bacteria genera makes it difficult to detect competitive exclusion, as it has been recently suggested  <cit> . moreover, many of the aggregations that we find must be attributed to habitat filtering. nevertheless, in most cases this explanation does not appear as the most likely, which opens the way to the surprising ecological interpretation that cooperative interactions between bacteria may be very widespread.

this interpretation is worth investigation. several other works studied bacterial communities on a large scale, emphasizing the role of either habitat filtering or competitive exclusion or cooperative interactions.

chaffron et al.  <cit>  performed a study very similar to ours, detecting numerous significant aggregations from bacterial co-occurrence in environmental samples. the main differences with respect to our study are that their null model does not take into account environmental preferences, so that these aggregations must be conservatively attributed to habitat filtering, and segregation was not assessed. the study of faust et al. examined the microbiome of several body sites with high spatial resolution, finding a comparable number of positive and negative associations within body site  <cit> , but another recent study of the human gut microbiome did not find significant negative associations  <cit> . arumugam et al. provided evidence for the existence of three distinct types of composition of the gut microbiome called enterotypes  <cit> . however, even in distinct enterotypes one does not observe complete exclusion of any common bacterial taxon, except prevotella.

in an interesting study, freilich et al. studied the ability of pairs of bacterial species to interact competitively or synergistically by predicting their metabolic growth in isolation and in the presence of the other species on different media  <cit> . interestingly, in most cases both outcomes are possible depending on the growth medium. they also performed a co-occurrence analysis similar to ours, but with the important difference that it did not adopt any null model and it did not attempt to eliminate pairs that are associated due to common environmental preferences, but instead focused on such pairs. nevertheless, the qualitative incidence of aggregations and segregations is similar to the one that we found, and 65% of the significantly aggregated genera that we could compare were also co-occurring in their analysis. the co-coccurrence analysis shows that pairs of taxa that are ecologically related through co-occurrence or exclusion tend to have larger competition and cooperation scores than unrelated taxa, which supports the idea that ecological interactions lie behind many aggregation and segregation events. horner-devine and coworkers examined  <dig> matrices of presence-absence of bacterial taxa and computed their c-score  <cit> , finding that all but one significant c-scores were positive, which suggests prevalence of segregation over aggregation  <cit> . however, the c-score is a global measure that may be positive even in the absence of significant segregations if the majority of pairs co-occur less than expected, which is very likely due to the discretization of presence-absence matrices. gotelli and ulrich found that the c-score may be highly significant even if the number of significantly aggregated pairs is larger than the number of significantly segregated pairs  <cit> . levy and borenstein recently studied through metabolic models the complementarity and competition of pairs of bacterial taxa, predicting that taxa that co-occur in the gut microbioma tend to compete more than those that exclude themselves  <cit> . this prediction suggests that microbiome assembly is dominated by habitat filtering. we also consider habitat filtering as the most economic explanation for the aggregation of taxa that co-occur in one or few environmental subtype, but not for those that co-occur in a wide range of environments. one should be cautious in using metabolic predictions, since the difference between metabolic competition and syntrophy may depend on a small number of key enzymes: the introduction of just one engineered gene in strains of the same bacterial species can turn their competition into a strong synergistic interaction  <cit> . moreover, using metabolic predictions it has been shown that it is possible to identify putative media that induce commensalism or mutualism for all the examined pairs of seven bacterial species <cit> .

there is an increasing number of experiments that attempt to investigate ecological interactions between bacteria on a large scale. a recent experiment measured the overall respiration of assemblies of species and attributed competitive interactions to assemblies in which the total respiration was less than the sum of the respiration of individual species, concluding that competition, not cooperation, dominates interactions among culturable bacteria  <cit> . however, respiration does not measure biomass production but production plus dissipation, which is expected to increase in the absence of ecological partners  <cit> . in contrast, another recent experiment found the seemingly opposite result that bacterial taxa have lower growth rate when assayed in the absence of other taxa in their natural community  <cit> , suggesting that cooperative interactions are common. moreover, a recent experiment found that environmental bacteria are organized into socially cohesive units in which cooperation mediated by antibiotic resistance tends to occur within each ecologically defined population while antibiotic-mediated antagonism occurs between populations  <cit> .

in addition, it is relatively easy to set up experiments in which cooperative interactions evolve or are maintained  <cit> , or to find growth media compositions such that the two species are predicted to grow synergistically  <cit> . a recent work has realized synthetic communities of engineered strains of the same bacterial species linked through the metabolic exchange of amino acids, finding that biosynthetically costly amino acids tend to promote strong cooperative interactions and presenting genomic evidence that suggests that amino acid crossfeeding and synergistic growth are common in bacteria  <cit> .

last, we discuss the interesting observation that phylogenetically related taxa have large aggregation propensity. this result was also found in ref.  <cit> , where it was attributed to habitat filtering. nevertheless, this tendency exist also for cosmopolitan bacteria and for pairs that co-occur in many different environments, which suggests that some of these aggregations may be due to cooperative interactions. this hypothesis is puzzling. since closely related taxa are expected to have large metabolic overlap and to compete strongly, as predicted by the metabolic models of ref.  <cit> , specialization into different niches or physical separation as in allopatric speciation may be expected to be a likely outcome of a speciation event, leading to segregation between related taxa, which is the contrary of what we observe here. this interpretation is consistent with the recent experiment by mee et al., who turned strains of the same bacterial species from competitors to cooperators by engineering metabolic dependencies <cit> .

the recently proposed black queen hypothesis  <cit>  postulates a process in which the evolutionary loss of a gene whose product leaks out of other cells is selectively advantageous for the acceptor strain, which looses the gene and reduces its genome, and neutral for the donor strain, which disposes the gene without additional costs. this model has been proposed as a general mechanism for the establishment of cooperative bacterial communities  <cit> , and its paradigmatic example is thought to be the evolution of genome reduction in several strains of the marine cyanobacteria prochlorococcus  <cit> .

the observation that phylogenetically related taxa are prone to aggregate may suggest that cooperative interactions played a role in their differentiation. a possible scenario, consistent with the black queen hypothesis and the experiment of mee et al., who turned strains of the same bacterial species from competitors to cooperators by engineering metabolic dependencies  <cit> , is that one strain lost some genes not needed in its new dominant environment and established an enviroment-dependent metabolic dependency on a sister strain that disposes the products of these genes. this scenario may be testable. in the absence of a direct test, it is just a speculation, and the interpretation that the aggregation between related taxa is mainly due to habitat filtering should be preferred as more economic.

CONCLUSIONS
in conclusion, our results show that aggregations are frequent in the bacterial world, and they occur more frequently for cosmopolitan taxa and for phylogenetically related taxa. our data support the view that a large number of these aggregations may be due to cooperative interactions. 57% of the aggregations occur in at least two different supertypes, and in our view they are more likely explained by cooperative interactions than habitat filtering, although the latter cannot be ruled out and indirect interactions with a third taxon can offer another possible explanation. aggregations are particularly common for cosmopolitan taxa that are found in very different environments and for phylogenetically related taxa, which leads us to conjecture that cooperative interactions may be key for the remarkable cosmopolitanism of some bacterial taxa, and they may influence the mechanisms of bacterial differentiation.

