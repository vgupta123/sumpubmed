BACKGROUND
metabolism is a highly regulated dynamic process that involves transport and chemical reactions of thousands of metabolites to fulfill hundreds of metabolic functions. metabolic dysfunction is a major contributor to many diseases which have become prevalent in human population in the last decades, e.g. cardiovascular diseases  <cit> , neurodegenerative diseases  <cit>  and cancer  <cit>  amongst many others. alternative pathways and branches are continuously activated or shut down to maximize metabolic efficiency in a specific context  <cit> , resulting in disease and patient-specific alterations.

metabolism is regulated at multiple-levels with abundance and expression of the metabolic enzymes being one of the most decisive mechanisms. gene expression control has to integrate multiple signals both at transcriptional and post-transcriptional levels. at the epigenetic level the availability of various transcription factor  binding sites through chromatin decondensation at context-specific enhancers is regulated by the interplay of tfs and post-translational histone modifications deposited by the recruited co-activators  <cit> . enhancers adhere to unique chromatin states defined by features such as deposition of histone variants, presence of co-activators and monomethylation of histone h <dig> at lysine  <dig>   <cit> . more recently, acetylation of histone h <dig> at lysine  <dig>  was described to specifically mark active enhancers engaged in regulation of rna polymerase activity through chromatin looping  <cit> . recent work on genome-wide analysis of active enhancers has revealed that important genes determining cellular identity, such as tfs, are often controlled by large and strong clusters of multiple enhancers called super-enhancers or stretch-enhancers that are active in a cell type-specific manner . moreover, these enhancer clusters usually reside in insulated chromatin loops or domains and often overlap with so called tf hotspots, suggesting that their target genes are under high regulatory load from multiple tfs and enhancers, integrating numerous different signals to promote proper cellular phenotype, including the appropriate metabolic network  <cit> . however, the role of high regulatory load genes in the metabolic networks has not been studied previously.

metabolic networks are highly complex and can hardly be understood without using mathematical representations. the most comprehensive descriptions of metabolism are genome-scale reconstructions . there are several human reconstructions available, like recon  <dig> and recon  <dig>  <cit>  or the edinburgh human metabolic network  <cit> . alongside with these reconstructions extensive reaction databases were developed, like hmr  <cit>  or humancyc  <cit> , which collect additional information to refine the available models. mathematical models derived from genres were successfully used to understand how perturbations in the metabolism lead to severe pathologies  <cit> .

genres are usually generic representations of a cell or organism comprising all reactions that can potentially become active regardless of the specific environment and cell type. therefore they do not cover the fact that the set of expressed genes and thereby the set of active reactions vary significantly in function of the cellular context. the generation of context-specific models that include only pathways predicted to be active in the given context is highly desirable and has lead to the development of various algorithms like gimme  <cit> , imat  <cit> , made  <cit> , mcadre  <cit> , init  <cit>  or mba  <cit> , that use omics data for building of context-specific model. while allowing the generation of models with higher predictive power than the genres from which they were derived from  <cit> , these algorithms suffer from high computational demands due to the application of mixed integer linear programming, and/or the required setting of one or several expression thresholds.

recently we proposed an lp-based algorithm for the fast reconstruction of compact context-specific metabolic networks  that allowed decreasing the reconstruction time of context-specific networks to the order of seconds, using as input a genre and a set of core reactions being active in the context of interest  <cit> . fastcore identifies a close to minimal set of non-core reactions from the input model, to be added to the core set in order to obtain a consistent model.

to adapt fastcore for the direct integration of microarray data, we propose here a new workflow: fastcormics pre-processes microarray data with the discretization tool barcode  <cit> , is devoid of arbitrary parameter settings and has a low computational demand with overall context-specific model building times in the order of a few minutes. we use fastcormics to generate multiple metabolic models across tens of primary cell types and analyze the cell type-specific usage of the alternative branches in metabolic networks. to address the question of epigenetic regulation of metabolism in different cell types we performed genome-wide mapping of active enhancers in primary human macrophages and integrated these data with metabolic models of monocyte-to-macrophage differentiation to expose the metabolic genes under high regulatory load by multiple enhancers. we show that high regulatory load genes have a cell type-selective expression profile within any metabolic pathway and a specific positioning of many of these genes at transport or entry point reactions of pathways.

RESULTS
analysis of cell type-specific metabolic networks of primary human cells
in order to adapt fastcore for the integration of transcriptomics data from microarrays, we developed a new workflow named fastcormics , requiring as inputs microarray data, which are first pre-processed with the discretization tool barcode  <cit> , and a genre of the organism of interest. like fastcore, fastcormics is devoid of arbitrary parameter settings and has a low computational demand with overall building times in the order of a few minutes.

to validate fastcormics, we first performed an essentiality assay on two generic cancer models based on recon  <dig> and recon  <dig> and existing microarray expression data from  <dig> cancer cell lines  <cit>  . comparison to a ranked gene list based on an shrna essentiality screen in several different cancer cell lines  <cit>  shows the significant predictive power of the fastcormics models . benchmarking against similar algorithms shows that fastcormics clearly outperforms competitors in speed, while predicting the highest number of essential genes and achieving best significance levels among other algorithms . a hypergeometric test also showed that the neoplasia-associated genes retrieved from the disgenet database  <cit>  are over-represented in the essential genes of both fastcormics models . finally, predicted lactate secretion rates based on cancer cell line specific reconstructions showed a good correlation with measured rates indicating the capability of fastcormics to also generate context specific reconstructions .

in order to identify cell type-specific differences in the usage of the human metabolic network and to further validate the fastcormics workflow, we generated context-specific metabolic models based on recon  <dig> for different cell types across most human lineages. from an existing collection of  <dig> microarrays  <cit> , we selected a subset of  <dig> microarrays , corresponding to  <dig> primary human cell types at their resting states, and took advantage of the low computational demands of fastcormics to generate a model for each microarray. all reconstructed models are available in sbml format . interestingly, clustering the different models according to their active reactions allowed clear separation between the cell types largely along their developmental origin or cellular function, suggesting significant differences in the metabolism across cell types . the most unique metabolism was predicted for the gametocytes, oocytes and spermatocytes, which at lowest showed only around 30 % similarity to other cell types. some of the largest clusters were formed by the different blood cells that clustered together with their progenitors as well as cd34+ hematopoietic stem cells, suggesting many shared features in their metabolism.fig.  <dig> identification of cell type-specific metabolic pathways in primary human cells. a  <dig> metabolic models based on an equal number of microarrays and corresponding to  <dig> primary human cell types were built using the fastcormics workflow and microarray collection from primary cell atlas . the level of similarity between the different model pairs was determined via the jaccard index. the jaccard index matrix was then clustered in function of the similarity level. b for each pathway, the level of activity, given as percentage of reactions of the consistent version of recon  <dig>  that are present in each context-specific model was computed. the distribution of the activity levels of each pathway across the  <dig> models are shown as box plots and sorted according to the median value across the pathways. pathways that contain less than  <dig> reactions were not included. mean percentage of active reactions across macrophage and monocyte samples are depicted by black asterisk  and green cross , respectively



to investigate how much the different pathways contribute to the differential metabolism between the cell types, and what are the most unique pathways in different cell types, we looked into the activity state of all reactions according to the pathways they belong to. figure 1b lists all the recon  <dig> pathways consisting of more than one reaction, ordered by their combined median activity in all analyzed cell types with the first pathways  showing no activity in almost none of the analyzed cell types and the last pathways being fully active in almost all cell types. the distribution of these values indicates the variation in the number of active reactions for each pathway between cell types and, for example, the usage of additional or alternative branches of the pathways. by focusing on the most deviant values of any pathway one can identify the cell types that show very high or very low number of active reactions for that pathway compared to other cell types, and can thereby identify the cell type-specific branches of those pathways.

altogether, as expected, the different cell types exhibit differential usage of their metabolic pathways, ranging from ubiquitous to cell-type specific. this variation can be captured by fastcormics and allows clustering of the cell types according to their functions and developmental origins.

metabolic modelling of primary human monocyte-to-macrophage differentiation
one of the cell types with particularly high proportion of active reactions compared to other cell types across many metabolic pathways are macrophages. this is true when comparing to the median of all cell types as well as when comparing to the immediate precursor cells, the monocytes . to gain more detailed understanding of the differential usage and regulation of the metabolic pathways in macrophages, we chose to generate our own expression data with sampling at multiple time points during differentiation of primary human monocytes to macrophages as well as regulatory data from macrophages by mapping active enhancer regions . this was done in multiple biological replicates to stringently focus on regulatory regions that are active in most healthy individuals .fig.  <dig> transcriptomic profiling of primary human monocyte-to-macrophage differentiation. a-b primary human monocytes isolated from donated blood samples were differentiated into monocyte-derived macrophages in vitro, and microarrays were performed with total rna extracted on time points day  <dig>  day  <dig>  day  <dig> and day  <dig>  in addition chromatin was isolated for chip-seq experiments from day  <dig> macrophages. c relative expression levels of differentially expressed genes during monocyte-to-macrophage differentiation selected with a fdr cut-off of  <dig>  and absolute fold change greater or equal to  <dig> were clustered and represented as a heatmap. genes with a positive z-score are represented in red and negative in green. on the right of the heatmap, the time points where the differentially expressed genes show significant changes are indicated for a comparison between d <dig> and the remaining time points in different shades of the blue, between d <dig> and d <dig> or d <dig> in yellow or green and between d <dig> and d <dig> in red, indicating that most significant expression changes occur already at early time points. d. a gene ontology analysis for enriched biological processes and kegg pathways was performed on the differentially expressed genes using david  <cit> . the top ten gene ontology terms for the biological processes and the top five kegg pathways are listed. e relative expression levels of recon  <dig> genes with differential expression  during monocyte-to-macrophage differentiation are represented as a heatmap as in panel c




for the expression profiling we chose to isolate primary human monocytes from blood samples of four healthy donors and to differentiate those to adherent mature macrophages over a time course of 11 days . total rna was collected at four time points,  <dig>   <dig>   <dig> and 11 days after isolation, and used for gene expression profiling by microarrays . time points before  <dig> days were not considered as the cells at these early stages are affected by the stress from the collection and isolation. during the differentiation , a total of  <dig> genes were significantly up-regulated  while  <dig> were down-regulated . most expression changes occurred already early in the differentiation and were not too dynamic, as most genes that changed significantly during the differentiation , also remained differentially expressed in day  <dig> macrophages . gene ontology  and kegg pathway analysis of the differentially expressed genes revealed enrichment for many categories and pathways related to macrophage function, suggesting the differentiation had been successful . the differentially expressed genes included also  <dig> tfs. among the highest expressed tfs in macrophages we found cebp-family factors , egr <dig>  spi <dig> , srebf <dig>  and fli <dig>  most of which are known regulators of macrophage differentiation and phenotype . rreb <dig> was the only factor among the  <dig> highest expressed tfs for which we did not find any previously described role in macrophages. finally,  <dig> metabolic genes became differentially expressed with a log <dig> fold change ≥ <dig>  during the differentiation, most of which were up-regulated .

the microarray data was used as an input for fastcormics to generate four metabolic models that correspond to each tested time point of macrophage differentiation . all reconstructed models are available in sbml format . out of  <dig> reactions in the consistent recon  <dig> ,  <dig> reactions were predicted to be active in each time point of macrophage differentiation . the complete size of the day  <dig> monocyte model was  <dig> active reactions , which increased to  <dig> active reactions  in day  <dig> macrophages, suggesting that many inactive alternative branches become active during differentiation. many of the newly activated reactions were turned on already early on day  <dig> of differentiation with most of the remaining reactions becoming active by day  <dig>  the number of reactions that became inactive in macrophages is smaller with only one pathway decreasing its overall number of active reactions.fig.  <dig> monocyte-to-macrophage differentiation is accompanied by activation of alternative metabolic branches and increased activity of already active pathways. for each pathway, the level of activity  was computed for each time point . each column represents the model built by the fastcormics workflow for the given time point whereas each line stands for a different pathway. the fraction of active reactions ranges from  <dig> to  <dig> and is represented in shades of gray for low, yellow for intermediate and red for high number of active reactions per pathway. additionally,  the significantly differentially expressed genes  were mapped to the models via the gpr rules. the percentage of up-regulated reactions in a pathway was computed after summing up the significantly up-regulated reactions. the number of significantly down-regulated reactions was then removed from this sum and the total was then normalized by the number of reactions in the pathway. the fraction of reactions associated with differentially expressed genes ranges between − <dig>  for down-regulated pathways in blue and  <dig>  for unregulated pathways in red. only pathways that show a differential expression over time are represented



among the pathways with highest relative number of active reactions in macrophages were several fairly ubiquitously active pathways such as hyaluronan metabolism, chondroitin sulfate degradation, and n-glycan degradation . however, most of these, as well as many other pathways with steady overall number of active reactions  still showed a significant increase in the expression of the genes corresponding to their active reactions, suggesting a further increased flux for these pathways in macrophages . the total of  <dig> subsystems that showed an increase in the expression of genes controlling them, are listed in fig.  <dig>  together with the  <dig> subsystems showing decreased activity. cross-validation based determination of confidence levels of the included model reactions  show high or moderate confidence for approx. 80 % of the reactions, indicating that only approx. 20 % of the reactions did not have expression based support, i.e. were added by fastcormics to generate a consistent network model. and approx. 88 % of the excluded reactions had multiple evidences  for not being included.

next we aimed to find out which subsystems are particularly active in macrophages when compared to other cell types, including monocytes, and therefore possibly under macrophage-specific regulation. since our own data were generated with more recent affymetrix arrays  where limited possibilities for comparisons to public data exist, we focused here also on the macrophage samples from the primary cell atlas  <cit> . results are depicted in fig. 1b and additional file 1: figure s <dig>  among the interesting subsystems, for example, more than 60 % of reactions in tryptophan metabolism are predicted active in macrophages while the median value across cell types is 30 %. this is consistent with the models of monocyte-to-macrophage differentiation from our own data, which suggest over 3-fold increase in active tryptophan metabolism reactions over the time course . similarly, approximately 80 % of reactions in cholesterol metabolism are predicted active in macrophages, compared to a median of 45 %. also here there is a comparable 2-fold increase in active reactions from day  <dig> monocytes to day  <dig> macrophages in the models based on our own microarrays. consistently with increased cholesterol metabolism, also bile acid synthesis, a major cholesterol catabolism pathway, is predicted to have more active reaction in macrophages  than the median across other cell types , other interesting pathways with particularly high numbers of reactions in macrophages include triacylglycerol synthesis and valine, leucine and isoleucine metabolism, both of which show further increase in expression during differentiation from monocytes to macrophages. overall these results suggest that some alternative branches of the above-mentioned pathways could be under cell type-specific regulation in macrophages.

taken together, time course analysis of metabolic models during macrophage differentiation predicts changed activities for hundreds of reactions, many of which occur already at early time points and, in contrast to what could be assumed from transcriptome-wide expression level changes, consist largely of increased reaction activities, especially in alternative branches of already active pathways.

identification of metabolic genes under high regulatory load in macrophages
recent work has shown that active enhancers directly involved in transcriptional activation via chromatin looping are marked by specific chromatin modifications such as acetylation of lysine  <dig> of histone h <dig>   <cit> . moreover, we and others have shown that genes under high regulatory load from multiple tfs are often disease-associated and acting as cell type-specific key regulators of cellular identity  <cit> . importantly, these genes are marked by a high number of strong enhancers, collectively also called super-enhancers or stretch-enhancers  <cit> , allowing their identification using epigenomic mapping of active enhancers.

in order to identify metabolic genes under high regulatory load in macrophages, we performed chromatin immunoprecipitation coupled to high throughput sequencing  with an antibody against h3k27ac in primary human macrophages derived from additional three donors different on top of the donors used for the microarray analysis. analysis of the obtained sequencing data identified approximately  <dig> - <dig>  active enhancer regions in macrophages, depending on the sample, with  <dig>  regions detected in all three samples . the reproducibly identified enhancers in proximity of induced genes correspond to binding sites of known macrophage tfs such as srebf <dig>  fli <dig>  cebp-family and spi <dig>  as suggested by the de novo motif analysis of the underlying sequences for enriched motifs .fig.  <dig> identification of high-regulatory load genes in human macrophages. a active enhancer regions were identified via chromatin immunoprecipitation coupled to high throughput sequencing  with an antibody against h3k27ac using chromatin from monocyte-derived day  <dig> macrophages from  <dig> anonymous donors. enhancer regions were considered reproducibly detectable when their genomic coordinates overlapped by at least one nucleotide in all biological replicates. b selected enriched sequence motifs located within the identified active enhancer regions associated to upregulated genes in macrophages and corresponding to known transcription factor binding sites are shown. see full list in additional file 1: figure s <dig>  c genes associated with at least one active enhancer region were ranked in function of the number of active enhancer regions. a threshold  corresponding to the top 10 % and at least  <dig> active enhancer regions was set to segregate between high regulatory load genes and the remaining expressed genes . 105 kb genomic regions surrounding spi <dig> and cd <dig> loci, mapped reads indicating h3k27ac enrichment from the three donor samples, and called reproducible peaks are shown as examples of high regulatory load and low regulatory load genes, respectively. d the distribution of the expression levels of the high regulatory load genes was compared to genes that have a number of enhancers below the threshold of seven enhancers but that are associated to at least one enhancer . e the enhancer load of the metabolic genes present in the consistent version of recon <dig> was determined and then manually curated to minimize false peaks-to-gene assignments allowing identification of  <dig> high-regulatory load genes ,  <dig> of which mapped to the macrophage model. the distribution of expression levels of these metabolic high regulatory load genes was compared to the distribution of expression of the remaining metabolic genes of the macrophage model 



when assigning the enhancer regions to their putative target genes , we observed that almost  <dig> genes were associated with at least one active enhancer in macrophages, despite our stringent selection . ranking the genes according to their regulatory load  revealed that the number of enhancers per gene ranged from  <dig> up to  <dig> with only the top 10 % of the associated genes having  <dig> or more enhancers. among these top genes were numerous tfs, many of which were already identified as highly expressed and enriched for their binding site motifs, including cebp-family members, spi <dig>  and fli <dig>  as an example of a high regulatory load gene, the genomic locus of spi <dig> – the well-known pioneering factor and key regulator of macrophage differentiation – with two large clusters of multiple enhancers, is depicted in fig. 4c. in contrast another abundantly expressed macrophage gene, cd <dig>  is using only one intragenic enhancer region. interestingly, rreb <dig>  which we had previously noticed among highly expressed tfs in our microarray data, but for which no role in macrophages has been described, was the gene with third highest enhancer load of all genes in our experiments, suggesting that rreb <dig> might play an important role in macrophages or their differentiation. finally, analysis of the expression levels of the top genes with ≥  <dig> associated enhancers confirmed them to be on average significantly higher expressed than the genes with fewer enhancers .

next we focused on the identification of the metabolic genes under high regulatory load. in total there are  <dig> metabolic genes expressed in the macrophages that are consistent with our metabolic model and  <dig> of them belong to genes under high regulatory load of  <dig> or more enhancers in our data set . importantly, the expression of the metabolic genes under high regulatory load is even more shifted towards high expression levels when compared with other expressed metabolic genes .

in summary, we reproducibly identified over  <dig>  active enhancers in primary human macrophages, a large proportion of which could be associated to the top 10 % of genes with high regulatory load. these genes are expressed at high levels and include many of the known key regulators of macrophage phenotype as well as  <dig> metabolic genes.

genes under high regulatory load control macrophage-specific control points of metabolic pathways
given that genes with high regulatory load are important for the cell identity and often expressed in a cell type-specific manner, we decided to analyze the expression levels of the macrophage metabolic model genes across numerous different cell types. to this end, we again used the microarray data collection from mabbott et al.  <cit> , this time taking advantage of all  <dig> arrays corresponding to a total of  <dig> different cell types and conditions, and analyzed the expression level of each metabolic gene across the  <dig> conditions and ranked it according to its average level in the monocyte-derived-macrophage samples contained in the data set. figure  <dig> depicts these ranks for all genes of the macrophage-specific metabolic model that belong to a subsystem containing at least one high regulatory load gene. analysis of the distribution of the expression ranks along the cell types and subsystems reveals that; 1) the genes under high regulatory load  show an overall shift towards the upper ranks of macrophage metabolic genes, arguing they are generally expressed in a macrophage-specific manner, and 2) they are the more selectively expressed genes within each metabolic subsystem . at the same time the other genes contained in the macrophage model show an even distribution across the ranks, suggesting a more ubiquitous expression between cell types.fig.  <dig> high-regulatory load genes show macrophage specific expression and are the highest expressed genes in their respective pathways. the normalized expression values of the  <dig> arrays of primary cells atlas were downloaded from the gene expression omnibus repository . the  <dig> arrays are subdivided in  <dig> separate cellular contexts. for each reactions-related gene of a pathway, the normalized expression value was retrieved and for each gene, the  <dig> conditions were ranked from the highest expressed to the lowest expression level with the impavrank function from  <cit> . for each pathway, the genes are plotted in function of the rank of the monocyte-derived macrophages among the  <dig> conditions. each rank position is represented as a box along the y-axis. high-regulatory load genes are mapped along this axis in function of their rank and depicted in orange, whereas the remaining genes in the pathway are depicted in dark gray



since most of the metabolic genes with high regulatory load in macrophages are preferentially expressed in macrophages, and are usually the most abundantly expressed genes within their respective pathway, we asked in addition whether the positioning of the reactions they control within the macrophage metabolic network is also different from other reactions. indeed, we could observe clear differences when focusing on the genes associated to transporters or entry points of the pathways predicted active in the macrophage model . while  <dig>  % of all gene-associated reactions in our macrophage metabolic model are transport or entry point reactions, this fraction increases significantly to  <dig>  % when focusing on reactions associated to high regulatory load genes . furthermore, when looking only on transport reactions that constitute  <dig>  % of all macrophage reactions, we observe an even more significant enrichment  to  <dig>  % of the reactions associated with high regulatory load. finally, when excluding the transport reactions and focusing on the reactions corresponding to the remaining entry points of the different pathways  we also see an enrichment for the high regulatory load genes , although with clearly higher p-value . importantly, similar results could not be obtained using a generic metabolic reconstruction such as recon <dig> , further highlighting the importance of using context-specific models and cell type-specific epigenomic data.fig.  <dig> high regulatory load genes control transport and entry point reactions in macrophages. the enrichment of transport reactions and other entry point reactions under high-regulatory load among the gene-regulated reactions of the macrophage model was computed using hypergeometric test. an entry point is defined as the first reaction of a pathway change when considering the flux direction. in addition, the transport reactions and entry point reactions were tested separately to estimate their contributions to the observed enrichment



taken together, genes associated to reactions at important control points of the macrophage metabolic network such as transporters or other pathway entry points are particularly enriched for high regulatory load, and exhibit abundant and cell type-specific expression patterns, possible enabling cell type-specific control of the downstream pathways.

entry to alternative bile acid synthesis pathway via cyp27a <dig> is under high regulatory load and depends on multiple transcription factors
an interesting example among pathways with differential activity in macrophages is the bile acid synthesis pathway, which also serves as the major cholesterol catabolism pathway. consequently, it also produces intermediates like oxysterols that serve as regulators of gene expression through their role as endogenous ligands for transcription factors like liver x receptors . the bile acid synthesis pathway has two genes with high regulatory load in macrophages, cyp27a <dig> and acp <dig>  which are also the highest expressed genes of the pathway throughout the differentiation from monocytes to macrophages . both genes are the most macrophage-specifically expressed genes of the pathway  and cyp27a <dig> shows the most abundant expression in different macrophage cells and selected dendritic cells . cyp27a <dig> is known to be involved in catalyzing the mitochondrial reactions of the classic, or neutral, bile acid synthesis pathway in the liver  <cit> . in addition, cyp27a <dig> is also responsible for the first reaction of the alternative, or acidic, pathway to hydroxylate cholesterol directly in the mitochondria to 27-hydroxycholesterol in extrahepatic tissues, in particular in macrophages   <cit> . therefore cyp27a <dig> is a prime example of a high regulatory load gene potentially integrating multiple signals to control an entry point reaction of an alternative pathway.fig.  <dig> the alternative pathway of bile acid synthesis is controlled by high regulatory load on cyp27a <dig> gene. a the mean normalized expression values of the genes implicated in the bile acid synthesis pathway based on the microarray data across the four differentiation time points are depicted. high regulatory load genes  are presented in different shades of orange and with a thicker line than other genes of the pathway. b for each gene of the bile acid synthesis pathway, the rank of the expression level in the macrophage samples among the  <dig> conditions and cell types of the primary cell atlas are shown by an orange or gray star  for high regulatory load genes and genes that are not under high regulatory load, respectively. genes in the top ranks are situated in the top of the figure. c the expression profile for cyp27a <dig> across all  <dig> conditions and cell types from primary cell atlas as arbitrary expression units. macrophage samples are depicted in red. d the alternative pathway of bile acid synthesis was visualized in cytoscape. to allow the alternative pathway to carry a flux, an exchange reaction was added, enabling the export of the last metabolite from the cell. reactions predicted active in this modified macrophage model  are depicted as filled black circles or filled orange circles for reactions under control of high-regulatory load genes. the size of the nodes correlates with the number of associated enhancers. the reaction names correspond to reaction-identifiers of recon  <dig>  e the normalized expression levels of cyp27a <dig> in microarray analysis of thp- <dig> monocytes in a series of knock-down experiments for  <dig> different transcription factors or regulators and three unspecific control sirnas retrieved from the fantom consortium database. expression values were normalized to the first control sirna  and represent the mean expression values ± sd . student’s t-test determined the significance of changes in response to sirna transfection 



finally, to test which transcription factors could be responsible for the high regulatory load of cyp27a <dig>  we analyzed microarray data from the fantom consortium for knock-down experiments of  <dig> transcriptional regulators in thp <dig> monocytes   <cit> . interestingly, almost half of the tested knock-downs affected cyp27a <dig> expression directly or indirectly with  <dig> tfs showing significant downregulation after transfection and additional  <dig> regulators causing a significant upregulation . among the tfs causing significant change in cyp27a <dig> expression upon knock-down were many known myeloid regulators that were also predicted as key tfs based on our de novo motif analysis , including cebp-family members, forkhead-family members, and fli <dig>  moreover, cebpb and srebf <dig> knock-downs both led to decreased expression levels just above the significance cut-off with p-values of  <dig>  and  <dig> , respectively, altogether indicating that cyp27a <dig> expression is controlled by multiple transcription factors in monocyte-derived macrophages.

discussion
here we present a novel workflow, fastcormics, for the fast, robust and accurate generation of metabolic models based on transcriptomics data generated by microarrays and use fastcormics to generate multiple metabolic models across tens of primary cell types. this analysis reveals a cell type-specific usage of the alternative branches in metabolic networks and raises the question about the epigenetic regulation of metabolism in different cell types. to address this question we performed genome-wide mapping of active enhancers in primary human macrophages and integrated these data with metabolic models of monocyte-to-macrophage differentiation to expose the metabolic genes under high regulatory load in macrophages and general features of these genes within metabolic networks. interestingly, the high regulatory load genes show the most abundant and cell type-selective expression profiles of the genes within any metabolic pathway and control in particular the different transport and entry point reactions of the pathways.

an interesting example of a metabolic enzyme controlling an entry point of an alternative pathway is cyp27a <dig>  which is encoded by one of the  <dig> metabolic genes under high regulatory load in macrophages. the alternative bile acid synthesis, which is initiated by cyp27a <dig> in mitochondria, is also the major cholesterol catabolism pathway in macrophages. therefore the regulation of cyp27a <dig> can be used to control cholesterol homeostasis in macrophages, and other extra-hepatic cell types, on one hand through initiating cholesterol catabolism, and on the other hand due to production of intermediate oxysterols that indirectly influence cholesterol efflux and biosynthesis  <cit> . cyp27a <dig> has therefore many implications to the development of atherosclerosis and cardiovascular disease. moreover, a mutation of cyp27a <dig> in humans causes a disease called cerebrotendinous xanthomatosis , which leads to accumulation of cholesterol in brain and tendons and is accompanied by neurological dysfunctions, including parkinsonism, as well as increased rate of atherosclerosis  <cit> .

the disease-association of cyp27a <dig> is consistent with previous findings from us and others that genes under high regulatory load, or controlled by so called super-enhancers, are often associated with disease  <cit> . indeed, our current findings suggest that within any cell type the top 10th percentile of highest regulated genes are significantly enriched for disease-association   <cit> . this is possibly due to their central roles as network hubs within gene regulatory networks, forming integration points for multiple signals. while this combinatorial regulation can be robust, it might also increase the likelihood of being affected by alterations such as single nucleotide polymorphisms  in the regulatory regions. this would be consistent with the experiments of siersbaek et al. who showed that omission of one tfs activity, that of glucocorticoid receptor , in early adipocyte differentiation had more potent effect on super-enhancer activity than on activity of more isolated gr binding sites  <cit> .

integrating gene regulatory networks with metabolic networks is an important and necessary step for truly global understanding of metabolism and its regulation. however, the role of high regulatory load genes in control of metabolism has not been previously specifically addressed. we find that high regulatory load genes, the central hubs of the gene regulatory networks, are significantly enriched for controlling transport reactions or other entry points of pathways, like in the case of cyp27a <dig>  with almost 70 % of such reactions located at transporters/entry points . they are the most abundantly expressed genes within the pathways and show most variation between cell types, suggesting they are used as the control points for cell type-specific metabolism. this is consistent with the findings in metabolic control analysis that for linear pathways with similar individual kinetics assigned to the different enzymes the flux control exerted at the upper part of the pathway and especially at the first step is much higher than in the lower part  <cit> .

while most high regulatory load genes do control entry point reactions, there remains a large proportion of them that do not. an interesting question is what other network positions are controlled by high regulatory load and to which end. among the non-entry point reactions associated to high regulatory load genes in macrophages many are situated immediately downstream of branch points where a metabolite can follow two different fates within the pathway. for example, kynurininase  is a high regulatory load gene catalyzing branch point reactions in tryptophan metabolism pathway to decide the faith of tryptophan metabolite kynurenine into downstream metabolites with inflammatory and neuroactive functions  <cit> . similarly, udp-glucose ceramide glucosyltransferase  is a macrophage high regulatory load gene controlling the commitment of sphingolipids to glycosphingolipid branch  <cit> . interestingly, the enzyme is also required for capture of hiv- <dig> viral particles into dendritic cells and useful for the virus upon infection  <cit> . in addition to branch point reactions, many high regulatory genes also control reactions along the metabolic pathways. regulation at such positions might be important for example to control accumulation of harmful or beneficial metabolic intermediates. however, it should also be pointed out that the consistency of the current human genres like recon  <dig> is only approximately 75 % and many branch or entry points might still remain unannotated.

in general the context-specific reconstruction of metabolic network models with fastcormics as presented here might be severely influenced by the quality of the used genre, especially when applying automated annotation pipelines. as the overall run-time of fastcormics is very low, it allows performing cross-validation studies as described earlier and thereby detecting high-confidence reactions with multiple evidence for their presence in the context-specific model of interest. in general, with run-times in the order of seconds fastcormics clearly out-performs competing algorithms and might serve as an important corner stone of many future applications.

we’ve used fastcormics to generate metabolic models of hundreds of human cell types, including a time-course of monocyte-to-macrophage differentiation. as discussed above, the cholesterol metabolism was predicted to be increased between day  <dig> and day  <dig> of the differentiation , consistent with the ability of healthy resident macrophages to uptake and release lipids, as part of their generic cleaning role or in a targeted way through low density lipoproteins   <cit> . this may also be correlated to the observed increase in the active reactions in phospholipid  metabolism or overall increase in expression of genes associated to reactions in triacylglycerol synthesis, the two other main lipid families that constitute ldls. also, the differentiation process between day  <dig> and  <dig> predicts an increase in the metabolism of the essential amino acid tryptophan, in particular with respect to its kynurenin metabolite  <cit> . in addition, also the metabolism of other relevant metabolites like the eicosanoids, another important signaling family  <cit> , or glutamate  <cit> , were increased, as well as pathways with fewer specific implications for macrophage biology like inositol phosphate, pyruvate and propanoate metabolisms. fastcormics is therefore able to contextualize a qualitative and quantitative difference between monocytes and macrophages.

more detailed analysis of pathophysiologic states of monocyte-to-macrophage differentiation in inflammatory conditions could be another informative application of the predictive efficacy of fastcormics. indeed, inflammation of the vascular wall is for example disturbing the uptake and release equilibrium of lipids by macrophages, making them become lipid-loaded foam cells by mechanisms involving oxidized ldl, and thus participate to the development of atherosclerosis  <cit> . also, inflamed microglia  have been shown to produce enhanced quantities of quinolinic acid, a metabolite of the tryptophan-derived kynurenin, which can become toxic to the brain and could participate to the development of various neurodegenerative processes among which alzheimer’s and parkinson’s diseases  <cit> .

fastcormics allows in a modular fashion to use medium information and/or a biomass function for improved contextualization. this would allow generating more accurate context specific network models. however, it might be challenging to obtain specific medium and biomass information for reconstructing a cell’s metabolism residing within a multi-cellular context. in the presented work a general biomass function was used. future progress in the respective analytical methods will therefore help to further improve the contextualization via fastcormics by providing more accurate specific medium and biomass information.

fastcormics is based on the discretization of the expression data with barcode, which to our knowledge currently is the most robust and reliable discretization method. the pre-processing step with barcode allows circumventing the need of setting an arbitrary expression threshold that segregates between expressed and non-expressed genes as e.g. in  <cit> . as such a threshold is arbitrary and critical for the output metabolic models as in response to this threshold complete branches, alternative pathways, or subsystems might be included or excluded, thereby heavily changing the functionalities of the model. further, barcode shows a better correlation between predicted expression and protein expression than competing discretization methods for the segregation of gene expression and allows reducing batch and lab-effects that affect measurements  <cit> .

an interesting future research question is if better context-specific reconstruction could be obtained by applying continuous weights instead of discrete core assignments or by a combination of the two approaches. while in general continuous weights might be able to better capture the continuous distribution of expression values, this would require the setting of arbitrary parameters to convert expression values into optimization weights, thus rendering this approach biased to arbitrary settings as also stated by machado et al.  <cit> . thus the overall performance of such approach needs to be investigated in more detail in future work. fastcore can form a valuable building block here as well.

such continuous approach might also be suitable to treat genes with reactions associated in multiple pathways  more efficiently, where a stringent including of core reactions without integration of the expression context of the remaining reactions in the pathway might not be the best approach.

furthermore fastcormics can easily be adapted for the integration of other omics types, like data from next generation sequencing methods such as rna-seq, while special attention has to be paid to the data type specific discretization step.

CONCLUSIONS
fastcormics allows obtaining high-quality, robust models in a high-throughput manner. this allows the use of metabolic modelling as routine process for the analysis of expression data. further integration with gene regulatory network data opens possibilities for better understanding of the upstream events and identification of novel drug targets such as the genes under high regulatory load which we here find to control entry points of pathways in the macrophage metabolic network.

