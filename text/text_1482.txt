BACKGROUND
given the complex three-dimensional  architecture of the brain, it is essential to explore the morphology and activity of neurons in all layers of the cortex. however, this can often be challenging because the dendrites of cortical neurons are widely spread across several layers, including deeper layers that are difficult to observe by confocal or light microscopy. the length of the dendrites can vary from 20 μm to 1 mm, and the width and branching of the dendrites depends on the distance from the soma. this suggests that spatial differences in brain morphology relate to the functionality of the neuron, including characteristics of the dendrite and synaptic efficiency  <cit> .

to understand the 3d structure of dendrites and the connectivity among neurons in the brain, in vivo imaging and visualization have significant roles. recently, the improved performance of microscopy systems has enabled the acquisition of large amounts of slice images from living tissues. in comparison with confocal or other optical microscopy systems, two-photon microscopy has an advantage in visualizing the morphology of neurons within deeper layers of a living mouse brain  <cit> . because the structures of tissues are stored as volume data, volume visualization techniques  <cit>  are focused on the interactive exploration of the 3d images. when visualizing unknown features in the deeper layers of the brain, prior knowledge of the morphology of tissues  <cit>  cannot be used. furthermore, microscopic images are affected by optical characteristics such as scattering within tissues and the presence of image noise within the deeper regions of the images. because large amounts of volume data are obtained through two-photon microscopy, there is a demand for efficient visualization of local internal structures and characteristic intensity distributions.

direct volume rendering  has been widely used for visualizing volume data, where the rendered image is generated from the data by simulating optical properties such as radiation and absorption  <cit> . the user can interactively explore the micro-level structures included in the volume data while changing the camera parameters, modifying the transfer functions  <cit>  or generating the cross-section of the 3d images. unlike the pattern recognition approach  <cit> , visualization does not involve algorithm-based detection for specific objects. in other words, the only aspects defined by the method are the transformations when visualizing the 3d image as a projection on the screen, and modifications of the visualization parameters and final judgments about the structures observed are left to the user.

the final quality of projections obtained with volume rendering depends significantly on the definition of the transfer functions . for this reason, the design of the tfs is regarded as an important area of research for volume visualization. clinical tools commonly provide predefined tfs  for efficiency in the clinical workflow. recent studies have improved the tfs based on multidimensional feature values to visualize changes in texture and morphological characteristics included in the images  <cit> . because the high degree of freedom in multidimensional tfs makes it difficult for users to obtain visualization results through manual parameter settings, a variety of user interfaces and automatic tf generation methods have been investigated  <cit> . in the case of visual exploration, there are many situations for which feature descriptors have not been formulated  <cit> . some researchers have focused on this issue and have investigated methods for exploring high-dimensional feature space. principal component analysis, independent component analysis, and clustering techniques are commonly used for dimensionality reduction of the feature space  <cit> .

in microscope images, the intensity value of voxels can differ locally, even within the same structure, because emission of fluorescent materials and the optical properties based on point spread functions affect the imaging results. most previous tfs designed for clinical computed tomography  and magnetic resonance imaging  images are not applicable to images that have specific areas with locally varying contrast. in addition, images obtained from brain tissue contain a variety of neural structures such as dendrites and white matter, where similar line structures are overlapped or crisscrossed with some complexity . numerous minute or thin structures can be closely observed with optical scattering noise. in these cases, previous tfs often fail to optimize the visualization results, making it difficult to explore the connectivity of neurons because of their occlusions and geometric complexity. the main focus of this study, therefore, is to answer these issues in biological visualization, and to design an efficient visual exploration tool.figure  <dig> 
visual exploration of overlapping neural structures.
 an example of three-dimensional microscope images with a depth ~ <dig>  mm from the surface layer of the cortex.  tomographic image of apical dendrites. the low contrast area shadowed by the blood vessels is shown within the red dashed lines. volume visualization results obtained by   a traditional intensity-based 1d tfs and  the proposed method, which succeeds in locally improving the visualization result.



this paper proposes an interactive visual exploration method by which the tfs are modified locally and interactively based on multidimensional features of the images. this method will also provide a direct editing interface to specify both the target region and the structures with characteristic features, where all manual operations can be performed on the rendered image. therefore, multidimensional features and interactive methods can be used for local improvement of the visualization results for overlapping structures. despite the high dimensionality of the tfs, users only specify the structures of interest on the rendered image and control simple parameters to explore similar structures. the performance of the method is demonstrated using two-photon microscope images measured from live mice. the experiments show that this method is effective for interactive visual exploration of overlapping similar structures.

regarding related study in vessel visualization, the recent work by kubisch et al.  <cit>  summarizes problems and reviews of related work. much recent work has focused on multi-scale methods based on eigenvalue analysis of the hessian  <cit> . using the vesselness measure, lathen et al.  <cit>  presented automatic tuning techniques by applying a locally shifted intensity to the tfs  in the vessel visualization domain. in computed tomography angiography , which is analogous to microscope images, the intensity value of blood vessels partially decrease owing to the distribution deflection of the contrast medium. the advantage of this approach is to use the 1d tf presets that are popular in clinical applications and are easily set up in a visualization workflow.

in this study, we consider an application of the tf shift technique to 3d microscope images. in biological visualization using two-photon or confocal microscope images, however, the main focus is on neural structures that crisscross in a complex way with multiple overlaps. the deep layers of the brain tissue contain a variety of neural structures with complex shapes such as soma, dendrites, and white matter. unlike the situation that exists in clinical ct or mri images, however, numerous minute or thin structures are closely observed with optical scattering noise, which creates challenges for volume visualization. to our knowledge there have been no reports on an interactive, visual exploration software and interface for overlapping similar neural structures in microscope images. this study proposes a new tf shift mechanism and interface that can efficiently use more general multidimensional feature values, while avoiding a complex tf design process.

methods
figure  <dig> shows slice images that include structures with characteristic shapes measured from a live mouse using a two-photon microscope. the central image shows the results of visualization of the entire image data with an intensity-based 1d tf. apical dendrites, dendrites, soma, and white matter, which are all parts of the neurons, are included in the images. in the apical dendritic region, linear structures run along the xy plane and each linear structure crisscrosses in a complex manner. the large linear shadow shown within the red frame in the middle of the image indicates blood vessels, because there is a tendency for a decrease in the intensity value of structures directly below blood vessels. in the dendritic regions, linear structures with a high intensity value can be found along the z axis and, around these, linear structures with low intensity values exist in large quantities, though these structures are not visible. the soma can be identified as a spherical structure. in the white matter region, most of the linear structures run in the specific direction of the xy plane.

we will now discuss our goals toward visualization in the microscope images. figure  <dig> is a tomographic image of apical dendrites located near the brain surface. however, there is actually a large quantity of low luminance neurons around the dendrites, making observation of the dendrites difficult. blood vessels with a diameter of ~30 voxels run within this data, and are seen as regions in which nerves do not exist. the low contrast area shadowed by the blood vessels is shown within the red frame in figure  <dig>  figure  <dig> and  shows the volume visualization results obtained by a traditional intensity-based 1d tf. the histogram of the voxel and the opacity curve setting in the tf is inserted in the bottom of each figure. in figure  <dig>  it is not possible to distinguish most of the structures with low intensity under the area of blood vessels. figure  <dig> shows another visualization result obtained by adjusting the window level parameter of the tf to a lower level. in this figure, some structures can be observed in the low contrast area. however, because of a widening in the range of opaque intensity, surrounding dendric structures and optical noises can occlude the target structure, which fails to distinguish the connectivity of the three-dimensional neural networks. figure  <dig> is a visualization result obtained by the method proposed in this study, which succeeds in distinguishing dendric structures and their connectivity under the blood vessels. because the color/opacity outside the target area does not change, the target structures with low intensity as well as the other structures outside of the region of interest can be seen simultaneously without self-occlusion or noise enhancement.

here, we describe a set of methods to achieve the above-mentioned local refinement of the rendered image. because intensity values and contrast can differ locally in the target data of this study, the method developed by lathen et al. for cta images  <cit>  is used as a basis for the local adjustment of tfs. to achieve automatic tuning of visualization results for linear structures, lathen et al. employed the vesselness measure as feature values. in our study, for visualization of various neural structures such as soma, dendrites, and apical dendrites with different features and sizes, we design a novel tf shift framework to address these multidimensional feature values. in addition, for efficient visualization of dendric structures that crisscross in a complex manner, locally similar structures are selectively visualized by direct editing of the visualization results on the rendered image.

flowcharts of the proposed method are shown in figure  <dig>  with the proposed method, a predefined 1d tf  is first prepared, and dvr of the target data is conducted. the colored histogram with a linear graph at the bottom of figure  <dig> and  is used as a tf setting interface, which is a common interface in medical visualization software. the user can change the color lookup table that maps the intensity to rgba values on the histogram. opacity values are defined using the linear graph or using free form curves manually drawn by the user. these configurations can be done by mouse operation only. in addition to modifying tfs, users can obtain desired visualization results based on the rendered images. users can directly specify the structures of interest Ω ∈r <dig> as visualization targets. during visualization workflow, users input into the system one point of a structure  similar to the structures of interest such that x <dig> ∈r <dig>  and the central coordinate of differential Ω . our system calculates the shift value  of the tf of all voxel positions  within Ω on the basis of xΩ and x <dig>  then, the input for the tf is modified, and dvr is again processed. if users are not satisfied with the rendering results, the tf can be modified again.figure  <dig> 
flowchart and user interface of the proposed visualization framework. multidimensional feature values of microscope images are addressed in visualization process with local tf shift. with the direct editing interface, the user can explore overlapping similar structures with spatially different contrast locally and interactively.



figure  <dig> shows changes in visualization when x <dig> is fixed and Ω is altered, along with the shift value Δ of the tf. in this case, the shape of the 3d pointer is a sphere, which works as a minimal roi for the local tf shift. the radius of the pointer is changed by the user, and the time series input by dragging a mouse defines the total roi Ω. therefore, the shape of the roi can be modified interactively and can be any form. by increasing the shift value of the tf in low-intensity voxels, if there is a similar structure one can assume the visualization results to be the same, regardless of the intensity value. the tf configured by the user is stored in a file to be re-used by different users or the same user at different times. because the tfs consist of volumetric, spatially-varying scalar values, the file format can be the same as three-dimensional image format.figure  <dig> 
interactive editing of the visualization results. by locally changing the shift value of the tf in the low-luminance area, similar structures with low intensity values can be visualized based on multidimensional features.



localized multidimensional transfer function
this section describes details of the designed spatially varying tf based on multidimensional feature values. in a method similar to the approach used by lathen et al.  <cit> , our system uses a basic objective function based on the eq.   <dig> tfx,ix,Δx=tfpresetix+Δx, 

where i is the intensity distribution of the volume data.

for selective visualization of a variety of structures contained in a microscope image, the design of the calculation formula of the shift value Δ of the tf becomes important. specifically, unlike the previous tf shift technique based on the vesselness measure, multidimensional features are addressed in our framework. the following section explains the concrete calculation formula of Δ. in addition, to allow users to interactively input x <dig> and xΩ into the system, it is essential to develop a method for inputting 3d coordinates on the rendering image.

the calculation formula of Δ is designed to meet conditions , , and , given as  if i = i, then rgba = rgba.

  if c ≈ c, rgba ≈ rgba.

  only rgba changes within the region Ω near xΩ.



in these conditions, the color/opacity value of point x is expressed as rgba, and the feature value of point x is expressed as c ∈rn.

condition  is used to maintain the integrity of the calculation. in the proposed method, reference point x <dig> can also become a processing target. for the situation where there is no shift in the tf of the reference point x <dig>  condition  must be feasible. condition  indicates that the color/opacity value of structures similar to x <dig> changes. if the features are similar, even with structures of different luminance, visualization can be achieved on the basis of the color/opacity value previously determined with tfpreset. condition  indicates that only the color/opacity value in the region Ω specified by the user changes. visualization that maintains visibility can be achieved through spatial and local visualization when structures with multiple overlaps are not portrayed. to satisfy condition , the shift function Δ should have i − i as a factor. introducing the function g where , Δ is determined as  <dig> Δx,x <dig> xΩ=ix0−ixgx,x <dig> xΩ. 

when g =  <dig>  then Δ = i − i and tfpreset becomes tfpreset). this means that the color/opacity value rgba in x becomes the same as rgba in x <dig>  when g =  <dig>  then Δ =  <dig>  and the color/opacity value rgba of x is unchanged. to achieve condition , the dissimilarity of c and c ,c) where ) in the feature value space is calculated. a larger df relates to a greater difference in the features of structures in x and x <dig>  the mahalanobis distance and inner product can be used in the calculation of df. equation  shows cases in which the mahalanobis distance dmah is used in eq. , and when the inner product ddot is used in eq. .  <dig> dmahcx,cx0=cx−cx0tv−1cx−cx <dig>    <dig> ddotcx,cx0=1−cx⋅cx <dig>  

where c is the feature value vector at x and v is the covariance matrix between every feature value. to achieve condition , the distance of x and xΩ is calculated in the virtual space by the euclidean distance de where . when considering the function g that satisfies conditions  and , g is first defined, as with eq. . next, the function ff, which changes in value according to the dissimilarity of features, and the function fe, which determines the range of Ω, are introduced as  <dig> gx,x <dig> xΩ=ffdfx,x0fedex,xΩ. 

to satisfy 1 ≥ g ≥  <dig>  ff and fe must each satisfy 1 ≥ ff ≥ <dig> and 1 ≥ fe ≥ <dig>  function ff, which satisfies condition , and the sigmoid function fe, which satisfies condition , are shown in eqs.  and , respectively. an outline of these functions is given in figure  <dig>  by using the sigmoid function in fe, the visualization results at the boundaries of Ω can be easily changed, and improvement in visualization quality can be expected.figure  <dig> 
two sub-functions
f
f
and
f
e
defined by the configurable parameters, where the parameter
α
is the sensitivity that determines the amount of the change in rgba dependent on the dissimilarity of the feature values and parameter
β
is the radius of the current region of Ω.


  <dig> ffdf=e−αdf,   <dig> fede=11+ede−β, 

where the configurable parameters α ≥  <dig> and β ≥  <dig> are introduced by the user. parameter α is the sensitivity that determines the amount of the change in rgba dependent on the dissimilarity of the feature values. parameter β is the radius that determines the size of region Ω. the shift value Δ when ff and fe from eqs. , , and  are used is given as  <dig> Δx,x <dig> xΩ=ix0−ixe−αdf1+ede−β. 

direct editing interface
in this section, we consider the method for directly inputting the 3d coordinates x <dig> and xΩ onto the rendered image. with the volume rendering process, volume data are projected in the viewing direction νeye∈r <dig>  as such, there are voxels drawn by the click point  of the rendered image in the direction of νeye, which originates from xclick. among the quantity of voxels existing in the direction of νeye, those close to the surface of the structure are believed to be the voxels specified by the user and are estimated using degrees of transparency  <cit> . first, the volume data are searched from the xclick point in the direction of νeye. during the search, voxels are sampled at fixed intervals, xi. next, the sum ∑i=0nαi of the opacity value  of xi is calculated. the value of αi is calculated using tf, Δ), which considers Δ. the voxel is acquired that is larger than a threshold opacity value  predefined by ∑i=0nαi, and these voxels are assumed to be those specified by the user and are close to the surface of the structure that has been visualized to consider the Δ.

RESULTS
we implement a sequence of algorithms using c++, opengl, glsl , and the software package nvidia cuda . we apply the developed software to two-photon microscope images and verify the visualization of the characteristic structures and the intensity distribution included in the images with biological researchers. for the 3d microscope image and for visualization of its feature volume, we use the texture-based rendering scheme  <cit>  to achieve high-speed volume rendering using the texture interpolation and synthesis functions of the graphics processing unit. for verification, we used three volume data sets taken from live, genetically modified mice  <cit>  using a nikon two-photon microscope , wherein the neurons in the second and fifth layers of the mouse cortex are labeled by a green fluorescent protein. the study was carried out in accordance with the recommendations in the guidelines for the care and use of laboratory animals of the animal research committee. the protocol was approved by the committee on the ethics of animal experiments. these data sets capture a tomogram with a depth ~ <dig>  mm from the surface layer of the cortex. the volume data have a size of 512 × 512 × 325 voxels, and the range of capture is 512 × 512 × 1300 μm. neurons are included within the image, and the direction from the deep part of the brain toward the brain surface is assigned as the positive z axis. apical dendrites, dendrites, soma, and white matter exist in the positive z direction. to reduce noise, a median filter is applied for preprocessing the volume data.

for this experiment, the ratios of the eigenvalues λ <dig> λ <dig>  and λ <dig> of the hessian matrix and the eigenvector e <dig> belonging to the third eigenvalue of the hessian matrix are used to express the shape feature. the feature value λratio, which highlights linear structures, is calculated from λ <dig> λ <dig>  and λ <dig> based on  <dig> λratio=λ2/λ1−λ3/λ1λ2/λ10λ1≤λ2≤λ3≤0λ1≤λ2≤ <dig> λ3>0otherwise 

voxels with large λ2/λ <dig> ratios are linear or spherical local structures, whereas those with large λ3/λ <dig> ratios are spherical local structures. as such, voxels with a large difference value for λ2/λ1−λ3/λ <dig> are linear local structures. in addition, linear structures with an intensity less than that of the background have positive values of λ <dig> and λ <dig>  whereas those with an intensity greater than that of the background have negative λ <dig> and λ <dig> values. because the linear structures included in the target data of the present experiment have an intensity value greater than that of the background, λratio is prevented from becoming increased  with an intensity less than that of the background by using the conditions λ1 ≤ λ2 ≤ λ3 ≤  <dig> and λ1 ≤ λ2 ≤  <dig>  λ3 >  <dig>  the feature value e′ <dig>  which corrects the eigenvector e <dig>  is given as  <dig> e'3=e30λ1≤λ2≤0otherwise 

as with e′ <dig> and λratio, and by using the condition λ1 ≤ λ2 ≤  <dig>  e′ <dig> is prevented from having a value in voxels with an intensity less than that of the background.

white matter
during the experiment, the region containing white matter is trimmed, and νeye at the time of rendering is set as the − z direction. figure  <dig> and  shows visualization results with 1d tf presets. we are able to confirm that most of the linear structures are included within the image in the  =  direction, but linear structures in directions other than  also exist but cannot be visualized clearly. here, the focus is on linear structures in the direction  within the red circle. in the visualization of figure  <dig>  many parts of the linear structures in the red frame have become transparent. in figure  <dig>  linear structures in the  direction occlude the structures within the red frame, making it difficult to distinguish them. we attempt to selectively visualize based on the orientation of the linear structures by using e′ <dig> as the feature. because e′ <dig> represents the local orientation of the structure, it is better to use the inner product rather than the distance when calculating the dissimilarity df. the expression for df in this case is given asfigure  <dig> 
interactive visual exploration for overlapping white matter structures. visualization results obtained using  and  1d tf presets, 
x
 <dig> and Ω set by the user,  the locally refined result and  effect of the configurable parameters α and β, wherein the sensitivity and locality of the exploration can be interactively adjusted based on user objectives.

  <dig> dfx,x0=1−e'3x⋅e'3x <dig>  

the tfpreset used in figure  <dig> is used for our method, and the structure already visualized is indicated as a feature point. the x <dig> and Ω are set as shown in . the results of the interactive visual exploration with α =  <dig> and β =  <dig> are shown in . compared with the visualization results obtained with 1d tf presets  and ), the results obtained with our method ) present the existence of structures within the red frame that are easily distinguished by users

we now qualitatively examine the process of visualization by the proposed method by first discussing the validity of the calculated df. the value of the feature at x <dig> is e′3 = . the results of the visualization of all voxels having the dissimilarity of the feature with df ≤  <dig>  are shown in figure  <dig>  the structures visualized in  are those in which the angle with e′ <dig> is within 60°. figure  <dig> displays the vector e′3⊥, which is perpendicular to e′ <dig> in the xy plane, showing the visualization results of all voxels with df ≤  <dig> , and structures in which the angle with e′3⊥ is within 60° are visualized. by calculating df with the feature 60°, we find that each linear structure in a different direction can be separated. with the proposed method, the visualized area is limited by visualizing structures only within Ω after separating the visualization target structures from other structures by using df. figure  <dig> shows the shift Δ of the tf when the proposed method is tested with α =  <dig> and β =  <dig>  structures around the computer mouse cursor are visualized during the operation. users can use the visualized structures as a guide and can interactively specify these structures targeted for visualization. we see that only tfs of the target structures can be modified by using df within the visualized region Ω. furthermore, the average frames per second for visualization is  <dig>  confirming that the proposed method is interactive in practice.figure  <dig> 
three-dimensional tf shift distribution globally computed based on  the orientation of the structures,  vertically overlapping structures and  locally selected by the user.




next, we examine the effect of the sensitivity α and the radius β on the visualization results. the parameters are varied so that α =  <dig>   <dig>  and  <dig> and β =  <dig>   <dig>  and  <dig>  and the results of visualization by combining each of these values are shown in figure  <dig>  when α =  <dig>  structures are completely visualized except for the background; when α =  <dig>  linear structures in the  direction are visualized; and when α =  <dig>  the visualization results are the same before and after the operation. when the focus is on visualizing similar structures of x <dig>  a suitable parameter value for α which enables visualization of linear structures in the direction  is α =  <dig>  when α is larger than this value, it is not possible to visualize targeted structures, and when α is smaller than this value, structures outside of those targeted are visualized. next, when β =  <dig>  the visualization results before and after the operation are practically unchanged. when β =  <dig>  both the target structures and surrounding structures are visualized, and when β =  <dig>  structures corresponding to a wider range than β =  <dig> are visualized. thus, to visualize the target structures only, it is best to use the smallest β possible. however, if β is too small, the function cannot be used as a guide when specifying the target structures. conversely, although it is easy to specify target structures if β is large, it is possible that structures outside of those targeted may also be visualized.

as such, it is necessary to select suitable parameters based on user objectives and on the actual situation when attempting to obtain good visualization results. although the parameters are modulated based on a trial-and-error process, the following guidelines can be considered. because α controls sensitivity of the features that are to be visualized, large α values are first suitable to roughly visualize local structures with a variety of features, and then smaller values can be tried to strictly extract the target features. β controls the size of the direct editing pointer that defines the minimal region of interest . therefore, β can be adjusted based on the size of the target structures. larger β is useful when searching non-visualized, transparent structures existing within the volume data. after visualizing a part of the target structure, a small β is useful for fine adjustment of the visualization results.

dendrites
next, we apply this method to the area with dendric structures. the eye direction  during volume rendering is set as + z. figure  <dig> shows volume rendering results obtained with 1d tfs, which fails to visualize thin dendric structures with lower intensities. here, we focus on visual exploration of the local area a and b. figure  <dig> is visualized using previous method, in which we modify the tfs of the area based on the vesselness measure used by lathen et al.  <cit>  for the feature. linear structures of low intensity appear and run over the xy plane around the dendrites, but only some of the structures can be distinguished. because all linear structures in the data are highlighted as shown in figure  <dig>  it is hard to present the endpoints of one linear structure in a form visible to the eye. by applying the proposed method to this dendritic region, we attempt to observe structures in detail. equation  and λratio are used for the feature to highlight the linear structures. the expression used in this experiment is given:figure  <dig> 
comparison between the vessel measure based tf shift  <cit>  and the proposed interactive exploration.  1d tf preset visualization,  close-up visualization of the area a and b shifted by the vesselness measure,  the tf shift applied to the area,  interactive editing results by the proposed framework for tracing specific dendric structures with lower intensity and  the tf shift.

  <dig> dfx,x0=1σλratiox−λratiox <dig> 

where the quantity σ is the standard deviation of λratio.

the point of the linear structures is denoted as x <dig>  to apply small modifications to the visualization results, we use  = . by changing the specified region of Ω, we interactively obtain the visualization result. first, clear structures are visualized among the linear structures when the dendrites within the area b are taken as the starting point. the proposed method enables the presentation of plural structures in forms distinguishable to the eye, which are difficult to observe in semitransparency with methods developed to date. in addition, when using the vesselness measure based tf shift, many overlapping structures are displayed simultaneously. however, the proposed method allows the structures of interest to be traced easily on the rendered image. figure  <dig> shows the visualization results after interactive editing of the dendric structures. the tf shift is shown in figure  <dig>  comparing the two methods, linear structures that are largely transparent and cannot be distinguished can be visualized using the proposed method.

apical dendrites
finally, a visualization experiment targeting the apical dendritic region is performed. we applied our data to the vaa3d visualization software employing virtual finger  techniques  <cit>  and compared the visualization results. we tried the visualization functions and the tracing tool in the vaa3d software, and finally decided to focus on the two functions of mip  based direct volume rendering  and vaa3d-neuron <dig> auto-tracing for comparison with our local tf shift techniques. our visualization targets are the dendric structures possessing a lower intensity located under the blood vessels. although there are linear dendric structures that cross the blood vessels in figure  <dig>  their connectivity and distribution are not clear with the 1d preset tf.figure  <dig> 
apical dendric region represented using  tf preset visualization,  mip-based dvr,  surface reconstruction by neuron tracing,  tf shift applied to the low contrast area locally and interactively and  the improved dvr result, which clarifies the connectivity of neural structures.




figure  <dig> shows the mip-based dvr results in the vaa3d software. this rendering mode is effective for visualizing occluded vessels, and some neural structures can actually be observed in the lower intensity area. however, because of a widening in the range of opaque intensity, optical noise or unfocused surrounding structures are also visualized globally, which can decrease the contrast between the neural structures and background areas. this continues to make it difficult to clearly visualize connectivity of the neural structures. figure  <dig> shows the vaa3d-neuron <dig> auto-tracing result with an auto-thresholding mode  <cit> . neural structures are reconstructed as surface models by correcting imperfect parts in the traced areas. however, this function can yield many artifacts, especially around complex crossing structures with low-contrast intensity values. when higher threshold values are used, the artifacts can be reduced but reconstruction of the neural structures in low intensity area is not achieved. this results in a difference in the spatial density of neural structures in low-intensity areas and in other areas. we also note that the tracing result is represented using the reconstructed surface models. locally improved dvr is not achieved using only vessel tracing tools.

with the proposed method, the tf shift is applied to the low-intensity area locally and interactively. the parameters used in this experiment are  = . figure  <dig> shows the spatial relationship between the tf shift applied to a low-intensity area and other dendric structures with high intensity. figure  <dig> is the final rendering result, and the connectivity of the dendric structures can be viewed thanks to locally improved dvr images. compared with ,  and  of figure  <dig>  the visual appearance of the spatial density for vessel structures is corrected, which generates a more natural visualization result in . thus, our approach can simultaneously visualize regions that are below blood vessels without affecting regions that are not.

discussion
so far, most interaction techniques  <cit>  assume that the entire shapes of the target structures is first visualized in the screen. then, by pinpointing a 3d position on the rendered image, the user can extract a part of the 3d structure to specify his/her roi. however, microscopic images obtained from brain tissues sometimes contain a variety of neural structures with complex crossings and overlapping linear structures. in these cases, even if the 3d location is specified, the tracing task is difficult and often fails to extract a single linear structure because undesired surrounding structures are simultaneously selected. in the developed software, we can start the tracing task on the partially-visualized structure and can expand it to transparent regions with low-intensity areas where no structures are yet visualized . in addition, thanks to the multidimensional tf, the user can limit the visible structures in a robust way based upon a combination of 3d features such as direction, radius and textures . the multidimensional tf design and its combination with the direct editing interface are main contributions of this work in biological visualization. in addition, three-dimensional images with scalar intensity values measured from electron microscopes and confocal microscopes as well as ct/mri images can be applied to our software. we will further study practical application to other types of volume data

the automation of transfer function  generation is a critical issue in volume rendering. specifically, in biological volume visualization, users often focus on overlapped neural structures or internal structures occluded by other surrounding tissues. when automatic tf tuning  <cit>  is applied globally, many structures are simultaneously visualized and some of these structures occlude the target structures. in figure  <dig>  because similar structures in the data are highlighted, it is difficult to present the endpoints of one linear structure in a visually distinguishable form. applying machine learning or clustering approaches  <cit>  are interesting methods to automate tf configuration, but they require prior knowledge to learn the target structures.

knowledge exploration for newly-measured data is regarded as a user-dependent problem in many situations. the advantage of the interactive, manual tf configuration is that features of interest can be locally explored based on the user's preferences. this user-dependent localization of information visualization is an important factor to transfer the user's biological knowledge into the visualization system. also, because the developed system does not require any time-consuming setup, it can provide a practical environment for rapid visualization of the measured data. combining the interactive localization with automatic tf tuning would be interesting and has the possibility of a more intelligent interface for volume visualization, and we would like to further study this on the semi-automatic framework.

CONCLUSIONS
in this study, a method is proposed for interactive and local improvement of visualization by volume rendering in two-photon microscope images containing regions in which linear nerve structures crisscross in a complex manner. for this method, multidimensional features and interactive methods are used for selectively visualizing structures. users can specify the structures and regions of interest on the rendered image and only visualize similar structures in the regions of interest. the proposed method introduces the parameters α and β, which are freely tuned by the user. the sensitivity α determines how easy it is to change visualization results by similarity, whereas the radius β determines the size of the region of interest.

by applying the proposed method to an image of a mouse brain acquired by two-photon microscopy, we visualize white matter, dendrites, and apical dendrites in which we verify the proposed method in an experiment in the region containing white matter. the proposed method is characterized by multidimensional features and interactive methods that are effective for visualizing target structures. furthermore, we investigate the effect of parameters α and β on the results of visualization, where we find that a large β is suitable for search purposes and a smaller β is effective for small modifications of the visualization results. because the suitable values of α and β depend on the situation, the proposed method promises that visualization can be implemented with flexibility, and that the parameters can be determined by the user to suit their particular visualization requirements.

availability of supporting data
the data sets supporting the results of this article are included within the article.

megumi nakao, shintaro takemoto, tadao sugiura, kazuaki sawada, ryosuke kawakami, tomomi nemoto and tetsuya matsuda contributed equally to this work

competing interests

the authors declare that they have no competing interests.

authors’ contributions

mn carried out design of the study, the implementation of the software and a part of the experiments. st participated in the implementation of software, feature analysis and a part of the experiments. ts conceived of the study and participated in the measurement of the mouse brain data. ks carried out measurement of the mouse brain data. rk participated in development of the two-photon microscopy and evaluation of the software. tn participated in development of the two-photon microscopy and evaluation of the software. tm carried out design of the study and participated in its design and coordination. all authors read and approved the final manuscript.

