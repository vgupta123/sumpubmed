BACKGROUND
researchers interested in studying the genetic regulation of particular processes or traits must first identify the genes contributing to the phenotype, a step which can be particularly challenging in organisms for which genomic data are not yet available. differential display methods have been commonly used to compare levels of gene expression in target tissues at various stages, allowing the identification of sets of genes whose expression patterns are significantly correlated with traits of interest  <cit> .

among the available differential display methods, one increasingly popular tool is cdna-amplified fragment length polymorphism . this method allows the identification of differences in the expression of genes that are correlated to a trait of interest and has proven particularly useful in non-model organisms, as it does not require previous sequence knowledge. the cdna-aflp technique involves the digestion of cdna preparations produced from rna extractions with two restriction enzymes. to analyze the produced fragments, adaptors are ligated to each restriction fragment, which then serve as oligonucleotide-binding sites for two subsequent rounds of pcr. by adding a few , selective base pairs  to these primer sequences, the amplified fragment pool is reduced in complexity such that a suitable number of fragments can be visualized  <cit> . by comparing the presence or absence of individual fragments in individual cdna libraries after size separation, one can identify genes correlated to the trait of interest. while the use of traditional gels  is required for the recovery of fragments for further characterization, separation on fluorescent sequencers allows for high throughput and has become standard  <cit> .

a well-designed differential display experiment should aim to sample all transcripts present in a target tissue in order to avoid biasing downstream analyses. optimizing coverage  in an exhaustive cdna-aflp screen) is at the heart of designing a successful experiment. insufficient coverage of the cdna pool can prevent the detection of genes correlated to the trait of interest, even if gene expression differences underlie trait production. although complete pool coverage may often not be possible in any differential display screen, the recent literature indicates that dozens to hundreds of transcript-derived fragments  correlated to traits of interest can be obtained from the successful application of cdna-aflp screens . a variety of modified cdna-aflp protocols have been proposed to optimize pool screening  <cit> .

tdfs are the number of transcript-derived fragments produced in each screen, while pc indicates the number of primer combinations tested in each study. mean tdf indicates the average numbers of fragments generated per primer combination, while corr tdf identifies the number of transcript-derived fragments that were found to be correlated to the trait under investigation. restriction enzymes  listed in column re <dig> are characterized by recognition sites of  <dig> bp, while re <dig>  is a  <dig> bp-cutter.

the absolute number of tdfs that are screened per selective amplification is determined by several factors. an increase in the number of selective base pairs will reduce the number of fragments screened per pcr, and the choice of appropriate restriction enzymes can also systematically and substantially affect the quality of a screen, due to functional or evolutionary constraints on the triplets of amino-acid coding cdna. the total number of fragments obtained is also directly linked to the total cdna pool size, because the presence of more  cdnas provides more restriction sites, and thus a larger pool is expected to produce more fragments per pcr. it is intuitively appealing to simply maximize the number of fragments screened per pcr to minimize the workload, and in fact the first aflp studies  <cit>  suggested that up to  <dig> aflp fragments could be reliably separated. however, subsequent studies have shown that when the number of fragments visualized exceeds ~ <dig> per pcr, there is a significant risk of co-migrating fragments that can confound the reliability of an aflp screen  <cit> . the risk of co-migration is further complicated by the fact that sequences of different lengths may migrate together for a variety of reasons, including physical damage to the dna molecule, differences in base pair composition and/or methylation  <cit> . for all of these reasons, studies in which the accuracy of aflp-scoring is critical need to be particularly sensitive to the risks of high-throughput analysis.

complementary dna-aflp optimization problems can be addressed by computational  analysis. these in silico approaches are becoming increasingly feasible as genetic databases increase in taxonomic breadth, analytical tools are developed, and computational resources increase in power. as aflp searches are essentially searches for particular sequence motifs, the implementation of cdna-aflp in silico is computationally straightforward. each of these screened sequence motifs is composed of the recognition site of the restriction enzyme and three or fewer selective base pairs, such that analyses are restricted to searches for up to  <dig> ×  <dig> =  <dig> sequence motifs for a three-selective base pair experiment involving two enzymes.

the first quantitative cdna-aflp in silico studies approached this optimization problem in individual taxa, identifying several factors that can improve experimental design. kivioja et al.  suggested that the use of restriction enzymes with 6-bp restriction sites is likely to be disadvantageous in cdna-aflp studies due to the fact that such enzymes significantly reduce pool coverage. again, simply maximizing the number of fragments screened per selective pcr by using restriction enzymes that cut frequently is not necessarily optimal, as this increases the risk of obtaining size-homoplasious fragments  within each selective amplification  <cit> . there is thus a tradeoff between data quantity and quality in cdna-aflp experiments. methods have been proposed which would minimize the number of amplifications required per enzyme combination  <cit>  when the cdna pool has been previously characterized, but it is unclear whether these approaches have more widespread applicability.

these first in silico approaches to the study of cdna-aflps suffer from two significant limitations. first, these studies used cdna data from a small number of  taxa  <cit> , an approach that could restrict the wider applicability of their conclusions, as codon usage is known to vary widely across taxonomic groups  <cit> . as one of the major benefits of aflps is their ready applicability to new taxa, this may be a particularly important issue. a second potential limitation of these earlier studies stems from the fact that previous in silico analyses of cdna-aflps used refseq sequences from curated resources, which are typically biased towards larger and more complete sequences. as this quality of data is rarely available in real-world datasets, insights gained from simulations based on these data may not be relevant for typical research projects. the effects of the raw data themselves on the outcome of the in silico optimizations have not yet been unexplored.

to overcome the limitations of previous in silico studies, we use a taxonomically diverse eukaryotic dataset to investigate traditional cdna-aflp experiments sensu bachem  <cit> . briefly, cdna is digested with two restriction enzymes, from which subsets of fragments are amplified and then separated by electrophoresis. depending on the frequency of restriction enzyme cleavage, multiple fragments may be generated for each cdna. we maximize cdna pool coverage and optimize the number of tdfs produced per selective pcr using simulated cdna-aflps on a wide taxonomic sampling of  <dig> eukaryotic species representing most major groups . making use of data from two different repositories, we also investigate whether systematic differences exist between datasets obtained from different databases. after quantifying these effects, we test all  <dig> combinations of eight commonly used restriction enzymes on all  <dig> species and assess the relative performance of individual enzymes on cdna-aflp screens. by including information on the taxonomic grouping of each species, we are able to investigate whether there is significant phylogenetic signal in the data, a finding which could indicate that different cdna-aflp protocols might be necessary for particular taxonomic groups. this quantitative dataset is then used to compare and identify optimal enzyme combinations, both at the species-level and across all eukaryotes.

the cdna pool coverages obtained in these global analyses are based on the execution of all possible selective pcrs, but such extensive screens are often infeasible in the laboratory. to investigate potential differences in tdf recovery during selective pcr, we simulate all possible combinations of selective pcrs for each enzyme combination and species and extract information on the number of fragments produced per selective pcr. because the maximum number of selective amplifications is frequently limited and the selective base pairs used in amplifications are not necessarily independent of each other, we use graphical representations to identify general patterns in the performance of selective amplifications. as a comparison, we perform in silico aflp on simulated dna and cdna datasets to address whether cdna-aflp patterning in real data differs from neutral expectations.

our comprehensive in silico approach provides a realistic quantitative framework for the design of future cdna-aflp experiments. in addition to removing the guesswork from the design of such screens for non-model organisms, our in silico approach offers a powerful means for identifying general patterns in the transcriptomes of both model- and non-model species.

RESULTS
consistent results from curated datasets
ncbi and ensembl databases provided a total of  <dig> pools of cdna for this study. twenty-one species were present in both databases, providing an opportunity to investigate the potential effects of database origin on pool coverage. while the data from ncbi and ensembl differed significantly in many characteristics , the source of the data did not explain a significant proportion of the variation in cdna pool coverage after controlling for total pool size, average sequence length, gc content and the proportion of ambiguous nucleotides . duplicated species from the ncbi database were therefore removed to avoid pseudo-replication in subsequent analyses .

sources of variability in cdna pool coverage
considerable variability exists in the observed cdna pool coverage both within and across species . two major sources of variability in coverage can be identified. sequence characteristics such as average cdna length and the total pool size explain a significant proportion of the variation in the pool coverage. of these technical effects, average sequence length explains 38% of the variation in cdna pool coverage. less important is the effect of total pool size , while the effect of ambiguous bases on pool coverage is non-significant .

variance partitioning addressing the contribution of enzyme combination  on pool coverage for  <dig> eukaryotic species . species was included as a random factor in a mixed model analysis which aimed to determine the influence of individual factors or interactions . cdna pool coverage was weighted by the number of sequences per species to account for variation in available sequence data. the numerator and denominator  degrees of freedom  are provided. f statistics  and the significance  of the overall model, factors and interactions are reported. the proportion of the variation in cdna pool coverage which is explained by each factor/interaction is indicated as partial r-square values  <cit> .

a larger portion of the variation in coverage can be explained by biological factors , of which the combination of restriction enzymes is most important, explaining  <dig> % of the observed variation in coverage. the gc content of the target species explains  <dig> % of cdna pool coverage, and a significant two-way interaction exists between enzyme combination and the gc content of the pool, explaining  <dig> % of the variation in coverage. this significant interaction term indicates that optimal enzyme combinations differ among species  and suggests that gc content should be considered when choosing optimal restriction enzymes for a cdna-aflp screen. taken together, our mixed model explains 78% of variation in cdna pool coverage .

the choice of the most appropriate restriction enzymes substantially increases the coverage of a given cdna pool from less than 40% to more than 75% . the effects of restriction enzymes are essentially additive , indicating that the performance of individual restriction enzymes is not strongly influenced by the second enzyme used in the double digest.

descriptive statistics on the average cdna pool coverage obtained for each enzyme combination across all  <dig> species , sorted by decreasing mean coverage. the average coverage by enzyme combination and standard deviation  are indicated, as are the minimum and maximum cdna pool coverages for individual enzyme combinations . r-square indicates the correlation coefficient for the relationship of total cdna pool size  and the average number of fragments produced per selective pcr . the linear regression equation for this relationship is indicated.

source
the effects of individual restriction enzymes on cdna-pool coverage, based on all  <dig> species . the percentage of total cdna pool coverage explained by each enzyme has been estimated. the degrees of freedom  of each factor included in the model  are indicated. enzymes are sorted by decreasing coverage, and restriction sites of each restriction enzyme are listed. details on the significance of each factor  in this analysis and corresponding f-statistics are given .

effects of evolutionary history on cdna-pool coverage
analyzing sequence data from a group of organisms with an evolutionary history as old and diverse as that of eukaryotes allows the quantification of the effects of taxonomic substructure on cdna pool coverage.  <dig> of the  <dig> study species could be assigned to eight major taxonomic groups  with at least three members per group. this additional predictor  improves the fit of our model by  <dig> % . taxonomic grouping itself explains  <dig> % of the variation in pool coverage. once again, the choice of enzyme combination explains the highest proportion of coverage in this model , and the influence of technical effects is less significant. of these sequence characteristics, the average sequence length has again the strongest influence and explains  <dig> % of the variation in cdna pool coverage, while the total pool size accounts for only  <dig> % and the proportion of ambiguous nucleotides does not significantly affect coverage. there is a strong interaction between taxonomic group and enzyme combination  indicating that the optimal enzyme combination varies across groups . this difference is mediated in large part by differences in gc content among the taxa included here .

variance partitioning addressing the influence of enzyme combination  and taxonomic grouping on pool coverage for  <dig> species . species was included as a random factor and cdna pool coverage was weighted by the number of sequences per species to account for variation in available sequence data. denominator degrees of freedom were kenward-roger corrected. partial r-square indicates the proportion of the variation in cdna pool coverage which is explained by each factor/interaction  <cit> .

a positive relationship between cdna-aflp fragment number and pool size
we were interested to see whether a relationship exists between the average number of fragments produced per selective pcr and any of the additional information we collected for each cdna pool. we found a strong positive correlation between the average fragment number per selective pcr and the size of the cdna pool in base pairs . with an r <dig> of  <dig>  -  <dig> , the average fragment counts generated per pcr provide a reasonable estimate of the size of the underlying cdna pool.

cdna length averaged  <dig> ±  <dig> bp across the pools included in the present study , similar to the recently published estimate of  <dig> bp derived from gene predictions in the eukaryotic genome  <cit> . using these estimates, it is possible to convert the estimated total pool sizes in base pairs into absolute numbers of cdnas. the linear relationship between total cdna pool size and average fragment number per selective pcr can help minimize the possibility of collisions when optimizing cdna-aflp experimental design. in case of a selective pcr regime which employs a two-by-three selective base pair design, the threshold of  <dig> fragments per pcr reaction to minimize the chance of collisions will rarely be reached in tissues with fewer than  <dig> sequences, assuming an average cdna length of  <dig> bp. however, the frequently used two-by-two selective base pair design will yield more than  <dig> fragments per selective pcr in a pool of only  <dig> cdnas and nearly  <dig> fragments in a pool of  <dig> cdnas , suggesting that a two-by-two selective base pair design is likely to introduce a significant source of error via collisions in a typical cdna screen  <cit> .

non-random patterning in cdna-aflp arrays
selective pcrs generally use up to three selective base pairs, and hence a maximum of  <dig> ×  <dig> =  <dig> different selective amplifications are theoretically possible when using two restriction enzymes. according to neutral expectations, each of these selective primer combinations would be expected to produce on average a similar number of fragments. we used array plotting to visualize the relative fragment numbers produced by each potential selective pcr in the typical three-by-three selective base pair design and found considerable structure in empirical data that is not found in simulated cdna and genomic dna pools . such structure is observable for all enzyme combinations . as is apparent from figure  <dig>  restriction-enzyme specific patterning for individual enzymes is highly conserved even when enzymes are used in different combinations, suggesting that the difference between the fragment numbers per selective pcr is largely the result of the individual restriction enzymes . particular selective pcrs fail to generate any products and are thus entirely uninformative in cdna-aflp screens. in these cases, one or both restriction enzymes cut closely together, producing aflp products too small to be visualized in the screen . this restriction-enzyme patterning is consistent even in distantly related taxa , indicating the strong signal of evolutionary history in the underlying datasets.

discussion
complementary dna-aflps are an increasingly popular tool to study differential gene expression, particularly in non-model organisms for which genome data are unavailable . the main benefits of the cdna-aflp approach are the relative ease of its implementation and its low per-marker costs  <cit> . in addition to the traditional use of cdna-aflps to identify dominant  markers correlating to traits of interest, recent methods have shown that cdna-aflps can also provide quantitative data  <cit> . regardless of the goals of a cdna-aflp experiment, a successful screen requires high coverage of the underlying cdna pool. while significant advances have been made in technical aspects of the aflp methodology, theoretical studies investigating methods for optimizing the cdna-aflp screens remain relatively rare, and large scale empirical data - as provided here for eukaryotes - have not yet been used for this purpose  <cit> .

recent years have seen an explosion in cdna datasets. ensembl and ncbi are two of the most important repositories for cdna data, and the taxonomic coverage and quality of data in these archives will continue to grow with the development of next-generation sequencing technologies. given the vast amount of available data - in the present study a total of more than  <dig>  million sequences and  <dig>  gbp of cdna were screened - in silico studies offer the potential to address novel research questions and to optimize experimental protocols before undertaking large experimental studies. the cdna pools included in the present study cover most major extant eukaryotic groups, providing an opportunity to identify broadly applicable conclusions on the most important factors affecting the quality of cdna-aflp screens. these cdna pools range from a few hundred to more than  <dig>  sequences , covering the range of experiments likely to be undertaken in both model- and non-model organisms.

using previously published and pre-filtered data has the potential to introduce technical artifacts into in silico analyses. the database origin of cdna pools does not affect our coverage optimization after controlling for differences in sequence length, total pool size, gc content and the proportion of ambiguous nucleotides . when comparing data derived from different databases, non-acgt content was found to explain a significant component of pool coverage . this result is due to an abnormally high proportion of ambiguous nucleotides in the gasterosteus aculateus cdna pool obtained from the ncbi repository . this effect of non-acgt nucleotides on coverage disappears when this species is removed from the analysis .

cdna pool coverage in the complete dataset of  <dig> species  is significantly affected by both total pool size and average sequence length, which explain 14% and 38% percent of coverage, respectively . because the cdna-aflp method requires the presence of at least two restriction sites in proximity to screen each transcript, cdna sequence length can have a large effect, and a significant reduction in coverage is expected when using short cdna sequences. while the quality of the cdna preparation can influence cdna length, differences in cdna length between species may also reflect biological reality. species included in our study differ substantially in average cdna sequence length . this difference is most pronounced between plants , which have an average cdna length of approximately  <dig> bp, and mammals, which have an average cdna sequence length of  <dig> bp . this difference, though more modest, is also evident in the results of recent full-length cdna sequencing projects. an average cdna length of ~ <dig>  kb has been reported in plants , whereas mammals have on average longer full length cdnas of ~ <dig>  kb . while these studies indicate cdna length may vary among taxonomic groups, the biological implications and evolutionary consequences of this variation remain unclear.

technical issues have an important effect on the outcome of cdna-aflp experiments, but the restriction enzymes employed explain the majority of the variation in pool coverage . here, three factors are relevant. first, the use of restriction enzymes with 6-bp recognition sites is not recommended for cdna pools , as it greatly reduces the number of fragments generated per pcr reaction. second, among the restriction enzymes tested here, some are far better suited for cdna-aflps than are others. estimates of the effects of individual enzymes on coverage  or their combined effect  clearly indicate that the efficiency of the pool coverage can be nearly doubled by choosing the optimal enzyme combination. of the restriction enzymes included here, cviaii, msei and cviqi outperform the other enzymes and are as such good candidates for cdna-aflp screens in eukaryotes . finally, several basic rules should be kept in mind when choosing restriction enzymes. a strong interaction between optimal restriction enzymes and organismal gc content is apparent in all analyses . clearly, restriction enzymes with gc-rich recognition sites are likely to cut more frequently in gc rich genomes than in those with reduced gc content. similarly, the use of restriction enzymes with recognition sites frequently found in cdnas could likewise aid in obtaining in-depth pool coverage. as most previous studies have used a six-cutter restriction enzyme together with a four-cutter and have focused on a small number of primer combinations , the number of genes correlated to traits of interest has likely been frequently underestimated.

complementary dna-aflps have been applied to a wide range of eukaryotic taxa, and the ease of implementing this method in new systems is one of its particular strengths. while previous studies proposed suitable enzyme combinations for species for which sequence data are already available  <cit> , the restricted taxonomic focus of these earlier studies limited the applicability of inferences across a wider array of organisms. as can be seen from table  <dig>  significant effects of taxonomic grouping exist, and a strong interaction between the taxonomic grouping and the gc content is apparent . while this indicates that the optimal choice of restriction enzymes differs among taxonomic groups, it also indicates that a large portion of this difference in optimal enzyme choice can be explained by organismal gc content . by considering gc content prior to undertaking a cdna-aflp experiment, researchers should be able to optimize the quality of their screens.

our in silico experiment revealed that cdna-aflp performance differs markedly from neutral expectations  and that the observed patterning is highly consistent across taxa . clearly, cdna pool coverage could be even further enhanced through a more explicit incorporation of the results presented here. by selecting only the best performing selective base pair combinations for several independent enzyme pairs, one should be able to maximize pool coverage in a reasonably-sized cdna-aflp experiment. we refer the reader to additional file 5: "arrays of all selective pcrs for all species and enzyme combinations", which provides complete cdna-aflp arrays for all species investigated here. figure  <dig> indicates that most of this patterning results from the effects of the individual restriction enzymes. this is especially apparent for areas of uninformative selective primer combinations in which particular primer-enzyme combinations fail to generate any cdna-aflp products at all. this pattern is a result of the aflp methodology, where restriction enzymes are used to digest double-stranded dna and adaptors are ligated directly to the digested cdna ends. during selective amplifications, the selective base pairs of each primer extend directly 3' from the recognition site. as a consequence, an aflp screen using four-cutter enzymes and three selective base pairs is equivalent to a motif search for dna stretches of 7-bp length. when restriction enzymes overlap in one or more base pairs, this motif may contain multiple restriction enzyme recognition sites, producing cdna fragments shorter than the  <dig> bp required for visualization. these classes of selective pcrs will thus not produce any fragments of mixed type. the selective amplification of hinp1i-generated fragments with the selective base pairs gcn is one such example . when a given dna sequence contains the motif gcgcgcn, hinp1i will cleave the sequence at two positions . due to this double digest, the use of hinp1i will fail to generate any aflp fragments containing the gcgcgcn motif. even when this overlap in recognition sites is only partial, the number of fragments generated by a particular pair of selective primers can be reduced, which might explain a portion of the observed patterning. however, the absence of patterning in the simulated data relative to homo sapiens  suggests that technical aspects of the cdna-aflp method are insufficient to explain the higher level of complexity found in real data. as this structure is remarkably consistent across taxa , factors highly conserved across evolution  must contribute to this pattern.

during aflp screens, selective pcrs are used to reduce the complexity of produced fragment pools. the average number of fragments produced during each selective pcr is positively correlated with the size of the cdna pool . for the restriction enzyme combinations investigated here, the average number of fragments obtained from selective pcrs can be converted into an estimate of the - typically unknown - size of the underlying cdna pool. this novel versatility of the aflp methodology - estimating cdna pool size - should be particularly useful for any study in which knowledge of the underlying transcriptome size is critical. this is especially the case when performing large scale sequencing of the transcriptome, where a preliminary cdna-aflp screen may offer a cost-effective means to estimate the number of genes expressed in a tissue of interest.

the linear relationship between average fragment number and total cdna pool size can also provide guidance when deciding on how many selective base pairs to use. from figure  <dig> it is apparent that a two-by-two selective base pair design will often result in fragment numbers that far exceed that optimal for reliable fragment separation  or to avoid significant homoplasy . a three-by-three selective base pair design is, however, too conservative, in that too few fragments will be screened per pcr reaction . using a two-by-three selective base pair design appears to be the best option for most cdna screens, producing 10- <dig> fragments per amplification  in cdna pools of up to  <dig> sequences or  <dig> mbp, pool sizes expected in vitro in typical mammalian tissues  <cit> .

CONCLUSIONS
optimizing the quality of cdna-aflp screens
our in silico approach to cdna-aflp optimization suggests several key improvements to existing methods of cdna-aflp experiments and highlights restriction enzymes likely to be particularly well suited for screening eukaryotes . matching the gc content of the restriction enzymes with that of the target cdna is a relatively simple step to optimize experimental design. consideration of the restriction enzyme recognition sites is particularly important, especially when resources limit the number of selective pcrs that can be performed. following these recommendations will significantly improve the efficiency of future cdna-aflp experiments.

a new application of the cdna-aflp methodology
in addition to our methodological suggestions, the comparative approach taken here identified a positive linear relationship between the average fragment numbers per selective pcr and the size of the underlying cdna pool. this provides a novel method to estimate the number of transcripts present in a cdna pool via a simple series of cdna-aflp screens, an application which will be invaluable as next generation sequencing technologies are adapted for differential display.

