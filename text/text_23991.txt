BACKGROUND
eukaryotic genomes have many genes that fall within well-defined gene or super-gene families  <cit> . both orthologuous and paraloguous genes within the same gene family may vary in functions at levels from subtle changes in regulation or catalytic efficiency to substantial evolution of new function. while functional divergence within a protein family is usually determined by changes in a few amino acid residues or domains. identification of these has traditionally required considerable experimental effort. developing computational tools for predicting these crucial residues or regions has become important in the field of current functional genomics. many methods have been proposed, such as ancestral sequence inference  <cit> , positive selection  <cit> , and site-specific rate shifts  <cit> . the new software splittester reported here is focused on a special type of functional divergence that functionally associated amino acids do not have the same evolutionary relationship as the protein family. the software is designed to identify domains responsible for functional divergence by iteratively comparing split cluster to the functional classification. identified inconsistence between the functional divergence and the phylogenetic relationship may provide valuable information for gene function prediction.

for illustration, we applied splittester to the reverse transcriptase family from a group of retrotransposons, pseudoviridae. there are two subgroups of reverse transcriptase, according to the primer utilizations at the initial step of reverse transcription process. one subgroup binds full length trna molecule and another one binds trna fragment respectively as primer to initiate cdna synthesis . such difference in primer specificity can not be reflected from the inferred phylogenetic relationship of this protein family, that is, they are not monophyletic because of the parallel evolution for functional-related changes during the expansion of this protein family  <cit> . thus, one may design a tree-based  algorithm that can define domains relevant to diverged function in a protein family with known functional subtypes. the software splittester we developed is to look for the local sequence alignments that display the clustering topology in agreement to a known functional split, using the evolutionary relationship of the gene family as the reference, which can be reconstructed by the conventional methods.

implementation
the algorithm implemented in the software splittester begins with a multiple sequence alignment of a protein family with known functional diversity , defined here as a 'functional split'. usually, a functional split is based on a few but unknown diagnostic amino acid residues or regions that are expected to be in accordance with the functional split. if the functional subgroups are not consistent with the phylogenetic tree of the gene family, we may, in retrospect, identify the sequence region that may include amino acid residues crucial for the sought-after function, if the clustering analysis of this region shows the expected functional grouping. in the following we call this idea the split-clustering for simplicity.

we have developed a software package called splittester . the input file is the protein sequence alignments, as generated by some conventional methods   <cit> . the users should predefine the functional subtypes, usually based on functional differences of proteins that have been verified by the experimentation. in the current version, the partitioning of sequences is limited to two groups. in the case of multiple functional subtypes, one may start with crude partitions and progressively refining pairs of groups, or by comparing two groups pairwisely. the program uses the neighbor-joining  method for phylogeny inference or split-clustering  <cit> . the user can select one of several amino acid substitution distance matrices, including the mutation distance matrix, the hydrophobic distance matrix, pam10- <dig> and blosum 30– <dig>  <cit> . then, the split-clustering algorithm implemented in splittester will generate tree-like topologies for each sliding windows along the aligned sequences. the procedure is iterative and starts with very small windows , which slide along the length of the alignment. window size gradually increases until it reaches the full length of the aligned proteins. all the examined windows are displayed in an plot as part of the output interface. the horizontal axis shows the position of sliding windows in the protein alignment and the vertical axis indicates the length of sliding windows. the tree-topology generated by the split-clustering from each window is compared to the predefined functional split. if it matches, this window is marked as a line on the output plot at the corresponding position and length.

the distance method  implemented in most phylogenetic software normally uses the greedy algorithm for efficiency and simplicity, but only tracks a single locally best tree. consequently, ignoring the alternative solutions can be misleading for phylogeny inference particularly when the sequence length is short  <cit> . to improve the reliability of distance method, there are some efforts to track multiple partial solutions as it progresses  <cit> . since split-clustering usually deals with the short sequence length, we modified the conventional algorithm by tracking all possible topologies equally best fitting the data. that is, at each step, the split-clustering searches for the minimal distance pair, creating a list of pairs with equally minimal distance, and then performs the neighbor joining on each pair in order following a depth-first search. only the resulted unique topology trees are saved for subsequent analyses. in the following we call them nj-equivalent tree topologies if it is inferred by the nj algorithm.

if the split-clustering analysis for a given window yields at least one  tree whose topology matches the predefined functional split, we consider the window containing a potential functional signal. in the case of multiple nj-equivalent trees, as explained above, the strength of the functional signal, or the degree of confidence, is measured by the percentage of nj-equivalent trees that support the functional split. we used different colors to indicate the signal strength of the window: red means that all  these trees derived from this window split the genes according to the specified function; yellow, green and blue indicate that 75%, 50% and 25% of the trees match the functional split, respectively. a color gradient is used to represent degrees of confidence between the above intervals.

in the output plot, all the lines representing the candidate windows can be selected to display the sequences within this window and the corresponding phylogenetic trees in two separate panels. the panels are updated in real time with the progress of each window tested. while in theory our algorithm could be quite time consuming to run because of the potentially large number of individual nj operations , in practice the calculation is very reasonable, because the sequence length is typically small. our dataset  required approximately six minutes for analysis of all possible windows using a pentium  <dig> ~  <dig> mhz processor with 512mb ram and the microsoft windows  <dig> operating system. in practice, most domains will be identified when window sizes are smaller than  <dig> amino acids. therefore, 2– <dig> minutes of running time is expected to be sufficient for most computers.

splittester is available as precompiled binary in a distribution package for microsoft windows from the following url: , and . both a zip file of the installation files and a self-extracting installer are available. documentation and example files are included in the distribution packages.

RESULTS
we applied splittester to understand functional diversity among retroelement proteins for primer utilization by retroelement reverse transcriptases. reverse transcriptases of retroviruses , metaviruses  as well as retrotransposons in the genus pseudovirus  use the 3' acceptor stem of the host trna as a primer for dna synthesis. this region pairs with the retroelement rna template to start dna synthesis from 3'-oh of the trna. retrotransposons of the genus hemiviruses  use a half-trna primer, and cdna synthesis initiates from 3'-oh of nucleotide  <dig>  which resides within the anticodon stem-loop. it is likely that the primer template complexes for the two groups of elements have different structural conformations or properties, and that reverse transcriptases from the different groups have evolved the ability to recognize these differences. the split-clustering implemented by splittester could explore candidate domains of reverse transcriptase related to primer selection. these identified candidates provide testable hypotheses that could be verified or falsified by the follow-up molecular genetic experimentation.

we focused on members of the pseudoviridae, which include both half-trna priming elements , osser ,  <dig>  and copia ) and elements that use full length trnas , opie- <dig> , tnt <dig>  and sire- <dig> )  <cit> . the nj phylogenetic tree from full length sequence alignment did not reflect the divergence of the two functional subtypes   <cit> . for example, osser and tnt <dig> are the only two members of one cluster and the bootstrap value is  <dig>  the genes seem to be clustered according to their hosts, e.g.,  <dig> and copia from drosophila, ty <dig> and ty <dig> from saccharomyces cerevisiae, as well as osser, tnt <dig>  sire- <dig> and opie- <dig> from plants.

two signal regions were identified by splittester when the mutation distance matrix was used to compute the cost of amino acid substitution and when gaps were considered as potentially informative characters. in the aligned amino acid sequence, the maximum windows showing functional split in each non-overlapping region cover positions 144– <dig>  and 269– <dig>  . using the hydrophobicity matrix, splittester also identified these regions, as well as an extra region at the n-terminus . each of signal regions above is derived from the multiple overlapping signal windows with gradually increased window length. we chose  <dig> aa window  in region  <dig> and  <dig> aa window  in region  <dig>  both windows are close to the median window length with demonstrating high bootstrapping values . in general, one may use the median sized window for representing, because small windows are statistically unstable while a too broad window will demolish the functional signal of the window.

we located the two windows identified by both matrices within the hiv reverse transcriptase sequence, based on the published protein sequence alignments of the reverse transcriptase family by xiong and eickbush  <cit> , and mapped onto the crystal structure 1rtd  <cit>  . hiv reverse transcriptase p <dig> has a 'right hand' structure. the  <dig> aa window  in region  <dig> from the alignment correspond to the "palm" of the protein  that encompasses the polymerase active site wherein nucleotides are added to the 3' end of the primer. the  <dig> aa window  in region  <dig> corresponds to one α-helix in the 'thumb' region of hiv reverse transcriptase , which directly contact the primer/template complex, as determined by cross-linking experiments  <cit> .

the region of β-sheets between the two identified domains  is called the primer grip and cross-links to the 3'-oh group of the hiv primer, trnalys  <cit> . we would speculate that primer grip is related to the primer binding. however, this region is not identified as determinant of primer specificity, indicating that the ability of the primer grip to interact with the 3'-oh of the primer will be a common feature of both full-and half-trna priming retroelements. the two regions identified by splittester surrounding the primer grip may play a role in distinguishing primer conformation or length. the results of splittester, therefore, can be well explained from the reverse transcriptase crystal structure and supported by experimental data. to further validate our findings, we randomly partitioned the gene members into two groups and reran the program. the candidate functional regions were not identified using any of the partitions . we therefore conclude that the identified residues may separate the functional subtypes specifically.

the strength of functional signal vs. the evolutionary background on the multiple windows of different length  in the signal region  <dig> can be well illustrated by the bootstrapping values . the right splitting of the two functional groups in this region , as predicted by splittester, showing a  maxima at the window length of  <dig> residues. interestingly, when the window size is greater than  <dig>  the topology by the split-clustering is a random mixture between functional split and evolutionary background; the bootstrapping value is for the deepest two subtrees. rather, with the increase of the window length toward the window of full length sequence, the topology converges to the evolutionary tree as shown in fig. 4a. therefore, the region identified by splittester is intuitively valid even though although the bootstrapping  value is not very high. we also observed the very similar pattern for region 2; the highest bootstrap value in window with size of  <dig> aa around the median length within the range of  <dig> to  <dig> 

because the splittester employs a heuristic algorithm to decipher weak functional signal from the high level of evolutionary background, its power would be limited by several factors. if there are only a few amino acid residues related to a given functional split, or these residues are located in a broad sequence region, the statistical power for detection is low, as we expected. one improvement for splittester is to divide the proteins into several small regions, for instance, based on the protein structure, or motifs. then one can implement some algorithms to integrate weak signals from these non-overlapping small regions, which otherwise are indistinguishable from the background.

there are several other factors that may affect the performance of splittester. the first one is the choice of substitution matrices of proteins. we have provided several options for the matrices. the user can select one of them based on their purpose. in general, blusom matrices reflect the overall evolution history and hydrophobicity matrix can reflect more on chemistry properties of amino acids. second, the inference power of this method might increase with the difference between the functional splitting and phylogenetic tree because the signals are more likely being distinguished from the background. thus, increasing the sample size, for instance, sequencing more genes from different species is certainly helpful. nevertheless, the example of reverse transcriptases we presented here has indicated that one may obtain valuable functional information even the difference between functional splitting and phylogenetic tree is weak as indicated by the bootstrap value.

there have been many methods developed to analyze sequences involved in functional divergence between protein subtypes . most of them are focused on identifying specific residues contributing to the functional differences of subtypes along the phylogeny. hence, the prediction accuracy may rely on the quality of multi-alignments, the accuracy of phylogenetic inference, or the sufficient number of sequences. since the splittester focus on a particular sequence region that supports the subtype functional split, the predicted results seem not to be strongly affected if a few positions are misaligned. we validated this claim by deleting the position  <dig> in the multiple sequence alignment, which contain conserved f in pseudovirus subfamily and a, v, e, t in each gene of hemevirus subfamily respectively. this position was selected because it can be easily identified manually as one of three "seeds" of the growing signal region . fortunately, splittester still identified the almost identical region  <dig> as before only in overlapped shorter windows  and  . similar results were obtained when we deleted each of other two "seeds" at position  <dig>  and  <dig> .

CONCLUSIONS
splittester can explore regions potentially responsible for functional divergence of proteins. the best scope of this software is to study the dataset with different functional clustering and phylogenetic tree. as shown by the case of reverse transcriptase, function-related signals may emerge when the functional split is inconsistent with the phylogenetic relationship of the protein family. even if the functional clustering is consistent with its phylogeny, splittester may also provide some useful information for amino acid residues important for functional divergence, e.g., the conserved myb gene family. in spite that the phylogeny is the same as the known functional split of myb genes, splittester still successfully identified  <dig> candidate residues that differentiate the two-and three-repeat myb proteins, the major functional split of myb gene family  <cit> , because the sequence window including these residues shows a stronger functional signal. indeed, these identified candidate residues are well supported by their locations on the nmr structure of the mouse c-myb dna binding domain 1msf  <cit> . moreover, these residues are called by type-ii functional divergence by  <cit> , which can also be predicted by the "evolution trace" method  <cit> . see additional files  <dig> and  <dig> for the detail. finally, we mention that, after combining splittester with other complementary methods, such as the method of  <cit> , "evolution trace" method  <cit> , "phylogenetic inference" by sjolander  <cit> , diverge  <cit> , we can develop a powerful analysis pipeline for predicting functional divergence from sequence domains to amino acid residues.

in summary, we developed splittester – a tool for exploring the functional domains in protein family. splittester focus on a specific type of functional divergence: the functional split is different from the evolutionary relationship. using the split-clustering algorithm, splittester scans all the possible local regions of protein sequence alignment to identify the domain that provide the same clustering topology as the functional split. in the analysis of retroelements reverse transcriptase family, we identified the regions splitting this family according to the primer specificity, implying function in the primer selection. the functional role can be well explained after we map the identified domain onto the structure of the reverse transcriptase protein.

availability and requirements
• project name: splittester

• project home page:



• operating system: windows  <dig> and xp

• programming language: c

authors' contributions
xgao designed this project, analyzed the results and prepared the manuscript. kvv implemented the software. xgu and dfv supervised the project and helped to prepare the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
display the result of identified residues in myb protein.

click here for file

 additional file 2
descript the detail of myb protein family and the predicted key residues for functional divergence from splittester.

click here for file

 acknowledgements
we thank dr. les miller for helpful discussions. this work was supported by nih grants gm <dig> to d.f.v, and gm <dig> to x.gu.
