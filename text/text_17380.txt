BACKGROUND
the topology of interactions in a biological network is often studied by modeling the network as a graph, which allows the use of established algorithms and metrics such as shortest path analysis
 <cit>  and betweenness centrality
 <cit> . graph theoretical models have yielded useful insights into not only the global topology of biological networks, but also local interactions that form distinct substructures, frequently referred to as modules
 <cit> . indeed, there is growing consensus that many types of biological networks possess modular character. hierarchically arranged modules have been identified in metabolic networks, where larger, more heterogeneous subnetworks comprise smaller, more cohesive subnetworks
 <cit> . hierarchical modularity has also been observed for gene interaction networks
 <cit>  and protein interaction networks
 <cit> .

despite the important insights obtained from topological analysis, almost all of the graph-based studies to date have examined a biological network under a single static condition
 <cit> . for instance, potapov and coworkers note that shortest path analysis, applied to a static network, may offer limited information because the length of an edge in the graph model may not correlate well with the overall efficiency of a particular biochemical transformation represented by the edge
 <cit> . there is increasing evidence that biological network organization is dynamic and state dependent, which cannot be adequately studied from a static point of view. as a result, there has been growing interest in augmenting the topological information of biological networks for graph-based analysis with observed activity data. recently, tang and coworkers used gene expression data to construct time-course protein interaction networks, and found that functional modules detected in the time-course networks more closely matched known regulatory complexes than those detected in the static networks
 <cit> . in another example, greenblum and coworkers constructed a metagenomic network of the human gut microbiome using gene expression data, and showed that state-specific networks representing lean or obese individuals exhibited different topological properties, including modularity
 <cit> . similarly, taylor and coworkers found that dynamic changes in the organization of the protein-protein interaction network, rather than expression levels of individual proteins, correlated strongly with breast cancer prognosis
 <cit> . interestingly, mutations in hub proteins connecting different modules were found to be more frequently associated with cancer phenotypes than mutations in hub proteins that are highly connected with other proteins in the same modules, suggesting that alterations in global modularity may occur in cancer.

in the case of a metabolic reaction network, gene or even protein expression data may not best capture the interactions between the network’s components, as mrna levels or enzyme concentrations do not necessarily correlate with reaction rate or metabolite turnover. a more comprehensive snapshot of the physiological state may be provided by a metabolic network’s reaction flux distribution, which directly reflects the relative engagements of enzymes, integrating the various layers of regulatory processes active in the cell. intuitively, the flux of a reaction can be used to weight the interaction mediated by the reaction. for example, yoon and coworkers applied flux-based weights to adjust the edge distances in a graph model of murine adipocyte metabolism, and thereby reflect metabolic state-dependent variations in the interactions between metabolite pools
 <cit> . while intuitive, this weighting scheme assumes that the metabolic network is modeled as a metabolite centric graph, where the edges represent reactions. for the purpose of studying the interactions between enzymes, it is often useful to model the metabolic network as a reaction centric graph, where the nodes represent enzymes and edges represent interactions between the enzymes mediated by metabolite substrates and effectors
 <cit> . the benefit of a reaction-centric graph, particularly in the context of modularity analysis, is that a metabolite is not constrained to a module. instead, a metabolite is more appropriately modeled as a shared resource, and reactions define the functional identity of a module. to our knowledge, a scheme to weight the edges of a reaction-centric graph has not yet been described in the literature. the purpose of this study was therefore to develop a generally applicable method for incorporating activity data such as metabolic flux into modularity analysis using graph models where the nodes, rather than the edges, represent the network’s functional components.

recently, we defined a new metric, termed shortest retroactive distance , to capture feedback and other cyclical interactions in a metabolic network
 <cit> . based on the earlier work of saez-rodriguez and coworkers on retroactivity
 <cit> , shred was used to solve for modular partitions that would minimize cyclical interactions between modules while maximizing such interactions within a module. while the earlier work on retroactivity focused on nearest neighbor interactions, for example mediated by the product of a reversible reaction, the shred-based analysis also considered interactions between distant parts of a network. in the present study, we further expand the use of shred as a modularity analysis metric by developing a weighting scheme to reflect phenotypic state-dependent variations in reaction-to-reaction interactions. we focus on flux data due to the integral nature of the information content in such data, reflecting the functional outcomes of transcriptional, translational, and post-translational mechanisms of enzyme activity regulation. flux data can be obtained using a number of different methods, including isotopic  labeling, metabolic flux analysis , and flux balance analysis , generally, mathematical model-based analysis of isotopic enrichment of multiple metabolite pools offers the greatest resolution. flux balance analysis is a constrained optimization based approach typically used to estimate fluxes in conjunction with a metabolic objective function. the problem is usually severely underdetermined in fba. in the present study, we used a constrained optimization based approach to estimate metabolic fluxes, but without assuming a metabolic objective. rather, we minimized the sum of squared differences between the measured and estimated exchange fluxes, as the problems were well constrained. applied to a model of adipocyte metabolism, shred-based modules obtained using flux weights more consistently reflected recognizable functions of established pathways compared to the modules obtained without the weights. comparisons of modules obtained using several different flux sets representing distinct metabolic states identified robust reaction pairs that repeatedly partitioned into the same module across many levels of modular hierarchy, suggesting possible co-regulation.

RESULTS
effects of weighting edges on shred distribution
weighting the edges that define the interactions between the reaction nodes substantially impacted the overall distribution of shreds. in the un-weighted case, when all edges have the same unit distance, the shreds are close to normally distributed, with a skewness of − <dig>  . in the weighted cases, the distributions clearly skew to the right. for example, the skewness of the day  <dig> model is  <dig>  . this difference in shred distribution between the weighted and un-weighted cases motivated an adjustment from our earlier modularity metric. in our previous work, the entries for the modularity matrix were computed as the difference between the expected and actual shred of two reaction nodes, where the expected shred was calculated as the arithmetic average of all shreds involving either one of the two reaction nodes
 <cit> . this calculation assumed that the overall shred distribution is close to normal, and that the arithmetic average reasonably represents the expected shred between two nodes. with the incorporation of reaction flux-based weights, many reaction-to-reaction interactions were orders of magnitude weaker  than the average interaction, for example, due to the involvement of amino acid reactions whose fluxes were negligible compared to those of glucose and lipid metabolism. therefore, in this study we introduce a modified modularity matrix v, which ranks the shred between two reaction nodes relative to the distribution of all shreds involving either one of the two reaction nodes.

there is a positive correlation  between the un-weighted shred and the corresponding weighted shred. the correlation analysis was performed on reaction pairs with shred <  <dig>  since the maximal shred value was capped at  <dig> . the positive correlation suggests that the topology of the metabolic network as defined by the stoichiometry has some influence on the closeness of cyclical interactions between enzymes as defined by the fluxes of the reactions connecting the enzymes . however, the correlation is not very strong, as there are many instances where a relatively short un-weighted shred corresponds to a relatively long weighted shred , and a long un-weighted shred corresponds to a short weighted shred .

effects of edge-weighting on shred-based network partition
the shred-based hierarchical partition of modules for the un-weighted adipocyte model is compared to the partition for the flux-weighted day  <dig> model . there are striking similarities between the two partitions. in both cases, the transport reactions and a few amino acid metabolism reactions peel off from the original network after the first partition. additionally, several key interactions between reactions are conserved. the partitions point to close interactions between carbohydrate metabolism, lipid metabolism, and citrate-malate cycle for both the un-weighted case  and the flux-weighted case . similarly, there is tight coupling between triglyceride synthesis and degradation that persists through multiple partition levels for both cases .
 <dig> 

however, there are also several qualitative differences between the two partitions. the un-weighted partition broadly distributes tca cycle and amino acid reactions across various branches in the hierarchical partition tree . however, in the flux-weighted case, the a priori assigned textbook associations largely remain intact . quantitatively, the flux-weighted partition has a greater average homogeneity index between heights 1– <dig> in the hierarchy , where height zero corresponds to terminal nodes. at height zero, the average homogeneity is similarly high for both the weighted and un-weighted cases due to the large number of single reaction modules.

comparing dynamic vs. static weighting schemes
in the absence of flux data, topological data other than cyclical connectivity could be used to guide modularity analysis. metabolite degrees
 <cit>  were investigated as an example of connectivity-based weights reflective of network topology from a static perspective. briefly, the edge distance from a reaction node ri to reaction node rj was determined as the number of reactions in the network that consume the intermediary metabolite connecting ri and rj. the rationale was that the influence of ri on rj would be strongest if rj is the only reaction consuming the intermediary metabolite produced by ri. the influence would be weaker if the intermediary metabolite was consumed not only by rj, but also by many other reactions in the network. applying this weighting scheme to the adipocyte model , we find that shred-based partitioning of the metabolite degree-weighted network results in average homogeneity index values that lie between the un-weighted network and the flux-weighted network. this result suggests that the metabolite degree-weighted network is an improvement over the un-weighted network, but is less effective than the flux-weighted network at capturing the relative engagements between the reactions.

robust interaction pairs
we next investigated whether the modularity score vij of two reaction nodes in the initial un-partitioned network could predict the degree to which the two reaction nodes remain together in the hierarchical partitioning. the degree to which two reaction nodes remain together was assessed by the partition score hij, which scales the number of modules shared by both reaction nodes with respect to the total depth of the partitions for each reaction node . a scatter plot of the partition score and the modularity score for the day  <dig> flux-weighted model shows a significant positive correlation  for reaction pairs with a positive modularity score . of particular interest are the reaction pairs that fall in the upper right hand corner, chosen here to be reaction pairs with vij >  <dig>  and hij >  <dig> . reaction pairs satisfying this criterion were selected from all four flux-weighted adipocyte models . forty reaction pairs, or roughly  <dig> % of the possible  <dig> reaction pairs, satisfied the criterion for at least one of the four models. a heat map displaying the number of models  for which a given reaction pair meets the criterion shows that  <dig> of the  <dig> reaction pairs robustly partition together across the different metabolic states . one such reaction pair is  , which corresponds to nadph production from the pentose phosphate shunt and nadph consumption for palmitate synthesis, respectively. to determine whether these robust reaction pairs could be identified solely based on stoichiometry in the absence of flux information, each of the  <dig> reaction pairs were mapped onto a corresponding plot of modularity and partition scores for the un-weighted adipocyte model . overall, the correlation between the partition and modularity scores, albeit still significant, was weaker for the model without flux weights . only  <dig> of the  <dig> robust reaction pairs identified in figure 
4b have partitions scores >  <dig> , and only  <dig> reaction pairs also have modularity scores >  <dig>  in the un-weighted h-v plot. the three reaction pairs are  corresponding to pyruvate dehydrogenase/citrate synthase and isocitrate dehydrogenase in the tca cycle, , corresponding to triglyceride synthesis and degradation and , corresponding to glutamate synthesis and degradation. the remaining robust reaction pairs identified in the four flux-based partitions are not found in the un-weighted network partition. for example, the robust pair , which corresponds to reactions in glycolysis, has relatively low partition and modularity scores in the un-weighted case.

impact of metabolic state on modularity
the partitions of the four flux-weighted models show clear differences in hierarchical modularity. the differences are mainly due to the placement of the reactions catalyzed by phosphoenolpyruvate carboxykinase  and pyruvate carboxylase . for the day  <dig> model, the first partition of the initial network isolates both enzymes from the main network along with transport reactions that do not have any cyclical interactions . for the day  <dig> model, pepck is tightly coupled to the tca cycle reactions , and pcx is coupled to carbohydrate metabolism . for the ldh-inhibition model, pepck is coupled to carbohydrate metabolism reactions  while pcx is coupled to triglyceride metabolism and reactions that produce nadph .
 <dig> 

to quantitatively assess and visualize the overall impact of metabolic state on the hierarchical partitioning of modules, we computed the euclidean distance a reaction pair moves in the normalized h-v space of a flux-weighted model relative to another flux-weighted model . a large distance implies that the reaction pair’s partition and modularity scores  are substantially influenced by the change in metabolic state, whereas a short distance suggests that the change in metabolic state has little impact on the reaction pair’s placement in the module hierarchy. these distances are shown as heat maps for the changes in flux distribution between day  <dig> and day  <dig>  and day  <dig> and day  <dig> with ldh inhibition . for both models, the heat maps feature several dark regions . these regions largely correspond to reaction pairs involving amino acid metabolism, but also include reaction pairs involved in carbohydrate metabolism , and the tca cycle . overall, it is clear that the change in flux distribution between day  <dig> and day  <dig> has a more pronounced effect on modularity compared to the change in flux distribution between day  <dig> and day  <dig> with ldh inhibition. a similar observation was made for the change in flux distribution between day  <dig> and day  <dig> with pcx inhibition, which also had a smaller impact on modularity compared to the change in flux distribution between day  <dig> and day  <dig> .
 <dig> and
 <dig> 

discussion
in this paper, we present a novel methodology for investigating the impact of different metabolic states on the functional organization of metabolic networks. the methodology utilizes metabolic flux data as weights for a graph-based partitioning method that conserves cyclical interactions. previously, we assessed the cyclical interactions based on shreds calculated by assuming static interactions, and thus a uniform graph distance, between each connected reaction pair. in the present study, we allow the interactions, and thus the graph distances, to vary with the metabolic state.

unlike the un-weighted case, the weighted shred distribution displays significant skewness , indicating that the arithmetic mean is not representative of the average or expected shred. a likely reason for the skewness is that some reactions, particularly those involved in amino acid metabolism, carry negligible flux compared to other parts of central carbon metabolism such as glycolysis and the tca cycle. as the edge weights of a shred are inversely proportional to the fluxes of the reactions comprising the shred, a shred that includes one or more reactions carrying negligible flux can be very large, and thus skew the arithmetic mean of the distribution. for this reason, it is possible for a reaction pair to have a relatively small shred in an un-weighted network, but a relatively large shred in a corresponding weighted network. for example, the shred for the reaction pair  in the unweighted network is two  , since r <dig>  and r <dig>  interact cyclically via the production and consumption of nadh and nad+. however, in the weighted network, the directional interaction from r <dig> to r <dig> is very weak, since only a very small fraction of the nadh produced by glycolysis is used for proline synthesis. the corresponding edge distance is  <dig>  which is approximately 50-times the average of non-infinite shreds in the network . as a result, the weighted shred between these two reactions traverses an alternate sequence of reaction nodes, comprising  <dig> reactions spanning parts of glycolysis and the tca cycle, 2-oxoglutarate synthesis, and glutamate synthesis . the shred value of this cycle is ~ <dig>  this shred value is still relatively large compared to other weighted shred values in the distribution, implying a relatively weak cyclical interaction. conversely, a relatively long shred in the unweighted network can yield a relatively short shred in the weighted network. for example, the unweighted shred for the reaction pair , corresponding to mitochondrial malate synthesis and triglyceride degradation respectively, is the largest non-infinite shred at  <dig> . however, every edge in this cycle carries a relatively large flux, resulting in a weighted shred value of  <dig>  which is close to the average shred of the weighted network.

a comparison of the hierarchical partition trees for the unweighted and weighted  models shows that the weighted model yields greater functional homogeneity of modules based on the canonical pathway assignments of the constituent reactions . this suggests that the network topology alone, as defined by the network’s reaction stoichiometry, is insufficient to capture the functional associations between reactions that are reflected in the textbook pathway assignments. in our previous work, we augmented the stoichiometric information by including known regulatory interactions between reactions. edges denoting regulatory interactions were drawn from one reaction node to another if the product metabolite of the first reaction allosterically regulated the second reaction. the presence of these regulatory edges had a significant impact on the modularity of the network. however, for many cell types, information regarding regulatory mechanism is incomplete or difficult to obtain, requiring extensive manual searches of the literature. therefore, an un-weighted network will almost certainly contain only partial information regarding functional interactions between reactions. one way to upgrade the information content is to incorporate metabolic flux data, which provides a snapshot of cellular metabolic state, and reflects the integral of various regulatory processes active in the cell. in this study, we found that incorporating flux data as weights for directed interactions between reactions resulted in homogeneous modules that are more in line with textbook knowledge on biochemical pathway organization.

however, we found that some module inhomogeneity persists deep into the hierarchy even for the weighted models. a majority of these inhomogeneous modules include one or more robust reaction pairs that consistently partition together across the different metabolic states examined in this study. one such module, found at depth  <dig> of the day  <dig> model partition , points to a tight coupling between carbohydrate metabolism, citrate malate cycle, and lipid metabolism, mediated through the production and consumption of nadph. this module includes the reaction pair , corresponding to nadph production via the pentose phosphate shunt and palmitate synthesis respectively, which was one of the  <dig> robust reaction pairs with both a high modularity score and a high partition score for all four flux-weighted partitions. we have previously observed that the interactions mediated by cofactors, which are ubiquitously present throughout metabolism, can couple reactions spanning seemingly distant pathways
 <cit> . prior studies have often removed cofactors or ‘currency metabolites’ prior to network modularization due to the difficulty of assigning them to distinct functional modules. while shred-based partitioning can also be performed after the removal of cofactors, our prior work suggests that cofactors are essential in mediating metabolic cycles and allosteric feedback loops
 <cit> , and should thus be retained if the goal is to identify modules based on cyclical interactions.

one possible biochemical basis underlying the robust reaction pairs is co-regulation. for example, reaction r <dig>  catalyzed by 3-oxoacyl- reductase, requires nadph as a cofactor for activity
 <cit> , while both enzymes catalyzing the lumped reaction r <dig>  glucose 6-phosphate dehydrogenase and 6-phosphogluconate dehydrogenase, are allosterically regulated by nadph
 <cit> . similarly, reaction r <dig>  catalyzed by malic enzyme, is product-inhibited by nadph
 <cit> , which is a required cofactor for reaction r <dig>  another co-regulated robust reaction pair is , corresponding to the first steps in the tca cycle  and oxidative phosphorylation, respectively. oxaloacetate is a limiting substrate for citrate synthase, and also a competitive inhibitor of oxidative phosphorylation
 <cit> . reactions r <dig> , r <dig>  and r <dig>  are steps in the tca cycle regulated by atp, which could explain the robustness of interactions between reaction pairs  and 
 <cit> .

while the partitions of the four flux-weighted models share similar modules as exemplified by the robust reaction pairs, they also exhibit notable differences. for the day  <dig> partition, reactions catalyzed by pcx and pepck both split off immediately from the parent network at depth one of the hierarchy. this split is due to the very low flux carried by these reactions at day  <dig>  which excludes them from significant cyclical interactions with any of the other reaction nodes. day  <dig> represents an early stage of differentiation when an immature adipocyte phenotype is expected. while lipogenic genes are activated, the fluxes of lipid synthesis and triglyceride accumulation remain low at this stage relative to other parts of central carbon metabolism. our results suggest that pcx and pepck, which catalyze upstream steps in glycerogenesis and fatty acid synthesis from glucose, are not yet integral to any major functional modules in the immature adipocyte. however, at day  <dig> , pepck is tightly coupled to the tca cycle reactions, mediated through the consumption and production of atp, and pcx is coupled to carbohydrate metabolism and triglyceride metabolism . indeed, there is a striking difference between day  <dig> and day  <dig> partitions based on the relative distances between the corresponding pairs of reactions in the h-v space. in comparison, there is a more subtle difference between the partitions of day  <dig> and day  <dig> with ldh inhibition. these observations suggest that the inhibition of one enzyme is not enough to drastically alter modularity. in contrast, the transition from an immature phenotype on day  <dig> to a mature phenotype on day  <dig> represents a concerted set of changes across cellular metabolism, which is reflected in the broadly altered modularity.

CONCLUSIONS
taken together, our results support the notion that network modularity is influenced by both the connectivity of the network’s components as well as the relative engagements of the connections. the major contribution of the present study is a generally applicable methodology to incorporate activity data into a systematic partitioning framework featuring the conservation of cyclical, or retroactive, interactions. we found two key benefits of incorporating metabolic flux data. first, comparisons across different metabolic states can identify conserved modules comprising robustly interacting reactions that may be co-regulated by a common allosteric effector. second, embedded in the flux data is information on the various layers regulatory processes active in the cell, which can be used to augment connectivity relationships defined by stoichiometry. in the context of modularity analysis, the implication is that lack of detailed knowledge on regulatory mechanisms can be at least partially addressed using experimentally observable data. on the other hand, the reliance on experimental data is also a limitation in the scalability of our methodology. as modularity analysis is an approach to study complex networks, it is ideally applied to large-scale systems rich with complexity. unfortunately, resolving the flux distribution of a large-scale metabolic network, for example using 13c isotope labeling, remains experimentally demanding and technically challenging. one way to address this limitation in scalability could be to utilize solutions from constraint-based methods such as flux balance analysis that require relatively few measurements. rather than rely on flux data reflecting an observed metabolic state, flux data could be used that reflect an optimized state or a range of attainable states. an added benefit of using such model-derived flux data could be to enable efficient exploration of different module configurations accessible to a metabolic network.

in summary, we have extended a previously developed methodology for modularity analysis by considering non-uniform interactions between retroactively connected reactions. whether the modules defined by cyclical interactions between their constituent reactions indeed contribute to some recognizable system property warrants further study. for example, a future study could examine whether modules comprising metabolic cycles serve to limit the propagation of perturbations through the network, and thereby add to the stability of the system.

