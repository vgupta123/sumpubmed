BACKGROUND
current genome sequencing projects are producing a wealth of data in the form of sequences of biological polymers. for this data to be useful, it has to be interpreted in functional terms. thus, efficient systems to describe and classify protein function are needed, as well as tools to predict the function of the huge number of new sequences.

there is much evidence for the need of well-defined and structured functional descriptions  <cit> . however, the main difficulty encountered is that 'function' is not a well defined concept and it is not as un-equivocal as 'sequence' or 'structure'. indeed, protein function is a very complex and multidimensional phenomenon.

in many cases, functional descriptors are based on the available experimental techniques or are due to historical reasons. however, they do not necessarily have any meaning in biological terms . the methods we use to study biological systems require conceptualization and categorization, which are sometimes taken beyond their role as mere tools of the scientific method and are 'imposed' on the cell. one example is the artificial distinction between processes such as 'transmission of information' , 'metabolism'  and 'transport' . such disjointed classifications, as used in the first schemes to describe protein function, clearly do not extend to the molecular or evolutionary level. these schemes have been used in the past for classifying proteins into functional classes and for developing systems to assign newly sequenced proteins to them  <cit> .

the current tendency is to use vocabularies and ontologies that allow complex functional descriptions beyond disjointed classes. among these, the important effort of the open biomedical ontologies   <cit>  in developing controlled vocabularies for a wide scope of applications in a biological and medical context must be recognised. the obo ontologies are designed as graphic architectures formed by univocal concepts  that are linked together by relationships that satisfy some prefixed and formal rules  <cit> . the gene ontology  project  <cit>  has become the 'de-facto' standard in biomedical ontologies. formally, go is designed as a direct acyclic graph  based on two unconstrained relationships  that link a vocabulary of functional terms  <cit> . this graph structure, together with the simple conceptualization, permits comparisons between any two go terms to assess their functional similarity. however, certain problems, such as the function-based search for potential genes/proteins of interest across multiple annotated databases and the analysis of high throughput microarray data, have led to the in depth exploration of ontology in order to propose models and criteria to measure the functional relationships between the terms.

in recent years, many studies have addressed this matter  <cit> , although lord was the first to establish a semantic distance for any two terms in go  <cit> , adjusting the ideas of resnik  <cit>  for general taxonomies. in the model proposed by lord, the similarity of any two go terms is determined as a function of the information content of common ancestors that are calculated from corpus statistics. recently, further efforts to identify functionally related gene products in annotated databases based on the distances calculated by lord  <cit>  have been shown to produce a good agreement with homology searches  <cit> . nevertheless, using the more informative common ancestors as a proximity reference presents some restrictions. first, the depth of the shared parent nodes is not a suitable criteria for some limited cases in which the terms to be compared are close to the root. furthermore, the information content  of a node is highly dependent on the annotated database selected and its release version.

models have been developed to overcome these limitations that take into account other aspects of the ontology structure. for example, the distance between two terms may also integrate the density of the terms and the path that links them  <cit> . alternatively, a new definition has been used that considers the local relationships in the subgraph generated by the terms, rather than their global positions in the dag  <cit> .

a common feature of these different approaches is that they rely mainly on the semantic links of the dag. unfortunately, there are inherent problems in this approach due to the non-homogeneity and the uneven distribution of the biological knowledge. as a result some regions of the dag are more densely populated than others, so that the connections between terms are not comparable. in addition, the depth of a node  can not be assigned in an unequivocal way. this type of problem is especially relevant for nodes that are profusely connected to the root by various paths of different lengths.

in this work, we propose a novel method that associates the molecular function go  terms based on their co-occurrences in a 'curated' set of proteins and enriched by the semantic relationships from the ontology. interpro is used as a curated database as it integrates protein information from other databases that describe protein families, domains and functional sites, such as prosite, prints, pfam, prodom, smart and tigrfams  <cit> .

conceptually, the method is, to some extend, similar to the way in which similarities between aminoacids are 'learnt' from examples  rather than obtained from the raw chemical properties of the aminoacids. methodologically, it shares aspects of the algorithm used in the david tool  <cit>  for clustering heterogeneous annotation contents from different resources into annotation groups based on the co-association of the annotated genes in the databases.

the method analyses the mutual occurrences of the mf-go terms across the interpro entries. the occurrences are used as the basis of the comparison of the terms on the assumption that the persistent coincidence of two terms describes its 'relation' in the general functional space. the analysis of the occurrences provides a useful mathematical tool to quantify the functional similarity between terms. a hierarchical tree linking the mf-go terms is built from the similarity matrix. we termed this tree the 'functional tree' and it formally constitutes a distance model since it satisfies the ultrametric triangle inequality. in this context, the functional distance for a pair of terms, df, is defined as the height of their least common ancestor in the 'functional tree'. in addition, the tree allows the go terms to be clustered into compact and homogeneous groups with biological meaning.

we describe here how the functional tree was built, how the tree is clustered and the groups generated are analyzed in terms of the functions they describe. the functional distance df derived from the functional tree was used to calculate the distances between pairs of yeast proteins to assess the reliability of the tree. we also compare this new metric with another based on semantic similarities.

RESULTS
algorithm
the steps followed to obtain the metric model are schematically represented in figure  <dig> 

first, for each molecular function term we create a profile vector that represents its presence/absence in different intepro entries . these vectors resemble the 'phylogenetic profiles' used to encode the proteins present in different organisms and to detect protein relationships  <cit> .

initially, we started with  <dig> mf-go terms present in  <dig> intepro entries. additionally, we included the semantic relationships represented by the gene ontology dag by assigning the same interpro domain to the parent of a given go term. the profiles were checked to detect the terms that were associated exclusively to one interpro entry and to ensure that this entry was not annotated with any other term. any such profiles were removed because they do not help to extract relationships between the terms. after filtering, we obtained a matrix of  <dig> interpro entries with  <dig> mf-go terms. in a second step , we built a matrix of co-occurrences of go terms in interpro entries. the occurrences were accumulated through all the profiles and we obtained the total mutual occurrences in the universe of the  <dig> terms. each co-occurrence vector describes a mf-go term in relation to the rest of the mf-go terms, which enables it to be used as a feature vector in the application of statistical learning techniques.

third, the similarity between the terms was calculated using the cosine distance between their corresponding co-occurrence vectors . the similarity matrix s was obtained by crossing the vectors all-against-all  and the functional groups were obtained by the clustering of s. full details of the similarity matrix calculus are available in the methods section. finally we applied a spectral clustering algorithm  <cit>  as it performs a dimensional reduction of the data . the general ideas behind spectral clustering methods are introduced in the 'spectral clustering' subsection from the appendix. this approach improved the search for functional groups in the mf-go terms space.

spectral clustering considers s as the adjacency matrix of a normalized weighted graph g, where the nodes stand for the mf-go terms linked by the similarity values. thus, the clustering problem is transformed into a partitioning graph problem. we only considered the graph comprised of terms that were connected with significant relationships, that is those connected by a pairwise similarity greater than a manually selected threshold value . after imposing this constraint, we obtained  <dig> mf-go terms from the total of approximately  <dig> terms integrated in the released version of this work.

we have also considered the njw adaptation of spectral clustering  by ng, jordan and weiss  <cit> , which is summarized in the general scheme in figure  <dig> . the algorithm calculates a transition probability matrix, p, from a n Ã— n similarity matrix, s, that represents the probability of transit from one node to another in the graph. p is diagonalized and its k first eigenvectors are stacked and normalized in a new k Ã— k matrix, y. the rows of y can be treated as n vectors k dimensional. therefore, njm-sc projects the mf-go terms  onto points in a k dimensional space. subsequently, the terms can be grouped with any standard clustering technique. k was thus selected as the number of clusters in the optimum partition of g. the optimization procedure is presented in detail in the methods section. the resulting number of optimal groups was  <dig> 

finally, from the vector projections of the mf-go terms, we built a dendrogram with an agglomerative hierarchical clustering algorithm  <cit>  . the tree obtained  defines a distance df between any two mf-go terms from the set of  <dig> . the distance for two terms was the minimum height of their common nodes. from a mathematical point of view, df satisfies the topological properties that induces a metric space . so, the metric generated by the functional tree establishes a 'distance scheme' that provides a measure of the closeness of any two mf-go terms within the tree.

testing
functional groups
the nodes of the functional tree are divided into groups imposing the number of clusters obtained in the optimization step. the  <dig> groups of molecular function terms are inspected and  <dig> groups with highly homogeneous biological function are detected. in the functional tree , the functionally homogeneous groups are coloured and ranked, and the labels assigned are shown with their rank number.

some of these groups were very specific, like the group containing the  <dig> amino acyl-trna ligase activities. this group includes all the trna ligases and no other go term, and hence the automatic clustering algorithm achieved a perfect segregation of this functional group .

another big group mostly composed by activities related to hydrolysis  was labelled as group  <dig>  although this group was homogeneous for this activity, the coverage was not perfect since other hydrolases lay outside of this group. for example, group  <dig>  which was far from group  <dig> in the tree, was mainly comprised of peptidase activities.

interestingly, many different activities associated with dna processing tended to cluster together despite the fact that they were apparently unrelated . as for the hydrolases case commented above, although this group contained only dna-related activities and other dna-related functional terms were not included in this group.

most of the kinases of small metabolic compounds were clustered in a large group , while protein kinases were more widespread even though some of them clustered together in group  <dig>  many membrane transporters of apparently different nature  were also clustered together in homogeneous groups.

all the 'protein inhibitor' activities within the dataset were clustered together in a homogeneous group , which is interesting given that the proteins they inhibit are of a very different nature .

functional clustering was also evident for many other go terms: methyl-transferases, phosphorybo-syltransferases, peptidases, some peptidic hormones, neurotransmitter receptors, phosphate-hydrolases, hy-dratases/dehydrateses, adenylyltransferases, etc....

for other clusters, this functional 'homogeneity' was not so evident. for example, oxidoreductases were spread across many groups even though some groups contained oxidoreductase activities only . this dispersion could be explained by the fact that this function is present in proteins with a very different evolutionary origin. similarly, activities related to rna metabolism were spread among the different clusters, except the trna-ligases discussed above.

in general, the clustering represented by the tree makes sense, meaning that go molecular functions that are intuitively 'similar' were close in the tree and vice versa. this emphasise that the metric represented by the tree can be used to quantify functional similarities.

the functional tree as metric model
the functional distance df defined from the functional tree allows a new quantitative analysis of the functional relationship between gene products. to assess df as a functional similarity measure we correlated sequence and annotated function similarity over a set of aligned pairs of yeast proteins. the benchmark set has been selected by applying a very restrictive criterion to obtain a high reliable set of annotated proteins. the selection process  takes as quality assay the evidence codes in goa. in this work, we picked only those sequences that had been functionally characterized either by experimental assay  or by traceable published works  and whose go terms were included in our functional tree.

the functional distance between proteins  is calculated using the hausdorff definition. the details are exposed in the 'functional comparison between gene products' subsection from methods. the distance values are represented against the sequence similarity . lord semantic similarity ds was also implemented and represented in figure 5b. note that the lord distance values are normalised in order to analize the metric derived in this work with respect to lord's model.

to compare the models the mean distance values for each bin of sequence identity are superposed in figure 5c. in average, both approaches correlate well with sequence similarity and exhibit a similar trend for homologous pairs. this is partly due to the homology-based mechanism of annotation that transfers directly a source set of mf-go terms to many homologous sequences.

in consequence, more than 84% of the alignments with sequence similarity values greater than 80% share the same annotations. this lack of richness in the annotations limits further analysis of the methods. however, we can observe that df and ds show a different behavior. the distance space is discretized into three well-defined groups  whereas the semantic similarity values produced a great spread.

these natural 'cut-offs' allow classifying the pairs into three categories with biological meaning that can be roughly labelled as 'closely functionally related' , 'not related at all'  and 'divergence in functionality' . this partition results from the structure of the clusters  showing small intra-group and large intergroup distances. this is in part due to 'biological' reasons but is also affected by the function transfer by sequence homology. 

the repetitive and persistent presence of the same mf-go terms in the intepro domains indicates clear functional associations of the terms but it is also originated by the usage of a reduced set of annotations producing redundancy in the functional information of the sequences and low coverage with respect to the total number of terms in the ontology .

in addition, the functional distance model df becomes very useful from the perspective of recovering proteins functionally similar to a query, as it provides new associations between the terms inferred from the homology information in the database entries. these new links enrich the ontology relationships among the terms. this is the case of group  <dig>  whose mf-go terms are spread across different lineages of the ontology involving dna-related activities. these associations are very visible in many pfam domains  but are not detected with a criteria based on the semantic proximity of the terms. group  <dig> is partially represented in figure  <dig> showing the relations of some terms in the ontology. some terms of the group, such as 'dna binding' and 'specific transcriptional repressor activity', are very distant in the dag and share the root as common ancestor. this produces a semantic distance of  <dig>  other terms like 'transcription factor activity' and 'dna replication origin binding' share the node 'dna binding' that is three levels apart from to the root.

the benchmark set includes some example pairs in which df assigns close distances to functionally related pairs while ds does not. one is the pair formed by  and  that shares 50% sequence identity. the first is a transcriptional repressor and activator annotated with the term go: <dig> . the second is a trimeric heat shock transcription factor annotated with go: <dig> . both are characterized by hsf-type dna-binding pfam domain. the relative posititions of their annotated terms in the dag can be checked in figure  <dig>  ds is  <dig>  indicating a weak relation between the proteins. however, df situates the pair into the 'closely functionally related' region because the terms belong to the cluster  <dig> described before.

other similar example is the pair formed by the protein kinases  and . the proteins are characterized by protein kinase pfam domain and are annotated respectively with go: <dig>  and go: <dig> . both terms belong to group  <dig> . so, as in the example before, the distance df is  <dig> whereas ds is  <dig> . although these terms are close in the ontology , the lord model assigns such a value distance because the shared parent  is referred many times in the gene association.goa human file. according to lord definition, high probable terms carry low information content producing high distance values in the comparison of terms. in the case of the kinases pair, the probability introduces a bias that shifts the semantic distance value to a region that indicates, as the example before, a weak relation between the proteins.

finally, the functional distance model is sensitive enough to detect subtle differences in the pairs / and / that are explained by sequence analyses. in both cases, the members of the pair were annotated with go: <dig>  and go: <dig>  respectively. lord's semantic model produced a distance of  <dig>  between these proteins, indicating semantical relation. in fact, the aforementioned terms are close in the go hierarchy, and the deepest common parent shared by both go terms, two levels above, is 'nucleobase, nucleoside, nucleotide kinase activity' . however, our functional distance located that pair of go terms within the intermediate interval at a distance of  <dig> . a thorough analysis of the sequences revealed that  has the 'adk' pfam domain. adenylate kinases are phosphotransferases with well conserved adk domains that include an important arginine which inactivates the enzyme if mutated, and an aspartate that is located in the catalytic cleft and that forms a crucial salt bridge. however, in the particular case of  and , the putative adk domain is interrupted by another pfam domain, the adk lid. looking at the sequence of this particular region, the adk domain boundaries were not clearly delineated due to a high degree of divergence in the active site. so, in this example our metric is able to capture the 'functional difference' between these two proteins due to the inserted domain.

implementation
the spectral clustering algorithm is implemented in matlab  <dig> . <dig> using the clustering functions available in the statistics toolbox. lord's model is implemented in python  <dig> , and python was also used to calculate the functional and semantic distances.

discussion and 
CONCLUSIONS
here, we propose a new method to derive 'functional distances' between go terms based on the co-occurrence of them in the same set of proteins. the simultaneous occurrence of terms in interpro entries provides a natural biological link between the go functions. the relationship between terms in the go structure provides additional semantic information that helps to refine the metric model.

in this method, an initial profile is constructed for each go term representing its association with a set of interpro domains . these profiles are used to generate a matrix of co-occurrence between go terms. a graph is constructed where the nodes are the go terms and the edges are weighted according to the distances extracted from this co-occurrence matrix. spectral clustering is applied to this graph in order to obtain an optimal number of groups of functionally similar go terms. the distances derived in this way provide a hierarchical clustering of go terms  where the groups of terms with similar biological meaning tend to be close. additionally, this 'functional tree' represents a metric model df whereby the distances between the terms fulfil the mathematical properties of a metric space.

the main difference of this method from previous approaches  <cit>  is that df is learned from examples. hence, in contrast to other proposed methods that derive the distances from the semantic relationships within the go ontology, our method provides new associations between the terms that enables a different way to compare proteins in functional terms. we have selected some cases to illustrate this point, for which the functional similarity between related proteins is better estimated with this metric model than with currently available algorithms, such as lord's 'semantic similarity model'  <cit> . moreover, we also tried to qualitatively assess some of the groups automatically extracted from the distances by a clustering algorithm. over and above the comparison with these examples and the qualitative assessment of the functional tree, it is actually difficult to assess the general quality of any functional metric.

the overall representation of the functional distances in the functional tree originates very compact groups of terms separated by well defined intervals as it is shown in figure 6b. this structure of the clusters produces a not uniform distribution of distances because the values tend to concentrate in three regions , which is obviously a problem since it makes the metric to some extent 'qualitative'. on the other hand, this categorisation produces natural 'cut-offs' and functional similarities that are naturally classified by the method in three categories with biological meaning in a totally unsupervised way as been discussed in results section.

this discretization is in part due to 'biological' reasons but is also affected by the homology-based transfer that causes that only a reduced set of terms is used for annotation purposes. in consequence, the coverage with respect to the total number of terms in the molecular function ontology is low . in addition, only clear relations are selected resulting a set of  <dig> mf-go terms that are considered in the functional distance model.

it is important to note that the relationships between the go terms obtained and the relationships in the go ontology represent different elements. the go dag represents qualitative semantic relationships  while our relationships represent quantitative 'functional distances'.

thus, the metric proposed here provides a way of quantifying how similar two functional annotations are. this can be very useful for training systems for function prediction, for function-based protein searches in databases, or to assess the accuracy of a functional prediction . this metric could also be useful for analysing the gene clusters produced by dna array experiments. we think it may also provide insights into how functions evolved and the relationships between sequence, structure and functional spaces.

