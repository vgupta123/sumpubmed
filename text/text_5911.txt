BACKGROUND
new sequencing technologies, by generating hundreds of millions of reads from multiplexed samples, allow the rapid and simultaneous acquisition of many genome sequences, and foster comparative analyses of closely related organisms. despite achieving high coverage, the short reads generated by many sequencing platforms permit only partial assembly of genomes, due largely to the presence of numerous classes of repetitive sequences. only regions of unique, single copy sequence and repeat regions shorter than the read length can be accurately assembled, yielding draft genomes that consist of unordered contigs separated by gaps of unspecified size  <cit> . these technological limitations conceal the size and organization of a genome because the number, contents and distribution of repeat arrays remain unknown. to resolve the total size and repeat organization of a genome typically demands a complete genome assembly, which is ultimately obtained by linking contigs through combinatorial strategies and additional sequencing  <cit> , which may sometimes be aided by additional finishing approaches, such as optical mapping  <cit> .

the number, types and configuration of repeated sequences varies greatly within and across species. even bacterial genomes, which consist mostly of single-copy protein-encoding genes, can contain multiple classes of repetitive sequences that can prevent their assembly and analysis. bacterial genomes encode as many as  <dig> ribosomal dna operons, which can each span several kilobases and are of nearly identical sequence within most organisms, complicating the assembly of their genomes  <cit> . even more problematic are the shorter repetitive elements and sequence repeats present in bacterial genomes  <cit> . for example, most bacteria harbor multiple classes of insertion sequence  elements, which average about a kilobase in length and whose copy numbers are highly variable, sometimes reaching hundreds of copies per genome  <cit> . in addition, there are several other types of repetitive sequences, including the 21-to-65-nt repetitive extragenic palindromic  sequences  <cit> , the 127-bp palindromic enterobacterial repetitive intergenic consensus  sequences  <cit> , and the bacterial interspersed mosaic elements   <cit> , each of which can be dispersed throughout the genome or exist in tandem arrays  <cit> .

heterogeneity in the numerous classes of repetitive sequences contributes to the genome size variation that has been observed in many bacterial species. for example, isolates of escherichia coli can differ by up to 30% in genome size, with sequenced strains ranging from  <dig>  to  <dig>  mb  <cit> . some of this size diversity is also attributable to the differential accumulation of plasmids and prophages. accessory elements can also complicate the repeat structure of genomes because the multiple prophages within a genome can encode the same genes, and plasmids are often maintained in very high copy numbers.

because high-coverage, short-read data contain information about repeat content that is not apparent in draft assemblies, we developed a procedure to estimate the size and repeat content of genomes from raw sequence data. this method relies on the analysis of the frequencies of overlapping fixed-length sequences   <cit> , thereby exploiting a computationally efficient and scalable analytical technique that underlies many search and assembly algorithms. to date, k-mer-based algorithms have served as the basis for efficient similarity searching  <cit> , vector removal  <cit> , graph-based, short-read assembly  <cit> , short-read error correction  <cit> , estimation of genome repeat structure  <cit> , comparison of whole genomes  <cit> , identification of anomalous genome regions  <cit>  and binning of sequence fragments from different sources  <cit> .

we show that direct analysis of the abundances of unique 21-mers  recovered from sets of whole-genome shotgun short read sequences yields robust estimates of total genome size and of the proportion of the genome represented by repeats of each copy number. furthermore, sequence coverage can be estimated, sequence quality can be characterized, and sample contamination can often be diagnosed. therefore, resolution of the repeat architecture of a genome can facilitate comparisons of genome size, structure and complexity, help the assembly of accurate genome sequences, and improve confidence in genome assemblies.

RESULTS
analysis of short-read datasets from novel e. coli strains
our choice of k-mer length,  <dig>  was determined empirically and reflects the minimum size for these genomes that can reliably distinguish small repeats from single-copy sequences. abundance analysis using smaller k-mers is sensitive to shorter repeats, resulting in larger proportions of sequence inferred to occur in multiple copies  and k-mers shorter than  <dig> nucleotides in length are more likely to match by chance alone. the wider range of repeat lengths spanned by longer k-mers causes abundance analysis to be less sensitive to short repeats, such that smaller fractions of the genome will be classified as part of a repeat. discussions of k-mer length have treated it as a parameter to be optimized  <cit>  and as a sensitivity/specificity tuning parameter for search and assembly  <cit> . it should be noted that a k-mer length of  <dig> is biologically relevant: it is short enough to resolve small repeated elements that occur in e. coli, such as rep and eric sequences  <cit>  but long enough to distinguish between single copy protein-encoding regions by spanning the sequence that defines such regions as unique.

there are several methods to efficiently enumerate k-mers, including dense representations  <cit> , hashing  <cit> , and probabilistic data structures  <cit> . technical limitations on computer memory and storage space make dense representations unreasonable for k-mers longer than k = 18; however, the hashing implementation used here  is applicable to k-mers as long as  <dig>  and can in principle be applied to very large datasets . due to reverse-complement degeneracy, the total number of possible k-mers is approximately  4k, and for k =  <dig> or greater, there are many more possible k-mers  than basepairs in the largest observed bacterial and archaeal genomes . the scarcity of long k-mers, together with the fact that most microbial sequence is non-redundant, has the consequence that most k-mers that do occur are present only once, contain sequence from single copy genes, and map to unique locations of the genome.

the abundance histograms  display the number of distinct 21-mers at each abundance  for the short-read datasets generated for five environmental strains of e. coli. to improve visualization of these spectra, we transformed the data by multiplying the total 21-mers at an abundance by that abundance. these histograms share several features denoting similarities in the read sets produced for each genome. starting in the upper left of each plot are numerous, but low-abundance, 21-mers: these represent the unique and rare 21-mers produced by sequencing errors and are therefore not relevant to assessments of genome size and architecture. next along the curve is the principal peak comprised of 4– <dig> million different 21-mers present at approximately the same abundance. these represent 21-nucleotide sequences that are present in a single copy in the underlying genome. the horizontal position of the principal peak, representing the mode of the 21-mer abundance, is proportional to sequencing coverage. for sequencing runs of the e. coli strains that we examined, sequence coverage ranged from 55× in strain b to 85× in strain a, resulting from variation in the number of sequencing reads produced for each strain.

the multi-modal distributions of 21-mers at abundances above that of the principal peak reflect primarily the several classes of repetitive sequences that are present at different copy numbers in a genome, although unevenness in read coverage of the target genome can cause distortion of the peak shape. the successive peaks occur at multiples of the principal peak’s abundance, each of which reflects the repeat copy number of the sequence contained in those 21-mers, and the area under each peak is determined by the amount of unique sequence at that copy number. in all five e. coli genomes analyzed, the first peak is the largest, consistent with the expectation that complete e. coli genome sequences, and bacteria in general, are relatively gene-rich and consist primarily of single copy sequences.

to help interpret the 21-mer spectra of unassembled short-reads, we also examined the relationship between 21-mer abundances and the distribution of repeated sequences in a fully assembled genome. the abundance frequencies of 21-mers in the complete e. coli dh <dig> genome  reveals a total of  <dig> , <dig> unique 21-mers , and another  <dig>  21-mers present between two and  <dig> times. it is also notable that  <dig>  21-mers in the e. coli dh <dig> genome were repeated seven times, corresponding to sequences common to the seven near-identical ribosomal dna  operons  and to the insd is <dig> transposase, which is also at seven copies in this genome. additionally,  <dig>  21-mers are repeated more than  <dig> times, most of which correspond to the insh is <dig> transposase, present fifteen times in the dh <dig> genome.

aeach row corresponds to the number of nucleotides and the total amount of genome sequence inferred from the mixed poisson model fit to each peak of the 21-mer spectrum of short reads for each of the novel e. coli strains , and from direct counts of 21-mer in the e. coli dh <dig> genome sequence.

relating abundance histograms to genome repeat structures
the number of 21-mers that reside under each peak in an abundance histogram corresponds closely to the number of basepairs of sequence at a particular repeat copy-number. to estimate the amount of unique sequence under each peak and to gain insight into the repeat structure of each target genome, we applied a maximum likelihood estimator to model the distribution of 21-mers in each histogram spectrum . this approach is similar to but has advantages over the method used by li & waterman  <cit>  to estimate repeat structure from sequence reads. in our implementation, the inference of sequence repeats is guided by the natural property of 21-mer abundances to occur at integer multiples of the modal k-mer abundance . whereas our fitting procedure exploits this property to stabilize the likelihood optimization, the implementation of li & waterman  <cit>  uses the expectation-maximization algorithm. in addition, our approach was evaluated using high-coverage, short-read raw sequencing data and is optimized for current technologies.

the amount of unique sequence, as well as the total amounts of the genome sequence accounted for at each repeat copy-number, vary among the five strains indicating that the strains differ in their repeat structure and numbers of multicopy elements . the choice of k limits the shortest repeat that can be resolved. our choice of k =  <dig> allows resolution of the small repeated elements that typically occur in e. coli and other bacteria. resolution of the repeat structure of a genome also provides an estimate of the total genome size . despite different values of k providing different interpretations of repeat structure , estimates of genomes size are almost unaffected. other choices for k from  <dig> to  <dig> changed the genome size estimates among our five e. coli datasets by less than  <dig> % .

a common characteristic of the repeat structures of these e. coli genomes is a trend towards less unique sequence at higher copy numbers, except around seven times the abundance of the principal peak. the peaks at this copy number correspond to the rrn operons and any other sequence repeated a similar number of times. the rrn operons are present in seven copies in virtually all strains of e. coli and were observed in the 21-mers counted seven times in the completely sequenced e. coli dh <dig> genome .

despite the similarities in repeat structure, 21-mer abundance analysis using kmerspectrumanalyzer allows differences in repeat structure between these five novel e. coli genomes to be resolved. the amount of unique sequence at six to eight copies per genome ranges from  <dig>  kb in strain a_03_ <dig> to  <dig>  kb in strain e_01_ <dig>  while e. coli rrn operons are approximately  <dig>  kb and expected to be present at seven copies, they are often non-identical at a few positions. because 21-mer abundance analysis only resolves identical sequence repeats, the two smallest estimates of sequence at six to eight copies were  <dig>  kb in strain a_03_ <dig> and  <dig>  kb in strain b_04_ <dig> may not be an underestimation but an accurate reflection of the identical sequence among rrn operons. any differences among the rrn operon sequences would be included in the total genome size estimate but at copy numbers less than seven. the estimates of sequence at six to eight copies in strains c_04_ <dig>  d_04_ <dig> and e_01_ <dig> were  <dig> ,  <dig>  and  <dig>  kb respectively and are greater than can be explained by the presence of seven rrn operons alone. these larger estimates are evidence of additional repeated sequences at abundances similar to that of the rrn operons.

there is little sequence repeated at high copy numbers within strains a_03_ <dig> and b_04_28: the repeats in nine or more copies are represented by less than  <dig> bp of unique sequence in both cases. in contrast, strains d_04_ <dig> and e_01_ <dig> possess  <dig>  kb and  <dig>  kb respectively, of sequence repeated nine or more times. the  <dig>  kb of high copy-number sequence from strain d_04_ <dig> contains two protein-coding regions sharing high similarity with sequences annotated as is <dig> transposases , and some of the 3-kb sequence at high copy number in strain e_01_ <dig> shares high sequence similarity to plasmid pce10b from e. coli o7:k <dig> strain ce <dig> .

accuracy of 21-mer analysis for determining microbial genome sizes
the accuracy of estimates of total genome size obtained by our fitting procedure was tested in three ways. first, we assessed the sensitivity for discriminating the genome sizes from the whole-genome shotgun short-read datasets of five novel strains of e. coli, whose genome sizes were also estimated by totaling the lengths of i-ceui restriction fragments resolved by pulsed-field gel electrophoresis . next, we tested the range of microbial genome sizes over which the procedure remains accurate by comparing the size estimates made from publicly available short-read datasets to the lengths of the corresponding complete genome sequences. finally, we assessed the robustness of these genome size estimates by varying the read depths on target genomes and varying error content by quality-score-based read trimming.

the genome sizes obtained by enumerating 21-mers were very similar to those estimated by physically sizing i-ceui restriction fragments by pfge . based on pfge, the strains ranged in size from  <dig>  mb  to  <dig>  mb , well within the size range of completely sequenced e. coli genomes . on average, genome sizes obtained by pfge differed by only about  <dig> % from those obtained by 21-mer analysis, with the largest disparity observed in e. coli strain d, for which we obtained genome size estimates of  <dig>  mb by 21-mer analysis and  <dig>  mb by pfge. aside from this strain, the two methods are in agreement with respect to the relative genome size estimates, identifying strain a_03_ <dig> as the smallest with increasing sizes through strain b_04_ <dig>  strain c_04_ <dig>  strain d_04_ <dig> and strain e_01_ <dig> 

arestriction digests of genomic dnas with i-ceui endonuclease yielded seven restriction fragments for each genome, the sizes of which are listed in additional file 3: table s <dig> 

to assess the accuracy of the pfge estimates, we also sized e. coli strain mg <dig>  for which the genome sequence is available  <cit> , by pfge, and compared fragment lengths to those expected based on the i-ceui sites in the sequenced genome. except for the largest i-ceui restriction fragment, fragment length sizes estimated by pfge were very close to those predicted by in silico digestion of the genome and are listed in additional file 3: table s <dig> along with each fragment size for the novel e. coli strains. due to the vagaries of resolving and sizing fragments >  <dig> mb by pfge, we estimated the size of the largest i-ceui in the e. coli mg <dig> genome to be  <dig>  mb, whereas it is actually  <dig>  mb according to published sequence  <cit> .

although the genome sizes determined by pfge were similar to those estimated by 21-mer analysis of the short-read data, there remains some discrepancy between the two methods. one source of the difference is that the pfge only accurately assesses the sizes of linear dna fragments. bacterial genomes often contain small circular plasmids that remain intact after i-ceui digestion and these circular elements are not included when tabulating genome size. the reported lengths of complete genome sequences may differ from size estimates by 21-mer analysis of read-sets because sequences, such as those encoded on multicopy plasmids, are represented in read data in proportion to their actual molecular quantities. in contrast, published genome sizes do not accommodate such differences in copy number leading to disparities in the canonical genome size and actual dna content of the cell.

to further test the accuracy of k-mer analysis for estimating genome sizes, we applied the 21-mer abundance analysis to short-read datasets for a set of  <dig> microbial genomes whose known sizes range from  <dig>  to  <dig> , <dig> bp . the correlation coefficient between the actual sizes of these genomes and those estimated made by 21-mer abundance analysis is  <dig> , with a root-mean-squared error relative to the known genome size of 6% . the largest absolute discrepancy of  <dig> kb was observed for niastella koreensis gr20- <dig>  and the largest relative discrepancy of  <dig> % was observed for listeria monocytogenes j <dig> . given the difference in the size of the niastella koreensis , and listeria monocytogenes  genomes, there is little relationship between the estimation error and the size of the genome over the range tested. however, any underlying relationship between the estimation accuracy and genome size may be masked by variation in systematic sequencing error among the datasets tested.

some of the differences, particularly the overestimations of genome size by 21-mer analysis, may be caused by the presence of multicopy plasmids: these elements are always counted only once when reporting a completed genome size but are included in proportion to their actual copy numbers in 21-mer analysis. the over-estimate of the  <dig>  mb cylindrospermum stagnale pcc  <dig> genome  by only  <dig>  bp is consistent with single copy plasmids and a small degree of error, and the genome size estimated for nostoc sp. pcc  <dig> could accommodate two copies of its smallest plasmid  per chromosome. similarly, the genome size estimated for thermovirga lienii dsm  <dig> accommodates two or three copies of its  <dig>  bp plasmid in addition to its chromosome. e. coli ko11fl carries a single plasmid, prk <dig>  which has been shown experimentally to be maintained in e. coli strains at between  <dig> to  <dig> molecules per chromosomal equivalent  <cit> . we estimate the genome size of e. coli ko11fl to be  <dig>  bp greater than its published chromosome size , yielding ≈  <dig> copies of the  <dig>  bp prk <dig> plasmid, in agreement with its known copy numbers. figure  <dig> also displays the genome size estimates of the five novel e. coli strains as sized by pfge demonstrating close agreement between the assessment of accuracy within a single species and across genome sizes of three orders of magnitude.

our method is most accurate when read coverage over the entire genome is relatively even, since it provides k-mer abundance spectra with mixed poisson distributions. one limitation in our approach is how well the proposed model can account for systematic errors in contemporary sequencing methods and still retain accuracy. uneven read coverage broadens the peaks in the k-mer abundance spectra, sometimes causing errors in the assignment of sequences to a particular read coverage. other factors that bias the k-mer abundance spectra include random sequencing errors and sequences derived from non-target dna. sequencing errors replace high-abundance sequences among reads with comparatively rare sequences creating many novel low-abundance k-mers. the fitting procedure implemented in kmerspectrumanalyzer is designed to exclude these low-abundance k-mers by applying a heuristic low-coverage cutoff. we tested whether the genome sizes of the five novel e. coli, as estimated by 21-mer abundance analysis, were affected by removal of read positions likely to contain errors. we applied a trimming algorithm that retained the longest contiguous read positions with a less than 10% likelihood of being incorrect . this trimming procedure had little effect on the estimates of overall genome size, which changed by a maximum of only  <dig> % . therefore, kmerspectrumanalyzer is sufficiently robust against sequencing error to negate any need for the pre-processing of read data for error mitigation.

the 21-mer abundance analysis described here would also be appropriate to the whole-genome shotgun sequencing datasets of eukaryotes of known ploidy. although a kmer length of  <dig> is sufficient to ensure sparse sampling for microbial genomes, greater values for k may be necessary for the largest eukaryotic genomes. however, genomes with more complex repeat structure and lower sequencing coverage depths, can present challenges to the estimation approach presented here..in principle, this 21-mer abundance analysis can be applied to any sequencing methodology; however, there are some additional limitations. extremely low coverage datasets  and datasets with very high error rates  contain insufficient sampling of the true k-mers to support numerical inferences. while numerical inferences are supported above 10× coverage depth, accuracy is compromised below about 75× coverage depth . among the four example datasets we tested, only the estimates for the owenweeksia hongkongensis dsm  <dig> reads  were relatively inaccurate between 75–400× coverage; however, it never differed by more than 4% from the completely assembled genome length. k-mer spectrum approaches can measure sequencing error, characterize heterozygosity, strain variation or mixtures of organisms  <cit>  within a sample in an annotation-independent, scalable way, and therefore, are applicable to a several sequencing applications, including the interpretation of metagenomic data sets and diagnosing technical aspects of the sequencing procedure.

CONCLUSIONS
sequence repeats severely hamper the assembly of most genomes, and these repeats continue to obscure genome structure even with the high read depths afforded by new sequencing technologies. we provide a simple and rapid means to resolve the repeat structure and total size of a genome by directly analyzing the abundance of distinct k-mers among short reads. by obtaining the genome size and repeat structure of environmental isolates of e. coli from 76-bp illumina reads, we demonstrate that the sensitivity of this method is great enough to resolve differences among bacterial strains. total genome size estimates corresponded well with those obtained for the same strains by long-range rflp mapping on pulsed-field gels. in addition, inferences of genome size from short-read datasets are not limited to strains within species but are accurate across a wide range of genome sizes from  <dig>  to  <dig> mb. the fitting procedure introduced here depends only on the k-mer spectrum, which summarizes the sequence redundancy of the data set but preserves none of the sequence content.

previous work on plants  <cit>  and humans  <cit>  has exploited k-mer indices of raw sequence data to make inferences about the genome structure, particularly about the frequencies and contents of repetitive elements. more current analyses based on high-throughput sequencing data have proposed a variety of heuristics for estimating genome size by identifying features in the k-mer spectrum  <cit>  or by using arbitrary cutoffs in the k-mer spectrum  <cit> . however, such approaches have failed to exploit the fact that repetitive sequences must occur at integer multiples of single copy sequences. by incorporating this information, our method implements a more biologically accurate model of the k-mer abundance distribution, adapting the procedure of  <cit>  to high-coverage , short-read sequences.

accurate estimates of total unique sequence from raw reads, as provided by kmerspectrumanalyzer, can also aid in the optimization of read assemblies. whereas the accuracy of an assembly is generally more important than its assembled length, the extent to which the total length of assembled contigs accounts for the actual length of the sequenced genome is a potential metric for the completeness of an assembly. the length of the target sequence is usually unknown, but it can be obtained directly from raw reads by 21-mer analysis, thereby allowing an absolute measure of assembly success. moreover, abundance distributions in k-mer spectra are also useful in identifying samples that are dominated by pcr artifacts, samples contaminated with sequencing adapters, and samples that contain mostly positive-control calibration genomes  without performing assembly or similarity searches.

we have observed that the reliability of many widely used statistics for summarizing the k-mer spectrum, including the number of unique k-mers, the fraction of k-mers that are unique, or the fraction of k-mers above an arbitrary or model-fitted threshold, are sensitive to changes in sampling depth. two summary statistics that appear to be stable descriptions of certain informative properties of the k-mer spectrum are  the rank order distribution of k-mers and  the cumulative fraction of the data consumed by rank ordered k-mers. in addition to genome repeat structure resolution, the kmerspectrumanalyzer package includes tools to visualize the rank-order distribution of k-mers and assist in understanding sequence datasets, even in cases where fitting the spectrum to a mixed over-dispersed poisson model fails.

whole-genome shotgun sequencing applies technologies that generate hundreds of millions of short reads and has recently become the most widely used tool in genome analysis  <cit> . we introduce a straightforward methodology that provides information about the repeat structure of genomes that is ordinarily missing from assemblies of short reads. this additional information offers new insights about genome diversity and evolution that can be gained through the analysis of novel datasets or through the re-analysis of the large volumes of archived short read.

