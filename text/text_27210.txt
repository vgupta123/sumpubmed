BACKGROUND
multiplex polymerase chain reaction , defined as the simultaneous amplification of multiple regions of a dna template or multiple dna templates through the use of multiple primer sets  in one tube, has been widely used in diagnostic applications of clinical  <cit>  and environmental microbiology studies  <cit> . the key step in running a successful multiplex pcr reaction is to design an optimal primer set combination . it is well known that for conventional pcr, the optimal ps has the following standards or properties: 1) primer size: 18- <dig> bp; 2) product size: 100- <dig> bp; 3) melting temperature  of both forward and reverse primers: 58-65°c, with a temperature difference of less than 3°c; 4) gc content of primers: 40-60%; 5) Δg  of the last five resides of the primers at the 3' end: ≥ - <dig> kcal/mol; etc  <cit> . however, there are several additional criteria which must be taken into account when considering multiplex pcr assay: 1) lack of primer dimerization between all of the primers; 2) similarity of the tms of each primer; 3) primer specificity to avoid mis-priming; and 4) constraint of electrophoretic mobility of the amplicons in order to separate and purify the dna fragments easily in agarose gel electrophoresis  <cit> . 

it has been proved by nicodeme and steyaert that determining minimum-set primers for multiplex pcr is an np-complete problem  <cit> . most of the current programs mainly focus on the issue of determining the minimum-set primers, such as mpp   <cit> , pda-ms/uniq   <cit> , g-primer   <cit> , and greene scprimer   <cit> . there are also other programs available for the design of primers in specific contexts. for example, primaclade  <cit>  designs minimally degenerate primers for comparative studies of multiple species. primique  <cit>  designs pcr primers specific for each sequence in a gene family. primerstation  <cit>  designs human-specific multiplex pcr primers by checking the entire human genome database. muplex  <cit>  utilizes a multi-node graph algorithm derived from a greedy algorithm to assign and partition single nucleotide polymorphisms  into multiplex-compatible tubes for snp genotyping. however, with the exception of primerstation, few of the programs mentioned above analyze the primer specificity against the genomic or transcript dna database. additionally, only a few of these programs provided a simple blast  <cit>  search against the database locally or the genbank database to examine the specificity of pcr primers  <cit> . for example, the only database used to check primer specificity in primerstation is the human genome database. moreover, few of the primer design programs constrain the amplicon size to allow separation and purification of the dna fragments in agarose gel electrophoresis when designing pscs for multiplex pcr. some programs simply define a fixed length  as the minimum size difference between the amplicons. however, the relation between an amplicons' size and their electrophoretic mobility in agarose gel electrophoresis is absolutely nonlinear  <cit> . for example, it is easy to separate two dna fragments of  <dig> bp and  <dig> bp in agarose gel  electrophoresis, but quite difficult to separate two amplicons of  <dig> bp and  <dig> bp in a similar gel. the electrophoretic mobility of the amplicons should be considered at the very beginning of primer design.

in this work, we developed a program named mpprimer to address these issues. it employs the widely used primer design program primer <dig>  <cit>  and the primer specificity evaluation program mfeprimer  <cit>  to design and evaluate candidate primers based on genomic or transcript dna databases, followed with primer dimerization examination to discard unsuitable primers. finally, a graph-expanding algorithm derived from a greedy algorithm was used to determine the optimal pscs for multiplex pcr. mpprimer then provides a virtual electrophotogram to help users choose the best pscs for multiplex pcr assay.

implementation
primer <dig> has been widely used for conventional pcr primer design. mpprimer utilized primer <dig> to design candidate pss for each of the dna template sequences. to ensure that the pss  in a multiplex pcr work efficiently in the same tube, the optimal parameters for the entire template sequences were used for primer design by primer <dig>  these parameters  are: tm , primer size , gc content , maximum 3' stability , maximum self-complementarity  and maximum 3' self-complementarity . it should be noted that, instead of using the default settings in primer <dig>  mpprimer uses the thermodynamics parameters suggested by santalucia  <cit>  to calculate gibbs free energy  and tm. for each template sequence, five candidate pss were designed by primer <dig> by default and ordered from a small to large penalty . one ps for each template was selected to create a complete psc for the defined template sequences. if the user inputs k number of template sequences, primer <dig> will design  <dig> × k pss in total and mpprimer will select k pss to construct a psc . in other words, a psc contains k number of pss, where each ps will specifically amplify its own target dna sequence.

to avoid primer dimerization, mpprimer examines each pair of primers in a psc using a dimer checking program named pridimercheck, which is part of the perlprimer source code  <cit> , with some modifications. the most significant modification we made was the criterion to determine the complementarity degree of two primers. we calculated the stability of complementarity using a nearest-neighbor method using thermodynamic parameters instead of the matching score, which is used in many programs such as autodimer  <cit>  and primer <dig>  checking primer dimerization based on thermodynamics is more quantitative and reliable than the matching score method  <cit> . mpprimer uses a stringent cutoff value of - <dig> kcal/mol to define a dimer in pridimercheck.

mpprimer uses the mfeprimer program to evaluate the specificity of the primers in a psc. in order to illustrate our specificity evaluation strategy, we used the terms tipf and tipr  to represent forward and reverse primers of template i, and tjpf and tjpr for primers of template j . there are two steps of specificity examination in mpprimer. the first step is to evaluate the specificity of primer pair  tipf and tipr  or primer pair of tjpf and tjpr . this is similar to conventional pcr primer specificity examination. the second step is to evaluate the nonspecific cross amplification, for example, between primer pairs of tipf and tjpf , tipr and tjpr , tipf and tjpr , or tipr and tjpf . all of these potential primer pairs are thoroughly examined by mfeprimer. if one of these six primer pairs  failed in the examination, the two pss  are not allowed to co-occur in a psc.

following dimerization examination and specificity evaluation, a scoring matrix is developed based on the pss examination results. if there is no dimerization and no nonspecific amplicons found between two pss, a value of  <dig> is assigned to these two pss, otherwise a value of  <dig> is set to generate the scoring matrix as shown in figure  <dig> 

choosing optimal pscs using a graph-expanding algorithm
we used a graph-expanding algorithm derived from a greedy algorithm to choose the optimal psc. in the graph model , a node represents a candidate ps and an edge represents a specific relationship between two pss. an edge connecting two pss indicates that they are able to work in one tube without any interference or competition to produce nonspecific amplicons. after the first two pss  are linked together by one edge , another node is found and added to this graph to join to two new edges . whether two nodes can be connected is based on the primer dimerization and specificity evaluation results, which is displayed in the scoring matrix . by repeating this procedure, we can extend the graph to give it sufficient nodes to create a candidate psc . because the pss designed by primer <dig> are sorted by the penalty values , our graph-expanding strategy changed from randomly selected nodes  <cit>  to the nodes with lowest penalty. thus, the program finds the optimal psc, as opposed to choosing a random one, without requiring additional pscs sorting time. the scoring matrix makes sure that the pss in a psc are compatible. for n ×  <dig> nodes  in the graph, pre-computing and storing the scoring matrix would require o time and space.

when searching pscs, a constraint condition called minbs  has to be satisfied. this artificial condition is defined as the minimum electrophoretic migration distance of the amplicons in 1% agarose gel electrophoresis and should be greater than a certain distance so that the dna bands can be easily distinguished by the naked eye for purification.  

where positioni and positionj represents the electrophoretic mobility of the two dna amplicons  amplified by the psc. the formula used to predict the electrophoretic mobility of amplicons was reported by helling et al.,  <dig>  <cit> .

RESULTS
we provide both a web application and a stand-alone version of mpprimer for different purposes. the mpprimer web application is conveniently designed, with a friendly interface, while the stand-alone version is applicable to high-throughput multiplex pcr primer design with supporting comprehensive, custom-built databases in order to meet specific user demands. after inputting a set of template dna sequences in fasta format, mpprimer will design and output the best  <dig> pscs by default in a user-friendly format. besides the binding pattern of the primers and their template sequences, the detailed specificity evaluation results of mfeprimer are also provided. in addition, for the pss of each psc, users can then re-run the sequences on pridimercheck and mfeprimer to view the results of possible primer dimerization or nonspecific amplifications with stricter ncbi blast parameters such as using a lower word size  and larger e value  to improve the sensitivity. notably, mpprimer also provides a function to generate the virtual agarose gel electrophotogram for each psc to give users a visual impression before running the real multiplex pcr reaction .

because the purpose of mpprimer is to design an optimal psc that can specifically amplify the target dna sequences without nonspecific amplification or primer dimerization, it is useful for designing primers for dna template sequences without high sequence similarity. however, mpprimer does provide an alternative way to design primers for highly similar sequences  by allowing users to specify the region of primer location for each dna template sequence. this requires users to first run a multiple alignment for the sequences to find the nonconserved region before designing primers using mpprimer.

to examine the performance of mpprimer, we designed a psc comprising  <dig> pss  to amplify five mouse genes  in one tube as a typical multiplex pcr reaction. the result of the real experiment was nearly the same as that predicted by the virtual agarose gel electrophoresis analysis . the homepage of mpprimer describes the detailed information of the experiment including the templates sequences, primer sequences, and the pcr and electrophoretic conditions. as another example, we have successfully used mpprimer to design the multiplex pcr primers for dmd , which has  <dig> exons, for 20×, 20×, 20×, 14×, and 5× plex pcr reactions in five tubes to detect underlying exon deletions .

although designing minimum-set primers can save cost and time by reducing primer synthesis demand  <cit> , it is crucial to design specific pss, especially at the genomic or transcript level, to perform multiplex pcr with high reliability  <cit> . mpp  <cit> , pda-ms/uniq  <cit> , g-primer  <cit>  and greene scprimer  <cit>  are mainly concerned with the problem of minimum-set primers. primerstation  <cit>  designs specific multiplex pcr primers only by checking the entire human genome database, but this database is too limited. the mpprimer web application supports transcript level specificity evaluation for more than ten species, while the stand-alone version can support any dna sequence database, even the large genomic dna database. muplex  <cit>  and mpp  <cit>  simply use blast  <cit>  to check primer specificity, but this is insufficient. moreover, several other conditions such as tm were not considered  <cit> . primaclade  <cit>  and greene scprimer  <cit>  are used for degenerate primer design, while primique  <cit>  focuses on designing specific pcr primers for each sequence in a gene family. however, none of these programs provide the function for predicting the electrophoretic mobility of the amplicons from multiplex pcr reaction  <cit> . muplex  <cit>  and mpprimer use a very similar algorithm to find psc in a graph where nodes are pss and edges connect compatible pairwise pss for multiplex pcr. the difference between them is that mpprimer selects nodes which have a lower penalty  rather than random ones. therefore, mpprimer can find the optimal psc without enumerating and sorting all the pscs to find the optimal one. it should be noted that, as our graph-expanding model is based on the preselected candidate primer sets , the output pscs are not global but only local optimal. in another aspect, the running time of mpprimer is incomparable to other programs, because the specificity examination by mfeprimer requires more time for sequence similarity analysis between the primer sequence and the genomic or complementary dna database of the same species. therefore, the mpprimer web application currently only supports transcript level specificity examination. however, the stand-alone version of mpprimer supports unlimited databases, such as the genomic dna database, which mainly depend on the user's computing capability.

our further plans are to: 1) automatically analyze and design primers for amplifying different transcript variants for alternative splicing analysis of a single gene; 2) provide an alternative solution, should mpprimer not find suitable primers for a set of template sequences in one tube, by suggesting two or more tubes for one pcr reaction.

CONCLUSIONS
we developed a new program named mpprimer with both a web application and a stand-alone version to help users design highly reliable pss for multiplex pcr assay. the web application is easy-to-use with a friendly interface, while the stand-alone version is applicable to high-throughput multiplex pcr primer design with the support of comprehensive custom-built dna sequence databases. with the help of mpprimer, users can design reliable primer set combinations for multiplex pcr analysis.

availability and requirements
• project name: mpprimer

• project home page: http://biocompute.bmi.ac.cn/mpprimer/

• operating system: the web application is platform independent and the stand-alone version runs on linux/unix.

• programming language: python

• other requirements: python ≥  <dig> 

• license: gnu gpl v 3

• any restrictions to use by non-academics: license needed

authors' contributions
zs and wq wrote the main manuscript and did the most of the programming. ww carried out the multiplex pcr experiment. yl helped to optimize the algorithm. yw analyzed the agarose gel electrophoresis to determine the electrophoretic mobility of the amplicons. zl and xh participated in programming and debugging. xw and dz implemented the web server construction. cz designed and supervised the study, finalized the manuscript. all authors read and approved the manuscript.

