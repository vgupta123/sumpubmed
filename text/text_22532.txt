BACKGROUND
visual analysis of cell samples has played a dominant role in the history of biology. the scientific community has only begun to scratch the surface of computationally extracting the rich information visible in fluorescence microscopy images of cell samples  <cit> . this capability is increasingly important given the ease now to systematically perturb cells with libraries of chemicals or gene-perturbing reagents like rna interference or gene overexpression and collect hundreds of thousands of images of these cell samples  <cit> . we recently developed open-source image analysis software, cellprofiler, which measures a rich set of cellular features in images, such as size, shape, and staining patterns including intensity, texture, and colocalization  <cit> . this tool has been useful for extracting image-based measurements to score sophisticated screens  <cit> , with many more in progress.

the volume and richness of individual-cell data from large image-based screens is unprecedented and existing software is inadequate for the challenge of data analysis. for analysis of small or very simple experiments, spreadsheet programs like microsoft excel are sufficient, and useful open-source tools exist for analysis and exploration of data from high throughput screens in general  <cit> . existing software packages targeted for image-based screening, however, have one or more limitations which prevent sophisticated visualization and extraction of information from image-based screens:  they are not designed for the hierarchical data structure inherent in image-based data ,  they ignore the inherent biological variability of cell populations such that assays requiring subpopulation analysis cannot be scored,  they cannot handle the volumes of data typical in image-based experiments ,  they provide limited linking to raw or processed image data or chemical structure data,  they allow only limited statistical analyses of the data,  they are proprietary and new methods cannot be easily added,  they are limited to data from a particular image analysis package,  they require expertise in statistics or programming, and/or  they require intense hands-on data management.

given that no existing tools meet the specific needs of image-based screens, researchers have needed computational expertise to directly query databases of image-based information using command-line tools. often, the researchers best able to explore and interpret the data lack these computational skills. these researchers are therefore less likely to make serendipitous discoveries  in their image-based screens, which inherently contain enormous amounts of information beyond that which is pertinent to the original, intended biological question. it is critical to provide exploration tools to screening researchers, tools that employ their understanding of the experiment in question and their creativity and ability to recognize and interpret patterns and relationships within data. these capabilities flourish when united with a computer's unique ability to store, retrieve, display, and quantitatively analyze billions of data points.

we therefore sought to develop a software system that would make high-dimensional image-based data exploration feasible for researchers who lack computational skills, and flexible for computer scientists who want to develop and add advanced new methods for image-based screening, such as machine learning-based phenotype scoring. we describe here the result of our work, an open-source software package called "cellprofiler analyst".

RESULTS
viewing data
four types of plots are the starting points for exploration of large, multi-dimensional image-based screens in cellprofiler analyst . importantly, these tools are compatible with the scale of data typically acquired in image-based screens, which can be hundreds of features for each of hundreds of millions of cells. histograms display the distribution of values for one measured feature by grouping image or object data into evenly spaced bins, on a linear or logarithmic scale . such plots can be helpful, for example, to examine the cell cycle status of samples  or to examine outliers for quality control purposes . two measured features per image or object can be displayed on the same chart via a scatterplot , which is also useful for identifying hits and for quality control purposes. for example, the researcher can readily exclude out-of-focus images from analysis based on measurements made by cellprofiler's "measure image quality" module. because data points in scatterplots can occlude each other, they are typically unsuitable for individual cell data where hundreds of millions of data points are examined to identify interesting subpopulations. for these cases, a density plot is more appropriate . every pixel in the plot represents a histogram "bin" and the color of the pixel represents the number of data points in the bin. these plots are useful, for example, for establishing thresholds at which to classify individual cells as "positive" or "negative" based on two features . to explore more than two measured features of each image or data point, a parallel coordinate plot is used. parallel coordinate plots  <cit>  allow analysis of multiple dimensions of data, whereby each measured feature's scaled  values are given a separate y-axis and individual data points are connected across these multiple axes .

each data point in a plot can represent an individual cell or, by contrast, the mean value of the population of cells within an image. data can also be grouped by characteristics the samples have in common . multiple experiments that investigate the same set of treatment conditions  can be grouped together, which eases analysis of replicates. for all types of plots, the data to be displayed can be filtered, for example to plot data only from a single image, from a sample of data points at specified equal intervals, or data that satisfies certain criteria .

exploring relationships among data
data points selected and highlighted in one plot are immediately highlighted in all other open plots  such that a sample or set of samples can be examined in the context of other sets of samples . this allows, for example, the comparison of measurements from samples of interest vs. all samples in the experiment. brushing helps the user to more easily examine relationships in the data, especially when the data has a large number of attributes or items, when the data spans multiple experiments , or when it is natural to examine different parts of the data using different views. the brushing concept is extended in cellprofiler analyst for situations where multiple experiments are being simultaneously explored: when a point corresponding to a particular image is highlighted, all points corresponding to that experimental treatment condition can be highlighted, even if the data comes from multiple experiments that are being examined together. in the scatterplot in figure 1b, for example, four data points are blue because one was originally selected and the user requested that replicates for that sample be highlighted.

investigating data
interesting data points or sets of data points can be investigated by drilling down into the data in several ways . for plots showing data points representing image measurements, a data point or set of data points can be selected and the original images that produced the data point can be displayed . this can reveal artifacts in sample preparation or imaging, such as fluorescent test compounds, aggregates or overabundance of staining reagents, fibers, or debris . these artifacts not only occlude actual cells in images but can also disrupt the proper identification and measurement of remaining cells in the image. for these and other reasons, images showing identification outlines resulting from image analysis  can also be shown for selected data points , to identify whether the identification of cells occurred properly. this is an important consideration given that no segmentation algorithms are flawless.

additionally, a data point or set of data points can be selected and a plot of the measurements of individual cells that were present in those images can be displayed as a separate subplot. this allows, for example, a dna content histogram indicating cell cycle distribution of the cell population to be displayed for a particular image or set of images of interest . to investigate the identity of interesting samples, a simple list of the treatment conditions that produced a set of data points can be displayed to get an overview . for further investigation, web-based information about each image's treatment condition can be launched in an external web browser , if web addresses associated with each sample are stored in the database. all available measurements and other information for a particular sample can be displayed in a simple table and saved as a comma-delimited text file for analysis in another software package .

gating individual cell data to score complex phenotypes
image-based data is tremendously valuable in that multiple single-cell measurements are available. responses of individual cells to a treatment are usually inhomogeneous because of cell cycle variations or differences in protein levels due to memory or stochastic noise  <cit> . in many cases, a single measured feature  can be used to score individual cells and the only challenge is to identify a suitable threshold for scoring positive cells. this can be accomplished in cellprofiler analyst using histograms of individual cell data. for complex phenotypes, several features of each cell may be required for effective scoring. in these cases, a density plot showing individual cells  can be useful for identifying interesting cell subpopulations, by delineating a section of the plot . whether the gate contains the cells of interest can be tested using two features: the "show object montage" feature to see what individual cells within the gate look like , and the "show image" feature to see whether cells within a particular sample are appropriately marked as inside or outside the gate . once the final, desired subpopulation of cells is gated, the number of cells that fall within that subpopulation is calculated for each image, for further statistical analysis . as an example, when dna and phosphorylated serine  <dig> of histone h <dig> are both stained, a simple two-feature gate in cellprofiler analyst enables scoring mitotic subphases in human ht <dig> cells . many software systems perform image analysis on the fly during image acquisition; in such cases, a threshold value for a feature of interest must be chosen in advance to score the screen. by contrast, these tools in cellprofiler analyst allow testing the efficacy of scoring based on different features and different measurement thresholds.

if more than two features are needed to score a phenotype, sequential gates can be used upon the cell data. this approach is applied as follows:  display the entire population of cells from an experiment in a density plot,  draw a gate around the data points representing potential cells of interest,  adjust the gate to include nearly all positive cells and exclude as many negative cells as possible,  plot the resulting gated subpopulation in a new density plot with two new measurement features as axes,  gate the subpopulation again based on these new features, and  calculate the percentage of each image's cells that fall within the final gate.

case study: mitotic subphase screen
motivation
we wanted to test cellprofiler analyst's ability to plot, explore, and filter individual cell data to identify subpopulations defined by several morphological features. we chose to identify drosophila melanogaster kc <dig> cells in telophase and metaphase of the cell cycle, using only a dna stain. identification of samples with perturbed cell cycle regulation is of clear importance to normal cell biology as well as cancer studies. regulators of the cell cycle have been sought intensively for decades via traditional and high-throughput screens for changes in overall cell cycle distribution or for increased phospho-histone h <dig> staining, a marker of cells in late g <dig> and m phase . we reasoned that additional genes might exist which, when perturbed, yield increased numbers of metaphase- or telophase-stage nuclei without substantially affecting the overall mitotic index  or cell cycle distribution. while we were not aware of any positive controls with such a phenotype, we suspected such genes might have been previously overlooked because we noticed that not all metaphase nuclei stain brightly for phospho-histone h <dig> , for unknown reasons. identifying genes whose rnai produces cells appearing to be in particular subphases of mitosis, regardless of concomitant phospho-histone h <dig> staining, would be a first step towards understanding these phenomena.

several groups have tested automated methods for scoring mitotic subphases  <cit> ; these studies were accomplished by computational tools tailored to the specific assay and often relied on multiple cellular stains. machine learning methods have been explored by our own group and others  <cit>  , but we also wanted to explore allowing the user to manually select a small number of features of known biological relevance, followed by sequential gating on those features. this would give the researcher full control over the features used in the scoring, and the scoring would be more readily transferable from one experiment to the next because a small number of features are selected. we therefore wanted to score mitotic subphases using a dna stain only, using supervised selection of measurements followed by sequential gating on those measurements, in the context of a software package usable by a non-computer scientist.

image scoring by sequential gating of individual cell data
we screened genes using drosophila rna interference living cell microarrays  <cit>  to identify gene "knockdowns" that yield a disproportionate number of cells in two sub-phases of mitosis: metaphase and anaphase/telophase . we created and analyzed  <dig> replicates of a drosophila array, with  <dig> spots of dsrna on a single microscope slide , including three replicate spots for each of  <dig> genes , plus  <dig> negative control spots lacking dsrna. some phenotypes produced in these drosophila kc <dig> cells  are visible at low resolution , but to identify telophase and metaphase nuclei we collected individual high resolution images within each spot on each slide .

we began with the telophase phenotype. to determine which measured cellular features would be most effective for scoring, we handpicked representative telophase nuclei and normal g2-phase nuclei from random screening images and created image montages for these two classes  using adobe photoshop. we used cellprofiler to measure nuclear features in these montage images, then exported the results to excel and selected five features to use for sequential gating, based on a combination of biological intuition plus the quantitative ability of each feature to discriminate telophase from normal nuclei, using simple statistical tests in excel. the selected features included dna content, intensity, shape, and texture features .

we then interactively developed sequential gates using density plots of these features in cellprofiler analyst . to accomplish this task, cellprofiler was used to process the full set of screening images and load the resulting data into a database . this allowed us to display all individual cells in the experiment in an initial density plot with two of our selected features as axes, i.e., dna content and size  of the nucleus. we drew an initial gate around the 2n dna content peak and small nuclear area, and empirically refined the gate for telophase cells by examining images of the gated nuclei and adjusting the gate's boundaries accordingly. while automated approaches could certainly identify a boundary based on a researcher-provided training set, this manual approach allows the biologist to specifically assess many cells near the relevant boundaries. once the appropriate gate was selected for the initial density plot, the subpopulation was transferred to a new density plot with two new features used as axes and the next gate was created, again finding the optimal parameters to distinguish telophase nuclei from all other nuclei. this procedure was repeated for the fifth, and final, selected feature. once the final gate was refined, we applied the sequential gates to a new set of images and confirmed that their scoring was effective , successfully differentiating telophase from other nuclei. in creating the gates, we tried to minimize the false positive rate while accepting a higher false negative rate . we reasoned that true hits would have enough positives to overcome this intentionally stringent selection procedure. at this point, we applied the final sequential gates to all the cells in order to score the entire screen for the telophase phenotype. we found that the gates must typically be adjusted slightly between different replicate slides due to inter-experiment variability , although experiment-to-experiment normalization methods could be explored to reduce this effect.

ten randomly selected images from the screen  were scored by cellprofiler analyst and by two observers.

we separately performed the same procedure for the metaphase phenotype ; a complete list of the  <dig> genes tested and their scores for telophase and metaphase is shown in additional data file  <dig> 

telophase analysis
rank-ordering samples by the percentage of telophase nuclei revealed  <dig> gene knockdowns with a significant increase in telophase nuclei . validating the approach, two of the genes are pp2a complex subunits that have been previously associated with mitosis: the pp2a-c catalytic subunit mts  and a pp2a-a family regulatory subunit . rnai against both genes increased the percentage of cells that were phospho-histone h3-positive . a third hit, ck1α , has also previously been linked to mitosis . we noticed that its knockdown by rnai produced nuclei whose chromatin appeared to be slightly less condensed than typical telophase nuclei , while still more condensed than interphase nuclei. the percentage of cells that were phospho-histone h3-positive was normal . together, these observations suggest that this defect occurs in late-stage telophase/anaphase. the fourth hit was a predicted kinase with no functional annotation . visual inspection revealed that nearly all nuclei in these samples appeared brighter and more compact than controls, a subtle but reproducible effect . this understandably resulted in more of the 2n nuclei being counted as having telophase-like morphology. we found that these cells were not enriched for phospho-histone h3-positivity ; without further experimentation, it is unclear whether this is a true late-stage mitotic phenotype or rather a condensed nuclei phenotype.

metaphase analysis
interestingly, the only metaphase hit in this screen  is the b'/b <dig> subfamily regulatory subunit of pp2a , which at the time of our screen had not been linked to cell cycle regulation. the percentage of cells that were phospho-histone h3-positive was not much higher than normal . we confirmed by eye the metaphase-inducing phenotype of widerborst knockdown in the original images and in separate experiments with two other dsrnas, including one that was non-overlapping with the original . widerborst is an essential gene involved in planar cell polarization  <cit>  and apoptosis  <cit> . notably, in other contexts  widerborst is indirectly linked to the b/pr <dig> subfamily member twins/aar, which is itself known to be required for metaphase to anaphase transition  <cit> . our work therefore confirms, with non-overlapping dsrnas, a recently reported cell cycle regulation role for widerborst  <cit>  and together indicates that it is unlikely this phenotype is due to off-target effects  <cit> .

the closest human homolog of widerborst is ppp2r5e, the epsilon isoform of a subfamily of pp2r <dig>  regulatory subunits of the pp2a complex. as yet, no particular function has been associated with ppp2r5e. we wondered whether ppp2r5e might be a b' regulatory subunit that modulates the known role for pp2a in mitosis, given our finding of its homolog widerborst's role in drosophila. ppp2r5e knockdown did not increase the mitotic index significantly in recent rna interference screens for increased phospho-histone h <dig>  <cit> . however, when we scored these same ppp2r5e-knockdown images for metaphase morphology, rather than phospho-histone h <dig> levels, we discovered a metaphase-arrest phenotype for ppp2r5e knockdown, confirmed by two different shrnas , consistent with the phenotype seen for widerborst in drosophila. whether widerborst/ppp2r5e are themselves required for metaphase-to-anaphase transition or whether their depletion causes the phenotype by specifically disrupting the stoichiometry of the relevant pp2a complex remains to be determined. recent findings that ppp2r5e localizes to centromeres and that the b' subfamily of regulatory subunits are required for proper meiotic sister chromatid separation in fission and budding yeast  <cit>  support the idea that this family of subunits is indeed important for proper chromatin dynamics during cell division.

CONCLUSIONS
we have described here a software system for exploration and analysis of large, hierarchical, multi-dimensional data sets. while it is compatible with any type of data , it is particularly capable of high-end exploration and analysis of measured features from high-throughput image-based screens for both quality control and identifying hits in a screen. researchers are welcome to download the java source code and add new types of plots and analysis tools  to the system.

we have demonstrated the utility of this software for interactive data exploration and analysis – especially for intentionally selecting cells with particular measurement values in order to score complex visual phenotypes. of course, often the features that successfully specify a particular phenotype are either unknown or so numerous as to make the sequential plotting shown here impractical, and choosing decision boundaries empirically may not be optimal to score the phenotype. for these reasons, we recently added machine-learning methodology to cellprofiler analyst . nonetheless, the complete control over features and thresholds offered by sequential gating is quite useful in some cases. often a researcher needs to ignore certain features of positive control cells  and emphasize other, better-understood cellular features. interactive observation of the original cellular images while making gating decisions to define a phenotype also leverages the biologist's intuition about a phenotype. within the same open-source software infrastructure, both approaches  can now be applied to large-scale imaging screens.

availability and requirements
* project name: cellprofiler analyst

* project home page: 

* operating systems: platform independent 

* programming language: java

* other requirements: java  <dig> . <dig> or greater. for full functionality, cellprofiler analyst requires java  <dig> .0_ <dig> or greater, python version  <dig>  or greater  and the numpy python package .

* license: gnu general public license, version 2

* no additional restrictions to use by non-academics

