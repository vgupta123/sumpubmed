BACKGROUND
understanding the origin of novel and beneficial traits — evolutionary adaptations and innovations — is a challenge central to biology. an underappreciated source of such traits are latent phenotypes, by-products of already existing adaptive phenotypes. while themselves neither adaptive nor maintained by natural selection, such latent phenotypes can become sources of novel adaptations in the right environment. in other words, they can become exaptations  <cit> . prominent examples of latent phenotypes are those of promiscuous enzymes  <cit> , which have one primary, adaptive catalytic activity, and one or more latent activities. for example, in escherichia coli the primary activity of the enzyme aspartate aminotransferase is to transaminate dicarboxylic substrates. however, this enzyme can also transaminate tyrosine and phenylalanine, side-activities that can be increased by over 100-fold via directed evolution  <cit> . such promiscuous enzymes are not rare. for example, of  <dig> enzymes analyzed in e. coli, 37% were found to be promiscuous  <cit> . latent phenotypes may also exist in rna, which can form multiple secondary structures through thermal motion  <cit> , as well as in metabolic networks of chemical reactions, which can be viable on carbon sources without prior selection for such viability  <cit> .

an important source of evolutionary adaptations are gene regulatory circuits. they are responsible for innovations as diverse as the eyespots of butterflies  <cit> , the vertebrate limb  <cit> , and the body plan of insects  <cit> . part of the reason is that these circuits have functions in various processes of embryonic development and physiology, including the interpretation of morphogen gradients during embryogenesis in fruit flies  <cit> , chemotaxis in bacteria  <cit> , and circadian rhythms in organisms as different as fungi and mice  <cit> . such functions are embodied in a circuit’s spatiotemporal gene expression phenotype and can often be realized by a large number of different circuits  <cit> .

gene regulatory circuits are often multifunctional. examples include the segment polarity network in drosophila melanogaster, which guides several distinct developmental processes, including denticle patterning and the specification of neuroblasts  <cit> , the circuit controlling antitoxin production in e. coli, which mediates the cellular state between growth and dormancy  <cit> , the lysis-lysogeny switch of bacteriophage lambda, which determines the viral life cycle  <cit> , and the white-opaque switch of candida albicans, which governs numerous cellular phenotypes including metabolic preferences and pathogenicity  <cit> . experimental  <cit>  and theoretical  <cit>  studies hint that gene regulatory circuits harbor latent phenotypes because their gene expression patterns often vary when a circuit is exposed to distinct external stimuli. for example, natural  <cit>  and synthetic  <cit>  regulatory circuits can produce unique gene expression patterns in response to distinct combinations of signals endogenous to a cell. similarly, the equilibrium expression patterns of model regulatory circuits often differ between initial conditions  <cit> .

experimental work can provide examples of latent phenotypes that exist in any one circuit, but cannot elucidate how frequent latent phenotypes are in gene regulatory circuits in general. this can only be achieved by examining a large number of circuits, a task that is not feasible using existing experimental technologies  <cit> . thus, any such work must rely on computational models. here, we study the incidence of latent gene expression phenotypes in a broad class of model gene regulatory circuits that are highly successful in capturing biological phenomena  <cit> . these circuit models comprise small sets of genes whose ability to turn one another on and off in response to external stimuli is determined by a circuit genotype. the regulatory interactions specified by this genotype allow a circuit to form different patterns of gene expression that constitute a circuit’s phenotype and embody its function.

specifically, we here build upon our previous work, which exhaustively characterized the gene expression phenotypes  of all  <dig> , <dig> possible three-gene circuits  <cit> . this work uncovered several salient features of circuit multifunctionality. first, multiple different circuits — a large genotype set of circuits — are capable of performing any given number of k functions, and the size of this set decreases exponentially as k increases. second, the genotype set of circuits with any single function always forms a single connected network of genotypes — a genotype network — in the space of all circuits, implying that these circuits are reachable from one another via a series of small genotypic changes that preserve circuit function. third, genotype sets of circuits with more than one function typically fragment into several genotype networks that are disconnected, indicating that such circuits are often mutationally isolated from one another. these observations provide insight into how multifunctionality constrains the size of genotype sets and affects the ability to evolve additional functions, but they do not speak to the existence of latent gene expression phenotypes in these circuits. we here quantify such latent phenotypes exhaustively and answer several questions about them. how many  latent phenotypes do monofunctional circuits harbor? how many latent phenotypes are collectively harbored by a set of circuits with a given number of functions? does a circuit’s location in a genotype network indicate the number of latent phenotypes it has?

RESULTS
the model
the model circuits we consider have n =  <dig> genes  and are encoded by a genotype that specifies both the topology or “wiring” of the circuit and each gene’s signal-integration logic, i.e., how the gene’s regulatory region integrates signals from other genes to determine the gene’s expression state. we represent this genotype with a binary genotype vector g of length l = n × 2
n
 . one can think of changes in g as mutations in the cis-regulatory regions that determine a circuit’s topology and signal-integration logic  <cit> . they include mutations that alter the affinity of a transcription factor binding site, its distance from the transcription start site or from another transcription factor binding site, as well as mutations that result in the gain or loss of a regulatory interaction  <cit> . such mutations may lead to changes in a circuit’s interpretation of the regulatory state of the cell, thus altering the circuit’s gene expression pattern  <cit> .

genes in our model circuits can be in one of two states, expressed  or not expressed . each circuit is initialized with an expression state s <dig>  which represents regulatory influences from outside of the circuit, such as signals from the environment or from a higher level in an organism’s regulatory hierarchy  <cit> . starting from this initial state, the expression state of each gene can change through the influence of the expression states of its regulating gene products and its signal-integration logic. the circuit’s gene expression state eventually converges on an equilibrium gene expression pattern s
∞
 with period p, which can be a fixed-point  or periodic .

regulatory circuits that control developmental and physiological processes often do so via fixed-point gene expression patterns  <cit> . examples include the circuits controlling the interpretation of morphogen gradients in the early drosophila embryo  <cit>  and floral organ specification in arabidopsis thaliana <cit> . we thus consider the phenotype or function of a circuit to be an initial state paired with the fixed-point equilibrium state that a circuit attains through its gene expression dynamics when starting from this initial state, i.e., f =  . since there are 2
n
 distinct initial states, a circuit can have up to 2
n
 such functions f…f, as long as each initial state maps uniquely to a fixed-point equilibrium expression state ≠s∞ for all i,j). in the parlance of dynamical systems theory, such circuits can be said to display multistability on a subset of the state space.

despite its many abstractions, this modeling framework has provided important insight into both general and specific properties of gene regulatory circuits. for example, it has been used to understand the influence of various facets of circuit topology on the robustness of gene expression patterns to genetic perturbations  <cit>  and on the ability of circuits to adapt to novel environmental conditions  <cit> . moreover, variants of the model have been used to predict the expression dynamics of the genes involved in  specifying the endomesoderm and skeletogenic spatial domains in the embryo of the sea urchin strongylocentrotus purpuratus <cit> ,  modulating the expression of the tumor suppressing protein p <dig> in human breast cancer cells  <cit> , and  controlling circadian oscillations in the fungus neurospora crassa and the plant a. thaliana <cit> . we choose boolean logic circuits as our modeling framework because of their ability to capture both general and specific properties of gene regulatory circuits and because they allow us to study and alter both a circuit’s wiring diagram and its signal-integration logic.

circuits with multiple phenotypes or functions are not unusual. for example, the circuit controlling the lysis-lysogeny decision in bacteriophage lambda is bifunctional, while the circuit controlling the patterning of the neural tube in vertebrates is trifunctional, because it produces three spatially distinct ventral progenitor domains  <cit> . it is important to note that our knowledge of multifunctionality in biological circuits is limited to those conditions that have been tested experimentally, which most likely represent only a subset of the environmental and regulatory cues experienced by a circuit. the preceding estimates of multifunctionality in biological circuits should therefore be considered as a lower bound. in contrast to biological circuits, it is possible to comprehensively probe the functionality of synthetic circuits. examples where this has been accomplished include the bifunctional circuit that selectively induces apoptosis in cancer cells  <cit>  and the quadrifunctional circuit that serves as a combinatorial “decoder” in human embryonic kidney cells  <cit> . we here use the terms monofunction, bifunction, trifunction, etc. to indicate the number of functions in a circuit. more generally, we call any set of more than one function a multifunction and a specific set of k functions a k-function.

multiple circuit genotypes may have a given k-function, and we refer to the collection of such circuits as a genotype set, which may comprise one or more genotype networks <cit> . in addition to its k-function, each circuit in a genotype set may also have one or more latent phenotypes, potential exaptations which we define as an equilibrium expression pattern s
∞
 that is not part of the circuit’s k-function . we do not require the latent phenotype to be a fixed-point expression pattern  nor do we require it to be realized under a specific initial condition s <dig>  because it is not possible to determine a priori which form of expression pattern  might become beneficial for the survival of the organism, nor which initial condition might exist to facilitate its formation . biologically important non-fixed-point equilibrium expression patterns include the genetic oscillators that control circadian rhythms  <cit> , segmentation clocks  <cit> , and the cell cycle  <cit> .

in a previous contribution, we exhaustively enumerated the genotype-phenotype  map of all 2
l
 = 224 =  <dig> , <dig> possible circuit genotypes for all 2
n
 =  <dig> initial states of circuits with n =  <dig> genes, revealing a total of  <dig>  unique k-functions  <cit> . here, we study the circuits with these k-functions in more detail, focusing on their latent phenotypes.

monofunctional circuits typically have latent phenotypes
there are  <dig> possible monofunctions, and we previously found that these monofunctions exhibit two prominent features  <cit> : their genotype sets comprise many  genotypes that are part of a single genotype network and the number of genotypes in this network is independent of the specific monofunction — it depends only on whether the initial and equilibrium states are the same  or different . building on this work, we analyzed each of the  <dig> possible monofunctions systematically, and first asked whether their constituent genotypes had latent phenotypes and if so, how many. to answer these questions, we calculated the number of latent phenotypes f per genotype, which we computed as the number of new equilibrium expression patterns s
∞
 the genotype can realize under initial conditions that are not part of its function . figure  <dig> shows the proportion and number of genotypes with f latent phenotypes among circuits with the two types of monofunctions. remarkably, for both types of monofunctions, there are more genotypes with one latent phenotype than with no latent phenotypes. overall, 88% percent of circuits with an identity mapping and 61% percent of circuits with a transition mapping have at least one latent phenotype. in other words, latent phenotypes are the rule rather than the exception among monofunctional circuits. while the number of genotypes with f latent phenotypes decreases exponentially as f increases , there are hundreds of thousands of circuits with more than one latent phenotype. additional file 1: figure s <dig> shows a nearly identical trend for latent fixed-point phenotypes. to illustrate the types of latent phenotypes that are observed in these circuits, additional file 1: figure s <dig> shows the proportion of latent phenotypes that are fixed-point and periodic for identity and transition monofunctions.

next we determined how many latent phenotypes were harbored in the genotype sets of the  <dig> possible monofunctions. specifically, we considered all of the circuits with a given monofunction and calculated the size of their latent repertoire, i.e., the number of unique latent phenotypes that these circuits collectively harbor. we found that the size of a monofunction’s latent repertoire depends only on the type of monofunction . of the  <dig>  possible equilibrium expression patterns of three-gene circuits , circuits with any one identity mapping had a latent repertoire of  <dig>  phenotypes, whereas circuits with a transition mapping had a latent repertoire of  <dig>  phenotypes. in the supporting online material, we provide a combinatorial explanation for the observation that latent repertoire size depends only on the type of monofunction. we emphasize that all circuits with a given monofunction are accessible from one another through a series of small genotypic changes that do not affect the monofunction, because the genotype set of each monofunction consists of a single connected genotype network  <cit> . this means that all latent phenotypes accessible from some circuit with a given monofunction are reachable through gradual evolutionary change.

finally, we determined the extent to which latent repertoires varied among monofunctions. to do this, we considered each possible pairing of monofunctions and calculated the number of latent phenotypes that were present in the intersection and union of their latent repertoires. we then divided the former number by the latter to provide a fractional measure of similarity between latent repertoires. we found that this fraction is typically very small , meaning that monofunctions share few latent phenotypes . this indicates that a circuit’s primary function severely constrains the spectrum of accessible latent phenotypes.

latent repertoire size increases with genotype set size
we have found that the latent repertoire size increases with genotype set size for monofunctions. we next asked whether this is also the case for multifunctional circuits, i.e., we extended our analysis to include all  <dig>  k-functions. figure  <dig> shows that k-functions with larger genotype sets also have larger latent repertoires . for example, the smallest genotype sets contain only a single genotype and these have no latent phenotypes, while the largest genotype set has over two million genotypes, and these circuits collectively have thousands of latent phenotypes. notably, every k-function with more than one circuit in its genotype set has at least one latent phenotype. thus, while it is possible that an individual circuit does not have a latent capacity for exaptation , there always exists another circuit with the same k-function that does have such a capacity, so long as the k-function’s genotype set comprises more than one circuit. similar results are observed for latent fixed-point phenotypes, although the latent repertoire sizes are necessarily reduced . to further illustrate the properties of latent phenotypes, additional file 1: figure s <dig> shows the number of transient states encountered in the trajectory from initial to equilibrium state.

the step-like shape of the trend in figure  <dig> hints that the latent repertoire size may depend on qualitative features of a k-function. indeed, the inset of figure  <dig> shows that the number of unique states in the k-function uniquely determines latent repertoire size. for example, the latent repertoire sizes of the monofunction f:〈 <dig> ,0〉↦〈 <dig> ,1〉 and the bifunction f:〈 <dig> ,0〉↦〈 <dig> ,0〉, f:〈 <dig> ,1〉↦〈 <dig> ,1〉 are identical, as these two k-functions comprise the same expression states. moreover, these repertoires contain the same latent phenotypes, despite the two corresponding k-functions comprising distinct genotype sets. this pattern is apparent in any pair of k-functions that comprise the same set of expression states, as shown analytically in the supporting online material.

latent phenotypes vary within and among the genotype networks of a k-function
we have shown that the size of a k-function’s latent repertoire depends only on the number of unique expression states that occur in the k-function. however, we have not addressed how these latent phenotypes vary amongst the individual genotypes that have the same k-function. we therefore next asked whether genotypes that are separated by a small number of mutations are likely to have more similar latent phenotypes than those separated by many mutations. to answer this question, we sampled  <dig>  pairs of genotypes from the largest connected genotype network  of every k-function. for each pair of genotypes, we determined  their mutational distance from one another, and  the fraction δ of latent phenotypes that is unique to one genotype or the other . if δ increases with the mutational distance between genotypes, then a circuit’s location on a genotype network determines its latent capacity for exaptation.

many multifunctions have fragmented genotype sets, i.e., they consist of multiple disconnected genotype networks  <cit> . to understand how genotype set fragmentation may constrain the number of available latent phenotypes, we next asked how latent phenotypes vary between the genotype networks of fragmented genotype sets. first, for each k-function with a fragmented genotype set, we calculated the number of unique latent phenotypes found in the dominant genotype network, but not in the peripheral genotype networks . we found that for most k-functions the majority of latent phenotypes were only realized by circuits in the dominant genotype network . for example, the median fraction  of the latent repertoire that is accessible only from the dominant genotype network is  <dig> . second, we calculated the number of unique latent phenotypes that were present in the peripheral genotype networks, but not in the dominant genotype network. of all the k-functions with fragmented genotype sets, there was not a single such latent phenotype. since only a minority of circuits belong to the peripheral genotype networks of any k-function with a fragmented genotype set , these results suggest that genotype set fragmentation does not impose severe constraints upon the accessibility of latent phenotypes. finally, we found that the number of unique latent phenotypes per genotype network increased with the size of the genotype network , similar to the association observed between latent repertoire size and genotype set size .

robust circuits have many latent phenotypes
studies of systems as diverse as rna  <cit>  and programmable hardware  <cit>  have shown that a genotype’s robustness to genetic change is inversely correlated with its potential to bring forth novel phenotypes via mutation. in previous work, we also observed this inverse correlation in the model regulatory circuits considered here  <cit> . we therefore next asked whether a circuit’s mutational robustness — measured as its number of neighbors with the same k-function  — is inversely correlated with its number of latent phenotypes. to answer this question, we focused solely on multifunctions composed of at least one transition mapping, because only circuits with such multifunctions exhibit variability in their mutational robustness  <cit> .

latent repertoire size increases with the number of genes in a circuit
our focus on small, three-gene circuits facilitated an exhaustive analysis of genotype space. however, regulatory circuits often comprise more than three genes  and are typically part of larger regulatory networks  <cit> . as such, it is important to understand how our observations might translate to larger circuits. to do so, we randomly sampled  <dig>  genotypes of monofunctional circuits with 3 ≤ n ≤  <dig> genes and determined the average number of latent phenotypes per circuit.  we found that the average number of latent functions per monofunctional circuit increases linearly in n and only very gradually, such that a circuit with n =  <dig> genes has roughly twice as many latent phenotypes as a circuit with n =  <dig> genes . this indicates that the proportion of possible latent phenotypes that an individual circuit can realize decreases exponentially in n , since the maximum number of latent phenotypes in a circuit with k functions is 2
n
-k. nevertheless, we expect that the size of a multifunction’s latent repertoire will increase with n, for the following reasons. first, as n increases, the number of possible latent phenotypes increases exponentially  and genotype set size increases hyperexponentially  <cit> . second, these genotype sets comprise large dominant genotype networks of dissimilar circuits  <cit> , which will typically have different latent phenotypes . taken together, these observations indicate that the size of a multifunction’s latent repertoire will increase with the number of genes n in the circuit despite the decrease in the proportion of latent phenotypes realized by individual circuits.

discussion
we have exhaustively characterized the latent phenotypes of model three-gene regulatory circuits. while individual circuits typically have few latent phenotypes, the entire set of circuits  with a given set of functions  collectively has many latent phenotypes, which constitute the multifunction’s latent repertoire. this latent repertoire is a source of potential novel adaptations in gene expression patterns, because most circuits in a genotype set are part of a single genotype network, and each latent phenotype in the repertoire can be realized by one of these circuits. thus, a circuit with any phenotype in the latent repertoire can evolve via a series of mutations that preserve the circuit’s functions.

previous work on systems ranging from rna  <cit>  to metabolic networks  <cit>  shows that genotype networks  can facilitate the origin of novel and beneficial phenotypes. by permeating the space of possible genotypes, they allow for the accumulation of genetic diversity in evolving populations while permitting the preservation of an existing phenotype  <cit> . in doing so, they provide mutational access to genotypes with novel phenotypes  <cit> . our work suggests two additional reasons why genotype networks facilitate the origin of novel phenotypes. first, the latent repertoire of an entire genotype network is usually greater than that of a single circuit genotype. this means that the very existence of genotype networks enables the origin of novel circuit functions from latent gene expression phenotypes. second, the size of a multifunction’s latent repertoire increases with the size of its genotype set. this means that regulatory functions  that can be realized by greater numbers of circuits — which usually also form large genotype networks — harbor a greater potential for evolutionary innovation originating from latent phenotypes. since the size of the genotype set associated with a given phenotype can be used as a proxy for the phenotype’s robustness to genetic change  <cit> , those circuits with highly robust gene expression phenotypes can explore a greater variety of latent phenotypes.

we also investigated the relationship between the mutational robustness of individual circuit genotypes and their number of latent phenotypes, uncovering a positive correlation between these two properties. robust genotypes therefore have an increased capacity for exaptation. this is an intriguing observation because theoretical results suggest that such genotypes are likely to appear in neutrally evolving populations  <cit> . thus, in contrast with adaptations that arise via mutation — where genotypic robustness hinders, but phenotypic robustness facilitates, the origin of novel phenotypes  <cit>  — adaptations that arise via latent phenotypes are facilitated by both genotypic and phenotypic robustness.

the genotype sets of multifunctions are often fragmented into several isolated genotype networks  <cit> . such fragmentation is not unique to regulatory circuits. it has been observed in models of rna secondary structure  <cit>  and protein quaternary structure  <cit> . here, we found that larger genotype networks harbored more latent phenotypes than smaller genotype networks, indicating that a circuit’s latent capacity for exaptation is dependent upon which genotype network the circuit belongs to. because we know very little about the genotype networks of biological circuits, we cannot say whether the enhanced capacity for exaptation that is conferred by a large genotype network could be realized by extant biological circuits. we anticipate that the genotype network membership of biological circuits will be affected by a variety of factors, including historical contingency  <cit> , designability  <cit> , and robustness to environmental and genetic perturbations  <cit> . as screening and selection strategies for gene circuits continue to advance  <cit> , it may become possible to experimentally tease apart the relative influences of these various factors.

one caveat of using a boolean model of gene regulatory circuits is that the number of mutations required to transition from one logical function to another may not directly correspond to the number of mutations required for the same transition in a biological context. for example, in our model, mutating a gene’s signal-integration logic from or to and requires twice as many mutations as the transition from or to xor. while theoretical work suggests that the former transition would indeed require several mutations  <cit> , both theoretical  <cit>  and experimental work  <cit>  indicate that xor logic is exceedingly difficult to implement, suggesting that the latter transition would require a greater number of mutations. moreover, such mutational transitions are often accompanied by the addition and subsequent deletion of edges that are not involved in the logical function that is being mutated. some of these issues may be overcome using biophysical models of regulatory circuits, which employ experimentally derived tf binding preferences  <cit>  or tf-dna crystal structures  <cit>  to describe a tf’s binding affinity to short dna sequences embedded within longer promoter sequences. however, the length of the promoter sequences considered in such models  preclude the exhaustive enumeration of the space of regulatory circuits, and would therefore render the analyses considered here infeasible.

our results suggest that latent phenotypes pervade gene regulatory circuits and may therefore contribute to the origin of adaptations and evolutionary innovations. anecdotal evidence supporting this view comes from comparative genomics studies of the redeployment of ancient transcriptional regulatory circuits in novel spatial domains. for example, vertebrate dentitions first appeared in the pharynx of jawless fishes. the regulatory circuit that controlled the development of pharyngeal teeth was subsequently redeployed to control the development of oral dentitions  <cit> . similarly, the regulatory circuit that controls the patterning of the insect wing blade was redeployed in butterflies for the function of generating eyespots, a predator avoidance strategy that evolved much later than the insect body plan  <cit> . in both cases, the alteration of the spatial domain of an existing gene expression pattern formed the basis of an evolutionary innovation. while it is not known whether the ancestral circuits exhibited latent phenotypes in their novel spatial domains or whether the circuit redeployment evolved de novo, recent evidence from enhancer evolution in fruit flies suggests that the latent expression phenotypes of gene regulatory circuits can become exaptations  <cit> . specifically, expression of the gene neprilysin- <dig> in the developing visual system of drospophila santomea derives from the co-option of enhancer sequences active in other tissues that exhibited latent activity in the optic lobes of the last common ancestor of d. santomea and d. yakuba. thus, the latent phenotypes of regulatory circuits can provide a foundation for evolutionary adaptations and innovations.

classical exaptations — adaptive traits with non-adaptive origins — include the feathers of birds  <cit>  and the panda’s thumb  <cit> , which originated as a wrist-bone. such traits usually need to be modified to assume a new function. in contrast, a latent phenotype already embodies this new role as a by-product of a system’s existing function. once this phenotype becomes favored by natural selection, the system is already poised for exaptation. an intriguing question for future work is whether adaptations that originated from latent phenotypes are prevalent or rare among exaptations.

CONCLUSIONS
together with previous work on systems as different as metabolism  <cit> , enzymes  <cit> , and rna  <cit> , our observations suggest that latent phenotypes are ubiquitous in biological systems and could thus be a common source of new adaptations.

