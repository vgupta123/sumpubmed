BACKGROUND
understanding the molecular mechanisms regulating individual variation and how selection operates on these mechanisms to drive adaptive evolutionary change are fundamental goals in evolutionary ecological genetics  <cit> . however, studies of the molecular mechanisms mediating intra- and interpopulation differences in non-model organisms in their ecological habitats have traditionally been limited by the relatively low number of genetic markers available and the high cost of full genomic sequencing. the introduction of inexpensive, high-throughput sequencing technologies presents the unparalleled opportunity to rapidly analyze the structure of populations in ecologically relevant systems and begin to examine the evolutionary forces underpinning adaptive variation within and among populations and species  <cit> .

there are a large number of well-established computational procedures and statistical techniques to detect signatures of selection along the genome at different evolutionary time periods . however, the majority of these methods are computationally intensive for genome-wide analyses and difficult to execute for researchers not accustomed to working with population genomic data and the associated statistical techniques. recently, we developed a user-friendly, open-access, web-based platform on the galaxy web-server to investigate genetic variation and population structure  <cit> . in this study, we expand upon this existing platform through the development of additional tools and reproducible workflows to specifically scan the genome for signatures of selection and adaptive evolution. this interface allows scientists to easily and efficiently examine the evolutionary processes acting on population-genomic data sets and readily share their results with the scientific community, ensuring transparency and reproducibility.

here, we demonstrate an application of this platform in the study of evolutionary relationships among populations of apis mellifera honey bees in east africa, and search for signs of adaptive evolution across the genome. honey bees are a fascinating model system in which to study the molecular mechanisms underpinning adaptive evolution. apis mellifera honey bees are one of the most broadly dispersed animal species in the world, occupying every continent except antarctica. a. mellifera originally evolved in tropical africa, and subsequently migrated to and became established in temperate europe and western asia on two occasions, forming two distinct genetic lineages from their african ancestors . within kenya alone there is substantial genetic diversity, with previous studies identifying five distinct subspecies in different ecological niches: a.m. scutellata in the central savannah, a.m. monticola in the mountains, a.m. litorea on the coast, a.m. yemenitica and a.m. simensis in the northern desert . however, previous studies using a limited number of mitochondrial and nuclear markers have indicated substantial gene flow among these putative subspecies, and thus there may not be clear distinctions among these populations  <cit> .

adaptation to different environmental conditions in honey bees involves both behavioral and physiological changes. honey bees establish large colonies with tens of thousands of individuals which are active year-round  <cit> . in tropical regions, colonies must deal with both wet and dry seasons, while in temperate regions, colonies must survive extreme cold conditions. winter in temperate regions and either  wet or dry seasons in tropical regions are typically associated with reduced floral resources and reduced nutrient intake, which results in reduced production of new bees . in temperate regions, this nutrient-deprived, broodless condition has been shown to trigger the production of “overwintering bees”  <cit> , which exhibit reduced activity, altered hormone profiles, higher nutrient stores, and longer lifespans . the bees will also form a thermoregulating cluster when temperatures drop below 18 °c  <cit> . the phenotype of bees experiencing wet/dry conditions in the tropics has not been characterized, but rendering temperate bees broodless in the summer months can result in a similar “overwintering” phenotype of altered hormone and nutrient levels and increased lifespans , and it has been hypothesized that broodless conditions resulting from a lack of resources can trigger similar phenotypes under different environmental conditions  <cit> . furthermore, in addition to these physiological parameters, there are also clear behavioral adaptations to seasonal changes: colonies of tropical a. mellifera subspecies readily migrate over vast distances to find environments with more plentiful resources  <cit> .

with the sequencing of the honey bee genome  <cit> , and the development of high throughput genomic sequencing technologies, it is now possible to readily examine genome-wide signatures of selection in honey bees. previous studies have examined the genetic structure of populations of bees in africa, europe and north america allowing for inferences of the phylogenetic history of worldwide honey bee populations and identifying signatures of positive selection in protein coding regions of genes between african/africanized populations and european populations  <cit> . other studies demonstrated that genes associated with differences in queen and worker behavior have significantly higher numbers of snps than uncorrelated genes  <cit> , and identified signatures of postive selection in genes associated with worker behavioral traits  <cit> .

in this study, we sequenced the full genomes of  <dig> individual worker bees sampled from different ecological regions throughout kenya. we expanded and used our newly developed suite of web-based tools to examine signatures of selection within this sample group using six well established tests; each test is available as a tool or reproducible workflow on the galaxy website, http://usegalaxy.org/r/kenyanbee. as with the experimental design of any population genetics analysis, large sample sizes are always desired and lead to the greatest accuracy in the estimation of population genetics parameters  <cit> . despite the decreasing price of high throughput technologies, the costs of whole genome sequencing, sample collection and international field work remain as limitations to population based genomics studies. we acknowledge the potential limitations our relatively small size of  <dig> individuals yield, yet demonstrate the powerful application of publicly accessible, user-friendy tools developed on the galaxy platform to begin to identify the genes involved in environmental adaptation in this species. additionally, our work provides the foundation and computational framework for future population genomics studies in kenyan honey bees, as well as other ecologically relevant non-model organisms.

methods
sample collection
we collected honey bees from  <dig> apiaries across kenya  or relevant authority . honey bees were maintained according to standard beekeeping practices. one representative bee from one colony in each apiary was sampled; collections of bees were carried out between june-september  <dig>  a forager returning to the hive entrance with pollen was collected in 95 % ethanol. bees were collected into individual 2 ml cryogenic vials . samples were collected on ice, stored at -20 °c during field collections, and then shipped to the pennsylvania state university  within a month, where they were stored at 4 °c. sample collection procedures were in accordance with standard practices for ethical handling of invertebrate samples  <cit> . because a. mellifera is not a regulated invertebrate, no ethical use or institutional review board approval was required.

whole genome sequencing and snp identification
heads of individual foragers were dissected and homogenized with a fastprep instrument  for three cycles at maximum time and speed. dna was extracted using the puregene core kit  according to manufacturer’s instructions.

prior to library preparation, the quality of the gdna samples was assessed by running the samples on a bioanalyzer dna  <dig> chip . sample quantitation was performed using invitrogen’s picogreen assay. next-generation sequencing library preparation was performed on the biomek fxp  using the spriworks ht reagent kit  and illumina’s truseq lt dna adatpers . for each sample, 1ug of gdna was used for library preparation. the samples were sheared on a covaris s <dig> to ~300 bp, following the manufacturer’s recommendation . size selection was performed on the biomek fxp using the spriworks ht reagent kit. each library was uniquely tagged with one of illumina’s truseq lt dna barcodes to allow library pooling for sequencing. library quantitation was performed using invitrogen’s picogreen assay and the average library size was determined by running the libraries on a bioanalyzer dna  <dig> chip . library concentration was validated by qpcr on a stepone plus real-time thermocycler , using qpcr primers, standards and reagents from kapa biosystems . library quality was assessed by running the samples on an illumina miseq sequencer and high throughput sequencing was carried out on an illumina hiseq  <dig> sequencer at a read-length of 101 bp paired-end.

paired-end sequences of length 101x <dig> bp were aligned to the apis mellifera reference genome sequence  using bwa  <cit>  version  <dig> . <dig>  the default parameters were used, with the exception of the “-q 15” option, which was applied to allow soft trimming of the low-quality 3’ ends of reads prior to alignment. on average, we aligned  <dig>  gb of sequence data per individual , corresponding to an average of ∼ 20-fold coverage of the 234-mb honey bee reference genome sequence. we used the markduplicates utility in the picard toolset  to flag potential pcr duplicate reads that could otherwise affect the quality of the variant calls. of each set of potential duplicate read pairs, only the pair with the highest sum of base quality scores for bases with quality ≥ <dig> was used in the subsequent steps. considering data from all individuals simultaneously, we used samtools  <cit>  version  <dig> . <dig> to identify the locations of variants, using the option “-c 50” to reduce the mapping quality of the reads with multiple mismatches. these locations in the nuclear genome were filtered to maintain variants for which the total coverage in the samples was between  <dig> and  <dig> reads , and the rms  mapping quality was greater than or equal to  <dig>  as a result, we identified  <dig> , <dig> locations  in the nuclear genome, where more than one allele was observed among the  <dig> samples and the reference sequence. once the variant locations were identified, we then used samtools  to estimate genotypes at all snps for each individual, regardless of sequence coverage for that snp and individual. the final dataset of  <dig> , <dig> putative snps was constructed after filtering for a samtools-computed quality score of at least  <dig>  all sequences are deposited on the short read archive  and as a bioproject  on ncbi.

overall fst
samples were collected from apiaries that had previously been found to contain bees with mitochondrial haplotypes corresponding to four previously described subspecies  though in some cases, multiple subspecies were identified within an apiary . to determine if there were significantly differentiated populations of honey bees within our sample group using the whole genome information, we generated  <dig>  randomized groupings of individuals to be compared using the reich-patterson estimator of fst  <cit> . two groupings were identified  which we termed “desert” and “savannah”. both the data randomization and fst estimation were performed using the “overall fst” tool available in the “genome diversity” toolset on galaxy .table  <dig> specimen location information


aam-tropical monsoon climate, aw- tropical savannah climate, bsh- subtropical steppe climate, bwh- subtropical desert climate, cfb- marine coastal climate, csb- mediterranean climate


babpv- acute bee paralysis virus, bqcv- black queen cell virus, dwv- deformed wing virus, n.apis- nosema apis, vd-varroa destructor

the site number, geographic region, site name, coordinates, elevation, and identification numbers for individual specimens used in this study with köppen-geiger classification   <cit>  and previous identified pathogens at each site   <cit> . the apiary, colony and individual identification  numbers were assigned based on our initial survey scheme   <cit> 



phylogenetic analysis
the complete nuclear and mitochondrial sequences from the  <dig> individuals were used for phylogenetic analysis. the nuclear genome phylogeny was generated using the filtered set of ~ <dig>  million snps with the “phylogenetic tree” tool located under the “genome diversity” section on galaxy . “phylogenetic tree” constructs a neighbor-joining tree using the quicktree program  <cit> .

complete mitochondrial genome sequences were aligned with the clustalw package in bioedit  <dig>   <cit>  using the mutiple alignment feature . a neighbor-joining tree was constructed with mega <dig>  <cit>  using the maximum composite likelihood model , with uniform rates, and complete deletions. there were  <dig> sequences in all, including the outgroup individual, with  <dig>  nucleotides in the final data set of which  <dig> were variable sites. the european subspecies apis mellifera ligustica  is used as the outgroup to the african bees. the percentage of replicate trees in which the associated taxa clustered together in the bootstrap test are shown next to the branches  <cit> .

pn/ps
using the honey bee reference genome  we identified the annotated protein-coding exons for each putative gene. for each protein coding region, we analyzed all codons, other than the stop codon or those that intersect a gap  in the assembly. we defined the counts of effective nonsynoymous and synonymous sites using the approach of nei  <cit> . we then constructed a table containing the number of synonymous and nonsynonymous polymorphsims for each gene. a table based on all putative snps and the associated workflow is available on the galaxy server .

fixed differences from the  reference genome
the number of nonsynonymous and synonymous snps that are invariant among our samples and differ from the apis mellifera reference ,  <cit>  can be computed for each reference gene with galaxy commands and we provide a workflow at the galaxy website, http://usegalaxy.org/r/kenyanbee, that computes all of the values reported herein as well as the related supplementary table.

mcdonald-kreitman test
we extracted intervals of the a. mellifera reference genome that include coding exons plus  <dig> flanking bases on each side, which were then aligned to the a. florea reads using bwa and default parameters  <cit> . this allowed the mcdonald-kreitman test to be applied to all  <dig>  annotated a. mellifera genes within our kenyan samples. the number of synonymous subsitutions , the number of nonsynonymous substitutions , the number of synonymous polymorphisms  and the number of nonsynonymous polymorphisms  were counted using the galaxy “filter” and “count” commands; the galaxy table of bee genes that reports pn/ps  also contains columns with the mk ratio, ds, dn, ps and pn. the associated tools and workflow are available at the galaxy website, http://usegalaxy.org/r/kenyanbee.

runs of homozygosity
allele frequencies were calculated using the “filter”, “count” and “text manipulation” tools available on the galaxy browser. for each defined population, either desert or savannah, columns were appended to the data table that summed the genotypes for all individuals specified. using the “compute” tool, a homozygosity score was given for each site by taking the square of the difference of the frequencies of the alternate and reference alleles. in this way, any site that is homozygous within a population will receive a score of  <dig> . with the “remarkable intervals” tool on the galaxy browser, intervals of consecutive homozygous genotypes, or runs of homozygosity , were discovered by setting a cutoff of  <dig>  . we used  <dig> randomizations to determine which intervals to report, so that for any interval reported, the probability is p <  <dig>  for that interval’s score being equaled or exceeded by chance. these intervals were then intersected with and joined to known genes using the “intersect” and “join” commands on galaxy. a workflow showing the steps and tools used is available on galaxy .

fst
we first selected individuals for either the desert or savannah population using the “specify individuals” tool on galaxy. using the “per snp fst’s” tool, we then calculated the reich-patterson estimator of fst at each snp and used the “remarkable intervals” tool to locate regions containing runs of consecutive snps with high fst values. we used the highest scoring 10 % of fst values as our cutoff. at these intervals, the desert and savannah populations are more different from one another than can be explained by chance alone , demonstrated by our randomization approach using  <dig>  permuted replicates. these intervals were then intersected with and joined to known genes using the “intersect” and “join” commands on galaxy. a workflow showing the steps and tools used is available on galaxy .

tajima’s d
tajima’s d statistic was calculated according to the original definition  <cit> . d was calculated in 5 kb, non-overlapping windows across the entire genome of all individuals in the kenyan sample using the “tajima’s d” tool on galaxy. for each 5 kb window, we also estimated the normalized version of fay and wu’s h statistic using a custom python script  <cit> . to correct for multiple testing, we used the experiment-wide simulation approach of nielsen et al.   <cit> . significance cutoffs were obtained by repeatedly simulating data from a neutral coalescence model using a value of θ estimated from the data by taking the average number of segregating sites in a window. coalescent simulations were performed using hudson’s ms and tajima’s d and normalized fay and wu’s h values were estimated in sampled windows using zeng’s dh program  <cit> . we then filtered the data for windows with tajima’s d scores more negative than the simulated significance cutoff . a workflow showing the steps and tools used is available on galaxy .

genomic intervals under selection
the methods that search for genomic intervals where the snps reveal signs of positive selection all use the galaxy “remarkable intervals” tool and a workflow showing the steps and tools used is available on galaxy . the tool avoids problems associated with a fixed window size and in essence automatically determines the sizes of the intervals that it finds. certain genomic positions  are assigned a numerical value , and the user specifies a “cutoff value” or percentile that exceeds most of these numbers. the tool subtracts the cutoff value from each number, then finds “locally optimal” genomic intervals where the sum of the subtracted values cannot be increased by adjusting the interval’s end-points. also, it uses a randomization strategy to determine “empirical” p-values for the intervals that it reports. detailed descriptions of the method are reported elsewhere  <cit> .

gene ontology  analysis
where possible, go analysis was performed in david for genes displaying patterns consistent with selection  <cit> . go analysis was carried out on the genes with drosophila orthologs since david software does not support honey bee genome annotation. for the background list , we used all annotated a. mellifera genes with an available flybase annotation . numbers of genes in the analyzed gene lists with flybase orthologs were  <dig> for pn/ps,  <dig> for mcdonald-kreitman,  <dig> for tajima’s d, and  <dig> for fst. if bonferroni or benjamini procedures are applied to correct for multiple testing, no functional categories are identified as significant.

verification of snps in candidate genes
to validate our high throughput sequencing, selected genes  were resequenced in the  <dig> individuals and in two individuals derived from european subspecies . dna was extracted as above, and individual genes were amplified using pcr . pcr was performed on a mastercycler pro  using 25 ml reactions consisting of  <dig>  units of platinum taq dna polymerase, pcr buffer minus magnesium at a concentration of 1x,  <dig>  mm dntp mix,  <dig>  mm mgcl <dig>  5 % dmso,  <dig>  mm primers and 10 ng of extracted dna; reagents were purchased from invitrogen . the pcr was carried out using a touchdown protocol with the thermal profile of 2 minute at 95 °c, followed by 10 cycles of 95 °c ,  <dig> , and 72 °c . the program continued with 30 cycles of 95 °c , 55 °c  and 72 °c  and a final extension at 72 °c for 8 minutes. no-template controls were performed with each pcr run. products were visualized by electrophoresis on  <dig>  % agarose gels and were purified with a qiaquick pcr purification kit  for sequencing. sequencing was performed by the genomics core facility at pennsylvania state university. sequences were aligned using clustalw package in bioedit  <dig> .

RESULTS
evolutionary relationships among kenyan honey bee populations
we sequenced the genomes of  <dig> individual worker bees from  <dig> different apiaries distributed throughout four distinct ecological regions in kenya . these regions have been previously described as areas of subspecies endemism  <cit> . previous analyses with commonly used mitochondrial markers indicated that bees in these apiaries represented five different subspecies of apis mellifera: scutellata, monticola, littorea, and yemenitica or simensis   <cit> . sites s <dig>  s <dig>  s <dig> and s <dig> are within the described distribution of apis mellifera scutellata. the original description of this habitat is “thorn woodland and tall grass savannah”, but a. m. scutellata is found in more diverse habitats across eastern africa  <cit> . sites 1c, 2c, and 3c are located in tropical coastal habitat where apis mellifera litorea is said to occur. the apiary  at the gete ruins is in the arabuko sokoke forest reserve, a remnant of the coastal tropical forest that supports a number of unique endemic species. outside of this region, along the coast, there has been extensive alteration of the native habitat and potential incursion of a. m. scutellata. sites 1d, 2d and 3d are located in the hot, dry mandera district. at least two subspecies likely occur in this region, a. m. yemenitica and a. m. simensis  <cit> . the final subspecies, a.m. monticola, has received considerable attention in the literature . it has been described as “the bee of the rain forests of the east african mountains found at altitudes of 2000-3000 m”  <cit> . only one site  in our study was above 2000 m where a. m. monticola is said to occur. the bees were sampled during a  <dig> survey of the health of kenyan bee populations . several parasites and pathogens were identified in kenyan bee colonies during this survey: acute bee paralysis virus , black queen cell virus, , deformed wing virus , nosema apis , and varroa destructor ; see table  <dig> and additional file 1: table s <dig> for a listing of the parasites and pathogens found at each site. notably, the honey bee colonies sampled at 1d, 2d, and 3d were free of all tested parasites and pathogens .fig.  <dig> geographic, phylogenetic, and principal component relationship of kenyan honeybees. a) geographic locations of sampled apiaries. each individual is designated according to the ecological region in which it was sampled, with s = savannah, c = coast, d = desert, and m = mountains. colors indicate köppen-geiger climate regions, see   <cit> . b) neighbor-joining tree inferred from full mitochondrial sequences. the evolutionary distances were computed using the maximum composite likelihood method and are in the units of the number of base substitutions per site. the tree is drawn to scale. c) neighbor-joining tree inferred from full nuclear sequences. numbers indicate the branch lengths



across these  <dig> individuals, we identified ~ <dig>  million putative snps in the nuclear genome after filtering by quality score . using this set of variable sites, we first examined the evolutionary relationships among our sampled kenyan honey bees through a phylogenetic analysis of both the mitochondrial and nuclear genomes . a phylogenetic analysis using the full mtdna genome sequence  distinguishes between bees sampled from the savannah, coastal, and desert. the four savannah specimens  all group together. two of the three coastal bee specimens  form an independent cluster. the three desert specimens  are most distantly related to the savannah specimens, and could be either a.m. yemenitica or the recently described a. m. simensis  <cit> . interestingly, one of the coastal bees  groups with the desert bees. as mentioned previously, this coastal bee was collected from a remnant of the east african coastal tropical forest, and may represent a population that was originally in contact with the desert bee population. the single specimen from a mountain region  groups together with the savannah bees. previous studies from arias and sheppard   <cit>  used part of the nadh dehydrogenase subunit  <dig>  and the isoleucine transfer rna  mtdna region for phylogenetic analysis of the african honey bee subspecies. the corresponding sequence from 1 m is identical to that of arias and sheppard’s a. m. monticola bee . the nudna phylogeny distinguishes the desert individuals from a broad goruping of bees collected from southern mountain, coastal and savannah apiaries .

there are differences in both branch length and topology between the phylogenies constructed from the nuclear and mitochondrial genomes. similar patterns of mito-nuclear discordance have been observed in other animal systems  <cit> . distinguishing which type of discordance is occuring is often difficult, but our results suggest biogeographic discordance, although we cannot completely rule out stochastic processes such as incomplete lineage sorting  <cit> . as described earlier, the mitochondrial tree  is roughly consistent with the geographic distribution  of the representative individuals and all savannah bees cluster together. the nudna-based tree however, distinguishes the desert bees from a broad southern population suggesting gene flow among the coastal, mountain and savannah bee populations . moreover, there is no indication of stepwise ecoclines as described in ruttner   <cit> , and the northern desert bees form a distinct cluster, against the suggestion of kerr  <cit> . the discordance between the mitochondrial and nuclear trees could be the result of limited dipersal of honey bee queens and movement of males over a larger geographic area. unmated honey bee queens fly to male congregation sites that are delimited by topographic features and air flow turbulence. upon mating with multiple males the females will leave the congregation site and found a colony. if female honey bees show natal site fidelity or limited dispersal similar to what has been found for the bumble bee bombus vosnesenskii, the mitochondrial lineage would show biogeographical patterns  <cit> . if males come to congregation sites from a wide area then there would be greater gene flow at the level of the nuclear genome . the northern desert bee population may be relatively isolated given the arid climate  separting these populations from the south.

one of the tests for adaptive evolution that we wanted to apply uses an estimate of genetic differentiation, fst, for two disjoint “populations” of individuals. we believed an appropriate choice would be to group individuals in geographically distinct populations and in accordance with the traditional definition of subspecies. one population consists of 1d, 2d and 3d, which we call the “desert population”, and the other contains 2s, 3s, 4s, 2c and 3c, which we call the “savannah population”. we used the “overall fst” tool on galaxy to compare their fst with the fst for  <dig> randomly generated choices of a set with three individuals and a disjoint set of five individuals . overall, fst was estimated to be  <dig>  between these two groupings. only  <dig> of the  <dig> pairs had an equal or larger fst, indicating that the probability of such a high score occurring by chance is p <  <dig>  . in addition, using the “pca” tool on galaxy we performed a principal components analysis  of the individuals in our two defined populations, which further supports genetic differentiation between the desert and savannah populations .

signals of adaptive evolution
we applied six tests  to scan the genome for genes or genomic intervals showing signs of positive selection . each test is available as a tool or reproducible workflow on the galaxy website, http://usegalaxy.org/r/kenyanbee. three tests are limited to snps observed in protein-coding regions, while three consider all polymorphic sites across the genome . in broad terms, the protein-based tests look for a high proportion of amino acid-altering  differences compared to the “silent”  differences, and they can potentially detect selection over a wide range of evolutionary times. thus, the protein-based tests include all kenyan bees in our sample and may detect selection not limited to local geographic subpopulations. the tests of allele frequencies that include non-coding regions can in theory detect recent selection, presumably affecting only some individuals. the tools and workflows  used to estimate the numbers of fixed differences form the reference genome, mcdonald-kreitman scores, runs of homozygosity  and tajima’s d values were specifically developed for the purpose of this study and are unreported in the initial description of the galaxy tools to study genome diversity  <cit> . most of the annotated genes that were identified by these tests are uncharacterized, and tests that considered genome-wide snps frequently found regions that do not intersect any annotated genes; however, for each test we describe a well-characterized gene that the test identified . we chose cutoff values for each of the protein-based tests to highlight examples of genes with large scores using tools available on the galaxy platform. future studies with a larger sample size will standardize the false discovery rate across each test for positive selection. for selected candidate genes  where it was possible to design pcr primers, we validated the snp calls detected from high throughput sequencing with sanger sequencing. because sanger sequencing was performed on the coding regions of three selected candidate genes, not enough sites were validated to accurately estimate false positive and negative rates for the entire data set.table  <dig> descriptions of statistical genomic analyses used

f
st
fig.  <dig> example of a workflow using galaxy commands. the workflow depicts the commands and tools used to carry out the test for genes located in a “run of homozygosity” . the workflows and command histories for each test are available at https://usegalaxy.org/r/kenyanbee




test 1: pn/ps
polymorphisms that alter the amino acid encoded by a codon are called nonsynonymous, while those that do not are called synonymous, or “silent”. under neutrality, the majority of nonsynonymous mutations are expected to be deleterious and removed through the action of puryifying selection  <cit> . different modes of natural selection, however, can cause the frequencies of particular nonsynonymous mutations to increase within a population  <cit> . hence, by comparing the rate of nonysnonymous mutations to the rate of synonymous mutations, which are not expected to be strongly affected by selection, insight can be gained into the selective constraints of particular protein coding regions. a common statistic used to infer the type and magnitude of selection acting on a given sequence is known as dn/ds, which simply divides the frequency of nonsynonymous differences per nonsynonymous site by the frequency of synonymous differences per synonymous site  <cit> .

to investigate selection within a single species, this ratio is denoted as pn/ps because the differences between sequences are polymorphisms segregating within a population, not fixed differences between lineages. diversifying, balancing or positive slection can be inferred when pn/ps >  <dig>  while purifying selection is suggested when pn/ps <  <dig> . it is important to be aware that interpretations of pn/ps may be complicated by the presence of multiple alleles or recently diverged sequences when analyzing within-species data. recent theoretical and empirical work using modifications from the codon based phylogenetic substitution model of goldman & yang   <cit>  to estimate dn/ds has demonstrated that in certain cases of positive selection, dn/ds <  <dig> when calculated from within-species data  <cit> . here, we estimated pn/ps across the genome for our kenyan samples using the heuristic counting method of nei & gojobori   <cit> .

for each of the  <dig>  annotated proteins, we partitioned coding-region snps into non-synonymous and synonymous, which permits pn/ps to be calculated for proteins with at least one synonymous snp . several genes found to have high pn/ps are suggested to be under selection in other species, including gb <dig>  which appears to be under selection in drosophila simulans. furthermore, gb <dig> , associated with learning and memory, has been identified as one of the rapidly evolving genes in primitively eusocial bees  <cit> .

one gene found to have a high pn/ps is venom allergen api m  <dig> , with  <dig> nonsynonymous and  <dig> synonymous mutations, for which pn/ps was estimated to be  <dig> . kettner, et al.   <cit>  isolated this component of honeybee venom and observed four protein isoforms, which peiren, et al.  <cit>  attribute to a high level of polymorphism at a single genomic locus. importantly, and somewhat disturbingly, our scan reported the gene in two genomic locations , both with high pn/ps. peiren, et al.   <cit>  had observed this situation with an earlier a. mellifera genome assembly, and concluded that a high level of polymorphism within and around the gene caused the assembly algorithm to erroneously separate the two haplotypes. we concurred with their analysis and sought to determine the correct numbers of nonsynonymous differences in this gene.

by decreasing the gap penalty between the two haplotypes, we created a single alignment of the reference region around gene gb <dig> that included the reads formerly aligned to gb <dig> to analyze the insertions and deletions. samtools reported  <dig> nonsynonymous substitutions, i.e., one of the previously reported differences was lost  <cit> . in an interval containing the gene and its immediate flanking regions , we detected  <dig> short insertion/deletions, including a one-codon deletion  in the second exon, and a two-codon insertion immediately before the gene’s last  codon, at a position where peiren et al.   <cit>  also observed a two-codon insertion .

we designed primers  to amplify the api m  <dig> region in our kenyan samples as well as in two individuals each of a. m. carnica and a. m. ligustica ancestry derived from us bee populations. using sanger sequencing, we confirmed the  <dig> nonsynonymous polymorphisms contained in exon  <dig>  the  <dig> nonsynonymous polymorphisms present in exon  <dig> as well as the  <dig> nonsynonymous polymorphisms located across exon  <dig>  furthermore, we were able to confirm the two-codon insertion relative to the reference before the gene’s last non-stop codon within the kenyan samples .

although the pn/ps ratio can provide insight into the selective constraints of a genomic region, we cannot exclude the potential influence of demography, population structure and biased allele frequencies on our results. however for the case of api m  <dig>  it is unlikely that population structure strongly affects our conclusions. between the savannah and desert subpopulations, fst over the locus is only . <dig> and neither form monophyletic clades in the phylogeny obtained from the region . it is also unlikely that incorrect gene models have inflated pn/ps values due to the misclassifcation of sites. the amel_ <dig>  assembly gene annotation  we used here is a significant improvement from the original annotation  contained in the previous assembly. in the ogsv <dig>  annotation, gene models were predicted de novo and inferred from rnaseq and protein data  <cit> . furthermore, we recognize that pn/ps can be artificially inflated if a gene contains a small number of polymorphic sites and mutations occur at nonsynonymous sites more frequently by chance. for genes with pn/ps ≥  <dig>  we consider this effect unlikely to impact our results, as the number of polymorphic sites per gene range from  <dig> to  <dig> 

test 2: fixed differences from the  reference genome
we looked for genes with an unusually large number of fixed amino acid differences between our kenyan samples and the apis mellifera reference genome, which is of european ancestry  <cit> . this property may indicate adaptive evolution in one or both lineages since the separation of the european and african honey bees. although similar in nature to other tests, such as mcdonald-kreitman , here we are specifically searching for sites that differ from the reference genome and have risen to complete fixation within the kenyan samples. because we are only interested in genes that contain amino acid differences that have arisen to complete fixation, this test may not detect genes with large numbers of high frequency nonsynonymous polymorphisms that could be detected by other methods, such as the mcdonald-kreitman test. of the snps reported on galaxy,  <dig>  are fixed in the  <dig> samples with an allele differing from the reference genome. these snps should be treated with some caution because erroneous nucleotides in the reference sequence are highly likely to appear in this list.

using galaxy commands , we found that  <dig>  of those snps create a putative amino acid substitution, with  <dig>  affected genes. similarly we found  <dig>  synonymous coding-region differences among the  <dig>  snps, distributed among  <dig>  genes. among all genes with a fixed difference, there was an average of  <dig>  fixed synonymous differences and  <dig>  fixed nonsynonymous differences. we then searched for genes where the frequency of fixed amino acid differences from the european reference  exceeds the number of amino acids that are polymorphic within kenyan bees . we sorted genes by the ratio en/ . note that go analysis was not performed because only a small number of genes was associated with a flybase annotation and david identifiers.

a gene tied for the second highest score was the fmrfamide receptor . fmrfamides are small molecules with neuropeptide-associated activity that play critical roles in several invertebrate physiological processes such as vision, reproduction, feeding and circulatory system regulation  <cit> . since this gene was independently cloned and sequenced , rather than a computational prediction based on the genome assembly, we could confirm the assembly’s accuracy in this region. the gene contains  <dig> nonsynonymous differences between the reference and the kenyan samples, along with  <dig> synonymous differences. within the kenyan samples,  <dig> variant nucleotides were called, all synonymous. these observations are consistent with a gene that has undergone positive selection in one of the lineages leading from the split of the kenyan and european populations. it is also possible that these amino acid substitutions could be a result of genetic drift and we cannot exclude its influence. these amino acid differences are predicted to lead to significant changes in protein structure. specifically, the extracellular domains differ between the kenyan and european protein structures .fig.  <dig> predicted fmrfamide receptor structures in european a and kenyan b bees. five residues in the extracellular domains  were found to differ at positions  <dig>   <dig>   <dig>   <dig>  and  <dig> between these two populations. the configuration of the extracellular domains is altered despite the fact that the mutations are not drastic. the transmembrane regions  follow the homologues positions of d. meloganogaster studied by merte and nichols   <cit> . red labels represent the position and amino acid of the structure altering mutation



the analysis was complicated by the presence of an assembly gap in the honeybee reference sequence  in the fmrfamide receptor’s last  exon, namely positions 498032- <dig> of the sequence called group <dig> . we substituted the corresponding sequence from aci <dig> for the run of ns and realigned with our sequence data. no new snps were predicted. however, manual inspection of the alignments suggested that one of the automatic snp calls of a synonymous difference among the kenyan samples might be a false positive, but did not materially affect our conclusions. we designed primers  to amplify across exon  <dig> and exon  <dig> of the gene and through sanger sequencing we confirmed the presence of the  <dig> fixed nonsynonymous differences between the european reference and our kenyan samples present in this region .

test 3: mcdonald-kreitman test
comparing the pattern of nonsynonymous and synonymous polymorphism within a species to the pattern of nonsynonymous and synoymous divergence between species can potentially identify positive selection operating over long evolutionary time periods  <cit> . mcdonald and kreitman   <cit>  hypothesized that regions containing an excess of nonsynonymous to synonymous divergence relative to the nonsynonymous to synonymous polymorphism may suggest positive selection and adaptive evolution. for a given gene, the mcdonald-kreitman test constructs a contingency table from the number of synonymous subsitutions , the number of nonsynonymous substitutions , the number of synonymous polymorphisms  and the number of nonsynonymous polymorphisms . note ps and pn refer to the actual counts of substitutions, and differ from the rates pn and ps used in test  <dig>  genes where the ratio of / exceeds  <dig> may be where purifying selection has not driven advantageous alleles to fixation within the species, but has done so over the longer evolutionary time separating the species. similar to shapiro et al.   <cit> , we calculated this ratio, termed the fixation index , for each annotated gene along the genome.

for the second species used in this test, we chose the dwarf honeybee, apis florea, for which unassembled sequence is available in genbank. a table that reports the computed fi scores for each gene is available at the galaxy web server . in total, we identified  <dig>  putative inter-species nucleotide differences. we note that high fi scores could be the result of a poor alignment with the outgroup sequence. for individual candidate genes, we manually inspected the a. florea alignment and did not find any unusual patterns .

when we simply sorted the table by decreasing fi score, the top genes were surprisingly dominated by cases where the computed pn/ps was extremely small, rather than cases where the nonsynonymous/synonymous ratio for interspecies variants was unusually high. for genes where we were able to estimate pn/ps, the average value is  <dig> , but genes with the highest computed fi score typically had pn/ps around  <dig> . among genes with pn/ps ≥  <dig> , the one with highest fi score is that for nadh dehydrogenase   <dig> beta subcomplex, subunit  <dig> . we observed  <dig> nonsynonymous and  <dig> synonymous differences in our a. mellifera data , but  <dig> nonsynonymous and  <dig> synonymous interspecies difference, for an fi score of  <dig>  the  <dig> nonsynonymous and  <dig> synonymous difference found with the kenyan individuals were confirmed to be located in the first exon through sanger sequencing . in a situation like this, where the gene appears to be quite well conserved within the species but quite divergent from a related species, one needs to consider the possibility that the genes being compared are paralogs not orthologs . we consider that to be quite unlikely for this gene, because a. mellifera and a. florea genes are embedded in assembled sequences that align for over a megabase without interruption. a second interesting gene in this group, gb <dig> , is associated with adult feeding behavior and is the ortholog of drosophila takeout . this gene encodes juvenile hormone binding protein and in drosophila is associated with circadian rhythm   <cit> ) and behavioral responses to starvation  <cit> . in honey bees, jhbp- <dig> might be under selection allowing adaptation to the vastly different environments these bees inhabit, possibly leading to differences in adult worker development and responses to food availability and different food resources.

test 4: runs of homozygosity
as an allele rises in frequency within a population, nearby variants can also rise in frequency, transforming the usual patterns of genetic diversity for that region and creating stretches of high homozygosity. thus, stretches of the genome containing reduced allelic diversity are potential signs of a selective sweep and can be indicative of recent positive selection  <cit> . significant selective sweeps within a population can result in extended tracts of homozygous polymorphisms, known as runs of homozygosity   <cit> . here, we compared allele frequencies between savannah and desert individuals to identify rohs in either population. using tools on the galaxy server , allele frequencies were estimated for each population and the genome was scanned for intervals containing consecutive homozygous genotypes. furthermore, we performed  <dig> randomizations of the data, so that any interval reported had a probability less than  <dig>  of being discovered purely by chance. we then intersected these intervals with the coordinates of annotated genes to create population-specific lists of candidate genes containing rohs .

we observed one such region surrounding the forkhead box protein o  gene in the desert population . heterozygosity levels in the desert population are consistent with the savannah bees around 500 kb upstream and downstream of the region. however, heterozygosity levels are strongly reduced in a 500 kb stretch containing foxo within the desert population relative to the savannah population. the protein expressed by foxo is a transcription factor that is thought to play a major role in caste differentiation and division of labor by regulating insulin signaling  <cit> . foxo was also found in a qtl that suppressed reproduction of varroa destructor, a major parasite of honey bees  <cit> . interestingly, a recent survey of honey bee populations in kenya revealed that varroa destructor is present throughout the southern and central honey bee populations but absent from the northern desert regions  <cit> . however, varroa was likely introduced relatively recently  into kenya  <cit>  and thus likely does not account for this population difference.fig.  <dig> evidence for a selective sweep near forkhead box protein o  in desert population. the average heterozygosity is shown for all individuals sequenced in the savannah and desert populations across a  <dig>  mb region on chromosome  <dig>  the shaded area indicates the location of foxo. a marked reduction in heterozygosity for the region surrounding foxo is observed in the desert population



besides selective forces, rohs can also result from high levels of inbreeding or appear as an artifact of population history . in our sample, inbreeding is not expected to have a major effect as all individuals were collected from wild populations where queens mate with an average of  <dig> males and mating occurs between colonies over a several kilometer radius. it is suggested the purpose of this polyandrous behavior is to avoid the accumulation of deleterious recessive mutations due to inbreeding as well as to increase genetic diversity  <cit> . furthermore, studies of populations of african bees demonstrate that there is rapid colony turnover, with more than 80 % of the queens in a particular site being replaced by genetically unrelated queens  <cit> . we cannot exclude past demographic events or low statistical power resulting from our limited sample size as contributing factors to the rohs we observe. however, the foxo locus shows a signal consistent with recent positive selection in the desert population and seems like a biological plausible candidate that future studies can provide further insight on.

test 5: fst
strong selective sweeps can create regions with differences in allele frequencies and increased genetic differentiation between populations  <cit> . genomic intervals containing high levels of fst between two populations indicate regions potentially under positive selection in one or both lineages  <cit> . we identified several such genomic intervals displaying signatures of positive selection between the desert and savannah populations. first, at each snp site we calculated the reich-patterson estimator of fst between the two populations . with a low-sample size, yet a large number of snp markers, the reich-patterson method provides an unbiased and highly powerful estimate of fst  <cit> . negative fst values are the result of higher genetic differentiation for individuals within a population than between populations. to locate regions of the genome with signatures of positive selection, we then searched for areas with dense concentrations of high scoring snps using the “remarkable intervals” tool on galaxy. furthermore, we performed  <dig> randomizations of the data, so that any interval reported had a probability less than  <dig>  of being discovered purely by chance. we located  <dig> such intervals with an average length of  <dig>  bp.  <dig> annotated genes were found in the highest scoring intervals . one of the genes located in an identified interval was gb <dig> , which is involved in regulation of cuticle sclerotization and pigmentation in drosophila  <cit> . since insect cuticle functions as the first line of defense against environmental stressors, it is possible that in african honey bees these differences represent an adaptation to different climatic and ecological conditions found between the desert and savannah regions. indeed, this gene was also found to be under selection in african drosophila melanogaster as a likely adaptation to differences in altitude  <cit> . additionally, foxo, identified previously in the roh test, was found to be located within a high scoring interval.

one of the genes identified with our fst test is gb <dig>  an ortholog of the drosophila peptidoglycan recognition protein-lc . similarly, viljakainen et al.   <cit>  found signatures of positive selection for a pgrp gene in an ant genus myrmica. we identified several other immune genes including relish  which is implicated in honey bee immune response  <cit> . interestingly, previous studies have indicated that the savannah bee populations frequently are infected with two common european viruses  while the desert bees were virus-free , however, it is unclear if this difference is due to variability in immune competence or exposure  <cit> .

another gene of interest is neuroligin  <dig> . nlg <dig> is involved in central nervous system development and is expressed in higher order processing centers in the honey bee brain  <cit> . the interval with high fst that intersects nlg <dig> spans around 600 bp with the 202 kb intron between exon  <dig> and exon  <dig> . nlg <dig> has several orthologs found within the insect class that also have long first intron sequences, including the parasitoid wasp , the red flour beetle , the dwarf honeybee , the leafcutter bee , the pea aphid  and the bumble bee . the evolutionary conservation of a large intronic region hints at the presence of essential regulatory elements.fig.  <dig> 
f
st analysis of the chromosomal region containing the neuroligin- <dig> gene. a) plot of f
st  between desert and plains bees at  <dig>  snps in a 200-kb interval on chromosome  <dig>  that spans the first two exons of the neuroligin- <dig> gene . orange rectangles indicate the two exons of annotated gene gb <dig>  putatively transcribed on the opposite strand, though we find the evidence for existence of a functional gene unconvincing. genome-wide, 10 % of the f
st values are larger than  <dig>  — indicated with red. light blue bars represent non-significant f
st values. b) the interval  <dig> ,154- <dig> , <dig> has a statistically significant concentration of snps with f
st in the highest 10 %, meeting our criterion for putative positive selection by the f
st criterion



test 6: tajima’s d
selective sweeps often cause distortions in the observed allele frequency spectrum at a given genomic region . genetic variability is greatly reduced in the area where a selective sweep has taken place, however, gradually over time new mutations appear. these mutations initially occur at low frequencies, creating regions with an excess of rare polymorphic variants and deficiencies of common variants  <cit> . several methods exist for detecting these regions where the frequency spectrum significantly deviates from neutral expectations, such as tajima’s d statistic  <cit> . we calculated d on a genome-wide level using 5 kb, non-overlapping, sliding windows to discover genomic regions containing extended stretches of an excess of rare polymorphisms relative to the total number of segregating sites, indicating positive selection. however, it is important to note that values of tajima’s d can be affected by population structure, demographic history and recombination  <cit> . negative d values may be caused from an excess of rare variants as a result of a recent population growth  <cit> . in our sample, values of d are slightly skewed towards negative values .

to differentiate between selective processes and demographic effects we also complemented our sliding window estimation of d with another test, fay and wu’s h, that considers the amount of very high-frequency polymorphisms relative to intermediate-frequency ones, in addition to using information from an outgroup  <cit> . as suggested by zeng et al.   <cit> , we estimated the normalized version of the h statistic. for an outgroup, we mapped unassembled reads of the closely related asiatic honeybee a. cerana, available from the ncbi short read archive  to the a. mellifera reference genome following the same procedure as the experiment that originally generated the data  <cit> . we note that interpretations of h may be complicated by the presence of missing data in the a. cerana sequence.

when tests against a neutral null hypothesis, such as d and h, are performed repeatedly across a genome in a sliding window analysis, an issue of multiple comparisons arises. although several strategies have been proposed to account for multiple testing, such as controlling the false discovery rate or bonferroni procedures, here we use the experiment-wide simulation approach suggested by nielsen et al.   <cit> . several genes were found in intervals testing significantly negative for both tajima’s d and fay and wu’s h , including derlin- <dig> . derlins are rhomboid pseudoproteases involved with endoplasmic reticulum associated degredation and play a role in the dislocation of misfolded proteins  <cit> . a ~20 kb region of chromosome  <dig> harbors several genes that intersect significantly negative windows of tajima’s d . furthermore, fay and wu’s h values in the region are also detected as significantly negative , providing additional evidence of a true departure from neutrality. genes located in this region include replication-protein- a 70 kda subunit , zinc finger fyve domain containing protein  <dig>  and alpha-mannosidase ii .fig.  <dig> selected chromosomal regions with signatures of positive selection according to tajima’s d analysis. the top panel shows a section of chromosome  <dig>  tajima’s d was calculated in 5 kb windows and scores are represented by vertical bars. any bar colored red represents a window where tajima’s d is significantly negative. conversely, bars colored light blue represent windows where tajima’s d is not significantly different from values expected under a site evolving neutrally. the bottom panel is a magnification of the area containing a ~20 kb stretch of significant tajima’s d scores. green blocks represent locations of genes contained within the interval



purifying selection may also result in significant tajima’s d and shift the frequency spectrum towards low frequency variants  <cit> . nonsynonymous mutations are expected to be under stronger purifying selection than changes at synonymous or noncoding sites because they alter the encoded protein and may be deleterious. to examine the effect of purifying selection on the frequency spectrum, we estimated tajima’s d genome-wide at three classes of sites: noncoding, synonymous and nonsynonymous. we observed a potential influence of purifying selection across the genome, as d is most negative at nonsynonymous sites . at synonymous and noncoding sites, d was estimated as - <dig>  and - <dig>  respectively. thus, because of the likely impact of purifying selection and unknown demographic effets, we caution against interpreting the genes detected by the test as being under positive selection.

CONCLUSIONS
here, we describe the expansion and demonstrate the use of a single, user-friendly interface on the galaxy webserver to elucidate population structure and signatures of selection from full-genome sequence data of individuals sampled across different ecological regions. this platform allows for the efficient integration of several different analyses and tests, allowing researchers to examine selection over different evolutionary time periods and make their data publically available, facilitating transparency and reproducibility. in our study, we examined the population structure of  <dig> individual honey bees collected from throughout kenya. because of the large amount of genetic markers available and despite the relatively low number of samples, we were able to demonstrate that the sampled specimens segregating into two populations, with one population found in the northern desert region and the second spanning the savannah, coast and mountain. both the analyses of the mtdna and the nuclear dna distinguished between these two main populations, though the grouping of three individuals were variable, suggesting that these specimens represent populations with complex histories. the two main populations are geographically separated by series of deserts that undoubtedly prevent migration and matings. the savannah population spans southern and central kenya and includes bees sampled from mountains, the coast, and the savannah. african bees can migrate long distances , thus facilitating gene flow across this large region  <cit> . the desert and savannah populations clearly experience distinct ecological and climatic conditions as well, and recent studies indicate that they are also experiencing different parasite and pathogen challenges  <cit> .

based on our analyses of genome-wide signatures of selection, there are several genes and gene regions that may have been influenced by selective forces at different evolutionary time scales. many of these genes have been shown to play a role in metabolism/nutrition , neuroplasticity/neuronal development , immunity and parasite resistance , reproduction , gland development and gland secretions , which may be involved in pheromone, brood food, and venom production and finally cuticle formation  and cuticular hydrocarbon synthesis  which are critical for protecting insects from environmental stressors, and, in the case of cuticular hydrocarbons, may also be involved in chemical communication. overall, while the suites of genes identified in these different tests were essentially non-overlapping, there was overlap in the general processes they are associated with; genes involved in the basic processes of metabolism and cell differentiation were found to be regulated across multiple evolutionary time scales. thus, selection may operate on different genes and on different time scales in these different honey bee populations, but these different selective pressures modify conserved pathways, as is the case for “genetic toolkits” identified in studies of evolutionary development biology  <cit> . although the tools and workflows developed on galaxy provide researchers with a user-friendly and integrative platform to scan genomic data for signatures of selection, we also wish to emphasize that alternative explanations may be responsible for statistically significant results. we encourage users to utilize the background information provided in this study and refer to the original publications of each test to understand how results may be impacted by various factors such as demographic history, drift and population structure.

while we validated the results of these genome-wide tests for several selected genes, it is important to stress that whole-genome computational analyses need to be used with care. a search though millions of nucleotides or thousand of genes to maximize or minimize some quantitative feature will frequently identify cases where the validity of the feature breaks down because certain assumptions are violated, such as where the genome assembly or gene annotations are incorrect. furthermore, genome scans can lead to spurious results in go analysis because of the potentially large numbers of false positives, so we further reiterate the importance of experimental validation and aim to motivate detailed studies of individual candidate loci in the future  <cit> . thus, at least until assembly and annotation methods become error-free, the results of high-throughput data collection and analyses often need careful investigation and/or experimental validation.

availability of supporting data
the data supporting the results of this study are available on the ncbi short read archive, accession number: . supporting tables and workflow histories are available at https://usegalaxy.org/r/kenyanbee.

additional files
additional file 1: 
supplementary tables .


 additional file 2: 
supplementary material.


 additional file 3: 
supplementary alignment  <dig> .


 additional file 4: 
supplementary alignment  <dig> .


 additional file 5: 
supplementary alignment  <dig> .


 abbreviations
abpvacute bee paralysis virus

bqcvblackened queen cell virus

dsnumber of synonymous substitutions

dnnumber of nonsynonymous substitutions

dwvdeformed wing virus

ennumber of fixed amino acid differences from the european reference genome

fifixation index

gogene ontology

mtdnamitochondrial genome

nudnanuclear genome

ncbinational center for biotechnology information

pcaprincipal components analysis

psnumber of synonymous polymorphisms

pnnumber of nonsynonymous polymorphisms

psrate of synonymous polymorphisms per synonymous site

pnrate of nonsynonymous polymorphisms per nonsynonymous site

rmsroot mean square

rohruns of homozygosity

snpsingle nucleotide polymorphism

competing interests

the authors declare that they have no competing interests.

authors’ contributions

zlf and wm developed the programs and workflows, analyzed the data, and wrote the manuscript; eln, ar, ocb contributed to the data analysis; hmp collected the samples, contributed to the data analysis and writing; tb performed the sanger sequencing; em, fm, mf, dm collected the samples; jm performed illumina sequencing; cmg contributed to data analysis and wrote the manuscript; ss, cmg and wm conceived of the study. all authors read and approved the final manuscript.

