BACKGROUND
tissue microarrays allow for the immunohistochemical analysis of large numbers of tissue samples and are used for confirmation of microarray gene-expression results as well as for predictive pathology  <cit> . a single tissue microarray  paraffin block can contain as many as  <dig> different tumors, enabling the screening of thousands of tumor samples for protein expression using a few array sections  <cit> . commercial digital-imaging systems can rapidly store thousands of images resulting from such sections. the stanford tissue microarray database  provides a central repository for data from tma's akin to the stanford microarray database  for gene expression arrays.

superficially the datasets generated from tma and gene expression arrays appear similar in that both are matrix type data and each entry in the matrix provides information about the expression of a biological entity  in a particular sample. however, gene expression arrays query a large number of genes in one sample or patient, whereas tissue microarrays query a large number of samples/patients for one protein. the key query dimension in tma data is a tissue sample, rather than a gene. as a result, queries such as 'find all genes that have a function x' get morphed to a query such as 'find all tissue samples that have a particular diagnosis'. currently, because of the lack of a commonly used ontology to describe the diagnosis or disease state for a given tma sample in tmad – analogous to the gene ontology for the function of gene products – it is not possible to perform such as query. the lack of an ontology for diagnoses and disease states also limits future integration of this resource with other public genomic scale data, such as gene expression arrays  <cit> .

for the purpose of this project, the key challenge was to create consistent ontology/terminology labels for each sample/record in the tmad that would allow the identification of all samples that are of the same type at a given level of granularity. . one mechanism of achieving this objective is to map the text-annotations describing the diagnosis of a particular sample to ontology terms that allow us to formulate refined or coarse search criteria  <cit> .

in the current work, we map the text annotations for records in the tmad to terms from the nci thesaurus, present the results on the quality of the mapping effort, describe the implementation of the mapping tools on the tmad website and explain how the mapping enables better querying of the data in tmad. to the best of our knowledge this is the first work that describes the use of the nci thesaurus for this purpose.

methods
overview of data in tmad
the tissue microarray database  contains data from immunohistochemical and in situ hybridization analysis of a large number of tissue samples that were studied with tissue microarrays. the tmad provides tools for quick upload, storage and retrieval of the tma images and the analysis of immunohistochemical staining results  <cit> . each record, describing the sample donor tissue, in the tmad contains free-text annotations – entered by the experimenter – for several fields such as the organ system, the source of the sample, the antibody or probe used for staining, and the staining result. among these fields are up to five diagnosis terms  describing the sample as well as a label for the organ and organ system from which the sample is derived. there are separate tables in the database for keeping track of user logins, experiment details, array constructions etc which are not relevant to the current work.

the nci thesaurus for annotating tma data
most of the samples in tmad are cancerous tissue samples and therefore we needed ontologies that provide a broad coverage of the various cancers. the nci thesaurus was thus a natural candidate to consider for annotating the samples in tmad. in previous work, we also included the snomed-ct for consideration <cit> . however, tmad would need a license to use the snomed-ct in their regular setup as they have non-us based users, therefore, while deploying the final system on tmad we decided to restrict ourselves to the nci thesaurus initially.

the nci thesaurus is an ontology providing broad coverage of the cancer domain, including cancer-related diseases, findings and abnormalities  <cit> . in certain areas, such as cancer diseases and combination chemotherapies, the nci thesaurus provides the most granular and consistent terminology available. the thesaurus currently contains over  <dig>  concepts, structured into  <dig> taxonomic trees. it is published under an open content license. the nci thesaurus can be obtained at . we downloaded version thesaurus- <dig>  g in the tab delimited text format. this text file contains columns for an id, name, parents, synonyms and definition for each nci thesaurus term. the parents and synonyms columns contain the immediate parents of the term and its synonyms separated by '|' respectively.

however, this format is not optimal for searching parent-child terms rapidly as well as for the purpose of matching against individual synonyms. therefore we reorganized the thesaurus into three separate tables which we named nci_term, nci_children and nci_synonyms. the nci_term table contains the thesaurus- <dig>  g as is. the nci_children table contains one row for each direct parent-child relationship and the nci_synonyms table contains one row each for each synonym of a term. this reorganization allows us to rapidly search the synonyms of a term as well as identify the parents and child terms of a given term. the tab-delimited files corresponding to these tables as well as the scripts to perform this reorganization are available on request.

mapping the tma annotations to ontologies
in order to map existing annotations of samples in the tma database to ontology terms during the test phase  <cit> , we created a database containing the tmad data, the nci thesaurus and the snomed-ct . we used perl scripts to process the existing descriptions of tissue samples and to generate strings for matching with ontology terms. we identified several heuristics to increase the accuracy of our matches. the perl scripts used for matching are available from the authors. after several refinements to the matching methods, the final version of the mapping scripts and a copy of the nci thesaurus are deployed on the tmad servers so that the text-descriptions of new samples can be processed at regular intervals and the ontology-based annotations can be kept up to date.

generation of annotation permutations
each record in the tma database has an organ, a diagnosis and four sub diagnosis terms associated with it. for example, a record might contain the entries breast, carcinoma, ductal, <null>, in situ, <null> for the organ , diagnosis , sub diagnosis  <dig> , sub diagnosis  <dig> , sub diagnosis  <dig>  and sub diagnosis  <dig>  fields respectively. we refer to the diagnosis related entries  as a term-set.

we generated all possible permutations of the non-null entries in every term-set. in theory, we would generate over a million permutations for the  <dig> records contained in the tmad at the time of this writing. however, these  <dig> records correspond to  <dig> unique term-sets, many of which contain fewer than five entries, and in practice we ended up with about twenty thousand permutations. we used the pair of a particular term-set permutation and the associated organ in the search for an ontology term to associate with that tma record

heuristics for increasing match accuracy
when searching the nci thesaurus, instead of searching for an ontology term for each permutation-organ pair, we first filtered out the non-informative permutations using heuristics that identify such permutations. for example, there are a number of uninformative records where d <dig> = normal and d <dig> = 19w which we identify using regular expressions. we also "tweak" a permutation to convert it to the most useful form. for example, if the first word in a permutation is carcinoma and the second word is adeno then flip the order and merge the two words to make the first word to be adenocarcinoma. in another example, if the first word in a permutation is carcinoma and the second word is squamous then flip the order but keep the words separate.

we use such a processed permutation and search for an exact match with a term or a synonym in the nci thesaurus. if there is no match, then we drop the right most term  and repeat the search. when, during this process, the permutation contains two words or fewer, we add ' of <organ>' to the search string where <organ> is obtained from tmad.

we also use simple heuristics to weed out bad matches. for example, if a matched term contains uterine but the organ associated with the record is not ovary, uterus, or fallopian tube, then we discard the match. if the matched term contains mouse, then we discard the match.

refining heuristics in consultation with pathologists
after initial success reported at amia annual symposium in  <dig>  we examined the unmatched records and their corresponding term-sets in collaboration with inigo espinosa  and kelly montgomery  from tmad to refine our heuristics. for example, if the permutation contains 'sertoli leydig' convert it to sertoli-leydig. we also added exceptions to our heuristics such as: if the permutation contains two words or fewer and one of the words is 'cholangiocarcinoma' do not add the 'of <organ>' to the search. such consultations, though time-consuming, turned out to be crucial in achieving high match accuracy.

deployment architecture
the setup, mapping to nci terms and browsing are all carried out using modular perl scripts that are used as shown in figure  <dig>  the scripts are divided into three groups: 1) setup scripts  create the necessary tables to store the nci thesaurus in relational tables as well as create the tables to store the nci-term annotation of a particular tissue microarray sample. 2) the update scripts  are run once after the setup and perform the mapping of user submitted annotation terms to nci thesaurus terms as well as index the particular tissue sample with the parents of the assigned nci term. this enables a pheochormocytoma sample to be counted as a retroperitoneal tumor. 3) the browsing script  drives the interface shown in figures  <dig> and  <dig>  the directed acyclic graphs are produces using the open source graphviz library. a utility script, compilemappingresult.pl, gives summary statistics on the number of mapped and unmapped samples.

RESULTS
we mapped the term-sets corresponding to the  <dig> records from the tmad, which specified a diagnosis, to ontology terms in the nci thesaurus. out of the  <dig> distinct term-sets  we were able to match  <dig> term-sets to the nci thesaurus. as mentioned before, in our initial work we had also mapped the term-sets to snomed-ct terms. tmad would need a license to use the snomed-ct in their regular setup because they have non-us based users; therefore, while deploying the final system on tmad we restrict ourselves to the nci thesaurus only. in total we were able to map  <dig>  of records in tmad to one or more terms from nci-t.

example matches to the nci thesaurus
the nci thesaurus has a wide coverage in providing matching terms for associating with diagnosis term-sets from the tmad. term-sets for a total of  <dig> records could be mapped to one or more terms from the nci thesaurus. the type  of the ontology terms that matched a given term-set varied over a wide range. for example, there are records where the term-set contained just four characters, such as mmmt  and matched a very specific ontology term such as 'malignant_mixed_mesodermal_mullerian_tumor'. at the same time, there are records where the term-set was highly descriptive such as carcinoma adeno intraductal  which matched an ontology term such as 'prostate_ductal_adenocarcinoma' and records where the term-set was highly descriptive such as carcinoma transitional cell in situ  which matched two ontology terms – 'stage_0_transitional_cell_carcinoma' and 'bladder_carcinoma' because no single term existed that would capture all the information.

evaluation of precision and recall
in our work, we mapped  <dig> records from tmad to one or more ontology terms; it is extremely time consuming for a domain expert to evaluate every matched term manually. therefore, we devised a sampling strategy where from the records that had a match, we randomly selected  <dig> rows comprising a distinct term-set, the associated organ, and the matched ontology term to determine the percentage of matches that were appropriate  or inappropriate  on manual inspection. we do not consider high-level matches such as sarcoma clear cell  – which matches 'sarcoma of the soft tissue and bone' – and mucinous neoplasm papillary intraductal  – which matches 'mucinous neoplasm' – to be appropriate hits in this evaluation. we repeated this procedure  <dig> times. the results of this exercise are presented in table  <dig>  14% of the reported hits were deemed to be false positives, giving a precision of 86%.

for  <dig> rows, corresponding to  <dig> term-sets , we did not have a match with any nci term. potentially all of these are false negatives putting a lower bound on the recall to be  <dig> %. we adopted a similar sampling strategy to select  <dig> sets of  <dig> records where no match was found. a domain expert then examined the nci thesaurus attempting to find a match for those records. the results are presented in table  <dig> 

we were manually able to find a match for 34% of those records, meaning that for these records, a true match did exist in the nci thesaurus that our methods were unable to find. examples of such record is carcinoma conventional granular pauci cellular area  where a match exists in the nci thesaurus as conventional renal cell carcinoma or clear cell renal cell carcinoma this fraction of the unmatched records are false negatives, giving us an estimated false negative rate of about  <dig>  % and an estimated recall of 95%.

for the remaining records, no good match exists and they are true negatives. among these true negatives, many term-sets did not describe any cancer and consisted of words such as proximal area history of lymphoma , mesial schelorsis epilepsy  and no cancer in prostate. it is not surprising that these term-sets did not match anything in the nci thesaurus because these are not cancer related terms. in some cases the term-sets were contradictory such as the diagnosis being leiomyosarcoma but the organ specified as skeletal muscle, instead of smooth muscle. there are several records that have words like 10w as the diagnosis, these are skipped during matching and considered as true negatives.

we note that metamap is considered the gold standard in mapping medical text to umls concepts  <cit> . however, butte et al have previously applied metamap  to determine the phenotypic and experimental context from text annotations of geo experiments  <cit> . they report that text-parsing using metamap is still an inefficient method to extract value from text annotations of genomic datasets  <cit> . in subsequent work they have explored much simpler methods such as ours and report that simple heuristics outperform metamap indicating that the complexity of metamap may not be essential for processing text annotations of genomic datasets <cit> .

mapping to nci enables better querying/analysis of tma data
once the mapping is accomplished, the simple assignment of the ontology terms to tissue samples is still not immediately useful to the end-user unless these ontology terms are used to drive specialized query-interfaces. plain keyword-based querying of ontology terms is not very useful. therefore, we are developing a querying and browsing interface  where the user starts with a term, visualizes the 'neighboring' ontology terms of that term in a dag view and browses up, and down the ontology-term hierarchy to identify a term that is at the right level of granularity. this term then can be used to pull out all the tmad records that are associated with that term or its child-terms. this interface is similar in spirit to amigo, which is used for browsing the gene ontology  at the gene ontology consortium's website  <cit> .

using this interface, a user can query a term such as "peritoneal neoplasm" to find that there are no samples corresponding to that particular term, but at the same time, the user can see that there are  <dig> samples corresponding to the parent term , and can click on the retroperitoneal neoplasm term to find that these are adrenal gland neoplasms and that four of them are from the medulla, and that eight are from the cortex of which four are malignant .

the user can then choose to retrieve all  <dig> samples corresponding to retroperitoneal neoplasm or retrieve the samples corresponding to specific terms such as adrenal cortex neoplasm. having annotations based on nci-t also enables formulation of queries  to pose requests such as: 1) show all retroperitoneal tumors 2) how many skin neoplasms does tmad have? 3) what subtypes of malignant abdominal neoplasms does tmad have? these queries could not be posed with the standard keyword based search interface.

discussion
currently there is a lot of effort directed towards classification of tumors using gene expression data <cit> . there are significant efforts directed towards creating centralized repositories of protein expression patterns observed on tissue microarrays as well as the underlying images such as the stanford tissue microarray database and tissue array database at md anderson cancer.

dna microarrays and tissue microarrays query two orthogonal dimensions of the data. the former query the expression of many genes for one patient in one experiment whereas the latter query many patients for changes in expression of one protein in a single experiment. the results from such studies have to be integrated with each other and with traditional histopathological diagnosis methods in order to form testable hypotheses about the underlying molecular mechanisms which determine prognosis of a particular cancer. however, little attention is being paid to the problem of developing mechanisms to integrate the results from these two complementary data types. recent reviews have suggested that it is essential to address this issue and synchronize the analysis, interpretation and data standards for these data  <cit> 

we believe such integration can be achieved via the use of explicit ontologies to link specific histological features, both morphological anomalies as well as ihc results, to gene expression changes in specific biological processes and pathways. the mouse pathology ontology is a significant first step in this direction and can potentially allow systematic integration of expression data with histopathology slides <cit> . however, no such equivalent exists for describing human histopathology and ihc studies as well as for combining their results with analyses of gene expression studies. the current work – where we have automatically mapped approximately 86% of diagnoses-related annotations for the samples in the stanford tmad to terms in ontologies – is a step in that direction. though detailed morphological annotations might not be currently feasible, simple annotations using terms from the nci thesaurus provide a specific mechanism to identify relevant samples in tissue and gene expression databases to perform integrative analyses .

it is possible to perform a similar procedure for microarray data sets corresponding to disease samples in the stanford microarray database  and/or the gene expression omnibus . if the microarray samples are similarly annotated with the diseases and/or tissue they are derived from, that will enable integrated analysis of protein and mrna expression datasets. in follow up efforts to the current work, we have applied our methods to text annotations of geo and are able to identify disease related experiments with high precision and recall as well as identify candidate datasets for integrated analysis of protein and mrna expression  <cit> . we note that though the coverage of nci-t was adequate for the current work, it might not be so for other situations. therefore we have made our methods available as a perl module that can be used to annotate samples using terms from any ontology that is in the umls.

this also presents an exciting research opportunity for specific cancer types, such as lung cancer, where integration of these data is needed for better tumor profiling  <cit> . such integration, can drive further research to develop formal guidelines for classifying and profiling tumors as well as making predictive pathology recommendations for customized chemotherapeutic intervention based on constraints defined on gene expression and histopathological phenotypes  <cit> .

CONCLUSIONS
we have demonstrated that we can effectively map the diagnosis-related terms describing a sample in tmad to the nci-t. the nci thesaurus terms have a wide coverage and provide terms for about 86% of the samples. we deployed a set of mapping scripts at tmad that will update the ontology annotations as new records are entered, ensuring that the structured annotations using ncit terms are always up to date. we have developed and deployed a graphical interface to browse the sample collection in tmad using the nci thesaurus terms and their hierarchical organization. we described how such a mapping allows a rich querying facility and offers the ability to identify "similar" or "related" tissue microarray samples, even though they may be described by different terms. for example, the four neoplasms of the adrenal medulla and eight neoplasms of the adrenal cortex  are all related to each other by the fact that they are all retroperitoneal neoplasms. finally, we note that such ontology based annotation can enable better data integration across diverse repositories similar to how go has enabled such integration across model organism databases.

availability and requirements
source code for both, the mapping scripts and the browsing interface is available as additional files . the main functionality of the mapping scripts – of generating permutations of text-annotations and mapping them to umls terms – is also made available packaged as a perl module  from  <cit> .

operating system: windows xp, linux;

programming language: perl;

other requirements: perl  <dig>  or higher, graphviz  <dig>  or higher;

license: gnu gpl;

any restrictions for non-academics: none.

authors' contributions
ns conceived of the project, developed the mapping method and wrote the code. dl, ie, km participated in the evaluation of the method. ie, km helped refine the match heuristics. all authors have read and approve of the manuscript.

supplementary material
additional file 1
mapping code. this zipped file contains the perl scripts to perform the mapping of the tma annotations as described in the methods section.

click here for file

 additional file 2
browsing code. this zipped file contains the perl scripts to create the browsing interface shown in figure  <dig> 

click here for file

 acknowledgements
we acknowledge robert marinelli and matt van de rijn for access to tmad database. this effort was funded by nih grant u <dig> hg004028
