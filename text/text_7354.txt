BACKGROUND
gene expression microarrays are a high throughput technique for measuring gene expression levels in thousands of genes simultaneously, and have been widely used in the study of cancer genomics. an important application of gene expression microarrays is detecting differentially expressed genes by statistical analysis. for example, the classical t-test can be used to assess the statistical significance of genes in terms of their ability to discriminate samples from two phenotypes.

while many microarray experiments from different laboratories have been performed with the same research aim, the results of these experiments may differ from each other in many aspects, e.g., the platform, the probe sets or the characteristics of the samples. consequently, the significant genes identified by the same statistical analysis from different experiments may be inconsistent.

to overcome these inconsistencies, the evidence from multiple studies needs to be combined. several papers  <cit>  directly integrated gene expression data by aligning genes/probes and concatenating samples. meta-analysis  <cit>  is another way of generating more robust and consistent statistical results by integrating multiple datasets and outputting an overall score, which we refer to as a meta-score for each gene/probe across all studies. for example,  <cit>  integrated the p-values from the t-test,  <cit>  integrated the effect size based on the model of  <cit> ,  <cit>  integrated the ranks of genes, and  <cit>  integrated the test statistics based on a mixture model of the normal distribution by considering the concordance between two datasets.

in addition, some papers used meta-analysis techniques to discover significant gene functions. for example,  <cit>  applied meta-analysis directly to the functional categories associated with each individual dataset, rather than the expression data, in order to identify more significant pathways;  <cit>  used meta-analysis to predict unknown functions of genes.

the integration of datasets from different platforms can generate more statistically significant results by reducing biases caused by specific platforms or experimental conditions. the study in  <cit>  first highlighted the importance of the alignment between different platforms as an issue for the meta-analysis of gene expression microarrays. more recently, the studies in  <cit>  applied meta-analysis to multiple platforms, and demonstrated that more robust gene signatures could be generated from multiple platforms.

a challenge for meta-analysis in this context is that microarray datasets from different platforms do not usually possess an identical set of probes. consequently, it is critical to fix a single set of probes as the candidates for statistical analysis. it is common to encounter incomplete alignment of genes among different microarray experiments, especially among those microarrays from different platforms. for example, the study in  <cit>  compared three microarray platforms - one with short oligonucleotides, one with long oligonucleotides, and a cdna platform. the three platforms have  <dig> genes in common, but many more genes are shared by a pair of platforms or by a single platform, as shown in figure  <dig>  similarly, many other meta-analysis studies have used datasets from different platforms, e.g.  <cit> . the overlap of genes among the three gastric cancer datasets  <cit>  used in our experiments, which were independently generated by the research groups from australia, hong kong and japan on different platforms, is also shown in figure  <dig>  in addition, other reasons can also cause missing replicates in microarrays.

however, to the best of our knowledge, all existing methods of gene expression meta-analysis either only consider those features that are assayed in all datasets , whereas the other genes that are not measured in all datasets are discarded, or simply ignore the missing replicates in the incomplete genes. we refer to the genes that are not measured in all datasets as incomplete genes.

however, the incomplete genes may also be significant and should be considered as candidates, even though their significance is not tested in all studies. in this paper, we focus on developing a novel meta-analysis method that takes complete and incomplete genes into account simultaneously.

we propose a meta-analysis framework, called incomplete gene meta-analysis , which is able to incorporate incomplete genes caused by cross-platform integration or any other reasons for missing replicates. igm comprises three major steps:  compute a statistic for every replicate  using the hedges' g effect size  <cit> ;  impute the significance of missing replicates, where the incomplete genes are not measured in particular datasets, using the model of a conditional probability distribution over the datasets;  generate an overall significance score  for each probe across all datasets using a variant of an earlier linear model  <cit> . as a basis for comparison, we also implemented other variants of this framework by replacing its key steps, including a traditional approach that does not consider the incomplete genes and a method that simply ignores the missing replicates in the incomplete genes.

we first tested igm and the comparable approaches on five breast cancer datasets with an identical set of probes, for the purpose of distinguishing the binary label of a given number of years to metastasis. we simulated the incomplete genes by randomly removing a subset of probes from each dataset. a gene ranking was generated using each method and the false discovery rate  was estimated using a permutation test  <cit> ). our method consistently achieved the closest fdr to that of the gene ranking produced on the original datasets without incomplete genes, which was considered as the gold standard. we also conducted experiments on three gastric cancer datasets, which were generated independently by research institutions in australia  <cit> , hong kong  <cit>  and japan  <cit> , for the purpose of discriminating diffuse and intestinal subtypes of gastric cancer  <cit> . using an enrichment test for gene ontology terms in both groups of cancer datasets, igm identified more significant terms that were closely related to a particular subtype of gastric cancer than only using complete genes. the above results show that the highly ranked genes produced by igm were statistically and biologically more significant than those produced by the other methods.

in section, we describe the igm framework, the comparable methods and our evaluation metrics. in section, we present the experimental results on the breast cancer and gastric cancer datasets. in section, we discuss the biological relevance of the results on the gastric cancer datasets. finally, we conclude the paper in section.

methods
in this section, we describe our framework called incomplete gene meta-analysis , which incorporates both complete genes and incomplete genes simultaneously by including the key step of imputing the significance of missing replicates. we also propose several other variants of this framework as a basis for comparison using three types of evaluation metrics.

notation
before presenting our framework, we first introduce several concepts and notations that are used in the following sections. we are given k gene expression datasets gej = , j =  <dig>  ···, k, where the dataset gej comprises the gene set gj and the sample set sj. let gi and gu denote the intersection   

and union   

of all gene sets, respectively. if the gene gi ∈ gu is not measured in the dataset gej, j ∈ {  <dig>  ···, k}, we call it a missing replicate. a gene that has no missing replicates is called a complete gene. otherwise, it is called an incomplete gene.

note that the features are aligned by their gene symbols between datasets. while there are other strategies to align probes between studies, they are not the focus of this paper. more details about the alignment can be found in  <cit> .

if multiple probes in one dataset correspond to a single gene, the median expression level of these probes is computed for each sample.

incomplete gene meta-analysis framework
our incomplete gene meta-analysis framework computes an overall score, called a meta-score, for each gene across all datasets, by imputing the significance of missing replicates and integrating the statistical results from individual datasets. the major steps are as follows .

 <dig>  input - we are given k ≥  <dig> gene expression microarray datasets gej = , j =  <dig>  ···, k. in each dataset, the samples are labeled with different phenotypes or clinical annotations, with respect to which the differentially expressed genes can be detected.

 <dig>  candidate gene set - we have to select a candidate gene set g <dig> ⊆ gu if the gene sets differ between datasets. previous methods  only select complete genes , but we select g <dig> = gu , so that all genes are considered as candidates. let n = |g0| denote the total number of candidate genes.

 <dig>  individual scores - we apply a statistical test to each replicate gi in dataset j, so that a score xij, which could be the test statistic or p-value, is used to measure the significance of the replicate. we let   

denote the score matrix for all n genes in k datasets. the corresponding value of any missing replicate is initially undefined.

 <dig>  imputation - for each missing replicate, we impute a value  for xij so that it has a valid score. we estimate the scores of the missing replicates using a probability distribution that is conditional on the observable replicates, and also calculate the estimation error for the imputed scores.

 <dig>  meta-scores - we compute a meta-score xm  for every gene gi, characterising its overall significance across all datasets.

in the following three subsections, we discuss the details of steps  <dig> to  <dig> 

individual scores
many statistical tests could be used for measuring the significance of the differential expressions of genes. in the case of two phenotypes, we employ the hedges' g effect size  <cit> , which is defined as the standardized difference in the means between two populations. we first briefly describe the general case of estimating the hedges' g effect size from the two groups of samples for one gene in one dataset. a biased estimator is given by:   

where ē <dig> and ē <dig> are the mean values of the samples in groups  <dig> and  <dig>  respectively, and s* is the pooled standard deviation of the samples. using g in equation , an unbiased estimator g* of the population effect size is given by:   

in addition, the variance of g* can be estimated using:   

where n <dig> and n <dig> are the numbers of samples in groups  <dig> and  <dig>  respectively.

in our algorithm, we compute g* as the individual score  for each observable replicate gi in dataset j:   

while the score for each missing replicate is initially undefined.

a variant of the linear model for meta-scores
our problem corresponds to the general problem of estimating the population effect size from a given set of measurements. we first recall an existing method for estimating a population parameter used by  <cit> . the observed statistic xij in equation  for the replicate gi in dataset j is hierarchically modeled as follows:      

in this model, μi is the unknown population effect size to be estimated for gene i. a key challenge in this estimation problem is how to account for the variation within each study  as well as the variation between studies . we now consider each of these terms.

first, many factors, such as different microarray platforms or samples of different ages and regions, may affect the measurements and result in variations of the population effect size between studies. this is modeled by the error term αij in equation , which follows a normal distribution with 0-mean and . the term μij is the study-specific population effect size.

second, the other error term βij in equation  represents the variation in measuring μij due to the finite number of samples in each study. this term's variance  is estimated by equation .

an unbiased estimator of μi is given by the semi-weighted mean  <cit> :      

where  and  are estimates of the population parameters  in equation  and  in equation , respectively.

when there is no variation between studies, which indicates , every study has the identical population effect size μij = μi. in this case, the model is called a fixed-effects model . otherwise, the model is called a random-effects model , in which . the test for fem or rem and the estimate of  in equation  can be found in  <cit> .

thus, when incomplete genes are absent, we can directly use this estimate as the meta-score:   

to incorporate the imputation step described in section, we propose a variant of the above model. in our case, some of the xij are unobservable. as a consequence, the imputation of the scores for these missing replicates  will lead to an additional source of variation, which can be accounted for by introducing a new error term eij in the model:   

for all observable replicates, eij =  <dig>  this indicates that the new error term is only introduced for the missing replicates. we extend the semi-weighted mean in equation  to a form involving eij as follows:      

where  is the estimated variance of eij, which is determined by a specialized method of imputation. thus, when incomplete genes are present, we use this estimate  of the semi-weighted mean as the meta-score:   

we can explain the impact of the error term eij as follows. first, if the expectation of the error term e =  <dig>  which implies the estimate of the score of a missing replicate in equation  is unbiased:   

the estimate  in equation  is again an unbiased estimate of μi. otherwise,  could overestimate or underestimate μi. depending on the method of imputation. second, intuitively, the imputed scores will have a smaller weight  in equation , due to the inclusion of the estimated variance  of the new error term.

imputation using conditional probability
the imputation step enables the incomplete genes, which are usually neglected in previous studies, to be included in the meta-analysis.

we use a conditional probability distribution  for imputation. when detecting differentially expressed genes in multiple datasets with respect to the same type of sample labels , the scores between datasets are usually positively correlated, which reflects the consistency between datasets in terms of significant genes. otherwise, the meta-analysis is pointless. intuitively, a gene that is observed to be differentially expressed in most studies is also expected to be significant in the studies where the gene is missing. based on this, we can estimate the unobservable scores conditioned on the observable scores of the same gene in other studies.

 <dig>  distribution model
for the score matrix x = n × k in equation , we denote xi., i =  <dig> ···, n, as the vector of the ith row , and x.j, j =  <dig> ···, k, as the vector of the jth column .

in our model, the row vector xi. follows a k-dimensional normal distribution across k datasets:   

where the dimensions  are usually positively correlated.

we denote pi ⊂ { <dig>  ···, k} as the set of indices of the unobservable dimensions , and qi ⊂ { <dig>  ···, k} as the set of the observable dimensions, so that |pi| + |qi| = k and pi ∩ qi = Ø. for gene i, the distribution of the unobservable sub-vector  conditional on the observable sub-vector  is given by:         

where   

more details of the conditional multivariate normal distribution can be found in  <cit> . note that the approximate normality of the real datasets used in our experiments is shown in the additional file  <dig> 

 <dig>  parameter estimation
the above parameters μ and Σ are computed from all complete genes using maximum likelihood estimation. consequently, we can obtain the conditional probability distribution in equation .

 <dig>  imputation
given the cpd in equation , the most likely score for the missing replicates is given by the mean of the distribution. thus, the score  for missing replicate gij in equation  is imputed as an element of the sub-vector:   

where  is computed in equation .

however, the cpd allows other possible values for estimating the scores of missing replicates, which leads to the variation of imputation. the variance of this estimate, which is modeled by the error term eij in equation , is given by the diagonal elements of the covariance matrix  in  of the cpd:   

where  is computed in equation .

consequently, the imputed scores  for missing replicates in equations  and  and the estimated variance of imputation  in equations  and  can be obtained using our strategy, and are used to compute the meta-scores.

in summary, the intuition of the cpd strategy is to impute the scores of missing replicates based on the positive correlation between datasets, which is also the basis of meta-analysis. we discuss the reasons why we employ such an imputation strategy here.

 <dig>  choice of distribution: assuming a multivariate normal distribution for data is a typical way to estimate missing values in incomplete data, even if the real distribution is not exactly normal  <cit> . the multivariate normal assumption enables the use of a tractable conditional probability model and captures the correlation between datasets, which is usually present and positive when we apply statistical tests to multiple datasets with respect to the same type of clinical annotation.

 <dig>  unbiased estimation: under the proposed model, the imputation provides an unbiased estimate of the scores for missing replicates ), which is desirable for an accurate estimate of the population effect size  =  <dig> in section).

 <dig>  variation of imputation: a critical aspect of imputation is how to model the instability of estimating missing values, which is reflected as the variance of imputation ). in the survey of  <cit> , two types of imputation, "model-based imputation"  <cit>  and "multiple-imputation"  <cit>  dealt with this problem by using the em algorithm and estimating multiple values for missing entries, respectively. however, since our model itself provides an estimate of the imputation variance based on the cpd, this variance can thus be directly used in the linear model in equation . this strategy, which includes the variance of imputation as part of the model, avoids the iterative procedure in the em algorithm, which can be costly for large-scale studies. moreover, it also avoids repeatedly applying the downstream analysis to the multiple versions of imputed datasets that would arise in multiple imputation. overall, our imputation is considered to be a "composite method" comprising "model-based imputation" and "cold deck imputation"  <cit>  with a strategy of embedding the variance in the meta-analysis model.

however, the cpd model has a potential limitation due to the assumption of the multi-normal distribution in equation . in this assumption, the effect sizes of all genes follow a multi-normal distribution with the same mean . this assumption may not always hold because the effect sizes of differentially and non-differentially expressed genes may come from different distributions. on one hand, the number of differentially expressed genes is relatively small in practice, and we demonstrate its validity for imputing incomplete genes in section  <dig>  on the other hand, this issue has been considered in  <cit> , where a mixture model was proposed for differentially and non-differentially expressed genes. thus, the integration of a mixture model for refining the imputation stage will be investigated in our future work.

another potential limitation of this imputation method is the lack of modeling of the dependence between studies when estimating the true effect size in equation . although this model has assigned a smaller weight to the imputed effect sizes in order to compensate the variability of imputation, the dependence caused by the cpd in equation  has not been taken into account. a topic for future research is to establish a model that incorporates this inter-study dependence.

comparable methods
in addition to the algorithm described above, we have also implemented several other methods to evaluate the importance of including incomplete genes and properly imputing their significance. the hedges' g effect size  <cit>  is used in all methods to compute the individual scores, and the model described in section is used to compute the meta-scores. the comparable methods that we have implemented are as follows.

 <dig>  intersection: all incomplete genes are discarded as in earlier meta-analysis methods. thus, the candidate gene set g <dig> is the intersection of the gene sets in all datasets . the imputation step is not necessary. in this case, igm is equivalent to the method of  <cit> .

 <dig>  ignore: both complete genes and incomplete genes are taken into account, by simply ignoring the missing replicates in the incomplete genes. meta-scores are computed based only on the observable replicates in the incomplete genes. a typical example of this type of method can be found in  <cit> .

these comparable methods are designed for different purposes. by comparing with the intersection method, we can show the importance of including incomplete genes. the ignore method is also considered because it is the simplest way of incorporating incomplete genes.

evaluation metrics
in order to evaluate the statistical significance of the differential expression of genes, we use the false discovery rate estimated by the permutation test  <cit>  as our metric. we also use the gene ontology  <cit>  to assess the significance of the biological processes that are enriched in the significant genes identified by our methods. in the additional file  <dig> we also consider the effect of incomplete genes on classification accuracy.

false discovery rate
the false discovery rate  <cit>  is defined as the ratio of the number of false positives to the number of features declared significant according to a specific ranking of features. however, when the gold standard for the true positives is not available, the fdr is usually estimated from the data. in our experiments, we employed the permutation test used by  <cit>  and  <cit>  to estimate the fdr.

the idea behind this method  <cit>  is to estimate the number of false positives at a given significance level by randomly permuting the labels of samples. we assume that we need to estimate the fdr at the significance level of xm , which is the meta-score of gi and is ranked ri from the most to least significant. in the bth permutation, the labels of samples are independently permuted in every dataset, ensuring that the number of samples in each class is unchanged. we then repeat the process of meta-analysis, and produce a vector of meta-scores  in this permutation. for the unpermuted meta-score xm  associated with gi, the number of false positives is estimated as the number of permuted meta-scores greater than or equal to xm  in this permutation. after a total number of b permutations, the expected number of false positives  is computed as the average number of false positives across all permutations. consequently, the fdr at xm  is the ratio of efp to the number of genes declared significant at the threshold of xm , which is the rank ri.      

gene ontology significance
to assess the ability to identify significantly over-represented go terms, we compute the significance of go terms associated with each subset of significant genes ranked by our methods. a p-value is computed for each go term using fisher's exact test, where a small p-value implies that this term is significantly over-represented. in our experiments, we only consider the gene odontology branch "biological process."

RESULTS
in this section, we first summarise the igm algorithm whose details are described in section. we then apply the igm algorithm as well as the other approaches in section to three separate sets of gene expression microarrays: five breast cancer datasets generated on the same platform, three gastric cancer datasets from different platforms and eleven different types of cancer datasets from the same platform. by comparing their performance in terms of the false discovery rate and the gene ontology terms, we show that compared with the other approaches igm is more able to identify significant genes and go terms that have been proven to be closely related to these cancers by the previous literature.

while our aim is to support meta-analysis across different microarray platforms, we first need to test the accuracy of our approach under controlled conditions. we achieve this in section by analysing five breast cancer datasets from the same platform, where we can simulate incomplete genes by randomly removing genes from each dataset. in this way, we can validate the accuracy our method by comparing the results of meta-analysis with and without the incomplete genes. having evaluated the accuracy of our approach under controlled conditions, we then evaluate its performance on three gastric cancer datasets that were generated on different platforms in section. finally, we test our method on a larger scale of  <dig> cancer datasets.

igm algorithm
we summarise the key steps of the igm algorithm as follows.

 <dig>  input - k  gene expression microarray datasets gej = , j =  <dig>  ···, k.

 <dig>  alignment - calculate the union set of features in all studies , n = |gu|

 <dig>  effect sizes - compute the effect size xij of each feature i in study j for all features in gu .  

 <dig>  imputation - impute the statistic of the missing replicates in the above score matrix x using the cpd method in section. the scores matrix with imputed significance is denoted as:  

 <dig>  meta-score - compute the meta-scores xm  for all features based on the score matrix x' using the model in section.

in our implementation, we have also provided an option to filter out the features with only a small proportion  of observable replicates in order to avoid unstable imputation.

in addition, we also implemented the intersection and ignore methods in section by specifying different options in the framework in section. these two methods are the basis of comparison with our method in the evaluation. the main igm program was implemented in matlab and the source code is provided in the additional file  <dig> 

controlled evaluation of accuracy in breast cancer datasets
as a first step, we need to evaluate the accuracy of our igm. however, this raises the question of how to measure accuracy in the absence of any ground truth of the significance of each gene, especially for incomplete genes. in order to generate such a ground truth for a controlled evaluation, we have simulated missing replicates in five breast cancer datasets from the same platform. in this way, we can compare the accuracy of the meta-scores generated for each gene with simulated missing replicate, by making a comparison with the meta-scores generated where all replicates are present in the original datasets. the meta-scores from the original datasets with no missing replicates thus become a "gold standard" for our evaluation, since using more samples leads to more reliable results. the results of our evaluation are presented in section and.

breast cancer datasets
we used five public breast cancer datasets from ncbi geo  <cit> : gse <dig>  <cit> , gse <dig>  <cit> , gse <dig>  <cit> , gse <dig>  <cit> , and gse <dig>  <cit> , all on the affymetrix hg-u133a platform. the phenotype was a binary label  years to metastasis.

simulating missing replicates
assuming that the probes are missing in each dataset independently, we randomly removed a proportion of probes  from each dataset to simulate missing replicates. we then tested each meta-analysis approach on these datasets with simulated missing replicates. subsequently, by comparing the results with the gold standard , we can evaluate the ability of the approach to estimate the significance of incomplete genes.

fdr comparison
in this section, by comparing the fdr between different methods, we demonstrate that igm is able to better estimate the significance of incomplete genes than the intersection and ignore methods. we first applied the framework in section to the original five datasets without any missing replicates  to generate a gene ranking, and computed the fdr using the permutation method in section as the gold standard for comparison. in this case, igm is equivalent to the method in  <cit> . we then generated  <dig> groups of datasets with simulated missing replicates using the approach described in section. for each group of datasets, we generated a ranking of all probes using igm as well as the other methods, and computed the average fdr across the  <dig> groups of datasets for each method. the resulting fdr  versus the number of probes declared significant for the "gold standard", igm and the comparable methods, are shown in figure  <dig>  in addition, the 5% and 95% quantiles of the fdr across all  <dig> simulations are shown at several positions to demonstrate the significance of the differences between these methods.

in our comparison, we consider that the probe ranking generated on the original datasets without any missing replicates, where most information is available, is most reliable, and we refer to this as our "gold standard". note that the fdr for the gold standard is non-zero because some genes in the original dataset are significant just by chance.

all methods when applied to the datasets with simulated missing replicates produce the same results for complete genes; the difference between these methods is reflected in their ability to estimate the significance of incomplete genes.

we analyse the cause of the overestimation of the fdr as follows. if some incomplete genes are often assigned less significant scores by a particular method than the significance level that they should have in the gold standard, these genes have a greater chance to be counted as false positives . in this case, the fdr is likely to be overestimated due to the increased number of false positives. for example, in figure  <dig> since the intersection method discarded all incomplete genes, which is equivalent to assigning the least significant score  to them, the fdr is overestimated compared to the gold standard. in the ignore method, the estimated significance of incomplete genes is merely determined by the observable replicates and the inter-study correlation is neglected. thus, the estimated significance is likely to be distorted by those observable values, and so the estimated fdr deviates from the "gold standard".

thus, we aim to develop a meta-analysis method that generates an fdr as close as possible to the fdr generated by the gold standard, indicating that this method is able to precisely estimate the significance of probes even though some replicates are missing. in this regard, our approach outperforms the others, since it is closest to the gold standard, and the significance of this difference in the fdr distributions is demonstrated by figure  <dig> 

gene ontology terms
to further compare the ability of each method to find a more significant set of genes, we have also evaluated the go terms found in the five breast cancer datasets.

in this experiment, we used the probe rankings produced by the gold standard, intersection and igm, which are identical to the results in section. based on these rankings, a subset of significant probes  were selected for each method and each simulation of missing replicates. to assess the significance of enrichment, we used fisher's exact test to compute the p-values of go enrichment in these significant subsets. the biological process branch was used. subsequently, for the intersection and igm methods, we computed the geometric mean of the p-values of the go terms from all  <dig> simulations, in order to generate a single integrated list of go terms as a basis for comparison with the terms produced by the gold standard. in table  <dig> the top four go terms for each method are listed.

top four go terms that are over-represented in the set of significant probes generated by the gold standard, igm, intersection and ignore methods in the breast cancer datasets.

as with the fdr evaluation, a good meta-analysis method is expected to reproduce the order of go terms generated by the gold standard as much as possible when missing replicates are present. before comparing the intersection and igm with the gold standard, we first show that the gold standard has effectively identified the important go terms associated with the time to metastasis of breast cancer.

a short time to metastasis  has been linked to up-regulation of the genes related to cell cycle, cell proliferation, and cell invasion  <cit> . the significant go terms generated by the gold standard confirm that the up-regulation of the biological processes related to cell cycle, such as mitotic chromosome condensation, spindle organization, dna replication and dna repair  <cit> , the processes related to signal transduction, such as phosphoinositide-mediated signaling  <cit> , and cell proliferation  <cit>  are most strongly associated with the short time to metastasis.

in order to statistically show the advantages of igm, we compared the precision and recall of the intersection and igm methods in identifying the significant go terms found by the gold standard. first, in order to establish a gold standard for comparing go terms, we selected the true significant go terms from the gold standard method by setting a threshold α on the p-values. for example, given α =  <dig> , we may find a set of go terms in the gold standard with a p-value ≤ α, and denote this set as g. second, we ordered all go terms in the other methods, including the igm, intersection and ignore methods according to their p-values separately. third, for each method , we scanned the ordered go terms from the most significant to the least significant, and declared different numbers  of go terms as significant terms . finally, for each number of terms declared significant k, we compared these terms declared significant with the true significant terms in the set g, which was previously obtained from the gold standard, and computed the precision and recall for this k. thus, we can generate a vector of precision-recall pairs for different values of k as a curve shown in figure  <dig>  this procedure is similar to the generation of a roc curve.   

similarly, the roc curves of go terms can be also generated for different thresholds. we show the comparison of roc curves between the igm, intersection and ignore methods in figure  <dig>  the results confirmed that our igm method was closest to the gold standard in terms of reproducing the significant go terms.

we have computed the correlation coefficients of the go terms between the igm, intersection and ignore methods and the gold standard, and the result in the form of a scatter plot is shown in figure  <dig>  the left figure shows the scatter plot of all go terms between the three methods and the gold standard. our igm method reproduced the go terms and their significance from the gold standard better than the other two methods, because it achieved the largest agreement with the gold standard . in addition, we also computed the agreement of the go terms between the igm, intersection and ignore methods in the right figure. the full list of these ranked go terms for all methods is provided in the additional file  <dig> 

real missing replicates in gastric cancer datasets
gastric cancer datasets
we tested our igm algorithm on three gastric cancer datasets, which we refer to as the australian dataset  <cit>  , the hong kong dataset  <cit>   and the japanese dataset  <cit>  . these three datasets were generated on different spotted cdna platforms and do not possess an identical set of probes. we aligned the features by their gene symbols. since we focused on the signatures discriminating two well-known subtypes of gastric cancer, diffuse and intestinal, according to lauren's classification  <cit> , only the tumor samples were retained. the australian dataset has  <dig> diffuse samples and  <dig> intestinal samples, the hong kong dataset has  <dig> diffuse samples and  <dig> intestinal samples, and the japanese dataset has  <dig> diffuse samples and  <dig> intestinal samples.

gene ontology terms
we evaluated the significance of go terms enriched in the top ranked genes in the gastric cancer datasets. we applied all methods to all three gastric cancer datasets, and set a threshold of fdr ≤  <dig>  to produce a subset of significant genes based on the resulting ranks using each method. the fdr was estimated using the approach in section. we used gostat  <cit>  to detect the enriched go terms for each subset of significant genes and to generate the corresponding fdr-corrected p-values  <cit> . in table  <dig> we show the top go terms over-represented in the groups of significant genes. note that the significant genes were divided into two groups, which are prominently over-expressed in the diffuse and intestinal subtypes, respectively.

top four go terms over-represented in the subset of genes that are prominently over-expressed in diffuse and intestinal  subtypes of gastric cancer.

since a few incomplete genes were included in the significant set and participated in some biological processes closely associated with a particular subtype of gastric cancer, such as "biological adhesion" enriched in the diffuse subtype , the genes identified by igm resulted in more over-represented terms that have been validated to be related to these subtypes in the previous literature  than the intersection method. under a threshold of the corrected p-value ≤  <dig> , igm resulted in  <dig> significant terms while the intersection method resulted in only  <dig> significant terms. this result is consistent with what we observed in the breast cancer datasets.

a validation on  <dig> cancer datasets
in order to validate the empirical performance on a larger number of studies, we have applied our method and the intersection, ignore methods to a group of  <dig> datasets with different types of cancer with the purpose of discriminating normal and cancer samples. a similar application can be also found in  <cit> . these datasets are all publicly available in geo  <cit>  .

all  <dig> datasets were selected on the affymetrix hg-u133a platform in order to conduct the same evaluation as for the breast cancer datasets. we used identical settings with the experiments of the five breast cancer datasets except that the proportion of missing values in each dataset was set to 10% instead of 30% in order to retain enough features for the intersection method. the fdr comparison for all the methods is shown in figure  <dig> 

as shown in figure  <dig> our igm method still performs better than the intersection and ignore methods in terms of fdr, since it is closest to the gold standard in the entire range. however, the performance of igm is closer to the ignore method than the result for the breast cancer datasets .

due to the noise and inconsistency when the number of studies increases, the inter-study correlation may decrease. as a result, the imputation based on the inter-study correlation may not be as effective as the situation where a significant positive inter-study correlation exists .

thus, this might be a reason for the reduced difference between our igm method and the ignore method. a previous study  <cit>  considered the inter-study concordance in order to assess whether these studies are worthy of being integrated. thus, as future work, we may take into account the inter-study concordance into the imputation step of our algorithm in order to improve the performance in large scale studies.

discussion
here we discuss the biological relevance of the genes and go terms that are over-expressed in the diffuse and intestinal subtypes separately.

compared to intestinal gastric cancer, the most significant feature of the diffuse subtype is the poor differentiation caused by the invasion of tumor cells to the stroma  <cit> .

the term "extracellular structure organization and biogenesis" and its descendent term, "extracellular matrix organization and biogenesis", which are associated with an important component of tumor invasion and metastasis, the extracellular matrix   <cit> , were over-represented in our experiment. in these terms, aside from the genes col4a <dig>  col6a <dig> and col14a <dig> belonging to the collagen family, tenascin-x , which was described as a metastasis signature in breast cancer  <cit> , was also up-regulated in our experiment but has not previously been reported for gastric cancer. this is a potentially new discovery and provides a focus for further investigation.

another feature of the diffuse subtype, active cell mobility, e.g., over-expression of caldesmon  <dig> , stimulates the invasion and metastasis of tumor cells  <cit> . this was reflected by the over-representation of the term "cell mobility" and its parent "localization of cell" in our experiment.

a few genes, such as the receptor tyrosine-protein kinase erbb- <dig> , which is related to growth factors  <cit> , and dual specificity protein kinase   <cit> , which is related to cell proliferation, were found to be up-regulated in the intestinal gastric cancer samples. the over-expression of these features were reflected by the over-representation of several terms related to "cell cycle", such as "mitotic cell cycle" and "m phase of miotic cell cycle".

by analysing the statistically significant terms and their biological relevance, we observe that the gene sets identified by igm result in more significant go terms, which are closely associated with particular subtypes of gastric cancer according to the previous literature. this demonstrates both the value of including incomplete genes and the ability of igm to better reproduce the cancer related genes and the corresponding go terms that have been validated by the previous literature.

CONCLUSIONS
meta-analysis has been widely used for identifying a more robust set of differentially-expressed genes by integrating multiple microarray datasets. however, some genes with missing replicates, which we referred to as incomplete genes, were neglected in previous studies. these genes may also be biologically significant though their statistical significance is not confirmed by all studies. in this paper, we developed incomplete gene meta-analysis for incorporating incomplete genes into the meta-analysis. we have shown that the gene rankings generated by igm were able to identify more statistically significant genes from incomplete genes in terms of fdr, indicating the benefit of including the incomplete genes. we also applied our algorithm and the traditional methods to three gastric cancer datasets. the over-represented go terms in each set of significant genes implied that the subsets generated by igm contained more genes that were associated with the important go terms relevant to particular clinical annotations in both the breast cancer and gastric cancer datasets. taken together, these results indicate the benefit in analysing the incomplete genes in addition to complete genes, and demonstrate that igm is able to appropriately estimate the significance of incomplete genes.

authors' contributions
fs, under the supervision of cl and ak, developed the major part of the methodology and ran the major part of the experiments. ga contributed to the gene ontology evaluation of the results in the manuscript and the classification evaluation in the additional file  <dig>  ih contributed to the biological analysis of the results. all authors contributed to the writing and modifications of the manuscript.

supplementary material
additional file 1
supplement. the supplement contains an analysis of the normality in the five breast cancer datasets, a correlation analysis of the significant genes identified in the five breast cancer datasets, significant gene ontology terms in the three gastric cancer datasets and the accuracy of classification in both breast and gastric cancer datasets.

click here for file

 additional file 2
source code. this additional file contains the source code of the program of our igm framework, which was implemented using matlab. in addition, a brief description is included to instruct the use of this matlab program.

click here for file

 additional file 3
ranked go list. this additional file contains the full lists of go terms which are ranked according to their significance in the breast cancer datasets. the go terms for the gold standard, igm, intersection and ignore methods are all included in this table.

click here for file

 acknowledgements
this work was supported by the australian research council, and by the nicta victorian research laboratory. nicta is funded by the australian government as represented by the department of broadband, communications and the digital economy and the australian research council through the ict center of excellence program.
