BACKGROUND
a key goal in cancer genomics is to map out the activation levels of cancer-relevant pathways across clinical tumour specimens  <cit> . obtaining pathway activity levels is important for several reasons. first, it reduces the genomic complexity from tens of thousands of features to measurements on only dozens of relevant pathways, thus circumventing the significant problems associated with multiple testing  <cit> . second, it represents an important step towards understanding the functional effects of genomic and epigenomic abnormalities in clinical tumours  <cit> . third, obtaining molecular pathway correlates of clinical and imaging traits may help improve current prognostic and predictive models as well as provide us with important new biological insights  <cit> .

however, obtaining reliable estimates of molecular pathway activity is a challenging endeavour. various gene expression based approaches have been used to address this problem. initial methods focused on inferring differential pathway activity between biological conditions using gene set enrichment analysis methods  <cit> . these methods used prior knowledge pathway databases, but only treated pathways as unstructured lists of genes. proper systems biology approaches that attempt to infer differential pathway activity by combining highly curated structural networks of molecular interactions  with transcriptional changes on these networks were subsequently developed  <cit> . these systems biology approaches can be distinguished depending on whether the discriminatory genes or gene subnetworks are inferred de-novo in relation to a phenotype of interest  <cit> , or whether the molecular pathway models are given as prior information  <cit> . these latter methods are particularly appropriate in conjunction with prior information pathway resources such as netpath  <cit> . it is important to stress again that most of these methods  are geared towards measuring differential pathway activity and are thus supervised in the sense that the phenotypic information is used from the outset to infer discriminatory genes or gene subnetworks.

another set of gene expression based approaches are based on deriving perturbation signatures of activation or inhibition in model cell systems and are based on the assumption that the measured downstream transcriptional consequences of the upstream perturbations constitute faithful representations of upstream pathway activity  <cit> . by correlating these in-vitro perturbation mrna signatures to a sample gene expression profile one may infer pathway activity in individual samples, for example in tumours where one may wish to know the potential functional impact of a particular oncogenic amplification  <cit> .

mathematically, a perturbation signature has the structure of a gene list with associated weights informing us if a gene in the list is up or downregulated in response to gene/pathway activation. similarly, the netpath signatures consist of curated lists of genes reported to be up or downregulated in response to pathway activation, and of genes reported to be implicated in the signal transduction of the pathway  <cit> . thus, at an elementary level, all of these pathway signatures can be viewed as gene lists with associated weights which can be interpreted as prior evidence for the genes in the list to be up or downregulated.

a common theme of most of the pathway activity estimation procedures described above is the assumption that all of the prior information relating to the pathway is relevant, or that it is all of equal relevance, in the biological context in which the pathway activity estimates are desired. while one would attempt to minimize differences between the biological contexts, this is often not possible. for instance, an in-vitro derived perturbation signature may contain spurious signals which are specific to the cell-culture but which are not relevant in primary tumour material. similarly, a curated signal transduction pathway model may include information which is not relevant in the biological context of interest. given that personalised medicine approaches are proposing to use cell-line models to assign patients the appropriate treatment according to the molecular profile of their tumour  <cit> , it is therefore important to develop algorithms which allow the user to objectively quantify the relevance of the prior information  before pathway activity is estimated  <cit> . similarly, there is a growing interest in obtaining molecular pathway correlates of imaging traits, such as for example mammographic density in breast cancer  <cit> . this also requires careful evaluation of prior pathway models before estimating pathway activity. more generally, it is still unclear how best to combine the prior information in perturbation expression signatures or pathway databases such as netpath with cancer gene expression profiles.

the purpose of this manuscript is four-fold. first, to highlight the need for denoising prior information in the context of pathway activity estimation. we demonstrate, with explicit examples, that ignoring the denoising step can lead to biologically inconsistent results. second, we propose an unsupervised algorithm called dart  and demonstrate that dart provides substantially improved estimates of pathway activity. third, we use dart to make an important novel prediction linking estrogen signalling to mammographic density data in er positive breast cancer. fourth, we provide an assessment of the netpath resource information in the context of breast cancer gene expression data.

while an unsupervised algorithm similar to dart was used in our previous work  <cit> , we here provide the detailed methodological comparison of dart with other unsupervised methods that do not attempt to de-noise prior information, demonstrating the viability and critical importance of the denoising step. finally, we also evaluate dart against a state of the art supervised method, called condition responsive genes   <cit> , and show that, despite dart being unsupervised, that it performs similarly to corg. dart is available as an r-package from cran.r-project.org.

methods
perturbation signatures
we considered three different perturbation signatures, all derived by a perturbation  affecting a single gene in a cell-line model. specifically, the perturbation signatures were an erbb <dig> perturbation signature derived by stably overexpressing erbb <dig> in an er+ breast cancer cell line   <cit> , a myc perturbation signature derived using a recombinant adenovirus to overexpress myc in human mammary epithelial cells  <cit> , and finally a tp <dig> perturbation signature derived by inhibition of protein synthesis by cycloheximide  in a human lung cancer cell-line  <cit> . erbb <dig> and myc are well-known oncogenes in a wide range of cancers, including breast cancer  <cit> . tp <dig> is the tumour suppressor gene which is most frequently inactivated in cancer  <cit> .

the netpath resource
the netpath resource  <cit>   is a growing, highly curated, database of important signal transduction pathways relevant to cancer and immunology. at the most elementary level these pathways consist of genes whose coding proteins are implicated in the actual signal transduction pathway as well as downstream genes that have been reported to be up and downregulated in response to pathway stimuli. this list of up and downregulated genes therefore provides a measure of pathway activity, provided these genes are relevant in the given biological context. to ensure that correlations between two different pathway activity levels were not due to trivial overlaps of their downstream transcriptional modules, we always calculated activity inference for each pathway in a given pair by only considering the mutually exclusive gene sets. of all netpath signatures, we considered ones which have been documented to play important roles in cancer tumour biology, cancer immunology and tumour progression, specially in breast cancer: a6b <dig> , ar , bcellreceptor, egfr <dig> , il <dig> , <dig> , <dig> , <dig>  , kitreceptor , notch , rankl  is a member of tumor necrosis factor  superfamily), tcellreceptor, tgfb  and tnfa . because of the documented role of these pathways in breast cancer, these were used in the context of primary breast cancer gene expression data sets.

gene expression data sets used
we used a total of six breast cancer gene expression data sets. four data sets were profiled on affymetrix platforms, "wang"  <cit> , "loi"  <cit> , "mainz"  <cit>  and "frid"  <cit> , while the other two were profiled on illumina beadarrays, "nch"  <cit>  and "gh"- a small subset of the data published in  <cit> . normalized copy-number calls were available for three data sets: wang  <cit> , nch  <cit>  and gh  <cit> . the "wang data set"  <cit>  had the largest sample size , and hence was used as the training/discovery set, while the other five data sets were used to evaluate and compare the consistency of activity inference obtained using the different methods.

we also considered five lung cancer/normal expression data sets  <cit> . one data set  consisted of  <dig> lung cancers and  <dig> normal samples  <cit> . another set  consisted of  <dig> matched pairs of normal/cancer lung tissue   <cit> . the third set  consisted of  <dig> normal lung samples and  <dig> lung cancers  <cit> . the fourth set  consisted of  <dig> lung cancers and  <dig> normal lung samples  <cit>  and finally the fifth set  consisted of  <dig> matched lung cancer/normal pairs. all of these expression sets used the affymetrix human genome u133a or u <dig> plus  <dig>  array. we used the "landi" set for the training/discovery of the pruned relevance network and the rest as validation studies.

mammogram density scoring
mammograms consisted of original standard mediolateral oblique and craniocaudal views and mammographic density was scored by an independent consultant radiologist. as all patients had been diagnosed with malignancy, the density of the tumour itself was scored on a scale from 1- <dig>  without inclusion of normal breast tissue.

dart: denoising algorithm based on relevance network topology
we assume a given pathway p with prior information consisting of genes which are upregulated in response to pathway activation pu and genes which are downregulated pd. let nu and nd denote the corresponding number of up and downregulated genes in the pathway. we point out that for the given prior pathway information, nu or nd may be zero, in other words, dart does not require both to be non-zero. given a gene expression data set x of g genes and ns samples, unrelated to this prior information, we wish to evaluate a level of pathway activation for each sample in x.

before estimating pathway activity we argue that the prior information needs to be evaluated in the context of the given data. for example, if two genes are commonly upregulated in response to pathway activation and if this pathway is indeed activated in a given sample, then the expectation is that these two genes are also upregulated in this sample relative to samples which do not have this pathway activated. in fact, given the set of a priori upregulated genes pu we would expect that these genes are all correlated across the sample set being studied, provided of course that this  prior information is reliable and relevant in the present biological context and  that the pathway shows differential activity across the samples. thus, we propose the following strategy to arrive at improved estimates of pathway activity:

 <dig>  compute and construct a relevance correlation network of all genes in pathway p.

 <dig>  evaluate a consistency score of the prior regulatory information of the pathway by comparing the pattern of observed gene-gene correlations to those expected under the prior.

 <dig>  if the consistency score is higher than expected by random chance, the consistent prior information may be used to infer pathway activity. the inconsistent prior information must be removed by pruning the relevance network. this is the denoising step.

 <dig>  estimate pathway activity from computing a metric over the largest connected component of the pruned network.

we consider three different variations of the above algorithm in order to address two theoretical questions:  does evaluating the consistency of prior information in the given biological context matter and does the robustness of downstream statistical inference improve if a denoising strategy is used?  can downstream statistical inference be improved further by using metrics that recognise the network topology of the underlying pruned relevance network? we therefore consider one algorithm in which pathway activity is estimated over the unpruned network using a simple average metric  and two algorithms that estimate activity over the pruned network but which differ in the metric used: in one instance we average the expression values over the nodes in the pruned network , while in the other case we use a weighted average  where the weights reflect the degree of the nodes in the pruned network. the rationale for this is that the more nodes a given gene is correlated with, the more likely it is to be relevant and hence the more weight it should receive in the estimation procedure. this metric is equivalent to a summation over the edges of the relevance network and therefore reflects the underlying topology  <cit> .

next, we clarify how dart was applied to the various signatures considered in this work. in the case of the perturbation signatures, dart was applied to the combined upregulated and downregulated gene sets, as described above. in the case of the netpath signatures  we were interested in also investigating if the algorithms performed differently depending on the gene subset considered . thus, in the case of the netpath signatures we applied dart to the up and down regulated gene sets separately. this strategy was also partly motivated by the fact that most of the netpath signatures had relatively large up and downregulated gene subsets.

constructing expression relevance networks
given the set of transcriptionally regulated genes and a gene expression data set, we compute pearson correlations between every pair of genes. the pearson correlation coefficients were then transformed using fisher's transform

  yij=12log1+cij1-cij 

where cij is the pearson correlation coefficient between genes i and j, and where yij is, under the null hypothesis, normally distributed with mean zero and standard deviation 1∕ns- <dig> with ns the number of tumour samples. from this, we then derive a corresponding p-value matrix. to estimate the false discovery rate  we needed to take into account the fact that gene pair correlations do not represent independent tests. thus, we randomly permuted each gene expression profile across tumour samples  and selected a p-value threshold  that yielded a negligible average fdr . gene pairs with correlations that passed this p-value threshold were assigned an edge in the resulting relevance expression correlation network.

the estimation of p-values assumes normality under the null, and while we observed marginal deviations from a normal distribution , the above fdr estimation procedure is equivalent to one which works on the absolute values of the statistics yij. this is because the p-values and absolute valued statistics  are related through a monotonic transformation, thus the fdr estimation procedure we used does not require the normality assumption.

evaluating significance and consistency of relevance networks
the consistency of the derived relevance network with the prior pathway regulatory information was evaluated as follows: given an edge in the derived network we assigned it a binary weight  depending on whether the correlation between the two genes is positive  or negative . this binary weight can then be compared with the corresponding weight prediction made from the prior, namely a  <dig> if the two genes are either both upregulated or both downregulated in response to the oncogenic perturbation, or - <dig> if they are regulated in opposite directions. thus, an edge in the network is consistent if the sign is the same as that of the model prediction. a consistency score for the observed network is obtained as the fraction of consistent edges. to evaluate the significance of the consistency score we used a randomisation approach. specifically, for each edge in the network the binary weight was drawn from a binomial distribution with the binomial probability estimated from the whole data set. we estimated the binomial probability of a positive weight  as the fraction of positive pairwise correlations among all significant pairwise correlations. a total of  <dig> randomisations were performed to derive a null distribution for the consistency score, and a p-value was computed as the fraction of randomisations with a consistency score higher than the observed one.

pathway activation metrics
first, we define the single-gene based pathway activation metric. this metric is similar to the subnetwork expression metric used in the context of protein-interaction networks  <cit> . the metric over the network  of size m is defined as,

  s→av=1m∑i∈nσiz→i 

where z→i denotes the z-score normalised  expression profile of gene i across the samples and σi denotes the sign of pathway activation , i.e σi =  <dig> if upregulated upon activation, σi = - <dig> if downregulated. thus, this metric is a simple average over the genes in the network and does not take the underlying topology into account. an alternative is to weight each gene by the number of its neighbors in the network

  s→wav=1Σi∈nki <dig> ∑i∈nσikiz→i 

where ki is the number of neighbors of gene i in the network. normally, this would include neighbors that are both in pu and in pd. the normalisation factor ensures that sw av, if interpreted as a random variable, is of unit variance.

simulated data
to test the principles on which our algorithm is based we generated synthetic gene expression data as follows. we generated a toy data matrix of dimension  <dig> genes times  <dig> samples. we assume  <dig> samples to have no pathway activity, while the other  <dig> have variable levels  of pathway activity. the  <dig> genes are all assumed to be part of a given pathway, but only  <dig> are assumed to faithfully represent the pathway in the synthetic data set. specifically, the data is simulated as

 x1s~δs≤40n+δs>40nx2s~δ∪n+δ∪nx3s~δs≤80n+δ80<s 

where n denotes the normal distribution of the given mean and standard deviation , and where δ is the kronecker delta such that δx =  <dig> if and only if condition x is true. the rest of the genes are modelled from the same distributions but with σ <dig> replacing σ <dig>  thus these genes are subject to large variability and don't provide faithful representations of the pathway. thus, in this synthetic data set all genes are assumed upregulated in a proportion of the samples with pathway activity but only a relatively small number are not subject to other sources of variation. we point out that the more general case of some genes being upregulated and others being downregulated is in fact subsumed by the previous model, since the significance analysis of correlations or anticorrelations is identical and since the pathway activation metric incorporates the directionality explicitly through a change in the sign of the contributing genes.

we also consider an alternative scenario in which only  <dig> genes are upregulated in the  <dig> samples. of the  <dig> genes,  <dig> are generated as above with σ <dig> =  <dig>  and the other  <dig> with σ <dig> =  <dig>  the rest of genes are modelled as n and are therefore not discriminatory. we call this synthetic data set "simset2", while the previous one we refer to as "simset1".

the algorithms described previously are then applied to the simulated data to infer pathway activity levels. to objectively compare the different algorithms we apply a variational bayesian gaussian mixture model  <cit>  to the pathway activity level. the variational bayesian approach provides an objective estimate of the number of clusters in the pathway activity level profile. the clusters map to different activity levels and the cluster with the lowest activity level defines the "ground state" of no activation. hence we can compare the different algorithms in terms of the accuracy of correctly assigning samples with no activity to the ground state and samples with activity to any of the higher levels, which will depend on the predicted pathway activity levels.

evaluation based on pathway correlations
one way to evaluate and compare the different estimation procedures is to consider pairs of pathways for which the corresponding estimated activites are significantly correlated in a training set and then see if the same pattern is observed in a series of validation sets. thus, significant pathway correlations derived from a given discovery/training set  can be viewed as hypotheses, which if true, must validate in the independent data sets. we thus compare the algorithms in their ability to identify pathway correlations which are also valid in independent data.

specifically, for a given pathway activity estimation algorithm and for a given pair of pathways , we first correlate the pathway activation levels using a linear regression model. under the null, the z-scores are distributed according to t-statistics, therefore we let tij denote the t-statistic and pij the corresponding p-value. we declare a significant association as one with pij <  <dig> , and if so it generates a hypothesis. to test the consistency of the predicted interpathway pearson correlation in the validation data sets d, we use the following performance measure vij:

  vij= ∑d∈dσijtijspij 

where the summation is over the validation sets, s is the threshold function of pij defined by

  s=1ifpij≤ <dig> ifpij> <dig>  

and where

  σij=1ifsign)=sign),d∈d-1ifsign)=-sign),d∈d 

in the above, tij is the t-statistic of interpathway correlation estimated in validation set d ∈ d and tij de-notes its absolute value. thus, the quantity vij takes into account the significance of the correlation between the pathways , penalizes the score if the directionality of correlation is opposite to that predicted ) and weighs in the magnitude of the correlation association tij. for each method, we thus obtain a set of hypotheses h=:pij< <dig>  and consistency scores over h:v=vij:∈h. finally, an objective comparison between two different methods  for pathway activity estimation can be achieved by comparing the distribution of v to that of v over the common hypothesis space i.e h∩h. for this we used a two-tailed paired wilcoxon test.

RESULTS
we argue that more robust statistical inferences regarding pathway activity levels and which use prior knowledge from pathway databases can be obtained by first evaluating if the prior information is consistent with the data being investigated . if the expression level of a certain set of genes faithfully represents pathway activity and if these genes are commonly upregulated in response to pathway activation, then one would expect these genes to show significant correlations at the level of gene expression across a sample set, provided of course that differential activity of this pathway accounts for a proportion of the data variance. thus, one may use a gene expression data set to evaluate the consistency of the prior information and to filter out the information which represents noise.

simulated data
to test the principle  we first generated synthetic data where we know which samples have a hypothetical pathway activated and others where the pathway is switched off . we considered two different simulation scenarios as described in methods to represent two different levels of noise in the data. next, we applied three different methods to infer pathway activity, one which simply averages the expression profiles of each gene in the pathway , one which infers a correlation relevance network, prunes the network to remove inconsistent prior information and estimates activity by averaging the expression values of the genes in the maximally connected component of the pruned network . the third method also generates a pruned network and estimates activity over the maximally connected subnetwork but does so by a weighted average where the weights are directly given by the degrees of the nodes . to objectively compare the different algorithms, we applied a variational bayesian clustering algorithm  <cit>  to the one-dimensional estimated activity profiles to identify the different levels of pathway activity. the variational bayesian approach was used over the bayesian information criterion or the akaike information criterion, since it is more accurate for model selection problems, particularly in relation to estimating the number of clusters  <cit> . we then assessed how well samples with and without pathway activity were assigned to the respective clusters, with the cluster of lowest mean activity representing the ground state of no pathway activity. examples of specific simulations and inferred clusters in the two different noisy scenarios are shown in figures 2a &2c. we observed that in these specific examples, dart assigned samples to their correct pathway activity level much more accurately than either upr-av or pr-av, owing to a much cleaner estimated activation profile. average performance over  <dig> simulations confirmed the much higher accuracy of dart over both pr-av and upr-av . interestingly, while pr-av performed significantly better than upr-av in simulation scenario  <dig> , it did not show appreciable improvement in simset <dig> . the key difference between the two scenarios is in the number of genes that are assumed to represent pathway activity with all genes assumed relevant in simset <dig>  but only a few being relevant in simset <dig>  thus, the improved performance of pr-av over upr-av in simset <dig> is due to the pruning step which removes the genes that are not relevant in simset <dig> 

improved prediction of natural pathway perturbations
given the improved performance of dart over the other two methods in the synthetic data, we next explored if this also held true for real data. we thus collected perturbation signatures of three well-known cancer genes and which were all derived from cell-line models. specifically, the genes and cell-lines were erbb <dig> , myc  and tp <dig>   <cit> . we applied each of the three algorithms to these perturbation signatures in the largest of the breast cancer sets  and also one of the largest lung cancer sets  to learn the corresponding unpruned and pruned networks. using these networks we then estimated pathway activity in the same sets as well as in the independent validation sets. we evaluated the three algorithms in their ability to correctly predict pathway activation status in clinical tumour specimens. in the case of erbb <dig>  amplification of the erbb <dig> locus occurs in only a subset of breast cancers , which have a characteristic transcriptomic signature  <cit> . specifically, we would expect her2+ breast cancers defined by the intrinsic subtype transcriptomic classification to have higher erbb <dig> pathway activity than basal breast cancers which are her2-  <cit> . thus, pathway activity estimation algorithms which predict larger differences between her2+ and basal breast cancers indicate improved pathway activity inference. similarly, we would expect breast cancer samples with amplification of myc  to exhibit higher levels of myc-specific pathway activity. finally, tp <dig> inactivation, either through mutation or genomic loss, is a common genomic abnormality present in most cancers. thus, tp <dig> activation levels should be significantly lower in lung cancers compared to respective normal tissue.

of the  <dig> data sets analysed, encompassing three different perturbation signatures, dart predicted with statistical significance the correct association in all  <dig>  . specifically, erbb <dig> pathway activity was significantly higher in er-/her2+ breast cancer compared to the er-/basal subtype, myc activity was significantly higher in breast tumours with myc copy number gain, and tp <dig> activity was significantly less in lung cancers  compared to normal lung tissue. in contrast, using the other two methods  predictions were either less significant  or less robust : we observed many instances where upr-av failed to capture the known biological association .

evaluation of netpath in breast cancer gene expression data
next, we wanted to evaluate the netpath resource in the context of breast cancer gene expression data. to this end we applied our algorithm to ask if the genes hypothesized to be up and downregulated in response to pathway stimuli showed corresponding correlations across primary breast cancers, which may therefore indicate potential relevance of this pathway in explaining some of the variation in the data. because of the large differences in expression between er+ and er- breast cancer the evaluation was done for each subtype separately . the inferred relevance correlation networks were sparse, specially in er-breast cancer, and for many pathways a large fraction of the correlations were inconsistent with the prior information. given the relatively large number of edges in the network even small consistency scores were statistically significant. the analysis did reveal that for some pathways  the prior information was not at all consistent with the expression patterns observed indicating that this specific prior information would not be useful in this context. the specific pruned networks and the genes ranked according to their degree/hubness in the these networks are given in additional files  <dig> , <dig> .

for both the er- and er+ breast cancer data set  <cit>  and for a number of important netpath cancer signalling and immune signalling pathways , we list some of the network properties of the inferred relevance expression correlation networks. for each molecular pathway we give the number of genes of the pathway present in the expression matrix , the number and fraction of edges  , the fraction of edges that are consistent with the prior information  and the corresponding p-value of significance . p-values were estimated using  <dig> permutations.

denoising prior information improves the robustness of statistical inference
another strategy to evaluate and compare the different algorithms is in their ability to make correct predictions about pathway correlations. knowing which pathways correlate or anticorrelate in a given phenotype can provide important biological insights  <cit> . thus, having estimated the pathway activity levels in our training breast cancer set we next identified the statistically significant correlations  between pathways in this same set. we treat these significant correlations as hypotheses. for each significant pathway pair we then computed a consistency score over the  <dig> validation sets  and compared these consistency scores between the three different algorithms. the consistency scores reflect the overall significance, directionality and magnitude of the predicted correlations in the validation sets . we found that dart significantly improved the consistency scores over the method that did not implement the denoising step , for both breast cancer subtypes as well as for the up and down regulated transcriptional modules .

expression correlation hubs improve pathway activity estimates
using the weighted average metric  also improved consistency scores over using an unweighted average , but this was true only for the up regulated modules . generally, consistency scores were also higher for the predicted up-regulated modules, which is not surprising given that the netpath transcriptional modules mostly reflect the effects of positive pathway stimuli as opposed to pathway inhibition. thus, the better consistency scores for dart over pr-av indicates that the identified transcriptional hubs in these up-regulated modules  are of biological relevance. down regulated genes might reflect further downstream consequences of pathway activity and therefore "hubness" in these modules may be less relevant. importantly, weighing in hubness in pathway activity estimation also led to stronger associations between predicted erbb <dig> activity and erbb <dig> intrinsic subtype .

dart compares favourably to supervised methods
next, we decided to compare dart to a state of the art algorithm used for pathway activity estimation. most of the existing algorithms are supervised, such as for example the signalling pathway impact analysis   <cit>  and the condition responsive genes   <cit>  algorithms. spia uses the phenotype information from the outset, computing statistics of differential expression for each of the pathway genes between the two phenotypes, and finally evaluates the consistency of these statistics with the topology of the pathway to arrive at an impact score, which informs on differential activity of the pathway between the two phenotypes. however, spia is not aimed at identifying a pathway gene subset that could be used to estimate pathway activity at the level of an individual sample, thus precluding a direct comparison with dart. corg on the other hand, while also being supervised, infers a relevant gene subset, and therefore, like dart, allows pathway activity levels in independent samples to be estimated. specifically, a comparison can be made between dart and corg by applying each to the same training set and then evaluating their performance in the independent data sets. we followed this strategy in the context of the erbb <dig>  myc and tp <dig> perturbation signatures . as expected, owing to its supervised nature, corg performed better in the three training sets. however, in the  <dig> independent validation sets , dart yielded better discriminatory statistics in  <dig> of these  <dig> sets . thus, despite dart being unsupervised in the training set, it achieved comparable performance to corg in the validation sets.

dart predicts an association between differential esr <dig> signalling and mammographic density
mammographic density is a well-known risk factor for breast cancer. indeed, women with high mammo-graphic density  have an approximately 6-fold higher risk of developing the disease  <cit> . however, no biological correlates of mmd are known  <cit> . therefore there has been a lot of recent interest in obtaining molecular correlates  of mammographic density  <cit> . based on these studies there is now considerable evidence that dysregulated oestrogen metabolism and signalling may be associated with mammographic density  <cit> , and indeed there have been reports of esr <dig> expression levels being reduced in breast tissue of high mmd  <cit> .

we thus decided to test dart in its ability to detect an entirely novel biological association, specifically we asked if dart could predict an inverse correlation between esr <dig> signalling activity and mmd. to address this we used the esr <dig> signature derived in  <cit> . we verified that this signature was able to discriminate er+ from er- tumours in all breast cancer cohorts , thus confirming that this signature is activated upon esr <dig> signalling. next, we applied dart to this signature in the wang er+ cohort to learn an associated relevance network for pathway activity estimation. we then estimated pathway actity using this relevance network in the gh er+ cohort , for which mmd scores were available. of note, dart predicted an inverse correlation between esr <dig> signalling and mmd . in contrast, not using the denoising step  failed to pick out this association .

discussion
the ability to reliably predict pathway activity of oncogenic and cancer signalling pathways in individual tumour samples is an important goal in cancer genomics. given that any single tumour is characterised by a large number of genomic and epigenomic aberrations, the ability to predict pathway activity may allow for a more principled approach of identifying driver aberrations as those whose transcriptional fingerprint is present in the mrna profile of the given tumour. this is critical for assigning patients the appropriate treatments that specifically target those molecular pathways which are functionally disrupted in the patient's tumour. another important future area of application is in the identification of molecular pathway correlates of cancer imaging traits. imaging traits, such as mammographic density, may provide important additional information, which is complementary to molecular profiles, but which combined with molecular data may provide critical and novel biological insights.

a large number of algorithms for predicting pathway activity exist and most use prior pathway models obtained through highly curated databases or through in-vitro perturbation experiments. a common feature of these methods is the direct application of this prior information in the molecular profiles of the study in question. while this direct approach has been successful in many instances  <cit> , we have also found many examples where it fails to uncover known biological associations . for example, a synthetic perturbation signature of erbb <dig> activation may not predict the naturally occuring erbb <dig> perturbation  in primary breast cancers . similarly, a synthetic perturbation signature for tp <dig> activation was not significantly lower in lung cancer compared to normal lung tissue, despite the fact that tp <dig> inactivation is a frequent event in lung cancer . we argue that this problem is caused by the implicit assumption that all prior information associated with a given pathway is of equal importance or relevance in the biological context of the given study, a context which may be quite different to the biological context in which the prior information was obtained.

to overcome this problem, we propose that the prior information ought to be tested first for its consistency in the data set under study and that pathway activity should be estimated a posteriori using only the prior information that is consistent with the actual data. we point out that this denoising/learning step does not make use of any phenotypic information regarding the samples, and therefore is totally unsupervised. thus, our approach can be described as unsupervised bayesian, and bayesian algorithms using explicit posterior probability models could be implemented. here, we used a relevance network topology approach to perform the denoising, as implemented in the dart algorithm. using multiple different in-vitro derived perturbation signatures as well as curated transcriptional modules from the netpath resource on real mrna expression data, we have shown that dart clearly outperforms a popular model which does not denoise the prior information . moreover, we have observed that expression correlation hubs, which are inferred as part of dart, improve the consistency scores of pathway activity estimates. this indicates that hubs in relevance networks not only represent more robust markers of pathway activity but that they may also be more important mediators of the functional effects of upstream pathway activity.

it is important to point out again that dart is an unsupervised method for inferring a subset of pathway genes that represent pathway activity. identification of this gene pathway subset allows estimation of path-way activity at the level of individual samples. therefore, a direct comparison with the signalling pathway impact analysis  method  <cit>  is difficult, because spia does not infer a relevant pathway gene subset, hence not allowing for individual sample activity estimates to be obtained. thus, instead of spia, we compared dart to a different supervised method  which does infer a pathway gene subset, and which therefore allows single sample pathway activity estimates to be obtained. this comparison showed that in independent data sets, dart performed similarly to corg . thus, supervised approaches may not outperform an unsupervised method  when testing in completely independent data. we also observed that corg generally yielded very small gene subsets  compared to the larger gene subnetworks inferred using dart . while a small discriminatory gene set may be advantageous from an experimental cost viewpoint, biological interpretation is less clear. for instance, in the case of the erbb <dig>  myc and tp <dig> perturbation signatures, gene set enrichment analysis  could not be applied to the corg gene modules since these consisted of too few genes. in contrast, gsea on the relevance gene subnetworks inferred with dart yielded the expected associations  but also elucidated some novel and biologically interesting associations, such as the association of a tosedostat drug signature with the myc dart module . a second important difference between corg and dart is that corg only ranks genes according to their univariate statistics, while dart ranks genes according to their degree in the relevance subnetwork. given the importance of hubs in these expression networks, dart thus provides an improved framework for biological interpretation. for instance, the protein kinase melk was the top ranked hub in the erbb <dig> dart module, suggesting an important role for this downstream kinase in linking cell-growth to the upstream erbb <dig> perturbation. interestingly, overexpression of melk is a robust poor prognostic factor in breast cancer  <cit>  and may thus contribute to the poor prognosis of her2+ breast cancers.

finally, we tested dart in a novel application to multidimensional cancer genomic data, in this instance between matched mrna expression and imaging traits of clinical breast tumours. interestingly, dart predicted an inverse correlation between esr <dig> signalling and mmd in er+ breast cancer . this association and its directionality is consistent with a study strongly implicating oestrogen metabolism  <cit>  and another reporting an inverse correlation of esr <dig> expression with mmd  <cit> . importantly, not using the denoising step in dart, completely failed to capture this potentially important and biologically plausible association.

in summary, we have shown that the denoising step implemented in dart is critical for obtaining more reliable estimates of molecular pathway activity. it could be argued that a practical drawback of the procedure is the reliance on a relatively large data set  in order to denoise the prior pathway knowledge. however, large panels of genome-wide molecular data, including expression data of specific cancers, are being generated as part of large international consortia , and since these large studies use cohorts representative of the disease demographics in question, they constitute ideal data sets to use in the context of dart. thus, we propose a strategy whereby dart is used to integrate existing pathway databases with these large expression data sets in order to obtain more reliable molecular pathway activity predictions in tumour samples derived from newly diagnosed patients.

CONCLUSIONS
the dart algorithm and strategy advocated here substantially improves unsupervised predictions of pathway activity that are based on a prior model which was learned from a different biological system or context. it will be fruitful to apply dart and further extensions of it in the context of multidimensional cancer ge-nomic data, where reliable and robust molecular pathway correlates of genomic abnormalities, clinical and imaging traits are urgently needed.

abbreviations
er+: ; er-: 

competing interests
the authors declare that they have no competing interests.

authors' contributions
yj performed most of the statistical analyses and contributed to the writing of the manuscript. aet conceived the study, performed some of the analyses and wrote the manuscript. kl and ag helped with bioinformatics and data processing. gp and aj obtained, analysed and scored the mammogram data. ap is the principal investigator at kcl for the molecular taxonomy of breast cancer international consortium programme , which funded the gene array analysis. tn designed the original concept of correlating and integrating imaging with genomic analyses, obtained funding and contributed to final writing of manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
dart modules for netpath pathways in er+ breast cancer. tables listing the pruned, consistent, maximally connected networks inferred from the application of dart to the transcriptional up and downregulated modules from netpath in the er+ subset of the wang data set.

click here for file

 additional file 2
dart modules for netpath pathways in er- breast cancer. tables listing the pruned, consistent, maximally connected networks inferred from the application of dart to the transcriptional up and downregulated modules from netpath in the er- subset of the wang data set.

click here for file

 additional file 3
hub genes in dart modules in er+ breast cancer. genes in pruned netpath pathway networks ranked according to their degree in the network.

click here for file

 additional file 4
hub genes in dart modules in er- breast cancer. genes in pruned netpath pathway networks ranked according to their degree in the network.

click here for file

 additional file 5
dart esr <dig> module in breast cancer. boxplots comparing predicted pathway activities of the doane esr <dig> signature in er+ versus er- tumours in the six different breast cancer cohorts. p-values from a t-test are given.

click here for file

 additional file 6
comparison of module genes between corg and dart. table comparing the number of genes in the corg and dart predictors of pathway activity.

click here for file

 additional file 7
gsea table for dart erbb <dig> module genes. gene set enrichment analysis table for the erbb <dig> dart gene modules . p-values are from a one-tailed hypergeometric test using the genes on the affy array  as the null background.

click here for file

 additional file 8
gsea table for dart myc module genes. gene set enrichment analysis table for the myc dart gene modules . p-values are from a one-tailed hypergeometric test using the genes on the affy array  as the null background.

click here for file

 additional file 9
gsea table for dart tp <dig> module genes. gene set enrichment analysis table for the myc dart gene modules . p-values are from a one-tailed hypergeometric test using the genes on the affy array  as the null background.

click here for file

 acknowledgements
yj and kl are supported by the kcl-ucl comprehensive cancer imaging centre , funded by cruk & epsrc, in association with the mrc and doh and cruk. aet is supported by a heller research fellowship. ag is supported by the breakthrough breast research unit funding at kcl. gp is supported by a  <dig> year fellowship from the comprehensive biomedical research centre award to guy's & st thomas' nhs foundation trust, in partnership with king's college london and king's college hospital nhs foundation trust; as well as a cancer research uk clinical training fellowship. patient tissue samples and gene expression data from guy's hospital samples  were provided by guy's & st thomas' breast tissue & data bank, which is supported by the department of health via the national institute for health research  comprehensive biomedical research centre award to guy's & st thomas' nhs foundation trust in partnership with king's college london and king's college hospital nhs foundation trust.
