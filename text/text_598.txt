BACKGROUND
computational analysis of cellular metabolism has recently gained increasing prominence and importance. in particular, genome-scale computational models capturing stoichiometric and thermodynamic constraints have been published for over  <dig> organisms  <cit>  ranging from relatively simple prokaryotes such as e. coli, to complex eukaryotes such as homo sapiens  <cit> . the application of such computational models is dependent on their accuracy and the tools developed for their analysis. the maintenance of model accuracy, or debugging, is an ongoing process by which model predictions are validated against experimental observations and discrepancies are identified and corrected. this process is clearly linked with the use and analysis of the models. these computational models can be analyzed in a number of ways. flux-balance analysis  and elementary mode analysis are perhaps two of the most popular and powerful.

fba determines a distribution of steady-state reaction fluxes that satisfies the constraints of the model and that optimizes a biological objective function such as biomass or adenosine triphosphate  production  <cit> . with appropriate constraints and a biological objective, fba has been shown to be an effective method for prediction of phenotypes associated with genetic manipulations such as knockouts  <cit>  and of intracellular metabolic fluxes  <cit> . a significant application for fba, therefore, is metabolic engineering-using computational predictions of metabolic phenotype under genetic manipulations to guide the engineering of metabolically optimized strains  <cit> -and computational methods have been devised to search the space of genetic manipulations in silico for those that yield the desired phenotype  <cit> . but, while fba has had a number of successful applications, the method gives little insight into its predictions, hindering human understanding and model debugging.

elementary mode analysis, on the other hand, yields no explicit predictions of metabolic behavior, and seeks primarily to allow understanding of an organism's metabolic capabilities. in elementary mode analysis, the elementary flux modes  that define minimal sets of reactions capable of operating at steady state are generated  <cit> . elementary flux modes formalize the concept of a biochemical pathway  <cit> , and studying the modes associated with a given metabolic network has been shown to be effective for understanding its function, regulation, and robustness  <cit> . the principal drawback of elementary mode analysis is that the number of efms in a network suffers from a combinatorial explosion  <cit> , and the use of complete sets of efms gives rise to problems with scalability when applied to genome-wide models  <cit> . for example, more than two million modes exist for a simple model of e. coli central metabolism consisting of  <dig> reactions  <cit> , which increases to more than  <dig> million modes when the possible substrates are expanded  <cit> . iaf <dig>  <cit> , the most recent genome-scale metabolic network of e. coli, consists of  <dig> reactions, and the number of reactions in e. coli metabolic models has increased steadily for the past two decades  <cit> . thus, the computation time and memory storage required to enumerate all the efms of full and detailed genome-scale metabolic networks are prohibitively large.

for many applications, however, our understanding of particular metabolic functions of an organism, such as its ability to produce a desired metabolite, is of greater interest than our understanding of its full metabolic capabilities. in this case, it is not necessary to know all the efms of the network, but simply those that combine to give rise to a particular behavior. previous approaches to this problem have relied on first computing all modes of the network  <cit> . more recently, an approach presented by de figueiredo et al.  <cit> , found biologically significant efms by identifying the k-shortest efms of the metabolic network without necessarily enumerating the whole set. our motivation is similar in that we are not concerned with generating all the efms of a network. however, our approach differs greatly in that we wish to determine those elementary modes that combine to yield a given flux distribution. this flux distribution can consist of both measured and computationally predicted fluxes.

we present an algorithm to find the elementary modes that combine to produce any previously-specified flux distribution. this links the advantages of elementary mode analysis with the advantages of flux balance analysis, without requiring the prohibitive computation of all elementary modes. our method is therefore applicable to genome-scale models and, because it can take as an input any flux distribution, it can be connected to particular experimental conditions  <cit>  or genetic modifications  <cit> .

to demonstrate the utility of our method and its applicability to genome-scale models, we apply it to genome-scale models of e. coli and mtb and show how its results can be used to interpret flux distributions related to the metabolic engineering of e. coli and to the survival of mtb during infection.

RESULTS
overview
our method takes a given steady-state metabolic flux distribution and the corresponding metabolic model, and produces a decomposition of the flux distribution into elementary flux modes. in this paper, we use flux distributions obtained by fba, but our method can equally be applied to flux distributions obtained by alternative means, such as those derived from experimental measurement or obtained from genetic perturbation analysis methods such as moma  <cit>  or room  <cit> . as an elementary flux mode is itself a set of reactions operating at steady state, any flux distribution composed entirely of elementary flux modes must necessarily operate at steady state too. therefore, an input flux distribution derived from experimental measurement may need to be balanced first to produce a steady state flux distribution, either by regression to fit the measured data or alternative means.

our method operates by first selecting the reaction with non-zero flux of maximum magnitude from the given flux distribution. the algorithm then uses mixed-integer linear programming to find an elementary flux mode that both contains the selected reaction and is contained in the given distribution. the contribution of this elementary flux mode to the given distribution is determined before it is removed to give an updated flux distribution. the updated flux distribution is used as the input distribution for the next iteration of the algorithm, and this procedure is repeated until the updated flux distribution is zero .

elementary mode decompositions are not unique. our goal is to assist in biological interpretation, and we are primarily interested in obtaining a valid decomposition rather than any specific decomposition. a valid decomposition will arise irrespective of the choice made at each iteration of the reaction with non-zero flux, but how this choice is made determines the specific decomposition. our choice has some desirable properties. as the elementary flux mode found by the mixed-integer linear program includes the chosen reaction, the flux through this reaction will upper bound the contribution of the elementary flux mode. by selecting the reaction with non-zero flux of maximum magnitude, we avoid the possibility of generating many elementary flux modes with very small weightings and hence minimal contribution to the flux distribution. this choice also minimizes numerical instabilities arising from the calculations.

although mixed-integer linear programming is np-hard in general, some large mixed-integer linear programs  can be solved with a modest amount of computation by solvers such as scip  <cit> , ibm ilog cplex , and gurobi . in particular, our algorithm, implemented using gurobi, successfully terminates in at most several seconds in all the genome-scale applications mentioned in this paper.

by contrast, previous approaches to decomposing flux distributions into elementary modes  <cit>  have relied on first generating the complete set of relevant elementary modes, then calculating a weight distribution among these modes. since elementary mode decompositions are not unique  <cit> , the principal advantage of these previous approaches in comparison to ours is that they are capable of selecting a particular unique decomposition based on some criterion , while our approach simply generates a valid decomposition among all possibilities. it is not clear, however, that criteria for selecting the weight distribution, such as the minimization of the euclidean norm, are biologically meaningful. as we will see with the examples in this paper, simply having a valid decomposition is in itself useful.

the principal drawback of these previous approaches is that generating the complete set of relevant elementary modes can be prohibitive, particularly for genome-scale models. to demonstrate this fact, we used efmtool  <cit>  to efficiently generate the relevant elementary modes for the genome-scale model of mtb by jamshidi and palsson  <cit> , inj <dig>  for growth on middlebrook 7h9-a standard growth medium for mtb. with the elementary modes generated by efmtool, we then applied the quadratic programming approach proposed by schwartz and kanehisa  <cit>  to obtain a distribution of weights to assign to these modes. the total computational time of this approach was  <dig> minutes and  <dig> seconds.

by contrast, our approach generates a valid elementary mode decomposition consisting of  <dig> modes in  <dig>  seconds-a computational time improvement exceeding 2000-fold. inj <dig> consists of  <dig>  reactions, which is modest for current genome-scale models  <cit> . with the ever increasing size and complexity of genome-scale models  <cit>  and the exponential manner in which the number of elementary modes increases with the size of the network, it follows that in some cases, the advantages offered by our approach may not simply be a several-thousand fold improvement in computational time, but rather the difference between practical feasibility and infeasibility.

indeed, inj661v  <cit> , a recent model that modifies inj <dig> with the aim of more accurately modeling mtb in in vivo infection, is only slightly larger than inj <dig>  with  <dig>  reactions. however, a more complex growth medium resulted in a significantly larger number of relevant elementary modes for the flux distribution obtained by fba than that for inj <dig>  and we were unable to generate them all using efmtool because of memory limitations. using our decomposition method, we generated a valid elementary mode decomposition consisting of  <dig> modes in  <dig>  seconds.

metabolic engineering of e. coli
to demonstrate the utility of our approach for metabolic engineering, we consider the metabolic engineering of e. coli for increased acetate production-a problem that has received attention owing to the value of acetic acid for its industrial and food uses  <cit> . knockout strategies for increased production of acetate based on fba have previously been reported by lun et al.  <cit>  using the genome-scale metabolic reconstruction of e. coli by feist et al.  <cit> , iaf <dig>  these knockout strategies were generated using gdls   <cit> , an efficient heuristic for generating metabolic engineering strategies involving multiple knockouts from genome-scale models, extending the capabilities of the computationally-expensive optimal search proposed by optknock  <cit> . the strategies were chosen using fba to have high predicted production of acetate whilst maintaining required energy production and growth to ensure viability. specifically, a predicted non-growth-associated atp maintenance  flux of at least  <dig>  h- <dig> and a biomass flux of at least  <dig>  h- <dig> were required.

the proposed strategies make sense biologically  <cit>  and include experimentally-tested knockouts for acetate production such as alcohol dehydrogenase and atp synthase  <cit> . however, the cause for the increased acetate production is not immediately clear from the metabolic phenotype predicted by fba alone. table  <dig> shows the number of reactions that have been added to or removed from the flux distributions of the gene-knockout mutants when compared with the wild-type flux distribution. as we can see, the changes in the flux distributions are quite extensive and, in particular, they do not result simply from shunts around the blockages created by the gene deletions. the inherent structure of the network, and hence the mechanisms by which predicted metabolic behavior arises, is difficult to ascertain from the flux distribution as a whole. we, therefore, applied our decomposition algorithm to determine the elementary flux modes that make up the flux distributions under these knockout strategies. we took the best knockout strategies reported by lun et al.  <cit>  with numbers of knockouts ranging from  <dig> to  <dig>  for the purposes of these strategies, a single knockout is considered to consist of all genes capable of catalyzing a reaction, i.e. the enzyme complex or all complexes with the same metabolic function.

ametabolite abbreviations: 12ppd-r, -propane- <dig> -diol; ac, acetate; etoh, ethanol; glc, glucose; pi, phosphate; succ, succinate.

most interestingly, when the modes are examined in terms of acetate production, we find that the most efficient modes are generally those that only contribute to ngam flux. however, a biomass-producing mode is necessary to satisfy growth and viability requirements. thus, the problem of selecting knockouts to maximize acetate production, given a limiting resource such as glucose, is not necessarily about finding a single optimal elementary mode. rather, competing constraints demand that the chosen modes need to complement each other well. this can be seen in the reported decompositions for the various knockout mutants.

for example, of all the biomass-producing modes, the mode arising from the five-knockout mutant is the most efficient at  <dig>  mmol of acetate per mmol of glucose. when more knockouts are allowed, the overall acetate production is improved despite a decrease in the acetate production efficiency of the biomass-producing mode. this decrease is offset by a shift towards using ngam-producing modes with significantly more efficient production of acetate. for the six and eight knockout cases, the ngam-producing mode generates  <dig>  mmol of acetate per mmol of glucose.

finally, as fba does not necessarily yield a unique distribution, we implemented the recursive milp algorithm from lee et al.  <cit>  to find alternate optima and then obtained decompositions for the corresponding flux distributions. our results  indicate that the decomposition into two modes with distinct functions related to ngam and biomass production is preserved for alternate optima. thus, the decomposition of flux distributions into primarily ngam-producing and biomass-producing modes is a robust quality.

understanding the survival of mtb during infection
to illustrate another application of our approach, we consider the utilization of the glyoxylate shunt in mtb. the glyoxylate shunt enzyme isocitrate lyase , present in mtb as two isoforms, is believed to be required by microorganisms to utilize fatty acids as a source of carbon and energy. this shunt has previously been shown to be required for the in vivo growth and virulence of mtb  <cit> . since mtb is believed to subsist on fatty acids during infection  <cit> , it is argued that, by removing icl, mtb is no longer able to utilize fatty acids for carbon and energy and therefore unable to grow in vivo. indeed, strains of mtb absent in both isoforms of icl are unable to grow on fatty acid substrates and unable to survive in macrophages and mice  <cit> . therefore, icl has attracted significant attention as a promising drug target for treatment of mtb infection  <cit> .

it is possible, however, that given the robustness that is generally observed in metabolic networks  <cit> , such a vital function would not simply rest on a single enzyme-even one present as two isoforms. using our method, we can study the metabolic capabilities of mtb growing on fatty acid substrates. in particular, we determined the elementary modes used by mtb at differing uptake rates of octadecenoate using the genome-scale metabolic reconstruction of mtb by beste et al.  <cit>  . we found that there exist modes that generate biomass and/or ngam both using and not using icl. at a given ngam flux, the modes that use icl generally produce biomass more efficiently than those that do not. however, for a given uptake of octadecanoate, the modes that produce the most biomass are those that do not use icl. therefore, the modes available to maximize the biomass production while maintaining a given ngam requirement will depend on the supply flux of octadecenoate. when the supply is sufficiently high, the ngam requirement is easily met by the high efficiency biomass producing modes that do not use icl, but when it is lower, use of icl allows the ngam requirement to be met more efficiently and, hence, allows more biomass to be produced.

under the assumption that the metabolic reconstruction by beste et al. is correct, our analysis implies that mtb is capable of producing both carbon and energy from fatty acids without the use of icl but, for lower uptake rates of fatty acids, icl allows for more efficient utilization of the fatty acids. indeed, we found that the optimal growth rate predicted by fba differs only slightly with icl present and without it . this presents the intriguing possibility that mtb possesses the metabolic capability to grow on fatty acids without icl, but does not do so after the knockout of icl because it has not yet undergone the adaptive evolution necessary to make use of this metabolic capability. this possibility is consistent with the work of fong and palsson  <cit>  showing that the growth rate of gene deletion strains of e. coli can change significantly after undergoing adaptive evolution. the possible existence of such inactive routes for metabolizing fatty acids without the use of icl in mtb has been discussed elsewhere  <cit>  and, if true, would imply that mtb could rapidly evolve resistance to drugs inhibiting icl.

closer examination of the elementary modes reveals how mtb grows in silico without icl and provides a testable means of confirming or rejecting the model's predictions. all the elementary modes that do not use icl use malate synthase, the second of the two enzymes that form the glyoxylate shunt. in all of these modes, the full flux through malate synthase comes from htra, a gene predicted to code for 4-hydroxy-2-oxoglutarate aldolase to complete the hydroxyproline degradation pathway in mtb using the bayesian method of green and karp  <cit> . htra supplies the glyoxylate that is used as a substrate by malate synthase. mtb and other mycobacteria have been observed to grow using hydroxyproline as a carbon source  <cit> , suggesting that this pathway may indeed exist. further studies confirming and characterizing this pathway will shed light on whether it does in fact provide mtb with a viable means of producing glyoxylate.

the elementary mode decomposition analysis we have presented sheds light on the mechanics of the fba prediction that is difficult to obtain from the fba results alone. specifically, htra in combination with malate synthase can be used in gsmn-tb to generate biomass and ngam. however, the space of possible biomass and ngam production rates that can be achieved in this way is smaller than that which is possible using the glyoxylate shunt. at low octadecenoate uptake rates, this difference is important, leading to a lower biomass production to meet the ngam requirement. furthermore, it also demonstrates the utility of our method in identifying a potential source of the discrepancy between in silico predictions and observed experimental results. if growth is not experimentally possible, even after adaptive evolution, then it suggests that the model is incorrect and the likely error in the model comes from the inclusion of the predicted gene, htra.

CONCLUSIONS
we have presented a method for decomposing a given flux distribution into a set of constituent elementary modes. in contrast to previous approaches, our method does not require the initial generation of a full set of elementary modes, which is often computationally demanding and, in some cases, computationally infeasible for practical purposes. in a moderately-sized instance, we observed a computational time improvement of over 2000-fold using our method.

overall, we see that elementary mode analysis offers a great deal that flux-balance analysis alone does not. fba yields predictions of overall metabolic behavior, while elementary mode analysis allows understanding of metabolic capabilities. by decomposing flux distributions obtained by fba into elementary modes, we can gain insight into how metabolic networks achieve their predictions. we exploit modularity to decompose a complex entity into a simpler entity, which enables debugging and understanding and, ultimately, more sophisticated design and engineering.

