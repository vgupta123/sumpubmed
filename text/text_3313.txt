BACKGROUND
the goal of systems biology is to shed light onto the functionality of living cells and how they can be influenced to achieve a certain behavior. systems biology therefore aims to provide a holistic view of the interaction and the dynamical relation between various intracellular biochemical pathways. often, such pathways are qualitatively known which serves as a starting point for deriving a mathematical model. in these models, however, most of the parameters are generally unknown, which thus hampers the possibility for performing quantitative predictions. modern experimental techniques can be used to obtain time-series data of the biological system under consideration from which unknown parameters values can be estimated. since these data are often sparsely sampled, parameter estimation is still an important challenge in these systems. on the other hand, the use of model-based  experimentation can greatly reduce the effort and cost of biological experiments, and simultaneously facilitates the understanding of complex biological systems. in particular, the modeling and simulation of cellular signaling pathways as networks of biochemical reactions has recently received major attention  <cit> . these models depend on several parameters such as kinetic constants or molecular diffusion constants which are in many cases not accessible to experimental determination. therefore, it is necessary to solve the so-called inverse problem which consists of estimating unknown parameters by fitting the model to experimental data, i.e., by solving the model calibration or parameter estimation problem.

parameter estimation is usually performed by minimizing a cost function which quantifies the differences between model predictions and measured data. in general, this is mathematically formulated as a non-linear optimization problem which often results to be multi-modal . most of the currently available optimization algorithms, specially local deterministic methods, may lead to suboptimal solutions if multiple local optima are present, as shown in  <cit> . this is particularly important in the case of parameter estimation for biological systems, since in most cases no clear intuition even about the order of magnitude exists. finding the correct solution  of the model calibration problem is thus an integral part of the analysis of dynamic biological systems. consequently, there has been a growing interest in developing procedures which attempt to locate the global optimum. in this concern, the use of deterministic  <cit>  and stochastic global optimization methods  <cit>  have been suggested. for deterministic global optimization routines the convergence to the global optimum is guaranteed but this approach is only feasible for a considerably small number of parameters. stochastic global optimizers on the other side converges rapidly to the vicinity of the global solution, although further refinements are typically costly. in other words, finding the location of the optimum is computationally expensive, especially for large systems as found in systems biology. alternatively, rodriguez-fernandez et al.  <cit>  propose a hybrid method to exploit the advantages of combining global with local strategies. that is, robustness in finding the vicinity of the solution using the global optimization procedure and the fast convergence to solution by the local optimization procedure. at a certain point the search is switched from using the global optimizer to the local optimization routine by this hybrid strategy. the determination of the so called switching point is done on the basis of exhaustive numerical simulations prior to the actual optimization run.

in this work a refined hybrid strategy is proposed which offers two main advantages over previous alternatives  <cit> : first, we employ a multiple-shooting method which enhances the stability of the local search strategy. second, we propose a systematic and robust determination of the switching point. since the calculation of the switching point can be done during the parameter estimation itself, computationally expensive simulations are no longer needed.

parameter estimation in dynamical systems
generally, the parameter estimation problem can be stated as follows. suppose that a dynamical system is given by the d-dimensional state variable x ∈ ℝd at time t ∈ i = , which is the unique and differentiable solution of the initial value problem

  x˙=f,t,p)x=x <dig>  

the right-hand side of the ode depends in addition on some parameters p∈ℝnp. it is further assumed that f is continuously differentiable with respect to the state x and parameters p. let yij denote the data of measurement i =  <dig>  ..., n and of observable j =  <dig>  ..., n, whereas n represents the total amount of data and n is the number of observables. moreover, the data yij satisfies the observation equation

  yij = gj, p) + σijεij     i =  <dig> ...,n, 

for some observation function g : ℝd → ℝn, d ≥ n, σij >  <dig>  where εi's are independent and standard gaussian distributed random variables. the sample points ti are ordered such that t <dig> ≤ t <dig> < ...; <tn ≤ tf and the observation function g is again continuously differentiable in both variables. eqs.  and  define an single-experiment design. if several experiments are available, possibly under different experimental conditions, eq.  depends on each experiment and must be modified in the following manner

  yijk = gj, p) + σijkεijk     k =  <dig>  ..., nexp. 

certain parameters may be different for each experiment, but the treatment of these local parameters and the different experiments requires only obvious modifications of the described procedures and therefore only the single-experiment design nexp =  <dig> is discussed in the following for sake of clarity.

on the basis of the measurements i =  <dig> ...,n the task is now to estimate the initial state x <dig> and the parameters p. the principle of maximum-likelihood yields an appropriate cost function which has to be minimized with respect to the decision variables x <dig> and p. defining x as being the trajectory at time ti, the cost function is then given by

  ℒ=∑i=1n∑j=1n,p))22σij <dig>  

in general, minimizing ℒ is a formidable task, which requires advanced numerical techniques.

methods
mathematical modeling in systems biology rely on quantitative information of biological components and their reaction kinetics. due to paucity of quantitative data, various numerical optimization techniques have been employed to estimate parameters of such biological systems. employed optimization techniques include local, deterministic approaches like levenberg-marquardt algorithm, sequential quadratic programming, and stochastic approaches like simulated annealing, genetic algorithms and evolutionary algorithms . most commonly, local methods optimize the cost function, eq. , directly with respect to initial values x <dig> and parameters p. this optimization scheme is called initial value approach or alternatively single-shooting. huge differences in the performance can be observed if either local or global optimization methods are used. due to the presence of multiple minima in eq. , convergence of local optimization methods to the global minimum is in most cases limited to a rather small domain in search space, see, e.g.,  <cit> . in contrast, global methods have generally a substantially larger convergence domain but the computational cost increases drastically.

one of the simplest global methods is a multistart method. here, a large amount of initial guesses are drawn from a distribution and subjected to a parameter estimation algorithm based on a local optimization approach. the smallest minimum is then regarded as being the global optimum. in practice, however, there is no guarantee of arriving to the global solution and the computational effort can be quite large. these difficulties are arising because it is a-priori not clear how many random initial guesses are necessary. over the last decade more suitable techniques for the solution of multi-modal optimization problems have been developed . several recent works propose the application of global deterministic methods for model calibration in the context of chemical processes, biochemical processes, metabolic pathways, and signaling pathways  <cit> . global deterministic methods in general take advantage of the problem's structure and even guarantee convergence within a preselected level of accuracy. although very promising and powerful, there are still limitations to their application, manly due to rapid increase of computational cost with the size of the considered system and the number of its parameters. as opposed to deterministic approaches, global stochastic methods do not require any assumptions about the problem's structure. stochastic global optimization algorithms are making use of pseudo-random sequences to determine search directions toward the global optimum. this leads to an increasing probability of finding the global optimum during the runtime of the algorithm. the main advantage of these methods is that they rapidly arrive to the proximity of the solution. examples of global stochastic methods are: pure random search algorithms, evolutionary strategies, genetic algorithms, scatter search and clustering methods. some of these strategies have been successfully applied to parameter estimation problems in the context of systems biology, see  <cit> .

in  <cit>  a combination of global stochastic methods with local methods has been proposed. this, so called hybrid approach, utilizes the property of the global search strategy to arrive quickly to the vicinity of the solution. at a certain point in the proximity of the solution the optimizer is switched from the global stochastic to the local deterministic search method. it has been shown that this strategy saves a huge amount of computational effort and provides an efficient and robust alternative for model calibration. therefore, the hybrid method takes advantage of the complementary strengths of both optimization strategies: global convergence properties in the case of the stochastic method, and fast local convergence in the case of the deterministic approach. speed and the stability, however, of the resulting hybrid approach also depends on the performance of the used local approach. for this reason we choose the method of multiple-shooting rather than the initial value approach in order to refine the hybrid optimization strategy as described in  <cit> . as shown below multiple-shooting has in general a larger domain of convergence to the global optimum while only a small portion of additional computational load has to be taken into account compared to single shooting. a brief outline of the multiple-shooting method is given below.

multiple-shooting
detailed discussion and some applications to measured data of the method can be found, e.g., in  <cit> . here, we will concentrate on the main principles of multiple-shooting in order to construct a new hybrid approach. the basic idea of multiple-shooting is to subdivide the time interval i =  into nms <n subintervals ik such that each interval contains at least one measurement. each of the intervals are assigned to an individual experiment having its own initial values k= <dig> ⋯,nms but sharing the same parameters p. suppose that x for all k =  <dig>  ..., nms denotes the trajectory within an interval. since the total trajectory for each t ∈ i = i <dig> ∪ ... ∪inms is usually discontinuous at the joins of the subintervals, smoothness as anticipated by the solution of eq.  is not fulfilled. to enforce smoothness, the optimization is constrained such that all discontinuities are removed at convergence. this leads to a constrained non-linear optimisation problem, which has in addition the advantage that further equality and inequality constraints can easily be implemented. note that if the integration between two time points is numerically unfeasible, the segment where this problem occurs can be removed. this, however, leads to a split trajectory which parts can be treated using a multiple-experiment fit.

for each k =  <dig>  ... nms let tk+=max⁡{ik},tk−=min⁡{ik} and θk =  the optimization problem can then be formulated in the following manner:

  ℒ=12∑j=1n∑k=1nms∑{i:ti∈ik})2=min⁡θ <dig> ⋯,θnmssubject tox−xi= <dig> ⋯,nms−1rje=0j= <dig> ⋯,nerkg≥0k= <dig> ⋯,ng, 

where the continuity constraints are given at the first row of the constraints-part, followed by optional constraints rje,rkg. cost function ℒ is equivalent to eq.  if the continuity constraints are satisfied; hence

  rijka=yij−gj,p)σij. 

we solved the non-linear programming problem defined by eq.  iteratively by employing a generalized-quasi-newton method  <cit> . with the current guess θl−1=, the update step Δθl= for the l-th iteration is obtained by solving the resulting linearly constrained least squares problem:

  12∑j=1n∑k=1nms∑{i:ti∈ik}+dθrijkaΔθl)2=min⁡Δθlsubject tox−x+dθixΔθil−dθi+1xΔθi+1l=0rje+dθrjeΔθl=0rkg+dθrkgΔθl≥ <dig>  

where dθ denotes the derivative with respect to the parameters θ of the corresponding function. setting θl = θl- <dig> + Δθl and repeating eq.  until Δθl ≈  <dig>  yields the desired parameter estimates under the condition that all parameters itself are identifiable and the constraints are not contradictory. these extra assumptions are necessary to fulfil the so called kuhn-tucker conditions for the solvability of constrained, non-linear optimization problems  <cit> .

in combination with multiple-shooting the generalized-quasi-newton approach has three major advantages: first, the optimization is sub-quadratically convergent. second, a transformation of eqs.  can be found such that the transformed equations are numerically equivalent to the initial value approach. third, due to the linearization of the continuity constraints, they do not have to be fulfilled exactly after each iteration, but only at convergence. this allows discontinuous trajectories during the optimization process, reducing the problem of local minima. the first two properties yield the desired speed of convergence whereas the third property is mainly responsible for the stability of multiple-shooting. this is gained by the possibility that the algorithm can circumvent local minima by allowing for discontinuous trajectories while searching the global minimum. whereas, the main disadvantage is due to the linearization of the cost function. it can easily happen that despite the update step Δθl is pointing in the direction of decreasing ℒ the proposed step is too large. such an overshooting is common to any simple optimization procedures based on the local approximation of the cost function. a suitable approach to cure this deficiency is realized by relaxing the update step; hence θl = θl- <dig> + λlΔθl for some λl ∈   <cit>  or differential evolution   <cit> . the local search method is – as already stated above – multiple-shooting.

calculation of the switching point
the multiple-shooting method is equipped with a relaxation algorithm to prevent overshooting of the update step. this overshooting is due to the quadratic approximation of the likelihood function in eq.  which is often too crude for points far away of the minimum. for these points the calculated update step tends to be too long and might result in a step leading to an increased value of the cost function. the relaxation method, also called damping method, selects some λl ∈  = ||gra|| <dig>  

where ra is the n × n-dimensional vector with components rijka in eq.  and g is the generalized inverse of eq. , satisfying Δθl = gra. based on t a very efficient corrector-predictor scheme is given in  <cit>  to determine the optimal damping parameter λ. furthermore, it can be shown that whenever the method enters the region of local convergence, the method converges to a full step procedure and thus λ →  <dig>  <cit> . this feature of the damping strategy can be utilized to detect the region of local convergence and provides a suitable criterion for determining the switching point. calculating λ during the global optimization and successively checking whether λ =  <dig> yields the desired information about the switching point. for stability reasons we propose to switch to the local method only after a certain number, say n <dig>  of consecutive λ =  <dig> is achieved. after the initialization of the method a number of iterations n <dig> is performed using the global method without checking the switching point criterion in order to decrease the computational load, note that a minimum of around  <dig> iterations will be usually needed, this number may be increases if the size of the search space also increases. for the simulations presented in this study n <dig> =  <dig>  since the corrector-predictor scheme can be implemented very efficiently, calculation of the damping parameter λ is computationally inexpensive.

RESULTS
in order to demonstrate the performance of the method we have chosen two examples: the stat <dig> signaling pathway  <cit>  and goodwin's model  <cit>  for a feedback control system showing a hopf bifurcation. in both cases we simulated data having a noise-to-signal ratio of either 0% or 10% and evaluated the performance of the proposed hybrid method in comparison to local and global search strategies.

stat <dig> signaling pathway
the jak/stat  signaling cascade is a well studied pathway stimulating cell proliferation, differentiation, cell migration and apoptosis  <cit> . a mathematical model of the jak/stat <dig> pathway is, e.g., presented in  <cit> . here, the binding of the ligand to the erythropoietin receptor  located at the cell membrane results in an activation of the receptor  and leads to a subsequent phosphorylation of the stat <dig> molecule. two phosphorylated stat <dig> proteins form a homodimer which enters the cell nucleus, where it stimulates transcription of target genes. then the molecules are dedimerized and dephosphorylated and relocated back to the cytoplasm. this process is modeled by the following system of non-linear delay differential equations:

  x˙1=−k1x1epora+k2x3x˙2=−x22+k1x1eporax˙3=−k2x3+x22x˙4=−k2x3+k2x <dig>  

where k <dig>  k <dig> are rate constants and τ is a delay parameter. the cytoplasmic unphosphorylated stat <dig> is represented by x <dig>  whereas x <dig> denotes the phosphorylated stat <dig>  moreover, x <dig> describes the dimer and x <dig> is the nuclear stat <dig>  the receptor activity is denoted by epora and the delay τ represents the time the stat <dig> proteins reside in the nucleus. delay differential equation exhibit a rich dynamic, which make them a difficult candidate for parameter estimation  <cit> . we approximate the delay in eq.  by a linear chain of length n:

 q˙1=n/τ −q1)q˙2=n/τ ⋯q˙n−1=n/τ out=n/τ ). 

here, in is the input and out the output of the delay chain. we set in = x <dig>  out = x <dig>  and n =  <dig>  this provides a reasonable approximation of the time delay  <cit> . two different sets of data were obtained by numerical simulations with a noise to signal ratio of 0% and 10%, respectively. as observed quantities we choose the total amount of activated stat <dig>  y <dig> = s <dig>  and the total amount of stat <dig> in the cytoplasm, y <dig> = s <dig>  where s <dig> and s <dig> are scaling parameters introduced to deal with the fact that only relative protein amounts are measured. initial conditions and the kinetic parameters were chosen to be: x <dig> =  <dig> , xi =  <dig>  , k <dig> =  <dig> , k <dig> =  <dig> , τ =  <dig> , s <dig> =  <dig>  and s <dig> =  <dig> . from the simulated data we aim to estimate the rate constants k <dig>  k <dig>  the delay parameter τ and the initial concentration of unphosphorylated stat <dig> x <dig>  in case of local optimization methods – single and multiple-shooting – we used multistarts, where the initial guess of each restart is randomly chosen from the intervals  <cit>  ,  <cit>  , and  <cit>  , respectively, using a uniform distribution. for each box size  <dig> restarts are chosen. note that the delay parameter τ has to be restricted to Δt <τ < , where Δt denotes the sampling rate of the data. this follows from the fact that no information is contained in the data about delays smaller than τt and larger than the total measurement time tf - t <dig> 

the results are given in figure a showing the percentage of convergence to the global minimum, local minima or failure of box  <dig>  box  <dig>  and box  <dig>  respectively. in the rather artificial case of zero noise shown in figure a multiple-shooting performs reasonably well while already a significant fraction of the single shooting trials converge to a local mimimum. figure b presents the results obtained using data with 10% noise to signal ratio. adding noise deteriorates the performance of both approaches, which can be seen by comparing figure a and figure b. as anticipated, multiple-shooting outperforms single shooting, since it reduces the multimodality of the problem. however, multiple-shooting tends to fail more often than single-shooting for large box sizes. even for this rather simple example the chance of getting trapped in a local solution or to fail is quite significant and increases with increasing noise to signal ratio. the corresponding total computational costs for both methods are summarized in table  <dig>  since different platforms are used for our study all cpu times are transformed to a pentium  using linpack benchmark tables. table  <dig> exemplifies the trade-off between robustness  and speed .

the cpu time is normalized using the linpack benchmark table and is in case of the multistarts of the single shooting  and multiple-shooting  method the sum over all restarts. increased robustness of ms results in substantially higher computational cost compared to ss. the hybrid is about 3– <dig> times faster than sres manifesting the advantage of the proposed method.

in contrast to the local methods, both, the global search strategy sres and the hybrid approach, converged in all cases to the global optimum which emphasises the strength of global methods. note that results obtained by de are comparable to sres and are therefore omitted. the power of the hybrid strategy can be appreciated considering the average computational cost as shown in table  <dig>  using the hybrid reduces the computational load significantly by a factor of four. due to the systematic switching point calculation no further adjustments were necessary to obtain this significant emendation.

oscillatory feedback control system: goodwin's model
parameter estimation for oscillating systems is usually more involved than for systems showing a transient behavior. a well known model describing oscillations in enzyme kinetics is the model suggested by goodwin  <cit> . it consists of the following set of ordinary differential equations:

  x˙=aa+zσ−bxy˙=αx−βyz˙=γy−δz. 

here, x represents an enzyme concentration whose rate of synthesis is regulated by feedback control via a metabolite z. the intermediate product y regulates the synthesis of z. oscillatory behaviour is not a necessary characteristic of this set of equations. different values for the parameters may result in limit cycle oscillations, damped oscillations or monotonic convergence to a steady state. in fact, only a restricted range of parameter values result in oscillations. the following values have been used here x =  <dig> , y =  <dig> , z =  <dig> , for the initial conditions and a =  <dig> , a =  <dig> , b =  <dig> , α =  <dig> , β =  <dig> , γ =  <dig> , σ =  <dig>  and δ =  <dig> , for the model parameters, resulting in oscillatory behavior.

as with the previous case the problem is first approached using multistarts where either single shooting or multiple-shooting are employed. the initial guess of each restart is randomly chosen from the intervals  <cit>  ,  <cit>   and  <cit>  , respectively, for both the parameters and initial conditions using a uniform distribution and two values 0% and 10% noise to signal ratio. the results are summarized in figure showing the percentage of convergence to the global minimum, local minima or failure for different box sizes. both local methods encounter difficulties in finding the global optimum, single shooting fastly steps in local minimima or diverges and only on a reduced percentage of the runs converges to the global solution, whereas multiple-shooting performs in all cases better than single shooting at the expense of higher computational costs. in case of the global approaches only de, under the choice of robust thus slower strategy parameters, was able to find the global minimum, whereas no convergent fit was obtained using sres. this emphasizes the difficulties in finding the optimal solution for oscillatory systems even for global search strategies. figure  shows representative convergence curves for the de and the hybrid to the global optimum of the goodwin problem given by eq. . the benefit of the hybrid can be appreciated by comparing the left panel  with the right panel . for box size  <dig> the hybrid converges almost ten times faster while for larger box sizes the asset is even more pronounced. this is also reflected by the cpu times presented in table  <dig>  it is important to note that this advantage has been obtained without costly adjustment of the switching point as a consequence of the systematic switching strategy employed in the proposed hybrid method. note moreover that the hybrid may use a faster strategy for de which further enhances efficiency.

the cpu time is normalized using the linpack benchmark table and is in case of the multistarts of the single shooting  and multiple-shooting  method the sum over all restarts. as in the case of the stat <dig> example the improved robustness of multiple-shooting gives rise to increased computational cost compared to single shooting. the benefit of the hybrid becomes evident by the fact that the computational cost of the hybrid is about  <dig> times lower than de for the box  <dig>   <dig> times lower for the box  <dig> and around  <dig> for box  <dig> 

CONCLUSIONS
in this study we present a new hybrid strategy as a reliable method for solving challenging parameter estimation problems encountered in systems biology. the proposed method presents two advantages over previous hybrid methods: first, it is equipped with a switching strategy which allows the systematic determination of the transition from the local to global search. this avoids computationally expensive tests in advance and constitutes a major benefit of the proposed method. second, using multiple-shooting as the local search procedure reduces the multi-modality of the non-linear optimization problem. because multiple-shooting avoids possible spurious solutions in the vicinity of the global optimum it outmatches the initial value approach  yielding an enhanced robustness of the hybrid.

we analyzed the performance of this new approach using two examples: the dynamical model of the stat <dig> signaling pathway suggested in  <cit>  and the goodwin model describing oscillating processes  <cit> . the hybrid was able to converge to the global solution in all runs performed with significant reductions in the computational cost. moreover a comparison with other search strategies reveals that the hybrid results in a better compromise efficiency-robustness. in conclusion the proposed hybrid provides a robust and convenient method for parameter estimation problems occurring in systems biology.

authors' contributions
c.f. initiated the work, m.p. implemented the multiple-shooting algorithm. m.p. and e.b.c. implemented the hybrid algorithm. e.b.c. performed the simulations. e.b.c., c.f., and m.p. drafted the manuscript. j.t. and j.b. proposed the main idea, gave valuable advises and helped to draft the manuscript. all authors read and approved the final manuscript.

