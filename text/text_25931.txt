BACKGROUND
in an ecosystem, different species/populations interact with each other to form complicated networks through various types of interactions such as predation, competition and mutualism. on the basis of ecological interactions, ecological networks can be grouped as antagonistic, competitive and mutualistic networks  <cit> . traditionally, food webs have been intensively studied in ecological research because they are critical to study the complexity and stability of ecological communities  <cit> . recent studies showed that food webs possessed typical properties of network topology   <cit> . within the last decade, mutualistic networks have also been intensively studied  <cit> . but, it appears that no studies have been performed to examine competitive networks. this is most likely because the network structure is not available based on competitive interactions. unlike food webs and plant-animal mutualistic networks where the structure is already known, quantifying competitive interactions among different species/populations within a given habitat is difficult so that the network structure for competitive interactions is unknown. this is also true for network studies in microbial ecology. because of their vast diversity, as-yet uncultivated status  <cit>  and of the lack of appropriate theoretical frameworks and experimental data, very few community-scale network studies have been performed in microbial ecology.

various network approaches have been developed and widely applied in genomic biology  <cit> . to reveal the interactions among biological molecules including genes and proteins, differential equation-based network methods  <cit> , bayesian network methods  <cit> , and relevance/co-expression network methods  <cit> , have been used to infer cellular networks based on gene expression data. among them, the correlation-based relevance network method is most commonly used largely due to its simple calculation procedure and noise tolerance  <cit> . however, most studies involving relevance network analysis use arbitrary thresholds, and thus the constructed networks are subjective rather than objective  <cit> . this problem has been solved by our recent development of a random matrix theory -based approach, which is able to automatically identify a threshold for cellular network construction from microarray data  <cit> . our results showed that the developed novel rmt-based approach can automatically identify cellular networks based on microarray data. our results also indicated that this approach is a reliable, sensitive and robust tool for identifying transcriptional networks for analyzing high-throughput genomics data for modular network identification and gene function prediction  <cit> .

high-throughput technologies such as microarrays and high throughout sequencing have generated massive amounts of data on microbial community diversity and dynamics across various spatial and temporal scales  <cit> . these data offer an unprecedented opportunity to examine interactions among different microbial populations  <cit> . recently, a novel conceptual framework, termed molecular ecological networks , has been proposed and applied to characterize microbial communities in response to elevated co <dig> <cit> . here, we provide detailed mathematical and bioinformatic foundation of this novel approach, and further applications to characterize microbial community network interactions in response to long-term experimental warming. additionally, we provide an online tool, named the molecular ecological network analyses pipeline , which is freely accessible to the scientific community.

RESULTS
overview of mena
an ecological network is a representation of various biological interactions  in an ecosystem, in which species  are connected by pairwise interactions   <cit> . as previously described, we refer such molecule-based ecological networks in microbial communities as molecular ecological networks   <cit> , in which different nodes  are linked by edges . the mens derived from functional gene markers are referred as functional molecular ecological networks   <cit>  and those based on phylogenetic gene markers as phylogenetic molecular ecological networks   <cit> .

the whole process of mena can be divided into two phases and each phase is comprised of several major steps . the first phase is network construction, which includes four major steps: data collection, data transformation/standardization, pair-wise similarity matrix calculation, and the adjacent matrix determination by rmt-based approach. among them, the last step is the key to rmt-based network construction , which has been well established in biological systems  <cit> . once the adjacency matrix is defined, an undirected network graph can be drawn. the second phase of mena is network analyses, which is composed of network topology characterization , module detection, module-based eigengene analysis and identification of modular roles. these methods are important for revealing the networks’ overall and modular organizations and identifying key populations at otu level. in addition, eigengene network analysis can be performed to reveal higher order organization of mens, and the associations of network properties to environmental characteristics can be established. finally, the network differences can be compared under different conditions to analyze how environments affect network structure and interactions.

molecular network under experimental warming
here we used 16 s rrna gene-based pyrosequencing data from a long-term experimental warming site  <cit>  to construct pmens and demonstrate the whole process of mena. the experimental site was established in grassland with two atmospheric temperature treatments, ambient  and +2 °c warming. six replicate plots were set up for each treatment. the environmental dna of microbial community was extracted from the soil samples of those  <dig> plots and  <dig> or  <dig> unique tags with 16 s rrna gene conserved primers were used to amplify the v4-v <dig> hypervariable regions of the 16 s rrna genes. altogether, there were  <dig> replicate datasets for each treatment of warming or unwarming. after preprocessing all raw sequences, the numbers of sequences for all  <dig> samples ranged from  <dig>  to  <dig> . after defining otus within  <dig>  sequence difference, an otu distribution table with  <dig>  distinct otus across  <dig> samples was obtained. since the numbers of sequences of all samples were diverse, the abundance data were transformed into relative abundance by dividing the sum of each sample as described previously  <cit> . the relative abundance table was split into two datasets: warming and unwarming. for each of the datasets, only the otus appeared in  <dig> or more replicates were used for correlation calculations, resulting in  <dig> and  <dig> otus for warming and unwarming datasets, respectively. after threshold scanning through rmt-based approach, the phylogenetic molecular ecological networks  under warming and unwarming conditions were constructed with an identical similarity threshold  <dig>  . the final warming and unwarming pmens included  <dig> and  <dig> nodes which had at least one edge, and  <dig> and  <dig> total edges, respectively.

avarious parameters of the empirical networks and generation of random networks are explained in the table  <dig> 

bsample sources:  the grassland soils under elevated and ambient co <dig> were collected from a free-air co <dig> enrichment field in minnesota which were analyzed with both geochip <dig>  and 16 s pyrosequencing  <cit> . the fmens analysis was desibed in zhou et al.  <cit>  and pmens analysis was desibed in zhou et al.  <cit> .  the lake sediment samples from lake depue were analyzed with geochip  <dig> .  the groundwater samples from three different wells in oak ridge, tennessee were analyzed with geochip  <dig>   <cit> .  the grassland samples under warming and unwarming were collected from the long term warming experiment at oklahoma  <cit>  and analyzed with 16 s pyrosequencing  <cit> .  the pyrosequencing data of agricultural soils from africa and the groundwater samples from oak ridge was provided by dr. tiedje and his colleagues at michigan state university.  the human intestine sample from stanford was desibed elsewhere  <cit> .

the robustness of mens to noise
in order to examine the robustness of men approach to noise, different levels  of gaussian noise were added to the warming dataset. once various levels of noise were added, new correlation matrices based on these noise-added datasets were calculated. the same similarity threshold used for the original datasets was used for defining adjacency matrices in the new datasets. when less than 40 % noise was added, roughly 90 % of the original otus were still detected in the perturbed networks . with 100 % gaussian noise, more than 85 % nodes from original network were still preserved and accounted for 75 % nodes of perturbed network. these results indicate that the rmt-based men construction approach is robust to noise.

the overall mens topology
scale-free, small-world, modularity and hierarchy are common network properties in many complex systems   <cit> . the overall topology indices  revealed that all curves of network connectivity distribution were fitted well with the power-law model , indicative of scale-free networks. also, the average path lengths  were  <dig>  to  <dig> , which were close to logarithms of the total number of network nodes and comparable to those in other networks displaying small-world behavior, suggesting that the mens in these microbial communities had the typical property of small world. for modularity, all modularity values  were from  <dig>  to  <dig> , which were significantly higher than the m values from their corresponding randomized networks, therefore, all constructed mens appeared to be modular. finally, the hierarchy property was examined by the scaling of clustering coefficient. r <dig> values of the linear relationship between logarithms of clustering coefficients and the logarithms of connectivity ranged from  <dig>  to  <dig> , indicating the hierarchical behavior was quite variable. mens from certain habitats may have highly hierarchical structures like sediment samples from lake depue , but others may not . overall, our constructed mens from different habitats clearly exhibit scale free, small world and modularity properties, but hierarchy property is displayed on certain networks.

modular structure
modularity is a very important concept in ecology. it could originate from specificity of interactions , habitat heterogeneity, resource partition, ecological niche overlap, natural selection, convergent evolution, and phylogenetic relatedness, and it could be important for system stability and resilience  <cit> . in mens, a module in the network is a group of otus that are highly connected among themselves, but had much fewer connections with otus outside the group. random matrix theory-based approach is able to delineate separate modules, but some modules could still be very big.

we used several methods, including short random walks  <cit> , leading eigenvector of the community matrix  <cit> , simulated annealing approach  <cit>  and the greedy modularity optimization  <cit> , to define modules and submodules within a large module. from the evaluation of warming and unwarming pmens, short random walks generated  <dig> and  <dig> modules with m values  <dig>  and  <dig> , respectively; the leading eigenvector of the matrix generated  <dig> and  <dig> modules with m values  <dig>  and  <dig> , respectively; the greedy modularity optimization had  <dig> and  <dig> modules with m values  <dig>  and  <dig> , respectively; the simulated annealing approach had average  <dig> and  <dig> modules with average m values  <dig>  and  <dig> , respectively. from these results, the greedy modularity optimization and simulated annealing approach had higher m values than two other approaches, indicating they are more effective in separating the complex networks into submodules. notably, since the simulated annealing approach was stochastic  <cit> , the submodules of pmens generated by this approach were slightly different with different runs. therefore, the greedy modularity optimization approach was preferred to identify the submodular structure of mens. the modular pmen of warming pyrosequencing dataset was shown in figure 4a. a total of  <dig> joint submodules with ≥ <dig> nodes were isolated from a single large module and all the other isolated modules were relatively small . the size of modules or submodules varied with  <dig> to  <dig> nodes.

eigengene network analysis and the modular topological roles
after modules and submodules are determined, the eigengene analysis is used to reveal higher order organizations in the network structure  <cit> . in the eigengene analysis, each module is represented by its singular value decomposition  of abundance profile called module eigengene  <cit> . in the warming pmen, the module eigengenes from top  <dig> large submodules  explained  <dig> - 68 % variations of relative abundance across different replicates, suggesting that these eigengenes represented the module profiles relatively well. the correlations among module eigengenes were used to define the eigengene network. eigengene analysis is important for revealing higher order organization and identifying key populations based on network topology  <cit> . in warming pmen, these correlations of  <dig> largest submodules were visualized as a heat-map and hierarchical clustering diagram . the eigengenes within several groups of submodules showed significant correlations and clustered together as super-groups, such as # <dig> and # <dig>  # <dig>  # <dig> and # <dig>  and # <dig>  and # <dig> and # <dig>  which were referred as meta-modules that exhibit a high order organization among submodules. besides, within each module, eigengene analysis approach was able to show the representative abundance profile and identify key members as shown in our previous paper  <cit> .

different nodes play distinct topological roles in the network  <cit> . the analysis of modular topological roles is important to identify key populations or functional genes based on the nodes’ roles in their own modules. their topological roles can be defined by two parameters, within-module connectivity  and among-module connectivity . the topological roles of nodes in warming and unwarming pmens were illustrated in zp-plot . according to values of zi and pi, the roles of nodes were classified into four categories: peripherals, connectors, module hubs and network hubs. from ecological perspectives, peripherals might represent specialists whereas module hubs and connectors were close to generalists and network hubs as super-generalists  <cit> . here, the majority of otus  under warming and unwarming conditions were peripherals with most of their links inside their own modules. a total of  <dig> nodes  were connectors and only four nodes  were module hubs. those four otus as module hubs were derived from planctomyces , nocardioides  under warming condition, and thermoleophilum  and gp <dig>  under unwarming condition, indicating that the hubs of pmens were substantially different under different conditions.

the correlations between network topologies with environmental traits
the relationships between microbial network topology and environmental characteristics can be examined in both direct and indirect ways. indirectly, as a first step, the otu significance  is calculated and defined as the square of pearson correlation coefficient  of otu abundance profile with environmental traits. then the correlation between gs and nodes’ topological indices  was used to measure the relationship of network topology with traits. for instance, in warming pmen, the gs of average soil temperature was significantly correlated with the nodes’ connectivity , indicating that the nodes with higher connectivity were inclined to have closer relationships with temperature. if multiple gs was involved, mantel and partial mantel tests could be implemented to calculate correlations between the connectivity and multiple gs of environmental traits to reveal the internal associations between network topology and environmental changes. in warming pmen, the nodes’ connectivity was significantly associated with the gs of ph values, soil no3-nitrogen and soil carbon contents when the effect of temperature was controlled . meanwhile, the gs of temperature was also significantly associated with the connectivity when aforementioned soil geochemistry factors were controlled  . moreover, the otus of β-proteobacteria and verrucomicrobia were highly associated with the changes of soil geochemistry . these results suggested that the otus topology in warming pmen was significantly associated with both temperature and the selected soil variables. in addition, otus from β-proteobacteria and verrucomicrobia were most sensitive to the changes of soil variables.

asoil variables used for otu significance calculations: ph values, no3-nitrogen and soil carbon contents.

bcorrelation coefficient based on mantel test.

cthe significance  of mantel test.

the correlations between module-based eigengenes and environmental factors can be used to detect the modules’ response to environmental changes. in warming pmen, the coefficients  and significances  were shown in a heatmap . submodules # <dig> and # <dig> were positively correlated with the average soil temperature significantly  but negatively  with soil ph values and soil carbon contents, indicating that the members in these two submodules might be stimulated by temperature but inhibited by soil ph and carbon. also, submodules # <dig> and # <dig> were positively correlated with soil ph , # <dig> was positively correlated with no3- concentration  and soil carbon content . while # <dig> was positively correlated with carbon content , # <dig> was negatively correlated with soil carbon content . in addition, # <dig> and # <dig> were negatively correlated with temperature . all above results demonstrated that different submodules in warming pmen responded to the environmental changes differently and the changes of temperature could have significant impacts on members of some submodules .

open-access pipeline
to facilitate the application of mena in the scientific community, an open-access pipeline for men construction and analysis  was implemented . although currently microarray-based intensity data and pyrosequencing data are two major types of informational sources for microbial community network analysis, a variety of other data types can be used for this pipeline as well. menap is implemented in perl integrated common gateway interface  and runs on a windows server . a user-friendly interface through web browser application was developed to facilitate the process of rmt-based network construction and related analyses . rmt-based threshold searching is performed using a java script  <cit>  and some network analyses are called in the programs of sna  <cit> , igraph  <cit>  and wgcna  <cit>  packages in the r project. the menap includes the following components:  user registration and login,  data upload,  network construction by the rmt-based method ,  network analysis, and  dataset and network management .

the network analysis component is further divided into three major parts:

 network characterization. various network properties are calculated and evaluated, such as connectivity, betweenness, clustering coefficient, and geodesic distance. the module/submodule detection and modularity analyses is performed using fast greedy modularity optimization  <cit> . eigengene network analysis is performed to understand network characteristics at higher organization levels and to identify key microbial populations or key functional genes in terms of network topology.

 network visualization. an automatic pipeline is constructed to visualize the constructed network. moreover, the file format for software cytoscape  <dig> . <dig>  <cit>  is prepared to visualize more complex and delicate network graphs. other data associated with otus, such as taxonomy, relative abundance, edge information, and positive and negative correlations is imported and visualized in network figures.

 network comparison. various randomization methods like the maslov-sneppen method  <cit>  are used obtain random networks for network comparison. various indices are evaluated for comparing the differences of networks among different communities in terms of sensitivity and robustness. in addition, otu significances are calculated to reveal associations of the network structure to the ecological functional traits  <cit> .

discussion and 
CONCLUSIONS
most previous studies on the biodiversity of microbial communities have been focused on the number of species and the abundance of species, but not interactions among species. however, species interactions could be more important to ecosystem functioning than species richness and abundance, especially in complex ecosystems  <cit> . several recent analyses show that the ecological networks of ecosystems are highly structured  <cit> , thus ignoring the structure of network and the interactions among network components precludes further assessment of biodiversity and its dynamics. several recent breakthroughs have been made to analyze species interactions of animals and plants  <cit> , but it is difficult to detect network interactions of a microbial community  <cit> . therefore, in this study, we systematically described a mathematical and bioinformatic framework of mena based on rmt, a powerful method well established in quantitative physics  <cit> . our results demonstrate that the rmt-based approach is powerful in discerning network interactions in microbial communities.

the network approach described is based on the transition of two universal distributions from the random matrix theory. a major advantage of rmt method is that the threshold to construct network is automatically determined. in contrast, most other methods studies use arbitrary thresholds, which are usually based on limited knowledge of biological information  <cit> . rmt-based approach selects an optimal threshold without ambiguity, which ensures its construction of optimal networks. another advantage of rmt-based approach is its remarkable capacity in tolerating noise, resulting in reliable, robust networks. our results show even with 100 % gaussian noise, more than 85 % nodes from original network are still preserved. this characteristic could be very important for dealing with the large-scale data, such as metogenomics and micrrorrays, which are generally inherent with high noise.

nevertheless, characterizing ecological network of microbial communities poses major challenges. mens are constructed by the adjacency matrix originated from the pair-wise correlations of relative otu abundance across different samples. therefore, a network interaction between two otus or genes describes the co-occurrence of these two otus or genes across different samples. the co-occurrence might be caused by species or genes performing similar or complementary functions, or shared environmental conditions that microbial species coexist in  <cit> . however, the former possibility can be complicated by the observations that functionally redundant genes are not necessary co-regulated, but instead co-regulated through other genes, which is coined as transitive co-regulation  <cit> . the latter possibility can be complicated by the distinctiveness of individuals in microbial niches observed in their behaviors and responses to environmental perturbation  <cit> . therefore, caution must be taken for the interpretation of underlying mechanisms that shape microbial communities.

a long-held tenet is that the structure of ecological networks has significant influence on the dynamics  <cit> . most complex systems have common characteristics such as small world, scale-free, modularity and hierarchy  <cit> . consistently, mens were found to be scale-free, small world and modular, in addition to hierarchical property in some mens. these network properties are important for the robustness and stability of complex systems  <cit> . for example, our results showed that any two microbial species in the community can be linked by just a few other neighbor species, showing small-world property. this may imply that the energy, materials and information can be easily transported through entire systems. in microbial communities, this characteristic drives efficient communications among different members so that relevant responses can be taken rapidly to environmental changes. meanwhile, it is intriguing to note that modularity is prevailing in mens, while hierarchy is present only in some mens. research on a wide range of architectural patterns in mutualistic  and trophic  networks showed that hierarchy, also called nestedness, was strong in mutualistic networks, but that modularity was strong in trophic networks  <cit> . although ecological networks of microbial communities are very complicated and cannot be classified into simple mutualistic or trophic networks, it would be interesting to compare a number of ecological networks of microbial communities to catalog different architectural patterns and to explore the mechanisms underlying the stability and resilience of communities.

in addition to interactions among microbes within a community, mens allow for analyses of interactions with their environment through correlations with abiotic environmental measurements, which might provide insights on the conditions that have significant impact on the co-occurring organisms. it is also possible to link groups of organisms with biogeochemical measurements to reveal the functional role of organism in biogeochemical processes. these kinds of data are important for generating hypotheses to help explain natural environments that microbial communities reside, which might lead to forecasting responses of microbial communities when environment changes  <cit> .

in summary, our study provides a mathematical/bioinformatic framework for network construction based on metagenomics data such as sequencing  <cit>  and microarray hybridization data  <cit> . it is useful, as demonstrated with the microbial communities under experimental warming, for dissecting interactions within a microbial community as well as with environment, thus allowing microbial ecologists to address a variety of ecological questions at the community-wide scale  <cit> . it is also possible to extend mena to emerging fields of microbial ecology such as high-throughput proteomics, since rmt is not stringent on data types. in addition, broad application of mena will generate a number of ecological networks that allow for exploration of architectural patterns of microbial communities  <cit> . this rmt-based molecular ecological network analysis provides powerful tools to elucidate network interactions in microbial communities and their responses to environmental changes, which are fundamentally important for research in microbial ecology, systems microbiology, and global change.

