BACKGROUND
discovering the molecular mechanisms underlying the protein functioning is a key step for understanding the complex processes involved in living systems, and would possibly allow to correct dysfunctions. large scale genomics projects are providing a huge amount of protein sequential and, at a lower but increasing rate, structural information. nonetheless, a large portion of such proteins have their function still undetermined, as it is often not straightforward to understand the details of a protein function even when its 3d structure is known. the task requires a time-consuming trial-and-error process of hypothesis formulation and verification by targeted experiments such as site-directed mutagenesis  <cit> . considering the rate at which protein structures are solved, the gap with respect to functionally characterized proteins is destined to increase over time. automatic approaches for the detection of protein functional sites can be very useful in narrowing this gap, by exactly determining functional residues or reducing the number of candidates to be experimentally verified.

in this paper we focus on predicting catalytic residues in enzymes. enzymes are proteins able to accelerate chemical processes inside a cell. in the catalysis the enzyme works by forming complexes with the substrates, usually small molecules, and in doing so it lowers the activation energy of the reactions thus increasing their rate. according to their function enzymes are classified into six functional classes in the so called enzyme classification  nomenclature  <cit> . many enzymes need to be bound to an additional non-protein component called cofactor in order to perform their function. cofactors can be grouped in:  coenzymes, i.e. dissociable cofactors that are usually organic; and  prosthetic groups, i.e. non dissociable cofactors. the enzyme lacking the cofactor is inactive and it is called apoenzyme, while the enzyme with the cofactor is active and it is called holoenzyme. enzymatic functional domains are also called active or catalytic sites. the residues that are directly involved in the catalytic process  constitute the active site, while residues in the surrounding space play the role of attracting and orienting the molecule to bind, and constitute the binding domain. the first kind of residues are of interest in our study. from now on we refer to them as functional or catalytic residues. traditional approaches to functional site identification use homology-based strategies. novel protein function is inferred by aligning the sequences or by superimposing the structures with already annotated proteins. in  <cit> , active sites of non annotated proteins in the pfam database  <cit> , which contains about  <dig>  protein families, are predicted by using a rule-based technique which exploits the homology and sequence similarity with other annotated proteins. the methodology is based on the transfer of experimentally determined active site data to other sequences within the same pfam family. the authors show that it is possible to gain functional annotation of a large number of sequences in the pfam database  for which the residues responsible for catalysis have not been determined. however, these homology-based techniques are well-known to fail in specific situations. first, an annotated homologue of the target protein needs to be available, preventing their applicability to novel folds. furthermore, proteins with similar overall tertiary structure can have different active sites, i.e. different functions  <cit> , and proteins with different overall tertiary structure can show the same function and similar active sites . finally, the increasing lack of functional annotations makes transferring them by homology even less effective.

a number of researchers have recently tackled the problem of functional residues prediction. in  <cit>  the authors generated three-dimensional templates of protein active sites with rigid prosthetic groups. their approach is based on the simultaneous alignment of several protein structures, and relies on local atomic-level similarities based on multiple comparisons. the generated patterns include 3d atomic coordinates, position of chemical groups, and cavity locations. however the approach remains limited to the subset of proteins having rigid prosthetic groups.

in its simpler formulation, functional residue prediction can be cast into a binary classification task at the residue level. petrova and wu  <cit>  and youn et al.  <cit>  have addressed it with a support vector machine  fed with both protein sequence and structural properties. capra and singh  <cit>  relied on an information-theoretic approach for estimating sequence conservation. the authors show that conservation of sequentially close residues improves predictive performance, especially when catalytic residues are involved. in  <cit> , carefully crafted conservation scores were shown to play a major role in predictive performance. closeness centrality measures  <cit>  have been used in  <cit>  to improve catalytic residue prediction by using neural networks trained with a genetic algorithm. a review on approaches and applications for structure-based protein function prediction can be found in  <cit> . interestingly, a recent study  <cit>  showed that sequence information alone could provide results similar to those obtained by previous structure-based methods. our early experiments came to the same conclusions , with profile enriched sequential information providing results which were statistically indistinguishable from carefully crafted features extracted from 3d coordinates  <cit> . this seems to indicate that much work has still to be done in order to fully exploit the information contained in protein three-dimensional structures. a number of recent approaches investigated the use of topological  <cit> , electrostatic  <cit>  and graph theoretic  <cit>  structured-based features for predicting ligand binding sites or protein functional sites. in a very recent work  <cit>  electrostatic features from thematics  <cit>  and geometric features are combined with sequence conservation features in a maximum likelihood approach called partial order optimum likelihood . the authors underline the key role of thematics features which are extracted from the residue theoretical titration curves.

in this work, we show how to effectively employ 3d structure information by modeling the structural neighborhood of candidate residues, represented as a sphere centered on the residue side chain. we encoded such neighborhood information with statistics on the properties of its content, such as physico-chemical properties, atomic density, flexibility, presence of water molecules. we trained a support vector machine combining our structural neighborhood features with evolutionary enriched sequence information as well as previously developed 3d features  <cit> . our structure-based method achieves improvements over both sequence-based and structure-based state-of-the-art predictors, as measured on a set of benchmark datasets with varying characteristics, and structural neighborhood information is shown to be responsible for such improvements. we additionally investigated the role of ligand information in presence of heterogens, playing possible catalytic or structural roles, and showed that exploiting such information in both sequence-based and structure-based active site predictions is an interesting direction for further research.

RESULTS
dataset
functional residue prediction can be cast into a binary classification task at the residue level, namely predicting for each residue of a given protein, whether it is directly involved in the catalysis or not. we performed a detailed analysis and feature engineering on a dataset  of  <dig> enzymes selected by petrova and wu  <cit>  for their structural and functional heterogeneity with respect to their scop fold classification, ec numbers and blast sequence similarity. the dataset contains enzymes from all the six classes in the enzyme classification  nomenclature. we collected sequential and three-dimensional data for a total of  <dig>  residues from the enzymes pdb files. few residues were removed with respect to the  <dig>  extracted in  <cit>  due to uncertain correspondence in the mapping between the two datasets or due to conflicts between the residues reported in the pdb structure file and in the fasta sequence from uniprot  <cit> . only  <dig> out of  <dig>  residues are labeled as functional in the catalytic site atlas  database  <cit> . hence the dataset is strongly unbalanced  with a ratio between positive and negative examples of about 1: <dig> 

we also conducted a broad experimental evaluation of the obtained features on a set of larger benchmark datasets which were proposed by previous sequence and structured-based approaches. three benchmark datasets with varying homology level were proposed in  <cit> : a scop fold dataset , a scop family dataset  and a scop superfamily dataset . two additional datasets were included to study the performance of our approach in the presence of low homology: the ha scop superfamily dataset from  <cit>  and the independent test set t- <dig> proposed in  <cit> . the characteristics of these five datasets are summarized in  <cit> . finally we included the dataset of  <dig> proteins  used in  <cit>  in order to compare with their approach.

experimental setting
we addressed the learning task with an svm, a state-of-the-art binary classification algorithm which aims at separating positive and negative examples with a large margin, possibly accounting for margin errors. details on svms can be found in several textbooks  <cit> . all experiments were carried out using the svm light  <cit>  software  <cit>  downloadable from http://svmlight.joachims.org/. our experimental evaluation is based on a 10-fold cross-validation procedure stratified at the protein level, that is, assuring that all residues of a certain protein always appear together in the same fold.

we fixed the regularization parameter  to  <dig>  and tuned the cost factor , which outweighs the error on positive examples with respect to that on negative ones, on each fold of the 10-fold cross-validation by an inner cross-validation procedure inside its training set. tuning the cost factor is particularly important for this application due to the strong imbalance between the number of positive and negative examples. previous works  <cit>  addressed such a problem by subsampling negative examples according to a certain ratio and training the classifier on the reduced set.

performance measures
the following measures have been used to evaluate our approach:

• precision = 

• recall or sensitivity or tp rate = 

• fp rate  = 

• f <dig> measure, f <dig> = 

• matthews correlation coefficient = 

• area under the averaged receiver operator characteristic  curve 

• area under the averaged recall/precision curve 

where t+, t-, f +, f -are the true positives, true negatives, false positives and false negatives respectively.

f <dig> is the harmonic mean between recall and precision, giving equal weight to the two complementary measures. it is the measure we optimized in our model selection phase. the averaged roc and rp curves are drawn by averaging the per-protein curves as in  <cit> . roc and rp curves and their areas provide a broader picture of a classifier performance, as they do not require to choose a fixed decision threshold to discriminate positive and negative examples, but evaluate all possible thresholds. for highly skewed datasets, the area under the rp curve is more informative than the area under the roc  <cit> . we included both measures to allow for comparisons with previous approaches.

statistical tests
we evaluated the statistical significance of the performance differences between the various settings by paired wilcoxon tests on the f <dig> measure reported for each fold. we employed a confidence level α of  <dig> .

overview of the extracted features
we extracted different sets of features from both primary and tertiary protein structure in order to represent candidate residues. tables  <dig> and  <dig> summarize our sequence and structural features respectively. in the following we give a brief overview of such features, while a detailed description is provided in the methods section.

representation: features extracted from the protein sequence.

representation: scalar features extracted from the residue structural neighborhood.

from the protein sequence we extracted a conservation profile  capturing evolutionary information, together with standard attributes encoding the name and type of the amino acid .

from the protein tertiary structure we extracted features characterizing the three-dimensional neighborhood of a residue: statistics on the neighborhood properties such as physico-chemical characteristics , type and frequencies of the neighboring amino acids , charge or neutrality of the surrounding space , presence of the water , atomic density , flexibility of the target residue ; the presence of disulphide bridges involving the target residue ; information on the presence of potential cofactors or other ligands, by encoding the presence of nearby heterogens playing possible catalytic or structural roles  as well as the fact that they directly bind the target residue . the methods section gives a detailed explanation of such structural features and the rationale behind their use.

our aim was to exploit information related to the properties of the local structure surrounding a residue. we added these features to those already used in  <cit> , which aim at modeling properties of the target residue plus its relationship with the whole region containing it. such combined representation allowed us to obtain significant improvements, as detailed in the results section.

legend of abbreviations for the different sets of attributes tried in the experiments .

results of different feature sets
we conducted a set of experiments aimed at elucidating the role of the different feature sets on the pw dataset . preliminary experiments showed that polynomial  or gaussian kernels did not significantly improve performance with respect to simpler linear kernels. all reported results thus refer to the latter type of kernel. table  <dig> reports a summary of experimental comparisons for different sets of sequence- and structure-based features we used.

                              f
                              1
                              mcc
                              aucroc
                              aucrp
summary of the results of the cross-validation on different selected attributes .

the first set of experiments refers to a sequence-based functional residue predictor, where each residue is characterized by features extracted from the protein sequence only . in table  <dig>  row  <dig> reports experimental results obtained by using our sequence-based attributes only, including the multiple alignment conservation profiles. we also experimented windows of conservation profiles of size varying between  <dig> and  <dig>  where size w implies a window of w residues on each side of the target residue along the primary sequence, in addition to the profile of the target residue itself. including such windows only provides a slight improvement  while drastically reducing the classifier efficiency. furthermore, the features proved harmful when combined with structural information, possibly because the large number of features they introduced covered the signal coming from other more informative ones.

rows  <dig> and  <dig> report additional results on sets of attributes extracted from sequence information only. the set svm_p51d is a group of five attributes from  <cit>  which includes the 1d <dig> and 1d <dig> attributes  and a conservation score from the scorecons server  <cit> , plus its entropy and relative entropy values, in place of our conservation profile. the results are comparable with those obtained with conservation profiles. results combining all the available features extracted from the protein sequence are reported in row  <dig> .

results in the rows from the fourth on include additional information provided by structural features. in rows  <dig> and  <dig> we employed the two sets of attributes proposed in  <cit> , i.e. the subset of the  <dig> optimal ones  and the entire set of  <dig> attributes  respectively. note that we obtained performance improvements over the original results in  <cit>   by tuning the cost factor for false positives versus false negatives, as compared to random sub-sampling negative examples in order to obtain a balanced set.

statistical comparisons of our best set of sequence-based features , the set of sequence-and structure-based features employed in petrova and wu  <cit>  , and their combination with our additional set of structural neighborhood features , excluding those coming from ligand information. cross-validated f1measures  and results of a paired wilcoxon test  on the statistical significance of the performance differences are reported for all benchmark datasets employed in this study. a white circle indicates a statistically significant improvement of the classifier in the row over the sequence-based classifier , while a black bullet indicates a statistical significant improvement over the petrova and wu features .

on the one hand, using features extracted from primary sequence alone allows us to apply the predictor to the much larger set of sequentially but not necessarily structurally determined proteins. on the other hand, as we already discussed in the introduction and also stated in the review of  <cit> , the availability of structural information should be able to significantly contribute in solving the task. indeed, adding three-dimensional information in the form of properties of the residue structural neighborhood allowed us to achieve significant improvements, as detailed below.

row  <dig> in table  <dig> reports results of the combination of our conservation profiles  with all the sequence and structural attributes in  <cit> . row  <dig> reports the result obtained by adding structural attributes encoding statistics of the residue three-dimensional neighborhood properties  without including the attributes related to the ligands . such results are always significantly better than those of sequence-based classifiers according to the statistical tests . furthermore, performance improvements with respect to previous structure-based results  are significant in all but the smallest test set.

finally, row  <dig> reports the performance obtained by including all the available ligand-based features, which allow to achieve further improvements and correctly predict some especially tough cases , paving the way to an interesting research direction. additional files  <dig> and  <dig> report detailed results and predictions for this classifier.

in order to better understand which are the features contributing the most to the classifier performance, we analyzed the weight vector  describing the separating hyperplane learned by the svm. the  components with higher absolute value are associated to the most discriminant features of the classifier. in figure  <dig> we represent the weight vector of a classifier trained on the pw dataset. among the most relevant properties there are features related to the relative position on the protein surface , features related to the conservation along the primary sequence  and also features describing the structural residue neighborhood. for instance, the fractions of amino acids with low and medium hydrophobicity are quite discriminative in opposite directions. the same holds for low and medium van der waals volume. other discriminative features include the atomic density of the residue sphere and the features related to its amino acidic composition: in particular the number of asn, cys and gln residues, but also that of met, phe and trp ones.

further analyses on the effect of different sets of features on prediction errors provide some interesting insights on their usefulness and reliability. the quality of multiple alignments strongly influences the performance of sequence-based classifiers. on the proteins for which psi blast did not provide good alignments we observed poor performance. in those cases structural features help in compensating such deficiencies. the inclusion of ligand features allows the correct prediction of many catalytic residues which have low catalytic propensity, like the glycine in the methylglyoxal synthase  and the glycine in the human glutathione synthetase . the latter is one of the emblematic cases of the importance of ligand features, as in the absence of those features only one of its four catalytic residues is correctly predicted. in the phosphofructokinase  the encoding of ligand features helps to correctly predict the two arginine residues of the active site. by looking at the three-dimensional structure of the protein, the active site seems to be exposed rather than located in a hydrophobic core. this implies that active site residues have associated structural features which may differ from those typical of the other catalytic residues in the dataset. on the other hand, we also observed few cases in which the addition of ligand features worsens predictions. this happens mainly when no heterogen appears in the crystal structure, possibly because the enzyme was solved in its apo form. we are planning to verify such conjecture by applying techniques for detecting binding sites in 3d structures  <cit> . note that while the presence of a heterogen provides a clear hint that the area could contain an active site, it is not by itself sufficient to determine the set of catalytic residues. out of the  <dig> heterogen-binding residues in the dataset, only  <dig> were actually labelled as catalytic. if we restrict to the subset of heterogens which tend to occur near catalytic sites in enzymes , the fraction becomes  <dig> out of  <dig>  as detailed in  <cit> , the sole fact of binding a substrate or cofactor does not classify a residue as catalytic. it also has to perform some specific activity such as proton abstraction from substrate, cofactor or water activation. for instance, the above-mentioned phosphofructokinase  contains three heterogens: adp, beta-fructose diphosphate , and a magnesium ion; of the  <dig> residues which bind one of them, only four are actually catalytic. in this case the predictor manages to selectively exploit ligand information in identifying two active arginine residues, one of which does not directly bind any heterogen, with a single additional fbp-bound arginine incorrectly predicted as catalytic. given that information on binding residues helps detecting active ones, it would be interesting to predict it when missing, either because sequence information alone is available, or because the 3d-structure does not contain the bound cofactor and/or substrate. indeed, both binding and active residues should be identified in order to fully characterize the functional domain. we believe that combining active and binding site prediction in a single collective model, as already done with profile-hmm for specific functional domains  <cit> , is a promising research direction, which can rely on a number of works for predicting binding sites from both sequence  <cit>  and structural information  <cit> .

3d kernel
in order to further investigate the discriminative potential of the features extracted from the 3d residue neighborhood we also experimented a structured kernel. we employed a 3d decomposition kernel on planar shapes in the 3d space. this kernel was proposed in  <cit>  for the classification of small molecules. we adapted it to the functional residue prediction task by extracting specific shapes from the residue structural neighborhood. among the different design choices we tried, the best performing one was the set of planar shapes of two  and three  vertices in the 3d neighborhood of a residue. one of the vertices was the target residue itself, and the others were residues evolutionary conserved over one of the hydrophobic, charged or polar classes. while providing reasonable performance when used alone, with an average f <dig> of 22% and an average mcc of 25%, such shapes failed to improve performance in combination with the remaining sequence- and structure-based features. this result confirms that effectively exploiting three-dimensional information for modeling catalytic residues is a hard task, and further research is needed.

comparison with other methods
we conducted a broad range of experiments on multiple benchmark datasets , and compared our results with the most recent methods for both sequence-based and structure-based prediction. considered that none of the other methods directly encodes information on heterogens, we excluded such features from our set in all these comparisons.

comparison with the crpred  <cit>  sequence-based approach on six benchmark datasets. for each dataset we report recall obtained by our predictor at a precision equal to that of the competing method and precision at equal recall. results are obtained without including ligand information.

previous results  <cit>  suggested that appropriate sequence-based features managed to match performance of different structure-based predictors on the same datasets, a result we also observed in our early experiments on the pw dataset. conversely, the improvements we achieve here show that structural information can indeed be effectively employed in predictions. nonetheless, further research is needed in order to fully exploit it, as our results using heterogen information seem to indicate.

for each dataset we report the recall obtained by our predictor at a precision equal to that of the competing method and the precision at equal recall. results are obtained without including ligand information.

                              f
                              mcc
                              aucroc
                              aucrp
1subsampling of negative examples with a ratio of 1: <dig> w.r.t. positives

2directly computed

results include both performance measures at fixed decision threshold and average areas under roc and rp curves. results are obtained without including ligand information.

finally, we compared with the recent structure-based predictor pool  <cit>  , which combines effective electrostatic features from thematics  <cit>  with geometric and sequence conservation features in a maximum likelihood approach. averaged roc curves are reported in figure  <dig>  we compared our method and the pool predictor with different sets of features as taken from  <cit> . the point representing petrova and wu results was also included in the graph. our method achieves superior recall for all possible values of the false positive rate. we also conducted experiments on the dataset of  <dig> proteins proposed by the pool authors  <cit> . in table  <dig> we compare our results with the results of the best classifier  × pool × p ool) reported in  <cit>  at equal recall and at equal precision. averaged recall  and precision  are computed as in  <cit>  as averages at the protein level. the area under our averaged roc curve is  <dig>  as compared to  <dig>  achieved by the best set of features for pool.

                              aucroc
performance measures include: the average per-protein precision at equal recall, the average recall at equal precision, and the average area under the roc curve . results are obtained without including ligand information.

CONCLUSIONS
in this work we addressed the problem of predicting catalytic residues from protein sequence and structure. we developed an effective approach to exploit structural information, by modeling residue structural neighborhood as a spherical region centered on the side chain centroid and including various statistics on the properties of the neighborhood content. our method outperforms the current state-of-the-art sequence-based and structure-based approaches, as shown on different benchmarking datasets. we further explored the information provided by the presence of nearby heterogens, playing possible catalytic or structural roles, when such information is available from the solved structure. we showed that ligand information can play a key role in correctly identifying functional residues with low catalytic propensities, and we are currently investigating solutions to jointly predict active and binding residues in the site in a fully collective approach.

