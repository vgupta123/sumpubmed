BACKGROUND
tiling micro arrays query genomic sequence in a manner not biased towards coding transcripts and has proven a valuable resource in the exploration of genomic expression. to date, the approach has been applied to human, arabidopsis, and rice  <cit>  and has been reviewed recently  <cit> . the challenge of tiling micro array analysis is to categorise genomically consecutive probes as either expressed or non-expressed. the affymetrix tiling array analyses  <cit>  invoke extensive experience from gene arrays. here, chip noise between replicates is dealt with using a quantile-normalisation procedure  <cit> . background and probe sequence-specific signal is normalised using the mas  <dig>  method  <cit> . in order to convert expression values into transcribed fragments  affymetrix uses a smoothing window approach, whereby expression values within a genomic neighbourhood are averaged. a region is labelled as expressed if all probes exceed a threshold value. the threshold is determined from expressed rna spiked into the micro array experiment. neighbouring regions closer than a distance threshold are then joined, forming transfrag predictions. we will use the collective acronym antm for for affymetrix's normalisation and transfrag methods. for a review of existing algorithms for tiling micro array analysis see royce et al.  <cit> .

previous related work includes analysis of chlp-chip experiments using affymetrix tiling arrays to predict transcription factor binding sites  <cit> . these chlp-enriched regions on the tiling arrays are predicted using log-odds scores for each probe generated by a two-state hidden markov model. tiling array intensities have been used together with a rudimentary hmm gene finder to establish likely exon-intron transcripts in windows of significant expression intensity  <cit> . this work, however, does not treat the probe intensities as observables of the hmm but as separate evidence supporting prediction of expression.

the approach to tiling array analysis presented here employs a hidden markov model , trained directly on the correspondence between tiling array fluorescence scores and annotation of expression. the model is then used to categorise consecutive probes as expressed or non-expressed. training the model using annotation of expression presents a problem since, in many cases, annotation does not represent actual expression. this may be due to a number of factors, such as non-expressed genes, alternative splicing, un-annotated exons, antisense transcription, and non-coding rnas. this type of incomplete information presents a problem to machine learning approaches as missing information compromises the training of the model unless properly addressed. we describe a two-step modelling and training approach that allows the training algorithm to down-weight dubious annotation in the context of the relevant cell line. the adaptive nature of our method avoids the ad hoc thresholds characteristic of previous work. as a case study we analyse human tiling array data of a single cell-line from cheng et al.  <cit> .

methods
data
the data we use is derived from the tiling array experiments on human chromosomes  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>  x, and y  <cit> . the tiling arrays use 25-mer probes querying genomic positions at five nucleotide intervals on the genomic sequence. only non-repetitive sequence is tiled resulting in a coverage of approximately 30%. from the cheng et al. raw array data we analyse the subset querying poly-adenylated rna extracted from human neuroblastoma cells .

array and probe normalisation
the affymetrix mas  <dig>  method addresses probe and array normalisation by, in addition to perfect match  probes, also designing mismatch  probes, where the complementary base at the 13th position of the  <dig> mer probe is used instead of the actual base. the mismatch probe is expected to capture much of the probe sequence and array-specific contributions to the signal as well as problematic probe eccentricities such as secondary-structure and cross-hybridisation effects while capturing little real signal. the difference in fluorescence score for the pm probe and an idealised-mm probe score is then used to estimate expression signal from the queried genomic position.

we tested a number of strategies for array and probe normalisation. these included pm - mm with and without quantile normalisation and a novel approach inspired by naef and magnasco  <cit>  that shares similarities with gc-rma  <cit> .

for the normalisation inspired by naef and magnasco sequence and array specific signal is modelled in a way that allows this to be subtracted from the raw signal. for each chip a large sample of probe scores are selected and used to fit position-specific estimates of nucleotide contribution to the signal. three free parameters for each position times the  <dig> parameters for each probe sequence position gives rise to  <dig> parameters. these are modelled by the following linear system:

pm.estimate=∑i=175aixi,
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgqbaucqwgnbqtcqgguaglcqwglbqzcqwgzbwccqwg0badcqwgpbqacqwgtbqbcqwghbqycqwg0badcqwglbqzcqgh9aqpdaaewbqaaiabdggahnaabaaaleaacqwgpbqaaeqaaogaemieag3aasbaasqaaiabdmgapbqabaaabagaemyaakmaeyypa0jaegymaedabagaeg4nacjaegynaudaniabgghildgccqggsaalaaa@4a24@

where each nucleotide type  in position k in a 25-mer probe is modelled by a triple in the indicator function ai . i.e. an a at position k has corresponding coefficients  = , a c has corresponding coefficients , a g has corresponding coefficients , and a t has corresponding coefficients . a least-squares solution to this system of equations for xi provides estimates of the expected contribution to the expression for any nucleotide at position k. that is, the estimated contribution to the expression level of an a at position k is given by x3k- <dig>  a c at position k is given by x3k- <dig>  a g at position k is given by x3k, and a t at position k is given by -x3k- <dig> - x3k- <dig> - x3k. to obtain a representative expression level over different replicates the mean log-likelihoods are computed:

ll:=13∑i=13log⁡2pmiestimate.pmi.
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgmbatcqwgmbatcqgg6agocqgh9aqpdawcaaqaaiabigdaxaqaaiabiodazaaadaaewbqaaigbcygasjabc+gavjabcegannaabaaaleaacqaiyagmaeqaaaqaaiabdmgapjabg2da9iabigdaxaqaaiabiodazaqdcqghris5aowaasaaaeaacqwgqbaucqwgnbqtdawgaawcbagaemyaakgabeaaaoqaaiabdwgaljabdohazjabdsha0jabdmgapjabd2gatjabdggahjabdsha0jabdwgaljabc6cauiabdcfaqjabd2eannaabaaaleaacqwgpbqaaeqaaogaeiola4caaaaa@5338@

an illustration of this strategy and comparison with unnormalised distributions is shown in figure  <dig>  for the pm - mm approach rather than using an idealised mm we use the raw values of both pm and mm. a representative expression level over different replicates using the mm probe are computed as:

d¯:=13∑i= <dig> 
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqdaaqaaiabdseaebaacqgg6agocqgh9aqpdawcaaqaaiabigdaxaqaaiabiodazaaadaaewbqaaiabcicaoiabdcfaqjabd2eannaabaaaleaacqwgpbqaaeqaaogaeyoei0iaemyta0kaemyta00aasbaasqaaiabdmgapbqabagccqggpaqkasqaaiabdmgapjabg2da9iabigdaxaqaaiabiodazaqdcqghris5aogaeiola4caaa@438c@

the performance of each normalisation strategy was evaluated  and d¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqdaaqaaiabdseaebaaaaa@2dce@ was chosen as the more appropriate.

training data
from ensembl   <cit>  we extract all annotated human refseq transcripts  <cit>  for the relevant ten chromosomes. transcripts with no introns are discarded. to obtain a one-to-one correspondence between annotation and sequence, overlapping annotation of expression is collapsed, forming a single set representing all annotated expression. the training set consists of refseq genes each represented by the corresponding sequence of genomically consecutive probe scores. using the 5' position of probes on the genome each probe is labelled as expressed or non-expressed in accordance with the collapsed refseq annotation . the training set includes  <dig> sequences of labelled probe scores that each represent the transcribed part of a refseq gene. the entire set is used for training the hidden markov model . for evaluation purposes a ten-fold cross-validation is used.

hmm architecture and training
the correspondence between scores and annotated expression, presented by the training set, is captured by an hmm, see e.g. durbin et al.  <cit> . an hmm is a probabilistic model that consists of a set of connected hidden states that each emit observables. in this case, states represent expression and non-expression and these states emit scores that constitute the sequence of probe scores over expressed or non-expressed regions. first order emission probabilities are used to model the dependency of scores for neighbouring-probes.

the hmm is shown in figure  <dig>  two loop states  model the bulk of probe scores in expressed and non-expressed regions, capturing the score distributions of the two cases. the loop states are connected by states that capture score gradients induced by genomically consecutive probes that overlap borders of expressed regions. the loop probabilities are tied during training of the hmm and thus estimated as one parameter. this is done in order to avoid bias of predictions towards typical exon length. the hmm used is discrete and expression scores are binned. considering the distributions of scores for probes annotated as expressed and non-expressed, we choose  <dig> bins uniformly covering the scores from - <dig> to  <dig>  another two bins capture extreme positive and negative values, .

the type of hmm used is a class hmm  <cit> . the collection of states in a class hmm is divided into classes, each designated by a label. the observables  in the training set are each assigned a label corresponding to a class. an observable with a given label can only be emitted by a state belonging to the class designated by that label. hence, the labelling of states and observables in the training set determines which parts of the training data are used to estimate which parts of the model. in our case, the labels are expression and non-expression and correspond to the red and blue colours in figure  <dig>  the advantage of the class hmm is that it allows all model parameters to be estimated simultaneously from sequences of labelled probe scores. alternatively, the individual parts would have to be estimated separately from expressed and non-expressed probe scores. the model is trained using the baum-welch algorithm  <cit> .

self-supervised re-training
as noted above, the correspondence between labelling of probe scores and actual expression in the relevant cell line is at best an approximation. this issue is addressed by re-training after adding a parallel shadow model that mirrors the core model shown in figure  <dig>  the combined model is shown in figure  <dig>  each state in the shadow model, x′i
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgybawgaqbamaabaaaleaacqwgpbqaaeqaaaaa@2f78@, shares emission probabilities with a corresponding state, xi, in the core model but does not contribute to the estimation of these parameters. the labelling of states in the shadow model differs from those of the core model in that the states e′i
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgfbqrgaqbamaabaaaleaacqwgpbqaaeqaaaaa@2f52@ model non-expressed probes labelled as expressed and the n′0
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgobgtgaqbamaabaaaleaacqaiwaamaeqaaaaa@2ef7@ state models expressed probes labelled as non-expressed. additional states impose a minimum on the number of consecutive probe scores that can be captured by the shadow model. without this constraint the model is not able to distinguish natural variation and noise from dubious annotation. the shadow component models regions annotated as expressed using the score distribution initially learned from non-expressed regions. analogously regions annotated as non-expressed are modelled using the score distribution initially learned from expressed regions. re-training after adding the shadow model allows the baum-welch algorithm to weight the contribution of training information to parameter estimation in proportion to how characteristic this is: in the e-step of the baum-welch algorithm the posterior probabilities of each emission from state xi are summed over all observables in the training set. the x′i
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgybawgaqbamaabaaaleaacqwgpbqaaeqaaaaa@2f78@ state does not contribute to this sum. hence, the posterior probability of using state xi relative to x′i
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacuwgybawgaqbamaabaaaleaacqwgpbqaaeqaaaaa@2f78@ for a given observable effectively constitutes a weight reflecting how likely the annotation is at the given position in the training set given the probe score distributions learned in the initial training. as a result, each subsequence of labelled probe scores in the training set contributes to estimation of emission probabilities to an extent determined by its reliability. it should be noted that the maximum likelihood of the model is obtained when only transition probabilities in the slave model are positive – the situation where the model discards all training material. the pre-training, however, produces a starting point that allows the model to reach a desirable local optimum.

once the parameters of the hmm have been estimated the parallel shadow architecture is removed. the sequences of probe scores corresponding to the tiling of each chromosome are then decoded using an n-best algorithm  <cit> . in this step the most likely sequences of contiguous expressed and non-expressed probes are established. in addition, the forward-backward algorithm  <cit>  is used to assign a posterior probability of expression to each probe. the prediction for each sequence of probe scores is then mapped onto the nucleotide sequence of the corresponding chromosome.

the tiling of the chromosomes only covers non-repeat sequence. some predictions may span untiled regions. to avoid this, gaps in the tiling larger than ten bases are removed from the predictions.

evaluation of performance
to establish the relative performance of expresshmm and affymetrix's normalisation and transfrag method  we test each method on the training set of probes covering refseq genes. to ensure that test and training material do not overlap, the performance of expresshmm is evaluated using six-fold cross-validation. the antm predictions are mapped onto the training set for comparison.

to acknowledge the most recent repeat predictions we remove, from all genomic predictions, all overlaps to the human repeat masker annotation from the ucsc genome browser database   <cit> . performance statistics are calculated using the eval program  <cit> . sensitivity is defined as true positives divided by the sum of true positives and false negatives but is calculated as the number of annotation objects  overlapped by predictions, divided by the total number of annotation objects. specificity is defined as true positives divided by the sum of true positives and false positives but is calculated as the number of prediction objects overlapping annotation objects divided by the total number of prediction objects. the statistics are calculated this way to ensure a sensible treatment of one-to-many overlaps. since the motivation in tiling array analysis is to find un-annotated expression a high specificity based on known expression is not a goal in itself. for this reason we report  <dig> – specificity as "novel prediction".

to further evaluate the performance we compare the two sets of predictions to annotation of human ests, mrnas, and known genes . only annotation of tiled genomic sequence is included. before evaluation the expression annotation is pooled and all overlapping annotation is collapsed into a maximal set where each nucleotide is only represented once.

within both sets of annotation only a subset are actually expressed in the sk-n-as cell line, and a substantial fraction of expression remains un-annotated. collapsing all overlapping annotation presents a similar problem especially affecting splice site statistics. relying on this annotation will make estimates of sensitivity artificially low and the absolute values of this statistic should not be given too much weight. the relative values for expresshmm and antm, however, should accurately reflect relative performances.

RESULTS
the performance statistics obtained from the cross-validation of our model is shown in table  <dig>  statistics of the expresshmm genomic predictions on the ten chromosomes are shown in table  <dig>  the overlap of expresshmm predictions to antm predictions is shown in figure  <dig>  the distribution of predictions and annotation is exemplified by chromosome  <dig> shown in figure  <dig> 

in addition to the most likely categorisation of probes expresshmm also calculates a posterior probability of expression for each probe. when mapped to the nucleotide sequence this results in an expression probability curve parallel to the predictions allowing the user to evaluate the significance of predictions and to directly view the evidence of expression.

two example predictions, together with the antm predictions, are shown in figure  <dig> and  <dig>  note the correspondence between expresshmm predictions and conservation in human, chimp, mouse, rat, dog, chicken, fugu, and zebrafish  <cit> .

all predictions can be downloaded and viewed from our web site  <cit> .

discussion
evaluation of normalisation strategies
in the process of developing our method we compared the performance of the ll and d¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqdaaqaaiabdseaebaaaaa@2dce@ normalisation strategies on the training set. six-fold cross-validation was used to ensure no over-training. the nucleotide-level sensitivities of ll and d¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqdaaqaaiabdseaebaaaaa@2dce@ was approximately  <dig> % and  <dig> % respectively with corresponding specificities of  <dig> % and  <dig> %. subsequent optimisation of the model resulted in further improvement of these values . the ll based normalisation is significantly more specific than the d¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqdaaqaaiabdseaebaaaaa@2dce@ approach but at a significant cost to sensitivity. we have used the d¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqdaaqaaiabdseaebaaaaa@2dce@ approach in this study because we view sensitivity as a more desirable trait than specificity for our predictor.

a tentative explanation for these rather surprising differences in performance can be found by considering figure  <dig>  observe the heavy right tail of the ll distribution for probes tiling coding regions. for the d¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqdaaqaaiabdseaebaaaaa@2dce@ method both the left and right tails of the distribution are heavy for probes tiling coding regions. the hmm only requires significantly different distributions between expressed and non-expressed regions in order to perform well. the two heavy tails generated by the d¯
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaadaqdaaqaaiabdseaebaaaaa@2dce@ method seems to supply more discriminative information to the hmm than the single heavy tail generated by the ll method. the effect of quantile normalisation was tested. this did not improve performance, and is not used for the results presented.

relative performances on the training set
as shown in table  <dig>  our probe sensitivity is higher than antm. of the total number of probes annotated as expressed we predict 21% more than antm. note that the upper limit to sensitivity is not 100% as only a fraction of the annotated sequence is actually expressed. for identification of exons expresshmm is equal to antm but better at predicting the borders of expressed regions correctly. the percentage of predicted probes that do not overlap refseq exons is 16% larger than antm. in contrast, the number of predicted transfrags not overlapping a refseq exon comprise only 27% of the expresshmm predictions whereas this number is 58% for antm. this means that even with the higher probe sensitivity expresshmm is more conservative than antm in predicting novel transfrags.

the hmm in expresshmm models the signal variability within expressed and non-expressed regions. as a result the algorithm does not predict very short expressed or non-expressed regions unless the relevant probe scores are highly characteristic. antm's threshold approach allows for little variability in score along a region. for these reasons antm tends to split exons into smaller predictions whilst expresshmm tends to join proximal exons into a single prediction. these differences are reflected in the length statistics given in table  <dig>  in effect, the two methods complement each other.

relative performances on the chromosome level
the comparison of genomic predictions to all human est, mrna and known gene annotation within the tiled regions also reflects the good performance of expresshmm. the nucleotide sensitivity is 75% larger than antm's and our transfrag sensitivity is 23% larger. expresshmm identifies an 19% larger fraction of novel nucleotides. in contrast, however, the fraction of novel transfrags among expresshmm predictions is 24% smaller than among antm predictions.

expresshmm predicts roughly twice as many expressed nucleotides as antm. still the total expresshmm predictions only amount to  <dig> % of the genome. for comparison, recent cdna based findings in mouse indicates that 62% percent of the genome is transcribed and that the number of transcripts is at least an order of magnitude larger than the estimated number of genes  <cit> .

as indicated by the nucleotide plot in figure  <dig> the lower nucleotide specificity of expresshmm is not due to false positives uniformly distributed across the chromosomes. rather, the distribution closely follows the density of both antm predictions and refseq exons. note the excess of prediction in the sub-telomeric regions. this is most likely due to frequent duplication events in these regions as observed in the recent chimpanzee-human genome comparison  <cit> . these duplications are expected to cause extensive cross-hybridisation. the two large peaks around 4e+ <dig> correspond to similar-sized peaks in the density of est and mrna annotation .

the transfrag plot in figure  <dig> shows the close correspondence between the distributions of expresshmm predictions and occurrence of refseq exons.

hidden markov model
individual values of probe scores form only a fraction of the signal characteristic of expressed and non-expressed regions. the distribution of scores within and between regions of expression constitutes an important source of information that is not utilised by simple threshold approaches. to capture as much relevant information as possible we use an adaptive approach. this learns directly from probe scores covering regions where expression is annotated. as a result the parameters of the model are optimal for the training data. these properties takes the place of the ad hoc cut-offs applied in previous approaches. 

before settling on the hmm described above, a variety of models were tested. these included different order markov models with and without modelling of transfrag borders. none of these offered apparent advantages over the one presented here. the order of the hmm has a pronounced effect on the results. for zeroth and first order emissions the nucleotide statistics are very similar. on the transfrag level, however, the zeroth order model is more sensitive  but less specific . we also experimented with excluding score sequences from the training set that did not seem unambiguously expressed. this improved the performance of some models but not that presented here.

the training of the model parameters does not include any nucleotide sequence information. in addition, to avoid any discriminative length modelling characteristic of coding exons the trained intron and exon length distributions are geometric and estimated as one to make them identical. as a result, the training data does not bias expresshmm predictions towards the length distribution of coding exons.

the expression probability curve that accompanies the expresshmm prediction has a direct interpretation as the evidence of expression given the model. it is a valuable tool to visually assess the significance of each transfrag as well as to identify regions with evidence not sufficient to result in a transfrag. with slight modifications expresshmm can equally well be used for the analysis of tiling micro arrays with non-overlapping probes of various length.

CONCLUSIONS
in addition to performing better than the approach presented by cheng et al.  <cit> , the adaptive approach used by expresshmm avoids ad hoc thresholds for the analysis of signal data. decisions regarding prediction are learned from the data in an automated fashion. in addition to predicting the most likely categorisation into expression and non-expression each genomic position queried by a probe is assigned a probability of expression. the resulting graph has a clearer interpretation than a smoothed fluorescence score. we expect that tiling arrays will play an increasing role in the investigation of genomic output.

authors' contributions
kasper munch and paul p. gardner contributed equally to the work presented, performing analyses, data acquisition, and preparing the manuscript. peter arctander and anders krogh contributed ideas and supervision.

