BACKGROUND
transcription factors  are proteins that bind sequence elements in dna and thereby affect expression of neighboring or distal genes. depending on cellular contexts, such as hormone stimulus or the cell’s differentiation state or cell type, a tf can bind to different subsets of the tf’s potential binding sites and regulate different gene expression programs
 <cit> . investigating this context-dependent binding of tfs and the causes of binding differences across different cellular contexts is therefore fundamental for understanding gene regulation in general, and also for understanding how differential binding by tfs contribute to disease development.

there are three main factors that determine a tf’s binding activity at a potential binding site. first, tfs bind to specific sequence motifs
 <cit>  that favor a local dna structure recognized by the tf’s dna-binding domain. second, the local chromatin structure needs to be favorable for tf binding. specifically, the chromatin must be sufficiently accessible to allow the tf to scan and bind to its sequence motif
 <cit> —a process that is influenced both by high level chromatin structure and local nucleosome positioning
 <cit> . certain post-translational histone modifications are associated with open or closed chromatin and therefore also binding site activity, but certain tfs may also directly bind specific histone modifications
 <cit> . similarly, dna methylation also affects tf binding—both by directly affecting binding motifs and by being involved in altering local chromatin structure
 <cit> . third, tf co-activators can recruit and stabilize tf binding, whereas repressors can out-compete or hinder binding to a potential binding site
 <cit> .

the tf binding activities that result from a given cellular context form in sum a transcription regulatory network. there are many different methods of inferring the structure of such regulatory networks in silico. some of these methods rely on context-dependent data, such as experimentally determined gene expression, tf binding, or chromatin structure
 <cit> , and therefore produce networks specific to a given context. examples include methods that rely on gene expression data only
 <cit> , and methods that integrate expression data and binding location data
 <cit> .

in comparison, many traditional methods for inferring regulatory networks are context-indifferent, typically relying on sequence motifs to map putative transcription factor binding sites . some of these methods use additional data such as a putative site’s conservation level in related species
 <cit>  and motif clustering
 <cit>  to increase the predictions’ signal to noise ratio
 <cit> . however, newer methods increasingly take advantage of recently available experimental data such as genome-wide occurrences of histone modifications and nucleosome occupancy
 <cit>  and our increased understanding of how these modifications affect the likelihood of tf binding
 <cit> . unlike previous methods that mainly rely on sequence motifs, adding experimental data typically makes the predictions specific to the given experimental context.

chromatin immunoprecipitation followed by massively parallel dna sequencing  is the current high-throughput experimental technique of choice for mapping the genome-wide state of chromatin, and this technique is also used for experimentally identifying tfbs
 <cit> . chip-seq captures tf binding as it happens in vivo, so using chip-seq data alone or as a basis in more integrative methods for modeling gene regulation will result in context-specific predictions
 <cit> . but how specific are these predictions to the given context?

the few studies that have investigated cell-type specificity of tfbs show that in general, binding differences increase with functional and evolutionary distance. a study investigating myod-binding in the highly related cell types myoblasts and myotubes found the majority of predicted binding sites to be common in both tissues
 <cit> . another study looking at e2f <dig> binding sites in seven primary mouse tissues and a mouse cell line found that between 65% and 85% of the cells’ binding events overlapped
 <cit> , whereas a study of serum response factor  binding across three distinct human cell lines found that less than half of the observed srf binding sites were shared across all three cell lines
 <cit> . studies comparing tfbs across homologous species have shown that tfbs in general are even less conserved between different species than between different cells within the same organism
 <cit> . thus, whether regulatory interactions determined for one cellular context can be used to predict functional outcomes in a different context seems to depend on both the tf itself and the context of the comparison. however, the studies also suggest that some tfbs appear to be active consistently across different cellular contexts, and it is not clear what separates such apparently context-independent tfbs from context-dependent sites and whether the genomic context for such sites differs for different tfs.

to address this question, we used chip-seq data from two encode cell lines
 <cit>  to examine cell-type specific binding sites for seven tfs with known dna sequence preferences and six transcriptional cofactors with no known sequence preferences. five of the six cofactors were polymerase  iii tfs
 <cit> , whereas the remaining factors were pol ii tfs. we first show that although both the number of sites and the site overlap differ substantially between tfs, stronger sites, as estimated by chip-seq peak height, are generally less cell-type specific than are weak sites. second, we find that strong sites generally occur more frequently in regulatory regions such as promoters and tfbs clusters and in conserved sequences, compared to weak sites. moreover, by analyzing cell-type specific chromatin data, we find that strong sites occur more frequently in open chromatin and at histone modifications associated with active promoters, compared to weak sites. strong sites are also generally more conserved than are weak sites. third, we show that differences in chromatin can be a reason for cell-type specific tfbs—both at strong and weak sites. we also show that some of the apparent cell-type specific tfbs can be due to differences in genotype that affect sequence motif regions. finally, by training a machine learning classifier to distinguish common, context-independent sites from cell-type specific sites, we show that site strength and clustering are the most important parameters for identifying context-independent tfbs. importantly, sites for sequence-specific tfs and sequence-independent cofactors and sites for pol iii and pol ii tfs shared these same characteristics. thus, our results suggest that context-independent sites are strong, clustered sites in conserved genomic regions.

RESULTS
the number of peaks varies between cell-types
recent genome-wide analyses of tf binding have shown that for a few individual tfs, binding sites can vary substantially between cell-types
 <cit> . but how cell-type specific is tf regulation as measured by chip-seq data of different commonly expressed transcription factors? to address this question, we used a robust peak detection method
 <cit>  on publicly available chip-seq data
 <cit>  for  <dig> tfs from two cancer cell lines, k <dig> and hela-s <dig>  . seven of the factors  are pol ii factors with specific dna binding preferences, one  is a basal pol ii factor, four  are general pol iii factors, and one  is a pol iii subunit that is enriched at pol iii transcription start sites and has strongly correlated peak heights between k <dig> and hela-s3
 <cit> . the resulting peaks revealed substantial differences in the number of putative binding sites for different tfs and cell types . the total number of peaks was similar in both cell types; in sum hela-s <dig> had 11% more predicted peaks than k <dig>  but the peaks were divided unevenly between different tfs in the two cell types. variable peak counts for different tfs could be expected as the tfs under study serve diverse regulatory roles, but the variability between cell types for the same tf was high.

nearly half of the k <dig> peaks  and more than a third of the hela-s <dig> peaks  were associated with promoter regions; specifically, the 2000bp upstream and 200bp downstream of refseq genes’ transcription start sites plus their first introns . we included the first intron in our promoter definition, as binding sites for several tfs are enriched within first introns
 <cit>  and such binding sites have been shown to have important regulatory roles for specific genes 
 <cit> ). despite the variability in the overall number of peaks per tf and cell type, the relative number of peaks mapping to promoter regions for the same tfs were similar between the two cell types .

only a third of peaks are found in both cell types
given the high variability in putative tfbs, we wondered to what extent these binding sites were cell-type specific. by comparing the genomic loci of peaks across cell types, we found that 33% of k <dig> and 30% of hela-s <dig> peaks overlapped with at least one peak of the same tf in the other cell type. taking into account that the relative overlap is limited by the cell type having the fewest peaks for the tf, we found that the potential overlap varied between 16%  and 93%  . although the potential overlap was slightly higher for tfs with large differences in peak counts between the cell lines, this apparent trend was not significant .

an extreme example of seemingly different binding between cell types is the cell-cycle associated factor e2f <dig>  which had  <dig> peaks in k <dig> but only  <dig>  in hela-s <dig>  a large fraction  of the relatively few e2f <dig> peaks in hela-s <dig> overlapped with k <dig> peaks. others using chip-chip have previously found e2f <dig> to have between  <dig> and  <dig> target genes with little cell-type specific binding
 <cit> . this could suggest that a majority of the e2f <dig> peaks in k <dig> are not functional binding sites, but we cannot exclude that our data are missing several true binding sites in hela-s <dig> 

peaks in regions associated with tissue-independent regulation have higher overlap than have other regions
because of the unexpected differences between the two cell lines for the e2f <dig> peaks, we wondered whether overlapping peaks were enriched in genomic regions known to have limited tissue-specific activity. a previous study has indicated that tfs primarily mediate cell-type specific regulation through enhancers located far from core promoter regions
 <cit> . in accordance with this, we found that peaks mapping to promoter regions had a significantly higher degree of overlap across cell types than had peaks that did not map to promoter regions . promoter regions were again defined as the region  <dig> bp upstream to  <dig> bp downstream of transcription start sites of refseq genes, together with the complete first intron of the genes. consistent with pol iii factors preferentially associating with regions near functional pol ii promoters
 <cit>  three of the four general pol iii tfs showed higher overlap in these mostly pol ii promoters than in the non-promoter regions. similarly, the subset of pol ii tfs also showed significantly higher overlap in the promoter regions than in other genomic regions .

housekeeping genes tend to maintain similar expression levels across cell types and are therefore also likely to have similar regulation within different cell types. indeed, the overlap was greater for peaks mapping to promoters of housekeeping genes
 <cit>  compared with promoters of other genes . housekeeping genes frequently have high cpg promoters, whereas tissue-specific genes tend to have low cpg promoters
 <cit> . accordingly, peaks in high cpg promoters had significantly higher overlap than had peaks in low cpg promoters . thus, as expected, peaks mapping to tissue-independent regulatory regions showed a higher degree of overlap between cell types than did peaks mapping to other genomic regions.

cell-type-specific peaks map to different genomic regions in the cell types
some of the “missing” overlap could perhaps be explained by alternative transcription factor binding sites, where a binding site active in only one cell type could have another nearby site active in the other cell type. to test this possibility, we counted the number of overlaps when allowing increasingly larger regions surrounding the original peak regions . we found no striking increase in the number of overlaps, however—even when looking at regions larger than  <dig> bp. consequently, most of the cell-type unique peaks are found at completely different loci in the two cell types.

differences in tf expression can partly explain differences in peak counts
the variability in peak numbers could suggest that some tfs have more binding activity in one cell type compared to the other. as one important determinant of binding activity could be tf availability, we looked at how the tf mrna expression levels, as measured by rna sequencing, correlated with the number of peaks. we found some, but insignificant, correlation between tf expression and peak numbers . using the differences in expression and peak count between the two cell types gave similar results , but removing the expression outliers c-fos and c-myc gave a large and significant correlation . this suggested that the difference in peak count could partly be related to difference in mrna expression levels of the tfs.

of course, the mrna level does not necessarily alone determine the tf’s actual protein-level
 <cit>  and binding activity could be influenced by other variables, such as for example post-translational modifications, chromatin differences, and co-factor availability.

high peaks are less cell-type specific and more associated with active gene regulation than are low peaks
the height of a chip-seq peak indicates the tf’s binding activity or strength at the site. moreover, peak height can give a measure of the likelihood for the tfbs to be active in a given cellular context, as spurious binding events occurring within a fraction of the cells will give low chip-seq peaks. we therefore wondered whether cell-type specific binding or binding within regions consistent with regulatory activity, such as promoters or open chromatin, varied with increasing peak height .

for  <dig> out of  <dig> tfs in k <dig>  there were significantly more overlaps among higher peaks compared with lower peaks . the trend was particularly clear for the very highest peaks, save for c-fos and brf2—the latter having only  <dig> peaks in k <dig>  this could mean that cell-type specific binding is generally weaker than the binding in common binding sites, but the observation likely also reflects that spurious binding  is more prevalent among low peaks.

high peaks were generally more associated with regulatory regions such as promoters  and cpg-rich regions . the tfs that showed little or no association were not expected to be associated with pol ii promoters; ctcf acts primarily in intergenic and intronic regions
 <cit> ), whereas bdp <dig>  brf <dig>  brf <dig>  rpc <dig>  and tfiiic- <dig> are pol iii factors. the pol iii factors bdp <dig> and tfiiic- <dig> and the pol iii subunit rpc <dig> did indeed show significant correlation between peak height and overlap with pol iii promoters . also, nearly all  brf <dig> peaks in k <dig> were associated with pol iii promoter regions, whereas too few brf <dig> peaks mapped to the pol iii promoters for a pattern to be evident. high peaks were also associated with increased chromatin accessibility as measured by sensitivity to dnase  and a higher enrichment in the histone mark for transcriptionally active promoters h3k4me <dig> , in accordance with previous findings
 <cit> .

even though others have demonstrated poor conservation of binding sites across species for some tfs
 <cit> , we noted that higher peaks generally resided in regions of higher sequence conservation for many tfs . the main exception was ctcf, which showed a significant negative correlation between peak height and sequence conservation.

high peaks were also generally more associated with sequence motifs . however, c-fos peak heights in k <dig> correlated negatively with pwm scores for the ap- <dig> motif, which c-fos recognizes as a dimer with co-factor jun. one possible explanation could be that competition with jun homodimers and jun-arf <dig> heterodimers for the ap- <dig> motif may have pushed c-fos to bind more in non-canonical motif regions
 <cit> . alternatively, as higher c-fos k <dig> peaks did not have significantly increasing overlap with hela-s <dig> peaks, but did have significantly increasing association with promoters, cpg-rich regions, open chromatin, and sequence conservation, c-fos or its antibody may have cross-reacted with a different tf in k <dig> 

using discriminative motif discovery on the 10% highest and 10% lowest c-fos peaks , we found that the highest c-fos peaks in k <dig> had motif sequences such as ccaat and cgcgg, which resemble binding profiles for nf-y and parts of ap- <dig>  but we did not find any ap- <dig> binding motif or variant thereof. when using sequences from another tf  as negative data and running motif discovery with high and low c-fos peaks separately as positive data, we again could not find the ap- <dig> motif in the high peaks , whereas the top motif discovered on the lowest peaks was the canonical ap- <dig> consensus motif . we therefore strongly suspect that the highest c-fos peaks in k <dig> are the result of some experimental artifact.

as an additional measure of regulatory activity, we looked at how peaks from all tfs clustered together, under the assumption that clustered peaks indicate a region of high regulatory activity
 <cit> . for all tfs save brf <dig>  higher peaks were significantly correlated with a higher number of tfs in the cluster. finally, as chip-sequencing has a bias for gc-rich fragments
 <cit> , we did a separate analysis on a gc-controlled subset of the data. this gc-balanced subset  had the same trends as the original full dataset . consequently, any gc-content bias in the chip-seq data could not explain the correlations between peak height and different regulatory data seen in figure
 <dig>  together, these results suggest that high peaks associated with strong and conserved binding sites tend to be cell-type independent or common for many cellular contexts, whereas low peaks associated with weak binding tend to show larger variation between cell types.

differences in chromatin state suggest cell-type specific regulation
high tf peaks both had a higher degree of overlap between cell types and were more associated with open chromatin and active transcription, compared to low peaks. however, it was still unclear to what extent cell-type specific differences in high and low peaks were related to differences in chromatin structure or to spurious binding events. we therefore compared chromatin data for k <dig> and hela-s <dig> in the regions that contained the 30% highest overlapping and non-overlapping peaks and repeated the comparisons for the 30% lowest peaks.

in general, chromatin was more accessible and had a higher signal for the active histone mark h3k4me <dig> in the cell type where the cell-type specific peak regions were found, compared to the same regions in the other cell type . differences in chromatin accessibility, as measured by dnase sensitivity, were significant on a kolmogorov-smirnov test for  <dig> of  <dig> tfs in k <dig> and for  <dig> tfs in hela-s <dig>  differences in h3k4me <dig> signal were significant for  <dig> tfs in k <dig> and  <dig> in hela-s <dig> 

for the lowest 30% of peaks we expected to see smaller differences between the chromatin state in peak and non-peak regions, as a smaller difference would be consistent with increased stochastic noise due to more spurious binding within the peak data. indeed, although the differences in dnase sensitivity and h3k4me <dig> signal were more consistent for the weak than for the strong peaks , the median difference in chromatin accessibility and h3k4me <dig> signal was greater for higher peaks . it is therefore likely that a larger fraction of the low than of the high cell-type specific peaks is a result of spurious binding events or stochastic noise in the data.

different genotypes can contribute to binding differences
another factor that could contribute to differences in binding between cell types is single nucleotide polymorphisms , as k <dig> and hela-s <dig> are established from two different individuals with different genotypes. we aligned available dna sequencing data for k <dig> and hela-s <dig> to the reference genome  and by using snps from the hapmap database and the aligned sequence reads, we calculated the most likely genotype for each cell type for the snps in peak regions .

in total, 12% of the peaks harboured at least one snp. relative to peak count, more overlapping peaks had snps  than k562-specific  or hela-s3-specific  peaks. but a relatively higher number of snps in cell-type specific peaks were homozygous with different alleles in the cell types .

we reasoned that the snps that were homozygous for one allele in one cell type and homozygous for another allele in the other cell type could affect tf binding if the snp resided in a high-scoring tf motif . indeed, the peaks that were cell-type specific and contained such snps had significantly higher motif scores in the cell type having the peak compared with the other cell type . among  <dig> k562-specific peaks that fitted the snp and motif criteria stated above,  <dig> had higher motif scores in k <dig> and  <dig> had higher scores in hela-s <dig>  among  <dig> hela-s3-specific peaks,  <dig> had higher motif scores in hela-s <dig> and  <dig> in k <dig> 

genotype-related differences were also evident in peaks common between the two cell types. specifically, for the snps that had different homozygous genotypes and were located in high-scoring motif regions, the difference in motif score between the genotypes correlated positively with the difference in peak height between the cell lines . this correlation was especially strong and significant for the 10% highest peaks, both for the peaks that had snps in high scoring motif regions  and for the peaks that had snps in any location within the peak region . thus, differences in genotypes do affect tf binding and can explain some of the binding site differences between cell lines.

peak height and clustering are the most important factors for cell-type specificity
our results so far indicated that the cell-type specificity we observed among chip-seq peaks was related to a number of different factors that included peak height and locus, sequence properties of the peak region, and the region’s cell-type specific chromatin context. but which factors are the most important indicators of cell-type specific tf binding and to what extent do combinations of factors determine cell-type specific binding?

to address these questions, we used a machine learning approach. specifically, we created support vector machine  classifiers
 <cit>  to separate cell-type specific peaks from peaks that are found in multiple cell types. the svm’s feature set for each peak included both cell-type specific information such as chromatin state, and cell-type independent information such as sequence conservation; see table
 <dig> for a full list of features. using peaks from k <dig> as a reference and comparing overlap and cell-type specific data with the corresponding regions in hela-s <dig>  we trained for each tf one svm classifier to predict the k <dig> peaks that overlapped with hela-s <dig> peaks. we then used 10-fold stratified cross-validation to estimate the svm classifiers’ predictive performance in terms of their receiver operating characteristic  curve and roc-score .

the svm predictors were given these data as input for training and were classifying peaks as overlapping or not .

to assess which svm features were most important for correct classification, we removed a single feature group at a time from the svm and measured how this affected the svm’s cross-validation performance . although the results were somewhat different for each combination of tf and feature, one result was clear: peak clustering and peak height were the only features that had a strong positive impact on the prediction for the majority of the tfs. peak clustering was particularly important for classifying e2f <dig> and e2f <dig> peaks, whereas information on peak height was important to most tfs. as for individual tfs, the two tfs with the fewest peaks in their datasets, bdp <dig> and brf <dig>  had larger score variation than the other tfs. as a result, the tfs appeared to benefit from removing some features. finally, removing information about the distance to the closest transcription start site  had an expected negative impact on taf <dig>  which is a core component of the pol ii basal transcription factor tfiid
 <cit> .

given the major importance of peak height and clustering for classifier performance, and in light of previous results , we reasoned that including these features made it difficult to assess any importance of other features. we also suspected that some of the features could contain redundant information, as removing single features had relatively little impact on performance. we therefore removed peak height and clustering from the dataset and grouped features into the following three groups: cell-type specific features , promoter and sequence-associated features , and conservation feature . the results  showed that cell-type specific and promoter-associated features were important for, respectively, most  and some  of the sequence-dependent tfs, whereas only promoter-associated features were important for some of the general tfs . sequence conservation, however, was not an important factor for identifying cell-type specific peaks in this dataset.

peak height and clustering were the dominant factors in explaining cell-type specificity and could therefore confound the effects of other features when analyzing the total set of all peaks. we therefore did a separate analysis of the highest and most clustered peaks, as differences between cell types for these peaks should be due to other factors than peak height and clustering. specifically, we first identified the subset of peaks that were among the 10% highest and that also occurred among the top 20% largest peak clusters; that is, in clusters containing peaks from six or more tfs. second, we did a feature removal analysis on the five tfs that had more than  <dig> remaining peaks in both the overlapping and the cell-type specific datasets. although none of the features on this reduced dataset showed the same consistent pattern as the height and cluster features did on the complete dataset, five of the eight features  had a positive impact on the prediction for the majority of the five tfs . moreover, only one feature  had a negative impact on the prediction for the majority of the tfs. these results confirmed that additional factors beside peak height and clustering, including cell-type specific data on histone modifications, are important for identifying cell-type specific tf binding.

models for identifying cell-type specific peaks are consistent between cell lines
the feature analysis suggested that even though peak height alone was a critical factor for identifying cell-type specific peaks, other features could also help predictions. to further assess the effect of adding additional features, we therefore developed two reference models, which we refer to as height and hpp. these models were also based on svms, but contained fewer features; height used only peak height as its single feature and hpp used peak height, phylop conservation score, and pwm score .

consistent with the feature analyses, the svm model that included all features , was significantly better than the two reference models . the hpp model was also significantly better than height . the height model only had a higher roc-score than the full svm model on the brf <dig> dataset. this is likely due to a low number of training examples for the more complicated svm method, as there were only  <dig> brf <dig> peaks in k <dig>  consistent with previous results , peak height alone was insufficient to predict overlapping c-fos peaks.

so far we had tested how the models performed when classifying new unseen peaks from the same cell types  used during training, but would the models generalize to a different cell type? to address this question, we used a stratified 10-fold cross-validation procedure where we first trained the models on a subset of k <dig> peaks that were common and cell-type specific compared with hela-s <dig> peaks. we then tested the models on a different subset of k <dig> peaks that were common and cell-type specific compared to peaks in the gm <dig> encode cell line; that is, we trained the models on k <dig> and hela-s <dig> data and tested the models on k <dig> and gm <dig> data. importantly, none of the peaks in these train and test sets overlapped and the cell-type specific features  were derived from two different cell types in the train  and test  sets. we trained and tested the models on the five tfs with chip-seq data available in all three cell types.

whereas the height and hpp models had similar performance in the new cell type , the full svm model had a significant drop in performance ; see figure
8b and additional file
10: figure s9b. this drop resulted in the full svm model having lower roc-scores than the height model had on three of the five tfs. the largest differences between the svm and height models were on the max and c-fos data, suggesting that the svm model was over-fitted on these particular tfs. indeed for c-fos, the different features in the svm were more inconsistent between the three cell types than for the other tfs .

these inconsistencies between the cell types also strongly affected the height and hpp models on the c-fos data. as already mentioned, height could not predict c-fos peaks that overlapped between k <dig> and hela-s <dig>  whereas the hpp model trained on k <dig> and hela-s <dig> data could not predict peaks that overlapped in k <dig> and gm <dig>  of the five tfs, c-fos had the least consistent binding sites between the three cell types . c-fos is less specific in recognizing the ap- <dig> site compared to dimer-partners jun and atf2
 <cit> , so some of the differences could be because c-fos used different co-factors in the three cells. this explanation is consistent with c-fos having three different trends in peak heights and pwm scores for the three cell lines. moreover, jun expression level was four times as high in hela-s <dig> as in k <dig>  and the strong c-fos peaks in hela-s <dig> had good ap- <dig> consensus motifs compared to weaker peaks . however, as previously mentioned, we cannot exclude that c-fos or its antibody had cross-reacted with a different tf in k <dig>  apart from c-fos, however, the models could consistently separate cell-type specific from cell-type independent tfbs.

discussion
there is limited knowledge on how regulation by transcription factors in general varies between different cellular conditions, and what causes specific transcription factor binding. most newer approaches for inferring gene regulatory networks rely on experimental data that partly limit the inferred networks to a specific cellular context. while this makes it possible to focus on the interactions that are active in the particular context under study, it also means that it can be difficult to completely map the general regulatory network by using these approaches
 <cit> . because chip-seq is increasingly used for inferring gene regulatory networks, and is also used to validate predictions of other methods
 <cit> , it is important to understand to what extent chip-seq data are limited to a specific cellular context. here we have investigated chip-seq data for a number of tfs and examined possible causes of observed differences in binding.

our initial analysis indicated that in general, the number and location of binding sites as given by chip-seq peak data varies substantially between hela-s <dig> and k562—even for the same tf. the average peak overlap of 30% we found is in accordance with previous findings on tf binding specificity among different cell-lines
 <cit> , and we note that similar levels of overlap have been found for regions of open chromatin between a number of different cell lines
 <cit> .

these binding differences can partly be explained by cell-type specific regulation. specifically, our results show that chromatin accessibility, histone modifications, and genetic variations in peak regions can explain some of the cell-type specific peaks. another factor that could establish alternative binding contexts is a difference in availability of tf co-factors across cell types
 <cit> . although we found significant differences in co-factor expression and pwm score distributions between the cell types , because of limited and noisy pwm and interaction data it is difficult to quantify the overall effect of co-factor differences. stochastic noise does appear, however, also to be a major factor in causing binding differences. specifically, we found that peak height and additional tf binding events  are the most important features for discriminating between overlapping and cell-type specific peaks. when focusing on the 10% highest and 20% most clustered peaks, the average overlap increased to 58% and 68% for the k <dig> and hela-s <dig> peaks and open chromatin and histone modifications were important for separating cell-type specific from common peaks. low peaks, in contrast, were less associated with features supporting regulatory activity , including condition-independent features such as pwm score and sequence conservation, indicating that a larger fraction of the low peaks than of the high peaks represents stochastic noise or spurious binding events.

both high and low affinity binding sites are, however, known to have biological importance in regulating gene expression
 <cit> . merely setting a high cut-off on peak height to reduce noise
 <cit>  will therefore risk losing many functional sites. conversely, using peak height to infer whether a candidate tfbs will have binding activity in other cellular contexts risks introducing false positive regulatory interactions. our svm classifier can partly solve both these problems, as the svm is a better alternative than peak height alone for identifying tfbs that are common between cell types, when sufficient training data are available. alternatively, combining peak height with evolutionary conservation and tf motif scores  gives good predictions when less data are available. being less complex than the svm model, the hpp model also is less prone to overfitting than the svm model, as seen when the models were tested on a third cell type. as all three methods for finding common tfbs sites are data-driven, however, all three methods can suffer from inconsistent data, such as the c-fos datasets. apart from c-fos and tfs with limited data, both the svm and hpp models outperformed the simple peak height-based model for finding consistent tfbs. these models can therefore also be used to remove noise and identify high-confidence tfbs in chip-seq data.

peak height and clustering are the most important features for the svm. consequently, if context-specific peaks are indeed much more noisy than context-indifferent peaks, the svm classifiers are perhaps to a greater degree learning to differentiate between real binding sites and noise, and to a lesser degree learning to differentiate between context-independent and context-dependent binding sites.

our results show that low peaks are less consistent than high peaks, but what are then potential causes for these inconstancies? weak, apparently random tf binding, non-specific antibody binding, and sequencing errors combined with peak calling artefacts
 <cit>  can contribute random noise, but one intriguing possible contribution is cell culture subpopulations that have slightly different cellular contexts. cell cultures, such as the three cultures used in the chip-seq experiments we based our analyses on, are generally a heterogenous mix of individual cells in slightly different biological states. for example, unsynchronized hela cells growing in culture consist of different subpopulations of cells that are in different cell cycle phases and have slightly different transcriptional states
 <cit> . population-wide measurements, such as chip-seq data, from such unsynchronized cell populations represent an average of these individual states. consequently, binding events that are biologically consistent but only occur within a small fraction of the cells, because these cells are in a transient transcriptional state, will give low or undetectable chip-seq peaks that can appear to be random events. supporting this explanation, the 30% lowest cell-type specific peaks in the chip-seq data showed more consistent differences in dnase sensitivity and h3k4me <dig> signal between the cell lines than the 30% highest peaks showed , even though the differences in dnase sensitivity and h3k4me <dig> signal were smaller for the low than for the high peaks . small but consistent differences in dnase sensitivity and h3k4me <dig> signal together with low tf peaks indicate that these tf binding events occur within small but consistent subpopulations of the cell cultures. more focused experiments in synchronized cell cultures may therefore be necessary to completely and correctly map context-dependent regulatory networks.

CONCLUSIONS
many methods for inferring gene regulatory networks are based on chip-seq-predicted transcription factor binding sites, but little is known about how specific these data are to the experimental context. here we find that on average a third of chip-seq predicted transcription factor binding sites overlap between the cell lines k <dig> and hela-s <dig>  this number is in accordance with previous findings on cell-type specificity and suggests that regulatory networks inferred uncritically from chip-seq data will, in general, generalize poorly to different cellular contexts. however, some subgroups of peaks are less context-specific than others. specifically, peaks in regions associated with tissue-independent regulation, such as cpg-rich promoter regions, and more generally, high and clustered peaks associated with strong and conserved binding sites, tend to be more cell-type independent.

even though some of the discrepancy between the two cell types can be caused by cell-type specific regulation of chromatin and co-factors, the results indicate that most of the discrepancy—especially among the low peaks—is due to stochastic noise in the chip-seq data. our results do, however, not exclude that different sub-populations contribute to the discrepancy. specifically, the small but consistent differences in dnase sensitivity and h3k3me <dig> signal we observed for the 30% lowest peaks are consistent with distinct sub-populations within the data. nevertheless, context-independent attributes, such as pwm score and sequence conservation, are more associated with stronger and more overlapping peaks than with weak and isolated peaks.

moreover, both sequence-specific tfs and sequence-independent cofactors shared the same characteristic of stronger peaks being more cell-type independent. indeed, even the sites for the pol iii subunit rpc <dig>  which is enriched at pol iii promoters and shows highly correlated peak heights between different cell lines
 <cit> , were more cell-type independent and more associated with pol iii promoters when the sites corresponded to strong compared to weak peaks. consequently, it is likely that stochastic binding events instead of consistent cell culture sub-populations explain most of the observed cell-type specific binding events for the low and isolated peaks. accordingly, methods that try to build context-independent gene regulatory networks from chip data could benefit from focusing on high and clustered peaks in conserved genomic regions. our svm method can help identify such peaks.

it might be a while before binding sites of most tfs are mapped in a majority of tissues and cell lines. until then, any available chip-seq data, however noisy and condition-specific, is likely to serve as our best source of information on the location and context of regulatory elements.

