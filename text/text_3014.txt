BACKGROUND
in the last two decades, various protein three-dimensional structure prediction methods have been developed and much progress has been made in this area  <cit> . generally, numerous predicted decoy models are generated for a given protein sequence, and correctly ranking these models and selecting the best predicted model from the candidate pool remain challenging tasks. over the past years, a number of methods have been developed to address this issue  <cit> , and these methods could roughly be divided into three categories: single methods, quasi-single methods and clustering  methods. the single methods evaluate the model quality using the inputted model only  and often use three conceptual approaches: the physical model, the statistical model and the comparison between predicted properties and the properties extracted from decoy models. the quasi-single methods identify a few high-quality models as references, and evaluate the subsequent models by comparing them with the reference models  <cit> . the clustering methods often use clustering algorithm to cluster a set of models generated by structure prediction programs for target sequence . the clustering methods generally outperform single-model methods when numerous models are available  <cit> , however, the clustering methods perform poorly if most models are of low qualities or only a few models are available.

in this work, we developed a novel program based on learning-to-rank for protein model quality assessment . first, the mqaprank formulates the protein model quality assessment task as a ranking task and uses single method to sort the decoy models, the features include knowledge-based mean force potentials and evaluation scores from other state-of-the-art mqap . then, the mqaprank takes the first five decoy models ranked by the learning-to-rank algorithm as the reference models and the predicted qualities of other models are the average gdt_ts score of the target models with the five reference models. the mqaprank has been evaluated on the casp <dig>  dataset and participated in the casp <dig>  recently, it achieves the state-of-the-art performances on those two datasets.

implementation
overview
the mqaprank formulates the model quality assessment of protein models as a ranking problem, and the protein decoy models are sorted by their similarities with the corresponding native structures. such similarities can be measured by various structure comparison programs and in the mqaprank the gdt_ts score is adopted. the assessment procedure of mqaprank consists of three steps and its overall flowchart is shown in fig.  <dig>  first, the mqaprank extracts two kinds of features from the decoy models: knowledge-based mean force potentials and the evaluation scores of several programs for protein model quality assessment. the knowledge-based potentials used in the mqaprank include boltzmann-based potentials, dfire potential, dope potential, goap potential and rwplus potential. the evaluation scores from other protein model quality assessment programs include frst, proq, rfmqa, sift and selectpro software, detailed descriptions of those features are shown in the features section. then, each decoy model is represented as a feature vector and a pair of feature vector from the same protein is represented as an instance. these instances are inputted into learning-to-rank algorithm to predict the relative ranking relation of any two models from the same protein. finally, the mqaprank takes the first five models as the reference models and the predicted qualities of other models are the average gdt_ts score of the target models with the reference models.fig.  <dig> the overall flowchart of the proposed mqaprank




in summary, the mqaprank uses various features to predict the ranking relation of protein decoy models based on learning-to-rank algorithm and chooses first five best decoy models as references to score other decoy models. in order to provide more valuable assessment information, the mqaprank will output both the initial learning-to-rank based score  and the final predicted score .

learning-to-rank algorithm
learning-to-rank is a machine learning algorithm which constructs a ranking strategy and sorts new objects according to their relevance or importance to the target object. learning-to-rank has been applied effectively to solve information retrieval problems, such as document retrieval, collaborative filtering, spam detection, etc. the existing learning-to-rank algorithms can be categorized into three approaches: pointwise approach, pairwise approach, and listwise approach, and different approaches model the process of learning-to-rank in different ways. the pairwise approach could apply existing methodologies on regression and classification and generally outperforms pointwise approach, thus we adopt the pairwise via-classification approach  to deal with the protein model quality assessment problem. specifically, the pairwise approach takes pairs of decoy models  as instances for learning, and formalizes the task of ranking decoy models as that of classification. in learning, it first collects decoy model pairs from the decoy model list of a certain protein, and then assigns a label representing the relative qualities of the two decoy models for each pair. the final process is to train a classification model with the labeled data and to make use of the model to rank new decoy models.

features
the mqaprank extracts two kinds of features from the decoy models: knowledge-based mean force potentials and the evaluation scores of several programs for protein model quality assessment.

knowledge-based potentials
the knowledge-based potentials include boltzmann-based potentials  <cit> , dfire potential  <cit> , dope potential  <cit> , goap potential  <cit>  and rwplus potential  <cit> .

the boltzmann-based potentials are widely used mean force potentials that is derived from the inverse boltzmann law, and the corresponding non-linear forms are proposed in our previous study  <cit> . the five boltzmann-based potentials include the dih potential  <cit> , the dfire-scm potential  <cit> , fs potential  <cit> , hrsc potential  <cit> , t32s <dig> potential  <cit> .

the dfire potential  <cit>  is a distance-dependent structure-derived potential, which sums the interactions of all pairs of non-hydrogen atoms .

the dope  potential  <cit>  is based on an improved physical reference state that corresponds to non-interacting atoms in a homogeneous sphere with the radius dependent on a sample native structure. its variants  and dope-hr ) are also used in the mqaprank.

the goap potential  <cit>  is a generalized orientation and distance-dependent all-atom statistical potential, which depends on the relative orientation of the planes associated with each heavy atom in interacting pairs.

the rwplus potential  <cit>  is based on the pair-wise distance-dependent atomic statistical potential function rw  <cit> , and contains a side-chain orientation-dependent energy term.

evaluation scores from other mqaps
the evaluation scores from other model quality assessment programs are also extracted as additional features, which include the frst  <cit> , proq  <cit> , rfmqa  <cit> , sift  <cit>  and selectpro  <cit> .

the output of the frst  <cit>  is based on four knowledge-based potentials: rapdf potential, solv potential, hydb potential, and tors potential, and the frst energy is a weighted linear combination of the four potentials. besides the combination potential, the individual potentials are also used as the features in the mqaprank.

the proq  <cit>  is a neural-network-based method to predict the protein model quality. it uses structural information which contains the frequency of atom contacts and residue contacts, solvent accessibility surfaces, the fraction of similarity between predicted secondary structure and the secondary structure in the model, and the difference between the all-atom model and the aligned c-alpha coordinates from the template.

the rfmqa  <cit>  is a random forest based model quality assessment using structural features and knowledge-based potential energy terms. here we used an analogous strategy as rfmqa to extract four protein secondary structure features and two solvent accessibility features. for protein secondary structure features, the focus is the consistency between predicted and actual secondary structures of a target protein. for each decoy model, we use dssp  <cit>  to calculate its secondary structures and psipred  <cit>  to predict the secondary structures of the target sequence. the fraction of consistent secondary structural element  between the dssp label and the psipred output is calculated by dividing the consistency number by its total chain length, and the total consistency rfmqa-ss-total score is also used as a feature. for solvent accessibility features, the absolute solvent accessibility of the model is computed by dssp and relative solvent accessibility is computed by accpro <dig>  <cit> . these two vectors are compared and transformed into a pearson correlation coefficient and a cosine value as two features.

the sift  <cit>  is a program which uses averaged  radial distribution functions  to discriminate properly packed models from misfolded ones. it produces two alternative scores: one based on rdf only and the other based on a combination of rdf and other sequence-independent filters.

the selectpro  <cit>  is a structure-based model assessment method derived from an energy function comprising physical, statistical, and predicted structural terms that include predicted secondary structure, predicted solvent accessibility, predicted contact map, β-strand pairing and side-chain hydrogen bonding.

usage
web server
we offer a web server to non-commercial users at http://dase.ecnu.edu.cn/qwdong/mqaprankwebserver/server. non-commercial users could upload decoy models of protein targets to the server and get predicted gdt_ts values of corresponding models by the learning-to-rank  and the predicted gdt_ts value by the quasi-clustering method  from the result page.

stand-alone program
the standalone program of mqaprank is implemented in python  <dig> . <dig>  the source code, installation tutorial and test example are freely available to non-commercial users at http://dase.ecnu.edu.cn/qwdong/mqaprankwebserver/software. to reduce the complexity of the usage, the mqaprank uses one call script to execute the task. the input of mqaprank is a text file which contains the full path of protein models to be evaluated. users could chose the structure similarity metric  to be used by mqaprank. the output is a text file that contains three items in every line: full path of the model, the predicted value of the corresponding model by the learning-to-rank  and the predicted value of the corresponding model by the quasi-clustering method .

RESULTS
performance comparison on casp <dig> dataset
the mqaprank has participated in the casp <dig> under the group name fdubio. its performances and corresponding performances of four selected methods in casp <dig> are shown in table  <dig>  all of the performances on the casp <dig> dataset are obtained from the casp <dig> official website , three of the four selected methods are leading methods with best performances in their corresponding categories based on the diff metric. specifically, the mufoldqa_c is the leading method in clustering category, the modfold6_cor and mufoldqa_s are the leading methods in quasi-single category and single category respectively. the davis-consensus is the reference clustering method for assessing progress in protein model quality assessment field. on the casp <dig> dataset, compared with three leading methods and the reference method davis-consensus, the mqaprank outperforms other leading methods on all metrics on the best  <dig> dataset and achieves comparable performances on the select  <dig> dataset. fig.  <dig> shows scatter plots of the diff metric comparison between the mqaprank and other four methods. it should be noted that smaller diff value indicates better performance, so the method with less scatter points is better. as shown in the figure, most of decoy model qualities are better predicted by the mqaprank.table  <dig> the performances of the mqaprank and several leading methods on casp <dig> dataset based on gdt_ts score


mqaprank
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 

abest 150: the dataset comprised of the best  <dig> models submitted on a target according to the benchmark consensus method. bselect 20: the dataset comprised of  <dig> models spanning the whole range of server model difficulty on each target. cdiff: the average difference between the predicted and gdt_ts scores. dmcc: matthews correlation coefficient . eauc: the area under the roc curve. floss: the loss in quality between the best available model and the predicted best model. bold value indicates highest performance


fig.  <dig> comparison of the performance on diff metric between the mqaprank and other methods. a mufoldqa_c. b davis-consensus. c modfold6_cor. d mufoldqa_s. 




three factors contribute to the success of the mqaprank. the first one is the learning-to-rank framework which can give reasonable ranking of protein decoy models for a protein target. the mqaprank formulates the protein model quality assessment problem as a ranking problem and sorts protein decoy models by their similarities with the corresponding native structures. the second one is the features which are the complementary outputs of various methods. these features reflect qualities of protein decoy models from different aspects, so the ranking could be more reasonable and comprehensive. the third one is the quasi-clustering  strategy. the mqaprank selects reference models based single method, which could avoid the typical shortcoming of clustering method and reduce the dependency of the distribution of decoy model qualities. in order to specifically demonstrate the success of mqaprank, we select the protein target t <dig> from casp <dig> best  <dig> dataset as an example. the t <dig> protein target is a long sequence protein with  <dig> residues and contains three domains, its tertiary structure is relatively hard to predict. the top  <dig> decoy models based on gdt_ts score are shown in table  <dig>  and the top five scored by gdt_ts and five methods are highlighted in bold. from the table  <dig>  we can see that four out of the first five decoy models ranked by the mqaprank are consistent with those ranked by the gdt_ts score. the other decoy models predicted by the mqaprank have quite similar scores with those scored by gdt_ts score. the mqaprank successfully identifies high-quality decoy models from decoy model pool by using the learning-to-rank framework and complementary features, and then it takes the first five decoy models as references to reasonably score other models.table  <dig> the gdt_ts scores and predicted scores from different methods for the first  <dig> decoy models of target t <dig> on best  <dig> dataset

 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
bold value indicates the first five decoy models withhighest gdt_ts score




performance comparison on casp <dig> dataset
we have performed a benchmark evaluation on the casp <dig> dataset to verify the ability of mqaprank  <cit> . referencing to the strategy of casp  <cit> , we use casp <dig> dataset as the training set and make tests on the casp <dig> dataset . we select four leading groups  from different categories and the casp official reference method  as references. among these methods, the pcons-net, multicom-refine and davis-qaconsensus are clustering methods, the multicom-cluster is a single method and the mqapsinglea is a quasi-single method. we downloaded the performances of these four methods from the casp <dig> official website  and evaluated them by using metrics used in casp <dig> and two more pearson’s correlation coefficients between the predicted and gdt_ts scores. the evaluation results are shown in table  <dig>  as shown in the table, the mqaprank achieves the state-of-the-art performances on the casp <dig> dataset. these results are similar with those on the casp <dig> dataset, which demonstrates the robustness of the mqaprank.table  <dig> the performances of the mqaprank and several leading methods on casp <dig> dataset based on gdt_ts score


mqaprank
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 

ampcc: mean pearson’s correlation coefficient between the predicted and gdt_ts scores of per target protein


bpcc: pearson’s correlation coefficient between the predicted and gdt_ts scores on overall models. bold value indicates highest performance on corresponding evaluation metric




performance comparison on 3drobot dataset
we also evaluated the mqaprank on a large dataset, 3drobot dataset. the decoy models of 3drobot are generated by the 3drobot  <cit> , a program devoted for automated generation of diverse and well-packed protein structure decoys. the 3drobot dataset contains structural decoy models of  <dig> non-homologous proteins comprising by  <dig> α,  <dig> β, and  <dig> α/β single-domain proteins and the length of these proteins ranges from  <dig> residues to  <dig> residues. each protein has  <dig> structural decoys with rmsd ranging from 0 Å to 12 Å, so there are  <dig> decoy models in the 3drobot dataset. we performed a benchmark evaluation of the mqaprank on this dataset by using the five-fold cross-validation. we select one part  as the test dataset and the remaining four parts  as the train dataset each time. this process repeats five times and the prediction results of five test parts are integrated together finally.

in the meantime, we assessed decoy model qualities of the 3drobot dataset by using three stand-alone programs  as references. the evaluation results are shown in table  <dig>  table  <dig> shows that the mqaprank outperforms other three methods, especially on the diff metric. compared with casp datasets, the 3drobot dataset contains much more decoy models for each protein target, and the distributions of decoy model qualities in it are more uniform. due to these factors, the clustering methods , which are based on majority voting strategy, could not achieve ideal performances. while the mqaprank still performs well by using learning-to-rank and quasi-clustering strategy.table  <dig> the performances of the mqaprank on 3drobot dataset based on gdt_ts score


mqaprank
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
bold value indicates highest performance on correspondingevaluation metric




CONCLUSIONS
assessing the qualities of protein decoy models in perspective is one of the key stages of protein structure prediction, but it is still an open problem. here we propose the mqaprank, which is a global protein model quality assessment program based on learning-to-rank, for protein structure prediction and protein model quality assessment usages. the evaluation results on the casp <dig>  casp <dig> and 3drobot datasets show that the mqaprank could provide the state-of-the-art performance and is available for protein structure evaluation.

abbreviations
mqapmodel quality assessment program

best 150the dataset comprised of the best  <dig> models submitted on a target according to the benchmark consensus method

select 20the dataset comprised of  <dig> models spanning the whole range of server model difficulty on each target

diffthe average difference between the predicted and gdt_ts scores

mccmatthews correlation coefficient 

aucthe area under the roc curve

lossthe loss in quality between the best available model and the predicted best model

casp1111th community wide experiment on the critical assessment of techniques for protein structure prediction

casp1212th community wide experiment on the critical assessment of techniques for protein structure prediction

