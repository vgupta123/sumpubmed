BACKGROUND
the use of global gene expression profiling is a well established approach to characterize biological states or responses. one of the major goals of these investigations is to identify sets of genes with similar expression patterns that may shed new light on the underlying biological process leading to the observed states. a logical and systematic next step is to reduce the identified gene signatures to the regulatory components that induce the relevant gene expression states, with the over all goal to identify the gene regulatory network in operation. a central issue in this context is to identify transcription factors, or transcription factor binding sites, likely to be of importance for the expression of the gene signatures. a constructive approach in this direction has been to combine information on specific transcription factor binding sites  with information on gene co-expression as determined by global gene expression analysis. the first step in this effort is to identify putative tfbss in a set of gene promoters. this is normally accomplished by searching the dna sequence for matches to generalized sequence patterns obtained from experimentally characterized binding sites. these sequence patterns are represented in the form of position weight matrices  that describe the probability distribution of the four possible nucleotides at each location in the motif sequence. several softwares such as match  <cit> , matinspector  <cit> , and tess  <cit>  use pwms obtained from jaspar  <cit>  or transfac  <cit>  - large and frequently updated databases that contain pwms - to identify possible binding sites. an inherent problem with tfbs searches is that the binding motifs are short and degenerate which lead to high error rates in genome-wide scans. one approach to reduce the error rate is to limit the search to evolutionarily conserved segments or to evolutionarily conserved binding sites only. in addition, when working with sets of coordinated genes the search may be restricted to tfbs shared by all members in the gene set, or show over-representation. hence, a productive method has been to select genes that are significantly changed or show coordinated expression, and then identify over-represented tfbss in the promoters of the selected genes. for example, in the toucan software  <cit>  markov background models are used to identify significant binding sites analytically and a parametric statistical algorithm to estimate enrichment, whereas in the confac software  <cit>  evolutionarily conserved binding sites are considered significant and tfbs enrichment is evaluated by a non-parametric statistical test using a fixed set of reference random gene lists. an alternative approach to include gene expression analyses in the protocol is to produce gene sets based on shared tfbs and investigate the extent to which genes in the sets show co-expression in published gene expression data  <cit> . an extension of this approach is to score all genes for high quality tfbs and then investigate to what extent tfbs co-occur with the aim to identify genes that show a high probability to be regulated by the same sets of transcription factors. in these latter approaches efficient means to produce lists of possible target genes is necessary. in the present investigation we develop a strategy that efficiently produces tfbs/promoter databases. the resulting tfbs/promoter databases constitute all genes in the santa cruz database and the positions for all tfbs provided by the user as pwms. these databases are then used for two purposes, to identify significant tfbs in the promoters of gene sets and to identify clusters of co-occurring tfbs on a genome-wide scale. in the first application significant tfbs are identified by a re-sampling procedure in which the query gene set is compared with typically  <dig> independent gene lists of similar size randomly drawn from the tfbs/promoter database. for these purposes two criteria for significance are used; significant enrichment and significant presence. we apply this strategy to both published chip-chip data and to curated gene signatures obtained from the msigdb database. in the second application, we show that several groups of tfbs are highly correlated and that correlated tfbs define functionally related sets of genes.

RESULTS
creating tfbs/promoter databases
to generate tfbs/promoter databases we developed the smart  software. the smart software contains an application to download refseqs, mrna information, and promoter regions from the ucsc genome browser database to a local mysql database, and hence reduce the need for frequent interactions with the ucsc genome browser database. the smart software then retrieves each promoter sequence from the local database followed by scanning for transcription factor binding sites. in this study we used pwms from the transfac v <dig>  database  <cit> . for the first tfbs/promoter database, core similarity score  threshold values of  <dig>  and matrix similarity score  threshold values of  <dig> , were used to identify putative tfbs  <cit> . all hits of tfbs for the same transcription factor, e.g., myc_ <dig>  myc_ <dig>  and myc_ <dig>  in a given promoter region were then summed up. a first tfbs/promoter database was produced using promoter sequences consisting of the -  <dig> to + <dig> genomic interval relative putative tsss, using the start of the refseq or the mrna with the most distal tss for each gene. then a second tfbs/promoter database aimed for phylogenic foot printing analyses was created by using the corresponding orthologous genes listed in the ncbi homologene database based on human and mouse. for each orthologous gene pair the evolutionarily conserved sequences within the -  <dig> to + <dig> bp relative the tss were identified using the blast program and the criterion e <  <dig> , and tfbs identified as above. in the present investigation the - <dig> to + <dig> bp tfbs/promoter database is composed of  <dig>  <dig> genes and the -  <dig> to + <dig> bp database of  <dig>  <dig> genes.

estimations of significance using tfbs/promoter databases as references
we use two measures of significance to identify tfbs likely to be involved in the regulation of the query gene sets; significant enrichment ; an estimation of tfbs over-abundance in a query gene list, and significant presence ; an estimation of tfbs promoter over-presence in a query gene list. tfbs enrichment analysis is based on the observation that genes regulated by a given transcription factor tend to have several tfbs for the factor in their respective promoter regions. to calculate e the total number of instances of a given tfbs in the promoters of genes in a query gene list is recorded. then the tfbs/promoter database is re-sampled with replacement to produce randomly selected and independent gene lists with the same number of genes as in the query list. the number of tfbs instances in each re-sampled gene list is recorded and then ranked according to the number of tfbs present  together with the results for the query list. the rank of the query gene list divided by the total number of re-sample instances is then used as a p value for the probability to acquire the level of enrichment by chance . the pe value is then transformed into a score by using the -log value. assuming that all genes in a given query list are regulated by a given transcription factor tfa, one would expect that each gene promoter contains at least one binding site for tfa. the chance to find one instance of a given tfbs in a promoter is however dependent on the frequency of the corresponding sequence motif in promoters. we therefore introduce the "significant presence" measure which is an estimate of the probability  to find the observed number of promoters with at least one instance of the tfbs in a randomly selected gene list of the same length as the query list. the pp is estimated by a resampling procedure similar to the estimation of pe, and is converted to a score by using -log. the fraction of genes  in the query list that contain at least one instance of a given tfbs is also recorded.

gene set promoter analysis
to validate the promoter analysis strategy it was first applied to published chip-chip data and then curated gene sets from msigdb. the rationale of using chip-chip data is that such data is expected to identify gene promoters that a given transcription factors interact with physically. the results are either evaluated by a table containing values for pe, pp, and %-presence, respectively, or by score graphs produced by plotting the -log, -log, and %-presence, in any combination. an example of a -log/-log graph is given in figure 1a in which the promoters of genes reported by boyer et al. to bind e2f <dig> by chip-chip analysis  have been analyzed using the - <dig> to + <dig> bp surrounding the tss's and a total of  <dig> re-samples. the analysis identified the tfbs e2f, e2f <dig>  e2f1dp <dig>  e2f4dp <dig>  e2f, e2f1dp1rb and e2f1dp <dig>  among others, as both significantly enriched and significantly present with e and p scores of  <dig> in each case . in figure 1b a three dimensional representation of the data is shown based on the -log and -log scores, and %-presence. this latter graph identifies e2f, e2f <dig>  cbf, etf, whn, vmyb, elk <dig>  and cets1p <dig> as highly significant binding sites.

apart from data on e2f <dig> binding sites boyer et al. also reported chip-chip data on nanog, oct <dig>  and sox <dig> binding sites. as no definite pwm exists for sox <dig> in the transfac database no analyses of this binding site were performed. the analyses of the genes reported to bind nanog or oct <dig> using - <dig> to + <dig> portions of the promoters did not indicate any binding sites for the nanog and oct related transcription factors as significant. we then applied a phylogenic foot printing approach using the - <dig> + <dig> portions of the promoters . in this case, nanog and oct related binding sites were among the top ranking binding sites with respect to e- and p-scores in the boyer_nanog and the boyer_oct <dig> data sets respectively. nanog showed e- and p-scores of  <dig>  and  <dig>  respectively, and the oct related binding sites oct <dig>  oct <dig>  and oct all showed maximum e- and p-scores of  <dig> when using  <dig> re-samples. hence in this case positive data was only obtained when limiting the analysis to evolutionarily conserved segments of the promoters. the analysis of the boyer_nanog_oct4_sox <dig> data set, that contains genes that bind all three transcription factors, produced top ranking e- and p-scores for the oct related bindings site whereas the nanog site showed moderate significance when using the phylogenetic foot printing approach. on the other hand, the oct binding sites showed top scores in the boyer_nanog data set  and conversely, nanog showed top scores in the boyer_oct <dig> data set , indicating, as expected, a significant overlap in the binding sites for these two transcription factors. in addition to the boyer_e2f <dig> data we also analyzed the xu_e2f chip-chip data using a  <dig> resampling procedure in which e2f <dig>  e2f1dp <dig>  e2f4dp <dig>  e2f1dp1eb tfbs all obtained maximum e- and p-scores, i.e. equal to  <dig>  the smeenk_tp <dig> chip-chip data did not give as clear cut results as the previous chip-chip data. the promoter analysis of tp <dig> binding genes resulted in the top ranking e-score  but not the top ranking p-score for tp <dig>  even though the tp <dig> binding motif was present in 71% of the promoters .

we analyzed the zeller_myc chip-chip data in three different ways. first all genes reported to bind myc, then the genes that bind myc but lack the ebox, and then the genes that bind myc and contain an ebox were included in the analysis. in the first analysis the mycmax binding site was the most significant both with respect to e- and p-scores . the same analysis of myc binding genes lacking ebox showed no significant enrichment of myc related binding sites , whereas the analysis of ebox containing genes showed significant e- and p-scores for all myc related binding sites . in fact all six, nmyc, mycmax, max, myc, max, and cmyc, as well ebox, showed maximum e- and p-scores of  <dig>  in a subsequent analysis using a  <dig> re-sample approach nmyc, mycmax, max, and cmyc, as well as ebox binding sites obtained maximum e- and p-scores of  <dig>  underscoring the enrichment of these sites in the promoters of myc binding genes with eboxes . as this analysis was limited to the - <dig> to + <dig> regions of the promoters one may tentatively conclude that ebox containing genes preferentially show myc binding sites in the close vicinity of the tsss whereas genes lacking eboxes may bind the myc transcription factors outside the - <dig> + <dig> regions, or use an as yet not identified binding motif.

we then analyzed the odom_hnf6_hepa and odom_hnf6_panc chip-chip data, figure 2a and 2b. in both sets of genes hnf <dig> binding sites showed top-ranking e- and p-scores and were detected in 45% of the promoters in the hepa and panc gene sets respectively . interestingly, the binding sites cdpcr3hd and cdpcr <dig> both showed maximum e- and p-scores in both data sets. these sites were present in  <dig> and 21% in the hnf6-hepa and hnf6-panc promoters, respectively, indicating these as possible co-factors in a sub set of the genes. the data also indicated the possible role for hoxa <dig> in the regulation of this set of genes. hoxa <dig> was present in 84% of the promoters from both cell types and was among the top ranking binding sites with respect to e- and p-scores in both the hepa and the panc sets of hnf <dig> binding genes.

to further explore the strategy we analyzed gene signatures obtained from the msigdb database associated with induced expression of various transcription factors or processes  known to involve specific transcription factors. we downloaded four gene sets related to myc gene expression, fernandez_myc_targets, myc_oncogene_signature, myc_targets, and lee_myc_up. the genes in the respective gene sets were analyzed in the - <dig> + <dig> portions of the promoters using a  <dig> resampling procedure . all myc related binding sites, mycmax, myc, nmyc, cmyc, max, and ebox, showed maximum e- and p-scores  in the fernandez_myc_targets and all but mycmax in the myc_oncogene_signature gene set. all but cmyc showed maximal e scores in the myc_targets gene set whereas the p scores were moderate but still among the top ranking. none of the myc related binding sites showed high scores in the lee_myc_up gene set, in fact all of them showed e- and p-scores below  <dig>  a possible explanation for the negative results obtained for the lee_myc_up signature could be that this signature is dominated by late/secondary myc targets not directly regulated by the myc protein. an indication that this may be the case was the finding that only 27% of the promoters in the lee_myc_up gene set contained ebox motifs whereas these were seen in 70% of the promoters in the fernandez_myc_targets gene set. essentially the same results were obtained when repeating the analysis using the phylogenic foot printing approach, including the negative results for the lee_myc_up gene set . we performed similar analyses of four hypoxia related gene signatures . the hif <dig> binding site was the single site that showed maximum e/p scores in the mense_hypoxia_up gene set. the hif <dig> site showed the top ranking e-score and was among the top ranking with respect to the p-score in the hif1_targets gene set, showed moderate e- and p-scores  in the hypoxia_normal_up gene set, and showed low scores  in the manalo_hypoxia_up gene set. hence, the analysis indicated hif <dig> as the most important binding site in two of the gene sets. repeating the analysis using the phylogenic foot printing approach further emphasized the importance of hif <dig> sites, particularly in the hypoxia_normal_up gene set, but did not improve the results for the manalo_hypoxia_up set of genes . as for the lee_myc_up signature, the poor results for the manalo_hypoxia_up gene set could possibly be explained by the presence of a hypoxia late response signature. we also noticed that whereas the hif <dig> site was one of the top ranking tfbs in all the myc signatures investigated that also showed myc targets as top-ranking, myc tfbss were not top-ranking in the hypoxia related signatures. the hinata_nfkb_up gene set showed top ranking e- and p-scores for the nfkb, nfkappb, and nfkappb <dig> binding sites using the - <dig> + <dig> regions . the nfkappb <dig> motif was however not significant. the importance of the nfkb related tfbs for this set of genes was further emphasized using the phylogenic foot printing approach . poor results were however obtained for the hanson_nfkappb_ind gene set using both approaches . the analysis of the kannan_tp53_up gene signature indicated p <dig> as the most significantly enriched binding site with an e-score close to  <dig>  even though the p-score was non-convincing , the tp <dig> site was present in close to 80% of the promoters. this type of results i.e., moderate e-scores and low p-scores but high %-presence, was also obtained for the smeenk_tp <dig> chip-chip data and indicates that tp <dig> binding sites are frequently seen in promoters albeit at low numbers for each promoter. additional msigdb signatures that performed well were e2f3_oncogenetic_signature generating e- and p-scores of  <dig> for e2f <dig>  e2f, and e2f1dp1rb site, respectively; halmos_cebp indicating cebp and cebpgamma as the two top two binding sites with respect to e- and p-scores when applying phylogenic foot printing, and the bild_myc signature, that included ebox, myc, max, cmyc, and mycmax among the top ten ranking together with usf, usf <dig>  hif <dig>  arnt, and clockbmal, and bild_e2f <dig>  that included e2f <dig>  e2f, e2f1dp <dig>  and e2f1dp1rb among the  <dig> binding sites with e- and p-scores equal to  <dig> 

identification of sets of co-occurring tfbs and defining tfbs based gene signatures
it is well established that most transcription factors do not act in solitude but in a cooperative fashion with other factors. hence, co-regulated genes are expected to share more than one tfbs in their promoters, as was, e.g., seen in the above analyses of the msigdb gene sets. to gain new knowledge on such possible combinations we used the - <dig> to + <dig> tfbs/promoter database to produce a correlation matrix among the tfbs's using the number of instances for each tfbs in each promoter as variables. this matrix was subsequently re-ordered using hierarchical clustering analysis . the obtained re-ordered correlation matrix did indeed show distinct features. apart from tfbs's showing strong and significant correlations, a portion of the tfbs showed no or very low correlations. in figure  <dig> the analysis has been limited to subset of tfbs that showed the most varying correlations . based on the hierarchical clustering several tentative groups of co-occurring tfbs could be defined . interestingly, strong negative correlations were also detected in the data, particularly between the tef1_bach <dig>  dbp_gata, and freac_hfh clusters and the gc_whn and mazr_ik tfbs clusters suggesting a selection against the co-occurrence of these groups of tfbs in gene promoters. no negative correlations were however detected when the analysis was repeated using the evolutionarily conserved portions of the - <dig> + <dig> promoter regions .

we then produced gene signatures based on groups of correlated tfbs as defined by the hca. to evaluate the coherence of the top ranking genes in the respective gene lists the top  <dig> genes were analyzed for go category enrichment. of the  <dig> tfbs clusters listed in figure  <dig>  twelve showed significant enrichment  of gene ontology terms . hence, most of the tfbs based gene signatures were significant for specific biological processes, including as diverse processes as regulation of transcription, intracellular signaling cascade, and immune response. the above analysis was repeated with the tfbs/promoter database based on phylogenic foot printing and the - <dig> + <dig> portions of the promoters. again several clusters of co-occurring tfbs was identified and the most varying tfbs were selected for further analysis . the subsequent hca identified  <dig> tfbs clusters  of which  <dig> showed significant enrichment of specific go categories . these included top ranking go categories as diverse as regulation of transcription, cell adhesion, and neurogenesis.

there are arguments for using relatively short intervals as the definition of a promoter as well as for longer intervals but then limit the analysis to evolutionarily conserved regions. both approaches have advantages and limitations. the above analyses of chip-chip and msigdb gene signatures, as well as that of co-occurring tfbs, show that similar but not always identical results may be obtained using either approach. to capitalize on the benefits of both approaches we produced a third tfbs/promoter database that takes into consideration the - <dig> + <dig> portions of the promoters as well as the - <dig> to - <dig> and the + <dig> to + <dig> evolutionarily conserved portions. this produced a tfbs/promoter database consisting of  <dig>  <dig> genes. we used this database to identify co-occurring tfbs using the qt-clust algorithm, a more stringent method than manual inspection of hca dendrograms. this algorithm produced  <dig> groups of at least two co-occurring tfbs . many of these were identical, overlapped, or were parts of clusters also identified by the less stringent hca approach. as above, ranked gene list based on the normalized number of tfbs hits in each gene promoter were produced and the top  <dig> genes in each tfbs gene signature were subjected to analysis using the ingenuity software. in table  <dig> results obtained for the ingenuity categories "molecular and cellular functions", "physiological system development and function" and "top canonical pathways" are listed for  <dig> of the most biologically coherent tfbs clusters. intriguingly, of the  <dig> tfbs clusters in table  <dig>  three were involved in "nervous system development" or "function and axonal guidance signaling" and five in immune response, which may indicate that these processes are orchestrated by a several combinations of transcription factors. taken together, both the hca and the qt-clust formed clusters of co-occurring tfbs that defined gene signatures with distinct biological properties.

a only the top categories with respect to p-value are given

discussion
the backbone of the present investigation is the construction of the tfbs/promoter databases that we used for two purposes; as a background files when analyzing promoters for significant tfbs and as possible sources for investigating relationships among tfbs. as the definition of a promoter may vary from type of investigation and scientific questions asked, an advantage of the presented tool is that variant tfbs/promoter databases may be produced readily. in the present investigation we used three types of databases each based on different promoter definitions; regions derived from short segments upstream of the tss, conserved regions derived from large upstream segments, and a combination of these two. we used two measures for significance, significantly enriched  and significantly present  tfbs, and rank statistics based on a resampling procedure to estimate the corresponding p-values. the e and p measures capture two aspects of tfbs significance, the recognition that genes regulated by a specific transcription factor tend to have several recognition sites for that particular factor and that genes regulated by a specific transcription factor are expected to have at least one binding site each for that factor. the advantage of estimating p-values by a re-sampling method is that no assumptions regarding the underlying distribution of tfbs or of promoter dna sequences has to be made. even though we used a simple rule to score promoters , i.e., the number of high scoring motifs per promoter, biologically relevant and intriguing results were obtained. furthermore, as we use gene sets as the unit for investigation, and not individual promoters, the inclusion of false positive sites for individual genes identified with pwms will have limited effect on the final results. we showed that the presented strategy could faithfully reproduce several chip-chip results, and hence validate the strategy. nonetheless, there were some chip-chip data that the strategy could not reproduce, e.g., palomero et al.  <cit>   and reed et al.  <cit>  . there might be more than one explanation for these discrepancies, e.g., chip-chip data most likely contain false positives to a varying degree and the pwm database employed, transfac, may not be complete. an indication that the latter may be the case is the fact that several chip-chip and chip/pet investigations have led to the discovery of new consensus binding sites e.g., both smeenk et al.  <cit>  and wei et al.  <cit>  present new tp <dig> motifs based on whole genome chip analyses. it is thus likely that future chip-chip and chip/pet analyses will describe additional motifs for other transcription factors as well. discrepant results for msigdb derived gene signatures may be caused by several factors. apart from the fact that not all possible pwms may be present in the transfac database, an additional complication is that the response to a given perturbation may vary with the experimental procedures used, e.g., the gene signature response may vary with time and thus include secondary targets to varying degrees. an additional factor that may reduce the e- and p-scores is that most signatures in msigdb have been obtained by micro array experiments in which not all possible genes were included in the analysis. consequently, estimations by rank statistics using the whole genome as a reference, as was performed, may underestimate and skew the actual e- and p-scores. moreover, in some instances it may be beneficial to use a reference matched to some characteristics of the gene signature, e.g., gc-content  <cit> . nonetheless, several of the gene signatures from the msigdb produced consistent results, again showing the strength of the proposed strategy.

apart from using the tfbs/promoter databases as references when performing promoter analyses the databases were also used as a source for investigating tfbs co-occurrences. using hierarchical cluster analysis we were able to detect several clusters of tfbs. similar, and often identical, clusters of tfbs were obtained when applying the phylogenic foot printing approach as well as when we used the hybrid tfbs/promoter database and an alternative clustering principle. this indicates that the observed tfbs clusters are to a certain level robust and not dependent on the algorithms used to detect them. some of the obtained tfbs clusters were most likely caused by the presence of overlapping binding motifs, e.g., the aml and myc tfbs clusters, whereas others may represent true co-occurrence in the sense that the dna sequence of the binding motifs are unrelated. as no criterion for proximity, i.e., minimum distance between tfbs, was used many of the identified tfbs patterns are less constrained than so called tfbs modules, typically 100- <dig> bp in size. the obtained results thus suggest that long distance but within promoter combinatorics may operate among transcription factors. interestingly, some clusters of tfbs showed negative correlations. the negative correlations were however lost when the analyses were limited to the evolutionarily conserved parts of the promoters. this makes sense if selection against co-occurrence results in disruption of the respective tfbs as this ultimately would result in a degenerated sequence and no sequence conservation. such selection could possibly act to minimize contradicting regulatory signals caused by, e.g., spurious expression of transcription factor genes, or to keep different cellular states/processes well separated from a regulatory point of view. the target genes for the respective tfbs clusters represented in almost all cases biologically coherent sets of genes, as determined by go term enrichment analyses or the ingenuity software, and represented highly divergent cellular processes. hence, we conclude that the identified tfbs clusters, and their associated gene signatures, are of biological relevance.

we are aware of several limitations of the above analyses. for instance, the most appropriate way to identify tfbs that co-regulate genes might not be to investigate global correlation as this measure includes mutual absence in the comparison. an alternative measure of similarity could have been the jaccard algorithm  <cit> . we also applied the same thresholds for all clusters when selecting genes associated with the specific tfbs clusters, the top  <dig> and  <dig> respectively. as the number of promoters positive for a given tfbs varies with the particular tfbs, an alternative selection criterion would have been to select a given fraction of the positive promoters , e.g., the top 80% of the positive genes, as associated with the signature, which would have produced target gene lists of varying sizes; an option that could easily be biologically motivated. as an alternative to the sum of the normalized hits used in the preset investigation various boolean conditions could also have been employed or added as a limiting criteria. nevertheless, most of the identified tfbs gene signatures were associated with coherent cellular processes and made biological sense. to facilitate future investigations we will provide the software used in this available at http://cbbp.thep.lu.se/~markus/software/smart/.

CONCLUSIONS
we have provided a flexible tool to produce tbfs/promoter databases. we have described a approach to identify significant tfbs in gene sets by use of a resampling strategy and the introduction of a new measure of significance, significantly present . we apply this approach to several published chip-chip data and curated gene signatures obtained from msigdb and show that the strategy produces consistent results and hence may be useful in the analysis of gene expression profiles or chip-chip data. in addition, we have shown that tfbs form stable clusters of co-occurring tfbs that in a consorted fashion seems to regulate sets of genes associated with highly specific cellular processes.

