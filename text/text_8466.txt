BACKGROUND
recent advances in human and medical genetics have made it widely accepted that mendelian disorders that are caused by individual genetic variants are rare, whereas complex diseases that are speculated to be caused by multiple genetic variants, their interactive effects, and/or their interactions with environment factors are common  <cit> . the interactive effect between two or more genetic variants is typically referred to as epistasis, which is supposed to contribute to complex diseases ubiquitously via the sophisticated regulatory mechanisms in the molecular level of human genetics  <cit> . biomedical studies have also been confirming the existence of epistasis in many complex diseases, including myocardial infarction  <cit> , breast cancer  <cit> , hypertension  <cit> , atrial fibrillation  <cit> , diabetes mellitus type  <dig>  <cit> , aids  <cit> , and many others. the detection of epistatic interactions therefore plays a key role in the understanding of the pathogenesis of complex diseases.

nevertheless, most statistical approaches that have demonstrated remarkable successes in the detection of genetic variants underlying mendelian diseases have impaired explanatory power in the identification of epistatic interactions responsible for complex diseases  <cit> . for example, family-based linkage analysis that uses a transmission model to explain the pattern of inheritance of phenotypes and genotypes exhibited in a pedigree works well for mendelian diseases, but it is ineffective when a single locus fails to explain a significant fraction of a disease  <cit> .

on the other hand, with the completion of human genome project, new opportunities and challenges have been presented for uncovering the genetic basis of complex diseases via genome-wide association studies  <cit> . with the accumulation of well-phenotyped cases and carefully selected controls, as well as the emergence of high-throughput genotyping techniques, it becomes urgent to develop effective methods for the detection of epistatic interactions.

to embrace the opportunities, a number of multi-locus approaches have been developed. for example, hoh et al proposed a trimming, weighting, and grouping approach that used the summation of statistics on the basis of single-locus marginal effects and the hardy-weinberg equilibrium  for hypothesis testing  <cit> . nelson et al put forward a combinatorial partitioning method  that exhaustively searched for the combinatorial genotype group that has the most significant difference in the mean of the responding continuous phenotype  <cit> . culverhouse et al modified cpm by ignoring partitions that combined individual genotypes with very different mean trait values  <cit> . millstein et al developed a pre-screening strategy to reduce the number of tests with the use of a focused interaction testing framework   <cit> . chatterjee et al used turkey's 1-degree-of-freedom model to detect interacting loci from different region  <cit> . ritchie et al adopted an exhaustive search strategy to detect combinations of loci with the highest classification capability and named their method multifactor-dimensionality reduction mdr  <cit> . zhang and liu introduced a bayesian epistasis association mapping  method that integrated a bayesian model with a metropolis-hasting algorithm to infer the probability that each locus was associated with the susceptibility of a disease  <cit> . they also proposed the use of a new b statistic instead of the standard χ <dig> statistic. many machine learning methods have also been applied to this research field from the viewpoint of binary classification and feature selection  <cit> .

the effectiveness of most of these methods for genome-wide case-control data has not yet been validated. besides, many methods rely heavily on the exhaustive search for combinations of multiple loci. this strategy, though feasible when the number of candidate snps is small, can hardly be computationally practical for genome-wide association studies in which the number of candidate snps is typically very huge. for example, a study on age-related macular degeneration  has genotyped more than  <dig> thousand single nucleotide polymorphism  markers for  <dig> patients and  <dig> unaffected people  <cit> . it has also become very common to genotype 400~ <dig> thousand snp markers for hundreds of cases and controls in recent genome-wide association studies  <cit> . with such dense snps being genotyped, methods based on the exhaustive search are computationally impractical due to the vast number of combinations of snps. one of the main challenges for genome-wide association studies is therefore to design computational methods that are able to reduce the search space for epistatic interactions from an astronomic number of all possible combinations of snps to a manageable set of candidates.

in this paper, we study case-control data from the viewpoint of binary classification. specifically, we treat cases as positive samples and controls as negative samples, and we use snp markers as categorical features that have three possible values . with this notion, we adopt the random forest  <cit>  that has been widely used in bioinformatics fields such as the selection of genes  <cit> , the identification of gene-gene interactions  <cit> , and the detection of causative nonsynonymous snps  <cit>  as the classifier to discriminate cases against controls, with an emphasis on the contribution of each snp to the classification performance. for this purpose, we first run a random forest with all snps to obtain the gini importance of each snp and then use a sliding window sequential forward feature selection  algorithm to select a subset of snps that can minimize the classification error. since this subset typically contains only a small number of snps , we are able to enumerate all possible k-way  interactions of the candidate snps and test for statistical significance their associations with the disease risk.

the above approach, named epiforest , was compared with three existing methods  on three simulated disease models  <cit> . the results showed that epiforest was comparable to, sometimes more powerful than, these methods. we further applied the proposed approach to a genome-wide case-control dataset for amd that contains  <dig>  snps genotyped for  <dig> cases and  <dig> controls  <cit>  and selected a subset of  <dig> snps that can minimize the classification error. further statistical tests successfully detected from these candidates two snps  that were reported to be associated with this disease.

RESULTS
principles of epiforest
the classical approach to the detection of single-locus association fits a full logistic regression model with a parameter for each observed genotype and then tests the significance of the fitted model via a χ <dig> approximation of the likelihood ratio test statistic  <cit> . alternatively, a χ <dig> test with up to  <dig> degrees of freedom can be directly applied to the contingency table that records the number of cases and controls for each genotype to test whether the distributions of snps for the case and control populations are significantly different. to ensure the overall type i error not exceeding a preset significance level α, a bonferroni correction is typically applied by multiplying the p-values with the number of snp markers l .

similarly, in order to detect the epistatic interaction of two loci, a full logistic regression model with at most  <dig> parameters can be fitted and tested, and the p-values should be multiplied by l/ <dig> according to the bonferroni correction  <cit> . because the number of snps is typically huge  in genome-wide case-control studies, an exhaustive search for all possible combinations of snps is computationally impractical. to overcome this limitation, the stepwise logistic regression approach first selects a small fraction  of loci according to the significance of their single-locus associations and then tests the interactions between the selected loci  <cit> . the determination of the fraction ε is, however, not guided. an approach that is able to automatically determine such a small set of good candidate markers is therefore preferred.

for this purpose, we propose to use epiforest, a two-stage approach as illustrated in figure  <dig>  for the detection of epistatic interactions. a case-control study can be thought of as a binary classification problem, in which we treat cases as positive samples and controls as negative samples, and we target on discriminating cases against controls. the snp markers can be used as categorical features with three possible values in this classification formulation.

with this notion, in the first stage, we use an ensemble learning technique called random forest  <cit>  with all snps to do the classification, while the objective is to obtain the contribution, measured by gini importance, of each snp . then, a sliding window sequential forward feature selection  algorithm that adds one snp at a time from the most significant snp to the least significant one is applied to greedily search for a small subset of snps that could minimize the classification error . after this step, a small set of l  candidate snps that have the most significant contribution to the discrimination of cases against controls is selected.

in the second stage, a hierarchical procedure is adopted to declare the statistical significance that the candidate snps are associated with the disease risk. let α be a preset significance level . in the one-way tests, we apply a statistical test with the use of the b statistic proposed by zhang and liu  to every candidate snp and report all snps whose p-values are less than α after bonferroni corrections for l tests. in the two-way tests, we apply the b statistic to all two-way interactions of the candidates, and report interactions whose p-values are less than α after bonferroni corrections for l/ <dig> tests. in this procedure, if both snps in an interaction have already been reported in the one-way tests, we skip the test for their interaction; if one of the snps has already been reported in the one-way tests, we use a conditional b statistic for testing the interaction; if neither snps in an interaction has been reported in the one-way tests, we use the b statistic for testing the interaction. similarly, in the three-way tests, we apply the b or conditional b statistics to all three-way interactions of the candidates, and report those with p-values less than α after bonferroni corrections for l / <dig> tests.

performance of epiforest
in order to demonstrate the performance of epiforest, we compared it with three existing methods, beam  <cit> , the stepwise logistic regression  <cit> , and the standard single-locus χ <dig> test, on three simulated disease models.

beam uses a bayesian model with the metropolis-hasting algorithm to partition snp markers into three groups: a group g <dig> containing markers unlinked to the disease, a group g <dig> including markers contributing independently to the disease, and a group g <dig> that is composed of markers jointly influencing the disease. after the partition step, candidate snps are further tested for significance with the use of the b statistic  <cit> . in beam, there are two prior probabilities need to be pre-determined: the probability that each marker belongs to g <dig> and that of g <dig>  in our studies, we set both priors to  <dig> . the stepwise logistic regression first selects the most significant ε fraction of snps on the basis of their marginal effects, and then tests all two-way interactions of these snps using logistic regressions with likelihood ratio tests  <cit> . we use ε = 10% in our studies and further test all three-way interactions of the candidates besides the two-way interactions. the classical single-locus χ <dig> test  is used as a benchmark in this comparison.

we considered three disease models with different characteristics . briefly, model  <dig> contains two disease loci that contribute to the disease risk independently. model  <dig> is similar to model  <dig>  except that the disease risk is present only when both loci have at least one disease allele. model  <dig> is a threshold model in which additional disease alleles at each locus do not further increase the disease risk. assuming the disease prevalence to be  <dig>  for all disease models, each model has three parameters associated: the marginal effect of each disease locus , the minor allele frequencies  of both disease loci, and the strength of linkage disequilibrium  between the unobserved disease locus and a genotyped locus   <cit> . to enumerate all possible combinations of these parameters is impossible. we therefore selected only some typical values for each parameter. for λ, we set it to  <dig> ,  <dig> , and  <dig>  for model  <dig>   <dig>  and  <dig>  respectively. for maf, we considered four values,  <dig> ,  <dig> ,  <dig> , and  <dig> , for each model. for r <dig>  we simulated for each model two values,  <dig>  and  <dig> . there were therefore  <dig> parameter settings for each disease model and a total of  <dig> comparisons in our simulation studies.

for each parameter setting of each model, we simulated  <dig> datasets, each of which contains  <dig>  markers genotyped for  <dig>  cases and  <dig>  controls. the minor allele frequency for each non-disease marker is randomly chosen from a uniform  distribution. the performance of a method on a specific parameter setting is measured by the power, defined as the fraction of simulated datasets in which all disease loci are identified at the significance level α =  <dig>  after the bonferroni correction.

the simulation results are shown in figure  <dig>  an overall impression is that the power of epiforest is comparable to, sometimes higher than, that of beam and the stepwise logistic regression, while all these three methods are superior to the χ <dig> tests. specifically, all methods achieve similar performance in model  <dig>  regardless of the ld strength. the reason behind this observation is that model  <dig> is actually a non-epistasis model, in the sense that the two causative loci contribute to the disease risk independently. therefore, all methods for epistasis detection achieve similar performance as the single-locus χ <dig> test, suggesting that the more complex models have little effects in this situation. in model  <dig>  epiforest and beam show their superior performance when the minor allele frequencies of the disease markers are small. this might be attributed to the benefit of using the more powerful b statistic. we also notice that the standard χ <dig> test, as a single-locus search method, performs poorly when the minor allele frequencies of the disease markers are small, suggesting the necessity of developing multi-locus approaches in the search for markers that have epistatic interactions. in model  <dig>  we have similar observations as in model  <dig> 

effectiveness of the swsfs algorithm
the subset of candidate markers that are likely to be associated with the disease risk is screened out with the use of a sliding window sequential forward feature selection  algorithm, given the gini importance provided by the initial run of the random forest . it is therefore necessary to see how many markers are typically selected by this algorithm.

for each parameter setting of the disease model, we plot the number of markers selected by the swsfs algorithm in figure  <dig>  from these box plots, we can see that the median of the number of selected markers is around  <dig> for every parameter setting, and the upper bound of this number is generally less than  <dig>  in other words, the swsfs algorithm is capable of shrinking the search space from  <dig>  snps to, typically, about  <dig> markers, thereby facilitating further statistical tests for epistatic interactions within this small set of candidates.

in our simulation studies, the power of epiforest is in general superior than that of the stepwise logistic regression, while the parameter ε  in the stepwise logistic regression is set to 10% , which is generally greater than the number of candidates suggested by the swsfs algorithm. these facts suggest that epiforest can more precisely pinpoint the candidate snps that might be associated with the disease risk, and this procedure is fully automated.

the observations from figures  <dig> and  <dig> suggest the feasibility of using machine learning methods to select a set of candidate markers that are likely to be associated with the disease risk, thereby reducing the search space for epistatic interactions from a large number of snps to a small number of selected candidates. traditional approaches such as the stepwise logistic regression uses the marginal importance of individual markers as the criterion to select the subset of candidate for further exploration, and the size of the subset remains as a free parameter whose determination is not guided. with the use of epiforest, however, the subset is automatically determined as the one that can minimize the classification error, therefore providing an automated initial screening. on the other hand, because the criterion used by epiforest  is intrinsically different from the p-value provided by likelihood ratio tests that is used in the stepwise logistic regression, it is possible that the gini importance can complement statistical criteria to achieve a better search for epistatic interactions. the results also demonstrate the power of the b statistic over the likelihood ratio test statistic and the χ <dig> statistic, because both epiforest and beam are in general more powerful than the stepwise logistic regression and the χ <dig> test.

application to amd
in simulation studies on  <dig>  snps, epiforest is comparable to, sometimes more powerful than, three existing methods. nevertheless, studies have shown that a number of  <dig>  to  <dig>  common snps may be required for genotyping in real genome-wide case-control studies  <cit> . it is therefore necessary to show whether epiforest is able to handle such large data in real genome-wide association studies.

for this purpose, we applied epiforest to an age-related macular degeneration  dataset  <cit> , which contained  <dig>  snps genotyped with  <dig> cases and  <dig> controls. as suggested in  <cit> , we removed nonpolymorphic snps and those that significantly deviated from hardy-weinberg equilibrium , and we removed all snps that had no reference snp id or had more than  <dig> missing genotypes to ensure the high quality of the remaining data. after the filtering, there remained  <dig>  snps.

we first run a random forest with the use of all snps as categorical features to discriminate the  <dig> cases against the  <dig> controls. the aim was to obtain the gini importance, indicating the contribution to the classification accuracy, of each snp. we used one million trees in the construction of the random forest and repeated the experiment ten times to reduce random effects. the gini importance for each snp was averaged over the resulting ten forests and shown in figure  <dig> 

it is interesting to see from this figure that the two snps, rs <dig> and rs <dig>  that were reported to be associated with amd in literature  <cit> , have the largest gini importance among all snps. specifically, the gini importance is  <dig>  for rs <dig> and  <dig>  for rs <dig>  while the bonferroni-corrected p-values are  <dig>  and  <dig>  for rs <dig> and rs <dig>  respectively, according to χ <dig> tests under the assumption of hardy-weinberg equilibrium  <cit> . these observations suggest that higher gini importance may indicate lower p-value.

we then plotted the relationship between the gini importance values and the p-values  for b statistics of all the  <dig>  snps in figure  <dig>  we observed that, in general, larger gini importance values imply smaller p-values. in other words, the gini importance has a strong negative correlation with the p-value. in details, their pearson's correlation coefficient  is - <dig> , and is very significant with a p-value less than  <dig>  × 10- <dig> . this observation suggests that the gini importance from the viewpoint of machine learning may complement the p-value from the statistics point of view to offer yet another measure for the associations between snps and complex diseases.

to illustrate the sliding window sequential forward feature selection  algorithm, we plotted the classification error rate of random forests using up to the first  <dig>  most important snps, as shown in figure  <dig>  the minimum classification error  occurs when the first  <dig> most important snps  are used. with the use of the swsfs algorithm , only the first  <dig> random forests need to be constructed, therefore saving the computational expenses. it is worth noting that the minimal classification error, the number of the snps used, and the subset of snps are automatically determined by the swsfs algorithm without the participation of human. when compared with the stepwise logistic regression method in which the fraction of candidate markers need to be manually determined for further investigation, our approach can provide an automated means of determining this critical value.

there has yet no report about interactions associated with amd from this dataset thus far. the main reason might be the small sample size of  <dig> individuals is insufficient for detecting subtle epistatic interactions  <cit> . in our study, we also find no significant interactions after the bonferroni correction. nevertheless, we still report in table  <dig> the top  <dig> two-way interactions and the top  <dig> three-way interactions that have the smallest p-values before the bonferroni correction. it is interesting to see that neither rs <dig> nor rs <dig> is significant for single-locus association , whereas their combination has the smallest p-value among all two-way interactions. we can also see that rs <dig> appears in  <dig> out of  <dig> two-way interactions, and rs <dig> appears in all  <dig> three-way interactions. certainly, these observations need to be further studied in depth with the use of more case-control samples, and functional tests are necessary to confirm whether these interactions have true associations with amd. although these studies are beyond the scope of this paper, we hope that, from table  <dig>  some clues could be provided for the exploration of epistatic interactions in this complex disease. note that, some of these interactions have been previously detected independently by another genome-wide association study method that is developed by the authors to identify epistatic modules via the integration of bayesian models and markov chain monte carlo strategies.

discussion
the development of epiforest is motivated by the following two facts:  most existing approaches use pure statistical methods and  in the stepwise logistic regression, the selection for the subset of candidate snps is not guided. accordingly, the main contribution of our approach includes:  the incorporation of the random forest into case-control studies and  the automated screening of the candidate snps for further statistical analysis.

the random forest has several advantages over other classifiers in the studies for case-control data. first, and of the most interest, the random forest can natively provide the gini importance that measures the contribution of individual features  to the classification. we have also shown that the correlation between this importance measure and the p-value for the b statistic is strongly negative. in this sense, the gini importance may complement the p-value to offer yet another useful measure for the associations between snps and complex diseases. second, the random forest needs no extra cross-validation for evaluating the classification performance, thereby greatly reducing the computational time. third, as a classical ensemble learning method, the procedures for constructing decision trees in the forest are mutually independent, hence very suitable for large scale parallel computation or hardware acceleration.

the epiforest framework can also be extended from the following directions. first, the gini importance can itself serve as a statistic and be used with the permutation test to directly offer a p-value. second, the random forest has an experimental means of estimating interactions between two features. for each tree, features can be ranked on the basis of their gini decreases, and the absolute difference in the ranks of every two features can be calculated. averaging this difference over all trees, one obtains a measure for the interaction of every pair of features  <cit> . it is therefore interesting to analyze the relationship between this measure and statistical measures such as the p-value.

certainly, our approach is not intended to take the place of existing statistical methods for detecting epistatic interactions. instead, we are interested in showing how machine learning approaches can complement statistical methods to facilitate the exploration of interactions between multiple snps, because epistasis plays such an important role in the pathogenesis of complex diseases, and the detection of epistasis still remains a great challenge and needs to be studied from different perspectives.

CONCLUSIONS
in this paper, we studied case-control data from the viewpoint of binary classification. we treated cases as positive samples and controls as negative samples, and used snp markers as categorical features. we adopted random forest to discriminate cases against controls, while the focus was to obtain the gini importance to measure the contribution of each snp to the classification performance. on the basis of this measure, a sliding window sequential forward feature selection  algorithm was proposed to automatically determine a subset of candidate snps that were most likely to be associated with the disease. a hierarchical procedure with the use of the b statistic was applied to declare statistical significance of up to three-way interactions within this set of candidates. this framework, including the random forest and the swsfs algorithm for initial screening, and the hierarchical procedure for declaring statistical significance, was named epiforest.

we compared the proposed approach with three existing methods, including beam  <cit> , the stepwise logistic regression  <cit> , and the χ <dig> test, on three simulated disease models  <cit> . the results showed that the power of epiforest was comparable to, sometimes higher than, that of the other methods.

we further applied epiforest to a real genome-wide case-control dataset of amd. the swsfs algorithm automatically selected a set of  <dig> snp markers. it was interesting to see that the two snps  already reported as linked to this disease  <cit>  had the highest gini importance. a strong negative correlation between the gini importance and the p-value for the b statistic was also observed.

