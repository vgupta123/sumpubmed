BACKGROUND
in the era of dna sequencing, researchers must balance cost, ease of use, efficiency, sequencing fidelity, and quantity of data produced against project requirements when choosing between sequencing technologies. despite the rapid proliferation of next generation sequencing  technologies, we have relatively few evaluations of the accuracy and efficiency of ngs platforms for whole genome sequencing or for re-sequencing of large populations . here, we genotype  <dig> ring-tailed lemurs  at the major histocompatibility complex  gene drb, using two ngs platforms, roche's  <dig> flx titanium  and life technology's ion torrent personal genome machine . we demonstrate the utility of using ngs to genotype non-model organisms at complex hypervariable loci like those of the mhc and we validate the use of mhc-drb diversity as a proxy for overall mhc diversity.

mhc genes are among the most variable in the mammalian genome, presumably because of their role in identifying the myriad potential pathogens in the environment  <cit> . mhc protein products activate the adaptive immune system whenever they encounter and bind an intracellular or extracellular pathogen. across fish, reptiles, birds, and mammals, mhc genes are frequently duplicated with 1– <dig> copies and 1– <dig>  alleles per gene: even between alleles within a single species, 12-45 % of the nucleotide sites are variable . although this diversity and genomic complexity makes the mhc well suited for the measurement of individual and population-level genetic fitness, it leads to many practical complications during mhc genotyping . beyond the difficulties introduced by duplications, allelic variation, and the presence of pseudogenes , genotyping population-level sample sizes  for studies of the influence of mhc on health or reproductive success can be cumbersome, time-consuming, and expensive.

although many techniques have been used to genotype the mhc , cloning has historically been the gold standard  <cit> ; however, mhc allelic variation and duplication can necessitate higher sequence coverage than is practical for cloning or gel-based genotyping systems. parallel sequencing using ngs platforms solves this problem by quickly generating immense volumes of data  <cit> . moreover, in studies comparing the performance of ngs platforms to cloning or gel-based genotyping systems, ngs detects significantly more mhc alleles  <cit> . to overcome the difficulty of genotyping hypervariable loci for large sample sizes, samples can be pooled or multiplexed into a single run via parallel-tagged sequencing on ngs platforms  <cit> . ngs technology is, therefore, less labor intensive, more efficient, and more cost effective than older methods. a significant challenge with these technologies, however, is distinguishing genuine allelic variation from artifacts.

current ngs platforms include gs flx titanium/gs flx junior from roche, solid and ion torrent platforms from life sciences, the pacbio rs ii from pacific biosciences, and genome analyzer/hiseq/miseq/nextseq from illumina. owing to the specifics of enzymology, chemistry, high-resolution optics, hardware, and software, each platform differs in the types of sequencing errors   and quantity of data produced . most ngs projects sequence genomes via the assembly of short  reads. as ngs platforms became cheaper and produced longer reads  <cit> , however, ecologists and conservation biologists began using ngs to obtain population-level estimates of genetic parameters and individual genotypes for hundreds or thousands of samples . currently, roche  <dig> flx, ion torrent pgm, pacbio rs, and illumina miseq v <dig> are the only ngs platforms to rival sanger sequencing for the production of longer  reads  <cit> . roche  <dig> was the first platform to produce longer reads and thus has been most widely used; however, because roche is shutting down the  <dig> flx manufacturing and servicing at the end of  <dig>  it is critical to evaluate the performance of this and other ngs technologies against traditional methods like cloning, as well as to be able to distinguish alleles from sequencing errors or artifacts.

in this paper, we use both the ion torrent  <dig> v <dig> chip and 400 bp kit, as well as the  <dig> flx titanium, to genotype the second exon of the mhc-drb of a non-model species. we present modifications to a method for distinguishing alleles from sequencing errors to account for potential pitfalls of deep sequencing. additionally, we report on allelic diversity in the ring-tailed lemur, which is only the third strepsirrhine primate species to be investigated in depth . in species for which the mhc is well characterized, identifying alleles and assigning genotypes is relatively straightforward; however, for most non-model species, basic information about the number of gene copies and the variability present in the mhc is unavailable. in such cases, distinguishing between true alleles and artifacts presents a substantial methodological challenge because of the extreme variation and copy number variability in mhc genes  <cit> .

ten years after beginning to use ngs in genotyping, investigators are still developing standards for quality controls, validation, and allele calling . in one strategy, researchers used a cut-off based on the absolute frequency  <cit>  or the relative frequency of alleles and artifacts within an amplicon  <cit> . because the sequencing depth often causes the relative frequencies of alleles and artifacts to overlap near the cut-off  <cit> , this latter approach may result in misassignments, including false negatives, in which genuine alleles are discarded as artifacts, and false positives, in which artifacts are classified as alleles . therefore, researchers have begun implementing new strategies , custom algorithms , and workflows to account for differential amplicon efficiency . by modifying a published protocol, we present additional steps to refine the process of assigning correct genotypes for the mhc-drb gene.

as our contribution to these workflows, we add steps to address two problems that occur in ngs genotyping during deep sequencing: allelic dropout and misassignment of artifacts. in current allele-calling workflows, researchers classify as an allele any sequence that does not meet the criteria of an artifact. criteria for an artifact involve filtering by length, quality, consensus to known sequences, presence in sample replicates or in other individuals, and relative frequency within an amplicon. some of these criteria must be adjusted depending on the depth of coverage and number of amplicons.

because the second exon of mhc-drb contains the functionally important antigen-binding site, which is responsible for peptide recognition, the mhc-drb gene is one of the best-studied and most diverse functional genes  <cit> . researchers often use diversity at the mhc-drb gene as a proxy for diversity across the rest of the mhc gene family ; however, this practice may lead to an inaccurate estimation of mhc diversity because the mhc spans hundreds of genes over several megabases of dna  <cit> . our ultimate goal was to compare multiple mhc genes to verify that the mhc-drb gene is the most variable and, therefore, a suitable target for future work investigating mhc contributions to fitness. we evaluated allelic diversity at five additional mhc genes that are typically less diverse in primates than is the mhc-drb . for all six mhc genes, we examined nucleotide and amino acid variation, as well as the presence or absence of selective pressure on mhc-drb, by looking for amino acid sites under positive selection and trans-species polymorphism . as the second exon of mhc-drb encodes the functionally important binding pocket responsible for the specific binding of pathogenic peptides, selection is expected to act most intensely on this part of the gene. therefore, this area of the mhc has been used as a barometer for the genetic health of populations  <cit> . studies like the present one pave the way for using ngs to provide reliable genotyping of hypervariable loci on large numbers of non-model species.

methods
subjects and sampling
our study population consisted of  <dig> ring-tailed lemurs. these represented   <dig> captive animals from various facilities, including the duke lemur center  in durham, nc , the cincinnati zoo in cincinnati, oh , and the indianapolis zoo in indianapolis, in , as well as   <dig> wild animals from the bezà mahafaly special reserve  in southwestern madagascar. for captive animals, our sampling methods for obtaining dna  followed approved animal handling guidelines and protocols of the institutional animal care and use committee of duke university , as well as the institutional guidelines of each zoo. sample collection from wild lemurs in madagascar was approved by the institutional animal care and use committees of the university of colorado-boulder and/or the university of north dakota , madagascar national parks , and cites .

for individuals derived from the captive populations, either staff veterinarians obtained blood samples from the femoral vessels of gently hand-restrained subjects or we acquired tissue samples banked from deceased subjects. these samples were stored at −20 °c until processing. blood samples from anesthetized, wild animals were obtained by team veterinarians during annual health analyses conducted from 2003– <dig> . the blood samples from 2003– <dig> were preserved on schleicher & schuell isocode© dna isolation cards , whereas blood samples from 2007– <dig> were preserved on whatman fta® classic cards .

dna extraction and genotyping overview
for samples obtained from captive animals, we performed dna extractions using either dna miniprep kits  or dneasy® blood and tissue kits . for samples obtained from wild animals, we extracted dna from the isocode cards, using  <dig> -mm hole punches following manufacturer's instructions, and from fta cards following the protocol for whole genome amplification  of dna from blood spots dried on fta paper . due to the age of some cards and the storage conditions in madagascar, we subjected each extracted dna sample to wga to improve dna quality and quantity. previously, researchers have shown that wga results in 98 % congruence of snp calling between amplified and non-amplified dna, and does not result in allelic dropout  <cit> . we performed wgas using repli-g single cell kits®  and modified our protocol by incubating each sample for 16 h at 30 °c to generate sufficient quantities of gdna for future work. to verify that the wga did not bias our genotyping results, we also subjected the dna of a subset of captive individuals  to wga. we then genotyped all individuals at the second exon of mhc-drb using the  <dig> flx titanium®  and the ion torrent pgm®  platforms. for verification of ngs genotyping, we cloned the mhc-drb second exon from  <dig> captive individuals. we also genotyped 5– <dig> individuals at five additional mhc loci  via cloning  <cit> .

mhc-drb primers
for ngs sequencing, we amplified a 171 bp-fragment of the mhc-drb exon  <dig> using modified primers, js <dig> and js <dig>  <cit> . the  <dig> forward primer was composed of the  <dig> flx amplicon a 19-bp adaptor sequence, a 4-bp key sequence, a 10-bp multiplex identifier ‘tag’ , and the site-specific forward primer, js <dig> : 5’ < cgtatcgcctccctcgcgccatcagnnnnnnnnnngagtgtcatttctwcaacgggacg > 3’. the ion torrent forward fusion primer was composed of the ion torrent a adaptor sequence, a 4-bp key sequence, a 10-bp multiplex identifier ‘tag’, and the site-specific forward primer, js1: 5’ < ccatctcatccctgcgtgtctccgactcagnnnnnnnnnngatgagtgtcatttctwcaacgggacg > 3’. the reverse primers also included the platform-specific adaptors, 4-bp key sequence, 10-bp multiplex identifier ‘tag’, and the site-specific reverse primer, js <dig>  the  <dig> reverse primer and ion torrent reverse primer sequences, respectively, were as follows: 5’ < cgtatcgcctccctcgcgccatcannnnnnnnnngatcccgtagttgtgtctgca > 3’ and 5’ < cctctctatgggcagtcggtgattcag-nnnnnnnnnngatgatcccgtagttgtgtctgca > 3’. we used  <dig> distinct 10-bp tags from the standard mid set developed by the manufacturer .

 <dig> sequencing of mhc-drb
we performed pcrs for  <dig> sequencing on a programmable icycler thermocyler  in 25 μl reactions, using  <dig>  μl of 10x faststart high fidelity reaction buffer #  <dig> with mgcl <dig>  10 μm of each primer, 5 mm of each dntp,  <dig>  u of faststart high fidelity taq polymerase , and 20–70 ng of genomic dna per reaction. the pcr scheme was as follows: initial denaturation at 94 °c for 3 min, 25 cycles of 94 °c for 15 s, 55 °c for 45 s, 72 °c for 1 min, followed by a final extension at 72 °c for 8 min. we estimated the concentration of the pcr products by agarose gel electrophoresis  <cit>  and combined approximately equimolar quantities of each pcr product into five pools. we combined 56– <dig> unique individuals per pool, plus 19– <dig> replicates, for a total of 80– <dig> pcr reactions per pool . in total, we pooled  <dig> pcr reactions , from  <dig> individuals, sequencing these samples according to the manufacturer’s instructions on five 1/8th lanes of a  <dig> ptp titanium plate ). we sequenced these pooled amplicons between september  <dig> and october  <dig> at the genome sequencing & analysis core resource, duke university, nc, and the microbiome core facility, university of north carolina at chapel hill, nc.table  <dig> ngs statistics per  <dig> titanium 1/8th lane or individual ion torrent pgm run



ion torrent pgm sequencing of mhc-drb
we performed pcr reactions for ion torrent sequencing on programmable icycler thermocyler  in 50 μl reactions, with 44 μl platinum pcr supermix high fidelity , 10 μm of each primer, and 20–70 ng of genomic dna. based on the performance of our samples on the  <dig> titanium platform, we performed each pcr as a touchdown series of cycles to decrease the production of pcr artifacts  <cit> . initial denaturation began at 94 °c for 2 min, followed by touchdown pcr for 14 cycles: denaturation at 94 °c for 30 s, annealing 62 °c for 30 s, extension at 68 °c for 1 min, and lowering the annealing temperature by  <dig>  °c every cycle, ending at an annealing temperature of 55 °c. following the initial 14 cycles, we performed  <dig> additional cycles as follows: denaturation at 94 °c for 30 s, annealing at 55 °c for 30 s, extension at 68 °c for 1 min, followed by a final extension at 68 °c for 10 min. we followed the previously described protocol for pooling pcr products into pooled amplicons, and submitted these pools to the genome sequencing & analysis core resource at duke university in september and october of  <dig> . for each ion torrent pgm run, we pooled 104– <dig> unique individuals and 12– <dig> replicates, for a total of 120– <dig> amplicons per run . in total, we pooled and sequenced  <dig> amplicons of  <dig> individuals on three ion torrent pgm runs. we used the ion torrent pgm template ot <dig>  <dig> kit and an ion torrent pgm 314r v <dig> chip for sequencing, and ion torrent software suite  <dig>  for image analysis, according to the manufacturers’ instructions.

cloning of mhc genes: drb
to verify ngs genotypes of the second exon of mhc-drb, we used the unmodified primers js <dig> and js <dig> to pcr  <dig> samples following the above ion torrent pcr protocol. following manufacturers’ instructions, we cloned these pcr products using pgem-t® easy vector  and library efficiency® dh5α competent cells . due to the incredible diversity of mhc-drb, we sequenced between  <dig> and  <dig> clones per individual, using abi 3730xl analyzer and big dye chemistry . using mega  <dig>   <cit> , we aligned and analyze sequences against ngs sequences for these individuals.

cloning of mhc genes: doa, dob, dpa, dqa, and dra
to clone additional mhc genes, we designed primers from grey mouse lemur , thick-tailed bushbaby , and philippine tarsier  genbank sequences . our pcr had an initial denaturation of 45 s at 94 °c, followed by 30 cycles of 30 s at 94 °c, 30 s at 54 °c, and 1 min at 68 °c, and a final extension of 7 min at 68 °c. using pgem-t® easy vector  and library efficiency® dh5α competent cells , we cloned the pcr products following manufacturers’ instructions. in other primate species, these genes have much reduced diversity compared to mhc-drb  <cit> . we therefore sequenced only 10– <dig> positive clones per gene, per individual, on abi 3730xl analyzer using big dye chemistry . we considered as alleles only sequences found in minimally three clones per pcr. we used mega  <dig>   <cit>  to align and analyze sequences from mhc-doa, mhc-dob, mhc-dpa, mhc-dqa, and mhc-dra.

ngs data analysis
following initial quality assessment by the  <dig> and ion torrent software, we differentiated alleles from artifacts using a modified version of a published protocol . in our first step, we used the open-sourced, web-based platform galaxy to filter the original fastq files for read length and read quality . we discarded all reads shorter than 150 bp, longer than 400 bp, or in which more than 5 % of bp had a phred score <  <dig>  we then sorted reads into specific amplicons according to their unique barcode combination using jmhc  <cit> . using the galaxy clustalw package  <cit> , we aligned reads to published ring-tailed lemur mhc-drb sequences . because the number of mhc-drb copies present in the ring-tailed lemur was unknown, we initially analyzed all reads assuming that ring-tailed lemurs had only one copy. we also assumed an average amplicon efficiency of  <dig> , as outlined in previously published methods  <cit> . we therefore discarded amplicons containing <  <dig> reads as having too few reads to genotype accurately  <cit> . after discarding singleton variants, we compared replicates of the same individual and discarded any variant that did not represent > 1 % of the total proportion of reads in any replicate amplicon; these variants were considered artifacts  <cit> . we performed all subsequent steps of the workflow  independently on each amplicon without regard to results from replicates of the same individual. we performed each step on all amplicons before beginning the next step of the workflow, i.e., we completed step i for all amplicons before beginning step ii, then completed step ii before moving on to step iii. we analyzed variants within each amplicon independently and did not assume each only had one classification; thus, even if a variant were classified as an allele in one amplicon, it could be classified as an artifact in another amplicon. at the conclusion of the workflow, we classified all variants as either an allele or an artifact.fig.  <dig> workflow for differentiating alleles from artifacts: step i. this workflow is modified from  <cit>  and a more detailed description of the workflow is provided in the additional file  <dig>  briefly, ngs reads were filtered for read length, phred quality score, complete forward and reverse primer + mid, and alignment to published sequences. read numbers are given in italics, whereas variant numbers are given in bold

fig.  <dig> workflow for differentiating alleles from artifacts: step ii. this workflow is modified from  <cit>  and a more detailed description of the workflow is provided in the additional file  <dig>  in step ii, identical reads within each amplicon were clustered into a single variant and variants were sorted according to relative frequency within the amplicon. variants of > 1 % frequency and chimeric variants were discarded. then variants were classified as differing from the most frequent sequence by 1–2 bp or > 2 bp. intra-amplicon classifications are shaded in gray, whereas final variant identifications are shaded in blue. variant numbers are given in bold

fig.  <dig> workflow for differentiating alleles from artifacts: step iii & iv. this workflow is modified from  <cit>  and a more detailed description of the workflow is provided in the additional file  <dig>  variants were compared to replicate amplicons for each individual using relative frequncies, and to amplicons of other individuals to determine if the variant was an allele, a low efficiency allele, an artifact, or an unclassified variant. a more detailed description of the workflow is provided in the additional file 1


fig.  <dig> workflow for differentiating alleles from artifacts: step v. this workflow is modified from  <cit>  and a more detailed description of the workflow is provided in the additional file  <dig>  variants classified as chimeric sequences in step ii were compared to other replicates to determine if they were truly chimeric sequences. a more detailed description of the workflow is provided in the additional file 1


fig.  <dig> workflow for differentiating alleles from artifacts: step vi. this workflow is modified from  <cit>  and a more detailed description of the workflow is provided in the additional file  <dig>  in the final step of the workflow, we compared the classification of each variant across replicates within an individual to verify that no classifications disagreed



in steps iiia & iiib of the workflow, we classified variants into the following three categories: ‘1-2 bp differences’, ‘>2 bp differences’, and ‘chimera’ . these classifications were based on the assumptions that, during pcr or sequencing, artifacts generated  occur less frequently than their parent allele,  occur less frequently than any non-parent true allele, and  are less likely than true alleles to appear in replicate pcrs. mhc alleles should be amplified in greater frequency than artifacts, although this may not always occur if the amplification efficiency of an allele is low relative to the artifact’s parent allele  <cit> . we calculated bp differences between variants using mega  <dig>   <cit>  and identified potential chimeras using the uchime de novo command in uchime  <cit> .

for the  <dig> individuals with replicate amplicons , we examined variants within each amplicon first, then compared variant classifications between replicates for disagreement . those variants with classification disagreements between replicates fell into the following two categories:  variants that were not labeled as an allele in any replicate , which were then classified as artifacts for all replicates, or  variants that were labeled as an allele in at least one replicate, which became ‘low-efficiency alleles’  <cit> . some individuals  were represented by only one successfully sequenced amplicon. because we were unable to compare replicates for individuals, we modified our protocol to distinguish alleles from artifacts for those individuals .

lastly, owing to high coverage obtained for certain individuals,  <dig> lemurs initially had ≥  <dig> alleles following workflow analysis. their amplicons also contained no artifacts because, owing to the depth of coverage attained, none of the variants fulfilled the criteria for an artifact. thus, all variants were initially classified as true alleles by default. these individuals appeared to have as many as eight mhc-drb copies, whereas other individuals possessed a maximum of four mhc-drb copies. within these  <dig> individuals, many variants initially labeled as alleles were present only in those individuals that lacked any artifacts. we therefore classified these variants as artifacts. any variant classified as an allele in another individual was retained as an allele. after this step, all genotyped lemurs had ≥  <dig> alleles each.

after the initial analysis, our results clearly indicated that ring-tailed lemurs have >  <dig> mhc-drb copies, contrary to our initial assumption. our threshold of reads required to reliably genotype an individual therefore increased to  <dig> reads per individual  <cit> . to confirm that at least  <dig> reads were required for reliable genotyping, we re-genotyped a subset of individuals using two alternative thresholds of  >  <dig> reads per amplicon and  >  <dig> reads per amplicon. based on the minimum threshold of >  <dig> reads, we then re-genotyped any individuals for which any replicates fell below the threshold of  <dig> reads per amplicon, excluding amplicons with <  <dig> reads. we then named alleles in convention with previously established standards  <cit> .

as a final verification of our genotyping protocol, we compared genotypes generated by our ngs data to predicted genotypes based on captive pedigree data, using  <dig> known parent-offspring trios from the historical dlc records. to evaluate ngs performance against traditional cloning, we compared genotypes obtained by ngs to genotypes obtained by cloning for  <dig> lemurs cloned at mhc-drb.

after mhc-drb genotypes were obtained for all individuals, we calculated dn/ds ratios for the entire mhc-drb fragment, and the abs and non-abs regions separately, using mega  <dig>   <cit> . to test for positive selection on the second exon of mhc-drb, we analyzed our alleles using models  <dig>  1a, 2a,  <dig>  and  <dig> in codeml  <cit> . lastly, we tested for trans-species polymorphism by constructing a phylogenetic tree, which included our new allelic sequences and all published lemur mhc-drb sequences  <cit> .

RESULTS
in total, we generated  <dig> , <dig> reads across the two ngs platforms, of which  <dig> , <dig>  were retained after length and quality filtering on galaxy . these reads clustered into  <dig>  unique variants. to examine differences between the platforms, we sequenced all individuals on each platform at least once. the platforms differed in the amount of data generated: the  <dig> titanium 1/8th lane produced an average coverage of  <dig> reads per amplicon, whereas the ion torrent pgm averaged  <dig>  reads per amplicon .fig.  <dig> frequency distribution of final read coverage per amplicons. the read coverage for each of the two sequencing platforms is shown:  <dig> titanium  and ion torrent pgm . because few amplicons had >  <dig>  reads , only the distribution of amplicons with <  <dig>  reads are shown



using our workflow, we successfully genotyped  <dig> individuals from  <dig> amplicons combined across both ngs platforms. a minimum threshold of  <dig> reads per individual was sufficient for genotyping. we found that genotypes obtained using a minimum threshold of  <dig> reads differed from genotypes obtained using a threshold of  <dig> reads; however, genotyping using a minimum threshold of  <dig> reads produced identical genotypes to those obtained using a threshold of  <dig> reads. we were unable to genotype  <dig> individuals, due to insufficient read coverage. by comparing the number of alleles within an individual to the read coverage per individual  <cit> , we verified that we had not under-sequenced individuals because the number of alleles per individual was uncorrelated to the read depth per amplicon . by the end of our workflow, we classified  <dig> variants as alleles,  <dig> variants as low-efficiency alleles,  <dig> variants as unclassified variants, and  <dig>  variants as artifacts. the maximum relative frequency of all final ‘error’ classifications  overlapped the range of the relative frequency of alleles between  <dig>  and 10 % ; however, in contrast to the  <dig>  % average frequency of an artifact  or the  <dig>  % average frequency of an unclassified variant , the average frequency of an allele was  <dig>  % , calculated across individuals possessing one to seven alleles. of  <dig>  unique variants spread among  <dig> amplicons, the classifications of only  <dig> variants disagreed. the majority  of the disagreeing variants resulted in the classification combination of “artifact/unclassified variant”; the remaining  <dig> variants were classified in various combinations of alleles, low efficiencies, artifacts, and unclassified variants. we then collapsed the categories of ‘alleles’ and ‘low efficiency alleles’ into ‘alleles’, and unclassified variants into artifacts. we found no disagreement between the genotypes of samples obtained before and after whole genome amplification. using historical records from the duke lemur center to examine the genotypes of  <dig> known parent-offspring trios, we found agreement between  <dig> parent-offspring genotypes, whereas  <dig> offspring possessed at least one allele that was not present in either parent. because these  <dig> offspring possessed either a unique genotype or possessed a ‘common’ genotype found in many other individuals in this study, sample contamination or mis-labeling of samples was unlikely. lastly, we confirmed all ngs genotypes of  <dig> individuals, using traditional cloning . from these  <dig> individuals, six alleles were confirmed as true positives and all  <dig> genotypes showed 100 % congruence with genotypes assigned using ngs.fig.  <dig> relationship between the number of alleles per ring-tailed lemur and average read coverage per individual. lack of correlation indicates that individuals were not under-sampled . read coverage per individual was averaged across replicates for each individual and gray shading reflects 95 % confidence intervals

fig.  <dig> frequency distribution for final variant classifications within amplicons. the top left and center graphs show alleles  and low efficiency alleles , whereas the bottom left and center graphs display artifacts  or unclassified variants . the top right graph shows the combined relative frequencies alleles and low frequency alleles, and the bottom right graph shows the combined relative frequencies of artifacts and unclassified variants. the y-axis is scaled as a square root



from  <dig> ring-tailed lemur genotypes, we found  <dig> unique putative mhc-drb alleles , and identified the first sequences from this species for the mhc genes doa, dob, dpa, dqa, and dra . because we found only one allele each for dob, dpa, dqa, and dra, and two alleles for doa, the diversity at these mhc genes appears to be far less than that present in the mhc-drb gene. individual lemurs possessed between  <dig> and  <dig> mhc-drb alleles.

within the  <dig> mhc-drb alleles, we found variation at  <dig>  % of  <dig> nucleotide sites and at  <dig>  % of  <dig> amino acid  sites . between alleles, there was an average of  <dig>  ±  <dig>  nucleotide differences  and  <dig>  ±  <dig>  aa differences . differences in aa sequence were concentrated at the antigen binding sites  and at positively selected sites  and sequences showed a high dn/ds ratio along the entire sequence, the abs sites, and the non-abs sites . models m2a and m <dig>  fit the data better than models  <dig>  1a, and  <dig> . lastly, a phylogeny of all strepsirrhine mhc-drb sequences showed no concordance with the lemur species tree .table  <dig> variation in amino acid sequence and rates of synonymous and nonsynonymous mutations across antigen and non-antigen binding mhc-drb sites

region of mhc-drb
note. this table shows the total number of amino acid codons  as well as the number and percentage of variable amino acid codons  in the mhc-drb second exon, the average  pairwise aa differences  between alleles, the average  rates of nonsynonymous  and synonymous  substitutions per site, and the one-tailed test of positive selection  with p-values . all standard errors were obtained from  <dig> bootstrap replicates  <cit> 

fig.  <dig> sequence logo. this sequence logo  <cit>  showing amino acid  variation along the second exon of the ring-tailed lemur mhc-drb gene. letters represent standard aa abbreviations, letter height indicates the relative frequency in the population of each aa at that position, and letter color indicates the chemical properties of the aa: polar , neutral , basic , acidic , and hydrophobic . * identifies antigen-binding sites, assuming consensus with human drb  <cit> . gray boxes indicate positively selected sites calculated by models m2a & m <dig> in program paml 

mhc-drb
p1 =  <dig> , ω1 =  <dig> ,

note. fit of data compared between models of strict neutral evolution  and models including positive selection . fit assessed by log likelihood score , and akaike information criteria  values; the model with the lowest aic value, or a Δaic of zero, indicates the model that best fits the data. estimated proportions of sites  evolving at corresponding estimated rates  are given in the parameters column, as well as positively selected sites , or aa sites under positive selection in each model

fig.  <dig> phylogenetic tree of all ring-tailed lemur and all other published lemur mhc-drb sequences. ring-tailed lemur mhc-drb sequences were produced by this study or downloaded from genbank  <cit> . the phylogeny was created via neighbor-joining method with kimura 2-parameter  <cit> . species are designated by the first two letters of the genus and species names, e.g., ring-tailed lemur, or lemur catta, sequences are indicated by 'leca'. triangles indicate collapsed nodes that did not contain ring-tailed lemur sequences. bootstrap values >  <dig> are shown from  <dig> replicates



discussion
for hypervariable, multilocus genes like mhc-drb, ngs is the preferred genotyping method, especially for large numbers of individuals . in this paper, we improved previously published methods for distinguishing alleles from artifacts, including additional steps to improve the detection of artifacts and allelic dropout  <cit> . using our roadmap, we were able to genotype  <dig>  % of our individuals with less expense and effort  <cit> , as well as greater depth of sequencing, than possible using previous ‘gold standard’ methods . the lack of correlation between read depth and number of alleles per individual indicates that we sequenced individuals at sufficient depth to avoid under-sampling and potentially missing alleles because of low coverage  <cit> . using a combination of gold-standard cloning and ngs techniques, we produced new sequence data for five previously unexplored mhc genes in the endangered ring-tailed lemur and confirmed that the mhc-drb is by far the most variable of the six mhc genes investigated. we determined ring-tailed lemurs have at least four putatively functional copies of the mhc-drb gene, consistent with the number of copies found in other primates . lastly, we demonstrated that the mhc-drb gene in ring-tailed lemurs has experienced positive selective pressure in the past, supporting its importance in immune function.

because sequencing depth depends on copy number, number of amplicons, and the number of reads that fail to pass length and quality filters  <cit> , researchers must plan amplicons pools carefully; otherwise, amplicons will lack sufficient coverage. as roche ends technical support for all  <dig> machines in  <dig>  researchers will need to transition to other platforms like the illumina miseq or ion torrent pgm. based on the results of this study, researchers could pool as many as 400– <dig> individuals with four mhc-drb copies on a single ion torrent pgm run .

in contrast to the well-developed methods for cloning or conformation-based genotyping, researchers are still refining protocols for ngs projects . methodologies are being modified and improved as new pitfalls are discovered. more specifically, the immense quantity of sequence data produced by ngs requires improved study designs. an important lesson from our study is that depth of sequencing is not a substitute for independent replicate pcrs. we highlight the need for increased sample replication between runs and platforms. we also suggest that each sample be sequenced from at least two independent pcrs, consistent with protocols in traditional cloning . replicating only a few samples can increase the probability of obtaining the same genotype for each replicate by chance alone. for example, lichten and colleagues  <cit>  assigned genotypes for seven replicates with 100 % repeatability within a run; however, when the authors tested genotype repeatability across platforms by re-sequencing  <dig> samples on a different platform, genotype repeatability decreased to  <dig>  % . to date, the majority of researchers replicate ≤ 10 % of their sample populations using ngs, often within the same run and/or on the same platform . in studies in which < 10 % of samples are replicated, genotyping reliability is typically near 100 %; however, genotyping repeatability decreases as the amount of replication increases  <cit> . as sequencing costs decrease and we continue perfecting ngs methods, sequencing each sample from two independent pcr reactions should become standard protocol  <cit> . to achieve > 90 % genotyping success, we recommend researchers use a greater minimum coverage threshold to calculate their amplicon pools . this increased threshold accounts for both the loss of data during processing and for differing amplicon efficiencies.

additionally, genotyping larger numbers of samples at greater depth can create unforeseen difficulties with the allele-calling workflow. for example, when samples are deep sequenced, some amplicons may be sequenced at such depth that even artifacts occur at great enough frequency to be classified as alleles using published allele-calling workflows  <cit> . in these cases, all amplicons variants are classified as alleles. to avoid this error, researchers should begin with an idea of copy number variation of mhc-drb genes present in the study species and verify all genotypes using replication. previous researchers have focused on low amplicons coverage impeding successful genotyping; however, as the quantity of data generated increases, we will likely discover new issues arising from greater sequence coverage of individuals.

our final verification of genotypes, using known offspring-parent trios, identified another known pitfall of pcr-based sequencing – allelic dropout, which occurs when alleles are not detected in individuals that biologically possess them because of differences in allele amplification efficiency  <cit> . we suggest that the mismatches we detected between parent and offspring genotypes resulted from allelic dropout. the  <dig> offspring in our population had been sired by seven different mothers, but only three fathers, and whereas the mothers produced additional offspring whose genotype could be matched to those of both parents, the three fathers sired only those offspring involved in the mismatches. we could therefore identify the fathers as the parent with an incorrect genotype owing to allelic dropout. alternative explanations include sample mislabeling, misidentification of parents, or mutation of alleles between the parent and offspring generations. sample mislabeling is unlikely because blood samples were collected and dna extracted at several time points and we checked all sample identification at each step. because replicates also failed to amplify the ‘missing’ alleles, amplicon mis-labeling or incorrect barcode assignment cannot explain the mismatches. we are confident in the parental attribution of the offspring because the putative parents were the only sexually mature adults present at the time of conception. lastly, the rate of mutation in mhc alleles between generations is low . thus, mutations cannot account for the spontaneous appearance of new alleles in multiple offspring. these same alleles exhibited low amplification efficiency in other individuals; thus allelic dropout is the most likely explanation for the parent-offspring genotype mismatches we observed and has been observed in other parent-offspring mhc genotypes  <cit> .

based on our sequencing results, it is clear that ring-tailed lemurs retain mhc diversity despite their endangered status and declining population  <cit> . the diversity at their mhc-drb loci is comparable to the diversity found in other primate species, both threatened  <cit>  and non-threatened . likewise, the low diversity at mhc-doa, mhc-dob, mhc-dpa, mhc-dqa, and mhc-dra genes in ring-tailed lemurs was similar to the few alleles found at mhc-dqa, mhc-dqb, and mhc-dra in mouse lemurs  <cit> . these latter genes are variably diverse in other non-human primates  <cit> . for instance, dp and dq loci are variable in humans and apes, but show only limited variation in new world monkeys and strepsirrhines  <cit> . in contrast to other mhc loci, particularly the drb locus, the dra locus exhibits low variation in humans  <cit> , but moderate polymorphism in macaques  <cit> . ring-tailed lemurs appear to have limited polymorphism at all of these loci, although sampling of additional individuals will be required to confirm these patterns. minimal diversity at other mhc class ii genes, combined with greater diversity at the mhc-drb, indicates that the mhc-drb gene is the most suitable candidate for investigating the fitness consequences of lemur genetic variation in future studies.

because we sequenced from dna rather than rna, we could not assess if all of the mhc alleles uncovered were expressed and functional. in spite of this limitation, no alleles possessed stop codons so we can presume functionality. our primers, however, amplified only 171 bp of exon  <dig>  although these 171 bp included the most variable region of the gene, the placement of the primers excluded any variation in the flanking regions of exon two, as well as variation in additional mhc-drb loci. therefore, we cannot assume that all lemur mhc-drb loci are equally functional or under equal selective pressure. we were also unable to specify which alleles were found at which mhc-drb copy. nevertheless, evidence of historical, positive selection on ring-tailed lemurs is shown by the nucleotide and aa diversity found in mhc-drb exon two, coupled with the high copy number, increased rate of nonsynonymous-to-synonymous substitutions, and better fit of codon-based models of selection that include positive selection. pathogens likely drive this selection, though sexual selection also may be important  <cit> . notably, we found the greatest between-sequence differences at the antigen binding sites. many of these aa differences alter the binding properties of the sequence. we suggest from this evidence that different mhc-drb molecules likely recognize different subsets of pathogens. evidence of functional diversity, both between alleles and within an individual, reflects the strength of selective pressure that is likely exerted by pathogens.

as further evidence of the importance of disease resistance to an individual’s fitness, lemur mhc-drb sequences show trans-species polymorphism, a phenomenon in which identical or nearly identical alleles are present in distantly related species . ring-tailed lemur alleles cluster with alleles from closely related genera, such as eulemur and hapalemur, but also with alleles from more distantly related malagasy primate taxa, like daubentoniidae and indriidae, which diverged from the lemuridae ~ <dig> mya and 24– <dig> mya, respectively  <cit> . because of these phylogenetic relationships, we suggest that balancing selection likely maintained these alleles throughout the strepsirrhine radiation. all lemur mhc-drb alleles, however, form a monophyletic group within the greater strepsirrhine tree, just as all strepsirrhine alleles form a monophyletic group within the primate mhc-drb tree. this pattern suggests that all lemur mhc-drb alleles evolved after the most recent common ancestor of lemurids arrived on madagascar  <cit> .

CONCLUSIONS
here, we highlight that ngs has the potential to alleviate many of the logistical and financial constraints that previously prevented genotyping large populations of non-model species at hypervariable loci like those genes in the mhc. as ngs genotyping becomes increasingly adopted by researchers, we will continue to discover new pitfalls to be avoided, especially when tackling the problem of distinguishing artifacts from true alleles. we suggest abandoning the use of absolute thresholds of sequence frequencies for distinguishing between alleles and artifacts. we also stress that each sample should be sequenced in duplicate and the replicates compared, preferably on a second run and if possible on a second platform to account for any run-specific or platform-specific errors. historically, genotyping problems have resulted from the lack of sufficient coverage. as the capacity for data generation increases from tens of reads per sample to thousands or tens of thousands of reads per sample, this problem is no longer the primary limitation. indeed, ‘ultra-deep’ sequencing gives rise to a new set of problems that require additional steps of error detection. given the rapid expansion of these technologies and their increasing usage, studies such as the one presented here are critical to the transition from  <dig> sequencing to other ngs technologies.

additional file
additional file 1: supplementary materials  <cit> . 

 competing interests

the authors declare that they have no competing interests.

authors’ contributions

cmd initiated the overall study, participated in study design as well as sample collection, and critically revised draft versions of the manuscript. keg participated in study design and sample collection, performed the mhc-drb molecular work, ngs data processing, and statistical analyses, and drafted the manuscript. gjm performed all cloning and data analysis related to the additional mhc genes sequenced. mls and fpc coordinated and collected the wild samples from madagascar, and revised portions of the manuscript. all authors approved the final version of the manuscript.

funding was provided by the national science foundation , the margot marsh biodiversity foundation , the duke primate genomics initiative , duke university , the university of colorado , the university of north dakota , nd epscor , primate conservation inc. , the international primatological society , the american society of primatologists , and the st. louis zoo . we would like to thank the staff of the duke genome sequencing & analysis core, the unc microbiome core, the dlc, and the census team at bmsr for their help, as well as the indianapolis and cincinnati zoos for providing samples. we would also like to thank m. charpentier, j. horvath, and m. boulet for their expertise, as well as the many veterinary and field assistants who contributed to sample collection in madagascar . we would like to thank gregory wray for his valuable feedback during the study and on this manuscript in particular, as well as two anonymous reviewers for their feedback. this manuscript is dlc publication # <dig> 
