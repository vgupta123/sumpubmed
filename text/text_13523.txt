BACKGROUND
flow cytometry  is increasingly moving to-wards automated methods to deal with the quantities of data generated by high throughput, high-content screening  <cit> . an appropriate, auto-mated data pre-processing pipeline, including automated gating and matching of corresponding cell populations across replicated or similar samples is important for the accuracy of downstream analysis. however, accurate automated gating of fcm data is complicated by asymmetric and overlapping cell populations, frequent outlier events, cell populations whose variance depend on their mean fluorescence intensity, and multiplicative errors in the fluorescence channels. all of these characteristics can influence the output of both manual and automated gating, and subsequent downstream analysis. data transformation plays an important role in mitigating some of these effects, both in manual and automated analysis setting. in a manual analysis setting, a transformation is typically chosen to facilitate cell population visualization for the purposes of gating. generally, a set of common transformation parameters are chosen across multiple samples to ensure that they are on a common scale and facilitate comparison. carefully chosen data transformations and corresponding parameters have been suggested to overcome some of the problems surrounding manual fcm analysis and gating  <cit> . data transformation plays an even more important role in an automated, high throughput setting since the scale and distribution of the transformed data can influence downstream analysis procedures. some automated gating methods include data transformation as part of the gating algorithm  <cit> . other methods function under the assumption that the data have been appropriately transformed prior to the gating step  <cit> . methods for inter-sample normalization in downstream preprocessing steps can allow for different data transformations per sample. by loosening the requirements of a common transformation across samples, we can explore the optimization of data transformations for automated gating. in such a setting, the impact of data transformation has received relatively little attention  <cit> . lo et al. propose the estimation of a generalized box-cox transformation embedded within a mixture modelling framework to simultaneously gate and transform skewed cell populations  <cit> . their approach works very well in practice, but fcm data are generally still subjected to a global transformation prior to automated gating. what is clear is that the choice of transformation is data-driven and involves multiple considerations. the underpinning principle is to choose a transformation that facilitates cell population gating, visualization, and inter-sample comparison, by obtaining a representation wherein cell populations are well resolved across the full range of the data  <cit> .

there are many transformations in common use for flow cytometry data, including the logarithm and related transformations such as the linear-logarithmic and hyperlog transforms, power transformations such as the generalized box-cox, which includes the logarithm as a special case, and the biexponential and related transformations such as the logicle and generalized arcsinh  <cit> . the log transformation can often stabilize the variance of cell populations in the fluorescence channels across nearly the full range of intensities but cannot represent negative data values of unstained cell populations, leading to compression of data against the axes and poor visual representation of low intensity or unstained populations  <cit> . to deal with this, other transformations have been suggested, including the linear-logarithmic  transformation, the biexponential , and generalized arcsinh transformations. these all improve upon the log by allowing negative values, providing a linear representation of data around zero and a logarithmic representation of the data at higher intensity values, with a smooth transition between the two extremes. the hyperlog has been proposed specifically for compensated data and is also capable of dealing with non-positive values  <cit> . the biexponential transform provides additional flexibility by allowing the linear portion of the scale to be asymmetric around zero; the logarithmic scale can similarly be tuned by adjustable parameters. the generalized box-cox has been adapted and applied to fcm data in the context of automated gating within a multivariate-t mixture modelling framework  <cit> . lo et al. proposed to select the generalized box-cox transformation parameter maximizing the likelihood of individual cell populations being generated by a mixture of multivariate-t or multivariate-normal distributions on the transformed scale  <cit> . all of these transformations have one or more parameters  that can be adjusted in a data-dependent manner to modify the representation of the data. we perform our analysis within the flowcore framework in bioconductor, which is the predominant tool set in use for automated, high throughput flow data analysis. the default parameters of the transformations within flowcore are rarely adjusted in practice, and are almost certainly not the best possible parameter choices for all data sets. here we examine the impact of the chosen transformation and its parameters upon the accuracy of automated gating as well as the ability to match gated cell populations across samples.

we make several important comments about notation. in this paper we refer frequently to transformations and inverse transformations. mathematically, a function and its inverse are denoted f and f - <dig>  respectively. however, in fcm data, the biexponential transformation is actually the inverse of f = a exp) - c exp) + f, where f is the biexponential function. for clarity of exposition, in this paper, we will refer to the biexponential transformation as f - <dig> above, and the inverse-biexponential transformation as f, above. although counter-intuitive to the mathematical definition of the biexponential function, this nomenclature is accepted in the fcm community  <cit> . the notation in table  <dig> is in accordance with this nomenclature.

summary of transformations for flow cytometry. the transformations examined in this study, together with their inverses, jacobians and parameter restrictions. f is the transformation function typicallly applied to untransformed flow cytometry data, y, whereas f- <dig> is its inverse. for the biexponential, the transformation f has no closed form and must be solved numerically. consequently, the jacobian of the biexponential transformation is given by the reciprocal of the jacobian of the inverse transformation, and therefore depends directly on the transformed data, x. sgn is the signum function, also known as the sign function, which extracts the sign of a real number.

methods
parameter estimation
we use maximum likelihood methods to estimate the parameters of each transformation  following established methods  <cit> . if y is an n × d data matrix, we represent the data as a sequence of n d-dimensional vectors yi ={yi,  <dig> ..., yi, d} and the transformed data as yi=f, where f is the transformation function, and θ is the vector of transformation parameters. for simplicity we model the transformed data by a multivariate normal distribution y ~ nd. the likelihood of the parameters, given the data and a fixed θ is   

where jθ=|∂,…,yi,d)∂| is the jacobian term that accounts for the change of scale under different transformation parameters. it follows that for a fixed θ, the mean and covariance of the transformed data can be estimated by the sample mean and sample covariance, as follows,

 μ^=1n∑i=1nyi=y¯Σ^=1n∑i−y¯)−y¯)t 

now we can substitute these two expressions into  and maximize over θ after some simple algebra, it can be shown that it is equivalent to minimizing:

 s=|))t/n−¯)¯)t)|g 

where g=2)1/n is the geometric mean of the squared jacobian terms. thus explicit derivation of the functions to be minimized for each transformation, s, only involve deriving the jacobian of the transformation. these transformations, their inverses, and their jacobians are summarized in table  <dig>  and presented in additional file  <dig> with common parameter values. when no closed form exists, we use numerical optimization routines in r to optimize  over θ  <cit> . we note that the translation parameter is fixed at f =  <dig> in the biexponential transformation in order to resolve identifiability issues with the full parameterization . the decision to model the transformed data as a multivariate gaussian distribution is motivated by the implicit assumption of a common error model across all cells when performing a global data transformation. we note that the form of this implicit error model is not known. the multivariate gaussian assumption is strictly a computationally convenient choice that has the effect of making the marginal distribution of the data more symmetric and reducing the influence of outliers at the subsequent gating step. for the purposes of gating, however, flow cytometry data is better represented as a mixture of distributions, which is done explicitly by flowclust and flowmerge.

follicular lymphoma data set
we examined a subset of a clinical fcm data set derived from lymph node biopsies from  <dig> individuals diagnosed with follicular lymphoma. each sample was five-dimensional, labeled with cd <dig>  cd <dig>  and cd <dig>  in addition to the fsc  and ssc  channels. the ten individuals sampled consisted of five males and five females, of median age  <dig>  years, . five individuals had stage  <dig> disease, three had stage  <dig> disease, and two had stage  <dig> disease. overall survival for the group ranged from  <dig>  years to  <dig>  years.

evaluating the suitability of a data transformation
to evaluate the performance of different transformations, we measured the variation in the location of cell populations identified by automated gating using the flowclust/flowmerge frameworks  <cit> . the variation in the position of gated cell populations was measured across biological replicates, and compared for each transformation.

the fsc and ssc channels were analyzed separately from the fluorescence channels, according to procedures established elsewhere  <cit> . data was normalized on the scale on which it would be visualized, therefore the scatter channels were normalized prior to transformation, whereas the fluorescence channels were normalized after data transformation   <cit> . in the scatter channels, parameter-optimized transformations  were compared against default-parameter counterparts , as well as the standard procedure of no transformation . for fluorescence channels, default and optimized parameter transformation were compared against together with the log transformation . populations in the scatter and fluorescence channels were automatically gated using the flowclust and flowmerge framework  <cit> . these discovered populations were metaclustered, and intracluster variability was compared either on the transformed scale , or on the original scale .

cell population identification, metaclustering and metrics
automated gating was performed using the flowclust and flowmerge packages in bioconductor  <cit> . lymphocyte cell populations were identified manually from among the gated populations, and corresponded to the most dense clusters of cells in the fsc vs ssc dimensions. we evaluated the performance of each transformation by examining the variation in the position of the lymphocyte cell populations across biological replicates. the variation was measured as the sum of squared deviations from the mean lymphocyte cell population position across the samples. cell populations identified in the fluorescence channels by automated gating were matched across samples using a metaclustering approach. this involved a modified single linkage agglomerative clustering approach to group corresponding populations across samples  <cit> . we provide an informal description of the algorithm, followed by a formal definition. informally, we assume that cell populations in each sample are unique, therefore no more than one population from a sample can belong to a metacluster. we choose the sample with the largest number of cell populations and assign each population to unique metacluster. we then iterate through each cell population in the remaining samples and assign it to its nearest metacluster , with the restriction that no more than one cell population from a sample may belong to the same metacluster.

more formally, we let s = {s <dig>  . . , sn, . . , sn } be the set of all samples, indexed by n. following automated gating, a sample is clustered into some number, πn, of discovered cell populations. we let pn={p1n,..,pin,..,pπnn} be the set of discovered cell populations within the nth sample, such that the cardinality of pn is |pn| = πn. on the transformed scale, each discovered cell population is summarized by a multivariate-t distribution. the parameters of the multivariate-t distribution representing the ith cell population from the nth sample are μin, the d-dimensional vector of means, Σin, the d × d covariance matrix, and νin, the degrees of freedom, as defined in lo et. al.  <cit> .

the set of metaclusters is denoted ℳ = {m <dig>  m <dig>  ..., mk}. each metacluster is itself a set of populations with the constraint that no metacluster can contain more than one population from a given sample. for each population, pin, we define a label lin which can take a value between  <dig> and k, where k = maxn. if lin = k, population pin belongs to metacluster k. additionally the distance between a metacluster mk and a population pjm is denoted d=min{i,n|lin=k}, which is the minimum distance between population pjm and all populations that are already assigned to metacluster k. to enforce the one sample per metacluster constraint we set d=∞ if lim=k for some m. we define the distance between population i in the nth sample and population j in the mth sample as d=tΣin− <dig>  which is the mahalanobis distance, assuming that the first argument  is a population assigned to metacluster k  <cit> .

to construct the metaclusters we:

 <dig>  set the number of metaclusters to k = maxn

 <dig>  initialize the metaclusters with the k populations from sample sn <dig> where n <dig> = arg maxn. if there is more than one such sample, pick the one with the best likelihood or best separation of clusters .

 <dig>  let =argmin{j,n,k}d, assign pjn to metacluster k.

 <dig>  repeat until each population is assigned to a metacluster.

simulation study
to further test our algorithm, we simulated ten data sets of n =  <dig> events in three-dimensions from nine cell populations modeled as a multivariate-t mixture distribution with four degrees of freedom, following the approach of lo et al., and fixed proportions drawn from a dirichlet distribution with parameter α =   <cit> . the population proportions were,

  p= 

eight cell populations were distributed in three dimensional space at the eight corners of a cube, with one cell population located in the center of the cube . real fcm data frequently contain one cell population that has higher density than the other cell populations in the mixture. we simulated this characteristic of fcm data by as-signing higher weight to the central population in our simulated data and it is reflected in the parameters of the dirichlet. simulated cell population locations ranged from zero to seven in arbitrary units, and corresponding populations has variance σ <dig> =  <dig>  across the ten data sets. the simulated data were transformed  by the inverse biexponential using different, randomly chosen transformation parameters for each sample  and {b, d} u), where {x, y} ~ u denotes that variables x and y are independently drawn from a uniform distribution over the interval . we applied our algorithm to this inverse-transformed data, optimizing transformation parameters for the generalized arcsinh, biexponential, generalized box-cox, and linlog transforms in order to recover y. we then compared the output of these transformations against the default-parameter versions of the biexponential and generalized arcsinh transforms, as well as the original untransformed data. to assess the performance of different transformations the data were normalized, gated using flowclust/flowmerge, and the discovered populations were clustered across data sets   <cit> . we then measured the resulting intra-metacluster variability as well as the misclassification rate for individual events in the discovered populations, relative to their true class membership   <cit> .

RESULTS
follicular lymphoma data
our approach to data analysis of fluorescence and scatter data differs slightly, in that scatter data are normalized prior to transformation, while fluorescence data are normalized post-transformation, in accordance with common practice . we examined the effects of parameter-optimized transformations compared to their default-parameter counterparts on visualization of cell populations in the scatter and fluorescence channels . for scatter channels, differences between parameter-optimized, default, and untransformed data are clearly visible . the optimized version of the biexponential, generalized arcsinh, and generalized box-cox, all provide improved visualization of cell populations than the default-parameter biexponential, generalized arcsinh, or the untransformed data. for the fluorescence channels, the data are put on a common scale following transformation , and distinct differences can be seen between the optimized and default transformations . populations are better resolved following some transformations than others. the optimized biexponential improves visualization of cell populations compared to the biexponential with default parameters, while there is no observable difference between the default and optimized generalized arcsinh transformation. other transformation show similarly variable results. although differences between optimized and default transformations are subtle under visual inspection, these subtleties can have significant effects on model fitting and model selection during automated gating if they lead to violations of model assumptions . for example, small deviations from symmetry in the shape of cell subpopulations can lead to selection of models with more components, more parameters, or different degrees of freedom, leading to different final gates.

to obtain a quantitative measure of the effect of different transformations on the automated analysis of real-world flow cytometry data, we proceeded to perform automated gating populations in the scatter and fluorescence channels, as described in the methods. we measured the variability between discovered populations by metaclustering them across samples, and measuring the intra-metacluster variability as the sum of squared deviations . there were minimal differences in the variability of the lymphocyte populations between different transformations applied to the scatter channels . the optimized generalized arcsinh and optimized generalized box-cox transformations had the lowest variation in metaclusters, performing better than the default generalized arcsinh, or the standard of no transformation. in contrast, larger differences in variability were observed between transformations for populations in the fluorescence channels . the optimized biexponential, optimized generalized box-cox, and default biexponential exhibited the lowest intra-metacluster variation, whereas the optimized linlog, log, and default generalized arcsinh exhibited the highest intra-metacluster variation. however, on the scale of the scatter data, it appears that the differences between transformations are not large.

the differences between lymphocyte metaclusters in the scatter dimensions are readily seen to be minimal when visualizing the metaclusters directly on the original scale . each metacluster contains all ten lymphocyte populations from the ten samples in the data set. similarly, metaclusters in the fluorescence channels are visualized directly on the transformed scale . the metaclusters of the primary cell populations in the samples are shown , represented as a series of bivariate projections for each transformation examined. interestingly, with the exception of the default biexponential transform, all metaclusters contain representative cell populations from all samples in the data set. additionally, the total number of metaclusters varies between transformations , indicating that the principal source of variation in the metaclustering is due to cell populations represented as outliers in the flowclust/flowmerge gating, rather than due differences in the well-defined, primary cell populations in the samples.

simulation
simulated data allows access to the "true" class memberships of individual events that are not available with real-world data, and can help to better understand the effects of transformation and parameter selection on automated gating. we again briefly describe our approach here. we simulated ten data sets, transforming each with the inverse of the biexponential transform using randomly chosen parameter values, as described in the methods . we then applied our algorithm to the inverse transformed data to estimate optimal parameters under different transformations and again transformed the inverse-transformed data using those estimated parameters and the appropriate transformation. the data output by this process, which should reflect the distribution of the original data, was subjected to automated gating. by comparing the true class membership of events in the original data against the class membership of events gated by flowclust/flowmerge, we computed the misclassification rate of the gating model under different optimized and default transformations . when the optimized transformation was of the same family as the inverse transformation  we observed misclassification rates comparable to the rates obtained for the untransformed data   . in contrast, the optimized generalized box-cox, optimized linlog, as well as the default generalized arcsinh and biexponential had considerably increased misclassification rates with higher variability across the simulated samples  . the poor performance of the optimized generalized box-cox is not surprising in this case, since the biexponential inverse-transformation applied to the data was quite different from the generalized box-cox transform. this demonstrates that optimization of the transformation parameters together with selection of an appropriate transformation can lead to significant improvements in model fitting during automated gating that compare favourably to results obtained for the untransformed data. furthermore, the estimated transformation parameters compare favourable with the true transformation parameters , demonstrating that our assumption of a global multivariate gaussian distribution is acceptable for the purpose of transformation.

following extraction of discovered cell populations and metaclustering, we observed the lowest intra-cluster variability for the optimized generalized arcsinh and optimized biexponential transformations, followed by the baseline of no data transformation, indicating that parameter optimization can reduce inter-sample variability and aid population matching . the largest inter-sample variability following meta-clustering was observed for the optimized generalized box-cox, default generalized arcsinh, and optimized linlog transformations . selected metaclusters obtained from default and parameter-optimized transformations demonstrate that parameter optimized transformations can lead to better population identification in the automated gating step, and consequently lower variability metaclusters .

software and availability
we have implemented parameter-optimization routines for the biexponential, linlog, generalized arcsinh, and generalized box-cox transformations in the r package, flowtrans. this package integrates with the existing fcm data analysis tools in bioconductor and uses existing data structures data manipulation paradigms from the flowcore framework  <cit> . the package is freely available at http://www.bioconductor.org/packages/release/bioc/html/flowtrans.html.

discussion
ideally, all cell subpopulations in an fcm sample would be well-separated to facilitate gating. in practice, this is rarely, if ever the case. real flow data typically consists of a mixture of complicated distributions that are asymmetric, frequently overlapping, with cell populations whose variances are dependent on their mean fluorescence intensities. a variety of automated gating algorithms have been proposed to identify distinct cell sub-populations  <cit> . most of these automated approaches function under the assumption that the data has been transformed prior to the automated gating step. others even include data transformation as part of the gating procedure  <cit> . the global data transformation step treats all cells and cell subpopulations equally, and hides an implicit assumption of a common error model across all cells and cell subpopulations. the problem is that we do not know what the correct error model is for fcm data, and so it is simply ignored. in this paper, our approach to parameter optimization attempts to make this assumption more explicit. we assume that, on the transformed scale, the global data distribution can be approximated by a multivariate gaussian distribution. although the data are clearly not multivariate normal, as typical fcm data are multimodal and best represent by a mixture model, we transform the data towards normality to make the distribution more symmetric, mitigate the impact of outliers, and to have an objective criterion to use for estimating transformation parameters. our simulation study shows that our assumption of a common gaussian distribution allows us to obtain reasonable estimates of the optimal transformation parameters even when the gaussian assumption is violated. only subsequently do we take on the task accurately modelling the data using a model-based automated gating algorithm. we leave the work of fitting a mixture model to resulting transformed data to the automated gating algorithm.

we have examined the impact of the choice of transformation and its corresponding parameters on the automated gating procedure. transforming the data towards normality reduces the influence of outlier events and our simulations have shown that optimizing transformation parameters in this way can improve gating and cell subpopulation discovery when compared to applying a naive transformation with default parameter values. optimization of the parameters leads to lower misclassification rates, improved cell population identification, lower inter-sample variability and fewer outliers than blindly applying default transformation parameters. in our simulations, data were transformed with the biexponential function using randomly chosen parameters. only parameter-optimized transformations from the same family  regenerated a data distribution similar to the untransformed data, as exhibited by comparable gating misclassification rates . the optimized linlog and generalized box-cox transformations did not have the flexibility to transform the data back to the original distribution, leading to biases in the automated gating step. although the differences in misclassification rate are only a few percent, they could introduce significant variation on downstream analysis, especially in large-sample situations, where many data sets need to be analyzed in an automated manner.

our analysis of a subset of real-world flow cytometry data set derived from lymph node biopsies of individuals with follicular lymphoma demonstrated similar results to those obtained using simulated data. optimizing transformation parameters in order to make the transformed fcm data more normal-like can improve data visualization and cell subpopulation identification in certain cases. however the improvement in performance is data- dependent, and it is unclear how to determine in advance which samples benefit from such an approach as compared to applying a standard fcm transformation. addressing this problem is the subject of future work. in the cases examined in this study, transformation of the scatter dimensions via a parameter-optimized generalized arcsinh or biexponential transformation generally improves cell subpopulation visualization . therefore, in situations where scatter data are to be gated manually we argue in favour of such an approach. however, we note that under an automated gating scheme, the differences between transformations are marginal on the scale of the data, and the benefits are minimal, particularly when fsc and ssc cell populations are well defined. this is in accordance with what is typically seen in fcm data analysis  <cit> .

cell subpopulation identification in the fluorescence channels benefits more from parameter- optimized transformation than in the scatter channels. however, again the choice of transformation is data-dependent. while the greatest improvement in metacluster variability was observed for the parameter-optimized generalized arcsinh transformation in the case of scatter channels, here the greatest improvement is observed for the parameter-optimized biexponential transformation and parameter-optimized generalized box-cox transformation. the intra-metacluster variation for these transforms is lower than for the log transformation, but only marginally lower than for the default- parameter biexponential transformation. despite this, closer examination of the metaclusters generated from the default biexponential transformed data shows that one of the cd3-/cd5+/cd19+ cell subpopulations was not captured by the cd3-/cd5+/cd19+ metacluster. additionally, the default biexponential transformed data leads to seven metaclusters, compared to six metaclusters obtained for the optimized biexponential transformed data. these additional metaclusters capture outlier cell populations which are not of interest in this particular experiment. in general, the metaclusters representing the primary cell subpopulations in this data all capture representatives from each of the ten samples. the predominant source of intra-metacluster variability is derived from the metaclusters corresponding to outlier cell populations. therefore, in situations where an automated gating and analysis approach is undertaken, we recommend applying a parameter-optimized data transformation such as the optimized biexponential, rather than the default biexponential, since it has the potential to improve cell subpopulation discovery and matching across multiple samples. this is likely to be a greater concern in large-sample situations than when a small number of samples are to be analyzed manually.

our metaclustering approach has been designed to work specifically for data gated using the flowclust/flowmerge algorithms. the constraint limiting each metacluster to one cell population per sample is predicated on the assumption that the gating algorithm  represents each distinct cell population by a unique mixture component. generally speaking, this is a safe assumption in the case of the flowmerge algorithm, which has been designed to identify and represent distinct cell populations by unique mixture components  <cit> . however, the metaclustering algorithm would have to be modified if the gating algorithm were changed.

we explored alternative approaches to parameter estimation that included preselection of a sub-population of events and optimizing transformation parameters with respect to the subpopulation. how-ever, this approach proved ineffective, since preselection effectively removed outlier events. it is these outliers that cause problems for downstream automated gating approaches, and thus should be considered in the transformation step. the decision to transform the data towards a multivariate gaussian distribution is supported by our ability to accurately recover the true transformation parameters in our simulation study, even though the original data distribution is clearly derived from a multivariate mixture model. our approach could be extended in a number of ways analogous to flowclust, either by embedding the transformations within the gating step, thus selecting transformation parameters maximize the likelihood of a k-component mixture rather than a single component density, or by modelling the data with a more robust distribution such as the multivariate-t. this approach could have the benefit of generating less variable parameter estimates, though likely at the expense of computation time.

CONCLUSIONS
although the idea of optimizing transformations for fcm data is not new, to date, there has been no systematic comparison of fcm data transformations examining their performance in an automated data analysis setting  <cit> . we have developed criteria for optimizing the parameters of transformations commonly used for preprocessing and visualization of fcm data, designed to transform the data towards a more multivariate normal and symmetric global data distribution. we have shown that these parameter-optimized transformations can improve data visualization, population discovery, and metaclustering, relative to their default-parameter counterparts in certain sample-specific cases. parameter optimization of the generalized box-cox transform has been previously implemented within an automated gating framework implementing a mixture modelling approach   <cit> . while it would be of interest to implement a similar strategy for the other commonly used flow cytometry data transformations, our goal here has been to examine the influence of global transformation on the automated gating step of high throughput fcm analysis. our software allows the user to quickly examine the effects of different parameter-optimized transformations on the data, and defer the computation-intensive gating step to downstream analysis. our findings showed that the optimized generalized arcsinh transformation had the lowest intra-sample variability between populations for the scatter channels. however, substantive differences in variation were subtle and rare across the different transformations in the scatter channels. in contrast, the optimized biexponential transform had the lowest variability for the fluorescence channels. this transformation is in accordance with current best practices. therefore we would recommend, in the absence of additional knowledge to suggest a given data transformation, the parameter-optimized versions of the biexponential transform for fluorescence channel data, over the default-parameter counterpart. in situations where many samples need to be processed in an automated manner, the parameter-optimized generalized arcsinh may be a better choice over the current standard practice of not transforming the scatter data, thus reaping the benefits of occasional improvements in the automated gating step. due to its simplicity, our optimization algorithm could be readily implemented in other widely available tools such as flowjo and winlist, and indeed, efforts are currently underway to tie flowjo more closely to the r computing environment  <cit> .

authors' contributions
gf designed experiments, performed analysis, and contributed to manuscript preparation. rg designed experiments and contributed to manuscript preparation. jmp contributed to manuscript preparation. aw contributed the clinical fcm data.

supplementary material
additional file 1
examples of common transformations with typical parameters. examples of the generalized box-cox , linlog , biexponential , and generalized arcsinh  transformations using common parameter values. the chosen parameters are selected from an optimized fit of each transformation to fsc vs ssc follicular lymphoma data.

click here for file

 additional file 2
the biexponential transformation is weakly identifiable. the biexponential transformation with full parameterization is weakly identifiable. a) a bivariate normal distribution on the original scale. b) original data transformed with the inverse-biexponential using parameters a =  <dig>  b =  <dig>  c =  <dig>  d =  <dig> 10- <dig>  f =  <dig>  w =  <dig>  c) inverse-transformed data transformed with the biexponential using the true parameters a = 1; b =  <dig>  c =  <dig>  d =  <dig> × 10- <dig>  f =  <dig>  w =  <dig>  d) inverse-transformed data transformed with the biexponential using alternate parameters c' =  <dig> × 10- <dig>  d' =  <dig> × 10- <dig>  f' = - <dig>  when parameters c' and d' are near zero, if f' ≈ c and d' is near zero, the two transformations are virtually indistinguishable.

click here for file

 additional file 3
residuals of estimated biexponential parameters. boxplots showing the difference between true and estimated biexponential parameters on ten simulated data sets. although the optimized estimates are variable for parameters b, d, the misclassification rates of fitted models demonstrate that this bias doesn't negatively impact the subsequent gating.

click here for file

 acknowledgements
the authors wish to acknowledge the help of dr. randy gascoyne and ryan brinkman for providing the lymphoma data set. this work was funded by a cihr bridge funding, nih grant r01-eb <dig> and an establishment grant from the fonds de la recherche en santé du quebec . we thank drs. thomas lumley and ryan brinkman for their feedback during manuscript preparation. we also sincerely thank the reviewers for their comments and suggestions towards improving the manuscript.
