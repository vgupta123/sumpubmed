BACKGROUND
it is now well established that eukaryotic genome dynamics and 3d architecture have a fundamental role in the regulation of nuclear functions such as dna replication and gene transcription . at small scale , the crystal structure of the nucleosome core particle  was determined  <dig> years ago  <cit> . at the scale of the nucleus, fluorescence imaging revealed the dominant structural organisation of the genome into chromosome territories reflecting a non-mixing compartmentalisation of the chromosomes  <cit> . however, until the emergence of chromatin conformation capture  technologies  <cit> , our knowledge of the structural organisation of dna at the intermediary scales remained partial. high-throughput 3c protocol  has opened new perspectives in the study of these intermediary structures genome-wide in higher eukaryotes, closing the gap between the atomic and chromosomal resolutions . hi-c technique relies on high-throughput sequencing and allows to semi-quantitatively measure the co-localisation frequencies of all pairs of genomic loci . inter-chromosome co-localisation frequencies are lower than intra-chromosome frequencies, following the nuclear organisation into chromosome territories  <cit> . mean intra-chromosome frequencies decrease with the genomic distance as expected for a polymer  <cit> . changes in the decreasing rate reflect the modifications of the global chromosome structure like the chromosome condensation observed during entry in metaphase  <cit> . nevertheless hi-c data also put into light a structural compartmentalisation of the genome at different scales that cannot be explained by simple homogeneous polymer models  <cit> . principal component analysis of the correlation matrix between the co-localisation frequency profiles of each locus revealed the existence of two nuclear compartments, loci preferentially co-localising with other loci from the same compartment: compartment a is associated with gene rich and early replicating regions and compartment b with gene poor and late replicating regions  <cit> . projected on the genome, this classification describes the chromosomes as the succession of a/b domains of length ∼ <dig> mb. inspection of intra-chromosomal co-localisation frequency matrices reveals a finer structuring level characterised by diagonal blocks of length ∼ <dig> − <dig> mb: co-localisation frequency is high between regions of the same block but weaker between regions belonging to different blocks  <cit>  . these blocks, named topologically associating domains , underline a structural compartmentalisation of chromosomes whose link with genome functional organisation and dynamics is the subject of intense research activity . in order to carry out this research, methods allowing to objectively delineate structural domains from hi-c data have been developed . most of these approaches look for structural domains that are intervals of the chromosomes. for example, chromosome structural partition was achieved using  1d signals quantifying the balance between the co-localisation frequencies of the locus of interest with upstream and downstream loci   <cit> ,  dynamic programming algorithms that also explicitly model structural domains as chromosome intervals  <cit>  and  projecting on the genome the bisection obtained from a graph representation of the hi-c data   <cit> . as illustrated in fig.  <dig>  chromosome structural organisation can involve nested structures over a large range of scales  <cit> . however only the method proposed in  <cit>  explicitly includes the possibility to identify chromosome structural domains at diverse scales of observation and the method in  <cit>  to hierarchically merge adjacent tads into metatads.
fig.  <dig> hi-c co-localisation maps reveal a multi-scale structural organisation. hi-c co-localisation frequency matrices along a  <dig> mb fragment of human chromosome  <dig> in h <dig> es  under  the diagonal with intensity of interactions colour coded according to colour map on the right. blue lines represent tads  <cit>  in the two cell lines. coloured dashed lines correspond to  <dig> partitions into communities obtained at small  and large  scales. columns and rows in black correspond to masked regions 




here we propose a novel method to analyse hi-c data that allows a multi-scale identification of structural domains. because it does not rely on the specific assembly of the reference genome, this method does not look for structural domains limited to chromosome intervals thereby relaxing our preconception about the nature of structural domains. moreover, due to polymorphisms within a species or to chromosome rearrangements characteristic of cancer cells  <cit> , the assembly of the reference genome does not necessarily corresponds to the true assembly for a cell line under investigation. in these situations, reduced sensitivity to genome assembly is likely to avoid erroneous structural domain predictions. a hi-c co-localisation frequency matrix is positive and symmetric, it can thus be interpreted as the adjacency matrix of the genome interaction network where the nodes are the chromosome loci  and the edges reflect the co-localisation frequency between these regions. this justifies the use of concepts and tools from graph theory to analyse hi-c data . this representation depends on genome assembly only up to the scale used to define the hi-c matrix, the columns/rows of the hi-c matrix can be permuted without affecting the output of graph algorithms. in graph theory, a set of nodes that share more connections between themselves than with the rest of the graph is called a community  <cit> . hence we reformulate the question of structural domain mining as a search for community in the hi-c interaction network. note that markov graph clustering was already experienced to delineate sub-segments within large a/b-like chromosomal domains obtained in a first step  <cit>  and that extensions of graph stochastic block models were also applied to hi-c matrices of human chromosome  <dig> and a segment of human chromosome  <dig>  <cit> . in order not to privilege any particular scale in the analysis, we performed the multi-scale partitioning of the full intra-chromosomal interaction networks into structural communities using a multi-scale community mining algorithm based on graph wavelets  <cit> .

methods
chromatin conformation capture data and topologically associating domains
here we used hi-c data obtained in different human cell lines: 
embryonic stem cell line h <dig>  and foetal lung fibroblast cell line imr <dig> hi-c data for which tads are available  <cit> , allowing a direct comparison of our structural communities with what is considered as reference structural domains in the literature. hi-c matrices at resolution  <dig> kb and  <dig> kb for two replicates in each cell lines as well as tads predictions in these cell lines were downloaded from the geo database under accession number gse <dig>  these data are based on the hg <dig> assembly version of the human genome.

myelogenous leukemia cell line k <dig> and lymphoblastoid cell line gm <dig> hi-c data  <cit>  for the analysis of the structural conservation between cell lines. hi-c matrices at resolution  <dig> kb for the two cell lines were downloaded from the geo database under accession number gse <dig>  these matrices are based on the hg <dig> assembly version of the human genome.

cervical cancer cell line helas <dig> hi-c data  <cit>  where the hi-c experiments were performed on synchronised cells during mitosis and g <dig> allowing a study of the community structure during the cell cycle. the hi-c reads alignment files to the human genome  for the two stages of the cell cycle were downloaded from the arrayexpress database under accession number e-mtab- <dig> 




hi-c intra-chromosomal co-localisation frequency matrices for non-overlapping  <dig> kb loci correspond to the downloaded matrices that were down-sampled to  <dig> kb when necessary or were constructed from the alignment files . unexpectedly low and unexpectedly high interacting loci that are likely to introduce noise were removed . the remaining  <dig> kb loci were concatenated resulting in new masked positions.

we compared the structural-communities described in this work to the tads  <cit>  that are considered as a reference for the structural description of hi-c data. tads were identified in h <dig> es and imr <dig> cell lines at both  <dig> and  <dig> kb resolutions  <cit> . given our adopted resolution of  <dig> kb, we used the tads dataset obtained at the  <dig> kb resolution, and we assigned each tad border to the corresponding  <dig> kb pixel keeping only tads larger than  <dig> kb . this led to a database of  <dig>  <dig>  tads in h <dig> es , with  <dig>  <dig>  distincts borders in h <dig> es .

in this work one focus is to question the existence of a tad-like structuration of the human genome in the intermediary scale range from the described tad typical size up to the chromosome length. a second objective is to address the possible conservation of these structural motifs across cell lines. this led us to include the k <dig> and gm <dig> datasets from the original hi-c study  <cit> . these datasets are less resolutive than more recent ones in imr <dig> and h <dig> es cell lines  <cit>  due to a limited sequencing depth and were analysed at best at  <dig> kb resolution by the original authors. this explains why we chose  <dig> kb as the resolution for all the analysis presented in our manuscript. however to check whether lower or higher resolution has significant impact on the results, the imr <dig> dataset was also analysed at resolutions  <dig> and  <dig> kb.

multi-scale community mining using graph wavelets
we used the multi-scale community mining algorithm based on spectral graph wavelets that we previously described and benchmarked against two other multi-scale community mining methods from the literature  <cit> . the purpose of detecting communities at different scales using graph wavelets instead of, say, cutting a hierarchical clustering at different levels, is to fit as close to the data as possible. cutting a hierarchical clustering impose a hierarchical structure to the set of community obtained at the different scales . when using wavelets, we do not suppose beforehand that the data have a hierarchical structure: a community at a coarse scale does not necessarily have to contain communities found at a finer scale.

our community mining algorithm  <cit>  relies on the precise construction of graph wavelets in order to introduce the notion of scale  <cit>  . a graph wavelet centred on a node a is a function on the nodes of the graph whose values capture the proximity of each node to node a given a scale s of observation. as such, the set of graph wavelets at scale s characterise the local graph structure around each node over a “distance” controlled by the scale parameter s, as illustrated in additional file 1: figures s <dig> and s <dig>  at a fixed scale, the similarity between the neighbourhood of  <dig> nodes  can be quantified as the correlation , additional file 1: equation ) between the wavelets centred on each of the two nodes at that scale. computing the correlation distance d=1−c ) between all pairs of nodes results in a distance matrix capturing the similarity of node neighbourhood, which can in turn be used as the input of a hierarchical clustering algorithm in order to partition the nodes into communities for the scale of observation s . to sum up, at each scale and for each intra-chromosomal interaction network, the community mining algorithm amounts to  compute the matrix of correlation distance d,  apply average-linkage hierarchical clustering  <cit> , and  finally cut the resulting dendrogram following the method prescribed in  <cit> . this results in a set of structural communities for a given scale and a given chromosome.

we used the fast implementation of this procedure  <cit> . on the one hand, the graph wavelet transform is computed using the fast algorithm proposed in  <cit>  ). on the other hand, instead of computing the wavelets on the n nodes of the graph which requires n wavelet transforms of dirac functions  n times), the matrix of correlations between wavelets at scale s is approximated by the correlation between η  wavelet transforms of random gaussian functions on the graph . importantly, the fast implementation of our multi-scale community mining protocol is applicable to large networks with ≳ <dig> nodes  <cit> , allowing to consider its future application to intra-chromosomal interaction networks at high resolution  in mammals  <cit>  but also to full genome interaction networks at the resolution used in the present work . note that graph spectral clustering can also be considered for these large interaction network settings thanks to recent algorithmic developments  <cit> .

comparing sets of genomic domains
as discussed in results and discussion, communities within intra-chromosomal interaction networks can be described in terms of genomic intervals i.e. sets of loci that form contiguous genomic domains and can thus be fully described by their two extreme positions, called domain borders. we adopted the three following points of view for the comparison of sets of genomic domains  of different origins. note that because the sets of domains of interest here do not form partitions of the genome, we could not adopt the classical measures of similarity between partitions like mutual information and adjusted rand index. given two sets of domains d <dig> and d <dig> with two sets of associated borders ℬ <dig> and ℬ <dig> respectively, we used the following estimators: 
mean best mutual coverage: we define the mutual coverage m
c between two domains d1∈d <dig> and d2∈d <dig> as their intersection length ld1∩d <dig> divided by the maximum length of the two domain lengths ld <dig> and ld2: mc=ld1∩d2/max.

the maximal value  <dig> of m
c is obtained when the two domains d
 <dig> and d
 <dig> are identical. then, for each domain d1∈d <dig>  we define its best mutual coverage with d <dig> domains  as its maximal mutual coverage with d <dig> domains: bmcd2=maxd2∈d2


). sorting the d <dig> domains by size, we compute the mean best mutual coverage with d <dig> of groups of  <dig> d <dig> domains that we plot as a function of the mean length of the domains in the group. this results in an average mean best mutual coverage curve between domains in d <dig> and d <dig> as a function of d <dig> domain size.

we say that a domain d has a match in d <dig> if bmcd2≥ <dig> . pd <dig> is then defined as the proportion of domains d∈d that have a match in d <dig>  sorting the d <dig> domains by size, we consider them in groups d of  <dig> domains and plot pd <dig> as a function of the mean length of the domains in d. this results in a matching proportion curve of domains in d <dig> and d <dig> as a function of d <dig> domain size.

we say that a border b has a match in ℬ <dig> when there is a border in ℬ <dig> less than  <dig> kb away from b
i.e ±  <dig> pixel away. pℬ <dig> is then defined as the proportion of borders b∈ℬ that have a match in ℬ <dig>  sorting the ℬ <dig> borders according to their associated lengths , we consider them in groups ℬ of  <dig> borders and plot pℬ <dig> as a function of the average associated length of the borders in ℬ. this results in a matching proportion curve of borders in ℬ <dig> and ℬ <dig> as a function of ℬ <dig> border associated length.




domain length is an intuitive quantity to order a set of domains. in the same manner, we associated a length with each border of the genomic domains used in this work. tad borders can be shared by at most  <dig> consecutive tads, so we associated them with the length of the shortest tad they border. at a fixed scale of analysis, a border of the novel interval-communities  delimits two consecutive interval-communities, so  we associated it with the minimum length of the two bordering communities. however these borders also present a strong pattern of conservation from one scale to another , so the largest of these lengths across the scales was retained as the final length associated with an interval-community border. in this way, border associated lengths allowed us to sort borders according to the importance  of the corresponding chromosome structures.
fig.  <dig> multi-scale interval-communities. multi-scale community structure along a  <dig> mb long fragment of human chromosome  <dig> in imr <dig>  and h <dig> es  cell lines. most  communities reduce to genomic intervals , here we only represent these interval-communities. at each scale they are represented by colouring the segment from their masked start to masked end positions which are marked by grey crosses . colours were limited to  <dig> for readability. when a community is found at  <dig> consecutive scales the same color is used




RESULTS
wavelet-based community detection in the dna interaction network
as discussed above, hi-c data can be represented as graphs where nodes represent dna loci and the edges connect interacting loci, allowing us to reformulate the question of finding structural domains as a question of finding communities in the dna interaction network. we used the fast implementation of the wavelet-based multi-scale community mining algorithm  with η= <dig> random gaussian functions to estimate the distance correlation matrix. for each hi-c dataset, we considered the  <dig> autosomes’ intra-chromosomal interaction networks constructed for non-overlapping  <dig> kb loci . we systematically applied the wavelet-based multi-scale community detection method to all the connected interaction networks scanning  <dig> scales logarithmically distributed in the range of available scales )  <cit> . the average total running time per cell line was  <dig> h  <dig> mn using matlab on a linux computing desktop with  <dig> xeon cpu at  <dig>  ghz. we first discuss the results obtained for human chromosome  <dig> in h <dig> es and imr <dig> cell lines as representative examples of the results obtained for all intra-chromosomal interaction networks. chromosome  <dig> network initially contains  <dig>  <dig> nodes. after the filtering procedure,  <dig>  <dig> nodes are left in imr <dig> and  <dig>  <dig> in h <dig> es . when applying the wavelet-based community detection method separately on the two interaction networks, we obtained  <dig> partitions of the masked genome for each cell line, one at each scale. overall, we obtained  <dig>  <dig>  communities for imr <dig> . as expected, the size of the resulting communities increases with the scale parameter . for h <dig> es the increase of the mean community size with the scale is homogeneous suggesting that there is no characteristic size for the community structure. for imr <dig> we observe a first range of scales where the communities reduce to singletons , followed by an abrupt transition to a community mean size ∼ <dig> . the existence of singletons over a relatively large range of scales explains why the total number of communities in imr <dig> is larger than in h <dig> es. after removing the trivial communities ,  <dig>  <dig>  communities were kept in imr <dig> .
fig.  <dig> multi-scale communities in the dna interaction network. a mean structural community size  for chromosome  <dig> as a function of the scale index in imr <dig>  and h <dig> es . b histogram of interval-communities genomic length  calculated in  <dig> kb bins in a log-log representation for different cell lines: imr <dig> , h <dig> es , gm <dig> , k <dig>  and hela  . the black straight line correspond to the power-law behaviour l
α with α=− <dig> 




structural communities correspond to genome intervals
the interaction frequencies outside the diagonal blocks characterising the structural compartimentalisation as described in  <cit>  are not negligible . this suggests that structural communities may not necessarily reduce to intervals along the genome. hence for each non trivial community , we computed the proportion p
int of the largest set of successive  <dig> kb loci covered by the community over the size of the community: p
int= <dig> when all the nodes of the community constitute an interval of the masked genome and p
int=1/n where n is the size of the community when the community do not contain any pair of consecutive loci of the genome. considering p
int≥ <dig>  as a criterion for a community to constitute an interval along the genome, we observed for the  <dig> cell lines that more than 99% of the communities correspond to intervals of the genome. this property for the communities remains true for all the scales and whatever the size of the communities. this is consistent with the fact that at all scales, genomic neighbours tend to strongly co-localise resulting in higher frequency of interactions. these results demonstrate that the strongest motifs of structural organisation involve contiguous genomic segments. we will refer to the communities forming a genomic interval as interval-communities. we only kept the communities that correspond to an interval  reducing them to their main interval. this allowed us to adopt a simple representation of the structural-communities obtained across scales . the differences observed between the resulting community size distributions in imr <dig> and h <dig> es  are visible in this representation. we clearly see a first range of scales  where the interval-communities reduce to singletons in imr <dig>  and not in h <dig> es . above this critical scale, non trivial interval-communities appear in imr <dig>  note that the mean size of the interval-communities for this first meaningful partitioning in imr <dig> is larger than the ones observed in h <dig> es for its first meaningful partitioning . this results in a lack of small non trivial interval-communities in imr <dig> 

a hierarchical organisation of the genome
the representation in fig.  <dig> reveals the hierarchical organisation of the communities. across scales, small communities merge together to form bigger communities at larger scales. hence the community borders present at the smallest scale progressively disappear at some larger scale allowing the emergence of bigger communities. importantly, the conservation of borders from large scales to small scales is very high. for each pair of scales s2>s <dig>  we computed the proportion of borders at the larger scale s <dig> that are also present at the smaller scale s <dig>  this proportion is close to  <dig> regardless of the scales . the fact that the borders are conserved across scales means that there is no “new” structure that emerges and that only existent ones merge together, i.e. small structures are nested into bigger ones. this is consistent with the results of recent studies suggesting that tads hierarchically co-associate to form larger structures  <cit> .

another important property illustrated in fig.  <dig> is the redundancy of the communities obtained across scales, underlining the robustness of the graph wavelet community mining protocol with respect to its stochasticity . hence, we kept only once each non trivial interval-communities . we also filtered out the communities that more than double in size when reintegrating the masked regions of the genome, e.g. interval-communities spanning the centromers. this leads to  <dig>  non trivial interval-communities in imr <dig>  for the chromosome  <dig>  when applied to the  <dig> hi-c datasets considered , the methodology presented for human chromosome  <dig> in h <dig> es and imr <dig> resulted in few thousands interval-communities per dataset , except for the mitosis helas <dig> dataset . interestingly, the length distributions of the interval-communities for the imr <dig>  gm <dig>  k <dig> and helas <dig> g <dig> datasets are very similar, but they display differences with the one obtained for h <dig> es dataset for small interval-communities : there are more interval-communities involving only 2- <dig> nodes  in the  <dig> differentiated cell lines datasets and a deficit in interval-communities of length ∼  <dig> kb to ∼  <dig>  mb relative to h <dig> es. a possible interpretation of this excess of interval-communities of size ∼ <dig> mb in h <dig> es, compared to differentiated cell lines, is that cell differentiation is accompanied by the merging of the small structural communities in a structural consolidation scenario. for larger communities, the interval-community size distributions in these  <dig> hi-c datasets are almost identical. indeed, for l≳ <dig> mb, they display a power-law behaviour l
α with α≃− <dig>  . note that if communities of length ∼l would form a partition of the genome of length l, then the number of communities of this scale would be equal to l/l leading to α=− <dig> . this underlines the existence of domains at all scales up to the chromosome length without a characteristic size for genome structuring.
for each cell line, n is the number of distinct non redundant and non trivial  interval-communities. n is the number of communities filtered out because  they do not correspond to a genomic interval or  they double in size when going back to the original  positions. the last two columns correspond to the number of communities and distinct borders in the database




are interval-communities structural domains?
to test the robustness of the wavelet-based community detection method with respect to the possible absence of a community structure over some range of scales, we compared the interval-communities obtained for the hi-c datasets in synchronised helas <dig> cells during g <dig> and m phase, respectively . the original study  <cit>  showed that the highly compartmentalised organisation described before from non synchronous cells  <cit>  was restricted to interphase and that during a cell cycle, chromosomes transit from a decondensed and spatially organised state during interphase to a highly condensed and morphologically reproducible metaphase chromosome state. in the former phase, the hi-c interaction maps display similar plaid patterns of regional enrichment or depletion of long range interactions  while the maps in mitotic cells change and the plaid patterns disappear  <cit> . for helas <dig> g <dig>  dataset, we obtained  <dig>  <dig>  non trivial communities and  <dig>  <dig>  distinct borders . for the mitosis helas <dig> hi-c dataset, we obtained  <dig>  <dig> communities from which we filtered out  <dig> resulting in  <dig> distincts borders . consistently with non synchronous cells, g <dig> cells present a hierarchical structure into interval-communities that increase in size across scales . small scale singletons hierarchically group to form large interval-communities at larger scales. as discussed above, the length distribution of the g <dig> helas <dig> interval-communities is similar to the interval-communities size distribution obtained in the  <dig> other differentiated cell line datasets . in contrast, metaphase chromosomes do not present a hierarchical structural organisation. more specifically, chromosomes  <dig>   <dig> and  <dig> do not present any structure . in the  <dig> other autosomes, at small scales each node is a singleton and above a critical scale a sharp discontinuity of the community sizes distribution is observed: nodes are abruptly grouped in a small number  of communities . for  <dig> out of these  <dig> chromosomes, when divided in two communities, these communities correspond to the two chromosomal arms, as illustrated for chromosome  <dig> in additional file 1: figure s <dig>  these results demonstrate that the wavelet-based community detection method does not produce misleading intermediate scale communities when no structuration exists in that scale range.

to strengthen this point in a noisy situation, we simulated a structural interaction matrix between  <dig> nodes  organised in fully connected interval-communities with no specific organisation at scales larger than the community size: the matrix is built as a series of  <dig> pairs of domains of size  <dig> nodes and  <dig> nodes with internal domain interaction set to  <dig>  with the two first  sub-diagonals set to  <dig>  to assure connectivity and with an additive poisson noise over all interaction pairs of mean value λ= <dig> . when applying the graph wavelet community mining protocol, we recovered only trivial singleton communities at small and large scales. however in the intermediate scale range, we nicely recovered all the  <dig> and  <dig> nodes on a range of scales that depends on their size . this example shows that the method does not produce a fake hierarchical domain organisation by merging existing domains even in a noisy situation.

in order to verify that there are more interactions within interval-communities than between successive interval-communities, we compared the number of contacts between two  <dig> kb loci that are inside the same interval-community at equal distance from its center and the number of interactions between two loci at equal distance from one of the interval-community borders, as a function of the distance separating the pairs of loci. the ratio vs distance curves for different interval-community length categories show that on average there are more interactions within the communities than between communities, regardless of the cell line and the community length: the interaction ratio systematically increases to some maximal value at distances ∼ 1– <dig> mb, from a maximal value ∼  <dig>  in gm <dig> and k <dig>  to ∼  <dig>  in h <dig> es and ∼  <dig> in imr <dig>  over larger distances, the ratio remains rather constant in gm <dig> and k <dig> and decreases to ∼  <dig>  in h <dig> es and imr <dig> . this property holds true even for communities larger than  <dig> mb. as a comparison, we performed the same analysis for the original tad datasets in h <dig> es and imr <dig> . over the shared domain length range, the interaction ratio vs distance curves computed for the tad datasets present very similar shapes as observed for interval-communities , reaching maximal values ∼ <dig> in both h <dig> es and imr <dig>  these results provide evidence that multi-scale interval-communities, very much like tads, constitute units of 3d genome organisation bordered by structural barriers.
fig.  <dig> are interval-communities structural domains? ratio  of the number of interactions between two  <dig> kb loci that are inside the same community at equal distance from its center  and the number of interactions between loci in different communities at equal distance from a community border , versus the distance between them. different colours correspond to different community size categories:  <dig>  ≤l<  <dig>  mb ,  <dig>  ≤l<  <dig> mb ,  <dig> ≤l<  <dig> mb ,  <dig> ≤l<  <dig> mb ,  <dig> ≤l<  <dig> mb ,  <dig> ≤l<  <dig> mb  and  <dig> ≤l<  <dig> mb 




are tads interval-communities?
we next compared our communities to the tads previously described in h <dig> es and imr <dig>  <cit> , asking to which extent the tads and tad borders are recovered in our hierarchical database of interval-communities. the mean best mutual coverage vs tad length curve  between tads and interval-communities is slightly higher in h <dig> es as compared to imr <dig> for all tad lengths , ranging from 62%  at small length  to 91%  at larger length  in h <dig> es . this suggests a good recovery of the largest tads by the interval-community classification. given the  <dig> kb resolution used in this analysis, it is not surprising to observe lower mutual coverages at small lengths where  <dig> pixel error results in a dramatic lowering of mutual coverage. we also observed that the proportion of tads that have a matching structural community  increases with the domain length . only about 1/ <dig> of the smallest tads  are recovered consistently with the fact that in this scale range a match has to be exact. for tads longer than  <dig> mb, the proportion of match is relatively high: in imr <dig> it increases from 40% for tads ∼ <dig> mb up to 70% for tads ≥  <dig> mb and in h <dig> es from 70% for tads ∼  <dig> mb up to 85% for tads of ∼  <dig> mb . comparison of tad borders to interval-community borders shows good concordance for the two datasets . for meaningful comparisons, we restricted the reference domain border set for each species to a subset of borders that at  <dig> kb resolution  collectively cover no more than 35% of the genome. interval-community borders with the largest associated lengths  are selected first. given the overlap between borders at that resolution, this process resulted in selecting a different number of distinct interval-community borders in each species:  <dig>  <dig> in h <dig> es,  <dig>  <dig> in imr <dig>   <dig>  <dig> in gm <dig> and  <dig>  <dig> in k <dig>  tad borders are recovered from 50% up to ∼ 90% in h <dig> es and up to ∼80% in imr <dig>  depending on the tad border associated length, while the expected recovery rate by chance is 35% . these results quantify the high level of tad recovery by interval-communities for domain length ≳  <dig> mb. altogether, these results show that there is a significant agreement between tads and the interval-communities. this provides evidence that interval-communities captures similar organisation principle of genome structure and, thus, extends this description up to chromosome size.
fig.  <dig> tads are interval-communities. a mean best mutual coverage of tads with interval-communities, and  proportion of tads that have a match in the interval-community database, as functions of the average tad size . c proportion of tad boundaries that have a matching interval-community border as a function of the average tad border associated length ; only the set of interval-community borders with largest associated length covering 35% of the genome were used ; the horizontal dashed line marks this expected border matching proportion of 35%. in , yellow marks the analysis in h <dig> es and blue in imr90




to test the robustness of our methodology with regards to the binning resolution, we reproduced the analysis of the imr <dig> data at a finer  and a coarser  resolution . the lengths of interval-communities determined at these  <dig> resolutions nicely reproduce the distribution obtained at the  <dig> kb resolution . intervals-communities of size ≳1− <dig> mb strongly match between these intervals communities datasets . for smaller community size, recovery proportion between datasets decreases with community size in the same manner for the  <dig> resolution pairs. this can be understood when noting that the isolation strength of community borders significantly weakens when decreasing the genomic distance below ∼ <dig> mb . finally, the proportion of tads that have a match in the interval-community database is similar at  <dig> kb resolution than at  <dig> kb resolution . this demonstrates that the results do not depend on the choice of the  <dig> kb resolution and further underlines that the lower structural domain recovery rate generally observed for small domain sizes  is likely related to the weaker isolation strength of structural domain borders over short distances .

conservation of structural communities across cell lines
in the pioneering study  <cit> , tads were described to be conserved between cell lines. we observed that interval-communities in different cell lines present similar size distributions . this led us to investigate to which extent they are conserved across cell lines. to compare the communities obtained in different cell lines, we used each of the interval-community database obtained in h <dig> es, gm <dig>  imr <dig>  k <dig>  as a reference domain set and computed the proportion of matching interval-communities of the  <dig> other cell lines relative to this reference set . we observed that small interval-communities  are not well conserved between different cell lines . this might result from the fact that hi-c data are average over cell populations and that some regions may present different structural organisations from cell to cell blurring the insulator property of structural domain borders at small scales. however, when considering interval-communities of larger sizes, higher conservation was observed . more than 60% of intervals-communities of length l≳  <dig>  mb in the differentiated cell lines correspond to an interval-community in h <dig> es . h <dig> es interval-community dataset thus contains a large proportion of the interval-communities observed in the differentiated cell lines above ∼  <dig> kb. when using one differentiated cell line interval-community database as reference, we observed a maximal recovery rate that is similar for the  <dig> other cell lines: 45% for sizes ≳  <dig> mb in imr <dig>  65% for sizes ≳  <dig>  mb in gm <dig> and 70% for sizes ≳  <dig>  mb in k <dig> . the observed differences likely reflect the excess of interval-communities in the size range  <dig> - <dig>  mb observed in h <dig> es relative to the differentiated cell lines . as a comparison, we performed the same analysis for the tads that were claimed to be conserved between h <dig> es and imr <dig> cell lines  <cit>  . like for interval-communities, the correspondance between tads in the two cell lines decreases for domain sizes ≲  <dig> kb. for larger domain sizes, we observed that h <dig> es tad dataset contains more  of the imr <dig> tads than the imr <dig> tad dataset contains h <dig> es tads . these results corroborate the conservation of structural domains of length ∼1– <dig> mb between cell lines in the 45–70% range but also extend this conservation to the largest interval-communities up to length ≳  <dig> mb.
fig.  <dig> conservation of interval-communities between cell lines. proportion of interval-communities in the query cell lines h <dig> es , imr <dig> , gm <dig>  and k <dig>  that have a matching interval-communities in the reference cell line indicated in each plot: h <dig> es , gm <dig> , imr <dig>  and k <dig> . proportion of interval-community matches is computed over groups of  <dig> query interval-communities ordered by length 




CONCLUSIONS
we introduced a fast multi-scale community mining algorithm based on spectral graph wavelets  <cit>  to identify structural motifs from high-throughput chromatin conformation capture data   <cit> . hi-c data were represented as intra-chromosomal interaction networks and structural motifs were delineated as communities of these networks. the novelty of this approach relies on the combination of a multi-scale procedure and a representation of the data that is independent of the exact assembly of the reference genome over length scales larger than the window size used to construct the interaction network. the proposed methodology has no a priori on the size and on the nature of the structural motifs. the application of this protocol to  <dig> hi-c datasets led to a database of several thousands structural communities . the database of interval-communities in mitotic helas <dig> cells that were described not to present a tad-like structural organisation  <cit> , does not contain any intermediary scale structural communities, illustrating the robustness of the proposed methodology with regards to the absence of structural motifs. consistently with the recent usage of hi-c data for genome sequence assembly  <cit> , we observed that structural-communities in unsynchronised and g <dig> cells form hierarchies of chromosome intervals of length ranging from the resolution  to the chromosome lengths  . the prevalence of interval-communities underlines that chromosome folding is mainly driven by interactions between neighbouring loci, at all scales of observation. this constitutes a justification that tad-like structural motifs indeed correspond to chromosome intervals. for domains significantly larger than the resolution of the analysis , a majority of the tads  <cit>  are recovered as interval-communities  and, whatever the interval-community length, their borders present an insulator-like behaviour  as expected for tad-like structural motifs. hence interval-communities capture similar structural organisation patterns as tads but over the full chromosome range of scales.

this novel multi-scale structural decomposition of human chromosomes provides an original framework to question structural organisation and its relationship to functional regulation. it allowed us to reformulate the question of structural domain conservation between different cell lines across the scales: a high level of structural conservation between cell lines up to the largest scales becomes apparent. for example, ∼ 65% of the differentiated cell lines interval-communities larger than  <dig> kb were also found to be structural-communities in h <dig> es cell line . it was previously noted that there likely exists some links between structural domains and replication domains  <cit>  including the so-called replication timing u-domains  <cit> . u-domains are bordered by early replicating master replication initiation zones that present similar insulating properties as the ones observed for tads and interval-communities borders   <cit> . in human es cells, master replication initiation zones are enriched in ctcf and pluripotent transcription factors nanog and oct <dig> that were recently shown to contribute to the overall folding of embryonic stem cells genome via specific long-range contacts  <cit> , and appear to be fundamental determinants of pluripotency maintenance  <cit> . in particular they are at the heart of the so-called consolidation phenomenon  <cit>  corresponding to early to late transitions from embryonic stem cells to differentiated cells coinciding with the emergence of compact heterochromatin at the nuclear periphery  <cit> . es cell line are characterised by smaller replication u-domains  <cit> . here we observed in h <dig> es cell line an excess of interval-communities in the range of scales from ∼ <dig> kb to ∼ <dig>  mb as compared to the differentiated cell lines . these domains not observed in differentiated cell lines might be subject to some structural consolidation scenario during cell differentiation, similar to the one described for replication timing domains. for example, the strutural community border present in h <dig> es and absent in imr <dig> at position ∼ <dig> mb in fig.  <dig> correspond to a replication timing u-domain border specific of es cell line. further analysis of the structural consolidation scenario is likely to shed a new light on the role of structural organisation in the epigenetically regulated chromatin reorganisation that underlies the loss of pluripotency and lineage commitment  <cit> . it was shown that master origins of replication conserved between  <dig> cell lines are encoded in the dna sequence via a local enrichment in nucleosome excluding energy barriers  <cit> . this raises the question whether borders of the conserved structural community borders  might be specified by a similar genetic mechanism.

a recent hi-c experimental study at much higher  resolution has provided some refined partitioning of the human genome by tads of mean size ∼ <dig> kb  <cit> , much closer to the estimate ∼100-kb previously reported in drosophila  <cit> . interestingly, as in drosophila, these refined tads seem to have some specific epigenetic chromatin identity that can change dramatically their functional identity in different cell types  <cit> . detecting interval-communities at higher resolution can provide better quantification of the chromatin state blocks as epigenetic communities. the wavelet-based community detection method provides us with a tool to investigate further the existence of some underlying rules for the association of structural/functional domains across scales. the robustness of the proposed protocol with respect to rearranged genomes is a key property to pursue this research.

additional file

additional file  <dig> supplementary online material. additional data file  <dig> contains supplementary text: graph wavelet transform and community mining, supplementary figures s <dig> to s <dig> and supplementary table s <dig> . 




abbreviations
dnadeoxyribonucleic acid

hi-chigh-throughput 3c

h <dig> esembryonic stem cell line h1

tadtopologically associating domains

3cchromatin conformation capture

funding
this work was supported by centre national de la recherche scientifique , ecole normale supérieure de lyon  and agence national de la recherche . ba acknowledges support from science and technology commission of shanghai municipality , fondation pour la recherche médicale  and agence national de la recherche . the funding bodies had no role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.

availability of data and materials
the structural domain predictions supporting the conclusions of this article as well as the version of the multi-scale community detection  algorithm code used for all analyses and a wrapper matlab script allowing to reproduce the described pipeline can be downloaded at http://perso.ens-lyon.fr/benjamin.audit/structuralcommunities/.

the latest version of mscd matlab source code is freely available at http://www.gipsa-lab.fr/extasciitildenicolas.tremblay/index.php?page=downloads.

authors’ contributions
all authors designed the study. reb performed the analysis. nt and pb contributed to elaborate analysis tools. aa, pb and ba supervised the study. ba wrote the manuscript with contributions from all co-authors. all authors read and approved the final manuscript.

competing interests
all authors declare that they have no competing interests.

consent for publication
not applicable.

ethics approval and consent to participate
not applicable.

publisher’s note
springer nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.
