BACKGROUND
as a new capillary grows from a blood vessel, a series of cellular processes occur. these vascularization events have been extensively studied experimentally, however the whole angiogenic sequence has yet to be characterized by any experiment or model, and numerous unknowns remain. what is known is that an endothelial cell from an existing vessel becomes activated. the activated cell starts to migrate into the extracellular matrix by degrading it; this unique, spindle-shaped cell is called the tip cell. cells adjacent to the tip cell begin to proliferate, and follow the tip cell; they are referred to as stalk cells. these processes result in formation of a sprout  <cit> . this capillary sprout moves towards a stimulus, in response to chemical cues, mechanical factors, and a degree of random motility. finally, the sprout joins an adjacent capillary. together these events define the process of sprouting angiogenesis.

hypoxia is a main stimulus for angiogenesis during ischemia, exercise, inflammation, and cancer. in response to hypoxia, a transcription factor hypoxia-inducible factor  <dig>  activates hundreds of genes in cells exposed to low oxygen  <cit> . these genes include vascular endothelial growth factor, vegf. overall, vegf protein stimulates chemotaxis and proliferation of endothelial cells. there are seven known isoforms of vegf, each with a different effect on cell behavior, and ultimately, on vascular pattern formation  <cit> ; additionally, there are splice variants of the vegf isoforms, vegfxxxb  <cit> . here, we first refer to hif1-dependent expression of vegf and represent the effect of the vegf-a  isoform on cells, unless otherwise specified.

along with vegf, another ligand, delta, and its receptor play a key role in angiogenic tip cell formation and proliferation, and the integrity of a microvascular network. recent studies have focused on the multiple effects of notch-delta signaling on vascular sprout formation. delta-like ligand  <dig>  is a transmembrane ligand for notch receptors, and it is critical to vascular development. so important is dll <dig>  that like vegf, haploinsufficiency of the dll <dig> gene is embryonically lethal in many mouse strains, as a result of extensive vascular defects  <cit> . dll <dig> is primarily expressed in endothelial cells, and correlated to the local concentration of vegf  <cit> , as well as vegf receptor concentrations. a blockade of vegf leads to a decrease of dll <dig>  <cit> , while notch-delta signaling downregulates vegfr <dig>  <cit> . one study showed the presence of dll <dig> reduced tip cell formation as a function of vegf  <cit> , and another demonstrated notch suppressed branching and proliferation at the sprout tip  <cit> . a dll <dig> deficiency causes an increase in sprout formation but vessels appear nonproductive, with less capability of carrying blood or reducing hypoxia in surrounding tissue  <cit> . overexpression of dll <dig> diminishes the growth of new sprout tips. in the computational research presented here, we focus on the effects of vegf protein concentrations and dll <dig> haploinsufficiency on endothelial cells and how this cell level behavior contributes to differences in capillary network formation.

mathematical representations of angiogenesis date to the 1970's, and their numbers continue to expand rapidly. some of the first models were differential equations representing a generic growth factor as a chemotactic stimulus, produced and released by a tumor mass, and inducing growth of vessels into the tumor  <cit> . models have since included detailed equation-based network models of tumor-induced angiogenesis  <cit> , a model of capillary growth through a corneal pocket assay  <cit> , molecular level interactions of vegf complexes coupled to vessel oxygenation  <cit> , a cell-level rule-based model of network growth in mesenteric tissue  <cit> , potts models of angiogenic growth  <cit> , a model of tip cell selection as a function of notch-signaling  <cit> , network formation stemming from capillary movement through a matrix composed of aligned collagen fibers  <cit> , and vegf-driven angiogenic growth applied to a vascular engineering construct environment  <cit> , among many others  <cit> . each model brings a new perspective on the biological phenomenon behind neovascularization, and together they give insight on multiple conditions affecting angiogenesis, and multiple conditions affected by angiogenesis. the goal of the current modeling effort is to provide a framework where many of these models could be employed or integrated, or at the very least their hypotheses tested in a new context, specifically related to biological observations and experimental data.

for this reason, we chose to design the model using the broad framework of three-dimensional agent-based modeling. agent-based programming has roots in social science, game theory, economics, evolution and public health. more recently it has emerged as a tool useful for a range of biomedical applications, including angiogenesis  <cit> , membrane transport  <cit> , inflammatory response  <cit> , and tumor growth  <cit> .

agents are objects that can interact with their environment, and modify their surroundings. they are analogous to digital organisms familiar to evolutionary biology in that they carry a computational genome, or a sequence of instructions . these rules determine the agents' response to logical functions. the rules of agents require listing the factors that influence cell behavior as events, with direct counterparts in biology. unlike digital organisms, agents used in the model are not inherently self-replicating. agents' rules may evolve, and they may copy their instructions when modified to represent growth.

in agent-based modeling, global functions  and sophisticated rules can govern agent behavior. agent interactions with one another and their environment can also be asynchronous. the rule-based modeling we describe is a continual, iterative process, much like perfecting in vitro or in vivo experiments. as more knowledge is gained, the current assumptions may change, and a cycle of improvements is needed to keep pace with current biological information. furthermore, we start with a very general model – its parameters will be changed to represent specific species, tissues and conditions.

we employed this agent-based approach to develop a three-dimensional, computational model that simulates cellular sprouting at the onset of angiogenesis. we use the model to determine and weigh the critical events in angiogenesis; and differentiate under what microenvironments, which factors dominate and result in a particular vessel and capillary network phenotype.

the model is based on experimental work found from extensive literature research, and methods in the model are closely governed by biological mechanisms. currently, the model is applied to conditions that might occur in a three-dimensional in vitro setting. we represent physiological changes at the cell level; visually simulate in three dimensions assumptions behind cell activation, migration, elongation, proliferation and branching; and test cell level behavior in response to different stimuli, focusing in the current model on activation by a threshold change in vegf and changes in ligand presence. a novel capillary network emerges out of this complex interaction of single cells.

results of the model show the relationship between growth factor gradients, cell sprouting, cell migration and cell proliferation. results also showed how variations in the mechanisms of cellular persistence alter vessel growth. we predicted the effects of migration separate from proliferation on tip cell and stalk cell movement, and on total vessel growth. furthermore, the model represents novel findings of how delta ligand changes influence capillary phenotype. overall, the model represents a three-dimensional framework upon which to test and develop biologically realistic mechanisms underlying blood vessel growth.

methods
model formulation
model inputs are coordinates of an initial 3d vascular network, local vegf concentrations, binary values for five parameters , and initial values of variables. output is the resulting change in cell activation, cell position, cell growth and vessel phenotype after the series of biologically-based rules determine cells' response to the local environment. rules are implemented through logical statements and equations. rules and parameter ranges are initially based on available literature data on endothelial cell behavior in vitro . while this version focuses solely on endothelial cells, subsequent iterations of the model can include other cell types important to different angiogenic processes, e.g., smooth muscle cells, pericytes, precursor cells and astrocytes.

values are experimentally determined or estimated. the default value used in the model is given first; value ranges found in references and used for sensitivity analysis are provided in parentheses.

below we introduce the model, describe individual rules for cell activity, and explain how the rules work in a discrete grid. a list of model abbreviations and parameters can be found in tables  <dig> and  <dig>  respectively, while initial values for variables are shown in table s <dig>  and rules are listed in table  <dig> 

geometry
at the beginning of each run of the model, the simulation environment is populated by an initial preexisting capillary network. in this rendition, the dimensions of the capillary network are similar to those simulated from rat extensor digitorum longus , as in reference  <cit> . for the purpose of showing the initial steps in sprouting, several capillaries  were selected randomly from this network. these capillaries are represented in the model as connected endothelial cells. the location and movement of cells are defined in a cartesian grid, however the methods are portable to other geometries. there are no inherent size restrictions on the space modeled. in this model version, the specific grid dimensions for the program showing two initial capillaries is  <dig> μm by  <dig> μm by  <dig> μm , and the grid size shown for three capillaries expands to  <dig> μm by  <dig> μm by  <dig> μm. the k-axis is scaled down by 1/10th, as a visual aid. voxels in the model are occupied by part of the vasculature, or by the matrix and interstitial fluid surrounding the vasculature. each voxel is associated with a computational datastructure that is capable of storing and passing information in vectors. in the current model, the voxel-associated datastructure contains information on local concentrations of growth factors.

representation of cells
each preexisting capillary vessel is composed of four endothelial cells. endothelial cells are represented as a series of segments that occupy a cylindrical volume specified by a radius and length . segments are defined by two connected nodes . each node is associated with a voxel, and serves as a position used to calculate the local environment of a cell segment. an activated tip cell is defined throughout the simulation by one segment  that can vary in length, as the cell changes position, grows or elongates. stalk cells are represented by one activated segment adjacent to the tip cell and by any number of nonadjacent, quiescent segments. as the adjacent stalk cells change position and shape, their segments can change in number and radius, and the activated segment closest to the tip cell can change in length and radius. endothelial cells on the preexisting capillaries have a static length and radius, throughout a model run.

local vegf levels
vegf gradient, ∇, and local vegf concentrations, , are inputs into the current model and remain constant for every run of the simulation. this condition can be relaxed by coupling the cell model to previously developed vegf models  <cit> . for graphs and model runs presented here, there is either no gradient , or the ∇ is defined as in appendix  <dig>  where noted.

rules
behavioral rules based on biophysical properties and experimental observations govern the activation and movement of endothelial cells in the model. table  <dig> lists the main rules governing endothelial cell migration and proliferation, and the related experimental references. to represent biological mechanisms in the model and perform these rules, the computer code implements over  <dig> logical statements at each timestep, for each active cell segment.

at the beginning of each run of the simulation, boolean rules are defined. these rules determine proliferation, migration and elongation; see table  <dig> . at the start of any sequence of rules for tip or stalk cell segment movement, the values of these global booleans dictate whether or not a certain event is permitted. to restrict elongation from occurring during proliferation of stalk cells, and vice versa, there are also local booleans employed for the individual stalk cells to indicate what event they just performed, and therefore what they can or cannot do in the same and following timesteps.

proliferation, elongation and migration of endothelial cells in a growing sprout are represented through the movement of nodes . throughout the steps in angiogenesis, we focus on three activated nodes representing the tip cell and the adjacent stalk cell segment in every sprout. these nodes are introduced as follows :

 node a, leading node of the tip cell 

 node b, shared node of the tip and adjacent stalk cells .

this is the back node of the tip cell and leading node of the adjacent stalk cell segment.

 node c, back node of the adjacent stalk cell segment 

we describe the sequence of events that define the computational processes representing sprout growth, in the context of these nodes. the following paragraphs discuss the processes modeled: cell activation; cell sensing of growth factors; cell migration, proliferation and elongation; cell branching and the process of a sprout joining an adjacent vessel or another sprout. in appendix  <dig>  we define in more detail events from to, the time at the onset of angiogenesis, to tn, a time at any interval following the appearance of a sprout. in figure  <dig>  we provide a flow chart of the processes to illustrate their connectivity.

cell activation
in experiments of angiogenic sprouting, a single cell is initially shown to branch out in a spindle-shaped fashion from an existing vessel  <cit> . this tapered sprout tip is a highly polarized cell, which expresses genes differently than adjacent stalk cells, including higher levels of vegfr <dig> and pdgfβ  <cit> . the tip cell also proliferates with a much lower probability than stalk cells  <cit>  .

cells in an existing blood vessel can be activated by a threshold increase in vegf protein levels  <cit> . one cell becomes the tip cell, and a cell adjacent to this tip cell becomes an activated proliferating stalk cell. by secreting matrix degradation proteases like matrix metalloproteinases , a tip cell proteolyses its surrounding extracellular matrix and releases matrix-stored growth factors  <cit> . we restrict our initial model to considering the effect of chemical factors on tip and stalk cell response. mmp secretion and matrix degradation are assumed constant. haptotaxis and the effect of the matrix are represented by adjusting the second term in the cell migration rates, a term that depends on collagen content . the growing sprout, lead by the tip cell, moves along a growth factor concentration gradient, towards the source of higher vegf. active stalk cells may change in shape and position, and proliferate, so long as the stalk cell adjacent to the tip cell remains connected to the tip cell throughout.

the computational representation of activation is as follows. an endothelial cell on an existing capillary can be activated in the model when one of its segments is activated. at to, the onset of angiogenesis, there is a search routine over all the cell segments in the model of the existing capillary network. a cell segment is activated when both its nodes sense a level of vegf above a specified concentration threshold, vegf_activate . these nodes are labeled activated nodes. with a certain probability limited by the number of tip cells per capillary, a probability defined by the variables tipnumber and tipnumberfrac , a sprout may originate from one of these activated nodes. once a sprout forms from a node, nodes adjacent to it on the existing capillary become inactivated.

cell movement following activation
cellular sensing of local growth factor gradients
the local maximum vegf gradient ∇max for the leading tip cell node is determined by a local search surrounding the node. for a node at position x, the maximum change in growth factor concentration between its current location and its local environment can be defined mathematically:

  Δcmax⁡⋅η=max⁡i'=i−1 to i+1j'=j−1 to j+1k'=k−1 to k+1⌊Δco,i'⋅ηi'+Δco,j'⋅ηj'+Δco,k'⋅ηk'⌋ 

ηi is the weighting vector for the +i direction. this weighing vector could be defined as a function of the local matrix, e.g., as a function of collagen fiber orientation. for this model, the matrix is uniform and the weighing vector's magnitude is uniform in all directions and equal to  <dig>  the probability of the cell moving into a potential new position is a function of Δc, the change in concentration of growth factor between the current position of a cell's leading node , and the highest concentration of growth factor in a nearby voxel , divided by the change in distance between voxel o and voxel q. the larger the positive concentration gradient, the more likely that the cell's node moves towards voxel q. following this local search routine, the location of the voxel q is where the maximum concentration change per distance was found.

direction of cell velocity 
the leading node of a sprout moves in the direction of Δcmax·η, i.e., d is a function of ∇max surrounding the leading node of a tip cell. the local direction for cell movement is recalculated for activated tip cell nodes at each timestep. in the discrete 3d grid used in this version of the model, the directional vector for movement of an active tip cell is defined by changes in the position of its leading node, as follows:

  d=xo,i−xnew,i2+2+2i+xo,j−xnew,j2+2+2j+xo,k−xnew,k2+2+2k 

where the designation "new" represents the new x position determined by the highest local vegf gradient, and "o" represents the current one. the directional vector is a unit vector, and the local search for maximum concentration gradient is restricted to adjacent voxels. when there is only one direction for the highest vegf gradient surrounding a voxel, then xnew corresponds to position voxel q, and d points in the direction of a single Δcmax·η .

stochasticity is introduced where the highest gradients are the same in two or more voxels surrounding the sensing cell node, that is, Δcmax·η and q have more than one voxel associated with them. in this case, d is chosen randomly  between the available locations corresponding to the highest gradient. if all the local concentrations surrounding a cell node are equal in vegf concentration, the next position is chosen with a bias towards persistence, as described below. if the activated cell is in the position of highest local vegf concentration, it will continue to move or grow, in a direction chosen from all available locations, also with a persistence bias. the cell searches its local environment and moves based on this weighted set or probabilities, i.e., with a weighted random walk.

persistence
to account for experimentally observed cellular persistence, the probability of moving in specified directions is weighted. numerous factors could contribute to the underlying biology of observed in vivo persistence, including matrix stiffness, growth factors, filopodia, or directional sensing from a yet uncharacterized source. to analyze the contribution of different factors on biased cell movement, we tested three methods of representing persistence in the model. the first representation of persistence was called intrinsic persistence – a measure of the probability that a cell follows along the same path without deviating direction, independent of growth factors. this was implemented computationally by a rule where a tip cell's leading node remembers its previous location, and a vector is calculated between its previous location and current one. then the probability of the node moving in the next step along that same vector direction is weighted more heavily; the value of this probability is defined by the variables dirbias and denombias . while this is referred to as intrinsic persistence, it is also a means to implicitly represent the process when the leading part of a tip cell alters the local extracellular matrix as it moves  and paves a favorable path for any following cell segments  <cit> . a second way of representing persistence was to bias directional movement of cell nodes in favor of a particular location in the entire gridspace. for this representation, movement towards one corner of the grid was weighted more heavily than other directions, and not as a function of vegf. however, beyond offering a chemotaxic stimulus, growth factors such as vegf could affect the ability of a cell to follow a given direction  <cit> . a third representation was weighing directional movement as a function of local . in this implementation, the dirbias variable became a function of . finally, purely random movement of the tip cell's leading node was compared to the effects of persistence, in the case where local vegf concentrations surrounding a node are equal.

proliferation, migration and elongation
the dynamics of proliferation, migration, and elongation in the model represent a novel hypothesis as to how sprout formation is governed by individual cells and cell segment behavior. the result is a push-pull system between tip and stalk cells. as the tip cell migrates out of the existing capillary, it may pull along the stalk cells. this pulling causes the adjacent stalk cell segment to elongate. diverse stimuli affect elongation of cells during angiogenesis, including growth factors, mechanical stretch and adjacent cells  <cit> . we first restrict elongation to result only from a tip cell pulling. once a tip cell stretches the adjacent stalk cell segment, stalk cell proliferation is stimulated. stalk cell proliferation in turn pushes the tip cell forward, resulting in tip cell migration. the process then repeats: the tip cell proliferates and migrates towards higher growth factor levels, pulling along the adjacent stalk cell segment, which elongates; then the stalk cells proliferate and push the tip cell forward . note that the tip cell can also proliferate, with a low probability  <cit> .

in the current model, only the stalk cell segment adjacent to the tip cell elongates, while all the stalk cell segments and the tip cell are able to proliferate. during elongation, the volume of a cell remains constant; the cell radius decreases to compensate for the extended length. the tip cell and stalk cells have a maximum length and volume, which provide limits on velocity and elongation. the following provides the sequential rules that govern the process of angiogenesis after a tip cell appears. the tip cell and the adjacent-to-tip stalk cell segment are the active, moving, growing, and branching segments. the unactivated stalk cell segments in the capillary sprout, all those following the adjacent stalk cell, remain in the position they first establish.

cell proliferation
proliferation of the tip cell ptip is represented in the model by cell volume changes, with time . it is defined as the same experimental-based equation for tip cells ptip and stalk cells pstalk , however stalk cell proliferation occurs deterministically whenever pstalk is allowed, while the tip cell proliferation occurs probabilistically as a function of dll <dig> . length changes due to proliferation are directly related to volume changes. following tip cell proliferation, the new radius rp and length ℓ of the tip cell are defined by:

  rp = ·r 

  ℓ=⋅v2⋅π 

where r is the old radius, and v is the old volume of the tip cell segment.

total tip cell movement
the total movement or length displacement of a tip cell, mtotal, at any given time interval tn- <dig> to tn, is given by:

  mtotal={min⁡{⋅mtip,estalk}+ℓptip,where estalk> <dig> pstalk=0case 1ℓpstalk+ℓptip,where pstalk> <dig> estalk=0case  <dig> 

where mtip is migration rate of the tip cell. ℓpstalk and ℓptip are length changes of the tip cell due to stalk cell proliferation and tip cell proliferation, respectively. elongation estalk and proliferation pstalk of the stalk cells occur independently and separately, i.e., they do not occur in the same timestep. the specific cases  <dig> and  <dig> refer to when the adjacent stalk cell segment elongates, but the stalk cells do not proliferate  and when stalk cells proliferate, but the adjacent stalk cell does not elongate . rules for cell movement in these two cases are described in detail in appendix  <dig> .

branching
branching occurs at a certain probability after the onset of angiogenesis, and a delay defined by the variable timebranching. currently branching occurs with a specified probability for every activated cell during each timestep of the model, if a cell's node senses a specified threshold of local vegf concentrations . the minimum branch length is initially set, and the initial angle formed between branching cell segments is also defined, for the current model . to visualize the branch , we set a minimum branch length that corresponded to at least one grid point away, where growth was allowed in two directions, with a grid size of  <dig> μm. as an alternative in future models, varying this length, or making the initial branch length dependent on proliferation and migration rates, could be possible. eventually, the model will include the effect of mechanical forces on cell shape and size; in this case , we would be able to better justify a range of minimum/initial branching lengths. the branching angle can be randomly selected to be equal, less or greater than this maximum default value, for specific conditions. the presence of dll <dig> affects the rate of branching both at the tip and stalk cells; and the effect of dll <dig> haploinsufficiency on the branching is represented in the model parameters . branching in the model can occur at a stalk or a tip cell node. for a detailed description of how branching is implemented, see appendix  <dig> in additional file  <dig> 

joining another sprout or vessel
anastomoses, or the connection of a growing sprout to another vessel occurs when the leading node of the tip cell touches an adjacent vessel or another tip cell node, randomly. this is a first implementation, and subsequently activation of the adjacent vessel may be a requirement for joining of the tip cell. in this initial model, anastomoses occur infrequently; there is no restriction on sprout movement by surrounding tissue or a bias from interstitial fluid flow.

effects of dll4
the presence of dll <dig> has an effect on those rules involving tip cell formation, tip cell proliferation, and branching probability . experimentally, the observed tip cell number in dll4+/- vasculature is near  <dig>  times that of control tip cell number  <cit> . a two-fold difference was used in the model to allow integer number of tip cells, when observing only a few capillaries. note also that the number of tip cells formed from an existing capillary versus a new capillary formed by angiogenesis is expected to differ. more tip cell formation and branching is hypothesized in the newly formed vessel.

model parameters
platform
the model was programmed in java, using sun's java3d and mason  libraries. the java ide used was borland jbuilder. output of the java code  was written into tecplot ; additional results were written to text files. a description of the computational architecture in provided in appendix  <dig> . for graphical rendering, the output was read into a user-written pov-ray program . a pov-ray movie was then produced from a series of these programs.

sensitivity analysis
sensitivity analysis was performed for key parameters. cell displacement rates, , migration rates, random weighting, branching probability and timesteps were adjusted over a wide range of values, while other factors were held constant. sample graphs from the sensitivity analysis are provided in figures, where details of the parameters are relevant to the results and discussion. an exhaustive systematic sensitivity analysis can be performed when the model is restricted to a specific tissue type.

timestep
the timestep currently is defined as a constant. as experimental details of events become available, it could be made variable. there is no inherent limit on the number of timesteps.

RESULTS
the model results show cellular activation, proliferation, and movement during the initial steps in angiogenesis. four main applications of the model were explored: in silico knockout experiments, characterization of persistence effects on vessel formation, differentiation of tip cell and stalk cell branching, and the effect of dll <dig> haploinsufficiency on sprouting.

first, to give a basis of how the model's representation of cell activation and chemotaxis correlates with experiments that can serve as validation of the model, cumulative sprout length was compared with and without vegf at different concentrations. in developing the model, rules for determining the experimental relationship between vegf concentration and cell migration  <cit>  and cell proliferation  <cit>  were estimated from experiments on endothelial cells . cell proliferation experiments were 2d in vitro cell culture assays, and cell migration experiments used vegf as a stimulus for movement of cells in a boyden chamber assay. in vitro experiments provide an estimate in the computational model for the maximum in vivo changes in response to an activated cell sensing a specified local concentration of vegf. the effect of vegf concentration on sprout formation was then predicted by the simulation in three dimensions . the model output was qualitatively compared to independent data  from experiments on sprout length changes as a function of vegf in three-dimensional huvec spheroid experiments   <cit> . without vegf or with local vegf levels less than  <dig>  ng/ml, the cells in the model do not become activated, and there are no cumulative sprout length changes.

migration, proliferation and elongation
once the premise of cell activation by a threshold vegf and migration in response to a vegf gradient was established, varied combinations of the migration and proliferation rules were explored. one highlight of the described modeling approach is that methods were designed with modularity. the effects of allowing or prohibiting processes that would not be feasible to manipulate independently in vivo, can be predicted for specific cell types. figure  <dig> shows the effects of altering migration and proliferation differentially in tip and stalk cells, for the experiments 1– <dig> detailed in table  <dig>  there are  <dig> possible combinations of experiments from manipulating the five boolean values for initial variables. boolean values indicate whether or not five processes are allowed . initial total capillary length is  <dig> μm, at  <dig> hrs, for all model runs. experiment  <dig>  where no process is permitted, indicates near base line values; in this case, the only growth or cellular addition is the initial formation of tip cells. experiment  <dig>  on the other hand, stands in for a positive control – all processes are on, and maximum growth and proliferation of both tip and stalk cells are expected. figure 5c shows how branching is related to elongation and proliferation. without one or the other, there is no branching ; significant branching occurs when only tip cell proliferation is turned off .

persistence
representations of persistence were compared graphically . figure  <dig> shows the calculations for persistence weighting and the effect on total vessel length over time. when vegf levels are not uniform, using a search routine for a local gradient  combined with intrinsic cell persistence, produces some random movement of cells . when the tip cell's intrinsic persistence is replaced by a biased weight towards a particular grid location, the results are shown  and compared to length changes in time where there is 20% intrinsic persistence . with uniform vegf levels in the grid, entirely random tip cell motion limits the planar-xy growth perpendicular from the initial vessels , while also limiting the total length of capillary growth . without a biased directional preference by cells, the model predicts a tortuous vascular network, regardless of the number or degree of activated cells. other factors not yet explicitly modeled that could affect persistence include collagen fiber alignment, and the influence of contact guidance  <cit> .

branching
the effect of branching on total vessel length is shown in figure  <dig>  at the onset of angiogenesis, there is little branching; the model predicts it is not until  <dig> hrs in the default microenvironment, that branching has a significant effect on the total vessel length changes . branching predicted by the model correlates to results from available in vitro and in vivo experiments. in huvecs cultured in 24-well plates with matrigel  at  <dig>  cells/well, the number of branch points at  <dig> hrs ranged from ~ <dig> for cells without growth factor to ~ <dig> for cells cultured with  <dig> ng/ml soluble dll <dig>  <cit> . scaling these in vitro findings to the dimensions of  <dig> μm ×  <dig> μm ×  <dig> μm , an estimate would be 0– <dig> branches in  <dig> hrs, which is what the model predicts at 10% branching for timesteps of  <dig> or  <dig> hrs .

dll4
discussion
this model introduces the steps of cellular sprouting during angiogenesis in a manner that is biologically relevant and consistent with experimental observations. many previous computational models of angiogenesis have been based on equations or rules governing generalized growth factors, without specifying the molecular nature and properties  <cit> . where vegf and fgf have been considered specifically, a two-dimensional model provided results with good qualitative agreement with experiments  <cit> . models have been deterministic  <cit>  and stochastic, and included differential equations  <cit> , as well as discrete models  <cit> , such as cellular automaton  <cit> . the agent-based model introduced here offers a three-dimensional, detailed look at the steps in cellular activation, proliferation and movement during angiogenic sprouting. it shows how chemotaxis alone, from a vegf gradient, affects the velocity and growth of vessel sprouts. the model predicts the degree to which vegf concentrations beyond an activation threshold influence total vessel length changes , ranks the key individual factors in migration and proliferation by differentiating tip and stalk cell events , explores three potential mechanisms altering cellular persistence , offers one perspective on how branching and vessel length changes could be correlated  and predicts global angiogenic changes to knockout conditions both knockouts at the level of dll <dig> receptor binding  and cell-specific processes .

vegf concentrations vs. vegf gradients
vegf is one of the main growth factors involved in angiogenesis. experimental studies have predicted that the absolute vegf concentration and the vegf gradient play separate roles in new blood vessel formation, in a microenvironment-dependent way. the current model represents a situation that might be found for capillary growth in a 3d in vitro setting with human endothelial cells sprouting from an existing vasculature. perhaps surprisingly, the model predicts little effect of absolute  concentration on overall vessel growth in three-dimensions within the range of 1– <dig> ng/ml . at  <dig> ng/ml vegf, the average increase in vessel length looks noticeably higher compared to ≤  <dig> ng/ml vegf . however, the degree of variation in vessel length changes is very high at this concentration, and in some instances, vessel length change could be similar to those at lower concentrations . from visual representations, this phenomenon reflects the possibility of two conditions: one, the initial vessels sprout extensively outward, without physical limitations, and two, the sprouts grow randomly and then back on themselves, limiting total length changes. thus, from the model, it would be predicted, that where there is no vegf gradient and cells are activated, total vessel length increases significantly from 24– <dig> hrs , though largely independent of the concentration of vegf beyond  <dig> ng/ml; this is in good qualitative agreement with the trend lines for vegf dependence from experiments using a bovine aortic endothelial cell radial array assay, which showed saturation in vessel length changes with increasing   <cit> . furthermore, the model predicts that increasing overall uniform vegf concentration increases the variability in the length changes. in qualitatively comparing the model predictions to experimental measurements of sprout increase as a function of vegf and time in huvec spheroid models seeded in a collagen gel, two things are of note. one, the variability in results from one experiment to another is high , while two, the sprout length changes are generally less than that predicted by the model at  <dig> and  <dig> hrs . this latter observation may reflect that the current model has no boundary restrictions. in vivo, the sprouting capillaries would be restricted by tissue and other vasculature, and in vitro, the extracellular matrix could affect growth differently than modeled, as could the limited viability of the cells in culture. in the current simulation, there is no mechanical limitation on their growth and only several initial capillaries present in the model; moreover, cell apoptosis and vessel pruning has yet to be considered. in further renditions of the model, it will be important to test the effect of larger capillary networks; the presence of other cells and tissues; and the effect of apoptosis and vessel pruning.

while independent rules for migration and proliferation are a function of absolute vegf concentration, the driving force for angiogenesis predicted by the model is vegf gradient . the structure of the vasculature in the simulation changes over time, and this is caused by vegf gradients stimulating a directed growth with the described push-pull phenomenon associated with tip and stalk cells. the vegf gradient provides a chemical cue that promotes the motion of the tip cell. increases in vegf concentration alone do not have this effect, but rather increases speed and random motility of cells, in the model; this has also been supported experimentally  <cit> . once the leading node of the tip cell moves, the adjacent stalk cell elongates or grows to maintain contact and vessel integrity.

beyond what has been modeled and discussed so far, there are a number of other factors that influence vegf gradients and a cell's response to them. endothelial cells themselves may secrete vegf as they form a sprout. outside the primary source of vegf stimuli, cells such as pericytes, endothelial cell precursors and smooth muscle cells may influence vegf levels by secretion or physical position. extracellular matrix heterogeneity and the presence of different vegf receptor isoforms and heparin binding groups on cells would also alter the response to vegf gradients.

proliferation
we define the probability of proliferation of tip and stalk cells to be different, but the rate of proliferation, once initiated, to be the same. another way of representing observed differences in cell number between tip and stalk cells, would be to change the rate of proliferation, and keep the probability uniform. the rationale for using the first was that a tip cell has in the past been considered as nonproliferating, leading to a hypothesis that the ability to proliferate increases in different conditions, and that there are subpopulations of proliferating and nonproliferating tip cells.

knockout experiments: elongation, proliferation and migration
in the model, it is predicted that cell elongation has a significant effect on total vessel length . this is because elongation is the stimulus for cell proliferation and migration; without it, the cell may migrate to an extent, but will not proliferate until stimulated. the event knockout experiments of table  <dig> and figure  <dig> also reflect the extent to which stalk cell proliferation dominates tip cell proliferation. the total vessel changes in experiments  <dig> and  <dig> are nearly identical, where the difference between them is only that experiment  <dig> has both tip and stalk cell proliferation restricted whereas experiment  <dig> has just stalk cell proliferation restricted. furthermore, experiment  <dig> has a similar pattern of growth to experiment  <dig>  where again the only difference is the ability of the tip cell to proliferate in experiment  <dig> 

persistence
without a heavily biased directional preference by cells, the model predicts a very tortuous vascular network . these results were based solely on a search routine for a local gradient  combined with intrinsic cell persistence. this implies that a highly random movement of cells would be present in angiogenesis, even with a local chemotaxic signal, if the extracellular matrix had no effect on cell migration. alternately, this suggests that the sensing of growth factors like  goes beyond local changes, and requires sensing gradients at longer distances than a few microns. if a cell is sensitive to local changes in  on the order of microns, the latter hypothesis gives credence to a balance between gradient sensing at a longer distance scale  and local sensing at the cell surface. it has been shown that retinal endothelial cell filopodia can extend beyond  <dig> μm, and they are capable of sensing and responding to vegf via vegfr <dig>  <cit> . another study indicated endothelial cells can sense directionality in 3d collagen gel for distances of 600– <dig> μm  <cit> . these experimental observations support modeling persistence as a function of growth factor concentration as well as a function of the intrinsic probability of following a continuous path in a given direction.

delta-like ligand  <dig> signaling
delta-like ligand  <dig>  is a transmembrane ligand for notch receptors, and it is critical to vascular development. so important is dll <dig>  that like vegf, haploinsufficiency of the dll <dig> gene is embryonically lethal in many mice strains, as a result of extensive vascular defects  <cit> . dll <dig> is primarily expressed in endothelial cells, and correlated to the local concentration of vegf. the model predicts the effects of a dll4+/- on the phenotype of new vessel growth . in the dll4+/- knockout, the vessels show greater total vessel length compared to those in simulated controls . this increase results from a combination of an increase in the total number of sprout tips , greater tip cell proliferation rates, and greater degree of branching  in dll4+/- vasculature. the absolute magnitude of dll <dig> concentration could not be predicted in the current model, based on existing rules ; these rules can be amended as experimental data becomes available.

it is worthwhile to mention limitations of the current model in resolving existing experimental observations on dll <dig> effects during angiogenic sprouting. studies have indicated an increase in vessel diameter in notch-inhibited cell cultures  <cit> , while others have shown in dll4+/- retina microvasculature, vessel size is similar to wild type, and the increase in vessel density is attributed predominantly to increased sprout numbers  <cit> . the model represents the latter as a first approximation. it may be that both situations occur, depending on the local microenvironment, existing vasculature, and degree of dll4+/- and notch expression. furthermore, here we simplify the system by rules that define the effects of dll <dig> haploinsufficiency. in the future, dll <dig> expression being induced by vegf or dll <dig> downregulating the expression of vegfr <dig> merit consideration  <cit> . heterogeneity and location of dll <dig> and notch expression among the endothelial cell population may play a significant role in formation of sprouts, and vegf signal transduction. for example, transiently notch may be overexpressed by stalk cells, inhibiting the production of new sprouts  <cit> . currently, the model limits the number of tip cells present under different conditions , an implicit representation of the signaling that occurs to limit activated cells adjacent to a sprout from also becoming a sprout and disintegrating the integrity of the existing vasculature.

beyond restrictions in how the model represents dll4+/-, other limitations of the current model warrant discussion. in this model, numerous known biological entities and processes are not considered: hypoxic-induction of hif1; hif1-dependent regulation of vegf; isoforms of hif and hif's hydroxylation proteins; vegf isoforms; a non-uniform extracellular matrix; and matrix-cell interactions, beyond a general representation of how matrix composition contributes to migration ; vegf release from the extracellular matrix by endothelial cell-released mmps; the dynamics of basement membrane deposition around the stalk cell; the effects of parenchymal and stromal cells; and vessel retraction. experimentally, chemotaxis can generate neovascularization  <cit> , and for the current model, we neglected mechanical factors, including fluid shear stress and explicit changes in matrix stiffness. in future studies, it would be interesting to examine in detail, the contribution of mechanical cues, matrix density and haptotaxis on cell response in angiogenic sprouting, as well as all of the above-mentioned factors that influence angiogenesis.

other considerations include that capillary lumen and vessel diameter may change in response to angiogenic stimuli, as has been shown in hepatocellular and pancreatic tumors  <cit> . assuming that vegf concentration is constant is an initial simplification; in reality, during angiogenesis, endothelial cells uptake and may produce vegf.

there also remains a question as to how and when adjacent capillaries connect. in the current model, sprouts or vessels connect when in contact. further studies should elucidate how the sprout tip of one activates the other, and the degree to which the alignment and anastomosis of the capillaries is driven by collagen fibril alignment  <cit> . tip cell filopodia, whose length could be upwards of  <dig> μm in retinal endothelial cells  <cit> , may sense adjacent vessels and contribute to the formation of capillary anastomoses, as well. in vitro, endothelial cells have been shown to sense collagen gel alignment over 600– <dig> μm away  <cit> . additionally, average capillary length in experiments of angiogenic sprouting is reported with wide variability , and depends highly on the microenvironment  <cit>  and type of endothelial cell.

another possibility is that notch-delta signaling dictates the attachment of sprouting vessels to adjacent vessels. currently the model includes attachment of one vessel to an existing one, or two sprouts joining, randomly, when they physically touch. it is possible only two activated cells can join. along with testing out different means of vessel fusion, future model versions would explore the effects of apical-basal cell polarity, the necessary flipping of polarity during sprout formation and alterations in vacuole formation .

diverse approaches to computationally representing angiogenesis can yield similar results, particularly in relation to capillary network formation. examples are an energy-minimizing model  <cit> , a mechanical stimuli-based model, a two-dimensional cellular level model  <cit>  and a generic systems model  <cit> . the question then arises, how are these models related to one another? the methodology presented here allows different influences on cell growth, proliferation and other cellular processed to be considered explicitly and in accordance with experimental data.

one goal of this cell-based model is to build a general framework that would allow it to be combined with models of intracellular molecular interactions, and membrane receptor-ligand binding and signaling  <cit> . molecular models carry the advantage that individual compounds and reactions are often the building blocks for therapeutic development. the cell-level model, in turn, provides other benefits – modeling cell behavior at a level where not all molecular details are known, and when an event  or sequence of events governs capillary growth. we further the field of angiogenesis systems modeling by approaching scientific questions from the cellular and tissue level. as the focus of the current study was on the effects of cellular proliferation, migration and elongation on vessel growth – molecular details were not required to answer questions of interest. when tied to the molecular level models, a resulting multiscale simulation would be able to show how molecular interactions influence cellular behavior, which in turn determines tissue phenotypes  <cit> .

CONCLUSIONS
in sum, this cell-based in silico model of angiogenesis shows the relationship between growth factor gradients, receptor-ligand presence, cell sprouting, cell migration, cell elongation and cell proliferation in three dimensions. the model shows how representing random movement, persistence by intrinsic means, or persistence by a function of vegf concentrations alters phenotypic vessel length changes. furthermore, benefiting from the modularity of the computer methods, we demonstrated the effects of migration separate from proliferation on tip cell and stalk cell movement. finally, the model represents findings of how delta ligand changes influence capillary phenotype and presents a three-dimensional framework upon which to test and develop biologically realistic mechanisms underlying blood vessel growth.

abbreviations
hif1: hypoxia-inducible factor 1; pdgf: platelet-derived growth factor; vegf: vascular endothelial growth factor; mmp: matrix metalloproteinase.

authors' contributions
aq participated in the design of the study and its algorithms, programmed the computer codes, and performed computational experiments; asp participated in the design and coordination of the study. both authors read and approved the final manuscript.

supplementary material
additional file 1
appendices 1– <dig>  supplemental figures s1-s <dig> and tables s1-s <dig>  appendix  <dig>  description of the vegf gradient; appendix  <dig>  description of rules for cell movement; appendix  <dig>  methodology for computational analysis; appendix  <dig>  computational architecture; figure s <dig>  diagram for cell movement; figure s <dig>  graphs for parameter calculations for proliferation and migration rates; figure s <dig>  computer code hierarchy; figure s <dig>  example code for a rule; table s <dig>  variables for cell model and their initial values; table s <dig>  table of experimental value ranges for cell velocity in 2d and 3d.

click here for file

 additional file 2
movie s <dig>  cartoon of endothelial cell segment movement.

click here for file

 additional file 3
movie s <dig>  movie of dll4+/+, control conditions.

click here for file

 additional file 4
movie s <dig>  movie of dll4+/- conditions.

click here for file

 additional file 5
movie s <dig>  movie of dll4+/+ control conditions in 2d.

click here for file

 acknowledgements
this work was supported by nih grants ro <dig> hl <dig> and r <dig> hl <dig>  and nih 1f32hl085016- <dig> . the authors thank olga hudlicka, and members of our laboratory, feilim mac gabhann, james ji, emmanouil karagiannis, marianne stefanini, jae lee, mikhail basilyan, gang liu, david noren, and sravisht iyer, for critical discussions.
