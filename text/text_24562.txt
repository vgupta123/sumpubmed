BACKGROUND
phylogenetic studies are undergoing a massive jump in the scale of the molecular datasets used to estimate phylogenies, due to the ease of collecting hundreds of loci sampled throughout the genomes of non-model taxa . increasing the number of loci is expected to have a positive effect on phylogenetic estimation  <cit> . both simulation and empirical studies  demonstrate strong correlation between the number of independent loci and phylogenetic accuracy, though the exact number of markers required to resolve relationships varies depending on the informativeness of the markers, the method of inference used, the number of taxa, and the time-scale being examined. typically though, the ability to generate hundreds or thousands of loci that provide the appropriate amount of variation at differing time scales has been a challenge, especially across many non-model taxa. recently, two different next-generation sequencing  protocols have produced large datasets composed of generally longer loci  useful for estimating phylogenies at varying temporal scales—the ultra-conserved element procedure of faircloth et al.  <cit>  and the anchored phylogenomics approach of lemmon et al.  <cit> . these methods differ in the specific regions targeted and the numbers of loci produced, yet both produce orthologous markers across multiple, non-model taxa with substantial genetic variation for inferring phylogenies at both shallow and deep-time scales .

while generating dna datasets that cover the genome has become easier, estimating species-tree phylogenies with these data remains problematic  <cit> . multi-species coalescent methods that jointly estimate gene trees and species trees, such as *beast  <cit> , have proved robust for species-trees estimation. although these full-coalescent methods can be highly accurate when using relatively few loci , they may not be suitable for the large numbers of loci produced using ngs techniques due to computational time and a lack of convergence as the number of taxa or loci increases  <cit> .

alternatively, methods that use summarized information from user-provided gene trees to quickly estimate species trees, such as mp-est  <cit>  and star  <cit> , are promising for analyzing ngs datasets. these methods can accommodate many taxa and loci and have the statistically desirable properties of being accurate when used with large numbers of loci and low levels of missing data  <cit> . however, species-tree methods that depend on summarized gene-tree uncertainty may suffer when markers are short and uninformative  <cit>  or when incomplete-lineage sorting is not the main cause of gene-tree discordance . while the concern of uninformative markers can be circumvented by using high quality datasets , gene-tree discordance due to mutational variance or migration between species is a problem that still exists when estimating species trees even under a full-coalescent model such as *beast  <cit> . despite these potential challenges, summary statistics approaches remain a viable option for ngs dataset analyses and several recent empirical studies with these types of data have used mp-est and star to estimate well-resolved species trees that confirm previously hypothesized taxonomy as well as discover novel relationships , as well as basic morphology . this is unfortunate since pseudoxyrhophiines are unique among the world’s snake fauna as being the only island snake lineage where the majority of diversification takes place in situ on the island rather than through dispersal from the mainland  <cit> , potentially making pseudoxyrhophiines an excellent model system for determining what factors promote ecological and morphological diversification within a closed system.

of the currently recognized  <dig> species of pseudoxyrhophiine,  <dig> are endemic to madagascar , with the remaining taxa distributed in mainland africa , the comoros islands , and socotra . previous studies have indicated the african and socotran species are the sister lineage to a monophyletic radiation of malagasy/comoros taxa  <cit>  but this has not been supported by the most recent phylogenetic estimates for the group  <cit> . prior molecular phylogenetic studies have included up to  <dig> of the recognized species of pseudoxyrhophiinae for a single gene  <cit>  and no study has used more than  <dig> loci to determine relationships among the genera, with the majority of taxa having only 1– <dig> loci available  <cit> . these studies also used concatenated gene-tree methodologies, rather than species-tree approaches, which are more likely to be misleading when using small numbers of loci  <cit> . although under certain circumstances concatenation results in identical topologies when compared to a species trees  <cit> , empirical studies have demonstrated that concatenation may overestimate branch lengths, causing inaccuracies in downstream phylogenetic analyses .

using a ngs dataset comprised of  <dig> loci covering 77 % of the genera of pseudoxyrhophiinae, we first estimate species trees using the full dataset and the summary statistics approaches star and mp-est, and subsets of the loci using the multi-species coalescent method *beast. this is the first species tree to be produced for the subfamily, clarifying the intergeneric relationships of these snakes, and allowing us to more robustly examine the monophyly of the malagasy genera, specifically with respect to the african mainland genus duberria. recent studies have found duberria within a clade also containing the malagasy pseudoxyrhophiine genus compsophis, with this clade then sister taxon to the remaining malagasy pseudoxyrhophiines  <cit> . that relationship suggests that malagasy genera are not a single monophyletic radiation, which is a key assumption for future studies examining diversification of these snakes in madagascar  <cit> . second, using varying numbers of loci with different tree-inference methodologies, we compare the tree topologies estimated from the full ngs dataset  to smaller subsets of the ngs data , as well as to a typical, sanger-sequenced dataset comprised of five loci that are commonly used to infer squamate phylogenies. from these empirical results we determine if the numbers of loci and methods used influence phylogenetic inference for pseudoxyrhophiines.

methods
taxa sampled
we sampled  <dig> taxa:  <dig> pseudoxyrhophiines across  <dig> species, in  <dig> different genera and included two psammophiines as outgroups, mimophis mahfalensis, and rhamphiophis rubropunctatus. with the exception of the outgroup rhamphiophis rubropunctatus and the pseudoxyrhophiine parastenophis betsileanus, the same individuals were used for the sanger and anchored ngs methods .

ethics statement
all sample collection complied with the policies and guidelines of relevant institutions, including the ministries des eaux et forêts, madagascar national parks, the université d’antananarivo, departement de biologie animale, the university of michigan museum of zoology, and the american museum of natural history.

dna extraction and sanger sequencing
dna was extracted using a quiagen® dneasy kit, following the tissue protocol. sanger sequencing was used to sequence five loci that have been previously utilized to infer squamate phylogenies  <cit> . this dataset consisted of two protein-coding mitochondrial genes , two nuclear protein-coding genes , and one nuclear intron  . sanger sequencing was performed at the american museum of natural history on an abi  <dig> sequencer. sequences were edited and aligned using the geneious alignment algorithm in geneious® v. <dig> . <dig> and checked by eye to ensure that protein coding loci did not contain stop codons.

anchored phylogenomics locus selection and probe design
we used the following approach to identify a set of loci that could be obtained efficiently in snakes using anchored hybrid enrichment. first, in order to improve gene-tree resolution, we increased the size of each target region described in  <cit>  to approximately  <dig> bp by including flanking regions that contained sufficient sequence conservation between homo and anolis. because some of the original anchor regions were near each other, some of these loci were joined to form a single locus. loci that performed poorly in  <cit>  were removed. the resulting locus set contained  <dig> loci comprising a total of  <dig>  bp target region . in order to improve the capture efficiency for snakes, we also obtained homologous sequences from the python molurus genome  and 15× genomic reads obtained for the brown reed snake calamaria pavimentata . after aligning the anolis, python, and calamaria sequences using mafft  <cit> , alignments were trimmed to produce the final probe region alignments , and probes were tiled at approximately  <dig> x tiling density per species .

the ngs dataset was generated by the center for anchored phylogenetics  <cit>  using the anchored hybrid enrichment methodology described by  <cit> . we used a covaris e <dig> focused-ultrasonicator to fragment each genomic dna sample to a fragment size of ~150– <dig>  a beckman-coulter biomek fxp liquid-handling robot was then used to prepare indexed illumina libraries following protocol modified from meyer and kircher  <cit>  . a single pool containing all of the libraries was then enrichment for the target using an agilent custom sureselect kit  that contained the probes described above. the enriched library pool was then sequenced on  <dig> pe <dig> illumina hiseq <dig> lane by the translational science laboratory in the college of medicine at florida state university.

ngs data assembly
paired reads were merged following  <cit> . briefly, for each degree of overlap for each read we computed the probability of obtaining the observed number of matches by chance, and selected degree of overlap that produced the lowest probability, with a p-value less than 10− <dig> required to merge reads. when reads were merged, mismatches are reconciled using base-specific quality scores, which were combined to form the new quality scores for the merged read . reads failing to meet the probability criterion were kept separate but still used in the assembly. between  <dig> and 75 % of the sequenced library fragments had an insert size between  <dig> bp and  <dig> bp.

the reads for each sample were assembled into contigs using a reference assembly approach to map reads to the calamaria probe regions and a de-novo assembly approach to extend the assembly into the flanks . the reference assembler uses a library of spaced 20-mers derived from the sites conserved across squamates. a preliminary match resulted if at least  <dig> of  <dig> matches existed between the positions in a read and the corresponding positions in one of the spaced. reads obtaining a preliminary match were then compared to the calamaria, with greater than  <dig> matches out of  <dig> was considered a significant match. approximate alignment positions of mapped reads were estimated using the position of the spaced 20-mers, and all 60-mers existing in the read were stored in a hash table used by the de-novo assembler. the de-novo assembler identifies exact matches between a read and one of the 60-mers found in the hash table. simultaneously using the two levels of assembly described above, the read files were traversed repeatedly until an entire pass through the reads produced no additional mapped reads.

mapped reads were then clustered for each locus into clusters using 60-mer pairs observed in the reads mapped to that locus. in short, a list of all 60mers found in the mapped reads was compiled, the 60-mers were clustered if found together in at least two reads. the 60-mer clusters were then used to separate the reads into clusters for contig estimation. relative alignment positions of reads within each cluster were then refined in order to increase the agreement across the reads. up to one gap was also inserted per read if needed to improve the alignment. note that given sufficient coverage and an absence of contamination, each single-copy locus should produce a single assembly cluster. low coverage , contamination, and gene duplication, can all lead to an increased number of assembly clusters. a whole genome duplication, for example would increase the number of clusters to two per locus.

consensus bases were called from assembly clusters as follows. for each site an unambiguous base was called if the bases present were identical or if the polymorphism of that site could be explained as sequencing error, assuming a binomial probability model with the probability of error equal to  <dig>  and alpha equal to  <dig> . if the polymorphism could not be explained as sequencing error, the ambiguous base was called what corresponded to all of the observed bases at that site . called bases were soft-masked  for sites with coverage lower than  <dig>  a summary of the assembly results is presented in the additional files .

in order to filter out possible low-level contaminants, consensus sequences derived from very low coverage assembly clusters  were removed from further analysis. after filtering, consensus sequences were grouped by locus  in order to produce sets of homologs. orthology was then determined for each locus using a distance-based approach. first, a pairwise distance measure was computed for pairs of homologs by computing the percent of 20-mers observed in the two sequences that were found in both sequences. the list of 20-mers was constructed from consecutive 20-mers as well as spaced 20-mers  in order to allow increased levels of sequence divergence. finally, we clustered the sequences using the distance matrix and a neighbor-joining algorithm that allowed at most one sequence per species to be assigned to a cluster. only clusters containing at least 50 % of the species were utilized downstream.

following orthology assessment, sequences in each orthologous set were aligned using mafft v <dig> b  <cit> . the flags --genafpair and --maxiterate  <dig> were utilized. the alignments for each locus was masked/trimmed in three steps. first, each alignment site was identified as “good” if the most common character observed was present in >50 % of the sequences. second,  <dig> bp regions of each sequence that contained < <dig> good sites were masked. third, sites with fewer than  <dig> unmasked bases were removed from the alignment.

phylogenetic analyses
we estimated species trees using the summary statistics methods star  <cit>  and mp-est  <cit> . the star method estimates the species tree from a distance matrix constructed from the average ranks of gene-coalescence events from gene trees, while mp-est estimates the species tree from gene trees by maximizing a pseudo-likelihood function of the triplets  of the species tree. both of these methods require user-provided gene trees for all loci and allow for some missing data. we generated maximum-likelihood gene trees for all loci  using raxml v. <dig> . <dig>  <cit>  under the gtrgamma model. for each locus, we performed  <dig> bootstrap replicates, which permits error estimates to be generated on the species trees; this entire process was streamlined using a perl-scripted pipeline developed by ftb and a. narechania  <cit> . we used the species tree analysis web server  <cit>  to run all star and mp-est analyses. the star and mp-est programs were run using several different subsets of loci. for the sanger dataset, we used the complete dataset of  <dig> loci and subsets of  <dig> loci ,  <dig> loci , and  <dig>  loci. for the ngs dataset, we randomly subsampled the entire 377-locus dataset into  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>  and 3-locus datasets; these subsets were run five times using different sets of random loci to determine, on average, how discordant the resulting trees were compared to the 377-locus species trees. the topological comparisons between all trees were performed using robinson-foulds  distances in the r statistics platform  <cit>  using the package phangorn  <cit> . the rf distance is a metric that determines the number of bipartitions that differ between trees to indicate the amount of topological discordance between two trees  <cit> . to show relative differences between the trees using the rf distances, we used the percentage of the maximum rf distance, which was calculated using  <dig>  where n is the number of taxa, and n -  <dig> represents the maximum number of inner branches for a rooted tree  <cit> . the % rf distance between trees is the ratio of the rf distance divided by the maximum rf distance. we also used the coefficient of variation for each locus-set to determine in the mp-est and star analyses at what point increasing the number of loci reached diminishing returns, where additional loci no longer resulted in an improvement to the species tree; this is indicated by the lowest coefficient of variation value for each locus set. we also compared the ngs and sanger species trees using the same numbers of loci  to examine how similar the resulting trees are topologically when using the same numbers of loci, again using rf distances.

we next used raxml to generate concatenated trees using the complete 377-locus ngs dataset and the complete 5-locus sanger dataset; the sanger dataset was partitioned by locus and codon position for the protein coding genes .. these results were compared with the explicit species-tree approaches using % rf distances. to determine how locus number affects bootstrap-support values for the species trees, a mean bootstrap value was taken across the entire tree for each of the ngs subset species trees  and then averaged across the five replicates for each of those subset species trees.

although the complete 377-locus ngs dataset is too large for the full-coalescent species-tree model implemented in *beast  <cit> , we ran an additional series of species trees with subsets of  <dig> loci to determine if this method could estimate the same topology as the full 377-locus dataset using mp-est and star. a recent study of chickadee phylogenetics  <cit>  found that among several coalescent-based species-tree inference methods, *beast was the most robust and consistently converged on the same tree estimated from the authors’ full dataset  when using  <dig> loci. we took five random subsets of  <dig> ngs loci and estimated five species trees using *beast  <cit>  in beast v <dig>   <cit> . in addition, we also ran *beast on the 5-locus sanger dataset to determine how well it performed using a dataset similar to those typically used to infer squamate phylogenies. we used jmodeltest v <dig> . <dig>  <cit>  with the bayesian information criteria to choose the most appropriate model of sequence evolution for each locus in the *beast analyses, as *beast allows for multiple models . as in our star and mp-est analyses mimophis mahfalensis and ramphiophis rubropuntatus were used as outgroups. the *beast analyses were run for  <dig> ×  <dig> generations each using a log-normal relaxed clock model, a yule-process speciation prior, and were sampled every  <dig> generations. tracer v <dig>   <cit>  was used to assess stationarity for each of the runs and determine burnin. a summary table of the various methods used with the different datasets and loci is included as an additional file .

to visualize congruence between resulting gene trees and the species trees, we used the program metatree  <cit> . metatree builds a “tree-of-trees” that shows the relationships between alternative phylogenies. this program takes user-inputted phylogenies with fixed sets of taxa to construct a tree that clusters similar topologies together, allowing the user to examine a set of trees and determine how similar topologies are to one another; here we use this program to examine whether gene trees from both the sanger and ngs datasets are similar to the species tree topology. for our metatree analyses, we compared the gene trees from the sanger dataset to the 377-locus species tree. since micropisthodon and rhamphiophis were not available for all of the sanger loci , they were not included and pruned from the species tree for that comparison. for the ngs metatree analysis, we used subsets of  <dig> gene trees  from the ngs dataset  to compare to the 377-locus species tree.

RESULTS
sequencing
for the sanger dataset, sequences were aligned in geneious® using the geneious alignment algorithm and were checked by eye to assure no gaps in protein-coding genes. the five loci ranged from a minimum of  <dig> %  to a maximum of 20 %  uncorrected pairwise divergence across taxa , with a mean of 10 % uncorrected pairwise divergence for all loci. for all taxa, parsimony informative sites  = 26 % of sites  and for ingroup taxa only, pi = 25 % of sites . all but one locus had at least  <dig> of the  <dig> taxa .

for the ngs dataset,  <dig> loci were successfully sequenced for an average of  <dig>  bp per sample before trimming. a total of  <dig> loci remained after filtering and orthology assessment. the resulting dataset after aligning in mafft and trimming/masking as described above contained  <dig>  alignment sites. loci ranged in length from 424– <dig> bp, with a mean locus length of  <dig> bp. the matrix had very little missing data . all loci had at least one representative from each genus;  <dig>  % of loci  included all  <dig> terminal taxa, and  <dig>  % of loci  included  <dig> of the  <dig> taxa, with a single locus missing two taxa. the uncorrected pairwise divergence for loci ranged from  <dig>  −  <dig>  % divergent, with a mean of  <dig>  % divergence across the matrix. for all taxa across all loci, pi = 8 % of sites  and for ingroup taxa, pi = 6 % of sites ; the mean pi per locus =  <dig> bp for all taxa and  <dig> bp for ingroup taxa.

phylogenetic estimates
the star and mp-est species trees inferred for pseudoxyrhophiinae using the complete 377-locus ngs dataset were identical . this is our preferred tree for all subsequent topological comparisons and we consider it the species tree for the pseudoxyrhophiines throughout the remainder of the manuscript, as it was estimated using species-tree methods, included the most data and was topologically identical across a variety of methods. the concatenated 377-locus tree and all five replicates using  <dig> random ngs loci in *beast were also identical to the pseudoxyrhophiine topology of the 377-locus species tree , while the 5-locus sanger *beast tree differed slightly from the full ngs dataset species tree . all *beast runs were found to reach stationarity by  <dig> ×  <dig> generations, with no trends in the trace plots suggesting that the mcmc had not converged; we discarded the first 25 % of generations as burnin. effective sample size values were high  for almost all parameters. the mean rf distances for the ngs datasets of 3– <dig> loci varied from 1 − 21 %  when compared to the 377-locus species tree. species trees inferred using greater numbers of loci produced more similar topologies with respect to the 377-locus species tree; as locus number increased, mean rf distances generally decreased and mean bootstrap support values generally increased . at ≥ <dig> loci, the placement of a single taxon, liopholidophis  is responsible for all discordance among the ngs subset trees and the 377-locus species tree and the coefficients of variation calculated for mp-est and star indicated that after  <dig> loci, increasing locus number did improve the topology with respect to matching the 377-locus species tree . the species trees and concatenated trees from the sanger datasets had rf distances similar to those from the ngs subsets of < <dig> loci when compared to the 377-locus species tree, with none being identical to the species tree .fig.  <dig> species tree for the pseudoxyrhophiines using star and mp-est  based on the 377-locus ngs data set. bootstrap values are  <dig> for all nodes except those labeled with the star value first, followed by the mp-est value. photos cjr & sr

note that the mp-est, star, and concatenated trees for the  <dig> loci ngs datasets were identical and so are in one column

fig.  <dig> ngs dataset mean robinson-foulds  % distances for each species tree  with respect to the number of ngs loci used  compared to the 377-locus species tree and the mean bootstrap values for each species tree  with respect to the number of loci used 



mean bootstrap values generally increased for the ngs species-tree analyses as the number of loci increased . the bootstrap values for the 377-locus trees were high for both methods of species-tree inference, with the placement of only two taxa supported < <dig>  . the runs from *beast generally gave high posterior probability support for the same nodes, with the same two taxa  having lower posterior probability values . interestingly, the concatenated 377-locus tree had slightly higher support values, with only one of the nodes having a value < <dig>  . this is in contrast to the bootstrap values for the concatenated 5-locus sanger tree, which had a lower mean bootstrap value of  <dig>  across the tree versus  <dig>  for the concatenated 377-locus tree.

for the metatree comparison of the sanger dataset to the 377-locus species tree, each sanger gene has a unique topology and none of the sanger gene trees were closely clustered with the 377-locus species tree, with the two mtdna gene trees  and rag <dig> gene tree being the most discordant . the branches for the gene trees are also relatively long, indicating high degrees of conflict between the topologies and have few shared splits between trees  <cit> . for the ngs gene trees compared to the 377-locus species tree, few of the gene trees were similar to the full species tree and no gene trees were identical to the species tree; no gene tree topologies were identical to each other as well. we present these results to illustrate the large range of discordance between the species tree and the various gene trees with both the sanger and ngs data; for brevity, one metatree set of  <dig> loci is shown in comparison with the species tree .fig.  <dig> metatree visualization showing similarity of the species tree topology  with that of the  <dig> sanger loci gene trees  and  <dig> ngs loci gene trees . the species tree is labeled for each. sanger loci gene trees are indicated by locus name, ngs loci gene trees are indicated by number. in both data sets no gene trees were identical to the species tree



within pseudoxyrhophiines, the three genera with multiple species were monophyletic in all analyses. several of the resulting clades have been recovered by other studies ;  <cit> . our species tree  also provides well-supported placement for some enigmatic taxa such as elapotinus picteti , which was found as the sister taxon to a clade including liophidium, liopholidophis, pseudoxyrhopus, heteroliodon. we also find strong support for a single monophyletic malagasy clade of pseudoxyrhophiines with respect to the african taxon duberria. we discuss the taxonomy of the group in detail below.

availability of supporting data
the datasets supporting the results of this article and the information pertaining to the anchored loci probes are available in the dryad repository .

discussion
phylogenetic inference and dataset size
the number of loci required to accurately infer phylogenies has generally been addressed in a theoretical framework, but how this translates for empirical studies has not been extensively examined. here, using datasets with varying numbers of loci and multiple phylogenetic methods, we estimate a well-supported species tree for pseudoxyrhophiine snake genera that suggests a monophyletic radiation of these snakes on madagascar. identical tree topologies were inferred using datasets of both  <dig> and ≥ <dig> loci, but the number of loci necessary for accurate inference depends on the species-tree method.

when using the summary statistics methods star and mp-est, large numbers of loci  are required to consistently produce phylogenies equal to those using all  <dig> loci and that the differences between topologies generally decreases as more loci are added to the analyses . these results are comparable to another recent empirical study which found that increasing locus number improved topological estimates, but that ultimately the number of requisite loci plateaued  <cit> . there is a threshold where increasing the number of loci no longer provides greater resolution; for our dataset this is ~ <dig> loci for both star and mp-est  with bootstrap-support values increasing similarly . while star and mp-est generate strongly supported trees for pseudoxyrhophiines, which is likely due in part to the high quality loci in our dataset, these methods may fail when gene trees are estimated from short, uninformative loci  <cit> . additionally, despite the overall increase of support values as loci number increases, the position of some taxa remain poorly supported regardless of the number of loci included . in particular, the instability of one taxon  is responsible for all topological discordance at  <dig> or more loci with respect to the subset ngs trees and the 377-locus tree. this suggests that some taxa may remain problematic regardless of how many loci are included. similarly, a recent study of major snake lineages using  <dig> anchored phylogenomics loci and species-tree methodologies found low support values within lamprophiids, the family to which pseudoxyrhophiines belong  <cit> . previous work indicates that including more individuals per species increases phylogenetic accuracy  and future studies with multiple individuals per species and full species sampling per genus will determine whether more complete sampling provides better resolution for the weakly supported taxa in the pseudoxyrhophiine phylogeny.

in contrast to the summary statistics methods requiring ≥ <dig> loci, we found that with only  <dig> loci, *beast consistently inferred the same pseudoxyrhophiine topology as the 377-locus trees from star and mp-est. this suggests that for smaller datasets , full-coalescent methods may outperform other types of species-tree analyses requiring more loci, though the generality of this trend should be investigated. while the matching topologies of the 15-locus *beast analyses and all other methods using the complete dataset make us confident in the results from *beast here, we acknowledge that full coalescent analyses such as *beast should ideally include multiple individuals per terminal taxon, as this greatly improves all aspects of tree estimation  <cit> . estimating population sizes in particular requires at least two individuals per species  <cit> , as well as greater numbers of loci when compared to accurately estimating only the tree topology  <cit> . the results presented here may not be typical when including population-level sampling, poorly defined species, or very large numbers of taxa, since these scenarios may result in shorter branch lengths and represent recent time-scales, which likely require larger numbers of loci for good resolution and support  <cit> . furthermore with a dataset that includes hundreds of species, coalescent-based methods such as *beast are unsuitable due to computational time and failure of parameters to converge  <cit> .

unlike the 15-locus ngs subsets used in *beast, the 5-locus sanger dataset was unable to recover the same topology as the 377-locus tree, despite these particular loci having higher average numbers of parsimony informative sites compared to the ngs loci . when using star and mp-est, neither the sanger datasets nor ngs subsets of 3– <dig> loci resulted in species trees congruent with the 377-locus tree . interestingly, the most congruent tree using 3– <dig> loci was produced using the complete 5-sanger locus dataset in *beast , further demonstrating that for small datasets, a full-coalescent model approach may yield the most accurate topology. full-coalescent-model approaches may be robust to low numbers of loci for topological inference when a high proportion of gene trees match the species tree  <cit> . however, our results indicate that datasets of ≤ <dig> loci within any of the species-tree frameworks do not generate trees that fully correspond to the 377-locus tree for pseudoxyrhophiines . additionally, neither of the two mtdna gene trees  closely matches the species tree, further underscoring that mtdna gene trees, at least in this case, do not suitably represent the species tree . while many studies use mtdna gene trees as a proxy for the species tree, our results suggest that relying entirely on a single locus, whether mitochondrial or nuclear, is a potentially risky practice. it is likely that estimating credible species trees using small numbers of loci with conflicting gene-tree histories is impossible. simulations have shown that when the majority of gene trees are highly discordant with the species tree, as many as  <dig> loci are necessary to recover the species tree in a coalescent-based framework  <cit> . similar to our sanger dataset results, an empirical study on lizards  <cit>  using varying numbers of loci found that when estimating trees with four loci, *beast was unable to correctly infer the species tree, even when only the most informative loci were included. therefore if a reduced set of loci are discordant it is expected that numerous additional markers are required to generate a credible species tree.

we find no topological difference for the pseudoxyrhophiines between the 377-locus concatenated tree and the 377-locus species tree . it is expected that when incomplete lineage sorting is low, which is likely when population sizes at the time of speciation are small and the time between speciation events is long, concatenation may accurately infer species relationships , especially at deep time scales  <cit> . however, incomplete lineage sorting can still be pervasive at deeper time scales and coalescent-based species-tree methods are able to account for this  <cit> . furthermore, concatenation may overestimate branch-lengths  <cit>  and result in positively misleading support values  <cit> . finally, species-tree methods may be better suited to modeling the phylogenetic signal of very large datasets compared to concatenation .

pseudoxyrhophiine generic relationships
the 377-locus species tree for the pseudoxyrhophiines presented here is well supported ; although several  genera missing from this analysis , taxonomic relationships are largely similar to those found in prior studies with respect to affinities between genera based both on morphology as well as molecular datasets, as is much of the overall structure of the tree . we found two major clades of pseudoxyrhophiines: one which includes the genera alluaudina, compsophis, dromicodryas, thamnosophis, elapotinus, liophidium, liopholidophis, pseudoxyrhopus, and heteroliodon and a second that includes leioheterodon, parastenophis, phisalixella, madagascarophis, langaha, micropisthodon, and ithycyphus.

the major subdivision of this malagasy snake radiation, in two approximately equally diverse clades is intriguing, in that this largely corresponds to a division of the aglyphous genera  and opisthoglyphous genera . historically, this tooth character was considered important for classifying snakes , and was used to organize the most recent monographic treatment of the malagasy snakes  <cit> . all genera in the alluaudina, compsophis, dromicodryas, thamnosophis, elapotinus, liophidium, liopholidophis, pseudoxyrhopus, and heteroliodon clade are aglyphous, with the exception of alluaudina and compsophis. similarly, all genera in the leioheterodon, parastenophis, phisalixella, madagascarophis, langaha, micropisthodon, and ithycyphus clade are opisthoglyphous with the exception of leioheterodon and micropisthodon. it is worth noting that leioheterodon have enlarged rear teeth, and are known to be capable of mild envenomation  <cit> ; and that more generally, the dentition of most of the rarer malagasy snakes have not been recently re-evaluated. nevertheless, our results presented here do suggest that the evolution in dentition, envenomation, and thus feeding strategies, may have influenced the early diversification of the pseudoxyrhophiine radiation, though the impact of these traits on the evolution of these groups requires further testing.

inclusion of the continental african pseudoxyrhophiine genus duberria allows us to address the biogeography of pseudoxyrhophiines in africa and madagascar. many prior studies have supported a single dispersal event from continental africa to madagascar for the pseudoxyrhophiines, with the african taxa amplorhinus and duberria and the socotran ditypophis as sister taxa to the malagasy species  <cit> . this suggests the malagasy species are monophyletic, with subsequent dispersal to the comoros islands  <cit> . however, not all previously used datasets/tree-methodologies, even within the same publications, support this scenario, and there is also some evidence for ditypophis and/or duberria nested within malagasy taxa  <cit> . since we do not include amplorhinus or ditypophis here, we cannot directly comment on their position or biogeographic origins, but our results strongly suggest that the malagasy genera form a monophyletic group with respect to duberria. while we do not show all of the summary-statistics species trees generated from the ngs subsets of loci, we note that 81/ <dig> of those species trees place duberria as the basal taxon to a monophyletic malagasy pseudoxyrhophiinae. future datasets including amplorhinus and ditypophis will allow further exploration regarding the biogeography of both continental african and malagasy pseudoxyrhophiines. within the aglyphous clade, the genera elapotinus, heteroliodon, liopholidophis, liophidium, pseudoxyrhopus have been previously referred to as the “pseudoxyrhopus group”  and were originally united based on hinged teeth and tooth replacement pattern  <cit> . the exact placement of liopholidophis within this clade remains somewhat unclear as it is poorly supported in our species tree , but importantly all of the discordant trees do place liopholidophis within this clade. previous molecular-based studies have indicated that liopholidophis may be the sister taxon to liophidium  <cit>  but most studies  <cit>  have found the same relationship presented here, with liopholidophis being the sister taxon to heteroliodon + pseudoxyrhopus, and liophidium in turn being the sister taxon to this inclusive clade. although none of these prior studies have included all five genera in the same analysis, our results show the same relationships reported in previous studies . additional sampling within these genera will help determine if these genera are all monophyletic or if heteroliodon renders pseudoxyrhopus paraphyletic, as has been previously suggested  <cit> .

the remaining aglyphous genera include two sister taxon pairs; thamnophis + dromicodryas, and alluaudina + compsophis. thamnosophis  and dromicodryas are both diurnal and active terrestrial predators, sharing external morphological similarities  <cit> . a sister-taxon relationship between these genera has been indicated by prior studies  <cit> , and our results continue to support this relationship, as well as the recognition of thamnosophis as distinct from liopholidophis .

alluaudina and compsophis have been shown to share morphological characters with respect to hemipenes  <cit>  and several molecular studies have found alluaudina and compsophis as sister taxa  <cit>  as we do here . however, at least one recent molecular study  <cit>  indicates that compsophis is sister to ditypophis and part of the clade that includes the mainland african/socotran taxa . we find very high support for compsophis being the sister taxon to alluaudina , rather than being placed in a clade with duberria, similar to other studies where ditypophis, duberria, and/or amplorhinus fall outside of the malagasy pseudoxyrhophiines  <cit> .

within the mostly opisthoglyphic clade of pseudoxyrhophiines, the currently monotypic parastenophis was formerly a subgenus within the genus stenophis , which also included the currently recognized species in the genera phisalixella and lycodryas. however, as was suggested in a taxonomic revision of stenophis  <cit>  and noted in other molecular studies  <cit> , it appears that parastenophis, a nocturnal tree-snake, is the sister taxon to the large, diurnal and terrestrial malagasy hognose snakes, leioheterodon. the highly disparate morphology, ecology, and behavior between these sister genera  <cit> , is intriguing and deserves further investigation. although lycodryas was not included in the present study, previous work  <cit> , as well as our own unpublished results, indicate that lycodryas is likely the sister taxon to phisalixella. both of these genera share very similar morphologies, and are nocturnal tree-snakes, that until recently were also included in the genus stenophis  <cit> . as previously suggested  <cit>  and indicated in our species tree here , the sister taxon to phisalixella  is the similarly nocturnal and elliptical-pupiled madagascarophis. madagascarophis is a broadly distributed group of snakes in madagascar that is also partly arboreal, but lacks the lateral body flattening and slender necks of phisalixella and lycodryas.

the remaining clade within the opisthoglyphic pseudoxyrhophiines contains langaha, micropisthodon, ithycyphus, which are mostly diurnal and arboreal snakes . these relationships have been supported by previous molecular studies  <cit> . although the support for micropisthodon + ithycyphus is the lowest for any node in the species tree , it was consistently inferred in the species-tree analyses even when using subsets of the ngs dataset and was also found with high support values in the aforementioned studies. the behavior and ecology of micropisthodon and langaha are not yet well described, and the evolution and function of the unique head ornamentation in langaha still not clearly understood  <cit> .

CONCLUSIONS
the phylogeny presented here is a first step in using large-scale phylogenomic data to determine relationships for snakes of madagascar. this phylogeny, produced using both summary statistics and full-coalescent models for species-tree estimation, is well supported and shows a monophyletic clade of malagasy pseudoxyrhophiines. within this radiation of snakes madagascar, we also find strong support for two major subclades which largely correspond to the aglyphous and opisthoglyphous genera, and thus different forms of tooth venom delivery. our results suggest that while hundreds of loci are not always essential for accurate topological inference, the method used for tree estimation may affect the resulting phylogeny and that for smaller datasets , full-coalescent models of tree inference are likely more accurate than summary statistics methods. because full-coalescent model-based methods are unable to computationally handle large amounts of data, these summary statistics provide essentially the only current option for generating species trees using hundreds of loci obtained from hundreds of taxa. importantly, our results indicate that summary statistics methods, given enough loci , are able to estimate a robust species tree comparable with a full-coalescent model method. however, whether these results are applicable across different study systems is not known and it is unclear if other datasets will give similar results with respect to the numbers of loci necessary for inferring tree topologies with the methodologies used here. using the maximum number of loci available may be the best strategy for resolving trees, though this does not account for time and expense for developing probes and sequencing these loci. considering the alternative, where the investigator uses the minimum number of loci due to time or financial constraints, it would be difficult to know a priori which loci in combination yield trees with the most resolution and highest node support. future ngs studies that include a far more complete sampling of species, and even populations for broadly distributed pseudoxyrhophiine taxa, will inevitably improve our ability to estimate relationships among species, and thus provide the groundwork to examine biogeography and diversification processes that generated this spectacular insular snake diversity.

additional files
additional file 1: 
samples used in analyses and which loci were successfully sequenced . 

additional file 2: 
pcr and sequencing protocols. all pcr reactions were  <dig> μl reactions consisting of  <dig> μl of gotaq® green master mix,  <dig> μl of h2o,  <dig>  μl each of forward and reverse primers at a  <dig> μm concentration, and  <dig> μl of dna extract. samples were incubated at  <dig> °c for  <dig> min initially,  <dig> °c for  <dig> s, followed by  <dig> s at the appropriate temperature for the primer pair , with a  <dig> °c extension period for  <dig> min. this procedure, minus the initial  <dig> min incubation period, was repeated for  <dig> cycles. reactions were cleaned with  <dig> μl of exosap-it® following the exosap-it® protocol. sequencing reactions used the same primers as for the pcr reactions. we used the bigdye® terminator v <dig>  cycle sequencing kit; each sequencing reaction consisted of  <dig>  μl of abi bigdye® terminator ready reaction mix,  <dig>  μl of abi bigdye® 5x sequencing buffer,  <dig>  μl of h2o,  <dig> μl of the cleaned pcr reaction template, and  <dig>  μl of the  <dig> μm primer for each direction. sequencing reactions were incubated initially at  <dig> °c for  <dig> min, followed by  <dig> °c for  <dig> s,  <dig> °c for  <dig> s, and  <dig> °c for  <dig> min  <dig> s and repeated for  <dig> cycles, minus the initial  <dig> min incubation period; the reaction was then incubated at  <dig> °c for  <dig> s,  <dig> °c for  <dig> s, and  <dig> °c for  <dig> min  <dig> s and repeated for  <dig> cycles; the reaction was then incubated at  <dig> °c for  <dig> s,  <dig> °c for  <dig> s, and  <dig> °c for  <dig> min and repeated for  <dig> cycles. sequencing reactions were cleaned prior to sequencing using ethanol precipitation. 

additional file 3: 
summary of the anchored phylogenomics assembly results. 

additional file 4: 
tree estimation methods, with the dataset type  and the number of loci used with each method. 



competing interests

the authors declare that they have no competing interests.

authors’ contributions

sr produced the sanger dataset, conducted the analyses, contributed to the conception of the study, and drafted the manuscript. cjr contributed to the conception of the study, helped to draft the manuscript, and contributed to the sample collection. arl & lml produced the anchored phylogenomics dataset. ftb contributed to the conception of the study and helped to draft the manuscript. all authors contributed to the editing of the manuscript and approved the final version.

