BACKGROUND
transcription factors  are major players in the regulation of gene activity. they bind to dna target sequences known as transcription factor binding sites  in order to up- or down-regulate transcriptional activity. as dna binding is pivotal to correct tf function, mutations in tfbss can lead to genetic disease  <cit> .

however, despite the rapid growth in the number of mutations known to cause mendelian disorders, the number of confirmed mutations in regulatory sequences is still low, presumably due to difficulties in experimentally verifying their functional relevance as the cause of a given disease.

with each deep sequencing run a large number of dna variants are found, many of which may be considered as potentially causing mendelian disorders, even after bioinformatic filtering. hence the main challenge is currently not the generation, but the interpretation of the data. while considerable progress has been made at the in silico analysis of alterations in the protein coding sequences , these prediction tools address the role of variants within potential regulatory sequences only indirectly, e.g. via their evolutionary conservation, or the simple fact that a variant occurred somewhere within a confirmed regulatory element. we thus set out to examine and compare the relevance of methods for computational tfbs recognition as a means to assess the disease-causing potential of genetic variants.

currently, the state-of-the art method for functionally representing tfbss is via transcription factor binding models that are described by matrices, such as position-specific scoring matrices , also called position weight matrices . these pssms are normalised representations of the position-specific log-likelihoods of a nucleotide’s probability to occur at each location in an observed sequence  <cit> . pssms can be used to computationally detect putative tfbss in regulatory regions by establishing a match score, which determines how well a given sequence matches with a tf binding model.

a manually curated census in the year  <dig> counted  <dig> tfs in humans  <cit> . this number has grown since then—estimates for the total number of human tfs currently range between  <dig> and  <dig>  <cit> . however, only a fraction of these factors have been studied intensely enough to generate reliable binding models; the encode  project, for example, offers one of the largest collections of experimentally verified binding instances, but only covers  <dig> different tfs  <cit> .

moreover, various other repositories of tf binding models exist that have been obtained by different methods, but still fall short to represent the predicted tf landscape in humans. the largest of these repositories, transfac  <cit> , is not freely available and has therefore not been included into this survey. the human protein-dna interactome   <cit>  contains matrices for  <dig> human tfs generated through protein-binding microarrays , whereas a recent publication  <cit>  determined over  <dig> matrices for  <dig> human tfs via an ht-selex experiment. ht-selex enables the identification of dna target strands through a large library of artificially generated oligonucleotides, which are presented to a target protein. bound sequences are amplified by pcr, followed by several rounds of selection processes to determine the best-bound sequences. it is not surprising that binding models derived from different experimental methods can show highly different success rates in modelling tf-dna binding. however, for a long time it was impossible to compare the quality of binding models that had been obtained by various methods due to the lack of sufficient experimental data.

therefore, only recently a direct comparison between tf models derived from pbm and ht-selex-experiments has been published  <cit> . this study found models generated through both experimental strategies to be quite similar for in vitro binding, whereas for in vivo prediction ht-selex-derived models achieved better results.

here we present a larger study in which we set out to compare a total of  <dig> pssms linked to  <dig> different tfs that derived from the following three sources: ht-selex, pbm, and the manually curated binding models provided by jaspar  <cit> . almost all of the  <dig> jaspar matrices  used in our study resulted from chip-seq experiments, only two, aimed at nfic and rela, were generated by ht-selex experiments. we tested all models for their capability to recognise chip-seq confirmed functional  tfbss from the encode project  <cit> . due to the presence of several tfs in more than one binding model source, we were able to directly compare matrices linked to  <dig> different tfs from jaspar and ht-selex, thereby enabling a quality assessment of binding models obtained through different experimental methods. for this study, we created two test sets, one comprising all suitable tfbss from encode and another one which includes only those tfbss with a high binding score . we used the same number of length-matched exonic sequences as a tfbs-depleted control set.

this study is to our knowledge the largest comparison of tf binding models, testing  <dig> binding models  on over  <dig> x  <dig> , <dig> target sequences in total. hence, our study provides insight into the current quality of computational tfbs predictions and the findings generated in this study may help to evaluate the feasibility of whole-genome tfbs prediction studies.

RESULTS
binding predictions
we tested the pssms mentioned above and used chip-seq derived sequences binding to tfs as positive controls. results were assessed with roc analysis .

the various binding models from the multiple sources yielded different results in many cases: while only  <dig> of the  <dig> pbm-derived models from hpdi  reached an auc score of ≥ <dig> , this was the case for 46 % of the ht-selex and 60 % of the jaspar-models. the average auc values generated by the different binding model sources were highly divergent, ranging from  <dig>   to  <dig>  .

when tested on the ‘high-confidence’ dataset,  <dig> out of  <dig> models  from hpdi yielded auc scores of ≥ <dig> , which resulted in an average auc score of  <dig> . the ht-selex-models reached auc values ≥ <dig>  in 70 % of the cases , whereas the jaspar-matrices generated an average auc score of  <dig> . an overview of these findings is depicted in fig.  <dig> fig.  <dig> average auc scores and representative roc plots for different binding model sources. a average auc scores generated for the different binding model sources. b roc plot for tfap2c. c roc plots for tfap2a for the entire encode test set  and the high confidence set . d underlying tf binding models for tfap2a



we were able to directly compare the prediction quality of models for  <dig> different tfs that were represented in both the jaspar and the ht-selex data . we found that in general, the manually curated matrices from jaspar enabled a slightly better distinction between positive and negative sequences . in the ‘high-confidence’ data set, these values increased for both data model sources: the ht-selex models generated an average auc of  <dig> , whereas for jaspar this value was  <dig>  .fig.  <dig> direct comparison of binding models generated by different methods. depicted are auc scores for tfs stored in both jaspar  and ht-selex. auc scores were generated using rocr. if multiple binding models were available for one tf, we depict the average auc value



these findings can help to estimate the utility of tfbs models from different sources, enabling researchers to better circumvent the high false-positive rate, a problem which is well known for in silico tf binding analyses  <cit> , and thus to make the most of the available data. in general, we found manually curated models provided by jaspar and ht-selex-derived matrices to be much more successful in recognising in vivo tfbss than pbm derived models.

previously, the success of tf binding prediction has been found to be similar for the majority of matrices, with degenerate matrices yielding the most accurate predictions  <cit> . hence researchers currently often use tf binding models from various sources indiscriminately. the notion that tf binding models obtained through different experimental methods can be variable has just recently entered the scientific discourse in a novel publication  <cit> . there, the authors compared pbm- and ht-selex-derived models and found both models to be reliable with a slight advantage of ht-selex models in the prediction of in vivo tfbss. our study on a larger test set  showed jaspar to be the most reliable source for tfbs matrices in this data set.

to check if the higher accuracy of jaspar might be the result of an overfitting of the jaspar models to the encode data, we manually checked for an overlap between the tested matrices and the encode data set. for each pssm, we studied the accompanying publication and found that this was not the case for any of the binding models included in our study. hence we can safely assume that the current jaspar models are indeed the most successful ones to recognise in vivo tfbss.

in this study, we decided to use exonic sequences as a negative test set. because the 5’ regions of genes occasionally contain functional binding sites  <cit> , we decided to categorically exclude the first exon of each transcript from our analyses. thus, the percentage of functional tfbss in the negative test set should be sufficiently decreased in order to allow computational predictions. we preferred this approach to alternative analyses, such as the usage of artificially generated random dna sequences without tfbss, as they might be very different from naturally occurring sequences and are also likely to increase error rates  <cit> . furthermore, the usage of random exonic sequences as a negative set closely mimics the real-life research situation, therefore allowing an important insight into the limitations of current in silico tfbs analysis methods.

we found that the usage of only high-confidence encode data leads to an increased reliability in the computerised recognition of tfbss. however, this filtering step also introduces a potential drawback: strong tf binding does not necessarily implicate strong tf function, as has been shown for d. melanogaster  <cit> , where low-affinity binding sites can be of great importance for normal gene activation. moreover, a researcher looking for a functional binding site in silico does not necessarily have any previous knowledge on the binding strength. therefore, the decision to admit only high-confidence data into analyses – which is common practice in tf binding research  <cit> —in fact excludes a large amount of relevant information and should therefore be taken with care.

conservation analyses
in a real-life research situation, tfbs predictions are usually supplemented by additional analyses such as the determination of sequence conservation. we therefore further tested whether the encode tfbss  show a higher degree of conservation than the genetic background. in detail, we measured phylop  <cit>  and phastcons  <cit>  scores for each position of the encode tfbss and of negative test cases . for each tf, we then calculated the average scores of the highest conservation as well as of the average conservation score reported for each sequence. as we did not know where exactly in the encode sequence the actual tfbs was located, we chose to focus on the highest conservation scores, assuming that functional tfbss would show a high degree of conservation. however, we found that, while there was a higher degree of conservation for the encode sequences, the variability in the tested sequences was very high. moreover, we did not find a link between strong tf binding and sequence conservation because the mean maximum phylop and phastcons scores for the high-confidence test set were not significantly higher than for all encode sequences. we hence conclude that, while this may sometimes be the case, a functional binding site does not necessarily have to be highly conserved. as a representative example, fig.  <dig> shows example images of conservation readings for zbtb <dig> and bcl11a.fig.  <dig> representative plots for conservation analyses. we determined the maximum phastcons  and phylop  scores in each experimentally confirmed binding site of bcl11a  and zbtb <dig>  and calculated the averages of the maximum scores



our findings indicate that while there seems to be a certain degree of increased conservation for chip-seq verified tfbss in comparison to random genetic sequences , the variability between individual sites is too high to draw any reliable conclusions. these results support previous findings, which suggest that functional tfbss can, but do not have to be evolutionarily conserved with regard to their primary nucleotide sequence . more precisely, some researchers argue that tfbss may fluctuate quite rapidly between species. for instance, it has been found in a comparative genomics study that the likelihood of a tfbs to be conserved between s. cerevisiae and its two closest relatives  lies below 5 % for a majority of the sites  <cit> . in addition, rapid evolution of combinatorial transcription networks was found for the transcriptional regulator mcm <dig> in closely related fungi species  <cit> . moreover, a simulation of the evolution of tfbss by introducing local point mutations showed tfbss and combinations of binding sites to evolve quickly  <cit> . considering the fact that tfbss are known to be relatively variable, even within the same species, it would be surprising if all functional binding sites were conserved across larger evolutionary distances  <cit> . it has also been shown in comparative studies between various species that the functionality of tfbss can still be preserved despite underlying sequence changes  <cit> . the three-dimensional structure of the dna at a tfbs, including the histones, is likely to play an important role for tf binding, a notion which is slowly being acknowledged for the analysis of tfbss  <cit> . as such three-dimensional structures can be well conserved while the underlying linear sequence may evolve rapidly, sequence conservation scores might not be of major importance for the assessment of tfbss. in our study, we found that the degree of variation between individual tfbss was too high to infer tfbss conservation in general. hence, measurements such as genomic location or three-dimensional conservation might be better suited for the assessment of the validity of a tfbs.

regulatory snps 
we compiled a set of  <dig> rsnps known to directly impact tf binding or gene expression . rsnps are single-nucleotide polymorphisms occurring in regulatory regions such as promoters or enhancers. they are likely to be of functional significance as they do affect transcription initiation, elongation, and translational characteristics of mrna but are more difficult to study than alterations in coding regions and are hence under-represented in the literature . we only included alterations in this test set which have been shown to directly interfere with a tfbs’s function in in vitro or in vivo experiments. in this test set, we found differences between wild-type and mutant variants with respect to the evaluated maximum binding scores in 76 % of all observations, but they rarely exceeded 20 %. for a subset of the rsnps, which linked to  <dig> different tfs , we were able to directly compare the computational predictions to the experimental findings. if solely considering maximum binding score changes, we found agreement between computational and experimental results in less than 50 %  of the tested matrices. however, when analysing the data with epossum , we obtained a correct prediction in 62 % of the cases. interestingly, the different binding models from the various sources again yielded quite divergent results, thus confirming strong variability in the quality of the tested matrices .

we are aware that the rsnp test set used in this study was not large enough to provide comprehensive insight. this is due to the fact that experimental data on rsnps in tfbss are not readily available. hence, we decided to make the best of the available data and to provide an initial glimpse into the reliability of the state-of-the-art methods for tfbs prediction.

epossum
our study demonstrates that many of the existing pssms offer only limited reliability, while others do indeed allow reasonable predictions. in order to make our findings readily available to the scientific community, we created software called epossum that predicts the effect of genetic variation on tf binding using the matrices included in our study. it also includes a measure of significance of the assessments to indicate how reliable a prediction by a certain pssm would be.

epossum is a web-based application that can be freely accessed at http://mutationtaster.charite.de/epossum/. users can either enter genetic variants in the common vcf format or wild-type sequences along with the variant sequences. in the first case, the position of the variant is known and epossum scans the encode chip-seq data used in our study for known tfbss around this position. the existence of tfbss at the position under study is included in the output. in total, epossum offers predictions for  <dig> tfs which are based on  <dig> different pssms. to speed up analysis, users can choose which tfs to include into the search for binding sites. if they submit a genomic position, they can limit the search to those tfs that are known to bind at this position.

unlike similar applications such as motifbreakr  <cit> , epossum does not merely subject sequences to different pssms, but uses their binding scores as input for a bayes classifier. more precisely, this classifier uses the quotient of the maximum binding scores calculated for wild-type and variant sequence to determine whether the genetic alteration leads to the  gain or loss of a tfbs. as most of these quotients do not show a normal distribution, we use the r module klar  <cit>  for the classifier, which considers the kernel-density, i.e. the real distribution of values, to generate predictions.

due to the poor performance of many pssms in discriminating real tfbss from exonic sequences as indicated by similar maximum binding scores for both, the bayes probability for both outcomes  is often far from 100 %. we therefore include the negative or positive predictive value  for each matrix for the given bayes probability as a measure of the reliability of the classifier’s prediction. this value is also used to colour-code the likelihood of increased/new or decreased/lost tf binding. darker colours represent more likely changes in tf binding. epossum uses all available pssms for a tf to generate a final assessment—here, only ppvs/npvs of 70 % or above are considered. the assessment also includes whether or not a binding site for the tf was reported by encode at the respective genomic location.

different bayes classifiers were trained for each pssm with the quotients of all possible pairs of positive versus negative cases for the respective tf using all available sequences from our encode high-confidence set as positive and exonic sequences as negative cases. the number of pairs was deliberately limited to  <dig> , <dig> per matrix, even if more pairs were possible.

epossum is limited to human tfs and, if genomic positions were used, to genome version grch <dig>  a weakness lies in the recognition of known tfbss—as each tfbs positive chip-seq snippet from encode comprises several hundred bases, we do not know whether or not the “real” tfbs is truly located within the fragment screened in the analysis.

CONCLUSIONS
the assessment of variation in regulatory sequences remains a substantial challenge for the research community. while in previous decades genetic analyses focused on protein-coding regions, due to the availability of deep sequencing the search for regulatory mutations has meanwhile become a research focus. the properties of tf binding have been investigated for a long time and therefore offer a myriad of data for computational analyses. however, the utility of tf binding models for large-scale tfbs recognition has not been extensively investigated yet.

therefore, this study is an attempt at comparing the accuracy of tf matrices obtained by various experimental methods in predicting functional tfbss on a large scale. thus, it enables an analysis of the quality and relevance of current tf binding prediction data.

problems in predicting tfbss in silico include high false-positive rates  <cit>  high variability  <cit> , and insufficient knowledge of the exact in vivo binding sites  <cit> . current tf binding models are usually based on mere one-dimensional sequence parameters, which poses a major limitation.

to tackle these problems, researchers have to wisely choose data sources as well as tfbs predictors. taken together, our analysis and the newly created and free-to-use software epossum provide previously unknown quality measures for computational tfbs predictions thus enabling researchers to extract and use the most meaningful of the available data.

