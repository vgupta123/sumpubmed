BACKGROUND
epigenetic deregulation of cell activity is thought to be an important requirement in the preclonal phase of glandular epithelial cancer  <cit> . what level of deregulation is required before the histology becomes abnormal? can a mechanism of deregulation be inferred from the abnormal phenotype? to better understand causal linkages between mechanisms and phenotype in an in vitro setting, epithelial cells have been cultured and studied in three-dimensional  gels of extracellular matrix , such as collagen i or matrigel®. when grown embedded in 3d culture, madin-darby canine kidney  cells form identically structured acinar organoids enclosing a cell-free, fluid-filled lumen  <cit> . proliferation and apoptosis are essential features of the process. when manipulated or exposed to certain factors, the organoids and composing cells exhibit phenotypic features that are associated with pre-cancerous or cancerous tissues in vivo  <cit> . such cell culture models are thought to provide an appropriate physiological environment to study glandular epithelial morphogenesis and cancer progression.

from a systems modeling perspective, epithelial cell cultures are abstract, somewhat simplistic models of epithelial cells in vivo. they are constructed wet-lab models: a controllable, careful assemblage of laboratory materials and equipment, in which one component is alive. there is little direct overlap between measured in vitro phenotypic attributes and corresponding attributes of epithelial cells in vivo. nevertheless, the accumulated literature and the model's continued study attest that scientifically useful mappings exist between model and referent at several levels, from genetic to systemic phenomena  <cit> . however, even though the in vitro cultures are orders of magnitude simpler than epithelial cells in a mammalian tissue context, they still are complex systems that have proven challenging to understand.

we suggest that progress can be made in understanding epithelial cell behavior, morphology, and mechanisms, along with the changes that occur during cancer progression by constructing and studying abstract analogues in software, where the system features at all levels can be modeled, fully explored, and understood. the envisioned products are examples of executable biology  <cit> , which are useful for systematically exploring hypotheses about referent mechanisms through virtual experimentation. the approach works synergistically with inductive mathematical methods and emerging, hybrid approaches based on "first principle" physical laws  <cit> .

in a previous study  <cit> , we presented a cell-mimetic analogue of the envisioned new class, which validated for a small set of targeted mdck attributes. its growth characteristics and the types of stable structures formed mimicked those of mdck cells in cultures. eleven axiomatic operating principles, and six simulated cell actions, were adequate for validation. however, it failed to consistently produce cystic structures with a round, convex contour, a cardinal feature of normal in vitro phenotype which has not been considered in the earlier study.

starting with the earlier analogue, we explored several analogue revision strategies to achieve the expanded attribute set. for the purposes of this study, we focused on cell event  patterns and multicellular morphology. because of the networked nature of axiom use, some changes intended to have one effect also had other, unintended, often abiotic consequences. one of our guidelines was to keep revisions parsimonious. we sought one new analogue having as few new axioms as possible to achieve morphological validation against the shape requirement, in addition to the original set of target attributes. for one, validation was achieved by addition of only one new cell action coupled with replacement of one axiom. use of the new action enabled the improved in silico epithelial analogue  to form stable cystic structures with smooth, convex margins similar to those observed normally in 3d epithelial cell culture.

we reasoned that if a mapping exists between isea's coarse-grained operating principles and the more complex epithelial cell counterparts, then selective disruption of isea's operation should exhibit cancer-like characteristics of in vitro epithelial cancer reconstruction models  <cit> , examples of which are provided in the appendix. we designed and implemented methods to selectively deregulate, at a controlled level of severity, simulated cell operation at the axiom level. we focused on two processes known to be critical for normal isea growth and stabilization. one process ended with an isea version of anoikis, a specific form of cell death due to extracellular matrix detachment. the other involved directed placement of a daughter cell, the isea's version of oriented cell division. a grading measure was developed and used to quantify changes in morphology.

dysregulation of either "anoikis" or directed daughter cell placement, or both, led to manifest changes in isea phenotype that were reminiscent of dysplastic growth associated with in vitro cancer reconstruction and early glandular epithelial cancer progression in vivo. consequently, we undertook a detailed analysis of the deregulations and their consequences. varying the level of dysregulation led to morphologies that could be classified into groups using automated grading. dysregulation of isea's anoikis process had a greater effect on overall morphology. simultaneous dysregulation of the two axioms had a nonadditive effect. importantly, dysregulation of either process resulted in similar morphological outcomes, which could not be differentiated reliably without additional information on growth dynamics, with potentially significant implications for early cancer diagnosis based on histology. the results also provided an early lead on possible additional mechanisms to reconstruct, or revert, cancer-like phenotypes in experimental and therapeutic contexts. future rounds of development of these in silico methods may lead to a viable platform for unraveling the operational bases of glandular epithelial morphogenesis and early cancer progression.

methods
the isea design is based on the methods and principles of agent-based modeling  <cit>  and discrete event simulation  <cit> . the isea and its predecessors  <cit>  can be categorized broadly as cell-based or cell-centered models, which encompass cellular automata, cellular potts models, and various types of agent-based or individual-based models as reviewed in  <cit> . cellular automata and their relationship to isea are discussed in the appendix.

detailed descriptions of isea components and the experimentation framework are provided in  <cit> . an abridged description follows. to clearly distinguish isea components and processes from their in vitro counterparts, hereafter we use small caps when referring the former. as detailed in  <cit> , isea is a standalone system that comprises culture analogue and system-level components for semi-automated experimentation and analysis. system-level components include experiment manager, observer, and culture graphical user interface . experiment manager, the top-level agent, provides experiment protocol functions and specifications. observer agent is responsible for recording culture measurements. culture gui enables visualization and user interaction during simulation.

a culture is an agent that maps abstractly to the mdck cell culture within one well of a multi-well culture plate. it maintains a two-dimensional  hexagonal grid, which represents an arbitrary cross-section through a 3d mdck cell culture. the grid has toroidal topologies. discrete objects with eponymous names represent the essential cell culture components: cells, matrix, and free space. matrix and free space are passive objects that map to units of extracellular matrix  and matrix-free material. a matrix object maps to a cell-sized volume of ecm. for simplicity, matrix represents any media containing sufficient ecm to which mdck cells can attach. for the traits targeted, no distinction was needed for differential physical ecm characteristics, such as stiffness, density, and viscoelasticity. a free space object maps to a similarly sized volume of material that is essentially free of cells and matrix elements. free space also maps to luminal space and non-matrix material in pockets enclosed by cells. the latter are called luminal space when distinction from free space is useful.

cells are quasi-autonomous agents. they use the axiomatic operating principles and decision logic  to interact with components in their local environment. every cell has the same step function in which an assessment of its environment is made and a call is made for an appropriate action. the step function is scheduled each simulation cycle. a set of cell axioms, discussed below, determines cell action. a cell selects just one axiom and completes its corresponding action during each simulation cycle.

* the precondition for each axiomatic operating principle  takes into consideration the six objects adjacent to the decision-making cell. † two cell neighbors separate matrix on one side from luminal space on the other side. ‡ a polarized cell has noncontiguous matrix neighbors.

cell axiomatic operating principles
an agent must have rules and protocols for interacting with adjacent components. the operating premise is that the same is true for cells in culture; what can be described as rules and protocols are emergent properties of the cell's expressed genetics and ongoing biochemistry. rules can take any form. we elected to have each rule take the form of an axiom, which specifies a precondition and corresponding action. preconditions correspond to a cell's neighborhood configurations. for action options, we specified what we determined to be a minimal set to achieve validation: replace an adjacent non-cell object with a cell copy, die  and leave behind a luminal space, create matrix, destroy an adjacent non-cell object and move to that location leaving behind a luminal space, polarize, depolarize, and do nothing. for any precondition, only one action was executed.

detailed descriptions of supporting biological evidence and assumptions made for isea cell axioms are provided in  <cit> . briefly, cell death axioms  were based on a general biological principle that cells, such as epithelial cells, undergo a process of cell death within some interval after detaching from ecm  <cit> . that behavior is observed in mdck cell cultures  <cit> . axiom  <dig>  which dictates matrix deposition between two adjacent cells, was specified based on observations that some matrix is produced de novo between two adhering mdck cells in suspension culture  <cit> . a cell division axiom, axiom  <dig>  follows from experimental observations that, when embedded in matrix, single mdck cells proliferate  <cit> . other cell division axioms, axioms  <dig>   <dig>  and  <dig>  follow from a similar, general principle that epithelial cells proliferate when they adhere to ecm and tend do so in arrangements that maximize intercellular contact  <cit> . cell polarization axioms, axioms  <dig> and  <dig>  reflect in vitro observations on mdck cell polarity  <cit> . axiom  <dig> applied when the cell achieved mandates that map to the three-surfaces principle articulated in  <cit> . an unpolarized state indicates that the cell's three surfaces mandate has not been achieved.

the earlier axioms developed by grant et al.  <cit>  enabled the analogue to validate for a set of basic mdck cell culture attributes. unlike its referent, the model frequently produced highly irregular, abiotic structures. we revised the axioms to enable isea to consistently develop cysts having roundish, convex shapes, a cardinal feature of a normal in vitro epithelial cyst. note that a regular hexagon in a hexagonally discretized space maps to a circle in continuous space. fig.  <dig> describes and shows use of all  <dig> isea axioms. axioms 1- <dig> were carried forward from  <cit> . isea variants that were more elaborate also enabled isea variants to achieve the targeted attributes, but they were rejected because we strove to adhere to the guideline of parsimony.

we considered and explored adding and using limited details about the axis of polarization. a cell, following one of its action options, acquiring cell neighbor or prior to creating a copy, for example, could assign itself a vectorial axis of polarization. thereafter, an axiomatic precondition could include reference to the direction of polarization combined with neighborhood information. however, other analogues that were explored, including isea, achieved the targeted attributes without that added detail. adhering to the parsimony guideline, we excluded polarization details because they were not needed to achieve the attributes targeted, but they can be added easily when the need arises. axiom  <dig> requires a cell to be aware of the positions of its neighboring objects relative to each other and itself. a higher resolution  mechanism that would be exchangeable for axiom  <dig> could include having and using an axis of polarization.

operational disruption of cell axioms
following implementation  of the revised axiomatic operating principles, our next task was to add a mechanism to disrupt the operation of individual cell axioms selectively. we added a set of parameters, one per axiom, which controlled the probability of the decision-making cell electing to follow the axiom when its precondition applies. the parameter values ranged from  <dig> to  <dig> inclusively. a parameter value =  <dig> corresponded to 100% adherence to the axiom. setting the parameter to zero completely blocked execution of the prescribed action and, if specified, dictated an alternate action. at its decision point, each cell drew a pseudo-random number  from the standard uniform distribution. the prescribed action was followed only when the prn was ≤ the probability threshold set for the corresponding parameter.

following exploratory simulations that considered many options, we specified alternative actions that mapped to plausible in vitro cell actions in a deregulated state. axioms  <dig>   <dig>  and  <dig> governed cell death; a reasonable alternative was to resist death and remain alive . axiom  <dig> dictated random placement of a cell copy; its alternate action was to do nothing and thus prevent replication. we also assigned the alternate action of 'do nothing' to axiom  <dig> . several dysregulated action options were available to axiom  <dig> . one was to do nothing, effectively suppressing cell division. another was undirected cell division, placing the cell copy in a random direction without regard for the number of cell neighbors. we used the latter because adequate, supportive biological information was available. axiom  <dig>  which dictated cell division, had available the same alternative action options. axiom  <dig>  had many plausible options. one was preventing cell division; another, as above, was to allow the cell to place a copy of itself in any available location. yet, another option was to enable polarization. the preconditions prescribing cell division or polarization also could be swapped. the remaining axioms, axioms 9- <dig>  posed a similar problem of having many plausible action options. because no experimental information was available to narrow the options, we elected to defer investigation of those axioms until more information becomes available.

simulation experiments
culture width and height were set to  <dig>  for embedded cell culture simulation, a single cell was placed at the center of the culture grid filled with matrix. one cell width mapped to  <dig> μm. simulation time advanced discretely. ordering of cell events within the same simulation cycle was pseudo-random. each simulation experiment comprised  <dig> monte carlo  runs. each mc run was executed for  <dig> simulation cycles. one simulation cycle mapped to  <dig> h in vitro. a new culture was created for each repetition.

specification and use of morphology index
the morphology index, m, weighs three basic features of multicell morphology: local extracellular arrangement, e, structural discontinuity, d, and a structure's overall shape, s. for each cell, the algorithm computes a numerical score based on its neighborhood arrangement. an ideal arrangement corresponds to the axiom  <dig> precondition. higher scores are assigned to neighborhood configurations that deviate from that ideal. the collective extracellular arrangement score, e, is the mean of individual cell scores. a cluster is structurally continuous so long as it remains one connected body of cells and free  space. when structural continuity is broken, two or more clusters are formed. the structural discontinuity algorithm computes the number of disconnected bodies; that number translates to d. the shape profile algorithm takes into consideration a structure's overall 2d shape in hexagonal space and computes a score, s, which increases as shape becomes irregular or deviates from the ideal shape, a regular hexagon . the value of the morphology index becomes m = e + d + s. the maximum values of e, d, and s have been set to  <dig>   <dig>  and  <dig> respectively, reflecting their assigned relative weights. the final morphology index value ranges from  <dig>  to  <dig> . lower scores are assigned to configurations that are more organized and roundish with a single lumen. the measure was implemented and calibrated for isea simulations, and sufficed for this study's purposes. however, we will need counterpart metrics for in vitro and in vivo microscopic image analysis should we undertake direct, quantitative comparison between isea and wet-lab morphologies. a detailed description of the measure and algorithms are provided in additional file 1: supplementary material.

tools used for analogue implementation and execution
the model framework was implemented using mason version  <dig>  mason is a discrete-event, multi-agent simulation library coded in java  <cit> . batch simulation experiments were performed on a small-scale beowulf cluster system. computer codes and project files are available at http://biosystems.ucsf.edu/research_epimorph.html

RESULTS
isea was validated against normal 3d embedded cell culture traits
we implemented a common framework and components, some derived from the earlier analogue  <cit> . having a new general framework was needed in part to reduce unnecessary, cross-model redundancies between different candidate cells during analogue refinement, and facilitate an iterative model refinement process capable of automated cross-model validation. as done in  <cit> , we validated the revised isea for all four growth conditions: monolayer, overlay, suspension, and embedded cultures. simulation results for monolayer and suspension cultures were identical to those in  <cit> . results for overlay cultures were closer in appearance to in vitro observations . marked differences were observed for the embedded culture condition. that culture condition is the focus hereafter.

at the start of an embedded culture simulation, a single cell was placed in culture space, surrounded by only matrix. as a simulation progressed, the cell underwent repeated rounds of cell replication, followed by the formation of luminal space and an increase in cell number and cyst diameter. the central luminal space grew as cells in the inner region died or moved out. the growth dynamics and final morphology were similar to those observed for mdck cells . the embedded culture always formed stable cysts bordered by polarized cells , and isea consistently produced cysts with a roundish, convex shape with smooth margins. during an occasional simulation, because of their changing, local environment, one or more cyst surface cells failed to polarize or die before the simulation ended. such events prevented the local rounding out process that a polarized cell can undertake, preventing a few structures from stabilizing within  <dig> simulation cycles.

new capabilities were added to simulate epigenetic deregulation of cell processes
following validation, we undertook experiments that may simulate inducement and progression of in vitro cell phenotypes that mimic early, preclonal stages of carcinogenesis. the progression involves alterations in tissue organization and morphology but low genetic changes  <cit> . the experiments were motivated by questions such as these: what happens when normal cell operation and its regulation become faulty? to what extent can individual cell activities be disrupted separately and together, and still maintain an apparently normal morphology? what visible changes accompany relaxation of tight control of a cell-level process? can the operational cause of the changes be predicted from histological morphology? to obtain answers for isea, we conducted experiments in which the probability  of proper axiom operation was varied from  <dig> to  <dig>  when proper operation was not followed, alternate, dysregulated actions were used. from an operational standpoint, having p =  <dig> represents a permanent change in the cell's operating principles throughout the simulation. a nonzero value below  <dig>  specifies a reversible change in the cell's operation, or erratic operation. it can be viewed either as the probability of the cell behaving properly at any point in time, or the approximate percentage of time that the cell acts normal  during simulation. individual cells decide to act normal  each simulation cycle, independent of one another. as a result, cells can exhibit different behaviors  during a simulation cycle. with p <  <dig>  a cell can switch between the two behaviors multiple times during a simulation. it is a stochastic process having the markov property: future changes in the cell's behavior occur probabilistically, independent of its history.

we focused on axioms  <dig> and  <dig>  axioms  <dig>   <dig>   <dig>  and  <dig> were not essential to normal  cyst formation in embedded culture , and were used infrequently. consequently, they were excluded from this investigation. as described in methods, selecting an alternate action for disrupted axioms 8- <dig> is not straightforward. we elected not to pursue disruption of those axioms until further insight from wet-lab studies becomes available to narrow options. disrupting axiom  <dig> was straightforward but the outcomes  offered no significant insight: cell clusters either developed normally into cysts  or grew unchecked as a homogenous mass . we expected that outcome because axiom  <dig> is required for luminal space creation but becomes nonessential as soon as the nascent luminal space is formed. axioms  <dig> and  <dig> were essential to cyst formation in embedded culture. axiom  <dig> dictates anoikis , and is the most frequently used cell death axiom during culture growth. axiom  <dig> dictates oriented cell division; the action requires making a cell copy and placing it selectively. that process accounts for most of the cell division events in the simulations. their biological counterparts are centrally implicated in epithelial morphogenesis and carcinogenesis.

to aid investigation, we developed and used a morphology index to automatically quantify isea structure morphology. the algorithm analyzed and scored features of multicell structures. the measure weighed three characteristics: local extracellular arrangement, structural continuity, and the overall shape. the index values ranged from  <dig> to  <dig>  higher values indicated a more disorganized state. lower scores were assigned when the overall shape was convex, and all cells were polarized. the measure was calibrated for iseas, but could be generalized for other model types. the index represents the simplest metric that we found to be sufficiently discriminative for this study's purposes. we are exploring alternative metrics that may expedite simulation analysis and interpretation. however, it is unlikely that a single, simple metric will suffice for analyzing multiple, distinguishable morphological features, each of which requires different measurements to quantify and characterize. it is more likely that the complexity of the metric will parallel the complexity of the multi-feature attributes being analyzed. a further discussion of the morphology index is provided in additional file 1: supplementary material.

reduced anoikis caused lumen filling
for comparison, selected examples of in vitro structures formed following dysregulation of normal cell processes are provided in the appendix.

when cultured within 3d ecm, normal epithelial cells typically proliferate and organize into hollow spheroids, a process that recapitulates certain structural features of a glandular epithelium, such as the presence of a central, hollow lumen  <cit> . in mdck and some mammary cell cultures, apoptosis contributes centrally to lumen formation: cells in the inner region of the developing structure undergo anoikis upon loss of direct matrix contact  <cit> . blocking anoikis in vitro has been shown to cause lumen filling, which resembles a characteristic of most glandular epithelial cancers  <cit> . in 3d cultures of mammary epithelial cell line mcf-10a, focal adhesion kinase-mediated inhibition of apoptosis by inhibition of metalloproteinase  <dig>  has been shown to induce lumen filling and disrupt normal acinar development  <cit> . also, expression of oncoproteins with anti-apoptotic activities, including receptor tyrosine kinase erbb <dig>  colony-stimulating factor  <dig> receptor, src, and igf1r, has been shown to elicit abnormal, filled phenotypes that resemble human ductal carcinoma in vivo  <cit> . if isea's operating principles have cell culture counterparts, then simulation results should exhibit  lumen filling when anoikis is compromised. we simulated the condition by disrupting axiom  <dig> use, which allowed cells lacking matrix contact  to evade death for one or more simulation cycles. with nonzero p <  <dig>  anoikis was disrupted transiently, not permanently for any one cell. in simulations with axiom 5's p =  <dig>  cells were essentially immune from death on matrix detachment except when completely enclosed by other cells . anoikis dysregulation caused aberrant growth morphology , and changed cell death and division activity patterns.

for p <  <dig>  mean isea culture growth rates increased nonlinearly with increasing dysregulation. as evident in fig. 4a, culture growth became unchecked as cells evaded anoikis more frequently. growth became nonlinear at the lowest p values. culture morphology also exhibited changes , becoming more aberrant with increased dysregulation. however, dysregulation had only a limited impact on morphology index during the early proliferative stage of ≤  <dig> simulation cycles. thereafter, values either decreased or increased further, depending on the degree of dysregulation. increased dysregulation always led to a higher mean index value at simulation's end. images recorded after  <dig> simulation cycles showed more irregularities and larger structures following increased dysregulation .

the structures exhibited distinctive morphologies depending on dysregulation level. for instance, 'maximal' dysregulation  resulted in an aggressively expanding cell mass with minimal polarization, which failed to develop a central luminal space. the neighborhoods of most cells consisted of cells and luminal space. on a gross level, the morphological features resembled those associated with in vitro transformation by inhibition of anoikis or apoptosis  <cit> . less dysregulation resulted in structures in which portions exhibited somewhat normal attributes, including the formation of a central luminal space and increased polarization along the margins. however, cells remained in the luminal space, and most were unpolarized.

dysregulation also affected cell activity patterns. in particular, the number of cell death and cell division occurrences rose steeply over the growth period under severe dysregulation , as illustrated in fig. 4c-d. the increase was not as dramatic, and tended to remain relatively steady with less dysregulation. a drop in cell divisions was observed when anoikis was blocked  relative to strong dysregulation . the result was unexpected given the virtually unchecked culture growth measured under that condition. however, even though growth was unchecked, the elimination of anoikis reduced the relative frequency of cell division opportunities compared to extensive but incomplete inhibition of axiom  <dig> use. analysis of individual axiom use and their relative frequencies  showed that the relative frequency of cell division  exceeded the use of all cell death axioms by a factor of >  <dig> when p =  <dig>  there was a several-fold increase in axiom  <dig> activity, but it failed to compensate for the absence of axiom  <dig> use; axiom  <dig> use showed no observable increase. in partially dysregulated conditions , axioms  <dig> and  <dig> showed little activity after the first few simulation cycles. cell death and division caused by axioms  <dig> and  <dig> occurred more frequently as simulation progressed, indicative of active proliferation and death of cells in contact with luminal space. both exhibited similar use frequencies and changes over time.

dysregulation of oriented cell division disrupted cyst formation
oriented cell division is central to multicellular morphogenesis  <cit> . its disruption is implicated in cancer progression  <cit> . the cell division axis orientation determines the position of the daughter cells, their contents and hence their fate. it has been shown that both matrix contact and cell adhesions play important roles in determining the orientation of the division axis in vitro  <cit> . in mdck cell cultures, disruption of cell polarity by ablating the mammalian ortholog of pals <dig>  a gene involved in epithelial polarity and division orientation in drosophila, results in incomplete, multiple lumen formations  <cit> . also, in drosophila aura, mud, and polo mutants, improper cell division axis orientation results in abnormal accumulation of dividing cells and tumor development  <cit> . what impact would deregulation of oriented cell division have on 3d epithelial cell culture phenotype? if any, could it recapitulate features of early cancer progression? cell axis and orientation are below the current isea resolution. nevertheless, to the degree that the low granularity mappings between isea and in vitro systems are acceptable, a dysregulated form of axiom  <dig>  which accounts for most of the cell division events that occur during culture growth, can be used to explore plausible answers. to achieve that aim, we dysregulated axiom  <dig> by allowing the dividing cell to place its daughter cell in a randomly selected matrix location . we anticipated that, if axiom 6's operation maps abstractly to a form of oriented cell division in vitro, then the resulting culture phenotype would provide insight into the expected role of oriented cell division in the development, or disruption, of epithelial architecture in vitro.

we ran simulations with axiom 6's p ranging from  <dig> to  <dig> and recorded changes in culture growth, morphology, and cell activity patterns. some results are shown in figs. 3b and  <dig>  culture growth rate increased monotonically with dysregulation . the changes were less dramatic than those observed when axiom  <dig> was dysregulated. with maximal dysregulation, mean cell population after  <dig> simulation cycles reached  <dig> cells, compared with  <dig> cells following axiom  <dig> dysregulation. culture morphology also exhibited changes . when severely dysregulated , the developing structures exhibited increasing morphological irregularities. the increase correlated with the presence of unpolarized cells inside the luminal space . using culture gui, we visualized culture growth and observed cells undergoing continual, active cycles of proliferation and death inside the luminal space.

cell death and division activities  continued to register as simulations progressed when highly dysregulated. in fact, the mean number of cell divisions and cell death occurrences increased over time. cell death events were offset by an approximately equal number of cell divisions. their apparent dynamic balance resembled how a hollow structure is maintained by the increased apoptosis of cells inside the lumen when proliferation is increased in mammary epithelial cell culture  <cit> .

axiom  <dig> use accounted for most cell division events during early growth , but in a more severely dysregulated state, axiom  <dig>  was used more frequently as simulations progressed. the increase in cell division was offset by a similar increase in axiom  <dig>  use frequency. decreased use of axiom  <dig>  provided further evidence for the continual, dynamic cell turnover occurring inside the luminal space during growth. that is because current isea axiom use assumes that nutrient availability is the same in lumen as in the extracellular culture. if that is not the case, then it is straightforward to make axiom use frequencies nutrient dependent.

combined dysregulation of anoikis and oriented cell division caused phenotypic changes reminiscent of early phase cancer progression
we also explored conditions in which axioms  <dig> and  <dig> were dysregulated simultaneously. the experiments may map to experimental manipulation of protein complexes such as activated receptor tyrosine kinases in epithelial cell culture, which can deregulate both cell division and cell death processes  <cit> . we varied the two axioms' p independent of each other and conducted  <dig> monte carlo simulation experiments for each condition. the dysregulated isea, illustrated in fig.  <dig>  exhibited nonlinear growth changes. change was most striking for the maximally dysregulated condition , which resulted in a mean cell population of ~ <dig> cells vs ~ <dig> cells when only axiom  <dig> was dysregulated, or  <dig> cells from deregulating only axiom  <dig>  changes at other tested levels were also nonlinear . as measured by cell count and morphology index , axiom  <dig> dysregulation contributed more to observed phenotypic changes. when axiom  <dig> was maximally dysregulated, isea produced structures with morphology index values >  <dig>  regardless of axiom 6's p . simulation images  recorded after  <dig> simulation cycles showed differentiable morphologies that roughly coincided with different gradations observed in fig. 6b. the altered isea morphologies mapped to characteristics of the in vitro cancer reconstruction model and early cancer progression in vivo  <cit> .

in results from the above experiments, we observed similar morphologies regardless of which axiom was dysregulated. no new features emerged from simultaneous dysregulation of axioms  <dig> and  <dig>  for example, note the culture images in figs. 3a , 3b , and 6c . the similar features included formation of a central luminal space, which is fully enclosed by a monolayer of polarized cells, and the presence of mostly unpolarized cells in the inner region. the similarities were reflected in the morphology index measurements. consequently, we could not infer from culture morphology alone which axiom  had been dysregulated. however, making such a determination is straightforward given cell axiom use patterns. in time, gene or protein expression patterns of individual cells may emerge as the wet-lab counterpart to axiom use patterns.

discussion
studies of epithelial cell cultures are providing knowledge about how individual cell activities are mediated by intrinsic and environmental factors to create the diverse phenotypes of normal epithelial morphogenesis and epithelial cancers. there is a need for additional methods to facilitate achieving a deeper, integrated understanding of the growing body of experimental observations. past efforts have demonstrated how combined experimental and computational approaches contribute to that process  <cit> . our goal is to broaden and strengthen that effort by developing software analogues that are useful 1) as instantiated, working hypotheses of epithelial morphogenesis and tumorigenic phenotype in vitro, and 2) as an extensible, interactive resource of available biological knowledge about the mechanisms implicated in those processes. progress described herein represents an early step towards achieving those goals.

we revised and extended the axiomatic operating principles of an earlier model  <cit>  to those shown in fig.  <dig>  the revised isea consistently produced roundish, convex cysts with smooth margins, a cardinal feature of normal in vitro mdck phenotype. we enabled mechanistic tracing during simulations of all processes essential for normal isea development. two critical axioms were targeted for dysregulation: axiom  <dig>  which controlled anoikis, and axiom  <dig> that dictated an abstract form of oriented cell division. the causal chains of events responsible for isea phenotype were explored in detail following dysregulation, a process which is infeasible using current state-of-the-art in vitro methods.

dysregulated isea morphology exhibited features reminiscent of those associated with in vitro cancer reconstruction models and early cancer progression in vivo . by increasing dysregulation of the two axioms, we altered isea morphology progressively to mimic features of epigenetic change that accompany early precursor lesions like atypical ductal hyperplasia  <cit> . iseas using dysregulated anoikis  developed multicellular structures having ill-formed luminal spaces containing disorganized nests of cells. with increased dysregulation, luminal cells sometimes broke out through the enclosing monolayer to proliferate into the surrounding matrix, as illustrated in fig. 6c. although such behavior has not been observed in studies of apoptosis inhibition in 3d culture, the activation of certain growth factor receptors able to promote luminal space survival, such as erbb <dig>  do exhibit similar expansive phenotypes in 3d  <cit> . if a mapping does exist between those isea behaviors and phenomena of epithelial systems, it suggests that epigenetic changes may be capable of inducing invasive behaviors in otherwise apparently normal cells in vitro or in vivo  <cit> . the phenomena merits further in silico exploration.

similar, but less dramatic changes were observed when we dysregulated oriented cell division . simultaneous dysregulation of the two axioms produced nonadditive effects but no new morphological features emerged: the structures were virtually indistinguishable from those obtained by dysregulating only axiom  <dig> or  <dig>  consequently, without a priori dysregulation knowledge, one would be unable to reliably deduce the operational cause of a change in culture phenotype based solely on morphology images. a similar conclusion has been reached based on in vitro findings that phenotypic changes such as lumen filling in 3d cultures can be induced by deregulation of different molecular mechanisms  <cit> . to the extent that the in silico-to-in vitro and in vitro-to-in vivo mappings are valid, the results support the idea that morphologically similar dysplasia can have different causes, and that may have implications for early diagnosis of cancer based on morphology alone, as very aggressive, early stage cancers may appear morphologically similar to potentially less aggressive, abnormal, non-cancerous growths.

dysregulation of either axiom enabled some cells to survive in the luminal space. that isea behavior maps to in vitro observations  <cit> . how the latter occurs has not been determined. how it occurs within isea may provide insight. a subset of intraluminal cells established matrix contact by producing matrix de novo . so doing enabled them and some other cells to survive in aggregates inside the luminal space, where they underwent cycles of proliferation and death. blocking the cells' ability to produce matrix  reduced intraluminal cell survival dramatically, and facilitated clearing of residual intraluminal cells during luminal development . in vitro, similar phenomena have been observed in mcf-10a epithelial cell cultures: cells accumulated inside cyst lumens when an anti-apoptotic protein, bcl- <dig> was overexpressed  <cit> . however, unlike in isea simulation, the cells eventually died and disappeared. mechanisms underlying the latter process are unknown. interestingly, some evidence suggests that bcl- <dig> activates matrix metalloproteinase , which degrades ecm surrounding cells  <cit> . do the above intraluminal cell survival observations have an in vitro counterpart, or are these isea behaviors outside phenotype overlap? if there is an in vitro counterpart, then intraluminal epithelial cells in 3d embedded culture may evade apoptosis and further insure their survival by secreting matrix de novo for anchorage. in such a scenario, mmp activation could have an opposing effect by degrading the cell-secreted matrix, rendering the cells vulnerable to anchorage-dependent anoikis.

dysregulation of axiom  <dig> demonstrated the importance of proper division direction during culture growth. evidence supports a mapping to in vitro counterparts. similar structures form when cell polarity is disrupted in mdck cell cultures by ablating the mammalian ortholog of pals <dig>  a gene involved in epithelial polarity in drosophila  <cit> . similar to isea behaviors, the structures contain multiple intraluminal cell clusters and resemble certain patterns observed in breast ductal carcinomas in situ and prostate hyperplasia  <cit> . because cell polarity is critical to cell division orientation, one could speculate that a disruption in oriented cell division by pals <dig> ablation may have contributed to the observed phenomenon. we also note that several groups have discovered that ric- <dig> protein plays a key part in the positioning of the division axis in drosophila morphogenesis  <cit> . it is not yet known if ric- <dig> plays a similar role in oriented mammalian cell division in cultures. nevertheless, isea behaviors indicate that compromising one or more of the mechanisms managing oriented cell division can contribute to features that mimic early stage, cancer-like structures in 3d cultures.

the isea methods used to mimic attributes of cancer reconstruction can be compared to those used to model tumor growth in vitro and in vivo. recent models  <cit>  have represented cancerous cells as permanently transformed cell line. we explored incremental dysregulation of specific isea mechanisms. galle et al.  <cit>  used a similar, creative, individual cell-based approach to simulate and study epithelial cell monolayer growth. they used selective "knockouts" of cell level growth regulation and control mechanisms to investigate how those different mechanisms collectively acted together to influence population morphology. more recently, rejniak and anderson  <cit>  introduced single cell-based, immersed boundary simulation models of epithelial acini development in vitro, and applied the models to investigate different conditions of growth that contribute to normal and abnormal acinar development. other studies have used single cell-based cellular potts models and extensions to simulate various aspects of development including embryonic cell patterning and tumor invasion  <cit> .

finally, cell axioms are high level, low-resolution placeholders for more detailed representations of the actual complex mechanisms driving epithelial cell behavior. use of axioms precludes explicit representations of the abundant, detailed subcellular information that is available. however, starting with the current more abstract set of axioms provided the simplest method and approach for building a useful, working model, positing principles of operation, and testing hypotheses as discussed above. on the other hand, a key advantage of the approach built into isea and its framework are their adaptability for inclusion of additional attributes and details through an iterative model refinement process  <cit> . the current analogue and its components, including cell axioms, can be further developed to reflect new biological information . we can elaborate isea to include higher granularity components and mechanisms that map to subcellular details such as cell lifecycle pathways and intercellular signaling networks when validation against an expanded set of targeted attributes requires doing so. from an engineering perspective, doing so is straightforward and can be accomplished by swapping the current component  for a more detailed composite agent as described in additional file 1: supplementary material. replacement could also occur at the intra-component level, for example by replacing cell axioms with more detailed logic based on interacting components. a challenging task will be to insure cross-model validation between the different analogue variants, and to develop appropriate automated validation measures.

CONCLUSIONS
the approach described herein enabled instantiating a working hypothesis of how individual epithelial cell actions may give rise to cyst organization in vitro, and when disrupted selectively, to structures having tumor-like characteristics. modest dysregulation of one of two key isea operating principles was sufficient to cause manifest changes in its original morphology. the results support the position that epigenetic deregulation of a cell's principles of operation is sufficient to cause emergence of attributes of early stage cancers. we anticipate future rounds of isea refinement and validation will provide an additional, viable experimental approach to dissect the operational basis of glandular epithelial morphogenesis and cancer progression.

authors' contributions
sk and ch conceived the idea. sk designed and performed the experiments. sp participated in the design and implementation. sk, jd, km, and ch analyzed the experiment results. sk and ch wrote the paper with input from coauthors. all authors read and approved the final manuscript.

appendix
relationships between isea and cellular automata
it can be useful to relate agent-based models to cellular automata. a ca consists of a regular grid of "cells" which transition through a series of states in discrete time steps. the "cells" are immobile. a "cell" transitions its state based on the states of neighboring "cells". transitions are synchronous, meaning that all "cells" are updated each time step. a global software executive controls state transitions and time evolution. a fundamental attribute of ca is the realization of non-local, complex behaviors arising from the operation of local rules  <cit> . a ca can be thought of as a simple type of object-oriented program , where objects confined to specific locations map to a ca's "cells" and the transition rules are the objects' methods. the only differences being that 1) the objects in an oop can determine with which other objects they interact, 2) their interactions are not necessarily synchronous, and 3) any object may have more than a single state transition rule. in essence, such an oop can be viewed as being a more heterogeneous and dynamic type of ca.

an agent-based system  adds considerable heterogeneity over and above that of an oop. whereas an oop is not necessarily synchronous, the control of when an object interacts with another object and which objects interact is still handled by a global executive. objects are reactive slaves to this global executive, even in a parallelized oop. within an abs, on the other hand, some of the executive's capabilities and responsibilities, including some or all of the scheduling of actions, are distributed--delegated--to agents. an agent can be quasi-autonomous. it senses and is part of its environment, which may or may not be discretized in the form of a grid. it pursues an agenda within a larger script. an agent can choose dynamically with which other agents or objects to interact, when to engage other agents or objects, and which of various actions to take. it can also begin engaging in new actions without being told to do so or how to do so by a global executive. likewise, it can decide to stop engaging in a given interaction. in fact, an agent can initiate or end the execution of any of its logic, internal or interactive. given those attributes, "agent" can be defined technically as an object within an oop with the ability to schedule its own actions. in models such as an isea, an agent, like an actor, plays a role, participates in a process, or acts on behalf of something else. importantly, an agent is identifiable by an observer as a cause of an effect. some of an agent's attributes and actions may be designed to represent biological counterparts; others will deal with issues of software execution.

it can be important to distinguish an abs from an agent-oriented system. in the former, all the capabilities described exist in the software itself. in the latter, the actual software may not have all the capabilities of an abs, but when the system is used, it is useful to think of the simulation as being composed of agents. in that sense, a ca may be agent-oriented but not agent-based. however, an abs is sufficiently far removed from a ca so that the analogy only has pedagogical value.

in vitro morphology observations
a number of molecules contribute to the establishment of cell polarity and orientation in mammalian epithelial cells. among these are pals <dig>  and patj . they form macromolecular complexes at tight junctions. straight et al.  <cit>  ablated expression of pals <dig> in mdck cells in a cyst formation assay, and that led to defects in polarity determination and the failure of cysts to properly form a lumen. microscopic images taken at day  <dig> are shown in fig. 7a-b. cell masses contained either no lumen or several smaller lumens . occasionally a larger, but incomplete lumen was observed . in isea simulations, similar structures were observed when axiom  <dig> was dysregulated. isea cells developed multiple, relatively intact lumens at different, early time points, which disappeared or merged into a larger lumen by simulation cycle  <dig> . some were observed at or around simulation cycle  <dig>  which maps to the time  that the in vitro images were captured. these observed in silico features were mostly transient. time-lapse images at longer time points will be needed to confirm  the in silico observations.

although mcf-10a and mdck are different in several ways, when grown under identical 3d culture conditions, their structure formation processes exhibit many similarities, including formation of cysts having similar characteristics. we posit that for those conditions, the current isea is also an acceptable analogue of mcf-10a cyst formation. overexpression of erbb <dig> oncoprotein receptors and their epidermal growth factor  ligands is implicated in epithelial glandular cancer progression. to examine the effects of activating erbb receptors in a 3d in vitro context, muthuswamy et al.  <cit>  activated selected erbb receptors in preformed acinar structures composed of mcf-10a mammary epithelial cells. to create stable cell lines expressing chimeric erbb <dig> receptors, cells were infected with retroviruses encoding the chimeras that could be activated by synthetic dimerizing ligands without interfering with endogenous receptors and vice versa. when cultured in 3d matrigel, the cells proliferated and organized into polarized, lumen-enclosing cysts. upon activation of the chimera, these cysts developed structures consisting of multiple acinar-like units with filled lumen . the units within the multi-acinar structures were connected to each other at the base. these altered structures exhibited characteristics of early-stage epithelial tumors, including a high level of proliferation, loss of polarized organization, filling of the lumen, and retention of the basement membrane. most structures were at least  <dig> times larger than normal acini ; some were  <dig> times larger . they are similar to the isea morphology resulting from dysregulation of both axioms  <dig> and  <dig>  which could map to the in vitro condition where apoptosis, proliferation, and cell polarity are disrupted by erbb <dig> expression. as discussed in results, severely dysregulated cells developed large, expanding cell masses with numerous, incomplete lumens. like their in vitro counterparts, the isea structures were poorly polarized. without proper polarization, cells at the periphery continued to divide and expand outward. by simulation cycle  <dig>  some structures became at least 100-fold larger than stable, 'normal' cysts. an example is shown in fig. 6c.

debnath et al.  <cit>  used mcf-10a cell cultures to analyze the role of apoptosis in the formation and maintenance of luminal space during the in vitro morphogenesis of oncogene-expressing mammary epithelial acini. they made two interventions: one to increase proliferation and another to inhibit apoptosis. proliferation was increased via the ectopic expression of cyclin d <dig> or the inactivation of the retinoblastoma protein tumor suppressor pathway by the e <dig> oncoprotein from human papilloma virus   <dig>  apoptosis was inhibited by infecting cells with retroviruses encoding for exogenous expression of anti-apoptotic bcl family proteins. fig. 7e-f shows typical structures formed when cells expressed both the proliferative and anti-apoptotic proteins. those cells produced acinar structures with partially or completely filled lumen. similar, filled acinar structures were observed in another study, in which timp <dig>  a potent cell survival oncoprotein, was used to inhibit both intrinsic and extrinsic apoptosis  <cit> . axiom  <dig> dysregulation simulated a similar in vitro condition where anoikis, a specific form of cell death associated with extrinsic apoptosis pathway, is disrupted. the dysregulation resulted in structures  that exhibited morphological characteristics similar to those shown in fig. 7e-f. most structures had cells inside the cyst luminal space.

supplementary material
additional file 1
supplementary material. provided are detailed descriptions of isea morphology index, isea cell axiom use patterns following axiom  <dig> or  <dig> dysregulation, and a diagram illustrating model refinement and cross-model validation.

click here for file

 acknowledgements
we thank mark grant, glen ropella, wei yu, jesse engelberg, jon tang, teddy lam, shahab sheikh-bahaei, and members of the biosystems group for helpful discussions and suggestions. this research was supported in part by the cdh research foundation, a graduate fellowship to sk from the international foundation for ethical research, the culpeper scholar award  to jd, and nih grants r <dig> dk <dig> and r <dig> dk <dig> to km. the funding bodies had no role in study design; in the collection, analysis, and interpretation of data; in the writing of the manuscript; and in the decision to submit the manuscript for publication.
