BACKGROUND
thirty-five years since the introduction of contemporary dna sequencing techniques, next generation sequencing  methods now enable rapid and inexpensive exome and whole genome sequencing
. many genetic discovery applications such as population level mutation frequency analyses
 <cit>  and cancer genomics
 <cit>  have benefited from ngs capabilities. more recently, whole exome sequencing has played a clinical role for pediatric mendelian disease and cancer diagnosis. application to clinical rare disease diagnosis, however, remains challenging for many disorders with complex or multimodal genetic etiologies, primarily due to the difficulty of interpreting genomic sequence variants relevant to patient phenotypic features
.

in addition to other factors, clinical interpretation of ngs results is difficult due to the scale and complexity of the test output data. unlike typical clinical diagnostic tests that provide a small number of data points in well understood genes, a patient’s exome or genome usually contains hundreds or thousands of genetic variants, many of which require expert analysis to determine clinical relevance. currently, each patient’s sequence reveals a number of predicted or possibly damaging variants that must be individually assessed for biological impact to gene function. however, variant impact to gene function alone is insufficient to determine clinical relevance. clear association between a gene harboring a damaging variant and patient phenotype is also required for accurate clinical diagnosis. this gene-to-patient phenotype analysis is currently difficult for several reasons. first, there are tens of thousands of known gene-to-phenotype associations with various degrees of penetrance, which precludes individual expert assessment by a review process. also, in many cases no single variant explains all phenotypic features present in a given patient, while several variants may explain a subset of the features. these complications typically require the involvement of a team of highly trained specialists to identify the variant causative of patient phenotype, a process that is challenging with respect to expected future demand for clinical sequencing of cases with a complex genetic etiology
 <cit> . analogous to the development of tools that aid variant biological impact assessment; similar methods for systematic phenotype analysis would likely assist this process
 <cit> .

one approach to simplify ngs-aligned phenotype analysis is the use of gene lists. in this method, a predetermined set of genes with known or suspected pathogenicity for a diagnostic category  is created, and variant analysis is restricted to this subset of candidate variants. in effect, the gene list is used as a phenotype filter applied prior to additional analysis. while this method provides some systematic phenotypic analysis, it has important drawbacks. it can be difficult to reach consensus on the number and breadth of phenotypic categories and the genes that should be included within a given category. additionally, the lists require continual curation to remain current with new findings. most importantly, the applied list acts as an inflexible filter that either strictly includes or excludes genes from further analysis.

a number of approaches have exploited prior gene knowledge, genomic, functional, and population structure features for variant prioritization and prediction of ngs data. similarly, existing commercial tools, such as those offered by cypher genomics and ingenuity, utilize proprietary algorithms to provide phenotype analysis for variant interpretation. however there is a need for continued research to develop improved, openly available methods that incorporate patient clinical phenotype for automated variant classification. here, we implement and validate an algorithm that automatically ranks a gene set relative to provided phenotype descriptors. algorithm performance is analyzed under a variety of scenarios intended to mimic clinical diagnostic conditions. the algorithm utilizes the concept of semantic similarity, which has been applied in a variety of biological studies
. the work presented in
 <cit>  used semantic similarity to rank candidate disease diagnoses relative to selected ontology terms describing patient phenotype. our approach is similar but ranks candidate genes rather than diseases. specifically, our model ranks genes by the semantic similarity between patient phenotype features and phenotype features directly associated with each of a patient’s mutated genes. the model validation results demonstrate that, in combination with the many diverse variant features currently considered by diagnostic laboratories, phenotypic similarity measures can provide value for variant prioritization in a clinical setting.

RESULTS
once a patient’s exome or genome is sequenced, it is necessary to correlate a mutated gene to the patient’s phenotype to reach a clinical diagnosis. diagnostic complexity may be reduced if the mutated genes can be automatically ranked relative to their relation to the patient’s phenotype. here, we present simulation and clinical results for a semantic similarity algorithm that provides such a ranked list. for this exercise, we used the human phenotype ontology , a controlled vocabulary organized as a strict hierarchy that largely represents clinical features and pathogenic variant data from the online mendelian inheritance in man  resource and the biomedical literature.

our algorithm computes a score for a given gene by comparing the similarity of hpo terms annotated to the gene and those used to describe the patient. the similarity of any two hpo terms is a function of the specificity of the two terms and their semantic relation. the specificity of a term is quantified by its information content, ic, which is a function of the number of genes it annotates . there is an inverse relation between ic and the number of annotated genes, i.e. the more genes a term annotates, the lower the term’s information content. in this study, the similarity of two hpo terms is defined as the ic of the most informative common ancestor of the two terms . for example, the similarity of the terms “intellectual disability” and “specific learning disability” is the ic of the term “cognitive impairment” as illustrated in figure 
 <dig>  the maximum similarity between each patient term and each gene annotation averaged over the number of patient terms is the similarity score for the gene . these scores, with higher scores indicating a stronger predicted relation to the patient phenotype, can be used directly to rank genes.figure  <dig> 
subsection of human phenotype ontology . terms at left illustrate the ontology’s hierarchical arrangement. the numbers in parentheses indicate the number of genes that term directly annotates. a term is considered to annotate a gene if it directly annotates the gene, as shown in figure, or if it indirectly annotates the gene through any of its descendants, e.g. “abnormality higher mental function” is considered to annotate all  <dig> genes annotated by “cognitive impairment”. the gene list to the right illustrates how hpo terms are annotated to genes. the numbers in parentheses indicate the total number of hpo terms that directly annotate the gene.



analysis
we assessed algorithm performance by the ability to rank the known causative gene highly within a given gene list. in each case, we computed the semantic similarity score between the patient’s phenotype terms and the phenotype terms associated with the genes in the gene list. we then sorted the gene list relative to the computed similarity scores and identified the causative gene’s rank. additionally, we associated a p-value with each observed score to account for annotation bias that can occur when objects are annotated with ontology terms. bias can result from differences in curation and because some diseases—and by extension the related gene—have more phenotypic features, e.g. non-syndromic hearing loss vs. neurofibromatosis type  <dig>  compared to a given query term set, the term set of a preferentially annotated object is more likely by random chance to have a higher semantic similarity score than the term sets of other, less annotated objects. consequently, the ordering of an object set by comparison of the semantic similarity score of each object’s annotation set to the query set can be skewed. to compensate for annotation bias, we considered the one-sided p-value associated with an observed semantic similarity score. as with the similarity scores, we sorted the gene list relative to the p-values and identified the causative gene’s rank.

simulation cases
simulated results were generated for  <dig> diseases that have a single known causative gene according to the omim database and for which sufficient phenotype feature penetrance data were available to accurately model patient characteristics
 <cit> . for these  <dig> diseases, the number of hpo annotations per disease is approximately normally distributed, with a range from  <dig> to  <dig> and a mean of  <dig>  . an additional file lists the diseases and their associated hpo terms and penetrance [see additional file
1]. for each disease, we first generated  <dig> simulated patients by selecting hpo terms for the patient from those terms directly annotated to the disease gene, with probability determined by the penetrance data . this case is considered optimal and represents a clinical scenario where the patient phenotype is well recognized and a specific causative gene is suspected. we then added noise terms  to simulate clinical scenarios where certain patient characteristics are unrelated to the disease. for each patient, the number of noise terms was taken to be half the number of optimal terms, e.g. if a patient had  <dig> optimal terms,  <dig> randomly selected noise terms were added. finally, we considered imprecision, which occurs when selected patient terms are related to the disease but are less specific than the terms annotated to the causative gene. imprecision was simulated by randomly replacing each optimal patient term with one of its ancestor terms. in all, we generated  <dig>  simulated patients with a range of hpo annotations between  <dig> and  <dig> and a mean of  <dig>  .

for each simulated patient, we ranked the causative gene against all  <dig> genes annotated by at least one hpo term to evaluate algorithm performance. the causative gene rank cumulative distribution plots, shown in figure 
 <dig>  summarize the results. the causative gene was ranked first for 92% of the optimal cases when ranked by similarity score and 80% when ranked by p-value. the occurrence of optimal cases with causative gene ranks other than first is a result of the patient phenotype annotation process. recall that optimal patient terms were selected probabilistically based on term penetrance. thus some optimal patients had fewer annotations and/or were not annotated with the important disease terms, specifically those with higher information content.figure  <dig> 
simulated hpo term annotation counts. distribution of the number of hpo term annotations per disease for the  <dig> mendelian diseases used in the simulation cases , and the number of hpo term annotations per simulated patient .
causative gene rank cumulative distribution function. the cumulative distribution function of causative gene rank for the four simulated scenarios taken across the  <dig> simulated diseases. the solid lines are the results obtained when ranked by similarity score. the dashed lines are the results obtained when ranked by p-value. the x-axis is the rank, r, and the y-axis is the probability that the causative gene rank, r, is less than or equal to r. note that the x-axis is on a logarithmic scale.



the addition of noise alone did not have substantial impact on the rankings. when introducing noise, the causative gene was ranked first for  <dig> % of the cases when ranked by similarity score and 72% when ranked by p-value. further, the causative gene was ranked in the top  <dig> for greater than 88% of the cases when ranked by similarity score or p-value.

however, we determined that introducing imprecision had a large impact. the causative gene was ranked first for 20% of the cases with added imprecise terms when ranked by similarity score, and 2% when ranked by p-value. when we considered introduction of both imprecision and noise, these values fell to 4% and held at 2% when ranked by similarity score and p-value, respectively. however, these results are skewed by outliers that occur for patients with significant amounts of noise and imprecision. this effect is observed in figure 
 <dig>  which relates the quantity of noise and imprecision in the patient terms to causative gene rank. specifically, figure 
 <dig> illustrates the probability that the causative gene is ranked above a certain value as a function of the similarity between the optimal patient terms and the corresponding patient terms with noise and/or imprecision when ranked by similarity score. the figure indicates that when this similarity is greater than  <dig> —when the noise and imprecision terms are not too severe—the causative gene is ranked in the top  <dig> genes for at least 80% of cases. indeed, the median causative gene ranks were  <dig> and  <dig> respectively for cases with imprecision, and imprecision with noise cases when ranked by similarity score. thus, for the majority of cases, the causative gene was ranked in the top  <dig> %. note that the maximum probability observed for s between  <dig>  and  <dig>  is likely a result of the specific random patients generated in this study. given more samples, we expect that the maximum would shift toward s =  <dig> . however, the general trend observed in the plot of decreasing rank  with increasing s would be maintained with more samples and is indicative of the algorithm’s performance relative to imprecision and noise.figure  <dig> 
noise and imprecision quantification. the color map indicates the probability that the actual causative gene rank, r, is less than or equal to r  given the similarity value, s , between the actual and optimal patient, that is the similarity between the patient terms with noise and/or imprecision, p
act, and the corresponding optimal patient terms, p
opt. similarity values are normalized by the self-similarity between the optimal patient terms so that all values of s are in  <cit> .



there is some indication that inclusion of patient exome or whole genome data can further improve results under these conditions. as described in the clinical results section, patient ngs data can be used to filter predicted non-damaging variants and common variants, which reduces the gene list length. additionally, the reduced gene list can be used to guide patient phenotype feature selection, a topic we discuss further below.

the noise and imprecision analysis on algorithm performance suggests possible guidelines for selecting patient terms in clinical practice. in particular, it appears that the algorithm performs better when provided patient terms that are very specific, and by having a large number of relevant terms . comparison of the noise-with-imprecision case to the noise-only and imprecision-only cases in figure 
 <dig> indicates that selecting very specific terms can help counter noise. as with figure 
 <dig>  the minimum rank  that occurs as the maximum ic reaches  <dig> in figure 
 <dig> is likely a result of the specific random sample observed in this study. given more samples, we expect that the best performance would shift toward a maximum ic of  <dig>  which is the maximum possible for the particular annotation set used. again, we expect that the general trend observed in the plot of decreasing rank  with increasing maximum ic would be maintained with more samples. figure 
 <dig> indicates that both imprecision and noise effects can be countered by selecting a large set of patient terms, provided that the terms are relevant to the disease condition.figure  <dig> 
patient hpo annotation information content impact. the causative gene mean rank when ranked by similarity score as a function of the maximum information content, ic, of all hpo terms used to describe the patient. higher information content indicates higher term specificity.
patient hpo annotation count impact. the causative gene mean rank when ranked by similarity score as a function of the number of hpo terms used to describe the patient.



clinical cases
to provisionally evaluate the algorithm in a clinical workflow, we measured performance for four actual clinical cases with hearing impairment. a single genetic counselor provided clinically relevant patient phenotypes for each of the four subjects as part of a retrospective exome sequencing validation study. notably, for more complex phenotypes it is likely that multiple clinicians may collectively select patient phenotype terms. in such cases, variability in term selection between clinicians is possible and may increase imprecision. the counselor was allowed to select any hpo phenotype term deemed clinically relevant, i.e. term-to-gene annotation information was not provided as might be done to mitigate noise and imprecision. terms were selected for a given patient using a custom web application that enables hpo term searches by integration with ncbo web services. the web application associates the selected terms with a patient id and stores the terms for later use. semantic similarity scores were determined for each case prior to considering genomic sequence data. subsequently, exome sequence data was obtained for each case. similarity scores were then recalculated considering only the subset of genes that contained one or more infrequent or rare variants in each individual patient.

table 
 <dig> provides causative gene ranks for the four hearing impaired subjects. the patient annotations ranged from  <dig> to  <dig> hpo terms. when compared to all  <dig> hpo annotated genes, the causative gene exhibited a mean rank of  <dig>   when ranked by similarity score and  <dig>   when ranked by p-value.table  <dig> 
clinical cases causative gene rank



gene
terms
hpo sim score rank
hpo p-value rank
variant gene set
gene set sim score rank
gene set p-value rank

ush2a

cdh23

slc26a4

gjb2
causative gene ranks for patients with hearing impairment. gene: the causative gene for each case. terms: the number of hpo phenotype terms assigned to the subject by the genetic counselor. hpo sim score rank: the calculated causative gene rank using the semantic similarity score compared to all  <dig>  hpo annotated genes. hpo p-value rank: the calculated causative gene rank using the p-value compared to all  <dig>  hpo annotated genes. variant gene set: the number of genes with variants identified in the patient of interest. the variant gene set represents genes for which the patient had exonic or splice site variants that occur with a minor allele frequency: <10% in chop’s internal cohort or <3% in exomes from either the  <dig> genomes project
 <cit>  or the nhlbi exome variant server
 <cit> . gene set sim score rank: the calculated causative gene rank using the semantic similarity score when compared to the subset of genes included in that patient’s variant gene set. gene set p-value rank: the calculated causative gene rank using the p-value when compared to the subset of genes included in that patient’s variant gene set.



after consideration of exome data for each patient and filtering out non-exomic and common variants, each patient contained variants in approximately  <dig> genes . when re-ranking within this subset of variant-associated genes, the causative gene demonstrated a mean rank of  <dig>   when ranked by similarity score and  <dig>   when ranked by p-value. although preliminary, this result implies that combining phenotypic information via the semantic similarity score with population and structural information may provide a significant improvement in the ability to identify patient causative variants in certain patient populations.

as noted, our method is similar to the tool presented in
 <cit> , phenomizer, which ranks candidate diseases relative to patient phenotype. where possible, the phenomizer tool also provides genes known to be associated with each disease, thereby providing an indirect gene rank mechanism. however, the resulting phenomizer gene rank is based on hpo term-to-disease annotations whereas the method presented here provides gene ranks based on hpo term-to-gene annotations. these two annotation sources, term-to-disease and term-to-gene, have different distributions. the annotation differences arise because many of the annotated diseases lack specific gene associations and many diseases are associated with multiple genes that individually are not associated with all of the phenotype characteristics associated with the disease. consequently, the two methods yield different gene rank results. for example, for the four clinical cases presented here, phenomizer yields mean causative gene ranks of  <dig>  and  <dig>  out of the  <dig> annotated genes when ranked by similarity score and p-value, respectively. selection of one approach over the other depends on the clinical scenario. however, in cases where whole exome or whole genome sequencing is performed and information specific to gene rank is sought, the presented method is likely advantageous, as it is based on direct phenotype term-to-gene knowledge and appears to rank the causative gene more highly.

CONCLUSIONS
these results suggest that semantic similarity can rank a causative gene highly within a gene list relative to patient phenotype characteristics. the algorithm demonstrates good performance in the presence of noise, provided that imprecision is mitigated. further, the clinical case results suggest that phenotype rank combined with variant analysis can substantially improve results over the individual approaches, at least within the diagnosis of hearing impairment. these conditions approximate a typical rare disease diagnosis analysis scenario that exists after a patient’s sequence results are complete and a set of genes with identified variants is produced. in this case, noise and imprecision can be mitigated if patient phenotype term selection is restricted to a subset of hpo terms, namely the terms annotated to the patient’s variant genes.

while the clinical application has been applied here only to a small number of cases associated with a single diagnostic category, these results are encouraging, as they suggest that careful annotation of phenotype by clinical staff can dramatically improve gene rankings, and thus could significantly reduce analysis time in certain rare disease cases, when assessed in context with additional genomic and clinical data. however, careful annotation of cases in a busy clinical setting presents workflow and expertise resourcing challenges. to mitigate these obstacles, we are currently developing software that will assist patient phenotype selection through use of the known term information content and intelligent term suggestion.

as compared to phenotype-based gene lists, the semantic similarity-ranked patient gene list provides at least two advantages. first, the relative order provides more information in the situation where the patient’s mutated gene set contains multiple genes from the assigned gene list. in this situation, a gene list does not prioritize amongst multiple genes, and hence all must be investigated equally. the rank ordered list, however, assigns a score to each gene that indicates the strength of association between the gene and the patient’s clinical presentation. genes with very low scores are unlikely to be associated with the patient’s specific phenotype and should not require detailed review. if we assume there is a reliable mechanism to determine a similarity score or p-value threshold to delineate genes unassociated with patient phenotype, we may expect reduced analysis duration. secondly, unlike a phenotype-specific gene list, the rank ordered list is inclusive of all annotated genes, not just those on the phenotype specific gene list, which may not be comprehensive for the phenotype. indeed, this was encountered in a hearing impairment subject whose causative mutation occurred within the cdh <dig> gene. a team of physicians and genetic counselors with pediatric hearing loss expertise created a hearing impairment gene list for use at the children’s hospital of philadelphia. the hearing impairment gene list is available as an additional file [additional file
2]. the list was created to support wes clinical analysis conducted for ongoing research within the national institutes of health  clinical sequencing exploratory research  consortium and was used in the initial analysis for the cited case. however, the gene list did not include cdh <dig> and the diagnosis was missed. in contrast, our semantic similarity algorithm ranked the cdh <dig> gene 2nd among the  <dig> genes with variants of interest. this is an anecdotal case but it illustrates the challenge with curating phenotype based gene lists.

an important algorithm limitation is that it is knowledge-based and is therefore limited by the gene annotation sources being considered. as such, the system cannot rank any gene that is not annotated by at least one hpo term and is dependent upon available gene-to-hpo term mappings. in such cases, the unranked genes should be clearly delineated. although we focused initially on hpo, we have designed the algorithm to easily consider additional disease-based ontologies and expect that more comprehensive vocabularies and term-to-gene mappings will emerge over time. another limitation is that the algorithm does not consider pertinent negative annotations, i.e. the indication that relevant phenotypic terms are not present in the patient. inclusion of negation information could be valuable but may likely require better disease term penetrance data to develop adequate scoring models.

currently, good algorithm performance is constrained to the clinical diagnostic scenario described above in order to mitigate imprecision. if imprecision degradation can be reduced or eliminated , algorithm applicability may expand to other scenarios, such as pre-test decision support for appropriate genetic test selection. a first step in this regard is to develop high-resolution similarity score distribution models to obtain accurate p-values that can serve as a test validation measure. for example, assume the top ranked gene has a similarity score, s, with an associated p-value, α. the absolute similarity score, s, only provides an inter-gene comparison mechanism but does not indicate the statistical significance of the relation between the top ranked gene and the patient phenotype. a p-value would provide such a statistical significance measure. note, in this context it is necessary to correct for multiple testing
 <cit> . we are currently developing similarity score distribution models with higher resolution than our initial versions that will enable reliable p-value calculations to indicate test validity.

exome sequencing capabilities have enabled advancements in a number of genetic research domains, clinical diagnosis of mendelian disease, and clinical oncology. however, application of genomic sequencing as a clinical diagnostic test has been more difficult to achieve for many rare diseases. in part, this difficulty results from the complicated process of associating predicted deleterious variants to observed patient phenotype. moreover, clinical application of ngs technologies to rare disease must often address a wide phenotype spectrum. specific phenotype combinations will vary widely in their ability to precisely define genes. for example, the search query “microcephaly, oligodactyly, diaphragmatic hernia, hypertrichosis” produces exactly one omim result, cornelia de lange syndrome. other phenotypes are more difficult to diagnose because they are common and exhibit genetic heterogeneity. our clinical results are encouraging because the hearing disorder phenotype is especially difficult to diagnose; indeed, the search query “hearing loss” yields greater than  <dig> omim results. with continued research, we expect the algorithm presented here may play an integral role for ngs-based clinical diagnosis, especially when used in combination with other genomic, population, and predictive variant annotations.

