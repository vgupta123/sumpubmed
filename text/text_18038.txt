BACKGROUND
marker-assisted selection  is a powerful tool for accelerating genetic improvement of plants and animals  <cit>  through introgression of quantitative trait loci  and selection using genomic-enhanced breeding values   <cit> . meuwissen et al.  <cit>  and xu  <cit>  first incorporated genome-wide molecular markers into the estimation of breeding values, and these so-called genomic selection  methods have improved over time to handle a large number of loci  <cit>  with increased accuracy  <cit> .

for genetic improvement and genetic studies in the post-genomic era, new genotyping platforms such as genotyping by sequencing   <cit>  and single-nucleotide polymorphism  arrays  <cit>  provide a large number of molecular markers, but often with reduced genotyping accuracy  <cit>  and missing genotypes due to other factors. the implementation of such technology in crop breeding programs  <cit>  helps maximize genetic gain through genomic selection  <cit>  and also benefits genome wide association studies   <cit> . when there is a high proportion of missing data, consistent imputation may be challenging  <cit> . accurate imputation of missing values and correction of genotyping errors is essential for eliminating gaps in genome coverage, integrating data across different arrays, and allowing robust genome-wide association mapping and prediction  <cit> .

researchers have proposed a variety of procedures for adjusting genotypic data to impute missing values and correct snp miscalls. most imputation algorithms, such as hidden markov models  <cit> , linear models  <cit>  and pedigree-based haplotyping  <cit> , were designed for ordered markers which are known because there is a reference genome available. but some methods of imputation do not require information on marker order or phase  <cit>  such as k-nearest neighbors  <cit> , single value decomposition  <cit> , or random forest  <cit> . these, therefore, are well-suited for de novo genotyping  <cit> .

incorporating genealogical information boosts the accuracy of genotypic imputation, phasing, and the power of association analysis  <cit> . therefore, here we describe a new method of imputation based on the pedigree relationship matrix  <cit>  and covariance among markers. the proposed method treats genotypes as response variables within a multivariate empirical bayes model traditionally used in plant and animal breeding  <cit> . the expectation of narrow-sense heritability across a set of traits can be translated into a machine learning approach of pattern recognition to measure the amount of additive genetic information captured by the genomic information. thus, we then compare the accuracy of each imputation method based on the amount of genetic variation that can be accounted for by a snp panel  <cit> .

methods
this study employed genotypes and phenotypes from the soynam project , downloaded on september 10th,  <dig>  soynam is a soybean  maturity group iii nested association panel composed of  <dig> bi-parental crosses sharing a common parent and inbred for five generations. the panel comprises  <dig>  recombinant inbred lines, phenotyped in  <dig> combinations of year and location, for four agronomic traits: grain yield, plant height, days to maturity, and seed protein composition. the panel was genotyped with a designed 5 k snp chip. after removing non-segregating markers, low quality snps based on marker heritability   <cit>  and minor allele frequency   <cit> , we selected a set of  <dig>  snps for this study that had 1 % of its genotypic data missing. to compare imputation performance under conditions with more missing data, we generated a second dataset by randomly deleting 20 % of genotypic data across all individuals using the prodna function from the r package missforest  <cit> . if differences in imputation methods are detectable for a strict amount of 20 % missing values, these results will apply to datasets with a larger proportion of missing values.

we compared imputation approaches using a variety of methods: a multivariate mixed model ; hidden markov models  implemented in three software packages commonly employed in genetic studies  <cit> ; a logical algorithm; and three non-parametric methods k-nearest neighbor , single value decomposition , and random forest . raw and imputed datasets are available upon request.

imputation methods
multivariate mixed model
we adapted the multivariate mixed model method for imputation from gengler et al.  <cit>  and yang et al.  <cit> , based on the concept that marker inheritance will proceed in a mendelian manner and therefore, follow the pedigree  <cit> . the method bases the numerator relationship matrix on the expectation of mendelian allele inheritance with shared identity by descent . this contrasts with expectation-maximization imputation algorithms that rely on observed kinship  <cit>  and imputation through coalescent analysis  <cit>  that attempts to recreate the pedigree.

if allele inheritance follows the pedigree, the marker should be perfectly heritable, except for mendelian sampling error. consequently, snp heritability is an indicator of the gene content  <cit> , and we can estimate it by fitting the marker to a mixed model with pedigree specified as a random effect, as discussed by forneris et al.  <cit> . thus, missing snps can be imputed as empirical bayes estimates. expanding the model to a multivariate level further improves the accuracy of prediction, “borrowing strength” from flanking markers and related individuals  <cit> . all markers are evaluated in a panel in a sliding window across the genome, ordered according to the genetic or physical map  <cit> . the method considers the marker of interest  and its flanking markers  as response variables , coding them in an ordinal or continuous scale  <cit> , and fitting them to a multivariate mixed model. thus: yn×3=1μnx3+zn×nγn×3+εn× <dig> 

where z is the design matrices of the random effects, μ and γ represent the intercept and individual additive effect, and ε represents the residual term. the variances associated with the imputed marker are: σγj <dig>  representing the genetic variance of the marker j; σij, the genetic covariance between marker j and the flanking marker i; σik, the genetic covariance between marker j the flanking marker k; and σεj <dig>  the residual variance of marker j. for the given mode, variances are expressed as vary=a⊗σγ2+i⊗σε2=a×σγi2σγijσγikσγijσγj2σγjkσγikσγjkσγk2+i×σεi2000σεj2000σεk <dig> 

where a is the additive numerator relationship matrix and i is an identity matrix. mmm uses restricted maximum likelihood  to estimate genetic covariances and then replaces missing values for the central position by the multivariate empirical bayes estimate  <cit> , also referred to as the best linear unbiased predictor   <cit> . the model is then incremented to the next position and repeated.

this study used the software blupf <dig>  to compute the covariance components. however, any existing software that allows multivariate mixed models incorporating pedigree information can implement the model, such as wombat, asreml, or sas. efficient algorithms to compute mixed models are described by zhou and stephens  <cit> , legarra and misztal  <cit>  and vanraden  <cit> .

hidden markov models
the hmm method is commonly employed in genetics and genomics for stochastic modeling of markov processes . assuming ordered markers, the hmm estimates the most likely path of states  based on the transition probability of marker mt to change state given the previous marker mt −  <dig>  in genetic terms, the four possible states for a diploid organism with alleles m <dig> and m <dig> for locus m, are: m1m <dig>  m1m <dig>  m2m <dig> and m2m <dig> 

this study evaluated three hmm software programs: fastphase  <cit> , beagle  <cit> , and mach  <cit> . beagle, fastphase, and mach implement hmm with iterative updating via expectation-maximization . missing values of each chromosome were imputed separately and pedigree information was not provided. hmm is the most common method of imputation and is shown to boost power and resolution of genome-wide association studies  <cit> .

logical algorithm
this method is implemented in the program findhap.f <dig>  <cit> . the program is computationally efficient, suited for large datasets, and becomes increasingly accurate as the proportion of pedigree data increases  <cit> . thus it is advantageous for populations that pursue genotyped pedigrees.

findhap.f <dig> first generates a list of possible haplotypes, then adds a genotype into the haplotype list and searches for a matching haplotype, then finds the second haplotype by subtracting the first haplotype from the genotype. it then compares each genotype to the haplotype list and imputes unknown alleles from the haplotypes. the first two iterations use population-wide genotypic data, and subsequent iterations locate matching haplotypes from pedigree data  <cit> .

k-nearest neighbor
knn is a non-parametric method commonly used for prediction and classification. knn is a memory-based learning algorithm based on voting  <cit> . it relies on filling missing data points with the weighted mean of the k most similar genotypes based on euclidean distance  between standardized observations. rutkoski et al.  <cit>  evaluated knn for genotypic imputation and suggested it was a promising method. we used the package knngarden  <cit>  with a setting of k =  <dig> to perform our computation.

single value decomposition
svd relies on orthogonal expression of the genotypic matrix  <cit>  from the decomposition m = udvt. svd uses the most significant eigenvectors  to predict missing values. we performed svd imputations by chromosome using the bi-cross-validation algorithm described in owen & perry  <cit>  and implemented in package bcv  <cit> .

random forest
random forest  <cit>  is a non-parametric method of prediction, classification, and imputation of mixed data types  <cit> . it establishes a combination of decision tree predictors, where the trees are bootstrapped random independent vectors that constitute training forests  <cit> . imputation studies of gbs data in wheat breeding have reported promising results for rf . we performed imputations employing random forest by chromosome to generate more informative trees and reduce computational burden, using the package missforest  <cit> .

comparison of methods
imputation errors impact the reliability of breeding values  <cit>  and therefore, affect genome-wide selection. to evaluate the fitness of different imputation methods for genomic enhanced breeding values , we calculated the intra-class correlation coefficient  for the genetic parameter, generally known as heritability, through average information restricted maximum likelihood, implemented in ai-remlf <dig> with a convergence criterion of 10- <dig>  <cit> . the icc is defined as h2=σa2σy <dig> 

given the phenotypic variance σy2 = σa2 + σe2 + σc2 + σε2; where σa <dig> is the additive genetic variance, σe <dig> is the variance due to environment, σc <dig> is the variance due to microenvironment , and σε <dig> is the residual variance. in genetic terms, icc represents narrow-sense heritability, which is defined as the amount of genetic variation that alleles can transmit to the following generation, and it quantifies the population response to selection  <cit> . the rational for using narrow-sense heritability estimator as a measure of how well genetic variability is captured by the genotypic information comes from its practical application of pattern recognition in machine learning  <cit> . genomic relation matrices generated from a snp panel imputed through distinct methods would yield different values of variance components. consequently, kernels that provide enhanced genetic variance and higher heritability reflect better estimators of the genetic term  <cit> .

to compare the effect of imputation methods on heritability, we performed analysis of variance  following the linear model yijkl = μ. + τi + βj + γk + εijkl; where yijkl is the heritability of the ith imputation method  with jth percentage of missing loci  of the kth trait  in the lth observation; μ. is the overall mean; τi represents the imputation method; βj is the percentage of missing loci; γk represents the trait; and εijkl is the residual of the ijkl observation. in this model, imputation method is the parameter of interest while blocking trait and percentage of missing. levene’s test determined the equality of variances  <cit> . the shapiro-wilk test of normality verified the normality. tukey’s honest significant difference   grouped the imputation methods when the p-value of f test was significant . results shown in fig.  <dig> fig.  <dig> average heritability across four soybean traits using genotypic data imputed with different methods. letters represent the statistical difference based on tukey’s hsd procedure 



imputation accuracy and prediction accuracy
this study evaluated imputation accuracy by determining the proportion of data imputed that was identical to the standard dataset  <cit> . for each method, we compared the imputed genotypic matrix with 20 % of the loci missing to the genotypic matrix corrected using the same method with 1 % of loci missing. thus, the level of accuracy provides insight into both imputation method and modifications of the dataset.

to measure prediction accuracy in the context of genomic selection, we used the correlation of observed and predicted values in a five-fold cross validation divided by the square root of the heritability as described by lehermeier et al.  <cit> . we used the following whole-genome regression methods  <cit>  to generate the predicted values: bayesa, bayesb, bayescπ, bayesian lasso, and bayesian ridge regression, as implemented by pérez and de los campos  <cit>  with default settings of hyperpriors. the statistical testing of imputation method on prediction accuracy followed the same anova model previously described with an additional term to accommodate the whole-genome regression method.

RESULTS
effect of imputation method on heritability
we found a significant association  between heritability values  and all terms in the statistical model: imputation method , percentage of missing values  and agronomic trait . the fitted model provided a coefficient of determination r2 =  <dig>  and a coefficient of variation cv =  <dig> . the group means procedure  showed that most imputation methods were similar. mmm had provided the highest across-trait heritability, although not significantly better than the other methods except for the knn and svd methods, which were inferior to the others, with svd being the worst.

post-imputation quality parameters
the average accuracy of imputation for data ranged from  <dig>  to  <dig>  %, . mach, fastphase, and rf were nearly identical , followed by knn . mmm and beagle showed the same performance . imputation accuracy reflects the sensitivity of imputation methods to missing data. however, lower imputation accuracy can be attributed to more severe correction of genotyping errors .fig.  <dig> post-imputation quality parameters. a imputation accuracy measured as the percentage of identical loci between datasets with  <dig> and 20 % missing. b number of repeated markers  after imputations with  <dig> and 20 % missing data. c percentage of heterozygous loci after imputations of datasets with  <dig> and 20 % missing data



we observed a higher number of markers with full linkage disequilibrium  after imputation with the hmm implementations. mach and beagle  also increased the number of repeated markers as the percentage of missing data increased. non-parametric methods, svd and knn, did not provide repeated markers. random forest and both pedigree-based methods, mmm and findhap, showed fewer repeated markers as the missing data increased.

the third measure of accuracy of imputation and data correction is the difference between the observed and expected proportion of heterozygosity in the data. the expected proportion of heterozygosity in this dataset is  <dig>  % of loci given that the parents were homozygous and the plants were genotyped in the f <dig> generation , in which the expected inbreeding coefficient is  <dig>  %. the results show that the proportion of heterozygous loci tends to increase as the proportion of missing data increases . we observed this in all but two methods, beagle and mach. svd and knn were more likely to increase the number of heterozygous loci with more missing data, especially svd for which proportions of heterozygosity reached 24 %, meaning that heterozygous loci were assigned to most missing loci.

imputation methods and genetic variation captured
the mean heritability for traits in this study was  <dig>  ±  <dig>  for plant height,  <dig>  ±  <dig>  for days to maturity,  <dig>  ±  <dig>  for seed protein content, and  <dig>  ±  <dig>  for grain yield. grain yield is considered minimally heritable while the other three are highly heritable. imputation method had the greatest impact on the trait with the lowest heritability  when compared to the impact on traits with high heritability . the mmm method was superior to the other methods for minimally heritable traits while mach was best for highly heritable traits. the svd and knn methods were consistently inferior across traits.fig.  <dig> narrow-sense heritability for soybean agronomic traits computed for genotypic datasets imputed by various methods



the prediction accuracy across traits ranged from  <dig>   to  <dig>  , but did not differ significantly . however, it appears that the genotypic data imputed with rf may have a slightly better performance. whole-genome regression methods did not provide statistically significant differences in prediction accuracy .

discussion
the capture of genetic variation
differences between imputation methods were clearly detectable on a snp panel containing 20 % missing values, raising questions about the quality and reliability of genotypic data obtained by imputing datasets with an 80 % or greater proportion of missing values, a common scenario for gbs.

our results indicate that genotypes imputed with methods that rely on pedigree information, such as mmm, better capture genetic variance in complex low heritability traits, while imputations performed using hmm may favor traits with high heritability. the choice of imputation method will affect downstream analysis. thus, if the genetic architecture of the traits to be analyzed is known, it is possible to achieve more accurate results by selecting the most suitable imputation method.

the genetic architecture of the trait should also influence the choice of genomic prediction method  <cit> , although this study found no statistically significant differences, likely due to the similar nature of evaluated models also reported by howard et al.  <cit> . chen et al.  <cit>  and poland et al.  <cit>  reported interactions between imputation method and prediction accuracy for different traits. for example, genotypic imputation through svd showed inferior capture of genetic variance, but it did not affect prediction accuracy.

mmm: strengths and weaknesses
in this study we presented a mixed model method of imputation using pedigree information that displayed interesting properties regarding the capture of genetic variance and may have advantages for downstream analysis of complex traits. some reported advantages of mmm include imputation of un-genotyped individuals  <cit>  or with a large percentage of missing data  <cit>  without losing robustness; and the identity link function of mmm allows imputation regardless of the allelic coding  <cit> .

on the other hand, genotypic information imputed by mmm was not advantageous for analyzing highly heritable traits and it did not improve prediction accuracy. however, nam populations have a very simple pedigree structure and more complex pedigree structures may lead to better results  <cit> . another drawback was the method’s computational burden because the mixed model computes each molecular marker, a limitation that can be addressed through parallel computing.

much as in hmm, the change-of-state of a haplotype in mmm is controlled by the covariance, with flanking markers considering linkage disequilibrium , and the population structure allied to the pedigree information simultaneously, while forward-backward hmm algorithms work one direction at time using just a subset of random samples  <cit> . imputation methods that incorporate pedigree do not rely on samples from a reference dataset that is assumed to comprise all populations  <cit> . using the genomic relationship instead of pedigree, yang et al.  <cit>  have reported the superiority of a similar mmm method over hmm emphasizing better incorporation of information on ld and ibd.

choice of the imputation method
properties of the methods are summarized in table  <dig>  our results support the use of hmm and rf for a reliable representation of the genotypes, being best for analyses of highly heritable traits and a good alternative even if pedigree data are not available. in addition, imputation though mmm and findhap is preferred to analyze traits with low heritability when the pedigree is known. knn and svd provided consistently poor representations of the genotypes.table  <dig> summary of properties of imputation methods under evaluation



for gbs and other technologies where a high percentage of missing values is expected, our results support the use of mach, fastphase, and rf, methods that have shown insensitivity to the percentage of missing loci. in a similar study,  <cit> ) observed inferior performance of rf over hmm in wheat that could be attributed to the whole-genome imputation at once as opposed to one chromosome at a time, resulting into less informative decision trees and inconsistent imputation. the imputation of each chromosome separately is also a common practice with hmm  <cit> .

CONCLUSIONS
quality of the imputation disturbs the genetic variance captured by the genotypic data. we were able to show that the imputation of genotypic data in the case where proportion of missing values as low as 20 % can affect the quality of the genotypic representation by the snp panel. this results must be seen as a word of care for technologies based on low-coverage genotyping, such as gbs, where the amount of missing information commonly achieves values of 80 %. yet, for the scenario in study it was not possible to identify significant impact of imputation method on genomic prediction. thus, based on imputation accuracy and genetic variance captured by the snp panel, the imputation method choice is hidden markov models and random forest for general analysis. pedigree-based methods of imputation were recognized to enhance the heritability of grain yield, the lowest heritable trait in this study.

availability of supporting data
this study employed genotypes and phenotypes from the soynam project . data is available through the r package soynam  <cit>  and usda-ars soybean database soybase .

competing interests

the authors declare that they have no competing interests.

authors’ contributions

ax, wmm and kmr designed this study. ax and kmr prepared the methods and datasets. ax analyzed the datasets. ax wrote the manuscript and all authors revised and approved the final manuscript.

