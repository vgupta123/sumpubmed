BACKGROUND
the transcriptome has long been studied by reverse transcribing single stranded rna into double stranded cdna and assessed with assays such as pcr  <cit> , microarrays  <cit>  or massively parrallel sequencing  <cit> . by assessing gene expression through cdna the strand information of the rna is lost. with the advent of many strand specific rna library preparation protocols increasing number of rna sequencing experiments are generating stranded rna sequencing data . without strand information it is difficult to determine correct gene expression from overlapping genes; i.e. genes that have the same location in the genome, at least partly, but are transcribed from opposite strands. knowing the strand information of the cdna is essential to determine from which of the overlapping genes the rna originates from. such overlapping genes in mammalian genomes, while not frequent, are more common than previously thought  <cit>  and they are widespread in genomes of other species, especially those with small and compact genomes  <cit> .

increasing exploration of the transcriptome has led to discoveries of multitude of various rna species  <cit> . of particular interest with regards to strand information is antisense rna  which is a transcribed rna that is complementary, i.e. on the opposite strand, to another gene, usually a protein coding gene. thus by definition all antisense genes are overlapping genes. the most straightforward regulatory function of asrna is its ability to hybridize to its existing sense mrna and hinder translation of that particular mrna molecule. this, however, is just one function of many and asrna encompasses many different types of rna  <cit> . a relatively newly discovered feature of asrna is the antisense transcription of pseudogenes  <cit> . pseudogenes, evolutionary remnants of gene duplication, were long thought to be silent and non-functional. still, while prokaryotes rapidly lose pseudogenes from their genomes, complex multicellular animals like mammals often retain their pseudogenes, suggesting evolutionary conservation and thus function. evidence is now mounting towards various regulatory functions of pseudogenes  <cit> .

a handful of protocols have been published which retain the strand information of the rna with varying degree of success and labor intensity. in  <dig> parkhomchuk et al.  <cit>  published a strand specific library protocol which has since become popular among such protocols being both relatively simple and effective. the protocol is called dutp second strand marking method, or dutp method for short, and consists of using dutps instead of dttps during the synthesis of the second strand in the cdna synthesis step during sample preparation. then prior to pcr amplification the uracil in the second strand is degraded using uracil-n-glycosylase . with the second strand partly degraded only the first strand is amplified in the subsequent pcr. this particular strand specific protocol was evaluated as superior in terms of simplicity and data quality in a benchmark study of strand specific protocols  <cit> .

in the current study we modulate specific steps in a scalable transcriptome preparation method  <cit>  to combine the strand specific dutp method  <cit>  and the illumina truseq rna sample preparation kit  into an automated strand specific rna sequencing protocol. by preparing libraries from different cancer cell lines we show that the stranded protocol is reproducible and compares well to its non-stranded counterpart  <cit>  and requires little extra hands on time in sample preparation. from our sequencing data we compare the performance of two sequence aligners; star  <cit>  and tophat <dig>  <cit> . in contrast to the published method  <cit>  we use ribosomal depletion instead of poly adenylation selection to enrich rna and here we evaluate two ribosomal depletion kits; ribominus  and ribozero gold . we then highlight some advantages of stranded libraries by performing a differential expression analysis between strand specific and non-stranded libraries and note how this procedure can be used to probe the annotation of the genome. in conclusion, we turn our attention to high coverage strand specific data to further explore stranded features of the transcriptome; we validate the antisense transcription of the pseudogene ptenp <dig> which has been shown to be involved in the regulatory network of the expression of the gene pten  <cit> , and we report novel transcription in the u2os cell line.

RESULTS
sample preparation
apart from the ribosomal depletion step and as described in  <cit>  , all other sample preparation steps; carboxylic acid  purification, cdna synthesis and library preparation, were carried out on a magnatrix™  <dig> biomagnetic workstation  , which is equipped with a  <dig> tip head suitable for preparing  <dig> samples in parallel. the stranded protocol differs from the non-stranded protocol in two ways; first, during cdna synthesis a ca purification step, carried out on the mbs, is introduced after the first strand synthesis after which the second strand synthesis continues as normal except the nucleotide mix includes dutps instead of dttps. this ca purification step is necessary to remove all the dttps prior to second strand synthesis. second, after library preparation  <cit> , a second strand digestion step is added. this step ensures that only the first strand survives the subsequent pcr amplification step and hence the strand information of the libraries. each of these additional steps add 45- <dig> minutes to the total preparation time, with about 15- <dig> min of those being hands on. additional file  <dig> shows the main automated steps of sample preparations and highlights the difference between the non-stranded method and the strand specific method.

in total there were  <dig> libraries prepared,  <dig> strand specific and  <dig> non-stranded. all libraries returned a high yield;  <dig>  ng/ μl and  <dig>  ng/ μl on average for the strand specific and non-stranded libraries respectively. all the libraries had comparable mean fragment length;  <dig> bp and  <dig> bp on average for the strand specific and non-stranded libraries, respectively. additional file  <dig> shows the concentration and the mean fragment length of each of the  <dig> libraries.

sequencing
all libraries were sequenced on the illumina hiseq  <dig> generating  <dig> bp paired end reads. the  <dig> libraries were divided into  <dig> groups depending on how they were prepared as shown in table  <dig>  in table  <dig> the group id shows the rna source , the enrichment method  and the library type . also shown in table  <dig> is the average number of raw read pairs generated in the sequencing. the raw sequencing reads are available at the ncbi sequence read archive under accession srp <dig> .table  <dig> 
overview of library groups


∗
grouping of libraries according to rna enrichment and library type along with the average number, and the standard error, of raw read pairs in each group. .



trimming and mapping
read alignment was performed by tophat v <dig> . <dig>  <cit>  and star v <dig> .1o  <cit>  on raw reads and on quality reads, i.e. reads that had been through adapter removal and quality trimming . tophat mapped  <dig> % of the raw reads on average compared to  <dig> % for star. for the raw reads the average mapping speed, measured in mapped read pairs per second, was  <dig> for tophat compared to  <dig> for star. the percentage of raw reads discarded from analysis by the quality trimming step step was  <dig> ,  <dig> ,  <dig> ,  <dig>  and  <dig>  for groups  <dig>   <dig>   <dig>   <dig> and  <dig> respectively. tophat mapped  <dig> % of the quality reads on average compared to  <dig> % for star. for the quality reads the average mapping speed, measured in mapped read pairs per second, was  <dig> for tophat compared to  <dig> for star. thus, star is nearly one hundred times faster than tophat.

graphical representation of these mapping attributes, mapping percentage and mapping speed, for both aligners and a comparison between the handling of raw data and quality data is shown in figure  <dig>  for these attributes star outperforms tophat in all instances. also, the quality trimming improves the alignment yield, not only in relative terms but in absolute terms as well , and the mapping speed. based on these results all further downstream analysis was based on the quality trimmed data aligned with star.figure  <dig> 
alignment yield and mapping speed. mapping yield a) and mapping speed b) for the aligners tophat and star, performed both on raw data and quality data. the mapping efficiancy and mapping speed improves using the quality data for both aligners. star outperforms tophat both in alignment yield and in mapping speed. note that the alignment speed is plotted on a log scale.



quality control metrics
the robustness of the protocol and the quality aspects of the data were evaluated using the  <dig> libraries generated from the human cell lines  through different metrics; ribosomal rna in data, strand specificity, duplication rate, gene body coverage and expression correlation. details from some of these analyses can be found in additional file  <dig> 

ribosomal contamination
to evaluate the efficiency of the ribosomal depletion, the rrna reads in each library were quantified. on average the libraries treated with ribominus contained  <dig> % rrna compared to only  <dig> % for the libraries treated with ribozero. figure 2a shows the average percentage of rrna reads in each library group.figure  <dig> 
quality control metrics for human cell line libraries.
a) rrna content in libraries treated with ribozero is  <dig> % on average while rrna content in libraries treated with ribominus is  <dig> % on average. error bars denote standard error. b) the strand specificty of strand specific libraries is  <dig> % on average; the libraries treated with ribominus have slightly higher strand specificity than the libraries treated with ribozero. the unstranded libraries have strand specificity of  <dig> %. c) the duplication rate varies between the libraries. the higher duplication rate of the libraries treated with ribozero compared to the libraries treated with ribominus can partly be explained by the much higher sequencing depth of those libraries. the hollow triangles represent the duplication rate of the downsampled data . d) all libraries show even gene coverage. the percentages in parenthesis is the percentage of reads that map closer to the 3’ end than to the 5’ end. .



strandedness of libraries
in general, these results show that the protocol works and in particular that the ca purification step is successful in removing dtnps after the first strand synthesis.

duplication quantification
due to the risk of inaccurately identifying reads originating from highly expressed genes as duplicates, the duplicate reads were not removed prior to differential expression analysis.

gene coverage and read distribution
expression correlation
to further assess the robustness of the libraries the correlation of expression values between replicates was quantified. the mean pearson correlation of the  <dig> possible correlations within replicates was r <dig> =  <dig> . correlation plots and the pearson correlation value for each correlation is shown in additional file  <dig> 

differential expression - strand specific vs. non-stranded data
the only difference between libraries in group  <dig> and group  <dig> is that the libraries in group  <dig> are strand specific, generated using the current approach, while the libraries in group  <dig> are non-stranded, generated using the approach in  <cit> . in order to explore the differences between these library types a differential expression  analysis was carried out beween these groups; first by downsampling each library so that they contain equal amount of reads, then by acquiring read counts per gene using htseq-count  <cit>  and finally using these read counts as input for the de analysis using deseq v <dig> . <dig>  <cit> .

of the  <dig> annotated genes   <dig> do get assigned low or no expression in all of the six libraries. of the remaining  <dig> genes  <dig> are found to be significantly differentially expressed genes, hereafter referred to as degs. of these  <dig> degs  <dig> have higher expression in the non-stranded libraries while  <dig> degs have higher expression in the stranded libraries. intriguingly the division of degs into protein coding genes and non coding genes is different depending on whether the degs have a higher expression in the non-stranded data or in the stranded data. so, for the  <dig> degs which show higher expression in the non-stranded data  <dig> are protein coding and  <dig> are non-coding while for the  <dig> degs which show higher expression in the stranded data  <dig> are protein coding and  <dig> are non coding. this expression profile is shown in figure  <dig> figure  <dig> 
differential expression profile when comparing the strand specific libraries to the non-stranded libraries. all green dots are protein coding genes found to be signficantly differentially expressed and all red dots are non coding genes found to be signficantly differentially expressed. pcrna: protein coding rna, ncrna: non-coding rna.



to find out why these degs arise, coverage plots for a selection of the degs with the lowest p-values, were analysed and compared to the annotation used for counting by htseq-count. all degs investigated that have a higher expression in the stranded data compared to the non-stranded data have overlapping annotation which results in many reads mapping to those genes being labeled as ambiguous for the non-stranded data and hence resulting in low expression. explanation for degs with higher expression in the non-stranded data compared to the stranded data is not as straightforward but scrutiny revealed three dominant reasons for these degs; i) the degs have overlapping features that are unnannotated, ii) the degs are annotated in the wrong direction or iii) the degs have antisense intronic transcripts that get wrongly assigned to them. additional file  <dig> shows coverage plots of selected degs along with their annotation and explanations for why these degs arise in this comparison and additional file  <dig> lists all the genes found to be significantly differentially expressed in this differential expression analysis.

this analysis also demonstrates how essential it is to have strand specific libraries for compact genomes with high abundances of overlapping genes since without strand specificity a large proportion of the genes would be labeled as ambiguous.

transcriptome assembly - strand specific vs. non-stranded data
for each library in group  <dig>   <dig> and  <dig> two transcript assemblies were made using cufflinks  <cit> . the first, termed raw assembly, used all mapped reads while the other, termed novel assembly, used only those reads that did not map to the ensembl reference annotation . then the assemblies within each group were merged together using cuffmerge  <cit> . in addition, library  <dig> was assembled again without supplying cufflinks with the information that it was strand specific thus generating a pseudo non-stranded assembly.

from these assemblies it was found that strand specific data generates fewer transcripts compared to non-stranded data and the average transcript length is usually shorter for the strand specific data as compared to the non-stranded data. the same holds true when comparing the assemblies between library group  <dig> treated as strand specific to library group  <dig> treated as non-stranded. an overview of the assembly results is shown in additional file  <dig> 

antisense transcription of the pseudogene ptenp1
the antisense transcription of the pseudogene ptenp <dig> has previously been reported and suggested to play a role in the regulation of the gene pten  <cit> . from the high coverage data of the u2os cell line  this antisense transcription was verified and further evaluated.

the coverage plot in figure  <dig> shows clear antisense expression of the ptenp <dig> pseudogene. the refseq database has this antisense transcript annotated as a gene with one isoform containing four exons as shown in the uppermost annotation track in figure  <dig> . the ensembl database, however, does not have this antisense transcript annotated but it does have two genes annotated further downstream as shown in the ensembl annotation track in figure  <dig>  the new annotation presented here, based on the raw assembly results from library group  <dig>  is shown at the bottom annotation track in figure  <dig> which suggests two new isoforms of the antisense gene ptenp <dig> one of which includes a new exon . this new exon overlaps the two annotated genes from the ensembl annotation indicating that they may be, not seperate genes, but part of the ptenp <dig> asrna.figure  <dig> 
antisense rna of ptenp <dig>  antisense transcription of the pseudogene ptenp <dig>  the refseq annotation includes only one isoform  while the ensembl annotation does not have this transcript annotated. our data, based on cufflinks assembly, suggest two alternative isoforms for this transcript labeled ptenp1-as <dig> and ptenp1-as <dig>  the ptenp1-as <dig> isoform includes a novel exon, higlighted by a red arrow, which overlaps ensembl annotation of other genes. it is suggested here that this ensembl annotation is wrong and that these genes are part of the ptenp1-as gene. *the cufflinks assembly shown here has been cleaned up a bit. for the direct output delivered by cufflinks see additional file  <dig> 



using an annotation which included the refseq isoform, ptenp1-as, and our two new isoforms, ptenp1-as <dig> and ptenp1-as <dig>  the isoform expression levels were evaluated with cufflinks. ptenp2-as is expressed with an average fpkm value of  <dig>  but the other isoforms, ptenp1-as and ptenp3-as, showed no expression according to cufflinks.

novel expression in u2os
identification of novel genes was attempted by using the novel assembly from library group  <dig>  by counting the mapped reads towards this novel assembly the most highly expressed genes were investigated. many of the assembled transcripts were evidently intron transcripts and others matched the current annotation, at least partly. other transcripts were potentially novel genes.

one interesting example are two overlapping novel genes on chromosome 17: 25380000- <dig>  figure  <dig> shows this region along with the annotations from ensembl and the prediciton by cufflinks. currently the only known annotation in this region is the pseudogene tufmp <dig>  but the data shown here clearly indicates more transcriptional activity, originating from both strands. the open reading frame of these novel transcripts indicates that they are non-coding. comparing the transcription of the locus between the three cell lines shows that this transcription is exclusive to the u2os cell line .figure  <dig> 
novel expression in u2os. novel, cell specific, expression on chromosome  <dig>  the coverage plot shows transcriptional activity, color coded to reflect the strand of origin. in the ensembl database this region has one annotated pseudogene. the data here indicate high transcriptional activity from both strands. shown at the bottom is the annotation as suggested by cufflinks. *the cufflinks assembly shown here has been cleaned up a bit. for the direct output delivered by cufflinks see additional file  <dig> 



two other interesting findings can be found in the additional files; a u2os cell specific transcription on chromosome  <dig>  possibly a pseudogene, is shown in additional file  <dig>  and ubiquitous transcription of chromosome  <dig>  which is currently annotated as two genes but our data suggests it is two exons of one gene, is shown in additional file  <dig> 

discussion
sample preparation
we have modified an existing non-stranded automated rna library protocol into a protocol that generates strand specific libraries by using the illumina truseq kit in combination with other reagents. this may be useful for other researchers who use the illumina truseq kit and want to make strand specific libraries. however, illumina has now released a new kit; truseq stranded total rna sample prep kit , which combines ribozero rrna depletion with a strand specific method similar to the dutp method. it should be possible to fully automate that protocol on the mbs for generating  <dig> samples in parallel or on the agilent bravo for a higher throughput of  <dig> samples in parallel.

trimming and mapping
we showed that quality trimming and adapter removal improves the alignment yield and mapping speed, both for tophat and star. we set the quality threshold to  <dig> on the phred scale and then removed any pairs that contained reads shorter than  <dig> bp after trimming. by setting the parameters differently this improvement might be different. for example by increasing the quality threshold it is likely that the mapping percentage will increase but that will not neccessarily improve the mapping in absolute terms since many more reads would be discarded prior to mapping. due to trimming, some of the quality reads are shorter than the raw reads which could explain the improvement in mapping speed of the quality data over the raw data.

we also showed that star outperforms tophat in alignment yield and mapping speed. this is in accordance with previous reports on alignment yield  <cit>  and mapping speed  <cit> . there are other features where these two aligners differ which are not investigated here but a recent and thorough comparison of various spliced aligners can be found in  <cit> .

quality control metrics
we showed that the ribozero gold kit far outperforms the ribominus kit in removing ribosomal molecules from rna samples. it should be noted that the ribominus kit is now no longer available for purchase and has been replaced by ribominus v <dig>  we show a  <dig> % rrna contamination in the ribozero treated samples which is better efficiency than previously showed in a comparison study  <cit> .

duplication quantification
the markedly higher amount of duplicate reads in the ribozero libraries compared to the ribominus libraries can partly be explained by the much higher sequencing depth of those samples. still, all the libraries show a considerably high duplication rate. we believe that this can be explained by too many pcr cycles in the libary preparation but in the protocol the number of pcr cycles was fixed at  <dig>  we have now altered the protocol to include a qpcr analysis step to measure the ct value  which better determines the amount of pcr cycles needed for each library during preparation.

differential expression - strand specific vs. non-stranded data
we compare our current, strand specific, approach to a previously, non-stranded, approach  <cit>  and show that genes get determined as differentially expressed when comparing strand specific data to non-stranded data, from otherwise identical samples. out of  <dig> expressed genes we identify  <dig> of them, or around  <dig> %, to be differentially expressed.

we further showed that these genes arise in a systematic manner in such a way that overlapping genes that are annotated get underrepresented in the non-stranded data and genes that have a faulty annotation can get overrepresented in the non-stranded data. also, genes in the non-stranded data can get overrepresented due to intronic transcripts from the opposing strand.

this highlights the importance of having strand specific libraries in order to be better able to make correct assumptions from the data. it also emphasizes the need for accurate and verified annotation which, currently, even for human is erronous and incomplete. by comparing stranded and non-stranded data it is possible to probe the areas of the annotation that need attention. this also shows, in the absence of strand specific data, that researchers need to be extra attentive when interpreting results from overlapping loci in the genome.

it should be noted that this method may not be sensitive enough to pick up all antisense behavior, for example if the overlap between the two strands is only a small proportion of the transcribed genes, and evidently more than  <dig> % of the genome features antisense transcription.

transcriptome assembly
from the transcriptome assembly we show that the strand specific data produces fewer transcripts than the non-stranded data. also, strand specific data usually produces shorter transcripts. this may indicate that assemblies from non-stranded data generates more false positives than does strand specific data.

it must be stressed though that cufflinks is far from perfect and tends to generate many questionable transcripts as can be seen from the transcripts we removed  and the many transcripts assembled from library group  <dig> . cufflinks also has many different parameters that can be tweaked which can effect the results signficiantly. assembling transcripts is a difficult task and is not the major focus of the current study. nevertheless, cufflinks proved useful as a guide for the asemblies we present and to highlight one of the many differences between strand specific and non-stranded data.

CONCLUSIONS
the illumina truseq library preparation kit can, with modifications, be used to make strand specific libraries. the ribozero kit is excellent in removing rrna molecules from total rna and the star aligner is ideal for big datasets and/or when time is a factor in the analysis and we show that quality trimming can improve mapping efficiency. there is a good selection of freely available bioinformatical tools for rna sequencing analysis many of which have an option to indicate whether the data is strand specific or non-stranded. thus there is, computationally, not much difference in analysing strand specific data compared to analysing non-stranded data. furthermore, none of these tools are specialized for handling strand specific data nor are any of them at a disadvantage when applied to strand specific data. however, data from strand specific libraries is more reliable than data from unstranded libraries and can correctly evaluate the expression of asrna and other overlapping genes as well as the direction of intronic reads. the annotation of the human genome is comparatively thorough and correct but still in need for verification, correction and improvement, all of which can be achieved with strand specific rna sequencing.

