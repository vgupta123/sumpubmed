BACKGROUND
human vision can be considered as a perfect image information processing device, it can easily recognize object's position, size, and orientation, pose in space, and so on. for a long time, visual scientists, computational neuroscientists, image processing experts and computer vision researchers make great effort to explore the neural mechanism of humans' remarkable visual abilities or how the retina image is represented in the primary visual cortex, which is related with the following two questions: what kind of neural computation is actually performed by the primary visual cortex, and how this is described mathematically.

it is well known that there is a one-to-one topographical mapping between retina and cortex v <dig>  which determines projecting relations in visual space and represents some transformations from retina to cortex v <dig>  <cit> . currently, it is believed that responses of neurons in cortex v <dig> can be simulated by a set of tiled spatio-temporal filters array. so the function of cortex v <dig> is to make a spatial local fourier transform. theoretically, these filters involve many processes about spatial frequencies, orientations, motion and velocities   <cit> .

is this notion consistent with the actual biological visual information processes? research in neurobiology indicates that the metabolism and decay of neurons do not affect the visual function. every neuron performs a simple on-off function and transfers the information through spikes. so a dead neuron can easily be replaced by other nearby neurons  <cit> . in case of a complicated function, this replacement would be difficult. therefore, the simplicity of algorithms not only reduces error rates to the minimum, but also guarantees repeatability and stability, i.e. robustness.

complex computations can be carried out by parallel computations of neuronal groups with high efficiency. so we believe that the actual computations in retinal image must be simple, repeatable and robust and be performed by individual neurons at the system level and by neuronal groups with high efficiency. they are obvious requirements for neural computations in v <dig> 

then, how is the topographical mapping from retina to v <dig> be realized? many neurobiological experiments and visual computational models show that when every primitive  in the visual image finds matches in the receptive fields densely distributed on v <dig>  only the neurons whose frequencies and orientations are similar to those of the primitive fire  <cit> . therefore, the patterns of the fired neurons correspond to the primitives in the visual image, which may be represented by a topographical mapping, reflecting the adjustment of the visual image to neurons in v <dig>  and reflecting distributive and parallel visual information processing between retina and v <dig> <cit> . in this paper, we discuss the mathematical representation of this information processing and use the normalized matching measure  to measure the matching extent  <cit> .

this paper proposes a model of neural information processing based on the topographical map in place of fourier transform. in this model, the functional columns are not considered as sets of tiled filters, but basis elements of the visual information, including orientation selectivity and feature matching  <cit> . the visual image carried by spike trains is processed by kronecker product with functional columns in v <dig>  so synchronously parallel computations on the whole image can be performed by receptive field-to-receptive field rather than by pixel-to-pixel, and be represented by kronecker product between matrixes. its complexity is greatly reduced as compared with fourier transform and other matrix computations  <cit> . what is more, this algorithm can simulate stimulations of the elements in the visual image to cortical neurons as the embodiment of simple neural functions. the aggregative computation based on simple functions is one of plausible approaches of the visual cortex in realizing topographical mapping.

numerical simulations are carried out to justify the above notions. in our experiments, receptive fields of neurons in v <dig> are simulated by hierarchical gabor functions  <cit> . visual image is the feature image of lenna processed by pre-processing  in front of the pathway. results of our algorithm are consistent with theoretical expectations.

RESULTS
the visual pathway  from retina across lgn to v <dig> is modelled. the following discussions are focussed on:  <dig>  the optimal detection in v <dig> of retinal image r;  <dig>  the optimal matching between r and firing pattern of neuronal groups in v1;  <dig>  kronecker product obtained by optimal detection and matching;  <dig>  determination of kernel function g;  <dig>  realization of kronecker product;  <dig>  numerical experiments and discussions.

image division and cortical response
as a first step of visual perception, external stimuli form a retinal image r. in the retina, a ganglion cell receives inputs from about 103~ <dig> photo-receptor cells. if the size of a ganglion cell's receptive field is a = Δx × Δy, the total imaging area of r in the retina is a, which is divided into m × n patches with the same size a as that of a ganglion cells receptive field, namely a = a. here a is referred to as sub-region, therefore, a indicates only its size; and the partially small image covered by the area a is called image unit or image primitive, and expressed by r. in this way, a patch or the image primitive at the i line and the j column can be denoted as ri, j , and the entire image included in the area a is also expressed by r, as shown in figure  <dig>  that is to say, the whole image r can be also formed from  patches by means of orderly putting patches together, i.e. .

this division involves two aspects. first, every patch ri,j contains local features  at  with area , while a pixel at  only contains intensity information. second, in the parallel multi-channel vision system, every channel only deals with a local patch. obviously this division is consistent with parallel and multi-channel properties of a vision system, and in a topographical mapping any patch can be located in the retina, so the neural processing based on functional columns can be realized and the corresponding mathematical description is possible. a patch ri,j will activate the corresponding ganglion cell and output a coded firing spike train. this is transferred across lgn into v <dig> as a topographical mapping. then, the firing spike train is decoded and the image represented by ri,j is restored. a kronecker product of the restored image with functional columns bk,l in v <dig>  <cit>  leads to firing of neurons in receptive fields having similar orientation and bandwidth . we denote the firing pattern of one singular neuron  as ϕi,j, where b denotes the area of the receptive field of the neuron. since, a, the retinal image area, will be enlarged in the cortex v <dig>  <cit> , for simplicity, with a magnification factor z = 2h ; if the area of image on the cortex v <dig> is denoted by b, we have b = za = 2h a, b = za = 2h a. in this way, the spatial sum of all signals ϕi,j in an orderly manner will form the overall firing pattern, that is , which represents a reconstruction of the retinal image r on v <dig> 

optimum detection in v1
for a single neuron in the functional columns, its receptive field consists of orientation, band-pass and spatial location  <cit> , with a strong selectivity with respect to visual image r topologically mapped from the retina. when some patch ri,j in visual image r shows properties at specific orientation and specific frequency similar to some receptive field gi,j, the corresponding neuron will respond strongly. in other words, when a local patch coincides with the receptive field of a neuron at its sensitive orientation and sensitive frequency, the neuron fires most strongly, which means a detection and matching of functional columns in v <dig> to local retinal patch's features ri,j, as a random process, in other words, which is a detection and matching in a random process. therefore, this process can be expressed as  <cit>    

where ri,j is a patch from input image r containing basic features such as orientation, edge, and contour within the receptive field. here ni,j is gaussian white noise with zero mean and variance . it is assumed here that the noise environment in different visual pathways is the same, i.e. ni,j is the same. αi,j is weight coefficient that can reflect excitation strength of an image primitive to neuron gi,j. we want to know what value of αi,j can strongly activate neuron gi,j to fire. obviously, αi,j is an unknown estimated coefficient. if we make k observations on the random process , in other words, we carry out k sampling on the random process , then formula  can be written in the following general form   

according to maximum likelihood estimation and least mean square error rule  <cit>    

the optimum estimation of ai,j is   

where  is a ratio coefficient.

we can see ai,j reaches its optimum value  when image patch ri,j coincides with receptive fields feature gi,j, i.e. ai,jri,j  = gi,j. so,  can be taken as the measure for matching extent between neuronal receptive field gi, j and patch ri,j in image r.

above process is illustrated in figure  <dig>  where the local patch is a horizontal edge and an optimal matching is found in receptive fields of horizontal orientation with a strong response. no optimal matches are found in receptive fields of other orientations, so we have weak responses.

it is worthy noting that the multi-scale processing function of a visual pathway is to guarantee a clear image at a proper resolution in v <dig>  so, the optimal matching is related with some resolution. when the scale or resolution changes, the optimal matching may concentrate on different extents of details, or may include or exclude some details, as is determined by the circumstances when the vision system is "observing" the world.

the whole matching between the retinal image and receptive field patterns in v1
in the previous section, we have described the local matching or detection . next we will analyze the image matching as a whole, to obtain a mathematical representation of the neural firing pattern in v <dig>  it is understood that the topographical mapping from retinal image r to v <dig> is actually a stimulating process of r with respect to simple selective cells with features of orientation, bandwidth and so on. receptive fields g of activated neurons are combined to form the global firing pattern Φ in the cortex, as the responding process of simple cell groups to the visual image. so, the firing process can be regarded as a global matching between g and r at the system level, and eventually responding pattern Φ will be formed. many methods can be used to measure the extent of matching. however, in order to ensure a minimal reconstruction error, we adopt the following measure:   

where b is the imaging region in v <dig>    

let . in the optimal matching in region b, we will have r = g, as is the case when the equal operation is adopted in formula  and λrg reaches its maximum value λmax. therefore, we can define the normalized matching coefficient ρrg as follows:   

obviously when ρrg =  <dig>  g and r reaches a complete match. in other words, the receptive fields of all activated neurons in v <dig> are combined to form the same responding pattern Φ as the whole visual image. it shown that this process can be mathematically described as follows by multiplication of r and g   

it can be seen later, r and g can be expressed as matrix form, for this reason, the formula  is essentially an inner product operation, it is not only more elegant on the mathematical form, but also more clear on the neurobiological significance.

additionally, we can see the normalized matching coefficient ρrg is equivalent to  in the previous section.

determination of integral kernel function
in formula , the role played by receptive fields g of cortical neurons is the same as the integral kernel in wavelet transform  <cit> . it can be described as oriented and bandwidth two-dimensional gabor function gλ,σ,θ,φ,γ  <cit>    

where γ is the ratio of the length in the major axis direction to that of in minor axis direction, usually set to a constant  <dig> ; σ is derivative of gauss, determining the size of receptive fields; φ is the phase, when φ = 0; π; gλ,σ,θ,φ,γ is symmetric about the origin; when φ = -; , gλ,σ,θ,φ,γ is anti-symmetric about the origin; Θ is the optimal orientation, and λ is the wavelength. these arguments should be determined by experimental results from morphology and biophysics, but the exact data are not available so far  <cit> . one plausible way is to set the arguments according to input image features in an input-driven topological mapping  <cit> . this will be explained in the last section.

substituting  into  and considering the cortical responses to orientation and bandwidth properties, we replace Φ with Φ,λ,σ,θ,φ,γ   

it is also the inner product, because the formula can be also expressed as matrix form. the formulae  and , as the inner product, which shows such an important neurobiological fact, that is, in the visual pathway topographical mapping indicates accurate positioning of retinal image in the visual cortex, therefore, these primitives can only respectively activate cells which are in the corresponding locations in visual cortex. since it is a one to one excitation, scanning and convolution is no longer needed.

comparison of inner product with convolution
for comparison, the convolution operation may be expressed as follows   

we know that convolution and cross-correlation operations are essentially filtering operations in the frequency domain, which is not needed for v <dig>  because such a filtering operation would lead to loss of high-and low-frequency information from the retinal picture. the second reason is that the scan process in such operations  is a calculation with a high cost , in which, gλ,σ,θ,φ,γ should be taken as the template to scan the whole image r from top to bottom and from left to right. obviously, it is not an effective method, because this scanning will cause too many responses of corresponding cells and the energy cost is too great.

mathematically, the discrete convolution of formula  can be expressed as   

for some point  in an image, gλ,σ,θ,φ,γ is moved around on the image  to realize an optimal match between Φ and r. the matched simple cell then is activated. figure  <dig> shows an example, in which the visual image r is a small horizontal or vertical line. obviously, a horizontal line in r excites numerous cells whose receptive fields have an orientation similar to a horizontal line, and a similar effect occurs for a vertical line. such a calculation comes with a high costs in time and complexity.

the use of the inner product reveals that neuron firing caused by a visual stimulus is in fact a simple function. this is a simpler neural computation than the cross-correlation and convolution operations, because it needs only multiplication between corresponding pixels of Φλ,σ,θ,φ,γ and r. it is worth pointing out that the product rΦλ,σ,θ,φ,γ means that the retinal image r excites all cortical cells and forms a global activity pattern Φ λ,σ,θ,φ,γ in v <dig>  different visual stimuli will excite and form different activity patterns corresponding to that stimulus; the differences in activity patterns occur only in a topographically connected weight coefficient of the pixels of r with the corresponding pixels of Φλ,σ,θ,φ,γ in a fully mapping neural computation. generally, the weight coefficients corresponding to detailed image information are much smaller than those corresponding to contour and edge information. the intensity of the spike firing of simple cells excited by the details of the stimulus is also weaker than the intensity corresponding to contours and edges.

the inner product  in equation  reveals the collective calculation of a simple neuronal "on" or "off" function. from this, we can see that the calculation of the inner product is very well suitable to the visual system in that it satisfies the prerequisites of efficiency, simplicity, and robustness and also provides an optimal means of detection under the condition of least-mean-square-error reconstruction.

in fact, formula  reflects a specific wavelet transform on retinal image r by basis function gλ,σ,θ,φ,γ. this formula reflects the neural firing stimulated by the retinal image at the system level. next we will discuss how to process visual images according to this formula. two important problems will be discussed, that is, how to divide visual image r according to structures and functions of the visual pathway and how to express the orientation selectivity of functional columns in v <dig> by two-dimensional wavelet function gλ,σ,θ,φ,γ.

kronecker product in v1
usually, visual image r is independently transferred to lgn through  <dig> million ganglion cells, and then reaches the layers of 4cα and 4cβ in v <dig>  and finally an image is reproduced in v <dig>  obviously, every image patch ri,j is transferred through one channel. suppose the number of channels is m × n, which means visual image r is divided into m × n units. as pointed out in previous section, each patch is assumed to have the same size as the receptive field of a ganglion cell, namely, a = Δx × Δy. the area of the whole image is a. in every channel only one patch of m × n, with local features, is transferred. all ri,j are added to form m × n.   

the receptive field of a neuron distributed in v <dig> is gi, j. after being stimulated by m × n, a response pattern m × n  is formed from theses receptive fields as:   

according to neurophysiology and neuroanatomy  <cit> , cortical modules are densely distributed in v <dig>  with approximately  <dig> modules; the area of each module is approximately  <dig>  mm ×  <dig>  mm, containing two function columns for both left and right eyes. thus, the area related with every function column bk,l  is  <dig>  mm ×  <dig>  mm. at the system level, before adequate neurophysiological and neuroanatomical knowledge may be available, these function columns are assumed to have the same function and be composed of many receptive fields with different orientations and frequencies  <cit> .

in this paper, the receptive fields of the function column can be represented as a matrix. as in figure  <dig>  each row of the matrix represents eighteen oriented receptive fields of the same type uniformly distributed from 0° to 180°. each column of the matrix represents eight types of receptive fields  with a same orientation. so k × l is made up of  <dig> elements gi,j     

therefore, some edge or contour located at  in retinal image m × n with area a will find a best match with the receptive field gi,j of the same orientation and shape. when ρrg  =  <dig>  it means the patch at  in m × n completely matches the cortical module k × l with the specific orientation. then the neuron is activated with the strongest response. the process of this image reconstruction is shown in figure  <dig> 

when all the m × n patches in retinal image m × n simultaneously  activate topographically corresponding neurons, response pattern m × n is formed in v <dig>  at the system level, this process can be described by kronecker product.

optimal responding of a neuron in v <dig> is actually reached through detection of cortical module k × l with respect to a patch ri,j in retinal image m × n, which can be represented as a product of them, i.e. ri,jk × l   

where |max for {ri,jbk,l| k =  <dig> ,⋯8; l =  <dig> ,⋯,18} means taking the maximum in . when i =  <dig> ,⋯, m; j =  <dig> ,⋯, n, it is equal to kronecker product between m × n and k × l. the two matrixes are not necessarily of the same dimension. it can be represented as   

where ⊗ denotes kronecker product, |max for ∀{ri,jbk,l},  =  <dig> or ρrϕ =  <dig> denotes the maximal of all products between ri,j  and b <dig> , b <dig> ,⋯, b <dig>   . in a neurobiological sense, only stimuli with optimal orientation and frequency may activate the strongest response of simple cells in v <dig>  formula  represents the activated pattern corresponding to a typical image. this pattern can be represented as a matrix   

in formula , m × n is the representation of retinal image m × n in v <dig>  which involves an essential difference with the traditional coding.

as is known, an image i can be represented as a linear combination of orthogonal basis functions ψi,j   

where ai,j are weights. obviously, the intersection of ai,jψi,j is not null, i.e.   

that is to say, the intensity at any location  in image i is contributed by all basis functions ψi,j , so the computation can be highly complicated. in our case, the orthogonal division of input images makes every patch ri,j orthogonal as shown in figure 6; at the same time, the following condition is satisfied:   

therefore, every patch ri,j can be processed independently by functional columns. this is consistent with the neural mechanism of cortical information processing, and reduces computational complexity as well.

discussion
currently, it is widely believed that simple cells densely distributed in v <dig> function similarly as a tiled set of selective spatio-temporal filters, while v <dig> carries out operations similar to the local complex fourier transform. theoretically, various kinds of neural processing about frequency, orientation, motion and other spatio-temporal operations can thus be performed  <cit> .

in this way, the responding property Φλ,σ,θ,φ,γ in v <dig> is realized by a convolution between image r and receptive fields gλ,σ,θ,φ,γ  <cit> .   

that is to say, gλ,σ,θφ,γ is taken as a template to scan the whole image r from above to bottom and from left to right. for example, if gλ,σ,θ,φ,γ is a horizontal orientation receptive field, it will match to many edges with a similar orientation in r, so many cells in v <dig> are activated. the activated pattern Φλ,σ,θ,φ,γ is shown in figure  <dig>  a similar activated pattern corresponding to a vertical edge is shown in figure  <dig>  this is not an effective method for it stimulates too many responses of relative cells and costs a large amount of energy  <cit> .

while in our case, in order to reconstruct retinal image m × n, we only calculate activated pattern ϕi,j = ri,jbk,l of the receptive field stimulated by every patch ri,j according to formula , and then the location of every patch is determined according to the topological mapping to v <dig> according to formulas  and . finally, the whole activated pattern m × n stimulated by image m × n is obtained. obviously, the related computation is much less complicated, which thus is more consistent with the multi-channel parallel processing mechanism in biology vision.

in order to compare computational complexity of the two ways of computation, we discretize formula  as   

every element ϕ in array m × n involves m × n times of calculations, making the total calculations for all elements as m <dig> × n <dig> 

while in our case, the main computation is ϕi,j = ri,jbk,l, so the total number of calculations are m × n × k × l . so the computation of kronecker product is much less complicated than that of convolution.

we already noticed that a number of other researchers have developed linear-nonlinear models based on response properties of visual neurons  <cit> , or on optimal nonlinear transformation  <cit> . in essence, they are a combination of linear filtering and divisive inhibition model; all of the models have been used to model the nonlinear responses of visual neurons and primary visual cortex. in terms of our proposed model, as already pointed out that theoretical analysis and simulated results show that at the system level, the inner product operator reflects the nature of the excitation of neurons in the cortex v <dig> by local characteristics of the external stimuli. this is also a plausible assumption for neural computation in the cortex v <dig>  therefore, it may have some reference value in investigations of neural mechanisms in visual information processing.

CONCLUSIONS
it is understood that the retinal image must be in one-to-one correspondence with cortex v <dig>  for all subsequent processing will extract information from v <dig> and the information kept in v <dig> is vital. only in this way, the brain can perceive a vision through the retinal image with high fidelity. neurophysiology shows that when a retinal image topographically projects to the visual cortex, corresponding neurons will be activated. the whole activated pattern is a copy of the retinal image with high fidelity. in view of signal processing, product ri,jbk,l means that receptive fields gi,j  in v <dig> are activated when stimulated by retinal image ri,j. therefore, this operator is consistent with this neurobiology mechanism. it involves both the simple function of a single neuron and the population function of neuronal groups. ϕi,j  is the local activated pattern corresponding to patch ri,j. different stimuli produce different activated patterns of neuronal groups. the signals activated by details in visual stimuli are much weaker than those activated by contours. according to our understanding of the precise reconstruction of retinal images in the visual process, and based on multi-channel parallel processing features of the visual pathway, a visual image is divided into basic image units  or primitives, which are topographically mapped onto the visual cortex by a one-to-one correspondence, by means of multiplication computing, features contained in image's primitives can be extracted by thousands of visual cortical modules in parallel and synchronously, where only an inner product is needed, then an image will be formed in the primary visual cortex. this algorithm is simple, efficient and in line with the current knowledge about the neural mechanism of visual information processing, the mathematical description is also appropriate to the visual neural computation.

visual information processing that is actually carried out in v <dig> is very important, but so far our knowledge of it at the system level remains inadequate  <cit>  apart from hubel and wiesel's discovery  <cit>  in the 1960s and field and olshausen's sparse coding theory  <cit>  in the 1990s. therefore, the neural computation model based on available knowledge about structure and function of v <dig>  <cit> , presented in this paper may throw some light towards that direction, of course, will require further proof in neurobiology.

the next step of the studies on the visual information processing will be focussed on functional modules in cortex v <dig> 

