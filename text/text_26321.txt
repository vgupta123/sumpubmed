BACKGROUND
most of the common human diseases with high mortality rates  are classified as complex diseases  <cit> . by definition, a complex disease is a multifactorial complex trait generally caused by multiple predisposing loci  and by the exposure to particular environmental factors  <cit> . although several genetic and environmental factors have been shown to affect susceptibility to particular complex diseases, the intricate sets of relationships between these factors and disease susceptibility are not yet exhaustively understood. for this reason, typically, the proportion of risk accountable to genetics and environment remains mostly unpredictable  <cit> . explanations for their unpredictability might include the occurrence of still unidentified factors and/or the presence of non-linear interactions among already identified factors; for example, some combinations of genetic and environmental factors could have disease risks that are consistently higher than those predicted by a single component.

gene-environment interactions  are expected to influence complex phenotypes, for example, disease risk. hence individuals with predisposing genetics are more likely to develop a disease when exposed to a damaging environment than individuals, exposed to the same environment, without predisposing genetics  <cit> . the role of g×e is so relevant that it is generally accepted that neglecting them can lead to an underestimation of disease risk, and may explain some of the inconsistencies in replications in different studies  <cit> .

complex phenotypes are regulated by pathways and biochemical mechanisms that involve many genetic products. hence, in addition to interactions among genes and environment, interactions among different genetic loci  can also influence disease risk. in particular, g×g are defined as epistatic when the allelic variations of one gene alters the effect of variations of another gene  <cit> . epistasis has been identified in human diseases  <cit> , and its role in public health has been highlighted  <cit> .

surprisingly, despite the general agreement on the relevance of g×e and g×g for correct disease risk estimations, only a few epidemiological studies have attempted to identify them. indeed, studying the complex interactions among risk factors is a daunting task that requires large data sets and specific research designs. furthermore, the best statistical method for the identification of g×g and g×e in case-control data sets  <cit>  is still widely debated. the performance of statistical methods that are used for the identification of g×g and g×e are typically influenced by many factors: sample size, number of involved factors, type of interaction, model of inheritance, allelic frequencies, distributions of the environmental factors, and relative strength of different factors affecting disease risk. unfortunately, only a few of these features are generally assessable in real populations. a further limitation of the epidemiological studies that have been performed so far, is the limited knowledge about the impact of linkage disequilibrium  on association statistics in the presence of g×g and g×e. it has been demonstrated that when g×g occur and the assayed snps are not the functional ones but snps that are in ld with them, common statistics like r <dig> are generally inappropriate and tend to lead to an over/underestimation of disease risk  <cit> .

a possible strategy to assess the performances of statistical methods is to test them against simulated data sets where the relevant features influencing the disease risk are known . with this aim, some of the authors  <cit>  of the present work proposed a novel approach to simulate case-control samples based on: 

 <dig>  a multi-logistic model  that can model any type of g×g and g×e,

 <dig>  a mathematical approach  that can translate biological and epidemiological information to mlm parameters, and

 <dig>  gens , a software that produces simulated data sets.

using that approach interactions between one genetic and one environmental factor only could be simulated; therefore, it was not possible to account for epistatic g×g. moreover, all simulated loci were considered to be independent and thus it was not possible to account for ld  <cit> .

in the present paper, we describe an extension of the previous model that overcomes such limitations using a new strategy that simulates up to two-genes×one-environment interactions with the possible inclusion of epistasis. importantly, the present algorithm can be easily extended to manage more than two genetic and one environmental factors. however, to simplify the design of biologically meaningful interactions, we limited the number of features . furthermore, the inclusion of two genetic factors  that in turn interact with a continuous environmental factor heavily increased of the complexity of the model. indeed, statistical methods that can deal with even two genetic factors are still far from being functionally useful for real, large data sets  <cit> . to provide a realistic genetic background to the simulated populations, we implemented our extended model as a module which can be integrated with simupop, a forward-time populations simulator that reproduces realistic demographic and evolutionary features  <cit> .

implementation
gens <dig> workflow
generation of the synthetic data set
the generation of the starting sample is carried out by a series of simupop scripts  <cit>  that 

• download phased genomic data from the hapmap public database  <cit> ,

• select a subset of snps or entire genomic regions, and

• let the population evolve until it reaches the desired size and frequencies for some disease predisposing loci .

to obtain a synthetic data set, simupop drives a forward-time simulation to obtain a population that is composed of the desired number of individuals and genotypic frequencies for all the markers. the use of this simulator helps to retain genetic realism in the final population, in particular with respect to the patterns of ld . when the genetic information for each individual has been obtained, gens <dig> assigns environmental exposures following a user defined gaussian distribution for the disease environmental variable, and several other user defined distributions  for a number of other environmental variables not related with the disease .

definition of the penetrance model
the second branch of the simulation procedure  is implemented in the knowledge aided parameterization system  <dig>  subsystem which accepts the input of some standard epidemiological measures for the relevant features listed here: 

• the expected prevalence of the disease in the sample,

• the id in the input data set of one or two dpls,

• the allelic frequencies of dpls ,

• the effect on disease risk of each dpl in terms of the relative risk of the high risk homozygote compared with the other homozygote,

• the dominance relation of each dpl , expressed as a number in the interval , representing the dominance relation , and

• the distribution parameters and the effect of the environmental factor on disease risk, expressed as odds ratio  of the risk related to one-unit increase in the exposure.

kaps <dig> also requires g×e and g×g models when two dpls are provided. in particular: 

i) g×e models are chosen from a set of four predefined models, two models of interaction between dpls and the environment, and two special models in which there is no gene-environment interaction but in which only one genetic or environmental factor contributes to the disease risk .

ii) g×g models  are accepted in the form of percentage variations on the risk associated with a maximum number of three  combined genotypes.

kaps <dig> converts population features and g×e and g×g models into the corresponding parameters of the mlm in two steps. first, starting from the provided epidemiological parameters, kaps <dig> calculates the penetrance of each combined genotype assuming no interaction between the genotypes of each locus. epistasis  is then modeled through a deformation procedure, reflecting g×g variations, of the set of penetrance values that keeps it coherent with user defined epidemiological parameters. in this step, when there is more than one way to change the values of the set , a mathematical optimization system is employed to find the deformation characterized by the smallest variation on the values not constrained by user defined epistatic variations. an example of the results of the epistasis application is presented in figure  <dig>  in particular, the figure shows the disease penetrance for each combined genotype before  and after  the penetrance of one combined genotype ) has increased by 20%. thus, by following the procedure presented above, the variations in the disease penetrance values of other combined genotypes are automatically distributed.

consequently, for each combined genotype, kaps <dig> computes the coefficients of a penetrance function of the environmental exposure that is associated with the combined genotype in the mlm. in this step g×e are also modeled; the additive model  assumes that combined genotypes with higher penetrance have a higher basal disease risk, while the risk associated with the environmental factor is just added. on the other hand, in the modulative model , combined genotypes with higher penetrance have the same basal risk although they are more ’sensitive’ to the effect of the environment .

disease risk of an individual
in the final step the two branches of the procedure  join. once the genetics and the environmental exposure for each individual are given, its disease risk can be obtained by evaluating the penetrance function associated with its combined genotype. the risk is then used to assign a disease status using a random process.

software
to create simulated populations, we employed an existing tool, simupop, and the implementation of the above described algorithm. using simupop it is possible to drive a forward-time simulation that results in a population composed by the desired number of individuals and having specified genotype frequencies for a set of markers. to be usable in gens <dig>  populations should be created in simupop as described previously  <cit> . this procedure generates a data set that contains genotypic data as a set of bi-allelic loci, for each individual in the population.

gens <dig> accepts as input a population produced by simupop and the ids of the dpls chosen from those present in the data set. for each dpl, the penetrance values are provided as relative risk  and dominance model . rr is calculated as the risk ratio of the high over the low risk homozygotes. for each combination of dpl genotypes, the percentage variation of the penetrance value if epistasis occurs can be assigned. gens <dig> assigns environmental factor exposure on the basis of a user-defined gaussian distribution. any remaining non-implicated loci can be considered as background noise. similarly, gens <dig> can produce an arbitrary number of non-associated random environmental exposures, following a gaussian, uniform or binomial distribution, that act as further background noise.

on the basis of the selected type of g×g and g×e, gens <dig> calculates the coefficients of the mlm as described in the method section.

for each individual, gens <dig> assigns the disease status  on the basis of its disease risk by applying the mlm and using a random process.

the main output of the software can be either a single file or several files for a set of subpopulations of a given size produced by means of a subsampling procedure. subsampling allows bootstrapping procedures to be executed on data sets produced with the same features. the output of gens <dig> is in the form of a table in which each row represents an individual and the columns contain, from the left to the right, disease status, gender, environmental exposures and genotypes for each individual.

two possible formats for the genetics output are available: phased haplotypes or genotypes. in both output formats the initial columns are identical to those described above; however, they differ in the way the genetic information for each individual is represented. in the phased haplotype format, there are two columns for each snp that report the allele status  on each chromosome. in the genotype format, each snp is represented by one number , where  <dig> represents the heterozygote and  <dig> represents, for dlps, the high risk homozygote or, for all the other snps, the lower frequency homozygote.

in addition to the main output file, gens <dig> outputs a log file that contains an extensive report of all the intermediate steps in the procedure and the values used to obtain the populations. optionally, a file containing the id and genomic position of the snps in the data set can be returned.

gens <dig> is designed to be used either from the command line as a python script, or through a graphical user interface, similar to a wizard, that prompts the user in the specification of all required parameters .

overall, the computational time complexity of the simulation procedure depends by both simupop and gens <dig>  for gens <dig>  the procedure is dominated by the assignment of the disease status to all individuals in the population. indeed, after the kaps <dig> module has performed the translation of user provided parameters into mlm parameters in bounded constant time, the time complexity becomes linear in the number of individuals and the number of represented variables  for each individual in the simulated population. on the other hand, the amount of time required to perform a simulation with simupop depends on the size of the simulation and scales roughly linearly with the number of markers and individuals that are used  <cit> . gens <dig> is written in python and is completely open-source. the software is freely available from  <cit> .

RESULTS
here we describe a method based on the mlm to simulate two genetic and one environmental factors interacting in the determination of a disease risk. the method is implemented in gens <dig>  a software that is freely available.

to test populations produced by gens <dig>  we performed a set of analyses on some representative populations. the aim was to emulate a case in which gens <dig> was used to assess the performances of a feature selection method. in particular, all the analyses were performed using a logistic regression  with a different model for each test and considering the status as the dependent variable.

the first test was a single-marker analysis on a population of  <dig>  cases and  <dig>  controls with two dpls in two distinct genomic regions, with no epistasis and an additive g×e model. the association of each marker with the status was tested using logistic regression analyses with model: disease risk = genetic factor + environmental factor. as expected, the most significant associations were those of dpls . the result showed that the environmental variable was also associated with the disease . furthermore, non-causative markers in ld with the two dpls also showed a significant association that was roughly proportional to the value of r <dig> with the dpls.

the second test was similar to the first, except that  <dig>  cases and  <dig>  controls and a modulative g×e model for the dpls were used. for this test, the logistic regression was used by considering both an additive model  and a multiplicative model . none of the markers, when tested by additive model, reached a bonferroni corrected significance level . conversely, dpls were found to be significant when the multiplicative model was explicitly considered. non-causative markers in ld with them were also found to be significant. notably, this more complex model required a 10-fold increase in the sample size to achieve the same significance level as the previous test.

finally, we tested an example of two dpls with no marginal risk, an epistatic interaction  combined genotype) and an additive g×e model in a population of  <dig>  cases and  <dig>  controls. because of the higher computational cost of this analysis, we performed the test on only a subset of about  <dig>  markers surrounding the two dpls. the results are displayed in figure  <dig>  the top panel shows the results of a single-marker analysis. as expected, no markers were found to be significantly associated when tested individually. thus, all possible 2-markers interactions  were tested. only the gene-gene interactions of dpls and of markers in strong ld with them were found to be significantly associated with the status after a bonferroni correction .

the model described here can handle, in principle, any number of dpls and environmental variables. however, we chose to limit the implementation to a relatively small number of factors  so that setting up the model does not become too complicated for the user. in this way, we reached a balance between the complexity of the represented phenomena and simplicity in the definition of the model. moreover, the best strategy to identify even simple interactions as single g×g and g×e with binary environmental variables it is still debated . for this reason, we believe that a set of simulated populations in which all features are known provides an important tool for the identification of the best strategy to identify and study g×g and g×e.

several methods simulating genetic data have been proposed, many of them also handle complex ld patterns and polygenic traits  <cit> . for example, hapgen <dig>  <cit>  simulates multiple polymorphic loci that are in ld and in the same chromosomal region. hapgen <dig> can simulate g×g, including epistasis, between two loci; however, the available models are limited to a predefined set. moreover, this program cannot handle g×e and the number of cases and controls that are produced cannot be controlled. another tool, gs <cit> , similarly simulates multiple loci with a realistic pattern of ld; it can modulate a quantitative trait  and can also manage g×g and g×e. in gs the user can define g×g between two loci in two ways: one, by providing a penetrance matrix for combined genotypes or, two, by selecting a penetrance matrix from a predefined set of g×g models. however, both these approaches have some limitations. although the first allows great control over the penetrance of each genotype, it easily leads to a loosening of control on marginal effects, making the replication of real populations difficult. the second approach, on the contrary, is too restrictive and does not allow any possible interaction to be simulated. for simulation of g×g, gs allows the user to input a list of rules regarding specific combinations of genotypes and levels of environmental values, and the corresponding risk levels. again, this approach makes it very difficult to control the overall characteristics of populations in terms of marginal effects of genetic and environmental factors. the approaches described above can simulate complex interactions by loosening control on overall population characteristics or, alternatively, can keep the overall population characteristics under control by limiting the freedom to specify the interactions. another strategy to simulate g×g and g×e is to manually write functions or sets of rules that associate each combination of genes and environmental factors to a risk value. although this strategy provides more freedom, it is very difficult to set up when the control of marginal effects of single factors is desired. we believe that gens <dig> provides a better balance between the freedom to define possible interactions among factors and the control of the overall population characteristics.

the simulated populations produced with gens <dig> can be thought of as a sampling of an ideal infinite population that has the characteristics specified by the user. from this point of view, it is easy to understand that fluctuations of observed values around the expected ones can occur. among the elements that mostly affect these fluctuations, are sample size, allele frequencies, and penetrance values. in particular, small sample sizes increase the effect of sampling error and thus, as expected, these fluctuations tend to vanish as the sample size is increased . this property can be used to test statistical methods because it allows the user to assess how well the methods perform as population and sample features change; conversely, it helps to assess the statistical power of methods in the presence of population features that can only be presumed.

although the gens <dig> part of the simulation process is reasonably fast, the procedure to simulate large populations using simupop takes time to complete. it would be difficult to simulate a large number of samples without a cluster system, unless multiple  samples are drawn from the same large population.

CONCLUSIONS
gens <dig> allows the simulation of gene-gene and gene-environment interactions among two genetic and one environmental factor in relation to the risk to develop a complex disease. it is based on data with a realistic pattern of ld and it has no limitations either on the number of individuals that can be simulated or on the number of genetic and environmental factors within a simulated data set. furthermore, a large amount of effort has been channeled into allowing the input of parameters as standard epidemiological quantities so that the software is immediately usable by the biomedical community.

gens <dig> provides large biologically realistic data sets with known features that can be used to challenge, and eventually improve, the statistical tools that are designed to identify those interactions.

