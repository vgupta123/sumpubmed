BACKGROUND
with the advent of the second generation sequencing technologies  <cit> , more and more sequences are being generated on a daily basis from various organisms in order to analyze genome sequences, whole transcriptomes, molecular evolution, and metagenomes . the availability of genome and/or reference sequence data for a specific organism greatly facilitates the study of dna-protein interactions, epigenetics and single nucleotide polymorphisms . second generation sequencing has thus triggered a revolution in many areas of biology. while there are many non-model organisms whose genomes have not yet been fully sequenced, the decreasing costs of sequencing have prompted qualitative changes in research strategies, including those relating to the development of molecular markers  and diagnostics in the agricultural and medical sciences.

microsatellites, or simple sequence repeats , are tandem repeat sequences with a repeating unit of one to six base pairs that are abundant in most genomes and exhibit high levels of polymorphism. they are therefore useful molecular markers, although the process of developing ssr markers originally involved laborious screening, cloning and sequencing steps  <cit> . together with increases in the throughput of commercial sequencers, the availability of a large body of data demonstrating that ssrs are abundant in expressed sequence tags   <cit> , has made it viable to develop est-ssr markers using traditional sanger sequencing. in recent years, the use of second generation sequencing machines has become increasingly common in est-ssr marker development  <cit> . the longer reads produced by the roche genome sequencer using the pyrosequencing method are preferred for this purpose, especially when working with non-model organisms for which comparatively few genomic resources and reference sequences are available. in such cases, the ability to sequence longer fragments increases the uniqueness of the sequences obtained, reducing the computational challenges associated with their analysis.

there are several automated pipelines for cleaning up and assembling reads, detecting ssrs, and designing primers that target the detected ssrs  <cit> . these pipelines are integrated systems; as such, in the absence of expert knowledge, they are not readily customized to meet any additional needs the user might have. to address this issue and to facilitate the ongoing development of analytical software at a pace that matches the rapid evolution of sequencing systems, it would be beneficial to create modular pipeline systems for the analysis of ssrs in ests and the development of est-ssr markers. such modular systems would be more flexible than current solutions and could be readily upgraded or adjusted in response to new developments in sequencing technology.

in this paper, we explicitly describe a framework for analysing est-ssrs and designing primers to target them using transcriptome shotgun assembly , on the basis of reads collected using the sanger and pyrosequencing methods. the model organism used was sugi , japanese cedar, which is an industrially important coniferous species growing in japan. we have previously collected ests  from several tissue libraries for this species  <cit> , used them to develop cleaved amplified polymorphic sequence   <cit> , ssr  <cit>  and est-ssr  <cit>  markers, and constructed genetic linkage maps  <cit> . the advantage of using c. japonica in genomic studies rather than other conifer species is that the estimated c-value for c. japonica is 11 pg  <cit> , meaning that its genome is approximately half the size of those of pinus or picea <cit> . while cryptomeria is one of the cupressease, pinus and picea belong to the pinaceae. the gap between these two families is the deepest phylogeneitc split in the conifers  <cit> , and may affect genomic composition of both family members. features identified by analyzing est-ssr can be referenced to study phylogenetic relationships among conifers. in the present study, tsa was performed using around 118 k sanger and  <dig>  m pyrosequencing reads, resulting in  <dig>  contigs that served as an important central hub for downstream analysis. the characteristics of the ssrs in the ests were analyzed in terms of frequency, gc percent, location, and gene ontology. we then used gene indices to compare the results obtained for c. japonica to those observed in other plant species. comparative analysis was used to identify the distinguishing features of this species, showing that much less amount of at motif in c. japonica than in two pinaceae species. est-ssr markers were developed using an open pipeline, and factors affecting pcr success and the level of polymorphisms were analyzed using a generalized linear model. this is the first comprehensive analysis of ssr-containing ests and est-ssr markers in c. japonica; the results obtained will be useful in future genomic analyses of conifers and other non-model species.

methods
a web link to programs/resources that were used in the present study is provided in additional file 1: table s <dig> 

cdna sequencing
sanger sequencing was used to collect  <dig>  reads for unigene construction. these reads had been obtained in previous studies . in the course of this work, two new cdna libraries  were sequenced and subjected to assembly. a cdna library for pyrosequencing was constructed from  <dig> seedlings from  <dig> elite c. japonica trees in japan. total rna was extracted from each seedling using a ctab-based method  <cit>  and the extracted rna from each individual was mixed in an equimolar fashion. cdna synthesis was carried out using the smart cdna construction kit  and normalized using a cdna normalization kit  by the dragon genomics centre, takara bio inc. . the library was pyrosequenced using roche  <dig> gs flx titanium reagents in one and a quarter pico-titer plates. the dra  accession number for this project is  and can be accessed at http://trace.ddbj.nig.ac.jp/dra/index_e.shtml. chimeric reads of the 454-reads were pre-filtered by dragon genomics center. to evaluate read quality, the read length with phred quality ≥  <dig> was estimated by measuring the read length after trimming by the qualitytrimmer module of the euler-sr package  <cit> .

n/a: see futamura et al. in preparation for details.

construction of unigene elements
electropherograms were base-called using the phred program  <cit> . all sanger reads  were screened by cross_match  <cit>  for vectors , adaptors  and the genome sequence of escherichia coli . for 454-reads, adaptors were screened and masked with cross_match, using the parameters:-minmatch  <dig> -minscore  <dig>  seqclean  <cit>  was also used to screen all sanger reads for vector, adaptor and e. coli genomic sequences and all 454-reads for adaptors and chloroplast sequences  <cit> ; default parameters were used in this case, and sequences shorter than 100 bp were considered invalid. finally, the longest non-masked region was extracted using an in-house perl script to eliminate potential chimeras. this process yielded  <dig>  sanger reads and  <dig> , <dig> pyrosequence reads. mira   <cit>  was used to directly assemble the sanger and pyrosequence reads, with the standard options  and no supplementary xml files. mira was also used for all assemblies conducted during this study. the gc percentage of the contigs was calculated using an in-house perl script.

mining of microsatellites
the misa  <cit>  software package was used to analyze microsatellite  frequencies. the minimum numbers of repeats for ssr detection were as follows: six for di-ssrs, five for tri-ssrs, four for tetra-ssrs, three for penta-ssrs and three for hexa-ssrs. the maximum length of interruption between two adjacent ssr repeat units was set to zero bp. the same criteria were used for all analyses of ssr frequency. ssr frequencies were analyzed for  <dig>  c. japonica contigs  and seven gene indices  <cit>  in order to compare ssr frequencies between taxa. ssr frequencies were also calculated for each cdna library to identify frequency differences between tissue/stage types and between sequencing directions . reads from each library or sequencing group were assembled using mira  with parameters appropriate for the type of sequencing used . we defined five tissue or stage types according to the origin of the cdna . for bark tissue,  <dig>  ests  <cit>  from the cambium and surrounding tissues  were retrieved from dbest, with  <dig>  and  <dig>  reads being identified as 3′ and 5′ ests, respectively. for ests from other tissues and sequencing directions, the libraries listed in table  <dig> were used .

to compare the frequency of est-ssrs in c. japonica with that in other species, seven gene indices were downloaded and analyzed using misa with the parameters listed above. we used the following tigr gene indices  <cit> : agi , hagi , ntgi , osgi , ogi , sgi  and pgi , which were available from http://compbio.dfci.harvard.edu/tgi/. these gene indices were selected so as to represent specific phylogenetic classes of land plants: gymnosperms , monocots , rosid i , rosid ii , asterid i  and asterid ii . the relationship between genome size and the frequency of est-ssrs was analyzed using data from the plant dna c-values database  <cit> .

the location of ssrs within contigs was estimated using prot4est   <cit> . this program uses hierarchical steps to identify protein coding regions. estscan  <cit>  was used in the second step of the process, with a matrix file constructed from  <dig>  representative peptide sequences that were estimated using framedp  <cit>  with the default parameters and the cjcon1; the tair9_pep sequences  were used as reference material. these representative peptides were generated from  <dig>  full length cdna candidates and were clustered using blastclust, a component of the blast package  <cit> , with the following parameters: -p t -b f -l  <dig>  -s  <dig>  while framedp alone can be used to estimate coding regions, preliminary analysis of the predicted ssr locations  showed that it over-predicted the presence of ssrs in the coding regions of the 5′ utr in popular gene models  <cit> . we therefore chose to rely on hierarchical analyses performed using prot4est for predicting ssr locations. predicted peptide sequences were used to estimate the coordinates of coding regions by alignment against corresponding dna sequences using the fasty <dig> module of the fasta package  <cit> .

functional annotations for ssr-containing contigs were identified on the basis of blast  <cit>  similarity searches against the ncbi nr protein database using an evalue cutoff of 1e- <dig>  the blast results were related to gene ontologies for plants  using blast2go software  <cit> . the enrichment of go terms for contigs with ssrs was tested using fatigo  <cit>  through blast2go.

design and selection of est-ssr primers
sequences for primer design were collected from three sources:  sequences already registered in dbest ;  sequences that had not been used for assembly   and  sequences that had been used for assembly  . when the c. japonica sequences were downloaded from dbest , we found  <dig>  sequences in the database, most of which had been registered by our group.

for groupa, seqclean was used with the default parameters to detect contaminant sequences using the univec database  <cit> , because dbest often contains such contaminants  <cit> . seqclean was also used to exclude chloroplast sequences of c. japonica <cit>  from groupa. for groupb, cross_match was used to mask vector and adaptor sequences, with the parameter set listed above . the genomic sequence of e. coli was also masked using cross_match . in addition, groupb was screened for vector/adapter and chloroplast sequences using seqclean with default parameters. for groupc, low quality regions were removed prior to primer design using the qualitytrimmer program of the euler-sr package  <cit> , which removed  <dig>  mb  of low quality data.

sequences with ssrs were initially extracted from these three source sequences.  <dig>  ssr-containing sequences were identified and passed to downstream processes. two different pipelines for developing est-ssr markers were used. the first involved read2marker scripts  <cit>  that cluster sequences on the basis of their blast similarity; primers were designed using primer <dig>  <cit> , and the designed primers were further checked for possible mis-annealing during pcr by searching for partial sequence identity within the primer pairs and all template sequences . we used the default parameters for all processes except for those involving primer <dig> .

the other pipeline  was newly developed and employs a combination of cd-hit-est, misa, ipcress and blastclust . the initial step involves clustering the ssr-containing sequences using cd-hit-est  <cit>  with the following parameters: -c  <dig>  -n  <dig> -r  <dig> and recovering the longest sequence within each cluster. from the resulting  <dig>  unique sequences, primers were designed using the misa  <cit>  package  with the same ssr detection criteria as outlined previously except that the length of interruption between two adjacent ssr was set at 100 bp. primers were designed using primer <dig>  <cit> , which was called by the p3_in.pl script . the designed primers were then used for in silico pcr experiments using the ipcress command of the exonerate package  <cit>  with the default options. this was applied to the  <dig>  unique sequences to select primer pairs that would produce single products. it was necessary to include this step in order to avoid having ssrs on repetitive domains within a single sequence, which are difficult to exclude using between-sequence comparisons alone. second generation sequencing techniques produce long contigs that necessitate self-sequence comparison. the in silico pcr products were further clustered using blastclust, a part of the blast package  <cit> , with the following parameters:-p f -b f -l  <dig>  -s  <dig>  finally, the primer pairs that generated the shortest in silico product from each cluster were selected. the successful sequences were blasted against est-ssr sequences for which primers had already been designed  <cit> . sequences with hsp  scores above  <dig> were excluded from further analysis.

pcr and statistical analysis of est-ssrs
for primer pairs resulting from the read2marker pipeline,  <dig> of the  <dig> primer pairs were selected in an arbitrary and random fashion. for those resulting from the cmib pipeline,  <dig> of the  <dig>  primer pairs that showed no similarity with previously-reported est-ssr markers  <cit>  were selected at random after the exclusion of primer pairs that had already been selected for the read2marker pipeline. in total,  <dig> primer pairs  were synthesized . pcr was first carried out for two individuals in  <dig> μl reaction mixtures containing ca. 5 ng genomic dna, 1 × pcr buffer, 200 μm of each dntp,  <dig>  mm mgcl <dig>   <dig>  μm of each synthesized primer, and  <dig>  u of taq polymerase , using the following program: 94°c for 5 min, then  <dig> cycles of 94°c for 30 s, 55–62°c for 30 s and 72°c for 30 s, followed by a final extension at 72°c for 5 min. the pcr products were electrophoretically separated on 2% agarose gels and stained with ethidium bromide to check for successful amplification. the utility of est-ssr primers that produced visible bands on the agarose gel was demonstrated by analyzing polymorphisms among  <dig> individuals of c. japonica from various locations across japan . pcr was carried out in  <dig> μl reaction mixtures under the conditions described above using the annealing temperatures listed in additional file 5: table s <dig>  pcr products were labelled with chromatide rhodamine green-5-dutp  according to a method described elsewhere  <cit> , and analyzed using a  <dig> genetic analyzer with genescan software . for each locus, the number of alleles  was counted and the observed  and expected  heterozygosity was calculated. polymorphism information content   <cit>  was calculated using the excel microsatellite toolkit  <cit> . deviation from hardy-weinberg equilibrium was tested using genepopv <dig>  <cit> .

to analyze factors affecting successful pcr amplification, we fitted a generalized linear model with a binomial error distribution, the logit-link function and the pcr amplification as the binary dependent variable . the explanatory variables were  the pipeline used to design the primers ,  estimated primer location ,  the sum of the melting temperatures of the forward and reverse primers and  the expected pcr product length in base pairs. the primer location was estimated in the same way as for ssrs, as described in the “mining of microsatellites” section above. we also analyzed the relationships between the level of polymorphism for each locus and factors that might affect it by fitting a generalized linear model with a poisson error distribution, log-link function and the number of alleles  as the dependent variable. the explanatory variables were  the pipeline used to design the primers ,  estimated ssr location ,  maximum number of ssr repeats within the amplified region, and  the length of the ssr repeat unit  corresponding to the maximum repeat within the expected pcr products. ninety-four loci that were analyzed by capillary electrophoresis were included in this analysis, with na =  <dig> for monomorphic loci.

we used r  <dig> . <dig>   <cit>  to fit the generalized linear models. the significance of each coefficient in the model was tested using wald statistics .

RESULTS
est cleaning and assembly
in total,  <dig>  sanger sequence reads were considered, although no quality data were available for  <dig>  of them; those without quality data were excluded from the assembly. the remaining sequences  were base-called to produce sequence data covering  <dig>  mbp . after cleaning using cross_match  <cit>  and seqclean  <cit>  ,  <dig>  reads  were passed to assembly, with an average read length of  <dig>  bp for bases with a phred qv of  <dig> or above. by using pyrosequencing with roche gs flx titanium reagents, we obtained  <dig> , <dig> reads  after chimera filtering. after cleaning, this number was reduced to  <dig> , <dig> reads  that were passed to assembly, with an average length of  <dig>  bp for bases with qv ≥  <dig>  the length of the sequences masked by cross_match was  <dig>  mbp and  <dig>  mbp for the sanger and pyrosequencing methods, respectively, which corresponded to  <dig> % and  <dig> % of the total sequenced length submitted for assembly. because sanger sequencing involves a cloning step using adaptors/vectors and host organisms, the sequences obtained using this method include a greater quantity of data that is unnecessary for assembly compared to those obtained by pyrosequencing. while adapters were used for pyrosequencing, the level of contamination was low.

 <dig>  sanger and  <dig> , <dig> pyrosequencing reads were assembled using the mira program, which identified  <dig>  contigs and  <dig>  debris reads. these contigs are collectively referred to as cjcon1; in total, they covered  <dig>  mbp. a plot of the length distribution of the reads can be seen in additional file 6: figure s2; the average read lengths of  <dig>  bp and  <dig>  bp obtained by the sanger method and pyrosequencing, respectively, are highlighted . the average length and depth  of cjcon <dig> was  <dig>  bp and  <dig> , respectively . the most common number of ests in a given contig was two;  <dig>   of the  <dig>  contigs were in this category.  <dig>   of the contigs contained fewer than  <dig> ests. the longest contig was  <dig>  bp in length and exhibited sequence homology with peroxidase 12; the deepest contig had  <dig>  reads exhibited homology with unknown proteins from picea species.

assembly within individual libraries and sequencing directions
in order to assess variation, and thus potential bias, in the depth and number of reads across tissues, different est data sets were constructed for bark, bud, leaf and seedlings. for the bark library,  <dig>  sequences were collected from the dbest database; the sources of the other libraries analyzed were as indicated in table  <dig> . assembly using the mira program produced contigs with varying average depths. contigs from the seedling library , which was sequenced by the pyrosequencing method, had the greatest average depth ; contigs from the other libraries, which were sequenced by the sanger method, had average depths ranging from  <dig>  to  <dig>  . in contrast, the average contig length for the sanger libraries  was greater than that for the pyrosequencing library . the sequences in each library were divided into separate groups on the basis of their sequencing direction  where sequencing direction data were available. it was found that the average contig depths for 3′ and 5′ assembly were almost identical , but the average contig length was greater for 5′ assembly . because 3′ ests have a poly-a sequence at their beginning, their sequencing chromatograms are of lower quality than their 5′ counterparts, and 3′ ests are generally shorter than 5′ ests.

frequency of est-ssrs
ssr motifs and the frequency with which they occur differ greatly between taxa  <cit> . we therefore analyzed both of these factors for c. japonica using cjcon <dig>  we also sought to identify differences in ssr frequency that may have arisen from the methods used for library preparation . information of this kind is important when designing efficient strategies for developing ssr markers and selecting target ssr motifs.

we used misa  <cit>  to screen for ssrs within cjcon <dig> and detected  <dig>   <dig> ,  <dig>   <dig> and  <dig>  di-, tri-, tetra-, penta- and hexa-ssrs, respectively, giving a total of  <dig>  pure ssrs. in addition,  <dig> compound ssrs , were found, giving a grand total of  <dig>  ssrs in  <dig>   contigs. most  of these contigs contained only one ssr; the greatest number of ssrs detected in a single contig was seven. the most frequent ssr motifs were at  and aag  . the frequency distributions for each motif and number of repeats are shown in figure 2; it is apparent that the di-ssrs tended to be the longest. the longest number of repeats was observed in ag motif,  <dig>  cjcon <dig> contained a total of  <dig>  mbp, giving an ssr density of  <dig>  ssrs/10 kb.

ssr location was estimated by inferring coding regions using the prot4est pipeline  <cit>  and the fasty <dig> module of the fasta package  <cit> . some of the locations were un-determined because the corresponding ssrs extended over both coding and non-coding regions.

in order to compare the ssr frequency and density of different libraries and sequencing directions, the contigs discussed in the previous section were analysed using misa  <cit> . the frequency and density of ssrs for each library ranged from  <dig> % to  <dig> % and  <dig>  to  <dig> /10kbp, respectively; the bark library contained the greatest number of ssrs . this may be due to the small number of contigs from the bark library that were screened for ssrs. an analysis of ssr frequency/density as a function of sequencing direction indicated that the ssr frequency/density was higher for 5′ est assembly than for 3′ assembly . it may thus be advantageous to sequence from the 5′ direction if there is a need to maximise the number of detected microsatellite sequences when developing microsatellite markers for c. japonica. while it was reported that 3′ ests contained a greater number of ssrs than did those obtained by 5′ sequencing in loblolly pine and spruce  <cit> , the opposite has been observed in arabidopsis thaliana and oryza sativa <cit> .

a comparison of the ssr frequency in cjcon <dig> to that in other plant gene indices  <cit>  using the misa program with a common parameter set revealed that conifer species have relatively low ssr frequencies , spruce  and c. japonica , respectively), whereas ssr frequencies in angiosperms can be as high as  <dig> %, as observed in oryza sativa . the ssr frequencies  were shown to correlate negatively with the logarithm of the genome size  , suggesting that it may be more challenging to develop est-ssr markers for species with larger genomes such as conifers. morgante et al.   <cit>  have previously reported a similar negative correlation between ssr frequency and genome size in plants.

the at motif was the most common di-ssr in c. japonica, accounting for  <dig>  of the  <dig>  pure ssrs. however, it is much more common in two other conifer species, accounting for  <dig> % and  <dig> % of all di-ssrs in pinus  and spruce , respectively . it was also found that penta- and hexa-ssrs are more common in conifers  than in the gene indices of other species . within these three conifer species, the motif frequencies for pgi and sgi were more strongly correlated than those for cjcon <dig> and pgi or for cjcon <dig> and sgi . the relatively early split of the pinaceae  from the cupresseae  probably caused species in the two families to evolve independently  <cit> , which is likely to be reflected in their ssr motif frequencies. however, it should be noted that ssr motif frequencies are not necessarily indicative of phylogenetic relationships  <cit> .

the location of the est-ssrs
estimating the location of microsatellites within genes  is important when using est-ssrs to study microsatellite evolution and in marker development. previous studies have shown that tri-ssrs are preferred in coding regions, because they do not cause frame shift mutations  <cit>  and thus have comparatively few detrimental effects. we sought to determine whether this high frequency of tri-ssrs occurred in cjcon <dig>  and whether the distribution of the ssrs was non-uniform and dependent on their location.

in order to estimate the location of each ssr, the amino acid sequences  of cjcon <dig> were identified using prot4est pipeline  <cit> . the coding sequences were then re-mapped onto the nucleotide sequences to obtain coordinates for the coding regions and estimate the locations of the est-ssrs. the total length of the estimated coding region was  <dig>  mbp, representing  <dig> % of the total sequence length for cjcon <dig>  the average length of the coding region in each contig was  <dig>  amino acids , ranging from  <dig> to  <dig> aa. the analysis of coding regions using prot4est did not guarantee the inclusion of start and/or stop codons , but rough estimated locations  were obtained for  <dig>  of the  <dig>  ssrs; no location could be determined for the remaining  <dig> because they extended over both estimated coding and non-coding regions. less than half of the di-ssrs  were estimated to be coding, but  <dig> % of the tri-ssrs and  <dig> % of the hexa-ssrs were in coding regions . because the addition or deletion of di-ssr repeats located within coding regions can cause frame shifts, selective pressures disfavour the presence of di-ssrs in coding regions  <cit> . we also examined the locations of specific ssr motifs. the most common motifs in the 3′ utr and coding regions were at and ag, respectively, with at motifs accounting for  <dig>  of all di-ssrs within the 3′ utrs and ag motifs representing  <dig>  of all di-ssrs motifs in coding regions. at was also the most common motif in the 5′ utr, accounting for  <dig>  of all di-ssrs in this region, although it was much less common here than in the 3′ utr. the most common tri-ssrs in the coding, 3′ utr, and 5′ utr regions were aag, aat and agg, respectively.

gc percentage
because the genomic gc percentage may affect microsatellite evolution  <cit> , we analyzed the gc content of the contigs, contigs with ssrs, and ssr motifs of cjcon <dig>  the average gc percentage for cjcon <dig> was  <dig> %, with maximum and minimum values of  <dig> % and  <dig> %, respectively. no homologues of sequences with such extreme gc percentages could be identified using blast searches against the ncbi nr database; it is not known whether these sequences are artefacts or represent real transcripts with as-yet unidentified functions. the average gc percentage for the  <dig>  ssr-containing contigs was  <dig> %, which is greater than that for the entire body of contigs . by comparing the gc percentage in cjcon <dig> to that in other species’ gene indices, it was found that c. japonica had the lowest gc percentage of all species examined . this may be simply because cjcon <dig> was assembled from both sanger and pyrosequencing reads, whereas the gene indices were assembled from sanger reads alone. when assembly was performed using sanger reads only, the average gc percent of the resulting contigs was  <dig> % for c. japonica. because the libraries sequenced by sanger method were not normalized and the amount of reads was small compared that obtained by pyrosequencing, the resulting transcriptomes were likely to miss genes with low expression, which may have lower gc levels than other genes. we observed a positive relationship between the gc content and the number of reads in contigs , which may indicate that highly expressed genes tend to have higher gc contents  <cit> . when the gc content of contigs containing di- or tri-ssrs was analyzed  and related to the gc content of the ssr motifs, a significant positive correlation was observed . similarly significant correlations were also found for other plant species, with the exception of agi . the lowest and the highest correlations were found for pgi   and ntgi  , respectively.

gene ontology
genic microsatellites have been reported to have functional roles  <cit> , some of which are related to regulatory functions. tri-ssrs in coding regions generate amino acid repeats whose expansion may cause diseases. we investigated the potential functions of the cjcon <dig> est-ssrs by relating them to gene ontology  annotations. the blast2go  <cit>  software package was used to assign  <dig> go slim terms to  <dig>   of the contigs of cjcon <dig> on the basis of blastx  <cit>  homology searches against the ncbi nr database. the most frequent go terms in the biological process, cellular component and molecular function categories were cellular process, intracellular, and binding, respectively . by focusing on contigs with ssrs  and comparing the frequency with which specific go terms occurred in ssr-containing contigs to the frequency of the same terms in all the contigs of cjcon <dig>  six go terms were found to be significantly overrepresented in the ssr-containing contigs, with a false discovery rate  of less than  <dig>  . these go terms included go: <dig> , go: <dig> , go: <dig> , go: <dig> , go: <dig> , go: <dig> , go: <dig> , in ascending order of fdr. in our previous studies on go term frequency in est-ssrs from quercus mongolica <cit>  and castanopsis sieboldii <cit> , go: <dig>  was found to be overrepresented in est-ssrs. while go: <dig> was not found to be significant in this work, go: <dig> which is located in the lower levels of the go hierarchy was significantly overrepresented. for eucalyptus est-ssrs  <cit> , nucleic acid binding was found to be the most common go term in the molecular function category. nucleic acid binding activity is likely to be associated with transcription processes, which were found to be overrepresented in this work. single amino acid repeats were found to be overrepresented in transcription factors for arabidopsis thaliana and oryza sativa proteins  <cit> .

the development of est-ssr markers
we used two pipelines to develop est-ssr markers, namely read2marker  <cit>  and cmib, which combines several freely available tools for clustering and microsatellite detection . we used read2marker scripts to develop est-ssr markers for several species  <cit> , because of its automated data flow from chromatograms to primer design. unfortunately, the process used in read2marker seems to be too inefficient for the huge data sets that are commonly generated using second generation sequencing machines and will become increasingly common in the future. we therefore sought to develop a pipeline that is flexible and capable of efficiently handling the volume of data generated by the second generation sequencers. in order to reduce computational load, we first identified sequences with ssrs. a total of  <dig>  ssr-containing sequences were identified, with  <dig>  belonging to groupa,  <dig> to groupb, and  <dig>  to groupc, respectively . these ssr-containing sequences were then used for both pipelines.

the first pipeline, read2marker, was used to design  <dig> primer pairs, of which  <dig> were selected to verify the presence of polymorphism. successful pcr amplification was achieved using  <dig>  of the  <dig> primer pairs, one of which produced a pcr fragment that was too large  to be analyzed by a sequencer and was therefore not investigated further. after capillary electrophoresis using a  <dig> genetic analyzer ,  <dig> primer pairs that produced stable peaks suitable for genotyping were identified; analysis of their products revealed  <dig> polymorphic loci . for  <dig> of these, annotation by similarity was possible by comparison with the ncbi nr database . nineteen of the markers were located within coding regions. the average expected pcr product size for these  <dig> loci was 240 bp. the number of alleles per locus , observed heterozygosity , expected heterozygosity  and pic values were 2– <dig>   <dig> – <dig> ,  <dig> – <dig>  and  <dig> – <dig> , respectively . there was no way to exclude loci corresponding to previously-reported primers  <cit>  from the output of read2marker; as it happened, one of the loci identified  had been discussed in a previous study  <cit> .

for the second pipeline, cmib, we devised a new methodology that emphasises the identification of unique primer pairs that target specific genes and relies on a combination of widely-used programs. this pipeline identified  <dig>  primer pairs that were expected to amplify a unique target. this number is substantially greater than that produced by the read2marker pipeline. read2marker uses strict criteria to select specific primers and discards all primer pairs that do not satisfy all criteria, greatly reducing the number of pairs that are ultimately obtained . in the cmib pipeline, mis-annealing between and within sequences was tested for by means of in silico pcr experiments using ipcress  <cit> , after which the resulting  <dig>  unique pcr products were clustered using blastclust  <cit>  and the primer pairs that produced the shortest products were retained. because the efficiency of pcr is generally greatest for shorter targets, this approach is likely to yield the greatest possible number of useful candidate primer pairs. after identifying and excluding previously-reported primers  <cit> ,  <dig> primer pairs were selected and tested for polymorphism. fifty-eight  of the primer pairs produced pcr products, of which six generated products that were too large  to be analyzed by capillary electrophoresis and were therefore discarded. when the pcr products were analyzed by capillary electrophoresis,  <dig> primer pairs showed clear peak patterns suitable for genotyping. polymorphisms were detected for  <dig> loci ,  <dig> of which could be annotated by similarity with proteins in the ncbi nr database . fifteen markers targeted coding ssrs. the average expected pcr product size for these  <dig> loci was 277 bp. the number of alleles per locus , observed heterozygosity , expected heterozygosity  and pic values were 2– <dig>   <dig> – <dig> ,  <dig> – <dig>  and  <dig> – <dig> , respectively .

factors affecting the pcr success rate and level of polymorphism for est-ssrs
we used a generalized linear model  to fit a dependent variable, pcr success/failure , with four independent variables. only one of these, the expected pcr product size, was found to have a negative effect on the likelihood of pcr success . the other variables, namely the identity of the pipeline used  in designing the primers, the location of the primers , and the sum of the melting temperatures for the primer pair, had no significant effect on pcr success.

pcr success was coded using a variable that took a value of  <dig> for success and  <dig> for failure. the primer melting temperature  was summed for both primers in a pair. the r functions called when estimating pcr success were: glm. the level of polymorphism was expressed in terms of number of alleles per locus  and was analyzed using the following function calls in r: glm. ssr motif corresponded to the number of bases in the ssr repeat unit; di-, tri-, tetra-, hexa-, and penta-ssrs were coded as  <dig>   <dig>   <dig>   <dig> and  <dig>  respectively.

we also constructed a glm fitted with four independent variables to analyze the level of polymorphisms for each primer pair, measured in terms of the number of alleles per locus . only one variable, the maximum number of ssr repeats, had a significant positive effect on na . the other three factors considered were the identity of the pipeline used to design the primers, the estimated location of the ssr , and the nature of the ssr’s repeat unit; none significantly affected the level of polymorphism at the locus. a more detailed examination of the relationship between na and the number of ssr repeats made it possible to identify threshold values for polymorphic est-ssrs. di-ssrs with  ≥  <dig> repeat units and tri-ssrs with ≥  <dig> repeat units all showed polymorphism, while those ≥  <dig> and ≥  <dig> repeat units, respectively, were polymorphic in some cases. in other words, if seeking to avoid monomorphic markers when designing primers for c. japonica, one should target di-ssrs with ≥  <dig> repeat units and tri-ssrs with ≥  <dig> repeat units. these criteria yielded promising primer pairs for  <dig> ssrs  using cmib. if the aim is to capture all polymorphic markers, primers should be designed for di-ssrs with ≥  <dig> repeat units and tri-ssrs with ≥  <dig>  these criteria yielded primer pairs for  <dig> ssrs  using cmib. human di-ssr markers exhibit increasing levels of polymorphism as the number of repeat units rises; di-ssrs with more than  <dig> repeat units were found to be highly informative in a study that examined over  <dig> markers  <cit> . it should be noted that the level of polymorphism at a given locus is affected by mutation rates, the characteristics of the species in question  and the number of samples genotyped. the minimum threshold nucleotide length of polymorphic ssrs has been reported to be 10 bp in humans  <cit>  and  <dig> in yeasts  <cit> ; these values would correspond to five and four repeat units in di-ssrs, respectively. the identification of threshold lengths for polymorphic ssrs in c. japonica will, in conjunction with similar values for other model organisms, facilitate the establishment of criteria for marker development and of critical parameters for the evolutionary analysis of ssrs.

the genetic diversity of est-ssr and genomic ssr markers
forty-two genomic microsatellite markers for c. japonica have previously been reported  <cit> . their levels of polymorphism  were compared to those for the  <dig> est-ssr markers identified in the work reported herein. the average values of na and pic were  <dig>  and  <dig> , respectively, for genomic ssrs; the corresponding values for est-ssr markers were  <dig>  and  <dig> . the levels of polymorphism in the genomic ssrs were significantly greater than those for the est-ssrs , probably due to the greater average number of repeats in the genomic ssrs. on average, the maximum number of repeats for all ssr regions was  <dig>  for genomic ssrs and  <dig>  for est-ssrs. genomic ssrs thus had significantly more repeats than est-ssrs . the relatively low number of repeats in est-ssrs could reflect selection against ssr expansion, which generates amino acid repeats in coding regions and affects transcription efficiency in utrs  <cit> ; both of these effects can cause disease.

CONCLUSIONS
we have developed an open scheme for analysing est-ssrs and developing est-ssr markers. all the tools and data used in this scheme are freely available. we collected around  <dig> k ests by sanger sequencing and  <dig>  m ests by pyrosequencing from c. japonica, an important forestry species in japan whose genome is significantly smaller than those of other conifers. assembly using the mira program produced  <dig>  contigs;  <dig>   of these were found to contain ssrs, and  <dig>  ssrs were identified in total. the frequency of ssrs was lower than that in seven other species with gene indices. the most common ssrs identified were tri-ssrs; the most common motifs observed were at and aag for di- and tri-ssrs, respectively. tri-ssrs were preferred in coding regions, while di-ssrs were more common in non-coding regions. more ssrs were found in 5′ ests than 3′ ests. seven gene ontology terms were found to be overrepresented in the data set. it is expected that further analysis of these characteristic features of est-ssrs in c. japonica will provide useful evolutionary insights.

we developed  <dig> est-ssr markers from  <dig> randomly-selected primer pairs designed using two pipelines, read2marker  <cit>  and cmib; the latter of these combines several freely-available tools. markers resulting from the two pipelines exhibited similar pcr success rates and levels of polymorphism, confirming the utility of the cmib pipeline.

the analytical scheme and results presented here provide an important foundation for further studies on the genomic and evolutionary analysis of conifers and other non-model species in the age of second generation sequencing.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
su conceived this study, analyzed the data and wrote the manuscript. ym prepared dna samples for est-ssr analysis and performed genotyping. ku, tui and nf constructed cdna libraries. nf and ts constructed full length cdna libraries and collected est data. ks and yt coordinated the project. all the authors read and approved the final manuscript.

supplementary material
additional file 1
table s <dig>  web links to programs/resources that were used in the present study. web links were accessed on 19th november  <dig>  

click here for file

 additional file 2
table s <dig>  parameters used in primer <dig> program for  read2marker and  cmib pipeline. 

click here for file

 additional file 3
cmib. an example shell script for the cmib pipeline. 

click here for file

 additional file 4
figure s <dig>  location of c. japonica samples used to screen polymorphisms. 

click here for file

 additional file 5
table s <dig>  est-ssr markers for c. japonica. primer sequences are first grouped by pipelines used . forward and reverse primer sequences are listed in upper and lower part of a cell, respectively. primer sequences include additional bases in 5′ end for fluorescent labelling. ta: annealing temperature. 

click here for file

 additional file 6
figure s <dig>  length distribution of reads obtained by  sanger and  pyrosequencing method. 

click here for file

 additional file 7
figure s <dig>   length and  depth distribution of contigs . 

click here for file

 additional file 8
table s <dig>  assembly statistics from  each library,  3′ ests and  5′ ests. 

click here for file

 additional file 9
figure s <dig>  ssr frequency and density for assemblies in different sequencing direction  for each library. 

click here for file

 additional file 10
figure s <dig>  motif frequency of est-ssrs in cjcon <dig> and est contigs for seven species in gene index. the gene indices are assigned as the following abbreviations: agi; arabidopsis thaliana, hagi; helianthus annuus, ntgi; nicotiana tabacum, ogi; oak, osgi; oryza sativa, pgi; pinus and sgi; picea. 

click here for file

 additional file 11
figure s <dig>  gc percent for cjcon <dig> and other seven gene indices. the gene indices abbreviations are as follows: agi; arabidopsis thaliana, hagi; helianthus annuus, ntgi; nicotiana tabacum, ogi; oak, osgi; oryza sativa, pgi; pinus and sgi; picea.

click here for file

 additional file 12
table s <dig>  summary of gene ontology annotations for cjcon <dig>  percentage for each go was based on the total number of sequences with go annotation. for cjcon <dig>   <dig>  contigs had go annotation, while for contigs with ssrs,  <dig>  had go annotation. cells in yellow indicate gos that are over-represented in ssr-containing ests. 

click here for file

 additional file 13
table s <dig>  annotation of est-ssr markers. #n/a indicates no blast hits. 

click here for file

 additional file 14
table s <dig>  levels of polymorphisms for est-ssr markers in c. japonica. twenty-four markers from the top are from read2marker pipeline, while the rest of the markers are from cmib pipeline. n: number of individuals genotyped; na: number of alleles per locus; ho: observed heterozygosity; he: expected heterozygosity; fis: fixation index; p value: levels of significance for deviation from hardy-weinberg equilibrium; pic: polymorphism information content. 

click here for file

 acknowledgements
authors would like to thank y. komatsu for his help with the laboratory experiments. this work was partly supported by a grant-in-aid  from the forest agency of japan and the program for promotion of basic and applied researches for innovations in bio-oriented industry. it was also supported by the research grant # <dig> from forestry and forest products research institute. authors would like to express sincere thanks to anonymous reviewers, which greatly improved the earlier version of this paper.
