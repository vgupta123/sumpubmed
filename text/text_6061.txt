BACKGROUND
since the publication of draft sequences for the human  <cit>  and mouse  <cit>  genomes, several groups have run large-scale comparisons of the sequences to detect regions of conserved sequence. an initial survey of these was published along with the draft mouse genome  <cit> , with additional comparisons appearing since then  <cit> . briefly, protein coding genes are – as we might expect – among the most strongly conserved regions, but homologous sequences can be found throughout the genome. in total, it is possible to align up to 40% of the mouse genome to human sequence  <cit> , but it seems likely that at least some of this is just random "comparative noise" – regions of sequence which serve no particular purpose but which, purely by chance, have not yet accumulated enough mutations to make their evolutionary relationship unrecognisable. however, it is widely accepted that some of the noncoding-but-similar regions, especially those with the highest levels of sequence identity between the two species, are preferentially conserved because they perform some important function. it has been estimated that around 5% of the genome is under purifying selection  <cit> , indicating that mutations in these regions have deleterious effects: a strong suggestion of some important function.

here, we apply the eponine windowed sequence  sequence analysis method method which uses a relevance vector machine   <cit>  to extract a minimal set of short motifs which are able to discriminate between two sets of sequences: in this case, a positive set of conserved non-coding sequences and a negative set of randomly picked non-coding sequences. the ews model is an adaption of the eponine anchored sequence  model, first applied for transcription start site prediction in  <cit>  and subsequently used to predict a range of additional biological features including translation start sites and transcription termination sites  while eas is designed to classify individual points in a sequence – a feature which allows the model to predict precise locations for features such as transcription start sites – ews classifies complete blocks  of sequence. the basis functions  of the rvm are sums of position-weight matrix scores  <cit>  across the whole window.

RESULTS
we considered a set of alignments made by the blastz program  <cit>  between release ncbi <dig> of the human genome and release ncbim <dig> of the mouse genome. since unprocessed blastz aligns around 40% of human sequence to the mouse genome, we chose to focus on the 'tight' alignments. these are a subset of alignments which are rescored and thresholded using a set of parameters given in  <cit> , and cover only around  <dig> % of the human genome – a proportion much closer to the fraction of bases thought to be under purifying selection  <cit> .

in total, the tight blastz set contained  <dig> blocks of sequence with high-scoring alignments between the two genomes. we considered only those blocks assigned to human chromosome  <dig>  a  <dig> mb chromosome which has recently undergone manual annotation of gene structures and other features  <cit> . this chromosome included  <dig>  of the total alignments. these varied in length from  <dig> to  <dig> bases, with a length distribution skewed towards relatively short alignments, as shown in figure  <dig> 

since we were interested in non-coding features of the genome, we ignored all regions where an alignment overlaps an annotated gene structure. this removed  <dig> % of aligned bases. it is possible that some genes, and especially pseudogenes, have been missed by the annotation process, so we also removed portions covered by ab initio gene predictions from the genscan program  <cit> . this eliminated an additional  <dig> % of aligned bases. finally, repetitive sequence elements annotated by the programs repeatmasker  <cit>  and trf  <cit>   were removed from the working set. the remainder of the aligned regions were split into non-overlapping  <dig> base windows, ignoring any portions less than  <dig> bases. this gave a set of  <dig> sequences which are well-conserved between human and mouse – and therefore likely to be functional – but which are very unlikely to be part of the protein-coding repertoire. these formed the positive training set for our machine learning strategy.

a negative training set of equal size was prepared by picking 200-base windows at random from the non-coding, non-repetitive portions of chromosome  <dig>  using the same criteria to define repeats and coding sequence. while it is probable that this set also included some functional sequences, we would expect them to be represented at a substantially lower level than in the conserved set.

these two sets of sequence were presented to the eponine windowed sequence machine learning system, as described in the methods section. randomly chosen 5-base words were used as seed motifs, and three independent training runs were performed, each for  <dig> cycles. the set of motifs used in model  <dig> is shown in table  <dig> 

while the exact set of motifs used in the model varied somewhat from run to run, testing pairs of models on non-overlapping windows from a  <dig> mb region of human chromosome  <dig> and plotting the scores showed that the model outputs were highly correlated . we calculated the pearson correlation coefficient for all pairs, and in all cases this was greater than  <dig> . from this strong correlation, we concluded that any variations in the model were simply the result of the trainer picking one representative from a group of motifs which provide similar information.

we scanned genomic sequences using these models at a range of thresholds, and examined the results on the ensembl genome browser  <cit>  using a distributed annotation system  <cit>  server. visual inspection showed that many of the highest-scoring regions were localised near the start of genes. this prompted us to look at the distribution of high-scoring sequences with respect to the starts of a set of well-annotated genes. we considered the gd_mrna genes from version  <dig>  of the human chromosome  <dig> annotation. these are confidently annotated genes with experimental evidence as described in  <cit> , which confirms at least the approximate location of the ends of the transcripts, and are independent from the chromosome  <dig> training data. figure  <dig> shows the density of predictions with ews scores ≥  <dig>  relative to the annotated 5' ends of these genes. this shows a strong peak of predictions close to the annotated starts, demonstrating that the model is predicting some sequences commonly located around the transcription start site of genes. combining this observation with the fact that the model was trained from conserved  sequences, we believe that it is detecting signals found in the promoter regions of genes.

evaluation of promoter-prediction methods on a large scale is a difficult exercise, since there are no large pieces of genomic sequence for which we can be certain we know the complete set of transcribed regions, and even in the case of well-known genes we often do not know the precise location at which transcription begins. in  <cit> , we developed a pseudochromosome, derived from release  <dig>  of the chromosome  <dig> annotation. as described above, this includes a subset of  <dig> experimentally verified gene structures. the pseudochromosome was constructed to include these genes while omitting all other annotated genes . we considered predictions  to be correct if they lie withing  <dig> kb of an annotated gene start, and false otherwise. plotting accuracy  against coverage  gives a receiver operating characteristic  curve. using this criterion, a totally random set of predictions would be given an accuracy of around  <dig> . roc curves are plotted for the three independently trained models in figure  <dig>  firstly, this shows that predictive performance for all three models is rather similar. it also shows that they can function as accurate promoter predictors, with accuracy rising to a plateau of around  <dig> , much higher than expected for random predictions.

we picked model  <dig> for further study. using a score threshold of  <dig> , this gives an accuracy of  <dig>  and a coverage of  <dig> . we compared the set of genes correctly detected by this model to two other methods: firstly, the eponinetss predictor described in  <cit> , and secondly, the published results from the promoterinspector program  <cit> . promoterinspector results were mapped to pseudochromosome coordinates using the procedure described in  <cit> . figure  <dig> shows how the set of promoters detected by these three distinct methods overlaps. there are clearly strong correlations between all three methods. in particular, at this threshold the ews homology model detects  <dig> promoters which were found by at least one of the other methods, but only  <dig> novel promoters.

we investigated the robustness of the signal learned by this process by retraining models with a variety of seed word sizes, from  <dig> to  <dig> bases. during training, motifs can be trimmed to lengths shorter than that of the seed words  but can never grow longer than the seed word size. when evaluated on the pseudochromosome, the resulting models always showed a preference for regions around gene starts, regardless of word length, as shown in figure  <dig>  however, the accuracy was reduced when using short seed words – particularly words of length of  <dig>  the best accuracy was seen for a seed word length of  <dig>  and decreased somewhat for words of length  <dig> 

this suggests that a large fraction  of the information learned by these models can be encoded in dinucleotide frequencies. it is well known that many transcription start sites are close to regions of relatively high cpg dinucleotide composition   <cit> . to investigate the contribution that cpg dinucleotides make to our models, we deleted all cpg dinucleotides from the training data, then re-evaluated the resulting models on the pseudochromsome , as shown in figure  <dig>  perhaps not surprisingly, dinucleotide models now show very little tendency to detect gene starts. however, as the word size increases, the preference for gene starts gradually increases, until a seed size of  <dig> gives an accuracy comparable to that see when cpg dinucleotides are included, although the maximum coverage before accuracy begins to drop rapidly is somewhat lower. broadly similar results are seen if cpg dinucleotides are randomly replaced with other dinucleotides.

CONCLUSIONS
we have shown here that, when presented with a set of non-coding sequences which are strongly conserved between human and mouse, a simple motif-oriented machine learning system consistently builds models which are able to detect a substantial fraction of human promoter regions with good accuracy. this strongly suggests that this promoter signal represents the most widely used motif-based signal in functional non-coding sequence. while the model learned here can clearly be applied for the purpose of genome-wide promoter annotation, in practise existing methods offer better coverage and  predictions for the precise location of the transcription start site.

it is interesting that the promoter model learned by this technique detected substantially the same set of promoters as found by the eponinetss and promoterinspector methods. it has previously been remarked that these two methods detect similar sets  <cit> , but this could perhaps be explained by the fact that both methods were initially derived from similar sets of known promoter sequences  model is designed by analogy to the eponine anchored sequence model first described in  <cit> , but rather than targeting individual points in the sequence, it is designed to classify small regions or windows of a sequence, based purely on their own sequence content.

the ews model uses the relevance vector machine  <cit>  algorithm to drive the training process. relevance vector machines solve classification and regression problems by building generalised linear models  as weighted sums of a "working set" of basis functions. during the training process, those basis functions which are not informative are given weights close to zero and eventually discarded from the working set. to explore very large sets of possible basis functions, it is possible to add extra basis functions during the course of the training process  <cit> .

the "sensors" of the ews model are dna position-weight matrices  <cit> , which make convenient models of short sequence motifs. when using weight matrices to analyse sequence windows, we sum the weight matrix probability scores for all possible positions within the sequence. normalising for the length of the sequence being inspected and the size of the pwm, the basis functions of the model take the form:



where w is the probability that sequence s was emitted by weight matrix w, |s| is the sequence length, |w| is the weight matrix length, and  denotes a subsequence from i to j.

an initial set of basis functions is proposed by taking all possible dna motifs of a specified length  and generating weight matrices which preferentially recognise these motifs. as the relevance vector machine trainer removes non-informative basis functions from the working set, they are replaced by applying one of the following sampling strategies to a basis function picked randomly from the working set:

• generate a new weight matrix in which each column is a sample from a dirichlet distribution with its mode equal to the weights in the corresponding column of the parent weight matrix.

• generate a new weight matrix one column shorter than the parent by removing either the first of the last column.

by using these sampling rules, the trainer is able to explore motif space. the process of generating candidate motifs using these rules then selecting the most informative using the rvm can be seen as a form of genetic algorithm.

authors' contributions
td and th conceived and designed this study, and analysed results. td implemented the eponine machine learning system and drafted the manuscript. all authors read and approved the final manuscript.

