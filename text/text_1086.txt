BACKGROUND
site-directed mutagenesis is a tool used in rational protein design strategies to modify the structure or function of a protein to adapt it to particular performance requirements. moreover, mutagenesis is a fundamental tool to study the relationship between protein structure and function, making possible the substitution of one amino acid by another, thus isolating the contribution of the original amino acid or the newly introduced amino acid to the structure and function of the protein as a whole  <cit> .

however, site-directed mutagenesis-based rational protein design strategies present a widely recognized drawback. in order to introduce changes that could confer a desired function or characteristic to a protein, it is necessary to know, or at least to assume, something about the protein structure-function relationship. in other words, it is necessary to know, for each amino acid of the protein or at least for a select group of them, what is their particular contribution to the structure and function of the protein as a whole.

even for a small protein, and assuming that only a subset of amino acids contribute to features really determinant for its relevant function, the number of amino acids to be considered is very large. for a medium-sized protein and with no additional information regarding the possible structure-function relationship, an exhaustive search is practically impossible  <cit> .

it is commonly known that there are certain amino acids in a protein that are necessary and fundamental for its activity, function or structure, and there are other amino acids that are readily replaceable by amino acids sharing a common characteristic, without affecting the main features of the protein. therefore, certain amino acidic positions must conserve some unique properties, which are communicated to the entire molecule, for a given protein or protein family. when analyzing a protein family, many functionally important residues of proteins can be identified because they have been conserved during evolution. however, residues that vary can also be critically important if their variation is responsible for diversity of protein function and improved phenotypes. this adds an entirely new complexity level to the analysis  <cit> .

the same type of functional variation can be observed in nature, represented by single nucleotide polymorphisms  in the coding region of a given gene. snps can be synonymous, often called silent mutations, or can substitute a particular amino acid for another in a protein primary sequence, which is referred as to a non-synonymous snp . prediction of the occurrence of nssnps in a gene could be easily done by comparing nucleotide sequences and detecting or predicting nucleotide changes that occur with low-probability incidence. however, predicting which of these mutations will have an observable effect on protein function is a much more difficult task. this is complicated by the fact that there is often no structure-function knowledge available about the protein. this variation in protein function can be subtle or lead to major phenotypic changes in living organisms. for instance, variations in the dna sequences of genes can affect how humans develop diseases and respond to pathogens, chemicals, drugs, vaccines, and other agents.

when no structure-function information is available, it is relevant to determine these features only from the protein's amino acid sequence  <cit> . a number of bioinformatic algorithms have been devised previously to extract this type of information from the primary sequence of a protein  <cit> . some of these methods have been successfully used for the prediction of altered protein phenotypes caused by nssnps in protein genes  <cit> . other methods have been described to derive this information from 3d structural data or molecular dynamics results  <cit> . a different approach that incorporates machine-learning techniques has been used to study the results of directed evolution experiments in order to explore proteins and to derive hidden structural rules  <cit> .

for this large-scale analysis, we propose an alternative, taking into account the contribution of each amino acid to the general structure of the protein through their characteristic physicochemical properties, such as hydrophobicity, side-chain volume and charge. each amino acid contributes with its own physicochemical characteristics to the entire protein, which adds to the characteristics of the other amino acids, thus determining the relevant features of the protein, both global and site-specific  <cit> .

in this study, we have developed a general algorithm, named mutagenesis objective search and selection tool , which analyzes the target protein as part of a multiple alignment to determine which are the positions that could be mutated with or without altering the common characteristics of the protein family, and gives mutagenesis estimations related to the possibility of whether a given amino acid change would have deleterious effects on the protein. a variant of the same method can be used to detect phenotypically relevant nssnps in a gene family and separate them from amino acid substitutions that do not have functional implications.

RESULTS
algorithm
as a summary of this work, the general algorithmic procedure is presented in figure  <dig>  the left end set of the global algorithm corresponds to the information delivered to select and design site-directed mutagenesis strategies, while the right end set represents the key information used to identify functionally significant nssnps using the tools and statistical procedures proposed in this paper. both analytic procedures share the same initial steps, but have subtle differences that are exploited to get the most appropriate results for each application.

background of the algorithm
a general consensus in protein science states that some amino acid physicochemical properties are conserved at particular positions in a given protein family and some others are not. this explains the possible variation that can be found in any protein family to achieve the same function and it also shows that, despite the possibility of variation, there are particular characteristics that must be retained in order for the protein to conserve its own distinctive features.

each macroscopic property of a protein is controlled by different amino acids in its sequence with a higher or lower degree of influence. hence, both within the framework of site-directed mutagenesis experiments and in the detection and prediction of phenotypic effects of nssnps, it is interesting to identify amino acid residues that are relevant for a protein's function, specificity, stability or binding interactions.

the proposed algorithm has been designed to analyze the general conservation of each relevant physicochemical characteristic at each amino acid position in a protein family . in this context, a protein family is predefined by selecting relevant proteins according to arbitrary criteria . a protein family can also be subdivided into subfamilies, in order to study the contribution of particular amino acids to differences between subfamilies.

preprocessing of the target sequence
to compare the proteins belonging to a family, a multiple alignment of the amino acid sequences is carried out. the most used algorithm for these multiple alignments is clustalw, developed by thompson et al.  <cit>  in a multiple alignment, the algorithm tends to retain and conserve the amino acids in each position, using a weight matrix . an optimal alignment is obtained using these general matrices, which guarantee that the properties as a whole are maximally conserved at each amino acid position of the alignment.

the preprocessing of the target protein sequence is represented by steps  <dig> and  <dig> in figure  <dig>  the mosst algorithm subsequently analyzes this multiple alignment to determine and quantify the statistical significance of the conservation of different physicochemical properties in particular positions of the protein family alignment. to perform this analysis, the conservation of each property is independently studied and patterns are identified by comparing the conservation of different properties at each amino acid position. typical conservation cases are defined based on these conservation patterns, which are then used to statistically classify the amino acids as relevant or irrelevant with respect to the conservation of any physicochemical property in the protein and the predicted amino acid mutability in the protein family. then the statistical parameters  determined for the conservation of each amino acid position are used as predictors to classify possible mutations in the protein family as functionally impairing or functionally silent. hence, these results can then be interpreted and sorted to design mutagenesis strategies or to identify nssnps.

control of the quality of the multiple alignment
the proposed method allows identification of functionally relevant positions in a particular protein when the protein is placed within a comparative reference group in a multiple alignment. the classification procedure gives unique results for each particular alignment, but the statistical result for each position will strongly depend on the quality of the alignment and nothing prevents a priori this significance level varying between one alignment and another.

this variation must be controlled so that the comparison gives coherent and reproducible results when confronted to minor changes in the comparison alignment. the proposed control of this variation, represented by step  <dig> in figure  <dig>  is done in two ways:

alignment quality control
the quality of a multiple alignment specifically depends on the substitution matrices used and the negative weight contributions of gap creation and extension. in the test performed to check the proposed algorithm, the alignments obtained using default clustalw parameters gave satisfactory results.

control of the representativity and the redundancy of the alignment
in the proposed analysis algorithm, the group of proteins in the alignment is supposed to be representative of a wider protein group. if the protein group does not include representatives of some subgroup that has some special feature, then such feature evidently cannot be included in the analysis. this sub-representation is impossible to detect by purely mathematical methods, but can be solved by judiciously choosing the proteins to be represented and analyzed, which is a task that has to be done by a suitable expert. on the other hand, if a subgroup of proteins is over-represented in the analyzed group, then the protein sample will be biased towards the characteristics of the most represented subgroup, ignoring the characteristics of the other subgroups. the over-representation of a subgroup in the sample is readily detectable, as it is possible to assess the percentage of similarity between all the proteins in a group. if a particular group shows a high similarity degree, i.e. high redundancy, then it is over-represented in the sample, and the number of proteins in that group could be reduced by eliminating the most similar proteins.

once a representative and non-redundant group of proteins is found, mosst can be used to detect functionally relevant positions.

statistical quantification of the conservation of properties
amino acids have physical and chemical properties that can be directly or indirectly measured, e.g. hydrophobicity, polarity, charge, molecular shape, conformational propensity and others. a numerical value is typically assigned for the measured property to each amino acid, whether free or associated to others in a polypeptide chain. as side chains are different for each of the  <dig> naturally occurring amino acids, these numerical values are different for each amino acid and provide a quantitative ordering between them with respect to the measured property. hence, these property values form a scale that represents a numerical scoring for each amino acid. many of these amino acid properties have been compiled in multiple non-independent "amino acid scales"  <cit> .

in this way, every amino acid is assigned a numerical score that quantifies a particular physicochemical property Ω . hence, any group of n amino acids will have n associated scores, xΩ, <dig> ..xΩ,n. from these scores, an arithmetical average μΩ and a sample variance estimator σΩ can be calculated  as:      

a multiple alignment of protein amino acid sequences, such as that obtained by using clustalw, comprises a given number of n positions. each position i contains a group of ni optimally aligned amino acids, each from a different protein . as the multiple alignment at position i can include gaps, ni is not always equal to the number of proteins in the alignment. for example, in the ninth position  of the alignment in figure  <dig>  n <dig> =  <dig>  hence, for any given amino acid property Ω, an average μi,Ω,n and a variance σi,Ω,n can be calculated for each position i in a multiple alignment with n amino acids, using eq. <dig> and eq. <dig>  respectively.

the variance σi,Ω,n, as its name suggests, quantifies the variability of the property Ω in position i. if σi,Ω,n is small, a large variation in the property Ω is not allowed in position i, and vice versa. therefore, σi,Ω,n can be used to quantify the conservation of the property Ω at that position. however, σi,Ω,n depends on the scale used to measure Ω and on the number n of amino acids compared. hence, it cannot be used to compare the conservation of different properties or different quantification scales, or to compare the conservation between positions with different numbers of amino acids. a different scale-free and position-free standard parameter has to be calculated to quantify and compare the conservation of properties in multiple alignments.

in the general case, there are  <dig> different amino acids and therefore for a given number of n amino acids there are 20n different random amino acid combinations. for any given property, it is possible to calculate all the 20n possible combinations of n amino acids and their associated averages and variances. if amino acid combinations are random, any particular combination will have a probability of occurrence equal to 1/20n. therefore, both the average and variance associated to each combination will have a probability of occurrence equal to 1/20n. particularly, for a random combination of n amino acids and any given amino acid property Ω, a discrete probability mass function  for the variance can be constructed. the function pmfΩ,n gives the probability that the variance σ of the property Ω calculated for a group of n amino acids is exactly equal to x  <cit> .

from the pmfΩ,n for the variance of the property Ω, a cumulative distribution function  can be obtained  <cit> . as shown in figure  <dig>  if the variance σΩ = x, then cdfΩ,n  = pΩ is the probability of the variance of a random combination of n amino acids being between  <dig> and x. thus, if pi,Ω,n in a given position i in a multiple alignment is small, then the probability of said variance having a value equal or less than x is very small in comparison with the probabilities of all the possible variances in a random combination of n amino acids, and vice versa. for example, a value of pi,Ω,n =  <dig>  means that the obtained variance σi,Ω,n  only occurs in a proportion of  <dig> to  <dig>  in random combinations of n amino acids.

the significance of variances for every position i in the target multiple protein alignment are calculated in step  <dig> of the algorithm . notably, if pi,Ω,n in a given position i in a multiple alignment is small, the variance σi,Ω,n of the amino acid property under analysis in that position is simultaneously small and relatively uncommon, i.e. the amino acid selection in that position is not random. hence, a small pi,Ω,n implies that the property value must be relatively invariable  at position i, and vice versa. the closer to  <dig> is the value of pi,Ω,n, the more significant this variance is and the less random the amino acid group is at position i.

the probability pi,Ω,n is an indicator of the degree of conservation of any property Ω at each position i in a multiple alignment, contrary to the use of the variance alone. the advantages of this conservation measure are, firstly, its independence with regard to the number n of amino acids in the comparison  and, secondly, the possibility of performing scale-free and position-free comparisons between conservations at different positions and using different scales or properties. interestingly, the probability value pi,Ω,n could also be used as a significance value in hypothesis tests for the obtained variance σi,Ω,n.

determination of mutationally relevant positions
ideally, each property Ω is unique and mutually independent, and its contribution to the global structure and function of a protein is relatively important. for an amino acid position i in a multiple alignment, and given a cumulative probability pi,Ω,n for each amino acid property, we define three possible cases into which the relationships between the different probabilities pi,Ω,n for each amino acid property at a position i could be classified a priori. in figure  <dig>  these three possible cases are shown with reference to three different amino acid scales. these three cases, which are defined in the following paragraphs, can be used as a basis to determine good mutagenesis objectives.

invariable determinant position 
the first case is defined by obtaining a high significance level, i.e. a very low pi,Ω,n value, for every amino acid property in a position i. this implies a relevant conservation of all the properties at that position. these positions are usually identified in multiple alignments as those positions that stringently accept only one or sometimes two different specific amino acids and are thus readily identifiable and visible using simple methods. the change of one amino acid for another in the analyzed position would probably imply a drastic change in the value of one or more properties and therefore alter the conserved necessity for invariability at that position, causing a partial or total loss of some of the characteristic properties of the protein family. if it is desired to conserve such properties, e.g. conservation of catalytic function or interaction sites, as would be the general case in conservative site-directed mutagenesis studies, then these positions should not be considered as possible mutagenesis objectives. a mutation in this type of position is usually deleterious for the protein function in nssnps.

variable irrelevant position 
the second typical case is when all the probabilities pi,Ω,n associated to variances for all the amino acid properties at position i are very high. here, the significance of conservation of those properties at that position is very low, i.e. conservation is irrelevant. the replacement of one amino acid by another in any of these positions should not be determinant for the protein family, as the conservation of any particular characteristic is not required. in other words, the amino acids present at these positions do not contribute fundamentally to any relevant characteristic of the protein family. therefore, it is expected that mutagenesis at a variable irrelevant position should not have a large effect on the characteristics of a protein family. a nssnp with these characteristics is probably silent and does not affect protein function.

variable determinant position 
the third case corresponds to the case where, at the analyzed position i, there is a high conservation, i.e. a high pi,Ω,n significance, in one property and a very low significance or conservation in the remaining properties. then, for this position there is a very high tendency to conserve one of the independent amino acid properties, which are necessarily privileged, and a simultaneous tendency to variability in the other groups of rather irrelevant properties. thus, this position is variable in the sense of admittance of global variability of some characteristics, but nevertheless is determinant for possession of a conserved group of characteristics, which have to be present to communicate common characteristics to the protein family. this makes this kind of position a main target to be mutated. a nssnp in this type of position can affect protein function in a rather unpredictable but probably very determinant way.

a conservative mutagenesis strategy that aims to preserve the main functional or interactional properties that characterize the protein family and to selectively alter secondary traits should be focused on mutating only vdps, while a non-conservative mutagenesis strategy could also include idps. if the aim is to identify nssnps, mutations that could alter protein function are most probably located at idps and vdps. whichever the task and the expected result would be, it is evidently useful to identify vdps, given their allowed amino acid variability and the simultaneous relative importance of conservation of one property in such position in the entire protein family. however, vdps are much more difficult to find than idps, which makes vdps prime "hidden" functionally relevant positions that cannot be readily identified by other existing automatic methods. the following sections will describe the proposed method to identify these positions.

identification of variable determinant positions
we described previously that the determination of the significance values pi,Ω,n for each position i in a multiple alignment is based on the cdfs of the variances of random combinations of n amino acids. after cdfs are calculated for the variance of each amino acid property, the significance pi,Ω,n associated to each property can be calculated at each position.

with these pi,Ω,n values we can identify in an alignment the vdps described previously as hidden functionally determinant positions where one of the properties is conserved, while others are not. to identify such positions , it is necessary to determine whether significant differences exist between the variances of the different amino acid properties at a given position i. in fact, differences between the variance of one property and the variances of every other could be used as indicators of the presence of conservation of a single property in position i. however, only significant  differences will indicate that position i is indeed a vdp. hence, in the following section, we develop a method that uses hypothesis testing to identify vdps by quantifying the magnitude of the significance of such differences and assigning a probability to classify position i as a vdp.

hypothesis test for differences
in the same way that probabilities pΩ can be calculated and cumulative distribution functions can be constructed for the variance of any given property Ω, a probability p for all the possible differences Δσ between the variances of any two properties Ω <dig> and Ω <dig> can be found . the probability value p is equivalent to the probability of the absolute difference between variances being Δσ or less. from these differences and their associated probabilities, a corresponding cdf,n can be calculated for a group of n amino acids, considering all the possible random combinations of variances and their differences .

therefore, for every position i with n amino acids in a multiple alignment, a hypothesis test can be devised to test whether a given difference between the variances of two given properties Ω <dig> and Ω <dig> is not random, i.e. Δσi,,n is significant. the null and alternative hypotheses for this test are, respectively:

h0: the variances of both amino acid properties are equal ,n is random).

h1: the variances of both amino acid properties are different ,n is not random).

thus, cdf,n is the distribution function of the test statistic Δσi,,n under the null hypothesis, i.e. random differences between the variances. hence, cdf,n ,n = x) = pi,,n is the probability of the difference between the variances of two properties Ω <dig> and Ω <dig> in a random combination of n amino acids being less than x . therefore, p'i,,n =  <dig> - pi,,n is the probability  of the null hypothesis for the properties Ω <dig> and Ω <dig> . for very low values, under certain arbitrary limits, the null hypothesis is not significant and could be rejected in favor of the alternative hypothesis.

the partial significance of the differences between each pair of properties is calculated in step  <dig> of the algorithm. however, as there are many different properties Ω, for each position i in a multiple alignment, each pair of properties will have a corresponding significance value for the difference between their variances. none of these differences or their related significance levels could be seen mathematically as the significance of the position by itself. the significance of the position must integrate all the individual significances in a global significance value. if the null hypothesis is significantly rejected for one single property when compared with all the other properties, position i can most likely be identified as a vdp. in particular, to identify a vdp the global significance must be maximal when all differences except one are significant.

integration of the individual significances
for a given position i in the alignment comprising a group of n amino acids, every possible pair of properties Ωr and Ωs will have a difference Δσi,,n between their respective variances, and a significance level p'i,,n associated to this difference. each comparison between any pair of properties gives information to prove or disprove that the variances of the properties are different. therefore, every p'i,,n can be considered as the significance level of a single experiment or sampling test to reject the null hypothesis at position i. however, the level of significance of the global null hypothesis must take into account the level of significance of all the differences between every pair of property variances. therefore, none of the p'i,,n alone is able to represent the significance of the position i on its own.

statistically, the significance levels obtained from different experiments to demonstrate the same hypothesis could be combined in order to get a composite level of significance, as if a single experiment would be done with the combined evidence of all those partial experiments. this combination could be done using different procedures according to the features of the particular cases . in our case, the differences of variances between each possible pair of properties are not independent, since the difference between the last pair of properties is a linear function of the others, so the fisher procedure cannot be used. from the other two methods, the simes procedure gives the best results, as its rejection region contains the rejection region of the bonferroni methods and it is always more powerful than those, specially in the case of highly dependent test statistics  <cit> , which is suspected to be our case.

we propose the use of the simes method to combine the significance values of the differences of variances between all the properties, in order to obtain a global significance value for the differences at position i . the simes method can be applied in a simple way: if p'm = p' <dig>  p' <dig> ... p'm is the value of the level of significance of each difference of variances between all the pairwise combinations of properties, in ascending order, the value of the global significance that considers all the individual partial significances for position i is:   

the global probability pi represents the probability of the null hypothesis being true, given the values obtained for the differences of variances between different properties. in our case, pi is the probability of all the variances being equal. the lower this probability, the higher the accuracy with which the null hypothesis could be rejected, i.e. it is more probable that the variances of the different properties at position i in the analyzed multiple alignment could be different. hence, low pi values could be used to directly identify vdps in a multiple alignment .

determination of the rejection regions for the null hypothesis
statistical practice classifies the levels of significance of a hypothesis test in different categorical levels, usually "not significant", "significant" and sometimes "very significant". this categorization is performed using a criterium that imposes an arbitrary limit between one significance level and another. usually, a value of  <dig>  is the limit between "non significant" and "significant" levels. however, multiple experimental implementations of the proposed algorithm indicate that this limit is not stringent enough to correctly classify vdps apart from idps and vips. preliminary evidence shows that positions in a multiple alignment could be roughly classified into one of the following categories according to their significance levels: not significant , significant  or very significant .

with this classification, critical values for the rejection region of the null hypothesis are determined  and vdps in the target protein are those positions identified as significant or very significant . accordingly, the other positions are classified as idps, which cannot be mutated without radically altering the characteristics of the analyzed protein family, and vips, which are not good mutagenesis targets because they are "filling" amino acids or amino acids that contribute with indiscernible and different characteristics to each particular protein.

identification of invariable determinant positions
the identification of idps can be done much more easily than the identification of vdps. normally, idps can be directly identified by visual inspection and looking for complete or almost complete amino acid conservations at any given position. however, the identification of idps can be readily implemented as a part of the mosst algorithm, using the same tools previously developed to identify vdps. in fact, according to figure  <dig>  idps have two characteristic features: the variances of all the amino acid properties must have very low values  and the differences between those variances must also be very small . therefore, any position i for which the global probability pi is classified as not significant and the probability pi,Ω,n for every Ω is classified as significant, must be an idp .

determination of the possibilities of mutation for each position
once the amino acid positions in a protein whose mutation could be functionally significant have been identified, the possible effects of amino acid substitutions at such positions are determined in a further step of the mosst algorithm. a distribution analysis of the different amino acid properties at said position is done in order to identify a priori possible functionally relevant or functionally silent amino acid changes in the protein, either to guide a rational mutagenesis strategy or to identify non-evident nssnps .

the proposed method determines the probability of an amino acid being present at a determined position using a statistical method based on the student t-test. this procedure starts with the previously calculated average  and variance estimator  at a position i of the multiple alignment. for each position, each amino acid property is assumed to have a normal distribution n, with unknown parameters μ and σ. this assumption is reasonable, because it is assumed that at each position the average of each scale would represent the ideal characteristic to be fulfilled at that position and the standard deviation would represent the accuracy level of conservation of the characteristic.

for a sample of n values xi,Ω, <dig> ..xi,Ω,n obtained for an amino acid property Ω at a given position i, assuming a normal distribution, it is possible to predict the distribution of a new value xi,Ω,n+ <dig>  mathematically, if we have a normally-distributed variable x sample mean value μi,Ω,n and a sample variance σi,Ω,n for a position i, then the test statistic:   

has a student's t-distribution with n- <dig> degrees of freedom  <cit> . as the probability distribution of τi,Ω,n+ <dig> is known, it is possible to calculate the distribution of xi,Ω,n+ <dig> as:   

 is the posterior cumulative distribution function for the values of the property Ω at position i, given the previously known group of n amino acids present in the multiple alignment at such position. from this , a probability density function  can be derived. since each amino acid naturally has one particular value of property Ω,  allows the assignment of a probability qj,i,Ω,n+ <dig> to each amino acid j  to be present at position i in a new protein not included in the multiple alignment . this probability is directly associated with the property Ω and its distribution .

as each amino acid can have many different properties Ω <dig>  Ω <dig> .. Ωl:, and each property will have a different pdf , then each amino acid will have l associated individual probabilities to be present at position i, which we will call  for each amino acid j. the combined global probability qj,i for the occurrence of each amino acid j at position i is calculated as:   

this combined global probability represents the probability of every particular amino acid satisfying the requirements of all properties at position i, and therefore is an indicator of the functional suitability of each amino acid in such position.

quantification of the functional suitability of the amino acids
the former multi-property consensus method allows calculation of the global probability of occurrence of each amino acid at each position in a multiple alignment. the probability value can also be used as an indicator of the functional impairment introduced by each amino acid at every analyzed position i. if the requirements of the functional properties that have to be fulfilled in position i lead to a high probability for an amino acid to be in that position, it means that the amino acid does not impair the function of the protein. inversely, if the probability is low, such amino acid can be functionally deleterious.

for this last step of the analysis, a method based on the sorting of these probabilities of occurrence in descending order and the construction of a scree plot with the ordered values can be used. an example of this procedure is shown in figure  <dig>  the scree plot at each position i could help in getting the preference level or reliance with which the analyzed position could be occupied by each of the amino acids, based on the required physicochemical properties at such position in the protein. an analysis of the scree plot and its curvature can serve to identify a cut point  in the curve. this point can be determined by using a "fall contrast" or "scree" criterium  <cit> , where the highest probability factors are chosen up to a point where the curve becomes approximately horizontal. a second criterium can also be used, where the highest probability factors are chosen to explain together at least a predefined high probability  or until the last factor has a non-significant probability . any criterium will define two sections in the scree plot: on the left a curve section including an amino acid group with the highest probabilities and on the right a section with those having the lowest probabilities. this classification allows separation of a high-probability group comprising functionally non-disruptive amino acids from a low-probability group of functionally deleterious amino acids. hence, qj,i can be used as a basis to identify non-evident nssnps and to design rational site-directed mutagenesis strategies for each position i in a protein.

implementation of the algorithm
three main issues were solved to implement the algorithm. these aspects will not be analyzed in detail in this paper, because they are not directly related to the algorithm theory and design, although they must be solved to get a good implementation thereof.

the first aspect is the selection of suitable property vectors that could be successfully used in order to get the most accurate information from the mosst algorithm and to exploit the classification abilities of the algorithm in an optimal way. though the general algorithm has been presented as being able to use any group of property vectors to perform the proposed analysis, we selected a minimal number of three normalized vectors that are mathematically orthogonal to each other to optimize the statistical potency of the results.

the second issue is the calculation of the probability distributions of the averages and variances of the selected optimal vectors, which are necessary for the implementation of the algorithm as set forth in the present paper. we have assessed that the law of large numbers is not accurately applicable for combinations of less than  <dig> amino acids given the optimal vectors previously obtained. even though the probabilities of the different amino acid combinations could be calculated in a direct way, it is computationally difficult and time-consuming for combinations of more than  <dig> or  <dig> amino acids. we developed a direct calculation method to get an approximate distribution for combinations from  <dig> to  <dig> amino acids, which analysis and explanation is out of the scope of this work.

the last aspect is the determination of the right significance levels that should be taken into account to classify each position as "non significant", "significant" and "very significant" when determining the rejection regions for the null hypothesis of equality of variances. as we mentioned earlier, values of  <dig>  and  <dig>  could be preliminary used to select between these classifications, which are more stringent than those values usually used in statistical testing. however, our experience implementing the algorithm has shown that the most interesting positions in a protein alignment  have to be determined case by case, based on characteristics of each different multiple alignment. in our experience, the implementation of the algorithm included this data analysis in order to get the most out of the results of the general algorithm.

the mosst algorithm has been implemented with the details mentioned above as a graphical user interface  in matlab . given the nature of mosst results, it is easier to display them in a graphical interface in order to allow the user to have an integral vision over them and to modify the parameters of the algorithm on-the-run to obtain the best possible results for each given analysis. one of the major advantages we devised from the use of an interactive gui is the definition of "primary positions". we defined primary positions as those "very significant" positions that have exceptionally high mutability scores as defined by the statistic theory behind the algorithm. by using mosst gui, the user can select both manually or semi-automatically the threshold significance value above which a "very significant" position becomes a "primary position" and thus a primary mutagenesis objective.

the semi-automatic method advantage over the manual method is that it helps the user to select a suitable threshold by presenting a differential scree plot where the user can interactively select the threshold by comparing the differences  between similar ordered significance values. the optimum threshold will be a "very significant" significance value having the largest possible difference with immediately higher  significance values. if two or more significance values fulfill these criteria, the largest one is most appropriately selected. this empirical rule is applied by the user with his/her own judgment to select a proper threshold value.

the empirical selection of "primary positions" proved to be an additional tool to narrow the search for mutable positions in a protein family. an example of the relevance of determining primary positions is shown in the study of glycosyl hydrolases belonging to family  <dig> 

testing: mutagenesis analysis of endoglucanases belonging to family  <dig> of the glycosyl hydrolases
selection of representative proteins
mosst was used for the analysis of representative endoglucanases classified as glycosyl hydrolases belonging to family  <dig>  they have several appropriate characteristics:  a very close structural and folding similarity despite them not having a very high degree of sequence similarity,  well characterized residues that participate in the interaction with the substrates at the active site and define the substrate specificity of the family,  well characterized active residues that are indispensable for catalysis,  two well defined and populated enzyme families with distinct substrate specificities and no known structure-function correlations, namely lichenases  and laminarinases -β-d-glucanases, ec  <dig> . <dig> ), and  large availability of experimental data, including mutagenic studies. these characteristics were considered ideal to test the ability of mosst to determine functionally relevant amino acid positions against experimentally tested results, since this allows the analysis of amino acid mutations purely by the effect of their side groups, while leaving other factors  outside of the analysis.

among these enzymes, we selected cellulosimicrobium cellulans's bglii as our reference enzyme. proteins included in the analysis were selected by their similarity with bglii and both the conservation of folding pattern and enzymatic activity. table  <dig> shows the representative set of proteins selected and included in this study.

descriptor codes in the multiple alignment are highlighted in bold characters.

obtention of a multiple alignment
following the flow diagram of the mosst algorithm, these proteins were aligned using clustalw . preliminary tests using different substitution matrices and different gap opening and extension penalties were performed. the combination that exhibited best results was obtained using an identity matrix as substitution matrix and minimal values for gap creation and extension. this combination empirically gives more importance to conserved sectors, which in our case correspond to secondary structure and folding sectors that are conserved in the family. this strategy is concordant with the fact that the studied group of proteins is a very structurally conserved enzyme family, even when conservation is lower at the sequence level due to the difference in activities of the proteins.

redundancy analysis
for this objective, a protein clustering dendrogram and an agglomeration plot were constructed according to the similarity percentage between the proteins in the multiple alignment . an optimal separation between sub-families is obtained using a similarity percentage cutoff of 86%. three groups of similar enzymes were represented by only one of them:  synthetic hybrid lichenases  <dig> and  <dig> from bacillus macerans / bacillus amyloliquefaciens ,  bacillus amyloliquefaciens  and bacillus subtilis  lichenases, and  two enzymes from rhodothermus marinus, one of them classified as a laminarinase  and the other classified as a lichenase . the remaining proteins, even those belonging to the same species, are considered different enough to be included in the analysis with no added redundancy.

it can be observed in the dendrogram a subdivision of the proteins in the alignment in two large sub-families corresponding mainly to the division between lichenases  and laminarinases . this observation indicates that the information contained in the multiple alignment is also able to discriminate between functional aspects of the enzymes.

calculation of the statistic values and significances
for each of the positions of the non-redundant multiple alignment, the associated variance in each of the three principal components and the differences between the three components were calculated. the values of said differences were used to calculate the global significance of each position and to classify said significance according to the criteria exposed in the previous paper of this series. this allowed the classification of positions in the alignment as "non-significant", "significant" and "very significant". in addition, a new category of "primary position" was defined when the global significance of the position is included in the higher percentile of the values in the distribution of global variances as described in the practical implementation of mosst analysis.

structural mapping of primary positions
the determined primary positions can be mapped over a model of the tridimensional structure of bglii. in this structural mapping a spatial distribution pattern of sectors in which variable determinant positions are concentrated can be observed, i.e. the most promising mutagenesis targets for this protein family . the active site of the protein family is comprised widely by amino acids in positions 45- <dig> , 167- <dig> , 187- <dig> , 205- <dig> , 214- <dig> , 307- <dig>  and 315- <dig>  in the multiple alignment. a detailed analysis of active site amino acids according to the algorithm implemented in this work is shown in figure  <dig>  inside the active site, variable determinant positions were identified as the following amino acids using bglii numbering : leu <dig> , trp <dig> , phe <dig> , met <dig> , leu <dig> , gly <dig> , met <dig> , gly <dig> , val <dig> , his <dig> , gly <dig> , phe <dig> , phe <dig> , leu <dig>  and ala <dig> .

predictive value of the algorithm: comparative analysis of laminarinases
the mosst algorithm can be applied only to an enzyme sub-family. in our case, these sub-families can be determined from the redundancy removal dendrogram and are associated with enzyme function differences, as mentioned earlier. it is interesting to apply this analysis procedure to laminarinases and compare these results with the variable determinant positions obtained for the entire family. therefore, variable determinant positions were determined for laminarinases using a similar procedure to that used for the total protein family, and these positions were compared with those obtained for all family  <dig> glucanases. the active site structure of bglii is represented in figure  <dig> with differentiated variable determinant amino acids for family  <dig> glucanases and variable determinant positions for the laminarinase sub-family. logically, if a position in the active site is variable for laminarinases as a family then said position cannot be significant to determine substrate specificity of these enzymes. instead, if a position is variable determinant for family  <dig> glucanases but not for laminarinases, then it is logical to assume that said position could be relevant in the determination of laminarinase specificity when compared with the other enzymes of the same family.

under this assumption, the comparative analysis using the mosst algorithm shows that the following active site amino acids  can have a determinant function over laminarinase specificity: leu <dig>  trp <dig>  gly <dig>  gly <dig>  phe <dig>  phe <dig> and ala <dig>  it is interesting to asses that some of these amino acids have been identified in the analysis of the molecular model of bglii and other family  <dig> glucanases as amino acids that participate in substrate binding and/or interactions  <cit> . this observation corroborates the ability of the mosst algorithm to identify relevant positions in a protein.

predictive value of the algorithm: analysis of histidine 129
position  <dig> , which corresponds to histidine  <dig> in bglii, is very remarkable. this position has been identified in the structural analysis of bglii as an amino acid that could be implied in the chemical reactions catalyzed by this enzyme  <cit> .

the mosst algorithm marks position  <dig>  i.e. histidine  <dig>  in bglii as a primary mutagenesis objective and therefore this fact can be exploited to obtain interesting variants of the enzyme, possibly having different catalytic properties due to the position occupied by said amino acid in the active site. it should be noted that this histidine is classified as a primary amino acid both for the global family of proteins under study and for laminarinases, and so a possible substrate interaction function should be discarded, at least in a first approach.

mosst algorithm suggests for said position the presence of a histidine residue  and the alternative presence of a phenylalanine residue  or a glutamine residue . the remaining amino acid have probabilities of less than 1% each and their combined probabilities only adds to  <dig> %, so their presence is not considered relevant in said position. the real nature and contribution of each proposed alternative could be analyzed using other predictive techniques, in advance to mutagenic experiments, in order to decide which of said variants would be the most favorable one to obtain the desired effects in the protein. it is also possible to analyze all the proposed alternatives, producing in the laboratory the corresponding mutant enzymes and analyzing their new properties.

the contribution of this amino acid and the possible mutations performed on it to the enzymatic catalysis could be assessed by means of an additional analysis, for example, a kinetic analysis of a catalytic model. in a former work  <cit> , using structural and mechanistic knowledge about glycosyl hydrolases from families  <dig>   <dig>  and  <dig>  we have formulated a mathematical model that can include ionizable residues in the active site and incorporating electrostatic influences via acid dissociation equilibrium constants and chemical relationships such as hydrogen bonds. the results of the simulations indicated a clear shift in the ph dependence of activity for the enzymes only when a close interrelation  between a catalytic glutamate and histidine  <dig> is taken into account, which is concordant with experimental evidence with bglii . moreover, we demonstrated that the presence of the kind of chemical interaction proposed could provide stabilization of the activity in the presence of environmental, structural, ph and electrostatic variations. the results suggested a new way to modify, via site-directed mutagenesis, the acid dissociation of one of the catalytic residues in the active site independently of the other, which could have clear advantages over the purely electrostatic modifications that usually affect both residues simultaneously.

under the light of this previous work, mosst analysis results were very striking in their ability to identify this residue as relevant even without any previous knowledge or suspicion about its relevance or function in this enzyme family. in our opinion, this clearly demonstrates the usefulness of mosst as a general tool for the design of new site-directed mutagenesis strategies in protein families.

CONCLUSIONS
a statistical procedure has been designed and presented to semi-automatically identify functionally significant mutable positions in a protein, based on the conservation of physicochemical properties. such positions are identified and classified into three groups, according to the influence their mutation could have on protein function. those in which a mutation does not alter the function and basic characteristics of the protein, but do change them slightly, and those in which a mutation is totally deleterious for the protein are the most relevant positions to look for nssnps, while only the former are important when trying to develop site-directed mutagenesis strategies so that variants with improved properties could be generated.

amino acid positions are also classified in three groups: variable irrelevant positions , invariable determinant positions  and variable determinant positions . the recognition and identification of vdps is especially relevant, since these are "hidden" functionally relevant positions that cannot be easily identified by other existing automatic methods. this classification serves as a basis to rationally identify relevant amino acid positions in a protein in the frame of a rational design strategy or in the identification of nssnps. in this way, a conservative mutagenesis strategy that aims to preserve the main properties of a protein family should be focused on mutating only vdps, while a non-conservative mutagenesis strategy could also include idps. if the aim is to identify nssnps, mutations that could alter protein function are most probably located at idps and vdps.

once these key functional positions are identified, the statistical distribution of the relevant physicochemical properties at each protein position is analyzed to get a list of the  <dig> common protein amino acids ordered according to the global probability with which they can conform to the required property profile of each relevant position. this ordered list is divided into a group of functionally non-disruptive amino acids and a second group of functionally deleterious amino acids.

these results become a discriminative tool in the selection and elaboration of rational mutagenesis strategies for the protein. they can also be used to predict if a given nssnp, identified, for instance, in a genomic-scale analysis, can have a functional implication for a particular protein and which nssnps are most likely to be functionally silent for a protein. this analytical tool could be used to rapidly discard any irrelevant nssnp and guide the research focus toward functionally significant mutations. this approach also has the advantage that not only conserved amino acid positions in a protein family can be labeled as functionally relevant, but also non-conserved amino acid positions can be identified having a functional effect.

the mosst algorithm has been implemented as a matlab gui and used to analyze endoglucanases belonging to glycosyl hydrolases family  <dig>  in order to determine interesting mutagenesis targets on them. the analysis has indicated amino acids that could be mutated in β- <dig> -endoglucanase bglii of c. cellulans to obtain critical changes in the enzymatic activity: putative substrate specificity amino acid determinants for lichenase and laminarinase activity and determinants of ph-activity profiles for these enzyme family, thus confirming mosst performance as a predictive tool for the study of functionally relevant mutations.

the proposed methodology also has limitations, especially in that it uses only information derived from a multiple alignment and the statistical result for each position will strongly depend on the quality of the alignment and it does not prevent a priori this significance level to vary between one alignment and another. in this sense, the quality of the alignment is determinant and should be carefully controlled. moreover, the algorithm does not give any suggestion about the real nature and contribution of relevant amino acids to the structure and function of the protein, but the predictions could be analyzed using other predictive techniques or tested by mutagenesis experiments. another limitation is related to the fact that mosst operates on single positions in a multiple alignment and all statistic parameters are calculated for each position without taking into consideration the simultaneous occurrence of mutations in other positions that can compensate for the effect of the first. this excludes the study of correlated compensatory mutations using mosst in its current version.

although the developed procedure does not give any indication about the functional implications of the amino acids positions identified as relevant, an unrelated analysis that use another type of information beyond the statistical inference performed on the multiple alignment by mosst could shed light on their contribution to the protein function or structure. specifically, classical methods to study experimentally and/or predictively the structure-function relationships in proteins can provide this kind of external information. for example, this type of analysis has been used to test the functional relevance of the amino acids identified by mosst in family  <dig> glycosyl hydrolases. in the case of position  <dig> of the alignment of these proteins, a mechanistic-electrostatic analysis yielded an explanation of the functional contribution of this amino acid position to catalysis  <cit> . the implementation and testing results set forth in this work show a promising performance of this technique as a valuable bioinformatics tool to aid in the development of new protein variants and to aid in the understanding of function-structure relationships in proteins.

