BACKGROUND
the acacia auriculiformis x a. mangium hybrid is emerging as an important forest tree for pulpwood production in south east asia. marker-assisted breeding is a promising approach for selection of superior trees with improved wood and pulp properties for the establishment of forest plantations. previous efforts to develop molecular markers such as cleaved amplified polymorphic sequence   <cit> , genomic - simple sequence repeat   <cit>  and expressed sequence tag - simple sequence repeat   <cit>  for acacia hybrid did not generate sufficient markers for linkage map construction because they were either monomorphic or not fully informative for the biparental mapping populations. development of molecular marker from narrow genetic background such as the parents of the mapping population is an effective way to generate informative markers for linkage mapping. towards this end, single nucleotide polymorphism  is the ideal marker because it provides affordable and high-throughput genotyping compared to other markers  <cit> . a snp is a single base change that occurs in at least 1% of the population  <cit> . snps are also co-dominant, bi-allelic, abundant in the genome  <cit>  and thus, suitable for low genetic diversity species such as a. mangium <cit> . besides linkage map construction, snps can be used in genetic diversity assessment of natural germplasms, estimation of outcrossing rate in natural germplasms and seed orchards, and more importantly, clone and hybrid identification in breeding program of both species. to date, only one study reported the genetic diversity of a. mangium involving the use of restriction fragment length polymorphism  markers  <cit> . genetic diversity of a. auriculiformis has been studied using isozyme markers  <cit>  and sequence characterized amplified region   <cit> . although there is no study that compare the genetic diversity of both species, the lower snp frequency observed in the transcriptome of a. mangium <cit>  suggested that a. mangium has lower genetic diversity than a. auriculiformis.

there are two main strategies to develop snp markers, namely in vitro and in silico method. the in vitro method involves polymorphism screening using dna sequencing while in silico method detects polymorphisms in dna sequences of different individuals using computer sequence analysis  <cit> . although in silico method is cheaper and less labour intensive compared to in vitro detection, it is more prone to sequencing errors and low sequence coverage  <cit> . currently, next generation sequencing  offers affordable, high-throughput, and accurate sequence data generation. ngs has been proven highly effective for in silico snp detection in many plants with reference genome such as arabidopsis  <cit> . for non-model species, several approaches have been adopted to overcome the lack of reference genome: a) generation of genome sequences using the reduced representation library  method  <cit> ; b) use of reference genome from closely related species such as catfish  <cit> ; c) use of gene index as reference  <cit> ; d) de novo transcriptome sequencing and assembly  <cit> . many reported studies on de novo transcriptome sequencing utilized  <dig> sequences that give longer read length for snps discovery . although various methods have been reported, it is difficult to apply the results of these findings to obtain similar results due to the differences in read quality, sequence coverage and preference of mapping and snps calling tools. it is important to understand the limitations and error rate of each dataset for effective in silico snp detection  <cit> .

medium- to high-throughput custom snp genotyping technologies such as illumina goldengate, kbiosciences kaspar and sequenom iplex, which differ in assay type, throughput, multiplexing and cost are suitable for linkage map construction  <cit> . among these technologies, the illumina goldengate assay has been widely applied in many plant species  <cit> . it has been demonstrated in human genome to provide affordable genotyping which has high reliability, reproducibility and multiplexing of up to  <dig>  snps  <cit> . in illumina goldengate assay, three oligonucleotides are designed for each snp locus using the submitted flanking sequence around the snp site. a minimum of  <dig> bp flanking sequence upstream and downstream of the snp site is required for submission  <cit> . two oligos are specific to each allele of the snp site, called allele-specific oligos , while a third oligo known as locus specific oligo  carries a unique address sequence and hybridizes several bases downstream from the snp site. the assay involves several steps such as dna activation, oligonucleotide hybridization, extension and ligation, universal pcr, array hybridization and scanning. for snp genotyping using illumina beadxpress reader machine, genomic dna is first biotinylated, attached to the oligonucleotides and bounded to streptavidin-coated paramagnetic beads  <cit> . the extension and ligation of hybridized oligonucleotides provide pcr template using three universal pcr primers in which two are cy <dig> and cy <dig> fluorescence-labelled. the non-fluorescent strand of pcr product is removed through its 5’ biotin group to generate single-stranded dna for hybridization to veracode beads. after hybridization, the beadxpress reader machine scanned for fluorescence signals on veracode bead plate and exports the intensity values to gencall software. gencall software uses a clustering algorithm known as gentrain and calculates a quality score for each genotype  <cit> . the intensity values for each of the two-color channels, commonly referred to as a and b, are normalized and plotted to display distinct patterns or clusters to represent aa, ab and bb signal profiles. the aa, ab and bb clusters correspond to homozygous genotype for allele a, heterozygous genotype and homozygous genotype for allele b, respectively.

the development of high-throughput snp assay in acacia can be challenging for several reasons. without a reference genome, several factors are known to affect the success of a snp assay such as the presence of exon-intron boundaries, secondary snps and indels in the flanking region, paralogous genes, genome complexity and repetitive sequence. the assay success rate has been reportedly lower in conifer forest species with complex genome . this factor may not be an issue for tropical hardwoods, which typically have smaller genomes and considerably less repetitive sequences than conifers. although snp transferability to other species has been reported in several plant species  <cit> , snp development in interspecific crosses has only been reported for a few forest and aquaculture species that remained largely “wild” and naturally outcrossing  <cit> . when using interspecific crosses, genomic similarity between species must be high to allow amplification and hybridization in snp genotyping. the genes of a. auriculiformis and a. mangium have been reported to share 99% similarity in nucleotide level  <cit> , and thus sequence similarity is not a concern. the overall success of snps development in acacia hybrid will depend on short read sequence quality, a highly robust snp detection approach to identify sequencing error and with enough sensitivity to detect rare snps to increase assay successful rate, appropriate assay design and genotype calling approach to obtain high quality genotypes.

in this study, we aimed to develop high-throughput snp genotyping assay for a. auriculiformis x a.mangium hybrid with the ultimate objective of linkage map construction. we sequenced the transcriptomes of the parents of two mapping populations and mapped the short reads against a set of gene contigs to discover snp markers. we evaluated our snp detection approach based on a set of validated snps from two lignin genes detected using in vitro approach and further validated  <dig> snps using illumina goldengate assay. we also investigated several factors affecting assay success rate based on 96-plex validation. based on these findings, we further improved the snp detection approach and designed illumina goldengate assay consisting of  <dig> snps. the clustering patterns were analyzed to evaluate the reproducibility of illumina goldengate assay. in addition, we identified polymorphic snps that can be transferred to natural germplasms of a. auriculiformis and a. mangium.

RESULTS
transcriptome sequencing and snp detection
sequencing of normalized cdna library from sample aa <dig> and am <dig> produced  <dig> , <dig> and  <dig> , <dig>  <dig> bp paired-end reads, respectively. removal of smart adaptors and concatemers resulted in  <dig> , <dig> and  <dig> , <dig> single-end reads for aa <dig> and am <dig>  respectively. the read generation and pre-processing for individual aa <dig> and am <dig> were described in wong et al.  <dig>  <cit> . a total of  <dig>  contigs with lengths ranging from 200- <dig>  bp where  <dig>  and  <dig>  contigs came from aa <dig> and am <dig> de novo transcriptome assemblies, respectively were selected as reference sequences  for snp detection. bowtie mapped about  <dig> - <dig> % filtered reads from each dataset to aarefseq  and a total of  <dig>  putative snps were called by samtools after excluding redundant snps present in at least two inviduals. generally, bwa mapped about 50% less reads to aarefseq compared to bowtie resulting in 55-65% fewer putative snps being called. higher proportion of mapped reads from dataset aa <dig> using both software was observed compared to sample am <dig> as a result of better cdna normalization. all putative snps contained scores that ranged from  <dig> to  <dig>  about 80-87% of the putative snps detected by bwa were also detected by bowtie .


comparison of in vitro and in silico methods
to evaluate the accuracy of putative snps, we compared the snps detected in the coding region of two lignin genes, namely c4h and cad gene using the current in silico approach and in vitro approach. we found out that in silico method is highly accurate compared to in vitro method. a total of  <dig> validated snps, namely  <dig> snps for each gene were compared to the snps detected in the present study . out of  <dig> validated snps in coding region of c4h gene, only four snps were assayed successfully. all four snps were monomorphic, as predicted by the in silico method. we detected a tri-allelic snp several bp away from snp site in the only failed assay of c4h gene, namely c4h <dig>  out of  <dig> validated snps in cad gene, four snps were polymorphic and one was monomorphic in consistent with the results from in silico method. only  <dig> out of  <dig> snps predicted by in vitro method were polymorphic. out of  <dig> successfully assayed and validated snps in both genes, the accuracy of in silico and in vitro method was 100% and 44%, respectively.


when comparing both methods, we observed two snp haplotypes consisting of  <dig> snps within  <dig> bp region in the cad gene sequence of parent aa <dig> . using the in vitro method,  <dig> out of  <dig> sequenced clones were found to contain haplotype  <dig>  however, haplotype  <dig> was not noticeable as there are many sequencing errors in the multiple sequence alignment. our observation that some  <dig> bp short reads spanned two to three snps confirmed the presence of this haplotype. another important finding was six out of twelve snps in haplotype  <dig> were non-synonymous snps, which resulted in a change in  <dig> amino acid sequences.

to determine the snps filtering stringency, we checked the snp score for the validated snps including the snps from the haplotype. we found that the validated snp which contained the lowest snp score was a snp at position  <dig> of contig aa_c <dig>  . this snp has a snp score of  <dig>  maf of 8% and coverage of  <dig> reads when detected by bowtie/samtools. however, this snp was missed by bwa/samtools approach because it was not called by samtools, although most reads were mapped by bwa. based on these findings, we chose bowtie as the preferred mapping software and increased the filtering parameters to a minimum snp score cutoff of  <dig> and maf of 8% . after applying filter  <dig>  a total of  <dig>  snps from four parents were obtained. after submission to adt, a total of  <dig>  snps representing  <dig>  contigs had final design score of more than  <dig> .

validation of in silico snp detection approach
a set of  <dig> snps with different snp scores which ranged from  <dig> to  <dig>  were selected to validate the improved in silico snp detection approach . out of  <dig> snps,  <dig> assays were successful, giving an assay success rate of  <dig> %. despite a lower concentration of dna used  compared to the recommended concentration  <dig> ng/μl, 99% of the samples had a minimum call rate of 95%. the reproducibility rate of duplicated am <dig> samples based on successfully assayed snps was 100% after excluding missing data.


an overall conversion rate of  <dig> % was obtained.  <dig> snps out of  <dig> successfully assayed snps were polymorphic, where  <dig> and  <dig> snps were polymorphic in wd and fl population, respectively, while  <dig> snps were polymorphic in both populations. we also observed that 25% of the polymorphic snps in wd population can be transferred to fl population. out of the remaining  <dig> monomorphic snps,  <dig> snps were interspecific snps , while  <dig> snps were identified as snps from paralogous genes . we found a significant relationship between snp score and validation rate as expected  and a correlation of  <dig> . generally, snp validation rate for each parent increased as the minimum snp score threshold increased, except individual am <dig> .

next, we compared the successfully assayed snps to the snps detected from bwa alignments . since we did not validate a set of snps detected only from bwa alignments, we can only compare the accuracy of snps detected from both bwa and bowtie alignments. the validation rates of snps detected from both bwa and bowtie alignments ranged from 33%- <dig> %, which were much higher than the validation rate of snps detected from bowtie alignments alone. the highest validation rate was observed in individual aa <dig>  similar to the snp detection result from bowtie alignments . the sensitivity of bwa/samtools approach ranged from  <dig> % to 80% and the estimated false negative rate ranged from 20% to  <dig> %. an average of  <dig> % snps failed to be detected from bwa alignments despite a higher accuracy in snps detected from both bwa and bowtie alignments.


factors influencing assay failure in illumina goldengate assay
to determine whether the snp final design score influences assay failure, we checked the final design score of all failed assays which ranged from  <dig>  to  <dig> . we found that the design score of failed assays and successful assays were not significantly different using t-test . out of  <dig> working assays,  <dig> snps  had design scores in the range of  <dig>  to  <dig> . chisquare test indicated that there is no significant difference  in assay success rates between snps with final design score of  <dig> - <dig>  and more than  <dig> .

to investigate how exon-intron boundaries can affect assay failure, we predicted the exon-intron boundaries in the acacia contigs based on homologous m. truncatula genes. when the contigs were searched against m. truncatula genome  using blastn in phytozome v <dig>  <cit> , we observed that the acacia contigs mapped to m. truncatula genome in four ways: a) acacia contig mapped to highly homologous genes in m. truncatula genome ; b) acacia contig mapped to two genes that were adjacent to each other in m. truncatula genome ; c) acacia contig mapped to the intronic region of its homologous gene in m. truncatula genome ; d) acacia contig mapped to the untranslated region of m. truncatula gene . further analysis of acacia contigs that mapped to m. truncatula revealed that observations in case b occurred due to the different genome versions used in phytozome and the present study. in the latest version that mt <dig>  used in the present study, the two m. truncatula genes were annotated as a single gene, thus matching the acacia contig alignment.


using this method, we were able to map  <dig> out of  <dig> contigs from  <dig> validated snps to m. truncatula genome to predict exon-intron boundaries. out of ten failed assays, we found five snps with predicted exon-intron boundaries located at 3- <dig> bp away from snp site. however, not all of the snp assays containing predicted exon-intron boundaries in the flanking region were failed assays. out of  <dig> successful assays, there are seven snps contained predicted exon-intron boundaries that were 10– <dig> bp away from snp. the presence of predicted exon-intron boundaries and distance of exon-intron boundaries from snp site did not seem to determine assay failure. to identify the difference between these two groups of assays carrying predicted exon-intron boundaries, we analyzed the flanking region of all  <dig> snps with predicted exon-intron boundaries. by mapping the oligonucleotide sequences  obtained from the opa manifest file to the snp flanking region, we found that the oligonucleotide binding sites were usually located about 19– <dig> bp upstream and downstream of the snp. out of five failed snps, the predicted exon-intron boundaries of three snps, namely aa_scaffold3620_ <dig>  aa_c434534_ <dig> and aa_scaffold17986_ <dig> were located on the oligonucleotide binding sites while the rest contained predicted exon-intron boundaries outside the oligonucleotide binding sites . in the seven successfully assayed snps, six snps contained the predicted exon-intron boundary outside oligonucleotide binding sites while the predicted exon-intron boundaries of one snp fell between the last and second last nucleotide of lso binding site . generally, predicted exon-intron boundary was located within oligonucleotide binding sites in the majority of failed assays and located outside oligonucleotide binding sites in the majority of successfully assayed snps.


we also found that the presence of secondary snps could be the cause of assay failure in two failed assays, namely aa_c431554_ <dig> and aa_c444244_ <dig>  a snp was detected by bwa/samtools approach in the lso binding site of aa_c431554_ <dig> . based on the clustering profile of aa_c444244_ <dig>  all a. mangium genotypes failed to be called due to low signal intensities , suggesting the presence of a secondary snp in a. mangium sequence caused the failure of aso carrying the allele a for a. mangium to bind to the snp site. since all a. auriculiformis samples were homozygous for b allele, all acacia hybrids were heterozygous, carrying one allele from each parent . the lower intensity of heterozygous cluster and compression towards the bb cluster is reflected by the presence of secondary snp.

the flanking regions of the remaining three failed assays did not contain predicted exon-intron boundaries or secondary snps. however, we found that the genes from two failed snp assays, namely aa_c431554_ <dig> and aa_scaffold6698_ <dig> shared 80-90% similarity with other contigs found in the transcriptomes. this suggested that assay failure might be associated with paralogous genes. in summary, we found no association between assay failure and design score. half of the assay failures were associated with exon-intron boundaries while the rest might be caused by the presence of secondary snps and paralogous genes.

 <dig> snps genotyping
based on the findings in 96-plex validation and analysis of assay failure, we applied more stringent filtering in the snp detection approach by increasing snp score cutoff and removing genes with exon-intron boundaries and paralogous genes more than 90% similarity . filtering of snp score  <dig> and  <dig> resulted in  <dig>  and  <dig>  snps in aa <dig> and am <dig>  respectively. we selected these snp score cutoffs to give a good tradeoff between reasonable polymorphism rate and number of snps as we would like to select snps that represent as many genes/contigs as possible. out of  <dig>  contigs in aarefseq,  <dig>  contigs mapped to m. truncatula genes using blastn. further  <dig> and  <dig> snps were removed from aa <dig> and am <dig> snps dataset due to presence of predicted exon-intron boundaries within  <dig> bp upstream and downstream of snp site. contigs with predicted paralogous genes were removed before the final selection of snps. the final selection of  <dig> snps contained  <dig> contigs with  <dig> contigs  mapped to m. truncatula genome. the mean snp score for aa <dig> and am <dig> excluding snps from 96-plex validation was  <dig> and  <dig>  respectively.

in  <dig> snps genotyping ,  <dig> snps from both opas contained gentrain score less than  <dig>  but most were increased to more than  <dig>  after manual adjustment. out of  <dig> snp assays,  <dig> assays  were converted to working assays . there were a total of  <dig> failed assays in which  <dig> snps  had no hit to the m. truncatula genome. out of  <dig> monomorphic snps, we observed about  <dig> interspecific snps  and  <dig> snps displaying only ab genotypes. the clustering profiles of all interspecific snps except two experienced moderate to severe cluster compression. although the success rate of  <dig> × 384-plex assay is higher than 96-plex assay, we found no significant difference between these two assays when tested using z-test .


*na = not available.

an overall conversion rate of  <dig> % was obtained for  <dig> snps genotyping. a total of  <dig> % samples had an average call rate of at least 95%. the conversion rate for wd was  <dig> % and lower conversion rate for fl was observed , as expected. when the validated snps from 96-plex were excluded, the conversion rate was reduced to  <dig> % and validation rate of  <dig> % was obtained. out of  <dig> polymorphic snps detected in wd population,  <dig> snps were polymorphic in fl population and thus, the snps transferability rate to other mapping population was  <dig> %. in both  <dig> and  <dig> snps genotyping, we found a total of  <dig> and  <dig> polymorphic snps in the a. auriculiformis and a. mangium natural germplasms which represented  <dig> % and  <dig> %, respectively, out of the total snps . snps with maf of at least  <dig>  represented  <dig> % and  <dig> % of the total polymorphic snps in the natural germplams .


*polymorphic snps from 96-plex also present in  <dig> x 384-plex.

reproducibility of illumina goldengate assay
we also assessed the reliability of illumina goldengate assay by looking at the reproducibility of genotype calling. we found that the reproducibility of clustering profiles among two mapping populations was very high. only  <dig> out of  <dig> polymorphic snps  shared in both populations displayed different clustering profiles . all four which were female markers had different positions of heterozygous cluster between populations.


next, we examined the clustering patterns of the  <dig> snps genotyped in both 96-plex and 384-plex assays. out of these, two snps initially thought to be polymorphic in 96-plex assay were identified as interspecific snps in 384-plex assay based on mendelian inheritance and manual clustering. we found that the clustering patterns of  <dig> snps  were not reproducible and additional manual clustering was required ; 62% of the snps  suffered lower norm r signal intensities in 384-plex compared to 96-plex assay. we observed that there were shifts of heterozygous clusters, which ranged from  <dig>  to  <dig>  along the x-axis. in snp aa_c444244_ <dig>  the homozygous and heterozygous clusters were indistinguishable in 384-plex genotyping compared to 96-plex genotyping . in another example, manual clustering based on mendelian inheritance was used to identify the heterozygous cluster aa_scaffold17708_ <dig> .

we hypothesized that snps originating from the same gene are under the same influence of paralogous genes in the genome and thus, they should display the same clustering patterns based on three assumptions: 1) assay conditions are the same; 2) interaction with other assays are negligible; 3) different regions of the gene are influenced by paralogous genes in the same way. the only difference in these snps from the same gene was their flanking region sequence. to test our hypothesis, we compared the clustering profiles of  <dig> pairs of snps from the same gene from wd population . out of  <dig> genes, five genes were removed from further analysis due to either sequence variation in flanking region or failed assay in either one aso. out of  <dig> examined genes, three genes did not display cluster compression. a total of  <dig> genes displayed the same degree of cluster compression in both snps. the remaining genes  showed varying degree of cluster compression in both snps . in addition, we observed several strange features in the clustering profile such as two sub-clusters within heterozygous cluster and heterozygous clusters located on  <dig>  coordinate along x-axis .

discussion
we have successfully developed high-throughput snp assays for a. auriculiformis x a. mangium hybrids using illumina goldengate assay. the sensitivity of our in silico snp detection approach was evaluated by comparison of validated snps detected using in vitro approach, selection of the most sensitive snp detection tool and  <dig> snps validation. the assessment of assay failure has enabled us to identify exon-intron boundaries as the main cause and subsequently reduce this problem by using m. truncatula as reference genome. we further analyzed the clustering patterns and reproducibility of illumina goldengate assay to determine if the assay is suitable for a non-model species like acacia. we have obtained snp resources for linkage map construction, hybrid discrimination and genetic diversity studies of a. auriculiformis and a. mangium.

in silico snp detection
it is common to use more than one snp prediction method in in silico snp detection when using next generation sequencing . the comparison of in silico and in vitro snp detection has led us to choose bowtie over bwa as the default short read mapping tool. bowtie has the advantage of providing fast mapping, allowing two mismatches and perform ungapped alignments. the high false negative rate observed in bwa/samtools can be explained by lower number of mapped reads and thus fewer snps were detected. our observation that bowtie can map more reads and detect more snps compared to bwa is similar to another study  <cit>  showing that bowtie can map 25% more snps compared to maq, which is a replacement for bwa. the observation that most reads were mapped to the snp site but the snp was not called by samtools is probably due to low quality scores of the reads. the low sensitivity of bwa/samtools method can cause the loss of valuable snps, which may affect the assay success rate. since our primary objective is to develop snps for linkage mapping purpose, it is important to detect snps from a large set of genes that can be selected for good genome coverage.

the validation of  <dig> snps has provided important insights into the data quality of each dataset and sensitivity of our snp detection approach. the observation that higher number of reads gives higher validation rate suggests that higher sequence coverage increases snp accuracy. the good correlation between snp score and validation rate showed that a higher snp score stringency can be used to increase the validation rate. initially, our study was designed to detect snps within both wd and fl populations. the poor sequence data of individual am <dig> as indicated by the low validation rate makes it unsuitable for snp detection. due to the good snp transferability rate to fl population, we decided to design high-throughput snp assay from wd population. the improved snp detection approach increased the assay conversion rate from  <dig> % in 96-plex to  <dig> % in  <dig> snps genotyping. the improved conversion rate is higher than the rate observed in european hake  <cit>  and similar to other studies  <cit> . this rate is within the range of 60-70% observed in forest species . the conversion rate in acacia is largely determined by the validation rate, as the assay success rate is very high.

the validation rate reported in this study is lower than other studies such as soybean  <cit> , sorghum  <cit>  and alfalfa  <cit>  can be caused by several factors such as the use of de novo transcriptome assemblies as reference, mapping of single-end reads, low sequence coverage and presence of paralogous genes. we think that the presence of paralogous genes is the main contributor. observation that  <dig> monomorphic snps exhibited ab genotype and almost all interspecific snps showed cluster compression in  <dig> snps genotyping suggests that 60% of monomorphic snps were also under the influence of paralogous genes. paralogous genes can lead to false snp detection by affecting fluorescence signal when the oligonucleotides were amplified in multiple locations with highly similar sequence in the genome. paralogous genes are one big problem for acacia because genome sequences are not available and the extent of genome duplication is unknown. if paralogous genes affect the detection of polymorphic snps, more stringent filtering will not improve validation rate. to overcome this problem in non-model species, some studies either use single copy genes   <cit>  or remove genes that shared more than 90% sequence similarity  <cit> . although our proposed methods were able to detect more paralogous genes by using a reference genome like m. truncatula, using transcriptome data alone is insufficient due to incomplete sequencing and failure to capture all paralogous genes in the genome. one possible solution is to identify paralogs within the transcriptome data using statistical methods such as qualitysnp  <cit> . since all the samples were subjected to only one lane sequencing, low sequence coverage might be a problem as a redundancy of  <dig> reads were required to detect heterozygous snps  <cit> . with the improvement of sequence coverage, sequence quality and mapping algorithms, in silico snp detection will become increasingly reliable in the future.

factors affecting assay failure in illumina goldengate assay
in this study, we obtained high assay success rate for acacia, similar to both model and non-model species such as barley  <cit> , soybean  <cit> , pea  <cit> , common bean  <cit> , cassava  <cit> , potato  <cit> , tetraploid wheat  <cit>  and eucalyptus grandis <cit> . the smaller genome size in acacia may explain the higher assay success rate compared to other forest species  <cit> . according to illumina, the likelihood of a snp to be converted into a successful assay depends on the final snp design score given by adt and a minimum score of  <dig>  is recommended. however, we found no correlation between design score and assay success rate. this observation is consistent with some studies  <cit>  but contradictory to other studies  <cit> . another study reported that there is no significant relationship between the design score and gencall score, suggesting that the design score does not influence the quality of cluster separation  <cit> . based on these results, we recommend using snps with design score of at least  <dig>  for snp genotyping in acacia.

our observation that half of the failed snps contained predicted exon-intron boundaries is similar to results from anithakumari et al. study  <cit> . we predicted that only exon-intron boundaries located on oligonucleotide binding sites can cause assay failure. our exon-intron boundary prediction is accurate considering that we were able to explain the difference between failed and successful assays containing exon-intron boundaries. exon-intron boundary is a major concern for snps detected from ests or transcriptome data of non-model species. since the flanking region is given in the gene coding region while genotyping were carried out using genomic dna, the oligonucleotides will not be able to bind if an intron occurs within the flanking region. according to the zhang et al. study  <cit> , sequencing of est amplicons revealed the presence of introns in 38% of the ests in oyster. to overcome the lack of genome sequence, many studies used reference genome from a related species . these studies utilized either a webserver  <cit>  or custom scripts to predict the exon-intron boundaries. the limitation of exon-intron boundaries prediction using a reference genome is that its success depends on the conservation between the two genomes. furthermore, exon-intron boundaries cannot be predicted for genes that are not found in the reference genome possibly due to gene loss and pseudogenes that occurred over the evolutionary history.

we found evidences that secondary snps may be responsible for a small proportion of failed assays. we predicted that presence of secondary snps can result in assay failure in two ways if a secondary snp occurs in either one aso: 1) in a testcross snp, presence of secondary snps in the binding site of either one aso will result in assay failure in half of the samples carrying that allele; 2) assay failure of all samples in the homozygote cluster of one allele and compression of heterozygous cluster toward homozygous cluster of the other allele. according to tindall et al. study  <cit> , the latter case can also occur due to presence of outliers and resulted in incorrectly genotyped samples. presence of secondary snp in flanking region can be a severe problem especially in the genotyping of highly heterozygous and outcrossing plants. however, the snp frequencies in a. auriculiformis and a. mangium <cit>  are much lower compared to many plant species  <cit> . therefore, presence of secondary snps in successfully assayed snps is not a major concern because all the genotypes can be easily differentiated and can be used for linkage mapping.

clustering and reproducibility of illumina goldengate assay
to our knowledge, no other study has reported the reproducibility of clustering patterns although reproducibility of genotype calling was widely studied. our observation that genotype calling is highly reproducible is consistent with results from another study  <cit> . however, high reproducibility of genotype calling does not necessarily mean high reproducibility of clustering patterns. our results showed that the clustering profiles of almost one third of the snps shared between 96-plex and 384-plex assays are not reproducible, suggesting that manual clustering is needed for accurate genotype calling. the lower than expected reproducibility might be due to increased number of snps in the assay and interactions with other oligonucleotides within the assays. our report that different clustering patterns observed in different mapping population was similar to hyten et al. study  <cit> . since reproducibility of clustering profiles between two mapping population is very high, manual clustering for each population is not required. another important finding is the clustering patterns of snps from the same gene can vary greatly, suggesting that the flanking region of the snp besides paralogous genes plays an important role in determining the clustering patterns. this finding supported the results from wang et al.  <cit>  who found that the quality of flanking region is very important.

manual adjustment of clusters for custom illumina goldengate assay is often required for non-model species because the automated calling which was optimized for human genome can be unreliable. in addition, a feasible size of  <dig> samples is recommended for clustering to maximize statistical significance. gencall software calls genotypes based on the assumption that there are three clusters in diploid organisms  <cit> . even in verified human snps, tindall et al.  <cit>  provided evidence that gencall software cannot cluster some snps accurately . based on our experience, we found that the inclusion of samples from natural germplasm is very helpful in the identification of all three clusters especially when the snps were segregating in the mapping populations following testcross configuration. most studies performed manual cluster adjustment using two common approaches, namely hardy-weinberg equilibrium for natural germplasms and mendelian inheritance for mapping populations. some other studies overcome this problem by using customized methods . as manual inspection and definition of assay failure varies greatly among studies, assay success rates among studies are generally not comparable. stringent manual clustering and calling assay failure will result in significant loss of marker information. like other studies  <cit> , we strongly recommend manual clustering for each snp especially during initial snp assay setup although it can be time-consuming for large number of snps. since manual clustering is very subjective, several revisions of manual inspection may be required before the final clustering patterns can be decided.

snps transferability to other populations
in this study, we found that the transferability of polymorphic snps detected in the parents of one mapping population to other mapping population and natural germplasms is similar to the study previously reported in grapevine  <cit> . although the number of polymorphic snps in fl population is insufficient for a dense linkage map construction, these snps provide important markers to allow comparison and integration of linkage maps in the future. snps with maf at least  <dig>  is considered common and useful in the evaluation of natural germplasms. as the parents originated from natural populations, more snps are expected to be transferable to natural germplasms when screened with larger amount of samples. the polymorphic snps detected here should be viewed with caution because it is based on small sampling size and therefore, subjected to clustering errors. to study the genetic diversity of both species using these markers in the future, manual clustering must be performed carefully and evaluation based on hardy-weinberg equilibrium must be carried out.

CONCLUSIONS
we have discovered large amount of snp markers in the transcriptomes of a. auriculiformis and a. mangium. we have successfully developed high-throughput snp genotyping assay in a. auriculiformis × a. mangium hybrids where most snps were converted to successful assays. illumina goldengate snp genotyping together with manual clustering can provide high quality genotypes for a non-model species like acacia. the snp genotyping assay has generated sufficient markers for linkage map construction of acacia hybrid. the use of reference genome from the most closely related species will allow us to perform comparative genomics in the future. the identification of interspecific snps will be useful for genetic mapping of f <dig> or backcross populations, clone and hybrid discrimination. good transferability rate to natural germplasms will allow genetic diversity assessment of a. auriculiformis and a. mangium.

materials and methods
plant materials
plant materials were obtained from two a. auriculiformis × a. mangium f <dig> mapping populations, namely wood density  and fiber length  population. the wd and fl population were full sib crosses from aa <dig> × am <dig> and aa <dig> × am <dig>  respectively. samples from four parents were collected from forest research institute malaysia , kepong, while the progenies of both mapping populations were sampled from frim station in segamat, johor and borneo tree seed and seedling sdn. bhd. in bintulu, sarawak. the natural germplasms of a. auriculiformis and a. mangium were sampled from the field plot in universiti kebangsaan malaysia . these samples originated from ten populations of a. auriculiformis  and a. mangium  which were used in sukganah  <dig> study  <cit> .

sample preparation for transcriptome sequencing
the sampling of plant tissues, namely young stem and inner bark tissues, and rna extraction were carried out for aa <dig> and am <dig> using the same method as described in the wong et al. study  <cit> . instead of using the pooled total rna for transcriptome sequencing as in aa <dig> and am <dig>  first strand cdna samples were synthesized from the total rna samples of aa <dig> and am <dig> using clonetech smart cdna synthesis kit  and second strand cdna synthesis was carried out using clonetech pcr kit . the cdna samples were normalized using evrogen trimmer cdna normalization kit  before sending to the genepool  for sequencing service. paired-end sequencing was carried on one lane of flow cell on illumina gaii for each sample. the short reads were filtered for smart adaptors. the unfiltered sequences of aa <dig>  am <dig>  aa <dig> and am <dig> in fastq format are available in ncbi sequence read achieve .

dna extraction
genomic dna extraction of leaf tissues was carried out using qiagen tissuelyser ii and dneasy plant mini kit. the quantity and quality of the dna samples were assessed using nanodrop nd- <dig> spectrophotometer  and quant-i picogreen assay  on varioskan flash multimode reader . the dna samples were diluted to a final concentration of 20- <dig> ng/μl using te buffer. the dna samples were sent to international rice research institute  where snp genotyping using illumina goldengate assay on illumina beadxpress machine was performed.

snp detection and illumina goldengate assay design
reference sequences were selected from the de novo transcriptome assemblies of aa <dig> and am <dig>  due to better length and sequencing coverage. each reference sequence must be present in both assemblies to ensure high sequence confidence in assay design of acacia hybrid but only the contig with the longest length in either assembly was chosen. first, we used mummer nucmer  <cit>  to detect orthologous sequences between the two assemblies. orthologous sequences with at least  <dig> bp and shared more than 90% similarity in nucleotide level were identified. the longest sequences were extracted using a python script . the selected sequences were labelled with prefix “aa” or “am” indicating what assemblies they originated from, followed by a “_” and suffix carrying the scaffold or contig number. the reference sequences were subsequently known as aarefseq .

the filtered reads from each parent were mapped separately to aarefseq using bowtie- <dig> . <dig>  <cit>  and bwa- <dig> . <dig>  <cit>  with default setting in single end mode. snps from the alignments were called using samtools- <dig> . <dig>  <cit>  and output in pileup format. samtools assigned a snp quality score  to evaluate the reliability of snp calling based on phred-scaled probability that the consensus is identical to the reference. in this study, the allele from the reference sequence is known as reference allele while major allele is the most frequent allele present in the individual. the reference allele is not necessarily the major allele as the de novo assembler randomly chooses an allele when encounters a snp or sequencing error. the frequency of reference allele, non-reference allele, minor allele and major allele were calculated and added to the pileup files using a python script . putative snps were extracted from the pileup files using the following parameters with awk one-liner scripts: 1) mapping and snp score more than 20; 2) snps must be covered by at least  <dig> reads; 3) at least three non-reference alleles are present; 4) snps must be bi-allelic; 5) minor allele frequency  must be at least 5%; 6) total frequency of major and minor allele must be at least  <dig> . the total number of snps for all four individuals was calculated based on the total sum of snps from all four individuals minus the number of snps present in at least two individuals.

the fasta sequences of aarefseq were converted to pileup format using a python script . a consensus sequence for each parent in pileup format was produced using awk one-liner scripts by: 1) replacing reference sequence with filtered snps; 2) replacing consensus sequence with non-reference allele if reference allele was not present; 3) coding region with no read as n; 4) masking tri-allelic snps resulted from paralogous genes or sequencing errors as n; 5) correcting reference sequence for any sequencing error resulted from de novo transcriptome assembly. all the snps within both mapping populations were taken into consideration to allow cross amplification between populations. therefore, the consensus sequence files from all four parents were combined into one file and a final consensus sequence was called using a python script . besides calling consensus, the script also masked all bi-, tri- and quad-allelic snps in the file with iupac code.

to design custom illumina goldengate assay, the flanking region of the snp with a minimum of  <dig> bp upstream and  <dig> bp downstream sequence was required. the numbers of secondary snps, interspecific snps and ns within the flanking region for each snp were calculated from the final consensus sequences using a custom python script . we then extracted a minimum of  <dig> bp flanking region and removed any snp with more than  <dig> ambiguous codes  in the flanking region. the snps were labelled with a prefix of the aarefseq sequence, followed by an “_” and suffix of snp position within the scaffold or contig. the flanking sequences were saved in csv format using a python script  and submitted to assay design tool   <cit> . any snp with final illumina design score less than  <dig>  were removed.

comparison of in vitro and in silico method
in vitro snps were identified from cinammate 4hydroxylase  and cinnamyl alcohol dehydrogenase  genes by sequencing  <dig> to  <dig> cdna clones for each of the four parents  <cit> . these in vitro snps were validated using illumina goldengate assay in the natural germplasms  <cit> . the sequences of c4h and cad genes from de novo transcriptome assemblies were aligned to full length acacia hybrid cdna sequence  using ncbi blastn blast2sequences to identify shared regions. the flanking sequences of validated in vitro snps were aligned against the genomic sequence of c4h and cad  and any snp flanking region located outside the exonic region was removed. the  <dig> bp flanking sequences of the validated snps in these two genes  were aligned against the shared coding regions. all the snps located in the shared region were identified from the modified pileup file for each parent. the successfully genotyped, polymorphic snps and monomorphic snps from the validated snps were compared to the snps identified from in vitro and in silico approach. based on these findings, the stringency of the snp detection approach was increased by removing snps with snp score less than  <dig> and maf less than 8%.

 <dig> snps validation
to evaluate the effect of snp score on the snp detection accuracy, a total of  <dig> snps with different snp scores ranged from 50- <dig> were selected randomly . of these,  <dig> snps shared by both a. auriculiformis parents ,  <dig> snps shared by both a. mangium parents  and  <dig> snps for each parent were selected. a total of  <dig> snps were predicted to be polymorphic for each parent. only testcross snps that were heterozygous in either one parent and segregating in the mapping population in ratio 1: <dig> were used in snp genotyping. the snps validation was performed on  <dig> dna samples using illumina goldengate assay on an illumina beadxpress platform according to manufacturer’s protocol. the samples consisted of four parents,  <dig> progenies for each mapping population, 21- <dig> individuals each for a. auriculiformis and a. mangium natural germplasms . to assess the reproducibility of the genotyping assay, dna samples from parent am <dig> were duplicated.


genotype calling was done using genomestudio genotyping module version  <dig> . <dig> with a minimum gencall threshold of  <dig> . the clustering of each snp was adjusted manually by visual inspection. an assay was defined as failed assay if most of the intensities were lower than  <dig>  and more than half of the genotypes from one mapping population cannot be called. a snp was considered monomorphic if the parents shared the same homozygous genotype. an interspecific snp that did not segregate in the mapping population because both parents were homozygous for one allele  was considered a monomorphic snp in this study. a snp was polymorphic if at least one parent was heterozygous and the snp was segregating in the mapping population following testcross  or intercross  configuration. mendelian inheritance in the mapping population and reproducibility within parent replicates were checked using heritability and reproducibility error function.

the assay success rate was calculated based on the number of successful assays divided by total number of assays while the conversion rate was calculated based on number of polymorphic snps divided by total number of assays. validation rate of the snps was calculated using the number of polymorphic snps divided by the number of successful assays. we also checked the significance and correlation between: 1) snp design score and assay success rate; 2) validation rate and snp score, using t-test and correlation test in microsoft excel. for comparison of snps detected from bowtie and bwa alignments, the successfully validated snps were compared to putative snps detected by bwa. the validation rate was calculated based on the number of true snps also detected by bwa divided by the total number of snps also detected by bwa. the sensitivity of combined bowtie and bwa approach was estimated by dividing the number of true snps detected from bwa alignments over the total number of true snps while the false negative rate is  <dig> minus sensitivity.

exon-intron boundary and paralogous genes prediction
genome sequences, gene annotation and imgag files of medicago truncatula version  <dig>   were downloaded from m. truncatula genome project website . for exon-intron boundary prediction, the start and stop position of each exon for each gene in m. truncatula genome was first extracted from imgag file and the length of each exon was calculated using an awk script. the acacia contigs were searched against m. truncatula full length transcripts using local ncbi blast- <dig> .25+ blastn algorithm  and the results were output in both tab-delimited and xml formats. the xml blastn results were simplified by extracting only useful columns with a custom python script . the best hit of m. truncatula full length transcripts for each acacia contig based on the smallest e-value was extracted from both tab-delimited and simplified xml blastn results.

a custom python script  was designed to identify potential exon-intron boundaries in acacia contigs by performing the following tasks: a) obtain exon-intron boundary positions of the best hit m. truncatula transcript from extracted imgag file; b) predict the exon-intron boundary positions in acacia contigs using alignments from extracted xml file; c) report snps that contain predicted exon-intron boundaries in  <dig> bp upstream and downstream of snp site. the reported snps were removed from filtered snp dataset of aa <dig> and am <dig> using an awk one-liner script. known paralogous genes were identified by searching the contigs against other contigs in the transcriptomes using local ncbi blast- <dig> .25+ blastn algorithm . any snp from a gene that shared more than 90% similarity in nucleotide level with another gene was removed. in addition, we also predicted paralogous genes by searching the contigs against the m. truncatula genes using the same method. two or more contigs that map to the same m. truncatula genes were predicted as paralogous genes or fragmented contigs. any contig that map to multiple m. truncatula gene transcripts are potential paralogous genes.

 <dig> snps genotyping
based on 96-plex validation results, more stringent filterings were applied to aa <dig> and am <dig> snp dataset using awk script.  <dig> snps were selected for snp genotyping as part of linkage map construction. the snps with predicted exon-intron boundaries and known or predicted paralogous genes  were excluded. a flowchart summarizing the snp detection approach for aa <dig> and am <dig> is shown in figure  <dig> 


a set of  <dig> validated snps from 96-plex validation and  <dig> snp from caffeoyl coa 3-o-methyltransferase  gene were included. snps from ccoaomt were detected using the same methods except the gene sequence of ccoaomt <dig>  which was not included in aarefseq was used as reference. the snps were designed in two 384-plex oligonucleotide pooled assays , namely aaopa and amopa. any two snps from the same gene or located less than  <dig> bp away were placed in separate opa. all the snps in amopa were markers from am <dig> while aaopa contained mainly snps from aa <dig> and a small proportion snps from am <dig> .

the snps genotyping was carried out on  <dig> dna samples  using illumina goldengate assay on illumina beadxpress machine. each parent was genotyped in duplicates and each replicate was placed in separate 96-well plates to detect interplate variation. genotype calling was carried out as described for 96-plex genotyping. outliers were identified when call rate was plotted against p <dig> gc. after excluding outliers, the number of samples with at least 95% call rate was calculated based on the total number of polymorphic snps. the separation patterns or clusters of each snp were inspected separately for each mapping population and natural germplasm. a snp was considered polymorphic in the natural germplasm if at least one out of six individuals carries a different genotype. maf for each snp of each natural germplasm was calculated based on the number of minor alleles divided by total number of alleles.

competing interests
the authors declared that they have no competing interests.

authors’ contributions
mw prepared the samples, designed the experiment, analyzed the data and drafted the manuscript. wr and cc conceived the study, participated in the design and coordination of the study. all the authors read and approved the final manuscript.

supplementary material
additional file 1
clustering profiles of  <dig> snps in 96-plex and 384-plex genotyping. this word document file contains a table showing the clustering profiles of  <dig> snps. the clustering profiles in 96-plex and 384-plex genotyping are shown side-by-side to indicate the reproducibility of illumina goldengate assay.

click here for file

 additional file 2
clustering profiles of snps from  <dig> genes in  <dig> snps genotyping. this word document file contains a table showing the clustering profiles of  <dig> genes. the clustering profiles of the two snps from the same gene are shown side-by-side.

click here for file

 additional file 3
python scripts used in snp detection. this compressed file in tar.gz format contains six python scripts used in snp detection. the title of each script is the same as the title that appeared in the text.

click here for file

 additional file 4
reference sequences used in snp detection. this compressed file in tar.gz format contains a fasta file of aarefseq .

click here for file

 additional file 5
a snp summary of  <dig> snps validation and  <dig> snps genotyping. this excel file contains three sheets, namely “96plex”, “aaopa3” and “amopa3”. each sheet contains snp information of dbsnp id, snp contig and position, design score, snp score, homologous genes in mt <dig> , assay success, polymorphism, mapping population, minor allele frequency in a. auriculiformis and a. mangium natural germplasms. description of each column can be found on the right in sheet “96plex”. 

click here for file

 acknowledgements
we would like to acknowledge forest research institute malaysia  and borneo tree seeds and seedlings sdn bhd.  for samples collection, the genepool for providing sequencing service, ukm medical molecular biology institute  in providing facility for fluorescent microplate reader. we would like to thank dr. mike thomson and his team from international rice research institute  for providing snp genotyping service. the help from zhang di for writing and improving some of the python scripts is greatly appreciated. this project was funded under the grant 02-01-02-sf <dig> from ministry of science, technology and innovation  and ukm-ap-bpb-13- <dig> from universiti kebangsaan malaysia .
