BACKGROUND
genetic resources stored in gene banks are usually sampled with the purpose of evaluating and utilizing them efficiently, as well as studying phenotypic and genotypic diversity, identifying duplicate accessions, and forming core subsets. the aim of the latter activity is to preserve in the sample as much of the diversity present in the original collection as possible. core subset selection can be based on varying criteria including phenotypic traits or various forms of molecular marker data including, but not limited to, single nucleotide polymorphisms , amplified fragment length polymorphisms , random amplified polymorphic dna , and simple sequence repeats . a simple example considering snp data is given in figure  <dig>  the concept of core collections  was introduced to increase the efficiency of characterizing and utilizing the collections stored in gene banks while preserving the genetic diversity of the collection  <cit> .

in many instances, gene bank curators and genetic resource conservation managers need to stratify their sampling procedure prior to forming a core subset. the criteria for stratifying samples may be based on ecogeographical sub-regions or on genetic considerations such as races and/or land-races. standard stratified sampling strategies seek to maximize the diversity among clusters while minimizing the diversity within groups. hierarchical clustering algorithms along with statistical models that maximize the probability of assigning accessions into each cluster have been used for this purpose  <cit> . once clusters are formed, an appropriate allocation method should be used to determine the number of accessions to be drawn from each cluster.

using phenotypic evaluation and characterization data, the d-method was developed as an allocation criterion for determining the number of accessions to be drawn from each cluster  <cit> . the d allocation method determines that the size of the sample to be drawn from each cluster should be proportional to the diversity between accessions within that cluster. the authors showed that the d-method produced samples with significantly more diversity than other allocation methods. in another study, the d-method was used, along with other sampling strategies, for forming core subsets of maize using molecular marker data  <cit> . the results showed that the unweighted pair-group method using arithmetic average clustering   <cit>  with the d allocation method produced core subsets with significantly more diversity than other methods in terms of genetic distances and diversity indices. another study, not using the d-method, showed similar results when using deviation sampling with the unweighted pair-group average method for hierarchical clustering  <cit> .

although the stratified sampling strategy using the d-method proved to be efficient for forming diverse core subsets, these can be formed by a non stratified procedure in which accessions are directly selected from the entire collection by maximizing an objective function. in  <cit> , schoen and brown addressed the issue of how to use genetic markers to sample collections of wild related species while maximizing allelic richness. they proposed the m  strategy that maximizes the number of observed alleles at each marker locus. a study using computer simulation for comparing the retention of neutral alleles when forming core collections using non marker-based random sampling and stratified random sampling strategies versus the m strategy using genetic markers, found the m-strategy very effective for retaining widespread and low frequency alleles  <cit> .

mstrat, a local search algorithm based on the m-strategy, has been proposed  <cit> . as described by the authors, mstrat uses a maximum iterative improvement search and consists of  forming a subset of n accessions chosen at random from the n accessions of the whole collection,  all possible subsets of size n -  <dig> are tested for allele diversity and the subset showing the highest level of richness is retained, and  the accession bringing the greatest increment in the diversity criterion among the remnant accessions is added, forming an new subset of size n. steps  and  are repeated until the richness of the subset is no longer improved. the diversity of the core subsets formed is measured using a score of allele richness.

the objectives of mstrat differ from those of the d-method. it has been suggested that core subsets can be formed that either include rare and localized alleles, which will maximize the total allelic diversity in the core , or can be constructed by including widely adapted accessions that maximize the representativeness of the genetic diversity in the core   <cit> . the objective of the d-method is to select the most diverse accessions in terms of genetic distances among genotypes, whereas the m-strategy emphasizes selecting accessions with the most diverse alleles. this was confirmed in studies, using molecular marker data, which found that mstrat is very effective for retaining widespread and low frequency alleles and thus for forming core subsets with high allele richness and a low proportion of non-informative alleles  <cit> . furthermore, it was found that mstrat formed core subsets with more allelic diversity than the d-method in most populations  <cit> . in general, the d-method formed core subsets having higher average genetic distances between genotypes than mstrat.

recently, power core, a new algorithm also based on the m-strategy was proposed  <cit> . however, power core's algorithm differs significantly from existing ones. the authors proposed a deterministic heuristic search, based on the concepts of a* search  <cit>  – an exhaustive graph searching algorithm, guaranteed to find an optimal solution. as suggested by the authors, it would be infeasible to run a* search on even moderately sized problem instances , due to its exhaustive nature. therefore, the deterministic heuristic they propose is necessary to ensure power core terminates in a reasonable amount of time. although their algorithm is not guaranteed to find optimal solutions, it found core subsets that were superior to those found by mstrat, as defined by their proposed evaluation criteria of variable coverage: the ratio of unique values present in the core subset versus those found in the entire collection, averaged over all variables  <cit> .

other sampling procedures have been proposed such as genetic distance sampling  <cit> , which finds core subsets guaranteeing no two accessions are within a defined distance of each other. in this way, the user need not specify the core size; however, the choice of an appropriate value for the distance parameter can be as problematic as the selection of the core size itself. another iterative procedure, least distance stepwise sampling , was proposed which uses the distances and groupings from hierarchical clustering to determine which accessions to eliminate, and which to add in each step of the procedure until the desired core size has been attained  <cit> . while both methods employ the use of genetic distances during their heuristic sampling, neither attempts to directly optimize them.

a first objective of this paper is to demonstrate the effectiveness of formally treating core subset selection as an optimization problem. this entails first defining which characteristics of the core subset should be optimized. these may include the average genetic distance between accessions in the core subset, and/or its redundancy of particular alleles, amongst other criteria. even constraints on the core subset such as ensuring it does not contain two accessions within a threshold distance of each other, as guaranteed by genetic distance sampling, can be treated in a broader view as an optimization problem. we will show that once the criteria for the desired core subset is well defined, the selection can be effectively and efficiently handled by sophisticated search algorithms capable of finding as good or better core subsets when compared with existing methods.

despite incremental improvements to the challenge of selecting the best core subsets, most existing algorithms and methods currently address either allele representativeness  or allele richness . a second objective of this paper is to propose an algorithm capable of selecting core subsets having high average genetic distance between accessions or a rich genetic diversity overall, or a core subset that considers both criteria. a method for combining discrete molecular marker data and continuous genetic data for core subset selection has been previously proposed  <cit> . we generalize this notion in order to consider any number of optimization criteria simultaneously. in this paper we limit our focus to discrete molecular marker data, although the same approach could be extended to consider continuous genetic data.

we present core hunter, an algorithm based on an advanced stochastic local search method. results from the diversity of the core subsets selected by core hunter are compared with the diversity of the core subsets formed using the current state-of-the-art methods with an available implementation: d-method  <cit> , mstrat  <cit> , and power core  <cit> . we demonstrate that core hunter finds as good or better core subsets than other methods for all genetic measures evaluated when attempting to optimize a single genetic measure. furthermore, by attempting simultaneous optimization of multiple genetic measures, core hunter often finds core subsets that simultaneously have higher average genetic distance and genetic diversity values than any reported by the other algorithms evaluated. we also demonstrate that core hunter is able to find smaller core subsets which maintain all unique alleles found in a reference collection, than all other methods evaluated.

methods
to simplify the discussion that follows, we first formalize the core subset selection problem.

the core subset selection problem
let s denote the original collection of resources and γ,  <dig> ≤ γ ≤  <dig>  the sampling intensity used to form the core subset. furthermore, let c be the set of all possible core subsets of s of size n, n = γ·|s|. finally, let f be the objective function we wish to maximize. f may be a genetic diversity measure such as shannon's diversity index, an average genetic distance within a population, possibly measured by modified rogers distance, or some multi-objective function which we will detail next. formally, we wish to select an optimal core subset c*, c* ∈ c, such that f = max{f|c' ∈ c}.

the proposed pseudo-index for integrating genetic distances and diversity indices
an advantage of using search algorithms for core subset selection is the potential to select core subsets that attempt to optimize more than one criterion. as an example and given the above definition of core subset selection, let f = α·fdistance + fdiversity , where α,  <dig> ≤ α ≤  <dig>  is a weight associated with genetic distance. in this formulation, if α =  <dig> , then a core subset would be selected which attempts to maximize the average genetic distance, using modified roger's distance for example, while genetic diversity, possibly shannon's diversity index, would not be considered. likewise, one could attempt to maximize the genetic diversity by setting α =  <dig> . however, for the case of  <dig> <α <  <dig>  a core subset will be formed by attempting to maximize both genetic distance and diversity proportional to the weight assigned to α. this concept is easily generalized to incorporate any k measures as shown below, where fi ≥  <dig>   <dig> ≤ i ≤ k, and .

   

indeed, this is a common approach in multi-objective optimization referred to as pareto optimization  <cit> . we stress that the pseudo-index does not provide any biological insight into the chosen samples; rather, it serves only as a mean for attempting optimization of more than one genetic measures simultaneously, based on the weights assigned to standard measures. another common approach in multi-objective optimization is pareto ranking  <cit> , a technique not explored further here.

the core hunter algorithm for the proposed pseudo-index
the core hunter algorithm uses an advanced stochastic local search  algorithm, replica exchange monte carlo  <cit> , to maximize the pseudo-index we propose above. this search method has been effectively used to solve high dimensional search problems containing many local maxima embedded in rugged search terrains in many areas of study including spin glasses  <cit>  and protein folding  <cit> . given the high dimensionality of the core subset selection problem, and the vast number of possible core subsets, this was deemed as a necessary alternative to the use of simpler search methods, such as iterative improvement , which are more likely to become trapped in local maxmima due to their greedy nature. we now provide a brief overview of the algorithm. the reader is referred to a review of extended ensemble monte carlo algorithms  <cit>  for further details.

for each replica, monte carlo search initiates by randomly selecting n accessions from the reference set to form the initial solution, where n is the number of accessions desired in the core subset. the search proceeds by perturbing the current solution and exploring the so-called search neighborhood. in this application, our search neighborhood consists of all possible subsets that differ from our current solution, by at most one accession. thus, to evaluate a new potential solution found in the search neighborhood, we perturb the current core subset by randomly removing an accession and adding a new accession from the original collection. this is commonly referred to as a 1-exchange neighborhood. while it is trivial to extend this concept to a δ-exchange neighborhood, δ >  <dig>  it was deemed unnecessary given our results. note that when the core subset need not be of a specific size, it is possible that a perturbation remove an accession, but not add another, or vice versa, in order to shrink or grow the core subset. this is useful, for instance, when attempting to find the smallest core subset which contains all unique alleles of a collection. after perturbing a current solution  s to form an alternate core subset s', the so-called metropolis criterion is used to determine if the new core subset s' should be accepted. the probability of accepting s' as the new solution can be expressed as

   

where Δf := f - f is the difference in the pseudo-index score between the new  and old  solutions , and t denotes the temperature of the replica.

intuitively, a replica at a higher temperature is more likely to accept a bad transition, one where the new core subset has a worse score than the original. accepting bad transitions to core subsets with worse scores than a previous solution allows the search to proceed without being trapped at a local maximum. this is a fundamental difference from other search algorithms such as maximum iterative improvement that is implemented in the mstrat program  <cit> . conversely, replicas at lower temperatures are less likely to accept worsening transitions, and therefore converge towards a solution.

for the duration of the search, k independent replicas are maintained, each performing a monte carlo search as described above at, a unique temperature ti,  <dig> ≤ i ≤ k. replicas are ordered such that t <dig> <t <dig> <...<tk. neighboring replicas periodically swap their core subsets in order to allow solutions that have stagnated to break out of local maximums and to allow promising solutions to converge. the probability of swapping the current solutions of replicas i and i +  <dig>  namely the core subsets si and si+ <dig>  can be expressed as

   

where ψ is the product of the pseudo-index difference and inverse temperature difference:

   

as the probability of accepting an exchange of core subsets of two replicas drops exponentially as the temperature difference between them increases, potential replica exchanges are only considered between neighboring temperatures  <cit> .

therefore, the search consists of performing a monte carlo search independently for a number of replicas. in brief, each replica is a potential solution and represents a core subset. after each monte carlo search has progressed for a fixed number of steps, replica exchanges are considered, temperatures are possibly swapped, and a monte carlo search begins again for each replica. the best solution, among all replicas, is tracked during the entire search. after a fixed runtime, the best solution observed is reported.

core hunter with stratified sampling
as previously stated, it is sometimes necessary to first stratify samples based on ecogeographical information, and other criteria, prior to forming core subsets. in these cases, core hunter can be used in a complementary manner with the d-method, or similar allocation methods. after stratification, the d-method will determine the number of resources to sample from each cluster, and core hunter can then be run independently on each cluster at the specified sampling intensity.

genetic distances and diversity indices
to evaluate the quality of core subsets formed by the different algorithms, and as compared with the original collection, similarly to a previous study  <cit>  we use two genetic distances between genotypes and three diversity indices that can be incorporated into the pseudo-index we propose above. before providing precise definitions of these measures, we pause to give a brief summary of the purpose of each measure and some insight into how the measures differ from one another. for an in depth treatment of appropriate applications of various genetic measures, and how they relate mathematically, the reader is referred to a review article by reif et al.  <cit>  and references therein, including a review article by mohammadi and prasanna  <cit> .

genetic distances are a measure defined between two samples in order to quantify their degree of dissimilarity; simply put, the larger the value of a genetic distance, the more genetically different the two samples are. conversely, redundant or highly similar pairs of accessions can easily be identified within a collection as those with very low genetic distance between each other. as a genetic distance measure is defined between a pair of samples, and not an entire collection, it is customary to report the average genetic distance between all unique pairs of samples within a collection. this type of measure is particularly useful for breeders interested in forming core subsets where each chosen accession is sufficiently distant from the others. the two genetic distance measures used here are modified rogers   <cit>  and cavalli-sforza and edwards   <cit> . both measures compare samples at the allelic level. modified rogers distance is a refinement of the standard euclidean distance where each allele is treated as a separate dimension.

cavalli-sforza and edwards distance is similar to modified rogers distance, however, it assumes a selective drift model where samples are subject to a low mutation rate and rapid changes in selective pressure  <cit> . for this reason, modified rogers distance may be a more suitable measure than cavalli-sforza and edwards distance in breeding programs where consistent selective pressure is applied for particular traits. in contrast to genetic distance measures, genetic diversity measures do not consider pairs of accessions, rather the allelic composition of the sample as a whole. genetic diversity measures are particularly useful for ensuring rare alleles, which may confer disease resistance or some other desirable property, are included during core subset formation. for this reason, these measures are well suited for genetic conservation efforts such as seed banks. although, they can be equally valuable in breeding programs to ensure a large distribution of alleles is maintained. we consider three genetic diversity indices in this study. the first, shannon's diversity index , is directly related to shannon's information content measure  <cit> . the index is defined in such a way that the largest value attainable occurs when each allele is present only once in the entire sample being measured. generally speaking, it penalizes redundancy at the allelic level, with respect to the entire sample. therefore, shannon's diversity index is an appropriate measure when forming core subsets that attempt to retain as many rare alleles as possible, regardless of their co-location within loci . the expected proportion of heterozygous loci   <cit>  on the other hand, specifically considers diversity within each loci. intuitively, since each loci contributes equally to the overall value of this measure, core subsets selected using this measure are less likely to be homozygous for a number of different loci than core subsets selected with shannon's diversity index. the number of effective alleles , by definition, positively correlates with he and measures the number of alleles within a loci and how evenly alleles are distributed within that loci  <cit> , averaged over all loci in the sample. thus, both measures are suitable for selecting core subsets which ensure allelic diversity within and across loci.

in each evaluation of a sample, we also report two auxiliary values: the proportion of non-informative alleles   and allele coverage   <cit> . cv is a simple measure which reports the percentage of alleles retained in a core subset compared with the original collection. this measure is particularly suitable in selecting core subsets for the purpose of allele conservation in gene banks and seed banks. for instance, due to time or financial constraints, it may be desirable to select the smallest core subset possible, which retains all unique alleles found within a larger collection . pn is defined to be the opposite of cv. thus, maximizing the one will minimize the other.

we now give the precise definition of these measures below where we let l be the number of loci , nl be the number of alleles within the lth loci, and a be the number of alleles in the collection (). furthermore, let  denote the relative frequency of allele a over the observed frequency of all a alleles , let  denote the relative frequency of the ath allele in the lth loci and let  denote the relative frequency of allele a within loci l for genotype x.

 <dig>  the modified rogers distance  between a pair of genotypes x, y is .

 <dig>  the cavalli-sforza and edwards distance  between a pair of genotypes x, y is .

 <dig>  the shannon diversity index  of the entire sample is .

 <dig>  the expected proportion of heterozygous loci per individual  is .

 <dig>  the number of effective alleles  is .

 <dig>  proportion of non-informative alleles in the core subset  is an auxiliary variable measuring the proportion of alleles lost in a core subset compared with the alleles found in the original collection. specifically, let  be the set of alleles found in the original collection and let  be the set of alleles found in the core subset. then .

 <dig>  coverage of alleles in the core subset  is an auxiliary variable measuring the percentage of alleles from the collection which are also present in the core subset. note that cv =  *  <dig> 

criteria for the best core subset
the best core subset has the highest average genetic distance between accessions, the highest allele richness, and the lowest proportion of non-informative alleles . these criteria are in agreement with previous works that suggest core subsets can be formed with the aim of maximizing the total diversity through allele richness and/or maximizing the representativeness of the genetic diversity in the core subset  <cit> .

data sets
to evaluate the utility of the proposed pseudo-index and the effectiveness of the core hunter algorithm, a number of experiments were conducted to compare them to existing strategies. for comparison with mstrat and d-method, the same three molecular marker data sets from a previous study were used  <cit> . a brief description of the three data sets follows:

• 'bulk data set':

-  <dig> samples, having  <dig> markers and  <dig> total alleles

- obtained by fingerprinting  <dig> bulks  of maize landrace populations from the americas and europe, using  <dig> ssr markers with at least one ssr per chromosome and a total of  <dig> alleles  <cit> 

• 'accession data set':

-  <dig> samples, having  <dig> markers and  <dig> total alleles

- obtained by fingerprinting  <dig> maize individuals from  <dig> maize populations using  <dig> ssr markers with at least one ssr per chromosome and a total of  <dig> alleles  <cit> .

• 'populations data set':

-  <dig> samples, having  <dig> markers and  <dig> total alleles

- obtained from the 'accession data set' by grouping the individuals of each population, and calculating the allele frequency per population; this data set had a total of  <dig> populations and  <dig> alleles  <cit> .

comparisons with power core used the same 'rice ssr' data set as used in the original study on power core  <cit> . the ssr data set contained values for  <dig> individual accessions at  <dig> loci.

implementation and hardware
core hunter was implemented in java . experiments were run on our reference pentium iv  <dig>  ghz processor machines, with 1gb main memory and  <dig> kb of cpu cache, running suse linux version  <dig> .

RESULTS
in the following section, we compare our proposed algorithm for forming core subsets, core hunter, with three state-of-the-art methods for which implementations are available: mstrat  <cit> , d-method  <cit>  and power core  <cit> . core hunter is evaluated on the same data sets used in recent studies of these algorithms. results for mstrat and d-method were reported in a previous study  <cit>  where core subsets were selected using a sampling intensity of 20%, a typical choice suggested in the literature  <cit> . for all comparisons with these methods, core hunter also used a sampling intensity of 20%. specifically,  <dig> samples were chosen for each core subset of the bulk data set,  <dig> samples for the accession data set, and  <dig> samples for the population data. we note that in general the choice of sampling intensity, and thus core subset size, for a particular purpose may be based on many independent factors. these factors may include criteria such as diversity, redundancy and possibly financial constraints.

power core results were determined by calculating the seven genetic measures used in this study on the core subset it selected for a rice ssr data set. the core subset selected by power core was previously published, consisting of  <dig> accessions, and made available online  <cit> . when comparing with power core, all core subsets selected by core hunter also contain  <dig> accessions, unless otherwise noted. in that study, the authors of power core demonstrated the software is capable of selecting smaller core subsets that maintained all unique alleles from the reference collection than other algorithms they compared against. we repeat this experiment with our core hunter algorithm.

we show how core subsets can be selected which attempt to optimize multiple genetic measures simultaneously, respective of an assigned weight, using the pseudo-index proposed above. we also explore how core subsets differ under various sampling intensities. as core hunter is a randomized algorithm, we also report on the solution quality variance arising from repeated independent simulations.

optimizing a single distance or diversity measure
for all data sets, core hunter was run with the objective of optimizing each genetic measure independently ). results reported for each measure are independent of results reported for all other measures. for each genetic measure being optimized for a given data set,  <dig> independent runs were performed with a maximum search runtime of  <dig> cpu minutes.

†each selection criteria was attempted to be optimized independently by performing  <dig> runs with 100% weight given to the respective selection criteria during each run. results reported for each measure are independent of results reported for all other measures.

‡ <dig> independent runs were performed with equal weight given to each of the seven measures in an attempt to maximize  all measures simultaneously.

§for each measure, results are shown for the best performing strategy as reported in  <cit> .

†each selection criteria was attempted to be optimized, independently, by performing  <dig> runs with 100% weight given to the respective selection criteria during each run. results reported for each measure are independent of results reported for all other measures.

‡ <dig> independent runs were performed with equal weight given to each of the seven measures in an attempt to maximize  all measures simultaneously.

while core hunter is capable of selecting core subsets which meet or exceed the quality of those chosen by existing software for a particular genetic measure, an important question is how the values of the other measures, which are not considered during optimization, were affected. these values are reported in table s <dig> and table s <dig>  and we summarize the findings here. the following general trends were noticed. when core hunter only attempts to optimize the auxiliary measures cv and pn, core subsets were selected that in general had worse values than at least one of the other algorithms for every other measure. conversely, core hunter consistently reported the worse score for cv and pn measures when attempting to optimize any other measure. this suggests selecting core subsets which attempt to minimize allele redundancy does not necessarily result in core subsets which have high average genetic distance or diversity, at least in the case of core subsets found by core hunter.

another overall trend that was observed was an apparent trade-off between optimizing genetic distance measures and optimizing genetic diversity measures. this observation was made in a previous study comparing d-method and mstrat  <cit>  and the results for core hunter are no exception to this trend. when core hunter optimizes a genetic diversity measure, it generally finds core subsets having worse values for distance measures and is outperformed with respect to other software. likewise, when optimizing a genetic distance, core hunter often finds core subsets with worse genetic diversity. there are a few interesting exceptions. for the accession data set , core hunter consistently finds better core subsets with respect to all distance and diversity measures, regardless of which of those measures is being optimized, with only one exception: mstrat finds a core subset with a better sh value when core hunter is optimizing the mr measure. also of note is that when core hunter is optimizing a genetic distance for the rice data set, it finds core subsets with both good average distance and high diversity, compared with other software.

these results motivate further study in a number of interesting directions. in the next sections, we study these trade-offs in more detail to determine if core hunter can be used to find core subsets having both high genetic diversity and high average genetic distance. we also consider the case for trying to find core subsets which have desirable properties for a number of measures, simultaneously.

simultaneous distance and diversity optimization
to test how effectively core hunter can attempt to optimize genetic distance and genetic diversity measures simultaneously, we conducted the following experiments. for each data set, core hunter was run with the objective of optimizing both a genetic distance and a genetic diversity index simultaneously, with respect to a weight assigned to each measure proportional to the pseudo-index parameter α. one hundred uniform values were tested in the range  <cit> . for each value of the parameter α,  <dig> independent runs were performed for a duration of  <dig> cpu minutes, and the mean values of both measures were determined.

the same experimental protocol was used for simultaneous optimization of the cavalli-sforza and edwards distance and the number of effective alleles diversity index. the margin by which core hunter outperforms mstrat and d-method is even larger, with results shown in figure  <dig>  for the accession data set ), core hunter outperforms both algorithms for both measures simultaneously, regardless of the weights assigned to the respective measure.

as was observed when optimizing a single measure, there is a clear trade-off between genetic distance and genetic diversity. the resulting core subsets discussed above do not have as high average genetic distance than core subsets optimized solely for that property. the same can be said regarding genetic distance. there is a necessary trade-off of one type of property to benefit the other. however, as shown above, core subsets can be selected that still exhibit high average genetic distance and diversity, especially when compared with core subsets formed by mstrat, d-method, or power core.

optimizing multiple genetic measures
to test the performance of core hunter when attempting to optimize more than two measures, the algorithm was run with weights assigned to all seven genetic measures detailed in this paper, for each data set we tested. in all cases, core hunter was run for  <dig> independent trials of  <dig> cpu minutes.

for the comparison with mstrat and d-method, the mean solution quality is reported in table  <dig> ) with each measure given equal weight. for each of these data sets, core hunter is able to select a core subset which better optimizes each genetic measure simultaneously than mstrat or d-method, with the only exception being the proportion of non-informative alleles and coverage. by varying the weights of each measure , a core subset can be found which outperforms mstrat and d-method for all measures .

results comparing core hunter to power core can be found in table  <dig> ). as a goal of power core is to optimize coverage, we assigned 99% of the weight to coverage, and distributed the remaining 1% of the weight equally amongst the other measures, for all runs of core hunter. our intention is to show that it is possible to select core subsets which satisfy a primary objective, such as ensuring perfect coverage , while still attempting to optimize other measures in the process. indeed, core hunter is able to find a core subset that outperforms power core for every genetic measure simultaneously, with the exception of proportion of non-informative alleles and coverage, as both algorithms find an optimal solution.

as discussed in the previous section, the core subsets found when optimizing multiple criteria generally perform worse with respect to individual measures when compared with the core subsets selected for those specific properties. for instance, when optimizing only modified roger's distance, core hunter finds core subsets which generally have 5% higher average modified roger's distance than the core subsets selected by core hunter  . while these core subsets have higher average modified roger's distance, they have 6% less allele coverage on average. thus, the various trade-offs between genetic distance, diversity and preservation of rare alleles must considered in the context of the intended purpose of the core subset being formed. while optimizing a single one of these criteria will be important in some instances, it will often be the case that finding a suitable balance will be the desired outcome.

selecting minimal size core subsets with perfect coverage
with respect to genetic data sets, a goal of power core is to select a core subset that retains all unique alleles found in the collection  and is as small as possible. using the ssr rice dataset, kim et al. demonstrate that power core is able to select smaller core subsets having perfect coverage than a random selection method , a proportional selection method  and mstrat  <cit> . details of the experimental protocol and other selection methods are given in  <cit> .

core hunter was run on the same data set, for  <dig> independent runs of  <dig> cpu minutes, with the objective of finding the smallest core subset, which retains all unique alleles. results for core hunter and those previously reported in  <cit>  can be found in table  <dig>  all  <dig> independent runs of core hunter found core subsets having perfect coverage while containing only  <dig> accessions,  <dig> accessions fewer than power core.

†results were previously reported in  <cit> .

effect of sampling intensity
the choice of sampling intensity when forming core subsets is usually determined by a number of factors. in the previous section the core subset was not intended to be a fixed size, rather the smallest possible size which produced a core subset that retains all unique alleles of a collection. this is beneficial for the application of genetic conservation of rare alleles. sampling intensity can be chosen based on preliminary estimations of redundancy in the original collection, which is an approach taken in the program mstrat  <cit> . often, the sampling intensity is chosen based on a combination of factors, including financial constraints, time constraints, and the particular application for which the core subset is intended. a sampling intensity of 5% to 20% has been suggested by many authors in literature  <cit> .

to determine the effect of sampling intensity on the various genetic measures we selected core subsets for the three maize data sets using two new sampling intensities and compared the results to the core subsets selected using the default 20% sampling intensity. results for 10% and 30% sampling intensity are shown in tables s <dig> and s <dig>  and are summarized here. two very clear, yet expected, trends were observed. with very few exceptions, core subsets selected with a 10% sampling intensity generally had higher average genetic distance and higher genetic diversity when compared with the core subsets selected using 20% sampling intensity. however, the resulting core subsets did not preserve rare alleles as effectively as the larger core subsets unless the genetic measure being optimized was specifically pn or cv. core subsets selected with a 30% sampling intensity preserved rare alleles as well or better than smaller core subsets as would be expected. however, the core subsets selected generally had worse average genetic distance and lower genetic diversity. there were exceptions noticed with regards to the population data set which are probably explained by the small size of the original collection.

overall, it was observed that a small sampling intensity of 10% results in core subsets which have high average genetic distance and diversity and could be an appropriate choice for breeding programs. the higher sampling intensities selected more homogeneous core subsets that preserved rare alleles better and would be an appropriate choice for applications involving genetic conservation.

variability of solution quality
as core hunter is a randomized algorithm, solution quality may vary between independent runs for the same problem instance. however, it was observed that in most cases all independent runs of core hunter for a particular combination of data set and genetic measure converge to the same solution quality, yielding negligible variance. the largest range of solution quality values observed involved the optimization of the number of effective alleles  diversity index for the rice ssr data set, , having a difference of less than  <dig> . the cumulative distribution of solution quality for  <dig> independent runs is shown in figure  <dig>  the second largest range of values, also for the rice data set, involved the optimization of the expected proportion of heterozygous loci per individual  diversity index, , having a difference of less than  <dig> . in nearly every other experiment, the independent trials converged to solutions having the same score.

CONCLUSIONS
we have demonstrated that our proposed algorithm for core subset selection, core hunter, has improved upon state-of-the-art selection methodologies in several ways. results for four distinct genetic data sets show that core hunter, when attempting to optimize a single genetic distance or diversity measure, selects core subsets as good as or better than existing algorithms, often by a significant margin. furthermore, when using the proposed pseudo-index, the algorithm attempts to optimize multiple genetic criteria simultaneously, often finding core subsets that have better values for all genetic measures evaluated, when compared with existing methods. therefore, it is now possible to select core subsets which satisfy both the breeders' and taxonimists' perspectives, respective of a weight assigned to each genetic measure as specified by the user. also, our algorithm is agnostic to the choice of genetic measures. new measures can be incorporated without altering the underlying algorithm. we have further demonstrated that core hunter is able to select significantly smaller core subsets that retain all unique alleles within a collection, than other algorithms designed for this purpose such as power core.

while we believe core hunter will significantly improve the process of core subset selection, there are a number of directions in which this approach can be further improved. first, our algorithm currently considers only genetic data. selection of crop varieties always depend on phenotypic traits and a sole focus on genetic information may bias results due to non-functional genetic variations. power core  <cit> , mstrat  <cit>  and d-method  <cit>  all provide support for using phenotypic measures when selecting core subsets. second, when combining a large number of molecular marker data with phenotypic variables, it is challenging to come up with a unified approach so that information on both data sets can be utilized. while core hunter is freely available for use, it currently lacks a rich graphical user interface such as those found in power core and mstrat. in order to make core hunter more accessible to users, development has begun on a rich graphical user interface as well as a web based interface. announcements regarding these efforts will be made on the project website.

authors' contributions
gd, jc, and jf proposed the project, and collaborated with ct on the algorithm development and design and analysis of experiments. ct proposed the algorithm, implemented it, and performed all new experiments. sd, mw provided advice, data and feedback throughout the process. ct and jc wrote the initial manuscript with all authors contributing to the final version.

supplementary material
additional file 1
supplemental results. expanded listing of tables  <dig> and  <dig> in addition to results for various sampling intensities.

click here for file

 acknowledgements
we would like to thank jonathan crouch and holger h. hoos for helpful comments concerning this project and manuscript. we would also like to thank the anonymous reviewers for their valuable suggestions. computational biology research in cril was funded by the generation challenge program . jc and gd are supported with funding by ifad and european union. ct received additional support from an nserc pgs-d <dig> scholarship.
