BACKGROUND
the study of reaction processes between different types of molecules has been an important research problem already for decades. a proper understanding of the processes occurring when two or more molecules react helps in the design of new chemical matters, e.g., in drug design or protein engineering. here, the researchers aim to combine a protein with a given ligand in order to design a new drug or to change protein properties and their function. in these particular cases the ligand has to be transported from the outer solvent to the protein active site where the chemical reaction between the ligand and the amino acids surrounding the active site takes place. the consecutive reaction then changes the composition and properties of both molecules. in protein engineering, for example, the goal is to alter the protein properties so that the new protein is, e.g., more stable and resistant to organic cosolvents  <cit> .

the design complexity of such reactions lies namely in the transportation of the ligand to the protein active site. as the active site is usually buried deeply in the protein structure and thus inaccessible directly from its surface, the ligand has to find a suitable transportation path through the protein structure. this process, called molecular docking, is very complex, lengthy, and its analysis is heavy on computational resources. therefore, researchers aim to find solutions that simplify and ease the analysis for proper ligand binding. currently available solutions often focus on detection of possible ligand transportation paths through the protein, called tunnels. these solutions are mostly based on the geometric analysis, e.g., caver  <cit> , mole  <cit> , or molaxis  <cit> . figure  <dig> shows an example of small ligand passing through a tunnel computed by caver algorithm and visualized using caver analyst  <cit> . the tunnel is colored with respect to the hydrophobicity of the surrounding amino acids and the geometric bottleneck of the tunnel is clearly visible.
fig.  <dig> small ligand  passing through a tunnel represented by the transparent surface. the surface encloses the empty space along the tunnel centerline and is colored with respect to the hydrophobicity of the surrounding amino acids . the active site is located in the left ending of the tunnel




other approaches, such as moma-ligpath  <cit> , aim at simulating the ligand transportation itself. nevertheless, simulating the ligand docking using current computational approaches is still a challenging problem. there are several available variants of molecular simulation methods devised specifically to this problem. among these, steered molecular dynamics  <cit>  and random acceleration molecular dynamics  <cit>  are able to simulate the ligand binding. such simulations produce a large amount of data containing the ligand movements that are to be explored by the domain expert. as the length of these simulations reaches often hundreds of thousands of time steps, it becomes impossible for the domain experts to visualize and observe the ligand movement in a frame-by-frame manner. moreover, the simulation often contains movements that are irrelevant to the ligand binding. for example, a significant portion of the simulation the ligand usually spends outside the protein searching for a proper tunnel gorge to enter the molecule. it also often happens that the ligand enters the molecule via a wrong tunnel and is then evicted from the molecule and searches for the entrance repeatedly. therefore, the “true” active site entering can be in fact captured in a smaller subset of the original sequence.

in this paper we propose a new visual analysis system that addresses the aforementioned challenges, i.e., the transportation of a ligand to the active site. we aim to provide the domain experts with a tool for intuitive and interactive exploration of already captured molecular dynamics  simulation containing the process of ligand binding. using our proposed solution the users are able to distinguish between the parts of the simulation where the ligand searches for the proper path to the active site  and the part where the ligand finally leads to and reaches the active site. furthermore, our solution introduces a method for simplification of the original scattered ligand trajectory. we suggest the automatic simplification of the trajectory which can be further interactively adjusted, i.e., selected parts of the trajectory can be further simplified. so the trajectory can be simplified in a hierarchical manner and further interactively explored using the other proposed views. one of these views is the 3d visualization where the simplified trajectory can be displayed in the spatial context of the whole molecule. the trajectory can be color-coded according to different criteria and selections performed in the other views are highlighted by a thick tube. another available view is the scatterplot matrix which helps to explore different properties of the ligand along its trajectory, e.g., the direction or distance to the active site. selections performed in these scatterplots are highlighted not only in the 3d view but also in another proposed view, the bar chart representing the temporal changes of selected ligand properties. this view enables to aggregate the time steps to better reveal the trends in ligand behavior. the bar chart is equipped with the line representation of amino acids lining the ligand along its trajectory. this helps the user to reveal the closest amino acids directly influencing the ligand behavior in different time steps.

our proposed solution was thoroughly tested and evaluated by the domain experts from protein engineering area. the evaluation was performed on several simulations captured and analyzed before using the traditional approach . therefore, we also describe the process of using our solution when exploring these molecular dynamics simulations and summarize the feedback from the domain experts.

related work
the interactive exploration of ligand paths leading through protein structures is a complex problem that requires an elaborate analysis of existing and convenient approaches. as our system addresses different areas, this section will be divided with respect to these areas as well. studying the ligand transportation path is tightly related to the analysis of its trajectory. thus, the first part will cover the topic related to the trajectory analysis, simplification, and visualization. then the existing representations of tunnels and their surrounding amino acids will be addressed.

trajectory analysis, simplification, and visualization
when searching for the most appropriate trajectory simplification method, the taxonomy of different movement patterns introduced by dodge et al.  <cit>  can help to categorize the type of motion and to propose an appropriate solution for the analysis and simplification. then, andrienko et al.  <cit>  describe a legacy of tools and approaches to analyze trajectory data. with respect to the trajectory simplification, they introduce two approaches to data abstraction representing a necessary step to achieve the reduction of the data in order to achieve informative visualizations. the first approach is characterized by omitting unnecessary positions and segments, while the second exploits data subsampling. on the other hand, they state that there is no general method to sample trajectories. thus the suitability of particular sampling method is deduced from what information is considered important. a recent work of vrotsou et al.  <cit>  introduce a systematic stepwise methodology for trajectory simplification with emphasis on visual analysis. even though they primarily developed the tool to analyze three dimensional trajectories, it is not limited to them only.

in the field of molecular biology as well as systems biology, there are several examples of methods focusing on trajectory analysis. bidmon et al.  <cit>  present an abstract way of identification and visualization of solvent molecules’ pathways within molecular dynamics. in comparison with the previous solutions, their approach preserves valuable information on the directions and velocities of water molecules routing along these paths. another approach that describes a guidance through a complex simulation trajectories in systems biology is presented by luboschik et al.  <cit> . the method addresses biochemical reaction networks and aims to provide the users with a tool for investigating the overall behavior of a modeled system and detailed behavior at the same time.

visualization of cavity and tunnel features
phillips et al.  <cit>  propose a method to quantitatively estimate molecular features, e.g., volume and surface areas, via a ray-casting technique. this involves the computation of cavities. lindow et al.  <cit>  introduce a technique that allows to extract significant paths from the molecules. in their approach the authors utilize a voronoi diagram of spheres. their final visualization is achieved by means of placing light sources on the extracted paths to enhance the presence of tunnels. parulek et al.  <cit>  exploit scatterplots to communicate the evolution of protein voids. in their later study  <cit>  they also suggest to utilize amino acids physico-chemical properties related to cavities to help users to navigate through their occurrences. the visualization is then achieved in the focus and context manner. lindow et al.  <cit>  present an approach for visualization of temporal evolution of cavities in a temporal graph. in this work they focus on the interactive exploration of the dynamics of protein cavities that can form the transportation path for a ligand. they calculate and visualize the cavity volume and analyze the time-dependent changes of the cavity structure. the cavity dynamics is captured by rendering the cavities in a single image. the final visualization is achieved through the molecular surface representation colored according to time. krone et al.  <cit>  present a similar approach where they extract and track tunnels in md simulations. they exploit temporal graphs to communicate the evolution of surface areas of tunnels. in our technique, we go one step further, where in addition, we incorporate the ligand-protein interaction information and provide users with the means to navigate through details of this interaction. moreover, we analyze sequences of several thousands of frames, which is not the case in aforementioned approaches. kozlíková et al.  <cit>  propose a way to seamlessly visualize the geometry and shape of tunnels across md simulation. here, they aim at 3d visualization solely, which is not suitable way of exploring and understanding of thousands of simulation time-steps. byška et al.  <cit>  introduce an approach to interactively explore the tunnel objects in md simulations. similarly to our proposed approach, they visualize the time-varying tunnel as a profile graph that includes information on surrounding amino acids. nevertheless, they focus on a single tunnel instance and do not provide the means to explore the ligand-protein interaction.

problem description and input data
when studying long molecular dynamics simulations, the researchers have to face namely the following high-level tasks: 
detect the part of the simulation where the ligand enters the protein and reaches the active site.

explore this route in detail and detect its bottlenecks.




in consequence, these steps are performed in order to reveal the parts of the trajectory where the ligand gets stuck. it means that in such parts there are some obstacles made by the surrounding amino acids. these obstacles can be geometric  or physico-chemical , or their combination. the geometric obstacles can be detected by using an algorithm for tunnel computation in molecular dynamics . these tools are able to produce the information about time evolution of individual tunnels and for each tunnel detect its bottleneck – the narrowest part limiting the size of the ligand aiming to pass through this tunnel.

however, this bottleneck can be to some extent influenced by the passing ligand and this influence is also determined by the physico-chemical properties of the ligand and the bottleneck-lining amino acids . to reveal such dependencies, it requires the involvement and experience of the domain expert who has to study the ligand trajectory captured in the molecular dynamics simulation.

in protein engineering, all these efforts can finally lead to the detection of amino acids along the ligand trajectory which caused some problems, i.e., were the key players in situations when the ligand got stuck. such amino acids are then the best candidates for subsequent mutation of the protein chain when these amino acids are replaced by more suitable ones wrt. their size and properties. on the other hand, in drug design the aim is to propose modifications of the ligand to increase the binding likelihood in order to design a better drug produced from this ligand.

the input data is obtained from the simulations of molecular dynamics which contains the movements of the protein and one or more ligands. ligands can follow different routes – they can be transported from the outside environment to the protein active site or vice versa .

the length of the simulations may vary from few hundreds to hundreds of thousands of time steps. this depends namely on the ligand velocity and its ability to find the proper path to the active site.

long simulations can often contain many time steps when the ligand followed an impasse – it tried to find the proper entrance point to the protein  or entered a wrong tunnel and had to return. such parts of the simulation could be of less interest so that the user should be provided with a possibility to filter them out and focus only on the interesting parts. figure  <dig> shows such example when the ligand trajectory consists of  <dig>  time steps. it is visible that in most of the time the ligand travels around the protein chain . therefore, only a fraction of the trajectory captures its transportation to the active site.
fig.  <dig> ligand trajectory  for a simulation containing  <dig>  time steps. the protein chain is depicted in blue





methods
our proposed solution consists of several linked views covering individual steps of the exploration workflow . in the first part, the user is provided with the overview representation of the whole loaded trajectory . this simple 1d representation encodes different routes of the ligand – orange color highlights the parts of the trajectory where the ligand is inside the protein, white color encodes the situation when the ligand is outside the protein, and blue stands for the situation when the ligand is close to the protein surface. red color shows the time portions when the ligand was close to the active site. by selecting a part of the trajectory using this representation, the user is automatically navigated to this selected part and all following representations show only this part.
fig.  <dig> overview of the proposed system.  <dig> – overview of the whole loaded trajectory,  <dig> – scatterplot matrix plotting different attributes of the ligand trajectory,  <dig> – bar chart showing temporal changes of selected ligand properties accompanied by line representation of ligand-lining amino acids presence over time,  <dig> – spatial representation of the trajectory




among the other supported views belong the scatterplot matrix  enabling to explore different attributes of the ligand and its trajectory. these attributes are described in detail in section derivation of attributes. by interactive manipulation with these matrices the user can select a subset of time steps in which the ligand behaved in a desired way. the selection is highly dependent on the current tasks the user aims to perform. for example, when the user searches for the parts of the simulation where the ligand got stuck for a certain amount of time steps and at the same time was close to the active site, he or she plots and interacts with the matrix showing the relationship between the ligand stuckness and its distance from the active site.

the selected time steps can be further explored using the combination of bar chart and line representations . the bar chart enables to follow a selected attribute over time. furthermore, individual bars can represent an aggregated information for selected portions of time steps. the aggregation is performed on uniformly divided time intervals. then they show the average values of selected attributes. the line representation informs about the amino acids closest to the ligand along its path. this information helps to determine those amino acids which play a substantial role in the ligand transportation.

these views are linked with the three-dimensional view  where the user can observe the ligand trajectory in the context of the protein structure. as the original trajectory is highly scattered, we propose a simplification algorithm which aims to reveal the trends in the ligand movement and suppress small insignificant movements. the algorithm is described in detail in the trajectory simplification section.

trajectory simplification
when visualizing the ligand trajectory in its original form, e.g., using a line strip of consecutive ligand positions, the visualization becomes very crowded even when analyzing only few hundreds of snapshots . therefore, it is necessary to simplify the original trajectory data and to visualize this simplified version . in this manner, we enable the user to deduce the information about significant ligand movements directly from its 3d visualization.
fig.  <dig> visualization of  <dig> snapshots of a ligand trajectory using line strip. visualization of the original trajectory is crowded . on the other hand, visualization of the simplified trajectory clearly reveals its possible important parts . the trajectory is colored by time from beginning  towards its end 




we propose two types of ligand trajectory simplification: i) automatic and ii) interactive. the automatic simplification is applied to the whole original trajectory, while the interactive one enables fine user-regulated control over the level of simplification of individual parts of the trajectory.

interactive simplification
first, we will describe the algorithm for the interactive trajectory simplification . the input of the algorithm consist of trajectory t
in and interval i which denotes a part where the trajectory should be simplified.

as a first step, the algorithm retrieves from a cache the current visualized trajectory t
′ together with its simplification s
′. structure s
′ is a list of consecutive intervals that span the whole trajectory. each interval in s
′ is assigned with a simplification level and as such describes the amount of simplification of a respective part of t
in. this representation enables the simplification of different parts of t
in using different levels of detail. in the next step, the updated simplification s is obtained by applying i to s
′. then, it is decided whether t
′ can be incrementally updated to obtain t
out. this is true when the level of simplification of t
′ at the updated interval i is lower than the desired level of simplification. in this case, the current visualized trajectory t
′ is simplified on i resulting in t
out. otherwise, the visualized trajectory t
′ cannot be used and the simplified trajectory has to be computed from scratch using t
in. this case typically emerges when the user decides to lower the amount of simplification of some part of the trajectory. the computation then proceeds as follows. a list ℒ is computed from s. for each simplification level in s, we extract from s a set of all intervals on that level, l, and we add l to ℒ. then, we iterate through ℒ in an ascending order by level of simplification. in each iteration, we have a set of intervals l∈ℒ and we apply the simplification on all i
l∈l to t
out. in both cases, we employ savitzky-golay smoothing method  <cit>  to simplify the trajectory. as the last step we store the simplified trajectory to a cache. the caching is employed to primarily improve the performance of automatic simplification. moreover, the performance of interactive simplification is also enhanced, for example, when the user iteratively simplifies the same part of the trajectory until reaching satisfiable results.





automatic simplification
the automatic algorithm  is iterative and in its iterations employs algorithm  <dig>  furthermore, it is based on an idea to simplify only parts of the trajectory that are still too complex. the algorithm starts with considering the whole trajectory as complex – the set of complex intervals c is set to the interval spanning t
in. then, the complexity c of t
in is evaluated in all points of t
in. the complexity c in point x is defined as : 
  <dig> c=∑∈n2α, 
fig.  <dig> evaluation of the complexity of a trajectory t in point x. the complexity c is determined by tuples  and , i.e., their angles α and β, as the segments u, v, and w lie in the neighborhood of x . the neighborhood of x contains all points that are closer  to x than to ν





where n is a set of consecutive tuples of segments of a trajectory t lying in the neighborhood of x and α is an angle between directions of u and v. the neighborhood of x contains all points y∈t such that d<ν where d is the distance along t. we evaluate the complexity of t in the neighborhood of x in order to take into account the local shape of the trajectory in the vicinity of x. our typical setting for ν is  <dig> Å which is an experimentally obtained value.





furthermore, the simplification s is set to be empty at the beginning and the resulting trajectory t
out is set to t
in. the iterative simplification then proceeds as follows. first, a set of simple points p is found by thresholding c by τ. all points p∈p are then removed from c which prevents further simplification of parts of the trajectory that are already simple. then, t
out is simplified in all complex intervals that remained in c. after the simplification, the complexity is evaluated again and the improvement in comparison with the previous complexity is computed. the iterative simplification ends when the improvement after an iteration Δ
c drops below a user-specified threshold ε.

to address the correctness issue, which may be raised by the smoothing simplification, we provide also non-smoothing simplification employing douglas-peucker algorithm  <cit>  which preserves original positions of trajectory vertices. generally, the non-smoothing simplification utilizes schemes presented in algorithm  <dig> and algorithm  <dig>  only small modifications to the simplification data structure  and new complexity measure c
dp were needed due to the nature of the douglas-peucker algorithm which keeps only a subset of the input positions. we present only the new complexity measure since the other changes are trivial. the complexity c
dp is defined as: 
  <dig> cdp=∑s∈ndp|s||pe−ps|, 


where n
dp is a set of trajectory segments in the neighborhood of x , and p
s and p
e are start and end points in that neighborhood. both simplification approaches were evaluated by the domain experts. they concluded that, although the smoothing simplification is superior thanks to the ability to provide results that are easy to understand using visualization, it is also important for them to use the non-smoothing simplification to confirm their assumptions that were made when visualizing the smoothed variant.

derivation of attributes
in the previous section we described the simplification of the ligand trajectory. on one hand, such approximation helps to understand the overall ligand movements. on the other hand, it also suppresses vast amount of details that are important for complete understanding of the ligand movements inside protein.

in order to preserve this information and hence allow the biochemist to explore the ligand behavior in detail we evaluate interesting geometric and physico-chemical attributes of the ligand trajectory on multiple levels. these attributes are then communicated to the user in several ways .

based on several discussions with the domain experts, we detected the following attributes as the most significant: “stuckness” of the ligand in one place, its distance from the active site, the direction of its movement, the amount of surrounding free space, changes of surrounding amino acids and their properties, the hydrophobicity and charge profiles of amino acids and atoms around the ligand, and the speed of the ligand along the trajectory. figure  <dig> aims to illustrate the individual attributes.
fig.  <dig> illustration of the attributes derived for the ligand and its trajectory. aa1-aa <dig> denote amino acids lining the ligand in a specific position




the remaining part of this section describes these attributes in detail, along with the process of deriving these attributes from the original data, and rationalizes their usefulness.


stuckness is one of the most interesting attributes. it comes from the fact that if the ligand got stuck in some place, it means that there was some obstacle  which prevented the ligand to pass towards the active site. the biochemists are highly interested in these obstacles and want to explore them in more detail in order to reveal the reason of this problem and possibly propose a replacement  of some amino acids surrounding this problematic spot. we consider the ligand to be stuck if it oscillates around a specific place in the protein. to estimate the stuckness, we measure how straight the movement of the ligand was, i.e., whether it moved significantly in some direction or its movement was rather random. the stuckness is estimated in a neighborhood of 2n+ <dig> consecutive ligand positions . the size of the neighborhood n can specified by the user. for a set of ligand positions p we define the stuckness as: 
  <dig> s=max−n≤i,j≤nd,p)∑−n≤i<nd,p), 


where p is the position of the ligand in snapshot x and d is the euclidean distance of x,y∈r <dig>  to be precise, at the beginning  of the trajectory, we shrink the neighborhood from the left  side. furthermore, we set n= <dig> by default. this value was obtained experimentally.


distance of the ligand from the active site provides the biochemists with the information whether some observed behavior occurred in a vicinity of the active site, the surface, or somewhere in between. this can be very helpful for instance when we want to mutate some amino acids along the trajectory in order to remove the stuckness of the ligand in that area. therefore, this attribute is naturally connected with the ligand stuckness. in these cases it is essential to see also where exactly the unwanted behavior of ligand happened. in order to evaluate the current distance of the ligand from the active site, we first extract the position of the active site a in each time step x. here the active site is defined by a set of surrounding amino acids and we compute the position of the active site as the center of mass of these amino acids, i.e., their atoms. once a is determined, we compute the distance of the ligand position p to the active site as d
as=d,a) where d is again the euclidean distance of x,y∈r <dig> 


direction of the ligand movement with respect to the active site is another essential attribute. during the md simulation the ligand can enter and exit the protein tunnel repeatedly. therefore, biochemists want to distinguish between intervals where the ligand was traveling towards the active site or in the opposite direction . the direction parameter is a binary value computed as the derivative of the distance attribute. in other words, we simply evaluate the ligand distance from the active site in two subsequent time steps and if the difference of the obtained values is positive we claim that ligand is moving towards active site and vice versa.


amount of free space surrounding the ligand can help the biochemists to understand why the ligand in some places got stuck. in such cases there was not enough free space for the passage of the ligand or the ligand was repelled by some amino acid due to incompatible physico-chemical properties. the amount of free space around the ligand can be obtained in two ways. when the user has the information about tunnels , we can use it for the assessment of the free space around the ligand. we take the tunnel in the corresponding time step and search for its sphere in which the ligand is positioned. the radius of this sphere is then taken as the descriptor of the free space. however, when the information about the tunnel is not available, we compute the free space in the following way. we denote this approach as the detection of temporal tunnel. the temporal tunnel is defined by a set of spheres where the number of spheres corresponds to the number of time steps in the simulation. each sphere is taken from one time step and it defines the maximum empty space surrounding the ligand. for each time-step we firstly retrieve ten protein atoms closest to the ligand. their mean position defines the center of the temporal tunnel sphere while the radius is determined as the minimum distance from this center to the closest protein atom.


changes of amino acids and their properties help to understand when the ligand was in contact with a specific set of amino acids and when this set changed. in other words, the changes of amino acids can reveal those parts of the trajectory where the ligand significantly changed its position with respect to the protein. the higher number of different amino acids surrounding the ligand between two consecutive time steps corresponds to variations inside the protein tunnel as well. moreover, whether the ligand will be able to pass through the tunnel and reach the active site is highly dependent not only on the geometric properties of the tunnel but also on the physico-chemical properties of the surrounding amino acids and their atoms . this attribute is tightly connected with the ligand stuckness and subsequent proposal of candidates for amino acid mutations.


hydrophobicity profile is related to the amino acids surrounding the ligand trajectory. it aims to add the user the information about physico-chemical property – hydrophobicity – of these amino acids. this is very useful in cases when the ligand got stuck and this was not caused by any geometric obstacle. this attribute is calculated as the average value from all ligand-lining amino acids when the lining distance is taken as  <dig> Å.


charge profile has a very similar purpose as the hydrophobicity profile. it conveys the information about another significant physico-chemical parameter, atom partial charge, calculated for each atom in the distance of  <dig> Å from the ligand and averaged.


speed can be easily described and estimated in relative terms. since the original data are uniformly sampled , we can measure the distance between two subsequent time steps and thus obtain the speed of the ligand in that particular area.

visual exploration
in this section we describe the individual views supported by our system. all views are interactively linked, i.e., the user can select a specific parts of the ligand trajectory and these parts are highlighted also in the remaining views.


trajectory overview this simple 1d representation helps to navigate the user to the interesting parts of the simulation. it is depicted as a bar colored according to the ligand position with respect to the protein surface and active site. we assort the ligand movement into four categories: 

outside – the ligand is moving outside of protein.


surface – the ligand is moving alongside the protein surface.


inside – the ligand is moving within the protein.


active site – the ligand is moving in close proximity to the active site.




this representation enables quick filtering of irrelevant data , as well as navigation to the potentially important parts. this is reached by using a brushing tool that allows to draw a rectangle over the desired part of the simulation and the corresponding time steps are selected and used for further exploration. the selected time interval is then displayed in the bar chart as well as in the scatterplot matrix.


bar chart and line view this view provides a closer look at the ligand movement with respect to the properties of the temporal tunnel. it consists of two parts – the bar chart and line representation of all amino acids lining the ligand trajectory.

by default, each bar in the bar chart represents one time step of the simulation, though if needed  the neighboring bars can be uniformly aggregated. the bars are selectable and the selected time steps are highlighted in the scatterplot matrix as well as in the 3d view. the height of the bar is set to represent one of the geometric or physico-chemical attributes described previously. the color of selected bars corresponds to the coloring of the trajectory overview, indicating the ligand position at a given time step. the user can visualize only the selected bars. when the set of selected bars is not continuous, the user is informed about it by a small wave inserted between the bars.

the information about the surrounding acids is also very crucial when exploring the sites when the ligand got stuck. for each time step within the temporal block we compute the three closest amino acids from the ligand. we provide the visual representation of this list , where each amino acid defines one line in the list. the line is colored with respect to a selected physico-chemical property – our representation supports switching between hydrophobicity, partial charges, and donors and acceptors. the interruption in some of these lines is caused by the fact that the given amino acid is not present around the ligand in the corresponding temporal block.
fig.  <dig> representation of amino acids surrounding the temporal tunnel and their physico-chemical properties. coloring corresponds to hydrophobicity, the line interruption means that this amino acid was not detected around the ligand in the corresponding temporal block





scatterplot matrix for detailed analysis of geometric and physico-chemical attributes of the ligand trajectory at given time steps we propose the scatterplot matrix. the axes of one scatterplot represent a pair of user-selected attributes. each point in the scatterplot then represents the values of these attributes at one time step. as a result, the scatterplot can easily reveal trends and relationships between attributes. interactive manipulation with the scatterplot, such as selection, zooming, and change of displayed attributes provides an easy way for manual data filtering. to eliminate the noise in the data caused by ligand jittering, we propose the sliding window smoothing function . the sliding window function assigns to each time step the averaged value from its neighborhood. the size of the neighborhood is again regulated by the user.
fig.  <dig> scatterplot matrix depicting time vs. distance and time vs. speed properties for a sequence of  <dig> time steps before  and after  smoothing




the plots can further be stacked, forming a matrix and thus showing relationship between multiple attributes at once. the stacked plots are also interactively interconnected and the selection in scatterplot matrix is interactively linked with barchart view and 3d view.


3d view this view provides an overview of the ligand trajectory in 3d. however, as was shown in fig.  <dig>  the ligand trajectory contains a lot of noise, due to the jittery movement of the ligand. therefore, we introduced the previously described trajectory simplification. using this function the whole trajectory can be automatically simplified. if the automatic simplification does not lead to satisfactory results, selected parts of the trajectory can be further simplified interactively by the user. the trajectory is colored according to one of the geometric and physico-chemical attributes.

RESULTS
in this section we will describe two scenarios which we have performed using our novel exploration tool. these scenarios were selected and conducted by the domain experts from our cooperating group of protein engineers. the group involved into the design of our proposed tool as well as the selection of interesting case studies and evaluation of the final visualization consisted of seven researchers – one professor , two post-docs, and four phd students. they were asked to use our tool to explore their datasets and to evaluate the intuitiveness, understandability, benefits, and drawbacks of the proposed tool.

first scenario
in the first scenario the biochemists explored the trajectory capturing molecular simulation of haloalkane dehalogenase together with one ligand. since the simulation consists of  <dig>  time steps, it would take enormous amount of time to analyze it using only common techniques such as 3d animation. here we will show how this can be significantly improved using our exploration tool. after the precomputation stage the user can immediately start to explore individual views described in the previous sections.

we start with the rough analysis of the overall behavior of the ligand using our simulation overview . utilizing this view the biochemist can immediately see that the whole simulation contains three main  parts where the ligand was inside the protein . these parts are divided by two blue and white blocks signalizing that the ligand was moving near to the protein surface  or even entirely left the protein .
fig.  <dig> overview of the simulation consisting of  <dig>  time steps. selected part was explored in detail in our case study




the mentioned color mapping on the simulation overview suggests that in this particular simulation the ligand started in the active site, then traveled towards the protein surface, and finally left the molecule. after spending some time outside it found again its way into a protein tunnel and traveled back to the active side. the whole process is then repeated again while this time the ligand spent significantly more time outside the protein or nearby its surface and returned just for last few hundreds of time steps.

after the first evaluation of the overall ligand trajectory the biochemists stated that they would like to evaluate the interactions between the ligand and protein in more detail using the following scenario . they focused on the part where the ligand traveled from the active site to the protein surface.

the exploration of this part of the simulation allows the biochemists to closely evaluate the influence of the protein tunnel and its properties to the ligand movements.

the biochemists selected the first part of the simulation consisting from circa  <dig>  time steps . from this point the biochemists continued to more detailed exploration using brushing and linking in other three views – namely using the 3d, scatterplot, and bar chart views. each of these views provides slightly different representation of the data thus allowed the biochemists to perform different operations.

for instance, by using the scatterplot set to show the ligand distance from the active site over time  we immediately revealed that the ligand was actually near to the protein surface  in few additional times during this part of the simulation. the same behavior can be actually observed also in the simulation overview  where these cases are highlighted by slim blue lines. but these cases are much better visible in the scatterplot view.
fig.  <dig> 
a,  distance of the ligand from the active site over time.  hydrophobicity profile of the trajectory over time. c,  hydrophobicity profile of the trajectory with respect to the distance




another interesting behavior which can be seen with this setup is that the ligand repeatedly traveled back and forward from the active site  to the surface  in the first  part of the selected interval. this behavior can suggests that the ligand had actually problems to bind with the protein in the active site.

when evaluating the reactivity between the ligand and protein active site it is important to determine the amino acids that interact with the ligand. when these amino acids are non-polar then the ligand has to be non-polar as well. similarly, polar amino acids attract the polar ligand. therefore, the biochemists were interested in seeing whether there are some polar amino acids inside the active site. the polarity of amino acids is closely related to their hydrophobicity – hydrophobic amino acids are non-polar while hydrophilic amino acids are polar.

the desired information can be retrieved using our exploration tool in many ways. here we show one of the possible solutions used by our domain experts in the real test scenario.

the biochemists first added another scatterplot showing the hydrophobicity profile along the ligand trajectory . since both scatterplots are interactively connected in real-time, the biochemists could select the low hydrophobicity values and immediately observe at which distance they are positioned with respect to the ligand trajectory over time .

the results confirmed the behavior common for most of the proteins, namely the fact that the part of the trajectory in greater distance from the active site  is surrounded mostly by hydrophilic amino acids. on the other hand, when the ligand reaches the inner part of the protein, it is surrounded by highly hydrophobic amino acids.

however, as can be seen in fig. 10
a, there are few amino acids that are actually hydrophilic but located in the close vicinity to the active site. in order to easily pinpoint these specific amino acids, the biochemists set the scatterplot to visualize the exact relationship between the distance and hydrophobicity . by creating the selection in this view, the biochemists were able to easily pinpoint the part of the simulation closer to the active site which contained the hydrophilic amino acids .

as the next step, the biochemists were interested in seeing which amino acids are actually responsible for the described behavior. for this reason they utilized the bar chart view containing the amino acid graph .
fig.  <dig> 
bar chart view showing the time steps when the ligand is in the vicinity of the hydrophilic amino acids




in order to easily see the required data they limited the view only to selected time steps and set high level of aggregation . even though the amino acid view contained the list of all amino acids surrounding the ligand in given time steps, it was relatively easy to spot the hydrophilic ones. this was enabled thanks to the ability of the view to color individual amino acids based on their properties. here the biochemists selected the green amino acids . as can be seen in fig.  <dig> the selected amino acids exactly correspond to the estimated active site in the protein. this was also confirmed by the bar chart representation in fig.  <dig> where the majority of bars have red color which corresponds to the closeness of the ligand to the active site.
fig.  <dig> 3d view showing the selected hydrophilic amino acids and their spatial position to the ligand trajectory




second scenario
in the second scenario we demonstrate the usefulness of our approach when studying more complex cases. for this purpose we used a simulation of haloalkane dehalogenase together with three  <dig> ,3-trichloropropane  ligands . the original trajectories of these ligands are very complex, as can be seen in fig.  <dig> 
fig.  <dig> haloalkane dehalogenase  with the original trajectories of three ligands, tcp– <dig>  tcp– <dig>  and tcp– <dig> 




the hypothesis stated by the biochemists at the beginning was that all three ligands should bind to the same pocket surrounded by the following amino acids h <dig>  l <dig>  and l <dig>  hence, attributes such as distance or direction were computed in relation to the active site defined by these amino acids.

first, the user can select one of the ligands to be observed and thus easily compare the individual trajectories. using the simulation overview  it is immediately visible that only tcp– <dig> evidently entered the protein – orange and red colors depict the state when the ligand is inside of protein while blue color indicates the ligand closeness to the protein surface. after more detailed observation it can be also seen that the tcp– <dig> also entered the protein in the last part of the simulation, but it probably did not enter deeply. finally, the overview of the trajectory of tcp– <dig> suggests that the ligand was rolling around the protein surface but never got deeper into the structure.
fig.  <dig> overview representation of the trajectories of three ligands entering the haloalkane dehalogenase. tcp– <dig> entered the protein just partially at the end of the simulation. tcp– <dig> rolled over the protein surface. tcp– <dig> entered the protein and headed towards the active site




the simulation overview, however, provides only general information about ligand positions with respect to the protein surface. the interesting behavior can be revealed after depicting the distances from the active site using scatterplots. here the biochemists immediately spotted that both tcp– <dig> and tcp– <dig> were evidently in a close vicinity to the active site during the last part of the simulation , while tcp– <dig> does not exhibit any significant affinity towards the active site.
fig.  <dig> scatter plots showing the evolution of the distance from the active site for all three ligands over time:  tcp– <dig>   tcp– <dig>  and  tcp– <dig>  d scatterplot showing the relationship between the distance from the active site and the stuckness of the tcp– <dig> ligand




in case of the tcp– <dig>  the overview is mostly blue  due to the fact that the site where this ligand binds is relatively shallow and close to the surface. tcp– <dig> reached the deeply buried active site first and hence filled the empty space around it. this can be seen either from the distance scatterplots  or directly from the 3d view .
fig.  <dig> 3d view showing the mutual position of two ligands, tcp– <dig> and tcp– <dig>  inside the active site at the end of the simulation




at this point the biochemists were already able to conclude that only two of the ligands entered the binding site of the protein and only one of them entered the deeply buried active site. nevertheless, some additional observations revealing more details about the simulation can be done as well.

when exploring molecular simulations containing a ligand, one of the most important tasks is to determine the ability of protein active site to bind the given ligand. in this particular case the biochemists were able to easily estimate the ability of the active site to bind tcp– <dig> and tcp– <dig> directly from the distance scatterplots . it is clearly visible that both ligands were in the vicinity of the active site for a long time and they did not left the site anymore. nevertheless, in more complicated cases the biochemists can use a scatterplot showing the relationship between the distance from the active site and the stuckness of the ligand. for instance, in case of tcp– <dig>  it is easy to confirm that the ligand was highly oscillating  in a close vicinity of the active site. on the other hand, it can be also seen that with the growing distance from the active site the stuckness ratio is lower. this suggests that the active site is highly suitable for the given ligand and there is no other place towards which the ligand would exhibit any significant affinity.

finally, as can be seen in the distance scatterplot , both tcp– <dig> and tcp– <dig> entered the protein active site during a short period of time and never left it afterwards. at this point the biochemists wanted to explore this particular moment in more detail. our tool proved to be highly suitable for such use case since all views are interactively linked together. therefore, the biochemists can, for instance, easily select a given part of simulation in the scatterplot and immediately observe the ligand transportation through the protein molecule in 3d .
fig.  <dig> small part of the molecular simulation showing the exact time span when the tcp– <dig> was penetrating the protein




the biochemists concluded that our tool gives them the necessary insight to the complex ligand trajectories and helps to reveal their interesting parts in an intuitive manner. such exploration was very hard to perform using the previous approaches which were based on the 3d view and animation of the ligand movement.

CONCLUSIONS
in this paper we presented a novel visualization system which helps the biochemists to explore long trajectories of the ligand movements. the system enhances the workflow of the biochemists namely in the following ways. first, the overview visualization along with the bar chart view helps to navigate the user to the most interesting parts of the ligand trajectory. second, the process of understanding the ligand behavior is further supported by the scatterplot matrix. the scatterplot matrix enables to explore different attributes of the ligand trajectory. additionally, the biochemists can further explore the spatial representation of the ligand trajectory using the 3d view. the visual analysis of the ligand movement in the 3d view is enhanced by employing automatic and/or interactive simplifications of the trajectory.

in the future we plan to extend the trajectory simplification method and employ a caching of the simplified trajectory also when the user decreases the level of simplicity of a selected part of the already simplified trajectory. although we did not observe in our experiments any chemically irrelevant behavior when simplifying the trajectory, we plan to employ the information about computed tunnels to ensure that the simplified trajectory still passes through the void space.

