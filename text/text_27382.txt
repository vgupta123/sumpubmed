BACKGROUND
for the adaptation of biological systems towards external and environmental stimuli usually a complex interaction network of intracellular biochemical components is triggered. that includes changes in the gene expression at both the mrna and protein level. considering a certain stimulus as an input signal to the system and mrna or protein levels as outputs, the connecting network may include interactions between signal transduction intermediates: transcription factors and target genes. generally, the term “gene-regulatory network”  summarises genetic dependencies, which describe the influence of gene expression by transcriptional regulation,
 <cit> .

the inference  of grns is important for understanding intracellular processes and for potential manipulation of the system either by specific gene mutations, knock-downs or by treatment of the cells with drugs, e.g. for medical purposes. towards a full understanding in terms of a complete network, partial models of the network give intermediate results which help to refine the knowledge and to design new experiments. still, many gene-regulated cellular functions, e.g. stem cell differentiation, depend on more than one stimulus and the cross-talk within the grn, e.g.
 <cit> . on the other hand, the stimuli might influence distinct components of a grn. such biologically relevant dependencies can be investigated by applying two or more stimuli and measuring the influenced genes. this approach can be called multi-stimuli experiment. if this is carried out in two or more separate experiments, one derives multi-stimuli multi-experiment data. only algorithms with the ability to consider those data can infer such dependencies.

as shown in review articles, e.g.
 <cit> , there are different inference methods using various sources of information thus leading to different results. amongst the typically mathematical models the application of differential equations describing time-resolved gene expression data  has been proven successful. unfortunately the potential complexity of the networks leads to a high number of structural connections and parameters in contrast to the comparably small number of available measurement data. apart from the problem of identifiability, the number of possible parameter combinations is very large, thus resulting in high computational costs. therefore, appropriate heuristic approaches can reduce this amount while providing comparably good inference results. netgenerator is a heuristic algorithm, which considers time series data to automatically infer grns influenced by an external stimulus,
 <cit>  and
 <cit> . the approach combines a structure  and parameter optimisation. the final result in form of a differential equations model can be simulated and displayed graphically. an earlier version with less functionality was applied successfully to biological problems, e.g. the regulatory network of iron acquisition in candida albicans and the analysis of the aspergillus fumigatus infection process,
 <cit>  and
 <cit> .

in the present article, we propose netgenerator v <dig> , an extended version of the algorithm which enables the use of multi-stimuli multi-experiment data, thus increasing the number of addressable biological questions. this causes significant changes in the algorithmic procedures, especially the processing of this kind of data as well as the structure and parameter optimisation. also, some other updated features will be outlined, for example the different modes of prior knowledge integration, further knowledge-based procedures, options of graphical outputs, changed non-linear modelling and re-implementation in the programming language / statistical computing environment r,
 <cit> . further, in comparison to the previous version, some of the algorithmic procedures will be explained in more detail, because they are important for understanding the overall method.

the successful application of the novel netgenerator will be shown by inference of relevant multi-stimuli multi-experiment benchmark examples, namely systems with a different degree of cross-talk. two aspects will be assessed:  reproduction of the benchmark systems  and  refinement / extension of a network structure by combination of different experimental data. furthermore, the applicability of netgenerator to a real-world problem is presented: after describing necessary data pre-processing steps, the underlying grn of chondrogenic differentiation of human mesenchymal stem cells, a process influenced by the two stimuli tgf-beta <dig> and bmp <dig>  is inferred.

methods
in the following subsections the necessary background knowledge and methodology of the netgenerator algorithm is described. in comparison to previous publications this includes new, updated and more detailed algorithmic procedures. first, the motivation and the goals are defined by considering the biological data. necessary steps of data pre-processing are also explained within this subsection. subsequently, ordinary differential equations and some of their properties are presented as a means for modelling the dynamics of gene regulatory networks. then the heuristic approach of the algorithm is explained including the structure and parameter identification . the next important topic will be the consideration of prior knowledge, followed by a subsection about the numerical simulation as well as the representation of modelling and graphical results. finally, some important options and their influence to the algorithm are presented.

time series data and pre-processing
gene expression time series data as required by netgenerator are typically derived from microarray measurements. before starting the network inference, raw microarray data have to be processed comprising a series of steps. the three main steps are displayed in figure
1:  microarray pre-processing,  gene selection and  time series scaling.

microarray pre-processing applies multiple procedures to remove non-biological noise from the data and to estimate gene expression levels. custom probe-sets, as assembled by
 <cit> , reduce the number of cross-hybridising probes. this initial reduction accomplishes a one-to-one correspondence between probe-set and gene. background correction, normalisation and summarisation are provided by the rma package,
 <cit> , resulting in logarithmised gene expression estimates, which can be used for the next processing step.

gene selection  is the important second step of processing, since reliable network inference is only feasible for a sufficient number of measurements per gene
 <cit> . this number is often limited and therefore a selection of genes for modelling is inevitable. candidate genes should show pronounced temporal dynamics and significant differences compared to the control group. statistical methods for identification of differentially expressed genes are widely used for gene selection. we use the limma tool, which can operate on time series data determining significance of gene expression changes over time
 <cit> . the statistical test  operates on contrast terms, defined by subtracting the control group at each time point. limma returns a ranked table for all genes containing columns for gene name, fold-change and adjusted p-values. differentially expressed genes are selected by a combination of adjusted p-value cut-off and fold-change criterion.

time series standardisation is the last processing step including centering and scaling of each time series. the centering procedure subtracts the original initial value at the starting time point from all values such that the transformed time series starts from zero. in the subsequent scaling procedure each time series is divided by its maximum  across all provided experimental data. this leads to gene-wise scaled data and gene expression time series varying within −1and  <dig>  the resulting data provided to the netgenerator algorithm are stored in
x=e and
u=e, i.e. matrices for the time series  and stimuli  data, respectively, for all experiments e =  <dig> …,e. therefore, the dimensions are
x=e:te×n and
u=e:te×m with te being the number of experimental time points, n being the number of time series and m being the number of inputs. furthermore, netgenerator provides the option of introducing additional artificial data points by cubic spline interpolation.

grns considered as linear time-invariant systems
the netgenerator algorithm infers dynamical models of grns. their general non-linear dynamics can be described by a set of first-order time-invariant ordinary differential equations , initial conditions, and time range 

  x˙-=f-x-,u-,θ-x-0=x-t≥t <dig> 

with the vector of state variables
x- and their changes
x˙- as a function
f- of state variables, input vector
u- and parameter vector
θ-. the state variables and inputs depend on time t, the independent variable, that is dropped in further equations. the description is valid for a certain time range starting at t <dig> from the initial conditions for the state variables
x- <dig>  if not stated otherwise each of the state variables corresponds to one specific output variable, i.e. one time series. the dimensions of the variables are
x-:n× <dig> 
u-:m× <dig>  and
θ-:p× <dig>  with n being the number of state variables, m the number of inputs and p the number of parameters.

even though netgenerator has a non-linear modelling option, the core mechanisms are based on linear modelling. under the assumption that most networks can be considered linear and time-invariant, the differential equation system in  can be modified resulting in the linear state-space equation system

  x˙-=a=x-+b=u- 

with the system or interaction matrix
a=:n×n and the input matrix
b=:n×m. most important for the understanding of the biological systems properties and the heuristic approach of the netgenerator algorithm is the system matrix
a= and its elements ai,j, i,j ∈ n, because they describe the dynamics and the coupling of state variables.

under the assumption, that the behaviour of a grn is described sufficiently by indirect transcriptional events and not by a conversion of material, activation  or inhibition  of state variable xi is not changing the value of the originating state variable xj.

without any further assumptions all elements of
a= and
b=, adding up to n <dig> + m·n, had to be determined. typically, in grns there are far less connections than theoretically possible leading to a sparse matrix
a=. regarding this property and avoiding problems occurring by the number of usually available measurement data  the netgenerator algorithm applies a heuristic approach as described in the next subsection.

heuristic multi-stimuli multi-experiment approach
the novel netgenerator algorithm is a heuristic multi-stimuli and multi-experiment approach. the heuristic is based on the observation that in grns the number of connections is much lower than all possible connections. further, since the applied stimulus is the cause of the observed dynamical changes, the network can be considered as a hierarchical structure originating from the input. the netgenerator algorithm implements both observations by an iterative development of the state-space system  by including coupled sub-models for each time series based on a structure optimisation iteratively increasing the number of connections. structural changes are taking place only if they result in a better adaptation of simulated to measured behaviour. the terms multi-stimuli and multi-experiment mean that the extended algorithm can handle more than one changed input and data of several experiments, respectively.

in figure
 <dig>  the main work flow of the algorithm is displayed. one outer loop, starting with empty
a= and
b=, iterates over all sub-models  to which the measured time series should be linked. at the ith iteration step of the outer loop already i −  <dig> time series have been included in the model as sub-models. there are n − i +  <dig> remaining time series to be included. the ith state equation  would be described by

  x˙i=∑n∈niai,nxn+∑m∈mibi,mum 

containing connections from state variables, ni being the indices of state-state connections including the self-regulatory term ai,ixi, and connections from inputs with mi being the indices of input-state connections for the considered state variable xi. that means that only the parameters of sub-models have to be identified.

since the algorithm aims at a low number of parameters, i.e. small |ni| ≤ n and |mi| ≤ m, the inner loop starts with basic models for the remaining time series containing only self-regulation, one input term as well as connections from “fix” prior knowledge if available, see respective subsection. those basic structures can be extended by further incoming connections  from already included sub-models and further inputs. every structural change requires a parameter identification of the active connections with respect to the considered time series, as will be explained later in the corresponding subsection. for every different set of parameters the resulting model needs to be simulated, that is the numerical solution of an initial value problem has to be found, as will be described later in another subsection.

the basic sub-model which reproduces one of the remaining time series best, is chosen for further improvement, for details see figure
 <dig> , and included into the model as a state variable. the most important structural improvements are 

•“growing”: further connections added

•“higher order”: increase sub-model order

•“pruning”: connections removed

in the improvement step “growing” is not restricted to connections from time series that are already included in the model. for describing the influence of time series that have not yet been included as sub-models, the corresponding measured and interpolated data are used as inputs. those connections form global feedbacks in the final model.

the increase of the dynamical order within the description of a time series is realised by r− <dig> additional equations or intermediate state variables leading to the following form:

  x˙i=ai,ixi+∑n∈ni∖{i}ai,nxn+∑m∈mi∖{i}bi,mumx˙i+1=ai,ixi+1+xi⋮x˙i+r−1=ai,ixi+r−1+xi+r− <dig> 

in this way the dynamics of a certain sub-model are described by an rth order integrator chain allowing for reproduction of processes with more complex time courses. it should be emphasised that by applying this approach the number of parameters is not increased but on the other hand the number of state variables becomes larger than the number of time series data. in that case only the state variable with the highest order in such a sub-model is to be compared to time series data. still, for the sake of simplicity all following algorithmic procedures are described for first-order sub-models.

in terms of the iterative process of including sub-models the different elements of the final system matrix

  a==a <dig> a <dig> ⋯a <dig> nsa <dig> a <dig> ⋮⋱ans,1ans,ns 

describe forward, local feedback and global feedback connections. elements below the main diagonal become forward connections, whereas the main diagonal elements
a <dig> ,…,ans,ns describe local feedbacks or self-regulations, while the elements above the main diagonal represent global feedbacks. from a biological point of view the local feedbacks describe different mechanisms including not only feedback regulation, but also the important process of mrna-degradation.

all the previously described structural procedures and the corresponding parameter identification are controlled by a-priori defined settings and options of the algorithm. some of them are balancing network complexity and error between measurement and simulation. for example, additional connections are rejected if they are not improving the objective function value to a significant extent while on the other hand connections are removed only if they are not worsening the result significantly. further important options of the algorithm are explained in the respective subsection.

parameter identification
the parameter values of an active sub-model are identified by a non-linear optimisation, minimising the error between simulated and measured time series data of multiple experiments. the initial parameters required for this optimisation are obtained by a linear regression. for one specific first order state variable xi equation  can be rewritten as

  x˙i=u <dig> …,umi,x <dig> …,xni·θ-i,init 

with

  θ-i,init=b <dig> …,bmi,a <dig> …,anit 

 being the parameter vector of some of the elements of
b= and
a=, respectively, as determined by structural optimisation using only a subset of inputs and state variables influencing the considered ith state variable. satisfying the measured data in an optimal way the unknown parameters can be determined by the following equation of linear regression, see e.g.
 <cit> ,

  θ-i,init=u=x=tw=u=x=−1×u=x=tw=x˙-i,num 

with the weight matrix
w= and the state variable derivatives
x˙-i,num. the latter are calculated by numeric differentiation of the respective time series  data. this means the vector
x˙-i,num is not the vector of state variables but the vector of time points of the considered time series derivatives. its length  equals the sum of the number of measurement time points and interpolation time points, as outlined in the subsection on data pre-processing. the reason for the use of interpolated data is the avoidance of over-fitting. the different influence of measured and interpolated values is considered in the elements of the weight matrix
w= possessing the dimensions t × t. since the model must be valid for all e experiments, the respective input and time series data are concatenated, indeed resulting in
t=∑te, e =  <dig> …,e. this becomes possible because the regression approach implicitly assumes a “dynamic independence” of data points. the dimensions of the other variables are
u=:t×mi and
x=:t×ni, with the number of rows of each matrix also equalling to the total number of time points. both dimensions of
u= reflect necessary algorithmic changes due to the consideration of multi-input multi-experiment data in this netgenerator version, because |mi| >  <dig> represents multiple inputs while the concatenated data of length t considers multiple experiments. for the sake of completeness it should be mentioned that higher-order sub-models are initialised first by their first-order equation and then adapted such that total time constant and static gain remain the same.

the non-linear optimisation of the parameters for the ith sub-model, initialised by the solution of the linear regression , is based on the minimisation of the objective function 

  ji,output=∑e=1e∑k=1te,iw·xe,i−x^e,i <dig> 

describing the deviation between measured xe,iand simulated
x^e,i time series at different time points tk depending on the parameter vector
θ-i. the minimisation following  is an optimisation problem of the least squares type featuring a double sum of experiments e =  <dig> …,e and time points k =  <dig> …,te,i. in contrast to the objective function applied in former netgenerator versions, now e multiple experiments are considered. the simulated time series are compared to measured and also interpolated data weighed by different w avoiding over-fitting. a further weighing based on properties of the data, like for example the maximal range, is not necessary since the described pre-processing normalises and scales the data. for the optimisation problem, the new netgenerator implementation applies the “l-bfgs-b” algorithm,
 <cit> , of the optim r-function, which has the ability to solve bounded non-linear optimisation problems.

consideration of prior knowledge
for improving the results, prior knowledge about the network connections can be integrated into the network inference. this version of netgenerator provides two modes for integration of prior knowledge about connections of stimuli on time series as well as between the time series:  “fix” and  “flexible”. for both modes the knowledge can be provided in form of connection matrices
a=fix—flexible and
b=fix—flexible resembling the system matrix and input matrix, respectively, as well as additional matrices containing reliability scores of the connections. the connection matrices can contain single-valued information about connection , no connection , activation  and inhibition . fix integration represents rigid model requirements that cannot be ignored by the heuristic. therefore fix connections are always included in the model structure.

flexible integration allows the inference heuristic to ignore prior knowledge when the model fit is substantially worsened. this is represented by an additional term in the objective function  now resulting in

  ji=ji,output+λ∑j∈nisi,jadi,ja+∑k∈misi,kbdi,kb. 

the term ji,output corresponds to the previously in  defined evaluation of output deviation, while λ weighs the overall consideration of prior knowledge, s represent the score values of the respective prior knowledge and d describe the distances between the prior knowledge and the modelled structure  evaluated by comparison of signs. that means the resulting elements of
a= and
b= are converted into the described notation of  <dig>   <dig>   <dig>  and − <dig>  thus permitting a comparison with elements of flexible prior knowledge connection matrices. here we consider two types of prior knowledge origin:  gene interactions automatically extracted from published literature and  predicted transcription factor binding sites  in the proximal promoter region of target genes.

for the extraction from published literature the software pathway studio v <dig> provides a gene relation database termed resnet mammalian, which has been compiled by automatic extraction of interactions from pubmed, as evaluated by
 <cit> . as shown in the latter publication, gene relations derived from pathway studio v <dig> can be considered of high quality, since in general scientific literature is a reliable resource and the false positive rate is reported to be about  <dig> %.

further, the tool matrix-scan from the rsat toolbox determines putative tfbs in the promoter regions of target genes, which might be involved in transcriptional regulation
 <cit> . this approach requires known sequence motifs of the investigated transcription factors as well as promoter sequences. sequence motifs are stored in form of position weight matrices , which describe relative nucleotide frequencies for each motif position, as can be obtained from the transfac database 
 <cit> . gene promoter sequences are available from ensembl using biomart,
 <cit> .

additional prior knowledge about the regulatory potential of the individual genes can be obtained by examining the known molecular functions. for example, the interaction between genes coding for non-regulatory proteins, such as structural proteins, and target genes can be assigned “no connection”.

simulation and graphical output
for every comparison of measurement and simulation as well as the generation of results the model equations  must be integrated. this corresponds to an initial value problem that is solved numerically. since the recent implementation of the netgenerator algorithm is in r, repeated operations of certain types take a long time. therefore, the model itself is implemented in c, created iteratively and simulated applying the implicit method “impadams” of the r-package desolve,
 <cit> . the necessary initial conditions
x-0=x- are either measurement data or extrapolated measurement data typically at t0 =  <dig> of the respective time scale.

the final result of the netgenerator algorithm is a parametrised model of the considered grn. moreover, the new implementation of the algorithm contains important graphical output facilities which have been extended to meet the needs of displaying multi-input multi-experiment data as well as different results concerning prior knowledge. first, there is a graphical comparison of measurements and simulations, showing the single measured data points and the corresponding simulated trajectory. this can be done either by comparison of each component  over all experiments or by displaying the data for each experiment independently. second the resulting network structure can be displayed as a directed graph applying the language dot and the software collection graphviz,
 <cit> . nodes denote the biochemical components, e.g. genes, and edges display connections of either activation or inhibition. in case of applying prior knowledge , a comparison between the inferred network and this knowledge is displayed with a colour code. black edges denote inferred connections without prior knowledge, green edges present an agreement, red edges could either have a wrong sign  or be connections that do not comply with prior knowledge, while grey dashed edges stand for prior knowledge not reproduced in the inferred network.

further settings and updated methods
the netgenerator algorithm itself can be controlled by parameters  and also contains further methods that will be summarised in the following. an important setting is the “allowederror” that controls the structure optimisation. if the objective function value of a certain sub-model structure is worse than this value the model structure must be extended as described. therefore smaller values of “allowederror” are indirectly leading to more complex structures. further important settings are the maximal number of connections and sub-model order.

additional updated or new methods, not described extensively here, include non-linear modelling and knowledge-based methods. the optional non-linear modelling approach contains an additional sigmoid transformation of the linear combination described in this publication. this transformation has its biological background in the saturating behaviour of gene expression. the additional non-linear parameters of each sub-model are determined by the described non-linear parameter identification, too. amongst further knowledge-based methods, the most important presents the possibility of retrieving network information from databases and combining this information with the inferred model in a directed graph. in that way, the biological interpretation can be extended by introducing unmeasured components into the network structure.

availability
the algorithm has been implemented as a package in the programming language / statistical computing environment r,
 <cit> . it is available in form of a testing bundle containing both the algorithm and the examples at http://www.biocontrol-jena.com/netgenerator/netgeneratorbundle.zip

RESULTS
example networks
we applied the netgenerator algorithm, which has been described extensively in the methods section, to  <dig> benchmark examples and  <dig> real-world example to examine the performance of our approach. at first, we consider the three benchmark systems, their corresponding artificial data and inferred networks in order to test the reliability and performance of our algorithm. particularly, we investigated whether network inference from multiple data sets, originating from different stimulation experiments, is beneficial. finally, we applied netgenerator to microarray time series data gained from human mesenchymal stem cells. we focussed on the modelling of gene regulation that occurs during in vitro stimulation of chondrogenic differentiation of these cells, with emphasis on the different effects triggered by multiple stimuli in the inferred model.

benchmark examples
we constructed three fully parametrised benchmark systems based on linear time-invariant descriptions, i.e. they are composed of differential equations representing the time series of genes and two external stimuli . the systems are characterised by a different degree of cross-talk between the components with respect to the external stimuli, that is “full cross-talk” : all components are influenced by all stimuli, “limited or low cross-talk” : some of the components are influenced by more than one stimulus, and “no cross-talk” : the stimuli influence distinct components resulting in separate networks. they also differ in the number of genes  and the parameters. the artificial data were generated exhibiting characteristics of real microarray time series data, i.e. low number of time points , exponentially increasing time intervals, and additional normally distributed noise
n. in summary, this procedure led to sample data sets containing matrices with number of rows equalling number of genes and six columns .

evaluation measures. the network inference of benchmark systems can be evaluated by determining the final objective function value  j according to equation , the computation time tc, and statistical measures that quantify the performance of the network inference by comparing the known structure with the inferred structure. the indicated computation times resulted from running the examples on a x86-pc with a  <dig>  ghzcpu. the measures comprise sensitivity , specificity , precision  and f-measure . the definitions of the measures take into account the correctly integrated edges , the falsely integrated edges , the truly missing edges  and true edges that are not contained in the model result . false positives  were further grouped into fps, connections integrated with wrong sign and fpn, modelled interactions which are not present in the real network. this leads to the following definitions:

 se=tp/sp=tn/pr=tp/fm=2·pr·se/ 

for all three benchmark examples, we evaluated the inference by those statistical measures showing the reproduction of the system structure and time series by the model.

fct scenarios and network inference evaluation. for fct, artificial data generation and subsequent network inference was performed within three scenarios:  “s1”: single experiment applying only u <dig>   “s2”: single experiment applying only u <dig> and  “m”: multiple experiment integrating experiments “s1” and “s2”. for the special case of fct, the scenarios allowed us to directly compare the inference of multiple stimuli data sets with the inferences of single stimulus data sets.

we applied the network inference to each of the three scenarios  for a series of  <dig> different settings varying the previously described “allowederror” =  <dig> ,  <dig> , …,  <dig>  resulting in  <dig> models, see figure
 <dig>  results for all statistical measures are depicted as connected points in individual boxes. the three scenarios are plotted in distinct colours  in each box. with regard to sensitivity, m models performs best, showing gradually decreasing values. specificity obtains highest values for the first and second model. f-measure results, which benefit from high sensitivity values, display good performance for all m models. the resulting model error increases gradually as expected, due to the increased “allowederror”, which is defined per time series. analysing these results, we found “m 1”  to be optimal with respect to the evaluation measures . for this model, the computation time was tc =  <dig> s.

dynamics of this model are displayed in figure
 <dig> showing a good reproduction of all time series for each of the two experiments. in figure
 <dig>  the corresponding regulatory network is presented in form of a directed graph. here, the colour code is not denoting a reproduction of prior knowledge but a graphical means displaying tp , fp  and fn  connections.

lct and nct network inference evaluation. in order to test whether netgenerator is capable of inferring different cross-talk structures, we generated benchmark systems lct and nct. both contain biologically motivated types of cross-talk, such as cross-talk of downstream components or separate sub-networks . inference of both networks was successful, shown by high statistical measures , the inferred network structures in figure
 <dig> and figure
 <dig>  and the good reproduction of the time courses . the computation time for inference of lct and nct was tc =  <dig> s and tc =  <dig> s, respectively.

chondrogenesis model
background of chondrogenic data. human mesenchymal stem cells  are multi-potent adult stem cells that have the capacity to differentiate into a variety of cell types depending on the external stimulus,
 <cit> . regulation of lineage-specific genes is crucial in this temporal process,
 <cit> . transforming growth factor -beta <dig> is essential for induction of chondrocyte differentiation of hmsc, a process which is strongly enhanced by the additional presence of bone morphogenetic protein  <dig> 
 <cit>  and
 <cit> . in this section, we describe the complementary effects of tgf-beta <dig> and bmp <dig> by multi-stimuli multi-experiment inference applying the netgenerator algorithm.

microarray time series data. hmsc from bone marrow were commercially obtained  and cultured as described in
 <cit> . to induce chondrogenic differentiation trypsinised hmsc were pelleted and subsequently incubated in culture medium supplemented with  <dig> nm dexamethasone,  <dig> ng/ml tgf-beta <dig> and, if applicable,  <dig> ng/mlbmp <dig>  time-dependent gene expression was studied under three experimental conditions:  following treatment with tgf-beta <dig> ,  following treatment with tgf-beta <dig> + bmp <dig>  and  untreated hmsc as a control. at  <dig> different time points  hafter addition of the stimuli, rna was isolated from three technical replicates per time point and measured on affymetrix hg-u133a microarrays.

pre-processing and filtering. raw microarray data was pre-processed as described in the corresponding sub-section. this included the use of custom chip definition files provided by
 <cit>  and application of the rma method
 <cit> . this procedure resulted in logarithmised gene expression estimates for  <dig> 095genes.

modelling a small-scale grn using microarray data requires adequate filtering of genes. we tested all genes for differential expression, used functional annotation and expert knowledge. differentially expressed genes were identified for both experiments  by computing adjusted p-values using limma. all genes with an adjusted p-value less than 10−10and an absolute fold-change greater than  <dig> for any time point were considered significant. using those criteria,  <dig> genes were found to be differentially expressed compared to control as well as between “t” and “tb”. subsequently, we selected from this group  <dig> annotated transcription factors  and associated  <dig> of them  with our investigated process . those genes may be involved in promoter-dependent regulation, which is important for binding site predictions. furthermore, we added col2a <dig>  acan, col10a <dig>  all three essential marker genes of chondrocyte differentiation, which encode essential structural proteins of the extracellular matrix.

prior knowledge. prior knowledge was taken into account as described in the corresponding sub-section. gene interactions were retrieved from the pathway studio resnet mammalian database. we obtained  <dig> gene-gene and  <dig> input-gene regulatory interactions. gene-gene interactions were passed as flexible prior knowledge to netgenerator. input-gene interactions were not integrated. additionally, potential gene interactions were determined by binding site predictions. for this purpose, we obtained pwms for sox <dig>  mef2c and msx <dig> from the transfac database and promoter sequences  <dig> bp upstream from the transcription start site. both pwms and sequences were loaded into matrix-scan from rsat, which is performed with default options  and organism-specific estimation of background nucleotide frequencies. the resulting significant binding sites have been listed in the table of additional file
 <dig>  the observed high significance of all matches minimises the risk obtaining similar results from random sequences.

network inference of multi-stimuli  multi-experiment data. after pre-processing, the input and time series data of the microarray experiments were passed to netgenerator for automatic network inference. according to the experimental set-up, the available data sets describe two experiments: only tgf-beta <dig> stimulation  and tgf-beta <dig> + bmp <dig> stimulation . this is mirrored by the two distinct input data matrices both describing the respective stimuli by step functions

 u=t=1010⋮⋮ <dig> u=tb=1111⋮⋮ <dig> 

model evaluation and validation. the inference results of the chondrogenic system, the grn and the graphical comparison of time series, are displayed in figure
 <dig> and additional file
 <dig>  respectively. the resulting network contains  <dig> connections:  <dig> gene-gene connections and  <dig> input-gene connections. compared to the prior knowledge, there are  <dig> green connections ,  <dig> red connection  and  <dig> blue connections .

for validation, we performed resampling which is based on random perturbation of time series data. a gaussian noise component
n was added to the time series data which is used for subsequent model inference. repeated performance  led to a series of inference results as well as relative frequencies for each of the connections of the nominal model, i.e. the proportion of models containing that specific connection. those frequencies imply a reliability ranking of all nominal connections. most of the connections were inferred with high frequency,  %, see figure
 <dig>  particularly, this applies to connections which reflect prior knowledge. also, inferred connections which are associated with a predicted binding site  were present in more than  <dig> % of the models.

network interpretation. sox <dig> exhibits a central role in this chondrogenic network and is activated by both tgf-beta <dig> and bmp <dig>  this indicates a complementary effect of both stimuli on the expression of sox <dig>  activated sox <dig> drives the expression of its target genes col2a <dig>  acan and col10a1
 <cit> . this regulation marks the essential formation of cartilage-specific structural components of the extra-cellular matrix and the differentiation of hmsc towards chondrocytes. beside this process, sox <dig> also activates the repressor gene trps <dig> and vice versa. regulatory interactions between both factors has not yet been addressed in the literature. additionally, the sox <dig> binding motif is present in the proximal promoter of the trps <dig> gene according to the prior knowledge. there is also a modelled effect from trps <dig> on mef2c, which in turn activates col10a <dig> and acan, but represses sox <dig>  this represents a negative global feedback from mef2c on sox <dig> in our model. mef2c also represses the expression of msx <dig>  which is solely activated by bmp <dig> stimulus and activates col2a <dig> according to the prior knowledge
 <cit> . msx <dig> also activates the satb <dig> gene, which in turn activates mef2c expression. negative regulation of acan by tgf-beta <dig> is contrary to prior knowledge, as indicated by the red connection of the network graph. however, tgf-beta <dig> can also activate acan indirectly through sox <dig> 
 <cit> . in summary, the central player sox <dig> is influenced by both tgf-beta <dig> and bmp <dig>  essential structural proteins are not solely regulated by sox <dig>  but also by other transcription factors . moreover, sox <dig> and msx <dig> are repressed by mef2c through negative feedback that involves trps <dig> and satb <dig> 

discussion
the netgenerator algorithm for automatic network inference from multi-input multi-experiment time series data and prior knowledge, described in the methods section, will be classified and distinguished from other methods in the next sub-section. therefore, its properties will be reviewed and justified showing advantages and disadvantages to other approaches. our discussion contains a wide spectrum of other methods, but will only go into detail for the ones closely related to netgenerator. also, further specifications of netgenerator will be summarised without a detailed comparison to other methods.

classification of the algorithm
good review articles on methods for automatic inference of grns can be found in
 <cit> . the different methods can be classified by the data type , the mathematical approach  and the result  whereby various combinations are possible. mutual information methods  are based on evaluating the statistical dependencies of large data sets resulting in undirected graphs. in comparison to netgenerator they possess far different preconditions and purposes, for example they do not consider a concerted influence of the variables or the dynamics of the state-space concept, and therefore a more detailed comparison is set aside. even though dynamical boolean networks for gene-regulation, first proposed by
 <cit> , possess some similarities to discrete-valued state-space models, their rule-based approaches typically lead to rather qualitative results .

very often, like in case of the core elements of netgenerator, grns are based on linear modelling, i.e. the behaviour of one variable depends on a linear combination of other variables. still the method can be a combination of either probabilistic or deterministic approach as well as algebraic correlation modelling  or dynamic modelling . in the case of the probabilistic modelling which is especially covered by static and dynamic bayesian networks  the inference is based on the application of probability distributions to describe the uncertainties or noise inherent in grns. beside the differences in the mathematical approach, probabilistic modelling includes the determination of statistical parameters and therefore generally more data replicates are required in comparison to deterministic modelling approaches such as netgenerator.

deterministic linear modelling applied to automatic network inference,
 <cit> , can be distinguished into at least two types depending on the results:  algebraic equations systems, e.g.
 <cit> , and  differential  equations systems, e.g.
 <cit> . although they have different prepositions on the dynamics of time series data, both types can be solved by linear regression. still, there is a disproportion between the number of free parameters and available measurement data on the one hand and the property of sparsity of grns on the other hand. for the former interpolated data points can be applied under the assumption that the influence of the chosen interpolation on the results can be neglected. for the reproduction of sparse networks the regression can be combined with model reduction, for example using the large group of lasso-based algorithms, see e.g.
 <cit> , on the basis of pca ,
 <cit> , or a combination of both,
 <cit> . for further approaches, see the aforementioned review articles.

in contrast to all these methods, we propose the netgenerator algorithm dealing with the problem of data number and sparsity in a different way. the algorithm is not inferring the network structure and parameters in one go. instead we applied an heuristic approach of explicit structure optimisation, which iteratively generates a system of sparsely coupled sub-models. in that way, the grn property of possessing more or less hierarchical input to output structures is reproduced. thus, only the parameters of sub-models describing one time series have to be determined. a major drawback of regression-based solutions of linear differential  equations systems is the necessity of applying numerical derivatives of small sample size and noisy data, which have a strong influence on the resulting network and modelled dynamics. netgenerator uses a different solution, whereby the regression just provides initial parameters for a non-linear optimisation of an objective function of the least squares type. overall, the final dynamic network can be obtained by a lower computational effort, because in comparison to the total number of parameters  in the model description  only a small number of parameters has to be determined.

inference from multi-stimuli multi-experiment time series data
the concept of inferring from multiple data sets is also applied by
 <cit> , however on the basis of principal components of those data sets. the work of
 <cit>  provides a multiple methods framework to integrate distinct types of data like steady-state and time series data, focussing mainly on the combination of knock-out and stimulation data.

the proposed netgenerator v <dig>  algorithm allows for integrating data sets of multiple experiments with multiple stimuli. in the inferred models, weighed input terms represent external stimuli and resulting grns represent the merged effects of the diverse experiments. therefore, from a biological point of view, the algorithm is able to handle experiments which investigate the degree of cross-talk.

we applied and tested this feature for  <dig> benchmark examples and  <dig> real-world example, the gene regulation during chondrogenic differentiation. the evaluation of the benchmark examples’ results showed the power of the algorithm to infer the network structure and to reproduce the time series. further, for a special system of “full cross-talk”, i.e. all components are influenced by all stimuli, we could show that the simultaneous utilisation of different data sets leads to higher model quality compared to modelling data sets individually. the reason for this effect is due to the different stimulation by another external input which alters the time series data qualitatively and quantitatively, something that could not be achieved by biological replicates of a single input experiment. this underlines the benefit of using our integrated approach. further, the presented examples lct and nct are possible outcomes of grn investigations. in the first case, there are two different types of genes: some are induced by one stimulus only and some are induced by multiple stimuli. the model inferred by netgenerator contains both the separate and common structural elements. the special case of nct occurs, if network parts are stimulated that are not connected at all. in summary, the extended netgenerator takes advantage of multi-stimuli multi-experiment data by network refinement and extension.

we further inferred a two-stimulus network for hmsc differentiating towards chondrocytes. this network model contains gene regulatory events following the stimulation with two distinct chondrogenic factors, therefore providing a view on how genes involved in differentiation might be controlled by external molecules. applying a subsequent resampling gives further information about the connections of this inferred grn:  the majority of connections, especially the ones of prior knowledge and predicted binding sites, occur with a high frequency which can be considered a measure of reliability and  the ranking of the frequencies can be used in interpreting the results with regard to biological hypotheses. overall, this shows the importance for an extension of netgenerator to deal with multiple data sets.

consideration of prior knowledge
the means to integrate prior knowledge  into the network inference is a distinctive feature of the extended netgenerator algorithm achieved by modifying the objective function. this feature can reduce the complexity of the structure optimization, although it strongly depends on the origin and quality of the given knowledge, see e.g.
 <cit> . using prior knowledge for network inference can also be found in several other algorithms, see
 <cit> .

for our example of chondrogenic differentiation, we exemplarily showed network inference using flexible prior knowledge about regulatory interactions extracted from a database . the graphical evaluation of the inferred network showed very good reproduction of the proposed prior knowledge. further predicted connections could be associated with potential regulatory binding sites generated from sequence data .

further aspects
apart from the linear modelling presented in detail, the ability of netgenerator to infer a non-linear model has been mentioned as a further option. the additional sigmoid function describing saturation in gene-expression has been proven successful before, e.g.
 <cit> . since the sigmoid transformation has also been used for neural network models, those inference methods are sometimes classified as such.

besides the many advantages and possible application areas, there are minor restrictions of netgenerator: it should be applied to pre-processed data without high correlations, it infers networks from measured time series data and due to the heuristic approach it cannot be proven that the global solution was found. the latter can be improved by decreasing the influence of noisy data using a bootstrap  approach, see chondrogenesis example and
 <cit> . one feature which might be introduced in subsequent versions is the application of “interventional” multi-experiment data, i.e. data originating from perturbations within the system. this can be dealt with by applying either experiment-wise prior knowledge or an additional module in the structure optimisation explicitly dealing with that kind of data.

CONCLUSIONS
we presented the novel netgenerator algorithm for automatic inference of grns, which applies multi-stimuli multi-experiment time series data and biological prior knowledge resulting in dynamical models of differential equations systems. this heuristic approach combines network structure and parameter optimisation of coupled sub-models and takes into account the biological properties of those networks: indirect transcriptional events for information propagation, limited number of connections and mostly hierarchical structures. the analysis of benchmark examples showed a good reproduction of the networks and emphasised the biological relevance of inferred networks with a different degree of cross-talk. the ability to infer a real-world example based on multi-stimuli multi-experiment data was shown by application of netgenerator to a system of growth factor-induced chondrogenesis.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
mw and sgh drafted the manuscript. sgh and dd contributed to the development and programming of the netgenerator algorithm and software as well as to the mathematical and modelling background. mw and rg contributed to data processing, application of netgenerator to examples, statistical evaluation and the biological interpretation. sv contributed to the generation of the benchmark systems and their artificial data. ejvz contributed to experimental set-ups, measurements and biological interpretation of the chondrogenic investigation. all authors read and approved the final manuscript.

supplementary material
additional file 1
figure: “limited cross-talk” example, time courses. comparison of the “limited cross-talk”  network time courses. each panel displays the results of one gene: the simulated time course , interpolated measurements  and the measured time series  for both data sets .

click here for file

 additional file 2
figure: “no cross-talk” example, time courses. comparison of the “no cross-talk”  network time courses. each panel displays the results of one gene: the simulated time course , interpolated measurements  and the measured time series  for both data sets .

click here for file

 additional file 3
table: results of rsat. results of rsat matrix-scan tool using transfac pwms and genomic dna sequences from ensembl. each row represents a predicted binding site with transfac motif , target gene, start and end coordinates, the matched sequence, match score  and associated p-value.

click here for file

 additional file 4
figure: chondrogenesis system, time courses. comparison of the chondrogenesis system time courses. each panel displays the results of one gene: the simulated time course , interpolated measurements  and the measured time series  for both data sets .

click here for file

 acknowledgements
we would like to thank all our linconet project partners of the erasysbio+ initiative. also, we kindly acknowledge the support of this work by the bmbf  funding mw within this initiative . further, we acknowledge the virtual liver network initiative of the bmbf for granting support .
