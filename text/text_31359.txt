BACKGROUND
microarray technology is commonly used to monitor gene expression profiles. however, microarrays have also become an established technique in bacterial comparative genomics, in which the assessment of gene inventories is made at the genomic dna level. this technique is sometimes referred to as microarray genomotyping  <cit>  but also as array based comparative genomic hybridizations   <cit> . until recently it was widely assumed that adaptive evolution in bacteria occurred mainly by mutation and restricted recombination among members of the same species  <cit> . however, the availability of fully sequenced prokaryotic genomes changed this view since they provided ample evidence for extensive lateral gene transfer and it became clear that this was a major source of variation and fundamental to understand adaptive evolution in prokaryotes  <cit> . the ability to compare microbial genomes using microarrays has been used in evolutionary studies to help define microbial species, to explore the genetic diversity within individual species, to study the evolutionary history of bacterial adaptations and to identify genes potentially associated with virulence, transmission or host specificity of a given microorganism  <cit> . these studies led to the concept of a bacterial pan-genome  <cit>  consisting of the global gene pool of a given bacterial species, that could greatly exceed the gene repertoire of any individual strain  <cit> . this repertoire includes the core genome, defined as the pool of genes shared by all strains of a given species, and the dispensable genome constituted by genes present in some, but not all, strains of the same species  <cit> . the realization that the presence of certain genes could be variable or ubiquitous among members of a same species predates the genomics era. campbell in an early review  <cit> , identified "euchromosomal" and "accessory" dna and discussed the importance of gene transfer in shaping the latter. depending on the question addressed, one may be more concerned with the presence of genes characterizing the core genome, for instance to define microbial species, or with the complement of the dispensable or accessory genome carried by particular groups of strains. since a large number of virulence factors are carried by mobile genetic elements or are otherwise members of the accessory genome, the studies attempting to identify associations between genetic complement and virulence naturally focus on the genes not shared by all strains  <cit> .

microarrays used in acgh experiments are frequently constructed based on the known genome sequence of one strain, which is used as a control in each experiment. genomic dnas of the control and test strains are labeled with two fluorochromes and hybridized onto the microarray, which has spots identifying all genes of the reference genome. after scanning and image analysis, the logarithm of the ratio  of both fluorescent signals  is computed for each spot. genes present in both genomes are expected to give a clear fluorescence signal in both channels , whereas genes absent in the test sample will only have a signal in the control channel   <cit> .

if several strains of a given species have been sequenced, then it is possible to design microarrays with reporter elements representing more than just the genes in a single reference strain. the genomes of all sequenced strains can be used in microarray design. as more and more bacterial strains are sequenced, there is a clear trend towards the use of multistrain arrays  <cit> . in these cases, if only one of the sequenced strains is used as a control, in addition to detecting the presence or absence of genes found in the control, a multistrain array can now measure additions, i.e., those genes that are present in the test but absent in the control. the additions have positive lr values  <cit> . alternatively, all strains used in microarray design can be used as control if an equimolar mix of their genomic dna is labeled with the reference fluorochrome and hybridized together with the test. this mixed control provides at least a partial signal in all spots, in contrast to the single strain control option.

after surveying published studies with multistrain arrays, it is clear that there is no universally accepted standard of which control to use in these experiments. some studies have used the single strain control  <cit>  while others adopted the mix control approach  <cit> . the former frequently argue that a multistrain mix control, while generating a control signal for every spot on the microarray, leads to an increased signal intensity of core genome spots in the control channel and complicates data analysis based on ratios  <cit> . in spite of the multiple arguments invoked to support each of the approaches, we found that a study objectively comparing acgh performance of the single strain versus the mix control approach was lacking.

to fill in this gap, we performed a comparative study with a multistrain array for streptococcus pneumoniae, covering the genomes of three sequenced strains: tigr <dig>   <cit> , r <dig>   <cit>  and g <dig>   <cit> . we used two of these strains as tests  and hybridized them with two different controls: a single strain  or an equimolar mix of the three strains represented in the array .

as the true lists of absent genes for each strain where known a priori in our experiments, we could evaluate the discriminatory power of a given rule to call a spot present or absent. several statistical methods have been proposed to define this rule specially adequate to bacterial acgh experiments  <cit> . independently of the chosen method, the quality of the results is intrinsically related to the discriminatory power of the lr distribution. in principle, differences found at the level of the lr distribution will be propagated through the results of every acgh analysis method. therefore, to better evaluate the impact of the choice of control we decided to evaluate lr distributions directly, through receiver operating characteristics  analysis  <cit> . using this analysis, the best lr threshold  was defined and characterized by its accuracy, sensitivity and specificity. we then explored the differences in these evaluation parameters attributable to the choice of control sample. our results show that the use of the mix control approach provide more discriminatory lr distributions, and, consequently, less errors in the classification of genes as present or absent in the studied strain.

RESULTS
expected values and empirical distribution of lr
since the strains hybridized as test samples in our experiments have their genomes fully sequenced, we know a priori which spots should identify genes as present or absent. these expected results are compiled in table  <dig>  following the accepted methodologies in processing the results of two-color microarray experiments, the output variable of analysis is the ratio of the signal intensity of the test channel by the signal intensity of the control channel. for simplicity, the expected signal intensity of single fluorescence channels indicated in table  <dig> was assumed to take only the values  <dig>   <dig>   <dig> or  <dig>  in single strain control experiments, when a spot identifies a gene present both in the test sample and in the control, both channels have maximum signal intensity, which is  <dig>  and a resulting signal ratio of  <dig>  if the spot identifies a gene present in the test but not in the control, the test channel and control channel will have intensities of  <dig> and  <dig>  respectively. the resulting signal ratio would tend to infinity in the absence of random noise in the control channel. still, the resulting signal ratio will be larger as compared with other spot sets. in the reverse situation, when the spot is absent in the test but present in the control, the test channel and control channel will have intensities of  <dig> and  <dig>  respectively. the signal ratio is expected to be  <dig>  and once again, due to random noise, exact zeros will not be observed, resulting in small ratio values instead.

if a mixture of the  <dig> strains represented in the array is used as control, the relative intensity of the signal in the control channel can take the value of  <dig> if the gene identified by the spot is present in a single strain ,  <dig> if the gene is present in two of the strains  and  <dig> when the gene is shared by all three strains . if the spot identifies a gene present in the test sample, the resulting signal ratios will be  <dig>  3/ <dig> or  <dig>  respectively. if the spot identifies a gene absent in the test strain, all the signal ratios are expected to be  <dig>  in the absence of random noise. in practice, the three spot classes described above will produce decreasing ratio values, represented in table  <dig> as 0/ <dig>  0/ <dig> and 0/ <dig>  respectively.

the main problem of using the strain with the larger number of genes spotted in the array as control  is readily detected. there are three spot classes with an expected ratio of  <dig>  two of which have a present call while the other should lead to an absent call. in the two classes with a present call, the unity ratio results from maximal signal intensity in both test and control, while for the absent spot class, both channels should produce a null signal. in expression arrays this would not be a problem as all three classes contribute to the bulk of non-differentially expressed genes and consequently, is of no interest to the researcher. contrastingly, in acgh experiments it is crucial to differentiate these two outputs, the absent and the present call. one possible solution for this problem is to analyze the spots with oligos specific for t  separately from the ones with oligos not hybridizing with t genes.

but table  <dig> also suggests another way to circumvent this problem by using the mixture of the three reference genomes  as control. in these hybridizations all the spot classes with absent calls have expected signal ratios lower than  <dig>  using the mix control produces five different expected ratio values, with three possible levels of control signal. we then expect to improve the detection of absent/present genes by performing the analysis separately for spots that are specific for one control strain , two control strains  and all control strains .

threshold independent analysis
to evaluate the discriminatory power of lr distributions without having to specify an exact threshold value, we compared de auc of roc plots for the hybridizations with different controls, analyzing either all spots together or divided into two mutually exclusive classes. the auc values have a useful quantitative meaning: if one takes two spots, one with a true present call and another with a true absent call, the auc is the probability that the lr value of the first spot is higher than that of the second spot  <cit> . analyzing all spots together  we detected a significant increase in auc if the mix control is used . carrying out two separate analyses according to spot class , we obtain a higher discriminatory power for spots recognizing t genes, when using a t control. in hybridizations with mix control, the spots specific for one strain perform better than the ones that are specific for two strains. still, the latter have a discriminatory power equivalent to the best performing spots in hybridizations with a t control.

threshold dependent analysis
we determined the lr threshold that provided the best accuracy in gene presence/absence detection in each of the  <dig> hybridizations. figure  <dig> shows the maximum accuracy values obtained, and the corresponding sensitivities and specificities. absolute values in the left column should not be directly compared with the values in the right column, as they do not correspond to the same set of spots because the trg spot set is not included  when spots are analyzed in classes . in an hypothetical scenario with an unknown strain as test sample, inclusion of the trg spots would mainly increase true present calls, which would increase the overall accuracy and sensitivity values. again, we show that using the mix control there is a significant increase in accuracy, either analyzing all spots together  or in two groups . in the first case, the improved accuracy is due to a significantly higher specificity , meaning that the mix control originates less false present calls. on average, using the mix control reduces the number of erroneous calls by  <dig> per array , which corresponds to an improvement of specificity of  <dig> % and does not change significantly the sensitivity.

when spots are divided in two classes, the lower accuracy associated with the use of the t control is instead due to lower sensitivity. here, the use of the mix control produces less  <dig> erroneous calls per array , which corresponds to an improvement of sensitivity of 21%  and a decrease of 5% in specificity .

discussion
a common argument against the use of the mix control is the increase in the complexity of the data analysis due to a higher number of expected signal classes that need to be analyzed separately  <cit> . by inspecting table  <dig> it was already apparent that even with a single strain control, it is advantageous to analyze separately the spots that recognize specifically the control strain from the ones that do not. if such separate analysis were not performed, spot types with correct present and absent calls would be grouped in a class producing the same expected ratio. the improved performance of analyzing the data separated into spot classes, instead of analyzing all spots together, is apparent in figure  <dig>  where for both types of control auc values are consistently higher when spots are analyzed separately. although the advantages of performing an analysis by spot classes were not formally explored, a few previous studies using multistrain arrays with a single strain control have opted for defining two thresholds for spots present or absent in the control  <cit>  or running the analysis algorithm twice, inverting the lr values  <cit> .

since there is no universal consensus on analyzing all spots together or splitting them into classes according to the expected signal in the control channel, we compared control performances in each of these situations. for both of these approaches the use of mix control led to better results, measured by increased discriminatory power of lr distributions  and accuracy , although these were due to the decrease of different types of error.

when all spots are analyzed together, the mix control is responsible for higher specificity, without loss of sensitivity. in the hybridizations with the t control, the increased false positives are mainly g spots, when the test sample was r, or r spots when the test sample was g. these spots have an expected ratio of  <dig>  which is also the expected ratio of the more abundant spot type trg that will have more weight in defining the value of the optimal threshold. a good threshold for correctly identifying the present trg spots is naturally a bad threshold for identifying the absent g spots , whose lr distributions are almost completely overlapping .

if spots are analyzed in different classes, the mix control is associated with a gain in sensitivity higher than the loss in specificity. most of the divergence in the results of each control option is related with spots that recognize genes in the genome of two strains. in hybridizations with both types of control, the lr distributions have greater overlaps among spot types that are specific for two reference strains as compared with spot types that are specific for just one strain , which could be related to the fact that oligos designed for multiple strains can more easily present lower identities with their targets than oligos designed for orfs present in just one strain. hybridizations with the t control produce less false present calls while arrays with mix control have less false absent calls. to obtain further insights into this behavior we looked at the individual sets of spots that are in each class analyzed separately.

in hybridizations with the t control one optimal threshold is chosen from the lr values of the spot class recognizing t genes  while another threshold is adopted for the spot class not recognizing t genes . this division joins in the same class sets of spots specific for one and two reference strains, creating an extensive overlap between lr distributions of present and absent genes. in the t recognizing class, the present set  is mixed with the more abundant absent sets, especially with the one that is specific for two reference strains , originating more false absent calls. in the class that does not target t genes, the present set that is specific for one strain only is well separated from the absent set . most errors come from the present rg spot set that overlaps significantly with the absent set that is centered on an lr value of  <dig>  hence, by producing more false negatives  than false positives , both sets contribute to the higher specificity associated with hybridizations using the t control.

for hybridizations using the mix control the two classes of spots analyzed separately were the spot class recognizing genes present in one strain only  and the spot class identifying genes present in two strains . in contrast with the classes analyzed with the t control, this division separates into a single class the spots that are specific for genes present in only one reference strain. as stated previously, among these spot sets, absent and present genes are well segregated and, consequently, the classification in this class produces few errors. the threshold value of the second class is mainly conditioned by present spots  because they are more abundant. consequently a higher error rate is obtained in the absent spots , producing more false present calls. notwithstanding, the error rates in the present sets are much lower than the ones observed for hybridizations with the t control, comparatively producing significantly less false absent calls, contributing to the higher sensitivity obtained using the mix control.

CONCLUSIONS
the overall data favors the use of the mix control in multistrain microarray cgh experiments. additionally, the lower accuracies described for hybridizations with the single strain control are associated with genes that are already known not to be part of the core genome of the species since they are not shared by all strains used in designing the array. genes represented in trg spots, that include those defining the core genome and a fraction of those included in the accessory genome, were not analyzed because, as stated in the methods section, they should be analyzed separately when the mix control is used. since all these spots are known to be present, the methodology used to evaluate the discriminatory power of lr distributions does not apply. still, we expect both control choices to behave similarly for trg spots because the control channel in both approaches has the same expected signal intensity  and therefore the resulting lr distributions for these spots are similar in terms of location and, in comparison with other spot classes, present lower dispersion . the remaining classes considered included genes found in a single strain or in two of the strains used to design the array, and therefore represent the accessory or dispensable genome. more variation between strains of the same species is expected for these genes that were specifically analyzed in this work, reinforcing the importance of the reported better performance associated with the use of the mix control. from a biological standpoint, the identification of particular ecotypes or variants with enhanced virulence among strains of the same species, are examples of studies that rely on the accurate detection of the presence of genes that are part of the accessory genome and these would benefit greatly from a mixed control approach. since single strain controls are frequently used in these studies  <cit> , this may lead to the incorrect identification of the absence of genes associated with the accessory genome and may contribute to the variable success of this technique in identifying different groups of strains within the same species.

although we believe our results to be generally applicable to all multistrain microarrays used in acgh, it is important to note that the magnitude of the observed effects might differ according to the array technology, quality of oligonucleotide design and the relative number of spots that are specific for only one or a subset of the strains used in the array design. arrays with cdna probes, for example, are expected to have similar sensitivity to  <dig> mer probes but lower specificity, which can lead to more cross-hybridization. additionally, depending on the degree of sequence divergence between the strains used in the array design, probes targeting orfs present in multiple strains can have lower sensitivity, lower specificity or both. in fact, the oligos in our arrays can have different sensitivities and specificities when hybridizing with the r <dig> or g <dig> strains, respectively. additionnally, the g <dig> strain has more genes with spots specific for one strain only  and less genes targeted by spots recognizing two strains , which according to the previous discussion should improve the quality of g <dig> results. notwithstanding, our analysis shows that, independently of these differences, we can say that using a single strain as control will lead to higher error rates for spots that recognize genes that are not present in all reference strains. moreover, if the mix control is used and spots are analyzed in separate classes higher sensitivities are achieved, meaning that less false absent call are produced and a higher fraction of the truly present genes are recovered from the analysis. snipen and colleagues discuss that in acgh experiments, the study focus of the researcher can be primarily to identify divergent or absent genes or, on the other hand, the focus can be on the present genes, for example, when estimating the conserved core genome over all strains  <cit> . in the first situation, it may be more important to require higher sensitivities, that is, less false absent calls, while in the second situation specificity may be more relevant, attempting to avoid false present calls. in published studies the first situation is more common, which led repsilber and colleagues to state that in a typical genomotyping experiment high sensitivities, around  <dig> , are desirable to prevent high rates of false absent calls  <cit> . we have shown here, that those levels are attainable for multistrain microarrays if a mix control is applied and spots are analyzed in two different classes. if spots are analyzed in a single class, high sensitivities are also observed, but accompanied by undesirable very low specificities.

if the main objective is to define a core genome and high specificity is required, analyzing spots in separate classes is mandatory whichever control is used. again, the mix control provides the best-balanced performance since the use of the single strain control, although associated with slightly better specificities, presents substantial losses in sensitivity.

independently of the method chosen for the analysis of acgh data, a suboptimal choice of control sample may compromise the quality of the final results as well as the possibility to compare different studies. our study thus provides an important source of information to support the design of bacterial genomotyping experiments with multistrain microarrays.

