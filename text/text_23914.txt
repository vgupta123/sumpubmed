BACKGROUND
the hedgehog signaling pathway plays an important role in regulating embryonic development in vertebrates, and it is highly conserved from flies to humans  <cit>  <cit>  <cit>  <cit> .the pathway name comes from a polypeptide ligand called hedgehog , which is an intercellular signaling molecule in drosophila. in drosophila, the mutation of the gene in the hedgehog signaling pathway gives rise to an unusual spiky-haired phenotype  <cit> . the misregulation of such pathways has been directly associated with a variety of inherited and sporadic diseases  <cit>  <cit>  <cit> . the key role of the hedgehog signaling pathway in the cell differentiation, growth, and proliferation makes it an excellent candidate in drug discovery, and thus targeting such pathway in cells represents a promising new paradigm for cell growth and death control.

the hedgehog signal pathway is composed of four important components: sonic hedgehog, patched, smoothened and gli transcription factors  <cit>  . the functional hh protein secreted from the membranes of the producing cells and initiates the hh signaling cascade upon binding to the 12-pass transmembrane receptor patched . in the absence of an hh ligand, the patched receptor inhibits the activity of the downstream seven-pass transmembrane receptor smoothened , which resembles g-protein-coupled receptors  in general topology. active smo then signals via a cytosolic complex of proteins including suppressor of fused , and the cascade culminates by triggering activation of the glioma  family of transcription factors and their translocation to the nucleus. this activation results in the expression of specific genes that promote cell proliferation and differentiation  <cit> .

the causal relationship between the activation of hedgehog signaling pathway and oncogenesis has driven cancer researchers in the direction of finding specific inhibitors of hedgehog signaling, since this will provide efficient therapies to a wide range of malignancies  <cit> . to date, several druggable nodes within the pathway have been identified. assays implanted on various cell lines have shown that small molecules were able to alter the activity of these targets. among them, murine cell lines such as nih  <dig> t <dig>  tm3h <dig>  and c3h10t1/ <dig> have been used  <cit> . while current cell lines allow the measurement of the inhibitory effects of compounds on the hh pathway, they, however, provide little or no information about the specific underlying targets. to the best of our knowledge, only specific smoothened inhibitors have been identified. among them, the well-known bodipy–cyclopamine, which is a fluorescent derivative of the naturally occurring smo antagonist cyclopamine, binds specifically to cells expressing the smo protein. this is one of the small chemical compounds that specifically inhibit smoothened in the hedgehog signaling pathway <cit> . in our previous study  <cit> , we have performed several quantitatively structure-activity relationship  studies for cyclopamine derivatives in multiple cell lines, and such study could reveal useful clues in developing clinically effective drugs and modifications of parent lead compounds for cancer therapy.

recently, our partners have synthesized  <dig> cyclopamine derivatives and their activities were tested against four different cell lines  respectively  <cit>  <cit> . based on these experimental data, a systematical qsar investigation was carried out by incorporation of various statistic modelings and different molecular descriptors  <cit> . however, there are still several issues remain to be solved, which we believe that solving such problems will greatly enhance the understanding of inhibitors on hedgehog signaling pathway, as well as the development of novel qsar methodology. we describe the two major problems below:

 in our previous qsar study, for specific cell lines, the activities were categorized into a binary classification under a naïve bayesian model, and we obtained relatively acceptable qsar results. however, no matter what kinds of statistical models or 2d descriptors were tested, low testing correlation coefficients were found when numeric activities were used. this may be due to the inherent noise existed in experimental activity measurement, or the relatively small number of training data used for a specific cell line. due to our compound data tested against multiple cell lines to evaluate their activities, we hypotheses that such information can be integrated to improve the qsar results rather than only a single cell line qsar modeling. such investigation will be extremely useful for the scenario that a small number of compound activities are measured under different experimental conditions , and will provide novel insights on the integration of existing information, avoiding repeatable laborious work in drug discovery. in addition, such a study may also lead to novel computational models for integrated qsar modeling, which is closely related to multi-task qsar modeling  <cit>  <cit> , multi-assay-based qsar modeling  <cit>  , and multi-target qsar study  <cit> .

 due to the existence of compound activity data against multiple cell lines, how can we integrate such information to derive more robust and efficient feature selection strategies for compound modification under such “collaborative” multi-cell line environment? that is, can we derive the commonly important features related to the entire given cell lines for compound description, while in the meantime present their specific contributions to a specific cell-line? this issue is closely related to the first one, but tougher to be solved since it needs much more domain knowledge.

inspired by these two problems, we aim to develop an efficient integrated qsar model for inhibitors of hedgehog signal pathway against multiple cell lines. this type of model has been used for information retrieval in social network, i.e. collaborative filtering  <cit>  <cit> , and it has been widely applied by the web companies such as google, amazon. dumitru erhan etc. has pioneered to use the term “collaborative filtering” in multiple target study  <cit> . nevertheless, their methodology can be categorized as multiple regression or neural network, and a complex kernel function for similarity measurement is needed. in this study, we will present a collective matrix factorization based collaborative filtering model for integrated qsar modeling, which is more naturally suitable for qsar modeling, and scales up well on large dataset. furthermore, we will also derive a powerful feature selection strategy for collaborative compound design to get more efficient inhibitors of hedgehog signal pathway.

methods and materials
dataset
 <dig> cyclopamine derivatives with their activities against four different cell lines  were obtained from our previous work  <cit> . the compound activity is measured by pki, as defined in the following cheng-prusoff equation  <cit> :

  pki=−logic501+kd 



where ic <dig>  is a measure of the effectiveness of a compound in inhibiting biological or biochemical function. more specifically, it indicates how much of a particular drug or other substance  needed to inhibit a given biological process  by half. in our study, the data are formulated as a data matrix x. note that the collective matrix factorization requires the matrix to be non-negative. in our original experiments, we measured the compound affinity under the pki evaluation system, and the activity values were negative. since the pki measurement is calculated by taking ic <dig> as the input in equation , we can just take the absolute value of the pki in qsar modeling , and this will not affect our final results.

definitions and notations
in this paper, the different cell lines and the compounds tested for hedgehog signal pathway will be denoted as t and c respectively, and their corresponding subscripts denote a specific compound and cell line. thus, for a specific compound ci, its experimentally activity value  against specific cell line tj is denoted as xij. we can build a m by n dimensional matrix x, where m is the number of the compounds and n is the number of cell lines.

each compound will be represented by a vector of descriptors, denoted as a matrix y with m by r dimensions, where m is the number of compounds and r is the length of the corresponding descriptor vector. similar to our previous study  <cit> , two different molecule descriptors, general descriptor  <cit>  and drug-like index   <cit>  will be used for compound representation.

collaborative filtering for multiple cell line qsar modeling
based on the above definitions, it can be seen that the traditional single cell line qsar modeling is applied on the data in a specific column of matrix x. in this study, we are more interested in incorporating the information from other columns  to enhance the performance of the qsar modeling for a particular column . this scenario is similar to the recommendation system presented by electronic retailers and content providers such as amazon.com and netflix  <cit> , which make automatic predictions  of users’ interests by collecting preferences or taste information from many users , naturally termed as “collaborative filtering ”.

formally speaking, in a typical cf scenario, there is a list of n users {u <dig>  u <dig>  . . . , un} and a list of m items {i <dig>  i <dig>  . . . , im}, and each user, ui, has a list of items, iui, which the user has rated, or about which their preferences have been inferred through their behaviors. the ratings can either be explicit indication on a 1– <dig> scale, or implicit indication such as purchases or click-throughs  <cit> . such a user-item relationship can be formulated as a matrix, which may be sparse and can have missing values . the goal of cf is to predict such missing values based on the existed information of users/items to make the reasonable recommendation .

such a cf scenario is inherently suitable for our multiple cell line qsar modeling. in our study, the former “cell line- compound” matrix x can be viewed as a kind of “item-user” matrix, where “compound” is analogue to “item” and “cell line” is analogue to “user” . the traditional single cell line qsar modeling uses the data restricted in a specific column of matrix x to train and test. from the perspective of machine learning, we just hold part of the data in the column as testing dataset, and use the other part of the data in the column to train a qsar model. this procedure can be naturally extend to the multiple cell line qsar modeling under the cf framework, where we can treat the testing data in a specific column as “missing” value and using the remain data from this column as well as the data from other columns to predict such missing values.

collective matrix factorization for collaborative filtering in the multiple cell line qsar modeling
we formulate the multiple cell line qsar modeling problem as a collaborative filtering problem. there are two existing techniques for solving collaborative filtering, i.e., the neighborhood methods and latent factor models. neighborhood methods are centered on computing the relationships between items or, alternatively, between users for missing value prediction, while latent factor models characterize both items and users on, say,  <dig> to  <dig> factors inferred from the ratings patterns  <cit>  <cit>  <cit> . generally, realizations of latent factor models are based on matrix factorization. in its basic form, matrix factorization characterizes both items and users through vectors of factors inferred from item rating patterns. high correlation between item and user factors leads to a recommendation. these methods have become popular in recent years by combining good scalability with predictive accuracy. thus, we will present a matrix factorization based multiple cell line qsar modeling method in our study.

specifically, we have matrix x∈r+mxn, where xi j, epresents the activity measurement of compound i against specific cell line j. noted that x is sparse in a specific column since we will hold part of elements in this column as the testing data  for qsar modeling. we use an indicator matrix i∈rmxn to represent the missing values, where iij =  <dig> if xij is missing and iij =  <dig> otherwise.

we denote by xj.,1≤i≤m and x.j, 1≤j≤n the ith row and jth column of x, which represent the ith compound's activities against all the cell lines and the activities of the jth cell line for all the compounds, respectively.

in a basic matrix factorization model, we usually seek two low-rank matrices, u∈r+m×d and v∈r+n×d. the row vector ui and vj represent the low-dimensional representations of compounds and cell lines respectively. we use matrix u×vt to approximate the original matrix x, thus to fill/predict the missing values. such matrix factorization can be achieved by solve the following optimization function:

  minlu, v 

where

  l=∥i∘∥f2+λ1∥u∥f2+λ2∥v∥f <dig> 

in equation , the operator “∘” denotes the entry-wise product. ||*||f denotes the frobenius norm. the last  <dig> terms add regularizations to the matrix u and v by avoiding over-fitting the observed data. the parameters λ <dig> and λ <dig> control the extent of regularizations, and they are usually determined by cross-validation.

we also have the compound description information as described in matrix y in order to use such auxiliary information to aid a more reasonable reconstruction of matrix x. we further presented a collective matrix factorization  <cit>  method for multiple cell line qsar modeling. the cmf method was recently presented by machine learning community  <cit> , and it jointly factorizes multiple matrices simultaneously, assuming that they share several common latent factors. to be more specific, given a compound - cell line matrix x∈r+m×n, and a compound description matrix y∈r+m×n, we extend the optimization function  and  to the following:

  minlu,v,w 

where l 

  =12∥i∘∥f2+λ12∥y−uwt∥f2+λ <dig> 

equation  is similar to equation , it reconstructs x≈uvt and y≈uwt by sharing the common factor u, where x∈r+m×n,y∈r+m×r,u∈r+m×d,v∈r+n×d and w∈r+r×d. u, v and w are low-dimensional matrices with dimensiond ≤min. by solving such optimization function, we can successfully incorporate the information of the multiple cell line compound activities and compound description for a better missing value prediction.

in general, the objective function  is not jointly convex to all the variables u, v,w, and we cannot get closed-form solutions for minimizing the objective function. therefore, we will turn to some numerical method such as gradient descent to get the local optimal solutions. specifically, we have the gradients as:

  ∇ul=i∘uvt−xv+λ1uwt−yw+λ2u 

  ∇vl=i∘uvt−xtu+λ2v 

  ∇wl=i∘uwt−ytu+λ2w 

after obtaining the gradients, we can use gradient descent to iteratively minimize the objective function. the algorithm for the collective two matrix factorization is given below:

algorithm 1: collective matrix factorization for multiple cell line qsar modeling

input: an incomplete matrix x and a complete matrix y , where x represents the compound activities in multiple cell lines with missing values in specific column, y represents the compound description matrix.

output: the complete matrix for x.

begin

 <dig>  t = 1;

 <dig>  while -;

 <dig>  y = 1;

 <dig>  while ≥l) do

 <dig>  γ=γ/2;

 <dig>  end

 <dig>  ut+1=ut−γ∇utl,vt+1=vt−γ∇vtl,wt+1=wt−γ∇wtl

 <dig>  t = t + 1;

 <dig>  end

 <dig>  return x;

end

performance measurement
in order to demonstrate the efficiency of collective matrix factorization based multiple cell line qsar modeling, we compare our approach with two other base line methods, i.e., linear ridge regression and support vector regression  for single cell line qsar modeling used in our previous study  <cit> . for the purpose of equal comparison, we apply the following two testing strategies for each specific cell line: . we randomly selected 2/ <dig> of the data to train the linear ridge regression and svr, and the remaining data as to test these two methods. these two base line methods are compared with collective matrix factorization based qsar method, where the same testing data  are predicted based on the original training data for this specific cell line plus the data from other cell lines. the whole procedure was repeated  <dig> times.  in order to evaluate the qsar model more rigorously and consider the representative ability of the compounds in training dataset, we applied another data partition strategy, i.e., diverse subset data division method  <cit> , which is commonly used in the chemoinformatics community. generally speaking, the diverse subset method ranks compound entries based on diversity. in the procedure of data division, the first entry of the original dataset is taken as a reference and will always be viewed as part of a diverse subset. then the most “distinct” compound data is assigned # <dig>  and then the most distinct compound to these two is assigned # <dig> and so on until the required number of diverse compounds is identified or the whole dataset is ranked in diversity order  <cit> . in this study, we also select 1/ <dig> of the data as testing dataset and the remaining data as the training dataset, while such partition is generated in a diverse subset way rather than randomly to keep the representative and distinct characteristics of data.

two classical measurements, i.e., root mean squared error  and squared correlation coefficient  were adopted as the performance evaluations for testing results. the definitions of these statistical parameters are provided as follows:

root mean squared error :

  rmse=1n∑i=1nei <dig> 

where n is the number of test compounds, ei=yi−y^i, is the difference between the observed compound affinity data and the fitted model. yi is the observed compound affinity, y^i is the predicted compound affinity.

squared correlation coefficient :

  r2=1−sserrsstot=1−∑ipiexp−picalc2∑ipiexp−pavg <dig> 

where pavg is the average value of piexp over the n predicted compound affinities.

feature selection based on cmf for compound description among multiple cell lines
under such collaborative qsar schema, we presented a novel feature selection model for compound descriptions weighting, which is also derived from the content-based recommender systems and collaborative filtering  <cit> . basically, we want to quantify the effect of each compound feature against a specific cell line  as well as among all the cell lines . the final feature weighting is an integration of the two types of weighting, where both specific and the whole cell lines contribute. such a feature selection strategy is attractive in multiple cell line qsar modeling, since it can provide useful clues of how to modify chemical compounds to improve their activities for a specific target, or for all given cell lines simultaneously. while the latter one is a key step for multi-target compound design.

specially, given a compound activity-cell line matrix x  and compound-feature description matrix y , we want to derive a cell line-description feature weighting matrix z , where its element zij is the weight of a compound feature j in cell line i. the value of element zij is contributed from two sides, i.e. intra-cell line and inter-cell line. the generally procedure for computing a weight for each compound feature is based on  the amount of information provided by itself , and  the correlation between the compound feature and a specific cell line. three steps are performed here:

step  <dig>  weighting for inter-cell line. for each compound feature cj, an entropy based method is applied to compute the amount of information that it can offer regardless of cell line, as denoted as hj.

step  <dig>  weighting for intra-cell line. for each compound feature cj and a specific cell line tj, the correlation between compound feature and the cell line is calculated. this calculation will depend on the nature of the features . two kinds of correlations, i.e., correlation coefficient and contingency coefficient  <cit>  are proposed for quantitative features and qualitative features respectively.

step  <dig>  calculation of the final weights. the feature weight is obtained as a result of the product of entropy and degree of dependency.

a generally outline of the proposed feature selection strategy is presented in figure  <dig>  detailed information can be referred to the original work  <cit> .

RESULTS
we performed a comprehensive study of the collective matrix factorization based multiple cell line qsar modeling for the inhibitors of hedgehog signaling pathway as described in section  <dig>  in the rest of this section we present and summarize the key results from this study. the performance of our method was compared with the baseline qsar models of liner ridge regression and sar. details are listed in the following.

performance of the collective matrix factorization based qsar modeling
figures  <dig> and  <dig> present average improvements achieved by the cmf based multiple cell line qsar modeling over the baseline methods for four cell lines, with two different kinds of drug representations, i.e., general descriptor and drug-like index respectively. figure  <dig> shows the performance result of the first partition strategy, where the test was carried out under certain parameter setting and with  <dig> times repetition by randomly selected 2/ <dig> data as training dataset and 1/ <dig> data as testing datasets. figure  <dig> shows the second strategy, where the test was carried out under certain parameter setting with diverse subset to consider the data representative ability in the training and testing dataset.

from figure  <dig>  it can be seen that that the different data partition strategies actually achieve the similar performance results. for all the cell lines and all the kinds of data representation, the performance improvement of collaborative qsar modeling was dramatic, especially for the evaluation of r-square. the improvement is statistically significant, with significant p-value measured by rmse and r-square respectively. we had already noticed in our previous study  <cit>  that under the measurement of r-square, the qsar modeling results for the four cell lines with numeric compound activities were not satisfied, indicating a satisfiable qsar modeling against single cell line individually was hard to obtain. in contrast, in our current collaborative qsar modeling, performance against all the cell lines was improved. the significant improvement margin evaluated by r-square indicates that our cmf based qsar modeling could successfully capture the correlation, rather than its absolute value of difference among the dataset as evaluated by rmse.

besides the measurements of the average rmse and r-square of different qsar models, we also investigated their error distribution under the diverse subset partition strategy to give a more rigorous comparison of their performance. it can be seen from the boxplots of the error square  that for both two compound descriptions, collaborative qsar modeling achieved the lowest error means and low variances compared to other two baselines, indicating the best prediction ability among all methods.

it should be noted that in our previous study we found that different cell lines perform differently for modeling the inhibitor affinity based on the linear regression or svr. particularly, only the data of nci-h <dig> could produce a reasonable model by qsar analysis, probably due to the fact that the other three cell lines may be less sensitive as hci-h <dig> cells to the hedgehog signaling inhibitor  <cit> . nevertheless, it can be seen from figure  <dig> that if we combine all these data from different cell lines together under the cmf based qsar modeling, we can greatly reduce such non-specific effects in the cell lines, and result in a reasonable qsar modeling against all the cell lines respectively. such improvement is attributed to the fact that the collaborative filtering based framework allows different cell line data tasks to enhance each other during the training process, which eventually makes the efficacy modeling better than those of using the datasets separately. we believe that such “collaborative” scenario for drug analysis will become more popular in the future, as more and more cell line will exist and the drug are often required to be investigated under various circumstances.

finally, in order to evaluate whether our collaborative qsar model is general enough for new predictions, we also checked the domain of application  for the model under the diverse subset partition strategy. the domain of application  is used to estimate the reliability in the prediction of a new compound  <cit>  for a specific method. those molecules fall out the domain may lead to unreliable predictions  <cit> . in the analysis of doa, a value of leverage hi is defined in equation  for each chemical molecule:

  hi=xit−1xi 

where xi is the row-vector descriptor of the query compound,xis the n×k matrix containing kdescriptor values and n training samples. the superscript t is the transpose of the matrix or vector. generally, the warning leverage h* is fixed at 3k/n, where n is the number of training compounds, and k is the number of descriptors. when the leverage is greater than the warning leverageh*, the predicted activity is the result of substantial extrapolation of the model and, therefore, it may not be reliable and tend to be over-fitting.

based on the definition of leverage, williams plot was used in this study to visualize the doa of the qsar model  <cit> . the williams plot plots the standardized cross-validated residuals  versus leverage values , and can be used to obtain an immediate and simple graphical detection of both the response outliers  and the structurally influential chemicals  of a model. generally, the points with their values of y axis fall outside the 3σ line  can be considered as y outliers, while the points with their values of x axis fall outside the warning leverage h*line can be considered as x outliers  <cit> . figures  <dig> and  <dig> represent the william plots for the four cell lines with compound representations of general descriptor and drug-like index respectively. it can be seen that for all four cell lines, most of the compounds fall into their corresponding application domain, which indicate that the collaborative qsar modeling has achieved a reliable activity prediction for the compounds, and they are following a well-defined domain of applicability.

impact of the regularization parameters
in this subsection, we will investigate the impact of the regularization parameters on our cmf-based qsar modeling. we choose the values of λ <dig> and λ <dig> under different dimensionality of low dimensional representations and different numbers of training ratings, and plot the rmse based on the whole four cell line data as shown in figure  <dig>  the tests were performed with different compound descriptions, i.e., general descriptors and drug-like index respectively. in the figure, x-axis corresponds to different value of regularization parameter  while y-axis corresponds to the number of training ratios for the whole qsar data . it can be seen that  basically the influence of the regularization parameter is small on the performance, indicating that our proposed method is robust and insensitive to the parameters,  higher performance will be achieved with the larger number of training samples, which is not surprising in our study, and  generally the two compound description, i.e, drug-like index and general descriptor, performed the same in cmf with no statistically different.

feature selection based on cmf for compound description among multiple cell lines
using collaborative filtering based feature selection strategy we proposed aforementioned, we obtained the feature weighting for intra-cell line and inter-cell line for the inhibitors of hedgehog signaling pathway. the former one can be used to uncover the important features in inhibitor design against a specific cell line, while the later one is used to identify common features that are important for the inhibitors against multiple cell line simultaneously. we compared the difference between these two kinds of feature weighting to provide useful clues for inhibitor modifications and improve their affinities.

in this feature selection, we used drug-like index to represent each compound, with the total of  <dig> features, since it is easy to interpret biological meanings. the general descriptor feature space has been hybridized, and the original meanings of compound structure description for current features couldn’t kept. therefore, gd will not be adopted for feature weighting here. generally speaking, drug-like index belongs to the category of structural descriptors. structural descriptors can correlate with each other; some of them may be redundant. however, if they have different and significant distributions in the considered drug class, they can be used for drug-knowledge extraction and the redundant can be ignored. in our study, the descriptors maintain their identity and clearly interpretable structural significance throughout the process. a table with detailed descriptions of each drug-like index is listed in additional file 2: table s <dig> 

the  <dig> feature weights for the intra-cell line, inter-cell line and the final integrated one are shown in figures  <dig>   <dig> and  <dig>  in all three figures, x-axis represents the drug-like index feature id and y-axis represents its corresponding weights. it can be seen that the final integrated feature weighting is different from that of intra-cell line. moreover, the inter-cell line feature weighting can be viewed as an efficient way to identify the potential features important for multi-target inhibitors of hedgehog signaling pathway. we provide our insights about inhibitors design based on these figures:

1) as shown in figure  <dig>  the features of ‘# of non-h’ , ‘# of non-h polar bonds’  and ‘# of 2-degree cyclic atoms’  were ranked top  <dig>  these findings indicate that the volume of the molecular, the polar of the molecular and the cyclic degree of the molecular are the most important features for the design of multi-target inhibitors of hedgehog signaling pathway. our findings are actually consistent with the empirical rules for lead compound optimization, which use these three elements to determine their activities.

2) we can see from figure  <dig> that the feature ‘# of cap fragments’  was also important when the multi-cell line inhibitors were designed. this is consistent with the empirical rule, which changes the substituent group  in order to improve the inhibitor activity. however, compared with figure  <dig>  it can be seen that the importance of this feature for multi-cell line inhibitor design is not as much significant as that for individual cell lines. this could be explained that, although this feature is important for individual cell line inhibitor, their activity improvement directions may be inconsistent, thus reducing its importance when multi-cell lines are confronted.

3) all three figures  have shown that the weight for the feature of '# of 3-level bonding patterns'  is  <dig>  this is probably due to the following two reasons:a) all compound samples in our study are lack of this feature, and b) this feature is not considered in most of the in-silico compound optimizations.

discussion
comparison of cmf based qsar modeling with other collaborative qsar modeling
although the cmf based qsar modeling was investigated in our study, we do realize the existence of other qsar modeling with integrated information, and we call such models as the “collaborative” qsar modeling, like the neural network based  <cit>  <cit>  and multi-task learning based  <cit>  <cit>  models, as well as the proteochemometrics modeling   <cit>  <cit> . in order to further uncover the characteristics of such collaborative qsar modeling, we discuss our cmf based method with the aforementioned methods on our multiple cell line qsar modeling for the inhibitors of hedgehog signaling pathway.

neural network based collaborative qsar modeling
as we mentioned above, erhan etc. proposed a neural network based collaborative qsar modeling for drug discovery  <cit> . this is one of the first attempts to construct an efficient procedure for integrating multiple drug target information at a time by extending standard multi-layer neural networks. basically, neural networks provided an ideal test bed for implementing collaborative qsar modeling: the simplest of such form was to create a shared hidden layer that is trained in parallel for all the learning tasks. in this case, the training procedure would be done on all the tasks  in parallel. because the structure of the network includes a shared layer , it is possible for so-called “shared internal representations” to develop and to be learned.

specifically, in our multiple cell line qsar modeling for the inhibitors of hedgehog signaling pathway, we used a 10-cross fold validation schema to test our data from  <dig> cell lines in this neural network model. the weights from input layer to hidden layer as well as from hidden layer to output layer for the network will be learned through the back propagation  algorithm. our in-house test indicated that the neural network based collaborative qsar modeling was comparable to cmf based qsar modeling, with no surprisingly better than the single qsar modeling .

multi-task learning based collaborative qsar modeling
neural network can be viewed as a specific form of multi-task learning. multi-task learning has been developed for those situations where multiple related learning tasks are to be accomplished together. when explicit or hidden interrelationship among the tasks can be exploited  <cit>  <cit> , multi-task learning is more effective than learning each task independently. the intuition underlying the framework is that the multiple related tasks can benefit each other by sharing the data and features across the tasks, and thus boosting the learning performance of each single task  <cit> . it also provides an efficient mechanism for cross-task feature selection, thus uncovering the common dominate features for all the tasks simultaneously. our group has successfully applied multi-task learning in qsar modeling with specific study of hiv and hcv inhibitors  <cit>  <cit> . basically, assume that the datasets contain n tuples, zi= for i = {1…n}, where xi∈rd is the drug descriptor, and ki∈{1…m} is the indicator corresponding to the example . the m tasks correspond to m different cell lines or drug targets. a critical issue in this collaborative qsar modeling is to learn a set of sparse functions across these tasks for drug activity regression. this is commonly achieved by learning m linear regressions of the form wktx, with the following square loss function is adopted :

  ls= <dig> 

wherez=, w=∈rd×m and wj be the jth row of w.

in the multi-task learning framework, w can be optimized and calculated by enforcing the joint sparsity across different tasks with adding the different norm of the matrix w to the square loss function, which leads to only a few non-zero rows of w.

the relationship between collaborative filtering and multi-task learning has been discussed in previous studies  <cit> . the multi-task learning model is closed related to the multiple response regression models  <cit> . multiple response regression is the task of estimating several response variables using a common set of input variables. in general, both multi-task learning and multiple response regression can be used to find the correlation between different tasks, and thus improve the single task learning. such an approach have many potential applications in various areas, interested readers may be referred to the paper  <cit> . it should be noted that in the multi-task learning framework, the samples for different tasks should not be identical. in general, the less overlap of the samples containing across different tasks, the more prediction ability of each task. this idea is related to another interesting algorithm, transfer learning  <cit> , whereas multi-task learning can be categorized into this area and the information between different tasks is expected to “transfer” from each other to boost the performance of individual task.

for the particular data in our multiple cell line qsar modeling for the inhibitors of hedgehog signaling pathway, it can be seen that the drug samples for all the cell line are totally identical, thus it is unnecessary to use multi-task learning in the collaborative qsar here. nevertheless, if non-identical samples for multiple cell line exist, multi-task learning will be a good choice for collaborative qsar modeling with integrating of different data sources.

proteochemometric modeling
proteochemometric modeling  is presented based on the similarity of a group of ligands and a group of targets, to the extent that pcm models the so-called ligand-target interaction space  <cit>  <cit> . like qsar modeling, the pcm model is constructed based on chemical descriptors that describe the compound data set and it introduces an additional term, a descriptor of the protein - target interaction . therefore, a pcm model is constructed on both ligand and target similarity, and it can be regarded as an extension of conventional qsar modeling, which models the relationship between multiple compounds and targets simultaneously. pcm is intrinsically the most similar to our collaborative filtering based qsar modeling among all others. pcm explicitly requires the target information as well as the protein-target interaction descriptions. whereas in our collaborative filtering based qsar modeling, these two kinds of information are implicitly embedded in one computational schema. from this point of view, our model is more flexible and extendable. since in our multiple cell line qsar modeling for the inhibitors of hedgehog signaling pathway, there is no explicit target information available, we cannot use pcm for the qsar modeling. large-scale ligand-target relationship study and comparison between collaborative filtering based methods and pcm still remain to be an interesting and useful topic for the future study.

CONCLUSIONS
in this study, an efficient collaborative qsar model for inhibitors of hedgehog signal pathway from multiple cell lines was proposed. the model is derived from the area of information retrieval in social network, i.e. collaborative filtering, and its performance is well demonstrated and explained in our study. by applying this elegant computational model, we successfully addressed two issues remained in our previous study, i.e.,  the information among multiple cell lines can be integrated to boost the qsar results, rather than single cell line qsar modeling. our extensive experiments indicated that the performance is remarkable compared to other single cell line qsar methods.  a novel feature selection strategy under such collaborative environment was proposed, which can be used to derive the commonly important features related to the entire given cell lines, while meantime presenting their specific contributions to a specific cell-line. based on the results of feature selection, we presented several ways of chemical modifications which will likely improve the compound affinity towards multiple targets in the hedgehog signal pathway simultaneously. in summary, our study provides useful clues for multiple cell line/targets qsar modeling when the cell line or target information among a related pathway exist. the proposed collaborative model with the feature selection strategy here is efficient, robust, flexible, and can be easily extended to model large-scale multiple cell line/qsar data.

competing interests
the authors declare that they have no competing interests.

authors' contributions
ql and jg carried out the designing of the whole computational algorithm and drafted the manuscript. jg and dc were responsible for the algorithm implementation. dc, vz and rz were responsible for the algorithm design. ql conceived the study and participated in the design and coordination of the analyses. all authors read and approved the final manuscript.

supplementary material
additional file 1
the data and scripts for collaborative qsar modeling.

click here for file

 additional file 2
table s <dig>  detailed explanations of each drug-like index.

click here for file

 acknowledgements
we thank the lab of prof. wei-dong zhang in second military medical university, shanghai to share the compound data. this work was supported in part by project shanghai pujiang talents funding , young teachers for the doctoral program of ministry of education, china  and national natural science foundation of china 
