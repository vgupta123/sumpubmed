BACKGROUND
animal migration requires an integrated set of physiological, morphological and behavioural adaptations  <cit> . some of these adaptations are directly associated with migration such as organ plasticity, fat deposition and orientation ability. other adaptations also influence animals during the non-migratory period. for example, in birds, the timing of migration has to be coordinated with the timing of breeding and moult. several of the traits involved in migration have the potential of evolving rapidly. new migratory behaviours have been established over a few decades in european blackcaps sylvia atricapilla <cit>  and in north american house finches carpodacus mexicanus <cit> . in the house finch, migratory birds have developed significantly longer wings compared to resident birds  <cit> . similarly, the novel migratory behaviour observed in the blackcap, which differs in its directional and distance component from the supposedly ancestral migratory behaviour, has been paralleled by morphological changes  <cit> .

quantitative genetic studies of blackcap populations have shown a strong heritable basis of several components of migratory behaviour, such as timing, duration and direction  <cit> . however, despite their often strong heritable basis, only a handful of studies have explored the genetic architecture of traits associated with migration. for example, zhu et al. <cit>  found  <dig> microarray probes differentially expressed between migrating and reproductive summer monarch butterflies danaus plexippus. using a candidate gene approach a length polymorphism in the 3′ untranslated region  of the adcyap <dig> gene that was found to explain a small but significant part of the variation in migratory activity within and between different european populations of blackcaps  <cit> . increased knowledge of the genetic composition of migratory traits would allow for comparative studies across different species and provide new insights into the evolution of migration. the slow progress of connecting genes to a migratory phenotype could at least partly be attributed to the fact that none of the traditional genetic model species exhibit any distinct migratory behaviour  <cit> . the huge amount of data that now can be obtained from non-model species using next-generation sequencing is therefore likely to accelerate the field, with the potential of exploring how sequence polymorphisms, gene expression and epigenetic processes influence migratory phenotypes.

in this study we attempt to identify genes potentially associated with migratory traits by using next-generation sequencing of a brain-derived transcriptome from two subspecies of a small passerine, the willow warbler phylloscopus trochilus. in scandinavia, p. t. trochilus breeds in the south and p. t. acredula in the north, and a hybrid zone is found in the central part of the region  <cit> . analyses of ringing recoveries and stable isotopes in feathers moulted in wintering areas in africa have shown that the subspecies exhibit different migratory behaviour. southern birds migrate southwest in autumn to wintering grounds in western africa, whereas northern birds migrate south to southeast and winter in eastern and southern africa  <cit> . previous genetic studies of mitochondrial dna, several microsatellites and thousands of amplified length polymorphism  loci have shown that the two subspecies could be regarded as a single panmictic population  <cit> . due to this very low genomic background differentiation, loci showing large allele frequency differences between the subspecies are likely to be either themselves under divergent selection or linked to genes under divergent selection  <cit> . given an otherwise small phenotypic differentiation, it is reasonable to assume that a majority of divergently selected genes between the two subspecies are associated with adaptations to the different migratory strategies.

with our data set we specifically wanted to investigate sequence variation in coding genes and determine how this variation is distributed between the subspecies. the sequence data provides a genome-wide set of markers and allows for detection of differences in protein-coding regions that could give rise to phenotypic differences. we used normalized cdna libraries in order to increase the sequencing depth of low abundance transcripts and to maximize the number of sequenced genes. the normalization in combination with a pooling of samples has the consequence that expression differences could not be reliably quantified from this data set. expression differences, which are likely to be important for differences in migratory phenotypes, are instead investigated in another study using microarray expression profiling of the same samples . here we describe the use of genomic resources of a closely related bird species, the zebra finch taeniopygia guttata, to assemble and annotate reads, and demonstrate the efficiency of this approach in detecting sequence variation in a non-model species.

RESULTS
sequencing and assembly
two runs of  <dig> sequencing produced  <dig> , <dig> and  <dig> , <dig> raw reads, respectively , with a similar contribution from each of the subspecies. as expected from the improvement of the sequencing technology, the average read length was higher for the second run. following linker and vector removal,  <dig> , <dig> reads  comprising 565 mb remained for assembly. of these reads,  <dig> , <dig>  were mapped to the zebra finch genome. together these covered  <dig>  mb  of the genome. the alignments were distributed on all chromosomes with a strong positive correlation  between the number of reads per chromosome and chromosome length. a small number of reads  were defined as chimeric by the mapping software and had two separate alignments included in the output, which in the vast majority of cases were situated on different chromosomes. the mapping quality  of reads ranged from  <dig> to  <dig>  with a mean value of  <dig> . mq is the phred-scaled probability  that a read has been incorrectly aligned in the genome, with for example a value of  <dig> corresponding to a probability of  <dig>   <cit> . in order to determine whether excluding alignments with lower mq values would influence the results, sequencing depth and snp statistics were also calculated for  <dig> , <dig> reads with a mq ≥  <dig>  this filtered set of reads was overlapping with fewer positions in the zebra finch genome and generally showed reduced sequencing depth as compared to the full set of reads. however, it did not qualitatively differ with respect to number of genes, relative sequencing depth among different types of features or the distribution of differentiation indices .

annotation
the annotation resulted in  <dig> , <dig>  of the aligned nucleotide positions overlapping with one or more gene feature in the zebra finch genome. these overlapping gene features originate from  <dig>  unique genes when excluding positions where features from multiple genes were overlapping. including positions in multiple overlapping genes, the number of unique genes was  <dig> . within genes, more aligned positions were located in introns than in exons, but the mean sequencing depth was higher in exons than in introns . of positions in intergenic regions, most were located relatively close to a gene feature . the distance ranged from 1– <dig>  bp with a mean and a median of  <dig>  and  <dig>  bp, respectively. alignments in intergenic positions were sometimes located close to genes that had no reads mapping within them. for example, if the annotated interval of genes in the zebra finch genome was expanded by  <dig>  bp upstream and downstream then alignments of willow warbler reads overlapped with an additional  <dig>  annotated genes.

snps refer to high-quality snps . snp density was calculated by dividing the number of snps with the number of positions with a minimum sequencing depth of six reads, which is the lowest depth in which a snp can be detected using the filtering requirements.

snp extraction and validation
the snp extraction pipeline detected  <dig> , <dig> raw snps in the willow warbler reads mapped to the zebra finch genome. with a requirement of a minor allele frequency of at least  <dig> , and a presence of the minor allele in at least three reads, the total number of high-quality snps was  <dig> . the density of snps was quite similar in different feature categories, with the highest value in intergenic regions and the lowest in exons . genetic differentiation between the pools was quantified for each snp using a differentiation index , which obtains a maximum value of  <dig>  when two different alleles are fixed in each of the pools . the average di between the subspecies was consistently low using different thresholds of minimum number of reads from each pool . however, only a very small proportion of the snps were highly differentiated . for example, with a requirement of eight reads from each of the pools,  <dig> out of  <dig>  snps were highly differentiated . of  <dig> highly differentiated snps validated with sanger sequencing of genomic dna in an independent set of eight samples from each of the subspecies, all but one snp associated with the adcyap1r <dig> gene were successfully genotyped in all the samples . snps with the highest number of reads/pool generally had the smallest difference in di between the  <dig> transcriptome and validation data sets . eight of the snps possessed large allele frequency differences  between the subspecies in the validation set and were clustered in two regions on chromosome  <dig> and chromosome  <dig> in the zebra finch genome . these snps also showed similar levels of differentiation between eight lithuanian willow warblers, which belong to the northern subspecies , and willow warblers from southern sweden in the validation set . this suggests that the identified snps represent subspecies-specific differences rather than adaptations to the different environmental conditions found in northern and southern sweden.

of the  <dig> candidate snps identified by the transcriptome analyses, eight  showed high to moderate differentiation  between southern  and northern swedish samples  when independently validated by sanger sequencing. these eight snps also showed elevated dis between southern swedish and lithuanian samples . the snp in adcyap1r <dig> could only be successfully genotyped in four southern and five northern swedish samples in the validation set.

discussion
next-generation sequencing provides new opportunities for studying the genomics of non-model organisms  <cit> . for recently diverged taxa connected by gene flow, such as the two subspecies of the willow warbler, genomic differences are expected to be few but informative about adaptive divergence  <cit> . on the other hand, detecting these differences could require a dense set of markers. the sequencing of a willow warbler transcriptome has vastly increased the genomic resources available for this species. previous studies on the same populations have used a small number of coding genes or microsatellites  <cit>  or anonymous aflps  <cit>  to study genetic divergence between the subspecies. with the use of the zebra finch genome for annotation, this data set provides a large amount of sequence data that could be associated with particular genes and gene features. as such, it will be a useful resource for future research by highlighting potentially interesting genes or genomic regions and by aiding the design of primers surrounding sequence polymorphisms.

in this study, the vast majority of reads  were matched to the zebra finch genome, but the applicability of cross-species genome mapping is dependent on the similarity between the genomes and is not expected to work equally well among different non-model species. the specific karyotype of the willow warbler has not been determined and it is not known how the arrangement of genes within and between chromosomes differs between the willow warbler and zebra finch genome. within the order passeriformes , to which both the willow warbler and zebra finch belong, a remarkable conservation of genome structure has been reported, with both gene order and gene content on chromosomes being largely unchanged even between distantly related species  <cit> . it therefore seems plausible that the zebra finch genome is a good model for the genome of the willow warbler. however, it is not necessarily identical, since chromosomal re-arrangements have been observed between different species of passerines  <cit>  and a neo-sex chromosome is suggested to have arisen in a subgroup of passerines presumably including the willow warbler  <cit> . on the other hand, these types of large-scale differences in genome organization have little impact on positions within or in the immediate vicinity of genes and do not therefore cause major differences in annotation at the gene level. another possibility is that some coding genes found in the willow warbler genome are not present in the zebra finch genome. of particular concern are genes underlying traits associated with migration, since the zebra finch does not show behavioural adaptations  that are observed among long-distance avian migrants  <cit> . however, migratory behaviour has been characterized as a threshold trait in which a non-migratory phenotype is switched into a migratory phenotype when the combined effects of multiple genes reach a threshold  <cit> . as a threshold trait, it is possible for variation responsible for migratory behaviour to be maintained in a population consisting of only resident individuals  <cit> . it is therefore likely that migration genes are also found in the zebra finch genome even if they do not manifest themselves into a distinct migratory phenotype in contemporary zebra finch populations.

as expected from the enrichment of mature mrna in the sample preparation steps, the greatest sequencing depth was observed in exons . unexpectedly, however, alignments in intronic features were common and, compared to alignments in exons, spread out over more positions in total in the zebra finch genome. this could be explained by that the enrichment step might not have been perfect and included unspliced mrna  <cit> . more than half of the positions in the zebra finch genome with aligned willow warbler reads were situated in intergenic regions, but the sequencing depth was lower than within annotated genes. as found in a transcriptome sequencing study of the great tit parus major <cit> , most of the intergenic positions were located close to predicted genes in the zebra finch genome . a possible explanation is that a majority of the positions could be situated in uncharacterized parts of utrs. more distantly situated alignments could potentially be situated in genes that have not been annotated in the zebra finch genome. positions in putative utrs are of importance because they add more sequence data to genes and thus make it possible to identify more sequence polymorphisms. additionally, in some cases they constitute the only aligned positions associated with a certain gene.

a large number of snps were detected in the sequence data, which were located on all but a handful of small chromosomes. the difference in snp density observed across features is likely to be associated with their different evolutionary constraints. for example, exonic positions had a lower density of snps than what is found in both intronic and intergenic positions . overall, the snp density is lower than found in a previous sequencing study of the subspecies  <cit> . a likely explanation is that the sequencing depth in general is too low to include many of the rarer alleles in the pools. this explanation is supported when restricting analyses to snps with a greater sequencing depth. for example, if only positions with a sequencing depth of at least  <dig> reads are included, the snp density is nearly doubled and more similar to previous estimates.

due to the construction of the cdna library it is impossible to trace the sequencing efficiency of each individual and this could bias the genetic differentiation estimate  for each snp. in order to get a more unbiased estimate, we filtered snps by their minimum sequencing depth in each of the pools. assuming that all or most individuals in each pool have similar expression levels of transcripts, and that these pooled transcripts are randomly sequenced, increasing the sequencing depth makes it more probable that more individuals are represented among the sequence reads. however, larger expression differences between individuals would result in a higher probability for transcripts from certain individuals to be sequenced. in this case, filtering by sequencing depth may not necessarily provide a more unbiased estimate. nevertheless, the general distribution of dis of snps between the subspecies pools  agrees with the low background differentiation and few genetic differences previously reported between the subspecies  <cit> . for example, with a minimum requirement of eight reads from each subspecies pool, only  <dig> out of  <dig>  snps had a di ≥  <dig>  . of these, four are located within a chromosome region that was previously shown to be highly differentiated between northern and southern willow warblers in scandinavia  <cit> . eight of the  <dig> remaining highly differentiated snps that were validated were also differentiated between the subspecies in an independent set of individuals originating from southern and northern sweden . the difference in di between the  <dig> data and the validation data was generally smaller with an increased sequencing depth in both of the pools in the  <dig> data set . this suggests that filtering snps by the sequencing depth provides an efficient way of accounting for sequencing bias of individuals in the pools. the validation set included a particularly interesting snp that is situated close to the adcyap1r <dig> gene. this gene encodes a membrane receptor that binds to the product of the adcyap <dig> gene  <cit> , which has been shown to explain some of the migratory behaviour observed within and between european blackcap populations  <cit> . even though not all individuals in the validation set could be successfully genotyped for this particular snp, there was no difference in allele frequency between the genotyped samples.

the identified genetic differences between southern and northern swedish willow warblers could also reflect adaptations to different environments. the only obvious large environmental and ecological contrast within the sampling area is between the scandinavian mountains and the rest of scandinavia. in sweden, only the northern subspecies occurs in the mountains and some adaptations to this drastically different environment are expected. indeed, two alleles of an earlier identified genetic marker show a distribution that is strongly associated with the different environments  <cit> . to address this question, we also genotyped eight individuals caught in lithuania for snps that showed a moderate to high differentiation between southern and northern swedish samples in the validation set. willow warblers in lithuania belong to the northern subspecies  and express the same migratory behavior as northern birds in scandinavia. the environment, however, is more similar to what is found at the same latitude in southern sweden. if the highly differentiated snps identified in this study were associated with adaptations to the different environments of southern and northern sweden, we would expect the lithuanian birds to have genotypes much more similar to birds in southern sweden. in contrast, we observed comparable levels of differentiation for snps between southern swedish and lithuanian samples as between southern and northern swedish samples. this corroborates the hypothesis that the identified genetic differences are associated with the subspecies in general and are potentially linked to adaptations involved in their different migratory strategies.

the majority of the highly differentiated snps, including most of the snps verified to be differentiated in the validation set, are not located in the protein coding part of genes, but in intergenic regions . although some of these snps themselves might be directly under divergent selection, they are more likely to be differentiated because they are in linkage disequilibrium  to divergently selected variation in the closest gene or even in genes further away on the same chromosome. the requirement of a minimum sequencing depth in each of the pools used for estimating differentiation reduces both the number of snps within genes and the number of genes containing snps. for example, the almost  <dig>  identified snps with a minimum sequencing depth of eight reads in each of the pools are located in at least  <dig>  predicted genes. including positions overlapping multiple genes and positions 2000 bp upstream and downstream of the genes, the total number of genes is increased to  <dig> , which still is only a fraction of the number of genes covered by the total set of sequence data. hence it is possible that many sequence variants are missed because of insufficient sequencing depth. in addition, ld has previously been shown to extend over several mb in the willow warbler. using the zebra finch genome as a basis for gene order, lundberg et al. <cit>  identified a region on chromosome  <dig> that was highly differentiated between willow warblers in the scandinavian mountains and the rest of fennoscandia. the chromosome region is significantly more differentiated than an estimated genomic background level for at least a  <dig>  mb interval in the zebra finch genome that contains at least  <dig> coding genes. in the present study, snps that also were highly differentiated in the validation set clustered in regions comprising  <dig>  mb on chromosome  <dig> and  <dig>  mb on chromosome  <dig> in the zebra finch genome . since the distances are based on positions in zebra finch genome, they should only be regarded as rough approximations of those found in the willow warbler genome and in reality these snps might be located closer or further away from each other. potentially large divergent chromosome regions could be formed if selection is reducing gene flow between chromosomes possessing alleles that are favourable in different environments,  <cit> . reduced gene flow could also be facilitated by an inversion, which could maintain favourable allele combinations despite gene flow  <cit> .

with the present data set it is possible that most of the large to moderate-sized divergent chromosome regions between the subspecies could be identified, but in order to detect more genomically localized differences, a denser set of markers would be required. this has been shown in a recent study of three-spined sticklebacks gasterosteus aculeatus <cit> , in which full-genome re-sequencing identified a number of more genomically localized signals of divergent selection that had not been detected in a previous genome scan employing  <dig>  snps originating from restriction-site associated dna  tags  <cit> . another limitation of the present study design is that the low number of individuals in each of the pools only allow for detection of snps that are highly differentiated between the subspecies. smaller allele frequency differences could be expected if a locus is more loosely linked to a gene under selection, if weaker divergent selection is acting on the trait  <cit>  or if the genetic architecture of a trait is primarily composed of many loci with small effects  <cit> .

future work will aim at validating the remainder of the highly differentiated snps in other individuals from the same populations of willow warblers. if these snps also are found highly differentiated in a validation set, their allelic distribution will be investigated over a larger geographical scale to determine how well it follows the distribution of the subspecies. putative divergent chromosome regions will be more finely mapped to get a better approximation of their size and gene content. when the differentiated regions have been properly delimited, efforts should be focused on identifying the actual targets of selection. this process will be aided by the integration with data derived from a microarray expression profiling study performed on the same set of samples . a particularly interesting analysis would be to compare the genomic position and the functional annotation of differentially expressed genes between migrating individuals of each subspecies with to those of genes found within the differentiated chromosome regions.

CONCLUSIONS
this study represents the first large-scale sequencing analysis in birds that attempts to explore the genetic architecture of traits involved in migration. the allele frequency distribution of snps identified in reads mapped to the zebra finch genome confirmed previous studies showing that most of the genetic variation is shared between the subspecies. a major finding was the discovery of two chromosome regions that are likely to be under divergent selection between the two subspecies and that could be involved in adaptations to their different migratory strategies. genetic variation within these chromosome regions will be integrated with microarray expression profiling data from the same samples in order to find networks of potential genes encoding migratory traits that could be investigated in other study systems.

