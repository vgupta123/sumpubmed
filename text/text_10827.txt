BACKGROUND
restriction-modification systems are rudimentary bacterial immune systems, whose main components are the restriction enzyme , and the methyltransferase . we here consider type ii restriction-modification  systems  <cit> , where r cuts the same dna sequences that are protected by m. consequently, r and m act, respectively, as a toxic molecule and its antidote, and analogies of r-m and toxin-antitoxin systems are often made  <cit> . r-m present rudimentary “bacterial immune systems”, as they protect the host bacterial cell against infection by foreign dna, such as viruses  . the protection mechanism is straightforward, as the foreign dna entering bacterial cell is unmethylated, and is consequently cut  by r. on the other hand, the host dna is methylated due to presence of m, and is therefore not cut by r, which prevents autoimmunity. in fact, many bacteriophages are under pressure from r-m systems with whom they have common hosts  <cit> , and have developed different mechanisms to avoid restriction . consequently, expression of the toxic molecule and its antidote provides an effective protection of the bacterial cell against foreign dna infection  <cit> .

r-m systems are often mobile  <cit> , spreading from one bacterial host to the other, so that a bacterial host, which initially did not contain the r-m system , can acquire it through horizontal transfer. expression of r and m was directly observed in single cells only very recently, for the esp1396i system  <cit> , and it is still unclear how different r-m system features affect this expression. it is however assumed that r-m expression has to be tightly regulated during its establishment in a naïve host  <cit> . for example, as the naïve host genome is initially unmethylated, r must be, and where tested actually is, expressed after a delay with respect to m, so that the host’s genomic dna can be protected before the appearance of r  <cit> . to ensure such tight regulation, a significant subset of r-m systems contains a third gene, which expresses the control protein  . c is a transcription factor, which regulates expression of genes in r-m system, including its own expression. in fact, c is typically co-transcribed with r from a common promoter , while m is transcribed from a separate promoter   <cit> .

with respect to the organization of the transcription units, two different architectures are exhibited, which correspond to the convergent , and the divergent  orientation of cr and m promoters  <cit> . despite r-m systems being known for few decades now, with numerous biotechnological uses of restriction enzymes, control of expression of these systems has been insufficiently studied. two relatively well studied examples are ahdi   <cit> , and ecorv   <cit> . for both systems, the core promoters , and the binding sites of c protein, are experimentally mapped. in addition, for ahdi system, the transcription activity of cr promoter was measured as a function of c protein amount. we previously showed that a thermodynamic model of cr promoter regulation provides a good agreement with this measurement  <cit> . we also recently showed  <cit>  that a similar thermodynamic model, coupled with a dynamical model of transcript and protein synthesis, can reasonably explain the dynamics of the enzyme synthesis measured by single-cell experiments in another convergent r-m system . this strongly suggests that quantitative modeling presented here can realistically explain r-m system transcription control. additionally, thermodynamical modeling of transcription regulation was successfully applied to a number of different biological problems , while dynamical modeling was applied to explain both more and less complex gene circuits including control of other convergent r-m systems .fig.  <dig> typical gene arrangement and promoter orientation in convergent and divergent r-m systems. a convergent systems, a representative of which is ahdi, where other studied systems encoding c protein include esp1396i, kpn2i, csp231i, pvuii . note that c and r genes are transcribed together from pcr promoter. transcription of m is exhibited from the separate pm promoter. b divergent systems, a representative of which is ecorv, where bamhi is another studied divergent system that encods c protein  <cit> . c and r genes are also co-transcribed, but now share a common promoter region with m gene. in ecorv the two divergent promoters  have overlapping rna polymerase binding sites




as we detail below on the example of ahdi , and ecorv , it is experimentally firmly established that r-m systems exhibit both different architectures, and different features that characterize their gene expression regulation  <cit> . on the other hand, the regulation should yield the same three dynamical properties, so that the host genome is protected, while the system is efficiently established. in particular, as discussed above, there would have to be a significant expression of m before r is expressed, to ensure that the host genome is protected. furthermore, once the host genome is protected, the system should likely turn to “on” state as rapidly as possible, so that the host genome becomes “immune” to the virus infections – this would then require that after an initial delay, r is rapidly generated. finally, we also previously proposed that, once the toxic molecule  reaches a steady-state, its fluctuations should be low – otherwise a high fluctuation in the toxic molecule  may not be matched by the antidote , which could destroy the host genome  <cit> .

it is however unclear how the diverse system features and architectures, relate with the constraints on the dynamical response of the system stated above. experimentally, one could, in principle, address this issue by mutating the relevant features , and then measuring how the resulting system dynamics is perturbed. this would however be very hard, as the system would have to be extensively experimentally mutated and/or redesigned, and the resulting protein dynamics measured in-vivo during the system establishment. in that respect, note that the in-vivo dynamics of r and m expression were directly observed for only two type ii systems – in pvuii via nearly simultaneous introduction into a culture using bacteriophage m <dig>  <cit> , and in esp1396i, via transformation followed by single cell analysis  <cit> . even in these cases, the measurements are done only on the wild-type  system, i.e. perturbations were not introduced in the system.

therefore, the main purpose of this paper is to investigate the relationship between different system features/architectures, and the dynamical properties which the system is expected to exhibit during its establishment. in particular, it is our hypothesis that the diverse features exhibited in r-m systems may largely be explained in terms of the three dynamical properties discussed above. to start testing this hypothesis, we will here biophysically model the control of ahdi and ecorv, and assess the resulting dynamics when the characteristic system features are either perturbed  or  introduced  in the system. this is analogous to a classical approach in molecular biology, where the system is analyzed by mutating its main features, or introducing new features in the system where they do not exist, and consequently observing what effect these perturbations have on the presumed system function. the difference is that we here analyze the system computationally instead of experimentally, where we build on the fact that we previously showed that the modeling approach that we employ here can reasonably explain the available equilibrium measurements  <cit> , and the available single cell experiments  <cit> . therefore, the ability of the modeling to explain the measured wild-type data in r-m systems provides a reasonable confidence that our predictions for the perturbed system will also be realistic. moreover, with the advancement of sophisticated experimental approaches, such as single cell experiments, or possibility to reengineer the system, there comes a prospect of directly experimentally testing these predictions in the future.

specifically, we will here start by reviewing the relevant experimental information for ahdi and ecorv systems , which will provide a bases for our theoretical modeling. we will then quantify the general principles discussed above, i.e. introduce what we here call the dynamical property observables, which will allow us quantifying the delay between r and m, how fast the system makes the transition from off to on state, and the stability of r steady-state levels. we will then investigate if abolishing the characteristic features of ahdi also diminishes these observables, i.e. negatively affects the dynamical properties discussed above. furthermore, we will also study if these dynamical properties also apply to the system  where ahdi features are absent, but a new feature is present . we will then ask what happens if the ahdi features are  introduced in wild-type ecorv system, where they originally do not exist. that is, we will investigate if introducing these features leads to  some of the three dynamic property observables being diminished – therefore explaining why they are absent from ecorv. overall, we will here systematically investigate how perturbing  features in two characteristic r-m systems affects the resulting system dynamics.

methods
in the first subsection, we provide in detail the experimentally available information on ahdi  and ecorv , on which we base our quantitative modeling. the main properties of the model, including the observables through which we assess the system dynamical properties, are provided in the second subsection. we note that the model itself is provided in details in additional files  <dig> and  <dig>  where all the parameters  are listed.

experimentally determined configurations of ahdi and ecorv
for ahdi, the positions of different promoter elements  were experimentally mapped for both cr and m promoters  <cit>  . in addition, the binding affinities and the transcription activities for both the wild type and mutant systems  were measured  <cit> . these measured values, together with the standard literature values for the kinetic parameters , were used to parameterize the model, as provided in detail in additional file  <dig> 

as indicated in fig. 2a, c binds to cr promoter, regulating both its own transcription and the transcription of r  <cit> . c binds to promoter dna as a dimer, where binding to the distal binding site , when c is present at relatively low concentration, leads to transcription activation, as c dimer bound to this position recruits rnap binding to the promoter . on the other hand, when c is present at high concentration, c dimer bound to the distal binding site recruits another c dimer to the proximal binding site , thus repressing the transcription, as rnap cannot bind to the promoter. note that the configuration in which c dimer binds only to the proximal binding site  is not shown, as the binding affinity to the proximal binding site is much lower compared to the distal binding site, making this configuration much less probable. as for m gene, its transcription is controlled by a negative feedback loop, i.e. m methylates specific sites in its own core promoter thereby repressing the transcription .fig.  <dig> ahdi r-m system promoter regions. the arrangement of the promoter elements for ahdi cr and m promoters is based on the experimental information provided in  <cit> . the regions which are schematically shown correspond to  pcr promoter. circles indicate c monomers, the rectangles indicates rnap, while the arrows indicate transcriptionally active configurations. k <dig> – k <dig> denote the dissociation constants  corresponding to different promoter configurations , where ω and ω’ denote, respectively, the binding cooperativity between the two c dimers bound to dna, and between c dimer bound to the distal binding site and rnap. c binds to the promoter as either dimer  or tetramer . the bound dimer recruits rnap to the promoter . on the other hand, the tetramer configuration corresponds to the repression, as it prevents rnap binding to the promoter. b transcription is repressed by dna methylation due to m binding  <cit> , i.e. m methylates specific sites in m promoter that overlap rnap binding site – for simplicity this is in the figure represented as m being bound to the promoter dna




there are three features which characterize control of ahdi expression  <cit> . first, there is a very high cooperativity in binding of the c protein dimers to the distal and the proximal positions in cr promoter, so that c dimer bound only to the distal site  exists only very transiently in the wild-type  ahdi system. that is, in the absence of rnap, a c dimer bound to the distal position immediately recruits another c dimer to the proximal binding site. second, the c dissociation constant of dimerization for ahdi is very high, so that almost all c protein in the solution is in the form of monomers. finally, c protein is translated from a leaderless transcript , which was in e. coli shown to be associated with lower translation initiation rate  <cit> .

for ecorv, cr and m promoters are divergently oriented, as schematically shown in fig. 1b. consequently, the promoter elements are located in the intergenic region that separates cr and m genes, and these elements are also experimentally mapped  <cit> . some of the binding affinities were also measured  <cit> , while the others were eliminated by rescaling the equations  – note that we can rescale the equations, as we are interested only in the relative protein amounts. the kinetic parameters , correspond to the standard literature values, and are taken to be the same as for ahdi .

in contrast to ahdi, the main feature of ecorv is the partially overlapping cr and m core promoters, as schematically shown in fig.  <dig>  consequently, rnap cannot simultaneously bind to and initiate transcription from both pm and pcr. moreover, the characteristic features of ahdi are not found in ecorv  <cit> . in particular, while the transcription control of the cr promoter by c protein is similar as in ahdi, the main difference is that the large cooperativity between the c dimers at the distal and the proximal binding site is now absent, in fact it was found in ecorv that the two dimers bind to dna with no cooperativity  <cit> . furthermore, the transcription from pm is not directly influenced by c protein binding, i.e. c binding does not directly affect rnap binding to pm. however, the influence of c on pm transcription is indirect, as the regulation by c of rnap binding to pcr, also affects when rnap can bind to pm. consequently, while in ahdi transcription of cr and m was independent from each other, in ecorv we have a more complex system where their transcription is strongly coupled. similar regulation through overlapping cr and m core promoters is also found in cfrbi r-m system  <cit> . finally, c transcript is not leaderless in ecorv, so the feature which was associated with lower translation initiation rate in e. coli, and which is present in ahdi, is now absent from ecorv.fig.  <dig> transcription regulation of ecorv r-m system. the promoter configuration in the figure is based on the experimentally mapped promoter elements from  <cit> . note that the promoters for cr  and m  genes are divergent, as schematically shown in fig. 1b. c and r genes are co-transcribed from the rightward promoter , with rnap bound to the promoter as indicated in the first and the third configuration . m gene is transcribed from the divergent pm promoter , with rnap bound to the promoter as indicated in the last three configurations. pm and pcr core promoters partially overlap each other, so that rnap cannot simultaneously bind to pm and pcr. the explanations for the first four configurations are equivalent as in fig. 2a. note that ω′ denotes the binding cooperativity between the dimer bound at the distal position and rnap. for the last three configurations, note that binding of c does not directly influence binding of rnap to pm  <cit> 




modeling ahdi and ecorv dynamics
we model r and m synthesis upon introducing ahdi and ecorv in naïve bacterial hosts. the models are based on the experimental knowledge of ahdi and ecorv transcription regulation, which is summarized in figs.  <dig> and  <dig>  respectively. the models are provided in detail in additional files  <dig> and  <dig>  and are briefly based on: a thermodynamic model, which takes into account the activation and the repression of cr promoter by c, and the repression of m gene by its own product . the model assumes that the promoter transcription activity is proportional to the equilibrium binding probability of rnap to promoter, which is a general assumption initially proposed by the classical shea-ackers approach  <cit> .

 equations that predict how the transcription activity of cr and m promoters depends on c-protein concentration, which further allows modeling the dynamics of transcript and protein expression. that is, the modeled transcription activities provide the main input for a kinetic model, which calculates r, c and m transcript and protein synthesis. also, note that r-m systems are characterized by very high expression of r and m proteins  <cit>  so that on the order of thousands of molecules are present in the cell. consequently, the system is expected to be well in the limit where deterministic modeling can be used to realistically describe the system.




we previously showed that such modeling can well explain the wild-type measurements for ahdi  <cit>  - in particular the measured dependence of the transcription activity on c protein concentration – as well as the most recent measurements in single-cell experiments allowing directly observing the dynamics of r and m synthesis  <cit> . our aim here is to computationally analyze how systematically abolishing individual system features affects the system’s dynamics, focusing on the following properties:i. the time delay between r and m accumulation,

ii. the transition speed of the system from “off” to “on”,

iii. the stability of r steady-state levels.




for this, we will introduce observables  that can quantify these properties. to reasonably define them, it is useful to visualize the predicted system dynamics, and the stability of r steady-state levels in wild-type ahdi system, which is shown in fig.  <dig> and calculated from eqs. ,  and – .fig.  <dig> 
a dynamics of r and m expression. r and m expression upon the system entry in a naïve bacterial host . the shaded area corresponds to the difference of the surface areas below m  and r  expression curves for the first 10 min post-system entry; the area presents a measure of the delay between m and r expression. the dash-dot line corresponds to the maximal slope of the sigmoidal r expression curve, measuring the transition velocity from off to on state. b steady-state and its stability. the steady-state  is obtained as an intersection of the transcription activity , and the dash-dot line whose slope is determined by the transcript decay and the protein translation rate ). the stability of the steady-state is related with the difference of the dash-dot line slope, and the slope of the transcription activity  at the point of their intersection ceq )




the first dynamical property observable 
from fig. 4a, we see that the system features lead to a significant delay in the expression of r compared to m, in accordance with the first dynamical property. to quantify how the delay changes upon perturbing these features, we introduce the first dynamical property observable, which corresponds to the ratios of the shaded areas in the perturbed system and in wt ahdi, at an initial interval post-system entry.

the second dynamical property observable 
furthermore, in fig. 4a, we see that r expression curve has a sigmoidal shape. consequently, the maximal slope of this curve  provides a reasonable measure of transition velocity from “off”  to “on”  state. therefore, as the second dynamical property observable, we introduce the maximal slope of this curve. the changes of this slope will allow assessing how the transition velocity – which determines the time window between the host genome being methylated, and the cell being protected against viruses – will be affected when the system features are perturbed.

the third dynamical property observable 
finally, the third dynamical property relates with fluctuations of the toxic r molecule, which we propose should be small in the steady-state  <cit> . the fluctuations are directly related with the stability of the steady-state, so that smaller fluctuations imply larger steady-state stability, which we introduce as the third dynamical property observable.

different  perturbations of the wild-type system – i.e. gradually abolishing the existing or introducing new features – will be introduced in either the thermodynamic model, or in the kinetic equations .

RESULTS
we will start by gradually abolishing the three characteristic ahdi features introduced above, and assess how this will affect the dynamical property observables. we will next model the dynamics of ecorv establishment in a naïve bacterial host, to see if the proposed dynamical properties also apply to a system with different architecture and transcription regulation features. this will provide, to our knowledge, the first quantitative model of a divergent r-m system control, and an opportunity to assess dynamics of r and m expression, which was up to now not experimentally observed for the divergent systems. finally, we will in-silico introduce to ecorv the regulation features that exist in ahdi, but are not found in ecorv, to investigate how this effects the dynamical property observables, and why these features are not present in ecorv.

perturbing ahdi system features
the three characteristic ahdi features are the high c subunit dissociation constant of dimerization, the large cooperativity between c dimers bound at the distal and the proximal position, and the low c transcript translation initiation rate. it was previously discussed that these features serve to limit the amount of the synthesized toxic molecule   <cit> . however, it is not clear that this amount per-se should be limited, as a too small steady-state amount of r may compromise the immune response – i.e. it can lead to the virus genome being protected by m before it can be destroyed by r  <cit> . as we discussed above, it would be very hard to experimentally investigate the effect of these ahdi features on the system dynamics, this can be readily predicted from the model that we formulated above.

decreasing the dissociation constant of dimerization
the dissociation constant of dimerization k
 <dig> is very high for ahdi, leading to almost all c subunits being present as monomers in solution  <cit>  – e.g. for another convergent r-m system , the measured dissociation constant of dimerization was found to be significantly  lower  <cit> . we start by gradually decreasing this high dissociation constant of dimerization, in the range that corresponds to the wild-type  to the opposite limit of lower k
 <dig>  in which only dimers are present in the solution. in fig. 5a, we see that this perturbation has a significant effect on r synthesis dynamics – note that the m dynamics curve, which is also indicated in the figure for reference, is not affected by perturbing the three characteristic ahdi features. one can observe the three main effects from fig. 5a: the decrease of the delay between r and m expression, the slower transition from off to on state, and the decrease in the steady-state level of r. the first two effects are further quantified in fig. 5b and c, as discussed below.fig.  <dig> decreasing ahdi dissociation constant of dimerization. k
 <dig> is decreased from the high value corresponding to mostly monomers in the solution, to the low value corresponding to mostly dimers in the solution, and the effect is assessed on a the dynamics of the protein synthesis. the black line corresponds to all monomers in the solution , while the light gray line corresponds to all dimers in the solution. the curves in-between  correspond to the gradually decreasing values of k
 <dig>  the relative protein amounts for a wt system  are derived from in-vitro transcription activity measurements in  <cit> . x indicated in the legend corresponds to the relative decrease of k
 <dig> . b the first dynamical property observable, corresponding to the relative delay of r with respect to m expression. the delay is normalized with respect to the wild type . c the second dynamical property observable, corresponding to the transition velocity from “off” to “on” state, represented by the maximal slope of the r expression curve. d the third dynamical property observable, corresponding to the stability of r steady-state levels 




in fig. 5b, we see that decreasing k
 <dig> leads to a significant, more than twofold, decrease in the relative delay between r and m expression. this perturbation can then significantly impact the ability of the system to protect the host genome from being cut during r-m establishment, with the necessary lag also depending on the specific activity of the m protein and the propensity for r to nick hemimethylated sites. furthermore, in fig. 5c we see that decreasing k
 <dig> also leads to a significantly slower transition from off to on state, so that the maximal slope is decreased for almost two-fold. therefore, decreasing the wt dissociation constant of dimerization also significantly impacts the time window in which the host will be protected from foreign dna infection. however, perturbing k <dig> has no significant effect on the steady-state stability of r levels . overall, decreasing the high dissociation constant of dimerization characteristic for wt ahdi, has a significant adverse effect on two of the three proposed design principles.

increasing c protein translation rate
in ahdi c transcript is leaderless  <cit> , which was in e. coli  <cit>  shown to be associated with a significantly smaller translation initiation rate – consequently in  <cit>  a five times smaller c transcript translation rate k
c, compared to r and m was assumed. we now test the effect of perturbing this system feature, i.e. increasing k
c towards those of r and m transcripts, which is shown in fig.  <dig>  we see that the main effect of this perturbation is on decreasing the steady-state level of r and the delay between r and m expression , as shown in fig. 6a-b. intuitively, this can be understood that by a more efficient c transcript translation, c accumulates faster, facilitating the formation of the activating and the repressing complexes on the cr promoter, so that r is expressed with a smaller delay, and reaches the lower steady-state level. on the other hand, the effect on the other two design-observables, i.e. on the transition velocity and the stability of r steady-state levels, is rather small . consequently, increasing the low c transcript translation rate adversely affects one of the dynamical property observables, i.e. the delayed expression of r with respect to m, which is considered crucial for the protection of the host genome.fig.  <dig> increasing c transcript translation rate: k
c is increased from the lower value  as taken in  <cit>  to the value which equals those for r and m transcripts . the effect of this decrease is assessed for: a the dynamics of the protein synthesis, with the black curve corresponding to the lowest  k
c, and the light gray curve corresponding to the highest k
c . the curves in different shades of gray correspond to the gradually increasing k
c values. b the relative delay  of r with respect to m expression. c the maximal slope of the r expression curve, reflecting the transition velocity from “off” to “on” state. d the stability of r steady-state levels, is shown on the vertical axis




decreasing cooperativity in the dimer binding
a rather drastic feature of ahdi is a very large cooperativity ω in binding of the two dimers to the distal and the proximal position in the promoter  <cit> , which is either not present   <cit> , or significantly smaller   <cit> , in other r-m systems. we therefore investigate how gradually abolishing this high cooperativity affects the system dynamics and the design observables. in fig. 7a, we see that abolishing ω affects only the late dynamics of r, so that the first two dynamical properties are not affected . on the other hand, we see that the steady-state amount of r significantly increases as the cooperativity ω decreases. this can be intuitively understood by the fact that perturbing the cooperativity affects only the efficiency of forming the repressor tetramer complex. as the probability of forming this complex is proportional to c <dig> , it becomes significant only in the later period, when a large enough amount of c is synthesized. furthermore, in accordance with the perturbation affecting the late dynamics, from fig. 7b, we see that decreasing the cooperativity significantly impacts the stability of r steady-state levels, leading to its 50% decrease.fig.  <dig> decreasing cooperativity in c dimer binding to cr promoter. the cooperativity in binding ω is gradually abolished from the very high value corresponding to wt ahdi  <cit>  to ω corresponding to the absence of the binding cooperativity. we predict the effect of this decrease on: a the dynamics of r protein synthesis, where the black line corresponds to the high ω, the light gray to no cooperativity, and the values of cooperativity in-between are shown in different shades of gray. b the stability of r steady-state levels, corresponding to different ω values shown in a





importantly, the first two ahdi features  have an opposite effect on the steady-state amount of r, as compared to the large cooperativity in c dimer binding. that is, while we showed that the first two features significantly increase the steady-state r amount, the third feature  significantly decreases it. on the other hand, all three features generally have the same effect on the three dynamical properties that we consider, i.e. abolishing these features either decreases the values of the dynamical property observables , or do not significantly affect them. this can then explain the extremely large binding cooperativity that was experimentally observed, as on the one side it allows controlling the steady-state amount of the toxic protein due to the opposite effect from the other two features, while at the same time working together with the first two features to ensure more optimal dynamical properties. in particular, note that both the large dissociation constant of dimerization and the large binding cooperativity significantly increase the stability of r steady-state levels, while having a significant - but opposite – effects on the steady-state r amounts.

ecorv wild-type dynamics
ecorv is an example of r-m system with a divergent organization of cr and m transcription units. overlapping cr and m promoters is the most distinctive feature of this system , which is, together with c protein binding, responsible for control of ecorv transcription. that is, high occupancy of m promoter by rnap, prevents rnap binding to cr promoter, leading to lower cr transcription activity, and vice versa. in modeling the gene expression regulation, we consider that cr promoter transcription is controlled by c, while c binding has little to none direct effect on m promoter transcription activity, as shown in  <cit> . in distinction to ahdi  <cit> , which shows an extremely high cooperativity in c dimer binding, no coperativity was found in ecorv  <cit> . we also assume that c dissociation constant of dimerization is significantly lower than the relevant range of c concentration, so that the majority of c molecules in solution exist as dimers. note that in another r-m system , which has a much lower cooperativity in c dimer binding compared to ahdi, a significantly lower dissociation constant of dimerization is also observed  <cit> . finally, in distinction to ahdi, c transcript in ecorv is not leaderless, so for ecorv we assume that c has the same translation initiation rate as r and m.

consequently, ecorv does not have the three features that control transcription in ahdi, but has instead another characteristic feature, i.e. the overlapping cr and m promoters. we therefore ask if ecorv, with different architecture and the regulation features, can also meet the three dynamical properties that we consider. to that end, we modeled the synthesis of r and m during the system establishment in wild-type ecorv, under the assumptions stated above, and following the scheme of the transcription configurations shown in fig.  <dig>  the model is provided in detail in additional file  <dig>  and is based on the same thermodynamics assumptions as the one for ahdi dynamics. to our knowledge, this presents the first model of expression dynamics for a divergent r-m system, which has a more complex regulation due to overlapping nature of their promoters. this model moreover presents the first opportunity to assess the dynamics of r and m synthesis for a divergent r-m system, as, to our knowledge, either their regulation or their expression dynamics was not previously measured.

the predictions for r and m accumulation in wild-type ecorv are shown by the full black curve  and by the black dashed curve , in fig.  <dig> below. from the figure we see that, regardless of lacking the characteristic ahdi regulatory features, the synthesis of r and m is well in accordance with the three dynamical properties. namely, by comparing fig.  <dig>  with the ecorv dynamics, we see that: i) the time delay for ecorv is even larger compared to ahdi, ii) there is a clear switch-like behavior of r expression in ecorv, i.e. the speed of transition from “off” to “on” state is comparable to the one in ahdi, iii) the system reaches the steady-state level , where the reached stabilities of r steady-state levels are comparable . therefore, we see that the design principles which we showed are inherent to ahdi r-m system, are retained in ecorv r-m system, despite the apparent distinction in gene expression regulation.fig.  <dig> increasing the dissociation constant of dimerization of wt ecorv system. the rescaled dissociation constant of dimerization k¯ <dig> is increased from the lower value with dimers in the solution corresponding to wt system, to the high value, where mostly monomers are in the solution. the effect of the increasing dissociation constant of dimerization is assessed on: a the dynamics of r and m synthesis. the solid and the dashed line correspond to r and m dynamics, respectively. different shades of gray correspond to the increasing value of the dissociation constant of dimerization, with the black line and the light gray line corresponding to the wild type and the monomer case, respectively. b the transition velocity vmax from “off” to “on” state. c the stability of r steady-state levels




introducing ahdi control features to ecorv
next, there is a question of why the characteristic ahdi features are absent from ecorv. that is, could we get even more optimal design-observables if ahdi control features are introduced in wild-type ecorv? therefore, we next use our model, to individually introduce each of the three control features of ahdi, on the top of the existing wt ecorv regulation . specifically, in the wild-type ecorv, we will perturb: i) the dissociation constant of dimerization towards the high values characteristic for ahdi, ii) cooperativity in c dimer binding to the promoter, also towards the high values observed in ahdi, iii) c protein translation rate k
c, towards the low values characteristic for leaderless ahdi c transcripts.

introducing the high dissociation constant of dimerization to ecorv
we first perturb the wt ecorv system by increasing the rescaled equilibrium dissociation constant of dimerization k¯ <dig> , which corresponds to a gradual transition from the solution containing mostly c dimers to the solution containing mostly c monomers. note that the dynamics of both r and m expression is now affected by the perturbation, in distinction to ahdi where only r expression is changed. this is because cr and m promoters overlap in ecorv, so that changing transcription from one promoter, necessarily impacts transcription from the other.

we observe that this perturbation does not significantly affect the early accumulation of r and m , but that the dynamics at later times is significantly affected . in particular, we see that increasing the dissociation constant of dimerization leads to a significantly slower switch from “off” to “on” state, so that the transition velocity decreases as much as four times . furthermore, in fig. 8c, we see that increasing k¯ <dig> also significantly decreases the stability of r steady-state levels Ω <dig>  which drops almost three times. consequently, introducing the high dissociation constant of dimerization to ecorv, which is characteristic for ahdi, has a significant adverse effect on two of the three dynamical properties.

introducing the high c dimer binding cooperativity
we next modify wt ecorv by increasing the cooperativity ω of c dimer binding to the proximal and the distal binding site, while keeping the other wt ecorv features unchanged. note that the experimental measurements in wt ecorv show an absence of c dimer binding cooperativity   <cit> , as opposed to the extremely large binding cooperativity that is observed in ahdi  <cit> . in fig.  <dig>  we see that increasing ω has the following effects: i) the time delay remains nearly the same , ii) the transition velocity decreases , where we see that increasing ω for a relatively moderate factor , leads to a significant  decrease of vmax, iii) stability of r steady-state levels slightly increases. consequently, we see that perturbing wt ecorv cooperativity towards the higher values characteristic for ahdi, has a significant adverse effect on one of the dynamical properties , while not significantly affecting the other two.fig.  <dig> increasing c dimer binding cooperativity in wt ecorv. the binding cooperativity ω is increased from the absence of cooperativity , to the higher values corresponding to cooperative c dimer binding. for each curve, ω is increased in steps by a factor of  <dig>  and the effect is assessed on: a the dynamics of r and m synthesis. the solid and the dashed curves correspond, respectively, to the dynamics of r and m synthesis. the black curve corresponds to wt , with the curves fading, as the cooperativity increases . b the transition velocity vmax. c the stability of r steady-state levels




decreasing c translation rate in ecorv
finally, we perturb wt ecorv by decreasing c transcript translation rate kc, towards the value characteristic for ahdi. note that c transcript is leaderless in ahdi  <cit> , which is not the case for ecorv  <cit> , so that we assume the same translation rate for all three transcripts  in ecorv, while k
c is taken as five times lower in ahdi according to  <cit> . in fig. 10a we observe that decreasing k
c does not impact the initial r and m accumulation . on the other hand, at later times the perturbation significantly decreases both the transition velocity that decreases two times , and the stability of r steady-state levels that decreases somewhat less than twofold . consequently, we see that again two of the three dynamical properties are significantly adversely affected by introducing a control feature from ahdi.fig.  <dig> decreasing c transcript translation rate of wt ecorv system. the translation rate of c transcript is decreased towards the low value characteristic for wt ahdi, and the effect is assessed on a the dynamics of r and m synthesis. the solid curves correspond to r, while the dashed curves correspond to m. the curves fade as k
c decreases, so that the black curve, and the light gray curve, correspond, respectively, to the maximal  and the minimal k
c. b the transition velocity from “off” to “on” state. c the stability of r steady-state levels




overall, introducing ahdi characteristic features to ecorv has a significant adverse effect on at least one of the dynamical properties, which may explain why those features are not found in ecorv. additionally, perturbing ecorv wt parameters towards the ahdi values  changes m to r ratio in the same direction for each introduced feature . this is in distinction to ahdi, where the high cooperativity of c dimer binding has an opposite effect on this ratio, compared to the other two features. consequently, we argue that another reason for why the characteristic ahdi features are not observed in ecorv, is because they do not allow balancing the amounts of r and m in the host cell.

CONCLUSIONS
r-m systems are characterized by different architectures and control features. we here test a hypothesis that these diverse features can be explained by constraints imposed by few dynamical properties. we started from a relatively well studied ahdi system, and computationally abolished three of its characteristic control features, showing that this has a clear adverse effect on the three dynamical properties. we then modeled a system with different architecture , and showed that its expression dynamics also satisfies the same properties. the ecorv model has significance in its own right, as the expression dynamics of the divergent r-m systems was, to our knowledge, not studied before, either theoretically or experimentally. finally, we computationally introduced to ecorv the control features that exist in ahdi, and showed that this diminishes at least some of the proposed dynamical properties, consistent with the fact that these features do not appear in wt ecorv. moreover, increasing the binding cooperativity has the same effect on m to r ratio in ecorv as increasing the dissociation constant of dimerization, or lowering the translation rate, which prevents balancing m to r ratio upon introducing these perturbations – this then provides another argument for why ahdi control features are absent from wt ecorv.

furthermore, dynamical properties proposed here can provide an explanation for a surprisingly large value of the cooperativity in c protein binding, accompanied by the large dissociation constant of dimerization that was observed in wt ahdi. we here showed that these two features have an opposite effect on the steady-state levels of the toxic molecule , allowing balancing the steady-state r amount, while at the same time leading to more optimal dynamical properties. in support of this proposal, a similar convergent system with lower binding cooperativity  was also found to have a lower value of the dissociation constant of dimerization. as a prediction, it will be interesting to test if, in other r-m systems, the value of the dissociation constant of dimerization and the binding cooperativity are also related in this way.

overall, this work provides an example that the system properties that may appear “random” or even surprising  may be explained by constraints imposed by few general principles . additionally, some of these system properties may serve other functions, e.g. the leaderless c transcripts might be related with a need for preferential translation under specific physiological conditions  <cit> . analyzing other r-m systems can further test relation of the system features with the simple dynamical properties, where the main obstacle is that their transcription regulation is generally not well studied. in particular, investigating up to now poorly understood linear r-m systems, which have different architecture compared to the convergent and the divergent systems studied here, and which do not encode c proteins – but may exhibit control by antisense rnas or at the level of translation initiation efficiency - may be particularly useful  <cit> . as a further outlook, it will be interesting investigating if properties of other bacterial immune systems, such as recently discovered crispr/cas systems  <cit> , can also be explained by similar dynamical properties  <cit> . with that respect note that crispr/cas is more advanced, i.e. adaptive bacterial immune system, which retains a memory of the past infections incorporated as spacers in the crispr array  <cit> .

also, in this work we follow a standard approach in molecular biology, where features of the system are perturbed/mutated , and the effect of these perturbations on the presumed system function is assessed. in addition to such “single mutations”, a computational equivalent of “double” or “triple” mutations can be exhibited, where more than one system feature would be simultaneously perturbed. this would address the question if perturbations in one feature, can be rescued by also perturbing the other feature, which is related to the system robustness. while this question is out of the scope of this work, it also provides an interesting outlook for future research.

finally, the recent advancement of experimental techniques, such as single-cell experiments, allows directly observing the protein dynamics during the system establishment. while in principle arduous, it would be interesting to experimentally observe how the relevant dynamics is perturbed when some of the key system features are abolished. this would then directly put to test some of the prediction from the computational modelling, which we provided here.

additional files

additional file 1: model of ahdi regulation and dynamics. 


additional file 2: model of ecorv regulation and dynamics. 




abbreviations
ccontrol protein

mmethyltransferase

rrestriction enzyme

r-mrestriction-modification

rnaprna polymerase

wtwild-type

