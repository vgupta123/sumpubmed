BACKGROUND
fungi comprise a large and diverse kingdom of organisms. it is estimated that as many as  <dig>  million species exist in the planet today  <cit> . most described fungi grow by producing long, multi-celled hyphae, and are known as filamentous fungi. filamentous fungi occupy a wide range of ecological niches with diverse life histories and physiological processes. many live as saprotrophs decomposing and absorbing nutrients from dead materials while others have evolved the ability to be pathogens deriving their nutrients from living or dying hosts. taking advantage of available genome sequences to explore the evolution of important gene families may help shed light on the processes that have allowed fungi to exploit diverse habitats.

the p450-containing monooxygenase system, an ancient multicomponent electron transfer chain system, plays an important role in a myriad of hydroxylation and oxidation processes leading to degradation, detoxification and syntheses of life critical compounds. p <dig> proteins, as the terminal oxidases of the system, are the ideal materials for evolutionary studies of biodiversity and adaptation for several reasons. first of all, p <dig> enzymes form a superfamily with similar heme-thiolate structures that are distributed widely throughout life forms. this implies a very early origin of this superfamily. the first p <dig> gene may have emerged more than  <dig>  billion years ago, shortly after the origin of terrestrial life  <cit> . secondly, the p <dig> superfamily consists of a large number of genes, contributing a broad array of biological functions in individual organisms. in addition to housekeeping functions, many have highly specialized function as the product of adaptive evolution. for example, pisatin demethylase gene  from nectria species detoxifies one specific class of the plant defence compound  <cit> . on the other hand, p450s in fungi are required for biosynthesis of several secondary metabolites such as toxins and hormones. thirdly, expansion and divergence of p450s has closely paralleled the evolution and coevolution of organisms. in fact, p <dig> gene evolution is thought to be correlated with historical biota evolution and atmosphere oxygen concentration flux  <cit> . specifically, the occurrence of certain important biota in history has been linked with a major branching of p450s followed by a great expansion of the diverged branch. in a case study of coevolution of plants and animals, it was proposed that intraspecific and interspecific polymorphisms of p450s in the predator  and prey  may be the product of the evolutionary warfare between them, i.e. plants are driven to produce defence chemicals-toxins while animals strive to produce new detoxifying genes  <cit> . for example the expansion of cyp <dig> gene family in the swallowtail butterfly appears to be linked to the ability to detoxify xanthotoxin  <cit> .

in spite of the wide sequence diversity and function of p450s, certain sequence motifs corresponding to the conserved tertiary structure and enzyme functions are identifiable. the signature motif  is required to bind heme, however, only cysteine is absolutely conserved across all p <dig> genes. another motif called the e-r-r triad is thought to be important for locking the heme pocket into position and to assure stabilization of the conserved core structure. the e-r-r triad lies in the k-helix beginning with consensus  and ending with the arg in the "per" consensus. a third relatively conserved motif is the i-helix oxygen binding domain g-t . all these motifs are short overall and somewhat variable. to group members within the p <dig> superfamily, genes are assigned into families and subfamilies based mainly on amino acid sequence identity. genes are assigned to families when they share greater than 40% amino acid identity with reference sequences and are assigned to subfamilies when there are more than 55% identical  <cit> . families are designated a cyp number based on blocks of numbers reserved for different taxonomic groups. thus cyp <dig> to cyp <dig> and cyp <dig> to cyp <dig> are fungal families. a higher order for grouping p <dig> genes, called the clan has been proposed and applied to studies of p450s from different kingdoms. the introduction of clan attempts to group genes based on robust phylogenetic relationships. genes within a clan likely diverged from a common ancestor gene  <cit>  and may share common functions  <cit> . however, clan membership parameters have not been clearly defined  <cit> . in fungi, few phylogenetic studies using p450s have been reported. in a recent report of p450ome for p. chrysosporium,  <dig> cyp families were classified into  <dig> clans based on a phylogeny inferred by upgma  <cit> .

in this study, we chose to characterize the p450s from four filamentous fungi for which draft sequence was recently released. we compared  <dig> plant pathogens, m. grisea  and fusarium graminearum , both of which are classified taxonomically as pyrenomycetes with  <dig> saprotrophs, aspergillus nidulans  and neurospora crassa . nc is also a pyrenomycete whereas an is classified as a related plectomycete. all four fungi are ascomycetes and share some common ecological features. all are able to grow on non-living organic matter, i.e. have a saprotrophic component in their lifecycle. however, mg and fg are distinct from an and nc because they can also derive nutrients from living plants, behaving as parasites. in nature, mg typically infects above ground tissue, causing foliar blast disease of grasses and is particularly devastating on rice. the fungus can also infect root tissue under laboratory conditions. its closest relatives in the magnaporthaceae family are all root pathogens. fg is the most common causal agent of fusarium head blight disease, causing sterile florets, withered kernels and mycotoxin contamination of small grains. both fg and mg over-winter in plant debris or soil where they live as saprotrophs. an and nc, on the other hand, are not pathogenic. an is cosmopolitan and is commonly isolated from soil. nc is also widely distributed and typically is associated with decay of organic materials following fires. nc is notable for the discovery of an active defence mechanism called repeat-induced point mutation . rip effectively mutates duplicated dna sequence such as invading mobile elements and has been shown recently to be present in several other fungi including mg and some aspergillus species. rip has had a profound effect on the genome evolution of nc. because gene duplication is one of the major mechanisms for the evolution of the p <dig> superfamily, we were particularly interested to investigate what effect rip may have had on the evolution of p450s in nc and the other three fungal species.

to carry out the comparative analyses of p450s in these fungal genomes, all identified p <dig> genes needed to be first clustered in order to begin an assessment of their evolutionary relationships. however, clustering of these p <dig> genes was complex due to unprecedented sequence divergence. conflicting membership of some genes to particular clusters were found when comparing results based on standard family classification and other clustering and phylogenetic analyses. in this report, we demonstrate that these conflicts can be resolved through the formulation of a standardized methodology to define high order clans. in addition, a novel approach is designed to reconstruct the p <dig> gene gain and loss history during the evolution of these four fungi by applying comparative studies using parsimony models.

RESULTS
distribution of p <dig> genes and designated gene families in filamentous fungi
inspection of the predicted open reading frame revealed that the fungal genomes contained between  <dig> and  <dig> p450s, with exception of nc which contained  <dig> . in total,  <dig> orfs were identified as p <dig> genes from the four filamentous fungi. three were possible pseudogenes and two were less than  <dig> amino acids long, which were excluded from further study. for the remaining  <dig> genes,  <dig> appeared to be correctly predicted. others were modified by the p <dig> nomenclature committee for possible incorrect exon calls, gene calls or fused orfs . based on the standard nomenclature, p450s with greater than 40% sequence identity were classified into a family. as a result, the  <dig> genes were assigned to  <dig> families. one hundred and nine p <dig> genes in an were placed in  <dig> families,  <dig> genes in fg in  <dig> families,  <dig> genes in mg into  <dig> families and  <dig> genes in nc into  <dig> families . among the  <dig> total families, only  <dig> contained  <dig> or more members and the other  <dig> families contained only a single gene, i.e. were orphan families. forty orphan families were present in an,  <dig> in fg,  <dig> in mg and  <dig> in nc, respectively . on the other hand, only  <dig> families contained more than  <dig> genes. the largest family in this study was cyp <dig> which contained  <dig> members. however, members of this family were quite divergent in terms of the sequence identity . furthermore,  <dig> families were represented in only one fungal genome, defined as self family, in a sharp contrast to only  <dig> families that were present in all four fungi . on average, a standard family contained less than  <dig> genes in each fungal genome. the sequence divergence of p450s in these fungal genomes was considerably more prominent than observed in animals  and plants . in summary, our results revealed that fungal genomes contain large number of p <dig> genes that have undergone extensive sequence diversification. relatively few homologous gene sets are shared among the four fungi while large numbers of gene families are unique to a particular fungal genome.

a. number of orfs for model animals and plants are approximate.

b. three genes from mg and two genes from an were subsequently excluded from this study .

optimization of p <dig> sequence alignment
of the total  <dig> genes in this study, our motif finding procedure identified the heme binding signature motif in  <dig> genes; oxygen binding motif in  <dig> genes and err triad motif in  <dig> genes. without any further adjustment in repositioning these motif sequences, we found the percentage of genes with each motif aligned correctly were  <dig> %,  <dig> % and  <dig> % respectively. to improve alignments, the  <dig> sequences were split into three groups based on their signature motif alignment pattern. group i contained  <dig> genes  with their signature motifs aligned well. group ii contained  <dig>  genes whose signature motifs aligned together but were  <dig> amino acids downstream of the aligned position of group i. the remaining  including the  <dig> p450s, which lacked a clear signature for the heme binding motif, were singleton sequences. following building the profile alignment for group i and group ii separately, the two aligned profiles were merged using profile alignment option from clustalx. finally, we aligned the merged alignment with the unaligned  <dig> sequences. as a result, we obtained an improved alignment for all  <dig> genes; the percentage of genes with aligned signature motif rose to  <dig> % while the percentage of genes with aligned oxygen binding motif and err triad motif increased to  <dig> % and remained at  <dig> %, respectively.

support for standard family designation by phylogenetic and other clustering methods
nj and mp trees were constructed using all  <dig> genes  and clades were collapsed into a single branch when all operational taxonomic units  in a particular clade were from one family . analyses of these two collapsed trees revealed that out of a total of  <dig> families containing  <dig> or more genes, only  <dig> families did not form monophyletic groups on either tree . it should be noted that the three families containing the largest number of genes in the four fungi, cyp <dig>  cyp <dig> and cyp <dig>  were within the list of  <dig>  in addition, two families were monophyletic on the mp consensus tree but not on nj tree and three families were monophyletic on the nj tree but not on the mp consensus tree. overall, although the grouping of most multi-member families was supported by the phylogenetic analyses, there were  <dig> exceptions . this suggests possible inaccuracy in tree construction or more likely inappropriate assignment of p450s to particular families. to investigate this further, additional analyses were conducted.

a. orphan clans  are not listed. there are  <dig> orphan clans associated with character state pattern  <dig> , clan  <dig>   <dig>  656– <dig>   <dig>   <dig>  666– <dig>   <dig> , 677– <dig>  683– <dig>  687;  <dig> orphan clans associated with pattern  <dig> , clan  <dig>   <dig>   <dig>  624– <dig>   <dig>  637– <dig>  645;  <dig> orphan clans associated with pattern  <dig> , clan  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig> , <dig>   <dig>   <dig>   <dig>   <dig>  608– <dig> and  <dig> clan associated with pattern  <dig>  clan  <dig> 

b. parentheses indicate the number of genes within each family.

c. "t" indicates total number of genes in a clan.

d. "b.v" indicates bootstrap support for a clan.

e. "i" indicates total number of introns in a clan.

f. "ui" indicates the number of unique introns in a clan.

g. "uip" indicates unique intron percentage. uip = ui/i.

** families and genes that were not monophyletic on nj tree nor mp tree.

^ families only monophyletic on mp tree.

~ families only monophyletic on nj tree.

cogs are commonly used to identify sets of orthologous genes. our cogs analyses resulted in  <dig> orthologous groups . ten groups contained members from all four fungi while  <dig> groups contained orthologous pairs from just two genomes. comparing the cogs groups with the standard family designation revealed  <dig> groups contained members from more than one standard family. these results further support the need for efforts to classify p <dig> genes beyond standard family designation.

clustering all our p450s genes was also performed based on pairwise sequence percentage identity using the complete linkage algorithm  <cit> . a cutoff value of 39% was found to yield the greatest degree of concordance with the standard family designation. at this cutoff, we obtained  <dig> complete linkage families of which  <dig> were identical to the standard families . therefore, out of  <dig> standard families, only  <dig> did not cluster as one complete linkage group or contained member from another family. the  <dig> families included  <dig> multi-member families and  <dig> orphan families. inspection of all members of a particular discordant family revealed that the majority of multi-member families were split into several groups. occasionally, these groups harboured members from one or more families. there were examples where a higher degree of sequence identity was observed to genes from other family than to members of its own family members, even though it formed a monophyletic group with its family members.

overall, our results from the cogs clustering and complete linkage clustering demonstrate extensive overlap with the grouping designated by standard families. however, as noted above, members of some standard families fell into other groupings. to investigate whether these conflicts could be resolved, we decided to evaluate higher order relationships.

higher order grouping resolves the conflicting results from different clustering methods
to establish higher order relationships, we combined all genes belonging to one clade derived from nj into a clan when the connecting branch was supported by bootstrap values >70%. according to hillis and bull  <cit> , "70%" bootstrap value corresponds to a probability >= 95% that the clade is real. however, we recognize that equating bootstrap value with statistical significance is not universally accepted. only two exceptions were made. the clade containing all three cyp <dig> genes was only supported with a bootstrap value of 44% . however, we included them as a clan because the three genes formed a cog and they shared as high as 59% percent sequence identity . in addition, we forced the orphan clan ancyp671a <dig> into clan  <dig> that contained ancyp671b <dig>  the only other cyp <dig> family member in our study. these two genes shared more than 43% sequence identity, thus forcing them in same clan conserved the original nomenclature. overall, this resulted in  <dig> clans ;  <dig> were shared clans  and  <dig> were self clans . this revised classification reduced the self units by  <dig>  from  <dig> families to  <dig> clans, and cut orphans  by  <dig>  from  <dig> families to  <dig> clans, indicating that we were able to identify additional orthologous/paralogous relationships. similarly, the shared standard families were reduced from  <dig> to  <dig> shared clans while  <dig> multi-member families were reduced to  <dig>  reflecting a trend to cluster different families into a clan.

however, there were two exceptions to this trend. the cyp <dig> family was split into  <dig> clans and the cyp <dig> family was assigned into two clans . our new clustering schema nevertheless resolved the vast majority of conflicting results between standard family clustering and other clustering methods as described in detail below:

1). comparison of nj tree and mp tree with standard family designation. as shown in table  <dig>  seven multi-member families did not form monophyletic groups on either the nj tree or the mp tree. as a result of formulating clans,  <dig> were resolved into five multi-family clans. the remaining  <dig> families, cyp <dig> and cyp <dig> were split. splitting the cyp <dig> family was supported by both phylogenetic analyses and complete linkage clustering analysis. cyp <dig> members were dispersed on  <dig> and  <dig> different branches and interlaced with other family members in the nj tree and the mp tree, respectively. furthermore, cyp <dig> members were dispersed over  <dig> different complete linkage groups at cutoff value of 39%. in fact, the percent identity among some pairs of cyp <dig> members was as low as  <dig> %, lower than  <dig> % of all gene pairs used in this study. therefore, it was not surprising to find that the  <dig> cyp <dig> family members were divided into  <dig> clans as a result of our re-classification process. as for cyp <dig>  results of every analysis including the nj tree , the mp tree and complete linkage analysis supported cyp532e <dig> being split from the family and merged with cyp <dig> and cyp <dig> families. combining them formed a new clan, clan  <dig> 

2). comparison of cogs clustering with standard family designation. out of the  <dig> orthologous groups which contained members from multiple families,  <dig> groups were resolved into clans after our re-classification efforts . the cog consisting of cyp614a1-cyp590a <dig> pair and another cog consisting of cyp665a1-cyp592a <dig> pair would each be clustered into a particular clan respectively if the bootstrap cutoff was relaxed slightly; 66% and 59% respectively. thus, only  <dig> cogs, cyp60b1-cyp65a <dig> pair and the cyp611a1-cyp636a1-cyp660a <dig> triplet had poor bootstrap support.

3). comparison of complete linkage clustering with standard family designation. there were  <dig> multi-member families and  <dig> orphan families which were not identical to complete linkage families formed at a cutoff of a 39% sequence percentage identity . reducing the cutoff brought together the respective members of  <dig> families. all members of the other  <dig> multi-member families  could be rejoined with their respective family members by reducing the cut-off. however, this resulted in the inclusion of members from other families. nevertheless, each of these composite families fell into one particular clan . finally, one orphan family, cyp <dig> was combined with cyp <dig> family members. this was also supported by our clan definition.

species topology of four filamentous fungi
for four taxa there are three possible unrooted trees . the species tree topology constructed by the mp algorithm based on character data matrix derived from standard family clustering, clan clustering and cogs clustering unanimously support tree  <dig> . in a recent comprehensive analysis, this tree is supported by the evaluation of  <dig> genes in  <dig> fungal species  <cit> . the monophyletic relationship of the pyrenomycetes was supported by phylogenies constructed using  <dig> randomly selected sets of  <dig> concatenated genes <cit> . based on this topology, an, a plectomycetes, is first split from the other pyrenomycetes. within the three pyrenomycetes, fg split from the common ancestor of mg and nc. this topology was also supported by results from our reconcile analyses . in total,  <dig> clans contained members from all four species. reconciling each of the  <dig> genes trees to each of the three species tree topology resulted in three cost values for each clan corresponding to each species tree topology. summing the cost value for each species tree topology across all  <dig> clans provided the total cost for each species tree. tree  <dig> resulted in the least cost among the three topologies . however, species trees constructed using sequences of three classical genes, 18s rrna, α tubulin and elongation factor  <dig> did not uniformly support a particular topology . among the trees constructed from dna or protein sequences of each of the  <dig> genes and  <dig> different tree construction methods, all three possible unrooted trees obtained support from at least one gene combined with one method. however, in many cases the bootstrap support was very weak. in the only three cases were bootstrap values more than 95%, two supported tree  <dig> and  <dig> supported tree  <dig>  our preferred topology. interestingly, in many cases using dna sequence and protein sequence for the same gene resulted in different supported trees. regardless of the inconsistent results using individual genes, additional analyses were conducted using tree  <dig>  the phylogeny supported by all parsimonious analyses results using p450s.

reconstruction of the phylogenetic origin of clans
among the  <dig> possible character state combinations representing all possible combinations of presence or absence of clans distributed within the four fungi , nine were unambiguous. thus, the phylogenetic origin of  <dig> of  <dig> clans could be assigned definitely on the species tree. clans associated with the remaining patterns had two equally parsimonious paths. two of these, pattern  <dig> and pattern  <dig>  could be resolved based on the reasonable expectation that if a clan was present in  <dig> separate fungal lineages, the clan was present in the lca of the two lineages. to account for the remaining four patterns, we developed  <dig> parallel models; a gain and a loss model . in the gain model, ambiguous clans were considered to be absent in lca of the four fungi followed by a gain  event on one branch  and no change  on the other branch. for the loss model, the lca were assumed to possess the clan, i.e. state  <dig>  followed by a loss  event on one branch and no change  on the other branch.

regardless of whether considering the gain or loss model, the number of clans gained and lost on each branch descended from node  <dig>  the ancestor of the pyrenomycetes, were the same. however, the origin of some of these clans was dependent on these two models. in the gain model, some clans lost in mg or nc lineages first appeared in branch  <dig> . in contrast, in the loss model, all clans that were lost in mg or nc were already present in lca. a common finding between both models was that only one clan was gained in the nc lineage while  <dig> clans were gained in mg and  <dig> clans were gained in the fg lineage. on the other hand, the number of clans gained by the an lineage was model dependent and ranged between  <dig> and  <dig>  a further difference between the two models was the number of clans present in the lca;  <dig> based on the gain model and an additional  <dig> for a total of  <dig> based on the loss model.

gene duplications and losses within each clan
the number of duplication and loss events within individual clans that occurred on all branches of the species cladogram was inferred as described in methods. twenty-seven clans appeared to have had at least one duplication event before an split from the lca , independent of gain or loss model, suggesting that the lca genome contained more than one member of these clans. in total, genes from these  <dig> clans accounted for  <dig> p <dig> genes in the lca genome. in particular, clans containing larger numbers of genes were usually present in the lca. for  <dig> clans which contained  <dig> genes or more,  <dig> of them were unambiguously inferred to be present in the lca. furthermore, we found a positive relationship  between the number of genes within a current clan and the inferred number of ancestral genes of the clan present in the lca genome. however, one obvious exception was clan cyp <dig>  the third largest clan. it contained  <dig> p <dig> genes from the four fungi. however, only  <dig> cyp <dig> ancestral genes were inferred to be present in the lca genome. thus, it appeared that clan  <dig> must have experienced considerable expansion after the an split. our data suggest that there were  <dig> duplication events on branch  <dig>   <dig> in branch a,  <dig> in branch f and  <dig> in branch m . therefore, clan  <dig> is a clear example of an orthologous group of genes that resulted from filamentous fungal lineage specific expansion.

the remaining  <dig> clans from the total of  <dig> clans were predominantly small clans; only three clans contained more than  <dig> genes. among these  <dig> clans, the number and branch location where duplication and loss events occurred could be unambiguously inferred for  <dig> clans. for the residual  <dig> clans, the number of duplication or loss events only differed between the gain and loss model at two branches; branch a and branch  <dig>  however, the difference between the two models was exactly "1" representing either a gain of new clan or a loss of ancestral clan in either of the two branches.

final resolution of gains and losses
based on the inferred origin of each clan and the inferred gain or loss of genes within each clan, we deduced a complete picture of the evolutionary history of p <dig> genes in these four fungi . from the gain model, which we favour over the loss model , the lca genome had  <dig> p <dig> genes from  <dig> clans compared to  <dig> genes from  <dig> clans in the loss model. since the gain and loss models are based on two alternative extremes, the actual number of p <dig> genes and clans in the lca may lay within these boundaries. for genes belonging to the  <dig> clans present in the lca based on the gain model , our analyses revealed that overall loss of ancestral genes was much more prevalent than expansion. this trend was prominent on almost every branch with the exception of branch  <dig> where gene losses equalled gains. for example, of the  <dig> lca genes belonging to  <dig> clans,  <dig> in  <dig> clans  were lost but only  <dig> in  <dig> clans  were gained in the branch a descended from lca. similarly, in the branch f,  <dig> ancestral genes derived from lca clans were lost in  <dig> clans  and only  <dig> in  <dig> clans  gained. moreover, branch f completely lost  <dig> lca clans. nc was the most extreme example. on branch n,  <dig> genes derived from  <dig> lca clans  were lost and there was no evidence of gene gains. furthermore,  <dig> lca clans were completely lost in this lineage. however, this trend was more modest in branch m. only  <dig> genes in  <dig> clans  were lost,  <dig> genes in  <dig> clans  were gained and  <dig> lca clans were completely lost. in sum, gene losses from the lca derived clans appear to have occurred much more frequently than gene gains on all branches descended from node <dig> as well as on the branch a during evolutionary history, regardless of model. the rate of gene duplication and loss within clans was similar for three of the fungal lineages, an, fg and mg, ranging between  <dig>  and  <dig> events per clan in the gain model. in the nc lineage, on the other hand, the lca derived genes were exclusively lost.

in addition to gene duplication and loss events from within lca derived clans, a large number of new clans were created in each fungal lineage with the exception of nc. in the nc lineage branch , there was only evidence for the gain of a single new clan , whereas an, fg and mg gained  <dig> ,  <dig>  and  <dig>  new clans, respectively . these lineage specific gains occupy a significant part of current p450omes in an, fg and mg. they also appear to compensate for gene losses that occurred from within the lca clans so that the current p450omes of the three fungi are approximately similar in size to the predicted number present in the lca. nc is an obvious exception and has much smaller p450ome compared to the lca and the other three fungi. this appeared to be the result of losses of ancestral p <dig> genes coupled with only a single gene gain.

our observations above are in general consistent when the loss model is applied , the only major exception being that the lca genome would possess a much larger p450ome . another consequence of applying the loss model is that there would be no lineage specific gains and more contraction of the lca clans on branch a and in the branch  <dig>  therefore, invoking the loss model as the other extreme does not compromise but actually strengthens our conclusion that the lca derived clans experienced significant loss events and few gains. furthermore, the total number of gains and losses were the same regardless of whether applying either model on all branches descended from node  <dig>  the ancestor of the pyrenomycetes.

evaluating the overall gene gains and losses on each of the four fungal lineage specific branches, regardless of origin, revealed that mg lineage gained nearly twice as many genes compared to losses. this is in complete contrast to fg, an and nc. the mg lineage branch gained  <dig> genes and lost  <dig>  whereas the fg lineage branch gained  <dig> and lost  <dig> and an gained  <dig> and lost  <dig> in the gain model and gained  <dig> and lost  <dig> in the loss model. the nc lineage only gained  <dig> and lost  <dig>  the large number of gene gains in the mg lineage is intriguing because this lineage presumably evolved more recently, particularly compared to the an lineage.

p <dig> genes do not appear to be highly clustered in filamentous ascomycete fungal genomes
we defined a gene cluster as  <dig> or more p450s present within a  <dig> kb sliding window of genome sequence. this revealed the presence of  <dig>   <dig>   <dig> and  <dig> p <dig> gene clusters in the genomes of an, fg, mg and nc, respectively . however, none of the clusters contained all p <dig> genes from the same family or clan. at most, two genes were from the same clan or family in any gene cluster. furthermore, the gene pairs which resulted from lineage specific duplication events, as inferred by our gain model, were not located within the same clusters.

intron-exon structure is marginally conserved
among the  <dig> p <dig> genes,  <dig> contained no introns. in contrast, cyp659a <dig> from an had  <dig> introns, while the next highest number of introns in a p <dig> gene was  <dig>  the remaining p450s harboured between  <dig> and  <dig> introns . the average number of introns present in each gene was  <dig>  and totalled  <dig>  as described above, p <dig> genes were associated with  <dig> multi-member clans and  <dig> orphan clans. nine hundred and eighty-six  introns were present in the  <dig> genes belonging to multi-member clans. a string of numbers representing the intron-exon structure and unique intron position  value for each clan are shown in table  <dig> and additional file  <dig>  the results demonstrate that the intron-exon structure is not well conserved for most clans. first of all, only  <dig> multi-member clans  had at least one consensus intron . there were a total of  <dig> clans with more than  <dig> members, only  <dig> had at least one consensus intron. secondly, 39%  of the total  <dig> introns were unique . the remaining  <dig> introns were present in  <dig> positions among the  <dig> clans. therefore, it was not surprising to observe a uip value as high as  <dig>  on average, across all clans. thus approximately half of the introns within each clan were unique. however, the uip value varied greatly among clans. there were  <dig> clans with a uip value  <dig>  as well as  <dig> clans with a value  <dig>  . values from clans other than these eight exhibited approximately a normal distribution with a mode value around  <dig>  . therefore, intron-exon structures were not well conserved for most p <dig> clans with a small number of apparent exceptions. when considering individual genomes of the four filamentous fungi, the uip value for the majority of clans were also high with consensus introns being rare. for example using the largest clan, clan cyp <dig>  consisting of  <dig> genes , the uip was  <dig>  for all  <dig> introns in  <dig> an p <dig> genes in this clan,  <dig>  for  <dig> introns in  <dig> fg p <dig> genes,  <dig>  for  <dig> introns in  <dig> mg p <dig> genes and  <dig>  for  <dig> introns in  <dig> nc p <dig> genes, as compared to an overall uip value for this clan of  <dig> .

discussion
p450ome of filamentous ascomycetous fungi exhibit considerable divergence in terms of sequence, intron-exon organization and genome location
in this work, we discovered that filamentous ascomycetous fungi, with the noticeable exception of nc, contain in excess of  <dig> cytochrome p <dig> genes. this is close to the number found in the basidiomycetous fungus , animals , but considerably fewer than found in plants . overall, between  <dig> – <dig> % of the entire predicted open reading frames encode p450s. a notable difference between the p450s in the filamentous ascomycetes and other organisms is the level of sequence divergence. p450s in the fungi studied here are considerably more divergent. with the exception of nc, p <dig> genes within filamentous ascomycetes fall into more than  <dig> distinct families, each possessing ~ <dig>  genes on average, whereas for plants and animals, the number of distinct families ranges between  <dig> and  <dig>  with each family containing between  <dig> to  <dig> members on average. in nc, each family contains a single member with only  <dig> exceptions . nc possess a genome defence mechanism, known as rip which serves to destroy repeat dna sequence such as invading viruses  <cit> . this mechanism presumably was able to effectively suppress creation of new genes via gene duplication. in contrast, p. chrysosporium has been reported to contain relatively few distinct families, each contained  <dig> members on average  <cit> . in plants, animals as well as p. chrysosporium, intron-exon organization is well conserved  <cit> . for example, the a-type  p <dig> clade in arabidopsis which contains  <dig> genes and several families has very few unique introns  and forms a single monophyletic group. in addition, there is one clearly conserved intron present at the same position of almost all of the genes . this is significant because half of the genes have only one intron while the others possess at most three introns with one exception. this is in distinct contrast to our findings for filamentous ascomycetes. the vast majority of clans containing multiple members did not contain a conserved intron, and nearly half of the introns were unique. it is noteworthy that the intron positions in p. chrysosporium members of two well studied families  were generally well conserved and co-localized in the genome  <cit> . this suggests that gene duplication typically occurred locally and that these events occurred relatively recently. in contrast, there is little evidence of co-clustering of family members in the genome of filamentous ascomycetes, suggesting they are more ancient as evidenced by sequence divergence and that they have become widely distributed about the genome predominantly through translocation events  <cit> . with more sequenced fungal genomes being sequenced, we are currently investigating whether it is generally true that ascomycetes tend to have a much more diverged p450ome than basidiomycetes. if this turns out to be true, does this trend apply to other gene families?

need for higher order classification of fungal p <dig> genes
our attempt to reconstruct the phylogeny for p450s in filamentous ascomycetes was hampered by their extreme sequence divergence and the large number of genes involved. to initiate phylogeny reconstruction, we identified the three core sequence motifs as an aid to ensure the best possible alignment of the sequences. the motif logo was useful for the signature motif, but due to sequence divergence, our ability to define good sequence logos for the other motifs was limited. we also used introns-exon structures to check the accuracy of our final alignments. as shown in additional file  <dig>  intron position generally aligned well in the few cases where they were conserved. attempts to reconstruct the overall phylogeny using the aligned sequences by distance  or parsimonious  method were unsuccessful due to conflicting relationships obtained by the different methods. however, by proposing a higher order grouping, the clan, the vast majority of these conflicts evaporated. moreover, the clan groupings were generally very well supported by both cogs and complete linkage clustering.

the concept of "clan" was proposed to accommodate the flood of new p <dig> families designated by the standard nomenclature committee. p <dig> clans were proposed to encompass genes derived from a single common ancestor and could contain one or more families  <cit> . however, previous efforts to define p <dig> clans in plants and animals are somewhat arbitrary and clan classification has not been standardized. consequently, ten and nine clans were proposed to occur in plants and vertebrates respectively  <cit> . in order to formalize the clans for ascomycete fungal p450s, we selected groupings that were supported by a bootstrap value of >= 70%. this value has been adopted by many systematists as an indication of support for a particular topology  <cit> . using the 70% cutoff value on a phylogenetic tree, we found that the vast majority of conflicting clustering results from the different methods used in our studies were resolved. this cutoff maybe too stringent in some instances to define clans because there were several examples of where pairs of orthologous genes were clearly grouped together on the phylogenetic tree with bootstrap value of <70%. however, making these assessments requires considerable manual inspection.

a novel strategy to trace the ancestral history of genes in a highly divergent superfamily
after assigning p450s into clans, we wished to identify the ancestral origin of each clan and to explain the current distribution of genes in the four fungal species on a clan by clan basis. an approach to begin to address these questions is to view each clan as an evolving character in the hierarchical context of the species tree  <cit> . as described in results, there is not universal support for one particular species topology for the  <dig> fungal species used in our study, however, most evidence points to the tree we settled on for our evolutionary reconstruction studies . this topology is supported by our p <dig> data as well as a recent report from galagan et al  <cit> , which used  <dig> fungi, including the  <dig> used in our studies, and protein sequences from  <dig> genes. to reconstruct the phylogenetic origin of p <dig> clans, we applied wagner parsimony to infer the ancestral state, which assumes gain and loss are equally parsimonious. a common assumption was made that clans present in two descendents were inherited from their last common ancestor in order to resolve some paths that were equally parsimonious. in other cases where ambiguity could not be resolved, two models were proposed, a gain model and a loss model. the number of character state changes resulting from application of these two models likely represents the two extremes.

parsimony analysis using the reconcile process was used to explain the current distribution of p <dig> genes within clans for the  <dig> fungal species superimposed upon the species tree. identification of the duplication and loss events is straightforward in the clans that exhibited a single most parsimonious path when inferring their origin. however, for clans that originated in branches descending from the lca node, it was necessary to impose a gain event at the branch where the clan originated. on the other hand, for clans whose origination was ambiguous, the gain or loss model needed to be inferred prior to applying the reconcile process.

gain and loss models were introduced to account for the parsimonious ambiguity for inferring the origin of certain clans. comparing the virtues of the gain and loss models, we believe the gain model more closely represents the real world situation for the following reasons. first, the overall branch length in the gain model appears to be more compatible with species evolution than the loss model, assuming the branch length is proportional to the sum of clans  gained and lost by each lineage. for example, in the gain model,  <dig> new clans appear in the an lineage and no loss events from the lca. in the fg lineage  <dig> clans were gained and  <dig> were lost for a total of  <dig> from the lca . similar values would be expected because the same period of time has elapsed from when the pyrenomycetes split from the plectomycetes. in contrast, in the loss model, the an lineage gained no new clans and lost  <dig>  whereas the fg lineage gained  <dig> and lost  <dig> for a total of  <dig>  furthermore, under the loss model, it would not seem reasonable that while fg and mg lineages gained new clans none appear to be gained in the an lineage.

it is worth noting that the number of clans and genes present in the ancestor of the pyrenomycetes  and the total number gained and lost on the descendent branches are not model dependent, suggesting that the evolutionary history of these p450s are robustly predicted.

the evolution of p450s in filamentous ascomycetes
by comparing the number of genes under both models, the lca genome may have possessed between  <dig> to  <dig> p <dig> genes. the lca thus had a similar size of p450ome compared to the current filamentous ascomycetes except for nc. thus, the p450ome size does not appear to have undergone expansion for around  <dig> hundred to  <dig> hundred million years in the ascomycete branch within the tree of life  <cit> . however, based on the gain model favoured by us as discussed above, the p <dig> genes in the lca were classified into  <dig> clans compared to the > <dig> present in an, fg and mg. in particular, regardless of gain or loss model, the last common ancestor of the three pyrenomycetes  contained  <dig> clans, considerably fewer than present in fg and mg. thus, during the evolution of these fungal lineages the p450ome has continued to diverge with the apparent loss of members from these  <dig> clans and the emergence of genes in new clans. it is intriguing to speculate whether there exists a certain selection pressure or stabilizing requirement which prohibited an overall gain in the size of the p450ome during the evolution of these four fungi. also, whether there is any selection pressure to maintain a balance between these  <dig> conserved clans and those that newly emerged. these  <dig> clans may represent the minimum p450ome of filamentous ascomycetes as most of them are maintained in the four fungi . these conserved clans may represent the core functions of p450s required by filamentous ascomycetes and most are likely present in other related filamentous ascomycetes. notably, eight out of the total eleven p <dig> clans in the basidiomycetous fungus p. chrysosporium  <cit>  overlapped with these core clans. these core clans usually contained multiple members  in the lca. thus the loss of entire clan in other fungal lineages after the lca would require multiple loss events of ancestral genes, which is unlikely and would be probably selected against. ancestral genes in these clans were gained and lost at a very similar rate until the fg lineage emerged. during this same period, several new clans appeared. thereafter, but before the emergence of the mg and nc lineages, loss instead of gain dominated the evolution of genes with respect to these core clans. in the nc lineage, loss of p <dig> genes from core clans continued. in the mg lineage, there was expansion of some of the core p <dig> clans accompanied by the appearance of a large number of new clans. as described in results, it is perhaps not surprising that the nc lineage was unable to evolve new clans and that genes were lost from ancestral clans due to the presence of rip. however, it is interesting to note that regardless of invoking the gain or loss models that there were very few genes gains to new or core clans immediately prior to the mg and nc split. this suggests that the ancestor common to mg and nc may also have had a mechanism to eliminate duplicated genes. indeed, a rip-like mechanism has been reported in mg and several other fungi including aspergillus species  <cit> . however, rip is not active in all mg strains and appears to be much milder than observed in nc. other factors, nevertheless, such as selective pressure, ecological niche adaptation may also have driven p450ome evolution. for example, after nc and mg lineage split, the expansion of p450ome in the mg lineage may have resulted from increased selection pressure to successfully adapt to its pathogenic life style on a number of grass host species. in contrast, it is possible that p <dig> gene expansion would interfere with or provide no advantage for nc to survive as a saprotroph.

for clans which we were unable to reliably assign origin to the lca, they may have been either derived from a gene which was horizontally transferred, such as the cyp <dig> clan, or diverged to the extent that we can not trace their origin to a core clan. genes in cyp <dig> clan, such as p450nora and p450norb from fusarium oxysporum, which encode nitric-oxide reductase, have been shown, based on sequence comparison  <cit>  and phylogenetic analyses  <cit> , to be more closely related to bacterial genes such as streptomycetes cyp <dig> and cyp <dig> than to eukaryotic p450s. in the latter and more typical instance, members of new clans likely represent genes which experienced neofunctionalization following duplication from the ancestor p450omes. these genes probably evolved at a fairly fast rate after duplication while the selective constraint was relaxed. thereafter, there may have been a period of positive selection, which resulted in neofunctionalization and their retention in the genome. our parsimonious analyses revealed that 31% of the mg p450ome, 20% of fg p450ome and 2% of the nc p450ome were derived from clans created within their own lineage. for an, 26% were derived from its own lineage based on the gain model. therefore, the mg lineage appears to have experienced a higher degree expansion of new clans compared to the other fungi in our study. additionally, the contraction of core p <dig> clans appears milder in mg compared to the other three. the biological relevance of these events is unknown; however, it may suggest that the mg has been involved in more intense warfare with its hosts than the other plant pathogen, fg, and/or mg has been more active in exploiting diverse habitats than the other three fungi. detailed analyses including functional studies of specific clans in these four fungi that exhibit differential expansion or contraction are currently under investigation.

CONCLUSIONS
our understanding of the processes that fungi evolved to exploit a variety of ecological niches is limited but of fundamental biological importance. among all gene families, the p <dig> superfamily likely plays an invaluable role. the four fungal genomes we studied contained a relatively large number of p <dig> genes. although, it is known that this superfamily exhibits considerable divergence, the level of divergence in ascomycetous fungi appears to be unprecedented. the degree of divergence greatly hampered our ability to apply advanced or traditional phylogenetic models to build the phylogeny for these genes, and required us to develop a novel strategy. to define more robust gene sets, each possibly derived from a single ancestral gene, we compared the standard family classification with results from other clustering methods. by proposing a standardized clan with 70% bootstrap support, we successfully resolved conflicting results from a variety of analyses. combined with applying parsimonious principles, we are able to construct a model which more clearly explains the evolutionary path of p <dig> genes in the four fungi used in our study. we identified  <dig> clans which may represent the core functions of ascomycetous fungi and found that the contraction of genes in these clans was more prominent than gene gains. to compensate in some way, a large expansion of new clans was found in three fungal genomes, the exception being nc, which was perhaps predictable based on the presence of the rip mechanism. intriguingly, this expansion was even more prominent in mg lineage. these results combined with our other findings such as the prominent lack of conservation of intron-exon structure for p <dig> genes and little clustering of homologous genes in the genome, suggest the evolutionary history of ascomycetous fungal p450ome is not simple and may include rapid sequence evolution and genome evolution. it is possible that this rapid and complicated evolutionary history may be an essential feature for fungi to have emerged as highly successful inhabitants of planet earth.

