BACKGROUND
one of the most important challenges in gene prediction is to identify relatively small amounts of coding dna among a large number of dna sequences. computational approaches based on single genomes, including the identification of likely splice sites  <cit> , integrated models  <cit> , and hidden markov models such as genscan  <cit>  have been developed to identify a large number of genes  <cit> . in addition to these approaches, sequence homology – or comparative genomics – has been employed  <cit> . instead of using a single genome to predict gene structures, sequence homology uses a pair or multiple dna sequences of related species  to study the conservation across them  <cit> . recently, a new class of gene-prediction algorithms which exploits the power of comparative genomics have been developed, these include but are not limited to rosetta  <cit> , cem  <cit> , twinscan  <cit> , slam  <cit> , and sgp <dig>  <cit> . relative to the single genome approaches, these programs have substantially reduced the number of false predictions, , but the reduction is not enough simply because of the large amount of non-coding dna.

a high specificity in exon prediction is shown by nekrutenko et al.  <cit>  when the exon location and frame are given. nekrutenko et al.  <cit>  used the ka/ks ratio test to detect the difference between the conservation of codons and non-codons, where ks and ka denote the synonymous and non-synonymous substitutions, respectively. wu and haussler  <cit>  incorporated the log odds scores of codons in a hidden markov model that predicts exon structures. similar as in  <cit> , the log odds ratio in  <cit>  was used to indicate the existence of an exon in the aligned sequence segments without the knowledge of the exon structure. these methods demonstrate that log odds ratios based on codon conservation can be used to indicate the possibility of a coding region existing in the alignment of human and mouse sequences  <cit> . however, since exon structure was assumed unknown, the high accuracy shown in  <cit>  was not attained.

existing methods that predict gene structures  have identified many candidates exons, , e.g. exons predicted by genscan, twinscan etc., which bridge the power of comparative genomic approaches  <cit>  and existing gene structure prediction methods  <cit> . since the putative exons naturally split into three types: those that exactly overlap with coding exons, those that partly overlap with coding exons, and those that totally fall into the non-coding regions, if one can develop a methodology which effectively identifies putative exons of third type – those contain nothing but non-coding dna – one then can filter them out and largely improve the specificity.

the proposed methodology is a scoring method that is based on the idea of homology which takes advantage of the conservation law between two related species. given that two sequences of related species  have been aligned, for each codon or triplet in the non-coding region, a probability model is developed for their dependency on the adjacent codon/triplet in the same sequence, as well as their conservation across different sequences . based on such models, it is possible to calculate, for each putative exon, the likelihood based on codons or triplets from non-coding regions, or equivalently the log odds ratio. intuitively, the larger the log odds ratio, the more likely the putative exon is comprised of codons, and vice versa. therefore, typically the putative exons that contain only non-coding dna should have a relatively smaller log odds ratio.

compared to the existing methods, the probability model is equivalent to the model in  <cit>  except for the codon dependency model. however, an important difference is that it provided an application for the homology approach studied by  <cit> , as it directly implements the log odds ratio methodology to the putative exons identified by other programs .

RESULTS
the proposed method is first compared with genscan, twinscan, and shorthmm in  <cit> . in order to train and test the proposed method, the data sets used in  <cit>  were adopted. then, the effects of the proposed method on twinscan's prediction of the entire refseq exons and refseq genes after filtering out the false predictioins are examined.

data sets
the test data are summarized in table  <dig>  first, the sets of clearly orthologous exons and potential non-exons used in  <cit>  were used to compare the proposed method with other methods. in  <cit> , the locations of refseq exons  <cit>  were first downloaded from assembly hg <dig>  in ucsc's genome database  <cit> . the non-overlapping refseq exons were then extended  <dig> bps on both ends and the human-mouse alignments  <cit>  of the extended exons were extracted from the chained and netted human-mouse alignments in assembly hg <dig>  those refseq exons that have full extended alignments were called the clearly orthologous exons. the potential non-exons in human genome were obtained by eliminating the alignment segment of human mrnas and ests and the  <dig> bps beyond their end points from the chained and netted human-mouse alignments in assembly hg <dig>  where the coordinates of human mrnas and ests were based on the annotations of mrna and ests in assembly hg <dig>  out of the two sets,  <dig>  alignments of clearly orthologous exons and  <dig>  alignments of potential-non exons were used as training data and the rest were used as test data in  <cit> . in this experiment, the coordinates of the clearly orthologous exons and the potential non-exons were first lifted from hg <dig> to the assembly of hg <dig> in ucsc's genome database by the batch coordinate conversion  <cit> . the alignment of clearly orthologous exons and potential non-exons were then extracted from the chained and netted alignments with mouse  <cit>  and dog  <cit>  in assembly hg <dig> in ucsc's genome database  respectively. the clearly orthologous exons that do not have full alignments were discarded. in the remaining clearly orthologous exons and potential non-exons, those used as training sets in  <cit>  were used to train the proposed model and the rest alignments were used to test the model. the coordinates of the sequences can be downloaded from .

the first row lists the type of sequences in the data set. the second row lists the number of the sequences in each type and the corresponding base pairs. the row of genscan lists the number of exons predicted by genscan with both ends matching refseq exons, the number of genes predicted by genscan that exactly match refseq genes. the row of genscan  lists the number of exons predicted by genscan, which have full alignments with mouse, with both ends matching clearly orthologous exons, the number of the predicted exons, which have full alignments with mouse, with both ends within or matching potential non-exons, and the number of genes predicted by genscan, which have full alignments with mouse, having all exons being in potential non-exons. the row of genscan  lists the number of exons predicted by genscan, which have full alignments with dog, with both ends matching clearly orthologous exons and the number of the predicted exons, which have full alignments with dog, with both ends within or matching potential non-exons. the row of twinscan, twinscan , and twinscan  list the number of exons and genes collected the same way as those related to genscan from twinscan's prediction.

next, the putative exons of genscan and twinscan were downloaded from assembly hg <dig>  the alignments of putative exons were also extracted from the chained and netted alignments of human-mouse and human-dog in assembly hg <dig> 

last, to examine the effect of the proposed method on the correctly predicted refseq exons and refseq genes, the locations of the entire  <dig>  non-overlapping human refseq exons were downloaded from ucsc's genome database , which correspond to  <dig>  refseq genes.

the true positive and false positive are defined as follows. a putative exon is called a true positive  when both ends of the putative exon match a clearly orthologous exon. a putative exon is called a false positive  when both ends of the predicted exon are within or match a potential non-exon. a putative gene is called a true positive when the gene exactly matches a refseq gene. a putative gene is called a potential non-gene  when all the exons of the gene are located in potential non-exons.

application of the log-odds score on the existing algorithms
to illustrate the improvement of existing gene prediction methods based on single species, the improvement of genscan's predictions using the log odds ratio is compared with twinscan's predictions, where twinscan is an improvement relative to genscan by incorporating conservation information not only in exon models but also in other parts of the gene structure  to genscan. another comparison is between twinscan's predictions that have high log odds ratios and the predictions from  <cit> , where  <cit>  incorporated the same probability matrices as in the log odds ratio into a model that predicts exon structure. the results are summarized in table  <dig>  which show that the refinement of genscan's predictions gives comparable results to twinscan's and the refinement of twinscan's prediction gives comparable results to  <cit> . these comparisons show that one could gain similar improvements in false positive rate by merely refining the existing results instead of refining the original prediction model. a set of simulated alignments, i.e.  <dig> alignments with length around  <dig>  bps are also generated according to the frequency and the conservation of the nucleotides in the alignment of potential non-exons. to study the threshold, we ran genscan on the simulated data and obtained  <dig> false predictions. by setting the threshold for the log odds ratio of the alignments that are falsely predicted at - <dig> , only  <dig> false predictions remains, corresponding to a 94% improvement in false positive rate.

the number of clearly orthologous exons and potential non-exons in the test set are listed in the row of size. the rows of genscan and twinscan list the numbers of putative exons provided by genscan and twinscan respectively. the thresholds for genscan and twinscan are set so that 99% of the correct predictions of genscan and twinscan that have alignments are kept. the percentages in the parentheses are the true positive and false positive rates relative to the sizes of the test sets. the row of shorthmm is cited from  <cit> .

the effect on all refseq exons and refseq genes that are correctly predicted by twinscan when thresholding on the log odds ratios are listed in table  <dig> and table  <dig>  which show that by losing 2% of correctly predicted refseq exons, thresholding on putative exons could remove 37% false exons from twinscan's predictions and by losing 2% of correctly predicted refseq genes, thresholding on putative exons could remove 26% false genes from twinscan's predictions.

results based on human-mouse conservation. the number of refseq exons and potential non-exons in the test set are listed in the row of size. the row of twinscan lists the number of putative exons provided by twinscan. the threshold for twinscan is set so that 99% of the correct predictions of twinscan that have alignments are kept. the percentages in the parentheses are the true positive and false positive rates relative to the size of the test set.

results based on human-mouse conservation. the number of refseq genes is listed in the row of size. the row of twinscan lists the number of putative genes provided by twinscan. the threshold for twinscan is set so that 98% of the corrected predicted genes of twinscan are kept.

the overall refinements on exon prediction by thresholding of the log odds score of twinscan's exons in clearly orthologous exons and potential non-exons are shown by the roc curve in figure  <dig>  in the roc curve, for a given threshold on the log odds ratio, tp is the fraction of the true exon from twinscan with the log odds score greater than the threshold and fp is the fraction of the false exon from twinscan with the log odds score greater than the threshold. the figures show that the level of refinement is almost identical for human-mouse and human-dog alignments.

whole genome scan
using the human-mouse alignments, the entire  <dig>  exons predicted by twinscan are scored. by setting the threshold at - <dig>  as in table  <dig> and table  <dig>  the estimated number of true exons in twinscan's predictions is  <dig> . the scores can be downloaded from .

discussion
this paper demonstrates the application of the scoring method as an addition to existing gene prediction methods. the scoring method efficiently removes conserved non-coding regions from putative exons. the improvement over genscan and twinscan demonstrates that the method can not only benefit prediction methods based on a single organism, but also benefit prediction methods based on comparative genomics. the notable improvement in twinscan's sensitivity is especially encouraging since twinscan also incorporated homology in its algorithm. furthermore, the application of the proposed scoring method is not limited by the availability of alignments, since more than 98% of the total refseq exons predicted by genscan and twinscan have full alignments with mouse and dog sequences.

the proposed scoring method considers a first order dependency in the codons. because of the large parameter space brought by the dependency model, directly extend the current model to a higher order dependency model would make the estimation of the parameters less accurate.

one limitation of the proposed approach is that it does not predict new exons. specifically, the performance of the method is dependent on the gene prediction method that provides putative exons. the sensitivity of the proposed scoring method is bounded by the sensitivity of the method that provides the putative exon. as shown in the results, in order to filter out false predictions, some sacrifice, i.e. 1% – 2%, in sensitivity is necessary. although the improvement in specificity is not sensitive to the alignment used, it does depend on how the putative exon is obtained . the level of the improvement of an existing method depends on how much of the conservation information used in the proposed scoring method has already been used to generate the putative exons.

for example, post-processing the predictions reported by wu and haussler  <cit>  would not remove any false predictions, since wu and haussler  <cit>  incorporated the same probability matrices as in this paper in their hidden markov model.

CONCLUSIONS
the proposed scoring method illustrates a strategy of data refinement. by examining the difference between the conservation and dependency between the codon and the triplet in the alignment, it conducts a filtering process on gene prediction results. the benefit of this approach is that it can be used as an addition to existing algorithms that predict gene structures to improve prediction quality.

