BACKGROUND
the wide use of dna microarrays to query expression of genes has created the need for updated, consistent and meaningful annotations on the probes included in the microarrays. we refer to gene annotation as a recognizable label or gene id identifying the gene that is targeted by a given probe. gene ids should be stable, widely used and allow reliable associations among genomic databases. several microarray annotation systems are available for investigators, aiming to address specific user demands. for instance, the karma  <cit>  web server provides periodically updated gene annotations of keck arrays  <cit>  and affymetrix® genechips®  <cit> , and can also annotate user-provided lists of accession numbers for pair-wise comparisons, even for different species. however, providing a gene list is not always a straight forward process given the large heterogeneity in the format that vendors provide sequence identifiers for probes. for instance, one platform can include identifiers in a genbank header format such as gb|ay <dig> |aal <dig>  and others may include different types of ids separated by commas or some other character within a single column. in addition, different sequence identifiers in several columns may be provided by vendors and choosing only one of them may not be the best solution. the resourcerer database  <cit>  tackles this problem by pre-computing gene annotations on a more exhaustive list of microarrays and oligosets for a number of species  <cit> . this database is centered on 'tentative consensus'  sequences which are used as gene definitions. tcs group est sequences that can be aligned and clustered in distinct groups, and these are periodically updated as new ests from genbank become available. functional annotations on these tcs generate the gene indices resource available from the tgi website  <cit> . tcs allow for cross species comparisons through the tentative orthologue groups  database. however, gene indices are not stable and cross referencing to other genomic databases is not easy. a different approach has been taken by mattes <cit>  who created a set of perl scripts that use unigene and locuslink as gene identifiers, providing a more universal gene definition that can be cross referenced with other databases. unfortunately, the recent shift of ncbi from locuslink to the entrez gene database format  <cit>  has limited the functionality of these scripts and rendered them obsolete. the dragon  <cit>  database  <cit> , and the david  <cit>  software  <cit>  provide web based services of gene annotation with similar objectives. none of them, however, allows for chromosome or genomic-region specific comparisons of gene coverage.

the objective of this study was to compare gene coverage from currently available whole mouse genome microarrays for any region of the genome. we only used the information about probes provided to researchers by vendors before the purchase of a microarray for the purpose of choosing the platform that best fits their needs. we have developed a platform for microarray annotation that not only provides gene annotations for probes but also genomic positions for tested genes in the mouse genome. coverage comparisons can be obtained for any genomic region of the last available mouse assembly build. the level of coverage of five whole mouse genome microarrays and four oligosets was compared in the present study. microarrays and oligosets will be referenced here by the short name provided in table  <dig>  the results were stored in a relational database that can readily be queried for coverage comparisons based on genome position. figure  <dig> shows a flowchart diagram for the databases and methods used for the annotation system and for querying gene coverage comparisons.

RESULTS
number of genes in the genome
the total number of genes in the genome was defined as the number of entrez genes with a unique genomic position at the ucsc genome browser database  <cit>  . a total of  <dig>  mapped sequences from the known gene, refgene, and mrna tracks were associated with entrez genes. a total of  <dig> genes could not be used because they are located in unordered scaffolds in build  <dig>  of the mouse genome assembly. multiple sequence alignments in the genomes were found for a total of  <dig>  sequences. for example, the m <dig> cdna aligns with chromosomes  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>  x, and un_random  chromosomes. this cdna is identified as the iap gene in the entrez gene database. this is a retrotransposon that can be found in several chromosomes and does not have a unique position. genes like this, and other not so extreme cases, cannot be considered in region-specific coverage comparisons and were therefore discarded. table  <dig> shows the number of genes that could be assigned to specific position in the genome in each of the source files. the file mm.gb_cid_lid in table  <dig> was used to incorporate associations between sequences and unigene ids in the genexref table. although we do not use unigene annotations of probes to identify the targeted genes  this allowed us to associate entrez gene ids with est accession numbers, which are commonly used in microarray genes lists. a total of  <dig>  genes could be found having a unique position in the august  <dig> mouse genome assembly . the distribution of these genes in the genome is shown in figure  <dig> 

microarrays probe annotations
the resourcerer database provides gene annotations for most of the available microarrays and oligosets for mouse and other organisms  <cit> . however, database updates are done at four-month intervals, and in our experience, gene annotations change periodically and many entrez gene ids in the resourcerer annotations are obsolete. microarray vendors also provide gene annotations on their probes, but they vary greatly in the number and quality of the annotations. for instance, abi is the platform with the largest number of probes annotated with a gene id by the vendor . however, these are celera genomics® gene identifications and cannot be directly matched to public domain genes. therefore, we opted for performing our own gene annotation of probes using the most updated information at hand . our genexref table, in the arraygene database, stored cross reference information between  <dig>  sequence identifiers and  <dig>  entrez genes. the different kinds of sequence identifiers included in the database are shown in figure  <dig>  performing in-house annotations allowed us to discard any probe that could be associated with more than one gene. probe annotation files, referred to as genelists, were obtained directly from vendors' websites and they identify the sequences from which oligonucleotide probes where designed. the format and amount of information provided in these lists varied greatly, affymetrix being the most comprehensive in the number of different annotations. the efficiency of the gene annotation process varied between platforms depending on the amount of sequence identifiers provided by vendors and the level of specificity of the information provided . specificity is defined here as the number of associations that can be inferred between a probe and entrez genes from all the probe annotations provided by the vendor. the gene annotations from the arraygene system do not include any probe that could be associated with more than one gene nor genes with an uncertain position in the genome. this approach created a more conservative set of gene annotations than those included in the resourcerer database. in most of the platforms we could not match the number of probes annotated with gene ids by the vendor  given our stringent criteria to select a unique gene identifier . the level of redundancy, i.e. the number of probes hybridizing to the same gene, also varied between platforms , the least redundant being the sigma platform , though it has the least number of probes. however, the newer abi platform has a comparable level of redundancy . the most redundant platforms is the affy array with an average  <dig>  probe sets per gene.

gene coverage from mouse whole genome microarrays and oligonucleotide sets
gene coverage was estimated as the proportion of entrez genes with a unique position in the ucsc genome database that is tested by a given microarray platform. the genome wide coverage varied from different platforms, ranging from  <dig> % to  <dig> % . the lowest coverage was observed, as expected, for the oldest platform, the sigma oligoset, with a total of  <dig>  probes testing  <dig>  genes. agilent and codelink showed very similar coverage levels . sentrix is the ready-to-use mouse microarray with the highest gene coverage, with  <dig> % of the publicly available genes tested. this was followed by the public oligonucleotide set, meebo , that sentrix was based on. the operon aros arrays oligosets showed clear improvement in gene coverage levels as new releases of their oligo data set have become available. the latest release  shows  <dig> % coverage, higher than operon <dig> which only covered  <dig> % and even agilent and affy .

gene coverage by chromosome
the differences between platforms in terms of gene coverage are well conserved across chromosomes . some changes, though, can be observed in specific cases. for instance, the affymetrix platform has a particularly low coverage for mouse chromosome  <dig> and  <dig> , being outperformed even by the older operon <dig> oligoset . for the complete list of gene coverage by chromosome per platform see  of the supplementary material. the database can be easily queried for gene coverage comparison on any region of any chromosome. figure  <dig> shows an example output report for a  <dig>  mb region of mouse chromosome  <dig> 

discussion
the use of microarrays has recently been extended to the study of natural genetic variation affecting the expression of genes at the transcript level. such techniques, originally coined as genetical genomics  <cit> , treats gene expression as a quantitative trait suitable for qtl analysis. using this approach, several groups have been able to detect loci affecting the expression of thousands of genes, both in cis and trans, in yeast  <cit> , mouse  <cit> , and humans  <cit> . furthermore, schadt et al.  <cit>  were able to identify cis-acting qtl for gene expression  causing obesity in mouse. however, the success of this approach depends heavily on the level of gene coverage from the microarray platform being used. previous qtl mapping knowledge can provide candidates regions for cis-eqtl that researchers would like to exhaustively test with a microarray platform. this is of prime importance when microarrays are used to compare congenic lines with background strains and the only difference between individuals is a small chromosomal region  <cit> . a priori knowledge of the level of gene coverage in the congenic region is essential to assess the significance of the results from such studies, creating the need for chromosome and region specific gene coverage comparisons between microarray platforms. consistent gene identifiers are needed that can be mapped to specific locations in the genome. we have created a system to perform in-house gene annotations on sequences from a number of different sources. this system is centered on our arraygene database which maintains an extensive set of cross references between sequence identifiers and entrez gene ids. this system was used to annotate the sequences mapped by the ucsc genome browser database with gene ids and created a gene-centered database called aligndb. these databases, and a set of perl scripts and modules, provide a platform for annotating and maintaining updated gene annotations of microarrays. we have annotated and compared gene coverage from five mouse oligonucleotide microarrays and four oligosets used for microarray spotting. only genes that could be uniquely mapped to a single position in the genome with the ucsc genome browser database were included in the comparison. genome coverage was then estimated as the proportion of such genes that is tested by a given platform. none of the platforms tested provided 100% coverage of the mouse genome, and their level of coverage depended greatly on the date of release. newer sets have better coverage, most likely due to a better state of genome assembly and annotation at the time of design. it should be noted that nonetheless the highest coverage was found in the newest commercial microarray available, sentrix by illumina, it was followed by a non-commercial oligoset that was the basis of the sentrix platform, called meebo . this oligoset was developed by a collaborative effort between researchers at ucsf, stanford, rockefeller, basel, and the stowers institute and it was based on an early draft of the genome, ncbi build  <dig> , which is previous to the genomic assemblies used by most of the arrays tested here .

significant differences were also found in the level of redundancy  and the amount of information that vendors provide for their platforms. the latter is a critical point at the time of data analysis if biological inferences are to be made from expression data. for instance, not all probes in the meebo array are annotated. the authors only provide an accession number for  <dig> % of non-control probes. they do provide a gene symbol for 97% of them, but the user has no means of finding the gene from sequence-specific annotations alone for  <dig> % of the non-control probes. however, the case is different for operon <dig> array where although 99% of probes are annotated with at least one sequence identifier, many of them  could not be associated with any entrez gene, representing  <dig> % of the not annotated probes by arraygene for this platform. this is also the case for  <dig>  probes in the codelink array with no entrez gene association . whether this is a consequence of using obsolete accession numbers that are not included in current development of entrez gene or unigene, or if it reflects big omissions in the curation of entrez gene, this should not affect the comparison in the present study. we expect that by imposing the same restrictions and conditions to all platforms our comparison can reflect real differences in gene coverage level. however we are aware that older platforms may be penalized because of the use of old sequences or ests that are not included in the entrez gene database and refseqs that are obsolete. it also must be noted that by using gene annotations such as gene symbols or unigene identifications provided by vendors, we assume that the annotation properly associates the probe with the source sequence. this not only can add errors to the gene annotation process, but can increase the percentage of unspecific-probe calls since gene symbols sometimes can be associated with more than one gene. however, in some platforms, gene symbols were the only probe annotation available and not using them would restrict the inclusion of those platforms in the present study. therefore, we opted for using gene symbols as probe annotations but not unigene ids since these are automated sequence clusters with no human curation, are not stable and could lead to errors, especially overestimation of unspecific probes if the unigene build used at the time of generation of the gene list is different from that used to build the genexref table of arraygene.

although we believe that our experimental design allowed for a fair and comprehensive comparison of gene coverage between platforms, this work also led us to identifying obstacles that researchers will encounter when trying to answer the questions of how many genes are being tested in a given platform and what is its level of coverage for a given region. the problems that we have encountered to perform optimal gene annotations of probes are associated with the lack of complete gene lists with essential information for the probes. furthermore, accession numbers may become obsolete and gene names can change with time. the only data that is completely uniform and stable is the sequence of the probe. sequences would allow any person to perform an alignment with the genome and identify the position being tested to determine what are the genes been tested. the accession number of the original sequence from which the probe was designed can also provide valuable information for the user. unfortunately, these are not always readily available and for this reason we could not use them in this study. for proprietary reasons vendors very often provide only a consensus or representative sequence identifier which does not necessarily correspond to the original sequences used for probe design. other probe annotations such as refseq accession, gene symbol, gene ontology classification, pathway, etc, can also be very useful for any potential user of the platform. however, from this work we see the need for standardization of a minimal set of information that vendors should provide along with the microarray itself. this should include:  accession number or other appropriate identifier for the original sequence used to design the probe;  database source of the sequence; and  type of probe . the position of the probe within the source sequence or the probe sequence is also invaluable information that, for example, would allow the user to assess possible hybridization artifacts due to polymorphisms between the target rna and probe. additional information such as refseqs id, gene name, gene symbol, and genomic position of the probe can also be very useful, helping the user to avoid performing genome-wide error prone annotations. these higher order annotations can become obsolete with the release of new genomic information, and constant updates would be needed for vendors to remain current. some microarray vendors have already taken this approach and we believe that this will provide them with a marketing advantage, even if the features and quality of the microarrays themselves are comparably similar.

CONCLUSIONS
the results of this study provide researchers with a comparison of the level of gene coverage of different microarrays platforms for the mouse genome, which is particularly useful for genetical genomic studies. the sentrix microarray by illumina and the meebo public oligo set that this array is based on provide the highest gene coverage of the mouse genome. the bioinformatics tools generated here can prove useful for microarray users studying other organisms with a sequenced genome. the annotation tools included in the arraygene software are flexible enough to be easily adapted to use input files from any database that associates genes with sequence ids. we also provide comments on the limitations from current microarray annotations to encourage the scientific community to develop minimum annotation guidelines that designers and vendors of microarrays can follow to better fulfill research needs.

