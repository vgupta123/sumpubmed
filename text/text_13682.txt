BACKGROUND
most performance traits of agricultural relevance are complex traits that are governed by multiple genes. due to the large number of genes underlying a single trait and their complex interactions, direct genetic analysis of such traits has been difficult. in the past decade, genetic mapping has demonstrated great promise for the analysis of complex traits. in particular, wide applications of microsatellite markers in animal genome studies have allowed major progress in understanding of genes underlying major performance traits  <cit> . however, as larger genome datasets have become available recently, it is clear that microsatellites are not sufficiently dense to provide the genome coverage necessary for the dissection of many of the highly complex traits such as disease resistance, feed conversion efficiency, growth, and carcass traits. in addition, large-scale automated genotyping of microsatellites has not been possible. recently, much excitement was generated with the ability to analyze complex traits with new types of polymorphic markers. efforts have shifted to single nucleotide polymorphisms .

snps are the most abundant type of genetic variation. theoretically, snps can have four alleles, but they have been regarded as bi-allelic as most often, only two alleles have been observed at a given position  <cit> . snps are estimated to occur once every  <dig> to  <dig>  bp in humans when any two chromosomes are compared  <cit>  and their frequencies have been estimated to be higher in other organisms  <cit> . this would make it possible to construct genetic maps with extremely high marker densities allowing identification of haplotypes using snps, especially for the species with a draft genome sequence  <cit> . in addition, snps offer several other advantages over other molecular markers. first, snps themselves are the fundamental causes of the genetic variation and their mapping would provide potential for the identification of the "causing" snps as well as the "associated" snps with specific and complex traits  <cit> . second, many technologies have been developed to genotype snps cost-effectively in an automated fashion  <cit> . third, snps are sequence-tagged markers with codominant inheritance, suitable for comparative genome analysis  <cit> ; and finally, snps are highly stable genetic markers compared to tandem repeat markers where the high mutation rates can confound genetic analysis in populations  <cit> .

in most cases, genome-wide snp discovery has relied on the availability of a draft genome sequence where snps can be detected from sequences of the two chromosomes of a diploid organism in the sequence assembly. this approach was initially feasible only for humans and model species. however, as the cost of genome sequencing decreases, now draft genome sequences have become available for several agriculturally important species including bovine, chickens, horses, and soon the swine and tilapia. however, for most aquaculture species, it may take a while for the generation of entire genome draft sequences. facing the equal challenge, alternative approaches must be sought. hayes et al.  was able to identify a large number of snps from est resources in atlantic salmon, and they recently demonstrated mapping of est-derived snps to genetic linkage map  <cit> . their pioneering work with an aquaculture species set a great model for use of ests for the identification of snps, especially in non-model species  <cit> . in addition, bac end sequences  can also serve as sources for the identification of snps, and the combination of est and bes could improve the snp discovery accuracy comparing using only est sequences  <cit> .

catfish is the most important aquaculture species in the united states representing over 60% us aquaculture production. much progress has been made  <cit>  in its genome resource development including a large number of polymorphic markers  <cit> , construction of genetic linkage maps  <cit> , construction and characterization of bac libraries  <cit> , and construction of bac contig-based physical maps  <cit> . particularly, in relation to snp discovery, a number of genome resources have been developed including approximately  <dig>  bac end sequences  <cit> , over  <dig>  ests  <cit>  and over  <dig>  ests are being generated by the joint genome institute of the department of energy. such est sequences will provide an enormous resource for snp identification. however, as most researchers have experienced, identification of snps using ests is not without problems. the most frequent problem is the high rate of sequencing errors that lead to the identification of pseudo-snps, leading to subsequently great efforts and expense. the objective of this project was to develop a strategy for rapid and reliable identification and evaluation of qualities of est-derived snps to reduce the rate of pseudo-snps resulted from sequence errors typically found in single-pass est datasets, especially those deposited in ncbi where sequence trace files may or may not be available.

methods
est clustering and contig assembly
all catfish est sequences were downloaded from ncbi dbest database, including those of blue catfish and channel catfish. cap <dig> was used to assemble the contigs with the parameters set at "minmatch  <dig>  overlap similarity  <dig> ", to have a minimal overlap of  <dig> bases and a minimal similarity of 95%  <cit> . for each contig generated from the cap <dig> assembly, blastx was conducted against the non-redundant nr database to assist identification of any related ests in different contigs. a significant hit was defined as having an e-value below e- <dig> and  <dig> minimum of alignment length for all sequences. following initial gene identification, related ests were further evaluated by manual inspection of the alignments.

snp identification using est resources
the autosnp program was used to detect putative snps from the est sequences  <cit> . the program utilized the cap <dig> output files as input to detect snps based on the base redundancy in the sequence alignments. the autosnp program generated two text files, a contig file including contig id, consensus length, number of sequences in the contig, and the number of snps, a snp file including contig id, snp position, minor allele frequency, snp allele, mutation type, and base alignment in the snp position. the program also generated an html file for each contig, including the alignment information and snp information. with the autosnp program, the parameters for minimum minor allele frequency for snp detection varied with the contig size : 1) a sequence variation is declared as a snp whenever a mismatch is identified within contigs with four or fewer sequences; 2) a sequence variation is declared as a snp when the minor allele sequence existed at least twice within contigs with 5– <dig> sequences; 3) a sequence variation is declared as a snp when the minor allele sequence existed at least three times within contigs with 7– <dig> sequences; 4) similarly a sequence variation is declared as a snp when the minor allele sequence existed at least four times within contigs with 9– <dig> sequences, and 5) when the minor allele sequence existed at least five times within contigs with 13– <dig> sequences and so on.

selection of snps for this project
to evaluate the effect of contig size and minor allele sequence frequency on snp reliability, the snps with different contig sizes and minor allele frequencies were selected for snp validation. after initial submission of a set of snps to illumina, goldengate assay functionality and designability scores were given by illumina. snps with a range of functionality and designability scores were chosen for evaluation in this project. a total of  <dig> snps were selected for this project. hot spots of snp occurrence that may have been caused by low sequence quality were selected to test how sequence quality affects snp genotyping and validation rates. in addition to sequence quality, the effect of intron presence on genotyping and validation rates was tested by including snps with four known genomic sequences.

fish samples used for validation of snps
a panel of  <dig> samples were used for genotyping and validation of snps including  <dig> fish from our interspecific mapping resource family f1- <dig> × channel catfish- <dig> , and  <dig> fish each from three wild channel catfish populations and three domestic channel catfish populations  <cit> .

snp genotyping assay
genomic dna  was used as template for snp genotyping using the illumina's bead array technology according to the manufacturer's protocol for goldengate assay  <cit> . briefly, two allele-specific primers labeled with cy <dig>  or cy <dig>  and a third locus-specific primer  with an address sequence were first hybridized to the template and allele-specific primers were extended to cross the snp site to reach the locus-specific primer. after this allele-specific extension, ligation was conducted between allele-specific primer and the locus-specific primer, creating a pcr template. pcr reaction was conducted using both allele-specific primers and the locus-specific primer. the pcr reaction products were hybridized onto a chip  containing bead types coated with oligo-nucleotides complementary to the locus-specific primer address on the pcr product. each bead type is represented with an average redundancy of 30× on the array to optimize the accuracy of the final genotype signal. following hybridization, the bead array signal was determined using a bead array reader, which could convert images to intensity data. the intensity data for each snp for each sample was normalized and assigned a cluster position , and a quality score for each genotype was generated. final genotyping results were automatically generated for downstream analysis using the beadstudio software .

data analysis
the beadstudio software was used to analyze the snps data. the dye intensities are examined by the software to determine the genotype of each sample for that locus. a locus returning predominantly signal from cy <dig> is aa, cy <dig> is bb and an equal signal of cy <dig> and cy <dig> represents a heterozygous individual. data is returned with the allele call for each locus as well as a gentrain score, a measure that represents the reliability of that genotyping call. gentrain scores was used to measure the reliability of snp detection based on the distribution of genotypic classes, and the calling frequency was used to measure the successful snp calling rate from all samples  <cit> . for this study, gentrain score of  <dig> , call rate of 90%, and minor allele frequency of  <dig>  was used. after removing failed snps, the remaining snps were identified as successful snps in genotyping. successful genotypes were used further for the analysis of minor allele frequencies, and for the calculation of snp validation rate. heterozygosity is defined with the formula h = 1- where pa is the allele frequency of the major allele and pb is the allele frequency of the minor allele  <cit> .

RESULTS
sequence assembly
a total of  <dig>  catfish ests available from genbank including  <dig>  ests from channel catfish and  <dig>  ests from blue catfish were subjected to cluster analysis to identify putative snps. the contig assembly resulted in  <dig>  contigs with an average size of  <dig>  sequences per contig and an average length of  <dig>  bp per contig. the assembly included  <dig>  contigs with  <dig> ests,  <dig> contigs with  <dig> ests, and  <dig>  contigs with  <dig> or more ests .

putative snp discovery
among  <dig>  contigs, snps were detected in  <dig>  contigs while  <dig>  contigs did not include any snps. the vast majority  of the snps were identified from contigs with 2– <dig> sequences, the remaining snps were identified from contigs with  <dig> or more sequences . a total  <dig>  snps were identified from the  <dig>  contigs, an average of  <dig>  snps per  <dig> base pair. the putative snp frequencies varied greatly among contigs of different sizes ranging from  <dig>  to  <dig>  snps per  <dig> base pairs. it was apparent that the putative snp frequency was greater within contigs containing fewer ests, an indication of significant sequence errors in contigs of  <dig> sequences ,  <dig> sequences , and  <dig> sequences . clearly, this is also related to the parameters used in the autosnp software where any sequence variation is defined as a snp in contigs of  <dig> sequences ,  <dig> sequences , and  <dig> sequences  whereas the minor sequence allele must be at least twice with contigs of 5– <dig> sequences, at least  <dig> times with 7– <dig> sequences, etc. this observation, while within expectation, strongly demands validation of snps identified from est sequences, especially with small contigs.

*average snp frequency per  <dig> bp.

validation of snps
to validate the putative snps identified from the ests, genotyping using the illumina bead arrays was conducted with  <dig> fish including  <dig> fish each from three strains of domestic catfish, and  <dig> fish each from three wild populations collected from different watersheds, and  <dig> fish from the inter-specific mapping panel. of the  <dig> successful genotyped snps,  <dig>  were polymorphic among these  <dig> fish . of the  <dig> snps that were polymorphic,  <dig> were polymorphic in black belt domestic population,  <dig> were polymorphic in geneva domestic population;  <dig> were polymorphic in petit farm domestic population;  <dig> were polymorphic in black warrior river population;  <dig> were polymorphic in guntersville reservoir population; and  <dig> were polymorphic in weiss reservoir population . interestingly, the minor allele frequency appeared to be similar in domestic and wild populations.

the illumina's quality scores of snps did not affect snp validation rates
of the total of  <dig> snps tested, snps were selected with quality scores ranging from  <dig>  to  <dig> . as shown in table  <dig>  successful genotypes were obtained from  <dig> snps , while genotyping failed for  <dig> snps. obviously, this failure rate is high, but this did not represent the overall success rate of snp genotyping using snps derived from ests as we designed in the experiment several parameters to test snp quality that obviously lowered the overall success rate. the very obvious question was if the illumina's quality scores  affected the success rate. as indicated in table  <dig>  clearly the quality scores was not associated with the failures of snp genotyping as the average quality scores for failed snps were actually slightly higher than the successful ones.

contig size and minor sequence allele frequency were the major determinants on snp validation rates
the percentage of putative snps that was validated to be real  was found to be directly correlated with contig sizes  and the minor sequence allele frequencies . in general, the smaller the contig size, the lower the snp validation rate was. however, consistently high snp validation rate was obtained with contigs of at least  <dig> sequences with minor sequence being present at least twice. great differences were observed within contigs with  <dig> sequences. while snp polymorphic rate of  <dig> % was achieved with contigs of sequences with two sequences of equal frequency , contigs of  <dig> sequences with 3: <dig> sequence frequency had only  <dig> % snp validation rate, suggesting that the minor sequence allele frequency is crucially important. overall, the average snp validation rate was only  <dig> % for contigs of  <dig> or fewer sequences with minor sequence allele present only once. however, the overall snp validation rate for contigs of  <dig> or more sequences with minor sequence allele present at least twice was  <dig> %, and up to  <dig> % with contigs of  <dig> or more sequences . contig length was found not to be related with snp validation rate. the average contig length of polymorphic snps was  <dig> bp; the average contig length for monomorphic snps was  <dig> bp; and the average contig length for failed snps was  <dig> bp.

*average polymorphic rate in respective categories.

quality of sequences flanking snps is important
flanking sequence quality greatly affected the snp success rate. among the contigs with snps, we identified  <dig> contigs with hot spots of snp occurrence where a region of sequence was highly variable with many "snps" detected. sequence quality examination suggested low quality scores in the sequencing reactions. we intentionally included these snps in this project. of the  <dig> snps tested,  <dig>  failed in genotyping, suggesting that high sequence quality is required in the snp region as they are involved in the genotyping primer binding regions .

the presence of intron was the major cause for snp genotyping failures
the presence of introns greatly reduced the snp genotyping success rate. among the contigs containing snps,  <dig> had genomic dna information that allowed us to test if the involvement of introns has any effect on snp genotyping and validation rates. all four snps failed to provide genotypes. clearly, the bead array technology depends on very short extension and subsequent ligation for success.

of the  <dig> failed snps,  <dig> were likely caused by low sequence quality flanking the snp sites; and  <dig> were caused by the involvement of introns, as designed in the experiment. the causes for failure of the remaining  <dig> snps were then explored by in silico comparative analysis. based on the fact that intron involvement led to the snp genotyping failures, we conducted comparative sequence analysis of the catfish ests with corresponding zebrafish genes as references. the rationale is that if the gene organization is similar in catfish and zebrafish, then sequence similarity comparison would allow the location of snp sites to be aligned to the zebrafish genome. if the snp sites are close to the exon-intron junction, then that could have caused the genotyping failures, assuming conservation of gene structure and organization between catfish and zebrafish. as shown in table  <dig>   <dig> of the  <dig> catfish snp loci had significant blast hits with the zebrafish genome, but of these, only  <dig> allowed sequence alignment in the region containing the involved snps. sequence alignment and gene structure in zebrafish indicated that  <dig>  of the  <dig> snps were located at the exon-intron border, suggesting that the presence of the presumed introns was the major cause for the failures of the snp genotyping.

discussion
ests were proven to be efficient resources for putative snp identification  <cit> . this study provides an assessment of nucleotide diversity in available catfish est resources for putative snp identification. since our goal was to make quality assessment for the est-derived snps, we designed this project to provide some answers as to how the sequence context , contig size, minor sequence allele frequency, sequence quality flanking snps, and the distance between the snp genotyping primers affect the snp validation rates.

as compared with snps identified from genomic sequences, est-derived snps have several advantages. since ests are transcribed sequences, est-derived snps are associated with actual genes allowing use of gene-associated snps for mapping and subsequent use in comparative genome studies  <cit> . this is particularly important for species without a genome sequence such as aquaculture species. in addition to be used as markers for mapping, snps are also considered a rich source of candidate polymorphisms underlying important traits leading to the identification of causative genes or quantitative trait nucleotide   <cit> . however, there are several important factors needed to be considered when using est-derived snps. the major issue for development of snps from est resources is not whether snps can readily be identified, but to what degree these snps would be reliable, because parameters for quality assessment of est-derived snps simply do not exist. this reliability issue was mostly due to sequence errors; assembled contigs with sequence variation could simply be sequence errors. additionally, since snps derived from ests can only be identified from est contigs where the same gene transcripts were sequenced at least twice and sequencing frequency of ests is not random, large scale sequencing is required to identify snp's from rarely expressed genes. moreover, snp rates could be lower in coding regions because of evolutionary restraints of selection pressure.

in this study, over  <dig>  putative snps were identified from  <dig>  catfish ests and  <dig> of these snps were tested using  <dig> catfish samples. we have found that the contig size  and minor sequence allele frequency were the two major factors affecting the validation rates of est-derived snps. small contigs had much lower snp validation rates. obviously, in small contigs with  <dig> or  <dig> sequences, the alternative base is represented only once, and this could be due to sequencing errors. similarly, in contigs with  <dig> sequences when the minor sequence allele is represented only once, it is highly likely that the minor allele is due to sequencing errors. we cannot determine the quality of these snps without the sequence trace files. contigs of  <dig> or more sequences with the minor sequence allele frequency being present at least twice in the contig provided high levels of snp validation rates . this makes good sense because it is highly unlikely that sequencing errors of two independently sequenced ests to occur at the same base location. when at least two ests exhibit an alternative base at the putative snp sites, it is highly likely that such sequence variations are real. all these findings were not unexpected, but for the first time, we provide experimental data to demonstrate the importance of contig size and minor sequence allele frequency. it is noteworthy that even though the larger contigs provided even greater snp validation rates, contigs of four sequences with even sequence allele distribution  provided similarly high validation rates. a minimum of two sequences in the contigs representing the minor allele was required to provide a high snp validation rate  <cit> .

the presence of minor allele sequence in relation to the contig size is important. for instance, if the minor allele sequence was present only once, then the smaller the contig size, the more likely the snp could be real. this is because the contig size of ests is simply a reflection of expression abundance. if a rarely expressed gene was sequenced twice, with the alternative allele being present once each, one can still expect that the allele frequency could be equal or close to be equal when the transcript is sequenced  <dig> times. however, if the transcript was already sequenced  <dig> times with the minor allele sequence being present only once, it is more likely that the minor allele could have been derived from sequencing errors . this relation is obvious when sequence heterozygosity is considered, as shown in figure  <dig>  a contig of two sequences with one each of the alternative alleles would have a sequence heterozygosity of  <dig> , while a contig with  <dig> sequences of  <dig> major allele: <dig> minor allele would have a sequence heterozygosity of only  <dig> .

another advantage of the snp identification from est sequences is its ability to identify the uncommon sequence variants  <cit> . the monomorphic snp rate was highly related to the number of samples tested, since the uncommon sequence variants possess very low minor allele frequency, which required a large number of samples. according to our results, the monomorphic snps accounted for 28% of tested snps. however, these monomorphic snps could be false snps caused by sequencing errors. the snps derived from contigs with four sequences with only one minor allele sequence had the highest monomorphic rate, and the snps derived from more than  <dig> sequences contigs had the lowest monomorphic rate, suggesting that most of the monomorphic snps could have also derived from false snps, not uncommon sequences variants. in addition, much smaller fish samples  were used to construct the est libraries than the number fish samples used here to validate the snps, further supporting the possibility of sequencing errors related to monomorphic snps.

sequence quality flanking the snp sites was found to be important for successful snp genotyping using illumina's bead array technology, but not the flanking sequence context as referred to as the quality score by illumina when above  <dig> . it is probably true that snp genotyping primers would have worked properly for the most part even if the sequence context was somewhat simple or a/t-rich, or g/c-rich. however, sequence errors in the snp region could directly affect the base pairing of the snp genotyping primers. low quality sequences could easily generate false snps, especially at the beginning or at the end of the sequence. therefore, sequence quality surrounding the snp site should be used as one parameter to identify reliable snps. however, many est sequences retrieved from ncbi do not have quality scores or trace files. in such cases, greater caution should be exercised. in particular, hot spot of snp occurrence should be avoided if possible.

selection of snps to allow both allele-specific and locus-specific primers to be located in a single exon is the key to achieving high success rate of snp genotyping. we found that all tested snp sites involving introns failed in genotyping. there seemed to be different reasons for such genotyping failures. the most notable cause is that the genotyping primers are located at exon-intron boundary, leading to non-base pairing of the primers with dna amplified from genomic dna . in addition, it appeared that the extension of the genotyping primer p <dig> and/or p <dig> to reach p <dig>  is quite limited. in cases when even both genotyping primers had a perfect match with the template dna, genotyping failed also simply because an intron was predicted to be present between the genotyping primers . this is somewhat unexpected as one would expect that dna polymerase should be able to extend easily a few hundred bases. in addition to the few tested loci, comparative gene organization analysis suggested that the vast majority of failed snps involved introns immediately flanking the snp sites, further supporting the inability of genotyping when snp is located at the exon-intron boundary or when introns are included in the extension reaction. therefore, bioinformatics analysis using in silico comparative sequence and gene structural analysis is important when dealing with est-derived snps.

CONCLUSIONS
in this project, we demonstrated that ests are powerful resources for snp identification. in spite of the development of highly efficient methods for snp identification from genomic sequences, such as using deep sequencing of reduced representation libraries  <cit> , snp discovery from est resources does not require any additional bench work. these existing resources need to be enabled by bioinformatics analysis. est-derived snps are from transcribed genes, and therefore they are applicable to the identification of quantitative trait nucleotide  as well as to comparative genome analysis  <cit> .

the key to the success of snp genotyping using est-derived snps is the avoidance of introns. the most important factors for high rate of snp validation are the contig size  and the minor sequence allele frequency. presence of minor sequence allele at least twice in the contig is crucial for est-derived snp validation. use of contigs with at least four sequences, when coupled to the presence of minor sequence allele at least twice in a contig should provide a high level of confidence for the validation of est-derived snps. quality assessment measures for the est-derived snps presented here should be applicable to est-derived snps from all species. application of such guidelines, along with the availability of large numbers of ests, should make it effective to identify and apply est-derived snps for genome-scale analysis.

authors' contributions
ws drafted the manuscript, prepared the samples, and performed the putative snp bioinformatics analysis and genotyping data analysis. zs assisted the bioinformatics data analysis and samples preparation. ts conducted all the genotyping experiments. hl, px, sb, and ep assisted in the putative snp bioinformatics data analysis. hk assisted in drafting and finalizing the manuscript. zl served as the p.i. for the overall design and execution of the project, and manuscript preparation. all authors read and approved the final manuscript.

supplementary material
additional file 1
polymorphic snp markers information. the file contains the polymorphic snp markers information including ids of snps, contigs sequences w/snp sequence and position, and blastx hits.

click here for file

 acknowledgements
this project was supported by a grant from usda nri animal genome basic genome reagents and tools program , and partially by an aaes ag initiatives grant.
