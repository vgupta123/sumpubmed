BACKGROUND
a major challenge of current genomics is to decipher the regulation of the expression for all the genes of a genome. transcriptional regulation is mediated by interactions between transcription factors  and specific cis-acting elements. the identification of putative transcription factor binding sites  is far from trivial, given their short size , and the low level of information in the signal . for this reason, specific algorithms have been developed to detect cis-acting elements in non-coding sequences. several pattern discovery algorithms were developed to discover putative regulatory motifs in sets of co-regulated genes from the same genome  <cit> .

the ever-increasing number of sequenced genomes opens the possibility to apply comparative genomics in order to analyze taxonomical conservation and divergence between cis-acting elements. this is particularly true for bacteria, for which the ncbi distributes  <dig> complete genomes and reports  <dig> on-going sequencing projects . the approach called phylogenetic footprinting relies on the hypothesis that, due to selective pressure, regulatory elements tend to evolve at a slower rate than surrounding non-coding sequences. this approach has been applied to detect conserved elements in the regulatory regions of selected mammalian genes, such as globins, rbc genes, tnf-alpha  <cit> , and in completely sequenced bacterial genomes  <cit>  or fungal genomes  <cit> .

a first essential parameter is the choice of the algorithm. kellis and co-workers  <cit>  used clustalw, a multiple global alignment algorithm  <cit> . phyme  <cit> , emnem  <cit>  and orthomeme  <cit>  are based on expectation-maximization, phylocon uses a greedy algorithm  <cit> , phylogibbs combines dialign for local alignment and gibbs sampling for motif discovery  <cit> . another crucial choice is the taxonomical level at which the analysis is led. the initial articles were restricted to the few genomes available at that time, and encompassed various levels of taxonomies:  <dig> or  <dig> genomes of the genus saccharomyces  <cit> ,  <dig> genomes in the class gamma-proteobacteria  <cit> , or  <dig> genomes distributed over the whole bacterial kingdom  <cit> .

with larger numbers of genomes, one can even address the problem in a more general way by comparing motifs discovered at various taxonomical levels, in order to detect not only conservation but also divergence between regulatory elements. this functionality is offered by footprinter  <cit> , which takes as input a set of upstream sequences and a corresponding taxonomic tree, and searches for conserved elements in each branch of the tree.

the choice of optimal background models is also a critical issue, and exerts a strong influence on the relevance of discovered motifs  <cit> . background models are generally defined in an organism-specific way, and the divergence of promoter composition across taxa opens the question about the definition of optimal taxon-wide background models.

despite the wide variety of approaches used to detect phylogenetic footprints, not very much has been done to evaluate their optimal conditions of utilization. in most publications, the quality of the predictions is illustrated on the basis of a few selected transcription factors . to our knowledge, a systematic evaluation has been performed in a very few cases. mccue and co-workers  <cit>  evaluated their approach on a complete collection of known motifs in escherichia coli. evolutionary models, generated by simulating mutations in non-coding sequences, have been used to assess the performances of pairwise  <cit>  or multiple  <cit>  alignment programs. more recently, phylogibbs  <cit>  was evaluated on  <dig> saccharomyces species with  <dig> annotated tfs, and compared to  <dig> other algorithms .

several questions remain open. what is the optimal taxonomical level to detect conserved elements? how to deal with the redundancy between promoters of very close species? how to calibrate taxon-wide background models? which fraction of existing motifs can we hope to detect ? which fraction of the discovered motifs can we trust as reliable ? how can we select score thresholds to tune up the tradeoff between sensitivity and predictive value?

we address all these questions by evaluating the capability of a pattern discovery algorithm  to predict cis-acting elements in bacterial promoters. this algorithm is based on the statistical detection of over-represented spaced motifs  <cit> , and is particularly well suited for the detection of cis-regulatory motifs in bacterial promoters, since most bacterial transcriptions factors belong to the helix-turn-helix  family. hth proteins typically form dimers that bind to spaced motifs  <cit> . in this context, we use the term dyad to denote a pair of trinucleotides separated by a spacing of fixed size but variable content. another advantage of dyad-analysis is that it is based on a significance test, which returns an estimated e-value for each motif, thereby permitting to control the rate of false positives. a third important feature of dyad-analysis is that it supports a variety of background models to estimate the prior probability of each dyad.

we first illustrate the approach with a well-characterized case, the auto-regulation of the transcription factor lexa at a single taxonomical level   <cit> . we then present a systematic evaluation of our method on  <dig> e. coli genes annotated in regulondb  <cit> . discovered motifs are evaluated at two levels: correctness and statistical significance. the correctness is estimated by comparing discovered motifs to those previously annotated. the evaluation of significance is based on a comparison between motifs discovered in promoters of orthologous genes , and those discovered in random selections of promoters . in the last section, we further illustrate the potential interest of our approach by performing a detailed analysis of the auto-regulation of the transcription factor lexa across the whole bacterial taxonomy. several distinct motifs are detected, each being characteristic of a particular taxonomic class. the correctness of the discovered motifs is confirmed by previously published experiments.

RESULTS
discovering the lexa auto-regulation in gamma-proteobacteria
we will illustrate our method by focusing on the gene lexa, which codes for the lexa repressor, involved in the sos response to dna damage . in e. coli, the lexa protein regulates its own production by recognizing specific binding sites in the upstream region of its own gene   <cit> .

we identified  <dig> putative orthologs of lexa in  <dig> bacterial genomes, and collected upstream non-coding sequences up to the next gene, with a maximal length of  <dig> bp. the choice of this limit was based on statistical analyses of the tfbs positions in two phylogenetically distant model organisms: e. coli  <cit>  and b. subtilis  <cit> . table  <dig> shows the most significant dyads detected in the  <dig> promoters of the gamma-proteobacterial orthologs of lexa. among the  <dig>  distinct dyads found in these sequences,  <dig> are significantly over-represented, among which  <dig> show a perfect match with the two annotated lexa binding sites. on the feature map , these dyads appear aggregated in clumps, thereby revealing different fragments of a same motif. indeed, the majority of the significant dyads can be assembled to form a larger motif , whose strict consensus, actgtatatatatacagt, corresponds to the lexa consensus  . the most significant dyad, ctgn10cag, corresponds to the most conserved nucleotides of this consensus  <cit> , and to the interface between the transcription factor and the dna  <cit> . this example illustrates the main keys for interpreting the result of dyad-analysis: a motif is generally detected as a collection of mutually overlapping dyads, which can be assembled to form an extended consensus. the most significant dyads of the collection generally correspond to nucleotides entering in direct contact with the transcription factor.

the table only displays the  <dig> dyads having a sig ≥  <dig> using the taxfreq background model. column content:  dyad;  dyad identifier ;  observed number of occurrences ;  expected frequency ;  expected number of occurrences ;  p-values ,  e-value , significance , rank.

the selected dyads  can be aligned on the most significant one . the "best" consensus of the alignment, obtained by retaining the highest scoring letter at each position, is actgtatatatatacagt.

systematic evaluation of the approach
in order to estimate the general performances of the approach, we performed a systematic analysis of the  <dig> protein-coding genes having annotated tf binding sites in regulondb  <cit> , and for which an identifier was found in the genbank/ncbi genome of the strain e. coli k <dig>  this analysis was led for all the ancestral taxonomical levels of e. coli: escherichia , enterobacteriales , gamma-proteobacteria , proteobacteria , bacteria , by increasing order of phylogenetic distance.

impact of the parametric choices: dyad filtering, background model, operon inference, and taxonomical level
footprint detection involves several crucial parametric choices. a first option, called "dyad filtering", was to consider either the dyads found in all the promoters of the orthologs of the gene of interest, or only those found in the promoter of the reference species . a second option was to use either a gene-specific  or a taxon-wide  background model. a third option was to collect promoter sequences either directly upstream of each gene, or to infer operons and to retrieve the promoter of their leader gene. a fourth option is the choice of the taxonomical level at which orthologs are collected. in total, there are  <dig> possible combinations of these  <dig> parameters. in this section, we present a systematic evaluation of their impact on the accuracy of the predictions.

gene-per-gene comparison
the correctness of discovered motifs was assessed by a gene-per-gene comparison between significant dyads and experimentally characterized binding sites . a dyad is considered as true positive if it perfectly matches at least one of the annotated sites for the considered gene. for a given pattern discovery result, we define the sensitivity  as the fraction of annotated binding sites matched by at least one discovered pattern, and the positive predictive value  as the fraction of discovered patterns matching at least one annotated site. the tradeoff between sensitivity and ppv is measured by the computing the geometric accuracy, accg=sn⋅ppv for example, in the lexa result of the previous section, both annotated sites are matched by at least one dyad, the sensitivity is thus sn = 2/ <dig> = 100%. among the  <dig> discovered dyads,  <dig> match at least one annotated site, the positive predictive power is thus ppv = 122/ <dig> =  <dig> %. the resulting geometric accuracy is accg=100%⋅ <dig> %= <dig> %.

an important fraction of bacterial genes are organized in operons, i.e. polycistronic transcription units. in such cases, transcriptional regulation is mediated at the level of the promoter of the operon leader gene. intra-operon intergenic sequences are generally much shorter than real promoters, and this feature has been exploited to predict operons in completely sequenced genomes  <cit> . we evaluated the impact of operon inference on the quality of the detected footprints: instead of retrieving the sequence directly upstream of each gene, we select the sequence upstream of the leader gene of its predicted operon. on the heat map, operon inference seems to improve the predictions for some genes, and weaken it for other genes, but, based on visual impression, it is hard to evaluate the general effect on the average darkness for all the genes.

quantitative comparison of parameter combinations
in order to quantify the impact of the respective parameters, we averaged the accuracy for all genes in each condition , and applied the wilcoxon paired test  to each parameter . the most significant parameter is the choice of the background model . consistently, table  <dig> shows that taxon-wide background models  give systematically better results than gene-wise models , all other parameters being identical. the second parameter, dyad filtering, also shows a straightforward effect : the accuracy is systematically improved when dyad filtering is applied. by contrast, operon inference gives variable results, depending on the other parameter values: retrieving the promoter from the operon leader gene gives better results in  <dig> cases, but worse results in  <dig> other cases . indeed, the high p-value  indicates that this parameter is poorly significant. the poor impact of operon prediction might be influenced by the fact that we analysed genes with known sites in their promoter region in e. coli k <dig> . however, operon inference might improve the results of the analysis of all genes of a genome for which there would be no prior knowledge on the motifs.

parameters are sorted according to the significance of their impact on the geometric accuracy. the best parameter value of each pair is in the left column. n: number of parametric combinations. sup, inf, equal: number of pairs where the left value gives better, wose or identical results than the right value, respectively. the p-value is estimated with a wilcoxon paired test.

for the choice of the optimal taxonomic level, we performed pairwise comparisons between each possible pair of taxa considered in this study. the class gamma-proteobacteria appears as the optimal taxonomical level, since it systematically appears in the left column, indicating that it gives better results than any other taxon. on the contrary, analyses restricted to the various strains of the same genus  give systematically worse results that the other taxa.

in summary, tables  <dig> and  <dig> clearly show that the best results are obtained when phylogenetic footprints are discovered at the level of gamma-proteobacteria, with taxon-wide background model, and with species-specific dyad filtering, and that operon inference has no obvious impact on the general accuracy.

correctness of the discovered patterns
the correctness of predictions was estimated by comparing discovered motifs with annotated binding sites. figure  <dig> displays the inverse cumulative distribution of sensitivity, ppv and accuracy as a function of the significance threshold. as expected, the ppv increases with the significance score , at the expense of sensitivity . there is also a clear impact of the taxonomical level on the matching statistics: the sensitivity is higher at the level of the class  or above  than at the level of the order  or below . at the closest level , the ppv curve is very erratic, because a very few motifs are detected, due to the small number of species included in the analysis and the low level of divergence between those genomes. the tradeoff between sensitivity and ppv is measured by the geometric accuracy . the optimal geometric accuracy is obtained around the default significance threshold  for all taxonomical levels . the accuracy curves are lower for narrow taxonomical levels  than for wider groups . the maximal geometric accuracy is reached for gamma-proteobacteria  with a sensitivity of  <dig> % and a ppv of  <dig> % at the default threshold. the choice of the threshold should however not be based on the sole criterion of optimal accuracy, but can depend on the purpose of the analysis. for example, selecting the motifs with a very high significance  will result in a drastic loss of sensitivity , but is likely to return the most promising motifs  as candidates for experimental validation.

for  <dig> genes among  <dig>  our approach failed to return any true positive. we identified two reasons for these failures. the first reason is the absence of the motif from the promoter sequences analyzed. this absence is in some cases due to errors in the annotated position of the start codon . in some other cases, a cis-acting element is actually located downstream of the start codon, in the beginning of the coding sequence of the regulated gene. intragenic regulatory are generally involved in transcriptional repression, and a few such cases are reported in regulondb, and thus included in our testing set . it has previously been reported that 71% of the promoters contain at least one repressing site downstream of the transcription start site, whereas there is not a single annotated example of downstream activating site  <cit> . in some cases, binding sites are even found in the coding sequence, downstream of the start codon. as example, yang et al  <cit>  characterized three binding sites for the repressor galr in the coding region of the gene glpt which codes for a transporter of the glycerol-3-p.

another reason for not detecting the correct motifs comes from genes having only a small number of orthologs, when the analysis is restricted to a very narrow taxon . in such cases, the promoters are largely redundant, and functional sites are masked during the purging procedure.

reliability of the significance score
in the previous chapter, we evaluated the accuracy of pattern discovery by comparing discovered motifs with those annotated in the reference database, regulondb. however, the concept of false positive is not trivial, since the reference set cannot be considered as exhaustive, for two reasons:  the annotation effort requires time, so that the regulatory elements stored in the database onlyrepresent a subset of the published ones;  despite de fact that e. coli has been, since several decades, among the most popular model organisms for hundreds geneticists and molecular biologists, it is clear that a good fraction of its regulation has still not been characterized.

in this section, we present a simple strategy for assessing the reliability of the significance without depending on any prior annotation about cis-regulatory elements. this strategy relies on a comparison of scores distributions obtained in a positive and a negative sequence set, respectively.

as discussed elsewhere  <cit>  the significance score returned by oligo-analysis and dyad-analysis is the minus-log of the binomial e-value, and can directly be interpreted in terms of risks of false positive: for a given value sig = s, the expected number of false positives is 10-s. for example, a threshold sig ≥ - <dig> corresponds to an e-value of  <dig>  meaning that, in a random data set, one would expect an average of  <dig> dyads to be selected by chance with such a score . similarly, one would expect an average of  <dig> dyad per random set with a threshold sig ≥  <dig>  and  <dig>  dyad per random set with a threshold sig ≥  <dig>  the e-value provides thus a very intuitive indication of the reliability of the discovered motifs .

a first question is whether this theoretical significance score corresponds to the rate of false positives observed in a random data set. indeed, the theoretical model underlying the estimation of e-value is based on some assumptions about sequences . a second question is whether the significance score makes an efficient distinction between biologically relevant and spurious motifs.

the left panel  shows the expected and observed number of significant patterns per gene  above each significance value . the black curve represents the expected number of false positives per data set, on the basis of the theoretical model. this corresponds to the e-value, which, by definition, decreases exponentially with increasing significance values , and thus appears as a straight line on the graph with a logarithmic ordinate.

the negative control consists in running the footprint detection in sequences where there are supposedly no conserved motifs. for this, we perform random selections in the complete collection of bacterial promoters at the considered taxonomical level. if the background model is correct, the empirical rate of false positives should fit with the theoretical curve. this is clearly the case for the three lowest taxonomical levels , whereas the rate of false positives is higher for larger taxa . this increase in the rate of false positives indicates that the background model is not perfectly appropriate for large taxonomical level, probably due to the fact that these promoters contain mixtures of g+c-rich and g+c-poor genomes .

the positive test consists in measuring dyad significance in sequences supposed to contain conserved motifs, i.e. promoters of orthologous genes . there is a clear effect of the taxonomical level, and the general trend is that the number of significant patterns increases with broader taxonomical levels.

the difference between the negative and positive curves indicates the reliability of the significance score to distinguish relevant  from irrelevant  gene sets. at the narrowest taxonomical level , the two curves are very close from each other, and from the theoretical curve. this weak significance reflects the insufficient signal-to-noise ratio, due to the small number of available sequences , and to the fact that they are too similar with each other . the number of detected patterns already increases at the level of the order , but the highest sensitivity is clearly obtained at the level of the class  and above . the best signal-to-noise ratio is obtained at the level of the class , where the random curve is very close to the theoretical expectation, whereas the number of patterns found in orthologous groups is almost as high as at the highest taxonomical levels.

in summary, our analysis shows that the e-value returned by dyad-analysis gives a reliable estimate of the expected number of false positives, and that it clearly distinguishes phylogenetic footprints from spurious motifs.

deciphering the evolution of lexa auto-regulation
the analyses above show that cis-acting elements can be detected by their conservation across the promoters of a set of related species. a complementary question is whether a separate analysis of distant taxonomic groups would allow us to detect divergences between regulatory motifs. to address this question, we focused our attention on the lexa regulator, whose peptidic sequence is highly conserved across bacteria, and for which distinct dna-binding motifs have been characterized for various bacterial taxa , suggesting a co-evolution of the transcription factor with its dna binding motif  <cit> . the question addressed in this section is whether footprint discovery would allow us to rediscover the evolution of lexa auto-regulation.

comparison of significant dyads with the annotated lexa binding motifs for different taxa
as discussed above, the most significant dyads detected in gamma-proteobacterial promoters  correspond to the lexa binding element characterized in several species of this class . an informative characteristic about discovered motifs is their gene coverage, i.e. fraction of genes whose upstream sequence contains at least one occurrence of the motif. figure  <dig> shows that the gamma-proteobacterial motif is found in  <dig> among the  <dig> promoters. interestingly, the  <dig> promoters where the motif is absent belong to the order xanthomonadales . this suggests that lexa auto-regulation might have diverged in this subgroup. consistently, when pattern discovery is restricted to xanthomonadales sequences, another motif, ttagta is detected in  <dig> of the  <dig> promoters. this hexamer is found in two occurrences per sequence, forming an inverted repeat . the assembly of the xanthomonadales-specific dyads  corresponds to the experimentally validated motif  <cit> .

for each analysis at a given taxonomical level , the annotated motif  is compared with the predicted motif  with matching letters in bold. capital letters in the predicted motif correspond to the most significant dyad . the gene coverage is the fraction of genes whose upstream sequence contains at least one occurrence of the most significant dyad. the last columns indicate the number of tested dyads and the number of dyads detected as significant , respectively.

when the analysis is restricted to a very narrow taxonomical level, the pattern discovery approach fails to detect motifs, because the species are too close from each other to have allowed divergence between promoter sequences . in all those cases, the sensitivity of the method is expected to increase with the number of orthologs, so that the missing motifs will hopefully be detected in the future, when additional genomes will be available for these taxonomic groups.

in addition to the  <dig> taxa where discovered motifs match the annotated one, a highly significant motif is detected in beta-proteobacteria . this motif is the same as for gamma-proteobacteria, and corresponds to a lexa binding site suggested for beta-proteobacteria after in silico analysis in ralstonia solanacearum  <cit> . it is detected in  <dig> of the  <dig> promoters analyzed , but, as discussed above for xanthomonadales, the five remaining genes have one or two occurrences in the beginning of their coding sequences.

in summary, the phylogenetic footprint detection reveals all the taxon-specific lexa binding motifs that had previously been characterized experimentally .

divergence of the lexa binding motif in gram-positive bacteria
the relationships between the motifs discovered at different levels of the taxonomic tree can give us insight into evolutionary events, such as conservation, appearance, loss and divergence of regulatory signals. this is well illustrated by the comparison of motifs discovered in gram-positive bacteria , which are comprised of two phyla: firmicutes and actinobacteria. the dyads selected in these two phyla show a partial overlap , but also some interesting differences. the most significant dyads discovered in firmicutes are aacn4gtt and aacn5ttc which correspond to the core of the cheo box gaacn4gttc  <cit>  and to the lexa consensus  proposed for gram-positive bacteria altogether  <cit> . in firmicutes promoters, the most significant dyads are spaced motifs, which can be combined to form a palindromic consensus tacgaacatatgttcgta. this motif is found in  <dig> to  <dig> occurrences per promoter, at more or less conserved positions . in contrast, the most significant dyads discovered in actinobacteria are hexanucleotides that can be aligned to form the heptanucleotide tcgaaca . a comparison of the sequence logos  shows that this heptanucleotide matches one half of the spaced palindrome found in all the gram-positive bacteria, but that the half-motif is more specific for actinobacteria than firmicutes.

consistently, the feature map obtained by merging all the gram-positive bacteria  shows that in firmicutes, instances of the heptanucleotide generally overlap with the larger cheo boxes. the situation however differs in actinobacteria: although some promoters contain one occurrence of the cheo box, many additional instances of the short motifs are found more distally, without being part of a large motif . this feature is particularly marked in corynebacterium , where the large motif has apparently been lost, and is somehow "compensated" by a more occurrences of the short motif. this observation raises the intriguing hypothesis that lexa binding specificity is on its way to diverge between firmicutes and actinobacteria. the reverse complementary symmetry of a binding motif generally reflects the binding of the transcription factor as a homodimer. this is the case for the gamma-proteobacterial lexa protein. the symmetry of the large motif has previously been shown in b. subtilis  <cit>  and suggests that, in firmicutes as well, lexa may act as homodimer, and this hypothesis is compatible with the structural model  <cit> . in actinobacteria, the imperfect palindromic nature of the sos box has been previously observed in reca promoter of streptomyces lividans  <cit> . the presence of half-instances of the motif in actinobacteria opens the question of the structure of the protein/dna interface. is it possible for the actinobacterial lexa to bind dna as a monomer? does it form heterodimers with another protein? a structural characterization of the lexa/dna complex would be required elucidate this mechanism.

beyond the particular case of lexa auto-regulation, this example shows that the comparative analysis of taxon-specific footprints is a powerful method to trace the evolution of dna recognition by transcription factors.

comparison between dyad-analysis and other pattern discovery algorithms
several previous studies have addressed similar issues as we do in this paper. in particular, the detection of phylogenetic footprints in bacterial promoters has been treated by several other groups, using various implementations of a gibbs sampler  <cit> .

pattern discovery algorithms can be broadly subdivided into two main categories:  enumerative approaches based on the detection of over-represented words   <cit> ;  matrix-based approaches, based on various optimization strategies: expectation-maximization  <cit> , greedy algorithm  <cit> , gibbs sampling  <cit> .

reliability of matrix scores
the comparison of score distributions between orthologs and random gene selections presented above can easily be applied to other programs, and used as a criterion to estimate the reliability of the motifs discovered under various conditions.

for obvious reasons, a comparative assessment should in principle not be led by the team who developed one of the programs: a fair comparison should either be done by a naïve user who did not contribute to any of the tools assessed  <cit> , or by letting developers run their own tool on some benchmark data set  <cit> . however, as a condition for publishing this paper, the referees and editors asked us to compare our own program with other pattern discovery programs. we performed this comparison as honestly as possible, and we tried to select, for each program, the most appropriate parameters. however, it is clear that, even with the best will, there is one bias that cannot be avoided: each developer better knows how to use his/her own tools. it is thus likely that the other programs would return better results in the hands of their respective developers than in ours.

one further remark: as shown in table  <dig>  dyad filtering has a massive effect on the accuracy of footprint detection. however, the other matrix-based pattern discovery tools do not support the concept of filtering . thus, for the sake of fairness, we decided to avoid dyad filtering for this comparison, so that all programs are fed with exactly the same sequences, without any prior information on the reference organism. it should be stressed that these conditions are far from our optimum, since they correspond to an accuracy of  <dig> %, whereas our best parametric conditions  reach an accuracy of  <dig> % . as shown below, even under these sub-optimal conditions, dyad-analysis outperforms the other programs.

the results of our comparative assessment are summarized on figure  <dig>  in the form of "roc-like" curves. each curve shows the performances of a given program and a given scoring scheme. for each score value, the curve indicates the fraction of sequence sets with at least one significant motif in promoters of random groups of genes  and orthologous genes , respectively. for example, figure 10a indicates that, with a significance threshold of  <dig> , motifs are found in 10% of the random selections versus 65% of the orthologous groups. there is thus a "cost" of 10% of false positives for obtaining 65% of sensitivity. with score of  <dig> , the rate of false positives drops to  <dig> %, but the sensitivity is reduced to 40%.

a classical statistics for estimating the general performances is to compute the area under the curve . a perfect program would give an auc of  <dig>  , whereas a random predictor would follow the diagonal from bottom left to top right, since it would return as many patterns in random selections as in orthologous groups . the sig score of dyad-analysis  gives an auc of  <dig> . by comparison, the word-based pattern discovery program oligo-analysis  <cit>  gives an auc of  <dig>  . since these two programs use exactly the same binomial statistics for scoring motif significance, the difference comes from the motif structure  thereby confirming the importance of using spaced motifs to decipher bacterial regulation, as discussed in the introduction.

we also tested four popular matrix-based pattern discovery programs . each of these programs returns several scores per matrix, shown as separate curves on the same plot. in addition to the matrix scores returned by the programs, we computed the total information content  of each matrix, following to hertz and stormo's definition  <cit> , as well as an information per column, in order to discard the effects of matrix width. interestingly, the total information content  performs generally better than the original statistics of those programs. this is particularly obvious for alignace , for which the tic gives an auc of  <dig> , whereas the map per site only gives  <dig> , and the map per matrix gives an auc smaller than  <dig> . surprisingly, the original gibbs motif sampler  <cit>  shows the opposite trends : the map  gives better results than the tic . an interesting property of meme   <cit>  is that it returns a negative answer  for 50% of the random selections, thanks to the threshold on e-value <  <dig>  however, with this threshold, a negative answer is also returned for 30% of the groups of orthologs. the tic obtained with meme matrices gives a total auc of  <dig> , but, if one only considers the subset of sequences giving at least one matrix, the curve shows a pretty good shape.

it should be noted that the auc, despite its popularity as measure of global performances, can be very misleading since it is integrated over the whole curve, whereas in realistic conditions, a user would not even consider the motifs returned in the right part of the curve, which are expected to return more than 50% of false positives. beyond the auc, a more relevant criterion for estimating the relevance of a program is the sensitivity obtained for a given rate of false positives . figure  <dig> shows that, with a 10% rate of false discovery  dyad-analysis discovers motifs in 65% or the orthologous groups, which outperforms meme tic , alignace tic , oligo-analysis significance , motifsampler information content , and gibbs map per site . the program ranking is similar with a rate of false positive of 5%.

in summary, in our hands at least, dyad-analysis outperforms the other pattern discovery programs in its capability to discovery higher scoring motifs in promoters of orthologous genes than in randomly selected promoters. we would however like to make clear that we consider this analysis as biased by our better experience for using our own program. since all the data used for our analyses are available on the supplementary web site, anyone interested is able to perform his/her own tests in order to estimate the most appropriate program.

comparison with previous studies
we further discuss hereafter our methodological choices and compare them with previous studies.

prior versus posterior probability of motif occurrences
many previous studies about footprint discovery in bacterial promoters were based on various implementations of the gibbs sampling  <cit> . this algorithm is based on the optimization of "relative entropy" score  <cit> . this score is however not efficient to discriminate between informative and non-informative motifs. for this reason, motifs are generally filtered a posteriori on the basis of the map  score  <cit> .

an advantage of the enumerative approach used here is that the probability of each motif is estimated a priori rather than a posteriori, on the basis of its occurrences in a reference data set . our analysis of the score distributions  clearly shows that this prior estimation provides an efficient discrimination between promoters of orthologs and random selections. in addition, our comparison between programs suggests that the map is generally not the best score, since the total information content  shows better performances on the roc curves .

choice of the motif width
an important advantage of dyad-analysis is that it does not require prior assumptions about motif width. indeed, different widths are automatically detected since the program scans all spacing values between user-specified limits . by contrast, matrix-based approaches generally require for the user to specify a matrix width. an exception is the programs meme, which permits to specify a range of matrix widths, and returns the motifs with the lowest e-value.

expected number of sites
another important parameter required by most matrix-based pattern discovery programs is an estimate of the expected number of sites . this parameter is very hard to estimate, since it depends on the transcription factor itself: some factors have  <dig> or  <dig> binding sites per promoter, whereas others have a single binding site. with enumerative algorithms like oligo-analysis and dyad-analysis, there is no need to provide prior estimates of the number of transcription-factor binding sites. rather, the number of sites can be deduced a posteriori, by inspecting the feature maps of discovered words/dyads.

negative control
an essential quality of a pattern discovery program is its capability to return a negative answer when, for some reason, the input sequences do not share any regulatory motif. in many articles, this aspect is simply neglected, and the evaluation is restricted to an analysis of promoters of co-regulated genes. in other cases, the negative control is performed, but it is based on a set of artificial sequences is generated by shuffling the original sequences  <cit> . such artificial sequences already provide some level of control, but a more stringent test is to submit a random selection of real bacterial promoters  <cit> . each of these promoters is likely to contain some binding sites for some transcription factors, but in principle no specific motif should be over-represented in random selections. beyond its stringency, this negative control is also more realistic, because it mimics the situation where a biologists tries to detect motifs in bad clusters of genes. we thus chose to base our negative control on random selections of bacterial promoters.

treatment of redundancy
the first implementation of the gibbs sampler  <cit>  was accompanied by a program called purge, designed to discard redundant sequences. indeed, the inclusion of multiple closely related sequences provokes a systematic repetition of all their fragments, which prevent the sampler from identifying the correct motifs. the effect of redundant sequences is very strong for footprint detection, because some small taxonomic groups are over-represented in genome databases. for example, the current ncbi collection  contains  <dig> species for the family of enterobacteriaceae, among which  <dig> strains of escherichia coli. an approach to circumvent this problem has been to manually select a set of non-redundant genomes  <cit> . we address the problem in a more automated way, by applying a gene-wise sequence purging: for each set of orthologs, redundant sequences are masked before the pattern discovery step, but in a second time pattern matching is applied on the full set of non-purged sequences, in order to visualize motif conservation across all available species.

site positions
previous analysis of the upstream distribution of cis-regulatory elements in conserved groups of genes shows that positions of tfbs are conserved across species  <cit> . consistently, the feature maps show a high conservation of the positions of putative lexa binding sites in cyanobacteria , firmicutes , beta-proteobacteria , gamma-proteobacteria  and xanthomonadales , respectively. by contrast, position of the predicted sites are less conserved for two other taxonomical classes . this might either reflect a more heterogeneous collection of available genomes in this taxon, or that a more rapid turn-over of tf binding sites. a more detailed gene-per-gene study of motif locations within this group would be required to clarify this question.

CONCLUSIONS
as pointed out by mccue and co-workers, many parameters can influence the results of phylogenetic footprinting, such as the number of sequences and the selected organisms  <cit> . we extended this question by assessing the impact of various parameters on the significance and correctness of discovered motifs in  <dig> genes. we tested all possible combinations between the following parameters:  <dig> background models,  <dig> taxonomical levels, operon inference, organism-specific dyad filtering, significance threshold. this quantitative evaluation suggests that the global optimum is generally found at intermediate taxonomical levels, and the class  seems to ensure the best tradeoff between sensitivity and specificity. however, beyond this general trend, the optimal level varies from gene to gene. for the detection of motifs in genes for which no regulation is known, we thus recommend to apply pattern discovery at all the taxonomical levels, and to inspect the feature maps in order to analyze the distribution of the predicted sites across the promoters of each taxon.

furthermore, our evaluation shows that phylogenetic footprint detection is significantly improved by choosing a taxon-wide background model and by applying organism-specific dyad filtering.

in the second part of the article, we showed how a cross-taxonomical exploration of phylogenetic footprints can reveal the conservation and divergence of cis-regulation. this strategy was illustrated with the example of lexa auto-regulation, for which our predictions are remarkably consistent with the binding sites characterized in different taxonomical groups. our method also detects a significant motif in beta-proteobacteria, which has not yet been experimentally characterized. the predicted beta-proteobacterial motif is similar to the one known in gamma-proteobacteria, suggesting that cis-regulation has been conserved across these two groups. in addition, we highlight a partial divergence between the motifs detected in two subclasses of gram-positive bacteria , suggesting a progressive evolution of lexa binding specificity. these features illustrate the predictive power of the method, and its capability to track the evolutionary divergence of cis-regulatory motifs.

in summary, this assessment can be considered as a calibration, which should help biologists to estimate the relevance of each predicted motif, and guide their experimental work by producing testable hypothesis about the regulation of genes with no annotated function.

in the future, this approach opens the way to identify groups of co-regulated genes , by regrouping genes with similar motifs, in order to address the challenging domain of the evolution of transcriptional regulatory networks.

