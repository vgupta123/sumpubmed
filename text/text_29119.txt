BACKGROUND
dna barcoding technology uses a short piece of dna sequence to identify species. in animals, a region of the coi gene has been found to possess properties like high pcr amplification efficiency, high dna sequencing success rate, and high discrimination power. consequently, the gene has been selected as the universal dna barcode. however, in plants, no dna sequences have been found to be comparable to the coi in animals. several dna regions such as rbcl, matk, its <dig>  its, and psba-trnh have been proposed as potential candidates for plant dna barcodes  <cit> . the psba-trnh intergenic spacer  region has been successfully used to resolve problems in species identification in a number of studies  <cit> . as one of the supplemental barcodes, ptigs has several favorable characteristics. first, it can be easily amplified across a broad range of land plants. based on the sequences of the conserved coding regions of psba and trnh, universal primers can be easily designed to amplify the ptigs region. secondly, the insertions/deletions of the ptigs region are common and lead to various length among different plant groups. as a result, ptigs has the highest percentage of nucleotide difference and micro-inversions and it has become the most variable plastid region in some group of plants  <cit> .

various methods have been tested on simulated or specific datasets. using available gymnosperm nrits <dig> and plastid matk sequences as a test dataset, little et al. have estimated the precision and accuracy of hierarchical clustering methods , similarity methods , combined clustering/similarity methods , diagnostic methods  for species identification  <cit> . it was found that no method was able to accurately identify query sequences for species at a frequency that would be considered useful for routine specimen identification. the success rate for unambiguously correct identification ranges from 42% to 71%. more recently, phylogenetic and statistical classification methods such as neighbor-joining , phyml, k-nearest neighbor , classification and regression trees , random forest, and kernel have been compared based on their performance on dna barcode analyses using simulated and specific datasets  <cit> . the authors found that no method is superior to others, although the simplest method of all, “one nearest neighbor” was found to be the most reliable. because of wide-spread phenomena of monophyly and paraphyly in plant kingdom, there are no defined borders for many plant species. consequently, classification based methods such as support vector machine  have not been considered more effective than the nearest neighbor method. in addition, several studies have applied the alignment free methods on dna barcode analyses using coi <cit>  or its <dig>  <cit>  as the barcode markers, even though it is arguable whether these studies are necessary as coi has little indels and less difficulty in sequence alignment. it has not been determined whether or not they can be extended to other markers.

ptigs sequence has unique characteristics that make it an important supplemental plant dna barcode. however, its usage has been limited by the lack of computational tools that allow the easy retrieval and annotation of the ptigs sequences, and the subsequent species identification due to the difficulty in aligning ptigs sequences. in this study, we have developed a web server system that tackles these problems, which, hopefully, will facilitate ptigs-based dna barcoding analyses.

implementation
the methods and their combinations were implemented using c and perl programming languages. perl catalyst framework was then used to develop the pitgs-idit web server. all source codes are available upon request. the performance of the various methods was measured on a machine with 24g ram,  <dig> processors, running red hat  <dig> .2- <dig> operating system.

RESULTS
algorithms
the current web server has three main functions:  retrieval of ptigs sequences,  annotation of novel ptigs sequences, and  species identification based on ptigs sequences. to allow the easy retrieval of ptigs sequences, we downloaded all sequences from the ptigs loci in genbank , available from additional file  <dig>  each sequence was divided into the 5’ psba region, the core ptigs region, and the 3’ trnh region based on genbank annotations. different sequences were grouped at various taxonomy levels of class, order and family, genus, and species, available from additional file  <dig>  for each species, the sequences of all the ptigs core regions were assembled using phrap program  to generate the consensus sequence, which is considered to be the reference sequence for each species. all processed sequences are stored in two dimensions, the sequence regions  and the taxonomy levels . the users can easily retrieve any sequence in the two dimensions. for more details, please see the corresponding application page.

we found manual annotation of ptigs regions, that is, defining the 5’, core, and 3’ regions can be extremely tedious. to automate this process, we implemented a hidden markov model -based annotation engine. to use this engine, the users need to prepare two multiple alignments of sequences for the 5’ and 3’ regions respectively. hmm models are built using hmmbuild   <cit> . the models are then used to scan the sequences to be annotated using hmmsearch . last, a parser written in perl identifies the regions in the sequences that were found to match the 5’ and 3’ hmm models, completing the annotation process.

as described above, one particular characteristic of the ptigs regions is the presence of significant portions of indels  <cit> , causing difficulties in multiple sequence alignment. these indels actually contain the information that can be used to distinguish the two sequences, which has been ignored by alignment-based methods such as blast and p distance method   <cit> . consequently, we are set to find methods that include the indels in the comparison of two ptigs sequences. to evaluate the performance of these methods, we first constructed a dataset from species that has at least two ptigs sequence. this produced a dataset containing  <dig> ptigs core region sequences .

the number in each cell represents the number of taxonomy units at the corresponding taxonomy levels for the particular group used in our analyses. essentially they correspond to the taxonomy units whose species having at least two sequences. the sequences can be downloaded from the web server.

after reviewing various methods, the one that calculates the edit  distance  <cit>  was selected. this method uses dynamic programming techniques to align two sequences  <cit> , then calculate the number of steps  needed to transform one sequence into the other. the allowed transformation steps include transition , insertion and deletion. an alternative solution to include unaligned regions in sequence comparison is to use the alignment-free methods as described before  <cit> . in this study, we implemented such a method by first converting input sequences into vectors of frequencies of kmers . then the pearson correlation coefficient was calculated for each pair of vectors as their distance. to find the best method for ptigs-based species determination, the e and kmer-based methods were compared with the other commonly used methods for species discrimination, namely, blast and p distance method. because the calculation of the p or edit distances between the query and all sequences in the reference databases is prohibitively time-consuming, we combined these base methods and compared their success rate and performance.

we first tested the success rate for discriminating ptigs sequences under various kmer sizes to determine the optimal size for the kmer based method. as shown in table  <dig>  vectors of frequencies of di-nucleotide were found to have sufficient discrimination power  with a significant less processing time  comparing to those of other kmer sizes. consequently, we use kmer size of  <dig> in the following study and named the method di-nucleotide frequency profile .

the test data is the same as those shown in table  <dig> 

the taxon coverage of the test dataset is shown in table  <dig>  each species in the dataset contains at least two individual sequences. each of the sequences was used as the query to search against the database with  or without the query sequence itself  using the corresponding methods. previous studies have showed that the prerequisite for meaningful dna barcoding analysis is that the reference database must contain the query sequences or sequences from the same species as the query sequence. when using the database that is “include self”, the query sequence will always pick up itself from the reference database. the question is whether or not it picks up non-self sequences at the same time. if it only picks up its own sequence, it is considered a success. if it picks up non-self sequence at the same time, it is considered a failure. for the database that is “not include self”, it contains other sequences from the same species but not the query sequence itself. when using this database, if the nearest neighbors only contain sequences from the same species, the identification is considered a success, otherwise it is considered a failure.

ratio indicates the number of correctly identified/total number of tests. the performance shows the average time in second taken to complete a query. the base methods are b: blast; p: p distance; e: edit distance; d: dnfp. “included” means that the query sequences are included in the reference database, while “excluded” means that the query sequences are not included in the database when performing the analyses.

to identify the best methods for discriminating ptigs sequences, we construct eight different methods based on the four base methods blast , p distance method , edit distance method  and dnfp method , which are b, b+p, b+e, d, d+p, d+e, b+p+e and d+p+e respectively. each query sequence was compared to each sequence  in the reference database to obtain the corresponding blast distance , p distance, edit distance or dnfp distance  that has the smallest distance  was considered the hit. “b+p” means that if the query sequences cannot be successfully identified using b method, it will be subjected to p method for further identification. the meanings for other methods are similar.

the success rate and performance for each method combination against two different databases are shown in table  <dig>  we found that the discrimination success rate follows e > dnfp > p > b. in terms of speed, it follows that dnfp > b > p > e, from the fastest to the slowest. the dnfp method is the fastest and has an identification success rate close to the highest rate , which is achieved when the e method was used. the best method exceeds the poorest method  by a margin of ~20% in terms of success rate. the slowest method on the other hand, which involves e method, is about  <dig> times slower than the fastest method .

to demonstrate the usefulness of this web server and its identification methods, we use a query sequence with accession number ef <dig>  as an example. using blast search method, three sequences  were found to have the smallest e-value, they are gq <dig> , ef <dig>  and ef <dig> . the blast results are shown in table  <dig>  the query sequence was then predicted to belong to species p. juniperinum  or p. commune . this result is considered unsuccessful. however, using blast+p distance method, the distances between the query sequence and the three sequences  with the best e-value scores are shown in table  <dig>  as shown, the query sequence was successfully identified to belong to p. juniperinum. the query sequence, the three best match sequences, the multiple alignments are shown in supplementary figure  <dig> and  <dig> respectively. a quick tutorial is also available on the “identify” web site using this sequence as an example.

*qs: query start; *qe: query end; *ts: target start; *te: target end.

application pages
review the reference barcode sequence
this page provides a summary for the ptigs region of each species. usually, there are many individual sequences associated with a single species, and the consensus sequence is an ideal way to represent the “average” dna barcode sequence of a species. the input is the taxid from ncbi for a species. while there are many taxonomy systems available, we use ncbi’s taxonomy system in our web server because the primary species identifier in ncbi’s system  is directly linked to dna sequences. we decided not to duplicate this taxonomy system and the user will have to go to ncbi’s taxonomy page  to find the taxid for the taxonomy groups of interest. after the query has been submitted, this module will return all sequences associated with this taxid as well as the reference sequence for the species under query. the taxid and sequence accession numbers are linked to their records in genbank which allows the users to obtain more detailed information about the species and the sequences.

retrieve different segments of the ptigs locus
we defined the ptigs locus as composed of the 5’ psba region, the ptigs core region, and the 3’ trnh region. the sequences of the ptigs core region should be the region used for dna barcoding. this page allows the user to retrieve a particular region as well as the entire locus region that include the 5’, core and 3’ regions. while the core region is needed for species determination analysis, the 5’ and 3’ regions can be used to annotate newly obtained ptigs sequences . the input is similar to the view page, which contains a single taxid. after specifying the regions of interest, this module will return all sequences associated with the query taxid for the corresponding region.

annotate novel sequences based on hidden markov model 
as described above, the ptigs locus consists of three regions: the 5’ psba, the ptigs core, and the 3’ trnh regions. this module allows the determination of these three regions for unannotated ptigs locus sequences using hmm. three input files are needed for this module. the first file should contain multiple alignments of sequences from the psba region. the second file should contain multiple alignments of sequences of the trnh region. the third file contains the sequences to be annotated. the user will have to provide the 5’ and 3' sequences that are needed to build the model. it is recommended that the length of the aligned sequence fragments should be between 20- <dig> bp and the total number of sequence fragments should be > <dig>  in order to build the hmm. the backend annotation engine will return the sequences with the three regions determined.

species identification based on a ptigs sequence
this page provides the interface for our species identification engine which consists of the eight methods described above. only one sequence is accepted at this time for species determination. after selecting the method of interest, the sequence will be compared to the backend reference database using the specified method. we use “nearest neighbor” as the criterion for species inference because this has been found to be the most reliable. the nearest neighbor is the sequence in the database that has or have the smallest blast distance, p distance, edit distance or dnfp distance to the query. consequently, the nearest neighbor to the query sequence from the backend will be identified and considered as the most likely identity of the input sequence. the taxid or taxids, if there are multiple hits, will be returned along with the time taken to complete the query.

check the performance for  <dig> different identification methods for given operational taxonomy units
as described in the algorithm section, eight different methods have been developed. these methods were first applied to a comprehensive and heterogeneous dataset . subsequently, they were applied to datasets containing sequences from various taxonomy groups including kingdom, phylum, class, order, and family. the rationale behind this is that it would be very valuable for the biologists who work on a particular group of plants to know if the ptigs core region is a good dna barcoding marker for the taxonomy group they are studying. one can simply select the group of interest from the pull down list and review the success ratio and performance of the eight different methods for the group of interest. however, we realize that particular taxonomy group of interest might not be found in the list. this is usually because no sequences are available for this group when the data were compiled. it should be noted that the analyses were carried out only on species that has at least two sequences because for species having only one sequence, the “not include self” analysis cannot be performed, and consequently, the comparison between the “include self” and “not include self” analyses is not applicable.

discussion
so far, two core barcodes and two supplemental barcodes have been proposed for dna barcoding of plant species. to optimize the usage of these barcodes, each barcode and the relevant methods have to have been first studied in-depth. the lack of computational tools that facilitate the retrieval and annotation of ptigs sequences, and that maximize ptigs-based species determination has hindered its use as a supplemental dna barcode. in this study, we have developed a web server system that tackled these problems. particularly, we have constructed several hybrid methods that would increase the species discrimination rate and also have acceptable performance.

we construct the eight methods for the following reasons. calculating blast distance requires local alignment. its calculation only uses the nucleotides within the locally aligned regions. in contrast, calculating both p and edit distances require global alignment. p distance is calculated using only nucleotides within the globally aligned regions. on the other hand, the calculation of edit distance uses all nucleotides between the two sequences. consequently, among the alignment-based method, the edit distance method utilizes all available sequence variation information and should have the highest discrimination power. however, the cost for increased resolution is the rapid degradation of performance. we combined the base methods to form b+p, b+e and b+p+e so that fast methods can be applied first and the queries that can not be successfully identified can then be subjected to more sensitive but slower methods. the alignment-free method dnfp is most accurate and fastest . however, totally unrelated sequences might have similar dnfp. we combined d+p, d+e and d+p+e to further resolve the queries that cannot be resolved by dnfp method alone.

we include all eight methods in the web server for the following considerations. in a typical scenario, the user can employ the dnfp method first for quick species identification. he can further drill down with more sensitive methods if the query fails to be assigned to a single species. in addition, the alignment-based methods can be used to validate the results obtained from the dnfp method.

the methods developed here have significantly increased the success rate of ptigs-based species identification when using the blast method. these methods can be easily extended to other dna barcodes. however, it should be emphasized that the improvement of methods will not be able to solve many problems inherent to dna barcoding technologies. for example, computational methods can differentiate species for a given marker only if there are variations in the marker sequences among different species. in addition, species determination is only useful when the query sequences exist in the reference database. when the query sequence is not in the reference database, the identification can be rather unreliable. last, these methods would be useless in the cases that the voucher samples are wrongly-identified, or the sequence annotations from public databases are incorrect, which are known to be far too common.

CONCLUSIONS
in the current study, we have compared eight different methods for ptigs-based dna barcoding analyses. we have also developed tools that would facilitate the retrieval and annotation of ptigs sequences. all these tools have been integrated into a web server. to our knowledge, this web server represents the very first that supports ptigs-based dna barcoding analyses. it would strongly promote the ptigs-based dna barcoding applications.

availability and requirements
the web server is available at http://psba-trnh-plantidit.dnsalias.org with no requirements for both non-profit and commercial users.

list of abbreviations
ptigs: psba-trnh intergenic spacer; dnfp: di-nucleotide frequency profile

competing interests
the authors declare that they have no competing interests.

authors’ contributions
cl designed the study, implemented the edit distance calculation method and set up the frame work for the web server, wrote the paper except the background section. tg wrote the background section. dl implemented the dnfp method and carried out the comparison of the eight different methods. xhp, jys, hy, jph, zhl, kj and xjg tested the web server. hl and slc critically reviewed the article.

supplementary material
additional file 1
sequences used in this study this file contains all sequences in fasta format used in this study.

click here for file

 additional file 2
taxon ids for sequences used in this study this file contains the mapping between the taxon ids from ncbi and their corresponding sequence accession numbers.

click here for file

 additional file 3
exemplar sequences used in method evaluation this file contains the three sequences used as the example to demonstrate that blast+p distance method is advantageous to the blast methods.

click here for file

 acknowledgements and funding
this work was supported by the “xiehe scholar” start-up fund from the chinese academy of medical science to c.l. and scientific research foundation of the ministry of education for the returned overseas chinese scholars to h.l.

this article has been published as part of bmc bioinformatics volume  <dig> supplement  <dig>  2011: tenth international conference on bioinformatics – first iscb asia joint conference  <dig> : bioinformatics. the full contents of the supplement are available online at http://www.biomedcentral.com/1471-2105/12?issue=s <dig> 
