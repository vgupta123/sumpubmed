BACKGROUND
chimeric transcripts or chimeras are transcripts whose sequence originates from two or more different genes in the genome  <cit> , and can be explained by several different biological mechanisms at the genomic or the transcriptional level. for its historical relation to cancer, the most well known mechanism is genomic rearrangement. this process brings two genes that are far apart in the germline genome close to each other, and in the same direction, in the cancer genome. the fusion gene thus created can have a deleterious role, either as a protein or as a transcript  <cit> . aside from chimeras that are important for their known role in cancer, there are other functional transcriptional mechanisms that can also explain the formation of chimeras in normal or tumour cells: polymerase read-through and trans-splicing  <cit> .

as indicated by its name, polymerase read-through occurs when the polymerase reads through one gene into the next, therefore creating a chimera between two adjacent genes. initially thought to be an exception, this mechanism was found to be widespread in mammals when large collections of ests  and cdnas  became available and were mapped to the genome , and when the encode  consortium systematically surveyed the transcriptome associated to annotated protein coding genes . read-throughs occur between annotated exons of adjacent genes, preferentially between the penultimate exon of the upstream  gene and the second exon of the downstream  gene  <cit> , resulting in new proteins containing domains from the two parent genes, therefore increasing the diversity of a species proteome  <cit> . they are also largely conserved across vertebrates  <cit> , and could be a way to regulate the expression of one or both parent genes  <cit> .

trans-splicing is a splicing mechanism that, unlike the well known cis-splicing, occurs between two different pre-messenger rna  molecules close in the three dimensional  space of the nucleus and thought to belong to the same ‘transcription factory’. if the two pre-mrnas come from two different genes, a transcriptional chimera is generated . the two connected genes can therefore be located distally from each other in the genome, however the chimeric junction must have canonical splice sites. initially thought to be restricted to trypanosomatidae, this mechanism has gained interest in human research since several studies have found chimeras between genes on different chromosomes or strands, without evidence of underlying genomic rearrangements  <cit> . one hypothesis is that such trans-spliced transcripts occurring in normal cells would trigger a genomic rearrangement, which will in turn produce a higher quantity of these transcripts , eventually leading to tumorigenesis  <cit> .

but chimeras can also be non-functional, either because they are biological noise from the transcriptional machinery, or because they are technical artefacts from reverse transcriptase polymerase chain reaction  based assays. a biological source of artefactual chimeras is polymerase transcriptional slippage through short homologous sequences , where the polymerase switches template , in the presence of a short sequence with high similarity to the one it is currently transcribing, in another gene close in the 3d space  <cit> . this mechanism is reminiscent of the reverse transcriptase  template switching, which can also produce artefactual chimeras in rt-pcr- based experiments  <cit> . note that in both cases the chimeric junctions will harbor shs and non canonical splice sites, however those are not sufficient conditions for a chimera to be an artefact, since rnase protection assay experiments, which are not rt-pcr-based, have confirmed a number of them  <cit> .

the importance of chimeras lies in their ability to create novel transcripts and proteins, therefore potentially altering the phenotype of cells, individuals or groups of individuals  <cit> . in the field of cancer, some fusion genes are cancer driver events and can be used as biomarkers or even lead to effective treatment - for instance bcr-abl <dig> in chronic myeloid leukemia   <cit>  or tmprss2-erg in prostate cancer  <cit> . however not all cancer related chimeras result from genomic rearrangements, since some of them can originate from read-through , and this mechanism could also be the most prevalent one for certain cancer types, such as cll  <cit> . although chimeras’ function have mostly been investigated in relation to cancer, chimeras can also be functionally important in other fields. for instance a chimera produced by trans-splicing, tsrmst, has been shown to interact with pluripotency related transcription factors to control cells’ pluripotency  <cit> , and the knock-down of two widely expressed chimeras, ctbs-gng <dig> and ctnnbip1-clstn <dig>  in non-neoplastic cell lines, resulted in significant reduction in cell growth and motility  <cit> .

these events were previously detected by rt-pcr-based methods such as est alignment to the genome  <cit> , or racearray followed by rt-pcr, cloning and sequencing  <cit> , however rna-seq has been shown to be both a more precise and a more sensitive detection method  <cit> . a growing number of bioinformatic methods have been created to detect chimeras amongst such datasets .

these state-of-the art programs usually include  <dig> steps:  mapping and filtering for chimeric reads,  chimeric junction detection, and  chimera assembly and filtering  <cit> . they rely heavily on an underlying mapper to map the reads to the genome , and make use of two kinds of reads for chimera detection:  discordant paired-end  reads, i.e. paired-end reads where the two mates map in a way that is not consistent with annotated gene structure, e.g. on different chromosomes, and  ‘split’ reads, i.e. reads that do not map contiguously to the genome but have to be split or fragmented into several blocks  to map to the genome . in addition, the use of one or two kinds of reads for chimeric junction detection allows one to define  <dig> classes of approaches:  the whole paired-end approach,  the direct fragmentation approach, and  the paired-end + fragmentation approach  <cit> .
fig.  <dig> two types of rna-seq reads for chimera detection. this picture shows a chimeric transcript  made from exons of two genes, a and b, depicted in blue and red respectively . this chimeric transcript is supported by two types of reads: a split-read and a discordant paired-end read, that we depict aligned both on the genome  and on the transcriptome . the chimeric junction position on the transcriptome is highlighted by a yellow star both in the split-read and in the chimeric transcript




benchmarking of these programs has shown a high false positive rate and a poor intersection between their outputs on the same dataset  <cit> . on the other hand these programs are usually developed to detect fusion genes in human cancer, and are therefore not always able to detect read-through events and to work on species other than human. in addition, these programs are not always able to predict multiple isoforms per gene pair, and more importantly to provide base pair resolution, preventing their downstream functional validation. to address these problems we present chimpipe, a modular method which uses the paired-end + fragmentation approach and a set of stringent filters, to reliably detect both transcriptional chimeras and fusion genes from illumina paired-end rna-seq data from both normal and tumor samples, in any eukaryotic species with a genome and an annotation available. the advantage of the paired-end + fragmentation approach is the complementarity of the two types of reads used, with the first ones relatively easy to find but only providing a rough indication of the connected regions, and the second ones more error prone but providing the exact chimeric junction coordinates. the biggest difference between chimpipe and other tools of the field is its independent generation of split-reads and discordant paired-end reads. programs using the paired-end + fragmentation approach usually first find discordant paired-end reads, then make an exon-exon junction database from them, and finally map the yet unmapped reads to this database. they are therefore not able to find split-reads that do not have associated discordant pe reads. contrary to these programs, chimpipe finds split-reads and discordant paired-end reads independently, defines chimeric junctions based on the first ones  and uses the second ones as a way to reduce the false positive rate . the second biggest difference with other tools is the fact that chimpipe uses mapping tools  that guarantee an exhaustive mapping search given the input parameters, which again allows for a higher initial sensitivity. our combination of filters may also be more complete than for other tools since it is based on chimera expression, gene annotation, mitochondrial read removal, and homology between connected genes. in practice it allows chimpipe’s false positive rate to be rather low, but not at the expense of sensitivity. chimpipe represents an advance in methods to quickly and reliably detect chimeric transcripts amongst the rapidly increasing volume of short read transcriptome data.

methods, 
RESULTS
in this section, we first present the chimpipe method, then the chimpipe benchmark, then the rt-pcr validation of chimpipe predicted chimeras, and finally the application of chimpipe to the search for common recurrent chimeras between human and mouse.

the chimpipe method
the chimpipe method is depicted in fig.  <dig> and includes  <dig> consecutive steps: 
 
exhaustive paired-end and split read mapping with gem. the paired-end reads are initially mapped in  <dig> ways with the gemtools rna-seq pipeline : to the genome, to the transcriptome and de novo. firstly, the reads are mapped to the genome with gem  <cit> , allowing up to 4% mismatches and indels. secondly, the reads are mapped to the transcriptome with the same mapping parameters, the transcriptome being composed of all biologically valid combinations of exons within each gene . this transcriptome is built from the gene annotation and allows mapping of reads spanning exon to exon junctions that would not match to the reference genome due to the presence of introns. thirdly, the reads are split-mapped to the genome with the gem rna mapper  to identify de novo splice junctions from unannotated transcripts. more precisely, reads are split into two segments of at least  <dig> base pair  length, which are mapped independently to the genome. to reduce the amount of false positive mappings, only split-mappings with less than 4% mismatches or indels and harbouring extended consensus splice sites are further considered . to increase the mapping sensitivity, a second attempt is made by eroding a maximum of two bp towards the ends of each segment if no result is found. at this stage, segments can map to distant positions, but not to different chromosomes, different strands or reverse order. after that, genome, transcriptome and de novo mappings are merged and paired and those pairs mapping to more than  <dig> positions are set as unmapped. finally, unmapped reads are remapped in a second de novo mapping with the gem split-mapper . reads are split-mapped to identify bona fide splice junctions connecting loci on different chromosomes, different strands and reverse order. since this read split-mapping step is likely to generate more false positives than the initial ’normal’ read mapping step done with gemtools, we decided to do the former in a more stringent way than the latter by not attempting to trim and remap the reads that did not map with the default parameters. note that we chose gem-based methods for mapping because these programs guarantee that all possible mappings of a read are reported given the input parameters.


 
chimsplice. read mapping is followed by candidate chimeric splice junction detection from split-mappings. the split-mapped reads are organized into clusters of reads spanning the same splice junction. the donor and acceptor splice sites are considered when building the clusters to guarantee that all of them are in the 5’ to 3’ orientation. this is very important to determine which are the upstream and downstream parent genes, and is particularly useful in case of unstranded rna-seq data. once the clusters have been generated, chimsplice produces a consensus splice junction defined by the exact junction coordinates, the upstream coordinates of the upstream cluster, and the downstream coordinates of the downstream cluster. additionally, each consensus junction is associated with the number of supporting split-reads and staggered split-reads. the term staggered split-reads refers to those reads spanning the same junction but mapping to different external positions and, as a consequence, producing a characteristic ladder-like pattern of reads across the junction . this pattern has been suggested to be specific to genuine chimeric transcripts, while false positives usually lack it  <cit> . this information is recorded and can be used to distinguish real from artefactual chimeras. then, the consensus junctions are annotated. each junction is compared to the annotated exons in order to determine its two parent genes. in case a junction side overlaps several exons from different genes, the one with a higher overlap is selected. finally, splice junctions connecting exons from two different genes  are selected for downstream analyses.

 
chimpe. once chimeric junction candidates have been found using chimsplice, chimpe looks for further paired-end support for them . genome, transcriptome and de novo mappings are filtered to select only those pe reads with both mates mapped. those pe reads are compared to annotated exons in the same way as described in , and reads with both mates mapping to exons from different genes are identified . for each chimeric junction, discordant pe reads connecting their parent genes are then selected and their relative mapping position to the chimeric junction is evaluated. this is done in order to know whether the discordant pe reads support the existence of the chimeric junction  or if, on the other hand, they are incompatible with the chimeric junction . inconsistent pe can be due to different reasons: they may come from a different chimeric rna isoform than the one highlighted by chimsplice, or from pe read misalignment, but they could also indicate a chimsplice false positive. finally, each chimeric junction is associated to the number of consistent and inconsistent pe reads, which can be used in the downstream chimfilter filtering module to filter out artefactual chimeras.

 
chimfilter. chimeric junction candidates are filtered to produce a final set of more reliable chimeras. firstly, based on the principle that false positives due to read misalignment would not be supported by both sources of evidence, chimpipe requires a candidate chimera to be supported by both split-reads and consistent pe reads. two different support based filtering schemes are applied depending on whether the chimeric junction involves annotated or novel splice sites. by default, chimeric junctions with annotated splice sites must be supported by at least one consistent pe read, one split-read and three total  reads, while those with novel splice sites have to be supported by at least three consistent pe reads, three split-reads and six total reads. secondly, chimeric junctions involving genes either located on the mitochondrial chromosome or pseudogenic are filtered out as likely false positives due to mapping errors. finally, chimeras between genes that share high exonic sequence similarity  are also filtered out since their supporting reads are more prone to mis-alignments . all these filtering parameters can be tuned.


fig.  <dig> the chimpipe method. a rna-seq reads are first mapped to the genome and transcriptome using the gemtools rna-seq pipeline, and the reads that do not map this way are passed to the gem rna-mapper to get reads that split map to different chromosomes or strands. b the split-reads from these two mapping steps are then gathered and passed on to the chimsplice module which derives consensus junctions associated to their expression calculated as the number of staggered split-reads supporting them. the chimpe module can then associate each chimeric junction found by chimsplice to their discordant pe reads, splitting them into the ones consistent and the ones inconsistent with the junction. c the chimfilter module then applies a series of filters to the chimeric junctions obtained until this point in order to discard false positives, leading to d a set of reliable chimeric junctions to which it associates several pieces of information such as a category , and the supporting evidence in terms of number of staggered split-reads and number of consistent pe reads, among others




the main chimpipe output is a tabulated text file with header including the set of chimeric junctions after filtering, in which the first column is the junction identifier in chimpipe format , and the other  <dig> columns are valuable pieces of information about it, such as its support in terms of number of staggered split-reads and consistent discordant paired-end reads, its type  if the two parts are on the same chromosome, same strand, expected genomic order and closer  than  <dig> kilobase , inverted if the two parts are on the same chromosome, same strand and unexpected genomic order, interstrand if the two parts are on the same chromosome but different strands and interchromosomal if the two parts are on different chromosomes), its two parent genes, its length and the list of its supporting reads . chimpipe also outputs a file with chimeric junctions before the filtering, and a file with the junctions that have been filtered out with information about the reason for this filtering . it has to be noted that chimpipe can also start from already aligned reads  provided they include evidence of intra-chromosomal chimeric junctions, and that chimpipe does not only output chimeric junctions but also a standard bam file  of the pipeline) that can be used for more standard rna-seq analyses such as differential gene expression or transcript reconstruction. finally chimpipe has been designed to require minimal information about the pe rna-seq dataset on which it is run, since it guesses the illumina quality offset, the strandedness, and the mate configuration in case of directional data. note that chimpipe’s documentation includes a tutorial and an example.

benchmark on simulated and cancer data
we evaluated chimpipe and other state-of-the-art chimera detection tools, using two kinds of evaluation data: simulated data that we generated and real data from melanoma and breast cancer. the main advantages of simulated data are the inclusion of all kinds of chimeras  and the control over the chimeras expected to be found, therefore allowing a precise evaluation of the programs. its main drawback, however, is the uncertainty about whether it captures the underlying complexity of real data. the drawback of real data, on the other hand, is its very limited number of validated cases, and the fact that most of them are fusion genes. indeed neither does it allow to assess the programs’ precision, nor to extrapolate their results to non cancer data.

we developed chimsim, a program to simulate chimeric transcripts from a gene annotation, a genome, and numbers of read-through, intra-chromosomal, inverted, interstrand and interchromosomal chimeric transcripts to create from the gene annotation . using chimsim on the the gencode v <dig> protein-coding genes  <cit>  and the hg <dig> genome, we generated a simulated dataset of  <dig> chimeric transcripts homogeneously distributed in the  <dig> chimera classes  . knowing that about 60% of transcripts from protein coding  and long non-coding rna  genes are usually expressed in a given condition  <cit> , we sampled 60% of transcripts from gencode v <dig> pc and lncrna gene transcripts, totalling  <dig>  transcripts . knowing that when a chimera is expressed, its parent genes are often also expressed  <cit> , we added the parent transcripts of the  <dig> chimeras to the sampled transcripts, totalling  <dig>  non chimeric transcripts .

the  <dig>  transcripts resulting from the union of the  <dig> chimeric transcripts and the  <dig>  non-chimeric transcripts, were then passed on to the art_illumina program of the art suite , to simulate illumina non directional paired-end rna-seq reads of  <dig> different lengths: 50bp, 76bp and 101bp, called pe <dig>  pe <dig> and pe <dig> respectively. several parameters were used in addition to read length and paired-endness, to make our simulated chimera data closer to real rna-seq data, including insert size mean and standard deviation, read coverage and sequencing quality profile . the sequencing quality profile was learnt from real illumina pe data of the same read length using the art_profiler_illumina program of the art suite . using these parameters, art generated  <dig> ,  <dig>  and  <dig>  million pe reads for the pe <dig>  pe <dig> and pe <dig> respectively . the benchmark was done for each read length separately.

for real data with experimentally validated chimeras, we used two previously published datasets: the leukemia/melanoma cancer study from berger et al. , and the breast cancer study from edgren et al. . the berger set was composed of the k <dig> chronic myelogenous leukemia cell line associated to two different insert size ranges, 300- <dig> bp and 400- <dig> bp, of the 501mel melanoma cell line and of  <dig> melanoma patient-derived short-term cultures, and came with  <dig> rt-pcr validated fusion genes . the edgren set was composed of  <dig> breast cancer cell lines , and came with  <dig> rt-pcr validated fusion genes. for the edgren set we used an additional  <dig> fusion genes that were found and rt-pcr-validated by a re-analysis of the edgren et al. data by kangaspeska et al.  <cit> , totalling  <dig> fusion genes . the benchmark was done for each library separately, but is provided for the pool of libraries of each dataset, for clarity reasons. since the chimeras specifically targeted by the berger and the edgren studies were only fusion genes, the read-through events were removed from all programs’ predictions before running the benchmark.
this table indicates for each cancer dataset, its associated set of cell lines and corresponding tumor types, together with the number of rt-pcr validated fusion genes and junctions. some fusion genes are associated to several fusion junctions


asra: sequence read archive 




since we wanted to do the evaluation both at the gene pair level and at the junction level, and since an rt-pcr validated fusion gene is merely a gene pair together with the cdna sequence corresponding to its junction, we used the blat program  <cit>  to align the cdna sequences to the hg <dig> human genome, and further manually curated these alignments to obtain the exact chimeric junction coordinates for each fusion gene . this procedure resulted in  <dig> and  <dig> chimeric junctions for the berger and edgren sets respectively, indicating the presence of two different isoforms for one gene pair in each set .

the chimera detection programs that we chose to benchmark together with chimpipe  were the following: 
fusionmap 

prada 

chimerascan 

tophatfusion .




we chose these programs because their method was published and for one of the following three reasons:  they were shown to have good results in several independent studies  or  they were used in studies associated with gold-standard chimera rna-seq datasets  or  they were extensively used by the community . since these programs are optimized for human and for cancer, we used them with their default parameters for real data, and we adjusted their parameters to allow read-through detection for simulated data, when it was possible .

the evaluation measures used are the standard sensitivity and precision for simulated data, and the sensitivity and total number of predictions for real data. in addition, the evaluation was done at two levels: the gene pair level and the junction level . for each of these two objects, gene pair and junction, we have a reference set , and a predicted set for each program . we then define a true positive  as an object present both in the reference and in the predicted set, a false positive  as an object present in the predicted set but not in the reference set, and a false negative  as an object present in the reference set but not in the predicted set. the sensitivity  is then the fraction of the reference objects that are correctly predicted, while the precision  is the fraction of the predicted objects that are correctly predicted. since a high sn can be easily obtained at the expense of a low pr, and reciprocally, we use the f1score, which is the harmonic mean between sn and pr, as an additional measure. note that in order for a predicted chimeric junction to be a tp, its coordinates must exactly match the coordinates of a reference chimeric junction .

the results at both the gene pair level and at the junction level for both the pe <dig> simulated data and the real data, are shown on fig.  <dig> and additional file 1: table s3-s <dig> . at the gene pair level the top program on the simulated data is chimerascan followed by chimpipe, fusionmap, prada and finally tophatfusion, with a generally quite high pr for all programs but a sn above  <dig>  only for chimerascan and chimpipe. for real data, chimerascan is still the top program in terms of sn followed by chimpipe, however its number of predicted gene pairs is  <dig> to  <dig> orders of magnitude higher than the one of chimpipe. the trend for sn on real data is similar to the one of simulated data, but the edgren gene pairs seem to be easier to predict than the berger gene pairs, with a higher sn of the programs for the former. note that prada is a program that also has a good compromise between sn and number of predicted gene pairs on real data.
fig.  <dig> benchmark results for  <dig> chimera detection programs on simulated  and on real  data. the sets of barplots on the top a, b indicate the programs’ performances at the gene pair level, while the sets of barplots at the bottom c, d indicate the programs’ performances at the junction level. for simulated data the provided measures are sensitivity , precision , and f1score , while for the two real datasets , the only provided measures are sensitivity  and the total number of predictions . here we show the results on pe <dig> simulated data, for the  <dig> simulated chimeric junctions . for the benchmark on real data, read-through events, i.e. junctions with a length smaller than 100kb when on the same chromosome, same strand and expected genomic order, were removed from the output of each program before the evaluation




at the junction level, chimpipe achieves the best results on both the simulated and the real data with a sn around  <dig>  and a pr close to  <dig>  and with a quite reasonable number of predicted junctions for real data . it is followed by prada and fusionmap, with prada behaving clearly better on real data. the performances of both chimerascan and tophatfusion are quite poor at the junction level, with tophatfusion junctions most often shifted by  <dig> bp on each side , and chimerascan junctions most often shifted by  <dig> bp on one or both sides, compared to true junctions. the fact that these programs do predict some junctions correctly , means that the incorrect junctions they predict cannot only be due to a different coordinate system.
fig.  <dig> distance between predicted and true junction. for the pe <dig> simulated set a, the berger cancer dataset b and the edgren cancer dataset c, and for each chimera detection program, the distance between the reference/true junction and the junction predicted by the program is plotted in log scale and using a pseudocount of  <dig> to avoid zero values. the distance between two junctions is defined as the sum of the distance between their donor/upstream/5’ splice sites and the distance between their acceptor/downstream/3’ splice sites




since some of the evaluated programs are not able to predict read-through events , or happened to not detect any of them on simulated data , we also made an evaluation without read-through events on simulated data . the effect was an overall improvement of the programs’ performances  but did not change the overall message above.

since some programs have a quite different behaviour at the gene pair and at the junction level, we also computed for each program and each evaluation set, the average and standard deviation of the distance between the predicted and the true junction in case the gene pair was correctly predicted . it showed that chimpipe, fusionmap and prada almost always provide the exact junction coordinates on simulated data and the berger real set, while this is not the case for chimerascan and tophatfusion, with a worse behaviour for the latter on the simulated data and for the former on the berger set. one can note that for simulated data, the distance between chimerascan predicted and true junction tends to increase with read length . although the edgren gene pairs seem easier to predict than the berger gene pairs , the junctions from the correctly predicted gene pairs seem more difficult to predict for the edgren set than for the berger set, since all the programs show a quite important average distance between predicted and true junction for the edgren set . chimpipe is second after fusionmap on the edgren set but also has many more true positives on this set. since when chimpipe detects the correct gene pair it also detects the correct junction both for the simulated data and for the berger cancer data, we think that the most likely explanation for this difficulty in finding the true junction for some edgren cases is the fact that the mrna isoform represented by the rt-pcr sequence is not the same as the one sequenced with rna-seq.

although real data does not allow to compute precision or false positive rate, we expect the number of programs predicting a given chimera to be correlated to the likelihood of this chimera to be a tp. we computed the intersection between the gene pairs predicted by each program on each of the two real sets  , and saw that prada, chimpipe and fusionmap predicted fewer unique gene pairs, while tophatfusion and chimerascan predicted many unique gene pairs, consistent with the previous benchmark results . we also confirmed that a gene pair predicted by at least  <dig> programs was more likely to be real since 26%  of the gene pairs predicted by  <dig> programs on the berger  set are tp , while only 0%  of the ones predicted by  <dig> program are tp.
fig.  <dig> chimeric gene pairs predicted by the  <dig> programs on the two real datasets. intersection between chimeric gene pairs predicted by the  <dig> programs on the berger set a and on the edgren set b are represented as venn diagrams. in general gene pairs predicted by all  <dig> programs are few compared to the gene pairs predicted by a single program, and we expect that the higher the number of programs predicting a gene pair the more reliable the gene pair. chimerascan and tophafusion are the programs that predict more gene pairs predicted by no other program, while prada, chimpipe and fusionmap are the programs with less such gene pairs. cp: chimpipe, fm: fusionmap, pr: prada, cs: chimerascan, thf: tophatfusion




regarding implementation, while some programs require a single step to predict chimeras , which is the case for chimpipe, fusionmap and chimerascan, some other programs require many different successive steps to obtain them, making the whole process more cumbersome. this is the case for prada which requires  <dig> steps  and for tophatfusion which requires  <dig> steps . the maximum virtual memory and wallclock time needed by each program  on the pe <dig> simulated data are provided in table  <dig>  the program that clearly needs the least resources is fusionmap with  <dig>  gb of ram and less than half an hour of running time, followed by chimerascan with  <dig>  gb of ram and  <dig>  h of running time, then prada with  <dig>  gb of ram and  <dig>  h of running time, then chimpipe with  <dig>  gb of ram and  <dig>  h of running time, and finally tophatfusion which requires  <dig>  gb of ram and  <dig> h of running time.
this table indicates the computing resources needed by each program to process the pe <dig> simulated data, as well as the number of commands needed to produce the final result


a <dig> h for mapping and  <dig> h for filtering  at the same time)




detection and validation of novel chimeras
in order to survey the human chimera landscape more extensively, chimpipe was run on  <dig> encode cshl pe rna-seq experiments from  <dig> human cell lines,  <dig> rna fractions  and  <dig> cell compartments  . at stringent settings , we found a total of  <dig> chimeric junctions over all experiments. of these,  <dig> had each of their two ends falling in a unique different protein coding gene, and  <dig> were either expressed recurrently  or very highly and specifically . we then only considered the  <dig> read-through and intrachromosomal chimeric junctions from this set .

four of these chimeric junctions were chosen for rt-pcr plus sanger sequencing validation. two of them were selected from the recurrently expressed class , and two of them from the very highly and specifically expressed class  . primers were designed to perform rt-pcr on cdna  as well as pcr on genomic dna, to assess whether the chimeras could originate from genomic rearrangements . out of those  <dig> cases, all showed evidence of the two parent gene mrnas , and  <dig> showed the additional presence of the chimeric rna . these  <dig> chimeric junctions present at the rna level, were not present at the dna level and therefore cannot originate from genomic rearrangements . we cloned and sequenced these  <dig> chimeras  . given that the genes they connect are on the same chromosome, strand and close to each other, these  <dig> chimeras are likely to originate from read-through events .
fig.  <dig> uba2-wtip chimeric transcript isoforms. a experimentally validated uba2-wtip chimeric transcript isoforms.  uba <dig> and wtip parent transcripts according to refseq version  <dig>  coding and utr exonic sequences are displayed as thick and thin boxes, respectively, and introns as lines. the genomic strand of the transcripts is represented as an arrow on the 5’ end  chimeric rnas with chimeric splice junctions are depicted as yellow dashed lines. on the left, list of cancer cell lines where each isoform was validated b uba2-wtip chimeric splice junction validation  primer design for validating the chimeric junction through rt-pcr plus sanger sequencing.  chimeric junction validation in  <dig> different cell lines. the  <dig> bp amplicons proving the expression of the chimeric rnas are highlighted in red. c uba2-wtip q <dig> isoform protein coding potential.  uba <dig> and wtip annotated start and stop codons represented over the transcript sequence.  orfs in the six possible frames. the selected orf from the uba <dig> annotated start codon to the wtip annotated stop codon is highlighted in dark yellow. d putative chimeric protein encoded by the uba2-wtip q <dig> isoform.  uba <dig> and wtip wild-type proteins. the exact position of the two protein breakpoints is indicated by yellow stars. protein domains are depicted as boxes and triangles over the protein sequences. thin boxes on the wtip protein sequence correspond to low complexity regions. the x axis shows the amino acid position along the protein sequence.  putative uba2-wtip chimeric protein. full-length domains are represented over the protein sequence. e the predicted 3d structure of the uba2-wtip chimeric protein as modelled by phyre <dig>  <cit> . the chimeric protein part derived from uba <dig> is depicted in blue and the one derived from wtip in red



this table lists the  <dig> chimeric junctions derived from the  <dig> encode rna-seq experiment, that we selected for rt-pcr validation . for each junction, its identifier , the name of its 5’ and 3’ genes, and its expression in terms of number of staggered split-reads and discordant paired-end reads in each of the  <dig> encode cell lines , are provided. since each cell line is associated to several rna-seq experiments , we provide the average number of staggered split-reads and the average number of discordant paired end reads across all experiments of a cell line




it has been suggested that the generation of chimeric transcripts and their translation into chimeric proteins may serve to generate novel proteins with altered functions  <cit> . therefore, we assessed the protein-coding potential of the  <dig> validated chimeric junctions. for each chimeric junction, we reconstructed the theoretical chimeric transcript structures by combining the refseq reference mrnas for the 5’ and 3’ parent genes compatible with the junction and searched for open reading frames  in the six possible translational frames with the ncbi orf finder . one case out of the  <dig> , which has already been reported  <cit> , maintained the frame of the two parent genes, uba <dig> and wtip, while the other two, picalm-sytl <dig> and rpl38-ttyh <dig>  did not. interestingly, this chimera is recurrently expressed in  <dig> out of the  <dig> experiments, which include the  <dig> cell lines, the  <dig> rna fractions and  <dig> out of the  <dig> cell compartments  . additional rt-pcr and sanger sequencing was therefore performed on uba2-wtip, giving rise to  <dig> novel complete transcript structures , of which the longest one , was more deeply analysed here. this complete chimeric transcript has an orf from uba <dig> to wtip annotated start and stop codon respectively . thus, if translated it would give rise to a chimeric protein including the two most n-terminal domains of the 5’ parent protein uba <dig>  and the three most c-terminal domains of the 3’ parent protein wtip , therefore only skipping the uba2_c domain of the uba <dig> protein and the proline-rich n-terminal domain of the wtip protein . finally, phyre <dig> structural prediction analysis  <cit>  of this chimera is able to model 97% of its residues at more than 90% confidence. this analysis suggests that the chimeric protein part derived from uba <dig> can fold into a 3d structure with 100% confidence and 96% identity to uba <dig> wild-type fold. on the other hand, the wtip protein part can fold with 99% confidence and 29% identity to ldb <dig>  a member of the same family of lim domain-containing proteins as wtip. these data are consistent with the hypothesis that the uba2-wtip protein may at least partially retain the biochemical activity of both parent proteins, leading to a protein with an altered function .

we further investigated the putative role of this chimeric protein containing the combination of domains from uba <dig> and wtip wild-type proteins. uba <dig> is part of the sumoylation machinery, which post-translationally modifies and regulates a large number of proteins with important roles in diverse cellular processes, including regulation of transcription, chromatin structure, and dna repair  <cit> . more precisely, it associates with the aos <dig> protein to produce the sumo-activating enzyme , a heterodimer that mediates the activation of ubiquitin-related modifier  molecules and their transference to the sumo-conjugating enzyme , which post-translationally modifies a target protein through the binding of sumo  <cit> . on the other hand, wtip belongs to a subset of lim-domain containing proteins, which are involved in focal and cell-cell adhesion. these interact with other proteins through their lim domains, whose sequence specifies a double zinc-finger structure capable of high-affinity binding to a wide variety of protein targets  <cit> . based on this, we hypothesize that the combination of uba <dig> sumoylation domain and wtip protein binding lim domains could lead to a chimeric protein with altered sumoylation activity. this protein may induce the sumoylation machinery to post-translationally modify and regulate novel targets, due to the interaction of its lim-domains with novel proteins.

finally, each one of the two other validated chimeras, picalm-sytl <dig> and rpl38-ttyh <dig>  gave rise to one novel  transcript structure with a premature stop codon before the last splice junction, leading us to hypothesize that they are degraded through nonsense-mediated mrna decay  <cit> . however, it is important to note that these chimeric junctions are supported by a very high number of reads , suggesting that the chimeric transcripts are highly expressed, and possibly functional.

common recurrent chimeras between human and mouse
in order to find common, and therefore potentially evolutionary conserved, chimeras between human and mouse, we applied chimpipe to human and mouse encode rna-seq data  <cit> . these data consist of  <dig> bioreplicates of  <dig> human cell lines and  <dig> mouse tissues, from which long polyadenylated rna was extracted and deeply sequenced . we applied chimpipe to each bioreplicate separately, and asked each reported junction to be supported by at least one split-read and one discordant pe read . we then gathered all reported junctions within each species, and found a total of  <dig> chimeric junctions in human and  <dig> chimeric junctions in mouse. in order to discard chimeras derived from genomic rearrangements, we also required the chimeras to be recurrent, i.e. detected in at least  <dig> samples . this filtering reduced the number of chimeras to  <dig> in human and  <dig> in mouse, corresponding to  <dig> and  <dig> gene pairs respectively. a common chimera between human and mouse was then defined by the combined presence of a chimera connecting genes a and b in human, and of a chimera connecting the ortholog of gene a and the ortholog of gene b in mouse. requiring the connected genes to belong to the set of  <dig>  one-to-one human-mouse orthologs  <cit> , we obtained  <dig> chimeras in human and  <dig> chimeras in mouse, corresponding to  <dig> and  <dig> gene pairs respectively, and the subset of those that were common between the  <dig> species were  <dig> junctions in human and  <dig> junctions in mouse, corresponding to  <dig> gene pairs . the large majority of these common chimeras connected genes on the same chromosome, same strand, expected genomic order and relatively close to each other , pointing to read-through as the main underlying mechanism. we also found that many tens of such chimeras were detected in more than  <dig> samples in one species or the other, confirming the existence and wide expression of read-through chimeras in non cancerous cells  <cit> . we also found that not only the gene pairs were common between human and mouse, but also the chimeric junctions. indeed from the  <dig> common gene pairs,  <dig> were supported by at least one chimeric junction where the  <dig> splice sites both in human and in mouse were in our set of orthologous splice sites  <cit> , of which  <dig>  were supported by at least one chimeric junction connecting orthologous splice sites in the  <dig> species. the cell lines and tissues with more chimeric junctions in the  <dig> species were related to brain  .

CONCLUSIONS
we have presented chimpipe, a novel method for the accurate detection of chimeras from pe rna-seq data, based on the independent use of discordant pe reads and split-reads. in addition to fusion genes and trans-splicing events, chimpipe is able to detect read-through events, which is now recognized as the most prevalent class of real chimeras in both normal and tumour tissues  <cit> . chimpipe is general enough to be able to work on any eukaryotic species with a genome and an annotation available. this allows to study chimera evolution but also to investigate the impact of chimeras on individuals from species on which we have more control than human . chimpipe can also predict several isoforms per gene pair and the exact chimeric junction coordinates, which are essential for chimeric transcript reconstruction and downstream biological validation.

chimpipe is easy to run since it only requires a genome, a gene annotation and a pair of rna-seq fastq files , and guesses many other things such as the directionality, the mate configuration and the illumina offset quality. for advanced users, many parameters, such as expression threshold or parent gene sequence similarity threshold, can be tuned. chimpipe provides both a complete and a filtered set of chimeric junctions, with additional information about them, such as chimera category, expression support and the list of reads supporting the junction . in addition to chimeric junctions, chimpipe provides a standard bam file obtained from the gemtools rna pipeline  of fig. 2), that can be used for downstream analyses such as differential gene expression or transcript reconstruction.

benchmarking of chimpipe together with four state-of-the art chimera detection tools on both simulated and real data, showed chimpipe to have a very good precision , and to be the second most sensitive program , therefore showing a very good balance between sensitivity and precision. additionally chimpipe’s performances on simulated and real data are comparable, and not much impacted by read length. chimpipe’s performances are also similar at the gene pair and at the junction level, which is not the case for all programs since they tend to predict gene pairs better than junctions . it has to be noted that chimpipe needs non negligible computer resources to achieve these results, since it requires ≈ <dig> gb of ram and half a day to run with  <dig> threads, on the pe <dig> simulated data .

the application of chimpipe to  <dig> encode pe rna-seq samples allowed the detection of  <dig> highly reliable chimeras, of which  <dig> were chosen for rt-pcr validation, and of which  <dig> were indeed validated and further cloned and sequenced. the uba2-wtip chimera additionally preserved the frame of the  <dig> parent genes uba <dig> and wtip, and was therefore completely sequenced, leading to  <dig> completely novel transcript structures. if translated these  <dig> novel transcripts would lead to a chimeric protein with the thif and the uae-ubf domains from the uba <dig> protein and with the  <dig> lim domains from the wtip protein. we hypothesize that this protein may induce the sumoylation machinery to post-translationally modify and regulate novel targets, due to the interaction of its lim-domains with novel proteins.

the application of chimpipe to  <dig> human and  <dig> mouse encode pe rna-seq experiments also allowed the identification of  <dig> recurrent chimeras common to both species, and therefore potentially conserved. although their large majority connect adjacent genes and should originate from read-through events, some cases are also distant or located on different chromosomes. tens of them are detected in more than  <dig> samples.

despite these advantages, chimpipe could be improved in at least  <dig> aspects:  it could provide all the chimeric transcripts compatible with the chimeric junction  as additional information,  it could be made more robust by being reimplemented in a pipeline specific language such as nextflow .

finally it has to be noted that our contribution goes beyond the chimpipe program, since we provide two additional programs:  a chimera simulator program, called chimsim , and  a chimera benchmark program, called chimbench . we also provide new realistic simulated data, as well as junction coordinates for validated fusion genes from  <dig> extensively used gold-standard chimera datasets  <cit> . we think that, in addition to chimpipe, both these programs and these data can be very useful in future chimera detection assessments.

additional files

additional file  <dig> supplementary tables, figures and methods 





additional file  <dig> simulated data 





additional file  <dig> encode read-through and intra-chromosomal chimeras 





additional file  <dig> junction sequences for  <dig> rt-pcr validated chimeras 





additional file  <dig> uba2-wtip transcript isoform sequences 





additional file  <dig> common chimeras between human and mouse 




abbreviations
bpbase pair

cdnacomplementary dna

estexpressed sequence tag

gbgigabyte

kbkilobase

mrnamessenger rna

pepaired-end

rt-pcrreverse transcriptase polymerase chain reaction

ramrandom access memory

3dthree dimensional

