BACKGROUND
copy number variation , where a section of dna differs from a diploid copy number of  <dig> between different individuals, is a common form of variation that can affect a substantial portion of the human genome and genomes from other organisms . such variation can affect phenotype through a variety of mechanisms, such as a gene dosage effect  <cit> , variation in the number of protein coding domains  <cit>  or alteration of position of enhancer elements  <cit> . cnv can be divided into simple cnv, usually comprising a deletion or duplication and generated by one mutational event, and complex multiallelic cnv where different dosage variants are generated by recurrent mutation. in humans, complex cnv has been shown to affect disease susceptibility. for example, cnv of the beta-defensin locus has been shown to affect the risk of developing the inflammatory skin disease psoriasis  <cit> , and cnv of the neuronal glucose transporter slc2a <dig> modifies the age of onset of huntington’s disease  <cit> . furthermore, cnv of the amylase gene in dogs has been shown to be an adaptation to domestication and in drosophila cnv is important in resistance to insecticides  <cit> .

despite the importance of complex cnv, research progress has lagged behind studies into simpler deletions and duplications, and has been dogged by false positive disease associations. this is almost entirely due to the challenges in accurately typing complex multiallelic cnv  <cit> . most studies have used real-time quantitative pcr, which is prone to bias  <cit> . although other more reliable methods exist, such as the paralogue ratio test  and multiplex amplifiable probe hybridisation , such assays require extensive validation and are locus specific rather than genome-wide, limiting the amount of data generated at one time. genome-wide approaches, such as analysis of hybridisation signal intensities from snp chips and array comparative genomic hybridisation, generate a large amount of useful data but are often weak in typing complex cnv – i.e. giving an absolute copy number rather than just indicating a loss or gain of signal. furthermore, complex cnv detection and typing appears to be dna cohort dependent, which further increases the risk of false negative genetic associations and false positive associations due to batch effects.

recent work has addressed analysis of cnvs using sequence read depth  generated by next-generation sequencing platforms  <cit> . the principle is simple: when short read sequences are generated from an individual with a high copy number for a particular region and are subsequently aligned to a reference genome with only one copy of that region, the number of reads mapping to that region will be higher than expected. most studies have focused on detecting cnv in whole genome sequences rather than typing absolute copy number of particular complex cnv regions  <cit> . one exception relies on singly-unique-nucleotides  to provide an internal calibration of copy number of that particular region  <cit> . this has been successful for some cnvs, and using this approach the role of a particular sequence variant of the cnv carrying the srgap <dig> gene in human evolution has been elucidated  <cit> . nevertheless, the extent to which other complex cnvs show that particular pattern of variation, where suns exist and are frequent, is not clear.

one distinct advantage of srd approaches is that they can yield information on the sequence differences between different copies of the complex cnv. other methods, such as analysis of snp array hybridisation intensity data, array comparative genomic hybridisation  data, maph or prt often assume sequence identity under the probe or primer. the effect of this can be minimised either by multiple assays or careful design of probes/assays, but such methods remain essentially blind to the sequence variation between copies. this sequence variation can be important, for example, in the srgap <dig> example mentioned above, where only particular paralogues, defined by sequence variants, are functional  <cit> .

an accurate assessment of sequence variation of a multiallelic cnv locus using srd needs high coverage sequence data to be confident that all copies have their sequence represented in the alignment. the number of publically-available whole genomes sequenced at high coverage is increasing but limited, but the  <dig> genome project has released sequence data of  <dig> exomes sequenced at high coverage using illumina sequencing technology. furthermore, given the lower cost of exome sequencing per sample, exome sequences are becoming increasingly common for large sample sets. therefore we focused on complex cnv typing and sequence analysis using high coverage exome sequence data.

there are several platforms that use exome srd data to detect and call cnv  <cit> . all use a similar approach of using principal component analysis to extract components describing different aspects of the variation, including noise, and then using a hidden markov model approach to call boundaries between gain of copy number, loss of copy number and diploid regions. in principle, the variation in the principal component that most closely corresponds to dna dosage signal can be used to type the absolute integer copy number of complex cnv. only one platform has been used to do this, conifer, which has been used on  <dig> exomes to show proof of principle  <cit> , and subsequently on  <dig> exomes to investigate the role of cnv in autism spectrum disorder  <cit> .

to rigorously test the quality of copy number and sequence variation calls from exome data on a region of complex cnv, we decided to focus on the well-studied human beta-defensin locus. this is a 322 kb region of dna on chromosome 8p <dig> , which is embedded within a complex region rich in segmental duplications and olfactory receptor genes  <cit> . the 322 kb region is copy number variable as a block, with the diploid copy number commonly between  <dig> and  <dig> copies, but individuals with as few as one copy and as many as  <dig> copies have been observed  <cit> . chromosomes with high copy number of the beta-defensin region can be distinguished by a visibly larger 8p <dig>  region by g-band staining  <cit> . furthermore, the beta-defensin region is polymorphic in physical location on the chromosome, with some copies polymorphically at the proximal end of 8p <dig>  within the olfactory repeat region repp in addition to the distal end within the olfactory repeat region repd  <cit> .

seventeen annotated genes are within the copy number variable region, including eight beta-defensin genes  and nine other genes mostly expressed in the testes  <cit> . the role of defb <dig> and defb <dig> appear to be immunomodulatory in humans, in addition to direct antimicrobial activity. for the other defensins, the role is less clear, although a knockout mouse deleting the orthologous beta-defensin cluster shows complete male infertility, strongly suggesting an important role of these genes in reproduction  <cit> . the function of the other genes remains unknown. sequence variation of the region remains understudied, primarily due to the difficulty of reliably distinguishing variant nucleotides in multicopy regions by the sanger sequencing method. we therefore decided to test whether exome srd could accurately call copy number and sequence variation of this complex cnv, both to identify beta-defensin variants which may have novel functions but also to robustly establish a recommended approach that could be applied to complex cnvs by the research community.

methods
exome data
filtered phase  <dig> exome data generated by the  <dig> genome project was downloaded from the european bioinformatics institute  as fastq files. we retrieved only illumina technology filtered paired end data generated by four different sequencing centres: baylor college of medicine , beijing genomic institute , broad institute , and washington university genome sequencing center . the initial dataset consisted of  <dig> samples divided in  <dig> major continental groups : african, east asian, south asian, european, and admixed american. throughout this paper, the standard abbreviations for  <dig> genomes populations are used – see http://www.1000genomes.org/category/frequently-asked-questions/population for details of population codes and sample names.

mapping
the reference sequence was generated using all chromosome  <dig> exons plus 300 bp flanking sequence from the grch37-hg <dig> human reference genome; when two exons were closer than 600 bp, all the genomic distance was considered. we used mrsfast ultra v <dig> . <dig> for sequence alignment, using a paired end approach  <cit> . importantly, conifer was designed to be used on alignments generated using mrsfast  <cit> , a one-to many sequence read aligner, rather than other more common aligners based on the burrows-wheeler algorithm that generally operate as a one-to-one sequence aligner. mrsfast therefore captures all possible mapping locations up to a user-defined number of mismatches, which leads to more accurate estimates of copy number from srd approaches, because all copies above a given percentage identity will be aligned efficiently to the reference locus. a reference indexing window size of  <dig> was created and the pair end reads mapping was performed using the all-mapper tool with a maximum error threshold of  <dig> 

cnv calling
cnv calling used conifer, a suite of python scripts that calculate rpkm  values starting from aligned sequences and a set of probes  <cit> ; for our analyses we defined the probe set as all the chr <dig> exon boundaries. samples with a rpkm mean < <dig> were discarded from the analysis to reduce background signal. singular value decomposition standardized z-scores rpkm  values were calculated for samples belonging to one or more population generated by the same sequencing centre , removing the first components that are disproportionally responsible for the variance of the data. for each dataset under analysis, we evaluated the best number of components to be removed using scree plots generated by conifer; the components to be removed were chosen based on the shoulder of the scree plot. raw svd-zrpkm mean of the beta-defensins that unambiguously map just to chromosome 8p <dig>  defb <dig>  defb <dig>  defb <dig>  defb <dig>  defb <dig> and defb107) were retrieved and used for cnv calling. to determine the integer copy number call for each sample we used cnvtools, grouping samples from the same continental group and sequencing centre together. the gaussian mixture models were evaluated by eye, plotting the mixture model together with a histogram of raw copy number to check for clear clustering about integer copy numbers, and also by comparing calls with previous copy number estimates of samples from the hapmap collection that overlapped the  <dig> genomes dataset, using triplex paralogue ratio tests  <cit> . these positive controls also allowed us to confirm that the correct svd-zrpkm component was used for copy number calling.

variant calling
single nucleotide variants in one assembled beta-defensin region were called using freebayes v <dig> . <dig>  <cit> . freebayes is a haplotype-based bayesian genetic variant detector, which can call sequence variants from samples of different ploidy, with ploidy  as an extra parameter for each sample. we ran freebayes setting  <dig> and  <dig> as minimum base and mapping quality, respectively;  <dig>  as the minimum fraction of alternate variant observations and  <dig> for the minimum count of alternate variant reads; finally we specified for each sample the number of copies of the beta-defensin region estimated by the conifer exome srd analysis.

validation of copy number
copy number estimates of  <dig> samples from the hapmap collection that overlapped the  <dig> genomes dataset, using triplex paralogue ratio tests, have been published previously. copy number estimates of the same samples were also obtained using the nanostring ncounter system  <cit> , by designing  <dig> probes mapping to the beta-defensin repeat and calculating the first principal component, sample-wise, of the  <dig> probe values using the r package cnvtools  <cit> .

validation of sequence variants
pcr primers were designed flanking variable sites, and genomic dna from a selection of  <dig> hapmap samples amplified using standard pcr. pcr products were then cloned into pjet  <dig>  vector using the clonejet pcr cloning kit , where the insert disrupts a lethal gene allowing only plasmids with an insert to confer viability to the bacterial host. following plating, colonies were selected for colony pcr using the vector primers 5’cgactcactatagggagagcggc-3’ and 5’aagaacatcgattttccatggcag-3’ flanking the insert, according to the manufacturer’s instructions. pcr products were then digested using the appropriate restriction enzyme to distinguish the alleles at the variant site  and scored for allelic state following agarose gel electrophoresis.

population genetics
variant frequency distributions for non-synonymous and synonymous variants were compared across the beta-defensin genes analysed, for each population, using the k-sample anderson-darling test  <cit>  implemented by the r package ksamples.

availability of data
one thousand genomes phase  <dig> exome read data are publically available from the european bioinformatics institute european bioinformatics institute  as fastq files. all  <dig> confident copy number calls have been submitted to dbvar  with accession number nstd <dig>  all novel variants identified in this paper have been deposited in dbsnp .

ethics statement
for a description of the ethics and consent agreements used for the  <dig> genomes project see http://www.1000genomes.org/about.

RESULTS
we aligned fastq raw sequence read files for  <dig> samples from  <dig> populations to a concatenated reference sequence made of all chromosome  <dig> exons plus 300 bp flanking sequence. we grouped the samples from the  <dig> populations into four continental groups. after removing samples where the reads per kilobase per million mapped reads  mean value was less than  <dig>   we calculated single variant decomposition scores batch wise, with each batch representing a distinct continental group/sequencing centre combination. raw svd-zrpkm mean of all exons of the beta-defensin genes were retrieved and a gaussian mixture model fitted for each set of data using cnvtools. observing clear clustering of svd-zrpkm mean values about integer copy number values leads us to have high confidence in the gaussian mixture model fit and therefore in the final copy number calls. importantly, batches needed to be defined by both sequencing centre and continental group, otherwise poor clustering was observed. for example, fig.  <dig> shows histograms of raw svd-zrpkm mean values from the bgi sequencing centre, for east asians , south asians  and east and south asians together . although a gaussian mixture model can be fitted for all three histograms, the clustering of the svd-zrpkm values of the combined batches  is visibly less distinct than when each batch is analysed separately. for most batches, clear clustering of raw svd-zrpkm values was observed, increasing confidence that the correct copy number was being called . however some showed svd-zrpkm values that did not cluster well , and these were removed from subsequent analyses.fig.  <dig> distribution of reads-per-kilobase-per-million-reads  values of different samples stratified by sequencing centre. the kernel density plot shows density of rpkm values from mrsfast alignments for four different sequencing centres, distinguished by the different colours. the vertical dotted line indicates the cutoff value at rpkm =  <dig>  with samples above that threshold taken on for copy number calling

*posterior probability of the copy number call is > <dig> 

fig.  <dig> effects of continental group batch of origin on copy number clustering. the histograms show normalised sequence depth coverage data for the beta-defensin region generated by the bgi sequencing centre. x-axis values represent raw mean svd-zrpkm values, and the y-axis represents number of samples. curved lines indicating the gaussian curves used to call integer copy number. a) samples from east asian populations , b) samples from south asian populations , c) samples from south asian and east asian populations analysed as one batch 

fig.  <dig> effects of sequencing centre and batch size on copy number clustering. the histograms show normalised sequence depth coverage data for the beta-defensin region for sub-saharan african samples. x-axis values represent raw mean svd-zrpkm values a) bcm sequencing centre, n =  <dig> . b) bgi sequencing centre, n =  <dig> , with curved lines indicating the gaussian mixture model used to call integer copy number



gaussian mixture modelling generated a copy number call for each sample with an associated posterior probability of that call. the proportion of calls with a posterior probability greater than  <dig>  varied between sequencing centres , but overall was 87 %. the distribution of copy number reflected previous results, with  <dig> being the modal copy number in all continental groups apart from sub-saharan africans, and the range of common variation extending from  <dig> copies to  <dig> copies per diploid genome .table  <dig> beta-defensin copy number frequency in human continental groups



we validated our copy number calls by comparing calls on a subset of samples with copy number estimates made previously by triplex prt  <cit> , by nanostring  <cit>  , and also with copy number calls of the region made by whole genome sequencing  <cit>  . it is clear that copy number calls made using exome srd agree well with both prt and nanostring consensus copy number. exome srd calls also agree well with whole genome srd data, although there is a significant discrepancy rate of  <dig>  %. most discrepancies are at the higher copy numbers, and seem to be due to exome srd underestimating copy number. of the  <dig> samples that are discrepant between exome srd and both prt and nanostring, three are also discrepant with whole genome srd copy number calls, all are spread across the different sequencing centres , suggesting the discrepancies are due to random assay noise rather than a systematic bias.fig.  <dig> validated of beta-defensin copy number calling. the plots show comparisons between two methods of calling integer beta-defensin copy number. a) comparison with triplex paralogue ratio test and nanostring ncounter. b) comparison with integer calls from phase  <dig> low coverage whole genome data  <cit> . the figures in red indicate the numbers of samples concordant for that particular copy number. the numbers in blue indicate the numbers of discordant samples



we used our exome srd data to investigate the extent of contiguous copy number variation at this locus, gene by gene. individual svd-zrpkm mean values of each gene were correlated with the individual svd-zrpkm mean values of genes within and surrounding the beta-defensin cnv region, both at distal 8p <dig>  , and proximal 8p <dig>  , across the  <dig> european samples sequenced at the bgi. we would expect genes on the cnv block to show highly correlated svd-zrpkm scores across these individuals, reflecting the cnv. indeed, the core defensin genes  showed a very high correlation  indicating that these are on a contiguous block that shows cnv. this block of highly correlated genes extends distally as far as fam90a <dig> and includes defb <dig>  albeit with lower correlation coefficients, which is likely to be due to mapping of sequence reads derived from known segmental duplications involving these genes on chromosome  <dig> and chromosome  <dig>  this confirms the observation made previously using arraycgh that these genes are involved in the beta-defensin cnv  <cit> , and shows that analysis of exome srd can be a powerful approach to identify cnv boundaries. interestingly, a moderate correlation coefficient is observed for some genes at repp, including defb <dig> but not defb <dig>  defb <dig> nor defb <dig>  the beta-defensin repeat region  is not assembled here, but it is known from genetic data that the repeat region can be polymorphically present here at this location  <cit> , and this signal we observe is likely to be due to cnv of the beta-defensin repeat region at repp.fig.  <dig> correlation of svd-zrpkm values between genes at 8p <dig> . plot of pairwise correlation between svd-zrpkm values among genes at chromosome region 8p <dig> . the svd-zrpkm mean for all exons belonging to each gene was calculated and the pairwise correlation for each pair of genes was evaluated by the r <dig> metric . gene presence and location is based on the annotation of the hg <dig> human genome assembly. complex repeat-rich regions repp and repd are indicated, and several genes between repp and repd are omitted to save space, as indicated by the red dashed line



we used our exome alignment files to call sequence variation across the beta-defensin genes within the cnv. using freebayes, a sequence caller that uses diploid copy number as an extra parameter and therefore can make sequence variant calls from non-diploid regions, we called  <dig> single nucleotide variants spanning 8811 bp of sequence representing the combined length of the beta-defensin genes.  <dig> are intronic or intergenic, with  <dig> within the untranslated regions or coding regions. the majority of variants called are rare or very rare, and are specific to particular continental groups, suggesting that they have arisen very recently in human evolutionary history.  <dig> variants  are novel and have been submitted to dbsnp.

sixty-seven variants  were called that were predicted to affect amino acids within the beta-defensin genes . we validated two frequent non-synonymous variants, rs <dig> in defb <dig> that changes arginine to a glutamine at position  <dig>  and rs <dig> in defb <dig> that changes a cysteine to a tyrosine at position  <dig>  it was important not only to validate the presence of the variant but also the correct number of copies of that variant. we did this by amplifying across the variant using genomic dna, cloning the resulting pcr product, and then counting the number of clones  that had each allele of the variant using colony pcr followed by restriction enzyme digestion . this gave an estimate of the proportion of each allele at each variant for each sample, which could be then compared with that predicted by exome sequencing – for example a ggga genotype  would be regarded as  <dig>  a allele. for both variants, samples homozygous for the variant that is cut by the restriction enzyme was included to provide a background rate of cut failure either due to experimental error or mutation of restriction site during amplification and cloning. the proportion of each allele measured using this approach is consistent with the genotype called from exome srd data for all samples, except one. the exception is na <dig>  where the molecular cloning method generates an estimate which agrees with a copy number of  <dig> called by prt rather than a copy number of  <dig> called by exome srd, and therefore reflects an error in copy number calling by exome srd.fig.  <dig> summary of predicted amino acid changes inferred from sequence variation. the six beta-defensin proteins encoded by the genes analysed in this study are shown. the prepro region, which is cleaved during processing, is shown under the blue bar; with the mature peptide sequence is shown under the red bar. the canonical six cysteines are highlighted in red, with sequence variants identified in this study shown in green. x represents a stop codon, and hbd <dig>  hbd <dig>  hbd <dig>  hbd <dig>  hbd <dig>  and hbd <dig> are the proteins encoded by defb <dig>  defb <dig>  defb <dig>  defb <dig>  defb <dig> and defb <dig> respectively

95 % confidence intervals of the binomial distribution calculated using the pearson-klopper method


acalled as  <dig> copies by previous prt



we considered whether a signature of selection at these beta-defensin genes could be inferred from the frequency of sequence variants. by comparing the sequence variant frequency distribution of non-synonymous and synonymous snps within coding regions, it is possible to detect the effect of negative selection or balancing selection across the region. assuming that selection does not act on synonymous variants and therefore their variant frequency distribution represents the neutral null model, we would expect to see an enrichment of non-synonymous variants at low frequency under negative selection, and an enrichment of non-synonymous variants at high frequency  under balancing selection.

given the small exon size and therefore small number of polymorphisms in the coding region of each gene, we compared the sequence variant frequency distribution for each continental group separately, combining data across all beta-defensin genes measured in the cnv. we did not find a statistically significant difference between any non-synonymous and synonymous sequence variant frequency distributions, for any of the continental groups. this suggests that selection is not acting on these genes, and that the sequence variants observed are essentially neutral.

discussion
in this study we show that high coverage exome sequencing can effectively report integer copy number and sequence variation between copies. focusing on exome sequencing data has two disadvantages compared to whole genome sequencing data. firstly, typing depends on the presence of exons  that map within the complex cnv region. it is obvious that if there are no exons within the cnv, the sequence will not be enriched and no  sequence will be generated from that cnv. the problem is scalar, in that it is likely that cnvs with more exonic sequence will have more sequence reads and therefore be more effectively called using srd approaches compared to cnvs with a small amount of exonic sequence. secondly, exome sequencing relies on solution-phase enrichment of fragmented dna using sequence-specific baits. such an enrichment process might introduce bias into copy number calling, dependent on gc-content of the region or experimental batch, for example.

future studies need to be aware of several issues that are important to consider when inferring integer copy number from exome srd. firstly, in this study we knew a priori the extent of cnv, which had been elucidated previously, so allowing us to choose several genes which we know were contained in a contiguous cnv block. inferring cnv boundaries from exome data, particularly when those boundaries are within gene sparse areas or segmental duplications, may result in noisier srd data, although we show that once a cnv can be robustly typed, the boundary of the cnv can be refined on a gene-by-gene basis. secondly, we had a number of positive controls where copy number was well established using other methods. this allowed us to validate our singular value decomposition components and our gaussian mixture models, giving us confidence in our final copy number calls. thirdly, particular population-sequencing centre batches of samples gave distinct raw copy number results, suggesting that fitting individual gaussian mixture models to individual batches is important. we do not know what causes this variation, and why sometimes it prevents clustering of raw copy number results, but we suspect it might be due to subtly different signal-noise structures in the data because of different exome enrichment processes used by different centres, which svd cannot completely resolve. if correct, then we predict that high-coverage whole genome sequences will not show this problem.

one previous study used target enrichment and  <dig> sequencing of over 87 kb of the beta-defensin cnv in two samples to study sequence variation  <cit> . this study had the advantage of revealing variation in non-coding regions, and, together with the longer reads generated by  <dig> technology, sequence haplotypes could be inferred. however, cnv calling by read depth was not attempted and some sequence variants, particularly rare variants, were called with a small number of supporting reads, suggesting limited sensitivity of the approach. furthermore, only two european samples were sequenced, revealing a limited part of the total potential sequence variation of the region.

by comparing sequenced bacs, we have previously shown that sequence differences between different copies is localised particularly immediately upstream and downstream of genes, and this may result in expression differences between different copies of the same gene. indeed, both luciferase reporter studies in keratinocytes and expression in lymphoblastoid cell lines have shown that variation between different defensin copies affects expression of defb <dig> and of defb <dig>  <cit> . the single nucleotide variation affecting defb <dig> expression is within 1 kb immediately 5’ of the transcription start site, but the single nucleotide variation affecting defb <dig> expression is not known, except that it is tagged by a synonymous polymorphism rs <dig>  which is reported as common across all the continental groups studied here . our previous observations of increased sequence differentiation upstream of defb <dig>  together with its functional effect and the population distribution differences, have led us to suggest that natural selection has influenced expression levels of at least defb <dig>  <cit> . furthermore, given the gene dosage effect of copy number variation observed at this locus  <cit> , gene copy number results in variation in levels of protein which in turn provides a phenotype upon which selection can act. in contrast, in rhesus macaques  <cit>  and dogs  <cit>  it seems likely that amino acid sequence variation between copies has been subject to natural selection.

in africa, all variants that alter amino acids in the defensin genes are rare, but outside some of these variants have risen to increased frequency. in particular, a variant at defb105 , which disrupts the fifth canonical cysteine essential for disulphide bridge formation in the mature protein , is common in non-african populations . the functional consequences of this and other variants are not known, and await further study. it is likely that they are variants with little effect or null variants, resulting in proteins with reduced function. in the context of a multicopy gene, one or two copies with little or no function will have little consequence, particularly at higher copy numbers, therefore negative selection against such variants is likely to be weak, and indeed we could not detect any signature of selection using variant frequency distributions. an alternative view is that some variants may have alternative off-target effects, and that we have little power to detect selection at a small number of such variants. indeed given the known receptor promiscuity of defensins  <cit>  and the influence of structural changes on antimicrobial activity  <cit>  this is a possibility worth exploring in the context of novel therapeutic agents.

CONCLUSIONS
we have used exome sequence data from the  <dig> genomes project to call copy number for the human beta-defensin region on  <dig> individuals. we have also identified  <dig> sequence variants that differ between copies and between individuals, mostly rare, of which  <dig> are predicted to affect amino-acid sequence of one of the beta-defensin genes.

additional file
additional file 1: table s <dig>  frequency of rs <dig> and rs <dig> in the  <dig> genomes continental groups. 



competing interests

ejh has received grant funding from pfizer inc on a project unrelated to the project described in this paper.

author contributions

the work was conceived and designed by df and ejh. df and dm generated the data, and df, ejh, dm, ra and ms analysed and discussed the results. as provided nanostring ncounter data. the paper was written by ejh with all authors contributing and reviewing the final manuscript.

