BACKGROUND
the domestication process of crop plants led to dramatic phenotypic changes in many traits that result from changes in the genetic makeup of the wild species ancestors  <cit> . the analyses of genomic variation and the structure of genetic diversity of cultivated crops and their wild relatives provides insights into the history of domestication, adaptation to local environments, and breeding  <cit> . the resulting analyses offer valuable information for germplasm management and the exploitation of natural variation to improve crops.

cultivated tomato   is a member of the family solanaceae, genus solanum l., section lycopersicon  <cit> . its wild relatives are native to western south america, including the galapagos islands. s. pimpinellifolium l.  is thought to be the closest wild ancestor to cultivated tomato  <cit> . sp accessions are found in coastal peru and ecuador and are divided in three main genetic groups corresponding to the environmental differences found in the coastal regions of northern ecuador, in the montane region of southern ecuador and northern peru, and the coastal region of peru  <cit> .

s. lycopersicum is divided into two botanical varieties: s. l. var. cerasiforme  spooner, g.j. anderson & r.k. jansen  and s. l. var. lycopersicum . slc is native to the andean region encompassing ecuador and peru, but it is also found in the subtropical areas all over the world  <cit> . slc grows either as a true wild species, in home gardens, along roads, sympatrically with tomato landraces, or as a cultivated crop  <cit> . slc thrives in the humid environments of ecuador and peru at the eastern edge of the amazon basin whereas sp occupies the drier peruvian coasts and valleys and the wetter ecuadorian coast  <cit> . although there is no reproductive barrier between sp and slc  <cit> , the andes mountains impose strong physical and ecological barriers for cross reproduction among these species.

many details of tomato domestication remain debated, especially regarding the role of slc in this process. the south american slc native to the ecuadorian and peruvian andes has been proposed to be an evolutionary intermediate between sp and cultivated sll  <cit>  or, alternatively, an admixture resulting from the extensive hybridization between sp and sll  <cit> . the location of tomato domestication also remains uncertain. both mesoamerica  <cit>  or ecuador and northern peru, near the center of origin of sp  <cit> , have been proposed as the center of domestication. if the former were true, slc would have had to migrate north to mesoamerica as a wild or weedy species, where it would have been domesticated into sll. instead, a two-step domestication process has been proposed for tomato  <cit> . the first step would have consisted of a selection from sp or primitive slc by early farmers resulting in the ecuadorian and northern peruvian slc. the second step likely occurred in mesoamerica, and consisted of further selection from these pre-domesticated slc after their migration from ecuador and peru. this second step completed the domestication process of tomato. genetic data confirmed that european sll accessions originated from mesoamerica and constitute the genetic base of the sll vintage varieties  <cit> . it has also been proposed that a genetic bottleneck was associated with the migration of sll from mesoamerica to europe  <cit> . blanca et al.  <cit>  proposed that the main bottleneck happened during the migration from peru and ecuador.

extensive breeding efforts have modified tomato over the last 100 years. breeding goals were focused on improving sll for disease resistance, adaptation to diverse production areas, yield and uniformity. these efforts resulted in the introduction of many introgressions from sp and more distant tomato relatives  <cit> , leading to a broadening of the genetic diversity of sll  <cit> . another consequence of these breeding programs was the selection for specific traits that are characteristic of the fresh and processing markets which has led to further diversification and genetic differentiation among market classes.

the traits that most likely have been selected during the domestication of tomato were fruit weight and, to a lesser extent, shape. in recent years, several genes affecting these traits have been identified  <cit> . as the underlying polymorphism causing the change in allele function for all these genes is known, the presence of the derived and ancestral alleles is easily sampled. for example, in vintage sll the majority of the shape diversity is explained by the derived alleles of the fas, sun, ovate and lc genes  <cit> . what is not well understood is when and where these alleles arose and how they spread through the germplasm. quantifying the allele frequency of the loci among the sp and slc populations will help to elucidate the process of selection that is at the foundation of tomato domestication.

the aim of this study was to better delineate the evolutionary history of tomato including its domestication. by using a dataset with over  <dig>  snps and  <dig>  accessions of sp, slc and sll we aim to compare and contrast the genome-wide molecular diversity of populations spanning the entire red-fruited clade. additionally, the allele frequency of six fruit weight and shape genes have been measured in order to elucidate the domestication process.

methods
plant material and passport data
we analyzed  <dig>  tomato accessions from the species representing the red-fruited clade of tomato . of these,  <dig> corresponded to accessions genotyped in studies conducted at comav, spain  <cit> , through the solanaceae coordinated agricultural project  in the usa  <cit>  and inra, france  <cit> . these data sets were combined with an additional set of  <dig> accessions originating from vintage and processing germplasm genotyped in ohio , and from the comav collection . altogether, these  <dig>  accessions represent  <dig> uniquely named accessions. several accessions were independently genotyped in different experiments. for example, moneymaker was represented several times and these duplicates were used for quality control of the genotyping results between the laboratories. the number of uniquely named accessions per species, according to their passport data, were: solanum lycopersicum var. lycopersicum , s. l. var. cerasiforme , s. pimpinellifolium , solanum galapagense s.c.darwin & peralta , solanum neorickii d.m.spooner, g.j.anderson & r.k.jansen , solanum chmielewski  d.m.spooner, g.j.anderson & r.k.jansen , crosses between s. lycopersicum and s. pimpinellifolium , and one hybrid between s. l. lycopersicum and s. pennellii. the hybrids were included to determine the ability of detecting heterozygous snps with the genotyping platform.

a unified passport classification, which includes species name, collection site and use, was compiled for all accessions based on the information retrieved from the different sources and donors . for sp and slc, the passport classification mainly reflected the collection site. an additional category for slc was introduced as “slc commercial cherry” to group the slc accessions with a commercial purpose. for sll, the vintage, landrace and heirloom categories were grouped together and classified collectively as vintage consistent with the nomenclature of williams and st. clair  <cit> . additionally, a category was created in sll to include the early breeding lines such as moneymaker and ailsa craig. the sll accessions derived from crop improvement programs currently active  were categorized based on use  and location of breeding. overall, sufficient information was available for 84% of the accessions to classify them beyond the species level. in cases where this was not possible, the passport classification only reflected the species . for  <dig> % of the accessions, geographic location information was available in the form of global positioning system  coordinates or from the location of its collection site .

genotyping and data set merging
all samples were genotyped using the tomato infinium array  developed by the united states department of agriculture  funded solcap project . the solcap snp discovery work-flow was described  <cit> , as were details of the array  <cit> . the genotyping array contained probes for  <dig>  biallelic snps. these snps represented a highly filtered and selected set, based on transcriptome sequence for sll, slc, and sp, optimized for polymorphism detection and distributed throughout the genome. of these,  <dig>  snps  passed manufacturing quality control  <cit> . all snps on the array have been incorporated into the solanaceae genome network database , the snp annotation file is available , and sequences are available through the sequence read archive  at the national center for biotechnology information .

genomic dna was isolated from fresh young leaf tissue. dna concentrations were quantified using the picogreen assay  and diluted to 50 ng/μl in te buffer . genotyping was performed using 250 ng of dna per accession following the manufacturer’s recommendations. the intensity data were analyzed in genomestudio version  <dig> . <dig> . the automated cluster algorithm generated from the solcap project was used to obtain initial snp calls. visual inspection was used to assess the default clustering of each snp, and calls were modified when the default clustering of a snp was not clearly defined.

there are three methods for snp calling for the illumina infinium array: relative to the reference , the design  or the top strand . to merge data sets from three different laboratories that had used different snp calling methods, we developed a python script to facilitate detection, reorientation and merging of the data such that all snps are called relative to the design strand .

selection of snps for downstream analyses
the accessions were genotyped with  <dig>  snps  that passed the manufacturing quality control and constituted the raw data set. of those, we removed  <dig> markers  that had more than 10% missing data and  <dig> , which had a major allele frequency above  <dig> . for all analyses, except for the rarefaction and the linkage disequilibrium , snps that mapped closer than  <dig>  cm were removed as well, yielding a final dataset of  <dig>  markers uniformly distributed across the genome. this filtering was done in order to avoid an overestimation of polymorphism and genetic distances among populations due to genomic introgressions from wild relatives. for this purpose a minimum genetic distance of  <dig>  cm was chosen as a trade-off between the number of markers left for the analysis and the ld minimization. genetic distances were based on the genetic maps of sim et al.  <cit> .

genetic classification and sample filtering
principal component analyses  were used to explore the patterns of genomic variation in the entire collection without considering the a priori classification based on passport data . a three level classification scheme, based on a series of hierarchical pcas, was used to define genetic groups within species and genetic subgroups within genetic groups. pcas were performed with the smartpca application included in the eigensoft  <dig>  package  <cit> . this genetic classification was used in the subsequent analyses unless mentioned otherwise.

pairwise genetic distances were computed among accessions within each group at each level of the hierarchical classification. kosman and leonard’s distance method  <cit>  was used and a violin plot was produced for each hierarchy level using the r package ‘vioplot’  <cit> .

when an accession was genotyped more than once and both genotypes were inconsistent  all data for the accession was removed from the analysis , unless it was clear based on the passport information, which genotype was correct . in total  <dig> genotypes out of the  <dig>  were removed due to inconsistent data. we assume that these rare inconsistencies were related to uncontrolled cross pollinations or seed mixing during regeneration.

genetic distances among samples of the same uniquely named accession were evaluated  to check the reproducibility between genotyping datasets coming from different laboratories. for the genetic analyses, unless stated to the contrary, only one randomly chosen genotype representative of the uniquely named accessions was used.

diversity and genetic differentiation
for polymorphic loci with a major allele frequency lower than  <dig>  , the expected  and observed  heterozygosity were calculated using custom scripts for each hierarchy of the genetic classification. differentiation among genetic subgroups was explored by calculating differentiation index dest  <cit>  using custom scripts and fst using arlequin v.  <dig> . <dig>   <cit> . only groups with at least  <dig> individuals were considered for genetic diversity estimates and mixture groups  were not included in these analyses. statistical significance of dest and fst was assessed after  <dig>  permutations.

an unrooted network was built based on the genetic differentiation matrix using the neighbor-net algorithm implemented in splitstree v. <dig> . <dig>  <cit> . additionally, a neighbor-joining tree was created using the same distance matrix. bootstrap values were obtained from  <dig>  trees. the tree was built using functions included in pycogent v.  <dig> . <dig> library  <cit> .

allelic richness and private allelic richness  were estimated using the rarefaction method implemented in the software adze  <cit> . ld was calculated using tassel v. <dig>   <cit> . pairwise r <dig> was obtained for all markers within each chromosome and data was fitted using a local polynomial regression fitting   <cit>  implemented in r v.  <dig> . <dig>  <cit> . rarefaction and ld analyses were performed using genetic groups defined by pca and network analysis. these groups are defined as follows: sp, slc ecuador and northern peru, slc non andean, sll vintage and sll contemporary .

isolation by distance
correlations between genetic, geographic and climatic distances were analyzed to infer patterns of isolation by distance or the effect of ecological conditions on the genetic structure. pairwise genetic distances between accessions were computed using kosman and leonard’s distance method  <cit> . pairwise geographic distances were calculated when gps information was available using the haversine formula  <cit> . climatic data for accessions with gps coordinates was obtained using the r package ‘raster’  <cit> . current climatic data interpolated from  <dig> to  <dig> was obtained from worldclim  at  <dig> arc-seconds resolution . a pca was carried out with all the climatic information and the resulting scores were used to obtain the pairwise climatic distances based on a euclidean metric. significance of the correlations between distance matrices was assessed with a mantel test based on  <dig>  permutations implemented by the pycogent python library  <cit> . a density plot for each distance comparison was created using the kde2d function in the r ‘mass’ package  <cit> .

phylogenetic analysis
a phylogenetic tree was built with snapp  <cit>  to infer the evolutionary history of the tomato species in the andean region encompassing ecuador and peru. snapp, which is part of the beast package  <cit> , is a recently developed method that allows reconstructing the species tree from unlinked snps by using a finite-sites model likelihood algorithm within a bayesian markov chain monte carlo . a mcmc chain was run for  <dig> , <dig> steps with a sampling interval of  <dig>  and a burn-in of 25%. convergence of posterior and likelihood distributions, and number of estimated sample size for model parameters were assessed using tracer v. <dig>   <cit> . due to the high computational demands of snapp, only one accession per genetic subgroup was used. for the same reason, not all genetic subgroups were considered; only sp and peruvian, ecuadorian and mesoamerican slc accessions were included. three outgroup species were also included, namely s. galapagense, s. neorickii and s. chmielewski.

fruit weight and shape genes genotyping
six markers that distinguish wild type and causal derived alleles of the fruit shape loci  as well as the fruit weight loci  were genotyped . lc  and fas  control the number of locules, an important feature affecting fruit weight as well as shape.the gene lc is hypothesized to be an ortholog of wuschel which is required to maintain stem cell identity  <cit> . the fas mutation affects a yabby <dig> transcription factor which encodes a member of the family regulating organ polarity  <cit> . two genes exhibit a major effect on fruit shape namely sun  <cit>  and ovate  <cit> , positive and a negative regulators of growth, respectively. the fruit weight gene fw <dig>  negatively controls cell division and encodes a member of the cell number regulator  family  <cit> . fw <dig>  encodes an ortholog of kluh, a p <dig> enzyme which increases weight through increased cell number in pericarp and septum tissues  <cit> .table  <dig> 
fruit shape and size marker information



gene
primer sequence 
polymorphism
restriction enzyme
wild-type allele size 
cultivated allele size 
reference

fw <dig> /cnr

fw <dig> /slkluh

lc

fas

ovate

sun
*marker that is modified from the original.



all markers, except sun, were genotyped by amplification using standard pcr following previously published methods  <cit> . pcr products were scored directly  or after restriction enzyme-digestion  by electrophoresis on 3% tbe  agarose gels. the sun duplication was scored as an rflp using standard southern blotting and hybridization protocols  <cit> .

RESULTS
genetic structure of the tomato accessions
to detect patterns of genetic structure within the collection, we conducted a global pca  using  <dig>  selected snps. the graphical pattern of the first two principal components  is suggestive of an arch structure with the three edges corresponding to sp, slc and sll respectively. the small-fruited wild relative sp forms the left side, differentiated along both pcs. slc corresponded to the top of the arch and was also distributed along both pcs albeit less clearly than sp. sll accessions are differentiated only along pc <dig>  forming the right edge . additionally, a group of genotypes appeared in between the three main groups and they have been classified as mixture. the accessions in this region include all ten artificial sll x wild species hybrids and the accessions bgv <dig>  bgv <dig> and la <dig> are already classified as interspecific hybrids in their passport data, thus we have called this group “mixture”. the sp category was the most genetically diverse group , followed by slc  and sll  .figure  <dig> 
principal component analysis using all  <dig> uniquely named accessions and based on  <dig>  markers.

summary of genetic-based classification: observed and expected heterozygosity , percentage of markers with a major frequency allele lower that  <dig>   and number of individuals  for the species, groups and subgroups of the genetic-based classification 



species
group
subgroup
h
0
h
e
p95
n


to identify clusters within each species  and sub-clusters within each cluster , additional pcas were conducted in a hierarchical fashion with the accessions belonging to the same species . for sp, the first two pcs  showed that the sp ecuador, that comprises northern ecuadorian accessions, formed a separate genetic group from the other sp accessions . these ecuadorian accessions were further subdivided into three genetic subgroups: ecuador  <dig>  ecuador  <dig> and ecuador  <dig> . the remaining sp accessions were divided into two genetic groups: peru  and montane  . montane accessions were further subdivided into two genetic subgroups , whereas the peruvian accessions clustered into  <dig> categories . accessions located in an intermediate position in the pca were classified as sp mixture, and likely represent admixtures between sp accessions from different groups . these admixtures could be from naturally occurring hybridizations or the result of accidental outcrossing events during the handling of the accessions in germplasm collections or regeneration in seed banks. the genetic diversity among the three sp groups ranged from he =  <dig>   to he =  <dig>   .figure  <dig> 
principal component analysis for sp, slc, sll and sll mesoamerica and genetically close slc subgroups.
 sp,  slc,  sll and  sll mesoamerica and genetically close slc subgroups. solid lines encircle the main genetic groups and different colors and markers represent genetic subgroups.



for slc, the first two pcs explained  <dig> % of the total variance and showed a clustering based on geography . the ecuadorian and peruvian slc formed two non-overlapping clusters in the pca representation and showed a higher genetic diversity compared to sp ecuador and sp montane . an slc group which included accessions from all over the subtropical regions of the world was called slc non-andean, and was located between the two andean clusters . a distinct cluster named slc-sp peru was identified and composed of accessions from southern peru.

each slc genetic group could be further subdivided based on genetic structure. ecuadorian slc was split into four subgroups, three that divided ecuador latitudinally  and one that was named slc vintage since it mainly included accessions collected from south american markets as vintage tomatoes. interestingly, the slc vintage accessions often featured big fruits with many locules, a trait that may have been selected early for cultivation and consumption . the slc vintage accessions clustered closely, but separately, relative to the three ecuadorian genetic subgroups . the peruvian slc was divided into three subgroups that were named from north to south as peru  <dig>  peru  <dig>  and peru  <dig>  the slc non-andean group was subdivided into: colombia, costa rica, mesoamerica, sinaloa , south east asia and other representing the rest of the subtropical regions of the world .figure  <dig> 
tomatoes from slc vintage subgroup .




similarly to sp, slc accessions without a clear genetic clustering and without a common geographic origin were classified as slc mixture. these mixture accessions were distributed between the peruvian and ecuadorian slc clusters in the pca . in addition, closely related to the slc non-andean were seven accessions with no obvious relationship according to the passport data and were referred to as slc  <dig> 

the pca for the sll accessions showed that the first two pcs  separated five main genetic groups: vintage, fresh, processing  <dig>  processing  <dig> and sll  <dig> . all sll groups had low diversity  compared with the peruvian and ecuadorian slc  . the sll vintage group was divided into subgroups that were differentiated using additional pcas: mesoamerica, vintage  <dig>  vintage  <dig> and early breeding lines . the sll fresh group was comprised of the subgroups fresh  <dig>  fresh  <dig> and vintage/fresh . the latter subgroup was named vintage/fresh because it included accessions classified as vintage as well as contemporary breeding fresh market accessions. the sll fresh  <dig> was composed of florida and north carolina accessions while sll fresh  <dig> consisted of accessions from new york . the sll processing  <dig> group was subdivided into three groups, 1– <dig>  1– <dig> and 1– <dig>  the latter group was comprised of a subset of accessions from the ohio breeding germplasm whereas the remainder of the ohio germplasm was found in the sll processing 1– <dig> subgroup. the processing 1– <dig> included accessions from oregon. the group sll processing  <dig> was clearly separated from the other processing groups. this group was entirely composed of new york breeding materials which represent a predominately california genetic background with phytophthora resistance introgressed from north carolina fresh-market accessions. finally, the sll <dig> group was located between sll processing  <dig> and sll fresh in the pca  and was comprised by a mixture of accessions such as the plum tomatoes rio grande and nc ebr- <dig> 

to determine the consistency of the structure obtained by pca analyses, we compared the distribution of genetic distances within the following hierarchy levels: species, genetic group, genetic subgroup and samples of the same uniquely named accession . as expected, the species showed the highest distances whereas the groups and subgroups showed progressively lower genetic distance values. all pairwise genetic differentiation among subgroups assessed by fst and dst were significant  . the distance among repeated samples of the uniquely named accessions was very low indicating a high consistency among genotyping experiments.

comparison of the genetic and passport classifications
the genetic classification derived from the pcas was compared with the passport-based classification and demonstrated overall good agreements . most disagreements were in slc followed by sll . one striking difference between the two classifications occurred for  <dig> slc accessions that were located in the pca between slc and sll and classified as mixture . these accessions included many of the commercial cherry tomatoes. these data imply that most cultivated cherry tomatoes are not true slc.figure  <dig> 
comparison between the passport-based classification  and genetic-based classification . the genetic classifications correspond to the clusters shown in additional file 1: table s <dig> and, passport classification is based on information provided . size of the squares is proportional to the number of samples corresponding to each genetic and passport group and, background colors highlight different species and botanical varieties.



one of the other notable exceptions to the correspondence between genetic and passport classification was the subgroup comprised of accessions that were listed as sll vintage, but instead were genetically classified as a slc group closely related to slc ecuador. this cluster was classified as slc vintage and consisted of genetically diverse germplasm that included accessions collected mostly at south american markets.

population relationships
to determine the relationship between all subgroups, we constructed a neighbor network and population phylogenetic tree reflecting subgroup relationships based on dst distances . all sp subgroups clustered together presenting a latitudinal ordination from south to north in both the network and the phylogenetic tree. little reticulation appeared in sp compared with slc and sll in the network, suggesting less gene flow between subgroups in sp. the closest to slc in the network were the sp montane  <dig> and sp ecuador  <dig> subgroups. the group slc-sp peru was located at a genetic position between ecuadorian slc and sp and appeared to be the result of an admixture between these two species. within slc, groups that were found in close geographical proximity also tended to cluster together. the neighbor network showed two plausible paths for the evolution of slc to sll: 1) slc ecuador  <dig>  slc colombia, slc costa rica, slc mesoamerica; and 2) slc peru  <dig>  slc peru  <dig>  slc peru  <dig> and sll mesoamerica . sll groups also showed that sll vintage and early breeding lines are genetically closely related to mesoamerican sll. the sll fresh and sll processing subgroups were more distant from the mesoamerican and vintage sll with evidence of reticulation. in general, the accordance between the proposed hierarchical genetic classification which is represented in the neighbor network and the population tree was high .figure  <dig> 
neighbor network for the genetic subgroups; neighbor network based on genetic distances  for the genetic subgroups.
 complete network and  close up of the region squared in panel a. only subgroups with more than  <dig> individuals are represented. different colors represent genetic groups.



the accession-based phylogenetic tree that included s. chmielewski, s. neoricki and s. galapagense  showed that the peruvian sp groups were basal for the red-fruited group, and ecuadorian sp was phylogenetically the closest to slc with slc ecuador  <dig> basal to the entire slc. interestingly the s. galapagense  accession clustered very close to the ecuadorian sp, a grouping which was also found in the pca .figure  <dig> 
phylogenetic tree based on snp data. phylogenetic tree based on snp data computed with bayesian based snapp algorithm. posterior support of nodes is shown.



isolation by distance and climate
we noted that most clusters in sp and slc corresponded to the location of where the accessions were collected. therefore, we sought to evaluate the significance of this finding by calculating the correlation between genetic, climatic and geographic distances . the highest correlation was found in sp indicating a strong positive correlation between genetic and climatic distances , as well as for genetic and geographic distances  . two sets of accessions were explored in slc, one including the subgroups from ecuador and northern peru and the other including slc non-andean. for the ecuadorian and northern peruvian slc, the relationship between genetic and climatic distances was lower  than in sp, whereas the genetic versus geographic was similar . when considering the slc accessions together, a low correlation between genetic and climatic  as well as genetic and geographic distances  were observed.table  <dig> 
isolation by distance and climatic distance: correlation between climatic, geographic and genetic distances in sp, slc ecuador and northern peru and slc non-andean: number of accession , correlation coefficient  and p-value for mantel test is shown


climatic vs. genetic
geographic vs. genetic

n
r
p-value
n
r
p-value

sp

slc ecuador/n peru

slc non-andean


diversity and heterozygosity
expected heterozygosity  and observed heterozygosity  decreased in the succession from sp to slc and sll . for sp, the sp peru group retained the highest diversity followed by sp montane and sp ecuador. the ecuadorian and peruvian slc  showed higher level of diversity  compared to sp ecuador and sp montane. in contrast with the high diversity of the ecuadorian and northern peruvian slc, the other slc subgroups exhibited low diversity, similar to that found in vintage sll. for sll a similarly low level of observed heterozygosity was typical for most subgroups. however, when combining the contemporary sll subgroups , slightly higher levels of diversity were found when compared to sll vintage , a situation that is likely due to the effect of introgression during breeding and differentiation into distinct market classes .

to avoid biases in the genetic diversity estimates due to the different number of individuals per group, a rarefaction analysis was carried out . to explore whether genetic diversity estimates might be inflated due to introgressed genomic segments from wild relatives present in contemporary sll accessions, we conducted parallel analyses with two sets of markers. the first set included one marker every  <dig>  cm   and the second set included  <dig>  snps, after removing monomorphic snps and snps with more than 10% of missing data  . when using the smaller marker set, the average number of alleles per locus of sp and the combined set of slc northern peru and ecuador was higher than in all other clusters . when all markers were used, the sll fresh and sll processing showed an allele richness that was intermediate between andean slc and sp on the one hand, and non-andean slc and sll vintage on the other . when all sll contemporary accessions were combined into one group, the analysis with the smaller marker set showed a slight increase in allelic richness compared to separate analyses of the sll processing and sll fresh genetic groups . using all markers, the allelic richness of the combined contemporary accessions approached that of sp . these findings suggested that introgressions found in the contemporary accessions might lead to increased estimates of genetic diversity but also that differentiation into distinct market classes increased genetic divergence within sll. frequency of private alleles was also explored for the subset of markers  and the whole dataset . the highest proportion of private alleles was found in sp regardless the marker dataset used, whereas the number of private alleles was virtually the same for all other groups, except for the processing group when using the complete marker set. this finding might indicate the presence of introgressions from genetically diverse relatives in sll processing.figure  <dig> 
rarefaction analysis of the number of alleles per locus and frequency of private alleles. rarefaction analysis of the number of alleles per locus  and frequency of private alleles  for sp, slc andean , slc non-andean, sll vintage, sll fresh and sll processing for two sets of markers. a and c show the results for a set of  <dig>  markers spread at least  <dig>  cm and b and d for  <dig> snps . include which genetic subgroups are included in each category.



ld was estimated between markers at different genetic distances from one another . from highest to lowest degree of disequilibrium the groups were: fresh, processing, vintage, andean slc, non-andean slc and sp. these results suggest that ld affects estimates of allelic richness, especially when dealing with groups with different degrees of ld.

origin and migration of the derived tomato fruit shape and weight alleles
several genes involved in the transition from small and round to large and variably shaped tomato have been cloned in recent years. in all cases, the nucleotide polymorphism that is associated with the change in fruit appearance is known. we wanted to investigate when and where the derived alleles of the six fruit shape and weight loci arose and how they migrated through populations in the evolution of tomato. for all fruit morphology loci, the derived allele was at very low frequency or not found in the sp accessions . the derived alleles for the fw <dig>  and lc loci were both found at very low frequency in sp ecuador but at much higher, 55% or more, frequency in the andean slc groups . the lc mutation was also common in sll vintage and sll fresh accessions whereas the derived allele was not found in the sll processing types. the derived allele of fw <dig>  was nearly fixed in all sll groups. for fw <dig> , the derived allele was found in slc ecuador and slc peru albeit at lower frequency compared to lc and fw <dig> . fixation of the derived allele did not occur in the sll vintage but instead became nearly complete in the contemporary sll accessions. the derived alleles of fas and ovate were most likely to have arisen in the ecuadorian or peruvian slc accessions and were maintained at low frequency in the remaining slc accessions. of the sll vintage,  <dig> and 30% carried the derived alleles of ovate and fas, respectively. in other sll groups, the derived allele for ovate and fas were found at low frequency in this dataset. however, the derived allele of ovate is quite common among italian vintage cultivars where  <dig> to 47% of the accessions carry the mutation  <cit> . sun is present at low frequency in sll vintage, fresh and processing whereas the allele has neither been detected in ecuadorian and peruvian slc nor in the mesoamerican accessions.figure  <dig> 
fruit weight and shape gene frequencies across genetic groups. ancestral allele in blue, derived allele in red. black lines show binomial confidence intervals at 95%.indicate which genetic subgroups are pooled in each category.



discussion
key questions regarding the evolutionary history of cultivated tomato include where and when the crop was domesticated and the position of slc in this evolutionary process. in this study, we interrogated a selection of  <dig>  snps from the solcap array in nearly  <dig>  unique accessions comprised of sll, slc and the red-fruited wild relative sp. by combining accessions with robust passport data we were able to test hypotheses about the origin of cultivated tomato. our results support the two-step domestication hypothesis proposed by blanca et al.  <cit> , and are in line with recently published work about the origin of tomato  <cit> . as expected, genetic diversity was high in sp , and genetic clusters were explained by geographic distances and climatic zones . the higher number of sp accessions analyzed when compared with previous studies has allowed a more detailed definition of the sp populations, especially in southern peru, where sequential colonization could be proposed based on the pca  and the network analysis . slc accessions from ecuador and peru also showed genetic structure that correlated with geography . genetic diversity was high in ecuadorian and peruvian slc, but was reduced in slc from mesoamerica and elsewhere. our results suggest that the major genetic bottleneck did not occur due to transport of sll from mesoamerica to europe, but occurred earlier coinciding with the migration of slc from ecuador and northern peru to mesoamerica . in wild populations there is a strong correlation between geography, climate, and genetic distances . these correlations do not occur in the non-andean slc and the sll genetic subgroups, a situation that is common for plants associated with human activities, either cultivated or weedy, due to the movements of the seeds by the humans and to the artificial modifications or their environments  <cit> .

phylogenetic relationships
the phylogenetic tree , neighbor network analyses  and the high number of private alleles  support the status of sp as the basal group of the red-fruited species of the lycopersicon section. our data also supports the view that the northern ecuadorian sp is the closest ancestor of slc. northern ecuadorian slc was likely to have originated from ecuadorian sp, yet its high genetic diversity and its reticulate structure in the phylogenetic network suggests a complex history. the position of sg within sp contrasts with a recent study  <cit>  in which sg was found to be closer to slc than sp. however, firm conclusions about the position of galapagos accessions will require further study, as both studies, koenig’s et al. and the present one, are based on a few number of accessions and koenig et al. lacked sp accessions from ecuador.

the data suggest two possible scenarios for the origin of slc. ecuadorian slc features twice the level of the genetic diversity as ecuadorian sp , thus it is not likely that slc was simply derived from this sp subgroup, despite being very close phylogenetically. one hypothesis is that the subgroup named peruvian slc-sp represents the origin of slc. this genetic subgroup is also close genetically to ecuadorian sp . however the large geographic distance separating these subgroups challenges this scenario. it is possible that the peruvian slc-sp is the result of a secondary contact between slc and sp. the second hypothesis is that ancestral populations of northern ecuadorian coastal sp gave rise to slc in northern ecuador across the andes. secondary gene flow between other sp populations, suggested by the reticulation of the phylogenetic network and the complex pca structure, e.g. montane sp from southern ecuador and northern peru may have enhanced diversity of the slc. alternatively, the sampling of northern ecuador sp may have been incomplete or an ancestral highly diverse population might have originated both northern ecuadorian sp and slc. ecologically, it is more plausible that slc originated from northern ecuadorian sp. these northern ecuadorian sp accessions thrive in wet and forested areas of coastal ecuador, a climate closer to the wet environment on the eastern side of the andes where ecuadorian slc is found. in contrast, peruvian sp is adapted to an arid climate. climatic similarity of some sp and slc populations may have facilitated gene flow due to animal or human movement, despite geographic differences. previously, possible mechanisms for gene flow between sp and slc have been proposed for this region  <cit> .

the mesoamerican sll vintage subgroup appeared to be the most ancestral sll according to the phylogenetic trees and the network. this sll genetic subgroup was closely related to slc peru  <dig> in the phylogenetic network and tree. thus, our data clearly support that slc evolved into mesoamerican sll. according to the analyses with this dataset, all other sll are monophyletic and all sll groups originated from the sll mesoamerican accessions.

proposed origin and domestication based on derived alleles for fruit weight and shape
the most ancestral slc is found in ecuador and northern peru and it is characterized by a high genetic diversity and morphological variability  <cit> . it spans a wide range of domestication  and use , which suggests a certain degree of selection for slc. this finding is supported by the fact that the derived alleles of lc, fw <dig>  and fw <dig>  are already prevalent in the ancestral slc accessions from northern peru and across ecuador . the derived allele of lc and fw <dig>  may have originated in the ecuadorian sp and could represent the earliest known mutations to arise. however, this interpretation needs to be viewed with caution as only two sp accessions carrying a single derived allele of each locus were identified . interestingly, the slc vintage group that clusters closely with ecuadorian slc included accessions that were collected from markets and feature fruits that are large, ribbed and multi-loculed . the strongest selection may have taken place in this subgroup as all accessions carried the derived alleles for lc, fw <dig>  and fw <dig> , and half of them carried the derived allele of fas . none of the other slc subgroups were fixed for as many fruit weight and shape alleles as the slc vintage category. thus it appears that slc was being cultivated and that selections for larger fruit were taking place . slc mesoamerica carried derived and ancestral alleles for most of the fruit shape and weight loci, while slc asia and slc other were completely fixed for the derived allele of fw <dig>  suggestive of selection for the slc germplasm grown outside the americas.

sll arose in mesoamerica as there is no evidence of the existence of ancestral sll in south america. all sll accessions sampled from south america were found to carry introgressions from wild relatives suggesting that they were derived from breeding efforts taking place in the last 100 years. therefore, to complete the domestication of sll, slc would have had to migrate to mesoamerica possibly as a semi-domesticated type. according to the network analysis, pca results, and previous knowledge of species history two slc migrations could be suggested. slc could have migrated from southern ecuador to colombia and costa rica arriving in mesoamerica in a stepwise process . however, a second possibility is also suggested by our results, slc could have reached mesoamerica from northern peru in one step. fruit weight and shape allele distribution did not support one route of migration over the other. in any case, results from the gene diversity analysis suggest that the migration from the ecuador or northern peruvian region to mesoamerica led to a strong bottleneck which eventually resulted in reduced variation in mesoamerican sll, as described by blanca et al.  <cit> . the second phase of tomato domestication in mesoamerica is suggested by the increase in derived allele frequency for fw <dig> . allele frequencies for fruit weight loci suggest that selection for fw <dig>  and lc were important for the origin of slc while fw <dig>  was important for the origin of sll. our results agree with a recent study  <cit>  based on  <dig> tomato genomes. they also find evidence for a two-step domestication, and identify new qtls implicated in both steps of domestication and breeding.

the american origin of the first european tomato is confirmed by the genetic relationship between the mesoamerican and vintage sll subgroups . it is remarkable that the vintage sll appears to have been derived exclusively from mesoamerican germplasm. although large fruited vintage slc were found in south america, they did not appear to contribute to the germplasm that migrated to europe and the rest of the world. it is not possible with the current data to know why the ecuadorian and peruvian slc did not contribute to the spanish vintage gene pool brought to europe, despite being those regions also under the control of the spaniards, but we could propose that climatic similarity between mexico and spain could have played a role.

contemporary tomato diversity
since the introduction of the modern breeding in the 20th century, the pace of genetic change in sll has accelerated. new germplasm has been created that, according to the pca, network and population tree, differ substantially from the vintage accessions. these results are consistent with previous findings  <cit> . the contemporary tomatoes can be differentiated into four broad groups: fresh, processing  <dig>  processing  <dig> and sll <dig>  this broad differentiation among the contemporary groups reflects independent breeding efforts and selection histories between the fresh and processing accessions. the further subdivision of the contemporary groups can be explained by geographic origin or founder effects in regional breeding programs. similar results were previously reported by sim et al.  <cit> . these subgroups differentiate accessions coming from the main public-sector breeding programs in north america. for processing they were historically carried out in california, the midwest of the united states, the east coast of the united states and ontario, canada. these programs commonly interchanged breeding materials, thus it is to be expected that the genetic groups mix those origins, albeit in different proportions  <cit> . the neighbor network reticulation found in these subgroups is compatible with this history .

contemporary tomatoes are the result of introgressing genes from wild species into sll starting before  <dig>  <cit> . the pca and rarefaction analyses  provided insight into the effect of these breeding practices on diversification and structure of the cultivated species, showing the existence the large introgressions as has also been described recently  <cit> . when we consider all contemporary accessions as a single gene pool , they represent a slightly more diverse population than the vintage tomatoes  . however, the differential overestimation of the gene diversity estimates within sp, slc and sll depending on the number of markers used, should be taken into account in future studies, especially now that thousands of markers are routinely being used in genotyping by sequencing  and whole genome sequencing experiments. contemporary breeding seems to have moderately increased the variation and diversity in cultivated tomato, although it remains low when compared with the most ancestral slc subgroups. these ecuadorian and peruvian accessions may represent a pool of unexplored variation for future improvement.

the distribution of the fruit weight and shape alleles is skewed in processing and in fresh market classes of sll, suggesting high selection pressures of shape loci for each market class. in contrast, the distribution of these alleles is more varied in the vintage group which is why this class is characteristically variable in shape and weight  <cit>  while contemporary material is quite uniform  <cit> . the observation of more phenotypic diversity for shape and weight, and more allelic diversity for these six loci in the vintage class appears to contrast with the observation of more genetic diversity in the contemporary germplasm. contemporary market classes are bred for uniformity of shape and weight within a class, as reflected by the allele distribution for lc, fas, fw <dig>  and fw <dig> . at the same time there are numerous resistances that have been bred into germplasm, with any given accession having multiple introgressed alleles that are missing from the vintage class, hence increased genetic diversity instead of phenotypic diversity in the contemporary class.

CONCLUSIONS
this work represents an effort to show a comprehensive view of genomic variation in tomato and closely related species. we have analyzed and classified  <dig>  tomato accessions, including the complete set of its closest wild relative, s. pimpinellifolium. the data are an excellent resource for evolutionary biologists and plant breeders. our analysis support a two-step domestication as proposed by blanca et al.  <cit> ; a first domestication in south america and a second step in mesoamerica,. the distribution of fruit weight and shape alleles also supports these two steps and shows that domestication of slc occurred in the andean region of ecuador and northern peru. the definition and clarification of the biological status of slc is also an important result of this work.

availability of supporting data
all supporting data are included as supplementary files.

additional files
additional file 1: table s <dig>  sample list, passport data and genotyping data for fruit shape and weight . a, wild allele; b, derived allele and a/b, heterozygous.

additional file 2: table s <dig>  genotyping data.

additional file 3: figure s <dig>  principal component analysis for sp. same legend as figure  <dig> 

additional file 4: figure s <dig>  principal component analysis for slc. same legend as figure  <dig> 

additional file 5: figure s <dig>  principal component analysis for sll. same legend as figure  <dig> 

additional file 6: figure s <dig>  geographical distribution of genetic sub-groups in  the andean region,  mesoamerica and of  species all around the world. same legend as figure  <dig> 

additional file 7: figure s <dig>  pairwise genetic differentiation between accessions and within genetic groups; violin plot showing the distribution of pairwise genetic differentiation between accessions and within each genetic groups at different hierarchy levels of the genetic classification. pairwise distances among different samples of the same accession are shown.

additional file 8: figure s <dig>  neighbor-joining tree based on the population distances measured as dest among genetic subgroups. bootstrap values based on  <dig>  trees are shown. branches with a bootstrap support lower than  <dig> have been collapsed.

additional file 9: figure s <dig>  correlation among genetic and climatic distance  and genetic and geographic distance  for sp accessions, slc accessions from the andean region and all slc accessions. solid lines show the result of the linear regression model. different colors represent the density of comparisons.

additional file 10: figure s <dig>  observed and expected heterozygosity  for the species  and groups of the genetic-based classification .

additional file 11: figure s <dig>  rarefaction analysis of the number of alleles per locus and frequency of private alleles. rarefaction analysis of the number of alleles per locus  and frequency of private alleles  for sp, slc andean , slc non-andean, sll vintage and sll contemporary  for two sets of markers. a and c show the results for a set of  <dig>  markers spread at least  <dig>  cm and b and d for  <dig> snps . include which genetic subgroups are included in each category.

additional file 12: figure s <dig>  linkage disequilibrium  measured as r
 <dig> for sp, andean and non andean slc and vintage, fresh and processing sll against genetic distance between snp markers within each chromosome. curves represent the resulting fits to a loess model.



josé blanca, javier montero-pau, esther van der knaap and joaquín cañizares contributed equally to this work.

competing interests

the authors declare that they have no competing interests.

authors’ contributions

jb, jc and evdk conceived and designed the study; cs, gb, df, mc, jb, mjd, jc provided solcap data; evdk, ei, jc, jb provided fruit weight and shape loci genotype data; jb, jm-p and jc performed the analysis; jb, jm-p, evdk, df and jc drafted the manuscript; all authors critically reviewed and approved the final manuscript.

we are grateful to the gene banks for their collections that made this study possible. we thank syngenta seeds for providing genotyping data for  <dig> accessions. we would like to thank the supercomputing and bioinnovation center  for providing computational resources to process the snapp phylogenetic tree. this research was supported in part by the usda/nifa funded solcap project under contract number to df and usda afri 2013-67013- <dig> to evdk and df.
