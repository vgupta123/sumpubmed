BACKGROUND
serial analysis of gene expression   <cit>  is a widely used method for transcriptome analysis. this technique has been successfully used for the analysis of a variety of biological phenomena, by investigating the expression level of previously characterized mrnas  <cit> . it has also permitted the study of important structural characteristics of the human genome such as co-expressed gene clusters  <cit> . more recently, a sage library construction pipeline has been described  <cit> , that allows to generate high-quality digital gene expression profiling data.

the sage method consists of sequencing small tags derived from the 3' ends of mrnas. a crucial step in sage analysis is tag identification  <cit> , or finding the transcript from which each tag was derived. the original sage protocol  <cit>  produces  <dig> bp tags that can be mapped to a set of transcribed sequences with known 3' ends  <cit> . using known transcripts, several studies have shown that  <dig>  to  <dig> % of human transcripts have unique sage tags  <cit> . this proportion is possibly a slight overestimate, because not all human transcripts have yet been annotated. to annotate such new transcripts, it is necessary to directly map the tags to the human genome sequence. however,  <dig> bp sage tags are too short to be reliably mapped only once to the human genome sequence, to the region from which the tag was derived. in contrast,  <dig> bp tags generated by a modified sage protocol called longsage  <cit>  can be identified by mapping them directly to the human genome sequence  <cit> . indeed, if we assume a simple model in which the nucleotides are randomly distributed along the genome sequence, and the four bases are equally abundant, each  <dig> bp tag should map spuriously on average  <dig> times to the human genome l)n where l =  <dig> is the tag length and n =  <dig> . <dig>  represents the sum of the lengths of the mitochondrial and nuclear genomes. therefore, p =  <dig> ). for a longsage tag of  <dig> bp, this probability of a spurious match is much smaller . therefore the longsage tags are much more specific than  <dig> bp sage tags, even if the specificity of longsage tags is not as high as these theoretical calculations suggest, as nucleotides are not randomly and equally distributed along the genome sequence, and the genome contains many repetitive sequences.

a systematic annotation of new transcripts by mapping a library containing  <dig>  of these longsage tags to the human genome sequence revealed  <dig>  exons that are not currently described, at least half of which belong to novel genes  <cit> . more recently, this longsage technique has been used to generate mouse libraries, and the analysis of these libraries provides evidence for the existence of about  <dig>  previously undescribed transcripts  <cit> . to find new transcripts, several recent microarray analyses assayed transcription at regular intervals in  <dig> human chromosomes. they confirmed the existence of a large amount of transcription outside the boundaries of known genes. these new transcripts may double the number of genes compared to current annotations  <cit> . because these new transcripts tend to be weakly expressed and non-conserved between human and mouse  <cit> , it has been argued that they correspond to spurious transcripts. however, transposable elements are excluded from some of these new transcripts, which confirm that some of them are functional  <cit> . but a comparison of several microarray studies has shown that a rather low percentage of positive probes overlap between experiments, suggesting either a non-negligible false positive rate or a high specificity of different microarray platforms and tissues analyzed  <cit> .

for this reason, we propose to study this question across the whole human genome using an independent method. we exploited the advantages of the longsage method to study the transcriptome without a priori knowing the transcribed sequences. we made a comprehensive study of all tags from all publicly available human longsage libraries deposited in the public gene expression omnibus databank. most of the studies using  <dig> bp sage tags have focused on the expression of known genes. by contrast, here we concentrated on the tags that have not been generated by known transcripts. because the main difficulty in estimating the amount of transcription in the human genome seems to be the false positive rate of detection  <cit> , we first carefully filtered our dataset and checked the reliability of the remaining tags. after having discarded the tags likely to contain sequencing errors from our dataset, we observed that an unexpectedly large number of tags do not match the genome sequence. we demonstrated that some arise from murine contaminants, polya tails, junctions between two exons, or polymorphisms. several arguments lead us to conclude that the remaining tags probably arise from sequencing errors. we estimated therefore that the rate of sequencing error is higher than previously thought. we then studied the tags that map uniquely to the genome, and we showed that 31% of them are located in parts of the genome that are still to be annotated. among the others, nearly one half correspond to antisense transcripts or to new variants of known transcripts. this shows that the human transcriptome is much more complex than shown by the current genome annotations.

RESULTS
selection and mapping of reliable tags
we used all the tags available in the public human longsage libraries of the gene expression omnibus database  <cit> . this corresponds to  <dig> libraries, generated mainly from stem cell lines or tumoral tissues, but also from several normal tissues . by pooling the tags from all these libraries, we obtained a dataset of  <dig> , <dig> tags, corresponding to  <dig>  different tags . we will hereafter refer to the frequency of tags by comparison to this number of different tags.

tags present only once in the libraries
to be able to predict with sufficient confidence which regions of the genome have generated these sage tags, we selected a reliable set of tags from this total dataset. for this purpose, we first considered the tags present only once in our dataset, that have therefore been observed only once in a single sage library. some of these infrequent tags correspond to very weakly expressed transcripts. others, however, may be incorrect because they have undergone sequencing error during the construction of sage libraries. tags occurring only once represent 13% of the total dataset, and a large proportion  of the different tags. this proportion is not negligible, but as some of these tags, unfortunately, may be incorrect, we checked the reliability of this set of tags before including it in our analysis.

as mentioned above, the probability that a  <dig> bp sequence spuriously matches the human genome sequence is very small : if the subset of tags occuring only once in the total dataset contained many incorrect tags, it should therefore be enriched in unmapped tags. we therefore mapped each tag to the human nuclear and mitochondrial genome sequence, and compared the tags occurring only once in the sage libraries and the tags occurring more than once. among the subset of tags occurring only once, 73% are unmapped. in contrast, in the other pool of tags, significantly less tags  have not been localized.

each transcript generates several tags, that could either be correct or incorrect after sequencing: a large majority of these tags are correct, but a small number are incorrect tags containing one or more sequencing errors. for each incorrect tag present in our dataset, it should be possible to recover somewhere else in our dataset the corresponding correct tag, without sequencing error. thus, for each tag which is present only once and does not match the genome sequence, we checked whether we could find in our dataset another tag matching the genome sequence and identical to this tag apart from one or two base pairs . for 69% of the unmapped tags occurring only once, we found at least one mapped variant. this frequency drops to 33% in the subset of unmapped tags occurring more than once in our dataset.

in conclusion, these results suggest that the subset of tags occurring only once is particularly enriched in incorrect tags resulting from sequencing errors. we have therefore chosen not to include these tags in our analysis.

tags present more than once but due to sequencing error
excluding tags that are present only once does not eliminate all tags containing sequencing errors. indeed, the same error could occur several times . we tried therefore to eliminate incorrect tags that occur more than once in the libraries.

for this purpose, we implemented the algorithm proposed by colinge and feger  <cit>  . to our knowledge, this is the most appropriate method to find possible erroneously sequenced tags in the absence of the corresponding sequence chromatograms. if each tag has the same probability to be erroneous , we expect the number of incorrect tags generated by a transcript to be proportional to the total number of tags generated by this transcript. then, given the number of occurrences of a given tag t, we can evaluate the number of variants derived from this tag t by sequencing errors. we identified the set of tags corresponding to all the variants of t , insertion or deletion), and determined for each variant whether it was rare enough to be only due to sequencing error. if so, the variant was discarded from the dataset.

ultimately, by eliminating tags present only once and tags occurring more than once but probably erroneous, we removed on average  <dig> % of the tags per library. after this filtering step, our set of reliable tags contained  <dig> , <dig> tags, corresponding in total to  <dig>  different tags.

mapping the tags to the genome
saha et al have already shown that most of the longsage tags that match several positions in the genome sequence correspond to duplicated genes or tandem repeats  <cit> . using tags from chicken longsage libraries constructed in our laboratory , we observed that the fraction of chicken tags that match several positions in the chicken genome sequence is much smaller  than human tags in the human genome . this is consistent with observations showing that the frequency of repeated sequences and duplicated genes is smaller in the chicken than in the human genome  <cit> .

we will now focus on the two remaining sets in figure  <dig>  unmapped tags and tags that map once to the genome. each of them raises a specific question. what is the origin of the unmapped tags? and do all uniquely mapped tags correspond to annotated transcripts?

analysis of tags that do not map to the genome
because we tried to remove tags generated by sequencing errors, we expected to see only very few unmapped tags, and not  <dig> tags, which corresponds to 36% of the total set of different tags. we therefore tried to understand why these tags were present in the longsage libraries. we first checked different possibilities that would explain why several tags generated by human mrnas do not map to the genome, for instance, tags overlapping two exons, tags extended into the polya tail and tags that differ from the genome sequence because of polymorphism. the results, presented below, are summarized in figure  <dig> 

tags overlapping two exons
tags that do not map to the genome could correspond to tags overlapping two exons. we computed the expected proportion of such tags using a set of transcripts with reliably annotated exons. for this purpose, we extracted in silico tags from  <dig> transcripts annotated in refseq . in these sequences, 3% of the tags overlap two exons.

among the tags from our dataset that do not map to the genome, we found that  <dig> different tags overlap two exons, by using ensembl annotations. these tags correspond to 1% of our initial set of tags. this proportion is slightly lower than the expected value, no doubt because the quality of annotations for all transcripts is not as high as in the set of refseq transcripts.

tags extended into the polya tails
tags containing part of the polya tail can also not be mapped to the genome sequence. we computed the expected proportion of such tags using a set of transcripts for which the polya tail is known. for this, we extracted in silico the longsage tag from  <dig> refseq transcripts  : 6% of these tags extend into the polya tail.

to estimate the frequency of such tags in our dataset, we mapped these tags to all human ests available in dbest  <cit> . we also considered each tag ending in base "a", because they may extend into the polya tail. for each of these tags, we extracted the set of est sequences containing this tag, and then we trimmed these sequences to obtain the parts downstream of the tag. we then computed the frequency of "a" in these fragments, and considered the tag to extend into the polya tail if this frequency exceeded 70% in at least one of these fragments. using this method, we found that  <dig> tags unmapped to the genome extend into polya tails, which corresponds to  <dig> % of our initial set of tags. this proportion is lower than the expected value , almost certainly because not all unmapped tags could be mapped to an est sequence and the polya tail is not sequenced on the 3' end of every est sequence. however, as the position of the polya tail is not exactly the same in each mrna corresponding to the same gene, the refseq and est sequences only represent one possibility for the position of the polya tail. therefore, our estimates of the expected and observed proportions of the tags that contain a polya tail are likely to be underestimates.

tags containing polymorphic positions
unmapped tags may also be due to the presence of a polymorphic region of the genome , if the allele sequenced in the genome project differs from the allele of the individual used to construct the sage library. it has previously been estimated that any two copies of the human genome differ from one another by approximately  <dig> % of nucleotide sites   <cit> . therefore, the probability p that a given tag contains no snp is p =  <dig>  and the expected proportion of tags with at least one polymorphic site is roughly 2% .

we searched for the presence of such tags among our set of unmapped tags. for this purpose, we used a dataset computed using a previously published method  <cit>  : unigene cluster sequences were searched for the presence of snps , either within the tag sequence or within the restriction enzyme site used for sage library construction. by using this dataset, we found that  <dig> tags from our set of unmapped tags could be due to the presence of a polymorphic region of the genome. these tags correspond to  <dig> % of our initial set of tags. the observed frequency is therefore lower than the expected one. however, the expected frequency was calculated using the frequency of snps estimated using known sequences. we expect that this frequency would be lower for sequences that are not well characterized yet. this could partly explain why we observe fewer snps than the theoretical value we calculated. furthermore, the observed frequency of snps is certainly lower than the real value. indeed, snp alternative tags could only reliably be predicted on complete mrna  that could be mapped to the human genome  <cit> .

tags belonging to est sequences
these explanations are not entirely satisfactory, because we expect only 10% of all different tags to correspond to any of the cases mentioned above, but we observe that 36% of all tags do not match the genome sequence . our theoretical calculations rely on the quality of the annotations and could thus possibly underestimate the real values. therefore, we tried to map each unmapped tag to human est sequences.  <dig> unmapped tags match at least one est, which represents 10% of the total of the set of different tags . this result is in agreement with our theoretical expectations. in conclusion, we did not find the potential origin of all unmapped tags : it seems that some fraction of these tags do not correspond to the sequence of already known human mrnas.

tags generated by contaminants
one third of the human public longsage libraries have been obtained from embryonic stem cell lines, which are often propagated on mouse embryonic fibroblasts   <cit> . some mef may therefore have been included in the embryonic stem cell preparation, and murine mrna may thus have contaminated the sage libraries. we expect that such murine tags would not match the human genome sequence in many cases. indeed, only 6% of murine virtual longsage tags we extracted from  <dig> refseq sequences match the human genome sequence. we thus looked for mouse tags in the set of tags that do not match the human genome sequence and that do not correspond to any of the cases previously described. for this purpose, we mapped these tags to the mouse nuclear and mitochondrial genomes. figure  <dig> shows that the proportion of tags that map to the mouse genome is higher in the libraries that have been obtained from embryonic stem cells than from other tissues. among the nine cell populations used to construct these libraries, eight have been propagated on murine fibroblasts . the remaining library, indicated by an arrow on figure  <dig>  was constructed using mrna from embryonic stem cells which were not propagated on murine fibroblasts. this probably explains why the frequency of tags mapping to the murine genome in this library is not higher than the frequency in libraries obtained from other tissues .

we considered a tag as a contaminant if it did not map to the human genome, nor to a human mature transcript, it occured only in embryonic stem cell libraries propagated on mef, and it mapped to the mouse genome. these tags represent a non-negligible proportion  of the tags that do not match the human genome sequence.

it is obvious that the percentage of tags that map to the mouse genome varies between embryonic stem cell libraries, revealing different degrees of exclusion of mef. our results show that even when libraries have been constructed from carefully dissected material, it is always necessary to filter the tags to exclude tags generated by transcripts present in the remaining mef.

where do the remaining tags come from ?
in total, the origin of 42% of the unmapped tags was explained by one of the situations previously described . however, we could not explain the origin of the remaining unmapped tags. these tags do not belong to any library in particular. the large majority  of these tags correspond to sequences varying by one base from another tag that maps to the genome, and some of these tags could therefore correspond to rare polymorphisms that are not represented by an est. this is possible, but unlikely to be the main explanation because we studied twice as many ests  as sage tags . we also tested whether these tags could come from edited mrnas that are not represented among est sequences. for this purpose, we examined the transition frequencies when comparing genomic and tag sequences, since the two known families of rna-editing enzymes in humans perform adenosine to inosine or cytosine to uracil modifications  <cit> . however, these modifications are not overrepresented in our dataset . therefore, the set of unmapped tags for which we could not find any origin seem do not seem to be enriched in tags coming from a-to-i or c-to-u edited mrna.

necessity of reassessing the error rate in sage libraries
unmapped tags whose origin could not be explained by our previous screens occur on average at a low frequency : 88% occur  <dig> times or less in the dataset, and the vast majority of these tags correspond to sequences varying by one base from another tag that maps to the genome . because of this, and because our screens exclude many other possible explanations, we think that the most parsimonious explanation for the presence of these tags is that they contain sequencing error. we initially used an error rate that was previously published  to remove the tags containing sequencing error. the observation of many unmapped tags that are likely to contain errors suggests that this error rate needs to be reevaluated. in the different libraries we analyzed, the unmapped tags whose origin could not be explained by our previous screens represent from  <dig> to 8% of of the size of the library . therefore, we used the same method as we initially used to remove sequencing errors , but with an higher error rate . with this new filter for sequencing errors, the set of unexplained tags drops dramatically , suggesting that the majority of the tags whose origin could not be explained by our previous screens are probably due to sequencing errors.

analysis of tags that map to only one location on the genome
tags mapping once to the human genome represent nearly half  of the set of different tags. we studied the localization of these tags with respect to known transcripts, to evaluate the amount of transcription inside and outside annotated transcripts.

tags mapping to annotated transcripts
we first studied the tags that are located inside known transcripts, using ensembl annotations  <cit> . these annotations do not always provide the complete 3'utr . indeed, the annotation of these regions is particularly difficult because it relies on the availability of a cdna sequence complete in 3' . we have therefore extended each transcript by systematically adding  <dig> bp to the annotated 3'utr. we chose this threshold because it adjusts the average length of the annotated utrs in ensembl  to the average length of human 3'utr in utrdb .

among the tags mapping once to the genome, 69% are located in such "extended" transcripts. a more precise description of the tag positions in different parts of these transcripts is displayed in figure  <dig>  as expected, a large proportion of the tags map to the 3'utrs, and most of the others map to the coding part of exons. many tags map both to an intron and to an exon, depending on the splicing variant considered. after discarding these cases, 12% of the tags matching once the genome sequence map to an intron . these tags do not belong to an annotated mature mrna, and therefore they correspond either to new splicing variants of known genes or to new transcripts that overlap with known transcripts.

even among the tags mapping to annotated transcripts, a non-negligible proportion  maps in antisense compared to the annotated transcribed strand. such tags have already been highlighted by several previous studies  <cit> . we observed that the proportion of tags mapping to antisense is significantly higher for tags located in 3'utr  than for tags located in coding exons . this means that a large proportion of the genome is transcribed from both strands of the dna, especially in the 3'end of the transcripts, confirming previous expectations  <cit> . among the  <dig>  transcripts for which we found at least one tag in out dataset,  <dig> % possess a tag in antisense. this proportion is in accordance with observations in arabidopsis thaliana  <cit> , but is higher than previous observations in human . for each of the public longsage libraries, we computed the proportion of transcripts with a tag in the same orientation as the annotated one, in the opposite orientation, or in both orientations. we found that on average 61% of the transcripts per library have tags only in the same orientation as the annotated one, 10% have tags only in the antisense orientation, and 29% have tags in both senses. however, these proportions varied between libraries, notably with library size . this could be explained by the low abundance of antisense transcripts, which could only be detected by in-depth sequencing. indeed, for the transcripts with corresponding tags in both orientation, tags in the same orientation as the annotated one are usually more abundant than tags in antisense .

tags mapping outside annotated transcripts
31% of tags mapping once to the genome  do not correspond to a known transcript. we already have discarded the tags that could have been generated by sequencing errors using a published sequencing error rate in sage libraries. however, as we previously mentioned, it is possible that the error rate is higher than anticipated, and that some tags from our dataset still contain sequencing errors. we thus estimated the probability that such tags containing a sequencing error match the human genome sequence. for this purpose, we randomly selected  <dig>  tags that match the human genome sequence, and we modified them by introducing "sequencing errors". these errors were randomly attributed, by using the percentage of error for each base we calculated . we found that  <dig> % of these modified tags matched the human genome sequence : this is an estimate of the probability that an erroneous tag maps to the genome ). consequently, for each tag from our dataset that maps to the genome , the probability that it is erroneous can be estimated by the following calculation :

 p=p×pp= <dig> ×p <dig> 
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgwbaccqggoaakcqwglbqzcqwgybgccqwgybgccqwgvbwbcqwgubgbcqwglbqzcqwgvbwbcqwg1bqdcqwgzbwccqgg8bafcqwgtbqbcqwghbqycqwg0badcqwgjbwycqwgobaacqggpaqkcqgh9aqpdawcaaqaaiabdchawjabcicaoiabd2gatjabdggahjabdsha0jabdogajjabdigaojabcyha8jabdwgaljabdkhayjabdkhayjabd+gavjabd6gaujabdwgaljabd+gavjabdwha1jabdohazjabcmcapiabgena0kabdchawjabcicaoiabdwgaljabdkhayjabdkhayjabd+gavjabd6gaujabdwgaljabd+gavjabdwha1jabdohazjabcmcapaqaaiabdchawjabcicaoiabd2gatjabdggahjabdsha0jabdogajjabdigaojabcmcapaaacqgh9aqpdawcaaqaaiabicdawiabc6cauiabicdawiabieda3iabiada2iabgena0kabdchawjabcicaoiabdwgaljabdkhayjabdkhayjabd+gavjabd6gaujabdwgaljabd+gavjabdwha1jabdohazjabcmcapaqaaiabicdawiabc6cauiabiada2iabisda0aaaaaa@94ae@ 

with a sequencing error rate p =  <dig> , p =  <dig> , and even with a higher error rate  =  <dig> ), p =  <dig>  is still low.

because the probability that a mapped tag is erroneous is very small, the majority of the tags mapping once to the genome and outside annotated transcripts should come from unknown transcribed regions. however, it is possible that some of these tags do not belong to new transcripts, because the real 3'utr may be longer than annotated . we therefore calculated the distance between these tags and the 3' end of the nearest transcript. we observed that very few tags are located in an incompletely annotated 3'utr .

because the vast majority of tags that do not correspond to an annotated transcript do not originate from an incompletely annotated 3'utr, we searched for other evidence of transcription in the regions from which these tags originate .

number of tags outside annotated transcripts. the percentage values correspond to the proportion of each of these sets of tags compared to the set of all tags matching once in the genome, outside an annotated transcript.

we found that 12% of these tags are located in a transposable element . we also found that 78% of the tags that match once the genome sequence but not in a known transcript map to at least one human est . this confirms, using independent evidence, that these tags mapping outside annotated transcripts belong to real transcripts.

as we mentioned in the introduction, most of the recent work on finding new transcripts in the human genome has been performed using tiling microarrays. we thus compared our sage tags  with transcribed regions predicted using tiling microarrays. for this comparison, we used the transfrags  recently obtained by cheng et al. by studying transcribed sequences, polyadenylated or not, from ten human chromosomes . 35% of our set of tags not located on an annotated transcript and that are located on the  <dig> chromosomes studied by chen et al. map to such a transfrag . for these tags, we thus have two independent lines of evidence that they come from a transcribed region.

conversely, only  <dig> % of the transfrags contain one or more of our tags. we propose several explanations for this observation. nearly half of the transfrags correspond to nonpolyadenylated transcripts  <cit>  that are not analyzed by sage. some of the transfrags may correspond to transcripts specifically expressed in particular conditions, that have not yet been analyzed by sage . finally, the small overlap between the results obtained in the different studies using human tiling microarrays suggest either that the transcriptome of the various tissues analyzed is very different, or that these array experiments provide a large fraction of false positives   <cit> . the fraction of false positives may thus be high, and both the high percentage of our tags that are located on transfrags and the low percentage of transfrags that contain a tag suggest that our set of tags may contain fewer false positives than existing transfrags do.

CONCLUSIONS
using the sage method, it is possible to study the transcriptome without any a priori knowledge of expressed genes. we used all the human longsage libraries available, filtered them to remove tags containing sequencing errors, and systematically mapped these tags to the genome. we particularly concentrated on unexpected localizations, either because the tags did not match the genome sequence, or because they mapped outside known transcripts. we then proposed explanations or hypotheses for the origin of these tags.

more than one third of the different tags do not map to the human genome. among them, 42% are part of mrna sequences but are not found on the human genome because they correspond to polya tails, junctions between exons, polymorphic sites or contaminant murine transcripts. the other tags are probably due to sequencing error. consequently, the sequencing error rate in these public libraries is probably higher than previously estimated.

half of the different tags map once to the genome, and one quarter of these tags match outside annotated transcripts. this suggests that many transcripts are still to be annotated in the human genome. because many tags mapping to known transcripts belong either to introns or are aligned in antisense, we suggest that they belong to new variants or antisense mrnas of these transcripts. consequently, the human transcriptome seems to be more complex than shown by the current genome annotations, and longsage analysis should help to improve the annotation process.

