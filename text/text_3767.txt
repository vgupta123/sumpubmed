BACKGROUND
gene clustering that assigns group membership to each gene is a widespread pattern extraction technique. genes sharing the same membership are often hypothesized to be regulated by the same defined or undefined genomic influence, such as cellular pathway. model-free clustering techniques such as k-means and hierarchical clustering  <cit>  are widely used. one limitation of these approaches, as pointed out by many researchers, e.g.  <cit> , is that each gene can only belong to a single cluster. these types of gene clustering algorithms are thus called mutually exclusive clustering. in the context of cellular pathways, they assume that one gene can only be regulated by one pathway at a time, which apparently, is not the case. model-based clustering or soft clustering  <cit>  provides mechanisms to relax this stringent assumption by introducing "probabilistic" or "fuzzy" memberships. however, these "soft" memberships do not biologically account for the fact that one gene is often simultaneously regulated by multiple genomic influences.

singular value decomposition   <cit>  has shown great promise towards deconvolving channels of genomic influence. assuming rows of data matrix correspond to genes and columns correspond to physiological/genetic conditions under which the gene expression abundance was interrogated using gene chips, the svd factors the data matrix into three matrices. the first matrix, which contains most of information, is called a gene coefficient matrix where each column  defines a preliminary gene cluster that might be regulated by a specific genomic influence. we will describe more details of svd in the method section. svd has been repeatedly shown to be able to deconvolve the observed gene expression signal into a composite of multiple overlapping genomic influences, many of them correspond to signaling pathways  <cit> .

thus svd provides a methodology base for non-mutually exclusive clustering. the gene clusters generated by svd are often preliminary due to the fact that many non-relevant genes might contaminate the pc's that define gene clusters. hastie et al  <cit>  proposed removing non-relevant genes in an iterative fashion, in which the least correlated genes with the leading pc is treated as non-relevant. the gene shaving algorithm quickly became an important tool in the pattern discovery arsenal. it iteratively searches for clusters of genes showing high variation across the samples, and correlation across the genes  <cit> . the former is achieved by working with the leading pc and the latter is achieved by iteratively discarding non-relevant genes to the cluster. there are other types of non-mutually exclusive clustering methods as well, such as plaid model  <cit> .

the underlying assumption of the gene shaving algorithm is that the leading pc accounting for the largest portion of variation is always of exclusive interest to the investigator  <cit> . consequently the algorithm iteratively refines the first gene cluster defined by the first pc by shaving off a proportion of genes that are least correlated with the leading pc. the second gene cluster is formed by performing the same procedure on the orthogonal data, resulting from the residuals of regression, and so on. however, the underlying assumption that the whole algorithm is based on is not always true for every single case. in fact, gene expression in many signaling pathways show modest but concordant changes. the gene shaving algorithm would most likely to fail in these cases by working exclusively with the leading pc.

gene set based methods, such as gene set enrichment analysis  were designed to overcome this limitation. since it's first introduction in  <dig>  <cit> , it has been widely applied to interpret genome-wide expression profiles  <cit> . however, the approach only ranks pre-compiled gene sets according to the relevancy to the data and does not predict any new genes in the gene sets. therefore, it strictly depends on the availability and validity of a priori defined gene sets. in reality a gene set is not always available in a complete and accurate format. what is typically available is partial pathway learned from empirical experimental studies.

we seek a seamless combination of the strengths of the two methodological frameworks. we manufacture a pc that is most enriched by prior knowledge . performing the analysis iteratively we will be able to identify the gene cluster showing modest but concordant changes. in many cases, we are further interested in finding genes that are concordantly up or down-regulated by genomic influences. therefore, it might be beneficial to turn our attention not only to the pc that the prior knowledge is most enriched, but also to the positive pc and the negative pc separatively. the hypothesis can be substantiated by previous works that positive and negative pc's can be enriched by completely different biological functions, e.g.  <cit> .

in our work, we eliminate non-relevant genes iteratively following and improving the procedure used in the gene shaving algorithm  <cit> . in each iteration, a weighted average expression profile was calculated and used as the seed profile to rank genes. with the heuristic removal of non-relevant genes at the beginning of the iterations, and some relevant genes by the end, the enrichment of prior knowledge has seen a sharp increase, followed by a gradual decrease. we then propose a trace-back step to retrieve the gene cluster in which enrichment of prior knowledge is maximized .

RESULTS
we aim to demonstrate that the proposed algorithm is capable of identifying tightly regulated gene sets showing modest and concerted variation using incomplete prior knowledge and real-world microarray data set. ground truth, which indicates a "complete" gene set used as precondition for applying gsea algorithm  <cit> , is desirable to demonstrate the claimed advantages of our algorithm. it is often not available. therefore, we use four "high-amplitude" and four "low-amplitude" gene sets identified in  <cit>  as ground truth to evaluate the ability of our algorithm to recover them using subsets of a variety of lengths. the high and low amplitude genes used in this example are well-studied genes in the cell cycle, and many of them are co-regulated by a number of signaling pathways  <cit> . we then use incomplete prior knowledge supplied by our collaborator and apply our algorithm to predict new wnt and notch pathway genes in the somitogenesis process.

recovering low and high amplitude gene sets using incomplete prior knowledge
as a proof of concept, we first analyzed a cell cycle data set originally reported in  <cit> . the data set consists of whole yeast genome expression profiles interrogated over two full cell cycles  synchronized by elutriation. we considered the same  <dig> genes as in the paper derived using fourier transform. in each of the four gene sets, genes were further classified into high-amplitude and low-amplitude groups according to magnitude of variation. the processed data are available from the authors' website at  <cit> .

we treated the high-amplitude genes and low-amplitude genes in each gene set as "complete", as assumed in classical gsea analysis. we sampled subsets of increasing sizes from  <dig> to complete  with a step size of  <dig>  in each step experiment, we generated  <dig> subsets of the same size , and for each subset we applied our algorithm to demonstrate its ability to recover the full gene set using the hypergeometric test explained in method section. the p-values of the tests were used as a measure for such an ability. for visualization convenience, the p-values were negatively log-transformed and higher value corresponds to better recovery of the complete gene set.

the high-amplitude and low-amplitude complete gene sets were plotted in figure 2a . in both fig 2b  and fig 2c , the ability of recovering the complete gene set  was plotted against the increasing subset size respectively. the observed monotonic increase indicates that the larger the subsets  are, the more capable of recovering the complete gene set. it is worth mentioning that figure 2b demonstrates the capability of our algorithm to recover low-amplitude gene set, and figure 2c demonstrates the capability of the gene shaving algorithm  <cit>  to recover high-amplitude gene set.

our algorithm can be viewed as an generalization of the gene shaving algorithm. gene shaving algorithm exclusively works with the leading pc. therefore, it is only capable of identifying high-amplitude signaling pathways. our algorithm adaptively works with the pc that is most enriched by prior knowledge. therefore, it is capable of identifying either high-amplitude or low-amplitude signaling pathways wherever prior knowledge is available. comparing figure 2b to figure 2c more closely, it is evident that our algorithm recovers low-amplitude gene sets even better than gene shaving algorithm recovers high-amplitude ones. this is demonstrated by uniformly larger mean values and overall smaller variance on the vertical axis. the results of analyzing other complete gene sets of appropriate size lead to the same conclusion . the proof-of-concept analysis provided compelling evidence that our algorithm is particularly suitable for identifying sets of tightly regulated genes with modest variation.

predicting wnt and notch pathway genes using prior knowledge
microarray data and prior knowledge
we then proceed to re-analyze microarray data originally reported in dequeant et al  <cit>  to predict genes in wnt and notch pathways. in this experiment, the genome-wide gene expression was interrogated over  <dig> developmental stages using affymetrix genechip 430a. using the lomb-scargle periodogram  <cit>  the top  <dig> genes were used for gene clustering so that all prior knowledge genes are included. microrarray data are available at arrayexpress at  <cit> .

prior knowledge corresponds to a list of experimentally validated cyclic genes regulated by the segmentation clock, a molecular oscillator acting during somitogenesis  <cit> . the segmentation clock is a set of periodic processes linked to the formation of the vertebrate embryo segments  that give rise to the segments in the adult body plan of a vertebrate animal. malfunction of cyclic genes are the direct cause of many developmental diseases, such as noonan syndrome and truncated tail  <cit> . therefore, predicted cyclic genes are potential human disease genes. in particular, we have incomplete sets of  <dig> genes in the wnt pathway, and  <dig> genes in the notch pathway as our prior knowledge. our objective is to predict more wnt and notch genes using prior knowledge, microarray data and our proposed algorithm.

finding the most enriched pc using prior knowledge
in each iteration of our algorithm, we search for the pc that is most enriched by known wnt and notch genes. we filtered the gene coefficients in each pc using the cutoff and tested enrichment of known pathway genes using the hypergeometric test . figure  <dig> shows what happened in the first iteration where all  <dig> known wnt genes and all  <dig> known notch genes are included in the second pc . after separating positive and negative pc's, in figure  <dig>  all known wnt genes are included in the second negative pc and all known notch genes are included in the second positive pc . the marked increase of p-value reveals that separating positive pc from negative pc is a key to better enrichment of prior knowledge. the fact that prior knowledge is mostly enriched in pc's other than the leading one indicates that the gene expression in the notch and wnt pathways show only modest and concordant changes. the enrichment of prior knowledge in the gene cluster could be further improved as our algorithm iterates. in the next section, we present results of generating the "best" wnt and notch clusters in which enrichment of prior knowledge is optimized.

comparing our semi-supervised algorithms with the gene shaving algorithm
we aim to show that our semi-supervised algorithm is uniquely able to identify low variation signaling pathway genes but not the gene shaving algorithm. for predicting wnt cluster, our algorithm terminates after  <dig> iterations, and for predicting notch cluster, it terminates after  <dig> iterations. we then traced back to retrieve the optimized clusters. both wnt and notch clusters were retrieved at the 9th iteration that prior knowledge is most enriched, and were smallest clusters containing all prior knowledge genes . from figure 5a, the original gene shaving algorithm  <cit>  apparently failed in this case demonstrated by no enrichment of prior knowledge at all. the reason is, as discussed before, that wnt and notch pathway genes are concordantly regulated in modest magnitude while gene shaving algorithm only works with the leading pc. figures 5b and 5c present the prior knowledge enrichment achieved by two variants of our semi-supervised algorithm: with or without separating positive pc's from negative pc's. it is evident that splitting pc's gives rise to better clustering performance.

the left panel of figure  <dig> plots gene expression profiles of the predicted notch cluster, and right panel displays the annotation of those genes. genes in the shaded areas are from our prior knowledge  <cit> , and genes that are pointed by red arrows indicate the genes are experimentally validated to be positive, and genes pointed by blue arrows indicate the genes are potentially relevant through literature search. note that the two pathways are far less from well understood, and therefore, many predicted genes, although not currently supported by experimental evidence, are likely to be validated later.

to make our prediction useful for improving current understanding of the mechanisms of wnt and notch pathways in somatogenesis, we performed analysis to infer what kinds of biological functions  are most enriched in the pathways, and what kind of transcription factors  are most likely to be involved in regulating the two pathways. table  <dig> presents the results of abovementioned enrichment analysis. the analysis was done through the web-server of the segal lab:  <cit> . in table  <dig>  results appear to be meaningful since many significantly enriched go terms  are related to embryonic development, and both enriched transcription factors : myog and myod are closely related to cell differentiation  <cit> . in particular, myod and myog have distinct regulatory roles at a similar set of target genes. the role of myog in mediating terminal differentiation is partially to enhance expression of a subset of genes previously turned on by myod  <cit> .

the third column contains biological functions significantly enriched in wnt and notch pathways, and the fourth column contains transcription factors significantly associated with wnt and notch pathways. the analysis was done through the web-server of the segal lab:  <cit> 

stability of clusters against perturbation of prior knowledge
our approach predicts new pathway genes based on the available prior knowledge, therefore, it is critical to investigate the sensitivity of our prediction to a modest perturbation of prior knowledge. since in this data set we don't know such ground truth as we did in the cell cycle data analysis, we performed sensitivity analysis using leave-one-out and leave-two-out jackknife approaches, see method section for technical details. narrower jackknife confidence interval of the enrichment indicates better stability of our enrichment estimation against perturbation of prior knowledge. in figure 7a where the leave-one-out approach was applied, the estimation of enrichment is perfectly stable  and increases until the ninth iteration. recall that we traced back and retrieved the "best" notch gene cluster right in the ninth iteration. this translates into the fact that our cluster analysis is very robust against moderate perturbation of prior knowledge. in figure 7b where the leave-two-out approach was used follows a similar trend but with better stability . this is due to the fact that there are a larger number of jackknife samples available in leave-two-out approach.

discussion
with exception of a few recent works  <cit> , most clustering algorithms these days are non-supervised in the sense that prior knowledge is not properly utilized to guide the learning process. instead prior knowledge is often used in the post-learning phase in that researchers predict functions of unknown genes based on genes of known functions lying in the same cluster. the traditional gene shaving method focuses on the leading pc that accounts for most of variation in the data. on one hand, it is useful in discovering high variation pathway genes  <cit> , on the other hand, it tends to overlook essential pathway genes that have modest expression variation. we hypothesized that highly concerted expression behavior of these genes, albeit modest in variation, may help shape its pattern out of the noisy microarray data using appropriate analysis techniques, i.e., svd.

the main contribution of this work is that we proposed an optimization algorithm combining the strengths of gene set based analysis and iterative gene selection. the iterative fashion inspired from the gene shaving algorithm allows distilling desired gene cluster using prior knowledge, while the latter enables us to discover gene clusters of modest and concerted expression change. the pc's that define gene clusters group a series of tightly regulated genes ranked by variance over samples. the orthogonality as specified in svd analysis indicates those gene clusters of different variation were regulated by orthogonal defined or undefined genomic influences .

our method is particularly suitable for identifying gene clusters with modest and concerted expression change, therefore it is not limited to identify periodically expressed gene clusters. when there is no prior knowledge available, the optimization process can be done through optimizing the enrichment of interesting gene ontology  vocabulary, for example, somitogenesis . the technique for testing enrichment of go term is very similar to that was used here, also see review in  <cit> . a recursive dendrogram can be constructed as a foundation to generate overlapping gene clusters, from which the optimal clusters can be identified and retrieved according to the enrichment of the interesting go term  <cit> .

CONCLUSIONS
our algorithm represents one of the first clustering algorithms that is particularly designed to identify signaling pathways of low and concordant gene expression variation. the discriminating power is achieved by manufacturing a principal component enriched by the prior knowledge.

