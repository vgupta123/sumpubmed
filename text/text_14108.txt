BACKGROUND
the advance of experimental technology, including complete genome sequencing, high-throughput expression profiling  <cit>  and binding-site mapping  <cit> , has made the computational approach of studying the cis-regulatory networks  more attractive. a widely used model is to cluster genes based on their expression profile and then using motif finding algorithms  <cit>  or motif enumerators to find the over-represented sequences within each cluster  <cit> . however, the correlation between gene clusters and motifs is imprecise because of the complex nature of regulation, as not all genes within a cluster share a common motif and the same motif can be found in gene promoters in other clusters. importantly, these clustering based models are not suitable to model the expression of each individual gene. to overcome this limitation,  <cit>  and  <cit>  have proposed a linear regression model to predict statistically significant motifs. while a fascinating approach, it assumes that the number of occurrences of motifs in a promoter is linearly correlated with the gene expression, where motifs are identified by simply enumerating all k-mers. from an entirely different angle,  <cit>  provided an approach that screened genomic sequences against a database of putative regulatory motifs, evaluating the contribution of the occurrences of the motif on the gene expression by comparing the expression profiles of genes containing this motif against those that do not. this method therefore requires knowledge about the putative motifs of that species, which may not always be available. another major direction of motif finding and crn discovery focuses on comparative genomics, also referred to as phylogenetic footprinting   <cit> . it assumes that the cis-regulation is conserved over evolution; thus, it does not need gene co-expression data as input to determine the sets of co-regulated genes. pf is a powerful method and has gained impressive success for the prediction of conserved regulatory elements. however, the main drawback of this method is that it cannot find species-specific regulatory elements.

here, we propose a simple approach for inferring crns that avoids the common limitations mentioned above. using genomic promoter sequences and gene expression data as input, our method utilizes the gene expression data in a novel way. in contrast to the approach favored by previous clustering based methods, which clusters genes by co-expression information and finds over-represented motifs for each cluster, our method first builds a gene co-expression network, and then searches for putative cis-regulatory elements that are enriched in the neighborhood for each individual gene on the network. in other words, our method utilizes the gene expression profiles in an individual gene motivated fashion. in addition, by using a simple enumerated k-mer counter to find the motif information within the promoter sequences, this approach needs little knowledge of the species-based putative motifs and requires few assumptions about the model by which elements of motif counts affect gene expression. it is a simple and versatile model for motif discovery and crn finding. thus, we hope it can be easily used for species with little previous cis-regulatory knowledge or be flexibly used for previous crns discovery approaches as an additional step. an in silico evaluation on saccharomyces cerevisiae and arabidopsis has been performed. compared to a phylogenetic footprinting  based method on several datasets, our method shows comparable or even better prediction accuracy. furthermore, the top ranked cis-regulatory clusters uncovered by our approach for the two species are evidently functionally co-regulated, and the regulatory relationships between the motifs and the enriched biological functions can often be confirmed by literature.

methods
cis-regulatory network construction
the input of our method includes a list of promoter sequences and a gene-gene co-expression network . the m promoter sequences are viewed as 'background' and the n genes of the co-expression network are the target genes whose crns we want to study, where the n target genes are a subset of the m background genes. the gene-gene co-expression network is represented by an adjacency matrix, a = 〈aij〉n × n, where aij =  <dig> if there is an edge between gene i and gene j, and  <dig> otherwise. for convenience, we let aii =  <dig> for all i. here the number of target genes n is from co-expression networks. the reason why we choose n target genes out of m is that in order to ensure a high-quality co-expression data, only the genes with the highest variations in the stress response data set will be chose to build co-expression network.

we first count the number of occurrences for each k-mer, where k =  <dig> in this study, on each of the m promoter sequences. let c = 〈cij〉m × l be the k-mer occurrence table, where l = 4k is the total number of candidate motifs . let d = 〈dij〉n × l be a matrix derived from c such that each row of d corresponds to a row in c for the same gene's promoter, and the order of the genes in d is equivalent to that in a.

next, for each gene g present in the co-expression network, we identify its neighbors in the network, πg = {i|agi = 1}, and retrieve the corresponding rows from d, defined as tg = 〈tij〉 = 〈dsj〉, where s ∈ πg.

finally, we compute the significance for the j-th k-mer being over-represented in the neighborhood of gene g using either the cumulative hypergeometric test, or student's t-test. with the cumulative hypergeometric test, the p-value is calculated as

  pgj= ∑r=xminkrm-kq-rmq 

where x = |{i|tg = 〈tij〉, tij > 0}| is the number of genes within gene g's neighborhood  that have at least one occurrence of motif j, k = |{i|cij > 0}| is the number of such genes in the background , and q = |πg| is the number of neighbors for gene g in the network. intuitively, the cumulative hypergeometric p-value is the probability of drawing at least x of a possible k items in q drawings without replacement from a group of m objects.

on the other hand, with the student's t-test, the p-value is calculated by performing a non-paired two-sample t-test to compare the average occurrence of motif j in the neighborhood of g against that of the genes not in the neighborhood of g.

from the p-value matrix p = 〈pij〉n × l, a score matrix s = 〈sij〉n × l can be computed by sij = log <dig> pij. the values in s range from  <dig> to +∞, where a greater number indicates a more significant regulatory relationship of a gene-motif pair. to cope with numerical precision limitations, all scores larger than  <dig> are converted to  <dig> 

at last, the cis-regulatory network, represented by a bipartite graph r =  can be derived from s, where u is the set of genes, v is the set of motifs, e is the set of regulatory relationships, and w is the associated edge weights, defined by wij = sij for any edge. to ensure statistical significance and biological relevance, a cutoff is applied so that  ∈ e if and only if sij >cutoff. in our study, for evaluation purposes, cutoff is set to  <dig>  corresponding to a p-value threshold at  <dig> . for visualization and biological analysis, cutoff is set to a much larger value .

evaluation of the predicted cis-regulatory network
to directly evaluate the predicted cis-regulatory network is difficult. we evaluated the performance of our algorithm indirectly in two ways.

co-regulatory network based evaluation
first, following the idea in  <cit> , we evaluate the crns based on co-regulatory networks. to this end, we first determine the similarity  between each pair of genes based on their motif scores. subsequently, a co-regulatory network, n, is constructed by connecting genes whose similarity scores are above a certain threshold. this co-regulatory network is then compared with some reference networks to determine the performance of our method. the key idea here is that if two genes share many regulatory elements, they are likely to be functionally related, and would share more edges with a reference network , which also captures functional relevance of genes. as the reference network and our predicted network may not have the same size, we first limit both networks to contain the same set of genes. we then compared the two networks using a set of standard metrics, defined as follows.

• true positive  is the number of edges in both n <dig> and n2: tp = | q <dig> ∩ q2|;

• false positive  is the number of edges in n <dig> but not n2: fp=|q1∩q2¯|;

• true negative  is the number of non-edges in both n <dig> and n2: tn=|q1¯∩q2¯|;

• false negative  is the number of edges in n <dig> but not n1: fn=|q2∩q1¯|;

• precision, also referred to as the positive predictive value , is the ratio between tp and number of edges of n1: ppv=tp|q1|=tptp+fp;

• recall, also referred to as sensitivity or true positive rate , is the ratio between tp and number of edges of n2: tpr=tp|q2|=tptp+fn.

here n <dig> and n <dig> represent the predicted co-expression network and the reference co-expression network, respectively, qi represent the set of edges in ni, and qi¯ represents the set of edges in the inverse graph of ni.

model based evaluation
second, we evaluate the crn using a completely different strategy. our idea is that, if the crn is correct and complete, we should be able to use it to model gene transcriptional level changes with a high accuracy. therefore, given a set of gene expression microarray data, we attempt to construct a linear regression model for each microarray to predict the expression levels for each gene using the linear combination of the gene's motif scores. importantly, in order to perform an unbiased evaluation, the gene expression microarray data used for evaluating the predicted cis-regulatory network should be different from the gene expression data that we have used for constructing the gene co-expression network or cis-regulatory network .

formally, let eg be the logarithm base two of the ratio of mrna levels between two conditions for gene g, we model eg by eg= ∑i=1kβiwig+c. this formulation is identical to the popular model proposed by  <cit> , except that they used motif occurrences , while we use the motif significance score . as the number of k-mer motifs  we have is larger than the number of genes , we apply a simple feature selection by only including the top q  motifs that have the highest correlation between motif significance scores and gene expression levels, and perform linear regression only using these top motifs. to measure the accuracy of the model, we calculated the root mean squared error  of the linear model, as well as the pearson correlation coefficient  between the predicted expression levels and the actual values. a higher pcc or a lower rmse indicates a better prediction accuracy and therefore a biologically more relevant crn.

competing methods
we compare our method with two alternative methods. the first method is based on a naive model where we simply score each promoter sequence by counting the number of occurrences of each k-mer . it is expected that such a simple method will su er from high false positive  and false negative . nevertheless, this is the model used in most methods attempting to model gene transcriptional changes . the second method was proposed by  <cit> , where they used phylogenetic footprinting to identify putative cis-regulatory elements in yeast saccharomyces cerevisiae by discovering over-represented motifs in the promoters of their orthologs in  <dig> saccharomycetes species. in their method, cis-regulatory elements are represented by dyads, i.e. pair of trinucleotides separated by a spacing comprised between  <dig> and  <dig> bp. the output of their method is similar to the gene-motif p-value matrix and we applied the same logarithm transformation as in our method so that a higher score means a more significant regulatory relationship.

data sources
promoter sequences
promoter sequences for saccharomyces cerevisiae  are downloaded from rsa tools  <cit> . the promoter sequence for each target gene is defined as  <dig> base pairs upstream from its transcription start site , or the whole intergenic region between the tss and the coding sequence of the upstream gene, whichever is shorter.

promoter sequences for arabidopsis thaliana are downloaded from tair . promoter sequences are defined as  <dig> base pairs upstream to the first annotated nucleotide of the gene , according to tari <dig> assembly.

microarray data and gene co-expression networks
to construct a gene co-expression network, we used gene expression microarray data from  <cit> , which contains the yeast gene expression data in response to a variety of environmental changes. this data set contains  <dig> arrays, and as in most previous studies, we selected the top  <dig> genes with the highest variances  <cit> . after quantile normalizing the expression data, we constructed a co-expression network using the method described in  <cit> . brie y, we first computed the pearson correlation coefficient between the expression profiles of every pair of genes, and then ranked the correlation coefficients for each gene separately. two genes are connected by an edge if the correlation between their expression profiles is ranked above a certain threshold within both genes' rankings. the threshold is determined automatically from an analysis of the resulting network's topological properties as described in  <cit> . the optimal rank threshold chosen is  <dig>  previous studies showed that such rank-based co-expression network can produce biologically more meaningful functional modules, especially for gene modules that are weakly co-expressed or conditionally co-expressed  <cit> .

to evaluate the predicted cis-regulatory network for yeast, we used a separate yeast gene expression microarray data from  <cit> , which contains  <dig> arrays measuring gene expression under various cell cycle phases.

gene expression microarray data for arabidopsis is obtained from atgenexpress, which includes more than  <dig> microarrays for various growth conditions, developmental stages, and tissues of arabidopsis  <cit> . the gene co-expression network is constructed similarly as above. the optimal rank threshold chosen is  <dig> 

reference networks
the choice of a proper reference network is crucial. in this work, we choose to evaluate our predicted crn for saccharomyces cerevisiae using two reference networks that are constructed also based on the principle of co-regulation. the first reference network, the annotated regulon network, is constructed by linking pairs of genes belonging to the same annotated regulon that have been proved by low-throughput experiments  <cit> . the second reference network, known as the co-binding network, is derived from high-throughput chip-chip data  <cit> , where we link any pair of genes that are shown to be bound by at least one common tf in the chip-chip data . the annotated regulon network is smaller and less complete than the co-binding network, but probably more accurate. table  <dig> shows some basic statistics of the networks. it is worth noting that the same networks were used by the competing method  <cit>  in their paper to evaluate their co-regulatory networks.

this table shows the size of the intersections of the networks that are restricted by the nodes  of the sub-networks. 'cis-similarity matrix' represents our predicted co-regulatory similarity matrix.

RESULTS
the predicted cis-regulatory network  of saccharomyces cerevisiae
the predicted co-regulatory network has a good accuracy
first, as shown in figure  <dig>  the model that simply includes the promoter sequences information  has a very poor performance. the precision  is almost always lower than 20%. the red solid line shows the improvement by including both the promoter sequences and the neighborhood information from the co-expression networks, indicating that including the gene neighborhood information is critical for this method.

compared to  <cit>  using the annotated regulon network, our precision is higher when the recall is less than  <dig>  or greater than  <dig>  . the comparison using the chip-chip co-binding network  <cit>  shows that, when the recall is less than  <dig> , our precision is better . the advantage for the top predictions indicates that our method is better for species-specific predictions. these results show that the prediction accuracy of our approach is comparable with the phylogenetic footprinting approach for co-regulatory network prediction.

since the predicted co-regulatory networks under comparison are intersected with annotated-regulon network or chip-chip co-binding network, the evaluation covers only a small part of the original predicted co-regulatory networks, so the real prediction accuracy cannot be fully represented by these evaluated results. compared to the annotated-regulon network, the ppv of high-scoring prediction, with the score cutoff greater than  <dig> , is higher than 50%. thus, among the  <dig> edges of the  <dig> by  <dig> original predicted co-regulatory network with cutoff =  <dig> , there should be a large portion of edges that correspond to real co-regulations.

the predicted cis-regulatory network has a good correlation with the gene expression profiles
we evaluated the predicted cis-regulatory network by using it to model the gene expression level changes, and then finding the accuracy of the predicted expression level. it is important to note that the reference microarray gene expression dataset  <cit>  used for modeling here is different from the gene expression dataset  <cit>  used for constructing the co-expression networks and cis-regulatory network. from figure  <dig>  it can be seen that our main model has the best result based on both the correlation and the root mean square error . the result from the pf method  is significantly lower than our main method and only slightly better than the naive model. this is in sharp contrast to the evaluation results based on co-regulatory networks, where both methods significantly outperformed the naive method. one possible explanation is that while the pf method can predict well-conserved cis-regulatory elements with high accuracy, it will miss species-specific motifs, which are important to accurately model the gene expression levels. in addition, we attempted to predict the cell cycle gene expression data using the co-expression network  directly with the linear regression model. this result is shown by the fourth sets of bar in figure  <dig>  it shows that although the co-expression network performs the second best, it is still a little weak compared to our method.

since our goal is to reveal the regulatory network, in other word, to find the relationship between the transcription factors and the target genes, the overall good quality of modeling gene expression data doesn't tell the best part of our approach. if we can find examples that the input gene expression profile cannot modeling the evaluating gene expression profile well, but our gene-motif score matrix can, that would show the value of our method. thus, we provided the figure in additional file  <dig>  the x axis shows the  <dig> gene expression conditions of the evaluating gene expression profile. the y axis shows the correlation between the predicted expression level and the true expression level. the red curve shows the results of our approach and the blue curve shows the results of the original input co-expression network of our approach. both of the prediction results are using the top  <dig> features. from the figure, we can see that for some of the conditions, our model performs better than the original input co-expression profile. in addition, the modeling factors of our approach are the k-mers which uncover the potential tf binding sites.

the predicted cis-regulatory network for yeast is biologically relevant
we have performed a preliminary analysis to evaluate the biological significance of the predicted cis-regulatory networks. for efficiency, we only focused on the most significant portion of the network. using a cutoff  <dig> on the the motif significance score matrix, s , we produced a sparse crn that contains several relatively large and dense clusters. figure  <dig> and  <dig> shows the overall network topology and the six selected clusters, respectively.

then, we analyzed the functions of genes in the discovered cis-regulatory clusters using the david functional annotation clustering tool. table  <dig> shows the discovered cis-regulatory elements and annotated functional clusters for the six cis-regulatory modules shown in figure  <dig>  the significance of the functional annotations is measured by the fisher's exact test for the enrichment level of the function within the cluster relative to the genome-wide genes with this function  <cit> . as shown, all six clusters are significantly enriched with some functional terms. more importantly, literature search confirmed that the cis-regulatory elements identified in each module matched the binding sites of transcription factors that are known to regulate the corresponding biological process. for example, the consensus motif regulating the subnetwork in figure 4a, gatgagc, resembles the well-known pac motif , which has been shown recently to be the binding sites of two transcription factors pbf <dig> and pbf <dig> and regulates ribosome biogenesis  <cit> . the module in figure 4b contains multiple cis-regulatory elements that appear to be sub-sequences of the rap1-binding motif, cacccrwaca  <cit> , which is known to be present in most yeast ribosomal protein genes  <cit> . the cis-regulatory elements in figure 4c include the known binding sites for mbp <dig>  and swi <dig> , two key regulators of yeast cell cycle  <cit> . the gataag motif in figure 4d matches the binding sites of several gata-family tfs, including gat <dig>  gln <dig>  dal <dig>  and gzf <dig>  all of which are known to be involved in nitrogen metabolism  <cit> . figure 4e contains the well-known stress-response element  bound by msn <dig> and msn <dig> proteins  <cit> . finally, the gcaccc motif shown in figure 4f matches perfectly with the binding sites of aft <dig>  which is known to be involved in iron utilization and homeostasis  <cit> . therefore, the discovered cis-regulatory modules are functionally relevant.

cgcgaa, cgcgtc, cgcgtt,
'd-clust' is the identifier for the discovered clusters; 'd-count' is the number of genes in the discovered cluster; 'f-count' is the number of genes in the functional clusters, which was discovered by previous well-organized experiments; 'p-value' is measured by fisher's exact test p-value, which measures the enrichment level of the functions within the discovered cis-regulatory cluster relative to the genome.

the predicted cis-regulatory network of arabidopsis
similar to the process of evaluating the predicted cis-regulatory network for saccharomyces cerevisiae, using an s cutoff of  <dig>  we determine the cis-regulatory network for arabidopsis . for the six most interesting clusters , we present the discovered annotated functional clusters in table  <dig> from the david functional annotation clustering tool. the arabidopsis is much more poorly annotated compared to yeast, and much less is known about the cis-regulatory networks in arabidopsis. nevertheless, the cis-regulatory modules identified by our method still shows significant functional coherence. for example, several motifs in figure 6b match to the core subsequence  of the well-known abscisic acid responsive element   <cit> . the catgca motif in figure 6c is part of the ry-repeat element that is specifically required during seed development  <cit> . the motif ggccca in figure 6d matches the up1atmsd motif that is over-represented in a list of up-regulated genes after main stem decapitation in arabidopsis, many of which are predicted to function in protein synthesis  <cit> . finally, genes in figure 6e are involved in cell cycle and are regulated by the caacgg motif, which contains the myb core motif found in the promoter of arabidopsis cell cycle regulating cyclin b1: <dig> gene  <cit> .

'd-clust' is the identifier for the discovered clusters; 'd-count' is the number of genes in the discovered cluster; 'f-count' is the number of genes in the functional clusters, which was discovered by previous well-organized experiments; 'p-value' is measured by fisher's exact test p-value, which measures the enrichment level of the functions within the discovered cis-regulatory cluster relative to the genome.

CONCLUSIONS
the method provided by this paper combined gene expression profiles and promoter sequences in a novel way. by including the neighborhood information from the gene expression profiles rather than clustering the genes, it does not neglect the information of each individual gene in the expression profiles. the accuracy of the predicted co-regulatory network was high when compared to the annotated regulon network, the chip-chip co-binding network, and outperformed a phylogenetic footprinting based method  <cit> . additionally, by using the motif enumerator, it is more flexible for discovering cis-regulatory elements in various species, or for improving current crn discovering methods. compared to current methods using phylogenetic footprinting, this method is better for discovering species specific co-regulations.

the future work of this paper includes two directions. first, more advanced motif models could be used for improving the accuracy of regulatory network discovery. currently, we just use the simplest approach in each step to show that the co-expression network-based approach can improve the specificity of cis-regulatory networks. for the 6-mer model, it may have more false positives compared with longer k-mer models. later, we would like to try some state of the art approaches to identify cis-regulatory element. second, better methods can be designed to identify genes that are not necessarily direct neighbors of a target gene, but are likely involved in similar biological processes. finally, more tests could be done by applying this method on other species.

abbreviations
crn: cis-regulatory network; pf: phylogenetic footprinting; pcc: pearson correlation coefficient: rmse: root mean squared error; tss: transcription start site.

competing interests
the authors declare that they have no competing interests.

authors' contributions
zg designed the study, performed the data analysis and drafted the manuscript. rz assisted in the data analysis and writing. jr conceived of the study, participated in its design and coordination and helped to draft the manuscript. all authors read and approved the final manuscript.

declarations
the publication costs for this article were funded by nih grant sc3gm <dig> 

this article has been published as part of bmc genomics volume  <dig> supplement  <dig>  2013: selected articles from the eleventh asia pacific bioinformatics conference : genomics. the full contents of the supplement are available online at http://www.biomedcentral.com/bmcgenomics/supplements/14/s <dig> 

supplementary material
additional file 1
the comparison of prediction accuracy for gene expression between methods.

click here for file

 acknowledgements
this work was supported by nsf grants ios- <dig>  iis- <dig>  nih grants sc3gm <dig>  u54ca <dig>  g12md <dig> , and a utsa tenure-track research award.
