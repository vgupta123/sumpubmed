BACKGROUND
phylogenetic trees are standardly used to analyse gene families as well as species ancestry  <cit> . a patristic distance is the sum of the lengths of the branches that link two nodes in a tree, where those nodes are typically terminal nodes that represent extant gene sequences or species. a matrix of patristic distances calculated from a tree for all pairs of genes or species summarizes the genetic change, or phylogenetic change, represented in the tree and the data. the distances may be used to analyse the rate of change and may be compared with other measures of genetic difference, such as the total change  or components of change such as those indicated by transitions, transversions, gene rearrangements or recombination  <cit> . in one significant example, the origin of the hiv pandemic was investigated by comparing the patristic distances of dated hiv gene sequences  <cit> . there are many methods and programs for finding, building, or testing trees but only one is known to us that calculates patristic distances and it does so only from maximum parsimony trees, which by definition only represent a fraction of genetic change  <cit> .

implementation
patristicv <dig>  is a java program that can be used as an applet on our website or downloaded. it calculates patristic distances from trees, generates scatter plots from ordered pairs of distances and calculates correlation coefficients and other statistics from distance matrices. it reads trees in variants of the newick format, including the nexus variant used by the package paup  <cit>  and the variants used by the programs mega  <cit> , phylip  <cit> , clustalx  <cit>  and treepuzzle  <cit> . an algorithm that traverses the various textual representations of trees  <cit>  was used to calculate the patristic distances, along with code that permitted different tree-text formats to be read, permitted the easy selection of matrices for plotting from a large number of stored matrices and permitted matrices and plots to be displayed. patristicv <dig>  runs on windows, mac and linux systems with the java runtime environment. a patristic distance matrix from a tree of  <dig> gene sequences was calculated in  <dig> seconds in a pc with an amd cpu at  <dig>  ghz and  <dig> ram using the jre  <dig> . patristicv <dig>  was tested by calculating patristic distances by hand across several small trees and in every case the results of the program were found to be accurate.

the program also recognises distance matrices calculated by other programs from other components of sequence data, such as evolutionary distances calculated from pair-wise sequence comparisons. it reads distance matrices generated by the programs mega, paup and phylip. for the current version, these externally generated matrices must be presented as upper-right or lower-left hemi-matrices or a column. other measures of that can be converted into distances, such as the isolation dates of virus samples, may be entered for each species or gene as real numbers. if sample times are entered directly patristicv <dig>  will generate a matrix of time differences between the species or sequences.

the order of sequences or species represented in a tree almost always differs from the order in the original data file from which the tree was found. hence to plot patristic distances against distances calculated by other methods or patristic distances from two trees, the program automatically reorders matrices with matching sequence or species labels. matrices may also be edited and reordered within an editing window.

a regression is calculated from the ordered pairs of distances when two matrices are plotted against each other  and simple statistics such as the sums of the distances are displayed. correlation coefficients, differences and quotients between the ordered pairs of distances may also be calculated using patristicv <dig> , as may the mean and standard deviation of the differences or quotients, and the program has a facility to enter other formulae so that other statistics can be calculated.

points on a plot that lie outside a chosen multiple of the standard deviation are identified by colour. points are also automatically identified on a plot when the mouse cursor is moved over them. a zoom feature allows the user to focus on a specific part of a plot by choosing the minimum and maximum distances for the two axes which correspond to the two distance matrices. plots of distance matrices may be inverted relative to the axes by a single mouse click. the user can also determine the scale used on the axes as well as the dot size.

plots may be saved as postscript or jpeg files allowing editing in graphics software in a vectorial or bitmap format. the program also allows distance matrices to be saved in a coma separated value format  as a full matrix or as columns so that they may be entered into a spreadsheet program. matrices can also be saved in the dip format used by the software diplomo  <cit> .

RESULTS
maximum likelihood  methods provide the best estimates of evolutionary change and genetic difference by modelling substitutions. models are used to calculate branch-lengths  that take into account the superimposition of substitutions and the similarities between one sequence or taxon and all others represented in the dataset  <cit> . hence, some patristic distances from ml trees are greater than the equivalent estimates of genetic distance, when the genetic distances are based on pair-wise comparisons between the raw sequences. the converse also occurs if patristic distances are calculated from a maximum parsimony tree, since characters that do not conform to the cladistic definition of phylogenetic information  are discounted. to demonstrate one of those effects we used patristicv <dig>  to plot patristic distances against uncorrected evolutionary distances, where the patristic distances were calculated from an ml tree of bunyavirus rna polymerase gene sequences and the evolutionary distances were obtained from pair-wise comparisons of the same sequences without reference to a tree . it can be seen that whereas the evolutionary  distances increased linearly the patristic distances were greater and increased exponentially.

another use of patristic distances is to investigate recombinational processes. a low correlation between distances obtained from different genes may indicate a recombinational process such as horizontal gene transfer  <cit> . influenza a viruses undergo a recombinational process, known as reassortment, that produces incongruities much like those produced by horizontal gene transfer, but on a smaller scale  <cit> , and the incongruities may be identified as poorly correlated patristic distances. we detected incongruities probably due to reassortment by plotting patristic distances calculated from the neuraminidase  and rna cap-binding protein  genes of a set of influenza a virus n <dig> subtype isolates ; we found that the majority of the points lie close to the regression line and appear to increase linearly, whereas some points fall well off the line. even when there has been no recombination, different measures of genetic difference from the same set of organisms may not correlate linearly. the rates of change in nucleotide sequences and the amino acid sequences they encode do not vary linearly because of the redundancy in the genetic code and because some sites reach a saturation point of superimposed substitutions. we demonstrated the effect by plotting patristic distances calculated from the nucleocapsid protein amino acid sequences and the equivalent nucleotide sequences of bunyaviruses ; the patristic distances from the nucleotide sequence tree increased at a greater rate than the equivalent patristic distances from the amino acid tree.

patristic distances have broader uses as it is sometimes of value to compare them with other data, such as data related to time or geographic distribution. for example, comparisons of the times of isolation and the distances between the sequences of influenza a virus strains describe an important process whereby the older strains are being eliminated from global circulation and being replaced by new strains. figure 2d shows that the patristic distances from an ml tree of the neuraminidase genes of a set of influenza virus isolates correlated with the differences in years between the times of isolation of the isolates.

CONCLUSIONS
a phylogenetic tree usually represents signals drawn from many sites in the sequences from which it was inferred, and it represents a hierarchy of those signals that may be nested. hence, the relationships between phylogenetic trees and sequences of interest are often complex and obscure. comparisons of patristic distances and other measures of genetic change allow the relationships to be analysed. patristicv <dig>  was developed to permit expedient comparisons and analyses. the program reads trees and distance matrices produced by the most commonly used software without editing. re-formatting is a time consuming element of multiple sequence and phylogenetic analysis and for that reason patristicv <dig>  creates no new intermediate formats. the need to re-order distance data from gene sequences or species was a major barrier that previously hindered analyses and that problem has been solved. the program is likely to be used to analyse recombination, rates of mutation and substitutional saturation and the evolution of rapidly evolving entities such as viruses.

availability and requirements
project name: patristic

project home page: 

operating system: platform independent

programming language: java

other requirements: java  <dig>  or higher 

any restrictions to use by non-academics: none
