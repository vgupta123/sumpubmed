BACKGROUND
understanding gene regulation is crucial to understand human development and to uncover the genetic basis of physiological and pathological processes. dna sequences known as cis-regulatory modules  play an important role in the tempo-spatial regulation of a gene. crms may be located a few dozen nucleotides from the transcription start sites or millions of nucleotides way. to activate a gene in a specific tissue, transcription factors  bind to their binding sites  in a crm. often, a co-activator protein binds to the tf complex and to rna polymerase ii, bringing the crm into close proximity to the promoter to start transcription  <cit> .

experimental methods to identify tissue-specific crms are available. one method relies on detecting dnase i hypersensitive regions that are strong makers of crms  <cit> . crms can also be recognized by identifying specific histone marks, such as h3k4me <dig>  h3k4me <dig>  or k3k27ac, for example  <cit> . visel et al.  <cit>  and blow et al.  <cit>  used chromatin immunoprecipitation followed by sequencing  to detect enhancers. the antibodies used in the chip-seq method target the co-activator p <dig> protein that forms a complex with tfs binding to a crm. candidate sequences identified by the above methods are usually fused to a reporter gene to be tested in transgenic animals. although experimental methods are effective in identifying tissue specific enhancers, they are relatively expensive, time consuming, and may require animal models. in addition, experimental methods are not perfect. for example, 87% and 62% of the p <dig> peaks obtained in  <cit>  and  <cit>  showed the expected tissue-specific activity in transgenic mice.

predicting crms from dna sequences is a challenging problem in computational biology. few computational methods take advantage of the availability of experimentally confirmed crms  <cit> . these methods apply supervised-learning algorithms to identify sequence features that are specific to the confirmed crms. sequence features may include motifs representing tfbss and words of specific length. even though these methods are useful in identifying tissue specific crms, they cannot be applied when there are not enough known crms for a desired cell type. since experimentally confirmed crms are not available for all tissues, alternative methods have been developed. several of these methods depend on detecting clusters of predetermined tfbss in a sequence  <cit> . these methods can be useful to search for a specific combination of tfbss. however, they cannot be applied when the regulating tfs or their motifs are unknown. searching for clusters of the same tfbs has been the underlying principle of related computational methods  <cit> . these methods can identify crms that include several instances of the same tfbs. they cannot identify those that include different tfbss.

crms modulating co-expressed or co-regulated genes are likely to share tfbss that comprise the regulatory signature. the main challenge facing the discovery of the regulatory signature of a group of related genes is the prohibitive number of all possible sets. to illustrate the difficulty, consider a set of  <dig> co-expressed genes. each gene locus has  <dig> candidate sequences . if only one sequence includes a cis-regulatory module of a gene, the total number of sets to be analyzed is  <dig>  next, we illustrate how computational methods have attempted to circumvent this challenge.

initially, computational methods limited the search for crms to the promoter regions or to the conserved elements within a few thousand nucleotides upstream of the transcription start sites   <cit> . grad et al.  <cit>  reduced the number of sequences to be analysed by searching for "similar short, conserved sequences" near the co-expressed genes. the enhancer identification  method  <cit>  searches for modules of tfbss enriched in conserved sequences in the promoter regions or in the "three most conserved" sequences in the vicinity of tissue-specific genes. further, the ei method reduces the number of sequences to be analysed by dynamically considering only sequences that include a tissue-specific tfbs module. pairs of nearby co-occurring words or tfbss can describe the regulatory signature of the promoters of tissues-specific genes  <cit> . the crm-pi  <cit>  method predicts crms based on pairs of interacting tfs by analysing "conserved regions" within  <dig>  kbp upstream of the tsss. then, it scans the regions  <dig> kbp upstream of tsss for segments that are enriched with the interacting tfs.

the above mentioned methods are successful in detecting tissue-specific crms modulating co-expressed or co-regulated genes. nevertheless, their search scope is limited. crms can be located hundreds of thousands of nucleotides from their target genes  <cit> . therefore, computational methods that can mine for tissue-specific crms among a large number of sequences are needed.

we designed and developed a probabilistic discriminative system, crmminer. crmminer attempts to overcome some of the limitations of the current state-of-the-art. specifically, crmminer is designed to mine for crms in a large number of sequences. hence, it has the potential to find crms thousands of nucleotides away from their target tsss. two principles provide the foundation for crmminer. first, crms, which regulate a group of tissue-specific genes, share tfbss. second, proteins never act in isolation. therefore, pairs of motifs representing co-occurring tfbss can be used to describe the tissue-specific regulatory signature.

crmminer overcomes the problem of mining for crms among a large number of background sequences by filtering out sequences that are not likely to include crms. the filtering step reduces the search space from thousands to a few hundreds of sequences. for example, the vicinity of a group of co-expressed genes includes thousands of sequences. a few hundreds of these sequences include crms. to reduce the number of sequences to be analyzed, during training crmminer identifies a subset of tens or a few hundreds of motif pairs that are enriched in this group of loci. at the same time, the system selects candidate sequences that include any of the selected pairs. this step results in set of a few hundred of sequences which are likely to include crms. often, there are thousands of motif pairs that are enriched in a group of loci. however, selecting the candidate sequences based on the entire set of the enriched pairs would result in thousands of sequences. the majority of these sequences do not include crms. as a result, the filtering step would be ineffective. therefore, we designed a greedy algorithm to select the final enriched pairs during training.

from the technical point of view, we formulated the task as a supervised classification problem. however, crmminer does not require experimentally validated crms. in sum, the contributions of our study are:

• the crmminer software,

• putative crms specific to  <dig> human tissues and cell types, and

• predicted regulatory signatures specific to  <dig> human tissues and cell types.

next, we describe the classification algorithm and discuss the performance of crmminer.

methods
crmminer
in this section, we present our discriminative probabilistic system, crmminer. the goal of crmminer is mining for crms in the vicinity of a group of co-expressed or functionally related genes.

input
the input to crmminer is two sets of sequences: a mixed set and a control set. the mixed set is assumed to include cis-regulatory modules  mixed with a large number of background sequences. in our experiments, the mixed sets consisted of sequences found in the vicinity of related genes. the control set consists of background sequences that are unlikely to include crms. a well-known problem in the field of machine learning is over-fitting the training data. over-fitting is manifested by an excellent performance on the training data; however, the performance on new testing data is poor. in other words, the algorithm does not perform as well on the testing data. to guard against over-fitting, the input sequences are partitioned into three sets:  training set, sequences in 50% of the loci;  validation set, sequences in 25% of the loci; and  testing set, sequences of 25% of the loci. we constructed a control set for each of the three mixed sets.

output
the output of crmminer is the predicted crms and their regulatory signature. the signature is represented by pairs of motifs of transcription factor binding sites . those crms should share the signature completely or partially.

overview
our procedure to predict crms consists of the following steps :

• scan sequences for motifs of known vertebrate tfbss.

• train crmminer on the training set:

- identify pairs of motifs that meet specific criteria.

- search the mixed and control sets for candidate sequences that include at least one of the selected pairs.

- score candidate sequences.

- determine a threshold that separates the scores of candidates found in the mixed set from those found among the controls.

- predict candidate sequences found in the mixed set as crms if their scores are above the threshold.

• validate crmminer's performance on the validation set. predict crms according to the list of pairs and the threshold, both of which are determined during training.

• repeat training and validation to find the parameters that result in the best performance on the validation set.

• test crmminer with the parameters determined in the previous step on the testing set.

scanning sequences for motifs of known vertebrate tfbss
we obtained  <dig> position weight matrices representing motifs of binding sites of known vertebrate transcription factors from the transfac  database  <cit> . the mast program  <cit>  scanned each sequence and its reverse complement to detect the presence of the  <dig> motifs. in the case where multiple motifs overlapped, all of them were kept.

selecting a set of motif pairs enriched in the training mixed set
the initial set of motif pairs is selected according to three criteria. first, the two non-overlapping motifs have to be near one another and separated by no more than a certain number of nucleotides . second, a pair has to occur at least a certain number of times in the mixed set . for example, suppose that the mixed set is expected to include  <dig> crms. the user may require a pair of motifs to be present in at least 10% of the crms. in this case, crmminer considers pairs that occur at least  <dig> times in the mixed set. third, the pair is more enriched in the mixed set than the control set. the enrichment of a pair p is measured by the e-valuep which is calculated as follows:

  e-valuep=lclm×nmnc 

lc and lm are the sum of sequence lengths in the control and mixed sets, and nm and nc are the number of times a pair occurred in the mixed and control sets. pairs that are not enriched in the mixed set  are excluded. however, not all enriched pairs are considered. the e-value of a pair has to be above the mean e-value of the enriched pairs, and less than 2- <dig> standard deviations above the mean . we avoid selecting pairs that are extremely enriched in the training set because they may not be enriched in other sets. in other words, those pairs may be potential outliers. the three parameters, discussed in this step, are adjusted automatically during validation.

selecting candidate sequences
the goal of this step is to select a set of sequences that are more enriched with sequences found in the mixed set than with controls. to this end, crmminer uses a greedy algorithm to collect such a set. for a set h, we define the e-valueh to measure the enrichment of h with sequences from the mixed set as follows:

  e-valueh=lclm×rmrc 

lc and lm are defined as before, and rm and rc are the number of sequences from the mixed and control sets in h. the algorithm depends on the enriched pairs determined in the previous step. the algorithm begins by sorting the enriched pairs in descending order. it considers the top k  enriched pairs in the list. for each one of the k pairs, crmminer calculates the enrichment value that may be obtained if sequences including this pair would be added to the set of candidate sequences . crmminer selects the pair that results in the best e-valueh. the sequences, which include this pair, are added to the set of candidate sequences. the chosen motif pair is removed from the sorted list and added to a list representing the regulatory signature. then, the algorithm repeats the search through the top k pairs in the updated sorted list. the rational for this step is that, although a pair could have the highest e-valuep, it may not result in the best e-valueh. therefore, examining other highly enriched pairs should provide a better alternative. the algorithm stops if at least one of the following three criteria is violated:

• the enrichment of the candidate sequences with sequences from the mixed set is above a threshold ;

• the number of sequences from the mixed set among the candidate sequences is less than the maximum allowed ; and

• the number of pairs, representing the regulatory signature, is less than the maximum number of candidate sequences gathered from the mixed set .

the algorithm selects a list of motif pairs representing the regulatory signature. in addition, it outputs candidate sequences found in the mixed and control sets. based on experimental results, it is recommended to set the minimum e-valueh to 3- <dig> fold, the maximum number of candidate sequences collected from the mixed set to 1- <dig> times the number of the expected crms, and k to 1- <dig>  we determine the values of these parameters automatically, by trying several combinations on the validation set.

to illustrate how the algorithm works, suppose that the training set includes  <dig> gene loci, where one crm is expected to regulate each gene. the user may wish to set k to  <dig>  the minimum e-valueh to  <dig> fold, and the maximum number of candidate sequences collected from the mixed set to  <dig> . using  <dig> allows, initially, at most one true positive in every three sequences because the user assumed that there are  <dig> crms. some of these sequences will be removed in the next stage. let p = {p <dig>  p <dig>  p <dig>  p <dig>  ..., pn} be the sorted list of motif pairs such that e-valuepi≥e-valuepj, ∀i <j. let s = {} be the set of motif pairs representing the regulatory signature. let h = {} be the set of candidate sequences. notice that h can include sequences from the mixed and control sets. the algorithm considers adding p <dig>  p <dig>  or p <dig> to s. suppose that motif pair p <dig> results in the highest set enrichment, e-valueh. then, p <dig> is removed from p and added to s. sequences including this pair are added to h. then, the algorithm considers pairs p <dig>  p <dig>  or p <dig>  crmminer stops if  the e-valueh drops below  <dig> fold,  h includes more than  <dig> sequences from the mixed set, or  the number of the selected pairs, |s|, is more than  <dig> 

predicting crms
crmminer searches the mixed and control sets for sequences that include at least one of the final motif pairs. we refer to this set of pairs as the tissue-specific regulatory signature. many of these pairs are expected to occur in control sequences by chance. to distinguish between candidates found in the mixed set  and those found among controls, crmminer trains a bayesian classifier  <cit> . a sequence is scored as the sum of the e-valuesp of the signature motif pairs present in it. the goal is to find a score above which a sequence is more likely to be from the mixed set than from the control set. our assumption is that a candidate sequence found in the mixed set should include more than one of the enriched pairs. in addition, the majority of control sequences should include at most one of the enriched pairs. therefore, the scores of candidate sequences gathered from the mixed set should be higher than those of their control counterparts. one way to find such a threshold score is to calculate the posterior probabilities of a sequence being from the mixed set or from the control set, given its score is greater than or equal to the threshold .

  p=p×pp 

  p=p×pp 

the threshold is the score that maximizes the log ratio of the class posteriors as in equation  <dig> 

  argmaxtlog)-log) 

note that c <dig> and c <dig> represent the mixed and the control classes. the evidence, p, does not need to be calculated. probabilities are calculated with respect to the candidate set that was determined in the previous step. the goal of the classifier is to remove  control sequences, and  sequences that belong to the mixed set and have scores similar to the scores of control sequences. given that the scores of controls are due to noise, it is appropriate to assume that they are normally distributed. crmminer searches for a threshold starting at the minimum score of controls with increments of  <dig> , and ending at one standard deviation above the average score of controls in the candidate set. a threshold within this range can eliminate up to  <dig> % of the noise due to the normal distribution properties.

optimizing crmminer's parameters
crmminer is controlled by six parameters. we designate the validation set to fine tune these parameters. during validation, crmminer uses the motif pair list  and the threshold that were determined at the training stage. the goal is to find a combination of the six parameters that enables crmminer to perform successfully on both of the training and validation sets. crmminer's performance is considered satisfactory if the predicted crms are significantly more enriched in the mixed set than in the control set. we use the one-tailed fisher's exact test to obtain a p-value as a measure of statistical significance. the results are considered successful if the e-valueh >  <dig> and the p-value is less than a threshold. since crmminer performs multiple tests on the training and the validation sets, we use the bonferroni correction to decide the significance threshold . for example, we searched  <dig> parameter combinations in our experiments described in the next section. hence, the significance threshold is  <dig> e− <dig>  in this study, sequences in the training mixed set were gathered from  <dig> gene loci. therefore, we tried crmminer with combinations of the following six parameters:

• distance between two motifs defining a pair: { <dig>   <dig>   <dig>   <dig>   <dig>  ∞}.

• minimum number of pair occurrences in the mixed set: { <dig>  8}.

• maximum pair enrichment value, e-valuep: average + { <dig>   <dig> ,  <dig>   <dig> , 4} standard deviations.

• minimum set enrichment value, e-valueh: { <dig>  5}.

• step size of the greedy algorithm, k: { <dig>   <dig>  10}.

• maximum number of candidate sequences collected from the mixed set: { <dig>   <dig>  320}.

one of two criteria can be used to determine the best parameter combination. first, the best parameter combination is the one that results in the highest significant e-valueh on the validation set. alternatively, we may search for a combination that results in the most significant validation p-value. for either criterion, we require a significant p-value and e-valueh >  <dig> during training.

testing
we use the training set to obtain the regulatory signature and a threshold to predict crms. crmminer parameters are optimized on the validation set. finally, the performance of the optimized system is assessed blindly on the testing set. a testing e-valueh >  <dig> and a p-value <  <dig>  suggest that crmminer found a common regulatory signature across the three sets.

next, we illustrate the procedures used to construct the mixed and control sets. the majority of the mixed sets in our study were assembled from conserved non-coding elements . the control sequences were sampled from the non-coding regions of the human genome.

data
in this section, we give details of collecting the data sets. crmminer requires a mixed set and a control set. the mixed sets were gathered from cnes located in tissue-specific gene loci, and the control sets were collected from non-coding genomic regions. in the following, we discuss:  how the tissue-specific genes were selected,  how gene loci were determined,  how the cnes were processed, and  how we obtained the control sequences.

determining cell-type-specific and tissue-specific genes
gene expression data in the gnf novartis atlas  <dig>  <cit>  are a valuable resource for our study. a tissue-specific gene is expected to be expressed in a certain tissue more than other tissues. to select a group of tissue-specific genes, a gene expression level is ranked relative to its expression levels in other tissues. specifically, we calculate the z-score of a gene expression level with respect to its expression levels in  <dig> non-cancerous tissues .

  sg=eg-meangstdg 

sg is the z-score of gene g, eg is the expression level, meang is the average expression of g in all tissues, and stdg is the standard deviation of g's expressions in all tissues. we ranked genes according to sg in a descending order. finally, the top n genes are selected.

determining gene loci
we determine the genomic location of genes using the hg <dig> refseq annotation  <cit> . the boundaries of a gene locus are the midpoints between the gene and each of the two flanking genes. if the gene is the first or last known gene on the chromosome, the locus starts or ends  <dig> kbp away from the start or the end of the gene of interest.

processing cnes
we obtained cnes from the ecr browser  <cit> . cnes are human sequences, hg <dig>  that are at least 70% identical with the mouse genome, mm <dig>  if a cne included a coding sequence, we removed the coding part and kept the rest of the cne. the shortest cne in our study is  <dig> bp long. cnes including less than 50% repeats were considered. cnes in the vicinity of tissue-specific genes comprise a mixed set.

collecting genomic control sequences
our database of control sequences contains  <dig> random sequences extracted from non-coding regions of the human genome. the control sequences are similar to cnes in length, gc content , and repeats content   <cit> . in this study, we constructed a control set specific to a mixed set. the distribution of sequence length in the control set is similar to that of the mixed set. we matched sequences in the mixed set to controls in the database according to ranges of  <dig> bp. for example, sequences of length 100- <dig>  200- <dig>  ... , and 1900- <dig> bp are matched with control sequences of length in the same ranges. if the mixed set includes sequences longer than  <dig> bp, these sequences are matched with control sequences longer than  <dig> bp. the ratio of sequence number in the mixed set to that in the control set is  <dig> to  <dig> 

in the next section, we evaluate crmminer on several data sets. first, crmminer performance is evaluated under controlled settings. then, we evaluate crmminer on real data sets.

RESULTS
our efforts resulted in a software called crmminer. the software is available as additional file  <dig>  crmminer has two specific goals. first, crmminer mines the vicinity of related genes for tissue-specific crms. in addition, crmminer searches for a common regulatory signature describing the predicted crms. this signature consists of pairs of motifs, which represent known vertebrate transcription factor binding sites. we start by defining the evaluation measures. then, we report the following:  the performance of crmminer under controlled settings,  a comparison between crmminer putative crms and experimentally validated crms,  the application of crmminer to predict crms specific to  <dig> human tissues, and  the application of crmminer to a group of genes functionally related to the human heart development.

to assess the performance of crmminer, evaluation criteria had to be determined. we used a statistical measure, e-valueh , to evaluate the performance of crmminer. recall that the e-valueh quantifies the enrichment of the predictions with sequences from the mixed set. to determine the significance of the enrichment, the fisher's exact test was applied to obtain a p-value. in addition, when experimentally validated crms are available, crmminer is evaluated in terms of the true positive , false positive , false negative , and true negative  predictions. when applicable, we used the sensitivity , the specificity , and the precision  to evaluate the performance of crmminer.

  sensitivity=tptp+fn 

  specificity=tntn+fp 

  precision=tptp+fp 

controlled experiments
mining for crms specific to the human cd4+ t cells under controlled settings
the vicinity of related genes include crms and other genomic sequences. to mimic this setting, we designed special mixed sets consisting of the human cd4+ t cells's dnase i hypersensitive sites   <cit>  and background sequences. hsss mark dna elements that take part in gene transcription. hsss often include transcription factor binding sites. also, they are strong indicators of crms. the exact number of crms among hsss is unknown; however, hsss are enriched with crms. the goals of this experiment are  to study the effect of the number of background sequences in the mixed set on crmminer performance, and  compare the performance of crmminer to that of cismodule  <cit> , a related crm predictor.

to begin, the loci of the top  <dig> genes, which are mainly expressed in the human cd4+ t cells, were determined. seventy-five loci were used for constructing the training mixed sets;  <dig> and  <dig> loci were used to construct the validation and testing sets. the training, validation, and testing loci included  <dig>   <dig>  and  <dig> hsss, respectively. we considered hsss that are at least  <dig> bp long and include at most 50% repeats. we assembled six groups of mixed sets. the training and validation mixed sets included the respective hsss in addition to x × l background sequences, x =  <dig>   <dig>   <dig>   <dig>   <dig>   <dig> and l is the number of loci used to assemble the set. the testing mixed set contained hsss only. the control sets included three times as many sequences as their mixed sets counterparts. we controlled for sequence length while selecting control sequences .

the underlying principle of a related crm predictor, cismodule  <cit> , is that tfbss usually cluster within crms. cismodule is based on a bayesian hierarchical model to learn overrepresented motifs that are "co-localized" in crms. the algorithm is unique in its ability to learn crms while it is learning the over-represented motifs. both cismodule and crmminer can be applied to mine for crms in the vicinity of tissue-specific genes. we trained crmminer on the training sets and optimized the parameters on the validation sets. the performance of crmminer was evaluated on the testing sets. to compare, we followed the same procedure to obtain cismodule predictions. specifically, we trained cismodule on the training set to find regulatory modules consisting of 3- <dig> motifs. the number of motifs that resulted in the best performance on the validation sets was used to obtain predictions from the testing sets. both crmminer and cismodule succeeded on the six testing sets. in other words, the testing e-valueh was more than  <dig> and the p-value is less than  <dig>  .

the true positive rates, the false positive rates and the precisions  of both methods were analysed. we considered a putative crm as a true positive if it overlapped with a hss. as expected, crmminer's true positive rate declined as the number of background sequences in the training mixed set increased ). crmminer true positive predictions were more than those of cismodule on the initial set . the true positive rates of both methods were comparable when x =  <dig> or x =  <dig>  cismodule true positive rates were higher than those of crmminer when x =  <dig>  x =  <dig>  or x =  <dig>  recall that the exact number of crms among hsss is unknown. therefore, we were not able to determine the sensitivities . to count the false positives, positive control predictions that overlapped with hsss were removed. in the six tests, crmminer's false positive rates were lower than those of cismodule ). finally, we calculated the precisions of both methods. we found that crmminer was 21%  - 75%  more precise than cismodule ). these results show that crmminer can reliably mine for crms in noisy data sets demonstrating its ability to retrieve functional crms.

results on random sets
the purpose of this experiment is to ensure that the observed enrichments were not due to a property of the algorithm, or of the predicted tfbss. we assembled  <dig> data sets in which the mixed sets were sampled from random genomic sequences. sequences of the mixed sets, i.e. the pseudo-mixed sets, and the control sets were random genomic sequences. the pseudo-mixed sets and the control sets were similar in sequence length distribution. a control set included five times as many sequences as its pseudo-mixed set. the pseudo-mixed sets were unlikely to share the same set of enriched motif pairs. when crmminer was evaluated on the  <dig> testing pseudo-mixed sets, crmminer failed, as expected, to predict the regulatory signature for all of them. these results suggest that the crms were predicted due to the shared regulatory signatures and not due to a property of the algorithm or the motifs representing the tfbss.

experiments
mining for crms specific to the human heart
in this experiment, we applied crmminer to search for conserved crms in the vicinity of heart-specific genes. specifically, we searched for crms among the human-mouse cnes. the goal of this experiment is to apply crmminer to retrieve known conserved crms by analysing cnes located in the vicinity of heart-specific genes.

we obtained  <dig> heart-specific genes . the loci of  <dig> of these genes were determined; the other  <dig> genes were located in random fragments of the genome. the  <dig> loci were randomly divided into  <dig> loci for training,  <dig> loci for validation, and  <dig> loci of testing. we assembled the three mixed sets  from the human-mouse conserved non-coding elements . initially, the mixed sets included cnes located between  <dig> kbp upstream and  <dig> kbp downstream of transcription start sites . we label this region, 10tss <dig>  then, we assembled additional eight sets by expanding the initial mixed sets to include the closest n cnes to tsss, if they were not already included. we assigned n to  <dig> ,  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>  and ∞ . about 75%  of the loci included  <dig> or less cnes. therefore, when n =  <dig>  the mixed sets included all cnes of at least 75% of the loci. the control sets had five times as many sequences as their mixed sets. both the mixed and control sets have similar distribution of sequence lengths. table  <dig> gives the details of the nine data sets.

the mixed sets consisted of cnes found in the vicinity of  <dig> heart-specific genes. nine sets were constructed. all mixed sets contained cnes within  <dig> kbp upstream and  <dig> kbp downstream of the transcription start sites . we expanded the mixed sets by including n cnes that are closest to the tsss, if they were not already included, n =  <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>   <dig>  ∞. a control set included five times as many sequences as its mixed set counterpart. we controlled for sequence length while assembling the control sets.

crmminer was trained on the training sets. for each of the nine sets, we trained crmminer and optimized the parameters on the training and the validation sets . the enrichment of the predicted crms with cnes, e-valueh, was calculated. the fisher's exact test was used to obtain a p-value to determine the significance of the enrichment. we selected the parameters that result in the most significant p-value on the validation set. both of the training and validation p-values were required to be less than  <dig> e− <dig>  due to the bonferroni correction. we evaluated crmminer, with the best parameters, on the testing sets. interestingly, crmminer succeeded in the nine tests. crmminer predictions  were significantly more enriched  with cnes than control sequences .

crmminer was evaluated on nine testing sets that were composed of cnes found in  <dig> heart-specific gene loci. pcrms stand for putative crms. controls stand for crms predicted among the control sequences. all mixed sets included cnes in the region between - <dig> kbp and + <dig> kbp. mixed sets were expanded as before. the number of cnes in the mixed set did not always increase when the number of the closest cnes, n, was increased because we randomly partitioned the loci into three sets every time n was increased. the fisher's exact test was used to calculate the p-values.

we previously developed a supervised-learning method to define the heart regulatory code from  <dig> known heart enhancers. we used this code to mine the sequence of the human genome and predicted about  <dig> putative heart enhancers   <cit> . to compare crmminer predictions to the phes, we started with scrutinizing the predictions obtained from the first set . this set consisted of  <dig> cnes,  <dig> of which overlapped with the phes. crmminer predicted  <dig> crms,  <dig> of which overlapped with the phes . our predicted crms were  <dig> -fold enriched with the phes . the expected overlap between the two sets was calculated by sampling  <dig> random sets from the  <dig> cnes. each of the  <dig> random sets included  <dig> cnes. we averaged the results of the  <dig> trails, and obtained the p-value by converting the z-score, which is based on the two-sets overlap distribution of the  <dig> trials. as we expanded the mixed set, the predicted crms continued to significantly overlap with the phes  up to  <dig>  folds. these results show the agreement between the two methods, even though crmminer was not trained on any known heart enhancers.

the phes were obtained by a supervised-learning method  <cit> . columns cnes and pcrms display the number of overlaps between the cnes and phes, and the pcrms  and phes, respectively. the expected number of overlaps between the cnes and the phes was calculated experimentally in  <dig> trials. in each trial, a set was randomly selected from the input cnes. these cnes are located in the  <dig> heart-specific gene loci and comprise the mixed sets that crmminer analysed. the number of cnes in a random set is the same as the number of the pcrms. then, the overlaps between a random set and the phes were counted. the expected number is the average overlap in the  <dig> trials. the z-scores were based on the distribution of the overlaps in the  <dig> trials. the p-values associated with the nine z-scores are  <dig> 

finally, we searched for further evidence to show that several of crmminer predictions are functional crms in the human heart. we previously collected a set of  <dig> experimentally validated human heart enhancers  <cit> . we assessed crmminer sensitivity  to detect known heart enhancers present in the mixed set. as a starting point, crmminer sensitivity was evaluated on the first set, n =  <dig>  this set consisted of  <dig> control sequences and  <dig> cnes, which are located in the 10tss <dig> regions. the mixed set included  <dig> known heart enhancers. crmminer predicted  <dig> crms including  <dig> out of the  <dig> heart enhancers . one may argue that these results are due to the abundance of enhancers in the 10tss <dig> regions. hence, these results might be obtained by selecting any  <dig> cnes of the  <dig> input cnes. to disprove this assumption, we calculated the expected overlap between the  <dig> heart enhancers and any  <dig> cnes from the mixed sets, as before. we found that  <dig>  enhancers are expected to overlap with a set of  <dig> cnes. crmminer predictions overlapped with heart enhancers about six-fold higher than the expected overlap . we obtained the p-value by converting the z-score. further, when the number of sequences in the mixed set was increased, crmminer remained sensitive to heart enhancers . for example, crmminer detected  <dig> out of  <dig> enhancers present in the seventh set . this set included  <dig> cnes and  <dig> control sequences. these results demonstrate crmminer ability to locate functional heart enhancers.

we calculated the overlaps of the cnes found in the  <dig> heart-specific loci and the putative crms  with  <dig> experimentally validated heart enhancers  <cit> . columns cnes and pcrms display the number of overlaps between the cnes and heart enhancers, and the pcrms and heart enhancer, respectively. the expected number is the average overlap between a random cne set and the heart enhancers. we selected  <dig> random sets as before. the p-values were based on the z-scores calculated from the distribution of the overlaps in the  <dig> trials.

mining for crms specific to the human cd4+ t cells
we took advantage of experimental data to evaluate crmminer performance on the human cd4+ t cells. recently, dnase i hypersensitive sites  in the same cell type have been determined experimentally  <cit> . hsss are indicators of regulatory elements. we used crmminer to predict crms modulating  <dig> genes specific to the human cd4+ t cells. we started with cnes located in the 10tss <dig> regions. then we expanded this set by adding the closest n cens to tsss. crmminer predictions were statistically significant up to n =  <dig> . these predictions are provided as additional file  <dig> .

the initial set  consisted of  <dig> cnes and  <dig> control sequences. predictions made at the training, validation, and testing stages were combined. in total, crmminer predicted  <dig> crms from the mixed set. in addition,  <dig> control sequences were predicted as positives. since the exact number of crms among hsss is unknown, the sensitivity cannot be determined. we used the precision and the specificity measures to evaluate the performance of crmminer. the  <dig> potential crms overlapped with  <dig> hsss . in comparison to  <dig> random simulations, we found about  <dig> of  <dig> input cnes are expected to overlap with hsss. therefore, the average precision of the random simulations is 41%. crmminer precision is two-fold higher than the average precision of the random simulations. when the  <dig> positive controls were examined,  <dig> of them were found to overlap with hsss . the average precision obtained from the  <dig> random simulations on the control set was  <dig> %. crmminer precision on the control set was about nine-fold higher than the average precision of the random simulations. crmminer achieved specificity of 99%. recall that the control sequences are random genomic sequences that are similar to the tissue-specific cnes in length only. therefore, the precision on the control set and the specificity give estimates of the precision and the specificity of crmminer on the human genome.

the results on the enlarged set, n =  <dig>  were similar . the following are the results on the largest set, n =  <dig>  the precision on the mixed set was 67% . the precision on the control set was 33% . crmminer specificity was 99%. these results show that many of crmminer predictions are functional regulatory elements specific to the human cd4+ t cells.

mining for crms specific to  <dig> human tissues and cell types
gene expression data of  <dig> non-cancerous human tissues are currently available  <cit> . crmminer was applied to the top  <dig> tissue-specific genes, divided into training , validation , and testing  sets. for each tissue, we assembled the mixed sets from the cnes located in the vicinity of the  <dig> genes. the control sets were assembled as before . initially, we applied crmminer to mixed sets that consisted of the cnes located in the 10tss <dig> regions . then the mixed sets were expanded by increasing n to  <dig>   <dig>   <dig> and  <dig>  because experimentally validated crms are not available for the majority of tissues, we used the e-valueh to evaluate the performance. recall that the e-valueh measures the enrichment of crmminer predictions with cnes in contrast to control sequences. crmminer performance on a testing set was considered successful if the e-valueh is greater than  <dig> and the enrichment with cnes is significant . we evaluated crmminer on the  <dig> testing sets. crmminer predictions for the  <dig> tissues/cell types are provided as additional file  <dig>  crmminer succeeded in 85%  of the initial sets . when n was increased to  <dig>   <dig>   <dig>  and  <dig>  crmminer succeeded in 82% , 79% , 60% , and 36%  of the tissues, respectively. table  <dig> lists the performance of crmminer on the testing sets  of the  <dig> tissues.

we trained, validated and tested crmminer on  <dig> human tissues and cell types  <cit> . the mixed sets consisted of cnes in the vicinity of  <dig> tissue-specific genes. those cnes were located within  <dig> kbp up or downstream of the tsss, or were among the closest  <dig> cnes to the tsss. here, we report crmminer performance on the testing sets. the number of motif pairs comprising the tissue-specific signatures are listed under the pairs column. the p-values were obtained by one-tailed fisher's exact test.

next, crmminer predictions, obtained from one of the expanded sets , are analysed. we assessed whether crmminer located potential crms in all of the tissue-specific gene loci. crmminer predicted crms located in 57% of the loci. three reasons can account for loci without putative crms:

• we searched only for conserved crms; however, crms may be weakly or not conserved  <cit> ,

• the missing predictions might be located outside the search range, and

• the missing crms may include unknown tfbss.

on average, crmminer predicted  <dig>  crms per gene. this is a known phenomenon. genes regulated by more than one crm were reported in the literature  <cit> . the average length of a potential crm is  <dig> bp which is almost twice as long as the average cne. recall that we controlled for sequence length while assembling the control set.

the cnes were distributed as follows:  <dig> % were in the promoters ,  <dig> % were in intronic regions, and  <dig> % were intergenic, whereas  <dig> %,  <dig> %, and  <dig> % of the putative crms were located in promoter, intronic, and intergenic regions. crmminer predictions were  <dig> -fold enriched with cnes located in the promoter regions . promoter regions are known to include crms  <cit> . therefore, these results suggest that these predictions are likely functional tissue-specific crms. in addition, crmminer predictions included distal ones. specifically,  <dig> % of the predicted crms were more than  <dig> kbp away from the tsss. consequently, the putative crms and the regulatory signatures can assist in understanding the tissue-specific gene regulation.

mining for crms specific to the developing human heart
crmminer can be applied to a group of functionally-related genes for which no expression data are available. we used crmminer to predict crms that can potentially regulate genes related to the development of the human heart. the availability of such putative crms should extend our understanding of the genetic basis of congenital heart diseases. we predicted crms located in the vicinity of  <dig> genes related to the human heart development . we obtained the functional annotation through the cardiovascular gene ontology annotation initiative . the  <dig> genes were divided into  <dig> for training,  <dig> for validation, and  <dig> genes for testing. crmminer was initially applied to the cnes located in the 10tss <dig> regions . then, the search scope was extended to include the n closest cnes to the tsss, if these cnes were not already included. we assigned n to  <dig>   <dig>   <dig>  and  <dig>  the control sets were similar to their corresponding mixed sets in sequence length distribution . the ratio of the size of the mixed set to that of the control set is 1: <dig> 

we trained crmminer on the training sets, and optimized the parameters on the validation sets. finally, crmminer was tested on the testing sets. regarding the testing sets, the predictions of crmminer were significantly more enriched with cnes than with control sequences. the highest testing e-valueh was obtained when n was  <dig> . based on the analysis of this set , the predicted regulatory signature consisted of  <dig> motif pairs . the maximum number of nucleotides separating two motifs is  <dig> nucleotides . these motif pairs were selected based on their enrichment values  during the training stage. to predict whether a sequence includes a crm or not, the sequence is scored according to the predicted regulatory signature. specifically, a sequence score is the sum of the e-valuep of the signature pairs present in the sequence. those pairs must meet the distance constraint . finally, a sequence that has a score of  <dig>   or above was predicted to be a crm.

crmminer predicted  <dig> motif pairs that comprise the regulatory signature of the developing human heart. the score of a sequence is the sum of the enrichment values  of any of the  <dig> pairs present in the sequence provided that a pair of motifs meets the distance requirement . a sequence that has a score equal to or above  <dig>  is predicted to be a crm specific to the developing heart. the  <dig>  is the threshold that was determined at the training and the parameter-optimization stages. the unit of e-valuep is fold.

the proposed signature included several tfs that regulate genes related to heart development. examples of such tfs are: e2f  <cit> , mef <dig>  <cit> , myod/bhlh  <cit> , srf  <cit> , sp <dig>  smad <dig>  <cit> , sp <dig>  <cit> , wt <dig>  <cit> , ap <dig>  <cit> , and ap <dig>  <cit> . this evidence indicates that our putative crms are likely to regulate genes modulating heart development. in addition, these results show that crmminer can provide useful biological insight in the absence of gene expression data.

discussion
in this section we compare crmminer to a closely related work and analyze the structure of the predicted regulatory signatures. in addition, the impact of the distance between the two co-occurring motifs on the performance is analyzed. then, we illustrate the applicability of crmminer to all sequences, regardless of their conservation degree, and to experimental data. finally, additional results are presented to show the consistency in crmminer performance on enlarged control sets.

comparison to related work
crm-pi  <cit>  is the work most closely related to crmminer. both tools are based on the same biological principles. specifically, they use enriched motif pairs to mine for crms in the vicinity of related genes. although these two methods are similar in principle, they differ in the following aspects:

• crm-pi identifies motif pairs in the "conserved regions" of the tissue-specific promoters, whereas crm-miner uses sequences, which are in the vicinity of 50% of the tissue-specific genes, to identify enriched motif pairs. these sequences are located in or outside the promoter regions.

• during training, crmminer selects a subset of the enriched pairs simultaneously while it is selecting the candidate crms. these two steps are independent in the crm-pi method.

• all "important" pairs contribute to a sequence potential energy, i.e. a sequence score that the crm-pi calculates. however, a sequence score calculated by crmminer depends on a subset of the enriched pairs.

• in the crm-pi method, the weight associated with a pair is a function of the enrichment and the distance between the two co-occurring motifs. the shorter the distance between the two motifs is, the higher the weight. we apply a 0- <dig> weighting scheme to the selected enriched pairs. if the distance between the two motifs is less than a threshold, the weight is  <dig> × e-valuep; otherwise, the weight is zero. our weighting scheme is inspired by two biological phenomena. first, it was observed that the interaction between two closely-located tfs is preserved when the distance between their binding sites is altered by up to  <dig> bp  <cit> . in other words, the two tfs still interact as long as their binding sites were separated by a maximum of  <dig> bp. by interaction, we mean that the two tfs produce their effects in synergy with each other. second, the spacing between tfbss in crms is flexible. it was observed that a complex between two tfs still forms if the distance  between their binding sites is increased by an "integral multiple" of  <dig> bp  <cit> . these two phenomena led us to adapt the flexible spacing scheme instead of a spacing system that favors tfbss that are located close to each other.

• crmminer requires three data sets. in comparison, crm-pi requires one data set.

• we apply the optimal bayesian classifier to determine a threshold above which a sequence is likely to be a crm. the classifier is trained on sequences that include at least one of the selected enriched pairs. these sequences are collected from the mixed and the control sets. the threshold used in crm-pi was determined experimentally on  <dig> control sequences. the threshold is the potential energy below which 5% of the control sequences are considered putative crms.

structure of the tissue-specific regulatory signature
to understand the composition of the regulatory signatures, we analyzed the  <dig> predicted signatures . we found that 22% of the tfs were components of more than 25% of the signatures, and 78% were parts of less than 25% of the signatures. for example, ubiquitously expressed tfs such as sp <dig> and ap <dig> were parts of 95%  and 88%  of the predicted signatures. tissue-specific tfs such as gata <dig> and otx <dig> were components of 25%  and 9%  of the signatures. these results suggest the following:  the majority of tfs comprising a regulatory signature are tissue specific, and  a tissue-specific regulatory signature is a combination of ubiquitously expressed tfs and tissue-specific tfs. such results confirm a similar recently published observation  <cit> . in addition, the interaction between tissue-specific and ubiquitously expressed tfs in a crm of the secretin gene has been previously reported  <cit> .

distance between the two co-occurring motifs
the parameter that controls the maximum distance between two co-occurring motifs has a biological significance. to gain the biological meaning of the parameter, we analyzed the impact of this parameter on crmminer performance on  <dig> tissues. the mixed sets of the  <dig> tissues consisted of the cnes that are located in the 10tss <dig> regions or are among the closest  <dig> cnes to the tsss. these tissues were chosen because there was statistical evidence indicating that crmminer succeeded in predicting their tissue-specific crms and the regulatory signatures. the performance of crmminer was the best on 89%  of the tissues when the maximum distance was constrained by a threshold. these results are supported by the phenomenon mentioned above, where two tfs function in synergy as long as the distance between their binding sites is less than a threshold.

input sequences
crmminer can mine for crms in conserved elements based on any conservation scheme. in addition, the user may choose to apply crmminer to any sequences regardless of their conservation degree. to illustrate, regions in the vicinity of related genes should be divided into shorter sequences of length, for instance, 400- <dig> bp. crmminer can be applied in an incremental manner. a good starting point is to apply crmminer to the non-coding sequences within  <dig> kbp up or downstream of the tsss. these regions can then be expanded by  <dig> kbp in both directions until the signal is lost. as a proof of concept, we applied crmminer to the 10tss <dig> regions of  <dig> genes specific to human cd4+ t cells. the non-coding sequences of these regions were divided into non-overlapping sequences of  <dig> bp in length. we trained, optimized the parameters, and tested on the training, validation, and testing sets. the predicted crms of the testing set were significantly more enriched with sequences from the mixed set than with controls . crmminer processed the mixed set which included  <dig> sequences and predicted  <dig> crms,  <dig> of them overlapped with hsss resulting in a precision of 63%, i.e.  <dig> of every  <dig> predictions overlapped with hsss. in comparison, the average precision of  <dig> random simulations was 28%.

further, we have demonstrated that crmminer can predict crms by processing tissue-specific hsss. recall that not all hsss include crms; they are enriched with crms. these results demonstrate the usefulness of crmminer to analyse experimental data such as hsss or histone marks.

experimental and predicted tfbss
currently, new technology such as the chip-seq makes it possible to obtain tissue-specific transcription factor binding sites. in the future, we will use experimentally determined tfbss or a mixture of experimental and predicted tfbss to detect tissue-specific crms.

size of the control set
crmminer requires a set that includes crms mixed with background sequences and another set of control sequences. in this study, the controls were sampled from the non-coding regions of the human genome. the two sets were similar in their sequence-length distributions. crmminer identifies the enriched motif pairs and the putative crms by contrasting the two sets. the control set needs to be large enough to accurately compute  the expected number a motif pair is found in the genome and  the threshold that separates crms from background sequences. initially, the control set contained five times as many sequences as the mixed set. we applied crmminer to these control sets and mixed sets that consisted of cnes located in the 10tss <dig> regions or were among the  <dig> closest cnes to the tsss. crmminer was able to predict the regulatory signatures of  <dig> tissues . when the ratio of cnes to controls was increased to 1: <dig> and 1: <dig>  crmminer succeeded in predicting the regulatory signatures of  <dig>  and  <dig>  tissues, respectively. these results show the consistent performance of crmminer on increased numbers of control sequences.

CONCLUSIONS
in sum, we designed and developed a new system called crmminer to predict crms modulating related genes. crmminer contrasts the mixed sequences to random genomic sequences to identify co-occurring motif pairs that are enriched in the mixed set. a subset of the enriched pairs is used to predict tissue-specific crms and the regulatory signature. the following lines of evidence support the validity of our method:

• under controlled settings, crmminer was able to find crms specific to the cd4+ t cells in noisy data sets up to a 1: <dig> signal to noise ratio.

• although crmminer does not rely on experimentally determined crms, its potential heart-specific crms overlapped significantly with heart enhancers predicted by a supervised-learning method. the model obtained by the supervised-learning technique required known heart enhancers for training.

• several of the predicted heart crms overlapped with experimentally validated heart enhancers.

• crmminer precision and specificity in detecting crms specific to the human cd4+ t cells reached up to 82% and 99%, respectively.

• as a starting point, we searched for crms located in the 10tss <dig> regions of co-expressed genes in  <dig> human tissues and cell types. statistical evidence suggests that crmminer succeeded in predicting crms specific to  <dig> human tissues and cell types. when the signal sets were enlarged to include the closest  <dig> cnes to the tsss, about 21% of the predicted crms were located more than  <dig> kbp from their target tsss.

• crmminer was also proven useful in mining for crms in the vicinity of genes related to the development of the human heart. prior published studies support the validity of the predicted tfs our method links to transcription regulation of the developing heart.

therefore, crmminer can play an important role in learning the genomic signature of tissue-specific crms.

availability
the crmminer software is included as an additional file  <dig>  the most updated version is available from the authors upon request.

project name: crmminer

operating systems: unix/linux

programming language: java and perl

other requirements: java  <dig>  or higher and perl statistics-lite module

license: the code provided by the authors, national center for biotechnology information , national library of medicine, is a work of the u.s. government and is not subject to copyright protection in the united states.

abbreviations
crm: cis-regulatory module; tss: transcription start site; hss: dnase i hypersensitive site; phe: putative heart enhancer.

authors' contributions
io and hzg conceived the study. hzg implemented the software. hzg and io designed the experiments. hzg conducted the experiments and performed the analysis. hzg wrote the manuscript. hzg and io approve the manuscript.

supplementary material
additional file 1
software. the crmminer software.

click here for file

 additional file 2
predictions for three tissues. this file contains crmminer predictions for the human adult heart, developing heart, and the cd4+ t cells. it includes the tissue-specific genes, the predicted signatures, and the putative crms.

click here for file

 additional file 3
predictions for all tissues. this file includes predictions for  <dig> human tissues and cell types. it includes the tissue-specific genes, the predicted signatures, and the putative crms. this file also contains predictions for the heart and the cd4+ t cells. we obtained these predictions by searching a larger set of parameters.

click here for file

 acknowledgements
the authors would like to thank sharon milgram and david landsman for helpful discussions. we also thank the anonymous reviewers whose comments have improved this manuscript. hzg thanks virginia locastro for her invaluable comments on the writing of the manuscript. hzg would like to thank loren hansen, ben busby, and jeff skinner for several discussions. the authors thank charles vinson for suggesting that the regulatory signatures consist of ubiquitously expressed and tissue-specific transcription factors. io thanks leila taher for providing the gene expression data. hzg is grateful to verma walker and the nih fellows editorial board for their help with editing. this research was supported by the intramural research program of the national institutes of health, national library of medicine.
