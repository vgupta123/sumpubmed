BACKGROUND
massive parallel dna-sequencing technologies have dramatically improved the researches in genetics, biomedicine, cancer evolution, and the other significant and intriguing fields in life science. however, an inevitable error rate of ngs  approaches ascribing to library preparation, sequencing et al.  <cit> , remains certainly high, ranging from  <dig>  % to 1 % varied in disparate platforms  and data processing strategies  <cit> . although the error rate presents feasibly tolerable in the case of studying high frequency mutations  <cit> , it severely obscures the precise determination of low frequency mutations  <cit> . taken a specific example, in the promising field of cancerous evolution, the sequencing errors arisen from ngs platform could be perfectly controlled in the case of studying germline mutations or high frequency somatic mutations  <cit> , however, they particularly hinder the unambiguous inference of the evolutionary trajectories of the cancer subclones  <cit>  due to the obscures of low frequency mutations.

additionally, precise calibration of genetic heterogeneity is well acknowledged as the prerequisite to understand the development and evolution of species and cancers. the de novo somatic mutations of offspring substantially facilitate the revelation of the genetic dynamics underlying biological processes , accurately evaluate the rates of spontaneous mutations  <cit> , and exquisitely profile the developmental trajectories of cell linages . furthermore, cascades of pioneering studies have confirmed that somatic mutations play critical roles in the formation of tumor heterogeneity  and drug-resistance  <cit> . nevertheless, majority of somatic mutations, unfortunately, has been characterized by low or ultra-low frequency  <cit> , which obscures their precise identification because of lacking of appropriate methods. theoretically, “abundantly deep sequencing” could address this problem and detect all, or at least most, of the mutations with low or ultra-low frequency, however, it can’t completely avoiding inherent pcr and sequencing errors and is barely feasible from the economical point of view  <cit> . as long as for a reasonable depth after compromising on costs and accuracy, it would always suffer from the bewilderment to distinguish very low frequency mutations and sequencing errors   <cit> .

thereby, detecting the low or ultra-low frequency mutations based on ngs platform appears intriguing but still remains incredibly challenging. great efforts have been substantially made to develop exquisite methods addressing this problem . majority of the methods utilizes unique barcodes  to eliminate pcr and sequencing errors , like safe-seq, duplex-seq. these methods tag every target molecule with different barcodes  and send them for sequencing. the produced reads with identical barcodes are regarded as one “read family” and are used to eliminate the pcr and sequencing errors. however, the efficiency of these methods relies heavily on the read number of each “read family”. to obtain high precision, one molecule should be sequenced many times; this constrains the application of these methods, especially for large genome analyses. cir-seq  tandems the replicates of one single-strand circularized molecule by rca   <cit>  to detect a tag-free read family. the original molecule can be sequenced at least twice by a pair of pe  reads by controlling the original dna fragment sizes; a pair of pe reads is termed as one “read family”. this method effectively overcomes the disadvantage of the barcode methods. however, rca inevitably introduces amplification bias, thus, greatly limiting the application of this method, especially when the input dna is low, such as for dna circulating in plasma or serum, forensic dna, dna of uncultured microorganisms, dna of tiny cancer sub-clones, and ancient, degenerated dna. the difficulty of rca bias is the same as that for whole genome amplification using mda  when the input dna is low.

in this study, we introduced an innovated method termed droplet-cirseq, which combines millions of pico-liter droplets and the cir-seq for uniform and ultrasensitive detection of rare mutations. compared with cir-seq, droplet-cirseq greatly reduced the amplification bias, represented more authentic allele frequency and detected rare mutations more effectively and precisely. droplet-cirseq was entitled with an incredibly low error rate of 3 ~  <dig> x 10- <dig>  according to the systematical assessment, droplet-cirseq detected  <dig>  times genuine snps more than cir-seq and had a  <dig> -fold lower false positive rate and a  <dig> -fold lower false negative rate when the input was 3 pg of circularized dna.

methods
droplet-cirseq library preparation
genomic dna  was sheared into 100 ~ 200 bp fragments in buffer ae  using covaris s <dig> in 100 μl volume , then purified with the  <dig> x ampure xp beads. the purified dna was phosphorylated at 37 °c for 30 min in a standard reaction consisting of 44 μl dna, 10u t <dig> pnk , 50 mm tris-hcl ph  <dig> , 10 mm mgcl <dig>  1 mm atp, 10 mm dtt, then was run on a 4 % agarose gel at 80 v for 80 min. subsequently, the gels with dnas in length of 80 ~ 140 bp marked with 20 bp dna ladder  were particularly cut off, and further extracted using qiagen minelute gel extraction kit . the ultimate dna concentration was calibrated using qubit  <dig>  dsdna hs assay kit.

a column of 20 μl dna  was denatured at 95 °c for 3 min, and immediately put on ice for another 3 min, then added by a mixture of  <dig>  μl 10x cirlagase buffer,  <dig>  μl 50 mm mncl <dig>   <dig>  μl cirligase . the mixtures were further incubated at 60 °c for 2 h, and the inner enzymes were inactivated by heating at 80 °c for 10 min. subsequently,  <dig>  μl exonuclease i  and  <dig>  μl exonuclease iii  were added into the reaction and jointly incubated at 37 °c for 1 h. the inner enzymes were inactivated at 80 °c for another 20 min. the successfully circularized dna was purified using the qiaquick nucleotide removal kit  and its final concentration was calibrated using qubit® ssdna assay kit.

a column of  <dig>  μl circularized dna was placed into  <dig> -ml tubes containing 5 μl 10x phi <dig> dna polymerase reaction buffer ,  <dig>  μl exonuclease-resistant hexamer ,  <dig>  μl 10 mm dntp, 1 μl 100xbsa, 27 μl ddh2o, which was denatured at 95 °c for 3 min, then put on ice immediately for another 3 min, and further added by a mixture of 1 μl udg , 1 μl fpg  and  <dig>  μl phi <dig> dna polymerase . the thoroughly mixed 45 μl rca reaction and 5 μl stabilizer were put into raindrop source chip  together to produce water-in-oil emulsion droplets as the manufacturer’s recommendations. in general, there will be 5 ~  <dig> million droplets per 50 μl volume formed in about an hour. the droplets containing rca mixture were completely reacted at 30 °c for 8 ~ 16 h, and the inner enzymes were further inactivated at 65 °c for 10 min. the emulsion was broken using pfo  to recover the amplified dna as follows: adding 2 ~  <dig> volume of pfo  to the reaction mixture and admixing thoroughly, incubating at room temperature for 5 min, then centrifuging at 3000 rpm for 5 min. the supernatant was then purified with  <dig> x ampure xp beads. the recovered dna can be used for preparing standard ngs libraries.

standard ngs library preparation
the amplified dna  was sheared into 700 bp in ddh2o using covaris s <dig> at 85 μl volume , then end-repaired using nebnext® end repair module  and purified with 1x ampure xp beads. the nebnext® da-tailing module  was used to da-tailing. 1x ampure xp beads were used to clear up the reaction mixture. ligation was performed at 20 °c for 30 min using nebnext® quick ligation module , 1 μl barcode adaptor  was used. the production was purified with 1x ampure xp beads and run on a 2 % agarose gel to perform the size-selection. the gel with dna in length of 500 ~ 700 bp was cut off and further extracted using qiagen minelute gel extraction kit . the ultimate dna concentration was calibrated using qubit  <dig>  dsdna hs assay kit. pcr was performed in a reaction consisting of 24 μl ligated dna  and ddh2o, 1 μl nextflex™ primer mix , 25 μl 2x phusion master mix with hf buffer  as the following cycling conditions: 98 °c for 2 min and 10 cycles of 98 °c for 30s, 65 °c for 30 s, and 72 °c for 1 min, then 72 °c for 4 min and held at 4 °c.

droplet-cirseq data processing
the data processing of droplet-cirseq and cir-seq reads is quite different from that of regular re-sequencing data. first, a consensus sequence should be determined from multiple tandem copies of circular dna within a pair of pe read. second, the break point of circularized dna should be accurately detected by mapping it to the reference genome.

the consensus sequences  can be determined by aligning read <dig> and read <dig> from the same pair of pe reads with a mismatch rate of approximately  <dig> . the detailed procedure of css determination was summarized as following. firstly, the read <dig> and the reverse complement of read <dig> are literally merged into one longer read according to their status of overlapping. the merged read contains copies of circularized dna. secondly, the merged reads are aligned against itself to determine the smallest unit of the circle. simultaneously, the base quality of the consensus sequence is scored according to its exact number and sequencing quality. for instance, if a site in the css is occasionally sequenced only once, a severe penalty would be assigned and thus discarded in the following process of variant calling. in case of a site with different bases in distinct copies, it is also considered to have a severe penalty and discarded.

the css were mapped onto the reference genome using bwa  <cit> . since every position of the css could be the correct junction of the linear dna sequence, we iteratively assign every base of the css as the start point of the linear dna sequence and independently mapped them onto the reference genome, where the one with the least number of mismatches and indels  was chosen as the original linear dna sequence, and further was utilized to call variants.

the source code of droplet-cirseq data processing is available on: http://sourceforge.net/projects/droplet-seqcode/files/droplet-code/.

standard ngs data processing
the 2x <dig> pe reads were mapped to the reference genome using bwa, the variants in terms of snps and indels were called using bcftools view with options of –bvcg. the variants were further filtered by quality  and a ratio of reference bases over alternative bases .

RESULTS
library construction and sequencing for droplet-cirseq
the strategies of library construction and sequencing for our droplet-cirseq were schematically illustrated in fig.  <dig>  as it elucidates, the genomic dna was sheared into small fragments, which were shorter than the length of a single pe read, to ensure that each fragment could be sequenced at least twice in a pair of pe reads. such a strategy that each fragment is repeatedly sequenced eliminates pcr error and sequencing error through exquisite data process . these fragments were denatured into single-strand molecules and then circularized by single-strand dna ligase. the circularized single-strand dna fragments were amplified independently in 5 ~  <dig> million water-in-oil emulsion droplets using phi  <dig> dna polymerase with random primers. in our study, we utilized the raindrop source of raindrop digital pcr system to produce the millions of picoliter droplets because of its competitive characteristic of generating droplets with extremely uniform dimensions. after amplification, the emulsion droplets were broken using 1h, 1h, 2h, 2h-perfluorooctane to collect the amplified dna, which was composed of tandem copies of the sheared dna fragments. the purified dna can be easily embraced into the standard protocols of ngs library construction on a broad variety of platforms, including the illumina hiseq and miseq, and life technologies ion pgm, et al. of note, it is importantly emphasized that the insert sizes of the standard ngs library is required to be at least twice longer than that of the original circularized dna, which guarantees the circularized dna was sequenced from different tandem copy units.fig.  <dig> overview of droplet-cirseq. a droplet-cirseq workflow. genomic dna was sheared into fragments shorter than half the length of the sequencing read and then denatured into single-stranded dna molecules that were circularized using single-strand dna ligase. after eliminating the linear dna using dna exonucleases, the circularized single-stranded dna was used for rca . the circularized dna and rca reaction mix was added to a raindrop source chip to produce water-in-oil emulsion droplets. generally, approximately 5 ~  <dig> million droplets formed in approximately an hour in a 50 μl volume. the droplets containing rca mix were allowed to continue to react for 4 ~ 16 h in order to amplify enough dna for standard ngs library preparation in the following steps. please note that the insert size of the standard ngs libraries must be larger than twice the length of the original circularized dna to avoid sequencing the same dna copy twice instead of sequencing two independent-amplified copies. b error correction. here is an example to explain the error correction strategy. multiple copies of the original circularized dna were examined in every pe read. “a”  represents the base, which may have errors generated during pcr or sequencing. there will be three cases present in the sequencing result: aa , no errors; ab , one read error; and bb , two read errors. b stands for t/c /g. in the following bioinformatics analysis, case  <dig> and case  <dig> will be filtered except when bb has the same bases, such as tt, gg, or cc 



in our case, based on the purified dna, we constructed the droplet-cirseq library by stringently following the protocol of droplet-cirseq library preparation , and generated 2x <dig> bp pe reads using the hiseq  <dig> platform. the pe reads were first used to detect the css after filtering out the low quality reads, and the css were then rotation-insensitively mapped to the reference genome to determine the junction sites of the circularized dna. the correctly mapped css were used to accurately identify the mutations. as comparison, another method, cir-seq was simultaneously implemented according to the abovementioned procedures without the droplets.

improved amplification uniformity of droplet-cirseq
as we known, cir-seq is developed as an innovative method that can effectively decrease the ngs sequencing error, thereby promisingly expected to facilitate the identification of low frequency mutations  <cit> . we assessed cir-seq libraries using phix <dig> dna in several independent experiments , however, it was illustrated that the ratios of read depth against the average across the whole genome ranged from  <dig>  x 10- <dig>  to  <dig>  , with a median of  <dig>  , and the depth coefficient of variance  of  <dig>  % . in contrast, the ratios for standard ngs  lightly fluctuated around a mean of  <dig> , with the depth cv of  <dig>  %. these statistics obviously implicated that cir-seq suffers from inevitable coverage bias that ascribes of the amplification preferences in the process of library preparation. the same phenomenon has been previously observed by the other researches  <cit> . such an inherent blemish referred as extensively amplification bias hinders its feasibility in the accurate exploitation of mutations in terms of snps, indels and copy number variations , since uniformity and efficiency of sequencing are the most pivotal concerns when amplifying dna molecules in vitro.fig.  <dig> the depth distribution of droplet-cirseq and cir-seq libraries. the first and last 100 bp of the genomes were excluded. a boxplot of depth distribution; y axis represents the log ratio of depth over mean of e. coli genome. two repeats of two different types of libraries were plotted. the droplet-cirseq libraries  showed more concentration depth distribution and more closeness to the mean value than the cir-seq libraries . b the phix <dig> depth distribution of the cir-seq  and standard ngs libraries . c the depth cv  of the droplet-cirseq, cir-seq, and standard ngs libraries. the droplet-cirseq library had a depth cv of almost  <dig> times less than that of the cir-seq library , but it was still higher than that of the standard ngs library. d the depth lowess  of the entire e. coli genome . the red and yellow lines represent the lowess of droplet-cirseq, while the blue and cyan lines represent the lowess of cir-seq



as a rule of thumb, two specific factors, in terms of the size of dna fragmentation and the rca reaction, may introduce amplification bias in cir-seq. previous studies  <cit>  have proposed that larger size of fragment specified as 90 bp had certainly improved the uniformity of sequencing coverage than the smaller one  in cir-seq. however, when we compared the cir-seq libraries with the standard ngs library , we found the cir-seq still suffered from severe coverage bias  . herein, our findings highlight that the small fragment size dedicated to the coverage bias in cir-seq, but which is definitely not the determinant factor. additionally, any method including cir-seq based on rca or mda reaction has been reported suffering from amplification bias when the input of dna is low, which is still the major technical challenge  <cit> . based on our results and experiences, a hypothesis has been naturally proposed that the rca system is probably the pivotal factor on account for coverage bias.

the promising strategies to overcome the barrier of coverage bias have focused on aspects in the forms of decreasing the reaction volume  <cit>  and reducing the amplification time   <cit> . in our case, we made great efforts in separating the circularized dna molecules into different compartments to reduce the uneven amplification in rca. we aimed to eliminate intermolecular competition during amplification and uniformly confine the amplification fold by embedding the circularized dna molecules into approximately  <dig> million pico-liter droplets that were similar in size. since the available number of total droplets is limited, we tested the amplification uniformity of droplet-cirseq and cir-seq libraries with 3 pg circularized e. coli dna. the sequencing results showed that the depth distribution of the droplet-cirseq was more concentrated to the mean depth  and the number of outliers dwindled . the cv of the droplet-cirseq depth was approximately 1/ <dig> of that of cir-seq  but was still higher than that of standard ngs library . the lowess  of the log ratio of depth over average across the genome also showed that the depth of droplet-cirseq was more uniform than that of cir-seq , indicating that the droplet-cirseq significantly reduced the rca bias by increasing the amplification probability of regions that were difficult to replicate in a tube and decreasing the amplification probability of regions that were more prone to be replicated. these results clearly demonstrated that droplet-cirseq significantly improved the uniformity of rca. it is more efficient to amplify low input circularized dna, as it allows more mutations to be identified with more accurate detected frequencies.

base error rate and error pattern of droplet-cirseq
to quantitatively assess the performances of droplet-cirseq and cir-seq in the forms of error rate and error pattern, we first sequenced two disparate e. coli strains, namely dh5α and w <dig>  using standard ngs libraries on the platform of illumina hiseq  <dig>  which achieves substantial reads with coverage as high as  <dig> x for each strain. the extremely deep sequencing facilitates the precise identification of the variations, which could be highlighted as calibration. after exquisite data processing, we unambiguously screened out  <dig> polymorphic sites  in the two strains.

subsequently, we mixed the dna of dh5α and w <dig> at a quantitatively specific ratio of 1: <dig> to simulate the circumstances of diploid with mutation frequencies of  <dig> . the mixture was further sequenced using droplet-cirseq and cir-seq libraries, respectively, on the platform of illumina hiseq  <dig>  as a consequence, for each library, approximately  <dig>  million of 2x <dig> bp pe reads were obtained, aligned and utilized to determine the css and thereby identify the variations. conveniently, we defined the variation that was supported by at least one cs as the “1x allele”, and the one supported by at least two different css as the “2x allele” aiming to further eliminate errors appearing during library preparation and sequencing. the error rates of droplet-cirseq and cir-seq were calculated as the fraction of identified mutations beyond the  <dig> polymorphic sites, which were interpreted as the genuine variations rather than errors. consequently, droplet-cirseq had an error rate of  <dig>  x 10- <dig>  when counting the “1x allele” , which was statistically comparable to that of cir-seq  . in contrast, the error rates of droplet-cirseq and cir-seq were decreased to  <dig>  x 10- <dig>  and  <dig>  x 10- <dig> , respectively, when counting the “2x allele”, where the error rate of droplet-cirseq presented significant lower than that of cir-seq .fig.  <dig> error rate and mutation types of droplet-cirseq. a error rate of droplet-cirseq and cir-seq. the “1x allele” represents the bases that were supported at least by one circularized dna, while the “2x allele” represents the bases that were supported by at least two different circularized dnas. the error rate of droplet-cirseq was  <dig>  x 10- <dig>  at the “1x allele” criterion and  <dig>  x 10- <dig>  at the “2x allele” criterion. b mutation types of droplet-cirseq. the error rates of most of the mutation types were lower than  <dig>  x 10- <dig>  but the error rates for the transitions c= > t and g= > a were almost one order of magnitude higher than the other types, and the other two transitions, a= > g and t= > c, also showed high error rates. the mutation pattern of the “2x allele” showed the same pattern as with the “1x allele”



furthermore, we profiled the error pattern for droplet-cirseq. the error spectrum when counting the “1x allele” represented a dominate pattern of c- > t and g- > a, which was consistent with previous reports  <cit> . in addition, the error patterns of a- > g and t- > c were also higher than other types in our data. the error spectrum of the “2x allele” also showed the same pattern. interestingly, these results provide evidence that transitions are more likely to cause errors than transversions. spontaneous cytosine deamination may contribute to the high error rate of c- > t and g- > a, as cytosine becomes uracil through deamination  <cit>  and then pairs with adenine, resulting in a c- > t mutation. similarly, spontaneous cytosine deamination will cause a g- > a mutation if it occurs on the complementary strand.

evaluation of the efficiency of snp calling by droplet-cirseq and cir-seq
next, we evaluated the capacities of mutation detecting for droplet-cirseq and cir-seq, respectively, under disparate scenarios in the mixture of two e. coli strains’ dna at a quantitatively specific ratio of 1: <dig> . mostly worthy of noticing, we just took the mixture ratio of 1: <dig> as a specific instance to profile the influence of amplification uniformity on snps detection, which doesn’t constrain droplet-cirseq to identify the mutations with frequency of 10 %. the considered scenarios consist of varieties in read depth  simulated by proportionally sub-sampling from the total css  and in quantity of input dna . as an important prerequisites, we exquisitely claimed a set of  <dig> highly confident sites out of  <dig> polymorphic sites after removing the low quality snps, indels and the common snps, which clearly distinguished the snps between the two strains and were further considered as the golden standard in the following analysis . as expected, with the increases of read depth, the identified number of snp consistently elevated . compared to the golden standard, droplet-cirseq averagely identified snps  <dig>  ~  <dig>  times as more as cir-seq when the initial dna input was 3 pg   at the “1x allele” criterion. similarly, at the “2x allele” criterion, droplet-cirseq also detected  <dig>  ~  <dig> -fold more snps than cir-seq  .fig.  <dig> detected mutation number, fpr and fnr of 3 pg droplet-cirseq and 3 pg cir-seq libraries. a, b the number of gold standard snps detected by droplet-cirseq and cir-seq methods with different css  numbers at “1x allele” and “2x allele” criterion . c, d fpr of 3 pg input droplet-cirseq and cir-seq libraries at “1x allele” and “2x allele” criterion. e, f fnr of 3 pg input droplet-cirseq and cir-seq libraries at “1x allele” and “2x allele” criterion



subsequently, we assessed the performances on the capability of snp detection for droplet-cirseq with different input dna amounts . the detected snp number of 3 pg droplet-cirseq was comparative to those of 30 pg and 300 pg at the “1x allele” criterion  but less than those at the “2x allele” criterion. intriguingly, the library with 30 pg input rather than 300 pg identified the most snps at the “2x allele” criterion , which naturally proposed a question that why 300 pg droplet-cirseq has not presented absolute superiority over 30 pg? according to the approximate weight of single-stranded dna molecule, each droplet accommodates an average of  <dig> molecules when the dna input is 3 pg input but up to  <dig> molecules when the dna input is 300 pg. relatively more dna molecules accommodated in one droplet makes the spatial separation of the droplets meaningless and results in the loss of superiority. in summary, three pivotal factors, namely read depth , amount of the input dna and the intermolecular interference, significantly influenced the snp detection for both droplet-cirseq and cir-seq, whilst, droplet-cirseq exhibits advanced performances on snp identification than cir-seq. we also noticed that  <dig>  %  and ~ <dig>  %  positive snps failed to be exploited by the droplet-cirseq, even with a substantial cs number of  <dig>  m , whilst,  <dig>  %  and ~ <dig>  %  failed to be detected by the cir-seq with the same cs number.

the fpr  and fnr  are also essential for evaluating snp detection methods. herein, we calculated the fpr and fnr for droplet-cirseq and cir-seq, respectively, based on the golden standard snps. of note, the fprs for both methods unfortunately reached as high as 81 % ~ 94 % with initial dna input of 3 pg and criterion of “1x allele”, which increased with cs number, but of which the growth rate relatively slowed down when the css achieving  <dig>  m . 3 pg droplet-cirseq presented slightly higher fpr compared to 3 pg cir-seq , whilst, preferably owned diminished fnrs across distinct read depths. 3 pg droplet-cirseq showed more comparative fnrs results with the 30 pg and 300 pg  than 3 pg cir-seq . as expected, the fnr for both methods sharply dwindled with the increase of cs number, with a range of  <dig>  % ~  <dig>  % , and the magnitude of reduction slowed down once the css exceeded  <dig>  m.

however, all the aforementioned findings recapitulated that the “1x allele” criterion was inaccurate and insufficient for distinguishing the true snps from errors. thereby, the “2x allele” criterion was introduced and assessed. consequently, the fprs for both methods drastically cut down, out of which, fprs for 3 pg cir-seq decreased to  <dig>  % ~  <dig>  % across distinct css numbers, while, those for 3 pg droplet-cirseq dramatically diminished to  <dig>  % ~  <dig>  %, significantly lower than that of cir-seq  . the 3 pg droplet-cirseq had the lowest fpr  compared to the 30 pg  and 300 pg droplet-cirseq  . to our surprise, the fprs for both 3 pg droplet-cirseq and cir-seq remained relatively unchanged as the increase of cs number, nevertheless, kept the augmentation for both 30 pg and 300 pg droplet-cirseq . conversely, the fnrs certainly increased when the “2x allele” criterion was applied, out of which, fnrs for 3 pg cir-seq ranged from  <dig>  % to  <dig>  %, whilst, those for droplet-cirseq exhibited  <dig>  % ~  <dig>  %, which was very significant lower than cir-seq  . the 30 pg droplet-cirseq had the lowest fnr  compared to the 3 pg and 300 pg droplet-cirseq , and the fnrs in spite of the initial dna input shrank with the augmentation of css number .

based on the above findings, a technical puzzle about droplet-cirseq has been literally proposed, why fnr still remains considerable and why droplet-cirseq still accommodates fp  sites after filtering with the “2x allele” criterion. to conveniently address this question, we refer to the fn  sites whose depths were less than or equal to 30x as the seq_bias  sites when the average depth was 80x, due to their sequence context interaction in the process of amplification in the rca reaction, and the fn sites with depths over 30x as the str_bias  sites, due to the uneven amplification of different dna strands. the 3 pg droplet-cirseq fn sites were composed by  <dig>  % seq_bias sites and  <dig>  % str_bias sites, whilst, the 3 pg cir-seq fn sites were characterized by  <dig>  % seq_bias sites and  <dig>  % str_bias sites . the relatively lower seq_bias of the 3 pg droplet-cirseq indicated its improvement of amplification bias by enhancing the amplification capacity of the poor replicate regions, however, there were still certain virgin regions remained. in addition, comparing the 3 pg and 300 pg droplet-cirseq libraries, the latter had less str_bias sites, which suggested that more input dna could decrease str_bias. such results were also concordant with the previous conclusion that more input dna and less intermolecular interference are effective on generating more uniform amplification and detecting more true snps. in other words, the fnr was influenced by the uniformity of the amplification and the input dna quantity. the droplet-cirseq method has advanced the uniformity of amplification, and its performance would be further ameliorated when more dna is added to more droplets.fig.  <dig> 
a fn site distribution of the droplet-cirseq and cir-seq. the seq_bias sites are fn sites with a depth less than or equal to 30x. the str_bias sites are fn sites with a depth greater than 30x but were still not detected as snps due to dna strand amplification bias. the 3 pg input droplet-cirseq method had a lower seq_bias, indicating that it improved the amplification of the poorly amplified region. the 300 pg input droplet-cirseq method had a lower str_bias, indicating that greater input improved str_bias. b mutation type of fp sites. c true positive snp frequency distribution for droplet-cirseq and cir-seq; the box width indicates the detected snp number, the outliers were excluded. d mutation frequency of fp sites. e fpr of different input droplet-cirseq libraries after filtering with the mutation frequency pattern. f fnr of different input droplet-cirseq libraries after filtering with the mutation frequency pattern



in reference to the fp sites, there were totally  <dig> fp sites in all libraries . out of them, we have to say, there might be genuine snps, which are actually supported by only 1 ~  <dig> reads but treated as random errors in the standard ngs data process due to the ultra-low frequency. we investigated and revealed  <dig> sites under such a circumstance. additionally, there is one common site at e.coli:  <dig> shared by each droplet-cirseq, which was actually a heterozygous site but failed to be detected by bcftools. besides this common site, the other  <dig> fp sites richly represented in two types of base substitutions, namely g to a  and c to t  .

then, we profiled the mutation spectrum of tp  and fp sites for droplet-cirseq and cir-seq, respectively. the frequencies of tp sites for both methods in the case of 3 pg dna input were all averaged at the true frequency , while, droplet-cirseq presented more concentrated and representative of the true frequency than cir-seq libraries  . majority of tp sites exhibited relatively high frequencies, and only  <dig>  % had frequencies lower than  <dig> . in contrast,  <dig>  % of fp sites were characterized by lower frequency , where,  <dig>  % had frequencies lower than  <dig> , and  <dig>  % were between  <dig>  and  <dig>  . the distinguishable frequency spectrums between tp and fp sites hint that fp sites could be partially filtered out according to the frequency pattern. in our case, after filtering out mutations with frequency less than  <dig> , the fpr was significantly decreased to  <dig>  % for the droplet-cirseq libraries , whilst the fnr remained nearly the same . it is also noted, compare to the average sequencing depth of the genome ,  <dig>  % of the fp sites inhabited in the regions with depths higher than 100x, which were prone to amplification in the rca reaction. additionally, for the different dna input amounts for droplet-cirseq, the 3 pg droplet-cirseq had the lowest fpr before filtering and showed the least change in fpr after filtering, indicating the amplification of the 3 pg droplet-cirseq was the most uniform.

discussion
cir-seq reduces high throughput dna sequencing errors by linking the tandem copies of one dna fragment in one reaction of paired-end sequencing but suffers from severe imbalance of amplification. to avoid such blemishes, we developed an innovated method termed droplet-cirseq. the droplet-cirseq approach combines millions of picoliter droplets and the cir-seq method for uniform and ultrasensitive detection of rare mutations. the picoliter droplets are used to eliminate the intermolecular competition of dna molecules and thus improve the efficiency of the amplification of the poorly replicated region. on the other hand, picoliter droplets provide an equal volume of reagent and the byproduct pyrophosphate, together with the uniform size and infinitesimal volume of the droplets, to confine the final amplification yields of the regions which were more prone to replication. these advantages allow this droplet-cirseq method to amplify circularized single-stranded dna with much less bias and detect rare mutations more effectively and precisely than other methods. droplet-cirseq has the error rate of 3 ~  <dig> x 10- <dig> for snps with one consensus sequence , and this was decreased to 3 ~  <dig> x 10- <dig> when the snps were supported by two consensus sequences with different breakpoints .

the error rate of droplet-cirseq at the “2x allele” criterion, which is close to the limitation of detected mutations in vitro based on ngs methods  <cit> . under this low frequency, the dna damage errors produced during dna extraction and preparation became the dominate error source, and these errors are difficult to distinguish from the genuine low frequency mutations. fortunately, droplet-cirseq is quite suitable for low input dna and, therefore, provides an alternative solution for detecting ultra-low frequency mutations by reducing population size. for example, one mutation in a large tumor nodule with a frequency of 1x10- <dig> cannot be detected by current methods. however, we can sample the tumor several times by taking a small number of cells so that the mutation frequency in some samples will increase to a detectable level. small population size implies low dna quantity, which has limited mostly current low-frequency detection methods  but is suitable for droplet-cirseq. the ultra-sensitive and uniform detection of mutations by droplet-cirseq with low input dna makes it the competitive method for successfully detecting mutations in small populations with low quantity dna.

to understand the relationships between and among input circularized dna, droplet number, amplification uniformity and snp detection capability, we tested different input dna amounts  for droplet-cirseq library preparation using approximately 5 ~  <dig> million droplets. three picogram droplet-cirseq obtained the best amplification balance , while 300 pg droplet-cirseq obtained the worst  . this suggests that increasing the amount of dna within one droplet decreased amplification uniformity. however, the results of mutation detection demonstrated that 30 pg droplet-cirseq identified the most genuine mutations. in general, the capacity of mutation detection is determined by two factors, the input dna quantity, and the uniformity of the amplification. thirty picogram droplet-cirseq may have the best tradeoff between input dna quantity and amplification uniformity. droplet volume is also critical for proper amplification. if the droplet volume is too large , it will not effectively inhibit the region that is prone to amplification. if the droplet volume is too small, it will lead to insufficient amplification or other unpredictable problems. collectively, increasing the droplet number, reducing the amount of circularized dna contained in each droplet and decreasing the droplet volume appropriately will result in better amplification.

in this study, we mixed two e. coli strains  at a ratio of 1: <dig> to compare the uniformity of the amplification and capability of mutation detection for droplet-cirseq and cir-seq. the results of this study clearly showed that droplet-cirseq has a great advantage over cir-seq in detecting mutations. this advantage of droplet-cirseq is diminished when it is compared with the standard ngs methods because of its relatively unbalanced amplification and double correction scheme; however, the advantage of droplet-cirseq over standard ngs methods is incomparable when it is used to detect low frequency mutations. we also mixed two e. coli strains at a ratio of 1: <dig>  the “2x allele” analysis revealed a fpr of 25 %, out of which, two dominant substitutions c = > t and g = > a accounted for  <dig>  %. this phenomenon was consistent with the error pattern of droplet-cirseq and has also been reported by many other previous studies . worthy of noting, droplet-cirseq still remains considerable poorly amplified regions , which ascribes of inherent characteristics of rca and this pattern was repeatable and stable.

compared with cir-seq, the droplet-cirseq approach has more uniform amplification, more accurate mutation frequency detection, a lower false positive rate, and a lower false negative rate. droplet-cirseq will be one of the best choice for detecting mutations at frequencies ranging from 10- <dig> to 10- <dig>  droplet-cirseq has an unparalleled advantage for low input dna. droplet-cirseq can be widely used for detecting low frequency mutations of circulating dna in the plasma, dna of uncultured microorganisms, dna of cancer subclones and dna of tumor-associated niche cells. it can also be used to filter out the errors in degenerated ancient dna and formalin-fixed, paraffin-embedded dna samples, et.al.

CONCLUSIONS
in this study, we described a novel approach namely digital droplets-based circle sequencing, abbreviated as droplet-cirseq, which is able to detect low or ultra-low frequency mutations with greatly reduced amplification bias. briefly, it introduces a pico-liter amplification system to cir-seq to improve the amplification bias. as expected, the coefficient of variance of read depth for droplet-cirseq was merely 1/ <dig> of that of cir-seq, and the identified allele frequency presented more concentrated to the authentic frequency of mixtures, illustrating a significant improvement of amplification bias and accuracy in allele frequency determination. in addition, compared to cir-seq, our method owns the competitive characteristics with an incredibly low error rate of 3 ~  <dig> x 10- <dig>  capability of rescuing  <dig>  times of genuine snps at the same sequencing depth, a lower false negative rate, and an even lower false positive rate. intriguingly, droplet-cirseq can successfully take pico-gram level of dna as input. with the particular characteristics and competitive features, droplet-cirseq would be promisingly and widely used in the identification of low frequency mutations initiated from extremely low input dna, such as circulation dna of plasma, subpopulation within tumor et al.

availability of supporting data
the data sets supporting the results of this article are available in the ncbi sequence read archive  repository,  under accession number: prjna <dig> 

additional files
additional file 1:  supplemental figures s1-s <dig>  comparations of depth distribution, detected snp numbers, fpr and fnr between droplet-cirseq and cir-seq. 

additional file 2:  supplemental table s <dig>  w <dig> and dh5α specific polymorphic sites. 



abbreviations
cnvscopy number variations

cssconsensus sequences

cvcoefficient of variance

fnrfalse negative rate.

fprfalse positive rate

indelssmall insertions and deletions

lowesslocally weighted scatter plot smoothing

mdamultiple displacement amplification

ngsnext generation sequencing

pepair end

rcarolling circle amplification

competing interests

the authors declare that they have no competing interests.

authors’ contributions

klw, qm, sjl performed the experiments, klw, jr performed the bioinformatic analyses. jr, klw, lj participated in the design of the study. jr, ciw, xml conceived of the study and participated in its design and coordination. klw, ylh, jr wrote the manuscript. all authors read and approved the final manuscript.

