BACKGROUND
there is almost no species that is not attacked by parasites. from an evolutionary perspective, host-parasite interactions are of fundamental importance, because these interactions can have very strong fitness effects on both hosts and parasites. for any given species, it is hard to imagine a change of environment that is as fast, as consistent and as profound as that constituted by its coevolving parasite  species. a particularly intriguing and much debated aspect of host-parasite coevolution is the so-called red queen hypothesis   <cit> . in a nutshell, the rqh states that the antagonistic coevolution between host and parasite leads to cyclical dynamics, also called red queen dynamics , which favor genetic shuffling  <cit> : the host continuously tries to escape the parasite which in turn responds to each adaptation with the corresponding counter-adaptation. in this arms race, recombination may offer the host the opportunity to generate novel, and therefore potentially resistant, offspring more quickly.

the only genetic effect of shuffling  is to reduce linkage disequilibria , i.e. statistical associations between alleles at different loci in the genome. thus, any theory that attempts to identify an evolutionary advantage of genetic shuffling must be based on a beneficial effect of reducing linkage disequilibria. in the context of the rqh, the benefit of genetic shuffling is associated with breaking up linkage disequilibria in the host population that are generated by selection pressures imposed by the coevolving parasite population. specifically, a prerequisite for the rqh is that the host-parasite interaction generates persistent ld oscillations. if these ld oscillations would wane over time, then selection for recombination/sex can at best be transient. indeed, standard models of the rqh  <cit>  do show persistent ld oscillations. however, given that oscillations are often structurally not robust , it is surprising that the question of robustness has been largely ignored in the context of the rqh.

here, we investigate one of the standard models for the rqh  <cit> , a discrete time model that uses a specific updating scheme where host and parasite frequencies are updated simultaneously. we then investigate two slightly modified models:  a continuous-time version of the standard model , and  a discrete-time version with a different updating scheme . while the standard model  <cit>  includes most interaction types that have previously been studied , we restrict our discussion to the matching-allele type  and neglect the  gene-for-gene type  <cit>  which is generally known to exhibit selection against sex/recombination. in the first part of our analysis, we focus on the classical matching-allele type  and then extend our scope to more general types of interaction  <cit> .

interestingly, we find that the proposed modifications of the standard model lead to a strong dampening of ld oscillations, which is driven by recombination and mutation. in addition, we find that even in the standard model, dampening occurs under some circumstances. these observations suggest that ld oscillations in the red queen are structurally not robust. if host-parasite interactions could maintain ld oscillations only transiently, the plausibility of the rqh would be severely undercut.

to investigate what factors could contribute to the persistence of ld oscillations we study here the effect of finite population size. in particular, we study the dynamic behavior of stochastic versions of both the standard simultaneous-updating model and of the alternative sequential-updating model. we have chosen to consider the sequential-updating model as a representative of the alternative models because it can be conveniently transformed into a stochastic model. we find that in the alternative model, drift indeed helps to maintain ld oscillations, and as a consequence, population size can strongly affect selection for recombination or sex. this contrasts the situation in the standard model where the effects of drift are much less pronounced and restricted to weak selection coefficients. finally, we consider the evolution of sex/recombination in a broader set of interaction types  and show that our results hold for the majority of these interaction types.

RESULTS
the structural robustness of ld oscillations in deterministic models
a peculiar and hitherto unnoticed consequence of deterministic modeling of host-parasite coevolution is that the amplitude of the resulting linkage disequilibrium  oscillations may decrease over time and eventually reach negligibly small values. ld oscillations can be damped in all three models . the dampening is a general phenomenon in the two alternative models, but in the standard model, it is only observed when selection coefficients are small . moreover, for weak selection, the type of ld oscillations in the standard model depends on the initial conditions: either the oscillations are weak but stable, or the oscillations are damped. for random initial allele frequencies, both scenarios seem to occur with similar frequency.

previous analyses of the standard model  <cit>  did not report any dampening. the dampening of the ld oscillations may have gone unnoticed for several reasons. first, for very weak selection, the dampening is particularly slow. second, in the standard model , only the ld oscillations are damped while the genotype-frequencies remain oscillating with a stable amplitude . third, the dampening does not occur for strong selection, even if selection is strong only for the parasite . overall, our simulations show that stability of ld oscillations is not a generic feature of the standard model, unless selection is strong on the parasite.

the sequential updating model exhibits substantial dampening of the ld oscillations for various recombination rates, mutation rates and selection coefficients ranging over several orders of magnitude . moreover, the rate of the dampening depends on both the mutation rate and the recombination rate , with high mutation and recombination rates causing faster decay. the continuous-time model shows a qualitatively similar behavior . these patterns suggest that for the alternative models, the antagonistic interactions between hosts and parasites alone are not able to maintain genotype- and ld oscillations against the dampening forces of mutation and recombination. taken together, these results suggest that stable ld oscillations are not a robust feature of rq dynamics.

testing the impact of stochasticity
in order to analyze the effects of  population size on the rqh, we developed stochastic versions of our models . this is straightforward for the discrete-time models , but more cumbersome for continuous time models. we therefore focus on the two discrete-time models: the standard model illustrates the role of stochasticity for systems in which oscillations can be maintained deterministically, and the alternative  model illustrates its role for systems in which oscillations are damped deterministically.

stochasticity can help to maintain the ld oscillations
in the stochastic regime, ld oscillations can be maintained indefinitely even in the alternative model . this result holds for a wide range of mutation rates, recombination rates, and population sizes . of special interest is the impact of population size on the ld amplitude that can be maintained at steady state . in the standard model, stochasticity increases the amplitudes of ld oscillations only for small selection coefficients, i.e. for those parameter values where damped oscillations occur in the deterministic model. in the alternative model, on the other hand, the amplitudes of ld oscillations increase with decreasing population size independent of selection coefficients. in particular, the amplitudes of ld oscillations tend to negligibly small values as population size grows to very large values . thus, while mutation and recombination can dampen the ld oscillations, finite population size counters this process.

consequences for the evolution of recombination
how does the dampening of the ld oscillations affect the evolution of sex and recombination? the mechanism underlying the rqh requires fluctuations of ld and epistasis , which in turn strongly depend on population size . thus, an effect of population size on the evolution of recombination seems evident.

to analyze this effect, we distinguish between two cases:  the competition between a sexual and a completely asexual type and  the competition between two sexual types with different recombination rates. both cases can be considered with the same model  but correspond to two different biological scenarios: the first case describes the replacement of a sexual by an asexual population. the second case describes the successive change of recombination rate. several studies  <cit>  have shown that the rqh depends crucially on the linkage between the modifier and the genes involved in host-parasite interactions. in particular, selection for higher recombination rates is generally more favored when linkage is tight. in the competition between sexual and asexual types, recombination occurs only between sexuals . therefore, the modifier responsible for asexuality never switches its genetic background, i.e. it is tightly linked to the rest of the genome. thus, the requirements that need to be met for the rqd to favor sexual over asexual types are less stringent than those that need to be met to favor high over low recombination rates, since in the latter case, the modifier can recombine away from the genotypic combinations that it produces . we model the competition between sexuals and asexuals by setting the recombination rates rmm and rmm to  <dig>  and rmm>  <dig>  and the competition between modifiers coding for low and high recombination rate by choosing recombination rates  <dig> <rmm <rmm < rmm.. note that the modifier is selectively neutral, i.e. costs of sex are not included in our simulations.

the impact of the interaction type
the preceding discussion was based on the matching allele interaction type. in order to investigate the impact of the interaction type, we measured the selection on a recombination/sex modifier for the generalized matching allele interaction type  with selection coefficients s <dig> and s <dig> ranging from  <dig> to  <dig> with a gradation of  <dig>  . the results are summarized in figures  <dig>   <dig>   <dig>   <dig>  figures  <dig>  and  <dig>  correspond to the standard model and figures  <dig> and  <dig> to the alternative model. these figures show that for most interaction types, the impact of population size is qualitatively the same as for the matching allele interaction type: in the standard model, drift only increases the strength of selection on the modifier when s <dig> and s <dig> are small. in the alternative model, however, drift increases the strength of selection for the whole range of s <dig> and s <dig>  the only exception to this pattern can be found in the in the vicinity of the mma . in this region, we observe a strong selection against sex/recombination even in the deterministic regime. the figures show that with decreasing population size this region  shrinks and the strength of selection against sex/recombination decreases. the reason for this effect is that systems with an  multiplicative fitness function exhibit a different dynamic behavior than those with stronger interactions: instead of periodic alternations of positive and negative ld, the system converges to a state in which the ld does not change its sign anymore . other than this effect around the mma, finite population size does not have any appreciable effect on the direction of selection on the modifier: independently of population size, sex wins against asex for the vast majority of interaction types , and high recombination wins against low recombination only if the selection coefficients are strong enough.

discussion
our results show that damped ld oscillations are the rule for the sequential-updating and the continuous-time model. in the standard model however, damped ld oscillations occur rarely . moreover, persistent oscillations have also been observed in a model with interaction types different from the ones used here  <cit> . thus, the dampening of the ld oscillations depends on the specific implementation of the host-parasite interaction. this raises the question whether damped or persistent oscillations are the generic case. which of the models investigated here is most applicable to any particular host-parasite interaction strongly depends on the corresponding biology. the sequential-updating model, for example, describes a situation in which the parasite population can first adapt to the host population for a few generations, and only subsequently affects host fitness. this pattern might be realized if at the start of every host-generation, the parasite population is small  and later, after a number of parasite generations, reaches an appreciable size . the standard model assumes that the fitness-effect of a host-parasite interaction affects host and parasites simultaneously. which scenario is more plausible is, in our view, debatable. more important, however, is the fact that oscillations are also damped in the continuous time model , suggesting that  the dampening is not an artifact that is particular only to the sequential updating model and  that the dampening cannot be attributed exclusively to sequential versus simultaneous updating. the difference in the dynamical behavior of the standard model and the continuous-time model is in line with the general observation that discrete-time models tend to show more oscillatory behavior  <cit> . continuous-time models are commonly considered more appropriate when reproduction is not fully synchronous. finally, the view that persistent ld oscillations are structurally not robust is further supported by the fact that even the standard model exhibits damped-oscillations when selection is weak.

the observation that the persistence of ld oscillations may not be structurally robust places a larger emphasis on the possible role of stochastic effects in the context of the rqh. if oscillations are persistent in the deterministic model, then drift is not required to maintain considerable oscillations and population size only has a modest impact . if, however, the oscillations are damped in the deterministic model, then drift is a necessary requirement for persistent rq dynamics and the strength of the selection for recombination depends crucially on the population size. in this latter case, the rqh should be considered as an essentially stochastic hypothesis, in contrast to the traditional view which classifies it as deterministic  <cit> .

in the alternative model , we generally observe stronger selection on modifiers of sex and recombination in small populations. this could be explained by two main mechanisms. the first mechanism is based on the observation that the amplitude of the ld- and epistasis- oscillations depend strongly on the population size , reaching the largest values for small populations. this explains the strong selection in small populations . alternatively, the impact of population size could merely reflect a superposition of the rqh  and the well-known fisher-muller effect, which states that in finite population under directional selection, recombination can increase the response to selection  <cit> . however, we found that if the corresponding deterministic model exhibits persistent oscillations, decreasing population size does not increase the strength of selection on the modifier . this speaks against the fisher-muller effect but is in line with the expectation based on the first mechanism. we therefore think that the first mechanism is more plausible, although it is conceivable that the fisher-muller effect also contributes to selection on the recombination modifier.

on first thought, the observation that sex/recombination is strongly selected against for interaction types close to the mma seems paradoxical, because both host and parasite loci determine fitness in a multiplicative fashion. thus, one might expect that there is no epistasis. as a consequence, no ld should build up, and there should be no selection for or against sex in the region close to the mma . this expectation, however, does not take into account that the epistasis experienced by the host population is a result of both the interaction matrix  and the disequilibrium of the parasite population . in our simulations, we see that if recombination is small, host and parasites that interact according to the mma  seem to behave in a very particular way: if the system starts exactly at the "central equilibrium" , the system stays there and no ld develops. if, however, a small ld is introduced, the system leaves the central equilibrium and approaches a stable state with a strong and constant ld, which is either positive or negative depending on the initial condition. an example for this behavior is given in supplementary figure s <dig>  additional file  <dig>  in accordance with the reduction principle  <cit> , such a steady state with non-vanishing ld leads to selection against recombination and thus explains our results for the mma and the closely related interaction types. interestingly, a similar behavior has been described in diploid single-species models where a population can attain high-complementarity equilibria , i.e. two stable steady states with non-vanishing lds of opposite sign  <cit> .

CONCLUSIONS
we conclude that in deterministic models of host-parasite interactions, persistent ld oscillations are structurally not robust. whether these oscillations are persistent or damped depends on both the implementation of the model and on the parameter region. in this article, we found damped ld oscillations for weak selection in one of the standard models for host-parasite interactions  <cit>  and throughout the whole parameter range  in two alternative versions of this model. damped ld oscillations imply  only transient selection for or against sex/recombination in the deterministic regime, and  a large impact of stochasticity  on the evolution of sex/recombination. if oscillations are damped in the deterministic regime, stochasticity can counteract the dampening and maintain ld oscillations with considerable amplitude, which becomes larger with smaller population size. as a consequence, selection for or against sex/recombination is persistent in the stochastic regime and depends inversely on population size. if, on the other hand, ld oscillations are persistent in the deterministic regime, then stochasticity only weakly affects the evolution of sex/recombination and rather decreases the selection on a modifier. overall, the fact that ld-oscillations are structurally not robust in deterministic models of the rqh and that consequently, the impact of host-parasite interactions may crucially depend on population size, suggests that the rqh should be seen as an essentially stochastic hypothesis.

