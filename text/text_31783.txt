BACKGROUND
many proteins are functional despite they lack a stable three-dimensional structure under physiological conditions in vitro and/or in vivo  <cit> . regions of protein-protein and protein-nucleic acid interactions, as well as sites of posttranslational modification, often fall into regions that are locally disordered or undergo disorder–order transition in biologically relevant situations  <cit> . intrinsic disorder is a common feature of “hub” proteins that interact with multiple other proteins and perform important regulatory roles in the cell  <cit> . many intrinsically unstructured proteins  or intrinsically unstructured regions  are critical for cell survival, proliferation, differentiation, and apoptosis, which make them important from a biomedical point of view.

intrinsically unfolded proteins, once purified, can be identified by various experimental methods  <cit> . however, experimental determination of the absence of a three-dimensional structure is difficult. since the presence or the absence of a single stable structure is encoded in the protein sequence, it is possible to use the sequence information to predict regions of disorder in the similar manner as e.g. secondary structure. therefore, the emerging “unfoldomics” field  <cit>  has prompted the development of numerous computational methods for the prediction of disordered regions from protein sequence .

iups and intrinsically unfolded regions  are quite diverse. they can be classified in various ways according to length , method of experimental determination , the presence or absence of certain structural features , and many other factors. different types of disorder are often associated with different types of characteristic. for this reason, some computational methods for disorder predictions are available in several versions, trained on different datasets, e.g. on short and long iurs separately  <cit> . however, thus far no single clear-cut classification of all disorder types has emerged that would be accepted and used by all experts in the field, and most methods for disorder prediction from protein sequence aim for a binary classification of protein residues: ordered or disordered .

the so-called “meta-method” approach relies on the fact that different algorithms have their individual advantages and disadvantages, and the combination of methods can be used to improve the prediction accuracy. this approach has been used to develop many successful prediction methods, e.g. in protein fold recognition  <cit> , protein function prediction  <cit> , prediction of protein domains  <cit> , prediction of protein model quality  <cit> , and recently also in protein disorder prediction  <cit> . in this article, we describe a set of predictors that take as an input a protein sequence, query other methods, and calculate a final “consensus” prediction of disorder . they have been implemented as a single web server called metadisorder, available at http://iimcb.genesilico.pl/metadisorder/. one of our methods is essentially a primary predictor, as it does not use any other disorder prediction method, however it is “meta” in the sense that it does utilize other predictions, namely alignments to proteins of known structure reported by protein fold-recognition methods. our other disorder predictors are typical meta-methods, as they directly query a series of primary disorder predictors and utilize their output. additionally, other types of one-dimensional features, such as predicted secondary structure and predicted solvent accessibility are used. in the framework of the casp <dig> and casp <dig> benchmarks, these meta-predictors outperformed other methods for disorder prediction  <cit> .

methods
definition of disorder
protein disorder can be defined by many ways depending on the research focus and experimental method used. as a baseline, we used the definition used in the critical assessment of protein structure prediction  experiments: the disordered residues are those marked by remark <dig> tag in the experimentally determined protein structures deposited in protein data bank   <cit> , which indicates regions with missing coordinates in crystal structures determined by x-ray crystallography or residues with highly variable coordinates in ensembles of nuclear magnetic resonance  structures. this definition was extended to include also proteins deposited in the disprot database  spectroscopy, mass spectrometry, immunochemistry, sds-page gel, small-angle x-ray scattering , currently over  <dig> regions)  <cit> . the advantage of the disprot database is that it includes proteins without known three-dimensional structure, especially proteins that are entirely disordered, whose structure typically cannot be determined by high resolution methods . thus, we treat all disorder types as a single class.

primary methods used in the meta-method
the metadisorder series of predictors combined, via a machine-learning approach, the predictions of  <dig> primary disorder predictors that performed well in casp and are freely available as standalone applications or stable web servers that can process large numbers of queries: disembl  <cit> , disopred <dig>  <cit> , dispro  <cit> , globplot  <cit> , ipda  <cit> , iupred  <cit> , pdisorder  <cit> , poodle-s  <cit> , poodle-l  <cit> , prdos  <cit> , spritz  <cit> , dispssmp  <cit> , and ronn  <cit> . additionally, the meta-predictors designed for casp <dig> used also six subjectively selected methods for protein fold-recognition: hhsearch run over pdb <dig> and cdd databases  <cit> , ffas  <cit> , mgenthreader  <cit> , psi-blast run in two different modes  over the culled pdb database  <cit> , phyre  <cit> , and pcons  <cit>  . for short description of each method see table  <dig> and table  <dig>  additionally, two methods for secondary structure prediction: jnet  <cit>  and psipred  <cit> , and one solvent accessibility predictor, jnet  <cit> , were used.

training and testing datasets
to train the meta-predictors, two independent datasets were used. the first dataset was prepared based on the combined disprot database  and casp <dig> targets. sequences longer than  <dig> residues were omitted, because they exceed the length limit of some of the primary methods used and could not be processed automatically without arbitrary manipulations. overall, this procedure provided  <dig> proteins, which included  <dig>  residues in total, of which  <dig> % were disordered. the second dataset, called pdbremark <dig>  was based on structures in the pdb database. representative structures were extracted using the pisces server  <cit>  and filtered according to the following criteria: experimental technique: x-ray crystallography, resolution < 2 Å, r-factor <  <dig> , length 50– <dig> aa residues, and mutual sequence similarity < 20%. the resulting dataset contained  <dig> proteins . in the final version of the meta-predictor, we combined these two datasets and used them for assessing the disorder prediction accuracy. during that procedure, standard 10-fold cross validation was used. all amino acid residues were randomly assigned into  <dig> bins of nearly equal size.  <dig> bins were used as a source of the training data and the remaining 10th bin was used as a source of the testing data. this procedure was then repeated  <dig> times, with each of the  <dig> bins used exactly once for validation. the results of  <dig> analyses were then averaged to produce final scores.

since we aimed to be as objective as possible in assessing the predictive power of our methods in a fair comparison to other methods, to avoid any bias we tested all predictors described in this article within truly blind tests of casp <dig> and casp <dig>  in which , the prediction of disorder is defined as the ability to identify regions with missing coordinates in crystal structures determined by x-ray crystallography or residues with highly variable coordinates in ensembles of nmr structures.

for the training of gsmetadisorder3d and gsmetadisordermd predictors, we used proteins from casp <dig> . again, 10-fold cross validation was used. the detailed statistics about each dataset are provided in table  <dig> 

measures used for training and evaluation
the results of predictions can be divided into four categories: true positives  – residues correctly predicted as disordered, true negatives  – residues correctly predicted as ordered, false positives  – ordered residues misclassified as disordered, and false negatives  – disordered residues misclassified as ordered.

the first assessment criterion we used was the receiver operating characteristic . the roc curve is a graphical plot of the sensitivity vs. false positive rate for a classifier, as its discrimination threshold is changed. the resulting area under curve  defines the overall robustness of an algorithm, where  <dig> means the perfect predictor  and  <dig>  corresponds to a random one.

the second criterion is the weighted score, called sw, which rewards a correct disorder prediction higher than a correct order prediction  <cit> . this is done to avoid over-prediction of an ordered state due the fact that ordered regions are more common in known proteins. the sw score is defined as:sw=ssmax=wdisordertp−worderfp+wordertn−wdisorderfnwdisorder+worder

where the wdisorder equals the fraction of ordered residues and worder equals the fraction of disordered residues. sw is in the range − <dig> to  <dig>  where  <dig> means random prediction. maximization of sw was the main criterion of the optimization procedure and it was also used to assess the relative value of individual primary disorder predictors to be incorporated into our meta-servers. the sw score was directly used as a weight of a prediction returned by each such method.

the third commonly used measure, which was not used during our procedure of developing the consensus methods, but which was used for their evaluation, is matthews correlation coefficient   <cit> :mcc=tp·tn−fp·fnsw and mcc were the measures used during casp to assess disorder predictors.

finally, we used our own measure, called sww, which combines auc and sw score in the following way: it is calculated using the sw formula, but the discrimination threshold is changed incrementally from  <dig> to  <dig>  by steps of  <dig> , giving sets of tp, tn, fp, fn values that are used to calculate a series of sw scores. sww is the average value of these scores. this score was used only in the gsmetadisordermd <dig> method during casp <dig> 

the statistical significance of the evaluation scores was determined by the bootstrap confidence interval method  <cit> : 80% of the targets were randomly selected  <dig> times, and the mean absolute error of scores was calculated. the roc statistics were compared by using the wilcoxon signed rank test and by calculating standard errors of roc statistics.

binary consensus and continuous consensus versions of metadisorder predictors
in general, two categories of predictors exist. the simplest predictors are binary, they try to classify the predicted feature only into separate subcategories . more advanced methods return continuous scores with values e.g. between  <dig> and  <dig> that inform how certain the prediction is, and the prediction is made according to an arbitrarily chosen threshold. the lower the threshold, the higher the number of both true and false positives. accordingly, initially we constructed two versions of the metadisorder predictor, named bincons and floatcons. these two methods were tested within the framework of the casp <dig> benchmark as groups with numbers  <dig> and  <dig>  respectively  <cit> . bincons uses only binary predictions from primary methods: each disorder prediction for a residue is counted as  <dig> and ordered as  <dig>  . floatcons uses all the information available: if a given method returns a continuous prediction, its score is used during the final consensus calculation. a consensus score for each residue is calculated by summing the scores from all primary methods and multiplying them by the accuracy of the given method. the result is normalized, i.e. the score is divided by the maximal possible score. for simplicity, the criterion of a method’s accuracy used as the weight of the method was sw calculated for our combined datasets. it was possible, because sw does not depend on the predictor output type.

in the next step, a special correcting function is used. it takes into account the fact that residues located in the protein termini are on the average more disordered than residues in the middle of the protein chain. this function is based on the statistics of disorder presence in the  <dig> proximal residues calculated on both datasets and provides an appropriate corrective factor, by which the original predictive score is multiplied.

finally, the decision whether a residue is ordered or disordered is made. if a residue scores above the threshold, it is predicted as disordered; otherwise it is predicted as ordered. the threshold for classifying the residue as ordered or disordered was based on sw scores obtained during 10-fold cross validation tests.

additionally, at the end, the repairing procedure is employed to improve the prediction. for predicted string  a simple smoothing filter with a window of five residues is applied. it eliminates short  stretches of predicted disorder within long regions of predicted order .

gsmetadisorder3d – a template-matching method
apart from disorder predictors, many other bioinformatics tools yield implicit or explicit information about order and disorder. in the course of a variety of other protein sequence analysis projects, we realized that there is a clear correlation between the disorder in the target protein sequence, and the presence of gaps in alignments to structurally characterized templates calculated by the protein fold-recognition methods. although the implementation of a method utilizing this type of information may seem trivial, it was not so straightforward to deal with different types of fold recognition methods. in other words, it was not so obvious which method should be used or, if many methods were used, how to rank them. additionally, a template-matching method should be able to take into account the fact that matches to homologous proteins have different reliability and in some cases homologous sequences cannot be found. to address all these questions, we compared the results from arbitrary chosen fold recognition methods that were relatively fast and performed well in the framework of casp: hhsearch, ffas, mgenthreader, psi-blast, phyre, and pcons <dig> . to optimize the weights assigned to individual methods depending on the alignment quality we used a genetic algorithm implemented in pyevolve  <cit> . the fitness function of the genetic algorithm was designed as a one-dimensional vector of length  <dig> . in this way, the weights for all methods were obtained, for the further incorporation into a combined template-matching method. the resulting predictor was tested in casp <dig> as a group number  <dig> .

* - the same score was used regardless of the database.

gsmetadisordermd and gsmetadisordermd <dig> – combined disorder consensus and template-matching method
the next method in the metadisorder series, gsmetadisordermd, was developed by combining floatcons  with gsmetadisorder3d . the same genetic algorithm was used as in the training of gsmetadisorder3d, but additionally the second dimension to the vector was added to optimize the relationship between these two components. this method was tested in casp <dig> as a group number  <dig> 

gsmetadisordermd <dig> is a variant of gsmetadisordermd, in which the genetic algorithm used for training optimized the sww score instead of the sw score. this predictor was tested in casp <dig> as a group number  <dig> 

implementation and availability
the metadisorder is a web interface to our series of disorder meta-predictors and can be accessed at http://iimcb.genesilico.pl/metadisorder/. wrappers and parsers for primary prediction methods were written in the python programming language under the unix system. data are stored in a mysql database. the web server was implemented using the mod_python apache module. for the interactive presentation of results, the javascript chart library highcharts  <cit>  is used. additionally, the results of analyses can be also obtained as simple text output .

RESULTS
meta prediction of protein disorder from primary disorder predictors
motivated by the success of meta-prediction in various fields of bioinformatics, we tested its applicability to the prediction of disordered residues in protein sequences. initially, we developed meta-predictors bincons and floatcons that calculate a consensus score by taking into account the relative expected accuracies of constituent primary methods . bincons and floatcons were first benchmarked by ourselves on combined datasets consisting of casp <dig> targets, disprot database and pdbremark <dig> dataset obtained from a filtered pdb database  and subsequently by independent assessors within the framework of the casp <dig> experiment   <cit> . in both tests the bincons and floatcons meta-predictors performed considerably better than individual primary predictors . the statistical significance of those results was compared by using the wilcoxon signed rank test . the overall difference of accuracy between these two meta-predictors was relatively small , but statistically significant according to the wilcoxon signed rank test. the difference between both meta-predictors and ipda and vsl <dig> is also statistically significant. this exercise demonstrated that meta-prediction can significantly improve the inference of intrinsic disorder from protein sequence, but the use of continuous scores contributes little to that success over simple binary prediction.

the highest value for each score is shown in bold.

the highest value for each score is shown in bold.

gaps in fold recognition alignments provide useful information for protein disorder prediction
subsequently, we have developed a primary disorder predictor gsmetadisorder3d that uses information from the coverage of the target sequence by known protein structures, according to alignments reported by protein-fold recognition methods . these methods aim at aligning target protein sequences to proteins with related structure. the lack of matches to known structures for a given sequence region may indicate the lack of detectable structured counterparts in the database, including cases of structural disorder. figure 1b illustrates an example, where the paucity of matches to known structures reported by fold-recognition methods corresponds to a disordered region. gsmetadisorder3d uses six different protein fold-recognition methods . the selection of these tools was dictated by the methods’ accuracy , but also speed, and either availability for local installation or stability of a web service. one issue we had to address was the fact that each fold-recognition method typically generates up to ten alternative alignments that are scored differently and may exhibit different accuracy. there are many nonlinear aspects of these methods that should be taken into account when considering the prediction of disorder using information from homologous alignments. to address them, we employed a genetic algorithm. the fitness function was designed in such a way that it optimizes a vector of size  <dig>  where triads of the vector elements represents weights for the eight fold recognition methods indicating good, medium and poor quality alignments.

as it can be seen in table  <dig>  gsmetadisorder3d performs better than many primary disorder prediction methods that sometimes use sophisticated machine learning algorithms, although it does not outperform them all. according to our benchmark, this method achieved roc of  <dig>  on casp <dig> targets . this indicates that the coverage of the target sequence by known structures in fold-recognition alignments is a good discriminator of protein order and disorder, but alone it is not sufficient to predict protein disorder as well as the top disorder prediction methods.

fold-recognition analysis adds value to consensus disorder prediction
the gsmetadisorder3d was not intended to serve as an independent predictor, but as a complement to other methods based on different principles. it has been combined with the consensus meta-predictor floatcons into a meta-predictor named gsmetadisordermd. according to an in-house benchmark and casp <dig>  gsmetadisordermd outperforms floatcons by 2-4%, depending on the dataset used for testing . it must be emphasized that this method was tested only on casp targets , because only for them predictions from all primary methods were available.

we have also developed and tested a minor variant of this method, dubbed gsmetadisordermd <dig>  trained with the use of the sww score instead of the sw score as the target function. this modification brought about a small but significant improvement in the prediction quality, especially if we consider the results from casp <dig> .

discussion
consensus predictions are practically useful: they are significantly better than primary predictors
the development of meta-predictors is often criticized as a parasitic approach that discourages the development of primary methods and does not improve our understanding of the underlying biological processes. in this article we have described not only a series of meta-methods that use other developers’ methods, but a novel primary method based on a different principle, which does not “beat” other primary algorithms in a head-to-head comparison, but is sufficiently different, that its inclusion improves meta-prediction by a few percent. thus, we argue that the development of meta-servers can actually positively influence the development of methods that are based on novel principles and that it can highlight the utility of new algorithms even if they do not “win” the competition on the basic level. on the other hand, our benchmarks demonstrate that many “old” methods are still useful in terms of contribution of important information that can be used for meta-prediction, and that meta-predictors can incorporate them as “building blocks” into a practically useful bioinformatics service.

the key conclusion from our work is that even a very simple weighted consensus  is able to improve disorder prediction over primary methods, resulting in a more robust and accurate prediction, as assessed according both to the sw score and auc. as can be concluded from data presented in table  <dig> and table  <dig>  regardless of the type of score and dataset used, consensus methods performed comparatively well both in our in-house benchmark and in casp  <cit> . the most advanced and best-performing meta-predictors described in this manuscript use machine learning to derive the best features from the primary predictors available. they outperformed consensus predictors based on simply averaging the input of the primary predictors.

consensus predictions improve other methods’ predictions. where does the improvement come from?
consensus predictors are more robust than primary predictors they are based on. they give less false positives and on the average the predictions are more definite. primary predictors are different from each other and in a collective prediction their different strengths can be combined and/or their difference weaknesses can be eliminated. first, different datasets are used for training, biasing the prediction towards  certain types of proteins with particular features. for instance, the use of proteins from the pdb eliminates all proteins that are so disordered that their structure cannot be determined, while the use of proteins from disprot implies the reliance on low-resolution experimental data that blurs the boundary between order and disorder. second, different machine learning techniques are used that can be more or less accurate under different circumstances. typically, the impact of the machine learning algorithm used or the parameters chosen for the training of a given predictor is not clear, as comprehensive evaluation of various machine-learning methods with respect to a particular dataset is rarely performed and described. hence, each primary predictor can be viewed as an instantiation of its developers’ expertise and ideas with respect to the dataset preparation, invention of new algorithms and/or machine learning use, which is never fully optimal with respect to all relevant parameters. a successful meta-predictor based on a machine-learning approach is able to perform a synthesis of abilities of the primary methods, and in our opinion the greatest improvement comes from eliminating their individual deficiencies rather than in the exploitation of the individual unusual strengths.

deficiencies of the meta-server approach for disorder prediction
disorder predictors developed in this work were carefully benchmarked against many other methods, using several different datasets as a reference, including the blind tests of casp <dig> and casp <dig>  where they always ranked among top contenders. it is unfortunately impossible to compare these methods to all the published disorder predictors , as not all of them are freely available as servers or standalone tools, and not all of them participate in casp.

another problem in benchmarking bioinformatics methods is that almost all of them use as an initial step a similarity search over some protein sequence database . these databases are constantly updated. for this reason it is not entirely fair to compare our predictors with other methods, unless they are installed locally and use the same databases. hence, we could not directly compare our method to many new methods. for example the mfdp meta-predictor  <cit>  can be installed locally, but it depends on more than ten third-party programs , which use their own databases. a fair comparison of mfdp and metadisorder methods would require e.g. the availability of hhsearch hmm-profile databases from  <dig> and  <dig> and others, which are unfortunately not available.

the problem with local benchmarks mentioned above emphasizes the importance of casp experiments. there, the contenders cannot control the dataset used for testing the methods, and the problem with biological database content is alleviated, as all methods are allowed to use the most up-to-date sequence databases . hence, it should be stressed out that the presented series of methods was developed, tested, and improved through two editions of casp, and was found to be superior to other methods in these fair competitions.

metadisorder is relatively slow, as it depends on more than  <dig> programs, which are not very fast even if installed locally. some of them search big databases and/or are not parallelized. for instance the generation of alignments by fold recognition methods can take more than an hour for long sequences. in the case of online web servers installed on third-party servers, the response may be delayed for reasons that are beyond the control of the meta-predictor . a significantly speed-limiting factor in our gsmetadisorder3d method is the use of the pcons <dig> algorithm, which is a fold-recognition meta-predictor run only when all primary fold recognition methods return their alignments and corresponding 3d models are generated by modeller. despite these performance drawbacks, the metadisorder web server is typically able to calculate final predictions from within minutes up to few hours, depending on sequence length.

probably the most serious problem in disorder prediction is that the binary classification of residues into the ordered or disordered state is very simplistic. “disorder” is not a single state, but in fact represents a whole range of biophysical characteristics that can be captured by different experimental techniques. it has been shown that disorder predictors trained on proteins with different types of disorder often achieve poor accuracy on disorder of proteins of a different type, which has led to the definition of “flavors” of disorder, characterized by differences in sequence properties  <cit> . there are certain classes of disorder for which specialized predictors have been developed, for instance short vs. long disorder  <cit> , and prediction of protein-binding regions in disordered proteins  <cit> . the use of a meta-server allows not only for combining predictions of different flavors of disorder into one “consensus” prediction, but also to collect and display these different predictions next to each other, allowing the human user to make an informed functional interpretation. on the other hand, the collection of results obtained by multiple methods can be overwhelming for a lay user. clearly, there is a need to develop more clear-cut classification of disorder that would capture functional features correlated with sequence features that can be used by machine learning methods in the development of multi-state disorder predictors. current efforts towards the development of disorder ontology  and new classification schemes  are expected to help in the development of multi-class predictors.

CONCLUSIONS
the meta-approach allows the consolidation of pre-existing knowledge to obtain more robust and accurate predictions than with the use of primary predictors. we developed one primary disorder meta-predictor and a series of disorder meta-predictors that use different sets of primary predictors, and tested their performance on different datasets. the most important evaluation of the predictors’ accuracy was in blind tests of casp <dig> and casp <dig>  in both cases, our meta-predictors were found to be superior with respect to all primary methods and other meta-predictors. currently, our metadisorder web service offers a possibility to run more than  <dig> bioinformatics tools , and to analyze the summary of results via a user-friendly interface.

competing interests
authors declare that they have no competing interests.

authors’ contributions
lpk collected all data, carried out calculations, developed programs and web interface and drafted the manuscript. jmb conceived of the project and edited the manuscript. both authors read and approved the final manuscript.

supplementary material
additional file 1
 <dig> sequences with their definitions of being disordered/ordered extracted from pdb files according to remark <dig> 

click here for file

 additional file 2
table s <dig>  results of the wilcoxon singed-rank two-sided tests for the auc scores on dataset combining casp <dig>  disprot and pdbremark <dig> datasets.

click here for file

 acknowledgements
our consensus methods could not be developed without the availability of third-party methods and servers. we would like to thank all developers for kindly making their programs freely available. we also thank peter tompa, keith dunker, and monika fuxreiter for stimulating discussions. lpk was supported by the polish ministry of science and higher education . jmb was supported by the european union , and by the polish ministry of science and higher education .
