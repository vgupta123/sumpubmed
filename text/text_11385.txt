BACKGROUND
time calibration of phylogenetic trees is a key factor to reconstruct the evolutionary history of taxa  <cit> . this is usually accomplished by extrapolating the known age of a node  to the remainder of the tree, and assuming a molecular clock. some animal groups, such as mammals or birds, are especially suited for time estimation based on a rather complete fossil record, but other organisms, typically species-rich groups of invertebrates with poor or inexistent fossil record, may represent more of a challenge for a similar exercise. in the case of insects, for instance, reliable paleontological evidence is frequently lacking, which leads to applying a proposed standard rate of  <dig> % divergence/my for the insect mitochondrial genome  <cit> . however, the development of independent calibration analyses, mainly based on the age of geologic phenomena that underlie the origin of particular cladogenetic events, have found rates either slower e.g.,  <cit>  or faster e.g.,  <cit>  than this standard. these studies illustrate how often the routine application of a standard rate may lead to incorrect inference of evolutionary histories.

the discrepancies in the rates of molecular evolution can be attributed to lineage specific effects or to the molecular marker employed  <cit> . however, they could also reflect biases in the calibration procedure  <cit> . decisions relative to the analytical procedure with potential effects on estimated rates include the suitability of selected lineage splits and the strategy used to enforce ages to nodes  <cit> , methodological aspects such as the method for branch length estimation , model of among-branch rate variation , selection of evolutionary model e.g.,  <cit> , partitioning of data e.g.,  <cit> , taxon sampling e.g.,  <cit>  or inclusion of ambiguously aligned regions  <cit> . but the effects of the methodology and specifically the combined effect of choices relative to these methodological aspects have not been fully explored. the increasing number of studies that rely on calibration analyses highlight the importance of investigating how these factors influence evolutionary rate and node age estimation in real datasets.

within the coleoptera, the family carabidae has been the focus of several molecular clock calibration attempts. for instance, contreras-diaz et al.  <cit>  and ruiz et al.  <cit>  estimated cox1-cox <dig> rates of  <dig> % and  <dig> % divergence/my for canarian species of trechus and sphodrini ground beetles, respectively. prüser and mossakowski  <cit>  used a strict global clock method and the opening of the gibraltar strait at the end of the miocene to calibrate hypothetic vicariance events between iberian and north african populations of carabus species. they found rates between  <dig>  and  <dig> % divergence/my for nd <dig> data. su et al.  <cit>  and tominaga et al.  <cit>  investigated nd <dig> rates for two endemic subgenera of japanese carabus using a similar approach and the isolation of japan from the continent at  <dig> mya. these authors found a very low evolutionary rate for this gene,  <dig> % divergence/my.

the genus carabus is a holarctic taxon that includes about  <dig> species, currently divided in eight main divisions  <cit> . it is highly diversified in the palaearctic, where it is distributed throughout continental eurasia, but is also present in japan, iceland, the canary islands, north africa and several mediterranean islands. indeed, the genus carabus represents a good research subject to conduct comparative calibration analyses, since there are a fair number of available dna sequences, a relatively solid systematic knowledge of its limits and major splits  <cit> , and the evolutionary history of these apterous beetles can be linked to geologic events that provide multiple potential calibration hypotheses about the origin of clades.

here we perform calibration analyses on nine gene fragments that include protein coding and ribosomal genes belonging to both mitochondrial and nuclear genomes. calibration analyses are based on the ages of the most recent common ancestor  for three cladogenetic events, including the origin of subgenera mesocarabus, macrothorax and the sister pair eurycarabus and nesaeocarabus, as estimated on an nd <dig> phylogeny using eight calibration points based on dates for fossil and past geologic events. the procedure takes into account the uncertainty intervals of these calibration points, to avoid a false perception of precision on age estimation in subsequent calibration analyses. overall, we have conducted a total of  <dig> independent calibration analyses on individual and concatenated dna matrices, using different outgroups, clock models, partition schemes and alternative treatments of ambiguous characters. we used these data to address several specific aims:  to obtain a reliable time scale for the origin and evolution of the genus carabus and discuss the obtained rates of molecular evolution with those reported in other studies, and most critically  to evaluate the effect of methodological decisions relative to calibration analyses in the resulting calibrated phylogenies.

methods
taxon and gene sampling
thirty-four specimens belonging to the family carabidae have been studied . samples correspond to  <dig> western palearctic species of the genus carabus representing  <dig> of the  <dig> conservatively recognized subgenera  <cit> . the selected species represent the eight main divisions and early splits in the phylogeny of carabus as inferred from analyses based on two nuclear gene sequences  <cit> , and hence the ingroup node in the present study very likely represents the true mrca node of carabus. moreover, our sampling includes the taxa postulated as the earliest branching events in the evolution of the genus based on morphology, i.e. platycarabus, rhabdotocarabus, limnocarabus and tachypus  <cit> . six taxa were incorporated as outgroups: calosoma as sister group to carabus; ceroglossus and cychrus as related members of the supertribe carabitae; and leistus and laemostenus as more distantly related taxa. dna was extracted from a leg of each specimen using the dneasy blood and tissue kit  or invisorb spin tissue mini kit  following manufacturers' instructions.

division of genus carabus follows deuve  <cit> 

each specimen was characterized for nine dna fragments corresponding to seven different ribosomal and protein coding genes from mitochondrial  and nuclear  genomes . the sequences of huwe <dig> are homologous to the anonymous gene described by sota and vogler  <cit>  for the genus carabus, and to the predicted huwe <dig> gene as identified by blast searches against the tribolium castaneum genome. pcr reactions were made using puretaq ready-to-go pcr beads  or qiagen taq polymerase with  <dig> cycles at 50-54°c for primer annealing. purification of pcr products and sequencing in both directions with the same primers used for pcr was performed by macrogen inc. . sequence accession numbers are given in table  <dig> 

sequence alignment
mitochondrial protein coding genes were unambiguously aligned and checked for their correct translation to amino acids using mega  <dig>  <cit> . the 5'-end of the huwe <dig> fragment was also unambiguously aligned and correctly translated to amino acids, while the 3'-end showed a length-variable intron sequence. all ribosomal markers  also showed length variation and required objective alignment prior to phylogenetic analysis.

variable-length dna fragments for the dataset including outgroups were aligned under each combination of five iterative refinement methods  and three scoring matrices  in mafft  <dig>   <cit> . each individual alignment was assessed for congruence with respect to a combined matrix including unambiguously aligned regions of every gene. to get this combined matrix, every fragment was independently aligned in mafft with fft-ns-i parameters, and local ambiguities were removed with gblocks  <cit>  with the no-gaps option and other default parameters; the resulting fragments were concatenated. congruence was measured using both the incongruence length difference index  and the rescaled ild  <cit> . ild values were estimated from parsimony-based tree lengths in every case using paup*  <dig>   <cit> . the alignment conditions maximizing character congruence for every length-variable marker, i.e. producing the lowest rescaled ild value, were objectively selected as those generating the best homology hypothesis for these data and employed in subsequent analyses.

favored alignments were used to produce three concatenated matrices, including all mitochondrial fragments , all nuclear fragments  and both datasets . in the case of ribosomal genes, selected alignments were previously processed with gblocks  <cit>  using the all-gaps option and default parameters; only selected positions were included in the concatenated matrices. these alignments are available at treebase.org 

phylogenetic analyses
all phylogenetic and calibration analyses described below were run independently for both the complete dataset  and a subset of data representing only the  <dig> ingroup carabus sequences .

bayesian phylogenetic inference for each individual and concatenated datasets, without specifying partitions and without clock assumptions, were run with mrbayes  <dig>   <cit>  under a gtr + g + i model to assess the reliability of nodes to be used in subsequent calibration tests. the gtr model of nucleotide substitution was identified by jmodeltest  <cit>  as the best fitting for nd <dig>  cox1-b, lsu-a, lsu-b, its <dig> and all concatenated datasets. for the remaining genes  a simpler model was favored, but the gtr was second best. the parameter gamma  was favored for all data sets but not invariant characters  in the case of nuclear ribosomal genes, although this parameter was included in the second best fitting model. to homogenize this part of the methodology, a complex gtr + g + i model was used in every analysis as their parameters are co-estimated with the tree and they can match eventually any simpler model at expense of increasing perhaps the variance of estimates. analyses enforced two independent runs, each with three hot and one cold chain, for  <dig> , <dig> generations, whereby trees were sampled every  <dig>  generations. convergence of independent runs was checked in tracer  <dig>   <cit>  and their half compatible consensus tree was calculated excluding 10% of initial trees, after the plateau in tree likelihood values had been reached. trees were visualized using figtree  <dig> . <dig>  <cit>  and node posterior probabilities were interpreted as support values.

calibration analyses
calibration tests were standardized across the phylogenies estimated under different conditions, by using a fixed set of nodes constrained to absolute age intervals obtained from an independent analysis of an expanded nd <dig> dataset. this dataset included  <dig> carabus and  <dig> outgroup nd <dig> sequences  and was analyzed in beast  <dig> . <dig>  <cit>  constraining eight calibrations points based on geologic events and the availability of a fossil carabus from the end of the miocene . these data were investigated under different codon partition schemes  and clock models, strict  and uncorrelated lognormal  clocks. the optimal conditions were selected based on bayes factors  comparisons using marginal likelihood values as calculated in tracer  <dig> . positive evidence based on bf was interpreted as requiring at least a ten units increase in marginal likelihood per additional free parameter before accepting a more complex model  <cit> . we assumed one extra parameter in uln analyses compared to the sc assumption  <cit> , and ten extra parameters per additional partition under a gtr + g + i model.

split between two canarian endemic species: carabus  coarctatus
the resulting calibrated phylogeny was used to obtain the ages for three well-supported cladogenetic events in the phylogeny of carabus: node a, the split between carabus  rugosus and c.  morbillosus; node b, the split of carabus  riffensis from european mesocarabus; and node c, the split between the sister subgenera eurycarabus and nesaeocarabus. these nodes were selected because they are not affected by systematic conflict , they are old enough to avoid time dependence effects  <cit>  and not so deep as to be excessively affected by saturation of molecular change. we used treestat  <dig> . <dig>  <cit>  to recover these node ages from the sample of the mcmc search in beast and used the "fitdistr" option of the r package mass to obtain a gamma function adjusting the distribution of sampled ages, thus including uncertainty associated to the age estimations .

calibration analyses of each marker and their combination were conducted in beast  <dig> . <dig> based upon four independent runs of  <dig> million generations each, sampling every  <dig> th generation, and using a yule tree prior and a gtr + g + i evolutionary model, with ten categories for the gamma distribution. samples from these independent runs were compared, checked for convergence and combined after conservatively removing 10% of initial trees in logcombiner  <dig> . <dig>  <cit> , drawing one sample every  <dig> th generation. mean, standard error, highest posterior density intervals  and effective sample size of likelihood, evolutionary rates and the tmrca of carabus were inspected using tracer  <dig> . consensus trees were obtained in treeannotator  <dig> . <dig>  <cit>  using the mean age option.

calibration analyses on individual protein coding genes. protein coding genes, including the 5'-end of the huwe <dig> fragment, were analyzed under different clock assumptions including sc and uln clocks, as well as different codon partition schemes , for both the outgroup and ingroup datasets. additionally, the complete huwe <dig> gene fragment  was analyzed without codon partitioning. results were analyzed to simultaneously select the best clock and partition model using bf as above.

calibration analyses on individual ribosomal genes. calibration analyses for trees based on ribosomal genes were conducted considering  all positions ,  only positions selected by gblocks with the no-gaps option and other default parameters , and  only positions selected with the all-gaps option . each individual analysis was done under different clock assumptions  and for the outgroup and ingroup matrices. the best clock model was assessed in every case using bf comparisons as above.

calibration analyses on concatenated datasets. outgroup and ingroup datasets for the mit, nuc and mit-nuc concatenated matrices were analyzed in beast under different clock assumptions  following different partition schemes, which included no data partitioning , partitioning by gene but not by codon in the case of protein coding genes , partitioning by gene, and each protein coding gene with two codon partitions where first and second positions are considered together , and partitioning by gene and by codon position . among-branch rate variation was always treated as linked among partitions, and bf comparisons were used again to select for the best clock and partitioning models.

the effect of different treatments of data was explored using wilcoxon signed rank test on the values of two relevant parameters, including the estimated rate of molecular evolution for the marker or markers investigated and the estimated age of the ingroup node .

RESULTS
phylogenetic framework for calibration tests
the alignment of choice based on congruence optimization with unambiguously aligned data was that obtained implementing the q-ins-i algorithm for all nuclear genes, except for the lsu-a fragment in the case of the ingroup dataset. the latter, together with the mitochondrial ribosomal gene rrnl data, were optimal using the e-ins-i method .

calibration analyses on the expanded nd <dig> gene dataset used a strict clock and 2p codon partitioning as selected by bf, resulting in a rate of molecular evolution of  <dig>   substitutions per site per million years per lineage . the time calibrated phylogeny obtained is shown in figure  <dig>  nodes a, b and c were recovered with high support  with median ages ranging from  <dig>  ma  to  <dig>  ma .

for the mitochondrial dataset only two of the  <dig> specimens lacked one of the five sequenced fragments. in the case of nuclear genes six specimens lacked a single gene fragment, three lacked two loci and only one, within the outgroup taxa, lacked three fragments. thus, completeness of the data matrices is very high and the effect of missing data is expected to be low. bayesian phylogenetic analyses for the concatenated datasets resulted in the recovery of focal nodes a, b and c with posterior probability of  <dig>  in all instances. node a--split between carabus  rugosus and c.  morbillosus--was found with a posterior probability  higher than  <dig>  for all individual dna fragments except for lsu-b  and lsu-a . node b--split of carabus  riffensis from european mesocarabus--appeared highly supported  for most individual dna fragments, except for its <dig> , lsu-a , cox1-a and cob . finally, node c--split between the subgenera eurycarabus and nesaeocarabus--was recovered for all individual fragments, although with pp <  <dig>  in nd <dig>  rrnl and lsu-b. figure  <dig> shows support of nodes a, b and c as obtained with mrbayes and beast analyses.

analysis of individual genes frequently failed to recover the monophyly of the genus carabus  and/or its sister relationship with the genus calosoma  . however, these nodes were recovered with high support in all combined datasets . bayesian analyses conducted in beast, where the calibration age prior was applied together with the favored partition and clock scheme, slightly improved node support within the carabus clade.

selection of optimal analytical conditions
for each individual and combined dataset and alternative partition and clock model schemes, the four independent beast runs resulted in similar global rates, tmrca of carabus and likelihood values, reaching stationary equilibrium and ess values always higher than  <dig> for the likelihood parameter and higher than  <dig> for all the other parameters, with very few exceptions. the results from these independent runs and for each dataset were thus pooled together to generate samples of  <dig> million generations, with ess values always higher than  <dig> 

bf comparisons resulted in the selection of the 2p codon partition strategy for mitochondrial coding genes, the combination of all mtdna markers, and the combination of all markers, while no data partitioning was selected for the nuclear huwe <dig> fragment alone and for all nuclear markers combined . the strict clock was favored for all protein coding genes , the combined mtdna including outgroup taxa, and also for some ribosomal genes using the ingroup dataset and after gap exclusion. otherwise, the relaxed  clock was preferred for all other individual and combined markers . relative to the effect of ambiguously aligned characters or outgroup inclusion/exclusion, no direct bf comparisons were possible, and a pragmatic decision was taken in every case. nogaps datasets were discarded due to their major effect on rates and age estimations . allgaps and complete matrices showed similar rates and ages, and the first option was selected. finally, we discarded outgroups for estimation of molecular rates and tmrca of carabus since this genus was not found monophyletic in most individual marker analyses, producing a net overestimation of the age for this node, taken as the one including all ingroup taxa but not only. when monophyly was recovered, such as in concatenated datasets, the differences in both rates and ages between outgroup and ingroup datasets was low.

evolutionary rates and ingroup ages
data corresponding to the ingroup dataset. rates are given in substitutions per site per million years per lineage, and tmrca of carabus in millions of years before present 

* selection of np dataset due to the anomalous branch lengths resulting from codon partitioned nd <dig> analyses

** these rates are estimated after character culling in g-blocks and are necessarily an underestimation of the real rates of change accumulation

the mean estimated age of the ingroup oscillated between  <dig>   ma as estimated for lsu-a data, and  <dig>   ma, in the case of its <dig>  whereas for most genes this value was between  <dig> and  <dig> ma with widely overlapping 95% hpd intervals . the combined analyses of all genes resulted in a tmrca of carabus of  <dig>   ma. the dispersion of values around the mean was higher for genes analyzed under a relaxed clock. the split between carabus and calosoma  was estimated to have occurred at around  <dig>  ma  with combined genes and the dataset including outgroup taxa .

effect of partitioning scheme
data partitioning affected protein coding gene fragments  and concatenated datasets . a general trend was observed whereby the average values for the evolutionary rates and the estimated ingroup age increased with the number of partitions considered, both for individual markers  and their concatenation . this trend was found irrespective of the clock model enforced , and it was particularly exacerbated in the case of the rate estimated for nd <dig> and the entire dataset, which tripled its value compared to non-partitioned data when three partitions where considered, without remarkable effects on the estimation of the ingroup age. on the other hand, the coding region of the huwe <dig> gene fragment showed invariable rates and estimated ingroup age independently of the partitioning strategy employed. values for mean rates and tmrca of carabus and their associated 95% hpd intervals for each analysis are provided in additional file 1: tables s <dig> and s <dig>  respectively.

effect of ambiguously aligned characters
the effect of gapped characters on rate and node age estimation was assessed in all gene fragments showing sequence length variation . in the case of ribosomal genes, the exclusion of gapped positions  had a noticeable effect lowering the estimates of evolutionary rates and ingroup age, up to three-fold, for the most variable gene fragments, hence with gappier alignments . these gene fragments diminished by  <dig> and 90% of aligned nucleotide positions, respectively, with a dramatic loss of phylogenetic information and great oscillations in the estimated parameters. expectedly, more length-conserved fragments  were only slightly affected by character culling in gblocks, with  <dig> and 1% of character loss, respectively, under the most conservative nogaps treatment, and consequently showed lower variation, particularly in estimation of evolutionary rates. less restrictive character culling approaches  preserved more characters to be used for branch length estimation and produced intermediate results, still with significant effects on rate estimation for highly variable markers, but not so much for that of the tmrca of carabus in the case of its <dig> and lsu-b data. the estimated mean node age in these cases was affected to a higher extent by outgroup inclusion/exclusion and by the clock model.

the simultaneous analysis of non-coding sequence information with exon information for the nuclear huwe <dig> gene had little effect on the estimation of evolutionary rates, although the estimation of the ingroup age decreased or increased when assuming strict or relaxed clocks, respectively .

effect of clock model
the choice of strict versus relaxed clock had effects on the estimation of parameters of interest, generally associated with the actual clock model best fitting the data. individual and combined genes in which the strict clock was preferred showed null to low effect of clock model on the estimation of rates and ingroup ages, with both parameters showing at most a trend to slightly higher values when a relaxed clock was enforced . in all other cases, except for the total evidence dataset, the use of the suboptimal strict clock resulted in lower rate estimates and higher ingroup ages .

effect of outgroup
the dataset including outgroups generally resulted in higher rates of molecular evolution compared with the analyses using ingroup data only  . exceptions to this pattern affected the fast evolving ribosomal markers lsu-b and its <dig>  as well as the combination of nuclear genes and the total evidence dataset when investigated under a strict clock model. in turn, for the tmrca of carabus no general trend could be identified , despite it was generally retrieved as older for most treatments when including outgroups, for instance with individual mitochondrial genes , a fact associated to most individual gene fragments failing to recover the monophyly of carabus. exceptionally, this age was younger for all nuclear markers independently  and for their combination  when the unfavored strict clock was enforced.

discussion
a time scale for the origin and evolution of carabus
the analyses of mit, nuc and mit-nuc combined datasets produce highly congruent topologies and high support for most nodes, including nodes t and k, representing the monophyly of carabus and its sister relationship with calosoma, respectively . in addition, all combined datasets show nearly complete overlap of the 95% hpd intervals on the estimated ages for these nodes; only the nuc dataset departs slightly from these values producing an older mean age estimate . the time scale obtained when all nuclear and mitochondrial genes are analyzed together  situates the initial split between carabus and calosoma during the oligocene, some  <dig> and  <dig> ma, after the opening of the atlantic ocean and the split of the nearctic and palearctic regions  <cit> . this timing is congruent with the observation that carabus, essentially a flightless genus, is more diverse in the palaearctic  than in the nearctic region , whereas calosoma is slightly more diverse in the nearctic  than in the palearctic region . the evolutionary events that originated the main extant lineages of carabus took place according to our data during the early miocene, between  <dig> and  <dig> ma .

these findings disagree with the previous hypothesis assigning an older eocene origin to carabus  <cit> . the occurrence of north american endemic subgenera tanaocarabus and lichnocarabus was interpreted as evidence suggesting that the origin of the genus predated the opening of the atlantic ocean, considered the event responsible for the isolation of nearctic from western palearctic lineages of carabus. however, molecular data indicate that these nearctic subgenera are instead related to eastern palearctic species  <cit> , which suggests an origin for the genus carabus within the paleartic region and a more recent dispersal event across bering strait land bridges, in agreement with the dates here provided.

rates of molecular evolution in carabus
the evolutionary rates for the genus carabus as estimated here are, in general terms, higher than those reported in previous studies. the discrepancies are thought to be mostly related to the use of inappropriate calibration points in these studies, combined with simplistic corrections of genetic distances among species. prüser and mossakowski  <cit>  in a study based on the nd <dig> gene in western mediterranean species of the genus carabus, calibrated the separation of six pairs of taxa with the opening of the gibraltar strait at the end of the messinian . five of these splits represented the separation of north african and european subspecies in c.  morbillosus and c.  rugosus, and the resulting rates ranged between  <dig>  to  <dig>  subs/s/ma/l. however, these splits seemingly occurred well after the opening of the gibraltar strait . the sixth node represented the split of subspecies of carabus  melancholicus from the iberian peninsula and north africa, the only one with compelling evidence to represent a vicariant event resulting from the opening of gibraltar strait . the rate estimated by prüser and mossakowski  <cit>  was  <dig>  subs/s/ma/l, much lower than our estimated rate for the slowest protein-coding gene-- <dig>   subs/s/ma/l. indeed, the divergence estimated by prüser and mossakowski  <cit>  for these taxa, based on an uncorrected p-distance, was approximately half as low as distances corrected with appropriate evolutionary models .

the degree of relaxation of evolutionary constraints acting on different genes or their portions ultimately reflects in differences on their inferred rate of molecular evolution  <cit> . our data showed a 16-fold difference between the slowest  and the fastest  evolving mitochondrial markers, in agreement with rate variation estimates between particular mitochondrial genes found by pons et al.  <cit>  for coleoptera. this important disparity cautions against the extrapolation of rates of molecular evolution among different gene fragments or their combinations. on the other hand, the extrapolation of evolutionary rates for the same marker across taxa, at least when they are relatively closely related, appears as a safer assumption, although it is possible to find differences. several studies using a similar approach as that described here but targeting different families  of coleoptera produced slightly different rates of evolution for the same gene fragments. thus, for instance, papadopoulou et al.  <cit>  and ribera et al.  <cit>  estimated rates of  <dig> % and  <dig> % divergence/ma in tenebrionidae and leiodidae, respectively, for a fragment homologous to the cox1-b fragment investigated here, which in our case yielded a slower rate of  <dig> % divergence/ma  in carabus. evolutionary rates obtained by pons et al.  <cit>  for the nd <dig>  and cob  genes are very similar to those we obtained for carabus , while they found an unexpected higher rate for the cox <dig> gene , although their estimation appeared associated to a surprisingly wide hpd interval .

heterogeneity in rates of molecular evolution
invertebrate mitochondrial genomes have long been assumed to evolve at a standard molecular clock rate of  <dig> % divergence/ma  <cit> . this rate was deduced from heterogeneous mitochondrial data, including restriction fragment length polymorphism, dna-dna hybridization and sequence data for several genes. its utilization in phylogenetic studies has been frequent for datasets composed by individual and concatenated mitochondrial dna gene fragments . it is important to notice that in these studies similar rates for different taxa and different regions of the mitochondrial genome were assumed. this assumption has been lately refuted e.g.,  <cit> . moreover, in former studies where the standard rate was routinely applied the effects of methodological decisions on the calibration procedure had not been considered, a question that has been shown to be important  <cit> , as we also stress here.

there is fair variation in the rates of individual gene fragments in carabus which are affected by methodological aspects of the calibration procedure. major differences on both the rates and the tmrca of carabus are obtained in the case of the nuclear ribosomal genes, which reach a fourfold variation between analyses involving different clock models, as well as inclusion/exclusion of ambiguous characters and/or outgroups. mitochondrial genes show comparatively less variation due to methodological decisions, and only the nd <dig> fragment showed a twofold difference depending on treatment . the most remarkable observation is that a calibration based on combined datasets results in the lowest effect of prior analytical decisions on both evolutionary rate and node age estimation, together with a reduction of 95% hpd intervals associated to these estimates. this effect hints at the importance of using multiple gene data on calibration exercises, both as a way to average across genes, diluting idiosyncratic behaviors of stand-alone markers, but also to help the analyses to converge into more precise estimates.

clock calibration with protein coding genes
the response to changes in analytical conditions differs between protein coding mitochondrial markers and the huwe <dig> gene fragment. thus, for the latter, the selection of a suboptimal clock model produces marked differences in the estimation of both the rates of molecular evolution and the inferred tmrca of carabus, while this choice reveals no remarkable effects in the case of the mitochondrial genes. this behavior can be related to the underlying rate heterogeneity for each marker class: clock-like in the case of mtdna data, but moderate in that of huwe <dig>  the selection of an unsuitable strict clock for the nuclear gene distorts branch length estimation and all parameters derived from these. in turn, the protein coding nuclear marker shows no apparent changes in the two parameters of interest through different partition schemes, while the mitochondrial genes prove more sensitive to complex evolutionary models, including the effect of adding or excluding an outgroup to the estimations. as with clock model selection, the partitioning scheme employed affects branch length estimation, and consequently the resulting inferred rate, a behavior already reported in other studies  <cit> . mitochondrial protein coding genes show a trend to slightly higher inferred evolutionary rates and tmrca of carabus with increasing partitioning; and the same is true for the mit and mit-nuc datasets. the influence of codon site-specific models is similar to that found by papadopoulou et al.  <cit> , in their study of darkling beetles from the aegean islands based on two mitochondrial and two nuclear fragments. these authors found up to 11% discrepancy in inferred rates between np and 3p partitioning, higher for the latter, both under uln clock assumption and using relatively recent calibration nodes , as used in our study. conversely, other studies found the opposite trend, with younger estimated ages when using complex codon partitioning models for mitochondrial data . this trend can be caused by the same underlying problem related to the specific way in which saturation effects are corrected, but combined in this case with the use of deep calibration points  to infer younger node ages.

there seems to be an effect of the relative position of calibrating nodes on the ages extrapolated along the tree. saturation and incorrect branch length estimation in deeper parts of the tree despite complex model-based corrections could explain these differences. the use of relatively recent calibration nodes should produce reliable age estimates for other nodes in areas of the tree not affected by saturation, with error accumulating progressively for deeper nodes, possibly with underestimated branch lengths, and in this case providing with minimum age estimates. depth constraints restrain branch stretching in most of the tree, and when deep nodes are affected by incorrect length estimation due to saturation problems, errors in resulting node ages will be extrapolated to more recent parts of the tree, resulting in older than true time estimates for such recent nodes  <cit> .

bayesian phylogenetic inference is known to produce incorrect long branch estimates at least in the case mitochondrial codon-partitioned datasets  <cit> . these flawed estimations have been found to be stable across independent runs with fixed parameters, but also when bayesian prior parameters are modified, an additional difficulty to detect them. it appears to be the case of the observed high rate increments when partitioning nd <dig> data by codon position  for both the ingroup and outgroup datasets. this type of misbehavior seems to be dependent on the characteristics of particular datasets, so that slight changes in taxon sampling can provide correct estimates  <cit> . taking advantage from the availability of nd <dig> sequences of carabus in genbank, we have conducted np, 2p and 3p partitioning calibration analyses for the expanded nd <dig> dataset . these analyses produced moderate increments in the estimated evolutionary rate for nd <dig> as more partitions were considered, in agreement with the results from other mtdna genes, supporting the reliability of these estimates.

clock calibration with non-coding genes
the effect of methodological choices is markedly higher for non-coding gene fragments than it is for protein coding genes, on both mean rate and node age estimations, but also on their corresponding 95% hpd intervals. indeed, calibration exercises based on non-coding genes frequently face alignment ambiguity and departures from the molecular clock, which can both jeopardize reliable branch length estimation. these problems increase with evolutionary distance between taxa, thus raising concerns about deep node calibration using slowly evolving ribosomal genes. several alignment strategies have been proposed to deal with length variation in homologous dna sequences , and discarding ambiguous dna positions has been also proposed as a complementary method  <cit> . we examined the effects of the latter procedure on global rate and node age estimation. expectedly, character removal, especially when applying restrictive culling options , has a marked effect which is negatively correlated with marker conservation. highly variable gene fragments, with gappy alignments, can lose a significant amount of phylogenetic information when filtered out of ambiguous alignment positions, and consequently contribute with unreliable calibrations.

as with protein coding genes, there is a strong effect of clock model selection for nuclear ribosomal gene fragments as well. for these markers, sc was unfavored in most cases and its implementation resulted in lower mean values for inferred evolutionary rates and higher ages  on the estimated tmrca of carabus, compared to the use of a favored uln clock. while this behavior is not exclusive of non-coding genes, its prevalence for non-coding data cautions about their use for node age estimation without appropriate accounting for rate heterogeneity in calibration analyses.

CONCLUSIONS
our study centred on the genus carabus illustrates some of the common problems but also alternative solutions and suitable strategies to molecular clock calibration analyses, exploring the possibility of synergic effects of wrong methodological decision. mitochondrial genes generally fit the strict clock model of evolution, providing an adequate and simple frame to conduct calibration analyses. however, the combination of several genes including nuclear and mitochondrial fragments results in the best strategy to minimise the effect of both the idiosyncratic behavior of individual markers and analytical aspects on the estimation of evolutionary rates and node ages. but even for mitochondrial genes or combined datasets, rate differences between markers, together with the effect of specific analytical decisions on their estimation, advise against extrapolating rates between different studies. as a summary of the findings reported here, it should be always desirable to check for the appropriate data partition scheme, and for the underlying evolutionary model for each partition; it is also necessary to investigate whether the data really fit a molecular clock previous to any calibration study, applying suitable corrections if needed. the analysis of time on trees should avoid as much as possible regions with dubious homology due to alignment ambiguity, or keep them to a minimum, since gap exclusion has a dramatic effect on branch length estimation and concomitant rates and node ages. finally, the analyses benefit from enquiry circumscribed to ingroup taxa , minimizing the biases introduced by highly divergent lineages and saturation.

abbreviations
bf: bayes factors; lnbf: natural logarithm of the bayes factors; hpd: highest posterior density; sd: standard deviation; tmrca: time to the most recent common ancestor; np: non-partitioned data; 2p: two codon partitions: with 1st and 2nd position together; 3p: three codon partitions; g-np: partitioning by gene with no codon partition; g-2p: partitioning by gene: with two codon partition of coding genes with 1st and 2nd position together; g-3p: partitioning by gene: with three codon partition of coding genes; sc: strict clock; uln: uncorrelated log normal clock; nogaps: dataset excluding ambiguous character with the nogaps option and default parameters in gblocks; allgaps: idem: applying allgaps option; mit: concatenation of mitochondrial genes; nuc: concatenation of nuclear genes; mit-nuc: concatenation of all genes

competing interests
the enclosed work has not been under consideration for publication in another journal or book and has been approved by all authors and institutions. all persons entitled to authorship have been so named and all authors have seen and agreed to the submitted version of the manuscript, and declare no competing interests affecting them in the paper under consideration.

authors' contributions
ca and js collected samples. ca and jg-z conceived the study and designed the analyses, ca gathered the molecular data and performed the analyses. jg-z, ca and js wrote the manuscript and all authors read and approved the final version.

supplementary material
additional file 1
additional file. one pdf file including: a) supporting figures and legends. figure s <dig> to s <dig>  phylogenetic trees of the genus carabus obtained with mrbayes, beast  and beast  under the selected parameters. bars represent 95% confident intervals for the node ages in ma. numbers inside nodes represent posterior probabilities. s <dig>  cox1-a; s <dig>  cox1-b; s <dig>  cob; s <dig>  nd5; s <dig>  rrnl; s <dig>  lsu-a; s <dig>  lsu-b; s <dig>  its2; s <dig>  huwe <dig>  s <dig>  mit; s <dig>  nuc; s <dig>  mit-nuc. b) supporting tables. table s <dig> primers used in the molecular clock calibration study of the genus carabus. table s <dig> data about nd <dig> sequences and specimens of the genus carabus and related taxa employed to conduct initial calibration analyses. table s <dig> calculations for the objective selection of alignments. table s <dig>  marginal likelihood values in beast analyses for individual and combined gene fragments as estimated in tracer v <dig> . table s <dig> mean rates of molecular evolution and 95% hpd intervals in calibration analyses on the genus carabus. table s <dig> mean ages and 95% hpd intervals in calibration analyses on the genus carabus. c) supplementary text d) supplementary references.

click here for file

 acknowledgements
this research was funded by projects cgl2006/ <dig>  cgl2009- <dig>  and cgl2008- <dig>  of the spanish ministry of science and innovation , as well as project 08724pi <dig> of the fundación séneca  . ca received the support of fpu predoctoral studentship of the spanish ministry of education. thanks are due to obdulia sánchez, ana asensio  and gwenaelle genson  for their technical assistance. carlos ruiz , ignacio ribera  and especially paula arribas  helped with their comments and advise. jean-yves rasplus  facilitated c.  cancellatus and achille casale  helped with the identification of some taxa. mrbayes was run using the resources of the computational biology service unit from cornell university, which is partially funded by microsoft corporation; most final computing was carried out using the facilities of the ben arabi supercomputer of the fundación parque científico de murcia.
