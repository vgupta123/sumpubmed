BACKGROUND
bulk segregant analysis  is an elegant method that allows simultaneous identification of genetic loci that contribute to a specific trait or phenotype . recently, bsa has been coupled to high throughput sequencing methods . in such a bsa set up, an individual displaying a phenotype of interest  is crossed with a reference  parent lacking this phenotype to generate a population of segregants. subsequently, the segregants are screened to identify a subset displaying the phenotype of interest. these selected individuals are pooled together , and the genomic dna of the pool isolated. high-coverage sequencing of this pooled genomic dna allows identifying for each polymorphic genomic site  the relative frequency of the two  parental variants in the pool. variant frequencies of these snps should theoretically be 50% for either parent variant, except for those regions that are genetically linked to the phenotype of interest. at those regions, often referred to as quantitative trait loci , the causative allele from the superior parent will be over-represented. the corresponding allele of the inferior parent will be under-represented. figure  <dig> shows a schematic representation of this approach, which has been successfully applied amongst others in saccharomyces cerevisiae for high ethanol tolerance  <cit> , impaired vacuole inheritance  <cit> , xylose utilization  <cit> , heat tolerance  <cit> , variation in colony morphology  <cit> , tolerance to  <dig> different ecologically relevant environments  <cit>  and  <dig> chemical resistance traits  <cit> ; in zea mays for drought resistance  <cit> ; in arabidopsis thaliana for growth defects  <cit>  and cell wall composition  <cit> ; in oryza sativa to find agronomically important loci  <cit>  and in danio rerio to study developmental mutants  <cit> .

theoretically, for any marker site not linked to the phenotype of interest, the alleles in the pool of segregants should be inherited in nearly equal proportions  from either parent. a statistical test  can be applied for each genetic marker separately to assess the extent to which the variant frequency at the marker site deviates from the expected inheritance probability of 50%. hence, the power of qtl mapping by bsa depends on the size of the initial population of segregants, the size of the selected pool and the strength on the phenotype . however, the sequencing procedure can compromise the qtl-mapping power: the sequencing coverage should at least be equal to the number of segregants to ensure information retrieval from all segregants  <cit> . when the coverage is too low, variant frequencies at marker sites will deviate significantly from the theoretical 50% in phenotype-neutral regions due to sampling error. in addition, errors introduced during library preparation, sequencing, read alignment and snp calling can also cause bias in variant frequency and result in falsely linked regions . as a result, in reality, spurious deviations of the observed variant frequencies from the theoretical 50% at marker sites will occur due to different sources of experimental error.

to increase the power of qtl mapping by bsa the properties of linkage disequilibrium can be exploited. linkage disequilibrium  arises because proximal marker sites are co-inherited  <cit> : in a bsa set up, a causative mutation will thus always be embedded in a larger region of marker sites that all display a deviation from the theoretical 50% inheritance of either parental variant. the extent of the deviation decreases with the distance to the causative mutation and depends on the resolution of the bsa. linkage disequilibrium produces deviations of variant counts towards the superior variant, not only at the genetic marker site causative to the phenotype of interest, but also in genetic marker sites closely located to these causative marker sites.

state-of-the-art bsa methods exploit ld to increase the power of bsa analysis but they differ in the way ld is modeled. a first set of methods model ld in a mere data driven way: relative variant frequencies are fitted robustly fit using a sliding window based strategy followed by different smoothing functions  <cit> . more recently, edwards and gifford  <cit>  developed a bayesian network called multipool to estimate the probability of linkage for each site and leshchiner et al.  <cit>  developed an hmm tailored to perform fine mapping of causative sites in mutagenesis experiments.

we developed a hidden markov model  called explora that explicitly models the effects of linkage disequilibrium to explain the dependencies between neighboring variant frequencies in the observed data. in contrast with other methods, explora models the relationship between a genomic variant and the phenotype of interest as a hidden state and use beta-binomial distributions to calculate emission probabilities of the observed data. tests on simulated data show that explora outperforms currently available state-of-the-art algorithms especially in cases where only a limited number of selected segregants can be produced. to further assess the performance of explora we analyzed a recently published dataset, described in swinnen et al.  <cit> , in which three different pools of yeast segregants were used, two of which were selected for tolerance to a different high level of ethanol and one which was used as unselected control pool. upon re-analysis of the data of swinnen et al.  <cit>  with our hmm model, we were able to identify reliably qtls linked to ethanol tolerance that could not be identified with statistical significance in the original study  <cit> . an open source java implementation of explora, useful for external use and independent validation is available at: http://bioinformatics.intec.ugent.be/kmarchal/supplementary_information_duitama_2013/.

methods
explora method
explora is a hidden markov model  which has per marker site two emission probabilities that model respectively that the variants in the pool at the marker site originate from the superior parent  or to an equal extent from either parent . the effect of linkage disequilibrium is modeled by the transition probabilities τ between two neighboring marker sites. the transition probability τ models the chance that a neighboring site remains in the same state as its preceding site state. its distribution is described by a negative exponential model as a function of the recombination rate and the physical distance between neighboring marker sites  <cit>  .

given a random state ni or pi at a marker site ‘i’ , the transition probabilities to the states ni +  <dig> or pi +  <dig> for the neighboring marker site ‘i + 1’ are given by:

 τni→ni+1=1-e-rli 

or

 τpi→pi+1=1-e-rlis 

where li is the physical distance between the marker sites i and i +  <dig> and r is a recombination rate, which is determined by the average number of crossing-overs occurring during meiosis over a given distance in a chromosome. the default level of r was fixed at  <dig>  × 10- <dig>  based on the estimations derived by ruderfer et al. <cit> .

each state in the model emits a random variable na, corresponding to the number of variant counts at a given marker site originating from the superior parent. na is described by a beta binomial distribution, which allows capturing different emission probabilities in phenotype-linked versus neutral states by choosing different α and β parameters for their corresponding distributions . we modeled all neutral states with the same parameters αn and βn, and all phenotype-linked states with the same parameters αp and βp.

given the observed total variant count and the variant counts that originate from the superior parent at each marker site  and fixed values for the parameters αn, βn, αp, βp, and τ, we can calculate the posterior probability of each state in the hmm with a standard forward-backward algorithm  <cit> . for each marker site, we then estimate its probability to be linked to the phenotype of interest as the normalized probability p /  + p).

since most of the genomic regions are supposed to be neutral with respect to the phenotype of interest, the parameters αn and βn of the emission probabilities in the neutral state can be estimated directly from the observed variant frequencies. to this end, we implemented a two-step process in which we first assume that most of the genomic regions are phenotype-neutral. we estimate with the method of moments the most likely values of αn and βn given the variant frequencies at each marker site. then in a second step we identify the marker sites linked to the phenotype of interest using the model, and we estimate again αn and βn leaving out the marker sites identified to be linked to the phenotype.

simulated data
to assess the robustness of explora we conducted simulations as follows: an artificial chromosome of length  <dig> kbp with random polymorphic sites was simulated. a single site was randomly chosen to be causative. for each simulation we defined in advance a proportion of segregants in the selected pool with the causative site . this proportion is used to construct a selected pool as follows: each segregant originates by randomly combining both parental alleles. so each segregant has a probability of 50% to contain the causal variant. each segregant with the causal variant has a probability equal to the psc to be present in the final pool whereas a segregant without the causal variant has a probability of 1-psc. segregants are added to the pool until the final number of selected segregants is reached . by defining in the simulations the ‘noise level’ as the psc we avoid to make any assumptions on the cause of the ‘noise level’  and the subsequent choice of an explicit model to describe the ‘qtl effect’ of the segregants. it is important to note that in this simulation set up, a higher number of segregants  does not increase the noise level . the effect of n only affects the results through its effect on the statistical power  or because at low values of n the relative impact of a sampling error will be higher. pools of selected segregants of size n were created by recombining the parental strains at a constant recombination rate of  <dig>  centimorgans  per kilobase, which is the average value for a yeast chromosome  <cit> . sequences of the selected pools were simulated at variable coverage  with a constant sequencing error rate of  <dig>  . a total of  <dig> datasets were created for each tested combination of simulation parameters.

performance analysis
to test the effect of the parameters on the performance of explora we used the fixed simulation parameters mentioned above and the following variable ones: n =  <dig>  c =  <dig>  the psc was varied from  <dig>  to  <dig>  and the number of polymorphic sites  was changed from  <dig> to  <dig>  the αp/βp ratio was varied from  <dig> to  <dig> and the assumed recombination rate  was changed from  <dig>  x 10- <dig> to  <dig>  x 10- <dig>  for each setting we report the recovery rate , the size of the linked region containing the position of the true causal site and the number of false positive linked regions.

comparison with state-of-the-art
to perform a comparison with magwene et al.  <cit>  and multipool  <cit>  we used the fixed simulation parameters mentioned above and the following variable ones:  <dig>  <dig> random polymorphic sites of which a single site was randomly chosen to be causative. two noise scenarios are presented: low noise with a psc of  <dig>  indicating that around 95% of the selected segregants contained the causative allele of the superior parent, and high noise scenario with a psc of  <dig> . pools with an increasing number of segregants  were simulated. sequencing of the selected pools was simulated at variable coverage .

a standalone version of the method described by magwene et al.  <cit>  was obtained from the authors and multipool  <cit>  was downloaded from http://cgs.csail.mit.edu/multipool/. for the purpose of comparison all tools were run on the simulated data . to assess recovery rate we measured for each method the number of times that the region in which the causative site was embedded was found to be significantly linked divided by  <dig> . for explora a marker is significantly identified if the posterior probability assigned to the marker is larger than  <dig> . for the method of magwene et al.  <cit>  we calculated for each experiment the null distribution of the g' score using the non-parametric method described by the authors. based on this null distribution, we calculated a p-value for each marker, also following the method described in  <cit> . a marker is significantly linked with the phenotype if its p-value passes correction for multiple testing at a  <dig>  significance level  <cit> . two types of corrections for multiple testing  were applied  <cit> . for multipool a marker is significantly linked if its lod  score falls within a 90% confidence interval  <cit> .

specificity is measured using two metrics: the size of the linked region at the causal position and the number of false positive linked regions found. we ran the method of magwene et al. with a default genetic window size of 30 cm, as recommended by the authors  <cit> . for explora we fixed the αp/βp ratio at  <dig> which gives the best tradeoff between the recovery rate and the size of the predicted regions. multipool was run with the default discrete block size of 100 bp  <cit> .

real dataset
to test our method, we used the dataset reported by swinnen et al.  <cit> . in their work, a segregant, vr1-5b  from a brazilian bioethanol production strain vr <dig> was crossed with the by <dig> lab strain . a total of  <dig> segregants tolerant to 16% ethanol and out of these,  <dig> segregants also tolerant to 17% ethanol, were pooled. dna of the pools and also of the vr1-5b parental strain was extracted and sequenced using illumina technology   <cit> . a total of  <dig> unselected segregants from the same cross were also pooled and sequenced as control experiment .

marker sites were identified as follows: the yeast s288c reference genome  available in the saccharomyces genome database  was used as reference. all reads from the parental strain vr1-5b were mapped to the reference sequence using bowtie <dig>  <cit> . we used the -a option to retain as many good alignments as possible for each read. over 93% of the reads from vr1-5b, 84% and 86% of the reads from the pools of segregants under selection, and 98% of the reads from the pool of unselected segregants could be mapped to the latest reference genome. we ignored the last 25 bp of each read from the vr1-5b strain and the two pools of selected segregants based on the base calling error rate estimated from unique alignments.

snps and small indels between the two parents vr1-5b and s288c  were identified with the snvq algorithm  <cit> . we filtered out predicted variants with genotype quality scores lower than  <dig>  falling into annotated repetitive regions , or falling into duplicated regions predicted either by reads with multiple alignments or by the cnvnator algorithm  <cit> . finally, we filtered out predicted variants located less than 30 bp from each other to avoid undesired local errors due to misaligned reads. we obtained  <dig>  snps and  <dig>  indels which were used for analysis of segregant pools.

to identify the relative variant frequencies in the pools of segregants at marker sites, we implemented a custom script to count at each marker site the number of read alignments that support the variant originating from the superior parent  and the total number of alignments. within each pool variants with read coverage less than  <dig> or over  <dig> were ignored. we retained  <dig>  variants for the 16% pool,  <dig>  variants for the 17% pool, and  <dig> variants for the pool of unselected segregants.

experimental validation
experimental verification of qtl <dig> on chromosome x was based on determining for a selected set of marker sites in this region, the number of times individual segregants selected for high ethanol tolerance displayed the variant originating from the superior parent   <cit> . relative variant frequencies in individual segregants were used to calculate the posterior probability of each marker site to be linked to the phenotype of interest using an exact binomial test with a confidence level of 95% and correction for multiple testing by a false discovery rate  control according to benjamini and yekutieli  <cit> . ethanol tolerance assays and reciprocal hemizygosity analysis were carried out as described previously  <cit> .

RESULTS
development of explora, a hmm for the analysis of bsa data
as indicated above, bsa is the first step towards finding sequence variations  that cause a given phenotype. causative sequence variations originating from the superior parent are expected to be over-represented in the selected segregant pool. due to linkage disequilibrium , other variants at marker sites that surround the causative site will also be over-represented in the selected pool. ld thus limits the resolution of the bsa analysis towards identifying the region in which the true causal site is embedded rather than the true causal site. however, this dependency between neighboring sites  can be exploited to increase the power of the statistical linkage of the identified loci to the phenotype of interest by filter out spuriously linked regions. to exploit the information contained in the dependency between neighboring marker sites, we developed a hidden markov model  called explora . explora explicitly models the effect of linkage disequilibrium to explain the dependencies between neighboring sites in the data. explora models for each marker site, two possible states: one state  expresses that the variants in the pool at that marker site originate predominantly  from the superior parent and are thus linked to the phenotype of interest. a second state  models that the variants in the pool at a given marker site originate to an equal extent from either parent, in which case the marker site is assumed to be located in a neutral region not linked to the phenotype of interest. the effect of linkage disequilibrium is modeled by the transition probabilities τ between two neighboring marker sites. the transition probability τ models the chance that a neighboring site remains in the same state as its preceding site state. its distribution is described by a negative exponential model as a function of the recombination rate r and the physical distance between neighboring marker sites  <cit>  . the probability to change states upon transition from one marker site to its direct neighboring marker site  is then described by 1-τ and takes into account the true distance between them . the model captures the fact that marker sites located in each other's physical neighborhood are likely to be in linkage disequilibrium and less likely to change their state .

each state in the model emits a random variable na, corresponding to the number of variant counts at a given marker site originating from the superior parent. na ranges from  <dig> to n, with n being equal to the  total variant count for the marker site. na is described by a beta binomial distribution, which allows capturing different emission probabilities in phenotype-linked versus neutral states by choosing different α and β parameters for their corresponding distributions . we modeled all neutral states with the parameters αn and βn, and all phenotype-linked states with the parameters αp and βp. while for the neutral states αn should almost equal βn to make values of na closer to n/ <dig> more likely to be sampled, for the phenotype-linked states αp should be much larger than βp to make values of na close to n more likely to be sampled.

the ratio between αp and βp thus defines the degree to which the relative variant frequency at a marker site needs to differ from the one obtained through random inheritance for it to be called linked to the phenotype . changing the ratio affects the probability with which an observed relative variant frequency is interpreted by the model as a phenotype linked region . in our experiments, we altered the ratio between αp and βp by fixing βp equal to  <dig> and testing different values of αp. a cut-off on the obtained posterior probability of each marker site to be linked to the phenotype was used to prioritize the most likely causative marker sites for the phenotype of interest.

parameter sensitivity of explora
we tested to what extent changing the model parameters  affect the results in terms of the recovery rate, the number of falsely predicted linked regions and the average size of the predicted regions. tests were performed under two different settings that assess respectively the effect of diluting the signal to noise ratio and the resolution of the bsa. changing signal to noise ratio’s is simulated as explained in materials and methods  and mimics the effect of e.g. having an incomplete qtl effect of the causal genes, because for instance several minor alleles might be involved or because of an imperfect selection procedure of the segregants. the bsa resolution was altered by varying the number of marker sites in the artificial set up .

both figures  <dig> and  <dig>  show that irrespective of the choice of the parameters, the recovery rate will drop with the noise in the dataset , the average region size becomes smaller with increasing noise levels  and the number of falsely predicted linked regions is quite noise independent . when the signal/noise level decreases, a longer region with truly deviating relative allele frequencies  will have more chance to become interrupted as the distinction between signal and noise is not that clear. as explora is designed to detect regions for which the deviating allele frequencies towards the superior allele are consistently maintained between neighbouring markers, explora in most cases still allows detecting the region encompassing the true causal site  but not the regions located more towards the end of the ld region. higher noise levels thus result in smaller identified regions without interfering with the number of falsely predicted linked regions.

figures  <dig> and  <dig> also show that the recovery rate, the region sizes and the number of falsely predicted linked regions  are almost independent of the bsa resolution , provided a minimal number of markers is available. in the following, we will focus on the effect of the parameter choices on the results of explora.

the parameter ‘recombination rate ’ determines the shape of the transition probability function which models the change from the n-state to the p-state and vice versa. explora predicts causal sites by transitioning between these states. gradually overestimating/underestimating the recombination rate, decreases the impact of linkage disequilibrium in modeling the effect between neighboring sites. how this affects explora is shown in figure  <dig> . in general, as r is gradually more overestimated, markers sites will be treated increasingly independent and each region with a sufficiently deviating relative allele frequency will be predicted as being linked to the phenotype, even spurious signals. this is clear in figure  <dig> that shows that independent of the noise level or the number of markers , seriously overestimating r results in smaller linked region sizes of the true peaks. this, however, comes at the expense of selecting a much higher number of false positive regions. expectedly, this behavior is most pronounced under conditions with a high number of markers as under those conditions the chance of introducing spurious signals is higher. the behavior is also more present at low noise levels which is counterintuitive, but can simply be explained by the fact that at high noise levels explora does not identify any linked regions, not even spurious ones. however, at low noise levels when regions are identified, overestimating r results in splitting up a truly linked region into smaller regions because the method becomes more sensitive to the small noisy variations in allele frequencies. so rather than identifying truly falsely linked regions, a high value of r only results in splitting up a truly linked region.

in contrast to the number of false linked regions and the region size, the recovery rate is unaffected by the choice of the parameter r. contrarily to overestimating r, underestimating r almost does not affect the results.

changing the αp/βp ratio affects the emission probability or the probability with which an observed relative variant frequency is interpreted by the model as a phenotype linked region. increasing the αp/βp ratio makes the prediction more stringent, meaning that a higher deviation of the relative allele frequency is needed before the region is considered linked.

the results in figure  <dig> are consistent with this explanation: expectedly a lower αp/βp  increase the recovery rate. interestingly, the choice of αp/βp does not affect the number of falsely linked regions , but it rather affects the average size of the linked regions. this means that provided the parameter r is not overestimated and linkage disequilibrium is taken into account, consistency between neighboring marker sites will compensate for the spurious deviations in relative allele frequencies. making the ratio αp/βp less stringent will thus only extend the size of the truly linked region, but does not affect the number of false positive predictions.

also the recovery rate, region size and the number of false positive linked regions  as a function of the number of marker sites is relatively independent of the choice of αp/βp. for a high number of markers, it seems that a less stringent αp/βp ratio results in a relatively higher number of false positives . to some extent introducing more markers will result in a higher chance of also detecting spuriously deviating relative allele frequencies.

conclusively, at a number of available marker sites comparable to those found in real life situations , and choosing a value for r that approximates the real recombination rate , explora will be able to predict truly linked regions with very little false positive regions, even for experimental settings with low qtl effect . the choice of αp/βp allows tuning the tradeoff between the recovery rate and the size of the linked region but does not interfere too much with the number of false positive regions.

comparison with state of the art
to illustrate the added value of explicitly modeling linkage disequilibrium  in explora, we ran our tool on simulated datasets and compared its performance to that obtained with the method of magwene et al.  <cit>  and multipool  <cit> . the first one is a state-of-the-art method for the analysis of bsa results, belonging to the class of statistical methods that apply a windows-based strategy to capture the block-like behavior of the relative allele frequencies plotted along the genome. multipool uses a dynamic bayesian network to model the changes in relative allele frequencies along the chromosome.

simulations mimicked different bsa experiments, differing from each other in their noise level , the number of selected segregants  and the coverage  at which this pool was sequenced. note that in our simulation set up, the noise level is mimicked by fixing the ratio of the segregants in the pool that have the causal allele versus those that have not. as a result, except for the higher impact of sampling errors at low n, the noise level in our simulation set up is independent of the number of selected segregants n.

for each experimental set up  <dig> different datasets were simulated and performances were assessed by the recovery rate, the false positive detection rate, and the average region size as described in materials and methods.

figure  <dig> shows that expectedly for both the method of magwene et al.  <cit>  and explora the recovery rate decreases with the noise in the dataset. the number of false positives is quite noise independent for both methods. for the method of magwene et al.  <cit> , and for a given n, c combination, the size of the linked region is relatively independent of the noise level, whereas for explora we again observed a decrease in region size with the increase in noise level . for both methods the performance  decreases with a lower number of segregants. this is due to the fact that at low n values, sampling errors increase i.e. the relative impact of by chance including a segregant that does not carry the causal allele is higher. for the method of magwene et al. a low n also interferes with the used statistics, further exacerbating the dropin performance at low n. this is also the reason why magwene et al.  <cit>  specifically recommend against applying their method on data obtained from small segregant pools.

given the used parameter and the multiple correction settings, explora obtains a higher recovery rate with smaller regions sizes for both noise levels than the method of magwene et al.  <cit> . this low recovery rate of magwene et al.  <cit>  is mainly due to the stringency in the selection imposed by the robust correction for multiple testing  <cit>  as the raw linkage scores prior to the correction were observed to be genuinely high at truly linked regions. the robust correction for multiple testing also results in the counterintuitive decrease of recovery rate of magwene et al.  <cit>  with increasing coverage, a behavior that was not expected based on the visual interpretation of the raw linkage score  . using the less stringent correction for multiple testing  <cit>   compensates for this loss of recovery rate, but comes at the expense of a much larger linked regions .

given its default parameter settings, multipool  <cit>  selects under all tested conditions  one region which almost always contains the causal site, but which can be excessively large . as a result the recovery rate and the number of falsely predicted regions always tend to be respectively  <dig> and  <dig>  therefore the size of the detected regions is much more informative to assess the performance of multipool  <cit>  than recovery rate and number of falsely predicted linked regions. given a sufficiently high number of segregants n and a minimal coverage c, multipool outperforms explora in better estimating the region close to the true causal site. however, compared to explora, multipool  <cit>  is less robust to changes in the number of segregants  and the coverage  than explora and it starts underperforming compared to explora in the presence of few segregants and low coverage. this is because in contrast to explora, which estimates the transition probability to move from a linked to a non-linked state from a negative exponential model as a function of the recombination rate r and the physical distance between neighboring marker sites, multipool  <cit>  uses the change in the estimates of the relative allele frequencies between neighboring marker sites to calculate the transition probability. when the number of segregants  is small or the coverage  is low, there are insufficient data to correctly estimate the distribution of the relative allele frequencies along the chromosome correctly and thus to obtain correct estimates of the transition probability. as a result, chances are higher of obtaining transitions probabilities close to  <dig> across neighboring marker sites, which to our opinion explains why multipool  <cit>  outputs very long linked regions at a low number of segregants.

conclusively, explora shows state-of-the-art performance. more importantly its performance remains extremely robust even when lowering the number of selected segregants or when the signal/noise level is low. these properties make the method particularly useful under bsa conditions for which segregant selection is non-trivial or the qtl effect is minor .

application of explora to real datasets
to evaluate the performance of our analysis method with a real bsa experiment, we applied explora to the data described in swinnen et al.  <cit> . in their analysis they used a statistical smoother to facilitate detecting from the raw data regions with deviations in relative allele frequencies. based on visual inspection and comparing the results from the  <dig> and 17% pool allowed them to predict six loci as being significantly linked to the phenotype, all of which were also explicitly mentioned in the paper. of those loci, the ones located on chromosomes v, x and xiv were denoted as respectively qtl <dig>   <dig> and  <dig> by swinnen et al. the three remaining loci, located on chromosomes ii, xii and xv did not receive a qtl number in the publication by swinnen et al. in the original paper, qtls  <dig>   <dig> and  <dig> were further proven to be statistically linked by individual genotyping of snp markers surrounding each qtl  <cit> .

to test to what extent we could recapitulate their results, we ran explora with both αp/βp =  <dig> and αp/βp =  <dig> ratios and a cut off on the posterior probability score of  <dig>  on the pools selected for  <dig> and 17% ethanol separately. in figure  <dig> the most confident results are shown i.e. those results that either could be confirmed with both parameter settings  or that could be confirmed in both pools  with at least one parameter setting. with αp/βp =  <dig> and setting a minimum posterior probability of linkage of  <dig>  we predicted in the 16% pool  <dig> marker sites clustered in four loci. in agreement with the initial study of swinnen et al.  <cit>  we identified the experimentally verified qtl <dig> located on chromosome v between coordinates  <dig>  and  <dig> , containing the causative gene ura <dig>  qtl <dig> located on chromosome x between coordinates  <dig>  and  <dig>   and qtl <dig> encompassing a gene cluster on chromosome xiv between coordinates  <dig>  and  <dig> , containing the causative genes mkt <dig> and apj <dig>  in addition, we detected one locus that was mentioned, but not further validated in the initial publication: a small, but still significant region on chromosome ii ). the length of the linked regions identified with αp/βp =  <dig> varies from as small as  <dig>  kbp for qtl <dig> to as large as  <dig> kbp in qtl <dig> 

these four qtls  identified in the 16% pool were also detected in the analysis of the 17% ethanol pool using explora with the same parameter settings , further increasing the confidence that these qtls were truly linked to ethanol tolerance  of the total number of linked marker sites  in the 17% pool). in addition the more stringently phenotypic selection of the 17% pool allowed drastically decreasing the length of qtl <dig> and qtl <dig>  as detected by explora with αp/βp = <dig> 

the remaining  <dig> linked markers in the 17% pool mapped to a locus  encompassing a region of  <dig> kbp in chromosome xv  and to three small regions on chromosomes i, vi, and xii . neither of those qtls was detected in the 16% pool, indicating that they are specifically enriched at more extreme ethanol levels . the fact that the region at chromosome xv  could also be confirmed with the more stringent value of αp/βp =  <dig>  indicates that from these additional qtls, this region is the best candidate to be an additional truly linked region. using the same settings , explora did not report significant relationship with ethanol tolerance for any polymorphic site in the control pool of unselected segregants.

figure  <dig> further illustrates the effect of changing the αp/βp ratio on the recovery rate and the size of the linked region for the identified qtls on respectively the  <dig> and 17% pool. as predicted by the simulation experiments, changing the ratio αp/βp from less  to more stringent values  reduces the length of the linked region size, but comes at the expense of missing the least pronounced qtls. for instance, for the 16% ethanol pool increasing the αp/βp ratio, reduces the length of qtls from  <dig> kbp to  <dig> kbp and from  <dig> kbp to  <dig> kbp in qtl <dig> and qtl <dig> respectively. however, this more stringent setting results in missing qtl <dig> and qtl <dig>  in the 16% pool, indicating that for this pool the signals of these qtls are not very pronounced . equally, in the 17% pool increasing the stringency of explora, reduces the length of the linked regions in qtl <dig>   <dig> and  <dig>  but results in missing qtl <dig> and qtl <dig> and the additional smaller linked regions in chromosomes i, vi, and xii.

these results indicate that the signal of qtl <dig> is prominent in both pools and thus very relevant for ethanol tolerance under both ethanol conditions. the signal of qtl <dig> is clearly more pronounced in the 16% pool than in the 17% pool, whereas for the signals of qtl <dig> and qtl <dig> the opposite is true, implying that under both ethanol conditions other protection mechanisms tend to play a role. the region in qtl <dig>  despite being a minor locus  might play an equally important role under both ethanol conditions as it is recovered in both pools.

experimental validation of the newly predicted qtl <dig> on chromosome x
to assess the validity of our predictions, we selected qtl <dig>  for experimental validation as this qtl, despite being important in both the 16% and 17% pool seemed to be one of the more difficult qtls to detect . fine-mapping of the region by pcr-based scoring of the markers in the individual segregants , allowed us to confirm the area with the strongest link. mutations in this confirmed region were verified by sanger sequencing. all genes carrying non-synonymous mutations in their coding region were first selected as candidate causative genes . true causative genes in qtl <dig> were identified using reciprocal hemizygosity analysis  <cit> . for each candidate causative gene a set of two diploid strains was constructed by crossing the parental strains, either containing or lacking the candidate gene. as a result each diploid has a different allele of the candidate gene while the other copy of the gene is deleted . phenotypic analysis on ypd plates with 16% ethanol showed a clear difference in ethanol tolerance between the two diploid strains carrying a different allele of vps70: the strain with the allele derived from the vr1-5b superior parent grew very well in the presence of 16% ethanol, whereas the strain with the allele from the by <dig> inferior parent did not grow at all , indicating that vps <dig> carries a causative mutation responsible for the link of qtl <dig> with high ethanol tolerance. except for a putative role in sorting of vacuolar carboxypeptidase y to the vacuole  <cit> , no link to ethanol tolerance for vps <dig> has been reported previously. this may be due to the fact that all previous analyses of yeast ethanol tolerance were performed with laboratory strains and with much lower ethanol concentrations .

discussion
in contrast to previously applied single locus models  <cit> , most state-of-the-art methods to analyse the results of bsa exploit the dependencies between neighbouring sites to better distinguish truly from spuriously linked regions. whereas classical data-driven statistical approaches fit a complex smoothing function to the data to facilitate the identification of patterns in the relative variant frequency plots, explora explicitly models linkage disequilibrium to explain the observed patterns in the data, which allows to compensate for noise caused by sampling and sequencing errors, and for the low statistical power in case of small pools or incomplete qtl effects. this was clearly illustrated in the simulation experiments where under conditions that become restrictive for a state-of-the-art statistical method such as the one of magwene et al. explora was still able achieve a high recovery rate while keeping a permissible low number of falsely linked regions.

a similar philosophy as the one adopted by explora is also used in the recently published methods multipool  <cit>  and the model of leshchiner et al.  <cit> . multipool  <cit>  uses a bayesian network to explictly infer variation in allele frequencies along the chromosome. such approach allows to better define the region close to the true causal site, but comes at the expense of having to estimate more parameters in the model, which becomes restrictive at low coverage or in the presence of a low number of segregants. results obtained with explora on simulated data show that the specific way in which explora models the effect of ld results in efficiently identifying phenotype-linked regions, even at low signal/noise ratio’s. these results were confirmed by reanalyzing a real dataset in which explora was indeed able to detect additional qtls in the 17% pool that were confirmed by the 16% pool despite the much lower number of segregants in this 17% pool. it was also able to recover for both pools a minor allele  for which the true contribution to ethanol tolerance was confirmed by experimentally identifying its causal gene.

CONCLUSIONS
by using linkage disequilibrium to model the dependency between neighboring marker sites, explora allows to reliably detect qtls using bulk-segregant whole genome sequencing data. results obtained with both simulated and experimental data show that explora displays superior performance under conditions with a low signal to noise level .

availability of supporting data
the sequencing data sets supporting the results of this article are available in the ncbi sequence read archive   under the accession number sra <dig> 

competing interests
the authors declare that they have no competing interests.

authors’ contributions
asr conceived the study. jd and asr designed and implemented the method. asr, jd and spt performed the computational analysis. ag, gh, mfm and jt performed the molecular-genetic studies. jd and asr drafted the manuscript. km participated in the design of the computational analysis and drafting the manuscript. jt, kjv and km coordinated and managed the research. all authors contributed to writing the manuscript and approved its final version.

authors’ information
jorge duitama, aminael sánchez-rodríguez and annelies goovaerts are joint first authors.

supplementary material
additional file 1: figure s1
average scaled linkage score at the causal site reported by the method of magwene et al.  <cit>  as a function of the coverage and under high  and low  noise levels. raw values of the g’ statistics at the causal site  were scaled taking into the maximum  and minimum  g’s values from the entire artificial chromosome according to the following formula: g’scaled = /. reported values correspond to the average of  <dig> repetitions.

click here for file

 additional file 2: figure s2
comparison with the state-of-the-art. the recovery rate , average size of the linked region  and number of falsely predicted regions  under high  and low  noise levels were assessed for explora and the method of magwene et al.  <cit> . for the method of magwene et al.  <cit>  the less stringent correction for multiple testing, which does not take into account dependency between tests, was used.

click here for file

 acknowledgement
funding
this work is supported by: 1) katholieke universiteit leuven funding: goa/08/ <dig>  coe ef/05/ <dig>  ikp/10/ <dig> zkc  <dig>  project natar; 2) agentschap voor innovatie door wetenschap en technologie : sbo-bioframe, sbo  <dig>  sbo-nemoa; 3) fonds wetenschappelijk onderzoek-vlaanderen  iok-b9725-g. <dig> ; g. <dig>  n; 4) ghent university ; 5) the european commission 7th framework program . kjv also acknowledges support from erc young investigator grant  <dig>  vib, ku leuven, fwo vlaanderen, the odysseus program, and the embo yip program.
