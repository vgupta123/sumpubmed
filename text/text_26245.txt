BACKGROUND
family-based designs, from complex genealogical structure to twin studies, are a valuable resource for genetic studies. the primary aim of currently-available software accounting for population substructure and/or relatedness in the statistical model  is to evaluate the association between genetic snp markers and response phenotypes and, to date, very few tools are available to test the association of large quantitative datasets generated by high-throughput -omics technologies  in familial samples. for instance, although modelling of genealogical data can be performed by the coxme  <cit>  and kinship <dig>  <cit>  r packages, r is not a particularly efficient environment to carry out hundred of thousands or millions tests.

we have implemented a user-friendly java program, poppante, to perform exact association tests between large quantitative datasets in family-based studies. relationships between individuals can be described either by known pedigrees of any size and complexity or by genetic similarity matrices  inferred from genome-wide genetic data  <cit> . pedigree-based and pedigree-free relatedness can show some discordance, especially when some degree of hidden relatedness or population substructure is observed in the data and extensive genealogical information is missing or incomplete. for instance, genealogical information going back more than three or four generations may be difficult to be retrieved for individuals recruited in large-scale biobank started in genetic isolates such as those from the middle east.

implementation
poppante assesses the relationship between quantitative dependent variables  and quantitative independent variables  within a variance components framework in order to model the resemblance among relatives.

the association of a single predictor with a single response variable is described as 
  <dig> ri=μ+βpi+∑jψijcij+gi+ei 


where r
i represents the response value for the i-th individual, μ the response mean, β the estimate of the predictor value p
i, ψ
j the estimate of the j-th covariate c, and g
i and e
i the polygenic and environmental effect, respectively.

the total response variance is partitioned into polygenic and environmental variances , and the variance-covariance matrix is calculated as 
 ω=2Φσa2+iσe <dig>  where Φ is the relatedness matrix between each pair of individuals, i is the identity matrix, and σa <dig> and σe <dig> are the additive genetic and environmental variance, respectively.

within the same framework, poppante allows the evaluation of the narrow heritability of any quantitative response variable included in the analysis.

the significance of the association is calculated using a formal likelihood-ratio test comparing the likelihood of the alternative model described in eq.  to the likelihood of a null model where the effect of the predictor is constrained to zero.

poppante implements an exact linear mixed model equivalent to that implemented in the qtdt software  <cit> .

to speed-up the evaluation, poppante clusters variables having the same pattern of missingness , then evaluates the likelihood of the null model once, and reuses the value to assess every variable included in the same cluster. poppante also allows the evaluation of empirical p-values by randomly permuting the predictor values among subjects and re-assessing the association under the null hypothesis. when genealogical information is provided as input, predictor values are randomly permuted within families in order to preserve the phenotypic correlation between family members. to speed up performance, poppante implements an adaptive permutation approach  <cit> , stopping the generation of randomly permuted samples earlier when there is little or no evidence of significance.

pedigree versus population analysis
when genealogical information is available, poppante evaluates the relatedness matrix from the known pedigree relationships using a recursive procedure and assuming pedigree founders as unrelated  <cit> . this results in a variance-covariance matrix that is usually both symmetric and semi-positive definite. therefore, the maximum likelihood estimates of the variance components can be assessed through efficient cholesky decomposition.

when the genealogical information is not available, a gsm can be estimated from genome-wide genetic data with any of several well-established tools, such as plink  <cit> , gcta  <cit> , or ldak  <cit> , and given as input to poppante. the property of positive-definiteness does not always hold for gsms. a bending procedure  <cit>  is used by default to transform the matrix when it is not positive semi-definite –but the user has the option to use a lu decomposition instead. additionally, poppante implements the qr decomposition to solve the rare cases where the variance-covariance matrix is not invertible and neither the cholesky nor the lu decompositions can be used.

to speed-up the evaluation of the variance components, poppante allows the user to set an arbitrary threshold below which individuals can be considered as unrelated. otherwise, the user has the option of using the value of expected kinship between second or third cousins  <cit> .

region-based testing
when predictors can be ordered in space, as in the case of epigenetic markers, poppante allows the computation of region-based association tests by gathering information from flanking predictors included in a sliding window of user-defined size, whose values are replaced by their first principal component. by definition the first principal component accounts for as much of the variability in the data as possible, and can thus be used to summarise the joint distribution of all variables included in a given region for gene- or region-based association studies .

data pre- and post-processing
quantile normalisation  <cit>  can be automatically applied to improve normality of both response variables and predictors. moreover, poppante implements two approaches to correct the association test for unwanted biological and technical variability . when the source of the confounders is known, it can be directly included in the association model. to deal with unknown sources of biological and technical co-variation, poppante can integrate into the association model the principal components that are required to explain a user-specified percentage of variation.

poppante implements the benjamini-hochberg procedure  to control the false discovery rate  <cit> , and, to aid in results interpretation and further analyses, it generates basic quantile-quantile and manhattan plots – the latter only when genomic data that can be ordered in space  are used as predictors.

finally, when the genealogical information is available, to determine whether an association has been generated by a uniform contribution of all the families within the sample, or by a strong contribution of a small number of families, poppante reports, for each test, the percentage of families showing a positive contribution and the gini coefficient  <cit>  assessed on family contribution to the χ
 <dig> statistics.

RESULTS
we carried out a simulation study to estimate poppante’s computational requirements. we also presented two real-world case studies , showing the results obtained through both pedigree-based kinship matrix and gsm .

simulation study
we simulated quantitative response and predictor variables in three-generation families .

in the first simulated scenario, we aimed to test the relationship between running time and number of subjects included in the analysis. therefore, we simulated  <dig> independent datasets including an increasing number of three-generation families  and one response and one predictor variable for all simulated subjects.

in the second simulated scenario, we aimed to test the relationship between running time and number of variables included in the analysis. consequently, we fixed the number of families included in each dataset  and generated  <dig> independent datasets with one response and an increasing number of predictors ranging from one to  <dig> .

both scenarios were simulated  <dig> times and the median time necessary for the testing step recorded. simulations were performed on a mac bookpro  <dig>  ghz, intel core i <dig>   <dig> gb ram; java version  <dig> . default parameters were used for the java virtual machine .

tables  <dig> and  <dig> show the median running time for each simulated scenario. we observed a linear relationship between running time and both samples size and number of tests. as expected, when multiple tests were performed , the per-test running time decreased, due to the fact that poppante clusters variables having the same pattern of missingness and evaluates the likelihood of the null model only once.
one response and one predictor variable were simulated for each subject. each dataset was simulated  <dig> times and the median time necessary for the testing step reported


the number of families included in each dataset was fixed . each dataset was simulated  <dig> times and the median time necessary for the testing step reported




case study 1: epigenome-wide association study in a qatari family study
we carried out an epigenome-wide association study of body mass index  using extended families from qatar. the qatari population is an isolated inbred population characterised by a large number of consanguineous families  <cit> . a detailed description of the subjects and methylation data included in this study has been previously reported in zaghlool et al.  <cit> . briefly, we used genome-wide methylation and snp data generated from whole blood on the infinium humanmethylation <dig> bead-chip  and the illumina humanomni <dig> -8m beadchip, respectively. dna methylation beta-values were measured for  <dig> individuals,  <dig> with both genotype and bmi data in  <dig> multigenerational families. we used gcta to calculate a gsm between pairs of individuals using all autosomal snp markers with minor allele frequency > <dig> . we compared heritability estimates of the methylation values at cpg loci and their association with bmi in the qatari family study using either the family information or the inferred gsm. age, sex, and cell-type proportions as estimated using the houseman method  <cit>  were included in the model as fixed effects. we observed a very high concordance correlation coefficient  <cit>  of the effect size estimates for the association between cpg methylation states and bmi , as well as of the cpg-specific component of genetic and environmental variances .
fig.  <dig> epigenome-wide association study in a qatari family study. comparison of the results obtained in the epigenome-wide association studies when the relatedness between subjects was evaluated using the family structures and when it was inferred from genome-wide snps by means of gcta  <cit> . left panel effect size estimates for the association between cpg methylation status and bmi. right panel estimated genetic  and environmental  variances




case study 2: transcriptome-wide association study in uk twins
in the second case study, we carried out a transcriptome-wide association study with bmi in a cohort of healthy female caucasians twins. the twinsuk adult twin registry includes about  <dig>  subjects, predominately females  <cit> . genotyping of the twinsuk dataset was performed with a combination of illumina humanhap <dig>  humanhap610q, 1m-duo and  <dig> mduo 1m chips and imputation was performed using the impute software package , as previously described  <cit> . expression profiling in subcutaneous adipose tissue was measured using illumina human ht- <dig> v <dig> beadchips for  <dig> female individuals  <cit> ,  <dig> of whom had both genotype data and bmi information. we used ldak to calculate a gsm based on allelic correlation across autosomes. before calculation, we excluded snps with minor allele frequency < <dig> . we compared effect size estimates of the gene expression profiles versus bmi, using either the family information or the inferred gsm. age was included in the model as a fixed effect. we observed a very high concordance correlation coefficient of the effect size estimates for the association between gene expression levels and bmi , as well as of the gene-specific genetic component of genetic and environmental variances .
fig.  <dig> trascriptome-wide association study in uk twins. comparison of the results obtained in the transcriptome-wide association when the relatedness between subjects was evaluated using the family structures and when it was inferred from genome-wide snps by means of ldak  <cit> . left panel effect size estimates for the association between gene expression levels and bmi. right panel estimated genetic  and environmental  variances




CONCLUSIONS
poppante is a user-friendly platform-independent java program that enables pairwise association testing of large numbers of predictor and response variables in related samples. poppante uses either known pedigree structures or gsms inferred from genome-wide genetic data, allowing the user to select the best approach according to the available data. when genome-wide genetic data are available, it may be advisable to use the gsm instead of the expected kinship matrix calculated using the genealogical information  <cit> . poppante can thus also facilitate the usage of biobank collections from population isolates when extensive genealogical information is missing.

availability and requirements

project name: poppanteproject home page: http://www.twinsuk.ac.uk/project/poppante/operating system: platform independentprogramming language: javaother requirements: java  <dig>  or higherlicense: gnu gpl  <dig> or higherany restrictions to use by non-academics: none

abbreviations
bmibody mass index

gsmgenetic similarity matrix

