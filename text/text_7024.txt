BACKGROUND
model reduction techniques are used to reduce the dimensionality of complex dynamics. applications of model reduction techniques in chemical engineering , in ecology  <cit>  or climatology, are well developed. a collection of reviews in model reduction for kinetic problems can be found in  <cit> . in systems biology, ad hoc reduction methods have been applied to signal transduction  <cit>  and to clocks  <cit> . combinatorial complexity of receptors and scaffolds can be reduced by exact lumping  <cit> .

we may distinguish among three classes of model reduction techniques. trajectory based techniques use the integration of the dynamical equations and look for a small number of reduced variables  <cit> . the empirical orthogonal eigenfunctions , also called proper orthogonal decomposition , or karhunen-loève expansion  method, consists in finding a low dimension linear  manifold, containing  the trajectories  <cit> . singular perturbations techniques eliminate fast variables whose dynamics is slaved by the slower variables. the computational singular perturbation  method provides approximations of a low dimensional invariant manifold, containing the dynamics  <cit> . invariant manifolds can be calculated by various other methods  <cit> . slow-fast or more general master-slave splittings  were discussed by  <cit> . chemical enzymatic kinetics beyond quasi-stationarity and quasi-equilibrium has been studied in  <cit> . averaging has been used to eliminate rapid oscillations of microscopic degrees of freedom and to obtain smaller models  <cit> . aggregation or lumping techniques have been proposed by many authors  <cit> . reaction graph contraction methods such as clarke's  <cit>  replace the reactions mechanism by simpler mechanisms in which some intermediate species are absent.

normally, identification of two well separated time scales is enough to reduce the system by using slow/fast decompositions  <cit> . however, the biochemical networks used to model cell physiology are multiscale, i.e. they have many, well separated time scales. for example, changing gene expression programs can take hours and even days while protein complex formation goes on the second scale and post-translational protein modifications take minutes to happen. protein life half-times can vary from minutes to days. this important observation applies not only to time scales but also to concentration values of various species in these networks. mrna copy numbers can change from some units to tens of thousands, and the dynamic concentration range of biological proteins can reach up to five orders of magnitude.

the aim of our paper is to propose model reduction methods well adapted to this situation. the mathematical techniques that we use  have a long history. however, their combination into practical recipes that we propose is original and well adapted for the study of multiscale biochemical networks. our most important development is the concept of dominant subsystem .

the idea of dominant subsystems in asymptotic analysis of dynamical systems is due to newton and developed by kruskal  <cit> . there are several ways to obtain dominant subsystems. these can be leading terms in power expansions of small parameters. thus, multiscale expansions are standard techniques in perturbation theory  <cit> . asymptotic theories using powers of small parameters were applied to study spectral properties of multiscale matrices  <cit> . in  <cit>  we have proposed a different approach to dominant subsystems. this approach exploits the reaction network structure to select dominant pathways and to obtain simplified reaction mechanisms. the simplifications are robust because are valid for a large range of parameters.

understanding the functioning of large networks of biochemical reactions could rely on having a hierarchy of such simplifications, ie a set of models that can be obtained one from another by model reduction. molecular networks are designed to fulfill many simple tasks. for each one of this tasks, the system scans only a small part of its high dimensional phase space. geometrically speaking, it evolves on a stable low dimensional invariant manifold with branching in the fast directions  <cit> . changing tasks, the system can jump from one stable branch of the manifold to another one. these represent jumps from one simplification  to another one. finding the set of simplifications of a molecular network means providing the set of functioning modes for the network.

thus, dominant subsystems provide an answer to a very practical question: how to describe the dynamics of a multiscale network? during almost all time this could be simplified and the system behaves as a small one. our methods show how to obtain the small dominant subsystem from the topology of the network and from the orders of magnitude of kinetic constants and species concentrations. in multiscale systems, concentration orders can change dynamically and the small system may change at discrete times. the whole system walks along small subsystems. the discrete dynamics of this walk supplements the dynamics of individual small subsystems.

dominant subsystem can be used to answer another important question: given a network model, which are its critical parameters? many of the parameters of the initial model are no longer present in the dominant subsystem: these parameters are non-critical. parameters of dominant subsystems indicate putative targets to change the behavior of the large network.

finally, dominant subsystems can be used to compare models. systems biology model repositories contain models of various degree of complexity. to be compared, or to be integrated into larger ones, models must be simplified to a common level of complexity.

our methods perform well when we have total or partial separation of time and/or concentration scales. total separation of time scales means the following: picking two timescales at random τi, τj one has either τi <<τj or τi >> τj with probability close to one. it is easy to construct a totally separated linear system. choose constants of biochemical reactions independently and distributed uniformly over a large interval in logarithmic scale: picking two timescales at random τi, τj one has either τi <<τj or τi >> τj with probability close to one. this situation has been studied in detail in  <cit> . though, it is difficult to have total separation in non-linear systems. for these, even if reactions constants are independent, timescales are not. our methods for robust simplifications of nonlinear systems functions also when scales are partially separated: in this case we gather terms of the same order in the quasi-stationarity and averaged steady state equations.

the models that we study here are deterministic. reduction methods for stochastic multiscale biochemical kinetics can be found in  <cit> .

the structure of this paper is the following. in the first section we present how to compute dominant subsystems for totally separated linear networks of monomolecular reactions. these appear as subsystems in analysis of multiscale networks of nonlinear biochemical reactions. this method uses the theory of limitation developed in  <cit> . in the second section, we show how to obtain dominant subsystems of non-linear systems. the technique is based on a method for identification of quasi-stationary and non-oscillating species and on dominant approximations of the quasi-stationarity and averaged steady-state equations for these species. in the third section, we introduce and analyze a new high dimensional model for the nf-κb signalling.

methods
reduction of linear hierarchical models
introductory notes
in this section we present a general algorithm for finding dominant subsystems and critical parameters for linear systems with completely separated time scales. linear systems represent a special situation when all the interactions in the reaction network are monomolecular, i.e., have the form a → b.

although systems biology models are nonlinear and contain also multimolecular reactions, it is nevertheless useful to have an efficient algorithm for solving linear problems. first, as we shall see in the next section, non-linear systems can include linear subsystems, containing reactions that are pseudo with respect to species internal to the subsystem . second, for reactions a + b → ..., if concentrations ca and cb are well separated, say ca >> cb, then we can consider this reaction as b → ... with rate constant proportional to ca which is practically constant, or changes only slowly. we can assume that this condition is satisfied for all but a small fraction of genuinely non-linear reactions . thus, linear models can serve as very effective approximations of behavior of non-linear models in certain windows of time: in this way, non-linear behavior can be approximated as a sequence of linear dynamics, followed one each other in a sequence of "phase transitions". third, linear networks represent the case when very large reaction networks models can be approached analytically, and some intuition and design principles can be learned and partially generalized to the non-linear case. as an example, see the robustness study made in  <cit> . the linear case offers nice simple illustrations of the concepts of dominant subsystem, critical monomials and critical parameters.

the algorithm presented here in its "recipe" form ready for computational implementations, is developed in detail elsewhere  <cit> , with many examples and rigorous justifications.

the structure of linear  reaction networks can be completely defined by a simple digraph, in which vertices correspond to chemical species ai, edges correspond to reactions ai → aj with kinetic constants kji >  <dig>  for each vertex, ai, a positive real variable ci  is defined.

"pseudo-species"  can be defined to collect all degraded products, and degradation reactions can be written as ai → ∅ with constants k0i. production reactions can be represented as ∅ → ai with rates ki <dig> 

the kinetic equation is

  dcidt=ki0+∑j≥1kijcj−ci, 

or in vector form: ċ = k <dig> + kc.

the advantage of linear dynamics is that it is completely specified by the eigenvectors and the eigenvalues of the kinetic matrix k.

the system has an unique bounded steady state cs = k- <dig> k <dig> if and only if the matrix k is non-singular.

in this case, it is easy to write down the general solution of eq.:

  c=cs+∑k=1nrk−cs)exp⁡ 

where λk, lk, rk, k =  <dig> ..., n are the eigenvalues, the left eigenvectors  and the right eigenvectors  of the matrix k, respectively, i.e.

  k rk = λk rk, lk k = λk lk. 

with the normalization  = δij, where δij is kronecker's delta.

closed systems are characterized by k <dig> =  <dig> . close systems are conservative if the matrix k is singular . then, the left kernel of k provides a set of conservation laws  are conserved). solution of the homogeneous linear equations are simply:

  c=∑k=1nrk)exp⁡ 

if all reaction constants kij would be known with precision then the eigenvalues and the eigenvectors of the kinetic matrix can be easily calculated by standard numerical techniques. furthermore, singular value decomposition can be used for model reduction. but in systems biology models often one has only approximate or relative values of the constants . in the further we will consider the simplest case: when all kinetic constants are very different , i.e. for any two different pairs of indices i = , j =  we have either ki >> kj or kj >> ki. in this case we say that the system is hierarchical with timescales  totally separated.

hierarchical linear network can be represented as a digraph and a set of orders  associated to each arc . the lower the order, the more rapid is the reaction . it happens that in this case the special structure of the matrix k  allows us to exploit the strong relation between the dynamics  and the topological properties of the digraph. big advantage of the fully separated network is that the possible values of lik are  <dig>   <dig> and the possible values of rik are - <dig>   <dig>   <dig> with high precision  <cit> . thus, if we can provide an algorithm for finding non-zero components of lik, rik, based on the network topology and the constants ordering, then this will give us a good approximation to the problem solution .

some basic notions
two vertices of a graph are called adjacent if they share a common edge. a path is a sequence of adjacent vertices. a graph is connected if any two of its vertices are linked by a path. a maximal connected subgraph of graph g is called a connected component of g. every graph can be decomposed into connected components.

a directed path is a sequence of adjacent edges where each step goes in direction of an edge. a vertex a is reachable from a vertex b, if there exists an oriented path from b to a.

a nonempty set v of graph vertexes forms a sink, if there are no oriented edges from ai ∈ v to any aj ∉ v. for example, in the reaction graph a <dig> ← a <dig> → a <dig> the one-vertex sets {a1} and {a3} are sinks. a sink is minimal if it does not contain a strictly smaller sink. in the previous example, {a1}, {a3} are minimal sinks. minimal sinks are also called ergodic components.

a digraph is strongly connected, if every vertex a is reachable from any other vertex b. ergodic components are maximal strongly connected subgraphs of the graph, but the reverse is not true: there may exist maximal strongly connected subgraphs that have outgoing edges and, therefore, are not sinks. if the digraph has no branching , then we can define a deterministic flow  on the set of its vertices. every vertex is the origin of an unique directed path.

basic procedure for approximating eigenvectors
the algorithm we provide is based on the solution of two simplest cases: 1) network without cycles and without branching   and 2) network without branching with a unique sink which is a cycle .

for the networks without branching, we can simplify the notation for the kinetic constants, by introducing κi = kij. also it is useful to introduce a map ϕ :

  ϕ={j,if there exists ai→aji,else 

acyclic non-branching network
in this case, for any vertex ai there exists an eigenvector. if ai is a sink vertex  = i) then this eigenvalue is zero. if ai is not a sink  ≠ i and reaction ai → aϕ has nonzero rate constant κi) then this eigenvector corresponds to eigenvalue -κi. for left and right eigenvectors of k that correspond to ai we use notations li  and ri , correspondingly.

let us suppose that af is a sink vertex of the network. its associated right and left eigenvectors corresponding to the zero eigenvalue are given by:

  rjf=δjfljf={ <dig> if ϕq=j for some q> <dig> else 

generally, right eigenvectors can be constructed by recurrence starting from the vertex ai and moving in the direction of the flow. the construction is in opposite direction for left eigenvectors.

for right eigenvector ri only coordinates rϕki  can have nonzero values, and

  rϕk+1i=κϕkκϕk+1−κirϕki=∏j=0kκϕjκϕj+1−κi=κiκϕk+1−κi∏j=1kκϕjκϕj−κi. 

for left eigenvector li coordinate lji can have nonzero value only if there exists such q ≥  <dig> that ϕq  = i , and

  lji=κjκj−κilϕi=∏k=0q−1κϕkκϕk−κi. 

these formulas  are true for all non-branching acyclic linear systems, even without separation of times. in the case of fully separated systems, they are significantly simplified and do not require knowledge of the exact values of κi. thus, for the left eigenvectors lii =  <dig> and, for i ≠ j,

  lji={ <dig> if ϕq=i for some q>0 and κϕd>κi for all d= <dig> ...q− <dig> else 

for the right eigenvectors we suppose that κf =  <dig> for a sink vertex af. then rii =  <dig> and

  rϕki={− <dig> if κϕk<κi and κϕm>κi for all m= <dig> ...k− <dig> else 

vector ri has at most two non-zero coordinates. the formula  means that to find the - <dig> component in ri, one should find the first vertex j downstream of i with κj <κi : there rji = - <dig>  following  we find that for the example at fig. 1a

  l1≈, l2≈,l3≈, l4≈,l5≈, l6≈.l7≈ 

  l1≈, l2≈,l3≈, l4≈,l5≈, l6≈.l7≈ 

non-branching network with a unique simple cyclic sink
in this case we have a reaction network with components a <dig>  ... an and last τ vertices  form a reaction cycle: an-τ+ <dig> → an-τ+ <dig> → ... an → an-τ+ <dig>  we assume that the limiting step in this cycle  is an → an-τ+ <dig> 

in this case the right eigenvector corresponding to the zero eigenvalue has non-zero components only on the vertices belonging to the cycle:

  lji={ <dig> if ϕq=i for some q>0 and κϕd>κi for all d= <dig> ...q− <dig> else 

similarly, the stationary distribution has non-zero value only at vertices belonging to the cycle. if b = ∑i ci is the total  mass, then the steady state is:

  cj=b/κj1κn−τ+1+1κn−τ+2+…1κn 

for j ∈  and zero elsewhere.

if we have a system with well separated constants  then this expression in the first order is simplified to

  cn=b,ci=bκnκi, 

which means that most of substance is concentrated just before the "bottleneck" an → an-τ+ <dig> .

to approximate the dynamics of the reaction network for κn ≪ κi, i ≠ n, it is sufficient to remove the slowest step of the cycle an → an-τ+ <dig>  after removing, we will have acyclic non-branching system of reactions with eigenvalues and eigenvectors that can be computed from the formulas in the previous section. these formulas give n -  <dig> eigenvector sets corresponding to n -  <dig> non-zero eigenvalues λi = -κi, i =  <dig> .n -  <dig>  for example, removing a <dig> → a <dig> step at fig. 1b converts the reaction network to the fig.  <dig> a whose dynamics approximates the dynamics of the simple cyclic network.

auxiliary reaction network and auxiliary dynamical system
now let us consider an arbitrary linear reaction network with well-separated constants. for each ai, let us define κi as the maximal kinetic constant for reactions ai → aj: κi = maxj{kji}. for correspondent j we use notation ϕ: ϕ = arg maxj{kji}. the function ϕ is defined under condition that for ai outgoing reactions ai → aj exist. if there exist no such outgoing reactions then let us define ϕ = i.

an auxiliary reaction network is the set of reactions ai → aϕ with kinetic constants κi. the correspondent kinetic equation is

  c˙i=−κici+∑ϕ=iκjcj, 

the auxiliary network also defines a auxiliary discrete dynamical system i → Φ  that is used to compute the eigenvectors of the kinetic matrix. the auxiliary network can have several connected components. in each connected component the minimal sink is an attractor of the auxiliary dynamical system, hence it is either a node, or a cycle.

general algorithm for calculating the dominant behavior of the linear dynamics
preprocessing reaction network
1) let us consider a reaction network w with a given structure and fixed ordering of constants that are well separated. using this ordering let us construct the auxiliary reaction network v=vw.

2) if the auxiliary network does not contain cycles then the auxiliary network kinetics  approximates relaxation of the initial network w. to obtain the solution, we use directly formulas  to calculate the eigenvectors  or  to obtain the 0– <dig> asymptotics .

3) in general case, let the system v have several cycles c <dig>  c <dig>  ... with periods τ <dig>  τ <dig>  ... >  <dig> 

by "gluing" cycles into points, we transform the reaction network w into w <dig> as follows. for each cycle ci, we introduce a new vertex ai. the new set of vertices is a1=a∪{a <dig> a <dig> ...}\ .

let us consider all the reactions from w of the form a → b . they can be separated into  <dig> groups:

 <dig>  both a, b ∉ ∪i ci;

 <dig>  a ∉ ∪i ci, but b ∈ ci;

 <dig>  a ∈ ci, but b ∉ ∪i ci;

 <dig>  a ∈ ci, b ∈ cj, i ≠ j;

 <dig>  a, b ∈ ci.

 <dig>  reactions from the first group  do not change.

 <dig>  reactions from the second group  transform into a → ai  with the same constant.

 <dig>  reactions of the third type  change into ai → b with the rate constant renormalization: let the cycle ci be the following sequence of reactions a <dig> → a <dig> → ... aτi → a <dig>  and the reaction rate constant for ai → ai+ <dig> is ki . for the limiting reaction of the cycle ci we use notation klim i. if a = aj and k is the rate reaction for a → b, then the new reaction ai → b has the rate constant kklim i/kj. this corresponds to a quasistationary distribution on the cycle . it is obvious that the new rate constant is smaller than the initial one: kklim i/kj <k, because klim i <kj due to definition of limiting constant. if after gluing, several reactions ai → b appear, then only the one with the maximal constant should be kept.

 <dig>  the same constant renormalization is necessary for reactions of the fourth type . these reactions transform into ai → aj.

 <dig>  reactions of the fifth type  are discarded.

4) after the new network w <dig> is constructed, we assign w:=w <dig>  a:=a <dig> and iterate the algorithm from the step 1) until we obtain an acyclic network and exit at step 2).

the algorithm produces an hierarchy of cycles. notice that the algorithm is based on an asymmetry between entering reactions and outgoing reactions from cycles in the hierarchy. indeed, some fluxes of w entering cycles ci can be neglected when they are dominated by a stronger flux of v bifurcating from the same node . the cycles ci are minimal sinks in v . there are no reactions a → b in v such that a ∈ ci, b ∉ ci. nevertheless, there may be such reactions in the initial network w. these fluxes can not be neglected because there are no exiting fluxes of v to dominate them. the rule of thumb is: neglect any dominated flux except for the fluxes exiting some cycle in the hierarchy. this explains our algorithm and was rigorously justified in  <cit> .

constructing the dominant kinetic system
now we show how to find an approximation of the dynamics of the reaction network w. to construct this approximation, we produce a new acyclic reaction network with the initial set of vertices ai ∈ w, i =  <dig> .n which is called dominant kinetic system. dynamics of this acyclic system can be computed from . to construct the dominant kinetic system, the following algorithm is applied:

let vm be the result of the network preprocessing algorithm described in the previous section.

 <dig>  for vm let us select the vertices a1m, a2m, ... that are glued cycles from vm− <dig> 

 <dig>  for each glued cycle node aim:

a) recall its nodes ai1m−1→ai2m−1→…aiτim−1→ai1m−1; they form a cycle of length τi,

b) let us assume that the limiting step in aim is aiτim−1→ai1m− <dig> 

c) remove aim from vm,

d) add τi vertices ai1m− <dig> ai2m− <dig> …aiτim− <dig> to vm,

e) add to vm reactions ai1m−1→ai2m−1→…aiτim− <dig>  with correspondent constants from vm− <dig> 

f) if there exists an outgoing reaction aim → b in vm then we substitute it by the reaction aiτim− <dig> → b with the same constant, i.e. outgoing reactions aim → ... are reattached to the heads of the limiting steps,

g) if there exists an incoming reaction in the form b → aim, find its prototype in vm− <dig> restore it in vm.

 <dig>  if in the initial vm there existed a "between-cycles" reaction aim→ajm then we find the prototype in vm− <dig>  a → b, and substitute the reaction by aiτim− <dig> → b with the same constant, as for aim→ajm .

 <dig>  let m ← m -  <dig>  and repeat steps 1– <dig> until no glued cycles left.

one has to notice that in the process of network preprocessing some reaction rates are substituted by monomials of the initial reaction constants, i.e. expressions in the form knew=ki <dig> i <dig> ..kj <dig> j2kl <dig> l <dig> ..km <dig> m <dig>  in totally separated case the values of these monomials are also well separated from the other constants with probability close to  <dig>  however, the initial order of constants does not prescribe position of these monomials in the rates order. in this case the algorithm produces several dominant systems defined for all possible position of new monomial rate constants in the order. an example of this will be given later in this section. such a situation can happen during the network preprocessing when maximum reaction constant should be chosen, or in the process of dominant system creation, when determining the limiting step in a cycle.

finding stationary distributions
the dominant kinetic system fully describes the relaxation modes of the network. the construction of this system depends only on the matrix k and does not depend on the production reactions k <dig>  in particular, relaxation times do not depend on the system being closed or not. however, the stationary distribution cs and the sequence of relaxation events depends on production reactions ).

for closed systems, steady states are solutions of the linear homogeneous equation kc =  <dig>  therefore they are determined up to multiplication by positive constants. they form a k-dimensional cone where k is the multiplicity of the zero eigenvalue of the matrix k, also the number of minimal sinks of the network.

let af1m,af2m,...,afkm be k sink vertices of the auxiliary network vm. let ai, i =  <dig> .n be vertices in the initial network w. below we describe a procedure for finding the basis of all stationary distributions of a closed network:

 <dig>  let us take the ith sink vertex afim.

 <dig>  define x = afim, b =  <dig>  and a null vector bi ∈ rn.

 <dig>  if x is not a glued cycle then it corresponds to a vertex aj ∈ w, and the basis vector bi has components bji = δij; stop.

 <dig>  if x is a glued cycle then recall all its vertices x <dig>  ..., xτ.

 <dig>  determine the limiting  rate constant κlim = mins= <dig> .τ {κxs} and smin = arg mins= <dig> .τ {κxs}.

 <dig>  for each vertex xj of the cycle repeat:

a) let cj=bκlimκxj if j ≠ smin and cj=b{1−∑s≠sminκlimκxs} otherwise,

b) if xj corresponds to a simple vertex ak then bki = cj,

c) if xj corresponds to a glued cycle then do recursively steps 4– <dig> with x = xj and b = cj.

any possible stationary distribution has form cs=∑i= <dig> .kcfimbi,cfim≥ <dig>  cfim. the coefficients c˜s=∑i= <dig> .kcfimb˜i are computed from initial data: they are equal to the total initial mass carried by vertices of vm  that are attracted by afim.

in brief, the distribution of the concentrations on any cycle is approximated by the first order expression , and this procedure is applied recursively for the vertices that represent glued cycles. the state thus obtained is equally a good approximation of the steady state of the dominant kinetic system.

open systems can be reduced to closed ones by considering that all production reactions originate from the node ∅ that has concentration c <dig> =  <dig>  the corresponding reaction are ∅ → ai and the constants are the production rates ki <dig>  the normalization c <dig> =  <dig> is possible for all bounded steady states, because these are determined up to multiplication by a constant. furthermore, all steady states are bounded, provided that the following topological condition holds: if there exists an oriented path from ∅ to ai, then there exists an oriented path from ai to ∅. we suppose this condition to be always fulfilled. applying the algorithm to the closed system we obtain c˜s=c˜s/ that is normalized to c˜s=c˜s/ in order to have c0s =  <dig> 

example. let us consider an example of the network w shown on fig.  <dig> . below we briefly detail every step of the algorithm.

2) an auxiliary reaction network vw is constructed ;

3) the cycle a <dig> → a <dig> → a <dig> → a <dig> in the auxiliary reaction network is glued in one vertex a <dig> ; in the initial network we find an "exiting from cycle" reaction a <dig> → a <dig>  renormalize its rate to k321=k24k35k <dig> and insert in the new network w1;

4) the cycle a <dig> → a <dig> → a <dig> in the auxiliary reaction network vw <dig>  is glued in one vertex a22; now the network w <dig> is acyclic and we stop the network preprocessing.

now if we restore the cycle a <dig> → a <dig> → a <dig> and try to determine the limiting step in it, we have two possibilies: k24k35k <dig> <k <dig> and k24k35k <dig> > k <dig>  let us consider them separately:

case k24k35k <dig> <k32

 <dig> .1) since a <dig> <k <dig>  then we remove the limiting step a <dig> → a <dig> and obtain  <dig> .2).

 <dig> .3) we restore the glued cycle corresponding to a <dig> and we recall that the reaction a <dig> → a <dig> in w <dig> corresponds to a <dig> → a <dig> in w.

 <dig> .4) we remove the limiting step reaction in the cycle a <dig> → a <dig> → a <dig> → a <dig>  and as a result we obtain acyclic dominant kinetic system shown at fig.  <dig> .

case k24k35k <dig> > k32

 <dig> .1) since k24k35k <dig> > k <dig>  then we remove the limiting step a <dig> → a <dig> and obtain  <dig> .2).

 <dig> .3) we restore the glued cycle corresponding to a <dig> this time we should re-attach the reaction a <dig> → a <dig> to the head of the limiting step in the cycle ; the rate of a <dig> → a <dig> is k24k35k <dig> 

 <dig> .4) we remove the limiting step reaction in the cycle a <dig> → a <dig> → a <dig> → a <dig>  and as a result we obtain acyclic dominant kinetic system shown at fig.  <dig> .

discussion and perspectives
dominant approximations of hierarchical linear reaction network allow us to introduce some new concepts important for the dynamics of multiscale systems.

hybrid and qualitative dynamics
piecewise affine dynamics has been widely used to approximate dynamics of gene regulatory networks  <cit>  as a sequence of discrete transitions between attractors of affine systems. this picture is based on threshold response of genes in models with steep regulation functions  and is not directly related to time scales. here, we emphasize another possible way to obtain hybrid, or qualitative representations of dynamics, based on time separation.

indeed, zero-one approximation of eigenvectors in hierarchical linear systems justifies a discrete coding of dynamics. suppose that initial state is concentrated in j <dig>  ci  ~ δi,j <dig>  at times just larger than 1/λk an exponential vanishes in eq.  and the state has a "jump" -rk  -cs). let us consider that eigenvalues are ordered λ <dig> >> λ <dig> >> ... >> λn- <dig>  then, the sequence of right eigenvectors rk such that  -cs) ≠  <dig> codes the dynamics starting in c. in other words, there is a sequence of well separated times τ <dig> = 1/λ <dig> <<λ <dig> = 1/λ <dig> << ... <<τn- <dig> = 1/λn- <dig> such that something happens  between each one of these times. left eigenvectors provides the lumping  and right eigenvectors provide the sequence of state transitions. on timescales τk <t <τk+ <dig> one can observe a jump -rk in state space provided that  - cs) ≠  <dig>  on this timescale the dynamics is equivalent to the degradation of pseudospecies , ddt = -λk .

critical parameters and design principles
our approach to dominant subsystems emphasizes some simple but important principles. first of all, dynamics of a hierarchical linear network can be specified if a) the topology of the network is given and if b) to each reaction we associate a positive integer representing order ; c) for cyclic topologies, some monomials grouping constants of several reactions have also to be ordered in the same manner .

in the process of simplification some reaction pathways are dominated and do not appear in the dominant subsystem. therefore, the corresponding constants are not critical for the system: although their ordering matters for establishing the simplification, their precise value have little importance. because parameters of the dominant subsystem are generally monomials of parameters of the whole system, critical parameters are those parameters that occur in critical monomials. our findings show rather counter-intuitive properties of critical and non-critical parameters, that can be useful as design principles. thus, in cycles, the limiting step  has little influence on dynamics . dynamically, a cycle with separated constants behaves like the chain obtained from the cycle by eliminating the limiting step. in particular, the slowest relaxation time of a cycle is the inverse of its second slowest constant  <cit> .

we should add some words about the relation between linear and non-linear models. mathematical models of biochemical reaction networks in molecular biology contain with necessity non-linear, non-monomolecular reactions . however, the developed algorithms of model reduction for linear networks can be useful in systems biology, in several situations:

1) when some submechanisms of a complex and non-linear network are linear, given fixed  values of external inputs ;

2) for approximating non-linear dynamics. for multiscale nonlinear reaction networks the expected dynamical behaviour is to be approximated by the system of dominant networks. these networks may change in time but remain small enough. to give an example, we provided the fig. 3s1–3s <dig> in additional file  <dig> demonstrating that in a model of complex reaction network of nf-κb pathway, containing  <dig> multimolecular reactions, only two reactions show genuinely non-linear behavior in some windows of time, with two more showing border-line behavior, and all others have well-separated reactant concentrations in any moment of time. the rigorous justification of these hybrid approximations for mass action reaction networks will be discussed elsewhere.

reduction of non-linear multiscale systems
complex formation is a source of nonlinearity in biochemical networks. for instance, in signalling, ligand molecules form complexes with receptors. transcription factors are often dimers or multimers or are sequestered by forming complexes with their inhibitors. in these examples, the reaction rates are non-linear functions of the concentrations of two or more molecules.

to construct a nonlinear reaction network we need the list of components, a = {a <dig>  ..., an} and the list of reactions :

  ∑iαjiai→∑kβjkak, 

where j ∈  is the reaction number. unless reactants and products belong to compartments of different volumes αji, βjk are nonnegative integers . reactions involving components from different compartments have non-integer stoichiometry. for instance, a reaction translocating a molecule from nucleus to the cytosol has stoichiometry  where kv is the volume ratio of cytosol to nucleus.

dynamics of nonlinear networks is described by a system of differential equations:

  dcdt=f=∑j=1rνjrj=sr=∑j=1rνj−rj−) 

νj = βj - αj is the global stoichiometric vector. s is the stoichiometric matrix whose columns are the vectors νj. the reaction rates rj+/−  are non-linear functions of the concentrations. for instance the mass action law reads rj+=kj+∏iciαji,rj−=kj−∏iciβji.

there are no simple rules to relate timescales to reaction constants of nonlinear models. the units of the inverse constants of bimolecular reactions are concentration multiplied by time and one needs at least one concentration value in order to construct a timescale. generally, timescales are functions of many reaction constants and concentration variables. these functions are not necessarily smooth. near bifurcations , at least one timescale of the system diverges for finite changes of the reaction constants. however, nonlinear biochemical networks have wide distributions of time-scales, as can be shown by simple  analysis of models.

various reduction methods of nonlinear models are based on projection of the dynamics on a lower dimensional invariant manifold  <cit> . the reduced models are systems of differential equations, but no longer networks of chemical reactions. quasi-equilibrium and quasi-stationarity methods keep the network structure of the model and propose lumped reaction mechanisms as dominant subsystems. this approach has some advantages. indeed, it leads to more transparent analysis of the results and of design principles, produces hierarchies of models and facilitates model comparison. graphical reduction methods using elementary modes, were proposed by clarke  <cit>  for chemical systems and more recently in systems biology by klamt  <cit> . similar methods can be found in  <cit> , from which we have borrowed the terminology. the choice of the species to be eliminated and of the reactions to be aggregated, as well as the calculation of rates of elementary modes have no theoretical justification in these methods and their inappropriate use can alter dynamics . thus, in order to have a complete practical recipe that applies to multiscale biochemical networks we need to solve three more problems: detection of rapid species, resolution of quasi-stationarity equations and calculation of reaction rates of the dominant mechanisms.

a major improvement in calculating dominant subsystems can be obtained by combining quasi-stationarity and averaging. averaging techniques are widely used in physics and chemistry to simplify models by eliminating fast, oscillating  variables  <cit> . our use of averaging is different, because we employ it to obtain averaged stationarity equations for slow, non-oscillating variables and to eliminate these species. after choosing a "middle" time scale , we want to reduce all scales that are faster but also all scales that are slower than this middle scale. in order to do that we provide a unified framework for species elimination and reaction aggregation, either by quasi-stationarity  or by averaged stationarity .

let i be the set of indices of intermediate components, that will be eliminated. r is the set of reactions that either produce or consume species from i. rates of r depend on the concentrations of intermediate species and also on the concentrations of other species, which in the terminology of temkin  <cit>  are called terminal. let t be the set of indices of terminal species. terminal species represent the frontier between the rest of the system and the subsystems made of intermediate species. although instead of terminal the name boundary species could be more appropriate, the latter term has already been employed in systems biology with a different meaning, which is species whose concentrations are fixed in a simulation.

extracting from the matrix s the columns corresponding to the reactions ri and the lines corresponding to the species i and t we obtain the intermediate stoichiometric matrix si and the terminal stoichiometric matrix st, respectively.

eliminating fast species: quasi-stationarity
in multiscale biochemical systems, some components react much more rapidly to changes in the environment than others. the reasons for the existence of such fast species can be multiple. thus, rapidly transformed or rapidly consumed molecules , or promoter sites submitted to rapid binding/unbinding processes are examples of fast species. fast species are good candidates for intermediate species. indeed, it is easy to prove that they can be eliminated by quasistationarity. when production rates are not weak, fast species are those whose concentrations are small and well separated from the concentrations of other species. though straightforward, the precise condition connecting quasi-stationarity and smallness of concentrations can not be easily found in literature, hence we briefly discuss it below.

let ϵ be a small parameter, representing concentrations. suppose for simplicity that reactions r are pseudo-monomolecular. this means that si ri  = ki  ci + ki <dig>  where ri is the restriction of the vector r to the intermediate species. an important assumption is ki <dig> = o meaning that the production of intermediate species is not weak.

suppose that among the reactions r consuming intermediates, at least some have rates of order o. this is current, because these reactions produce terminal species which have larger concentrations.

because ci = o, it means that ki  = o. this leads to the following asymptotic:

  ϵdc˜idt=k˜ic˜i+ki <dig> 

  dcicdt=g 

where c˜i = ci/ϵ, k˜i = ϵki = o, ic is the complement of i designating species other that i. intermediate species are fast and the system  can be reduced using tikhonov's  <cit>  and fenichel's  <cit>  results. according to these results, after a short laps of time, the system evolves on an invariant manifold  which is at distance o from the quasi-steady state  manifold defined by the quasi-stationarity equations:

  k˜ic˜i+ki0= <dig> 

quasi-stationarity equations can be used to express concentrations of the intermediate species as functions of the concentrations of terminal species. if matrix ki has not full rank, conservation laws should be added to the quasi-stationarity equations in order to obtain a full rank system. let μ <dig>  ..., μk be a basis of the left kernel of si . we say that species of indices i are quasi-stationary if they approximately fulfill the equations:

  si ri  =  <dig> 

and exactly fulfill the conservation laws:

  μi ii = ci,   i =  <dig> ..., k, 

where ci are real constants.

fast, quasi-stationary species are generally difficult to detect. for instance, the strong production condition ki <dig> = o, although informative for understanding of the dynamics, can not be used in practice. furthermore, small concentration is not a necessary condition for quasi-stationarity. therefore, our practical method for detection of fast, quasi-stationary species is based on the direct checking of eqs.,  .

once quasi-stationary species are detected, the recipe proposed by clarke  <cit>  can be applied to simplify the reaction mechanism. let us reformulate this recipe here:

 <dig>  eliminate the intermediate concentrations by solving the equations , . express ci as function of ct.

 <dig>  replace the mechanism r by "simple sub-mechanisms".

 <dig>  compute the rates of the simple sub-mechanisms as functions of ct.

the simplicity criterion employed by clarke does not follow from a physical principle. nevertheless, in systems biology, biochemical reactions are simplified representations of complex physico-chemical processes. in the absence of detailed information, simplicity arguments are often employed. elementary modes analysis widely used in metabolic control and gene network analysis  <cit>  is based on exactly the same argument.

the same recipe applies also to model comparison, when we want to compare two models which differ in complexity . in this situation we declare the extra species intermediate and apply the three steps of the algorithm.

simple sub-mechanisms and rates
let us introduce some more definitions. a reaction route is a combination of reactions in ri transforming terminal species into other terminal species and conserving the intermediate species. it is defined by a integer coefficient vector γ ∈ ℤs  satisfying the following three conditions:

  si γ =  <dig> 

  γi ≥  <dig>    if the reaction   i   is irreversible 

  ||st γ|| >  <dig> 

reaction routes are usually defined  <cit>  without the condition . by imposing this condition, we exclude internal cycles with zero terminal stoichiometry.

a sub-mechanism m is the set of all the reactions in the reaction route γ, m = {i|γi ≠ 0}. a sub-mechanism is simple if it is minimal with respect to inclusion, i.e. if m  ⊂ m  ⇒ γ = γ'. simple sub-mechanisms are pathways with a minimal number of reactions, connecting terminal species without producing accumulation or depletion of the intermediate species. thus, they are candidates for reduced reaction mechanisms. simple sub-mechanisms are minimal dependent sets in oriented matroids  <cit> , similar to elementary modes in flux balance analysis  <cit> . algorithms for finding elementary modes can be applied for the search of simple sub-mechanisms  <cit> .

in the reduced model, the reactions of the intermediate mechanism ri are replaced by the sub-mechanisms γ <dig>  ..., γs.

each terminal species is produced or consumed by one or several reactions of the intermediate mechanism. the reduction should preserve the flux of each terminal species, meaning that the following equation should be satisfied identically, for all ct and ci satisfying ,:

  ∑m∈riνmjrm=∑i=1sjr′i,j∈t 

where r′i are the rates of the simple sub-mechanisms.

suppose that for any simple sub-mechanism i there is a terminal species j such that st γi is the unique vector  having nonzero coordinate j, j ≠  <dig>  then, there is a straightforward solution for :

  r′i=1j∑m∈riνmirm 

the above uniqueness condition is not fulfilled if there are two sub-mechanisms for which the terminal stoichiometries are proportional. this situation can be avoided by quotienting with respect to the following equivalence relation: γi and γj are equivalent iff st γi = α st γj, for some α = ≠  <dig>  after discarding some sub-mechanisms and keeping only one representative per class, we have a reduced set of simple sub-mechanisms for which rates can be calculated from .

dominant solutions to the quasi-stationarity equations, multiscale ensembles
the most difficult part of the above algorithm is to solve the quasi-stationarity equations ,. even in the monomolecular case, symbolic solutions of the linear system  can involve long expressions. furthermore, mass action law leads to polynomial equations in the binary or multi-molecular case. symbolic methods for solutions of systems of polynomial equations are limited to a small number of variables.

in this subsection we show how the multi-scale nature of the system can be used to obtain approximate, dominant solutions of the quasi-stationarity equations.

in linear hierarchical models, ensembles with well separated constants appear . we could represent them by a log-uniform distribution in a sufficiently big interval log k ∈ , but most of the properties of this probability distribution will not be used here. the only property that we will use is the following: if ki > kj, then ki/kj ≫  <dig> . it means that we can assume that ki/kj ≫ a for any preassigned positive value of a that does not depend on k values. one can interpret this property as an asymptotic one for α → -∞, β → ∞. this property allows us to simplify algebraic formulas. for example, ki + kjcan be substituted by max{ki, kj} , or

 aki+bkjcki+dkj≈{a/c,if ki≫kj;b/d,if ki≪kj, 

for nonzero a, b, c, d.

of course, some ambiguity can be introduced, for example, what is  - k <dig>  if k <dig> ≫ k2? if we first simplify the expression in brackets, it is zero, but if we open brackets without simplification, it is k <dig>  this is a standard difficulty in use of relative errors for round-off. if we estimate the error in the final answer, and then simplify, we shall avoid this difficulty. use of o and o symbols also helps to control the error qualitatively: if k <dig> ≫ k <dig>  then we can write  = k1), and k <dig> - k <dig> = k1o. the last expression is neither zero, nor absolutely small – it is just relatively small with respect to k <dig> 

it is slightly more difficult to solve equations. some recipes were proposed such as newton polyhedra for approximate solutions of polynomial systems of equations  <cit>  but this type of methods suffers from combinatorial complexity. here we use a simpler, but not so rigorous approach. in the case of pseudo-molecular subsystems, our algorithms for linear hierarchical systems are enough for this purpose. in general, we choose the dominant terms in the solutions as monomials of the parameters. this can be done either by educated guess, or by testing numerically the orders of various terms in the equations. the most frequent, truly non-linear simplification that occurs in biochemical models is the "min-funnel", which we present below.

let us consider the production of a complex c from two proteins a and b:∅→kaa , ∅→kbb , a→kdeg,a∅ , b→kdeg,b∅ , a+b⇌kcc .

supposing a, b quasi-stationary we have to find the positive solutions of the equations ka=a˜+k˜ca˜b˜, kb=b˜+k˜ca˜b˜, where a˜=kdeg,aa, b˜=kdeg,bb, k˜c=kc/. we will consider two cases a) 1/k˜c <<ka <<kb and b) 1/k˜c <<kb <<ka. both cases mean that degradation of a, b is weak and/or the propensity of complex formation is high. case a) means also that b is in excess, the opposite being true in case b).

let us consider the case a). we consider that the order of a˜ in the dominant solution is larger than the order of b˜, a˜<<b˜. from the linear equation ka - kb = a˜−b˜ we obtain b˜ = kb and from the second nonlinear equation we obtain a˜=ka1+k˜ckb≈kak˜ckb. finally, we have a˜<<b˜ consistently with the starting guess. the dominant solution in case b) is obtained by symmetry from the one in case a). the quantity of interest in this example, for which we want a reduced expression is the production rate of the complex rc = kcab. actually, the two solutions can be summarized by:

  rc = min 

using the exact solution of the system  we can show that the min-funnel approximation  is valid under less restrictive conditions. the only separation condition that we need is min >> kdeg, a kdeg,b/kc. we can easily identify the critical parameters ka, kb and the non-critical ones kdeg,a, kdeg,b, kc. the validity of the expression  depends on order relations involving monomials of critical and non-critical parameters.

eliminating slow species: averaging
averaging is an useful model reduction technique for high-dimensional clocks or for other types of oscillating molecular systems .

averaging can be applied rather generally  <cit>  to produce coarse grained quantities and reduced models. the typical mathematical result applying here is due to pontryagin and rodygin  <cit> . supposing that the oscillating species are x, the non-oscillating species are y, and ∈ is a small parameter, then we have:

  ϵdxdt=f 

  dydt=g 

it is supposed that for any y, the fast dynamics  has an attractive hyperbolic limit cycle x = ψ , of period t: ψ , y) = ψ . then, after a short transient, the slow variable satisfies the averaged equation:

  dydt=1t∫0tg,y)dτ 

the result can be extended to the case when x = ψ describes damped oscillations, with damping time much larger than ϵ, i.e. when the fast dynamics  has a stable focus and the eigenvalues of the jacobian ∂f/∂x calculated at the focus are of the form -λ ± iμ,  <dig> <λ <<μ = o.

the following averaged steady state equation allows to eliminate the slow species y:

  ∫0tg,y)dτ= <dig> 

if  has a stable steady state, we always reach this situation. in this case, the slow non-oscillating variables y are constant in time and can be considered to be conserved, which has two significant consequences.

first, eq. restores conservation. slow variables are often the result of broken conservation laws. in fact, in biological open systems, nothing is conserved. conservation laws result from balancing production and degradation either passively  or actively . thus, we can ignore production and degradation of molecules whose level is rigorously controlled. eq. describes such a case.

second,  are averaged steady state equations for the slow variables. if slow variables y reach stationarity, the only variables that change in time are the oscillating variables x. eq. describes the dynamics of x, considering that y satisfies . for oscillators, averaging provides a way to eliminate slow non-oscillating variables, which is formally equivalent to quasi-stationarity and represents a new case of applicability of clarke's method. the difference between the two cases is that we eliminate fast variables by solving quasi-stationarity equations and we eliminate slow variables by solving averaged stationarity equations. thus, intermediate non-oscillating variables are expressed in terms of only non-oscillating terminal variables. if there are no non-oscillating terminal variables, then non-oscillating intermediates become conserved quantities.

RESULTS
methodology
in this section, we demonstrate hierarchical model reduction, model comparison and critical parameter identification. critical parameters are identified during the reduction procedure.

model reduction starts with a complex model, from which we obtain a hierarchy of reduced models by eliminating various intermediate species. the intermediate species are either quasi-stationary species , or non-oscillating species . the complexity of a model is quantified by three integers. a model with n species, r reactions and p parameters is designated by m. our conception about systems biology models is summarized by the following idea. instead of providing a single model, it is better to provide a hierarchy of models, and the relations between them. depending on the application, we can choose the most appropriate model in the hierarchy or couple several simple models into a larger model.

the number of parameters in a model are obtained as follows. if the elementary reactions follow mass action law kinetics, there are nk = 2nr + ni kinetic constants, where nr, ni are the numbers of reversible and irreversible reactions. reactions with kinetic constants zero are not considered in the counting. each one of the nc conservation laws adds an extra parameter, the value of the conserved quantity. these values follow from initial data and are important parameters for the dynamics. for multi-compartment models, the ratios of the compartments volumes  are extra parameters. thus p = nk + nc +  <dig> 

model comparison has a similar flowchart. by model comparison we understand a) mapping one model to another one by model reduction or mapping each model to a third one, closest in some sense to both; b) compare predictions of the models  for sets of parameters related one to the other by the mapping at a). in this case, the choice of intermediate species is dictated by the differences between the models to be compared.

hierarchy of models for nf-κb signalling
the transcription factor nf-κb is involved in a wide diversity of domains such as the immune and inflammatory responses, cell survival and apoptosis, cellular stress and neuro-degenerative diseases, cancer and development. nf-κb is sequestered in the cytoplasm by inactivating proteins named iκb. upon signalling, iκb molecules are phosphorylated by a kinase complex, then ubiquitinylated, and finally degraded by the proteasomal complex. nf-κb bound to iκb molecules is then transported to the nucleus to activate its target genes. there are known five members of the nf-κb family in mammals, rel , rela , relb, nf-κb <dig>  and nf-κb <dig> . this generates a large combinatorial complexity of dimers, affinities and transcriptional capabilities. iκb family comprises seven members in mammals   <cit> . all these inhibitors display different affinities for nf-κb dimers, multiplying the combinatorial complexity. moreover, the gene coding for iκbα, is transcriptionally activated by nf-κb. this negative feed-back loop can give rise to oscillations of the activity of nf-κb  <cit> . phosphorylation of iκbα upon signalling is provided by a kinases complex that includes ikkα and ikkβ , associated to a regulating protein nemo . therefore, it is clear that understanding such a complex biological system requires modeling. several mathematical models of nf-κb have been published. the first model described a single nf-κb molecule, which binds to iκbα, iκbβ and iκbϵ. this work demonstrated oscillations in nf-κb activity, confirmed by experimental data  <cit> . the model set by  <cit>  included in addition an a <dig> molecule whose production is enhanced upon nf-κb stimulation, and which negatively regulates ikk activity. a third model analyzed the critical parameters necessary for maintaining oscillations, with given amplitude and frequency  <cit> . in addition, a minimal simplified model was also set to study the oscillations of the nf-κb module  <cit> . we propose here a fourth, new model, with more complex descriptions that takes into account transcription, translation and degradation of different nf-κb units.

in our model, nf-κb is considered to be made of two subunits, p <dig> and p <dig>  all combinations of these subunits are allowed, including two homodimers p50:p <dig>  p65:p <dig> and one heterodimer p50:p <dig>  the three dimers of nf-κb are characterized by different affinities for dna sites, and associate differentially to iκbα, β and ϵ, generating thus  <dig> species with different abundances and characteristics upon signalling and degradation. the production of the dimer p <dig> is considered under control of a transcription factor ftay, which represents a simplification of many transcription factors supposed to activate this promoter. p <dig> is produced from a precursor molecule p <dig>  the transcription factor ftax binds to the promoter of p <dig> to activate its transcription at a basal level. similarly to ftay, this factor represents the sum of individual activities due to several transcription factors contributing to the basal activity of this promoter. as the p <dig> gene is activated by nf-κb, this factor can also bind to the p <dig> promoter and activate the transcription above the basal level. promoter of iκb is controlled by nf-κb and ftaz in a similar way as it is p <dig>  in addition, it was supposed that nuclear iκb can come and bind to nf-κb when this is on the promoter of iκb or of p <dig>  once the complex formed this can unbind from the dna, taking nf-κb away. the kinase activation/inactivation module including interactions with a <dig> was borrowed from  <cit> . let us notice that transcription regulation modules are very simplified and do not take into account specificities of eukaryotic regulation .

initiation  <cit>  and elongation  <cit>  for transcription and translation rates come from previous studies which were more recently re-examined  <cit> . binding and unbinding constants for nf-κb subunits come either from literature  <cit>  or from previous models  <cit> .

we should signal large uncertainty concerning values of constants. for example, the rate of degradation of iκb was assumed to be independent of the state of the molecule, either free or bound to nf-κb. this led to a poor fit of computational simulations of the nf-κb signalling module. the rate was newly measured in vivo and led to better fits of iκb levels and basal nf-κb activity  <cit> . this motivated us to determine which parameters of the model are critical and should be known with precision and which ones are not critical.

a simplified version of the model  is given in table  <dig> 

detailed description of the complex model for nf-κb signalling. the names of the species are provided following the template similar to that proposed in b7676: entity1name|modifications ...: entity2name|modifications...@compartment. here, the colon symbol ':' delimitates components of a complex. optional suffix 'active' describes the active state of the protein. the localization information  is provided when a protein or complex exists in both nucleus  and cytoplasm . mass action law constants are either in s- <dig> or in μms- <dig> units. kv parameter  is set up to  <dig>  first reactions in the list  correspond to the lipniacky's model.

model reduction
as an illustration of the model reduction flowchart, we obtain from the model proposed by lipniacki  <cit>  a series of simpler models. this model is ℳ in our hierarchy: it contains only one reversible reaction and the total nf-κb quantity is conserved nc = nr =  <dig>  the description of the reactions can be found in table  <dig> .

the model was forced to function in a strongly oscillating regime. this situation is the most unfavorable for the simple version of clarke's method which is doomed to shorten delays and to destabilize oscillations when intermediates are not appropriately chosen. thus, it represents a good test for our method. first, we identify quasi-stationary and non-oscillating species. we define log-average concentration clog = log <c > and the log-amplitude alog = min - clog, clog - log min)  = 0). species whose log-amplitudes are low and well separated from other values are declared non-oscillating. in order to detect quasi-stationary species, for each species ai we compare two trajectories : a) the trajectory in the unreduced model b) the trajectory of ai calculated from the trajectories of the species influencing ai by using the quasi-stationarity equation  for i = {i}. the two trajectories must be close one to another for quasi-stationary species , see fig. 3a). hausdorff distance between the two trajectories can be used to detect quasi-stationary species for automatic computation. non-oscillating species could also satisfy this criterion, but after a larger transition region, because they are slow ).

these procedures allow to identify  <dig> quasi-stationary species  and one non-oscillating species . two species with small concentration  are not quasi-stationary, as their relaxation time can be compared to the period of the oscillations. the smallness of their concentration is not a consequence of rapid consumption, but of small production  rate. two species with large concentration are quasi-stationary .

the  <dig> intermediate species can be grouped into two connected subsets . the first module involves six cytosol located intermediates  and four terminal species . the intermediate reactions form the cytoplasmic part of the signalling mechanism. the kinase transformation reactions r1– <dig>  the complex release reaction r <dig>  the complex formation reaction r <dig> and the nf-κb translocation reaction r <dig> are replaced by two simple sub-mechanisms representing the modulated inhibitor degradation , and summarizing the nf-κb release and translocation , respectively. the corresponding dominant rates are:

  r′21≈k21p1x10x13/) 

  r′15≈k15p1x13/) 

where x <dig> = , x <dig> = , x <dig> = , k21p <dig> = k3k9/k <dig>  k21p <dig> = k15p <dig> = k15/k <dig>  k15p <dig> = /, k21p <dig> = k15p <dig> = k5/k <dig> 

after reduction of the first module we obtain the model ℳ.

the second module is situated in the nucleus and contains ikba@ncl and ikbnp50:p65@ncl. three intermediate reactions  are replaced by one simple submechanism describing the nuclear complex formation and translocation  whose dominant rate is:

  r′14=k14p1x10x7/ 

where x <dig> = , k14p <dig> = k <dig>  k14p2=kvk′23/k <dig> 

this reduction step leads to the model ℳ. the dynamics  of the two new models is practically the same as the dynamics of the non-reduced model. one should not expect a perfect match because the method is based on asymptotic order relations between parameters. in establishing the expression of dominant rates we have considered that one parameter is much bigger than another one if the absolute value of their ratio is larger than ten. of course, a more drastic criterion would produce more complex expressions, because less monomials could be simplified .

we have tested reduction of two more species that have small concentration but are not quasi-stationary. reducing the species mrnaa <dig> leads to the model ℳ intermediate reactions  are replaced by a single one , of parameter k20p = k16k20/k <dig>  this model has stable oscillations, but with slightly smaller period, and with different phase relations between oscillating species . both period and phase changes result from the reduced delay on the negative feed-back loop containing a <dig>  reducing the species mrnaikb has destabilizing effect on the oscillations. it is no longer possible to obtain self-sustained oscillations and damping times are generally smaller than for the non-reduced model. it is well known that delayed negative feed-back favors stable oscillations and that reducing the delay destabilizes oscillations. our findings suggest that the delay along the ikba negative feed-back loop is more important for the stability of the oscillations than the delay along the a <dig> loop.

model reduction allows to identify critical and non-critical parameters. parameters of reduced models are monomials of parameters of the non-reduced models ,,). some parameters of the non-reduced model may not occur in these monomials; these are non-critical parameters. among monomials, only some are critical. critical monomials are detected by sensitivity studies  <cit>  performed on the reduced model. critical parameters of the non-reduced model are contained in the critical monomials of the reduced model. the relation between critical parameters and critical monomials is hierarchical: monomials may be combined to form new monomials . the degrees of critical monomials provide qualitative information on the influence of various critical parameters on the properties of the system. for instance, if two parameters have degrees of opposite signs in a critical monomial, their effects will be opposite.

as an example, we detect critical monomials in the simplest reduced model ℳ, first with respect to damping time and then with respect to the period of the oscillations. deciding rigorously what large sensitivity means is not easy. in  <cit>  we proposed a criterion which applies to properties that are homogeneous of degree ± <dig> in the kinetic constants, in particular, to characteristic times. let τ be the studied quantity and k the parameter . we say that k is critical if sup⁡|log⁡|<a|dlog⁡τdlog⁡s|> <dig>  where a >  <dig> is some fixed constant and k <dig> some central value of the parameter. the sensitivity study is presented in fig.  <dig>  the relation between parameters of the initial and the reduced models is represented in fig.  <dig>  damping time of the oscillations is most sensitive to parameters k14p <dig>  k <dig>  k20p, k21p <dig>  k <dig>  k <dig>  c <dig>  by changing these parameters, the oscillations can be modified from damped to self-sustained. the above parameters are the critical monomials from which we get the critical parameters  of the unreduced model: k <dig>  k <dig>  k <dig>  k <dig>  k <dig>  k <dig>  k <dig>  k <dig>  k <dig>  k <dig>  c <dig>  the degrees of the critical monomials represent logarithmic sensitivities, therefore they provide both sign an strength of the influence of the critical parameters on the studied property. for instance, from k21p <dig> = k3k9- <dig> we can say that damping time can be increased  by reducing k <dig>  or by reducing k <dig>  or by increasing k4), see also fig.  <dig> 

critical parameters correspond to reactions affecting three targets: the kinase, a <dig>  and the inhibitor, see fig.  <dig>  four groups of critical monomials are easy to interpret. increase of the monomial k20p stands for increasing the nf-κb dependent a <dig> production . increasing k <dig>  k <dig> stands for increasing the nf-κb dependent iκb production. the latter effect has been exploited in  <cit>  to stabilize oscillations by transfecting hela cells with κiκb-egfp vector. decreasing k14p <dig> stands for decreasing the nuclear concentration of the inhibitor, by reducing its translocation rate to the nucleus. it is possible that the experiment in  <cit>  affected also this constant  by attaching egfp to the inhibitor. the critical monomial k21p <dig> is more difficult to interpret in terms of putative targets. it gathers recovery  and dynamical properties , as well as the a <dig> dependent inactivation  of the kinase ikk. finally, increasing c <dig> means increasing the total concentration of nf-κb .

the value of the period is remarkably robust. there are no critical monomials for the period.

although the strongest effect on the oscillations has already been tested experimentally by increasing the nf-κb dependent iκb production  <cit> , there are two remaining targets  that could be tested experimentally.

the sequence of reduction steps described above is illustrated on fig. 1s in additional file  <dig>  a series of simplified models provided in sbml  <dig>   <cit>  format and annotated by celldesigner  <dig>   <cit>  software are submitted to biomodels database  with the following ids: model <dig>  model <dig>  model <dig>  model <dig> 

model comparison
to illustrate model comparison, we compare a version of our complex model  to the model ℳ, proposed by lipniacki  <cit> . our model is ℳ. the model ℳ is a submodel of ℳ in the sense that all its species are included in our larger model. the description of our model has been sketched at the beginning of the section  <dig> . a complete description is given in table  <dig>  to perform model comparison we define the set of intermediates i as the difference of the sets of species of the two models. there are  <dig> intermediate species and a small frontier: only  <dig> terminal species.

in order to verify that intermediates can be eliminated with no consequence on the dynamics we have used the method described in the previous section.

the intermediate species can be divided into four functional modules: production of mrnap <dig>  production of mrnap <dig>  production of mrnaiκb, and min funnel production of the complex p50:p65@csl, see fig  <dig>  we found three categories of intermediates. there are  <dig> quasi-stationary species,  <dig> non-oscillating species and  <dig> buffered species . the elimination of these is entirely justified and has no consequence on the oscillations. there are  <dig> non-quasistationary, oscillating species. among these,  <dig> are low concentration species, representing the states of two promoters  free and singly occupied by transcription factors ftax, ftaz, respectively. however, we can safely eliminate them because transcription initiation starts dominantly when both p50:p65@csl and ftax  are on the promoter, therefore the non-quasistationary promoter states are not important. the last non-quasistationary, oscillating species is p <dig> who binds to p <dig>  to produce p50:p65@csl via the min funnel. concentrations of all quasi-stationary intermediates are small ), . the reduction that we propose is fully justified for a deterministic model, but one may ask if deterministic differential equations apply in this case. we have shown elsewhere  <cit>  that deterministic approximation can be applied in two different situations. the first, well known situation is when the numbers of molecules are large; the law of large numbers applies. the second, less known situation, is when some species are in small numbers, but when the reactions involving these species are frequent. an example is the quick binding-unbinding of a transcription factor on a promoter site. in this case, we can consider that various states of the promoter are at stochastic equilibrium . under some conditions , stochastic averaging  <cit>  of the remaining equations  with respect to the invariant distribution is equivalent to applying quasi-stationarity to the fast concentrations in the deterministic approach.

reduction can be decomposed into several steps. the first three steps correspond to simplifications of the mechanisms producing the proteins p <dig>  p <dig>  and the mrnaikba. thus, the reactions r41– <dig>  r32– <dig>  r63– <dig>  r48– <dig>  r55– <dig> are replaced by the simple submechanisms ∅ → p <dig>  ∅ → p <dig>  ∅ → mrnaikba, of rates r′ <dig> r′ <dig> r′ <dig>  respectively. the quasi-stationarity equations become linear after applying the strong binding, large concentration approximation for the transcription factors ftax-y-z. the corresponding linear mechanisms ri are represented in fig.  <dig>  the dominant solutions of the quasistationarity equations are obtained with techniques presented for linear subsystems. using also eq. we find the following simple submechanism rates:

  r′45≈k43k45k <dig>  

  r′39≈k39p1x11+k39p2x7x7x11+k39p3x11+k39p4x <dig> 

  r′26≈k26p1x11+k26p2x7x7x11+k26p3x11+k26p4x <dig> 

where x <dig> = , x <dig> = , k39p1=k39k38+k39k36k34k68p0105k37k <dig>  k39p2=k39k36k38+k39k′66k70p0105k37k <dig>  k39p3=k68k <dig>  k39p4=k′66k <dig>  k26p1=k50k60p0ikbak <dig>  k26p2=k′58k62p0ikbak <dig>  k26p3=k60k <dig>  k26p4=k′58k <dig>  p <dig>  p0ikba are the concentrations of promoter sites of p <dig>  ikba, respectively.

the fourth step is a min funnel simplification of the production of the complex p <dig> : p65@csl.

r′ <dig>  r <dig>  r′ <dig>  r <dig>  r <dig> are replaced by ∅ → p50:p65@csl, of rate:

  r′52≈min=r′ <dig> 

this leads to the model ℳ.

the fifth step, justified by averaging, introduces a new conservation law  has no conservation law). without the reactions r′ <dig>  r53– <dig>  r71– <dig>  that produce and consume p <dig> : p <dig>  the total amount of p <dig> : p <dig>  would be conserved. considering that the degradation reactions r53– <dig>  r71– <dig>  r <dig> have the same constant k, the total amount of nf-κb  represented by the variable

c =  + /kv +  + ... satisfies the equation :

  dcdt=−kc+r′ <dig> 

the dynamics  has two time scales, a slow timescale 1/k and a rapid timescale, the period of the oscillations . c is a slow, non-oscillating variable, it averages oscillations. thus, the asymptotic, total amount of nf-κb is:

  c0=<r′52>/k, 

where the average is over a period of the oscillations.

in the fifth reduction step, reactions r <dig>  r <dig>  r <dig>  r <dig>  r <dig> are eliminated. initial conditions of the system are chosen such that initial total nf-κb is c <dig> .

we obtain the model ℳ that has the same species and reactions as lipniacki's model ℳ, but slightly more parameters. the difference in the number of parameters comes from the more complex expressions of the mrna iκb transcription rate r′ <dig> given by . in our model this rate is modulated by the nuclear iκb concentration x <dig> . this phenomenon is not taken into account in  <cit>  where the corresponding rate is simply r <dig> = k26x <dig> 

one important objective of model comparison is to obtain the parameter mapping. this allows to calculate the parameters of one model if the parameters of the other model are known. then, dynamical properties of the models can be compared. in our example, all the parameters of ℳ should be equal to the corresponding parameters of ℳ except for c <dig> and k <dig> which are obtained by averaging  and k <dig> is calculated in order to have equal average production rates of mrnaiκb in the two models, see fig. 7b). dynamical comparison has been done in fig. 7c. the model ℳ is a reduction of ℳ, therefore the dynamics of these two models is very similar. the model ℳ preserves the main features of the dynamics, except for the behavior iκba. without signal, the quantity of inhibitor in ℳ is small . with signal, the amplitude of the oscillations is higher in ℳ. these differences follow from the different kinetic laws for the transcription of iκba. basically, in m and ℳ, iκba has some negative influence on its own production ).

our most complex model can account for phenomena that can not be studied by any of the conservative models ℳ, ℳ, namely it can take into account variations of the nf-κb total quantity. although this is not important in normal situations , it could become important if one wants to cope with strong perturbations of nf-κb activity.

thus, using a more complex model depends on the experimental situation . the role of mathematics and modeling in quantitative biology is to predict the behavior of a system. depending on which behavior, the simplest theory can change, and we want a hierarchy of models and model mapping methods. the process can go in both directions: reducing, or increasing the number of details.

model mapping also allows to identify non-critical and critical parameters. let us give only two examples. the constants or reactions  <dig>   are not critical and one does not need to know them with precision. actually, variations by a factor  <dig> in these constants do not change the dynamics.

the values that we use come from  <cit> , who cites two other references  <cit>  that seem to propose very different values. our analysis shows that this is not important. on the contrary, we show that the constant c <dig>  is a critical parameter. reference  <cit>  proposes  <dig> molecules in a volume  of  <dig> μm <dig>  this means c <dig> =  <dig>  μm. nevertheless, cell volume estimate is not really precise and errors can easily shift the model from a damped oscillatory to a sustained oscillatory dynamics. in this case, it is the comparison between model prediction and theoretical observation that can fix the value of the critical parameter.

the sequence of reduction steps described in this section is illustrated on fig. 2s1–2s <dig> in additional file  <dig>  a series of models of decreasing complexity starting from ℳ and upto ℳ provided in sbml  <dig>   <cit>  format and annotated by celldesigner  <dig>  software  <cit>  are submitted to biomodels database  with the following ids: model <dig>  model <dig>  model <dig>  model <dig>  model <dig>  model <dig> 

CONCLUSIONS
we have presented a methodology for reducing and comparing systems biology models. we show how to produce a hierarchy of coarse grained models that can be used for understanding functioning of the biological systems. we show how models in the hierarchy can be mapped one onto another, thus allowing to decrease or to increase the number of details that are needed for the description of the system. our method identifies the set of critical parameters of the system. this can be particularly useful for robustness studies  or for practical multi-target approaches in pharmacology.

we did not approach aspects of multi-scale modeling that occur in multi-organ physiology, or spatial aspects. relation with stochastic modelling has been only briefly discussed and will be presented in detail elsewhere . the reduction methods presented here can be applied to systems of biochemical reactions modeling cell physiology  <cit>  and can be usefully applied to various problems in signalling, metabolism, genetic regulation.

a central idea in our treatment is the hypothesis that biological systems are hierarchial, involving many separated time scales. the reduction methods were adapted to exploit this situation . the hierarchical nature of the systems is not sufficiently exploited by more traditional approaches. for instance, singular perturbation copes with two time scales and eliminates the fastest. in biology, we are often interested in a "middle" time-scale, corresponding to a particular process that we study. we have shown how to eliminate both faster and slower variables. another specificity of systems biology is the quest for critical parameters. our approach offers naturally a solution: critical parameters are detected in the reduction process. it also extends the theory of limiting step to complex networks  <cit> . showing how to find critical parameters and dominant simplifications is a first step towards a dynamical systems approach to physiology. indeed, complex networks fulfill various tasks in simple ways by activating a few degrees of freedom. dominant subsystems gather dynamical variables that are activated and can change when the system needs to perform a given task. changing task could be represented as zooming in and out , or jumping laterally  in the hierarchy of models. as pointed out by denis noble  <cit> , physiology should not be understood from the bottom upwards. our approach suggests that not only the subjective understanding, but also the objective functioning of biological systems can be based on middle-out  pictures.

as future work we will improve our algorithms in order to propose fully automated reduction tools. at present, the automated sections of our methods are the calculation of dominant subsystems of pseudo-monomolecular subsystems and the calculation of simple sub-mechanisms stoichiometries and rates. the detection of quasi-stationary and non-oscillating species is semi-automated. the solutions of quasi-stationarity and averaged stationarity equations are not yet fully automated .

we also plan to consider other applications such as high dimensional switches  <cit> .

concerning our model comparison methods, we would like to study hierarchies of kinetic models coming from various organisms, for which the conserved and the specific parts are the result of evolution.

authors' contributions
or proposed the methodology to reduce nonlinear models. ag developed the general theory of multiscale linear system, together with or and az. az and or designed and implemented the algorithms. al designed the nf-κb model. all authors drafted, read and approved the final manuscript.

supplementary material
additional file 1
hierarchy of nfκb models. this file shows the hierarchy of models using systems biology graphical notation  and the results of a study of the truly non-linear reactions.

click here for file

 acknowledgements
we acknowledge support from the french ministry of research program aci impbio, from the british council/french foreign affairs ministry cooperation program alliance , from the french complex systems institute isc and ec-fp- <dig> . az is member of the team "systems biology of cancer "équipe labellisée par la ligue nationale contre le cancer. we thank upinder bhalla, dennis bray and john reinitz for inspiring discussions. we also thank the students that contributed to some of the programs used in this work: karine yviquel, ifsic intern and debasis panda, inria intern from ibab.
