BACKGROUND
the long-branch attraction  artefact was first demonstrated to affect maximum parsimony   <cit> , and subsequently all main types of tree reconstruction methods  <cit> . in the typical 4-taxa lba case  <cit> , two unrelated taxa  evolved significantly faster than their sister-groups ; the inferred tree artefactually groups together the fast evolving taxa, because numerous convergent changes along the two long branches are interpreted as false synapomorphies . it should be noted that lba could be alternatively named short-branch attraction, since the close resemblance of the two slow evolving taxa, due to symplesiomorphies, lead to their artificial attraction. in case of the lba artefact, tree reconstruction methods are inconsistent, i.e. they converge towards an incorrect solution as more data are considered. numerous computer simulations have shown that mp is the most sensitive method to the lba artefact, whereas probabilistic methods, namely maximum likelihood  and bayesian inference  are more robust  <cit> . since rate variation across lineages is almost invariantly observed in real data sets, often very pronounced, lba artefacts have regularly been found to mislead phylogenetic inference  <cit> . as a result, the majority of phylogeneticists consider inferences made with probabilistic methods as the most reliable  <cit> .

in  <dig>  siddall argued that in certain cases mp outperforms ml when lineages evolved at markedly different evolutionary rates  <cit> . instead of considering the so-called "felsenstein zone"  <cit>  where two unrelated taxa have long branches , siddall  <cit>  considered what he called the "farris zone" where the two fast-evolving taxa are related . in this configuration, simulations based on sequences of  <dig>  nucleotides demonstrated that mp recovered the correct tree more frequently than ml. the poor performance of ml relative to mp in the farris zone, and the fact that mp "imposes the fewest assumptions about process", led siddall to encourage the preferential use of mp over ml  <cit> . however, it was not demonstrated that ml was inconsistent in the farris zone, since only short sequences were considered. indeed, when sufficiently long sequences were used, ml recovered the correct tree  <cit> . in the farris zone, ml is simply more cautious than mp for grouping the two long branches together because this method acknowledges the fact that many false synapomorphies uniting these branches are the result of convergence  <cit> . in contrast, the literal interpretation of substitutions made by mp leads to the grouping of the two long branches even if the internal branch length, i.e. the number of true synapomorphies is zero  <cit> . swofford et al.  <cit>  conclude that "most scientists would prefer to use methods that are honest about how strongly a result is  than to use a method that pretends that a result is strongly supported when the majority of that support is a consequence of bias ". in addition, since, under various simulation conditions, ml is always more accurate than mp in face of across-lineage rate variation, investigators continued to prefer ml for analysing real data.

it should nevertheless be noted that most early simulations demonstrating the higher accuracy of ml methods were made using a very simple model of evolution, often the jukes and cantor model  <cit> . substitution properties vary from one position to another, with respect to rates  <cit>  as well as to the type of substitution propensity  <cit> . simulation studies have therefore been undertaken in order to investigate the effect of across-site rate variation  <cit>  and compositional heterogeneity  <cit> . however, the evolutionary rate of a given position can also vary throughout time  <cit> , a phenomenon called heterotachy   <cit> . heterotachy has been shown to be widespread  <cit>  and to affect the performance of phylogenetic reconstruction methods in empirical datasets  <cit> .

in a recent simulation study, kolaczkowski and thornton  found that, when the level of heterotachy is sufficiently high, mp is more accurate than ml, i.e. recovers the correct tree with infinite sequences under conditions where ml does not  <cit> . more precisely, kt used a simple but clever approach to simulate heterotachy . two sets of sequences are simulated using the same model topology, but under two totally different sets of branch lengths . these two heterogeneous sets of sequences are then combined and analysed using standard tree reconstruction methods . under this scheme, the level of heterotachy can be modified by changing the values of p and q  or the relative weight  of the partitions . the difference in accuracy between two methods can then be evaluated as the value of the internal branch length , for which the correct tree is inferred in more than 50% of the simulation replicates . even when sequence length is limited , bl <dig> provides a good estimate to the boundary value r <dig> for which tree reconstruction becomes inconsistent when r < r <dig> . for high levels of heterotachy , it appears that ml is less accurate than mp with higher values of bl <dig>  <cit> . consequently, kt "recommend reporting nonparametric analyses along with parametric results and interpreting likelihood-based inferences with the same caution now applied to maximum parsimony trees"  <cit> .

the simulation results reported by kt and the authors' conclusions on the relative performance of mp and ml  <cit>  prompted the publication of more simulations aimed at exploring heterotachy more widely  <cit> . spencer et al.  <cit>  performed simulations on all  <dig> possible combinations of two different edge-length partitions with two long and two short terminal edges and showed that ml performs better or at least as well as mp on the majority of combinations  <cit> . moreover, they also demonstrated that when accounting for both substitution and across-site rate heterogeneities, the performance difference between the two methods is largely alleviated  <cit> . these authors further demonstrated that the correct implementation of a mixture model dealing with heterotachy, first proposed by kt  <cit> , renders ml largely superior to mp under conditions where standard ml was outperformed  <cit> .

in the simulations of kt  <cit> , the terminal branch lengths, averaged over the two partitions, were kept equal to / <dig>  therefore, although heterotachy is accounted for, these simulations largely ignored a major kind of heterogeneity: rate variation across lineages. neglecting across-lineage rate heterogeneity is problematic because it is the main reason motivating the preference of ml over mp by most investigators. one way of simultaneously altering the level of heterotachy and across-lineage rate variation is to change the relative weight  of the two partitions, as in kt's fig. 2b. in this case however, the averaged terminal branch lengths become heterogeneous in a complex manner and kt reported only the performance of ml  <cit> . more recently, kt's simulations were expanded by exploring a wider range of w and it was demonstrated that ml in fact outperforms mp over the majority of the parameter space  <cit> .

in this report, we define a single parameter controlling the level of heterotachy without modifying the relative weights of the two partitions . we present computer simulations that simultaneously account for heterotachy and across-lineage rate variation. we show that the known superiority of ml methods over mp when rates vary across lineages still holds in the presence of a realistic level of heterotachy.

RESULTS
first, we introduce a new parameter  that allows for the adjustment of varying levels of heterotachy, while keeping the averaged branch lengths constant. as shown on figure 2b, terminal branch lengths leading to a and c are equal to  p and  p for the two partitions respectively. using a weight w of  <dig>  allows having a branch length of p, whatever the level of heterotachy. we varied τ from  <dig>  to  <dig>  . note that a different value of τ could be applied to each branch. for simplicity, we chose the same value of τ for all terminal branches of the model topology and therefore our simulations explore only a specific form of heterotachy.

the first simulations were realised using model topologies belonging to the felsenstein zone, from severe  to moderate  rate variation among lineages. when p =  <dig> q , ml  is much more accurate than mp , except for extreme heterotachy . for example, for τ =  <dig> , the internal branch length r for which ml recovers the correct tree in more than 50% of the simulations  is equal to  <dig>  whereas bl <dig> =  <dig>  for mp. interestingly, the performance of both ml and mp is negatively affected by increasing the level of heterotachy. however, the effect is much more pronounced for ml, going from bl <dig> ≈  <dig> without heterotachy to bl <dig> ≈  <dig>  when τ =  <dig> , whereas mp goes from  <dig>  to  <dig> . therefore, for extreme heterotachy, mp is slightly more accurate than ml.

the results are very similar when across-lineage rate variation is less extreme with p = 3q  or p = 2q . with increasing values of τ, the accuracy of both methods decreases, however the decrease is faster for ml than for mp. since, without heterotachy, the difference in bl <dig> between mp and ml is lower when the rate heterogeneity is reduced, mp becomes more accurate than ml for lower values of τ . nevertheless, at levels of rate heterogeneity often observed in real data sets  ml is more accurate than mp even in the presence of a significant level of heterotachy . in fact, when τ =  <dig> , the difference of evolutionary rates between the two partitions is already three-fold.

finally, we also studied the impact of heterotachy when going from the felsenstein zone to the farris zone. we chose a more extreme case of rate heterogeneity . the transition was performed by transferring a part of the length of the branch leading to a to the branch leading to d. for instance, we moved from : r) to : r). as found previously  <cit> , in the felsenstein zone and in the absence of heterotachy , ml is more accurate than mp until the two longest branches become the adjacent ones . after entering the farris zone, the values of bl <dig> are close to  <dig> for the two methods because the number of simulated nucleotides used here is large . as in fig.  <dig>  the accuracy of ml always decreases with increasing values of τ. in contrast, with increasing levels of heterotachy, the accuracy of mp sometimes increases or is not affected, but generally also decreases, albeit less rapidly than ml. as a result, heterotachy only slightly modifies the relative behaviour of ml and mp. when the two longest branches are not adjacent, ml outperforms mp, except when τ is high. when the two longest branches are adjacent, mp always outperforms ml. the only difference is that when heterotachy is present, the poorest performance of ml is not limited to its efficiency  but also to its consistency.

discussion
our results  confirmed previous studies  <cit>  that heterotachy renders probabilistic methods inconsistent. in contradiction with kt who stated that mp "is not additionally hampered by evolutionary heterogeneity"  <cit> , we found that mp is also affected by heterotachy, its performance being generally degraded, but sometimes also improved depending on the branch length combination considered. in fact, kt's observation of mp being not affected by heterotachy is due to a very specific simulation design. by modifying the relative weight of the two partitions, they simultaneously modified the level of heterotachy and the average terminal branch length. for instance, with w =  <dig>  there is no heterotachy and terminal branch lengths are p and q; with w =  <dig> , medium heterotachy and terminal branch lengths are  <dig> p +  <dig> q and  <dig> q +  <dig> p; with w =  <dig> , strong heterotachy and terminal branch lengths are of equal size,  /  <dig> . the lack of sensitivity of mp to heterotachy observed by kt is therefore due to an extremely peculiar combination of branch lengths and heterotachy level. when the effect of heterotachy is explored with a fix set of branch lengths, mp is affected by heterotachy, often to a great extent .

interestingly, the accuracy of mp does not always decrease with increasing heterotachy , illustrating a rather complex behaviour over the parameter range here covered . the explanation is that, with an increasing level of heterotachy, the branch lengths of one or two partitions can shift from the felsenstein in the direction of the farris zone, and vice versa. for instance, when the average branch length is well in the felsenstein zone  and τ =  <dig> , the first partition is entirely in the felsenstein zone , whereas the other partition is only on the border of this zone . therefore only the first partition contains a large number of convergences that mislead mp, in contrast with the homotachous situation where the two partitions are in the felsenstein zone. this explains why the accuracy of mp increases in the case of fig. 4a. in contrast, for the opposite case of fig. 4e, one starts from : r) and goes to : r) and : r) when τ =  <dig> . here, one of the partitions is clearly in the felsenstein zone when τ =  <dig> , whereas the starting point is exactly in-between the felsenstein and farris zones, explaining the decreased accuracy of mp. in summary, contrary to the claim of kt  <cit> , mp is also affected by heterotachy, often to a great extent. however, there is no simple rule to predict whether heterotachy will improve or decrease the accuracy of mp.

nevertheless, under extreme heterotachy , mp almost always outperforms ml whereas ml is generally more accurate when τ <  <dig> . but, as noted by swofford et al.  <cit> , the better performance of mp in the farris zone  is due to an intrinsic bias of mp  and cannot be used as an argument in favour of mp. to guide the choice of investigators in analysing real data, we evaluated the extent of heterotachy in real data sets by developing a bayesian mixture model that assumes k partitions and estimates the k sets of associated branch lengths and the relative weights of the k partitions, as proposed by kt  <cit>  and corrected in spencer et al.  <cit> . for the sake of comparability with our simulations, we assumed two partitions. the values of τ for each branch were calculated for several large alignments of amino acid sequences from various taxonomic groups . we confirmed that heterotachy exists in real data  <cit> , but the averaged observed value of τ is rather low,  <dig>  . according to these empirical observations, a realistic level of heterotachy can be considered to fall within the parameter range  with evolutionary rate varying between a two to three fold difference across lineages. under these conditions, ml is always more accurate than mp and we therefore strongly recommend preferential use of ml over mp for inferring phylogenetic trees from real data.

in fact, it is not surprising that the influence of the level of heterotachy on the performance of phylogenetic methods when analysing real data is less important than across-lineage rate variation. variation of evolutionary rates is indeed widespread and can easily be observed for any gene, with clock-like genes being the exception. in contrast, detecting heterotachy is much more difficult, as demonstrated by a short historical overview of its discovery and characterisation. fitch recognized early on that invariable sites are not identical in cytochrome c of animals and plants  <cit> . however, several other heterogeneities such as rate variation across sites  <cit> , across lineages  <cit> , across substitution types  <cit> , as well as compositional biases  <cit> , appear to be more prominent in the evolutionary process. indeed, a larger amount of data is necessary to detect heterotachy  <cit>  relative to other evolutionary heterogeneities. all other kinds of evolutionary heterogeneities have been successfully and naturally addressed in a probabilistic framework  <cit> , whereas various attempts to decrease the sensitivity of mp to these problems are far from being efficient and widely accepted. the case study in which mp outperforms ml under heterogeneous conditions  <cit>  is unrealistic in the sense that no evolutionary heterogeneity except a very strong heterotachy  was considered. we have shown here that taking into account across-lineage rate variation reverses the mp / ml accuracy ratio.

heterotachy has been proposed as a cause of tree reconstruction artefact in the case of fast evolving lineages such as chloroplasts  <cit>  or microsporidia  <cit> . it was proposed that model violations due to heterotachy render probabilistic methods inaccurate  <cit> . contrary to the claims of kt  <cit> , we have found that mp is not a valuable alternative to ml for dealing with heterotachy, as it is too sensitive to lba. for example, microsporidia represent a phylogenetic problem where the occurrence of both strong evolutionary rate variations and heterotachy have been demonstrated to affect tree reconstruction  <cit> . in agreement with the simulations performed here, we recently showed on a phylogenomic dataset that mp is unable to correctly locate microsporidia among eukaryotes whereas ml can  <cit> .

CONCLUSIONS
phylogenetic reconstruction is rendered difficult by the occurrence of numerous evolutionary heterogeneities in molecular sequence data. kt  <cit>  have judiciously pointed out that heterotachy seriously affects probabilistic methods. the reason is that the averaged branch length, which is fundamental for detecting convergent changes along long branches, no longer represents an accurate estimate when heterotachy is strong. however, from the extremely specific design of their simulations, kt found that mp would be unaffected by heterotachy and therefore suggested to consider with equal caution the results of mp and ml  <cit> . here, we have found that mp can be affected by heterotachy and that it is much less efficient than probabilistic methods in dealing with all other evolutionary heterogeneities. we therefore strongly urge the continued preference of probabilistic methods for inferring phylogenies from real sequences . indeed, heterotachy, as well as other kinds of heterogeneities  <cit> , can be handled properly in a probabilistic framework using mixture models  <cit> .

