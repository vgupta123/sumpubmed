BACKGROUND
linkage disequilibrium  has long been one of the central topics in evolutionary and population genetics. linkage disequilibrium refers to non-random association of alleles at different linked or unlinked loci in a population. inference about ld provides useful information for distinguishing between alternative evolutionary models of genetic polymorphisms within or divergence between populations  <cit> . the current surge of population based association studies has reported identification of causal genetic variants of disease susceptibilities in humans  <cit>  and complex genetic variation in plants and animals  <cit> . the kernel of these studies is inference of ld between the genetic variants and functional loci that are closely genetically linked. thus, adequate prediction of ld is obviously crucial for reliability and accuracy of these studies.

the coefficient of ld between two biallelic loci is defined as d = fab - fa fb in a randomly mating population, where fab, fa and fb are frequencies of gametes ab, alleles a and b in the population. the genetic parameter has been re-parameterized into different forms for various purposes of ld analysis  <cit> . hill proposed the well known "chromosome counting" method to estimate the parameter by using data of genotypes at the two loci from a random sample  <cit> . it has been widely used in population genetic analyses and studies on linkage disequilibrium based mapping  <cit> . the principle of the analysis has also been employed to develop widely used methods for predicting haplotypes of dna markers in natural populations  <cit> . in practice, however, it is very rare that the samples for ld analyses are truly randomly collected from the population under study. for example, the samples used in many association studies or population genomics analyses were so collected that the frequencies of some genotypes are artificially inflated to ensure that genotypes involving a rare allele are well represented  <cit> . weir and cockerham explored the consequences of implementing the method to estimate ld by using the samples in which some genotypes are missing and stressed that the method should not be used to estimate the parameter from non-random samples  <cit> , but neither appropriate theory nor method has been developed for inferring population disequilibrium from non-random samples.

in this paper, we develop a new method to calculate the maximum likelihood estimate of the coefficient of linkage disequilibrium between genes at any pair of polymorphic loci in any randomly matting population by making use of samples of genotype data, which are non-randomly collected from the population of interest. on the basis of simulation studies, we demonstrate that bias in estimates of the disequilibrium parameter from hill's method arising from the use of non-random samples can be substantially reduced by implementing the new method. we compared analyses of a 'case and control' dataset of β-thalassemia using three different methods: hill's, haplotype prediction by the computer software phase <dig> . <dig> and the method developed in the present study.

RESULTS
we developed a likelihood-based statistical approach to estimate the coefficient of linkage disequilibrium between a pair of polymorphic loci in a natural population and to test for significance of the disequilibrium by making use of the samples that are not randomly collected from the population. the method uses information from the conditional distribution of genotypes at one locus given genotypes at the other in formulating the statistical analysis with non-random samples. this is in contrast to the approach proposed by hill  <cit> , which relies on information of a joint distribution of genotypes at the polymorphic loci and estimates the disequilibrium parameter from using the samples randomly collected from the population under question. hill's method has been extended or converted into various forms/approaches that are widely used in the current surge of genetic association studies and population genetic analyses  <cit> . here, our analysis is focused on hill's method  and the method  developed in the present study.

to explore the adequacy of the methods h and l in estimating ld and their statistical power in detecting ld, we first conducted a simulation study to generate samples collected from the simulated population by sampling with various degrees of non-randomness. we then implemented the methods to analyze both the simulated datasets and the real data of  <dig>  kb dna sequence surrounding the β-globin gene from a 'case and control' study with β-thalassemia  <cit> .

simulation study
the study considered three schemes of sampling individuals from a simulated population in which the distribution of genotypes at the marker and disease loci was as described by table  <dig> for any given set of simulation parameters p, q and d. sampling scheme i involved n individuals being sampled completely randomly from the simulated populations. sampling scheme ii generated the samples in which either individuals with a specific marker genotype or individuals with a specific marker-disease genotype were missing. finally, sampling scheme iii mimicked the generation of the case-control samples used in most association studies, in which the cases and controls were present in the sample in equal proportions. in addition, we explored influence of various 'case and control' proportions on statistical power of the 'case and control' design for detecting ld. the computer programs designed for simulating linkage disequilibrium between two bi-allelic loci can be found elsewhere  <cit> , and were modified to generate the samples in the present study.

q = q + d/p and r = q - d/

linkage disequilibrium parameters were estimated based on  <dig> simulations of n =  <dig> individuals from  <dig> different populations: p and q are the frequencies of alleles of the marker  and trait , d is the coefficient of linkage disequilibrium between the marker and the disease loci, dmin and dmax are respectively the minimum and maximum possible coefficients of linkage disequilibrium given allelic frequencies p and q,  and  are the estimates from methods h and l respectively, and the means and standard deviations, s.d., calculated from  <dig> simulations.

in sampling scheme ii, individuals were randomly sampled from  <dig> simulated populations but those with either a specific marker genotype  or a marker-disease genotype  were excluded in the sampling process. the sampling continued until the required number of individuals were obtained . from the samples so obtained, we calculated the allele frequencies, p and q, and then estimated d by use of both methods . means and standard deviations of the d estimates, based on  <dig>  simulations, are summarized in table  <dig>  in most cases, the two methods accurately estimate the disequilibrium parameters. however, when individuals with heterozygous genotypes at the marker locus were absent  in the sample, method h underestimated the parameters in the simulated populations 3- <dig>  in contrast, method l estimated the parameters adequately in these cases. in the cases where individuals with a specific marker-disease genotype were not present in the sample, method h severely underestimated the disequilibrium, for instance, when n <dig> =  <dig> in simulated population  <dig> and n <dig> =  <dig> in simulated population  <dig>  the biased estimates were substantially improved by making use of method l. one may argue that different performance of the two methods could be due to the limited sample size . we compared the methods with using much larger sample sizes  and observed that the same pattern in mean estimates of the disequilibrium parameter as demonstrated in table  <dig> with n =  <dig> . another question that may naturally rise from this sampling scheme is how much genotypic distribution at the simulated marker and disease loci deviates from that expected under hardy-weinberg equilibrium. the significance test shows that these genotype distributions in the samples generated from the sampling schemes highly significantly deviate from the hardy-weinberg expectations , revealing remarkable non-randomness of the samples with respect to the populations from which these samples were collected.

means and standard deviations of coefficients of linkage disequilibrium were estimated from  <dig>  repeats for methods h and l when  <dig> individuals were generated from the sampling scheme ii in which either a marker genotype  or a marker-disease genotype  was missing. the population numbers are the same as those in table  <dig> and d is the true value of the disequilibrium coefficient.

sampling scheme iii considered the scenario that the disease allele had a low frequency but generated an equal number of the case individuals  and the controls . to mimic the sampling scheme, we randomly generated a given number of 'case' or 'control' individuals for each of seven simulated populations. from these individuals,  <dig> 'case' and another  <dig> 'control' individuals were randomly collected, making a constant sample size of  <dig>  the samples so generated make a severely non-random collection of the cases but they present a typical example of the samples widely used in many current genetic association studies with a case-control design in which roughly an equal number of sporadic case individuals and control individuals were collected from the population under question  <cit> . use of the samples so collected raised a question of how the allele frequency parameters, p and q, can be calculated and used to estimate the disequilibrium parameter, d. we proposed to calculate p, the marker allele frequency, from the control sub-samples, and explored two alternative ways to obtain the value of q, the disease allele frequency. firstly, q was obtained from an independent population survey such as a prior epidemiological study or population survey. to assimilate this scenario, we used the stimulated value of q in estimation of d. secondly, we explored the use of q values directly estimated from the case-control sample in estimation of d.

simulation parameters for the case-control sampling scheme and means and standard deviation of estimates of the disequilibrium coefficients,  and , from methods h and l respectively. p, q and d are simulated values of population allele frequencies at the marker and disease loci and linkage disequilibrium respectively.  are the theoretical minimum and maximum values of d. the disequilibrium coefficients were calculated when the marker allele frequency, p was calculated directly from the control sub-samples while the disease allele frequency q was either from population survey or directly estimated from the case-control samples.

to explore influence of population size of the case-control samples on estimation and detection of the disequilibrium, we calculated estimates of the disequilibrium coefficient and the corresponding lod scores using method l in the case-control samples with an equal proportion of 'case and control' individuals but different total sample sizes. table  <dig> summarizes the means and standard deviations of  <dig>  repeated estimates of the disequilibrium coefficients and the corresponding lod scores. it can be seen that the disequilibrium parameters are estimated adequately from the method by use of the case-control sample with a size as small as only  <dig> individuals. the lod scores and the test statistic for significance of the disequilibrium, increase as the sample size increases.

means and standard deviations of the estimates of the disequilibrium coefficients and the corresponding lod score from using various sizes of case-control samples.

means and standard deviations of the estimates of the disequilibrium coefficients and the corresponding lod score from use of case-control samples of a constant size of  <dig> individuals but with varying proportions between the 'case and control' individuals, c:c.

analysis of β-thalassemia dataset
β-thalassemia is an autosomal recessive hemoglobinopathy caused by mutations in the β-globin  gene . the disorder is one of the most common inherited hemoglobinopathies in the world, with estimates of carrier frequencies ranging from  <dig> to 10% in some areas of the tropics and subtropics including southern china  <cit> . a frame shift mutation in codons  <dig> and  <dig>  a 4-bp deletion , of the human β-globin gene represents the most common β-thalassemia mutations in east and southeast asia. the population frequency of the deletion is as high as 3% in south china  <cit> . to survey the distribution of linkage disequilibrium among the polymorphic sites surrounding the β-globin gene, zhang et al collected a sample of  <dig> chinese individuals, including  <dig> βcd41/ <dig> thalassemia heterozygotes and  <dig> normal individuals  <cit> . they directly sequenced a  <dig> -kb dna region spanning  <dig>  kb of the β-globin cluster surrounding the deletion and detected  <dig> bi-allelic sites in the sequenced region. all individuals in the sample were genotyped at the polymorphic markers. this dataset represents a typical example of the selected sample in which disease carriers are deliberately enriched and no homozygote of the disease allele  is present in the sample.

to evaluate linkage disequilibria across the sequenced region, the haplotypes in the sample were first predicted by use of the computer software phase <dig> . <dig> developed by stephens et al  <cit> , and the predicted haplotypes were then used to calculate the coefficients of linkage disequilibrium. we implemented the haplotype-based method and the two methods  to analyze the sequence data and calculated the coefficient of linkage disequilibrium between the disease mutation, which was set as position  <dig>  and each of the other polymorphic sites. we used the population frequency of 3% for the disease causing allele in the analysis and illustrate the distribution of estimates of the disequilibrium between each of the polymorphic sites and the disease causing mutation in figure  <dig> together with the lowest and highest bounds for the disequilibrium parameter which were inferred from the maker allele frequency estimates and the population frequency of the disease causing allele. it can be seen that the ld estimates from the present method could differ substantially from the other two methods. importantly, the ld estimates by the former lie properly between the corresponding theoretical bounds whilst the estimates by the latter two may be severely out of the bounds, suggesting serious bias in the estimates to the true parameters. figure  <dig> shows the lod score values for the ld estimates from the three methods and demonstrates that the present method provides much more likely estimates of linkage disequilibria in the vicinity of the disease causing site than the other methods under comparison. the data analysis clearly indicates that the method developed here is robust to non-randomness of the samples by which linkage disequilibrium is statistically inferred.

discussion
the past decade has witnessed great progress in high-throughput detection and genotyping of single nucleotide polymorphisms  in the genomes of plants, animals and humans. this has stimulated tremendous interest in mapping and identifying subtle genetic variants contributing to phenotypic variation of complex traits in natural populations through detecting linkage disequilibrium maintained in the populations by close linkage between alleles at genetic polymorphic sites and at trait loci. however, a common concern of association studies is the high proportion of false positive or false negative tests of association of trait phenotype with causal genetic polymorphisms as well as the limited statistical power in detecting genuine associations  <cit> . a rich pool of literature has been focused on exploring factors that cause these problems and seeking for solutions to them. the most prominent among these is population stratification that could cause both false positive and false negative inferences of association  <cit> .

although it has been well established that skewed sampling from a population with a linkage equilibrium distribution of multi-locus genotypes may result in spurious linkage disequilibrium  <cit> , there has not been a comprehensive investigation of the consequences of non-random samples on statistical inference of ld from populations under disequilibrium. we demonstrate in the present study that the use of non-random samples could result in severely biased estimates of ld from the method proposed for random samples. the simulation study showed that the estimates could be so biased as to be outside the theoretical limits of the corresponding simulated values and the biases can be either up- or downwards. these results indicate that the non-randomness of the sample may result in considerable false positive or false negative inference of the disequilibrium parameter and, in turn, false positives or false negatives in association analyses in which significant degree of marker-disease association implies significant linkage disequilibrium. instead of considering the joint probability distribution of genotypes at the marker and disease loci in estimating ld from random samples  <cit> , we propose the use of the conditional probability distribution of disease genotypes given any marker genotype in developing a new method to estimate the parameter. the method avoids or effectively alleviates the influence of non-random presentation of any marker-disease genotype in the samples on the parameter estimation. on the basis of simulation studies, we show that the method yields equally adequate estimates of ld to the method previously proposed  <cit>  and currently widely cited in the literature when individual genotypes are randomly sampled from the populations. however, the method confers significant improvement over the current method when the parameter estimation is made from using artificially selected samples. methodologically, the improvement in the parameter estimation of the method developed in the present study over the current methods  <cit>  can be explained by their difference in extracting information of linkage disequilibrium between the two loci of interest from the samples under study. the present method uses the conditional probability distribution of genotypes at one locus on any given genotype at the other locus as illustrated in table  <dig>  when the sample of study is collected in such a way that genotype at one of the two loci undergo selection, for example, the case-control samples where genotypes at the disease locus are strongly selected, the joint distribution of genotypes at the two loci in the sample deviates greatly from the joint genotypic distribution in the population from which the sample is collected. however, the conditional distribution of genotypes at one locus given any genotype at the other selected or unselected locus in the sample remains approximately the same as that in the population. hence the analysis based on the conditional genotypic distribution is more robust to non-randomness of the samples to infer linkage disequilibrium in populations of interest than that based on the joint genotypic distribution.

the 'case and control' design used in many association studies to screen for genetic polymorphisms in significant association with phenotypic variation probably illustrates the most popular example of ld analysis with non-random samples  <cit> . although the base populations under investigation may be randomly mating with respect to genotypes at marker-disease loci, the samples used in the studies are collected so that case individuals are well represented and thus create severely non-random presentation of the populations. given that the analysis of the samples is to infer the situation in the base populations, accurate inference of ld from the samples is obviously crucial for reliability of these analyses. the β-thalassemia data analysis in the present study represents a typical example of such studies. the analysis with the dataset, although very limited in sample size, highlights the importance of adequately tackling the non-randomness in the 'case and control' studies in order to achieve reliable assessment of ld. it clearly demonstrates the robustness of the method developed in the present study to the non-randomness. previous methods, which are widely implemented in the current literature of 'case and control' studies are only suitable for analysis with random samples and so can result in seriously biased inference of the disequilibrium parameter.

a practical problem that is raised to accurately infer ld from 'case and control' samples is the need for accurate estimates of allelic frequencies at both marker and putative disease loci. we propose the use of control samples to calculate marker allelic frequency because there is usually not any prior selective criterion imposed on the marker genotypes of those individuals to be included in the control samples. it is shown that accurate estimates of the allele frequency are the basis for accurate estimation of the disequilibrium parameter , but neither the 'cases' or 'controls' separately or together are likely appropriate to estimate the allele frequency at the putative disease locus. in the scenario where epidemiological information is available for disease candidates such as the β-thalassemia data considered in the present study, the allele frequency estimate from a prior population survey may be used to meet this need. alternatively, one can search the lod score profile  for the mle of the disequilibrium parameter over various q values and choose the mle of d calculated from the q value at which the likelihood profile reaches the maximum. figure  <dig> illustrates such an example with the β-thalassemia data analysis and shows that the mle of d was obtained when q took a value of ~3%, which is near to the estimate from the previous population survey  <cit> .

methodologically, the present study has been focused on the most prominent linkage disequilibrium measure, d as defined above. there are several other measures, such as d' or r <dig> etc, frequently used in the literature of genetic association study or population genetic analysis. these latter measures are either a scaled or standardized form of the basic disequilibrium parameter d. bias in estimate of d will be inherent to that of transformed versions of the parameter. for example, we re-analyzed the β-thalassemia data by using r <dig>  which is defined as d2/pq in the present notation, as the disequilibrium measure and showed the analysis in additional file  <dig>  the disequilibrium distribution shows an almost identical pattern to that demonstrated in figure  <dig>  in which d was the disequilibrium measure.

one of the key properties of 'case and control' designs is its statistical power in detecting association between a genetic polymorphic marker to the phenotype of a disease trait. it has been widely accepted that level of ld is a critical factor in determining the power of 'case and control' designs to detect significance of genetic association  <cit> . several studies have focused on investigating factors affecting statistical power of the 'case and control' design, including marker allele frequency and errors in marker genotype and trait phenotype  <cit> . an equal proportion of cases and controls were proposed in these studies and implemented in many real 'case and control' experimental analyses  <cit> . the present study investigated the impact of using varying proportions of the cases and controls on the power of the 'case and control' design in detecting linkage disequilibrium and shows that, for a given size of the 'case and control' sample, increasing the proportion of the 'cases' decreases rather than increases the statistical power . in fact, increasing the proportion of control individuals in the 'case and control' samples alleviates the effects of non-randomness of the samples. this result indicates a need of reconsideration of the commonly accepted sampling strategy for 'case and control' study designs. we re-examined the question by implementing the chi-square based test proposed to test for significance of difference in marker allele frequency between cases and controls. the analysis was summarized as an additional file  <dig> and shows that use of an equal proportion of cases and controls in the case-control design is favoured for a higher statistical power to detect the genetic associations. however, it has been well established that the chi-square based association test is highly vulnerable to deviation of genotypic distribution from the hardy-weinberg equilibrium  <cit> . any violation to the equilibrium may result in severe type i error. moreover, it is clear from additional file  <dig> that the equilibrium does not usually hold in these samples.

it is well established that ld based association analysis is effective only for the genes underlying mendelian traits or the genes with major genetic effects on polygenic traits  <cit> . in the present study we assumed that genotypes at the putative disease locus are observable as are those at the marker locus. the assumption holds for mendelian traits but may be questionable for quantitative traits. in fact, the theoretical model and analysis developed in the present study can be incorporated into the statistical framework we previously developed for detecting and estimating linkage disequilibrium between a genetic marker and a locus affecting a quantitative trait showing continuous or dichotomous phenotypic variation  <cit> . the quantitative genetic model allows allelic frequencies at the marker and trait loci, the coefficient of linkage disequilibrium between the two loci, genetic effects at the trait locus and the residual variance component to be modelled and inferred. integration of the two models enables the non-randomness of samples to be properly accounted for in the statistical inference on the genetic parameters.

CONCLUSIONS
we demonstrated that the non-randomness may cause seriously biased assessment of ld when using the current methods originally developed for random samples. we have developed a new approach for inferring ld from samples with various degrees of non-randomness, and showed the significantly improved robustness of the present approach over the current methods when non-random samples were to evaluate ld through intensive simulation studies and analysis of a case and control sample of β-thalasemia. as accurate estimation of the disequilibrium parameter is crucial for any association study, in which the case/control design represents a typical example of non-random samples, the present paper highlights the importance of tackling the problem of using non-random samples to the community of ld analysis, and in addition, provides a route to improve statistical reliability in association studies.

