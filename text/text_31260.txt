BACKGROUND
the complexity of animal body form arises from a single fertilized egg cell in an odyssey of gene expression and regulation that controls the multiplication and differentiation of cells  <cit> . for over two decades, drosophila melanogaster  has been a canonical model animal for understanding this developmental process in the laboratory. the raw data from experiments consist of photographs  of the drosophila embryo showing a particular gene expression pattern revealed by a gene-specific probe in wildtype and mutant backgrounds. manual, visual comparison of these spatial gene expressions is usually carried out to identify overlaps in gene expression and to infer interactions  <cit> .

whole fruit fly embryo and other related gene expression patterns have been published in a wide variety of research journals since late 1980's. these efforts have now entered a high-throughput phase with the systematic determination of patterns of gene expression . as a result, the amount of data currently available has doubled leading to the imminent availability of multiple expression patterns of every gene in the drosophila genome  <cit> . in addition, the use of micro-array technology to study drosophila development has revealed additional and important insights into changes in gene expression levels over time and under different conditions at a genomic scale  <cit> .

with this rapid increase in the amount of available primary gene expression images, searchable textual descriptions of images have become available  <cit> . however, a direct comparison of the gene expression patterns depicted in the images is also desirable to find biologically similar expression patterns, because textual descriptions  cannot fully capture all aspects of an expression pattern. in fact, there is a need for automated identification of images containing overlapping or similar gene expression patterns  <cit>  in order to assist researchers in the evaluation of similarity between a given expression pattern and all other existing  patterns in the same way that the blast  <cit>  technique functions for dna and protein sequences. of course, unlike the genomes with four letters and proteomes with  <dig> letters, all gene expression anatomies cannot be easily reduced to, and thus represented by, a small number of components.

we previously proposed a binary coded bit stream pattern to represent gene expression pattern images  <cit> . in this digital representation, referred to as the binary feature vector , the unstained pixels in the images  were denoted by a value of  <dig> and the stained areas  were denoted by a value of  <dig>  based on the bfv representations of the expression pattern, we proposed a basic expression search tool for images   <cit>  with an aim to produce biologically significant gene expression pattern matches using image content alone, without any reference to textual descriptions. we found that the besti approach generated biologically meaningful matches to query expression patterns  <cit> .

in this paper, we explore how a more sophisticated invariant moment vectors  based digital representation of gene expression patterns performs in generating an ordered list of best-matching images that contain similar/overlapping gene expression patterns to that depicted in a query image. imv are frequently used in natural image processing  and have a number of desirable properties, including the compensation for variations of scale, translation, and rotation. if successful, imv representations hold the promise of producing significantly shorter computing times for image-to-image matching compared to bfv.

previously, we had examined the performance of the bfv representation for a limited dataset of early stage images  <cit> . here we compare the relative performances of bfv and imv first using a dataset containing  <dig> images . then we test for scalability of the besti search by using a seven times larger dataset containing  <dig>  images from  <dig> additional research papers . both datasets contained lateral views of early stage  embryos.

during these investigations, we also developed another measure of image-to-image similarity for the bfv representation. this measure is aimed at finding images that contain as much of the query image expression pattern as possible, but without penalizing for the presence of any expression outside the overlap region in the target image. in addition, we examined whether partitioning a multi-domain expression pattern into multiple bfv representations, each containing only one domain, yields a better result set.

recently, peng and myers  <cit>  have proposed a different procedure involving the global and local gaussian mixture model  of the pixel intensities  to identify images with similar patterns. this gmm method is expected to find images with intensity and spatial similarities. this is different from the bfv and imv methods examined here, which are intended to find only spatially similar patterns. this focus is important because, as mentioned in  <cit> , the differences in gene expression intensity among images in published literature can arise simply due to use of different techniques, illumination conditions, or biological reasons. however, peng and myers method  <cit>  appears to be promising and we plan to examine its effectiveness in a separate paper.

RESULTS
data set generation
an image database of  <dig> gene expression pattern images was initially generated using data from the literature  <cit> . all were lateral images and exhibited early stage  expression patterns. these images were selected because they had some commonality of gene expression , which allowed us to evaluate the performance of the besti in finding correct as well as false matches under controlled conditions. besti was also tested for scalability on a larger dataset containing  <dig>  lateral views of early stage embryos. these  <dig> images were obtained from  <dig> articles.

in order to present comprehensible result sets in this paper, we have primarily discussed the findings from the dataset of  <dig> and provided information on how those queries scaled when they were conducted for the larger dataset. in general, our focus was to show the retrieval of biologically significant matches based on both the visual overlap of the spatial gene expression pattern and the genes associated with the pattern retrieved.

each image was standardized and the binary expression pattern extracted following the procedures described previously  <cit> . these extracted patterns, their invariant moments , and binary feature representations were stored in a database. we also calculated and stored the expression area , the x and y coordinates of the centroid , and the principal angle  for each extracted pattern.

to quantify the similarity of gene expressions in two images, we computed two measures  based on the bfv representation . ss is designed to find gene expression patterns with overall similarity to the query image, whereas sc is for finding images that contain as much of the query image expression pattern as possible without penalizing for the presence of any expression outside the overlap region in the target image. for a given pair of gene expression patterns , ss is the same irrespective of which image in the pair is the query image. that is, ss = ss . this is not so for sc, because sc measures how much of the query gene expression pattern is contained in the image. therefore, sc  ≠ sc.

for imv representation, we computed one dissimilarity measure . results from dφ should be compared to that from ss, as both of these measurements do not depend on the reference image, i.e., dφ  = dφ and, also they capture overall similarity or dissimilarity.

matches and their biological significance
the effectiveness of the besti in finding biologically similar expression patterns was geared towards determining the biological validity of the results obtained from the image matching procedure. all results were based solely on quantitative similarities between images without using any textual descriptions. all images were lateral views from the early stages of fruit fly embryogenesis and were oriented anterior end to the left and dorsal to the top. we refer to the images retrieved as the besti-matches.

performance of bfv-ss search
a search was conducted using the same query image and same distance measure  on the larger dataset. figure  <dig> shows the top- <dig> matches, which contain all  <dig> matches shown in figure 1a . this allowed us to directly compare the quality of matches between the two datasets. analysis of larger database of images yields more matches for the same ss cut-off value, as expected. a visual inspection reveals that these are all relevant images , with the larger dataset yielding more images for otd . images with expression patterns from slp <dig>  slp <dig> and combined otd expression are found in figure 2a,b, and 2d. more importantly, searches in the larger dataset provide images containing expression patterns of additional genes: kruppel , hunchback , bicoid , nanos, snail, hu-li tai shao  and hairy . since these images did not exist in the smaller dataset, they were not included in the search results in figure 1a. all are biologically useful matches because combinatorial input from gap genes  along with slp <dig> establishes the domains of segment polarity genes in the head  <cit> . as for the snail, hts and hairy genes, there are no known interaction between them and slp <dig>  in the wildtype embryo, but the images show overlap in gene expression due to the genetic backgrounds used  <cit> . therefore, they are also biologically relevant matches.

performance of imv search
we used the same query image for the imv method applied to the smaller dataset  and compared the results to the bfv-ss search. in this case, we obtain images containing expressions of hb, kr, tailless , slp <dig>  hairy and infra-abdominal  . it is clear that imv search produces some biologically disconnected matches. for example, figures 1b <dig>  1b4–b <dig> exhibit no visual overlap in gene expression pattern with the query. furthermore, even the biologically significant matches were retrieved out of order . this happens because dφ retrieves expression patterns that are of similar shape and/or size, regardless of the translation or rotation with respect to the query image.

a comparison of the results from the smaller and larger dataset for the imv measure is given in figure  <dig>  twenty-six images were retrieved from the larger dataset when we used the same maximum distance value for the same query image. of these, only two images were with expression pattern from slp <dig> . the expression of bcd was found in two of the results .  <dig> images containing gap gene expression patterns of kr, hb, tll, giant  and knirps   were also retrieved. images with expression patterns of hairy, achaete-scute complex , iab , iab <dig> enhancer, ventral nervous system defective , short gastrulation  and a combined expression of bcd, nanos and cap 'n' collar  accounted for the remaining nine . we see that the new results also suffer from the same problems as before. for example, images in figure  <dig> c,e,k and 3l have no common expression pattern with the query image. hence these are not biologically significant results even though few of them  contain expression patterns of developmentally connected genes .

since both ss and dφ measures capture the overall similarity or dissimilarity, we can use figures  <dig> and  <dig> to compare the relative effectiveness of the bfv and imv methods on the larger dataset. we clearly see that the bfv method performs much better in retrieving both overlapping and similar expression patterns that are also biologically significant.

in addition to the hu moments, one could also compute zernike moments, which are based on the polar coordinate system. both hu moments and zernike moments are susceptible to the same problem namely expression patterns showing a similar shape but translated to different locations in the embryo would be in the same result set. we chose to study the hu invariant moment vectors mainly because the centroid of the image can be used to distinguish between similarly shaped but translated expression patterns. with zernike moments, the image must be inherently contained within a unit circle anchored at the centroid  <cit> . thus, there is no straightforward method to eliminate the translational problem.

using the hu moments, the spatial location problem can be corrected by considering the euclidean difference in the centroid location expressed in pixels  of the query and results. in the case of bfv-ss search results in figure  <dig> , the maximum Δcxy is less than or only slightly greater than the minimum Δcxy for the imv search results . therefore, in the present case, the imv-based besti search results need to be pared down using the centroid location difference. for example, if we consider results based on a Δcxy lesser than or equal to  <dig> pixels, images shown in figure  <dig> b <dig>  b4–b <dig> would be removed producing a more meaningful result set.

performance of bfv-sc search
using the same minimum similarity value for the bfv-sc in the larger dataset resulted in  <dig> images, given in figure  <dig>  gene expression patterns of slp <dig> and otd accounted for  <dig> of these images .  <dig> images contained expression patterns of the various gap genes hb, kr, kni and tll  that were co-expressed with bcd and nanos  or with en . five other genes, developmentally connected to the gene, slp <dig>  in the query image were also retrieved in this result set   <cit> ; en   <cit> ; arm   <cit> ; figure 4m–q). these images were not found in the top- <dig> of ss result set, which accentuates the different capabilities of the two bfv similarity measures in retrieving biologically relevant matches. the remaining images had expression patterns of as-c, sc , snail, hairy, zen , run, hsp <dig>  nmo , tc'hb, iab, hts and sog  which are not known to be directly related to the gene slp <dig>  all but seven of these images  were from a different developmental stage than the query image. hence, by limiting the results to those from a specific stage, extraneous matches can be removed. the seven images having the same stage as the query image were retrieved because of their significant overlap  with the query gene expression pattern. thus, we observe that the new distance measure sc has the potential to identify images containing expression patterns of developmentally connected genes, other than those retrieved by ss, thus improving the overall performance of the bfv method and the besti tool.

analysis of multi-domain gene expression patterns
due to the presence of multiple areas of expression, some patterns in the database that appeared to contain much better matches  to the query image were not found or ranked very high. hence, we also analyzed multi-domain expression patterns separately for the smaller dataset. developmental biologists are also interested in finding such patterns as they contain overlaps with the expression domains in the query image. in fact, a large number of the expression patterns available today contain multiple isolated domains of expressions since more than one topologically distinct region of expression may be produced by many genes, transgenic constructs, probes or experimental techniques . in such cases, we need to consider each of these regions individually as well as in the context of the composite pattern. biologically, it is important to consider them separately because different regions of expression may be under the control of distinct cis-regulatory sequences  or may represent the expression of different genes in a multiply-stained embryo.

separating multi-domain gene expression patterns into individual components was straightforward; we simply generated multiple images from the same initial image and included them in the target dataset. this resulted in  <dig> additional images  in the database all of which were components of the initial gene expression patterns. the images were separated into expression regions horizontally and/or vertically depending on the gene expression. for this new set of images, the imv as well as bfv representations were re-calculated and the besti query constructed as above.

results from bfv-ss and imv queries for this data set are given in figures 1d and 1e, respectively. now, many images with multiple regions of expression are retrieved in the result set  and many of them show an even better match with the query pattern than those in figure 1a for the bfv-based besti search. for instance, gene expression patterns are now retrieved  from embryos with the expression of tailless , which is known to interact with slp <dig> in defining the embryonic head  <cit> , and with a composite expression of race , sog  and eve  due to enhanced race expression in the anterior domain caused by a transgenic construct causing ectopic expression of sog  <cit> . therefore, the strategy of dividing multi-domain expression data into individual domains provides additional flexibility to query individual components or sub-sets of complex expression patterns. results also improved for imv , but again the outcome reinforced the need to use the difference in centroid to limit the result set.

next we examine the performance of ss, sc and dφ in finding besti matches for a query pattern with multiple regions of expression . this complex expression pattern consists of anterior and posterior domains caused by enhanced race expression resulting from dosage alteration of dpp in a gastrulation defective  mutant background, and a middle stripe due to misexpressed sog using an eve stripe- <dig> enhancer . the results from this query are shown in figure 5a1–a <dig>  was used as the target database in this case). we again find that ss finds many images from the same paper as well as some images from other research articles with similar expression patterns. the results correctly include expression pattern of eve , of another pair-rule gene , and of two other developmentally related genes  <cit> .

when dφ is used as a search criterion, it produces some correct matches in the result set . however, it generally fails to rank biologically meaningful matches as the best matches. use of the centroid in this case is also not productive, as most of the matches show very close centroids. the principal angle  value calculated does not show a significant difference in the early stage embryos used in this study. the results using the sc based search are given in figure 5c1–c <dig>  they show a number of images in common with the ss results. however, as expected, there are significant differences between the two searches.

the results in figures 5d and 5e demonstrate the power of the besti-search when the multi-domain expression data are represented in their component patterns . in this case, all the besti searches are based on the use of ss as the search criterion. these searches are based on the complete expression  and on one of its components . all, but one, besti-matches in figure 5d contain both domains of expression. in contrast, the use of only the left, anterior, domain  in the besti search produces many other images in which the gene expression pattern is similar to only the anterior-ventral query pattern. therefore, the use of individual expression components as search arguments increases the potential of directly identifying different overlapping expression patterns.

CONCLUSIONS
we have found that it is possible to identify biologically significant gene expression patterns from a dataset by first extracting numeric signature descriptors and then using those descriptors in a computerized search of the database for expression patterns with similar signatures or maximum pattern similarities. we find that the bfv methodologies provide a longer and more biologically meaningful set of expression pattern matches than imv. even though imv representations will produce much faster retrieval speeds for large collections of embryogenesis images, the lack of biological validity of besti-matches retrieved makes imv undesirable for the present problem. instead, investigations and strategies aimed at improving the real time performance of the bfv representation will better serve the developmental biological research.

