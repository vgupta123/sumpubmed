BACKGROUND
to understand phenotypes and their regulations, it is important to identify key genetic components as well as how they interact. cell-based screening approaches have been successfully used to monitor the effect of individual gene knockdowns or small molecule treatments, identify key regulators contributing to the assessed phenotype and investigate their interactions  <cit> . such high-throughput screening experiments can be divided into two categories: homogeneous intensity-based methods, such as reporter gene or cell viability assays, and image-based phenotyping approaches. intensity-based methods usually report the average of cell populations, leading to scalar  values per perturbation. such screens have been designed, for example, to identify novel signaling pathway components by associating an intensity readout  with a perturbation of a specific reporter gene activity  <cit> . in contrast, image-based methods mark cells with fluorescent dyes, and produce high-dimensional data sets based on images of phenotypes on a single cell level and consequently on cell populations  <cit> . cellular phenotyping by imaging offers many advantages including flexible marker choices, subcellular resolution and ability to address cell population heterogeneity , but also pose new challenges such as lower throughput, more complex infrastructure, and in particular, challenges in data analysis  <cit> .

while the analysis of univariate readouts from intensity-based screens has been greatly facilitated by the development of specific algorithms and analysis methods  <cit> , how to effectively analyze image-based phenotypes is still being explored. in general, the analysis comprises two steps: image quantification and phenotype-based analysis of gene networks. the image quantification step, which includes image pre-processing, cellular object segmentation and feature extraction, is relatively well established with several software tools offering automated, scalable and interactive pipelines  <cit> . this step generates a multidimensional data set containing cell feature information for typically 100– <dig> cells per treatment and 10– <dig> features measured per cell . the second step, to derive functional relationships from these complex datasets representing phenotypes, remains challenging. while intuitively this is performed in any kind of genetic screens, e.g. in forward genetic screens in drosophila melanogaster or caenorhabditis elegans, a systematic implementation for quantitative cellular image data sets is still missing. one key question is how to define quantitatives to represent the phenotype of a given perturbation based on the multidimensional cell feature data sets, before one can identify and potentially cluster phenotypes by similarity.

previous studies typically first applied a dimension reduction or data transformation method, such as principle component analysis  <cit> , kolmogorov-smirnov statistics  <cit> , support vector machine  <cit> , or factor analysis  <cit> , and generate a single feature vector for each perturbation treatment, i.e. a phenotypic profile. then the distance between feature vectors is computed based on a distance measure, such as euclidean distance. although these approaches have been successfully applied in various image-based analysis, they often require manually curated training data sets and/or multiple optimization steps. thus, for a new image-based screen campaign, selecting and optimizing the appropriate method to perform hit identification and clustering analysis remains challenging.

here, we propose a novel method to measure phenotypic dissimilarity between cell populations in imaging screens, based on cell classification and cross validation. we define the phenotypic dissimilarity between a perturbation and a control, or between two perturbations, as the classification accuracy between the two corresponding cell populations. first, we virtually pool cells from both populations. then, using support vector machine  classification, the mixed cell population is classified into two groups based on quantitative cell features. the classification accuracy can be estimated by cross validation with the original cell labels, and defined as the phenotypic dissimilarity. a higher accuracy indicates better separation between the cell populations, thus a larger phenotypic dissimilarity. evaluated on a kinome-wide rnai screen for cell morphology  <cit> , the proposed phenotypic dissimilarity method  was able to identify rnai perturbations causing distinct morphology phenotypes, such as siplk <dig>  sicopb <dig> and siakap <dig>  we then clustered the phenotypes based on their pair-wise dissimilarity, and genes that clustered together were functionally related.

the phenodissim method is relatively straightforward to apply on different high-throughput screening experiments, as it has only two parameters for svm classification: cost and gamma, and parameter optimization can be automated. the method, as well as the quality metrics for evaluation, is implemented in a freely available r/bioconductor package phenodist , a toolbox for data analysis in image-based high-throughput screening.

RESULTS
we used a previously generated image-based rnai screening data set as a benchmark for phenotypic dissimilarity analysis  <cit> . the genome-wide kinase screen was conducted in duplicates using a cervix carcinoma cell line . cells were stained with cytoskeletal and nuclear markers   <cit> . plate layout is listed in additional file 1: table s <dig>  we reanalyzed the images with the r/bioconductor package imagehts, and measured  <dig> image-based features for every cell including geometric features, haralick texture features and zernike moments .

phenotype identification with phenodissim
one major goal in image-based screens is to identify perturbations that show significantly different phenotypes when compared to negative controls. applying the phenodissim method, we computed the phenotypic dissimilarity between each perturbation and the negative controls, which indicates how significant the phenotype is . the screening data set has one negative control  and two positive controls , with four wells of each control per 384-well plate. figure 2a plots the distribution of the phenotypic dissimilarity of these control wells to negative control wells. since sirluc is the negative control, these show a low phenotypic dissimilarity . it is larger than  <dig>  due to noise and cell population variation within sirluc wells. the positive controls siubc and siclspn have much higher phenotypic scores  and are well separated from the negative control sirluc .

phenotypic dissimilarity of all perturbations in the screen to the sirluc control are plotted in figure 2b with replicate  <dig> on the x and replicate  <dig> on the y axis. the data point and error bars represent the mean and standard deviation of three independent calculations, and in most cases the error bars are negligible. there is a good correlation between biological replicates . each control  is represented by  <dig> data points as there are three plates and four wells for each control per plate. data points of the same control cluster together, and negative and positive controls are well separated, consistent with the density plot in figure 2a. there are a total of  <dig> sirna samples, with diverse phenotypic dissimilarity ranging from  <dig>  to  <dig> .

three example perturbation with distinct phenotypes are shown in figure 2c . plk <dig> and copb <dig> are essential genes which cause viability defects similar to ubc when depleted by sirnas. cells treated with akap <dig> sirnas display a morphology phenotype whereby the cell shape is more round and actin signal is more evenly distributed over the whole cytoplasm. this phenotype is consistent with previous observations that akap <dig>  which encodes for a-kinase anchoring protein  <dig>  localizes to cortical actin cytoskeleton under the cell membrane and when mutated, spreads to the cytoplasm  <cit> .

in total,  <dig> sirna perturbations  showing high phenotypic dissimilarity to sirluc control  indicate morphological phenotypes. with the pair-wise phenotypic dissimilarity for the  <dig> sirna samples, we generated a network of phenotypes with nodes representing each phenotype and edges for phenotype dissimilarity between nodes as in figure  <dig> , as well as representative cell images. from network connectivity and visual inspection, we found three major groups of phenotypes. genes highlighted in green are essential genes, and cause viability defect when knocked down. within this group are genes plk <dig> and copb <dig>  but also other genes such as pkm <dig> and pmvk. genes highlighted in blue cause cell shape defect when depleted by sirna. cells are often elongated with thin stretches, suggesting defect in cell structure maintenance. genes highlighted in orange cause strong actin staining and also affect cell shape. genes in gray show intermediate phenotypes between the major groups. for example, sirac <dig> treated cells show both a slight viability defect and an elongated shape. further experiments to explain the underlying basis of these phenotypes are needed, however, in some cases previous functional characterizations support the observed phenotypes and their mechanism. for example, mrc <dig> was previously shown to be responsible for the turn-over of collagen  <cit>  and higher levels of collagen was associated with elongated cell shapes  <cit> . tesk <dig> was shown to be involved in actin cytoskeletal organization  <cit> . it should also be noted that the same morphology phenotype can be caused by unrelated mechanisms, nevertheless, grouping similar phenotypes may help identify and understand functionally related genes and their interactions.

gene clustering analysis with phenodissim
we then clustered genes by pair-wise phenotypic dissimilarity of the whole screening set to identify genes that perform potentially related functions. to this end, we averaged the two replicates and generated a 779× <dig> phenotypic dissimilarity matrix, with each row and each column representing an sirna treatment. then hierarchical clustering was performed based on the phenotypic dissimilarity matrix . the clustering tree was cut into  <dig> clusters, and each cluster analyzed for go term enrichment . the clusters are shown as colored bars, and the height of each bar indicates how many enriched go terms found in the corresponding cluster . there are a total of  <dig> enriched go terms identified, with clusters vary in the number of enriched go terms.

genes from the cluster with the highest number of enriched go terms  are shown in figure 4b, where nodes represent gene members and edges represent the gene-gene interaction identified in the string database  <cit> . the weight of each edge is proportional to interaction confidence.  <dig> of  <dig> genes were found to be connected in string. particularly, we noticed two functional groups, the mitogen-activated protein kinase  signaling pathway and the protein expressed in non-metastatic cells  family. the mapk pathway is involved in multiple cellular functions including proliferation, differentiation and migration  <cit> . eight members of the mapk pathway are found in this cluster, map3k <dig>  map3k <dig>  map3k <dig>  map3k <dig>  map4k <dig>  map4k <dig>  mapk <dig>  prkaca. these genes show phenotypic similarity among each other, and the associated go terms are enriched such as activation of jun kinase activity . the nme gene family was discovered as a metastasis suppressor  <cit> , and was later shown to be involved in cell proliferation and differentiation  <cit>  as well. five nme genes are present in this cluster and the associated go terms are enriched such as gtp biosynthetic process . grouping genes from the same pathway or family together validates the clustering analysis. additionally, the mapk pathway and the nme gene family are clustered together, which may suggest a functional link. this is supported by the previous finding that overexpression of nme represses mapk phosphorylation, and thus inhibits cell migration and metastasis  <cit> . in summary, our analysis has shown that clustering based on the phenodissim method has the potential to identify gene functional clusters.

discussion
the generation of phenotype-based perturbation networks based on cellular phenotyping is becoming a powerful approach in systems biology, functional genomics and drug discovery  <cit> . several approaches have been developed to quantify image-based readouts from image-based screening via segmentation and feature extraction  <cit> . however, translating multidimensional cell feature data into phenotypic information remains elusive and hinders the further application of image-based screening. previous studies have proposed multiple analysis methods with different dimension reduction and statistical learning algorithms  <cit> , but these methods often rely on human experts to provide biological knowledge, such as for feature selection and training data set annotation. these approaches also require the optimization of multiple parameters, which prevents an easy adaptation to other image-based screens with different setups.

we have developed here a new phenotypic dissimilarity measure, phenodissim, for image-based high-throughput screening. the proposed method can identify phenotypes by computing the dissimilarity between samples and controls, and determine phenotype-based gene networks by computing the dissimilarity between samples. with the proposed method, we have identified distinct phenotypes, and functionally related genes by cluster analysis. this method only requires the optimization of svm classification parameters cost and gamma, without knowing cell lines, fluorescent markers, treatment types or biological questions.

comparing the performance of phenodissim with previous methods is challenging due to the lack of gold standards and different scales of screening data sets. we have designed quality metrics to assess replicate reproducibility and separation of controls, which provide evaluation of the whole screen from different perspectives . as summarized in table  <dig>  the phenodissim method performs similarly or better on the benchmark data set compared with previous methods, in terms of replicate reproducibility, separation of controls and gene clustering quality. it should be noted that we have not extensively performed optimization for other methods, indicating that they could show a higher performance when fine tuned. in addition other data sets may behave differently for other analysis methods.

* mean ± standard deviation for three independent runs.

because phenodissim applies classification accuracy as a proxy for dissimilarity, the highest dissimilarity value is  <dig>  or 100% classification accuracy. thus phenodissim will not be able to quantify the differences between two phenotypes if both have 100% classification accuracy from the negative control. also when treatments generate similar phenotypes but different cellular subpopulation distribution, phenodissim might not be able to detect the distinctions. in these scenarios it will need to be combined with other methods. because svm classification needs to be performed between each pair of treatments, the proposed method is computationally more intensive than previous methods ). we have estimated that with the data set used in this study, every dissimilarity calculation takes about  <dig> seconds on a  <dig> ghz intel xeon cpu . the computation needed for each comparison will be affected by the number of features, the number of cells and the svm parameters when applied to other data sets.

diverse machine learning methods have been proposed for the analysis of image-based screens, which can be classified into generative model approaches, e.g. principle component analysis and factor analysis, versus discriminative model approaches, e.g. support vector machines; or supervised versus unsupervised approaches. the proposed phenodissim method is discriminative and unsupervised. depending on the biological question of the screening campaign, certain type of methods may be better fit than others. without a priori knowledge, phenodissim captures any phenotypes different from the negative controls as well as the dissimilarity between phenotypes. however, this method does not elucidate what are the phenotypes and what image-based features define the phenotypes.

CONCLUSIONS
the proposed phenodissim method needs minimum parameter optimization and is successfully applied in phenotype identification and clustering in the current kinome rnai screen. more and diverse image-based screening data sets need to be investigated to evaluate proposed analysis methods. to facilitate screen data analysis in general, we have developed an r package, available through the bioconductor project  <cit>  , which implements analysis methods and quality metrics used in this study. as a toolbox for phenotypic analysis in image-based screening, and quality control of screens and analysis methods, the phenodist package facilitates testing different analysis methods with various image-based screens, which will help develop accurate and effective data analysis methods, and promote further application of image-based screening.

