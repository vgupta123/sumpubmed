BACKGROUND
fundamental functions of living cells are controlled by regulatory relations between genes and proteins. most cell types respond to changes in their environment  by altering their transcriptional patterns. more than a decade ago, it became possible to measure snapshots of all transcript levels in a given tissue sample using microarray technology. since then, advances in technology have multiplied and the cost of experiments has decreased significantly. as a consequence, cell lines, animal models as well as clinical subjects in drug trials or in the general population  <cit>  have been characterized on a molecular level. one crucial problem in such studies is the detection of active key regulators; i.e. genes or proteins that causally affect expression of downstream genes or proteins in the study population.

the detection of regulators or regulatory networks from the primary data alone has been studied extensively. network reconstruction can be approached by identifying correlations in expressed genes  <cit> , using any number of methods including those based on information theory  <cit> , bayesian models  <cit>  and regression models  <cit> . however, all purely expression-based methods assume that the expression of regulators and targets are directly  correlated or at least not independent of each other. smet et al. showed that such models of high correlation between regulator and target don't match the actual situation captured in regulondb  <cit> . one of the possible explanations is that a regulator, even a transcription factor, itself is not necessarily co-expressed with its targets, especially when the regulatory relation of the regulator and the targets is complex  <cit>  or regulation acts beyond the transcriptional level, e.g. by phosphorylation. this suggests that in many cases the activity of regulator cannot be inferred from transcriptional data alone.

while methods to infer causal regulators directly from heterogeneous primary data types have been proposed and successfully validated in some cases  <cit> , these methods necessarily require very large sample sizes and a mix of different data types, e.g. genomic and transcriptomic data. even when such large data sets are available, the choice of which hypothesis to pursue in follow-up experiments might not be easy to make as such methods usually don't relate their conclusions back to already known biological facts.

in this paper we are interested in a method that suggests active regulators and corresponding perturbation experiments for a population based on expression data alone. with that goal in mind the above discussion suggests that investigating coherence between regulatee pairs rather than regulator-regulatee pairs might be more suitable for evaluating the activity of a given regulator. to associate regulatee coherence to a possibly only non-transcriptionally controlled regulator requires the use of prior knowledge.

our knowledge of molecular biology has increased dramatically over the past several decades as evidenced by the  <dig> million articles currently indexed by the national library of medicine  <cit> . this immense body of knowledge contains many experiments that define the response of a biological system to a stimulus, e.g. by altering its transcriptional state. these experiments can be translated into causal regulatory relationships. whenever the question of causal regulators is relevant , each experimentally validated finding constitutes a hypothesis that can be evaluated based on the data set at hand.

in contrast to many previous approaches, we rely on a very specific type of prior knowledge, namely relationships extracted from the literature that are  based on well-described laboratory experiments,  have a citation in the literature, and  establish a flow of causality; i.e. a directed flow of information form a well-defined perturbation experiment to observed molecular changes. consequently, our method does not rely on association but on established causation and should be well-suited to providing hypotheses about the causal regulators that are active in a given dataset. this specifically allows us to make statements about regulators that are not limited to activation by changes in transcript abundance, but can include changes in protein abundance or post-translational modifications.

prior biological knowledge has been used successfully in many contexts before. relevant functional terms, dysregulated pathways in diseases as well as active mirnas and transcription factors are routinely predicted based on so-called gene set analysis  methods and a number of statistical procedures have been proposed, e.g.  <cit> . however, virtually all such methods focus on differential gene expression between two conditions as opposed to coordinated changes in a subject population. the situation is similar for methods that utilize networks of prior information  <cit> . a class of methods that has been proposed to detect subnetworks co-expressed across a population  <cit>  is related in that it utilizes expression data across all conditions in conjunction with a network. however, such methods aim at finding coherence between expression correlation and distance in the network in general. our goal is to specifically assess whether a regulator is likely to be active based a given expression data set and consequently point the researcher to relevant perturbation experiments in the literature.

to this end, we introduce the correlation set analysis  method in the following, provide evidence that it performs well on simulated datasets, and apply it to three different disease settings: ovarian cancer  <cit> , metabolic disease  <cit> , and diffuse large b-cell lymphoma   <cit> .

methods
we identify regulators that are active under a given condition if  its known targets show  correlated transcriptional change. this method does not infer novel regulatory relationships, but rather selects from a library of experimentally defined relationships which regulators test as active in the population of interest. figure  <dig> provides an overview of csa. we elaborate on each step below.

constructing the causal network
the suggested method relies on a causal network to define regulators and regulatees and can only be as good as the encoded biological facts. the causal network consists of relationships that  are based on well-described laboratory experiments,  have a citation in the literature, and  most importantly, establish the flow of causality directed from a specific regulator to a specific regulatee. consequently, our method does not rely only on association, but on established causation. for example, consider the following statements extracted from two articles represented in the ingenuity  <cit>  data:

 <dig>  "binding of mouse fyn protein and mouse cnr <dig>  protein occurs in mouse brain." 

 <dig>  "blockade of cb <dig>  increases expression of hepatic lipase ." 

while statement  <dig> asserts a biologically correct binding event, it doesn't imply a directed flow of information and it is unclear what consequences the binding event has. in contrast, statement  <dig> describes a perturbation experiment that causally leads to observed changes. only statement  <dig> allows for a meaningful definition of regulator and regulatee. ultimately, the use of causal statements facilitates the interpretation of results and focuses the analysis on potential upstream drivers of the process under consideration.

regulators and regulatees can be of different molecular types and include transcript levels, protein levels, protein activities and phosphorylation states. for the purpose of this method, we restrict our causal network to transcript regulatees as this is consistent with the population measures analyzed. in contrast, regulators include transcript and protein levels as well as protein modifications and activities. for csa, we abstract these different forms into an undifferentiated node in the causal network based on their entrez identifier  <cit> .

it is important to note that the results of such transcriptional perturbation experiments do not necessarily capture direct physical relationships. in the example above, the increase in transcript levels of lipc is certainly mediated by a cascade of other signalling molecules. consequently, the csa method is not limited to transcription factors as regulators, but encompasses many other classes of molecules amenable to perturbation experiments.

to ensure the reliability of the data, we only include manually curated statements. the substrate for the causal network is licensed from two commercial sources, selventa inc.  <cit>  and ingenuity inc.  <cit>  and, after filtering and post-processing, reduces to  <dig>  regulators and  <dig>  regulatees. among  <dig>  regulators,  <dig>  are proteins or mrnas and  <dig>  are chemical compounds or environmental factors . as described above from this we selected the subset of proteins and mrna regulators. after removing self-regulation and regulators that only have one regulatee, the causal network reduces to  <dig>  regulators and  <dig>  regulatees. selventa inc. has recently launched an initiative to provide access to a significant amount of causal information to academic researchers through the bel-portal http://www.belportal.org. after performing similar pre-processing as we described above, the public causal network contains  <dig> regulators and  <dig>  regulatees.

scoring putative regulators
we assumed an active regulator under a given condition should activate or inhibit a subset of its regulatees. across a set of conditions , this relationship should become apparent in a coordinated change in expression levels for regulatees downstream of an active regulator. we used different scoring functions to identify active regulators.

mean scoring function
pearson's correlation coefficient is one of the most widely used measures to evaluate similarities of gene expression profiles. for an expression dataset with m samples, the co-expression level of any two genes x and y can be calculated by the correlation coefficient cor.

 cor=∑k=1m∑k=1m2∑k=1m <dig> 

, where x¯ and y¯ are sample means of gene x and gene y respectively.

to assess the expression coherence of regulatee sets, we employed the simple test of measuring all pair-wise correlations within each set. such a coherent regulatee set is consistent with the hypothesis that the corresponding regulator is active in the condition under consideration.

the causal network also specifies the type of regulation . consider two regulatees, x and y, that are under the control of a common regulator. if x and y are regulated coherently, we expect their transcriptional profiles to be correlated. conversely, if x is up-regulated and y is down-regulated, we expect their profiles to be anti-correlated. we examined the correlation coefficients between up-regulated regulatees and down-regulated regulatees to test this hypothesis. however, we did not observe significant differences between correlation coefficients of regulatees regulated in the same direction and regulatees regulated in the opposite direction. thus, we decided to use the absolute value of the correlation coefficient |cor| in the scoring functions.

one intuitive way of detecting regulators with highly coherent regulatee pairs is to examine the average of all absolute correlation coefficients between all pairs of regulatees xr for a regulator r.

 μr=2n∑i=1n-1∑j=i+1ncor 

here, n is the number of regulatees of the regulator r. μr is referred to as the mean scoring function in the rest of this paper.

ratio scoring function
if we expect that a substantial number of regulatees is affected by an active regulator, a test for a shift in mean pair-wise co-expression is sensible. however, we also investigated possible scenarios based on the biological data sets described in the results section. figure 2a shows an example distribution of absolute correlation coefficients between regulatees which has higher average absolute correlation coefficients in a real network than in a randomized network. in this case, the majority of regulatees have similar expression patterns, which supports the hypothesis that this regulator is active. in some cases we observed a small bump at the high absolute correlation tail , which indicates a small set of strongly co-expressed regulatees. this situation is more difficult to detect by examining the difference of average correlation coefficients. hence, we propose an alternate way to detect active regulators: scoring regulators according to the ratio of highly coherent regulatee pairs over all regulatee pairs .

 fr=2cn 

, where c is the number of regulatee pairs, for a specified regulator r having n targets, with absolute correlation coefficient greater than a cutoff. users can define biologically relevant pairs by setting the cutoff to levels appropriate to detect a desired effect size . in this paper, we fix the cutoff, c, at the 95th percentile of the distribution of all pair-wise correlations for a given dataset. this alternate score will identify small sets of highly coherent regulatees. the decision rule based on μr and fr is described in the next section.

assessing statistical significance
these scoring functions provide rank-ordered lists of all regulators in the causal network based on the coherence of their downstream regulatees, and indicate which ones may be active. while true signals will tend to lead to high scores, high scores in any given result may be due to random noise. we therefore evaluated the statistical significance of the scores, μr and fr of a regulator r, using a permutation test in two ways:

 <dig>  gene permutation randomly assigns transcript profiles to regulatees and, thus, compares the score of the regulator r to the distribution of scores attained by regulators with the same number of randomly chosen regulatees.

 <dig>  graph permutation generates a random causal network in which each regulator controls the same number of regulatees and each regulatee is controlled by the same number of regulators as in the original network. .

both permutation approaches assess the statistical significance of a score under the respective null hypothesis, and thus provide guidance to the biologist as to whether a particular regulator received a high score based on chance alone. note that the permutation of sample labels is not a meaningful option in the scenario of only one population when considering correlation though it is a preferred choice in many gene set analysis methods comparing two or more sample populations.

as the causal network contains more than one thousand potentially active regulators, the resulting p-values should be corrected for multiple testing. the false discovery rate  is an intuitive and well-accepted alternative measure of significance that is widely applied in similar applications. the benjamini and hochberg procedure was used to estimate the fdr based on the list of p-values  <cit> . finally, csa reports a results table of potentially active regulators  which contains fdr, scores , regulatees coherently up- or down-regulated by the regulator, non-coherently expressed regulatees, average correlation coefficient of regulator to regulatees, and the number of coherent regulatees. users can rank regulators by the scores , the number of coherent regulatees , or the average correlation coefficient of regulator to regulatees .

RESULTS
results on simulated data
to assess the sensitivity and specificity of csa, we generated simulated data sets with various characteristics. to retain a realistic scale for the data values, we derived our simulated data from the ovarian cancer dataset . the dataset was derived from  <dig> ovarian cancer patients in tcga  <cit> . to obtain a baseline dataset with no signal, we randomly permuted the sample labels for each gene vector separately. consequently, each gene vector retains its original distribution, but correlations between gene vectors are disrupted. we labelled n genes as active regulators in the simulated data. each induces expression profiles in p% of its regulatee pairs that have a pearson correlation coefficient of r. regulators and regulatees are defined according to the literature-based causal network described earlier. to evaluate csa with respect to many different signal-to-noise characteristics, we varied the percentage of correlated regulatee pairs p in 10% increments from 0% to 100%. similarly, we set the correlation coefficient r to { <dig> ,  <dig> ,  <dig> ,  <dig> }. details on the generation of dependent profiles can be found in the materials and methods section.

to test the robustness of the method to sample size, we generated additional datasets with a random subset of  <dig>   <dig>  and  <dig> patients. finally, we generated simulated sets based on n =  <dig> as well as n =  <dig> embedded active regulators. we found that the recovery of true positives was not affected by the number of embedded regulators. we therefore fixed the number of embedded regulators in the subsequent examples at n =  <dig> 

evaluation of permutation methods and controlling false positives
while the scoring functions are able to rank embedded active regulators higher than non-active ones, they do not provide an objective cutoff value when investigating the biological significance of top results. in order to assess the suitability of our procedures to control the fdr, figure 3a shows the false positive rate  of the two scoring functions with the two permutation methods on a representative simulated data set . our procedures are able to control the false positive rate effectively based on the estimated fdr while retaining a good true positive rate . in fact, when the data contains no or limited signal, csa does not report any potentially active regulators at reasonable fdr cutoffs . the same holds true for runs on randomized networks .

evaluation of scoring functions
to understand the characteristics of the ratio and mean scoring functions, we focused on four datasets which differed in the strength of correlation r and the quantity of correlated regulatees p, namely, low/low , low/high , high/low , high/high .

robustness to signal level and sample size
relevance of the causal network
to further illustrate the relevance of the underlying causal network to provide informative active regulators, we generated a randomized version of the causal network with the same degree distribution . running csa based on this randomized network against the simulated data and ovarian cancer data from tcga resulted in roc curves that were indistinguishable from random, indicating that the causal network is biologically informative .

comparison to degree-based ranking
finally, we compare csa's results to an alternative approach that has been suggested as a general principle in many approaches to transcriptional network reconstruction, namely the prediction of key regulators or biomarkers based on their degree in the inferred network  <cit> . here, we use the same representative simulation data set  as we used in the previous section. implementing a ranking strategy based on each candidate regulator's out-degree  gives an interesting baseline performance  that is clearly better than random. however, the roc curves suggest also that the results based on our method are superior to a purely degree-based method.

results on clinical data
to illustrate the utility of the csa approach we describe here the results of comparing the directed perturbation experiments captured in the causal network to  <dig> different surveys of expression variation in  <dig> distinct disease and tissue settings-subcutaneous adipose tissue  <cit> , ovarian cancer  <cit>  and diffuse large b cell lymphoma  <cit> .

experimental results i--adipose tissue
the first population dataset was subcutaneous adipose tissue from  <dig> individuals as described by emilsson et al.  <cit> , representing individuals from  <dig> generation families with a range of ages and degrees of obesity that was used to define loci affecting obesity in the icelandic population. after matching transcripts measured in the adipose cohort to the causal network, the csa method reported  <dig> of  <dig>   regulators as potentially active at an fdr <  <dig> . this corresponds to  <dig>  potential regulator:regulatee edges.

these data can be summarized by counting the number of csa significant regulatees for each regulator . amongst the top ranked regulators in adipose were some well-known metabolic targets, including pparg , ppara , insulin  and ppargc1a . the top hit as judged by the size of significant regulatees was myc  which has been implicated in adipogenesis  <cit> . it is interesting to note that the well-known transcription factor, myc, was not co-expressed with its regulatees in the adipose tissue dataset , but a subset of its regulatees were coherently expressed. this observation supported our hypothesis. an additional top hit was, nfe2l <dig> , a master regulator of anti-oxidant response that has been implicated in many disease processes and in adipogenesis and obesity specifically  <cit> .

adipose tissue is composed of adipocytes and a stromal fraction including macrophages. given this knowledge, we asked if csa provided evidence for these sub-populations of cells. perilipin  is a protein uniquely expressed in adipocytes  where it coats the surface of intracellular lipid droplets and protects them from degradation by lipases. csa identifies  <dig> plin <dig> regulatees as cohesive in adipose tissue consistent with it being a significant regulator in human adipose tissue. a major conclusion of the adipose tissue study used here was that macrophages, as observed by macrophage-specific transcripts, are identified as causal drivers of obesity in humans  <cit>  and mouse  <cit> . consistent with this csa finds a number of macrophage specific genes as active drivers including the chemokine receptor ccr <dig> . one of the ligands of ccr <dig>  rantes is reported to be secreted by adipocytes and recruits macrophages to fat depots  <cit> . ccr <dig> appears as both a target of other regulators and as a regulator of downstream transcripts as judged by csa . furthermore the regulators of ccr <dig> were also found to be connected to each other consistent with a web of regulatory interactions affecting ccr <dig> and its downstream targets in macrophages in human adipose tissue.

given the relative ease of experimentation, it is not surprising that many experiments reported in the literature were performed in cultured cell models. in this setting there is always a question of the relevance of the results to human populations. csa potentially provides a data-driven way to assess this by testing whether any perturbation signature  is significantly cohesive in a disease population. interestingly, csa identified many cell culture derived signatures as being relevant to the subcutaneous adipose tissue of humans . this included, for example,  <dig> of  <dig> regulatees for the classic adipose regulator pparg and  <dig> of  <dig> insulin regulatees.

experimental results ii--serous ovarian cancer
the csa method was also assessed against a collection of expression profiles from almost  <dig> human serous ovarian cancers available through tcga project  <cit> . after matching transcripts measured in the ovarian cohort with the causal network, it was found that  <dig> of  <dig>   regulators had an fdr <  <dig>  in the csa analysis . this identifies  <dig>  potential regulator:regulatee edges as active in this cohort.

as before, the potential regulators can be ranked by the number of regulatees that pass the cutoff. top ranked regulators include genes implicated in many cancers  such as tgfb <dig> , ifng , fgf <dig> , mycn  and vegfa . again, we observed that another well-known transcription factor, mycn, was weakly correlated with its regulatees , but it had a subset of coherent regulatees and were identified by csa as active in ovarian cancer dataset. csa also identifies numerous potential drivers of various cyclins which are known to drive the cell cycle and be aberrantly regulated in cancer . among  <dig> regulators that regulate cyclins in the causal network, csa identified  <dig> as active in the serous ovarian cancer. as with the ccr <dig> example extensive cross-regulation of cyclin regulators was predicted, suggesting the presence of a complex network of causal interactions upstream of cyclins in ovarian cancers revealed by csa. the derivation of the higher-order structure is non-obvious given the literature examples alone, but readily emerges from the csa analysis as relevant in this context. using the ranking by the number of edges testing significant in csa, tnf was found to have  <dig> regulatees  and  <dig> regulators  in this cohort. high levels of secreted tnf protein  were reported to cause high levels of the proteins il <dig>  mif, ccl <dig>  cxcl <dig>  vegfa, also secreted in ovarian cancer cell lines  <cit> . intriguingly, these genes in the csa analysis of the ovarian cancer cohort were also found to have many regulatees  and/or regulators , and directly and reciprocally regulate each other . as reported by kulbe et al.  <cit> , knockdown of tnf in cells with high tnf results in failure to form tumors in mice. the interpretation of such established cell line models of cancer can be difficult. the csa analysis however indicates that the basic regulatory findings of this work were replicated by csa and found to be the most dominant feature in approximately  <dig> ovarian clinical cancer samples. together, these findings may identify a critical driver of ovarian tumor growth in vivo.

experimental results iii--dlbcl
the final example is a study of diffuse large b-cell lymphoma  in which expression profiles of  <dig> patient populations who subsequently received different treatments were examined for signatures that predict the clinical course of the disease  <cit> . for the purposes of this analysis the subsequent treatments are not relevant. the first cohort  included  <dig> samples and the second cohort  included  <dig> samples. as described in  <cit> ,  <dig> signatures were derived in a multivariate analysis that predict survival in the  <dig> cohorts. the germinal center b-cell signatures contained  <dig> genes, the stromal- <dig> signature contained  <dig> genes and the stromal- <dig> signature contained  <dig> genes. csa analysis was applied to each of the cohorts and potentially active regulators identified that pass the fdr cut-off . using these significant hits we then asked if any of the regulators regulated genes involved in the  <dig> predictive signatures . interestingly, although the stromal- <dig>  and - <dig> signatures were found by a multivariate analysis, suggesting they are independent, csa analysis identifies genes that can regulate both signatures jointly. among the  <dig> regulators that regulate at least one gene in either the stromal- <dig> or - <dig> signatures,  <dig>  regulate genes in both cohorts. furthermore, we calculated the significance of the enrichment of each regulator's regulatees for overlap with the  <dig> predictive signatures by fisher's exact test. significant enrichments for the two stromal signatures were found . figure  <dig> shows the regulators enriched for stromal- <dig> and - <dig> signatures in the chop and r-chop cohorts and their target genes in all three signatures.  <dig> regulators were found enriched for stromal- <dig> signature in both cohorts. surprisingly, all of these  <dig> regulators are also enriched for stromal- <dig> signature, indicating that it is possible the  <dig> signatures arise because of the same regulator.

anumber of cohesive regulatees.

b, c, dthe enrichment p-values of germinal center b cell, stromal- <dig> and stromal- <dig> signatures in chop and r-chop groups.

the candidate regulators can be ranked by the number of predictive signature genes they regulate . this results in the identification of some very familiar drivers of many cancers including myc, mycn and ccnd <dig> .

results on clinical data with the public causal network
selventa inc. has recently launched an initiative to provide access to a significant amount of causal information to academic researchers. we performed csa on the ovarian cancer dataset with the public causal network released by selventa inc. the result suggested that  <dig> of  <dig> regulators reported by csa  with the public causal network were found in our previous result . compared with  <dig> causal regulators identified by using the complete causal network, csa can recover about 1/ <dig> of the regulators in the ovarian cancer dataset. the results suggested that csa works well with the public causal network although it does not report as many causal regulators as with the complete causal network.

CONCLUSIONS
the advent of inexpensive high-throughput transcriptomics measurement techniques has enabled the characterization of cell lines, animal models, and, more recently, cohorts of clinical patients on a molecular level. a crucial research question in such studies  is the identification of causal regulators of the observed transcript changes. in this study, we sought to develop a method, correlation set analysis , to identify directed perturbation experiments relevant to a disease population of interest in an unbiased data-driven manner. the method relies on the hypothesis that regulatees of a regulator active in a population will be significantly correlated to each other across the population. as described the csa method was developed and evaluated on simulated data where it found to be quite sensitive in identifying known regulator effects.

to test the method and illustrate its uses, we present the results of csa analysis in three disease settings, where in each case known key regulators and as yet un-described regulators were found. in the regulatory networks of ccr <dig> in adipose tissue and cyclins in serous ovarian cancer, we observed that upstream regulators of ccr <dig> and cyclins not only regulated ccr <dig> and cyclins but also regulated each other. also in the dlbcl dataset, we found that of  <dig> regulators enriched for stromal- <dig> signature in both chop and rchop cohorts were also enriched for stromal- <dig> signature. this finding implies that stromal- <dig> and - <dig> signatures are actually regulated by the same regulators. these examples indicate that csa is able to bring together isolated regulatory relationships into higher order regulatory networks, and thereby adding new knowledge and insights.

based on this we propose that csa has four key advantages. firstly, it provides a simple data driven way to connect population data with the many directed perturbation experiments reported in the literature. secondly, csa identifies plausible changes in regulators at the protein level, since we do not require correlation between regulator and regulatees. a third advantage of this approach is that the results can be simply ranked providing the user with an intuitive way to prioritize any follow up investigation. finally, the regulatory relationships inferred by csa were found in all cases to form a contiguous network, with many cases of regulators that were also regulatees of upstream regulators. in other words csa provides a glimpse of the true underlying higher order structure of biological systems which can be systematically tested for causal effects on disease progression.

in addition to the advantages it is worthwhile noting that there are some limitations to csa that stem from its reliance on the literature-derived causal network. clearly, the relationships identified are limited to the causal network used. with the continued expansion of our understanding of regulatory relations, the accuracy of csa should improve with time. another possible limitation is in cases where overlapping sets of regulatees are controlled by distinct regulators. in this case, csa will not be able to distinguish between the regulators resulting in an increased false positive rate. one possible solution for this problem is to cluster regulators by the similarity of their respective regulatee sets. in our experience, however, the overlap between regulatee sets is still sufficiently small to allow for meaningful inference. this is supported by the excellent performance of csa on simulated data.

as we mentioned before, the causal network in its original form contains not only genes and proteins, but also chemical compounds and environmental factors. since our approach does not restrict regulators to genes on the microarray, such entities can appear as candidate regulators, though we did not report them in this work. hypotheses based on compounds might be useful for assessing environmental factors driving disease progression or for supporting drug repositioning efforts.

in the future we plan to apply the csa method to large scale compendia of gene expression sets to understand patterns of active regulation across a span of phenotypes. given the promising performance of csa when recovering embedded regulators as well as providing insights for biological datasets, we believe that it will greatly enhance our understanding of general and specific mechanisms driving disease and other relevant phenotypes.

materials and methods
generating simulated data
in order to make simulated data follow the distribution of the real data, we generate the simulated data based on the ovarian cancer data used in this study by applying the cholesky decomposition method of iman and conover  <cit> . this approach is widely used to generate correlated random variables in finance. first, we randomly permute sample labels of a gene and repeat this step for all genes. hence, the mean and standard deviation of each gene vector are invariant under permutation. the correlation between genes, however, is disrupted. then, we randomly pick n regulators as test set of regulators. each test regulator rp can regulate a set of regulatees t = {t <dig> ..tq}, t is an n × m matrix, where n is the number of regulatees and m is the number of samples . we want to generate a set of new regulatees ts=t1s…tqswith same mean and variance as the original set of regulatees but correlate with each other at a desired correlation coefficient ρ. an n × n covariance matrix ∑ s with desired correlation coefficient ρ is created. the ∑ must be symmetric and positive-semidefinite. therefore, it can be rewritten as ∑ = ll' by cholesky decomposition, where l is the lower triangular matrix of ∑ with positive diagonal entries. we can get "spike-in" regulatee matrix ts with desired correlation coefficients ρ by postmultiplies t by l. iterate above steps until all regulatees of the test regulators are modified to be correlated with correlation coefficient ρ.

experimental data
expression datasets of adipose tissue and dlbcl are downloaded from the gene expression omnibus  <cit> . adipose tissue samples from  <dig> individuals  with a range of age from  <dig> to  <dig> and average bmi nearly  <dig> were used in this study. pretreatment tumor samples from  <dig> and  <dig> dlbcl patients  were used in this study. tcga  <cit>  provides mrna measurements of serous ovarian cancer tissue using  <dig> array platforms: an agilent array, and affymetrix's u133a and exon arrays. where genes are overlapping among the  <dig> platforms, we would like to combine the values into a consensus gene. here, we follow an approach originally described by verhaak et al.  <cit> . in short, the consensus gene is estimated using a standard factor model based approach:

 x^=-1y)t 

where β^and Ψ^are the platform specific coefficients and error covariance estimates, respectively, y is the 3-by-m dimensional gene expression values across the  <dig> platforms, and x^is the m-dimensional, unified estimate for a single gene. for complete details, see verhaak, et al.  <cit> . in those cases where only  <dig> genes are shared across the  <dig> platforms, we take the mean value.

for all of the  <dig> datasets, we used lsimpute to impute missing values in the expression profiles  <cit> . we discarded genes that are not included in our causal network and leave  <dig> ,  <dig>  and  <dig>  genes in adipose tissue dataset, dlbcl dataset and ovarian cancer dataset respectively.

performance metrics
the receiver operating characteristic  curves are used to evaluate the performance of csa. the true positive rate and false positive rate used for plotting roc curves are calculated as following:

 true positive rate=true positivestrue positives+false negatives 

 false positive rate=false positivesfalse positives+true negatives 

graph permutation
the corresponding permutation scheme  is more complex and also computationally more intensive. in each permutation, we evaluate sr on a random graph with the same degree distribution as our causal network. randomizing a directed graph with a given degree sequence is an active field of research and we adopt a method from  <cit>  relying on edge switching.

more precisely, at every iteration we pick two edges, say  and , uniformly at random from the set of edges e in the current graph, and replace them with the edges  and . this operation is known as an edge switch, and preserves the in- and out-degree distribution of the graph. if the resulting graph remains simple  and weakly connected, it replaces the current graph. in order to save the computationally expensive connectivity checks, a batch of k edge switches can be performed before a connectivity check. if the check succeeds, k can be increased, while if it fails, k can be decreased. the particular adaptive algorithm we use to update k is described in  <cit> . we also adopt the commonly used rule of thumb  <cit>  for the total number of edge switches to perform before declaring our graph to be sufficiently randomized, which is to perform an average of  <dig> edge switches per edge of the initial graph. both permutation approaches assert the statistical significance of a score sr under the respective null hypothesis, and thus provide guidance to the biologists as to whether a particular regulator received a high score based on chance alone.

abbreviations
csa: correlation set analysis; fdr: false discovery rate; tcga: the cancer genome atlas; dlbcl: diffuse large b-cell lymphoma; roc: receiver-operator characteristic.

competing interests
the authors declare that they have no competing interests.

authors' contributions
clh and dz designed the research and developed the method. clh implemented and tested the method. dz, clh and jl drafted the manuscript. jl interpreted the results of experimental datasets. lc performed graph permutation and helped in the writing of the manuscript. jg carried out the integration of expression data of ovarian cancer and helped in the writing of the materials section. jk provided suggestions for the statistical assessments. cd provided initial guidance. dz, jl, lc and cd edited the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
figure s <dig> effects of permutation on ranking regulators. roc curves show that fdr calculated based on permutation can improve both sensitivity and specificity. graph permutation is used here. permutation and fdr correction can decrease false positives by filtering out regulators that have high scores but only regulate a small number of regulatees since a regulator can easily obtain a high score by chance if it only regulates a few regulatees. similarly, permutation and fdr correction can increase true positives by recruiting regulators that have fair scores but can regulate a large number of regulatees.

click here for file

 additional file 2
figure s <dig> comparison of graph permutation and gene permutation on two representative simulation data sets.  simulation data set .  simulation data set . scoring function "ratio" is used in both cases. both permutation methods can reach good sensitivity and specificity. however, graph permutation reaches slightly better specificity in most cases.

click here for file

 additional file 3
table s <dig> active regulators found in the adipose tissue.

click here for file

 additional file 4
table s <dig> active regulators found in the serous ovarian cancer.

click here for file

 additional file 5
table s <dig> active regulators found in the dlbcl.

click here for file

 additional file 6
table s <dig> active regulators found in the serous ovarian cancer when using data from selventa's bel portal.

click here for file

 acknowledgements
we acknowledge the tcga program for collecting samples, data processing, and making data available. we thank zhenjun hu of the visant team for comments and network visualizations supports. we also thank ami khandeshi for help with testing the causal data from selventa inc's bel portal. this project was partially supported by grants from the national center for research resources  and the national institute of general medical sciences  from the national institutes of health.
