BACKGROUND
two-component systems  are abundant and modular signalling pathways predominantly found in prokaryotes. the simplest and most common tcss consist of two proteins, a histidine kinase , and a response regulator . hks are typically sensory proteins that contain a conserved transmitter 'domain' . transmitter 'domains' are composed of an hatpase domain wherein resides kinase activity, and a his-containing 'phosphotransfer' domain . it should be noted that as they are a combination of two domains, the functional transmitter unit is not strictly a domain itself. however 'transmitter domain' is a term used commonly in the literature and we adopt that convention here also, as the transmitter represents a fundamental functional unit for both mechanistic and bioinformatic considerations. upon stimulus perception the transmitter domain autophosphorylates on a conserved histidine residue within the phosphotransfer sub-domain. the phosphoryl group is than transferred onto a conserved aspartate residue in the receiver domain  of the partner rr. phosphorylation of the rr causes a switch in its behaviour  which leads to a cellular response to the initial stimulus. for an up-to-date series of reviews of tcs function, see bourret and silversmith  <cit>  and associated articles.

most prokaryotes possess multiple tcss, for example escherichia coli possesses  <dig> tcs genes, while bacillus subtilis has  <dig>  <cit> . as all hks and rrs are homologous, there exists the potential for any hk to signal to any rr. in reality this does not seem to happen, with most hk-rr interactions being highly specific  <cit> , however identifying tcs protein partnerships from genome sequences  remains a non-trivial task, despite significant computational advances in this area  <cit> .

luckily for researchers, in many cases the genes encoding a hk-rr pair are found adjacent in the genome, usually within a single operon . this arrangement allows for the coordinated expression of the two tcs genes and can provide robustness to the signalling pathway  <cit> . when tcs function requires additional proteins, the cognate genes are also sometimes found in an operon with the tcs genes. for example, chemotaxis operons usually contain several genes that are either required for, or modulate signalling by the che tcs, in addition to the che tcs genes themselves  <cit> .

thus contextual information regarding tcs gene organisation can be very important, providing clues regarding signalling pathway structure , and tcs function. however, straightforward analysis is confounded because of the expandable and modular nature of tcss. a common example of an expanded tcs is the phosphorelay, wherein phosphoryl groups are successively transferred between his-asp-his-asp amino acid residues. these residues are found in successive t-r-p-r domains, which are typically encoded by two or more proteins . the second phosphorylatable histidine residue of a phosphorelay can be found in proteins that contain solely an isolated p domain, and such proteins are referred to here as phosphotransfer proteins . examples are also commonplace where 'accessory' receiver domains do not regulate effector activity directly, but rather modulate signal transduction . thus tcs pathway structure is often more elaborate than the basic two-component paradigm, and in such cases pathway structure cannot usually be inferred from tcs gene structure.

a further complication regards the genetic organisation of a tcs. while many tcss are encoded as a pair of genes, often the two genes have apparently fused, encoding a 'hybrid kinase' which contains both r and t domains  <cit> . more complex domain architectures within tcs proteins are also common and indeed some tcs loci can be exceedingly complex. for instance, in the genome of myxococcus xanthus, there are four tcs gene loci that each encode contiguous proteins containing at least two t/p domains and at least two r domains  <cit> . in such cases correlating genetic/domain organisation with signalling pathway structure often requires a tour de force in molecular analysis  <cit> .

clearly it does not necessarily make sense to describe tcss purely in terms of the numbers of genes involved, as each gene may contain one or more tcs domains. similarly only describing the domain organisation of a tcs and ignoring its genetic structure impoverishes understanding of that tcs. ideally descriptions of tcss would encompass both gene and domain organisation, and this largely happens in the published literature. however there is still no systematic nomenclature for describing tcss  <cit> , let alone a common categorisation system. this has led to differing classification criteria in public resources such as mist  <cit> , p2cs  <cit> , and michael galperin's census of prokaryotic rrs  <cit> , and diverse standards of description in annotated genome sequences  <cit> . this diversity of tcs descriptors employed, necessarily confounds inter-genome and inter-database analyses.

ideally a categorisation scheme could be devised, which would encompass genetic and/or domain organisation as appropriate. such categorisation would also facilitate the creation of a series of metrics allowing for meaningful inter-genomic comparisons  <cit> . at the moment the most commonly used metric for tcs genes is the straightforward quantity, the 'number of tcs genes per organism', but more advanced metrics such as iq and extro/introvertedness have been proposed  <cit> , based respectively on the number of signal transduction genes, and the proportion of sensory proteins containing transmembrane helices . tcs genome metrics might valuably capture information regarding location and organisation, but would ideally do so at both gene and domain levels. new metrics could also provide mechanistic insights, as tcs gene/domain organisation appears intimately linked to mechanism .

in this work we investigate the genetic and domain organisation of the tcs genes from completely sequenced genomes, and use the resulting information to develop a categorisation scheme for tcs genes. we also propose and evaluate a set of possibilities for new genome metrics, which capture diverse aspects of tcs organisation.

methods
genomic organisation of tcs genes
data including the identity, features and replicon position of all the tcs genes from complete prokaryotic genomes  were obtained from the original release of p2cs  <cit> . the location of each tcs gene was given as start and stop nucleotide positions, and the strand  on which the gene was encoded. this allowed the trivial calculation of the distance between consecutive tcs genes , and whether any two consecutive tcs genes were encoded on the same strand  or not . for the analyses presented here, tcs genes classified by p2cs as 'incomplete hks' were treated alongside other hks, while 'mispredicted tcs proteins'  <cit>  were excluded from analysis. tcs genes were thus either hks , rrs, or pps in this work .

domain architecture of tcs proteins
the domain architecture of each tcs protein was also obtained from the p2cs database. a list of phosphotransfer signalling domains was manually compiled and used to define phosphotransfer signalling domains within each tcs protein - other domains were ignored. tcs domains were divided into three sets: hatpase , receiver  and phosphotransfer . a transmitter domain  was defined as an hatpase domain, with an adjacent phosphotransfer domain . isolated h domains were excluded from further analysis, including  <dig> genes which contained just a single h domain. all analyses were performed using custom biopython scripts  <cit>  and the resulting dataset was manually curated .

RESULTS
the relative location of tcs genes
initially, the positions of each tcs gene within all genomes were considered, and the relative locations of each tcs gene were defined . within each replicon, the distances between consecutive tcs genes were determined and whether each pair of consecutive tcs genes was encoded in cis , or in trans .

tcs inter-gene distances were ranked in order of increasing distance, and plotted against inter-gene distance . the resulting curve for cis-intervals showed two pseudo-linear regimes. large numbers of distances were ~ <dig> bp , while for distances larger than ~ <dig> bp, distances increased linearly with rank. the plot for trans-intervals only exhibited the linear regime of increasing rank with increasing distance. this regime started at a similar distance  to that of the cis-intervals, and with a similar gradient . across all gene separations, the number of cis-intervals  was nearly double that of trans-intervals , with the cis:trans ratio increasing further at smaller distances . this is easily explained, as many tcs genes are found encoded in tandem gene pairs  <cit> . additionally, around a quarter of cis-intervals  were less than  <dig> bp, suggesting those gene pairs were overlapping - another well-documented phenomenon in tcs genes  <cit> , and in prokaryotic genomes more generally  <cit> .

juxtapositioning of tcs genes - defining a cut-off
for both cis-intervals and trans-intervals, at larger distances there appears to be a linear relationship between rank and distance , implying that in this regime there is an even  relationship between the relative position of tcs genes. however at smaller distances, the number of tcs genes increased exponentially with decreasing distance, implying non-random juxtapositioning of tcs genes. the end of the pseudo-linear regime lies at distances of ~ <dig> bp for both types of intervals, implying that if two tcs genes are less than  <dig> bp apart, then they function together, whereas if further than  <dig> bp apart, then their juxtaposition will normally have occurred by chance.  <dig> bp therefore seems an appropriate cut-off value to define whether tcs genes are co-located for functional reasons, or purely by chance. extrapolation of the linear 'random' regime implies that imposing a  <dig> bp cut-off would result in a false positive rate of < <dig> % for an average genome - i.e. two tcs genes that are found by chance within  <dig> bp of each other but are not signalling partners, would be misinterpreted as paired in under  <dig> % of cases.

an orphan is defined as a tcs gene that is not adjacent to another tcs gene. by undertaking a count of orphan tcs genes as a function of cut-off distance, it was found that the number of apparent orphans decayed linearly with distance if a cut-off of > <dig> bp was used, however exponentially increasing numbers of orphans were identified as the cut-off distance was decreased below  <dig> bp.. extrapolation from large cut-off behaviour, implies that using a  <dig> bp cut-off might reduce the apparent size of clusters, but only in < <dig> % of cases.

tcs gene clusters and foci
tcs genes from  <dig> replicons  were grouped into gene clusters, with a cluster defined as a set of contiguous tcs genes, none of which are separated by > <dig> bp. cluster size  was recorded, with orphans having a cluster size of  <dig>  the number and order of all tcs genes found in each cluster was also captured. across all replicons tested, there were  <dig>  orphans,  <dig>  paired tcs genes,  <dig>  genes in clusters of size three , and  <dig> genes in clusters of size four  - see additional file  <dig> 

functionally inter-dependent tcs proteins are found to be encoded in trans very rarely, and the juxtapositioning of tcs genes in trans is far less frequent than juxtapositioning in cis . the effect of ignoring the adjacency of tcs genes in trans was investigated by defining a tcs gene 'focus' as a series of tcs genes, none of which are separated by > <dig> bp, and all of which are encoded on the same strand . as can be seen in table  <dig>  the numbers of genes encoded in pairs changed little when considering foci rather than clusters , although with a slight increase in the number of orphans , and a decrease in the number of triads and tetrads , as would be expected. the overall ratio of genes encoded as orphans, pairs, triads or tetrads varied little whether considering clusters or foci . all following analyses were therefore undertaken on tcs gene foci rather than gene clusters.

genes are categorised into clusters of foci of size  <dig> ,  <dig> ,  <dig>  and  <dig> . see text for details. ratios were calculated relative to the number of genes in pairs .

tcs gene organisation
the domain composition of each tcs gene focus was then elucidated as described in materials and methods. after removal of genes encoding hatpase domains without phosphotransfer domains and manual curation of genes apparently mis-classified by p2cs, a dataset was obtained containing  <dig>  genes, distributed over  <dig>  gene foci . genes were classified as hks , rrs and pps.

hk and rr genes are 'evenly' distributed
across all genomes interrogated, orphan tcs genes  were almost as likely to be hks as rrs , see table  <dig>  with the remainder being pps . of tcs gene pair foci , the vast majority  contained a single hk and a single rr.  <dig> % of triads  contained both hk and rr genes, with a slight preponderance  towards those containing two rr and one hk gene. as tcs genes in our analysis were classified as either hks, rrs or pps,  <dig> different tetrad geometries/organisations were possible . however two of the possible geometries accounted for  <dig> % of all observed tetrads. those two geometries each contained two rr and two hk genes, in an alternating order . when all tetrads comprising two hk and two rr genes were considered, irrespective of order, they accounted for  <dig> % of all tetrads, with no other single tetrad geometry accounting for more than  <dig> % of the total . it therefore seems that in many ways , there is a 'constancy' regarding hk and rr gene distribution - i.e. for every rr there is a hk  - thus at the genetic level the basic unit of a tcs is apparently a hk-rr gene pair. this of course correlates with the mode of action of the typical tcs - the direct transfer of phosphoryl groups between paired hk and rr proteins.

phosphotransfer protein genes
consistent with this observation, across all genomes, rrs and hks exhibit a remarkably similar distribution of gene organisations . however, the distribution was found to be very different for pps, with nearly two-thirds  found as orphans, and only  <dig> % in gene pairs . thus pps appear to exhibit less 'constancy' than hks or rrs, being more likely to be found as orphans, and with a reduced frequency of being found in a partnership. when they were found in a pair, the partner gene was a rr in the majority of cases . it could be argued that at the genetic level, if there is a functional unit involving pp genes, it is a rr-pp unit. this proposition also seems obvious, as pp genes are predominantly found within hk-rr-pp-rr phosphorelays, which are typical hk-rr tcss expanded by the inclusion of an rr-pp unit.

the presence of pp genes was also restricted to a small set of possible triad and tetrad geometries.  <dig> pp genes were found in triads, and of those,  <dig>  were found alongside one rr and one hk gene. of the five pp genes found in tetrads, only one was found in a hk > rr > rr > pp > focus  reminiscent of a phosphorelay, while the remaining four were found in foci with the geometry hk > rr > pp > hk >, suggesting the encoding of a signalling pathway structure more complex than that of a standard phosphorelay.

plasmid-encoded tcs genes
as plasmids are relatively mobile/dispensible genetic elements, the properties of plasmid-encoded tcs genes  were compared to those of the whole genomic dataset . most plasmids  encoded no tcs genes, however on average there were  <dig>  tcs genes per plasmid across all genomes. twenty plasmids encoded at least  <dig> tcs genes each, and  <dig> of those came from alphaproteobacterial or betaproteobacterial hosts - groups composed largely of symbiotes and parasites of metazoans.

the chi-squared test was employed to compare the observed numbers of plasmid-encoded orphans, pairs, triads and tetrads, with those expected from whole dataset distributions. it was found that the distribution of plasmid encoded tcs genes was significantly different from that of the whole genomic dataset . specifically, there were more orphans than expected , and fewer paired genes , with little difference for triads and tetrads . however despite these differences, the composition of the 'orphan' and 'paired gene' classes of plasmids were virtually identical to those of the whole genomic dataset . therefore despite the relative mobility of plasmids, they tend to contain fewer paired gene systems, instead encoding a greater proportion of tcs genes as orphans.

phylogenetic aspects of tcs gene organisation
 <dig> replicons encoded more than  <dig> tcs genes each . of those replicons, tetrads accounted for at most  <dig> % of the tcs complement , while nearly half  of the replicons had no tetrads. tetrads were particularly enriched in the alpha-, beta-, and delta- proteobacteria . triads were found to comprise up to  <dig> % of one replicon , and again triads were particularly common in the chromosomes of the alpha-, beta-, and delta- proteobacteria . only  <dig> of the  <dig> replicons had no triads,  <dig> of which were from firmicutes. conversely, paired genes were most common in the firmicutes , with the percentage of tcs genes found in pairs ranging from  <dig> %  to  <dig> .5% . a similar range was found in the percentage of tcs genes found as orphans, which varied reciprocally with the percentage of paired genes. the percentage of orphan tcs genes ranged from  <dig> %  to  <dig> % . as expected, it seems there is a significant phylogenetic dimension to the organisation of tcs genes.

tcs domain organisation
as noted above, the distribution and numbers of rr and hk genes in replicons are very similar. however across all prokaryotic genomes, there are around four receiver domains for every three transmitter domains  <cit> . the reason for this apparent discrepancy is that a large proportion of hk genes  encode proteins with a receiver domain in addition to transmitter domains - such proteins are usually described as hybrid kinases. therefore to truly understand/explain the organisation of tcs genes, it is necessary to take into account the various combinations of domains found within tcs genes.

phosphotransfer signalling domains within each tcs gene were identified and classified as either transmitter , receiver , or phosphotransfer domains , see materials and methods for details. this allowed each tcs gene and focus to be defined as a string of 'r', 't', 'p' and '-'s, where '-' denotes a junction between genes. inspection of the resulting manually-curated dataset  confirmed that receiver domains are significantly more numerous than transmitter domains, both of which outnumber phosphotransfer domain by around an order of magnitude .

domain organisations within tcs proteins
initially the nature of domain architectures and their frequency within the tcs gene population was investigated . on average, tcs genes each possess  <dig>  tcs domains . the majority  of tcs genes encoded single tcs domains, with receiver domain-only proteins  more frequent than transmitter domain-only proteins  and with a relatively small number of phosphotransfer proteins . a small proportion  of rrs possessed multiple receiver domains , generally two , but three in  <dig> cases. non-hybrid hks rarely possessed multiple transmitter domains , however the proportion of proteins with two transmitter domains was significantly enriched in hybrid kinases . no proteins were found to contain more than two transmitter domains. hybrid kinases were also enriched for multiple receiver domains , with  <dig> of  <dig> hybrid kinases possessing  <dig> or more receiver domains. of hks possessing a single transmitter domain, the majority encoded no receiver domains , however virtually all hks with two transmitters possessed receiver domains , presumably to somehow modulate/integrate signalling between the two transmitters.

 <dig> % of two-domain proteins contained paired receiver and transmitter domains, with a further  <dig> % comprising two receiver domains. two organisations were also particularly common in proteins comprising three tcs domains -  <dig> proteins  had one of each domain type , while  <dig> proteins  possessed two receiver and single transmitter domains. three combinations of domains  accounted for 93% of proteins possessing four domains -  <dig> proteins were trrp ,  <dig> were trrr , while  <dig> were trpp . proteins possessing more than four tcs domains tended to comprise multiple hpt domains upstream of a tr unit . the only protein encoding  <dig> tcs domains, was rrtrrprtr, being mmc1_ <dig> from magnetococcus sp. mc- <dig>  a magnetotactic proteobacterium  <cit> .

proteins containing a phosphotransfer domain either possessed no other tcs domains , or tended to also possess both transmitter and receiver domains , presumably forming parts of phosphorelays . of the  <dig> p-containing proteins which also had receiver and/or transmitter domains,  <dig>  had domain complements  of either trrp , trp , or pr , which are likely members of typical phosphorelays  <cit> . intriguingly, trp proteins were predominantly orphans, only  <dig> %  were encoded adjacent to a single response regulator, which would be required for the focus to encode an intact phosphorelay. conversely,  <dig> % of trrp proteins  were encoded next to single rr genes, suggesting that a large proportion of trrp proteins may not encode an intact phosphorelay by themselves.

domain organisation of tcs gene foci
the domain architectures of entire tcs gene foci were then categorised, as described in materials and methods . nearly half the tcs gene foci  encoded a single tcs domain , and of those the majority comprised a single receiver domain . such proteins were nearly twice as numerous as genes encoding a single transmitter domain , with single phosphotransfer genes being relatively rare . a similar number of foci encoded two tcs domains . the majority of two-domain foci  consisted of two genes,  <dig> % of which comprised a classic hk-rr pair. of the  <dig>  orphan gene, two-domain foci,  <dig>   were hybrid kinases, thus constituting an entire tcs. considering foci encoding more than two tcs domains, observed numbers decreased rapidly, as the number of encoded domains increased .

genes or foci, domains or genes?
is it more sensible to consider tcs organisation at a focus level, or at a gene level? we could start with the assumption that the most important factor is the number of tcs domains at a focus, with the distribution of those domains between genes being less important. if so, we would expect that for any number of encoded domains, the proportion of genes containing t, r or p domains, would be similar to the proportion of foci containing those domains . this is generally the case, to within 5%, however in some cases there is a great difference between foci and genes, especially considering 1-domain foci, and foci containing phosphotransfer domains. for instance, phosphotransfer domains are found in  <dig> % of 3-domain foci, but in  <dig> % of 3-domain genes. phosphotransfer domains are similarly enriched in 4-domain and 5+-domain genes. presumably, in a three-domain protein, a phosphotransfer domain would normally be required to signal to another protein  completing a phosphorelay. conversely phosphotransfer domains within 3-domain foci might be less common because to retain functionality, they would have to interact with proteins encoded by more distant genes.

for single domain foci, the proportion containing a transmitter domain is  <dig> %, however the percentage of single domain genes with a transmitter domain is  <dig> %. presumably this is because non-hybrid hks will have a partner rr, and there is a selective pressure towards the co-location of the two genes. conversely, the percentage of proteins encoding a receiver domain is  <dig> %, while the percentage of single domain genes that contain a receiver domain is only  <dig> %. this may suggest there is a pressure towards the 'orphanisation' of some receiver-domain only genes, potentially because they have multiple signalling partners.

plasmid-encoded tcs foci
as described earlier, more than half of all plasmid-encoded tcs were found on just  <dig> plasmids, each of which encoded more than  <dig> tcs genes. across all genomes r, t and p domains are found at frequencies of  <dig> %,  <dig> % and  <dig> % respectively, however in plasmids the relative frequencies of domains is significantly different , with  <dig> % r,  <dig> % t and  <dig> % p domains. thus for plasmid tcs, it seems that phosphotransfer domains are over-represented, at the expense of transmitter domains. assessing the number of domains encoded at a focus, there were also significant differences between plasmid foci and those of the entire genomic dataset , with  <dig> % of foci encoding a single domain , with a corresponding reduction in the number of paired-gene foci .

phosphorelays
in a typical phosphorelay, phosphoryl groups are successively transferred between t, r <dig>  p and r <dig> domains. in an early review of phosphorelay biology, appleby et al.,  <cit>  noted that the constituent domains of some phosphorelays exhibited different patterns of covalent linkages. for instance, some phosphorelays were distributed over four proteins, while others were composed of three or even two proteins.

in our dataset there were  <dig> foci that consisted of four domains, dominated by four domain-combinations . of the  <dig> proteins containing trrp domains,  <dig> were encoded as one gene,  <dig> were distributed over two genes,  <dig> were three-gene systems and only one focus consisted of four genes. of the  <dig> two-gene systems,  <dig> were found as a trp-r focus, while  <dig> of the  <dig> 3-gene foci had a tr-p-r geometry. thus for trpr systems, there is a distinct bias towards two of the possible  <dig> geometries , together accounting for  <dig> % of cases. conversely for the  <dig> trtr foci, every possible geometry was seen at least  <dig> times, with no single geometry accounting for more than  <dig> % of cases . there were also  <dig> foci encoding five domains in the dataset, and nearly half of these of those  have a trrrp domain combination, reminiscent of a phosphorelay with an extra receiver domain.  <dig>  of these were arranged in a two gene organisation trrp-r similar to the trp-r geometry found in  <dig> % of trrp foci.

metrics of tcs signalling
as can be seen above, the tcs complement of genomes can be characterised in many ways, and at several levels. an understanding of the relationships between tcs foci, genes and domains can help us to infer the functional properties of tcss from their gene sequence and context alone. it also enables us to define features of 'normal' tcs signalling, and in doing so identify organisms/systems in which tcs signalling is abnormal and thus interesting/novel. metrics have already been proposed that allow comparisons between organisms, based on the abundance and character of signalling genes in a genome  <cit> . these metrics correlate the number of signalling genes  in a genome with iq, and the proportion of sensory proteins lacking transmembrane helices with 'introvertedness'. another metric based on the relative abundance of different families of signalling proteins , has been shown to be consistent within phyla, and yet capable of discrimination between closely-related organisms with differing signalling capacities  <cit> .

in the following section we describe the rationale behind a series of potential metrics and evaluate their ability to discriminate between the tcss of various organisms.

measures of tcs genes/domain numbers
clearly the 'number of tcs genes/domains' is an important measure of prokaryotic adaptability. the number of tcs regulators is taken into account when calculating bacterial iq  <cit>  and in some organisms this will be a major component of the iq score. thus the number of tcs regulators, whether assessed in genes or domains, will scale with iq .

the 'percentage of tcs genes on plasmids' varies quite widely between organisms, from  <dig> % to  <dig> % . however  <dig> % of organisms with tcs genes have none encoded on plasmids, and those with large numbers of plasmid-encoded tcs genes are predominantly alpha- and beta-proteobacteria.. no organisms outside the alpha- or beta-proteobacteria contained more than 25% plasmid-encoded tcs, further limiting its use as a potential metric.

the domain/gene organisation of organisms could potentially form the basis of metrics. the 'percentage of orphan tcs genes' and the 'percentage of paired tcs genes' both range from  <dig> to 100%, and both still range over at least  <dig> % even when only considering replicons with > <dig> tcs genes. of those genomes, xanthomonas oryzae pv. oryzae px099a, exhibited the greatest proportion of orphaned tcs genes , while only  <dig> % of the tcs genes of clostridium phytofirmans isdg were orphaned.

the presence of pp genes  is indicative of an expanded tcs, so counts of the 'number of pp genes' was considered as the basis of a metric. however very few genomes possess multiple pp genes - only  <dig> replicons encoded more than  <dig> pp genes , and  <dig> % of chromosomes possess no pp genes, substantively limiting it's use as a metric. even focussing on phosphotransfer domains rather than pps does not improve such a measure's usefulness significantly, as there are only three times more phosphotransfer domains than pp proteins across all genomes.

for similar reasons, 'average genes/domains per focus' is of limited use as a discriminatory metric, as only  <dig> % of foci have more than two domains, and only  <dig> % of foci have more than two genes. indeed as  <dig> % of all tcs foci are either one-gene, one-domain foci, or two-gene, two-domain foci, measures of 'domains per focus' correlate with the '% of paired tcs genes' and '% of orphan tcs genes' measures. for example, 'average number of genes per focus' is negatively correlated with '% of orphan tcs genes' with r <dig> =  <dig> .

measures of complexity
potential metrics described thus far have centred around various measures of the number of domains/genes per focus. it is also possible to devise metrics based upon degrees of complexity within tcs foci. for example one might assess the number of different tcs gene organisations within a replicon, or the proportion of foci with >n genes. we compared four such metrics: the number of different focus organisations or 'diversity', the number of different focus organisations comprised of > <dig> genes , the number of foci containing > <dig> genes , and the percentage of foci containing  <dig> or more genes . '# >2', 'diversity >2', and 'diversity' all correlated with the 'number of tcs genes', with r <dig> values of >  <dig> . this might have been expected as the larger the number of tcs genes within a genome, the greater the number of more complex focus organisations. however '% >2' was found to correlate only slightly with 'number of tcs genes' . thus it would seem that the '% >2' metric captures some feature of tcs organisation distinct from the 'number of tcs genes', or the 'number of genes/domains per focus'. applying the '% >2' measure to replicons encoding  <dig> or more tcs foci, scores ranged from  <dig> %  to 0%. a significant proportion of replicons  possess no foci of > <dig> genes, which restricts the metric's applicability to replicons with large numbers of tcs genes.

discussion
assessing the relationship between tcs gene adjacency and nucleotide distance, led to the proposal that  <dig> bp be used as a cut-off for the definition of functionally co-located tcs genes on the same dna strand. the imposition of such a cut-off gives similar results to manual analysis of tcs gene structure. for example using a manual approach  <cit> bacillus subtilis has been described as having  <dig> orphan tcs genes, and  <dig> paired genes, whereas using the automated scheme here, b subtilis apparently encodes  <dig> paired genes and  <dig> orphans.  <dig> bp is a commonly used cut-off for defining likely operons  <cit> , and restricting focus membership to genes within an operon is a desirable outcome. a cut-off of  <dig> bp is pessimistic - it will often cause the separation of genes that would intuitively be assumed to be co-functioning, reducing the apparent size of tcs gene foci. however, a pessimistic cut-off reduces the problem of mis-classifying genes as being co-functional purely because of the relative proximity of their genes, which is more of a problem for replicons with higher densities of tcs genes. basing classification on a distance cut-off makes the scheme presented here sensitive to mis-classification of start sites, which is still an unsolved problem in genomics, however it does avoid the problem of gene underestimation during annotation.

other categorisation schemes have used ad hoc sets of rules for assessing adjacency of tcs genes  <cit> . for example, the mist <dig> database assesses linkage by restricting analysis to unidirectional gene clusters  within which linked tcs genes could be separated from each other by up to two other genes  <cit> , while whitworth and cock  <cit>  used an arbitrary  <dig>  bp cut-off. both or these approaches are thus far more optimistic classification schemes than the approach used here and don't have the benefit of being based on gene-distance data. despite this, our results are similar to those of other studies. applying the categorisation scheme to  <dig>  tcs genes from the p2cs database , revealed that the vast majority of tcs genes are encoded as either orphans  or paired genes , while the mist database classifies 38% of tcs genes as orphans  <cit> . in a recent upgrade to the p2cs database, the classification scheme defined here has been adopted, providing free access to gene organisation information for all tcs in completely sequenced prokaryotic genomes and metagenomes  <cit> .

in addition to noting gross trends of tcs organisation, categorisation of tcs genes allowed analysis of previously unexplored aspects of tcs gene organisation from a multi-genomic perspective.

analysis of the distribution of tcs genes between chromosomes and plasmids showed that plasmids are relatively enriched for orphan tcs genes, and that phosphotransfer domains are over-represented in plasmids at the expense of transmitter domains. the relative abundance of phosphotransfer domains implies that plasmid-encoded tcs tend towards the more complex 'expanded' types. plasmid tcs genes also tend to be orphaned, which suggests that plasmids either tend to encode more tcs pathways with components distributed around the plasmid, or encode more tcs proteins that act in combination with, or by modulating the activity of, chromosomally-encoded tcs. intriguingly, a recent study of rhodococcus equi has suggested that a plasmid-borne orphan rr required for virulence , is activated by a chromosomally-encoded hk , providing evidence that this latter scenario is plausible  <cit> . in either case, it is not clear why plasmid-encoded tcs should be at all different from chromosomally-located tcs.

classically, phosphorelays have been described as tcss involving phosphotransfer between four successive domains , as described by appleby et al.,  <cit> . such phosphorelays are readily identified in our datasets. most 4-domain tcs foci encoding t, r, r and p domains were found as either a trpr single gene , or as a trp-r two-gene focus . other relatively uncommon domain architectures are also viable functional units however - for instance a tr-p-r system  has been recently described in yersinia enterocolitica,  <cit> . a single domain/gene organisation is found for  <dig> %  of the  <dig> 5-domain foci containing trrrp domains , suggesting that these foci encode phosphorelays whose activity is somehow modulated by an extra receiver domain, a suggestion made previously  <cit> . an example of an experimentally characterised system showing such complexity is the cbbrrs phosphorelay of rhodopseudomonas palustris, which comprises a tr hybrid kinase , a pr protein  and a further rr   <cit> . also abundant in our datasets were loci encoding two transmitter domains and multiple receiver domains. the genetic organisation of these loci  suggests they might encode phosphorelays where the function of the hpt phosphotransfer domain of classical phosphorelays is performed by the phophotransfer domain within the second transmitter domains of the system. alternatively such loci may just be the consequence of the coincidental juxta-positioning of two dyad tcss. however, one such system that has recently been experimentally characterised is the redcdef system of m. xanthus  <cit> . the red pathway is encoded by a t1-r1r2-t2-r <dig> focus and the t <dig> domain has been shown to receive phosphoryl groups from the r <dig> domain . in addition, for the trt-r phosphorelay todst of pseudomonas putida, the second transmitter domains has been shown to act as a phosphotransfer domain, while possessing autokinase activity  <cit> . it therefore seems likely that trtr phosphorelays are nearly as commonplace as trpr phosphorelays, although currently less-well studied experimentally.

as noted by appleby et al.  <cit> , tcss display different covalent linkages between their tcs domains. cock and whitworth  <cit>  investigated the gene/domain relationship for 'minimal' tcs foci - those encoding a single transmitter and receiver domain pair. it was found that whether the two signalling domains were found as one or two proteins was dependant on whether the tcs possessed a transmembrane sensory domain, or a dna-binding output domain, each of which require particular sub-cellular localisation for function  <cit> . presumably arguments of co-localisation will affect the distribution of domains between genes, and the distribution of genes between foci, for all tcs geometries. the complexity of addressing such a topic computationally for pathways more complex than a minimal tcs is daunting though, and must be left for the future. however exploring the relationship between domain and gene organisation has the potential to unveil mechanistic features of tcs signalling/evolution, as it has done for minimal tcs  <cit> . hopefully the analysis and datasets presented here open up this possibility.

our analysis interrogated the collection of completely sequenced prokaryotic genomes. features of tcs gene/domain organisation are not conserved globally, with different phyla exhibiting distinct properties, for example firmicutes tend to encode tcs as pairs and not orphans, whereas proteobacteria tended to encode most of the tcs gene triads and tetrads. the dataset used to draw our conclusions is biased towards highly sequenced clades. the impact of such sequencing bias can be reduced by removing redundancy at an arbitrary taxonomic level , but ideally the analysis presented here would be performed individually for separate taxa, as depth of sequencing allows. unfortunately for most taxa there are currently not sufficient complete genome sequences available to undertake such analysis at even the order level, nor sufficient data on lifestyle to allow correlations with life history traits  <cit> . nevertheless, assessing the properties of tcs genes across all genomes is useful, as it provides a context for the analysis of individual organisms, groups of organisms, and subsets of tcs proteins, for instance chea homologues , or an individual family of rrs.

finally we investigated possible metrics of tcs gene organisation. useful metrics are able to distinguish between a wide variety of organisms, and provide a measure of an organismal feature that isn't captured by other metrics. some metrics capture phenotypic properties, for example extrovertedness and iq/adaptability which reflect lifestyle and ecology  <cit> , while others reflect mechanistic features of a system/organism, such as the relative numbers of one-component and two-component systems  <cit> , providing insights into evolutionary pressures and molecular mechanisms. in addition to providing such insights, metrics also allow rigorous rather than intuitive comparison between organisms.

here we propose two metrics that capture information regarding the genetic organisation of tcss - the 'percentage of orphan tcs genes', and the 'percentage of tcs genes in foci of > <dig> genes'. for ease of reference we have assigned these metrics the anthropomorphic names 'dissemination' and 'sophistication' respectively. the orders of organisms ranked by the two metrics are not significantly correlated, nor do they correlate with ranking by the number of tcs genes . care needs to be taken when describing the degree of dissemination and sophistication of organisms that encode few tcs genes, as the scores are percentages, and as the number of tcs genes per replicon drops, the proportion of replicons with no sophisticated foci increases. dissemination is strongly and negatively correlated with the percentage of paired tcs genes , and would also be expected to scale with the related measures of percentage paired/orphan transmitter/receiver domains.

the distribution of discrimination scores has a mean of  <dig> %  when considering all replicons that encode tcs genes , whereas sophistication scores average  <dig>  ±  <dig> % .

there appears to be little phylogenetic bias towards high dissemination scores - restricting analysis to organisms with > <dig> tcs genes, the twenty organisms with the highest dissemination scores were  <dig> spirochaetes,  <dig> proteobacteria,  <dig> cyanobacteria,  <dig> member of the euryarchaeota,  <dig> planctomycete and  <dig> member of the chloroflexi. the twenty replicons with highest sophistication scores included  <dig> spirochaete,  <dig> member of the fibrobacteres,  <dig> member of the euryarchaeota and diverse members of the proteobacteria. thus dissemination seems to capture more mechanistic rather than phylogenetic information, whereas heritage has more influence on the sophistication score.

the metrics proposed here don't consider sequence similarity or orthology. relationships, and are particularly sensitive to gene gain/loss  and gene fusion/fission events . the non-requirement for sequence similarity data allows metrics to be calculated for genomes that are the sole examples within a clade, however superimposing an orthology analysis onto a metrics-based characterisation should provide information regarding the lability of orthologous systems, and how their gene/domain organisation has evolved.

sophistication and dissemination are direct measures of gene organisation, and are only indirectly affected by domain architecture. metrics based on domain composition tended to be 'elitist', as the vast majority of tcs genes  contain only  <dig> domain, and are therefore of limited usefulness as discriminators. metrics that avoid this problem by capturing  the number of foci with >x domains/genes, correlate strongly with the total number of tcs genes, so are essentially modified versions of the iq metric and of little novelty.

how then can the dissemination and sophistication scores be used? beyond identifying replicons with unusually high or low scores, the next step is to identify factors that correlate with these two metrics. for instance in an earlier study it was found that the apparent fusion/fission rates of tcs genes correlated with the presence of tm helices and dna-binding domains, and with gene order  <cit> . similarly, analysis of the factors that co-vary with dissemination and/or sophistication should provide insights into the relationship between gene/focus structure and function .

CONCLUSIONS
in this study we have used a rationally-devised scheme to classify gene and domain architectures of prokaryotic tcs genes and in doing so, identified general features of tcs organisation. our analyses provide a baseline for comparison with individual organisms, and to such an end, we have also proposed two new metrics of tcs organisation that should prove useful in teasing apart features of tcs organisation and evolution.

authors' contributions
rhnw wrote all scripts, generated and analysed the datasets. dew conceived of the study, directed the research and wrote the manuscript. both authors read and approved the final manuscript.

supplementary material
additional file 1
numbers of tcs gene tetrads/triads/pairs/orphans per replicon. for every replicon analysed, the total number of hk, pp and rr genes are presented, along with the numbers of tcs genes found as orphans, paired genes, triads and tetrads. in addition the types of tcs genes found as orphans, and in various paired-gene geometries are provided.

click here for file

 additional file 2
dataset of tcs gene foci domain/gene organisation. a dataset of tcs gene foci, with each focus defined using the locus tag of the first gene in the focus. for each focus, gene architecture and domain organisation are presented.

click here for file

 acknowledgements
we wish to thank philippe ortet and mohamed barakat for freely providing output from the p2cs database. we would also like to thank peter cock and philippe ortet for critical comments on the manuscript. funding to meet publication charges was provided by the institute of biological, environmental and rural sciences, of aberystwyth university.
