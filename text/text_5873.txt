BACKGROUND
stoichiometric and constraint-based analysis of metabolic networks has become a key methodology to gain insights into functions, capabilities and properties of cellular metabolism . applications of metabolic network modeling include, for example,  simulation and prediction of metabolic phenotypes  for cellular growth under certain environmental conditions, either in the wild-type or in mutants containing certain gene knockouts;  the identification of maximal growth or product yields and the respective metabolic pathways leading to optimal yields;  the computation of intervention strategies increasing the synthesis of certain products ; or  analysis of general structural properties such as coupled reactions or the identification of gaps in reconstructed metabolic networks. until the end of the 90’s, stoichiometric models had usually not more than  <dig>  reactions. with the advent of annotated genomes, however, larger metabolic models were constructed for different organisms and the first reconstruction reached genome-scale level at the turn of millennium. today, more than  <dig> genome-scale metabolic network reconstructions for diverse organisms from all kingdoms of life have been published and examined  <cit> . these models are still evolving with new biological knowledge, as can be exemplified by network reconstructions for escherichia coli . the first e. coli genome-scale model  was published in  <dig>  <cit>  and consisted of  <dig> reactions and  <dig> metabolites. it was updated by reed et al. in  <dig>  <cit>  leading to an expanded network with  <dig> reactions and  <dig> metabolites . the next iteration  was published in  <dig>  <cit>  and contained as many as  <dig> reactions and  <dig> metabolites. the latest update was made in  <dig>  and comprises  <dig> reactions and  <dig> metabolites. numerous applications of these models demonstrated the power of constraint-based modeling in general and gained invaluable insights on the metabolism of e. coli  <cit> .

with increasing size and complexity of genome-scale models the computational effort for their analysis increased as well. some stoichiometric methods, for example those that require enumeration of elementary modes  <cit> , cannot be applied to networks consisting of several thousand reactions due to computational intractability. furthermore, metabolic flux analysis can usually only be used with models of the central metabolism since intracellular fluxes would poorly be determined in the full system  <cit> , even if data from isotopic tracer experiments are available  <cit> . similar arguments hold for kinetic modeling, which, due to lacking knowledge about kinetic mechanisms and parameters, can usually only be applied to smaller modules of the complete metabolic network. finally, metabolic core models may sometimes be more suitable to study and understand basic principles of an organism’s  metabolism. in all these cases, it would be most desirable to take a well-curated genome-scale model and to reduce this model to a certain core or module while keeping key elements or/and important functional properties. while some specific examples for network reduction of genome-scale models have been described in the literature  <cit> , we are not aware of an automated and flexible network reduction approach that can generically be applied to any metabolic network. in this work we present such an algorithm and demonstrate its applicability and power by reducing a genome-scale metabolic network of e. coli  to a meaningful core network representing the central metabolism. in a second case study, we reduce a genome-scale model of a cyanobacterial species to a small metabolic module which comprises photosynthetic core reactions and the calvin-benson cycle and allows synthesis of both biomass and a biofuel .

methods
stoichiometric networks and constraint-based modeling
metabolic network models with m internal metabolites and n reactions can be represented by a m × n stoichiometric matrix n. the basic assumption of steady state  leads to the metabolite balancing equation  <dig> nr= <dig> where r is the vector of net reaction rates . the solutions r satisfying  form the null space of n whose dimension is given by the degrees of freedom  defined as  <dig> dof=n−rankn. 

information on reaction rates  can be integrated by setting lower and upper boundaries for some reaction rates:  <dig> αi≤ri≤βi. 

the set of flux vectors r fulfilling  and  forms, in general, a polyhedron which can be bounded or unbounded. flux balance analysis  is often used to find optimal flux vectors in this polyhedron by maximizing a specific linear objective function  <dig> maximizerz=ctr. 

typical examples are maximization of biomass production or of formation of a certain product. while the optimal value z in  is always unique, infinite optimal flux vectors r achieving the maximal z may exist . here, flux variability analysis  can be used to identify the feasible flux ranges in the network by determining for each reaction the minimum and the maximum reaction rate under the given constraints  and .

network reduction algorithm
our network reduction algorithm networkreducer reduces a given large-scale metabolic network to a smaller subnetwork thereby keeping desired features of the full network. networkreducer accepts the following specifications of protected parts, properties, and phenotypes :set of protected metabolites pm: all metabolites in pm must be retained in the reduced network.

set of protected reactions pr: all reactions in pr must be retained in the reduced network. optionally, one may also specify whether protected reactions must be feasible .

protected functions and phenotypes: described by appropriate inequalities .

minimum degrees of freedom: the dof ) of the reduced network may not fall below a minimum threshold: dof ≥ dofmin.

minimum number of reactions .



specifications of type  and  allow protection of certain reactions and metabolites which will not be deleted by the algorithm. a typical scenario is to preserve reactions and metabolites from the central metabolism of a genome-scale network. for protected metabolites we demand that at least one  reaction involving this metabolite must be maintained in the network.

a key feature of our algorithm is the consideration of desired  functions and phenotypes ). each protected functionality k is described by a corresponding set of linear equalities/inequalities :  <dig> dkr≤dkk=1…s. 

in the e. coli case study presented in the results section, for instance, given a maximal substrate  uptake rate of 10 mmol/gdw/h and a non-growth associated atp maintenance  requirement of  <dig>  mmol/gdw/h  <cit>  ), we will demand that the maximal growth rate in the reduced network should be close  to the maximal growth rate  of the full network. inequalities describing these constraints in the style of  are  <dig> rglc_up≤10−μ≤− <dig> μmax_full which can be integrated in an appropriate matrix/vector pair d1/d <dig>  we thus demand that at least one steady state flux vector  and ) must exist in the reduced network that obeys  and thus achieves maximal growth rate. in the case study we will additionally demand that under anaerobic conditions the maximal  growth rate of the full network  can also be reached by the reduced network:  <dig> rglc_up≤10ro2_up≤0−μ≤− <dig> μmax_full_anaerobic. 

inequalities  can be properly described by a second pair d2/d <dig>  hence, d1/d <dig> and d2/d <dig> describe two  functionalities of the full system to be preserved in the reduced network . other phenotypes, for example, the production of a certain compound with high yield, could be protected as well.

the actual network reduction algorithm  starts with a preprocessing step, which checks the feasibility of the protected functions in the original network and removes  blocked reactions. the main algorithm is divided into two major parts: network pruning followed by network compression. network pruning involves a loop which removes iteratively non-protected reactions thereby checking that none of the desired properties - is violated. in each iteration, the algorithm applies fva in the current network to calculate for each removable  reaction i the feasible flux ranges separately for each protected function k defined by dk/dk. with fik we identify the flux range of reaction i under the protected function k, k = 1…s, and determine then the union fi of all these flux ranges: fi=∪k=1sfik.  two important results can be derived from these flux ranges. first, a reaction having an entirely positive or entirely negative flux range fik for any of the desired functionalities k is identified as essential reaction and therefore removed from the list of removable reactions. second, from the remaining removable reactions, the next deletion candidate is identified as the reaction that has the smallest overall flux range fi. we assume that removal of this reaction maintains a high degree of flux variability in the network . after deletion of a reaction, feasibility of the protected functions ), of protected reactions ) and of protected metabolites  is tested. if any of the conditions is violated, then the last removed reaction is reinserted and marked as non-removable and the reaction with the second smallest overall flux range fi is considered. once a reaction has been removed, the next iteration starts and the flux ranges are recalculated. the main loop of network pruning stops when no further reaction can be deleted without violation of any of the specifications -. at the end, unconnected metabolites in the reduced network not participating in any of the remaining reactions are removed from the network.fig.  <dig> schematic representation of the networkreducer algorithm. the figs. on the right-hand side illustrate the result of the step on the left-hand side



in a post-processing step, loss-free network compression can be  applied using methods as presented in  <cit> . in particular, reaction or enzyme subsets  will be represented as single overall reactions with collapsed stoichiometries. as a special feature of our compression algorithm, protected reactions and metabolites are kept and excluded from compression. one example illustrating the benefit of loss-free network compression is the following : if the central metabolism of a genome-scale model was specified as a protected subnetwork and  growth as a protected function, then, for each compound  in the biomass synthesis reaction, network pruning will typically keep one optimal pathway and remove all alternate routes from the respective precursor in the central metabolism to this amino acid. reactions and metabolites along this pathway were not defined as protected but were nevertheless kept in the system to still allow  growth. loss-free network compression will compress the linear pathway from the precursor to the amino acid by replacing the stoichiometric coefficient of the amino acid in the biomass synthesis reaction  with the cumulative stoichiometries of the precursors and cofactors h etc.) needed to synthesize the amino acid in the required amounts. for example, assume we have precursor p  and the three sequential reactions  <dig> p➔d; d+nadph➔f; f+atp➔a for synthesizing the amino acid a. furthermore, let a be contained with a stoichiometric coefficient of  <dig> in the bsr . network compression will remove a from the bsr and add instead p, atp, and nadph with coefficients  <dig>   <dig>  and  <dig>  respectively. the bsr thus effectively changed to  <dig> p +  <dig> atp +  <dig> nadph +  + … ➔ biomass. metabolites d, f and a as well as the three reactions can be afterwards removed. since atp, nadph and other metabolites  appear in several synthesis pathways, their respective stoichiometric coeffcients along all these pathways are summed up to eventually obtain the cumulative stoichiometry of biomass synthesis. we note that network compression leads to a more compact network representation but, in contrast to network pruning conducted in the first step, it neither changes the dof nor the potential behaviors of the network.

with the specifications -, many relevant scenarios of network reduction can be handled and two typical examples are demonstrated in the results section. a key property of our method is that the resulting network generates a true subset of the phenotypes of the full network. furthermore, if only the pruning step is performed , the obtained network will represent a proper subnetwork of the full network.

the pseudo-code of the whole networkreducer procedure is given below. the algorithm has been integrated in our matlab toolbox cellnetanalyzer  <cit> . files and scripts used in this study  can be downloaded from http://www <dig> mpi-magdeburg.mpg.de/projects/cna/etcdownloads.html.

RESULTS
reduction of an e. coli genome-scale model
this section aims to give a proof-of-principle of our networkreducer algorithm using a realistic application example. a typical scenario for a network reduction problem is as follows: given a genome-scale metabolic network with several thousand reactions, the goal is to reduce the network to a core network , usually the central metabolism, while preserving the ability of the virtual organism to grow or/and to produce certain metabolites. as source for a genome-scale network we used the iaf <dig> model of escherichia coli presented by feist et al.  <cit>  which contains  <dig> reactions and  <dig> metabolites and is one of the most frequently used metabolic network models. we compare the outcome of our network reduction routine with an e. coli core model presented by orth et al.  <cit> . the latter model, denoted in the following by colicore, covers the central metabolism of e. coli. it contains  <dig> reactions and  <dig> internal metabolites and was manually derived by orth et al. with iaf <dig> serving as a starting point. accordingly, colicore and iaf <dig> use identical identifiers for metabolites and reactions.

we considered the network spanned by the reactions contained in the colicore model as the “target network” to be reached by network reduction of iaf <dig>  before we could start with the reduction process, some minor adaptations had to be done to make both models consistent. first, colicore used the fumarate reductase reaction with ubiquinol- <dig> as redox carrier  and we added this reaction also to iaf <dig> to allow protection of this reaction during the reduction. in addition we introduced a metabolite “biomass” in the genome-scale model, integrated it in the biomass synthesis reaction as a product with stoichiometric coefficient of  <dig>  and added then also a reaction to “export” this biomass compound. this configuration makes it easier to configure biomass synthesis as a protected function and to keep track of the stoichiometric coefficient of the biomass compound during network compression. the final stoichiometric matrix of the genome-scale model  was thus slightly extended to  <dig> x  <dig>  flux constraints in the coligs model were specified such that glucose serves as the only carbon substrate.

the colicore model contains uptake reactions for glucose but also for some other substrates . since we aimed to focus on glucose as the sole carbon substrate, we removed all reactions and metabolites from the colicore model that are involved in uptake of these substrates. analogously to the coligs model, we also included a biomass metabolite in the biomass synthesis reaction and a corresponding “biomass export” reaction. with these changes, the final dimension of the colicore model was  <dig> reactions and  <dig> internal metabolites. key properties of coligs and colicore are summarized in table  <dig> table  <dig> properties of e. coli network models discussed in the text. coligs and colicore are slightly modified versions of iaf <dig>  <cit>  and of the model presented in  <cit> , respectively. all models are available in sbml format at http://www <dig> mpi-magdeburg.mpg.de/projects/cna/etcdownloads.html


e. coli genome-scale model 

μ

μ


after these preliminary steps network reduction of the coligs network could be started. phenotypes and elements of the genome-scale model to be maintained in the reduced model were specified as follows. all  <dig> reactions of the colicore model were marked as protected reactions  in the coligs model and we also demanded that all these reactions should be feasible  in the reduced network. since all metabolites involved in these reactions are implicitly protected as well we did not explicitly specify protected metabolites . concerning protected phenotypes, we demanded that  at least  <dig>  % of the maximal growth rate  in the coligs model under aerobic conditions and  at least  <dig>  % of the maximal growth rate in the coligs model under anaerobic conditions  should be reachable in the reduced network  and ). as already described in the methods section, the maximal glucose uptake rate was set to 10 mmol/gdw/h and minimal atp maintenance demand to  <dig>  mmol/gdw/h. finally, dofmin and nmin were both set to  <dig>  hence, we aimed to reduce the network as far as possible while keeping the protected reactions and phenotypes.



network reduction without applying network compression in postprocessing  yielded a reduced network model  which already decreased the dimension of the genome-scale network from  <dig> reactions /  <dig> internal metabolites to  <dig> reactions /  <dig> internal metabolites. as demanded, the maximal growth rates under aerobic and anaerobic growth in colipruned are identical  or very close  to the respective maximal rates in the genome-scale model. the dof of colipruned  is significantly smaller than in coligs  and already close to the dof of colicore  indicating a similar complexity of the solution spaces of colipruned and colicore. even though colipruned still contains more than  <dig> reactions, the  elementary modes of this network can be fully enumerated.

the structure of the colipruned network resembles the second network shown in fig. 1: many redundant  pathways to biomass components have been removed while the  core subnetwork was retained. as described in the methods sections, the remaining linear pathways from the central metabolism to the biomass components can be further compressed to single  reactions without loss of information . applying the network compression routine  to colipruned yields the fully reduced network coliprunedcomp, whose structure is now similar to colicore and resembles the third network shown in fig.  <dig>  coliprunedcomp  is much smaller compared to colipruned  while neither the dof nor the number of elementary modes and the possible phenotypes changed. the dimension of coliprunedcomp is now very similar to colicore , yet, there are still some differences which we analyzed in detail.

coliprunedcomp contains  <dig> more reactions and  <dig> more internal metabolites than colicore. a large fraction  of these additional elements arises due to a different description of exchange reactions. the colicore considers two compartments where metabolites are balanced  plus  an environment. thus,  <dig> reactions and  <dig> balanced species are needed to describe the import of a metabolite m  in the colicore model . in contrast, coligs contains additionally a periplasm compartment, hence, uptake of an exchange metabolite m involves  <dig> exchange reactions and  <dig> species . since  <dig> metabolites can be exported/imported to/from the environment in colicore,  <dig> additional species and reactions  must be maintained in the coliprunedcomp model; they can also not be compressed because they are surrounded by protected reactions.

another observation is that the genome-scale network and its derived reduced models allow higher maximal growth rates than the colicore model for which we identified two reasons. first, different stoichiometries for biomass synthesis may lead to different biomass yields . second, we found that the remaining two additional  reactions in the coligs model not contained in the colicore model allow for higher maximal growth rates; these reactions were kept by the pruning algorithm to maintain the protected phenotype of maximal growth in the coliprunedcomp model . the first of these two reactions is related to hydrogen production which turns out to be necessary to attain the maximal anaerobic growth rate. the second reaction is related to respiratory pathways. the coligs model contains two cytochrome oxidases . both oxidize ubiquinol but with different stoichiometry for the translocated  protons:  <dig> 2h++ <dig> o2+q8h2=h2o+2hperiplasm++q <dig>   <dig> 4h++ <dig> o2+q8h2=h2o+4hperiplasm++q <dig> 

clearly, the second reaction  will lead to a higher atp yield during respiration and therefore allow a higher growth rate under aerobic conditions. in contrast, the colicore model contains only reaction  translocating two protons accompanied with a lower atp and biomass yield. this reaction  was protected when reducing coligs, however, to allow maximal growth, the second reaction had also to be kept in coliprunedcomp. in fact, integration of reaction  in the colicore model increases the maximal growth rate to  <dig>  h− <dig> which is even higher than the μmax of coliprunedcomp .

these remaining discrepancies can be attributed to different stoichiometric coefficients in the biomass synthesis reaction  of colicore and coliprunedcomp. for the case of colicore, the stoichiometric coefficients of the precursor metabolites  in the bsr had to be calculated manually from the known requirements of monomers  in the genome-scale bsr. accordingly, orth et al. wrote  <cit> : “since most of the subunits of the cellular macromolecules, such as nucleic acids and amino acids, are not present in the core model, they could not be directly accounted for the biomass reaction. the metabolites in the core model that those macromolecular subunits are synthesized from are included instead. these are precursor metabolites. for example, the amino acid l-alanine is synthesized from pyruvate and l-glutamate, so both of these metabolites are consumed in the biomass reaction.”

hence, molecules such as amino acids contained in the genome-scale bsr must be translated into a stoichiometric demand for compounds present in the reduced model. making this translation manually in a genome-scale model is an error-prone and tedious task and an automated approach as ours supports this step and provides a rigorous approach to obtain a bsr in the compressed network that is consistent with the bsr of the full model. we directly compared the bsrs of colicore and coliprunedcomp to identify and understand possible sources of different stoichiometries.

table  <dig> shows the stoichiometric coefficients of metabolites in the bsr of the colicore and of the coliprunedcomp model . at a first glance, we can see that almost all metabolites contained in the bsr of colicore appear also in the bsr of coliprunedcomp, in many cases with comparable amounts.table  <dig> stoichiometries of metabolites in the biomass synthesis reaction of the colicore and the coliprunedcomp network model. negative values indicate consumption, positive values production during biomass synthesis



one major difference is that the bsr of coliprunedcomp contains a number of external metabolites, in particular trace elements such as calcium, sulfate, cobalt, copper, magnesium etc. originally, in the coligs network, trace elements were taken up by the cell yielding intracellular representatives of these elements which were then consumed by the bsr in the genome-scale model. these essential components of the biomass were kept in the coliprunedcomp model, however, network compression enforced the model to compress the two steps of uptake and consumption of a trace element into one step by integrating the required amount of external trace elements directly in the bsr of coliprunedcomp. although these external metabolites do not change the feasible network behaviors , it is one advantage of our algorithm that these condensed material balances are automatically calculated and still visible in the reduced model. note that the  amount of periplasmatic protons  consumed in the condensed bsr of coliprunedcomp is related to antiport uptake of trace elements.

further differences in the bsrs may arise by non-unique ways of representing precursor stoichiometries due to different reference points. for example, colicore uses glyceraldehyde-3-phosphate  as a precursor  whereas coliprunedcomp uses instead dihydroxyacetone-phosphate with a similar amount . since both metabolites can be converted into each other by a triose-isomerase reaction, both metabolites can in fact be used as precursors. a similar relationship exists for ribose-5-phosphate  and ribulose-5-phosphate . ru5p occurs only in the bsr of coliprunedcomp but, due to a simple isomerase reaction between both metabolites, could also be integrated in the value of r5p which is consumed in both bsrs.

despite those explainable differences, the bsr of colicore seems to slightly underestimate the demand for most precursors and, to a larger extent, for energy . on the other hand, the core model consumes a significantly larger amount of nadph and nadh which, in the final balance and biomass yield, could partially compensate the lower demand for some precursors. as mentioned above, would we add the high efficiency oxidase reaction  in the colicore model, the growth rate  would be slightly higher than in the coliprunedcomp model . we emphasize that we do not claim that the bsr of coliprunedcomp is necessarily “better” or more realistic than the bsr of the colicore model in  <cit> . it is possible that the authors used some specific assumptions in the calculation of the bsr for the colicore model which may have led to discrepancies with the condensed bsr calculated herein. nonetheless, the condensed bsr obtained with the networkreducer algorithm is consistent with the full model and allows for quantitative comparisons. our algorithm thus facilitates the unbiased and reproducible calculation of condensed bsr stoichiometries in reduced network models from their genome-scale representation.

to further test the quality of coliprunedcomp we exemplarily perfomed flux variability analyses for three different growth scenarios and compared the results with the original genome-scale model . we found a very good agreement of fluxes ranges in coliprunedcomp and coligs. although the trend of flux ranges in colicore and coligs are also similar, several larger differences can be observed.

reduction of a cyanobacterial genome-scale model to a module
in a second case study we used a genome-scale model of the phototrophic cyanobacterium synechocystis sp. pcc  <dig> and applied networkreducer to obtain a small metabolic core module which describes co <dig> fixation by the calvin-benson cycle in full detail and allows synthesis of biomass and of a biofuel . such a strongly reduced model may be useful to study basic principles and stoichiometries of, for example, coupled synthesis of biomass and biofuels . the genome-scale model of knoop et al.  <cit>   served as starting point. heterotrophic  metabolism was neglected and we again added biomass as internal species and a corresponding pseudo transport reaction for its export. after those minor adaptations the full model contained  <dig> reactions and  <dig> internal metabolites .

since the goal was to extract a network module that represents the calvin cycle and enables maximal phototrophic growth as well as maximal production of ethanol we protected all reactions of the calvin cycle, the pathway to ethanol, biomass and ethanol excretion, and light uptake . the two protected phenotypes were specified by rphotonup≤100−µ≤− <dig> µmax, representing maximal phototrophic growth , and rphotonup≤100−rethanol≤− <dig> rmaxethanol for maximal ethanol production .

as expected and desired, with the focus on a smaller subnetwork, the dimension of the reduced model  is much lower than in the e. coli core model and contains  <dig> reactions and  <dig> internal metabolites. the rank of the stoichiometric matrix is  <dig> implying four remaining degrees of freedom. the reduced model gives rise to  <dig> elementary modes reproducing not only the protected functions of pure biomass or ethanol synthesis but also growth-coupled ethanol production . the condensed biomass synthesis reaction withdraws metabolites  from the calvin cycle module needed to build biomass. since only a subset of “normal” precursors is part of the reduced model  the respective stoichiometric coefficients of precursors in the bsr of the reduced model are relatively large as they are not only needed as direct precursors for the bsr but also as starting point to produce other precursors. again, networkreducer ensures that the bsr of the reduced model is consistent with the bsr of the genome scale model therefore generating the same maximal growth rate and biomass yield.

CONCLUSIONS
in this work we presented networkreducer, a new algorithm for automated reduction of large-scale metabolic network models to obtain meaningful small- or medium-scale models, typically representing the central metabolism or certain modules of interest. the algorithm consists of  a pruning step followed by  network compression. network pruning removes elements of the network that are dispensible for a user-defined set of protected properties and parts. our algorithm accepts various criteria for specifying protected features. in particular, inequalities as in eqs.  provide a high flexibility in defining desired phenotypes. network pruning is accompanied with a real loss of feasible phenotypes in the model but our algorithm ensures that protected functions and parts are maintained. as a very useful and desired feature, network pruning always delivers a subnetwork of the full system implying that also all phenotypes  of the pruned network are a subset of the feasible behaviors of the full system. as one consequence, for example, all elementary modes of the pruned network are a subset of the elementary modes of the complete system.

network compression applied after network pruning further condenses the network structure by collapsing some reactions  if these are not protected. network compression works loss-free, that is none of the feasible phenotypes and functions is lost, however, the resulting network is generally not a proper subnetwork of the full system and a mapping of flux distributions  between the compressed and the full network can be cumbersome. it will depend on the application whether network compression is applied to the pruned network or not. if, for example, elementary modes are to be calculated in a network, loss-free compression algorithms are commonly used in a preprocessing step  <cit> . in the e. coli example study it was desired to fully condense the network to the predefined core.

whereas network compression delivers always a unique result, the outcome of the network pruning step can be unique or non-unique, depending on network structure, input parameters, and protected functions and parts. although reactions are removed in the order of their flux range , reactions with identical flux ranges may exist  from which then one is chosen randomly.

the e. coli case study demonstrated the applicability and potential of our approach. we reduced the genome-scale reconstruction iaf <dig> of feist et al.  <cit>  to an e. coli core model. the reactions and metabolites to be maintained were taken from the core model proposed by orth et al.  <cit> , which itself was manually derived with iaf <dig> serving as a basis. with the protected phenotype that the maximal growth rates of iaf <dig> under aerobic and anaerobic conditions must be achievable also in the condensed model, we used our algorithm to reduce the iaf <dig> model to its core and compared it with the model of orth et al. we found a generally good agreement between the manually and the automatically derived model but also some discrepancies. essentially, two reactions of the iaf <dig> not contained in the orth model were retained by networkreducer to ensure that the maximal growth rates can be achieved. furthermore, the stoichiometries in the condensed biomass synthesis reactions  showed some differences. with our algorithm we can ensure that the condensed bsr fully reflects the stoichiometries of the bsr of the original network thus leading also to the same maximal growth rates and biomass yields. the e. coli case study demonstrated the value of our approach for obtaining a fast , unbiased, and exact network reduction.

we consider the e. coli study as a typical application scenario for our method, namely to reduce a genome-scale network to its core  thereby protecting important properties such as  biomass or/and product yields. in the general case, a prerequisit is the careful delineation of the central metabolism  in the genome-scale network which, however, should be possible for many organisms from prior biological knowledge. many other reduction problems can be defined as well by using appropriate criteria for protected functions and parts. for example, instead of  the central metabolism, certain modules of a large-scale model  might be maintained in a high resolution while the rest is condensed. the presented case study of extracting a subnetwork of the cyanobacterial metabolism that comprises the calvin cycle and allows for biomass and biofuel  synthesis demonstrated that such an application is also supported by our algorithm. such extracted subnetworks are also useful for the construction of kinetic models of specific parts of metabolism, while preserving consistency with a genome-scale reconstruction.

an extreme application of networkreducer would be to compress the full network of an organism to just one single overall reaction consuming external metabolites  and synthesizing biomass with maximal yield. to simulate this maximal reduction, we again specified maximal aerobic biomass synthesis in e. coli as desired phenotype  and protected  the biomass export reaction. as a result, a “network” with only one overall reaction was maintained which exclusively converts external substrates and nutrients to external products the stoichiometry of this fully condensed bsr with one degree of freedom  can be found in the appendix showing that  <dig>  mmol glucose are required to build  <dig> gram of biomass in the optimal case.

although only genome-scale models can provide a complete view on the full functionality of a metabolic network there are several reasons why reduction of large-scale models can be useful or even necessary. first, computationally extensive analyses, such as full enumeration of elementary modes for metabolic pathway analysis, may only be tractable in smaller models. methods of metabolic flux analysis seeking to calculate internal metabolic fluxes based on measurements of extracellular fluxes or/and on data from isotopic tracer experiments are able to resolve metabolic fluxes for smaller  networks only. smaller models are also useful for didactic or educational purposes  <cit>  and, in fact, might sometimes be more suitable to gain a basic understanding of certain metabolic principles than exploring the “jungle” of a genome-scale network with thousands of reactions and metabolites. small-scale models are also useful for testing and evaluating new constraint-based analysis methods. finally, parameter-dependent dynamic modeling of metabolic processes normally focuses on smaller networks and network reduction allows one to cut a network region or module of interest from a genome-scale network which can then be studied by kinetic models. with all these applications in mind, we believe that networkreducer represents a valuable tool for stoichiometric and constraint-based modeling of metabolic networks.

appendix
biomass synthesis reaction of the genome-scale model coligs:

 <dig>  10fthf +  <dig>  2ohph +  <dig>  ala +  <dig>  amet +  <dig>  arg +  <dig>  asn +  <dig>  asp +  <dig>  atp +  <dig>  ca2 +  <dig>  cl +  <dig>  coa +  <dig>  cobalt2 +  <dig>  ctp +  <dig>  cu2 +  <dig>  cys +  <dig>  datp +  <dig>  dctp +  <dig>  dgtp +  <dig>  dttp +  <dig>  fad +  <dig>  fe2 +  <dig>  fe3 +  <dig>  gln +  <dig>  glu +  <dig>  gly +  <dig>  gtp +  <dig>  h2o +  <dig>  his +  <dig>  ile +  <dig>  k +  <dig>  kdo2lipid4 +  <dig>  leu +  <dig>  lys +  <dig>  met +  <dig>  mg2 +  <dig>  mlthf +  <dig>  mn2 +  <dig>  mobd +  <dig>  murein5px4p +  <dig>  nad +  <dig>  nadp +  <dig>  nh4 +  <dig>  pe160 +  <dig>  pe160 +  <dig>  pe161 +  <dig>  pe161 +  <dig>  phe +  <dig>  pheme +  <dig>  pro +  <dig>  pydx5p +  <dig>  ribflv +  <dig>  ser +  <dig>  sheme +  <dig>  so4 +  <dig>  thf +  <dig>  thmpp +  <dig>  thr +  <dig>  trp +  <dig>  tyr +  <dig> e- <dig> udcpdp +  <dig>  utp +  <dig>  val +  <dig>  zn <dig> ➔  <dig> gram biomass +  <dig>  adp +  <dig>  h +  <dig>  pi +  <dig>  ppi.

biomass synthesis reaction of the coliprunedcomp model  metabolites from the environment compartment have extension _b; from perisplasm: _p):

 <dig>  3pg +  <dig>  accoa +  <dig>  atp +  <dig>  dhap +  <dig>  e4p +  <dig>  f6p +  <dig>  for +  <dig>  gln +  <dig>  glu +  <dig>  h2o +  <dig>  h_p +  <dig>  nad +  <dig>  nadph +  <dig>  nh4 +  <dig>  oaa +  <dig>  pep +  <dig>  pi_e +  <dig>  pyr +  <dig>  r5p +  <dig>  ru5p +  <dig>  succoa +  <dig>  ca2_b +  <dig>  cl_b +  <dig>  cobalt2_b +  <dig>  cu2_b +  <dig>  fe2_b +  <dig>  fe3_b +  <dig>  k_b +  <dig>  mg2_b +  <dig>  mn2_b +  <dig>  mobd_b +  <dig>  so4_b +  <dig>  zn2_b ➔  <dig> gram biomass +  <dig>  ac +  <dig>  adp +  <dig>  akg +  <dig>  amp +  <dig>  co2 +  <dig>  coa +  <dig>  fum +  <dig>  g3p +  <dig>  glx +  <dig>  h +  <dig>  nadh +  <dig>  nadp +  <dig>  pi +  <dig>  pi_p +  <dig>  succ +  <dig>  4hba_b +  <dig>  5drib_b +  <dig>  hmfurn_b.

biomass synthesis reaction of the colicore model:

 <dig>  3pg +  <dig>  accoa +  <dig>  atp +  <dig>  e4p +  <dig>  f6p +  <dig>  g3p +  <dig>  g6p +  <dig>  gln +  <dig>  glu +  <dig>  h2o +  <dig>  nad +  <dig>  nadph +  <dig>  oaa +  <dig>  pep +  <dig>  pyr +  <dig>  r5p ➔  <dig> gram biomass +  <dig>  adp +  <dig>  akg +  <dig>  coa +  <dig>  h +  <dig>  nadh +  <dig>  nadp +  <dig>  pi.

biomass synthesis reaction of the coliprunedcomp_dof <dig> model  metabolites from the environment compartment have extension _b):

 <dig>  nh4_b +  <dig>  glc_b +  <dig>  o2_b +  <dig>  pi_b +  <dig>  ca2_b +  <dig>  cl_b +  <dig>  cobalt2_b +  <dig>  cu2_b +  <dig>  fe2_b +  <dig>  fe3_b +  <dig>  k_b +  <dig>  mg2_b +  <dig>  mn2_b +  <dig>  mobd_b +  <dig>  so4_b +  <dig>  zn2_b ➔  <dig> gram biomass +  <dig>  4hba_b +  <dig>  hmfurn_b +  <dig>  co2_b +  <dig>  h2o_b +  <dig>  h_b.

additional files
additional file 1: 
comparison of flux variabilities in 
coligs,
colicore,
and
coliprunedcomp
for three different growth scenarios. 

additional file 2: 
reactions, metabolites, the bsr and elementary modes of the reduced
synechocystis
model
. 



abbreviations
bsrbiomass synthesis reaction

dofdegree of freedom

fvaflux variability analysis

fbaflux balance analysis

competing interests

the authors declare that they have no competing interests.

authors’ contribution

rs proposed development of a network reduction algorithm. sk conceived and supervised the study. pe and sk implemented the networkreducer algorithm. pe performed the calculations for the e. coli case study and pe and sk analyzed the results. pe and sk drafted the manuscript. all authors read and approved the final manuscript.

