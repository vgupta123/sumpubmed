BACKGROUND
with the human and many other genome sequences complete or nearing completion, we are approaching the goal of identifying all the protein coding genes. however, to understand the function of these genes in different physiological contexts, it is important to understand how their expression is regulated. mechanisms of gene regulation are varied and complex and unraveling them will require a combination of approaches <cit> . having a catalog of all the transcription factors and being able to characterize their binding specificity at cis-regulatory sites would provide a fruitful starting point.

recent advances in chromatin immunoprecipitation  methods have led to large-scale efforts to determine all protein-dna binding events in yeast <cit>  but scaling up such methods for mammalian genomes may prove difficult. protein-binding microarrays , initially developed on a small scale by bulyk et al <cit>  showed promise in identifying transcription factor binding specificity with high accuracy and was recently successfully scaled up for the yeast genome by using pbms with all known yeast intergenic regions <cit> . although an exciting advance in the field, current design of pbms still leaves room for uncertainty because some of the intergenic regions may be too long to pinpoint the binding sites with high accuracy. scaling this method up to mammalian genomes would also require designs spanning multiple arrays, with a new design for each genome. both chip and pbm methods are well suited for low resolution identification of genes affected by a given transcription factor. however, in order to fully understand regulation, researchers will always be interested in pinpointing the specific regions to which the factor binds. identifying this region from chip-chip or pbm data requires sophisticated computational analysis, much like that used in ab-initio cis-regulatory region discovery. reliability of such analyses is sometimes questionable, in part because of the repetitive and degenerate nature of the intergenic sequences. harbison et al. note that some intergenic sequences are highly homologous thus skewing the results of motif discovery algorithms <cit> . if there was a way to test the binding of a given factor to all possible motifs of a given length, it would then be trivial to scan the intergenic sequences for potential sequences corresponding to a well-defined motif. we therefore propose a new pbm design that would allow the testing of all possible binding sequences of a given length in an optimally-efficient non-degenerate manner.

in recent years, a number of technological innovations took place, allowing programmable synthesis of microarrays as well as new techniques to make the arrays double-stranded <cit> . in particular, warren et al. successfully constructed and tested a combinatorial dsdna array with all possible 8-mer sequences, with one sequence per spot <cit> . since the proof of principle for this technology has now been shown, here we focus on optimizing experimental design. using variations on established graph theory algorithms, we propose a new design of a pbm, which would allow the in-vitro testing of transcription factor binding to all possible dna targets up to length  <dig>  this approach removes some of the redundancy in testing long intergenic regions. in addition, our design is organism-independent.

RESULTS
algorithm
the design, as described by bulyk et al. in proof-of-concept papers  <cit>  allows for testing n binding sites by screening n spots on the array. this approach is straightforward but not very practical for most transcription factors because the number of possible binding sequences is 4k, where k is the length of the binding site.

the more recent design involved spotting all annotated yeast intergenic regions on the array <cit> . this comprehensive approach is more scaleable, although mammalian genomes contain long "desert" regions <cit>  which would most likely have to be broken up into shorter segments for spotting on microarrays. in order to identify the transcription factor binding sites within the spotted regions, in this as well as in many other approaches, the authors rely on a variant of the gibbs sampling algorithm. some of the longer intergenic regions tested may present a problem in identifying binding patterns for low-specificity transcription factors. uniform probe length and optimal non-redundancy of the array proposed here would make it easier to analyze experimental results and estimate their statistical significance.

we propose the design of a dsdna array that allows screening for length k tf binding sites with maximum efficiency by allowing the k-mers to overlap. for instance, the 8-mer probe actgtgca represents two potential 7-mer tf binding sites – actgtgc and ctgtgca. it turns out that we can easily design an array with probes of certain length b that contain all possible k-mers, such that the required number of probes is minimal. if we can find the shortest string that contains all possible k-mer substrings, we can then "cut up" this string into individual probes of desired length. the problem of constructing such a minimum-length string can be represented in graph-theoretical formulation .

imagine a directed graph with nodes represented by all possible k-mers, where the edges exist between nodes that overlap by . finding the shortest path for a graph of all possible k-mers results in a superstring of length . given a desired probe length b > k, we can design an array with n probes that enables us to test the binding specificity of any transcription factor that can bind to a k-mer. the number of probes would have to be approximately

n = 4k/

the length of a string produced by naively joining all possible k-mers is k*4k. this means we are able to reduce the number of probes by a factor of k. furthermore, we can turn the reverse complementarity of double-stranded dna sequence to our advantage and gain another factor of  <dig> reduction in number of array probes <cit> . for instance, having included the 7-mer actgtgc in the superstring and assuming that the array probe will be double stranded, we are already accounting for the reverse complement 7-mer gcacagt. this introduces some complications in the algorithm, which we discuss in methods.

we would also need to take into account some additional considerations, such as allowing for spacers on either side of the designed sequence to ensure reliable binding, as well as a primer, if the double stranded dna is constructed enzymatically. we believe such an approach takes some of the ambiguity out of the decoding process that is needed in current approaches that rely on spotting long intergenic regions <cit> .

experimental design
using our combinatorial design, testing of all possible 10-mers with an array of probes of length  <dig>  requires only  <dig> probes. to avoid potential problems with factors binding to multiple sites on a given probe, and to aid in the identification of precise binding sites, the experiment may be performed in duplicate, with the cut points on the cyclical superstring shifted by k/ <dig> . table  <dig> shows the calculations for the number of probes needed on the array for a range of motif lengths k and array probe lengths b.

identifying the actual binding sequences given intergenic array spot data is a non-trivial problem, which mukherjee et al. addressed by gibbs-sampling algorithms <cit> . this problem arises from a combination of two factors: 1) many intergenic sequences are quite long , increasing the probability of finding multiple binding sites; 2) intergenic sequences are inherently redundant. our combinatorial design addresses both of these issues by proposing reasonably short and optimally non-redundant sequence features.

in order to illustrate the advantage of our design in more precisely identifying the exact binding sequences, we carried out simulation experiments with yeast rap <dig> transcription factor, yeast tata-box binding protein , as well as  <dig> random binding sites of length  <dig>  since some transcription factors are known to tolerate substantial variation of the binding site sequence, we generated all possible double mutants for every starting consensus binding site sequence and assumed that all those sequences would be recognized on the array. for our designed array, we chose a design from table  <dig> with k =  <dig> and b =  <dig>  because a probe of length  <dig> is statistically much less likely to contain multiple binding sites for a given factor than a probe of length  <dig>  we also included a combinatorial design with b =  <dig>  note that synthesis of a dsdna array with feature length of  <dig> would be very difficult if not impossible and is only used here to illustrate the properties of combinatorial design. the results of these simulations are presented in figures  <dig>   <dig>   <dig>  the simulation data shows that for rap <dig> and for random 10-mers, about 20–30% of intergenic pbm probes producing signal on the array in fact contain more than one binding site. this figure is greater than 70% for the more degenerate tata-box sequence. in all cases, the designed array, even with average probe length of  <dig> results in significantly fewer multiple site probes, showing that non-redundancy comes from our combinatorial design and not just from the reduced probe length. furthermore, results for the designed array with 25-mer probes are good enough that in doing the array analysis, one can assume a single binding event per probe. rap <dig> and the averaged data for  <dig> random sequences show ~1–2% multiple binding sites per probe. the tbp simulation results in ~ <dig> % putative multiple binding events.

signal-to-noise ratio
as mentioned above, the problem of finding precise binding sites in long intergenic sequences used in chip and pbm experiments, is traditionally addressed by gibbs-sampling and related algorithms. the reasons why gibbs sampling algorithms do not always perform well fundamentally come down the ratio of signal to noise in the dataset in question. this ratio can be estimated as the number of base-pairs involved in binding divided by the total number of base-pairs in the array probe. since the number of binding site bases in the combinatorial design remains approximately the same, and the total probe length decreases from a mean of  <dig> bp to  <dig>  we can estimate that our design reduces the signal-to-noise ratio by at least an order of magnitude. indeed, finding a 10-mer binding site in a set of 25-mers is almost a trivial gibbs sampling problem. in order to test the robustness of our designed array to experimental noise, we constructed a  <dig> bp wide pwm  of the rap <dig> transcription factor from transfac <cit>  data, containing  <dig> distinct aligned sequences. assuming, for testing purposes, that these sequences represent the entire set of rap <dig> targets, we found all the combinatorial array probes and those of one replicate  that included those sequences. we then proceeded to remove a fraction of these sequences from the probe set and substitute for them random probes, not containing the binding site. upon each iteration, we used bioprospector <cit> , a popular implementation of the gibbs sampling algorithm, to scan the sequences  <dig> times and find an overrepresented motif. we then used compareace <cit>  to calculate the correlation coefficient between the obtained motif and the original pwm that we started with. the results are presented in figure  <dig>  the motif extracted with the gibbs sampler remains essentially identical to the original, withstanding up to 50% substituted noise.

flanking sequences
the early versions of pbms were made double-stranded by enzymatic primer extension,  <cit>  which would mean that the combinatorial portion of the probe intended to assay for protein binding would be adjacent  to a constant primer sequence. of course, any such primer sequence could also contain a portion of a binding site or even an entire binding site, making it difficult to analyze the data. the more recent approach involved only a short 3-base flanking sequence on either side of the combinatorial portion of the probe, thus eliminating the problem <cit> . nevertheless, the enzymatic primer extension approach remains a valid option and has the advantage of higher fidelity, compared with oligo synthesis. it is therefore important to address the potential challenge of analyzing data from an experiment where the flanking sequence is bound on some probes and deciphering the true binding site in such an experiment.

we propose that this challenge be addressed by making a replicate array . the simplest approach would be to make a replicate array with different primers/flanking sequences. if the number of bound probes differs significantly between the two replicates, it would suggest that the flanking sequence is involved in one of them. analysis of the array with the smaller number of bound probes should reveal the true binding site and help extract additional information from the other replicate.

even with constant flanking sequence, we could solve the problem by making one or more non-identical array replicates obtained by "shifting" the probe cut sites on the superstring sequence as illustrated in figure  <dig>  the advantage of such replicate design is that, while the set of k-mers on the array remains the same, the position of each k-mer with respect to the chip surface is different. table  <dig> contains simulated examples for the case when half of the rap <dig> consensus binding site  is contained in the flanking primer sequence of the probe, thus allowing for a large number of possibilities matching in the combinatorial part of the probe. we can filter the matching probes, retaining only those replicate probe pairs that contain at least one combinatorial k-mer in common with each other. if the flanking sequence contained a portion of the binding site, the number of probes should decrease substantially after filtering, otherwise most of the probes will be retained . for cases when a portion of the flanking sequence is involved in binding, the filtering procedure will also retain some randomly paired probes but because the signal-to-noise ratio is high, the true binding site can still be easily detected by gibbs sampling.

a the first array design contains a flanking primer sequence that does not contain any part of the binding site. in the second array design, the last  <dig> bases of the flanking primer sequence  constitute half of the consensus rap <dig> binding site.

discussion
while the technological aspects of array construction have been the subject of much recent work, less attention has been paid to the oligonucleotides on these arrays in terms of experimental design. here we have laid out an algorithmic solution to the design of a dna microarray that would allow the characterization of binding specificity of any transcription factor independent of the species under study. the solution discussed here focuses on the algorithmic part of the problem and does not include some of the concerns involved in the production of such an array. however, we believe that given the recent advances in microarray technology, the arrays described here are well within the reach of current state of the art. custom arrays can be obtained from several sources such as agilent, nimblegen <cit>  and several others and new technologies for programmable array synthesis are still being developed <cit> . synthesis of the complementary strand on the arrays can be achieved enzymatically with a surface-proximal primer <cit>  or with other, more recently developed methods <cit> .

analysis of intergenic pbm data has been complicated by the fact that the sequences are long, redundant, and often contain multiple binding sites especially for factors that do not bind with high specificity. our design addresses this problem and in simulations produces data that is much easier to analyze due to higher signal-to-noise ratio. given our simulation data, it seems reasonable to make the assumption of a single binding site per probe and thus make it much easier for gibbs sampling algorithms to converge on the correct solution.

the combinatorial array design that includes all possible k-mers also has the advantage that as genome annotation continues to improve, including the validation of intron/exon boundaries and discovery of novel genes, the data obtained from such an array remains valid and relevant.

despite the probe number savings offered by the design presented here, the exponential growth of the number of probes as a function of k will limit the length of combinatorial binding sites. however, even with k up to  <dig>  the design can be applied to many important unresolved problems. applications of ideas presented here extend beyond transcription factor interactions. for instance, they may also prove useful to characterize restriction enzyme specificity, dna methylation patterns and in other systematic studies. the array could be used to study not only the binding patterns of natural dna-binding proteins, but also to analyze mutants and thus help us gain a more detailed understanding of the nature of specificity/promiscuity of these interactions as well as design new ones.

CONCLUSIONS
in this study, we present the design of a microarray containing all combinations of a dna motif for testing of transcription factor binding and other protein-dna interaction applications. the advantage of this approach is that it is exhaustive and the same exact design could be used for any genome. furthermore, uniform probe lengths and optimal non-redundancy allows for a more straightforward statistical analysis of the results. combined with recent advances in pbm technology development, <cit>  our design will enable more precise identification of true binding sites.

