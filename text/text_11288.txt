BACKGROUND
densitometric analysis provides information about the distribution of the objects of interest. if different biological states of a sample are analyzed, a quantitative comparison of the protein distributions can be performed. the current manual method is subjective and error-prone. an automated analysis can collect more data points and be more objective in the choice of locations measured.

biological model
we used canalicular bile salt secretion in liver tissue as a model to develop a workflow for automated microscopy image analysis. the canalicular membranes of adjacent hepatocytes, the most abundant liver cell population  <cit> , which limit tiny biliary ducts   <cit> , are of a particular interest here. hepatocytes continuously secret bile acids across their canalicular membrane  <cit> . cholestatic liver diseases can result from a dysregulation of transport proteins in the sinusoidal  <cit>  and the canalicular membranes  <cit> . in rat liver, the multidrug resistance protein  <dig>  as well as the bile salt export pump  are regulated on a short-term scale by retrieval from and insertion into the canalicular membrane in response to e.g. anisoosmolarity  <cit> . in induced experimental cholestasis, the amount of mrp <dig> in the canalicular membrane is reduced compared to liver tissue from untreated rats. internalized mrp <dig> was found in intracellular vesicles  <cit> . liver perfusion in rats demonstrated that hyperosmolarity leads to rapid retrieval of bsep from the canalicular membrane, reduces bile acid secretion and results in cholestasis. these protein translocations can be detected by analyzing the corresponding fluorescent microscopy images and can be quantified by toponomics methods.

manual analysis
several toponomic localization studies of bsep and mrp <dig> were published so far  <cit>  comparing transport protein distribution by manual processing of microscopic images. by means of immunofluorescence, proteins of interest  were labeled with fluorescent markers. zo- <dig> was used to localize the canaliculi, as the tight junctions delimitate the lateral from the canalicular membrane domains and the canalicular membrane of adjacent hepatocytes from the canalicular lumen. two roughly parallel zo- <dig> lines signal the presence of a canaliculus running parallel to the image plane of the microscope. an example of a suitable canaliculus is shown in figure 1a. such confocal microscopic images were manually assessed and processed previously. a standard dataset included  <dig> images of different tissue regions per biological condition, while only  <dig> measurements were performed on each image. we have developed a new method based on automated image analysis that substitutes the manual evaluation. this method is fast, unbiased and extracts information from over a thousand data points per image.

toponomics
the toponome is an account of the temporal and spatial organization of biological molecules, in particular proteins, within the structures of the organism, mainly on the level of cellular, subcellular and supercellular structures  <cit> . this analysis is also called topological proteomics or location proteomics  <cit> .

topological proteomics emphasizes the measurement of the spatial distribution of single or multiple proteins, while the term toponome describes the combined topological information in a cell and focuses on the underlying laws of this spatial arrangement. laws in this context do not necessarily mean causal relations, but models of spatial distribution. the goal of toponomic modeling is to reduce image data to a compressed description of the spatial and structural relationships. the molecular markers can be classified as functional or structural. the structural marker defines reference structures while the functional marker is the object of interest in terms of spatial relations.

spatial relations can be captured in different dimensionalities. translocation studies are based on the quantitative assessment of marker concentrations in bounded regions . protein co-localization studies can be based on measuring and evaluating isotropic distributions of distances between pixels  <cit> . if the former is described as a 2-dimensional analysis , the latter should be regarded as 0-dimensional . the method described here is based on 1-dimensional modeling . a comparable method for tissue samples is described in  <cit> .

RESULTS
spatial relationships can be described as geometrical relations between functional objects  and between functional and structural entities. to derive spatial relationships in toponomic modeling, a multi-step workflow is required:

 <dig>  establish structural entities by pattern recognition.

 <dig>  establish a representative group of objects, which we can define geometry relations for.

 <dig>  collect the geometric relations  of the population of interest as a density plot into a histogram.

 <dig>  evaluate the shape of the histogram with respect to the expectations from a biological model. behaviors distinguished in the biological model cause different distributions . ideally, a single numerical descriptor is derived that discriminates behaviors.

while the calculations  and  can easily be performed automatically,  and  are more challenging, in particular in tissue sections.  and  are highly relevant, though, for the robustness of the overall method. to capture changes in the spatial distribution with high sensitivity, establishing a suitable numerical descriptor is also very important.

algorithm
we have specified and implemented a workflow for the automated quantification of the protein translocation consisting of several methods. figure  <dig> illustrates the complete algorithm. the individual steps and the reasoning behind their choice is presented in the following sections.

structure identification
as the first step, canalicular membranes are identified in the fluorescent microscopy images using the foreground-background detection function of the software zeta  <cit> , which implements a supervised learning approach to image region detection  <cit> . representative examples of foreground and background regions  are manually labeled in the image as training data for the machine learning. within a square window a number of texture features are calculated  <cit> . the machine learning algorithm builds a classification model and extracts bit masks for the background and foreground of the whole image. high intensity fragments with high contrast to surrounding pixels are discriminated from low contrast background  <cit> . if a dataset is homogeneous and all microscopic images have a similar intensity range, the foreground detection can be trained on one image and applied to the whole dataset. in case of inhomogeneous data, training examples from several images have to be used. figure 1b shows the foreground detection result of figure 1a. the foreground regions  are considered for further processing.

in the next step, the foreground regions are refined and cleaned from noise. morphological opening  <cit>  deletes tiny objects, which might have been created by the foreground-background detection. then, all small objects are deleted from the foreground mask to exclude potentially damaged or incomplete canaliculi. subsequent morphological closing eliminates gaps, which were possibly introduced by morphological opening. a final cleaning step eliminates left over small objects.

in the following step, skeletonization of the foreground regions is performed according to euler characteristics  <cit> . the obtained skeleton is pruned by deleting short branches that are attached to the main skeleton line. pixels of the shorter branches are deleted one by one from four directions until no further deletion is possible. only those parts of the skeleton are left that extend in the direction of the long axis of the membrane segments.

pruning the skeleton is motivated by the manual strategy of selecting membrane segments for the intensity profile extraction. only long, clean and unbranched membrane segments are suitable for analysis. therefore, smaller foreground fragments and branching points with their neighbors are deleted from the skeleton .

marker distribution profiling
intensity distribution profiles are retrieved for the proteins of interest  orthogonally to the skeleton. at every pixel of the skeleton the following operations are performed. firstly, a tangent is fitted to the skeleton line at this pixel, so that the direction of this particular membrane segment is identified. then, an orthogonal line is drawn through this pixel that spreads equally to both sides of the skeleton. along this orthogonal line, the pixel intensities are extracted and recorded. similar to  <cit> , the width of the profile is increased by also adding intensity from neighboring parallel lines. an average of several such intensity profiles represents a wider profile, calculated at the given pixel. intensity profiles are extracted both for the structural marker  and the functional marker .

only a subset of the extracted intensity profiles clearly represent the translocation phenomenon. for example, in confocal imaging, profiles are not representative if the focal image plane does not cut the canaliculus in the principal axis . humans select membrane fragments that are symmetrical, contrasty and clean. in order to implement such a strategy, zo- <dig> intensity profiles are selected according to the four conditions described below.

firstly, membrane segments non-parallel to the image plane are filtered out. profiles extracted there exhibit zo- <dig> intensity peaks of unequal height, indicating that the image plane does not match the orientation of the canaliculus. therefore, the first condition restricts the height difference between the two local maxima. the second condition constrains the distance between the two peaks, as the variation range of canalicular widths is known. the third condition eliminates intensity profiles where the local minimum between the two peaks is not low enough . a small intensity difference between zo- <dig> peaks and valley might be caused by a damaged tissue region. it may also indicate that the focal plane is above or below the tight junctions, resulting in a low zo- <dig> intensity. high quality zo- <dig> profiles have two prominent peaks separated by a low local minimum, and have flat tails on the sides. noisy profiles, in contrast, show further local maxima, and are eliminated by the fourth selection criterion. only if all four conditions are fulfilled, a particular zo- <dig> intensity profile is considered to be valid. the respective bsep intensity profile is extracted along the same orthogonal line and is passed to further analysis.

bsep profiles can be normalized for a quantitative analysis in several ways. firstly, the lateral coordinate systems of profiles can be centered, compensating for skeleton lines not centered in the canaliculus. this might be caused by the skeletonization algorithm, as it uses only approximate foreground regions whose borders are not necessarily symmetric with the zo- <dig> maxima. secondly, protein distribution profiles can be normalized to a standard distance between peaks. however, in the samples we have analyzed so far, variations of the canalicular width were sufficiently small to not require such a scaling. and lastly, absolute intensity values of the profiles can be scaled to a defined range . our zonal descriptors presented in the next section, however, obviate the need for such a normalization.

the number of the extracted intensity profiles after the automated selection is still much larger than in the manual method. therefore, we rank their quality and use only the best profiles for the statistical evaluation. the parameters of the selection process are used for the ranking procedure. the first selection criterion  is used for the ranking r <dig>  the second parameter  leads to the ranking r <dig>  defined as the ratio of the central valley height to the peaks height. the smaller the values of the criteria, the higher the ranks assigned. later, an unweighted combination of r <dig> and r <dig> is calculated as the final ranking, according to which  <dig> or  <dig> profiles are taken for further analysis.

toponomic characterization
average bsep and zo- <dig> intensity profiles can be evaluated visually for each image. due to the selection process, these averages already reveal the biological structure well , as figure 4c and 4f show. nevertheless, for a toponomic analysis, quantitative descriptors have to be established that reliably distinguish different protein distributions according to the underlying biological condition. for the chosen biological model, we assume a lateral translocation of the transport protein bsep along the profile axis  with unknown extremes of regulation. we are therefore looking for a numerical descriptor that varies with the transporter distribution across the canalicular membrane and maximally distinguishes positive and negative controls.

such descriptors can be applied to an average profile as well as to all individual profiles. we have evaluated a number of different descriptors to identify those achieving the highest discrimination rate. in previous studies, protein distribution was described by the statistical variance of the bsep or mrp <dig> intensity profiles  <cit>  and no profile subregions were distinguished. however, different zones can be clearly defined in the profiles. the part of the profile between the zo- <dig> peaks  is considered to be the interior of the canaliculus, while the parts outside the tight junctions are considered to be cytoplasm. restricting the analysis to particular zones  might improve statistical significance of a descriptor. zones are identified based on the zo- <dig> profiles and are applied to the respective bsep profiles. figure  <dig> illustrates our zone model.

because of the fixed-length zones, integrals of the intensities can be compared as absolute numbers within one image. however, immunofluorescence methods do not allow absolute quantity measurements between images. therefore, relative descriptors of the protein distribution are preferred, such as ratios of intensity integrals. in the following, a number of different descriptors will be evaluated . two of them are presented as examples:

  d=sumzone2a+zone2bsumzone4a+zone4b, 

  f=sumzone5sumzone5+sumzone6a+zone6b, 

descriptor d is calculated as a ratio of bsep fluorescence intensities at the peaks of the zo- <dig> profile relative to the intensities of bsep in the cytosol far from the canalicular membranes. compared to control, the values of this descriptor are expected to decrease under cholestatic conditions. bsep internalization affects sum by broadening of the bsep intensity profile. it also leads to an elevated bsep fluorescence intensity in the cytoplasm due to immunoreactive vesicles, increasing sum. as the lengths of zones are kept constant for all profiles, values of the descriptor can be easily compared even between the images. descriptor f  represents a ratio of the bsep intensity inside the canaliculus relative to the total bsep intensity in the profile.

validation
two representative image datasets of rat livers were prepared by the university clinic düsseldorf and will be referred to as k <dig>  and t <dig> , respectively. k <dig> and t <dig>  each contain  <dig> images of different regions of the respective samples. it is known that bsep is retrieved from the canalicular membrane under cholestatic conditions  <cit> . the expected result of the automated translocation analysis is to detect less bsep in the canalicular membrane and an increased amount of bsep in intracellular vesicles in t <dig> relative to k <dig> 

the automated quantification workflow was applied to the datasets k <dig> and t <dig>  image processing followed by the automated profile extraction resulted in approximately  <dig> profiles per image. profile selection reduced this number to roughly  <dig> per image. figure  <dig> illustrates improvements of the average plots of all profiles  after the centering  and after the profile selection  for the first image of k <dig> 

then,  <dig> profiles per image were extracted manually by another expert. descriptor values and statistical variances were computed for all automatically extracted and all manually obtained bsep profiles. median and standard deviation values indicate a strong correspondence between the automatic and manual results . descriptor histograms show that both methods lead to almost equal distributions of variables.

comparison of manual and automated evaluation

as distributions of the descriptor variables are not known by default, a generally applicable statistical test has to be chosen. the wilcoxon rank sum test does not make any assumptions on the variables' distribution  <cit> . furthermore, the number of extracted profiles is not known in advance and may vary between the datasets. hence, the unpaired wilcoxon rank sum test is chosen. it describes whether distributions of the descriptor variables differ significantly or not. two samples are considered to be significantly distinct if the p-value is smaller than  <dig> .

wilcoxon rank sum tests were performed on the calculated descriptor values for the comparison of the datasets k <dig> and t <dig>  the null hypothesis assumed that no internalization of bsep took place in t <dig>  relative to k <dig> . as the wilcoxon rank sum test is sensitive to the number of data points, we evaluated the automated and the manual methods with equal sample sizes . we randomly selected  <dig> profiles from those automatically extracted and selected for each dataset. the corresponding descriptor values were used for the statistical evaluation. these operations were repeated  <dig> times, and the median p-values are reported in table  <dig> 

p-values obtained in the wilcoxon rank sum tests performed on descriptor values. for the automated method, median values from  <dig> random sampling evaluations are reported.

additionally, a simple classifier was trained to evaluate whether individual descriptors are suitable for diagnostic discrimination between different biological conditions . such an evaluation was performed for the statistical variance and the descriptor d, which exhibited one of the lowest p-values among the newly developed descriptors. a crossing point of the variable's density plots  was set as a threshold for the discrimination. after the prediction, the classifier was assessed by its precision and recall values  <cit>  .

automated and manual evaluation were reproduced in three independent cholestatic liver preparations and the respective control animals  and t <dig>  t <dig> ). bsep internalization was confirmed in all test samples with comparable p-values. as expected, the difference between the control datasets  was small and reported p-values were high . in contrast, comparison of k <dig> and t <dig>  and k <dig> and t <dig>  showed a highly significant difference in bsep distributions due to the internalization under experimentally induced cholestasis. in both cases, the results were improved by using top-ranked selected profiles. mean values of the descriptors were compared for these data .

p-values obtained in the wilcoxon rank sum tests performed on descriptor values from all accepted or the top-ranked accepted profiles.

p-values obtained in the wilcoxon rank sum tests performed on descriptor values from all accepted and the top-ranked accepted profiles.

                              μ
                              σ
                              μ
                              σ
                              μ
                              σ
discussion
rapid changes in transporter localization by endo- and exocytosis of transporter-bearing vesicles from and into the respective cell membrane have been identified as an important regulatory mechanism for cells to adapt to varying conditions. previous studies of the membrane transport protein distribution by manual analysis of fluorescence microscopy images were time consuming and error-prone  <cit> . we developed an automated quantification of the membrane protein distribution for fast and objective evaluation of experimental datasets.

image processing
initial image processing with the zeta software has demonstrated to be fast  and robust for images of different sources. foreground detection results were in all cases acceptable, as no high contrast foreground objects were misclassified. varying grades of background fluorescence, presence of further markers and staining artefacts did not disturb the stable performance. this illustrates the advantage of machine learning of model parameters over simple thresholding.

variation in the performance of the foreground-background detection has only limited influence on final results. firstly, good membrane fragments might be missed  due to bad training examples given or low contrast to the background. secondly, background regions might be classified as foreground  if the training examples have not been specific enough. in this case, the profile selection procedure will filter out bad profiles . and lastly, membrane fragments can be segmented with wrong borders, shifting a skeleton line from its optimal position. consequently, the respective intensity profiles will also be axially shifted relative to the center of the membrane fragment. however, profile selection will ensure that only acceptable intensity profiles are used for the statistical analysis. therefore, weak performance of the object detection step may lead to a reduction of the number of profiles, but will not influence the further profile evaluation.

image processing was optimized on model images with  <dig> ×  <dig> pixel resolution and a pixel size of approximately  <dig> nm. thresholds for the deletion of membrane segments were manually selected so that all big high contrast canalicular membranes with two parallel zo- <dig> intensity lines were kept. several skeletonization techniques were tested on membrane fragments, and the simplest one was selected, as the other techniques did not affect the quality of the selected profiles. generally, our method yields comparable results even with altered threshold configurations. the robustness of the method was tested on images from other sources and with different pixel sizes.

profile optimization
microscopic images of the datasets k <dig> and t <dig> were recorded with  <dig> ×  <dig> pixel resolution and a pixel size of  <dig> nm. approximately  <dig> individual profiles per image were automatically extracted. initial average profiles of the structural marker  generally did not reveal the structure of tight junctions, due to a high level of variation of individual profiles. after the profile selection, average intensity profiles were comparable to those manually extracted. as in the manual profile extraction, only long, straight and symmetrical membrane fragments were considered. we could show that the introduction of the criteria for profile selection could substitute manual profile extraction based on experience and biological knowledge .

both selection and peak-to-peak centering of the individual profiles led to a significant improvement of the average profiles. a gaussian-like distribution of zo- <dig>  did not comply with the expected structure of tight junctions. it became visible in the average profiles of the centered or selected points . however, only the average over the selected profiles  showed two symmetrical peaks and significantly reduced standard deviations.

there were approximately  <dig> profiles per image remaining after the selection procedure, compared to  <dig> profiles, which were manually extracted by biologists. consequently, the automated workflow does not only speed up the process and clean the data, but also increases the number of data points obtained for the analysis.

the suggested zo- <dig> profile selection procedure was tested for robustness and stability. two of the four criteria were varied, and numbers of accepted profiles were reported. the first threshold constrains the allowed height difference of the two zo- <dig> peaks. the second threshold limits the central valley height between these peaks. table  <dig> shows the numbers of accepted profiles from the total of  <dig> individual profiles extracted from the first image of the dataset k <dig>  the rejection percentage was found to be slightly more sensitive to the first threshold. however, no extreme dependencies on the threshold values were recorded.

numbers of accepted profiles  at different thresholds for the selection criteria.

descriptors for profiles and statistical tests
quantification of the transport protein distribution was significantly improved by the introduction of the zone model. earlier, only statistical variances of protein intensity profiles were used  <cit> . subdivision of the intensity profiles into biologically meaningful zones improved the quantitative separation of the toponomic states. wilcoxon rank sum tests demonstrated that the difference in protein distribution between images from cholestatic and control animals is more significant for the new descriptors . however, the new descriptors did not outperform the statistical variance when evaluated at the manually extracted profiles .

p-values obtained in the wilcoxon rank sum tests on the new descriptors differed significantly among each other . one factor seems to be the selection of zones employed in the respective formula. for example, those descriptors including intensities in zone  <dig> , e.g. x and a, performed worse. in contrast, descriptors, which did not include zone  <dig>  namely c, d and e, led to the most significant results, which may have physical reasons. confocal fluorescence microscopy is an optical sectioning technique, which acquires images of thin slices  of a thick specimen  <cit> . therefore, vesicle movement perpendicular to the image plane will not change the intensity, while lateral vesicle movement within the image plane can be assessed by intensity distribution profiles. if there is a low bsep signal in the zone  <dig>  it could be caused by two different situations, which are indistinguishable for a confocal microscope. either the focal plane contains only a canalicular lumen, or the canalicular microvilli membrane in the focal plane has a reduced bsep level due to the out-of-plane transporter vesicles. thus, intensity in the zone  <dig> is not directly related to membrane content. zone  <dig> can apparently be neglected in intensity profile analysis, which illustrates the advantage of the introduction of profile zones.

results of the wilcoxon rank sum tests suggested a significant difference between images from the datasets k <dig> and t <dig>  still, further evaluations showed generally significant overlaps in the density plots of the descriptor values. an example of such a density plot is shown in figure  <dig>  training of a simple classifier allowed better estimation of the descriptors' differentiation facilities. a model trained on the values of the descriptor d exhibited an f-score  <cit>  of approximately 80%. in comparison, a classifier trained on the statistical variance reached an f-score of only 68%.

the internalization degree  represents an intuitively understandable measure. in control animals, image analysis showed that approximately 56% of the total fluorescence intensity of the bsep transporter was localized between the two zo- <dig> intensity maxima . experimental cholestasis led to a reduction of the descriptor f value to 47% caused by the lateral bsep translocation from the canalicular membrane towards hepatocytes' lumen. despite being physically understandable, the internalization degree did not yield the best p-values in wilcoxon rank sum tests and was not optimal to quantify transporter internalization.

ranking of the selected profiles has proven to have an impact on the evaluation of the datasets. a stronger internalization effect was detected for k <dig> - t <dig> datasets when using the top-ranked in comparison to all selected profiles . furthermore, two control datasets  were found to be more similar based on the top-ranked profiles . consequently, the ranking procedure made statistical tests more sensitive.

statistical evaluation of the datasets of the same biological condition , or t <dig> and t <dig> ) revealed that the difference between their bsep distribution is small. it can be explained by biological variability and limitations of standardization in sample preparation. as expected, the difference between cholestatic and control datasets was much larger with very low p-values .

automated vs. manual method
the significance of statistical tests was much lower for the manual method in comparison to the tests on all of the automatically extracted and selected profiles, due to the smaller number of profiles . however, when using equal sample sizes, a very good correlation of p-values can be noted between the manual and the automated methods . descriptors x and a were the least eligible, while d and e showed the best performance.

initially, automatically extracted profiles contained noise and were measured partly at the membrane fragments unsuitable for the analysis. the introduction of the selection procedure improved the quality of the average intensity profiles, as shown by the reduced standard deviations . statistical tests on the automatically extracted and selected profiles confirmed the expected difference between the positive and negative controls, and correlated well with the results from the manually obtained profiles.

furthermore, the automated workflow processed a dataset in approximately  <dig> minutes and performed statistical tests between the datasets in about  <dig> minutes, while a human would need several hours for such evaluations.

the software would be freely available on request to anyone wishing to use it for non-commercial scientific purposes.

CONCLUSIONS
we have developed an automated method to analyze transport protein toponomics and compared it to the known manual quantification. the automated intensity profile extraction is faster and acquires a larger number of data points than the manual method. furthermore, the criteria suggested for the profile selection are fully reproducible. evaluation of the automatically and manually extracted data correlated well. several points contribute to this result. firstly, automated profile selection is comparable to the manual profile extraction based on the biological knowledge. secondly, introduction of the zone model improved the results by identification of regions, which are particularly meaningful regarding the internalization of membrane proteins. the suggested descriptors characterize the datasets better than statistical variances of complete intensity profiles. the internalization degree descriptor has a clear physical meaning and illustrates the protein retrieval from the membrane to decrease negative effects of bile acid secretion under cholestatic conditions  <cit> . however, it did not perform best among the newly developed descriptors.

the new method was tested with various configurations. even outside the optimal settings, robust results are produced. the same experiments were performed on  <dig> further datasets, including samples from a different experimental setup . in all these cases a good correlation with manually obtained results was shown. consequently, the developed translocation analysis has proven to be robust and to exhibit stable performance on various datasets.

