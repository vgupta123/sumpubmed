BACKGROUND
cancer remains a major public health challenge and the road to effective management of the disease is challenged by widespread inter- and intra-tumoral heterogeneity  <cit> . tumors at the same site of origin and identical clinical presentation may show wide differences in genomic  <cit>  and hence, functional  <cit>  architectures, leading to a diversity of underlying cellular mechanisms, drug responses and treatment outcomes. a key insight that has informed work in this area is the recognition that a tumor is an evolutionary system  <cit> , in which individual cells undergo a process of rapid mutation and selection leading to an accumulation of driver mutations and, consequently, a progression in phenotypes. though varying rates of progression result in widespread heterogeneity, a fundamental hypothesis is that a few "driver" mutations  <cit>  affecting key cellular pathways control any specific tumor type and that these drivers can be identified and exploited for effective and efficient disease management. recent research  <cit>  has shown that driver mutations function through clones of heterogeneous cells which progress through space and time. the search for such clonal populations defining robust progression subtypes and the paths leading to them remains an active area of research. various experimental and in-silico approaches have been devised  <cit>  and tumor phylogenetics  is one such strategy for interpreting the evolution of tumors using computer algorithms for phylogenetics, i.e., the inference of evolutionary trees. the result is a tumor phylogeny, or phylogenetic tree, a reconstruction of the sequences of mutations that cells within a tumor or class of tumors accumulate over the course of their progression. the trees allow us to learn markers of progression driving key steps in tumor evolution, identify and classify tumor subtypes with possibly different underlying mechanisms of action, and enable predictive modeling of future stages of progression. much prior work has shown the utility of tumor phylogenies using data from single-cell fluorescent in-situ hybridization   <cit>  and microarray technologies  <cit> . advances in deep sequencing technology, particularly single-cell sequencing  <cit> , have extended this interest by promising a granular view of heterogeneity and progression within a single tumor. single-cell sequencing, however, results in large noisy datasets, which are computationally expensive to analyze, and extending prior methods requires customizing them at different levels to accommodate new noise models. with such massive scale data becoming rapidly available, there is a need for new strategies to exploit them to derive robust progression models.

here, we propose a reference-free method for inferring genome evolutionary distance from single-cell sequencing data towards building tumor phylogenies. typically, a comparison of tumor genomes would involve their alignment to the human reference genome followed by identification and calling of aberrations of interest, usually genome copy number variations , single nucleotide polymorphisms  or other structural variations. in the case of genome copy number changes, such a method assumes an approximation of genome copy number at the individual tumor level and makes consolidation of multi-sample copy number changes challenging. our method does not rely on the availability of a well annotated reference genome and we draw inspiration from the widely used k-mer based reference-free methods  <cit>  to derive genomic measures of copy number changes among samples. we then assign a utility to this information by using it in tasks of classification and phylogeny inference. we also demonstrate approaches for evaluating the resulting phylogenies by hypothesis-testing of splits in the tree using random null models. besides computational simplicity, a reference-free method offers another advantage unique to the study of tumors: tumor genomes are massively rearranged and, hence, alignment to the reference genome can be a noisy process. our method is illustrated through its application on a publicly available breast tumor single-cell sequencing dataset  <cit> . this dataset has  <dig> cells and its analysis provides a prototype for more massive data as they become available. through this application, we conclude that our method offers advantages of  a stand-alone reference-free approach  easy comparison of multiple tumor genomes and  translating tumor copy number variation into practical use as features for classification and evolutionary inference.

methods
we describe our strategy through a series of steps performed in order. an overview of our method is presented in figure  <dig>  for our purposes, a "sample" is a single tumor cell genome and we use both terms interchangeably in the text.

starting data
we assume the input genome sequence data consists of quality-controlled short sequencing reads from which sequencing artifacts including adapters, polymerase chain reaction  primers or chimeras have been removed.

step 1: deriving the k-mer count matrix
our reference-free approach relies on using genome sequence information encoded in discrete genome marker units called k-mers, or sequences of dna of length k. for small values of k, we anticipate finding all possible k-tuples of the dna alphabet {a,t,g,c} in a sample. as k increases, we expect not to fully explore the k-mer space as the size of the human genome would limit the occurrence of all combinations of letters in the alphabet. for example, dna sequences of length 18- <dig> have been shown to have unique specificity in the genome  <cit> . if the genome were completely unique, we would expect to see n - k +  <dig> unique k-mers where n is the average genome size of  <dig> ×  <dig> base-pairs. we use a k-mer counter to generate counts of occurrences of each unique k-mer. a tumor genome can then be represented by a vector of k-mer counts. we aggregate count vectors from all samples into a k-mer count matrix which can be processed further for downstream analyses.

step 2: noise correction and normalization
there are several contributors to noise in deep sequencing data that must be considered in the model.

 <dig> noise due to sequencing error: each sequencing technology has an inherent error rate for base-calling and this is usually an error probability or score for each base of the read. for example, illumina fastq files come with phred  <cit>  scores for each base. a major consequence of such sequencing errors is confounding when calling sequence variants since distinguishing true variants from sequencing errors is a challenge. we assume that such sequencing errors would occur in a much smaller fraction and correct for it by filtering out k-mers with sparse occurrences.

 <dig> noise due to technical variation: it is widely known that sequencing depth may vary by sample or subsets of samples. the number of reads for each sample may be different due to varying experimental conditions, true differences in abundance of dna copies, nature of the contig, repeats or microsatellite regions, or other sources of noise. typically, to allow for even comparison in the absence of technical variation, counts are either normalized  <cit>  or adjusted for during analyses . we normalize the counts using total sum scaling  where the count of each k-mer is divided by the total sum of all k-mers considered in that sample to derive a compositional matrix of k-mer relative abundances for each sample. a global normalization method like quantile normalization applied to the counts directly would be less favorable in tumor data as individual samples can have widely varying genomic content. in the absence of ploidy information, we may fail to effectively differentiate between changes in genome ploidy and other forms of local copy number changes.

 <dig> noise due to random amplifications in the whole genome amplification or wga technology: noise results from unevenness inherent in the amplification technique and as a result, certain regions of the genome may be amplified in some samples and not in others. since wga was performed up-stream of sequencing to generate our test dataset, we address this unique technical limitation by only including those k-mers that are amplified or "occur" in all samples. by imposing this strict condition, we limit ourselves to a much smaller section of the genome that will be available for analyses and, thus, preferentially select for amplifications and genome ploidy multiplications at the cost of detecting truly deleted or missing genomic regions. we also cannot identify true structural rearrangements occurring in a subset of samples. for sequencing technologies not using wga, we recommend a less stringent filtering method based on occurrence of k-mers in a certain fraction of samples or by a measure of variance of individual k-mer count measures.

 <dig> noise due to alignment: the massive structural rearrangements accompanying tumor progression makes alignment to reference genomes noisy and non-robust. as our method is reference-free, we do not deal with this source of error.

step 3: dimensionality reduction and feature selection
when k increases, the computational expense of analyzing an exponentially increasing k-mer count matrix overpowers the computational efficiency of k-mer counting. in such a scenario, dimensionality reduction by selecting informative k-mers both improves downstream analyses as well as computational complexity. depending on the downstream application, we explore a few different strategies for dimensionality reduction. because our data was derived from wga assays, we only select k-mers present in all samples. in the absence of this technical limitation, we propose an alternate procedure of unsupervised filtering  <cit>  based on minimum variance or interquartile range  on normalized data . we further select informative k-mer features by testing for differential abundance followed by adjustment for the multiple testing. such a reduced k-mer feature set can be further probed for classification or functional relevance.

step 4: applications: classification and phylogeny inference
we present two applications for k-mer feature sets derived from k-mer count matrices in this paper:  predictive classification of tumor cells into different stages of progression and  inference of tumor phylogenies. assuming we have samples with different class labels - different stages of tumor progression or case-control designs, the reduced set of informative features can be used to build classifiers for predictive classification of cells.

the second application is in tumor phylogeny inference. interpretation of phylogenies depends on the characteristics of the starting data. character-based phylogenies use discrete representations of features for each sample going into the phylogeny, usually a vector of binary features. selecting robust markers of progression and discretizing them are usually challenging steps. the resulting phylogenies are easier to interpret as each split in the tree represents changes in specific features that underly the transitions between nodes, e.g., coordinates of copy number change, single nucleotide variations, etc. distance-based phylogenies are simpler in that they start with a matrix of similarities between individual samples but the non-leaf nodes are harder to interpret in terms of specific changes in features that lead to inter-node transitions. distance-based trees thus provide a global picture of evolution. here, we restrict ourselves to distance-based phylogenetics and derive evolutionary trees using distance matrices computed from the k-mer count matrix.

demonstration on real single nucleus sequencing data
to illustrate our method, we downloaded the raw sequence reads from genomes of  <dig> breast tumor cells  <cit>  from the ncbi sequence read archive   <cit>  as fastq files.  <dig> cells came from a primary ductal breast carcinoma patient; referred to as t <dig>  the remaining  <dig> were a combination of  <dig> liver metastatis cells and  <dig> primary breast tumor cells, referred to as t16m and t16p respectively, from a second patient t <dig>  matched normal cell data was not available. the original single nucleus sequencing experiment employed whole genome amplification  with random priming resulting in deep sequence reads with coverage of  <dig> reads per bin of reference genome mapped  <cit>  and an average read length of  <dig> bp. amplification artifacts were ignored for lack of information on pcr sequences. we checked sequencing base quality control using fastqc  <cit>  and found varying quality. instead of trimming poor quality reads, which is often used as a quality control step, we correct for this error source by filtering out sequences with low abundances, as we would expect with reads containing sequencing errors. due to the short size of reads, fastqc could not identify any illumina single-read adaptors that we provided in the configuration file. we expect to lose k-mers uniquely coding for adaptors during the k-mer selection and filtering stage.

k-mer inference
we used the fast k-mer counter jellyfish  <cit>  to count k-mers of lengths  <dig>   <dig>   <dig>   <dig> and  <dig> from the individual cells. the command jellyfish count -c k -o output -t  <dig> input.fastq creates the k-mer count hash, and the command jellyfish dump -c output recovers the count of each k-mer from the hash. the hashes from all cells were then merged to generate the count data matrix. the rows of the matrix are k-mer features and the columns are individual samples. the counts were normalized using tss as described earlier to derive count fractions. only k-mers present in all samples were retained for downstream analyses.

data survey
for an exploratory analyses of data substructure in the k-mer space, we perform ordination by the method of t-distributed stochastic neighbor embedding   <cit>  which is capable of capturing manifolds and non-linear substructures. we first generate dissimilarity matrices from the compositional matrix of k-mer relative abundances using the bray-curtis dissimilarity measure. bray curtis dissimilarity is commonly used for handling compositional data matrices in molecular ecology  <cit>  and is hence, an appropriate measure in our context of k-mer relative abundances. we use the r package vegan for the dissimilarity computation and rtsne for ordination. we additionally visualize the k-mer occurrence space by means of histograms.

k-mer feature selection
we used minimum interquartile range  filtering and filtered out k-mers with iqrs in the first quartile of all k-mer iqr values. we chose the non-parametric wilcoxon's rank-sum test to identify filtered k-mers differentially abundant in primary and metastatic stages of tumor progression. to adjust for multiple hypothesis testing, we used a conservative bonferroni correction on a p-value cutoff of  <dig> %. this step of global feature selection is important both for dimensionality reduction as well as for deriving a small subset of informative k-mer features. such a set can be further validated by meta-analyses for consistent differential abundance in addition to use in various downstream applications. we describe methods for two such applications in next two subsections. all statistical analyses was done using the r language for statistical computing .

k-mer counts as features for learning tasks
to test the discriminative power of the selected k-mer features to classify the tumor cells as primary or metastatic, we performed classification tasks on the k-mer feature count distribution matrix. we used two classifiers -- support vector machines  and classification decision trees -- for comparison using 10-fold cross validation to avoid overfit. we used the svm function in the e <dig> r library and the rpart function in the rpart library for model-fitting and class prediction. we assessed performance by computing average classification error for  <dig> replicates of 10-fold cross-validation.

distance-based phylogeny reconstruction
we computed euclidean distance matrices in which each non-diagonal matrix element is a measure of evolutionary distance between two samples. thus, when comparing across samples, we are comparing fractions of the genome occupied by different k-mers which approximately captures the differences in genome composition across the samples. neighbor-joining trees were built using neighbor program in phylip <cit> .  <dig>  bootstrap replicates were used to construct consensus neighbor joining trees.

analyses of resulting phylogenies
in the absence of ground truth for comparisons, we defined a test statistic for analyzing the phylogenies that would capture how well the tree partitions cells belonging to different stages of tumor progression. we would expect cells belonging to the same stage from the same tumor to be clustered closer together than cells from different tumors or stages. we defined a test statistic that would serve as the metric of separation, to be the ratio of the average distance between cells in the same class and the average distance between cells in different classes. we then sought to reject the null hypothesis that cells are randomly distributed in the phylogeny. we performed  <dig>  permutation tests to derive the distribution of the test statistic for the null hypothesis. we ascertain p-values at a significance threshold of  <dig>  for interpretation.

 teststatistic=∑pairwisedistancesbetweencellsinthesameclass∑pairwisedistancesbetweencellsindifferentclasses 

RESULTS
data survey
we demonstrate our methods through the analyses of the breast tumor single nucleus sequencing data  <cit>  described earlier. we used jellyfish to count k-mers. as k increases, the size of the hashes per sample also scale non-linearly. combining hashes of all cells further increases data matrix file sizes. for example, when k =  <dig>  the merged table is as large as  <dig> tb. since the k-mer count matrices tend to get sparse with increasing k, data subsampling can effectively reduce the matrices to sizes that can be easily manipulated. as described in the preceding section, we reduce the size of the matrices by only keeping those k-mers present in all samples. table  <dig> describes the distribution of k-mer counts with expected and observed occurrences of unique k-mers. as k increases, the number of unique k-mers actually found in the samples decreases as we would expect the size of the genome to be a limiting factor. while the true number of k-mers would be expected to saturate around the length of the non-repetitive regions of the genome, a smaller fraction of these will be observed as the k-mer length approaches the length of the sequence read. our strict criterion of screening out k-mers not found in all samples would be expected to greatly amplify the loss of k-mers as they get longer, either because of chance mutations in one or more samples, failure to amplify the entire region in one or more samples, or failure to produce a read covering an entire k-mer. on normalization by total-sum-scaling, the distribution of compositional values appears log-laplacian, as seen in figure  <dig>  during quality control, we noticed two metastatic cells from t <dig> have identical k-mer counts across values of k and, hence, removed one sample from downstream analyses.

column  <dig> lists the different "k"s explored. columns  <dig> and  <dig> describe the total number of possible unique k-mers for a given k and the actual number of unique k-mers observed in the data respectively. column  <dig> describes the k-mer counts after adjusting for sparsity and amplification noise.

k-mer feature selection
using the minimum iqr filtering approach described above, we found a 25% reduction in both 20-and 25-mer space respectively resulting in  <dig> 20-mers and  <dig> 25-mers respectively. differential abundance testing using a wilcoxon rank-sum test further reduced the space by  <dig> % and 38% for 20-and 25-mers, respectively, at a bonferroni-corrected p-value significance threshold of  <dig> . this results in a selected k-mer feature set of  <dig> 20-mers and  <dig> 25-mers. figure  <dig> shows the ordination of samples in the reduced k-mer feature space. the samples appear separated into two groups, one groups composed entirely of primary cells, and the other has all the metastatic cells from t <dig> and a smaller set of primary cells from t <dig> and t <dig>  potentially in more advanced stages of primary tumor evolution.

we used ncbi blast  <cit>  to query a few 25-mer sequences against the database of sequences of known cancer genes in order to determine specific hits of functional significance. erbb <dig> is a gene which is commonly over expressed or amplified in breast tumori-genesis is a well known breast tumor marker  <cit> . we report  <dig> 25-mers which align to the erbb <dig> gene with a single mismatch in table  <dig>  while there may be interesting information to mine in the remaining 25-mers, we tested only for the presence of a known amplicon we expected to find for validation purposes. we would expect that most biases in k-mer distributions would simply reflect random cnv diversification, but there may be other amplicons or regions of loss of heterozygosity that may be discovered in a detailed functional analysis.

column  <dig> lists  <dig> 25-mers that aligned to the erbb <dig> gene with a single-base difference in dna sequence. erbb <dig> is one of the most frequently amplified genes in primary breast cancer and a widely recognized tumor progression marker.

classification performance
10-fold cross-validation with  <dig> replicates gave us median prediction errors of  <dig>  for both svms with linear basis functions and classification decision trees . both methods classify the cells with very high accuracy. given the uneven class distribution of cells , we expect the overall accuracy to be slightly exaggerated. so, we subsampled the primary cells to yield even class distribution and performed the classification tasks described above for  <dig> replicates. the median prediction errors for svms and cart continued to remain high at  <dig>  and  <dig> . we report the classification performance error in table  <dig>  the relatively high accuracy is suggestive of the utility of k-mer based features for staging and classification.

values shown are classification errors computed as the average ratio of incorrectly classified test samples to the total number of test samples per replicate. we report results both including the entire dataset and results from  <dig> replicates of subsampling to ensure an even class distribution.

distance-based phylogenies
we report phylogenies for k =  <dig>  which yielded the largest number of distinct kmers after filtering. figure  <dig> shows the bootstrap consensus tree constructed using all cells from both samples. we may distinguish among  <dig> classes: primary cells of t <dig> , primary cells of t <dig> , metastatic cells in t <dig> . there are  <dig> broad clusters of cells based on phenotype: clusters a and d are entirely composed of primary cells from t <dig>  cluster e is similarly entirely composed of cells from t <dig>  cluster c is mostly a primary cluster dominated by t <dig> primary cells and a few metastatic cells, potentially early in their infiltrating stage. cluster b is a primary cluster with cells from both patients and a small number of metastatic cells. the phylogenies in the original tree  <cit>  have  <dig> distinct clusters for t <dig> based on ploidy and we observe that t <dig> cells are found in  <dig> distinct clusters, two of which are entirely filled with t <dig> cells. while it is hard to determine the biological meaning of the placement of tumor cells because of the lack of ground truth, we test for the quality of clustering by statistical analysis using the test statistic described in methods. the test statistics obtained for k =  <dig>   <dig>   <dig> and 20-mer trees are described in table  <dig>  in all cases, the values had a p-value of less than  <dig>  when compared to the mean value obtained from the permutation tests. this confirms that the placement of samples is the tree is non-random. the phylogenies in the paper that originally generated the data used  <cit>  were built by aligning the genomes to a reference. a full head-to-head comparison to their approach is not feasible because  information on leaf node labels are not available  the authors color leaf nodes by ploidy and this information cannot be matched to the cell names provided in sra and  we do not actually know the ground truth answers. while lack of a ground truth is often handled in the phylogenetics literature through simulated data, technologies for single-cell sequencing are sufficiently new and advancing sufficiently rapidly that we do not have simulation models one can trust to faithfully capture the challenges of real data. to better address these issues despite the challenges, we have conducted an indirect comparison using phylogenies built per patient and looking at the number of major clusters and ordering of cells on the tree for t <dig> to check for similarities to the clusterings found in the original paper. figure  <dig> shows the bootstrapped consensus neighbor-joining tree constructed from both primary and metastatic cells in t <dig> for k =  <dig>  we observe  <dig> distinct clusters: cluster a has sub-clusters, majority of which have no mixing and are either entirely metastatic or primary. cluster b is dominated by primary cells. cluster c is a more even mix of primary and metastatic cells. the original paper has neighbor-joining trees built based on copy number profiles and breakpoint regions for the two patients individually. the trees in the original paper for t <dig> have two major clusters colored by ploidy, both of which are a mix of primary and metsatatic more similar to clusters a and c. our phylogenies show a more granular clustering scheme. while we cannot definitively say our results are better or worse than theirs, our analyses do show that they yield comparable groupings of cells. we can therefore establish that our method yields a qualitatively similar partitioning of cells to navin et al.'s  <cit>  reference-based method, while avoiding the computational issues raised by mapping to a reference genome.

column  <dig> is the test statistic that served to capture how well cells from the same stage of progression cluster. column  <dig> describes null distribution characteristics derived from permutation testing. column  <dig> is the probability of occurrence of the test statistic in the null.

CONCLUSIONS
we have described a strategy to derive distance-based tumor phylogenies from whole genome sequencing data. k-mer counting provides an efficient way to go from genome sequences to informative markers of differences in genome copy numbers. in addition, selecting k-mer counts as features to represent genomic imbalances adds utility for practical applications of classification and staging. we show how evolutionary models derived from the k-mer relative abundances can be used to build phylogenies and demonstrate a method to analyze the resulting phylogenies as a measure of how well they partition different stages of tumor progression. while the current contributions are mainly methodological, future directions include applying the strategy to larger real datasets towards inferring biologically significant observations from the resulting phylogenies. the availability of single-cell sequencing data is still limited and the method is likely to have more potential, especially with regard to novel biological discovery, when more data with clinical covariates become available. further, the list of k-mer features can be used in other applications not explored in the paper. for e.g., they can be further tested for consistent differential abundance through meta-analysis or specific experiments to gauge functional relevance.

we have demonstrated that genome dosage differences represented by k-mers can separate tumor progression phenotypes with reliable classification performance. our results suggest that there is enormous redundancy in phylogenetically informative copy number variation across the genome and, in particular, that one does not need to see more than a small fraction of the genome in a solid tumor to identify cells from a given lineage. extensive diversification by copy number variations is a common feature of solid tumors  <cit> , so it is unsurprising that examining copy number status of a random subset of the genome would often allow one to robustly distinguish between two possible tumors of origin for a given sample. this observation has important implications for efforts at tumor phylogeny construction, since it argues that one can perform tumor phylogenetics reliably with fairly little data on individual tumor cells. our k-mer approach is so far unusual for the field, though, in exploiting this enormous redundancy of phylogenetically informative variation in single tumors.

competing interests
the authors declare that they have no competing interests.

authors' contributions
both a.s and r.s conceived the research idea and wrote the manuscript.

a.s implemented the workflow and performed experiments.

