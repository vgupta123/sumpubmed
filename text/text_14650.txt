BACKGROUND
alternative splicing  is a post-transcriptional regulation mechanism that allows a single gene to produce multiple mrna transcripts. some of the roles of as include regulating gene expression in response to environmental stimuli and developmental changes  <cit> . in addition to contributing to protein diversity and regulation, some variants of as may be nonfunctional and quickly degraded, providing gives cells another mechanism to regulate gene expression after transcription but before translation. as occurs as a normal phenomenon in eukaryotes and is more abundant in higher eukaryotes than in lower eukaryotes  <cit> . more than 95% of human genes and 60% of drosophila multi-exon genes are alternatively spliced  <cit> . in plants, 61% of intron-containing genes undergo alternative splicing  <cit> .

although there is no consensus classification of as types, the five standard types are skipped exon , alternative 3′ splice site , alternative 5′ splice site , mutually exclusive exons , and intron retention   <cit> . animals and plants differ in their most common types of as events. se is the most common as type in humans , but the least common type in plants   <cit> . intron retention is the most prevalent as type in plants  but the least prevalent type in humans  <cit> . this difference suggests plants and animals may recognize exons and introns in different ways  <cit> . also, as does not always occur as one of the simple events described above; combinations of multiple simple as events are common. in arabidopsis, multiple exons may be skipped together and/or exon skipping occurs in the company of alternative 5’ and/or 3’ splice sites  <cit> . such complex as events are abundant in arabidopsis latest annotation version, tair  <dig>  <cit> .

some evidence also suggests that plants and animals may regulate as in different ways. for examples, plants possess nearly double the number of sr proteins as compared to nonphotosynthetic organisms  <cit> . sr stands for serine-arginine-rich proteins, a conserved family of pre-mrna splicing factors. interestingly, most sr proteins   <cit>  are themselves alternatively spliced and some studies have linked the as of several sr proteins  to environmental signals. as is believed to play a critical role in helping plants adapt to their environment and may increase our understanding of plant and crop phenotypes  <cit> .

the advent of rna-seq has increased the observed frequency of as in plants from 30%  <cit>  in the pre-ngs era to 61%  <cit> . as rna-seq becomes the new standard for studying gene and transcription expression, a key problem is to detect condition-specific differences, such as differential expression and differential alternative splicing. to date, dozens of methods for detecting differential as using rna-seq have been published. most of the methods are designed for and tested on human, mouse and other mammals. their performance on rna-seq data from plants remains in question due to the differences in as machinery between animals and plants. recent review papers  <cit>  compare differential alternative splicing detection methods with respect to methodology but do not evaluate performance under realistic conditions. another two publications  <cit>  benchmark methods and algorithms for transcript reconstruction and quantification. to our knowledge, this study is the first to systematically compare differential alternative splicing methods using rna-seq in plant systems.

selection criteria and limitation of this study
this work benchmarks eight popular methods for differential as according to the three criteria given below: effectiveness, biological replicates and software engineering. effectiveness: the method should detect differential as across samples. note that this is not necessarily equivalent to isoform quantification problem as changes in the absolute isoform expression do not necessarily imply differential alternative splicing  <cit> .

biological replicates: the selected method should be able to take advantage of biological replicates in the rna-seq data sets.

software engineering: the method has to be implemented as a usable and robust program so that a scientist with limited computational skills can run the program regardless of understanding the theory behind it.



for example, under these criteria, some methods are ruled out for inclusion in this study. e.g., splicetrap  <cit>  only quantifies alternative splicing within a single condition and miso  <cit>  and psginfer  <cit>  do not support biological replicates. our list of programs is not exhaustive; however, we have selected a set of programs which represent a variety of approaches. due to our limited human resources and computational power, the current versions of fdm  <cit>  and juncbase  <cit>  met our criteria but were excluded from this study. fdm uses a splice graph representation of aligned rna-seq data and jensen shannon divergence  to measure the difference in relative transcript abundances. juncbase uses exclusively reads spanning exon-exon junctions. these concepts are well represented by the other methods we have compared in this study. importantly, our testing pipeline and the input data needed to run the simulation are available in a github repository, https://github.com/ruolin/asmethodsbenchmarking. the whole pipeline is documented, interested readers can repeat the study and test the results with their preferred differential as detection tools.

method classification
methods for detecting as may be categorized into two quantification schemas: count-based models and isoform resolution models . these two terms are based on the classification nomenclature defined by pachter in  <cit> . we selected eight methods and evaluated them based on simulated and real data. six of them are from count-based models: dexseq  <cit> , dsgseq  <cit> , splicingcompass  <cit> , mats  <cit> , rdiff-parametric  <cit>  and seqgsea  <cit> . the remaining two, cufflinks  <cit>  and diffsplice  <cit> , use isoform resolution models. a brief overview of the eight methods follows.figure  <dig> 
quantification schema. a simplified gene model consists of two expressed isoforms . exons are colored according to the isoform of origin. two model types used for quantification purpose . in the count-based models , reads are assigned to counting units  without ambiguity. for each counting unit the model can be viewed as a test on two possible outcomes . the isoform resolution model is shown on the right where two ends of a read pair  align upstream and downstream of an alternative donor site. l
i <dig> is the length of alignment of fragment f to isoform i <dig>  and is shorter than l
i <dig>  therefore if the fragment size distribution is known, it is possible to infer which isoform is more likely to generate f. note that transcript effective length, i.e. l
i <dig>  l
i <dig> and other parameters  might also affect the probability of assigning reads to isoforms. usually a maximum likelihood based approach is used to optimize this probability.



count-based models
the count-based models are based on the methods used to quantify transcripts with single isoforms. the number of reads falling on a transcript , like rpkm , is used as an estimate for abundance  <cit> . count-based models are commonly used in differential gene expression. for differential splicing, the count-based models are modified to count reads in smaller counting units  rather than the whole transcript regions. also the focus changes to the differential expression of the counting units. count-based models usually configure each gene into a single representation consisting of counting units. counting units can be full or truncated exonic regions , or junction regions . although the count-based model does not directly address the issue of quantifying isoform abundances, the dsgseq authors prove that the reads at counting units can fully reflect isoform expression as long as there is no isoform that can be composed by the combination of other isoforms  <cit> . the count-based model can be seen as testing of two possible splicing outcomes, inclusion and/or exclusion, of each counting unit. some papers refer to this model as an event-based model  <cit> . methods using the count-based model are usually dependent on existing annotation on the gene structure and typically employ poisson, generalized poisson or negative binomial  distributions to model the read counts on counting units. for rna-seq, the nb distribution is considered better suited for the analysis of biological replicates than the poisson distribution, as it is able to account for overdispersion in replicate counts  <cit> .

seqgsea  <cit>  and dsgseq  <cit>  are examples of count-based models. these two methods are similar in many ways. given a known set of transcripts at a locus, they both flatten these transcripts into a union transcript consisting of counting units . both dsgseq and seqgsea model the number of reads that fall on the counting units as nb random variables after adjusting for overall gene expression. for a given gene, they calculate p^ij as the expected read count fraction of counting units i in group j and variance of p^ij. both methods define a gene-wise statistic to measure the difference in the expected read count fraction across two conditions by averaging over all counting units and adjusting for variance. both methods mention that the null distribution is hard to obtain based on such statistics. seqgsea uses a permutation based approach to calculate the p-values while dsgseq just reports the statistics and does not calculate the p-values. both dsgseq and seqgsea report which gene is alternatively spliced. a novel as gene can be predicted only if an annotated constitutive exon is found to be a skipped exon. dsgseq can also tell you where the skipped exon may actually occur.

like seqgsea and dsgseq, dexseq  <cit>  transforms known gene models to sets of counting units  based on any possible splice sites. the difference is that dexseq uses a generalized linear model  to detect the differential usage of counting units. the glm in dexseq assumes a nb model for the counts. dexseq reports which counting unit is alternatively used across conditions and, like seqgsea and dsgseq, a novel skipped exon can be predicted only on an annotated constitutive exon.

the rdiff  <cit>  package consists of two methods: rdiff-parametric and rdiff-nonparametric. rdiff-parametric is a count-based model. unlike other count-based methods it only makes inference on regions that are not shared among all isoforms . rdiff-parametric uses the nb distribution to model the number of reads on counting units to account for biological variance. unlike seqgsea and dsgseq, the variance is calculated from an empirical variance-mean relationship  <cit> . a p-value is calculated on each alternative region within a gene, and bonferroni correction is used to obtain a genewise p-value. as a result, rdiff-parametric reports which gene is a significant as gene but no novel as gene can be found. the bf correction is known to be very stringent,which could explain why rdiff-parameteric has very low recall but high precision .

mats  <cit>  first retrieves all as events from input gene models and annotates the identified as events with the corresponding as types . more specifically, it cannot detect novel as events and only retrieves the simple as events, not complex ones. mats calculates a statistical metric called exon inclusion level, ψ, which is the proportion of the reads that exclusively support one outcome of the events to reads that exclusively support another outcome of the identified events. the exon inclusion level is always between  <dig> and  <dig>  then, the posterior probability of the difference of exon inclusion level across two samples which is larger than a user-defined cutoff, denoted p, is calculated. mats reports which as event is significant rather than which gene is alternatively spliced. mats differs from other count-based model methods in that it uses bayesian approaches. it is also the only method that does not assume independence of two biological conditions. a bivariate uniform prior is used to model the dependence. information across genes is borrowed in the process of estimating the common prior. although the method in mats’s original paper is only designed for a two sample comparison, the latest version of mats  accepts multiple replicates. however, it is unclear how the program models biological variability.

like dexseq and dsgseq, splicingcompass  <cit>  uses a union transcript model for each gene. however, it does not utilize any statistical model based on the counting process. splicingcompass first constructs vectors of read counts on exons as well as on splicing junctions for each gene and sample, then calculates pairwise geometric angles between two vectors. finally, a one-sided t-test comparing the within condition angles and between condition angles is carried out for each gene. splicingcompass reports which gene is as gene based on the t-test. therefore a novel as gene can be found if the aforementioned test turns out to be significant. again only se can be detected.

isoform resolution models
isoform resolution models  are multi-isoform models. instead of transforming the question into detecting differential usage of counting units, they seek to directly solve this problem by comparing the relative isoform abundance across samples and/or conditions. the estimation of the isoform proportion vector q is usually done by maximizing a likelihood function l. maximizing this likelihood function is equivalent to maximizing the likelihood of selecting a read or fragment from a transcript  <cit> . isoform resolution models try to assign reads or fragments to the transcripts they came from at the cost of introducing additional uncertainty in read assignments due to the overlap between isoforms. in count-based models there is no ambiguity in assigning reads toward counting units. it is worth mentioning that this question is also connected to the question of transcriptome assembly as novel transcripts are found in nearly every rna-seq study  <cit> .

cufflinks  <cit>  and diffsplice  <cit>  are examples of the isoform resolution models. cufflinks contains three independent but connected programs: cufflinks, cuffmerge and cuffdiff. cufflinks assembles and quantifies the aligned reads while cuffdiff performs differential testing. cufflinks uses a linear model  <cit>  which includes a specific parameter for fragment length. this differentiates cufflinks from other methods by allowing cufflinks to take advantage of insert size information in paired-end data. in this sense, cufflinks is more appropriate for paired-end reads. the estimate of relative abundance of a transcript is reported in the form of fpkm  which is equivalent to rpkm in the single-end case. cuffdiff performs tests for relative isoform abundance changes  using a one-sided t-test of the jensen-shannon divergence metric  <cit> . cufflinks is able to assemble transcriptomes and is thus less dependent on the accuracy of gene annotation.

rigorously speaking, diffsplice <cit>  is not “isoform resolution” but “alternative paths resolution”. in diffsplice, the alternative paths stand for the paths from the alternative spliced module  in spliced graphs and each asm has at least two alternative paths. an asm is a region in splice graphs where isoforms differ from each other. asm seeks to minimize the ambiguity in isoform resolution by only considering regions that are not shared by all isoforms. diffsplice tests differential splicing on each asm instead of whole transcripts. the relative abundances of alternative paths are estimated using the maximum likelihood method. the difference of the relative abundances compositions is measured using jensen-shannon divergence metric . both the diffsplice and cufflinks models are extensions of the model of  <cit> . cufflinks extends the model to the paired-end case while diffsplice restricts it to asms. like cufflinks, diffsplice is also capable of assembling the aligned reads onto the transcriptome. therefore, both programs are able to detect novel as events that are not in the annotation. however, the cuffmerge from cufflinks packages can merge the assembly with annotations to provide gene models with higher confidence while no previous knowledge of gene models is used by diffsplice. in other words, annotation is not used in diffsplice.

RESULTS
these differential as detection methods were first evaluated using simulated data with known ground truth, where we could control the level of differential splicing across conditions and other factors that may affect detection. the nb distributions were used to simulate read counts on genes. the mean and dispersion parameters for the nb distributions were estimated from heat shock data  <cit> . the  <dig> genes that are known to have at least two splice variants in the arabidopsis tair  <dig> reference annotation were focused on in the simulation studies. using our custom simulation pipeline , a set of  <dig> genes was randomly chosen from the overlaps between the  <dig> known as genes and genes that have non-zero expression in real data sets. these  <dig> genes were simulated to be alternatively spliced and are referred to as “true as genes”. details about the simulation settings and procedures can be found in the methods section.

in the simulation study, we evaluated the robustness of the methods by varying the degree of differential splicing, read depths, sample sizes and dispersion setting in different conditions. we set high, medium and low levels for as ratio, two dispersion patterns and three levels of read depth . in addition, we have compared the computational time required for running the analysis . we used two dispersion settings in the simulation. one allows the two conditions to use two different dispersion parameters in the nb distributions which are estimated from two replicated real rna-seq data sets, whereas the other forces both conditions to have the same dispersion parameter which is estimated from the pooled rna-seq data sets. we call these two settings different dispersion pattern versus same dispersion pattern . we also investigated the effect of sample size, from  <dig> to  <dig> samples per conditions. a simple notation high100×diff means a condition of read depth at  <dig>  different dispersion pattern and high as ratio across conditions.

all of these evaluations were carried out in terms of the receiver operating characteristic  curves and the area under the curve  metric. the roc curve depicts the true-positive rate  of a method for different false-positive rates  by varying the threshold for given scores. tpr is defined as the proportion of the events that are known to be differentially spliced that test as positives. similarly the fpr is the proportion of the events that are known not to have differential splicing that test as positives. as almost all as detection software packages tightly control fpr, we restricted the roc curves to the range of 0− <dig>  . the area under the roc curve, or auc, is the numerical measurement that summarizes the roc curves. here we calculated the auc under the restricted roc curves. methods with larger auc have better performance. the results of all simulation studies under the measurement of auc are summarized in table  <dig> figure  <dig> 
roc curves evaluation for three levels of as ratio when two groups of samples have the different dispersion pattern. roc curves for eight selected methods in simulation studies high100xdiff , medium100xdiff , low100xdiff . these roc curves are obtained at a simple size of  <dig> for each condition. when the level or degree of ds across conditions become smaller , the power of discrimination of true-ds and non-ds drops significantly. however the relative ranking of each methods tend to be unchanged. dexseq perform consistently the best with respect to all three simulation studies.
roc curves evaluation for accurate and incomplete annotation. roc curves for eight selected methods using simulation study high100xdiff with complete annotation  and incomplete annotation . isoform resolution model methods, such as cufflinks, are more robust to incomplete annotation compared with count-based models methods.
roc curves evaluations for three splicing classes. roc curves of eight selected methods based on  <dig> genes containing single splicing event from simulation study high100xdiff. these  <dig> genes were further divided into three splicing event classes:  <dig> genes with alt. donor/acceptor sites ,  <dig> genes with intron retention ,  <dig> genes with exon skipping .
area under the roc curve  and relative ranking measured under all simulation studies


cufflinks
dexseq
mats
spcomp
dsgseq
rdiff-param
diffsplice
seqgsea

high100xdiff
 <dig> 

medium100xdiff
 <dig> 

low100xdiff
 <dig> 

high100xsame
 <dig> 

medium100xsame
 <dig> 

low100xsame
 <dig> 

100xhighdiff
 <dig> 

60xhighdiff
 <dig> 

25xhighdiff
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
 <dig> 
larger values of auc indicate better performance. the table contains the auc and relative ranking for the methods under all simulation study. the best method under each study is highlighted in boldface. the ranking position is shown in the parenthesis. a3a5ss stands for the joint class of alternative 3’ splice site event and alternative 5’ splice site event. ir stands for intron retention event and se stands for skipping exon event.



as roc curves and auc measure the discrimination power between non-differentially spliced  gene and differentially spliced  gene over an interval, scientists are often interested in the discrimination power at a single cutoff point. therefore the recall and precision at a padj= <dig>  cutoff were used as a additional set of evaluation metrics . recall is equivalent to tpr while precision is the proportion of the events that test as positives that are actually true discoveries. precision is also known as 1−falsediscoveryrate. evaluating on precision examines whether the methods are able to control the fdr at the claimed  <dig>  level. dsgseq does not return p-values and was excluded from this evaluation and seqgsea did not report any gene under fdr= <dig>  when the sample size was  <dig>  the results of other seven methods under the measurement of recall and precision or fdr at padj= <dig>  are summarized in table  <dig> table  <dig> 
recall and precision at
p
adj
= <dig> 
 measured under all simulation studies


cufflinks
dexseq
mats
spcomp
rdiff-param
diffsplice
seqgsea
rec.
prec.
rec.
prec.
rec.
prec.
rec.
prec.
rec.
prec.
rec.
prec.
rec.
prec.

high100xdiff

medium100xdiff

low100xdiff

high100xsame

medium100xsame

low100xsame

100xhighdiff

60xhighdiff

25xhighdiff
a3a5ss stands for the joint class of alternative 3’ splice site event and alternative 5’ splice site event. ir stands for intron retention event and se stands for skipping exon event. recalls were shown as the numbers in the left column, precisions in the right column. larger values of both metrics are better. under a sample size of  <dig>  seqgsea found no genes at p
adj
= <dig>  and therefore no values were reported.



for the real data, we first compared the results obtained by the different methods in terms of absolute number of significant as gene calling, the overlap of results across software and the concordance of gene rankings. we further compared these results to a list of experimentally validated genes that are known to be alternatively spliced in response to ambient temperature changes. finally we carried out an semi-rt-pcr study and compared the results of the computational methods using rna-seq to the results from rt-pcr.

the effect of different levels of as ratio in conjunction with dispersion pattern
since the difference required between two isoform compositions to be biologically significant enough to call as differential splicing is an open question, we defined a parameter palt  to control the level of differential splicing in our simulation. palt, whose range is from 0− <dig>  simply represents the relative abundances of alternative isoforms for given genes. for multi-transcript genes, we randomly chose one transcript as an alternative isoform while the rest of isoforms remained as standard isoforms across conditions. for each of given genes, all standard isoforms have relative abundances which summed to 1−palt. the palt for  <dig> true as genes was set to  <dig>  in the control group and  <dig> ,  <dig> ,  <dig>  in the three treatment groups, corresponding to low, medium and high as ratio levels. we investigated the effect of varying the as ratio level under two dispersion patterns. as a result we carried out  <dig> simulation studies and denoted them in the format of high100xdiff, representing the situations for high as ratio, different dispersion patterns for two conditions and 100x read depth.

the restricted roc curves of the  <dig> selected methods based on  <dig> simulation studies on different dispersion patterns are shown in figure  <dig>  as palt changed from  <dig>  to  <dig> , the difference between the isoform compositions under the two simulated conditions became smaller. all methods lost their discrimination power as the signal of differential splicing became weaker. the results from simulation studies with the same dispersion pattern were similar and are shown in the . when two simulated conditions had different dispersion patterns, dexseq performed well in high and medium as ratio situations but not in the low as ratio situation. . when two conditions had the same dispersion pattern, dsgseq consistently performed the best out of the  <dig> methods . as we focused on the low as ratio in both dispersion situations, cufflinks performed the best.

both auc and recalls were affected by the change of the as ratio but the effect on recalls seemed to be larger. taking cufflinks as an example, the recall rates were 57%, 40% and 3% at high, medium and low levels of differential splicing respectively . however the auc dropped only 14% from high to low alternative splicing ratio . it is not surprising that auc is a more robust measurement than recall and precision. but it is not uncommon for people to use a single cutoff point, e.g. declare significance at fdr= <dig> . in this sense, the low as ratio has a severe impact on the discrimination power . diffsplice achieved the highest recall in both low100xdiff and low100xsame. however, its performance under the measurement of auc  was far from satisfactory since many as events were not detected by using asm and some detected asms were simply artifacts. in the baseline simulation study high100xdiff,  <dig> asms were reported by diffsplice and  <dig> of them resided at least 1kb away from coding regions.  <dig> asms were even longer than the longest gene  in arabidopsis tair  <dig> model.

when considering the ability to control for false discoveries, all methods except mats performed more poorly when the as ratio became smaller . only mats was able to control the fdr at all levels of as ratio and dispersion pattern. splicingcompass and rdiff-parametric could control the fdr at the desired  <dig>  level in the simulation studies with high as ratio but failed at low as ratio, low levels of coverage. dexseq and rdiff-parametric’s abilities to control fdr improved if the data shared the same dispersion pattern across conditions. with same dispersion pattern, rdiff-parametric was able to perfect control the fdr in all three as ratios while dexseq achieved the desired fdr level on low as ratio but not on high as ratio. although dexseq had the best performance in terms of auc, it did a poor job in controlling the fdr .

detecting novel splicing events
we simulated rna-seq reads using the latest arabidopsis tair  <dig> gene sequences and models. this implies that no as event is novel to this annotation. theoretically methods that use annotation information should be able to find all candidate as regions provided the annotation is correct. however in a real rna-seq study, even in model organisms, there may be many novel splicing events. to simulate this case, we deliberately removed the mrna model of the alternative transcripts from annotation for the set of true as genes. the relative abundances of alternative transcripts are controlled by palt and are the dominant force in the simulated as events. by running the software using this incomplete annotation, we evaluated their abilities to detect novel splicing events. this comparison was evaluated on the baseline simulation study high100xdiff . except for diffsplice, the performances of all other methods were degraded. because diffsplice does not use annotation information, its performance did not change. overall, cufflinks was more robust to incomplete annotation than other methods. mats and dexseq’s performances dropped significantly, suggesting that these two methods are very dependent on accurate annotation.

the effect of different as types
based on the gene models and sequences of the  <dig> annotated as genes in tair  <dig> annotation, we simulated  <dig> true as genes to be differentially spliced. however, most of the genes  have more than one as type. this made testing the performance in terms of the effect of different as types difficult. also as some methods, e.g. mats and diffsplice, test on individual events or local regions while others work on the gene level, the previous comparisons were not based on common ground. to overcome these problems, we picked out  <dig> genes that have exactly two transcripts and a single splicing event from the  <dig> genes. we then reevaluated all methods on these  <dig> genes in the baseline simulation study. this equated the detection on a gene level to the detection on a splicing event. we classified these  <dig> genes into three new sets by their splicing event types which include exon skipping, intron retention and alternative donor/acceptor sites . we treated alternative donor sites and acceptor sites together as a single class because there is almost no difference in detecting them from mathematical and computational perspective.  <dig> genes had an alternative donor or acceptor event,  <dig> showed intron retention and  <dig> demonstrated exon skipping and about one third of genes in each new set were pre-selected as genes . we evaluated the eight methods in each category. this is a simplified scenario where a gene has exactly one as event.

dexseq achieved the highest auc in two of the three simple event classes, ir and se, . in these two cases, the exons or introns are either included or excluded as a whole. however in the cases of a3ss and a <dig>  the counting units could be as short as several bps. dexseq may not have enough read counts to perform reliable statistical tests in such short regions. we observed that cufflinks which uses isoform-resolution models perform the best for a3ss and a5ss. when the complex as events were excluded mats’s improvement was very significant. the averaged auc for mats was  <dig>  when complex as events were included. while it averaged at  <dig>  in the simplified scenarios . this agrees with our observation that mats is not capable of discovering complex as events. in the simple scenario mats acquired the highest recall and lowest fdr at padj= <dig>  threshold in all simple as events . as we looked at the individual types of as events, dsgseq performed well for detecting ir but not so well on other splicing types. similarly, cufflinks performed well at a3ss and a5ss but poorly with other as types, indicating a bias in detecting different as types.

the effect of sample sizes and read depth
the increase in sample size from  <dig> to  <dig> did not have a significant impact on the auc statistics and the methods’ rankings based on the auc . even for the recall and precision statistics , the increase in sample size had a small impact for all methods except for splicingcompass and seqgsea. recall for splicingcompass increased from 14% to 50% when the sample size increased from  <dig> to  <dig>  seqgsea was not statistically significant at fdr= <dig>  for a sample size of  <dig> but achieved a recall of 95% at the cost of having a low precision  in a sample size of  <dig>  however the roc curves and auc statistics for seqgsea were almost the same for the different sample sizes . a possible explanation is that the permutation-based approach used in seqgsea may scale the padj according to the sample size. therefore, we would recommend a sample size between  <dig> to  <dig> for using seqgsea.

most methods were robust to different read depths or coverage of rna-seq with a minor drop of discrimination power as read depth decreased . however it is interesting to note that cufflinks achieves its best discrimination power at rd <dig> and ranked 1st among all methods at this read depth . this may suggest that cufflinks performs better when read depth is around  <dig> 

real rna-seq data from arabidopsis heat shock experiment
in addition to the simulated data, we also evaluated the methods on heat shock rna-seq data sets  <cit> . the results of eight selected programs on real data are given in the additional file  <dig>  three rna-seq samples were generated from heat shock t <dig> group and two from control t <dig> group . all the eight methods except for diffsplice are able to handle the unbalanced design with different sample sizes. for diffsplice, we took out one sample from the heat stress group to make it a balanced design. all genes found to be as at the threshold of fdr= <dig>  were consider statistically significant. dsgseq does not report a p-value and therefore was not used for this comparison.

we first compared the number of significant as events found by each method . seqgsea did not find any gene with significant as. this result was consistent with our simulation studies that seqgsea usually requires a sample size larger than  <dig> to declare significance at the fdr= <dig>  level. for the rest of the methods, the highest number of significant as events was found by cufflinks, followed by mats and dexseq. the most conservative method was splicingcompass as shown in table  <dig> table  <dig> 
the number of shared differentially spliced genes detected by the selected methods for the heatt <dig> data set


diffsplice
cuffdiff
dexseq
mats
rdiff-param
splicingcompass

diffsplice

cuffdiff

dexseq

mats

rdiff-param

splicingcompass
the table contains the number of significant differential spliced genes that reported by each methods  and numbers that are shared with another method.



we also examined the overlaps of the set of significant as genes found by each methods . from table  <dig>  we noted that splicingcompass was very conservative  and was also very “unique” in that it almost did not share any significant ds genes with other methods. the venn diagram  did not include splicingcompass. the results showed that the methods were very different from each other in that there was no gene that found by all five methods and that the proportion of genes that were found exclusively by each method was more than half. rdiff-parametric had  <dig> % genes that were shared by at least one other methods. it was the only one that was close to 50% level. dexseq shared 40% of rdiff-parametric reported ds genes.figure  <dig> 
venn digram of heat shock data set. overlap among the set of ds genes found by  <dig> methods. splicingcompass is not included because it almost shares nothing with other methods based on table  <dig> 



we further compared the results of all eight methods by investigating the correlation of gene ranking scores . we computed the spearman rank correlations between all pairs of the eight methods and visualized it using a heat map . the correlations were calculated based on the ranking scores from  <dig> common genes that were reported by all methods. the highest correlation was observed between dsgseq and seqgsea as both methods use nb statistics . overall, the correlations were very low which indicated that these methods tended to rank genes differently with respect to alternative splicing.figure  <dig> 
heat map for correlation of the gene ranking scores obtained by the different methods for heat shock data set. the correlations are generally low for any two methods, indicating the methods are very different. two methods both using nb statistics  achieve the highest spearman rank correlation of  <dig> .



a list of experimentally validated as genes which are known to exhibit as in response to temperature changes
since there have been studies that have linked some genes to alternatively spliced variants in response to heat stress, we came up with a list of six experimentally validated as genes based on a search of the literature. at1g <dig> encodes lhy, a transcription factor involved in regulation of circadian rhythm. an a3ss event, encoding a 3-nt difference, has been found to occur as the ambient temperature changes  <cit> . this alternative splicing event has been confirmed by high resolution rt-pcr  <cit> . at1g <dig> encodes sr <dig>  a member of sr proteins. at1g <dig> has two splice variants which differ by a 21-nt sequence which is present in sr <dig>  but absent in sr <dig>   <cit> . it has been found that the relative abundance of sr <dig>  is increased as temperature goes up  <cit> . another two sr proteins, sr1/sr <dig>  and sr <dig> , have been reported to be alternatively spliced in response to heat stress  <cit> . in both cases, relevant transcripts differ by several hundred nts . all of the above as events are a3ss. at1g <dig> encodes flm, a mans domain protein which regulates flowering. a mutually exclusive exon event has been found in this gene which is subject to temperature changes  <cit> . the p5cs <dig> gene  contains an exon- <dig> skipping event that is subject to temperature variation  <cit> . the sr45a gene  also contains an alternatively spliced internal exon and the proportion of exon-skipped transcript increases when exposure to heat stress. we illustrate the sr45a gene model and junction read alignments in different conditions using the integrated genome browser  <cit>  . similar illustrations of the read pileups for the rest of genes are given in the additional file  <dig> figure  <dig> 
sr45a. heat-induced differential splicing of arabidopsis gene sr45a  encoding an rna-binding protein involved in splicing. tracks labeled hot and cool contain exon-exon junction features inferred from spliced read alignments from heat-treated  and control samples . junctions with fewer than five supporting reads are not shown. two annotated gene models for sr45a are shown in the track labeled tair  <dig> mrna. taller blocks indicate translated regions of the gene model. note that inclusion of an internal exon introduces a premature stop codon that interrupts translation and the exon-skipped form likely encodes the full-length protein. the gene is on the minus strand of chr <dig> and so transcription proceeds from right to left.



at the cutoff fdr= <dig> , mats identified all seven genes and successfully located the actual genomic regions. dexseq found two of them  and cufflinks reported one . none of the other methods were able to find these genes. for lhy and sr <dig>  the a3ss events encompass a range of nt differences from a few to tens. mats’s success in finding these events can probably be attributed to the exclusive use of junction reads. the small differences were easily overlooked by other methods that take into account of reads on full exonic regions. the junction reads that uniquely supported the a3ss events tend to be overwhelmed by the non-junction reads along the long exon . dexseq detect sr1/sr <dig> and sr <dig>  with the differences in the a3ss events are several hundreds nt long. in dexseq, the junction reads are used as exon body reads.

pcr validation of the real data set
in a separate study that will be described in detail , we used semi-quantitative pcr to characterize heat induced splicing changes in seven genes that were annotated in tair  <dig> as being alternatively spliced. these seven genes thus provided a useful positive control for estimating the accuracy of the splicing analysis methods described here. these seven genes are at1g <dig>  at1g <dig>  at2g <dig>  at2g <dig>  at3g <dig>  at5g <dig>  at1g <dig>  at the cutoff fdr= <dig> , mats reported five genes, followed by cufflinks and dexseq, both of which picked out four genes. dsgseq, diffsplice and rdiff identified one gene. the details about which methods picked out which genes and which as events are contained in the seven genes are provided in table  <dig> table  <dig> 
the evaluation of the methods on the seven pcr validated genes



gene
found by which methods
as events


CONCLUSIONS
in this paper, we have evaluated and compared eight methods for alternative/differential splicing analysis of rna-seq data. the major observations for the as methods are summarized in table  <dig>  these methods are classified into count-based models and isoform resolution models. count-based models transform the question of as analysis into the question of alternative usage of counting units while isoform resolution models seek to resolve the isoform relative abundances and in further compare the difference across conditions. only cufflinks and diffsplice in our comparison belong to isoform resolution models. we’ve conducted both simulation studies and studies using real data to evaluate the methods. we created a customized simulation pipeline based on flux simulator. this pipeline allows users to repeat the simulation with different alternative splicing ratios, read depths and sample sizes.table  <dig> 
summary of the main observation for selected methods


class
novel as
detection region
comments

diffsplice

cufflinks

dexseq

mats

rdiff-param

splicingcompass

dsgseq

seqgsea
d
ir: isoform resolution models. cb: count based models. ns: not supported. asm: alternative spliced module.



from the perspective of auc statistics, dexseq and dsgseq performed well in the simulation studies when the annotation is accurate and complete. dexseq was slightly better when two groups of samples were simulated using different dispersion parameters while dsgseq excelled when the same dispersion parameter is used. dsgseq is also more robust to changes in the as ratio than dexseq. the drawback of dsgseq is that it does not calculate p-value. both methods belongs to count based models. however, like other methods which depend on gene models, they performance was largely impaired when incomplete annotation was used. this may impose problems when working on non-model species or simply any species that are not well annotated. cufflinks and diffsplice are capable of assembling reads into transcripts and are thereby able to detect novel as events. only cufflinks can take advantage of established gene models and is not fully dependent on the prior knowledge. these attributes render cufflinks the best combination of accuracy and robustness against incomplete annotation. therefore it is recommended for non-model species. on the other hand, cufflinks achieves a better tradeoff between precision and recall. it also performs the best in an median read coverage of  <dig>  the change of as ratio affected methods’ discrimination power as well as the ability to control fdr. the rankings, however, were relatively stable as as ratio changed, indicating that most methods is generally good enough to analyze real rna-seq experiments where the splicing ratio might vary from gene to gene.

mats uses a bayesian framework to calculate the probability of a gene being alternatively spliced. although mats did not exhibit good performance under the evaluation of roc curves and auc, it was the best method under our comparison with respect to controlling the fdr at a proposed level. mats excels in the precision of its results, which is very important for most biologists. the reason mats had low recall and auc is that mats was only designed for detecting simple as events. therefore it was not satisfactory when the simulation included complex as events. when only genes with simple as events were involved, both recall and auc improved dramatically for mats. the superb performance of mats in real data is boosted by the fact that all the  <dig> validated as genes from the literature as well as for the  <dig> pcr validated as genes are simple as genes. rdiff-parametric also had a low fdr, however, but it appears to be due to its use of bf correction. in the analysis of heat shock rna-seq data, mats turned out to be the method that was the most consistent with the established experimental evidence as well as our pcr validations. the drawback of the mats is that it is highly dependent on the goodness of annotation but it would be recommended for validating known as events.

large sample size  did not affect the discriminating power under roc and/or auc evaluation, but did improve several methods’ recall at the cost of decrease in precision. the several methods include cufflinks, dexseq, splicingcompass and especially seqgsea. seqgsea uses a permutation based approach to calculate p-values for genes being alternative spliced. it is likely that the p-values are scaled in accordance with sample size and we may expect a optimal sample size around  <dig> or  <dig> for using seqgsea. the sets of significantly alternatively spliced genes at given fdr threshold  varied considerably between methods for the analysis of heat shock data. seqgsea and dsgseq had the highest correlations of the gene ranking scores due to using the same test statistics.

