BACKGROUND
genome-wide association studies  have been successful in detecting single locus variants with relatively large effects in some common, complex diseases  <cit> . however, risk snps identified thus far can explain only a small percentage of the estimated heritability of such traits. this may be partly due to the fact that commonly used single snp analysis strategies employed in gwas are designed to detect common variants with strong marginal associations, and are not suitable for detecting complex multigenic disease risk factors, which may account for some of the missing heritability  <cit> . phenotypic variation present in common, complex diseases is thought to involve complex etiologies including complicated interactions between many genetic and environmental factors  <cit> . in particular, it is believed that gene-gene interaction effects, or conditional dependence between genetic variants affecting the phenotype, contribute to complex traits. ignoring those interactions in univariate analyses may be limiting the success of gwas studies for complex diseases  <cit> .

as an alternative to traditional statistical methods that fail to appropriately account for these complex genetic architectures, data-mining approaches designed to discover patterns in large amounts of data are gaining popularity for genetic association studies. many data-mining and machine learning approaches were developed with a main goal of prediction, such as exhaustive search strategies  <cit> , penalized regression  <cit> , multifactor dimensionality reduction  <cit> , neural networks  <cit> , and support vector machines  <cit> , but many of these methods have also been applied for variable selection or identification of relevant predictor variables . one commonly-used data-mining technique is random forests , which builds an ensemble of classification and regression trees that can predict an outcome  based on a large number of predictors , allowing for potentially complex models that can include interactions of the predictor variables  <cit> . rfs have been proposed for analysis of genetic data  <cit> , and more recently have been suggested as a way of analyzing even large snp data sets from gwas  <cit> . although designed for prediction, rfs give variable importance measures  that can be used to rank snps, and are therefore gaining popularity as a potential filter approach which considers interactions. in high-dimensional data, rf vim rankings can be used for screening or filtering by selecting top-ranking snps for follow-up study  <cit> ; in this context, rf rankings may have an advantage over univariate approaches because they may better reflect complex disease models.

the performance of rfs in the context of genetic data analysis has been investigated, and rf vims have been shown to out-perform fisher’s exact test as a screening tool when interactions are present  <cit> . rfs have been utilized in a number of genetic studies, and have recently been applied to a genome-wide association study of multiple sclerosis using filtering and backward elimination techniques, although identification of interactions was not explicitly considered  <cit> . to facilitate genome-wide application, rfs were iteratively applied for ‘sparsity pruning’ using vims to filter out non-predictive snps in a backward elimination technique  <cit> .

in addition to performance as a filtering/screening tool, other properties of vims have also been previously investigated. for instance, the bias of these measures has been assessed under linkage disequilibrium  <cit> , and an extension has been developed to consider the joint importance of multiple variables  <cit> . however, previous research has not considered the impact on interaction detection as data dimension  increases.

a frequently cited benefit of rfs in the analysis of genetic data is that they capture interactions between predictor variables, because the hierarchical decision tree structure can model non-linear associations  <cit> . the rf methodology is not designed to explicitly test for the presence of interactions or individual risk factor effects with a hypothesis test of significance. nevertheless, the variable importance measures for individual risk factors are expected to assess a variable’s overall impact on prediction and to reflect both main and interaction effects. methods for estimating the importance of joint effects including interactions  have been proposed  <cit> . however, these are not feasible in the context of large genetic datasets consisting of tens or hundreds of thousands of variables and thus interactions are usually not studied explicitly. yet even without explicit inclusion of interaction effects in the rfs, the individual snp vims used for screening are often claimed to capture interaction effects  <cit> .

previous studies of rf performance have primarily applied the approach in lower-dimensional settings, or settings involving interactions with strong marginal components. although it has been shown that in relatively small datasets rfs can detect interacting risk factors better than univariate tests of association of individual predictors  <cit> , this observation may not extend well to large datasets, with many potential predictors in the analysis. in fact, we might expect that the probability to detect true interactions may decrease as dimension increases, because the probability of the co-occurrence of interacting predictors decreases as the feature space grows, and earlier work suggests that rfs may be better at detecting main effects than interactions   <cit> .

in this study we explore the ability of rf vims to capture interaction effects, particularly as the data becomes increasingly high-dimensional. we hypothesize that when standard rf vims are used to identify the best predictors, the ability to detect interacting effects will decline rapidly as the total number of studied predictor variables is increased. focusing on analysis of binary case/control data, where rf is used for classification, this paper presents a simulation study to investigate the relationship between the number of variables in a rf and the ability of the approach to detect both marginal and interaction effects. we compare the performance of various rf measures of variable importance to p-values from univariate logistic regression under different data-generating models for complex disease, both as the number of predictors becomes large and as the strength of marginal association diminishes.

methods
random forests
random forests is an ensemble or ‘forest’ of many classification and regression tree  classifiers  <cit> . each tree is constructed on a bootstrap sample of subjects, with a random subset of the total number of predictors, p, eligible for selection at each node in the tree. the final prediction or classification is obtained via bootstrap aggregating   <cit> , and is based on a vote over all of the trees in the ensemble. in this study, we focus on classification for binary traits rather than regression for quantitative traits.

in general, a random forest of decision tree classifiers is grown as follows:

 <dig>  select a total of ntree bootstrap samples of size n from the original data for training. on average, about one third of the samples are left out, which are called the ‘out-of-bag’  data.

 <dig>  for each bootstrap sample, grow an unpruned classification or regression tree   <cit> .

a. at each node in the tree, randomly select mtry variables from the total p predictor variables.

b. choose the best split at each node from among the mtry variables by maximizing some measure of node purity , such as the gini index  <cit> .

c. an estimate of prediction error  is obtained for each tree using the oob individuals.

 <dig>  for a given observation, the final prediction/classification is the majority vote  over all trees in which that observation was ‘out-of-bag’. the oob prediction error and prediction accuracy of the rf can be calculated by considering accuracy of the oob prediction over all subjects.

for more detail on the method, see  <cit> .

variable importance measures
in addition to providing prediction, the rf method can be used to calculate a vim for each predictor. ranking based on vims can then be used as a screening tool to prioritize variables for follow-up study. a number of importance measures have been proposed, including gini importance and mean decrease in accuracy .

let x be a particular predictor variable . the gini importance of x measures the total decrease in node impurity across all nodes in the forest when x was selected for splitting  <cit> . although easy to compute, this measure has been shown to be biased by preferentially selecting variables with many categories  <cit> ; hence the more computationally intensive mda variable importance measure is typically preferred. the unscaled mda is the reduction in prediction accuracy after the data for the variable of interest are permuted across all samples within each tree; this vim is often referred to as ‘permutation importance’. if a variable is truly predictive of the response, permuting the variable across samples should disrupt this association and result in lower prediction accuracy; conversely, prediction accuracy should not change significantly after permuting data for unassociated variables. first, the prediction accuracy, at, is estimated from the proportion of correctly classified oob individuals for each tree t in the forest t. the values of x across samples are then randomly permuted in each tree, and the accuracy at* is calculated for the oob individuals using the permuted data. the raw or unscaled mda is

  mda=1ntree∑t∈tat−at*. 

variable importance can also be measured through a scaled version of mda,

  mdascaled=mdas2ntree 

where s <dig> is the estimated variance of decrease in accuracy across trees  <cit> . it should be noted that for trees in which the predictor variable x does not appear, the decrease in accuracy at- at* is zero by definition. another version of mda variable importance attributed to meng only considers trees in which x appears  <cit> .

interaction detection
typically vims are used to rank variables, and variables with high ranks are considered as potentially associated with the phenotype. a true causative genetic factor may be considered to be identified or detected by the rf analysis if it ranks highly in terms of variable importance, above null factors that are not associated with the phenotype. in our study, we considered a snp to be detected if it ranked within the top k snps, where k is the number of snps with a simulated causal effect. other definitions of detection were also investigated with similar results, so results are presented for this definition of detection only.

in rf analysis, the importance of each variable takes into account, or is conditional on, the effects of other variables in the tree. however, rf importance measures do not specify whether an effect is marginal or due to interactions with other snps. because one of the frequently cited advantages of rfs is the ability to model interactions, our primary goal was to investigate rf’s ability to detect both the effects of snps that act independently as well as those whose influence on the phenotype is dependent on genotypes at another locus .

in order to investigate the performance of rf vims for these different types of effects, we need to quantify both the strength and type of a variable’s effect on the phenotype. heritability in the broad sense, or the proportion of phenotypic variation that can be explained by genetic variation, is a common measure of the degree of genetic determination of a trait, or the total genetic effect size, and can also be used to estimate the effect of a particular disease locus  <cit> . suppose a binary disease phenotype d is controlled by two susceptibility loci a and b, with genotypes a,b =  <dig> , <dig> at each locus. the total heritability h <dig> due to the two loci can be defined as:

  hab2=1pd1−pd∑a=02∑b=02pgabpd|gab−pd <dig> 

where p is the disease prevalence, p is the frequency of genotype combination ab, and p is the penetrance of the disease  <cit> . we can define the heritability due to the marginal effect of snp a as

  hm,a2=1pd1−pd∑a=02∑b=02pgab×∑b=02pd|gabpgab−pd <dig> 

similarly, we can define h2m,b for snp b. the heritability due to the interaction effect of snp a and snp b, the conditional dependence of snps a and b on the phenotype, can be defined as the portion of the total heritability not attributable to the marginal effects at either locus: hi,ab2=hab2−hm,a2−hm,b <dig>  based on these definitions, snp a will confer a ‘main effect’ on the phenotype if h2m,a >  <dig> and an ‘interaction effect’ if h2i,ab >  <dig> for some snp b. these ideas can easily be extended to models with more than two causative loci.

simulation study design
in order to investigate the performance of rf vims in detecting interactions for a binary disease phenotype, we developed a sequence of three simulation studies. data sets that included variables with main effects only  and variables with interaction effects  on the phenotype were simulated and the performance of rfs in detecting the effects of these different types of variables was assessed. because an rf analysis is dependent on the tuning parameters selected, preliminary studies were conducted to determine optimal settings of mtry and ntree for this study based on prediction error , current recommendations in the literature, and practical considerations . based on these preliminary results, mtry = .1p and ntree =  <dig>  were used for the analyses presented here.

the first two simulation studies were designed to assess the performance of rf vims for detecting main and interaction effects, and compare the performance of rf with p-value rankings from univariate logistic regression. in order to focus on evaluating the performance of the methods in relation to the strength and type  of effect, in these simulations all snps were assumed to be independent and had the same minor allele frequencies. the third simulation study investigated the impact of linkage disequilibrium  on the detection of main and interaction effects using rfs. the designs of all three simulations are summarized in table  <dig> 

in all simulations, data were generated assuming that some snps contribute to the overall heritability only marginally , some snps contribute both marginally and interactively , and that some snps are not causally associated with the outcome and thus do not contribute to the total heritability . the performance of rfs was evaluated for each of the three types of variables by estimating probability of detection, which is similar to the concept of power in a frequentist statistical framework. a snp effect was considered to be detected if its rank based on the vim was in the top k ranks, where k is the total number of causal variants. the probability of detection was compared for a range of simulation scenarios for the three types of variables. analyses were performed using the software package random jungle  <cit>  and results were summarized and plotted using r statistical software.

simulation 1: comparing performance of vims for detecting main vs. interaction effects
the goal of the first simulation study was to compare the performance of rf vims for detecting marginal and interaction effects. the performance of rf was also compared to the most common gwas analysis approach, univariate logistic regression. the comparisons were performed for independent snp data with fixed maf, but with varying degrees of effect size and patterns of interaction. case/control datasets with p total snps were generated , where k =  <dig> causal snps were associated with the binary disease phenotype, d, with two snps having main effects only and two snps having interaction effects.

for each scenario,  <dig> replicate datasets were generated with  <dig> cases and  <dig> controls and maf =  <dig> ,  <dig> ,  <dig> , or  <dig>  at all snps. genotypes were generated assuming independence among snps and hardy-weinberg equilibrium. quantitative phenotypes were generated conditional on genotypes under a linear model, to reflect an underlying quantitative trait, and affection status was assigned using a threshold. phenotype data were thus generated under the following probit model:

  y=β0+β1x1+β2x2+β3x3+β4x4+β5x3x4+ed=iy>m 

where e ~ n, β0 =  <dig>  σ2 =  <dig>  and the threshold m was chosen to be median to achieve p =  <dig>  and balanced data. the genotypes at snp j were coded xj =  <dig> , <dig> reflecting the number of copies of the minor allele, assuming additive allelic effects . note that snps  <dig> and  <dig> have marginal effects only, whereas snps  <dig> and  <dig> are interacting. we quantified the strength of the simulated marginal and interacting effects in terms of heritability due to a given genetic effect . data were generated under five models, where the vector β =  was chosen to reflect different effect sizes and patterns in terms of total heritability due to the main effect snps  <dig> and  <dig>  and the total heritability due to the interacting snps  <dig> and  <dig> :

model 1: similar effects. the total effects of main and interacting snps are similar , with β = .

model 2: main effects greater. the total effects of snps  <dig> and  <dig> are greater than effects of snps  <dig> and  <dig> , with β = .

model 3: main effects only. the total heritability is due to snps  <dig> and  <dig>  and snps  <dig> and  <dig> are not causative , with β = .

model 4: interaction effects greater. the total effects of snps  <dig> and  <dig> are greater than snps  <dig> and  <dig> , with β = .

model 5: interaction effects only. the total heritability is due to snps  <dig> and  <dig>  and snps  <dig> and  <dig> are not causative , with β = .

in models 1– <dig>  the type of effect is a property of the heritability corresponding to the main effect snps  <dig> and  <dig>  and the interacting snps  <dig> and  <dig>  models with low heritability  were chosen to reflect realistic effect sizes that could be expected in genetic studies and also to investigate the performance in situations with low power. the specific heritability components depend not only on the β parameters, but also on the minor allele frequencies; in particular, the level of marginal heritability of interacting snps  <dig> and  <dig> varies with maf   <cit> . see  for the total, marginal, and interaction heritabilities of the simulated datasets.

in simulation  <dig>  we investigated performance of vims and compared variable importance rankings to p-value rankings from logistic regression. vims of interest in these simulations were raw mda, scaled/liaw mda, standard deviation of mda, and gini importance. “probability of detection” is reported for each vim for ‘main’, ‘interacting’, and ‘null’ snps, where the probability of detection was estimated by the proportion of times across  <dig> replicates that each snp was detected, averaged across all ‘main’, ‘interacting’, and ‘null’ snps, respectively.

simulation 2: comparing main effect and interaction detection with rf vims vs. logistic regression
generally, a threshold or probit model can be approximated by a logit model. this may give logistic regression an advantage in the above simulation  <dig> design, as similar models are used for simulating and analyzing the data. in order to provide an additional comparison of rf with univariate logistic regression, data were also generated directly from penetrance functions, the conditional probability of disease given genotypes. for simulation  <dig>  genotype data were simulated as previously described, with maf fixed at  <dig>  because the effect of maf had already been examined. phenotypes were generated conditional on genotypes from a specified penetrance function , assuming two true causative loci which interact . three model scenarios were considered in which both snps contribute marginally , only snp  <dig> contributes marginally , and neither snp contributes marginally to the phenotype . total genetic effect size was fixed at approximately 1% heritability to facilitate comparison across models. penetrance functions used for these simulations are provided in table b <dig>  and are displayed in figure  <dig>  along with the heritability due to each component.

simulation 3: investigating detection when ld is present
the goal of the third simulation was to examine the performance of rf vims in detecting main and interaction snp effects under a scenario with realistic patterns of ld and maf. we therefore generated genotypes based on real data, with various degrees of ld in different regions, and compared performance of interaction detection under some of the previously assumed data-generating models of phenotype conditional on genotype.

a real genome-wide snp dataset was used as the basis for generating genotypes for p =  <dig>  snps in  <dig> genes, giving rise to patterns of ld and maf resembling those encountered in genome-wide association studies. details of the genetic data simulations are discussed in additional file  <dig>  phenotypes from the real genome-wide data were not utilized, and instead binary phenotypes were generated conditional on genotypes under model  <dig>  and model  <dig>  from simulation  <dig> in order to investigate the impact of ld on the performance of rf snp detection for snps with both marginal and interacting effects in the high-dimensional setting . the two causal snps were chosen to have maf of approximately  <dig>  to provide results comparable to simulation  <dig> without ld. three patterns of ld were considered, involving causal snps either in strong ld  or weak ld  with other snps; either both causal snps were chosen to be in strong ld, both in weak ld, or one in strong and the other in weak ld. a fourth scenario was also considered for comparison where all snps were generated independently  with mafs identical to those seen in the real data.

probability of detection was defined as before, and also as the proportion of times that any snp in high ld  with the causal snp ranks in the top k in order to assess detection of a region around the causal snp. as in simulation  <dig>  the performance of rf vims was compared to p-value rankings from logistic regression.

RESULTS
simulation 1: comparing performance of vims for detecting main vs. interaction effects
as expected, in general, causal snps  have larger vims than null snps, particularly for small p . the causal snps also have larger variability in variable importance between trees than null snps, as expected.

for all types of snps , both the estimated variable importance and the probability of detection decline as the total number of predictors increases. however, as the total number of predictors increases, the probability of detection declines more rapidly for interacting snps than for non-interacting snps . only results for model  <dig>  and model  <dig>  are displayed in figure 2; results for models  <dig>   <dig>  and  <dig> show similar patterns . overall, the detection probability of all snps increases with effect size , as expected. for example, for the non-interacting snps, detection probability increases as hx1x <dig> increases. however, for the interacting snps, detection probability is largely dependent upon their marginal effect  rather than their total effect , which includes their interaction effect. thus, detection probability is strongest for the snps with the largest marginal heritability , not necessarily the largest total heritability. for example, under model  <dig> with maf of  <dig> , the detection probability is higher for the main effect snps than for the interacting snps, despite the fact that the total effect of the interacting snps  is larger than the effect of the main effect snps . this is because under this model the main effects snps have a larger marginal heritability  than the interacting snps . figure  <dig> demonstrates that the decrease in detection probability for snps with small marginal effects becomes more pronounced in situations with large p.

a pattern is observed across maf, where ‘main’ snps are more readily detected than ‘interacting’ snps for higher frequencies, corresponding to scenarios where hm,x <dig> and h2m,x <dig> are high. as maf increases, the difference in detection between ‘main’ and ‘interacting’ snps also increases; for low mafs, ‘interacting’ snps are more frequently detected, while for more common variants the ‘main effects’ snps are more frequently detected. this is because under our data generating model, as maf increases the heritability due to the marginal effects of interacting snps  <dig> and  <dig>  decreases , making them more difficult to detect using rf.

rf prediction errors, under the different simulation models, are shown in additional file  <dig> . these results demonstrate an inverse relationship between detection probability based on vims and the estimates of prediction error for the rf models. while all estimates of prediction error are relatively high , which is expected given the low heritability of the assumed models, the estimates of prediction error are lower for models with higher detection probabilities. for models with weak marginal effects , the snp effects are not well detected, and consistent with this, the prediction errors are high .

of importance is the fact that the probability of detection is not strongly affected by method of ranking , and in particular the rf vims rarely outperform logistic regression for values of p> <dig> for the scenarios studied here . in all scenarios, logistic regression has slightly higher detection probability for the non-interacting snps. when maf is high , rf variable importance measures have higher probability of detection than logistic regression for interacting snps, but only when p is low. for instance, liaw mda generally has higher detection probability for the ‘interacting snps’ when maf =  <dig> ,  <dig>  if p ≤  <dig> 

simulation 2: comparing main effect and interaction detection with rf vims vs. logistic regression
results for simulation  <dig> based on penetrance functions are portrayed in figure  <dig>  where probability of detection is reported separately for snps  <dig> and  <dig>  when marginal effects are present at both snps , detection probability is high for both snps, but steadily declines as p increases. when only snp  <dig> exhibits a marginal component , detection probability for snp  <dig> is high, but detection probability is much lower for interacting snp  <dig>  particularly for large p. when no marginal effects are present at either locus , detection probability is near zero when p> <dig>  the detection probability is highest when marginal heritability  is highest, which has a greater impact than method of ranking. no single rf method consistently outperforms the others; however, in general rf vims perform slightly better than logistic regression models.

because total h <dig> is low for the assumed models, we expect prediction error estimates to be high . however, the prediction error estimates are particularly high  for model  <dig>  which has no marginal effects, indicating that under this model rf cannot detect the snp effects. thus, as in simulation  <dig>  the high prediction error observed under the pure interaction model provides additional evidence that rf was not able to capture the snp effects in the absence of marginal effects.

simulation 3: investigating detection when ld is present
the results of the third set of simulations  demonstrate how the level of ld impacts the probability of detection for both marginal and interaction effects. for both the two locus model with main effects only  and with interaction effects , the detection probability is lower for the causative snps in strong ld as compared to the causative snps in weak ld for all vims. additionally, strong ld reduces the detection probability of the causal variant far below what can be expected if all genetic predictors are independent, regardless of the type of effect or vim, although when considering detection of the causal region  the detection probability is less affected . for main effect snps, the rf vims give similar detection probabilities when the causative snps are in weak ld with other snps and when they are independent . however, for interacting snps that are in weak ld with other snps, the detection probability is higher , especially when the other causative snp is in strong ld with other snps . the gini importance is more strongly impacted by both strong and weak ld, with greater reductions  and gains  in power than the other importance measures.

detection probability with and without ld for main effects only model  <dig> for rf vims and logistic regression . total number of snps =  <dig> , maf ≈  <dig> . average pe estimates range from  <dig>  to  <dig>  .

detection probability with and without ld for interaction effects only model  <dig> for rf vims and logistic regression . total number of snps =  <dig> , maf ≈  <dig> . average pe estimates range from  <dig>  to  <dig>  .

in general, the rf vims show improved detection over logistic regression for the snp in weak ld if the other causative snp is in strong ld , particularly when the causative genetic factors are interacting . in other situations, rf and logistic regression perform similarly when ld is present, with rf performing slightly better under weak ld and logistic regression performing slightly better under strong ld.

discussion
in this study, we investigate the ability of random forests to detect both marginal and interacting effects in high-dimensional data, in order to validate the claim that rf methods are well suited to describe gene-gene interactions and to determine their usefulness as filter methods or screening tools that allow for interaction effects in large datasets, assuming sample sizes and genetic effect sizes likely to be encountered in real data analysis. while rfs are often cited as an approach suitable for detecting genetic effects in the presence of interactions, mckinney et al.  <cit>  suggested that rfs may be better suited for detecting marginal effects than interactions. however, the effect of data dimensionality on rf’s ability to detect interaction effects has not been previously described. we found that as dimensionality increases, the ability of rf to detect snp effects diminishes, and this decline is more rapid for interacting snps than for snps with a large univariate effect. our results demonstrate that the detection probability of rf is driven by the strength of the marginal components.

in simulation  <dig>  we observed an inverse relationship between maf and interaction detection probability, which is a result of the dependency of effect size  on maf. for example, under the data-generating threshold model with stronger interaction effects , the marginal effect of the two interacting snps  decreases and the interaction effect of these two snps  increases, as the maf increases . in the case of maf =  <dig>  and  <dig> , the marginal effects of the interacting snps are strong, and the rf vims perform well. however, as maf increases and these marginal effects diminish, rf has a low probability of detecting the interacting snps for large p. this demonstrates that in high-dimensional settings rf vims are driven by the magnitude of the marginal effects , regardless of the presence of an interaction effect , and that vims are capturing marginal effects rather than interactions as originally claimed. this was also clearly demonstrated by simulation  <dig>  with models generated from penetrance functions with maf fixed at  <dig> . snps that had some level of marginal heritability had higher detection probability, whereas interacting snps with no marginal contribution to the total heritability were rarely detected, if at all.

in our simulations, we also observed a strong inverse relationship between estimated prediction error and detection probability. this relationship is expected, since if the rf model was not predictive of phenotype, then no predictive signal was detected for any variable, and hence the true causative factors  were not identified. therefore we do not advocate utilizing a ranked list to screen predictors if prediction error is high, because even if true causative factors exist, they will not be highly ranked. nevertheless, the relationship between prediction error and detection probability based on vims portrays a consistent story: prediction error estimates are only lower than what is expected by chance if the true causal effects are detected. as dimension becomes large, detection probability diminishes and becomes highly dependent on the strength of the marginal effects, and the poor prediction errors are a reflection on the failure of rf to model interactions in these scenarios.

the models used for simulating the data had low h <dig> to reflect realistic effect sizes for a study of common snp variants assessed with a genome-wide platform. it has been shown that snps identified thus far through gwas explain only a small portion of the heritability and have poor predictive performance, which is consistent with the models chosen for our simulation study. nevertheless, we also considered interaction models with stronger effect sizes and higher h <dig> . in these high-heritability models, models with marginal effects resulted in greatly improved prediction error, whereas interaction models without strong marginal effects still showed little if any improvement, reflecting the same general trend described in this study.

the use of alternative definitions of snp detection and detection probability could impact the findings of this study; however, we found that a previous definition of power utilized by bureau et al.  <cit>  is similar to our definition in practice and provided similar results. detection can also be defined using a percentage threshold  to account for non-constant p, but this definition also does not dramatically change the results. additionally, rf analyses are dependent on various tuning parameters. in our preliminary investigations to select the tuning parameters, we found that increasing the value of ntree beyond  <dig>  did not improve prediction error or probability of snp detection. although increasing the value of mtry from  <dig> p to  <dig> p resulted in a slight improvement in prediction error, it did not result in a gain in power. importantly, the observation that as dimensionality increases, the ability of rf to detect interacting snps diminishes more rapidly than for snps with a large marginal component remained unchanged as mtry was increased . hence results of analyses with the value of mtry =  <dig> p are reported here, since this value of mtry is more practical for real data analysis as dimension increases, and is the value suggested by goldstein et al.   <cit> . in our application of rf, classification trees were grown by splitting to purity, the current default setting available in software and recommended in the literature. however, some research suggests that this setting may be problematic because the large number of terminal nodes may lead to bias and a loss of consistency in the forest  <cit> . although the optimal settings of the number of terminal nodes for classification are still unknown, it is possible that a reduced number of terminal nodes could improve results. further investigation of optimal parameterization of the tree-building algorithm is warranted.

notably, our simuations revealed that the advantage of rf over univariate logistic regression is lost for larger values of p, conflicting with the findings of previous studies. lunetta et al.  compared the performance of rf variable importance rankings to univariate fisher’s exact test for p =  <dig> and  <dig>  snps and found that when interaction effects were present, rf outperformed the univariate method  <cit> . however, the multiplicative models investigated by lunetta et al.  have strong marginal components, indicating that the improved performance may be due to the marginal rather than non-linear association. moreover, the fisher’s exact test applied by lunetta et al. is not the most powerful univariate approach, and would rarely be applied in a gwas setting. they also reported that for the purely epistatic datasets of ritchie et al. , interaction effects were identified with rf, but these scenarios were low-dimensional with p =  <dig>  <cit> . in fact, in a methods comparison between multifactor dimensionality reduction, neural networks, and rf for purely epistatic models with p =  <dig> total loci, rf was shown to have extremely low power  <cit> . in the current study, a broader range of disease models with varying effect types and dimensionality were considered to fully explore performance of rf as dimension increases. under the simulation  <dig> threshold model, we failed to see an improvement with rf over logistic regression for any vims. in simulation  <dig>  the most commonly used vim  again displayed little advantage over p-values from logistic regression, particularly for higher p. in contrast, the less commonly used gini importance and liaw sd showed a slight advantage over logistic regression in detecting marginal effects.

the results of the study indicate that as a tool for variable selection, both rf vims and univariate logistic regression can detect snps with marginal components, but neither may be adequate for interaction detection in high dimensions. in lower dimensions, rfs capture interactive effects and may therefore outperform univariate logistic regression. however, in lower dimensions higher order logistic regression models and pair-wise scans are possible, limiting the advantage of rf. in fact, some researchers feel that interactions modeled by rf but not confirmed with logistic regression are unlikely to be real. nevertheless, the advantages of rf reside in the ability to incorporate the effects of multiple variables simultaneously and model conditional associations in both low and high dimensional data , which cannot be captured with univariate procedures. thus rf is recommended as a complimentary approach to other variable selection methods. moreover, we note that machine learning methods such as rf were designed to improve prediction rather than variable selection; therefore if the research objective is to develop a predictive model, then rf may be more appropriate.

bureau et al.  <cit>  previously recognized that rf vims do not explicitly test for interactions, and proposed joint importance measures based on permuting pairs of snps to identify pair-wise interactions. however, this joint permutation is computationally intractable in high-dimensional data, even for pair-wise interactions. the hope is that in genome-wide data, the original vims may still capture complex associations. yet we found that rfs fail to capture interactions in high-dimensional settings. while rf seems to identify interactions in low-dimensional data, why do these properties fail to extend to higher dimensions? unlike univariate analyses, rfs take additional factors into account and model the conditional relationships between variables within a tree. the decision trees in rf can efficiently detect conditional dependencies between predictors that are in the same tree, and therefore interactions are modeled in low-dimensional settings when most variables tend to be present in each tree. however, there is a limit to the depth of a tree based on sample size, and therefore in high-dimensional settings not every variable will make it into a given tree—variables with strong marginal associations are more likely to be chosen for a given split. the probability that a pair of interacting snps are in the same tree together is low, particularly if the marginal effects of both snps are relatively small; if a pair of snps are rarely present in the same tree, then their conditional association is rarely modeled. research on the asymptotic theory of rf has shown that for a fixed number of predictors p, rf is sparse  as the sample size approaches infinity  <cit> . however, our results demonstrate that with practical sample size limitations, rf has little ability to detect interactions.

increasing the sample size tends to increase the tree-depth and number of possible splits per tree, which increases the number of variables included per tree and the probability that the effects of a pair of interacting snps will be jointly modeled. to investigate the impact of sample size on power, we considered a difficult genetic model with low power  and increased the sample size from n =  <dig>  to n =  <dig>  and  <dig> . we found that increasing the sample size did increase power , particularly for p =  <dig> and 100; however, even with n =  <dig>  power is still extremely low when p =  <dig> , indicating that to detect an interaction with low heritability and no marginal effects, sample sizes much greater than  <dig> times the number of predictors are necessary . in practice, sample size is often n < p, hindering the ability of interaction detection of any statistical method, including rf.

poor snp effect detection in high-dimensional data is exacerbated in the presence of strong ld, both for marginal and interaction effects. if the true causative snps are in regions of strong ld, the causative effects must compete with correlated predictors for positions in each tree, since non-causative variables may also be associated with the phenotype because of ld. the result is lower importance rankings and a reduction in the probability of snp detection. our results were similar to those observed in previous studies, which also found that the presence of snps that are highly correlated with risk snps reduces rf performance  <cit> . although snp detection is reduced for predictors in strong ld, predictors in weak ld show improved results, particularly for interacting snps. in fact, the strong ld of one causative factor can improve the detection probability of other causative factors, including interactions. if one risk snp is highly correlated with other predictors, this increases the probability that additional risk snps will appear in a tree together with at least one snp in the first causative region, increasing the chance of modeling a joint association. this may have implications for ld pruning with rfs, which may be helpful for detecting marginal effects but in certain situations could reduce the chance of detecting effects of interacting snps. these observations raise questions about the most appropriate use of rf for genetic datasets.

the results of this study allow us to draw a number of conclusions about the performance of rf, but some inherent limitations remain. in the current study we only considered simple disease models with architectures involving marginal effects and two-locus interactions, and investigation of more complex architectures is warranted. nevertheless, our results demonstrate difficulties with detecting even these simple lower-order interactions using rf. furthermore, only a limited number of ld patterns were investigated. although this was not a thorough examination of the consequences of ld on interaction detection, our results provide some insight into the impact of ld on the performance of rf for identifying interacting snps. while beyond the scope of the current study, these findings motivate further research into how rf should be applied in practice for different types of data.

these results call into question the applicability of rf as a variable selection and screening tool in a gwas setting. in high-dimensional data, true causal snps without a strong marginal component are not highly ranked by the variable importance measures, indicating little potential improvement of rf as a filter approach over current univariate techniques. therefore, extensions that improve the detection of interacting factors would be highly advantageous. as the rf methodology currently stands, the primary goal is not identification of interactions. because the method incorporates conditional effects, allows for the analysis of high-dimensional data where the number of predictors far exceeds the sample size, and provides a ranking scheme to implement potential filtering, it seems that extension to better capture interaction effects seems promising. this work provides insight into why rf variable importance measures fail to capture interactions in a high-dimensional setting, which motivates further research to develop new variable importance measures to properly account for interacting variables or to modify the approach for accurate variable selection in the presence of interactions.

CONCLUSIONS
the ability of random forests variable importance measures to detect interaction effects has not been previously investigated in high-dimensional data. we found that as dimensionality increases, the probability of detection declines more rapidly for interacting snps than for non-interacting snps and random forests no longer outperforms univariate logistic regression. random forests efficiently model complex relationships including interactions in low dimensional data, but in high dimensional data they only effectively identify genetic effects with a marginal component. therefore current variable importance measures may not be useful as filter techniques to capture nonlinear effects in genome-wide data and extensions are necessary to better characterize interactions.

competing interests
the authors declare that they have no competing interests.

authors’ contributions
sjw designed the study, performed the simulations and data analysis, and drafted the manuscript. cc executed the simulations and facilitated data analysis. rrf, xw, mda and mh participated in the design of the study and interpretation/presentation of results. jmb conceived of the study, assisted in its design, and drafted the manuscript. all authors read and approved the final manuscript.

supplementary material
additional file 1
supplementary information, preliminary simulations to select tuning parameters. descriptions and results of parameter sweeps to determine optimal values of the tuning parameters mtry and ntree to minimize prediction error and maximize power  <cit> .

click here for file

 additional file 2
supplementary information, simulations 1– <dig>  additional descriptions and results for simulations 1– <dig>  <cit> .

click here for file

 acknowledgements
this study was funded by nida .
