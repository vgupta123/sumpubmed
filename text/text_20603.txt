BACKGROUND
species delimitation is an old issue in biology that continues to attract considerable attention  <cit>  as the present global biodiversity crisis makes it of paramount importance to delineate and identify as objectively as possible species-level taxa  <cit> . the widespread occurrence of cryptic species  <cit>  and the problems they pose in ecological, physiological and genetic studies  <cit>  also call for the establishment of methods that can be applied by scientists from a variety of backgrounds and not solely by specialized taxonomists.

as pointed out by de queiroz  <cit> , diverging lineages acquire progressively through time a number of different properties that allow their recognition as distinct species. among the different categories of characters  suitable for assessing the divergence between lineages, dna sequences have gained increasing popularity among taxonomists in recent years as they are, in many cases, not influenced by environmental conditions nor by the life stage of the organisms under scrutiny; moreover, gathering information on dna markers requires less taxon-specific training and expertise than for other categories of characters  <cit> . methods for delimiting species based on molecular sequence data can be broadly classified in two categories: tree-based, and non-tree-based  <cit> . tree-based methods use models of sequence evolution to reconstruct nodes that represent hierarchical kinship relationships among organisms in a historical perspective, whereas non-tree-based approaches use population genetic models to look for evidence of barriers or restrictions to gene flow among and within extant populations.

even though "a highly corroborated hypothesis of lineage separation  requires multiple lines of evidence"  <cit> , as a first approach it may be desirable to choose a species delimitation criterion that is as general as possible and can be used systematically. since a recent survey found 23% of species reported in the literature to be either poly- or paraphyletic at the various loci investigated  <cit> , a sensitive delimitation method should be capable of detecting closely related species at an early stage of lineage divergence, when most of their genetic loci have not yet reached reciprocal monophyly . moreover, it would be advantageous to use as a general yardstick for delimiting species a method that does not make restrictive assumptions regarding the genetics of the marker used  and of the populations studied .

one such method applicable to sexually reproducing organisms was proposed  <dig> years ago by doyle  <cit> : briefly, this approach uses information on the co-occurrence of alleles in the diploid phase to delineate, for each marker investigated, groups of individuals sharing a common "allele pool". in doyle's terminology these groups of individuals are named "fields for recombination" , following an earlier proposal by carson  <cit>  to consider species as groups of individuals whose alleles recombine through segregation and meiosis. doyle's method relies on the expectation that it takes less time for diverging populations to reach mutual allelic exclusivity than reciprocal allelic monophyly : hence, groups of individuals that do not have any allele in common can be assumed to belong to distinct species even though they are not reciprocally monophyletic.

in doyle's original proposal, a first step is to delineate, for each genetic locus under scrutiny, single-locus ffrs . however, "with sufficiently fine resolution, the allele pool may not extend beyond the single heterozygous individuals in which two alleles coexist": in such situation, "many more allele pools are recognized, and concomitantly there are more ffrs, each consisting of a single individual"  <cit> . to overcome this problem, doyle proposes to use information on the co-occurrence of alleles from different loci to lump sl-ffrs into multilocus ffrs : if individuals a and b belong to the same sl-ffr for marker  <dig>  and individuals b and c belong to the same ssl-ffr for marker  <dig>  then individuals a, b and c belong to the same ml-ffr. one drawback of this approach, however, is that it combines information from all available markers, which makes it difficult to judge the reliability of the ml-ffrs obtained . moreover, doyle's method requires determining the alleles of many individuals for several codominant nuclear markers: until recently, this could only be done for low-resolution and/or homoplasy-plagued markers such as allozymes or microsatellites, which probably explains why earlier attempts to use this method for species delimitation were unsuccessful  <cit> .

in the last few years, new techniques have emerged that make it possible to obtain information-rich allelic sequences from heterozygous individuals without cloning  <cit> . sequences obtained from exon-primed, introns-crossing  nuclear markers  <cit> , as a result, appear now well suited for delimiting species using doyle's method. and since such sequences are of finite  length, a simple strategy to obtain sl-ffrs that accurately delineate reproductively isolated populations is to sequence a large number of individuals. one may then assess the reliability of the resulting species boundaries by checking whether they are supported by several independent molecular markers, a congruence approach  <cit>  that presents the advantage of not mixing together information from different sources.

here we propose to revive and invigorate doyle's approach by extending it in two directions. first, we present a reliable graphical method to delineate sl-ffrs in large datasets using haplowebs : these two-dimensional representations are obtained from conventional haplotype networks  by adding connections between haplotypes found co-occurring in heterozygous individuals, i.e. haplotypes that belong to the same allele pool sensu doyle. and second, we introduce a procedure to complement the ml-ffr approach  with an analysis of the congruence between markers, by scoring each possible bipartition of the set of individuals according to the number of independent marker supporting it. these two approaches are illustrated with a detailed example of their application to taxonomically difficult corals of the genus pocillopora  collected around clipperton, an atoll located in the far eastern pacific ocean.

RESULTS
nuclear and mitochondrial markers yield putative species-level groupings of individuals
two nuclear markers and two fragments of the mitochondrial genome were successfully sequenced from each of the  <dig> pocillopora samples that we had collected around clipperton. haplonets were constructed for each nuclear marker and for the concatenation of the two mitochondrial markers; the haplonets obtained from each nuclear marker were subsequently converted into haplowebs by drawing additional connections between haplotypes found co-occurring in heterozygous individuals.

the internal transcribed spacers  are variable non-coding regions located in the nuclear ribosomal dna that have been proposed as a universal species-level marker in corals  <cit> . in the present study we focused on the its <dig> region, located between the  <dig> s and 28s ribosomal genes. fifteen different its <dig> sequences were detected , the most common of which was found in  <dig> individuals  whereas eight sequences were singletons . visual inspection of the resulting haploweb  revealed four allele pools  comprising  <dig>   <dig>   <dig> and  <dig> sequences; the corresponding four sl-ffrs comprised  <dig>   <dig>   <dig> and  <dig> individuals, respectively.

as a second supposedly independent nuclear marker, we sequenced an intron of the atp synthase β subunit  gene:  <dig> distinct atpsβ haplotypes were detected , the most common of which was found in  <dig> individuals whereas  <dig> haplotypes were singletons. the corresponding haploweb revealed two sl-ffrs: the larger allele pool included  <dig> haplotypes found in  <dig> individuals, whereas the smaller one included  <dig> haplotypes found in  <dig> individuals.

as for the two mitochondrial fragments , haplowebs were not suited to analyze them since they were not recombining ; hence, individuals were simply sorted into haplogroups according to the mitochondrial haplotype they possessed. only four different haplotypes were detected among the  <dig> samples analyzed : the most common haplotype, found in  <dig> coral colonies, was separated by only one mutation from the two less common ones , whereas the fourth haplotype, present in  <dig> individuals, was  <dig> mutations away.

the congruence between independent groupings can be quantified using bipartition scores
each of our three independent datasets  supported several possible species boundaries, but combining the results of the two nuclear markers following doyle's approach yielded two ml-ffrs comprising respectively  <dig> and  <dig> individuals. to assess the reliability of this result, we considered all possible bipartitions of our  <dig> samples and scored them according to the number of markers supporting them ; the mitochondrial regions were included in this analysis as a single marker independent from the two nuclear ones. generally speaking, the number of possible bipartitions of a set of n objects is 2n-1- <dig> : hence, a dataset comprised of two sl-ffrs  supports a single bipartition, a dataset comprised of three sl-ffrs  supports  <dig> bipartitions, a dataset comprised of four sl-ffrs  supports  <dig> bipartitions, etc.

g = 05clip002+05clip003+05clip005+05clip007+05clip012+05clip019+05clip021+05clip022+05clip <dig> +05clip046+05clip061+05clip079+05clip080+05clip082+05clip087+05clip096+05clip103

the atpsβ haploweb detected a single putative species boundary in our dataset, partitioning it in two sl-ffrs comprising respectively  <dig> and  <dig> individuals. since the its <dig> haploweb was comprised of  <dig> sl-ffrs, it supported  <dig> possible bipartitions of our set of  <dig> individuals, only one among which was also supported by the other nuclear marker. as for the combined mitochondrial regions, they delineated four haplogroups among our samples : out of the  <dig> possible bipartitions supported by this marker, one was also supported by the its <dig> and atpsβ datasets.

among the  <dig> bipartitions supported by at least one marker, none was supported by two markers and one was supported by all of them . this single well-supported bipartition divides our set of samples into two populations of  <dig> and  <dig> individuals  that do not share any allele at the three independent genetic loci investigated: according to the mutual allelic exclusivity criterion , these two populations thus represent distinct species, here designated pocillopora sp. a and pocillopora sp. b pending further taxonomic examination.

discussion
using haplowebs to delineate sl-ffrs: delimiting species without a priori hypotheses
as illustrated with our pocillopora example, haplowebs provide a simple, intuitive way to delineate sl-ffrs from a set of nuclear sequences and represent them graphically. in this article we chose to represent haplowebs by adding connections between co-occurring haplotypes on top of haplotype networks , but it should be emphasized that haplowebs can also be drawn atop phylogenetic trees if one wishes to do so.

usual tree-based methods can only delineate species that are reciprocally monophyletic , whereas most non-tree-based methods are statistical in nature and require large sample sizes and numbers of markers in order for meaningful conclusions to be reached. another issue with such statistical approaches is that genotypes have to be determined for each individual sampled, which poses problems in cases of polyploïdy, aneuploidy, copy-number variation or chimerism when individuals comprise variable numbers of haplotypes and the genotypes cannot be determined . in contrast, the delineation of allele pools using doyle's method is based only on haplotype presence/absence information and thus does not require knowledge of the respective amount of each haplotype in the genotype.

even though haplowebs have their most obvious application in the analysis of nuclear sequence markers, one may also find them useful when attempting to delineate species using mitochondrial markers that co-amplify with nuclear pseudogenes . such pseudogenes are common in many taxa  <cit>  and can be very difficult to tell apart from bona fide mitochondrial sequences  <cit> . however, pseudogene sequences diverge following speciation just like other markers, and reproductively isolated species are thus expected to own mutually exclusive sets of paralogous sequences that may not be reciprocally monophyletic but will be easily detected using haplowebs.

a previous survey of pocillopora's molecular diversity based on a single nuclear marker  also included four samples from clipperton  <cit> : in this survey, however, the authors took the morphological delimitation of species in veron's corals of the world  <cit>  as granted and thus attributed all their samples from clipperton to the species "pocillopora effusus". even though they presented compelling evidence for the presence of three divergent its <dig> types among their samples, they did not envision in their article the possibility that cryptic pocillopora species may be present but rather decided to attribute the observed molecular diversity to interspecific hybridization. this highlights that molecular studies based on a single marker can easily yield erroneous conclusions, especially when a priori morphological hypotheses hinder the objective analysis of the molecular data at hand. moreover, this suggests that the current evidence for interspecific hybridization in corals will have to be carefully reevaluated once their species-level taxonomy becomes clarified.

bipartition scoring vs. doyle's ml-ffr approach
if analyses using different markers yield different sl-ffrs, then the simplest explanation is that not enough individuals were sequenced, resulting in some sl-ffrs that are artefactually smaller than in reality. a straightforward way of solving this discrepancy would be to increase the number of individuals in the dataset, but this cannot always be done: for instance, the sampled populations may be rare or endangered, the sampling site may be difficult to access, or time and money may be limiting factors. a good example of the consequences of severe undersampling can be found in our previously published study of the genus pocillopora in hawaii  <cit> , in which a first attempt to delineate graphically sl-ffrs was presented: for each of the four nuclear markers analyzed, numerous small sl-ffrs were obtained as the number of individuals sampled  turned out to be very insufficient. in less severe cases, however, doyle's ml-ffr method and/or the bipartition scoring approach presented here can be used to synthesize the results obtained from all markers and obtain a putative species delimitation based on all information available at hand.

although doyle's ml-ffr procedure may superficially be mistaken for an approach based on congruence , it is better described as a "total evidence"  <cit>  approach since the inclusion of a single aberrant dataset can cause the whole analysis to yield conclusions that are not supported by any other marker. a possible way to detect and eliminate such aberrant marker could be to remove one locus at a time and delineate ml-ffrs using the remaining ones, but such approach is very time-consuming and will perform poorly if there are several aberrant datasets. our bipartition-scoring approach, however, solves this problem by making it possible to compare and quantify the support brought by each marker to the putative species boundaries.

missing data, when extensive, can jeopardize phylogenetic analyses  <cit> , but doyle's ml-ffr approach is relatively immune to this problem since possession of a single sequence from a known allele pool is a sufficient criterion for attributing an individual to a given ml-ffr . the bipartition scoring approach presented here, however, only works if sl-ffrs for all markers are delineated from the same set of individuals.

whereas the ml-ffr method proposed by doyle only bases itself on the sl-ffrs obtained from nuclear markers, our bipartition scoring approach can include other types of groupings based on a variety of characters: haploid sequence markers , morphological characters, biochemical or immunological properties, behavior, etc. including a few morphological, biochemical or behavioral characters in the bipartition scoring analysis would provide a nice way to test the congruence of the patterns obtained from there characters with those obtained from molecular sequence markers. however, our method of quantifying support supposes that the grouping used  be independent from each other, a requirement easily testable in the case of molecular markers  but that may prove more difficult to establish for other kinds of characters: hence, one may prefer to use solely molecular characters for quantifying the support of the bipartitions.

possible pitfalls: dealing with selection, shared ancestral sequences and introgression/hybridization
one possible issue with using the criterion of mutual allelic exclusivity to delineate species is that populations inhabiting contrasting environment can have distinct alleles at loci that are differentially selected: for such markers under selection, one may then end up with sl-ffrs that are less encompassing than the real species as they rather delineate intra-specific ecological niches. however, this problem will only affect markers that are selected: if several markers are used, there is good chance that most of them will be neutral or near-neutral , in which case the congruence analysis presented here will still recover the true species boundaries. moreover, whenever two sl-ffrs yielded by a marker turn out to be sympatric populations inhabiting the same environment, then the chance that the putative species boundary between them be actually an artefact caused by selection becomes vanishingly small.

recent introgression and shared ancestral sequences are two other possible pitfalls of doyle's ml-ffr method: the inclusion of a single recently introgressed sequence or shared ancestral haplotype in a dataset supporting otherwise the delimitation of species a and b would cause the immediate collapse of the two corresponding ml-ffrs into a single unit and yield the erroneous conclusion that a and b are conspecific. however, the bipartition scoring approach presented here would not be affected by the inclusion of a few such "misbehaving" loci as long as a majority of the markers do behave properly. f <dig> hybrids present a more difficult problem since they cannot be detected by a congruence analysis such as our bipartition scoring approach. however, if f <dig> hybrids are relatively rare in the population , then they may be spotted in haplowebs as thin lines connecting large haplotype circles . if the same small set of individuals turns out to be responsible for such infrequent connections over nearly all molecular markers analyzed, one may assume with a high level of certainty that these are f <dig> hybrids and subsequently remove them from the analysis to ensure proper species delimitation.

CONCLUSIONS
haplowebs are versatile tools that combine properties from both tree-based and non-tree-based approaches to species delineation: like the former, haplowebs can provide meaningful conclusions from relatively few markers without relying on population genetic models, and like the latter, they allow detection of potential species boundaries at an early stage of divergence when populations have not yet reached reciprocal allelic monophyly. the method used for building haplowebs from sets of sequences and for analyzing the congruence between them is straightforward and reproducible: hence, our next step will be to develop programs that speed up the construction of haplowebs from fasta sequence alignments and help perform the congruence analysis presented in this article.

