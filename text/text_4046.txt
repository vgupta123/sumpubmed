BACKGROUND
metagenomic sequencing involves high-throughput sequencing of complex samples comprised of nucleic acid from multiple organisms. although the technique is relatively new, published examples of metagenomic sequencing to detect and/or characterize a causal agent in diseases of animals and humans are already too numerous to be summarized here. in some cases, as in the case of a novel filovirus that caused an outbreak in uganda in  <dig>  metagenomic sequencing was used to follow up when results from traditional diagnostic assays indicated a novel agent. for instance, the ugandan filovirus had produced a positive result in a broadly cross-reactive igm capture assay followed by mixed results in rt-pcr assays for known filoviruses, and so metagenomic sequencing was employed to characterize the genome of the novel virus  <cit> . another example whereby more traditional diagnostic assays and metagenomic sequencing both played a role in detection is the identification of human metapneumovirus causing fatal infection of wild rwandan gorillas  <cit> . the opposing scenario, in which traditional diagnostic assays completely fail and metagenomic sequencing plays more than just a supporting role, includes a recent report of astrovirus encephalitis in an immune-compromised teenage boy  <cit> .

metagenomic sequencing has many advantages over more traditional methods of pathogen detection, such as pcr, elisa, cytopathic effect, etc. these advantages include relative speed, the ability to detect non-culturable organisms, and, perhaps most importantly, the fact that metagenomic sequencing requires little to no a priori knowledge of the organism. however, despite these advantages, there are some significant challenges involved. these difficulties may include computationally intensive analyses; in some cases the lack of appropriate reference genomes for comparison; difficulties in sample preparation, including matrix effects and biases introduced from extraction; as well as the need for sufficient depth and breadth of coverage to detect pathogens at potentially very low levels in a given sample. it is also important to note that there are currently no standards in terms of what constitutes “identification” of a pathogen in a sample. a number of organism-specific reads will be necessary to make a true positive call, but how many reads or signatures is necessary to invoke confidence is not standardized and may vary as per sample type/complexity or may be organism-dependent. it is likely that increased depth of coverage would increase confidence in a species or strain call, but again, there is no agreed upon standard regarding depth of coverage for metagenome samples, and in many cases it would be reasonable to expect that a region of a pathogen genome detected within a metagenome sample may be only present within the reads at 1x coverage.

just as there is currently no agreed upon standard to indicate what breadth or depth of coverage would be required to make an “identification,” there is currently a paucity of knowledge regarding the actual limits of detection  for each sequencing platform and protocol. detection of even one or several pathogen-specific reads in a clinical sample that are not found in control samples is likely to be interpreted as a positive result. however, in the absence of lod data, it is difficult to conclude with any confidence that a pathogen is not present simply because no pathogen-specific reads are detected. recently, moore et al. conducted a lod study whereby viral rna in serial dilutions was spiked into a colorectal biopsy sample and sequenced using the illumina platform. in this study, although the proportion of viral reads detected was less than expected, potentially due to issues quantitating the rna, virus-specific reads were detected from samples spiked with less than picogram quantities  <cit> . in another study, cheval et al. spiked plasma and cerebrospinal fluid with known concentrations of eleven different viruses to assess the level of detection by roche- <dig> pyrosequencing as compared to illumina, and found that the higher output  produced by the illumina platform resulted in better detection of the viruses per run. the authors report detection of viruses by their  <dig> sequencing at titers of 1x103pfu/ml and higher, and by illumina of viral genomes present at 1x <dig> genome copies/ml and higher  <cit> .

other studies have suggested that the lod by  <dig> sequencing for an rna virus with a genome size of ~10-11 kb lies between 1x <dig> and 1x <dig> pfu/ml  <cit> . likewise, in a recent study using artificially constructed marine metagenomes, pochon et al. determined that the  <dig> gs junior was capable of detecting dna from species present at levels greater than  <dig> % of the whole. it should be noted, however, that this study used amplicons from a single gene to determine sensitivity  <cit> . finally, variation in extraction techniques and/or sample preparation kits have been shown to affect the composition of sequence reads  <cit> . thus, any reported lod is likely to be very protocol specific, as modifications introduced at each step of the procedure can have drastic effects on overall sequence read output and quality.

in a previous study, we assessed the ability of the roche- <dig> platform to detect low-level pathogens present in a complex host background, insect vectors  <cit> . results indicated that pathogen reads present in proportions of  <dig> % were sufficient to cover 90% of a viral genome at a depth of >4x. the same study postulated the number of sequence reads required to identify a pathogen present in a sample in which  <dig> out of  <dig> pooled mosquitoes is infected. the projected number of reads necessary was expected to vary depending on titer, with high titer infections requiring hundreds of thousands of reads, while low titer infections would require tens of millions. in the current study we use the latest sequencing technologies with their increased throughput and lower cost to confirm these projections as well as establish metrics for pathogen identification from clinical samples.

RESULTS
limits of detection of roche- <dig> pyrosequencing
our previous study suggested that as few as  <dig> % of the total reads were sufficient to unambiguously identify a viral pathogen present in a complex background  <cit> . however, our experimental model was reflective of a disseminated infection and high viral load  <cit> . therefore, we wished to determine if the roche- <dig> platform was capable of detecting viruses at reduced titers.

to determine the limits of detection , mock samples were created by spiking known amounts of dengue virus type  <dig>  into 1 ml aliquots of whole human blood. total rna was extracted from each sample and used for construction of cdna libraries. sequencing of samples representing each titer was conducted in replicate fashion on the roche- <dig> platform and denv- <dig> was detected in a range of titers from 1x <dig> to 1x <dig> pfu/ml. since no denv- <dig> specific reads were detected at the titer of 1x <dig>  it was determined that the effective lod for  <dig> sequencing using this protocol must lie between 1x <dig> and 1x <dig>  and so several samples were prepared within this range . sequencing was initiated with the 1x <dig>  sample and progressed down to 1x <dig> , from which no reads were detected. overall, the decrease in the number of viral reads approximated the reduction in titer, especially at lower titers. at the lowest titer detectable, 1x <dig> , the breadth of coverage of the reference genome was 31% with an average depth of coverage of  <dig> x upon read mapping . in a parallel approach, de novo assembly of reads yielded a single contig of 427 bp in length. by comparison, assemblies of samples at 1x <dig> pfu/ml and 1x <dig> pfu/ml yielded one contig of 9445 bp and two contigs of  <dig> and 3566 bp, respectively. in both cases the largest contig in the de novo assembly belonged to denv- <dig>  it is striking that, in the case of the low titer samples, de novo assembly of the reads provides less information than would a taxonomic classification of all reads. in the case of the 1x <dig>  pfu/ml sample, although 11/ <dig>  resulting reads map to the reference, covering 31% of the viral genome, de novo assembly of the reads produces a single contig comprised of  <dig> reads that covers only 4% of the viral genome . this apparent difference between fraction of the viral genome covered by the de novo assembly and the reference mapping is due to insufficient breadth of coverage for the reads to overlap and be used in de novo assembly.

t
de novo 
comparison of roche- <dig>  illumina miseq and ion torrent pgm for detecting viral pathogens
next, we examined how the performance of benchtop sequencers would compare with that of the roche- <dig>  to that end, mock samples containing influenza virus h1n <dig> were prepared in a similar fashion to the denv- <dig> samples. for this experiment, the denv- <dig> results were used as a guide as to what range of titers to investigate. the effective lod for the  <dig> platform was found to be 1x <dig> , which we estimate to correlate with an upper limit of  <dig> - <dig>  genome copies/ml, based on work by houng et al. and wang et al., who found one denv pfu to correspond to  <dig> and  <dig> genome copies by qpcr, respectively  <cit> . therefore, an initial titer of 1x <dig> - genome copies/ml was chosen for these experiments. at 1x <dig> genome copies/ml the roche- <dig> platform was capable of detecting the influenza virus in only one out of two replicates, with only a single hit covering 3% of the flu genome . at the same concentration, two biological replicates sequenced on the pgm platform scored  <dig> and  <dig> hits, covering 7% and 12% of the genome, respectively. by contrast, two biological replicates sequenced on the miseq platform scored  <dig> and  <dig> hits, covering 79% and 95% of the genome, respectively. interestingly, even when the number of influenza-specific reads is expressed as reads per  <dig> , the miseq and pgm platforms both outperform the roche- <dig>  indicating that there may be some platform-specific factors that affect lod in addition to total output per run.

a
a
a
a: reads mapped at low stringency.

examination of the read mappings revealed that the mapped reads were not evenly distributed along the viral genome for any of the three sequencing platforms. figure 2a depicts representative read mappings by platform for segment  <dig> of influenza a h1n <dig>  for the pgm, the regions of highest coverage were found most often toward the 5′ end of segment  <dig>  specifically, 14/ <dig> mapped reads aligned within the first quarter of the genome segment. the single mapped read from the roche- <dig> was  <dig> bases in length. by contrast, the longest mapped read for the pgm was  <dig> bases. as expected, the mapped reads from the miseq platform were all  <dig> bases in length. since the pgm offers scalability in throughput, we sought to compare the sensitivity of the pgm using a  <dig> chip as well. the throughput of the  <dig> chip is similar to that of one-half of a  <dig> picotitre plate. although not shown in table  <dig>  two independent experiments using a  <dig> chip yielded a single,  <dig> base read mapped to segment  <dig> . this single read mapped within the first quarter of segment  <dig>  these data strongly suggest that increased throughput is required for detection of pathogens present at low levels.

a closer examination of the read mappings for both the pgm and miseq platforms indicated that some mapped reads were spurious. in order to eliminate these matches, stringency of read mapping parameters was increased. at the medium stringency setting, whereby the length of the read required to match was increased from 50% to 70%, the number of mapped reads dropped by roughly half for the pgm and by roughly 10% for the miseq. furthermore, the number of miseq reads that mapped in pairs was roughly 25% . this is most likely due to polymorphisms in the sequenced strain that are not present in the ncbi reference genome. as expected, no reads mapped at the highest level of stringency tested, as the requirement for 100% identity would preclude any matches.

for influenza virus segment  <dig>  the miseq yielded  <dig> mapped reads versus the single mapped read from the pgm. it is noteworthy that although the miseq reads covered more of the segment overall than the single pgm read did, both platforms produced a single read in an area of high g/c content. given that the miseq consistently produced the highest depth of coverage, we next examined whether the increased coverage of the miseq was sufficient to determine the presence of a single nucleotide polymorphism  that conveys resistance to a widely used antiviral drug, oseltamavir . previous studies have established that influenza a strains from the  <dig> epidemic had mutated to an ose-resistant phenotype  <cit> . thus, we examined the reads resulting from miseq sequencing of a  <dig> epidemic strain for the presence of the mutation h275y, and in neither of two biological replicates were any of the known snps detected. in fact, there was zero coverage of that specific region of the genome. given that our experimental model, human blood, represents a relatively low-complexity sample , spiked with influenza a genomes at titers higher than would be expected to be encountered in a clinical sample, these data suggest that pathogen enrichment may be a necessary step for determination of drug resistance by metagenome sequencing.

de novo assembly and blastn analysis of influenza a reads
in many cases the identity of a pathogen may not be known or the pathogen’s genome may be very divergent at the nucleic acid level from that of known family members, necessitating analysis by means other than mapping reads to a reference genome. therefore, de novo assemblies of the influenza a metagenomes from the pgm and miseq data were performed, followed by blastn analysis. assembly of the pgm reads using mira produced an average of  <dig>  contigs, yet not a single contig was classified as influenza a . in fact, no contig was classified as a viral taxon. this result is surprising given the observed sequence depth in several regions of the influenza a genome . we also attempted assembly of the pgm reads using velvet with similar assembly parameters. again, none of the resultant contigs were able to be assigned to influenza a. upon closer inspection, it was observed that the identified reads were either substrings of each other and therefore absorbed during the merge step of assembly, or they had a stretch of mismatches long enough  to cause the assembly algorithm to mark these reads as not overlapping.
de novo assembly and blastn statistics of influenza a sequence reads

by comparison, assembly of the miseq reads for two biological replicates using velvet generated well over  <dig>  contigs for both replicates, with  <dig> and  <dig> flu-specific contigs, respectively. taxonomic classification of the contigs by megan properly assigned the correct strain ) in  <dig> out of  <dig> and  <dig> out of  <dig> contigs. importantly, only the strain level classifications were mis-assigned. in each case, the correct genus and species calls were made. therefore, each of the contigs identified by megan as influenza but not correctly identified at strain level was individually subjected to blastn analysis and manual curation of results. this inspection revealed that the proper strain was indeed present in the hit tables , but that for each of these contigs, there were several strains hit with the identical e-value, including a/swine/iowa/15/ <dig>  and therefore, a definitive strain call could not be made in those cases. thus, for one of two replicates, a majority of the influenza-specific contigs resulting from de novo assembly of the miseq reads were either properly classified to the strain level, or conserved amongst a subset of strains including a/swine/iowa/15/ <dig>  it was interesting to note that, in each case, contigs corresponding to segments  <dig>  and  <dig>  were not assigned to the proper strain. these results demonstrate that the increased throughput of the miseq enables species level identification of reads present in proportions as low as .0008% of the total.

comparison of influenza a sequencing replicates on the pgm and miseq
we were interested in further examining the observed differences in the number of mapped reads between biological replicates and between genome segments. in addition, we wished to determine the reproducibility of our results. the biological replicates  sequenced on the miseq platform exhibited considerable variability , and we were interested in determining at what stage this variability would arise- at library construction or sequencing. thus, we performed replicate sequencing runs for each of the pgm and miseq libraries. the total number of mapped reads for each technical replicate was quite consistent . this observation held true for both platforms. moreover, each individual library yielded a number of mapped reads that was less than one standard deviation from the average. thus, the inter-run variability seems to be limited and results of sequencing a given library preparation are highly reproducible.

however, we did note several tendencies regarding the number of mapped reads per segment . firstly, segment  <dig> tended to be overrepresented in each pgm replicate. specifically, for comparison, we expressed the proportion of mapped reads for a given genome segment as a function of that particular segment’s length, as follows:

 y=#mappedreadspergivensegment/#totalreadsmapped/segmentlength× <dig> 

this value for segment  <dig> is more than twice that for any other segment by pgm sequencing . this is an interesting observation given that segment  <dig>  at  <dig> bases in length, is the fifth largest segment in the genome. in every case for the pgm, segment  <dig> yielded the most mapped reads. this observation is consistent with our previous result with the  <dig> chip in which the only segment mapped was segment  <dig> . secondly, segment  <dig> tended to be underrepresented, in both the pgm and miseq data. this trend was especially marked in the pgm libraries as compared to the miseq libraries . these findings suggest that some sequences are inherently favored for sequencing by the pgm as well as the miseq. thirdly, regardless of the number of reads mapped, the coordinates of the mapped reads in relation to the genome were widely variable . this effect was more pronounced in the pgm libraries. this suggests that the library diversity is greater than that sampled by a single sequencing run.

comparison of roche- <dig>  illumina miseq and ion torrent pgm for detecting bacterial pathogens
although there have been performance comparisons of the benchtop platforms for sequencing bacterial isolates  <cit>  to our knowledge, there has been no published report of comparisons of sensitivity and specificity in terms of speciation. therefore, we aimed to establish a lod for each sequencer using samples spiked with a known biothreat agent, bacillus anthracis. using the sterne strain as a surrogate of anthrax infection, the quantity of bacterial cells present in a dilution series was established. using three complementary quantitative techniques, mock samples with b. anthracis sterne present at roughly  <dig>  cells/ml of human blood were prepared.

all three platforms delivered sequence reads matching the chromosome of b. anthracis sterne by reference mapping . as expected, given the increased throughput, both pgm and miseq yielded significantly higher numbers of reads as well as genome coverage. however, at low stringency, large numbers of reads were falsely counted as mapped. this trend was especially prominent in the pgm data. most of the spurious reads were short  and low-complexity . this tendency was confirmed in the replicate samples. the same pattern was observed in the roche- <dig> sequence reads as well. in general, the  <dig> reads were clustered near the 5′-end of the linear reference sequence, while the pgm and miseq reads spanned a much larger breadth. however, the  <dig> reads were uniformly longer and more information-rich. the miseq replicates demonstrated a similar tendency as that of the pgm; in general, the lower stringency mapping contained matched reads of short length . for comparison, in replicate two for both platforms,  <dig> % of mapped miseq reads mapped as non-perfect matches versus  <dig> % of mapped pgm reads. the average read length of a non-perfectly matched miseq read was  <dig>  bases, as compared to  <dig>  bases for the pgm. interestingly, the mean number of mismatches per read tended to be higher in the miseq data than that of the pgm . due to the slightly longer length of mapped miseq reads, there could conceivably be more opportunity for mismatched bases per read. therefore, we compared the mismatches within miseq reads and pgm reads by expressing mean number of mismatches per read as a proportion of mean read length of non-perfectly matched reads. when expressed in this manner, the proportion of mismatches per length of non-perfectly matched reads is  <dig>  for the miseq versus  <dig>  for the pgm. additionally, the number of indel related mismatches was found to be proportionally higher in the miseq reads than in the pgm reads. conversely, the pgm reads had a higher number of a → t and g → c transversions than the miseq data. this is inconsistent with the known error models for both of these platforms.

a
a: fraction of reference covered using high stringency mapping parameters as defined in methods.

although de novo assemblies and taxonomic classification were attempted for both pgm and  <dig> reads, no dataset produced a single contig that matched bacillus spp. this is most likely due to the lack of coverage of the bacterial genome, resulting in a lack of sufficient overlap between reads necessary to form a contig. by comparison, de novo assembly of one miseq run yielded  <dig> , <dig> total contigs. taxonomic classification of the assembled sequence reads rendered  <dig> contigs that were assigned to the bacillus cereus superfamily. more importantly,  <dig> contigs were properly classified as bacillus anthracis sterne. these results echo those of the viral samples in that assembled sequence reads from the miseq were able to identify the spiked-in microorganism, in this case to the strain level.

detection of genetic engineering
we were interested in whether sequencing reads near the lod could detect an instance of genetic engineering. therefore, the strain of b. anthracis spiked into human blood for these experiments was a 34f <dig> strain of b. anthracis containing a stably integrated genomic copy of red fluorescent protein . metagenomic sequence data was compared with a computer simulation of the likelihood of detecting this genetic manipulation. for this purpose, we developed a perl-based algorithm to generate a distribution of the number of sequence reads necessary to detect a gene of 1000 bps inserted at five locations into a prokaryotic genome of 5 mb in size. at  <dig> organism-specific reads, the probability of detecting the inserted gene is roughly one-third . in fact, the minimum number of organism-specific hits necessary to ensure detection of the inserted gene is  <dig> . given that  <dig> of the  <dig> metagenomes sequenced here contained far fewer than  <dig> bacillus-specific reads , one would expect few, if any, sequence reads to match the rfp reference sequence. indeed, read mapping to the available ncbi reference  yielded zero matches to the rfp gene present in the 34f <dig> chromosome. these data suggest that increased titres, targeted enrichment, or both will be necessary for detection of gene-insertion events.

discussion
historically, identification of causal agents of disease has relied heavily on one’s ability to culture the organism in the laboratory and/or the use of organism-specific antibodies or sequence-based probes. however, these methods can be very limiting. for instance, some microorganisms are refractory to laboratory culture. in some cases, even microbiological assays for diseases that are manifested by cultivable organisms, such as endocarditis caused by staphylococci and streptococci, have a high false negative rate  <cit> . serological assays are typically limited to identifying known or closely related organisms and antigenic drift and shift can result in false negatives. even highly sensitive pcr-based assays must be continually updated due to signature degradation  <cit> . additionally, for divergent viruses such as hiv- <dig>  many pcr assays are unable to discriminate between closely related strains. this necessitates design of multiple probe sets, which is often a laborious task  <cit> . additionally, the sensitivity of these assays is often low due to high numbers of false negatives  <cit> . thus, there is a need for assays that are more robust and less pathogen specific.

prior to the widespread adoption of high-throughput sequencing , high-density oligonucleotide microarrays were used to determine the presence of microorganisms. syndrome-specific panels showed success in diagnosis of infectious disease  <cit> . however, sequence features sufficiently different from the array probe will not hybridize, resulting in false negatives. by comparison, hts represents a relatively unbiased approach to detection of causal agents of infectious disease. however, for metagenomic sequencing to be utilized in a routine clinical context would require some basic questions answered in terms of sensitivity and reproducibility. in this study, we compared three hts platforms for their ability to detect pathogens in human blood. as compared to the traditional roche- <dig> sequencer, the benchtop sequencers iontorrent pgm and miseq were better able to detect a pathogen in human blood, in part by virtue of their increased throughput.

our reported lod for viral samples on the roche- <dig> of 1x <dig>  pfu/ml is similar to but slightly lower than a previously reported value of 1x <dig> pfu/ml  <cit> . this may be a reflection of an increased number of reads in our study, differences in sequence library preparation or improvements in sequencing chemistry. notably, this value is near the lod for a validated qpcr assay  <cit> . our reported lod of 1x <dig>  pfu/ml corresponds to an upper limit of  <dig>  –  <dig>  genome copies/ml. indeed, at that titer, the sequence reads were of sufficient number and length to unequivocally discriminate between dengue virus subtypes. however, a strain-level designation was not possible. the inability to make a strain-level call could conceivably have potential clinical consequences. for instance, a recent phylogenetic study of circulating strains of dengue virus  <dig> indicated that a single substitution on the prm <dig> was responsible for fatal cases of dengue hemorrhagic fever  <cit> .

using a different virus at a comparable titer, the roche- <dig> platform was able to definitively identify the pathogen in only one of two replicates. both the pgm and miseq surpassed the roche- <dig> in terms of number of mapped reads as well as reproducibility. however, although the roche- <dig> sequence data produced only a single hit, the length and quality of the hit were adequate to make a correct strain call .

the apparent difference in the ability of each platform to detect a given pathogen is a function of the total output per platform. when the values are expressed in a normalized manner , it becomes apparent that the analytical sensitivity of the two benchtop platforms is roughly the same and surpasses that of roche- <dig> . neither technology seems to have a significant advantage regarding detection or characterization of a pathogen if the number of reads is held constant. when cost per sequencing run or per megabase is factored in, the benchtop sequencers are a more economical option.

in this study, we also examined metagenomic sequencing for its ability to detect a genetically modified pathogen in a clinical sample. a bsl- <dig> strain of b. anthracis containing an inserted rfp gene was used as a surrogate for a genetically modified organism , and spiked into human blood at relatively high concentration. in this case, although reads were identified as likely originating from b. anthracis, in none of the samples was evidence of the inserted gene detected. this likely means that, for the time being, even with their substantial output, the benchtop sequencers are not suitable for detection of gmo from complex samples or characterization of threat agents from complex samples. our results indicate, however, that although characterization of a given pathogen from a clinical sample by metagenome sequencing on a benchtop sequencer may not be possible without some pathogen-specific enrichment, identification of species and even strains is possible.

the results of this study suggest that the benchtop sequencers perform well at the task of identifying a putative pathogen present at low titers. each of the three platforms tested provided a number of reads that was sufficient to unambiguously identify the pathogen to species level in the case of virus and to the genus level in the case of bacteria. the data from each platform was very reproducible for technical replicates within library preparations. indeed, the data from each platform was remarkably consistent in terms of quantity and quality . additionally, there was little variation in the number of reads mapped or in taxonomic classification of contigs. these results suggest that library protocols and sequencing chemistries are robust and uniform enough to make a dependable identification of a given pathogen. our results are in agreement with a recently published study in which gdna from bacillus anthracis was serially titrated into background dna collected from air filters and soil. the results of this study demonstrated that, even with whole genome amplification prior to sequencing, it is difficult to assign a proper species classification to sequence reads from b. anthracis  <cit> .

we did note several platform-specific variations in our data. for instance, in the case of the influenza data from the pgm platform, segment  <dig> routinely exhibited coverage bias as compared to larger segments. there could be several possible explanations for this observation. the g/c-content of the influenza a genome displays wide intra-segment and inter-segment variations . a closer examination of the mapped reads seems to show a slight correlation with areas of low g/c-content, but follow on experiments would be required to conclusively elucidate the impact of g/c-content in this context. a number of studies have noted that ngs data have distinct biases in areas of high g/c-content  <cit> . additionally, template amplification via emulsion pcr is a potential source of reduced library diversity  <cit> . moreover, inefficiencies during reverse transcription due to rna secondary structure may be responsible for the observed coverage bias. given that the initial step in pgm library construction involves random fragmentation with rnase iii at 37°c, it is possible that some rna strands did not completely unfold. this may be especially true for those segments with higher Δg, such as segments  <dig>   <dig> and  <dig> . although the miseq replicates also showed a slight skew towards segment  <dig>  the preference was not as extreme as that for the pgm. this may be due in part to the method for rna library construction on the miseq platform. the initial step involves a chemical fragmentation step at high temperature. thus, the diversity of the libraries may be different from the start. on the other hand, the pgm replicates demonstrated some variation in mapped reads  suggesting that increased throughput might produce greater diversity.

another platform-specific characteristic observed in this study was the proportion of mismatches within a non-perfectly mapped read. this statistic was slightly higher for the miseq platform than for the pgm platform. ideally, given the correct reference sequence, for a given platform this statistic would approach zero as sequencing error decreased. however, as in this case, this statistic may also be affected by nucleotide differences between the sequenced strain and the closest reference sequence available from ncbi, precluding us from making any conclusions as to sequencing error rates from these data. it is possible that, to some extent, the longer length of miseq reads allows for more opportunity for mapping of non-perfect matches, and this may contribute to a decreased lod for miseq when mapping to a closely related but not identical reference sequence. however, the extent to which error rate versus strain level differences and read length affect this statistic as well as the lod cannot be ascertained in the absence of a true reference sequence for the strain in question.

a number of recent reports have attempted to define the limitations of metagenomic sequencing data. one study made use of simulated data sets to compare assemblies from three sequencing technologies . unsurprisingly, the study concluded that assembly quality decreased rapidly with increasing sample complexity. for low complexity samples  the assemblies were comparable in quality and inclusiveness, while illumina data produced superior assemblies in a higher complexity sample   <cit> . these results mirror those presented here in that no one sequencing chemistry clearly surpassed another in terms of identification of a microorganism present in a low-complexity sample. it should be noted that the illumina data in the study by mende et al. were from the hiseq platform and were extensively trimmed to provide high quality reads as input  <cit> . a separate report estimated that genome coverage of 20x was required for proper taxonomic classification of species present in a given metagenomic community  <cit> . this study is in agreement with our inability to make a correct species-level determination from our bacillus anthracis samples. additionally, our results complement an important conclusion from the previous report - that the efficiency of gene detection is most likely overestimated.

there has been much effort to understand and improve metagenomic data from complex samples comprised mostly of bacterial species. there are fewer published studies examining the effects of different sequence technologies on viral metagenomics. a recent research paper attempted a comparison of roche- <dig> and illumina data for estimation of diversity in viral quasispecies, in this case hiv. the authors of that study noted that the increased throughout and lower error rate of the illumina platform enabled improved reconstruction of viral haplotypes. however, due to the longer read lengths, the roche- <dig> was superior when long range reconstruction was necessary  <cit> .

our results indicate that library diversity and overall throughput are the two key metrics in determining how a researcher or clinician may use metagenomic data from benchtop sequencers. for instance, a recent survey of human papillomavirus dna present in human skin tumors demonstrated that the increased throughput of the pgm enabled identification of seven additional viral subtypes as compared to data from roche- <dig> sequencing of the same samples  <cit> . this result is similar to our observation that pgm data provided steady, reproducible identification of influenza a virus in comparison to sequence data produced by the roche- <dig>  overall, the miseq proved superior to both the ion torrent pgm and roche- <dig> for both detection as well as classification of the pathogen present in our mock samples.

although there is no published report of this, it remains formally possible to identify a previously unknown agent from a single novel microbial read present in a complex metagenomic sample. indeed, identification of novel agents has been reported with as few as  <dig> reads out of over  <dig>   <cit> . whereas identification of an agent may require detection of only one or more reads, characterization, the crucial next step, is absolutely dependent on complete  or nearly complete representation of the agent’s entire genome at adequate depth of coverage, especially in the case of rna viruses or other microorganisms likely to exhibit functionally relevant minority populations or quasispecies, or genetically modified organisms. in this case, it is necessary for follow-on experiments to more fully characterize the genome of the microorganism, such as sanger sequencing using primers based on the novel fragment. it would be optimal if some of the original sample were available for such experiments. however, in many cases, the original sample may be precious or limited in terms of volume. this challenge can be more pronounced when identifying viral agents as opposed to bacterial agents. viral genomes are orders of magnitude smaller  than those of an average bacterial agent . thus, the overall amount of viral nucleic acid may be in the picogram range, increasing the likelihood of two technical obstacles: 1) viral nucleic acid is outcompeted during amplification by other nucleic acids in the matrix, such as host ribosomal rna if the matrix is tissue or, 2) if the overall amount of nucleic acids in the metagenome sample itself is low, then library preparation of the sample may fail as successive losses of genetic material occur in each step. targeted amplification of organism-specific regions prior to sequencing has shown some promise. for instance, an assay in which multiplex pcr preceded sequencing was able to fully differentiate bacillus anthracis, yersinia pestis and francisella tularensis <cit> .

CONCLUSIONS
in this study, we sought to determine empirical limits of detection for metagenomic sequencing of clinical samples using three different sequencing platforms. we found that the analytical sensitivity of all three platforms approaches that of standard qpcr assays. although all platforms were able to detect pathogens at the levels tested, there were several noteworthy differences. the roche- <dig> titanium platform produced consistently longer reads, even when compared with the latest chemistry updates for the pgm platform. the miseq platform produced consistently greater depth and breadth of coverage, while the ion torrent was unequaled for speed of sequencing. none of the platforms were able to verify a single nucleotide polymorphism responsible for antiviral resistance in an influenza a strain isolated from the  <dig> h1n <dig> pandemic. additionally none of the platforms tested was able to detect evidence of genetic engineering in a bacterial biowarfare agent that was spiked into a clinical-type sample. overall, the benchtop platforms perform well for identification of pathogens from a representative clinical sample. however, our results indicate that, unlike identification, characterization of pathogens is likely to require higher titers, multiples libraries and/or multiple sequencing runs.

