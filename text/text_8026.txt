BACKGROUND
a systems biology approach which is becoming increasingly used in microarray data analysis is the search for enriched  terms in a list of interesting genes. this kind of approach tries to disclose the biological meaning behind the massive amount of data derived from high-throughput techniques  <cit> . by translating the results into a more human-friendly output, the search for over-represented terms can reveal pathway connections to track biological processes, helping the biologists to build system-level hypotheses.

the problem of ontology term enrichment is generally treated as the test for terms in a gene list that are present in higher numbers than it would be expected only by chance. the terms analyzed are generally derived from an ontology or a classification design. many genome sequencing projects define their own organism-specific gene classification but recently, we are witnessing an increase in the use of general and standardized vocabularies and classification procedures, such as the one proposed by the gene ontology consortium  <cit>  or by the kegg database  <cit> .

there are many software packages and web sites addressing the ontology term enrichment problem and it is difficult to acknowledge all of them. the most commonly known are those listed in the gene ontology  <cit>  web-site  <cit> , such as: onto-express  <cit> , genemerge  <cit> , funcassociate  <cit> , fatigo  <cit> , gostat  <cit> , goarray  <cit> , go::termfinder  <cit> , thea  <cit>  and ontologytraverser  <cit> ; but there are other options such as lack  <cit> , which deals with generic lexical bias. recently, more than ten different tools were compared and reviewed in  <cit> .

despite several options, there is no software that searches for enriched ontology terms using a bayesian statistical framework. moreover, to our knowledge, all the software packages available are based on the hypothesis test paradigm. we believe that, with the aim of defining enriched terms, the measure of statistical association can be an informative alternative or a useful complement to the usual statistical significance. thus, our original contributions in this work are:  to provide a software that measures the statistical association between differential gene expression and a given ontology term and  to present a statistical model for the enrichment problem that takes into account the realistic fact that, sometimes, not all the genes previously known as related to a given property are in fact observed.

we provide a mathematical source-code that can be easily accommodated into pre-existent software packages or pipelines, in addition to a version for windows that can be interactively controlled and a web-tool that supports organisms that share special local interest and are neglected by mainstream tools.

implementation
measure of statistical association
the genes in a microarray dataset can be organized using a classification scheme such as go  <cit> , kegg  <cit>  or an organism-specific categorization. let i be the list of genes related to the term in focus. let j be the list of genes related to term different from the term i. the dataset is described by a  <dig> ×  <dig> contingency table:

differentially expressednon differentially expressed        i-jijj−ixi−jxijxj−ini−j−xi−jnij−xijnj−i−xj−i
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqaaewabaaabaaabagaeeiraqkaeeyaakmaeeozaymaeeozaymaeeyzaumaeeocainaeeyzaumaeeoba4maeeidaqnaeeyaakmaeeyyaemaeeibawmaeeibawmaeeyeaknaeeiiaaiaeeyzaumaeeieagnaeeicaanaeeocainaeeyzaumaee4camnaee4camnaeeyzaumaeeizaqgabagaeeota4kaee4ba8maeeoba4maeeiiaaiaeeizaqmaeeyaakmaeeozaymaeeozaymaeeyzaumaeeocainaeeyzaumaeeoba4maeeidaqnaeeyaakmaeeyyaemaeeibawmaeeibawmaeeyeaknaeeiiaaiaeeyzaumaeeieagnaeeicaanaeeocainaeeyzaumaee4camnaee4camnaeeyzaumaeeizaqmaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaacaauaabeqadmaaaeaacqwgpbqacqggtaqlcqwgqbgaaeaacqwgpbqacqwgqbgaaeaacqwgqbgacqghsislcqwgpbqaaeaacqwgybawdawgaawcbagaemyaakmaeyoei0iaemoaaogabeaaaoqaaiabdifaynaabaaaleaacqwgpbqacqwgqbgaaeqaaagcbagaemiwag1aasbaasqaaiabdqgaqjabgkhitiabdmgapbqabaaakeaacqwgobgtdawgaawcbagaemyaakmaeyoei0iaemoaaogabeaakiabgkhitiabdifaynaabaaaleaacqwgpbqacqghsislcqwgqbgaaeqaaagcbagaemota40aasbaasqaaiabdmgapjabdqgaqbqabagccqghsislcqwgybawdawgaawcbagaemyaakmaemoaaogabeaaaoqaaiabd6eaonaabaaaleaacqwgqbgacqghsislcqwgpbqaaeqaaogaeyoei0iaemiwag1aasbaasqaaiabdqgaqjabgkhitiabdmgapbqabaaaaaaa@af44@

where: xi-j is the number of differentially expressed genes that are i-exclusive, ni-j is the total number of genes that are i-exclusive, xij is the number of differentially expressed genes belonging to the i and j intersection, nij is the total number of genes belonging to the i and j intersection, xj-i is the number of differentially expressed genes that are not related to the term i  and nj-i is the total number of genes that are not related to the term i . note that a given gene must be counted in one and only one of these cases and that summing over all n. yields the total number of considered genes.

in  <dig>  goodman and kruskal wrote a classical work discussing several issues on measures of association for contingency tables  <cit> . we choose to report the goodman and kruskal's gamma  <cit>  since it is symmetric and normalized between - <dig> and  <dig>  the gamma measure  is a  <dig> ×  <dig> extension of the known  <dig> ×  <dig> yule's q:

g = /     

where p = xi-j + xij and q = xj-i + xij. g values near  <dig> indicate that the property described by the term in focus have an important role in the biological phenomena studied. g values below or near zero have no relevant biological interpretation since they mean the absence of association with differential gene expression.

probabilistic model and bayesian inference
focussing on a given term and using the same notation from the previous sub-section, let xi-j be the number of differentially expressed genes observed that are i-exclusive, ni-j be the total number of observed genes that are i-exclusive, xij is the number of observed differentially expressed genes belonging to the i and j intersection, nij is the total number of observed genes belonging to the i and j intersection, xj-i is the number of differentially expressed genes observed that are not related to the term i and nj-i is the total number of genes that are not related to the term i. note that n. ≥ n. ≥ x. for any sub-index, represented by the "dot".

it is possible to realize that x.|x.,n.,n. follows a hypergeometric distribution  <cit> :

pr=−1
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaieqacqwfqbaucqwfybgccqggoaakcqwg4baecqgguaglcqgh9aqpcqwgrbwacqgg8bafcqwgybawcqgguaglcqggsaalcqwgobgtcqgguaglcqggsaalcqwgubgbcqgguaglcqggpaqkcqgh9aqpdaqadaqaauaabeqaceaaaeaacqwgybawcqgguaglaeaacqwgrbwaaaaacagloagaayzkaawaaewaaeaafaqabegabaaabagaemota4kaeiola4iaeyoei0iaemiwaglaeiola4cabagaemoba4maeiola4iaeyoei0iaem4aasgaaagaayjkaiaawmcaamaabmaabaqbaeqabiqaaaqaaiabd6eaojabc6cauaqaaiabd6gaujabc6cauaaaaiaawicacaglpaaadaahaawcbeqaaiabgkhitiabigdaxaaaaaa@58af@

we will omit n. and n. from the notation since they are always known numbers. using a non-informative uniform as the a priori distribution for x. and the hypergeometric likelihood above, it is possible to show that the a posteriori distribution of |x. is a betabinomial distribution  <cit> :

pr=b
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaaieqacqwfqbaucqwfybgccqggoaakcqwgybawcqgguaglcqghsislcqwg4baecqgguaglcqgh9aqpcqwgrbwacqgg8bafcqwg4baecqgguaglcqggpaqkcqgh9aqpdaqadaqaauaabeqaceaaaeaacqwgobgtcqgguaglcqghsislcqwgubgbcqgguaglaeaacqwgrbwaaaaacagloagaayzkaagaemoqaikaeiikagiaem4aasmaey4kasiaegymaejaei4oasjaemota4kaeiola4iaeyoei0iaemoba4maeiola4iaeyoei0iaem4aasmaey4kasiaegymaejaeiykakcaaa@5624@

where b is the beta special function.

therefore, the  <dig> ×  <dig> contingency table can be rewritten as:

differentially expressednon differentially expressed        i-jijj−ixi−j+|xi−jxij+|xijxj−i+|xj−ini−j−xi−j−|xi−jnij−xij−|xijnj−i−xj−i−|xj−i
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqaaewabaaabaaabagaeeiraqkaeeyaakmaeeozaymaeeozaymaeeyzaumaeeocainaeeyzaumaeeoba4maeeidaqnaeeyaakmaeeyyaemaeeibawmaeeibawmaeeyeaknaeeiiaaiaeeyzaumaeeieagnaeeicaanaeeocainaeeyzaumaee4camnaee4camnaeeyzaumaeeizaqgabagaeeota4kaee4ba8maeeoba4maeeiiaaiaeeizaqmaeeyaakmaeeozaymaeeozaymaeeyzaumaeeocainaeeyzaumaeeoba4maeeidaqnaeeyaakmaeeyyaemaeeibawmaeeibawmaeeyeaknaeeiiaaiaeeyzaumaeeieagnaeeicaanaeeocainaeeyzaumaee4camnaee4camnaeeyzaumaeeizaqmaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaacaauaabeqadmaaaeaacqwgpbqacqggtaqlcqwgqbgaaeaacqwgpbqacqwgqbgaaeaacqwgqbgacqghsislcqwgpbqaaeaacqwg4baedawgaawcbagaemyaakmaeyoei0iaemoaaogabeaakiabgucarmaabmaabagaemiwag1aasbaasqaaiabdmgapjabgkhitiabdqgaqbqabagccqghsislcqwg4baedawgaawcbagaemyaakmaeyoei0iaemoaaogabeaaaogaayjkaiaawmcaamaaeeaabagaemieag3aasbaasqaaiabdmgapjabgkhitiabdqgaqbqabaaakiaawea7aaqaaiabdiha4naabaaaleaacqwgpbqacqwgqbgaaeqaaogaey4kasyaaewaaeaacqwgybawdawgaawcbagaemyaakmaemoaaogabeaakiabgkhitiabdiha4naabaaaleaacqwgpbqacqwgqbgaaeqaaagccagloagaayzkaawaaqqaaeaacqwg4baedawgaawcbagaemyaakmaemoaaogabeaaaogaay5bsdaabagaemieag3aasbaasqaaiabdqgaqjabgkhitiabdmgapbqabagccqghrawkdaqadaqaaiabdifaynaabaaaleaacqwgqbgacqghsislcqwgpbqaaeqaaogaeyoei0iaemieag3aasbaasqaaiabdqgaqjabgkhitiabdmgapbqabaaakiaawicacaglpaaadaabbaqaaiabdiha4naabaaaleaacqwgqbgacqghsislcqwgpbqaaeqaaagccaglhwoaaeaacqwgobgtdawgaawcbagaemyaakmaeyoei0iaemoaaogabeaakiabgkhitiabdiha4naabaaaleaacqwgpbqacqghsislcqwgqbgaaeqaaogaeyoei0yaaewaaeaacqwgybawdawgaawcbagaemyaakmaeyoei0iaemoaaogabeaakiabgkhitiabdiha4naabaaaleaacqwgpbqacqghsislcqwgqbgaaeqaaagccagloagaayzkaawaaqqaaeaacqwg4baedawgaawcbagaemyaakmaeyoei0iaemoaaogabeaaaogaay5bsdaabagaemota40aasbaasqaaiabdmgapjabdqgaqbqabagccqghsislcqwg4baedawgaawcbagaemyaakmaemoaaogabeaakiabgkhitmaabmaabagaemiwag1aasbaasqaaiabdmgapjabdqgaqbqabagccqghsislcqwg4baedawgaawcbagaemyaakmaemoaaogabeaaaogaayjkaiaawmcaamaaeeaabagaemieag3aasbaasqaaiabdmgapjabdqgaqbqabaaakiaawea7aaqaaiabd6eaonaabaaaleaacqwgqbgacqghsislcqwgpbqaaeqaaogaeyoei0iaemieag3aasbaasqaaiabdqgaqjabgkhitiabdmgapbqabagccqghsisldaqadaqaaiabdifaynaabaaaleaacqwgqbgacqghsislcqwgpbqaaeqaaogaeyoei0iaemieag3aasbaasqaaiabdqgaqjabgkhitiabdmgapbqabaaakiaawicacaglpaaadaabbaqaaiabdiha4naabaaaleaacqwgqbgacqghsislcqwgpbqaaeqaaagccaglhwoaaaaaaa@2751@

the degree of association determined in eq. <dig> is now a function of the random variables xi-j, xij and xj-i, described by the betabinomial a posteriori probability functions.

in computational terms, it means that several independent  <dig> ×  <dig> contingency tables are built using random variates drawn according to their respective betabinomial probability distributions. the empirical probability distribution of the association level is obtained by applying eq. <dig> to each of these random contingency tables. the significance analysis and the construction of credibility intervals  are based on this empirical distribution of g.

we have used 90% credibility intervals as default, but this parameter can be easily adjusted in the source-code. the credibility intervals are defined as previously described  <cit> .

assessing the significance of association measurements
to evaluate the significance of a measured statistical association, we have determined the probability p = pr, where gobs is the observed association and gm is the association obtained from montecarlo simulations. this simulation process accounts for the ontology's structure since it is influenced by the connectivity of the ontology graph.

the simulation consists in uniformly sampling lists from the observed genes. in each simulation round, this random list of length m is considered as the list of differentially expressed genes. ideally, the number of genes used in each round considers that there is an intrinsic error when one defines a gene as differentially expressed. keeping the length constant m = ni-j + nij + nj-i could be an unrealistic approximation, due to the possibility of a global false-calling rate. we used a generic and heuristic sampling rule considering this length as m ~ poisson. it is possible to incorporate other rules to define the length m in baygo source-code. the rule can be derived from the particular method used for the identification of differentially expressed genes.

the definition of p is similar to the frequentist p-value if gobs is a real number and m is kept constant. it is known that, in this configuration, simulations tend to agree with the theoretical results from fisher-like methods. however, if we consider that not all the genes were observed and thus, the association is also a random variable, then the frequentist p-value is not defined. on the other hand, the bayesian analog p is still valid since the event {gm ≥ g} is well defined. this probability is calculated in the baygo software by counting the number of times that this event occurs during the montecarlo rounds. note that, in each round, a new g value is calculated based on random variates drawn according to the betabinomial model described in the previous sub-section.

baygo source-code
baygo source-code is provided in three versions: linux, windows® and as a package for building a custom web-based interface. the core of baygo is written as r language scripts  <cit> . the package for web-based interfaces is a set of perl, html and r source-codes.

the main source-code of baygo receives as inputs: an r binary "database" file, a list of differentially expressed genes in a plain-text file, a list of genes that were not differentially expressed and the number of simulation rounds desired for the significance and error-bar determination. the r binary "database" file keeps the organism information: an ontology table, containing all available ontology terms and descriptions, and an ontology-to-gene table, listing all the genes classified under each term. this file is built only once by an auxiliary script and it is used in several analysis. to build this "database" it is necessary to provide as inputs: a gene-to-ontology plain-text file  and an ontology description plain-text file. detailed examples are provided in the baygo user-manual available at baygo home-page  <cit> .

baygo assumes that the ontology-to-gene or gene-to-ontology tables are adequately built by the user, considering the different levels of abstraction of the go graph desired. these issues include taking into account the hierarchical structure when considering father/sons ontology terms and defining an arbitrary truncation level of the graph  <cit> .

the linux version was designed to be easily incorporated into pre-existing tools or pipelines. there are several software packages that deal with the ontology term enrichment problem  <cit>  and many of them are integrated with relevant databases, creating a knowledge discovery environment for the biologist user. we did not try to surpass these efforts and therefore, we provide a software that receives and exports simple plain-text files and is operated in a non-interactive form. these features allow baygo to be incorporated as a mathematical module in complex and complete pipelines. an example of an opensource software which has a powerful gui is clutree  <cit> .

the version for windows® was designed to be extremely user-friendly. it does not require any programming skills and it is controlled interactively by menus. the functions to analyze the data and build r binary "database" files are integrated in the windows-style menus.

finally, the web-based version was designed to allow the researchers to establish their own local web-tool for the ontology term enrichment analysis. it is easy to realize that the organisms supported by the web-based tools are restricted to those with a vast research community such as human, mouse, yeast and so on. this version will enable research communities focussed on other organisms to settle a useful resource, assuming a simple infrastructure such as a web-server with perl/cgi allowed.

microarray experiments
to test the baygo software, we used microarray data from the heat shock response in bacteria. since this stress triggers a conserved biological response from a system-level viewpoint, we believe that meaningful results could show baygo usefulness. therefore, we analyzed the transcriptional response of the phytopathogenic bacterium xylella fastidiosa exposed to a temperature shift-up from 29°c to 40°c for  <dig> minutes.

the complete dataset and all the miame-required details regarding the construction, hybridization, image acquisition and expression ratio normalization are publicly available at geo database  <cit>  under the accession number gse <dig>  the microarray slides and data were obtained according to  <cit> . the expression ratio between the 40°c and 29°c  conditions was normalized using the lowess fitting exactly as in  <cit> .

unreliable spots, presenting intensities too similar to the local background or saturated were filtered out. spots presenting mean signal intensity below the mean background plus  <dig> times its standard deviation in cy <dig> and cy <dig> simultaneously were eliminated from subsequent analysis. saturated spots were also discarded. the htself method  <cit>  was used to define the differentially expressed and non differentially expressed genes. briefly, the htself method uses self-self experiments  to derive an intensity-dependent cutoff curve. we used credibility intervals of  <dig> , window size of  <dig>  and window step of  <dig> . it is assumed that genes found consistently outside this cutoff curve are differentially expressed. a gene was classified as differentially expressed or not if it has at least  <dig> measured replicates and 80% of the replicates are outside or inside the intensity-dependent cutoff curves, respectively.

the pathway information about the bacterium xylella fastidiosa was obtained directly from the kegg web-site  <cit>  and the gene ontology information from the goa@ebi web-site  <cit> .

we considered an ontology term as significantly enriched if it presents a p-value smaller than  <dig> . to reach the conclusions using the frequentist method, we adopted the default parameters in genemerge  <cit>  software, including bonferroni correction and using the arrayed genes as the reference set. to reach the conclusions using our bayesian method, we used the whole-genome as the reference set, as required by our proposed model.

RESULTS
measurement of statistical association in addition to statistical significance
the measurement of association is an extensively studied issue in statistics  <cit> . the usual meaning of "association" refers to coefficients that measure the strength of relationships; they are used to measure the relationship when there is a dichotomy. two other kinds of association measurements are the well-known "correlation", which is used when both variables are intervals, and the "reliability", which is used to analyze a variable with itself. the concept of statistical association is different from statistical significance. measures of significance compare the strength of an observed relationship with one that would be expected by chance, if one performs random sampling. the significance analysis is influenced not only by the strength of a relationship but also by other parameters such as the sample size or the sampling procedure. it is possible to have a relationship that presents a non-significant strong association or a significant weak relationship. significance is relevant only when one has a random sample whereas association is always relevant to draw conclusions. since significance and association are not equivalent, researchers may report both measures when discussing their findings. the use of association measurements for the problem of ontology term enrichment in bioinformatics has not been explored yet; the predominance of significance approaches is evident.

we propose to measure the statistical association in the context of the ontology term enrichment problem using the goodman and kruskal's gamma factor g  <cit>  . g is a symmetric index, normalized between - <dig> and  <dig>  the interpretation of this measure is that g values near  <dig> indicate strong positive association. the positive association of a given term with differential gene expression means that the property described by the ontology term on focus can be involved in the biological phenomenon studied. negative and zero association are biologically meaningless in this context. the zero value means that there is no statistical association and the negative values indicate association with non-differential gene expression.

it is not possible to define in advance a cutoff value above which one can consider an ontology term as presenting a relevant association. on the other hand, there are some traditionally used cutoffs for significance such as  <dig>  or  <dig> . it is intuitive to rely on a conclusion showing significance of  <dig> , but it is difficult to foresee the value of association that represents a strong association in a general context . depending on the application, the value of  <dig>  can represent a strong association ; in other context, the same value can be an insufficient evidence of association between two facts. ideally, sorting ontology terms by their g values and performing external independent biological assays could provide the association cutoffs. in order to evaluate the significance of the obtained associations, we calculated the probability p = pr, where gobs is the observed association and gm is a random variable obtained by montecarlo simulation .

bayesian model accounting for non-observed genes
in a typical microarray dataset, a gene could not be detected for several reasons: it was not spotted on the array due to a selection procedure; it did not meet the quality standards on intensity, integrity, technical reproducibility, etc. if we cannot observe all the genes, the number of genes differentially expressed observed is an estimate and, therefore, we need an inferential framework.

the advantages and disadvantages of the bayesian statistics over the frequentist approach belong to an old and endless debate in statistics. some advantages of the bayesian approach for microarray analysis are well discussed elsewhere  <cit> . in the problem of ontology term enrichment, the bayesian framework allows the incorporation of prior information regarding the known size of each set of genes associated to an ontology term.

if we consider that all genes associated to a certain term were observed, the association measure g is a real number. in addition, if the significance analysis is made upon random lists of differentially expressed genes with the same length of the observed differentially expressed gene list, the probability p = pr is equivalent to the usual frequentist p-value. these assumptions are tacitly used when one performs all the fisher-like tests  <cit> .

however, if one cannot observe all the genes associated to a term, then the association should be treated as a random variable whose probability distribution reflects our ignorance about the true value. our ignorance becomes smaller as we observe more genes. moreover, we can establish credibility intervals  for the degree of association, similarly as discussed previously in a sage analysis context  <cit> . the bayesian analogue for the p-value, p = pr, is still valid even if both gm and gobs are random variables, whereas the frequentist p-value is not defined in this case.

it is possible to show that, under certain conditions, once one observes a portion of the differentially expressed genes related to a given ontology term, the unknown remainder portion is described by a betabinomial probability distribution  <cit> . this result holds under a non-informative uniform a priori  given the number of differentially and non differentially expressed genes that were observed and the number of genes known to be related to the ontology term. in other words, as it is performed in an electoral process, we estimate the behavior of the finite population of genes related to an ontology term using a sample of it.

examples of the baygo usefulness
to show the usefulness of the baygo software, we devise some illustrative examples of situations that one can face when analyzing microarray data. one of the examples shows the usefulness of the statistical association and the other examples show the bayesian feature of considering the sampling effect.

to highlight the difference between our bayesian method and one that does not account for the sampling effect, we have arbitrarily chosen the "hypergeometric" test to represent the frequentist fisher-like approaches  <cit> .

we will consider a fictitious test-organism with characteristics compatible with several real organisms. suppose that this test-organism has  <dig> genes, classified into several categories that are described by ontology terms. let us focus on an arbitrary class and list all the genes related to a term i that describes this class. the size of the set i is  <dig>  and only  <dig> genes are exclusively related to the property described by the term i. let j be the list of genes that have other terms different from i related to them. the size of this set j is  <dig>  the set i-j contains the genes that are exclusively related to the ontology term i while the set j-i contains the genes that are not related to the ontology term i. the set ij contains the genes that are not i exclusive. finally, suppose that we carried out microarray experiments comprising all the known genes.

the gene-to-ontology table for this test-organism, the complete bayesian and frequentist results and the corresponding gene lists used in the following illustrative examples are available as additional file  <dig> 

in the first example, suppose that all the  <dig> genes are observable and the microarray experiment yielded  <dig> differentially expressed genes, distributed as follows:

differentially expressednon differentially expressed        i-jijj−i317380283590
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqaaewabaaabaaabagaeeiraqkaeeyaakmaeeozaymaeeozaymaeeyzaumaeeocainaeeyzaumaeeoba4maeeidaqnaeeyaakmaeeyyaemaeeibawmaeeibawmaeeyeaknaeeiiaaiaeeyzaumaeeieagnaeeicaanaeeocainaeeyzaumaee4camnaee4camnaeeyzaumaeeizaqgabagaeeota4kaee4ba8maeeoba4maeeiiaaiaeeizaqmaeeyaakmaeeozaymaeeozaymaeeyzaumaeeocainaeeyzaumaeeoba4maeeidaqnaeeyaakmaeeyyaemaeeibawmaeeibawmaeeyeaknaeeiiaaiaeeyzaumaeeieagnaeeicaanaeeocainaeeyzaumaee4camnaee4camnaeeyzaumaeeizaqmaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaacaauaabeqadmaaaeaacqwgpbqacqggtaqlcqwgqbgaaeaacqwgpbqacqwgqbgaaeaacqwgqbgacqghsislcqwgpbqaaeaacqaizawmaeaacqaixaqmcqai3awnaeaacqaizawmcqai4aaocqaiwaamaeaacqaiyagmaeaacqai4aaoaeaacqaizawmcqai1aqncqai5aqocqaiwaamaaaaaa@8d60@

in this 1st scenario, there is no qualitative difference between the two approaches. the p-value obtained by the frequentist test is <10- <dig>  indicating a significant enrichment of the term i. accordingly, using the goodman and kruskal's gamma  to measure the statistical association between the term i and differential expression, one obtains gobs =  <dig> , a value close to  <dig> which means strong association. moreover, since all available genes were observed, g is known without uncertainty and its 90% credibility interval  has zero length. the montecarlo simulations with  <dig> rounds indicate significant association since p =  <dig> 

suppose that, for the same dataset, the result from half of the genes related to term i was not measured by typical reasons such as: it did not meet quality standards on intensity, integrity, technical reproducibility, and so on. now the contingency table is:

differentially expressednon differentially expressed        i-jijj−i19380143590
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqaaewabaaabaaabagaeeiraqkaeeyaakmaeeozaymaeeozaymaeeyzaumaeeocainaeeyzaumaeeoba4maeeidaqnaeeyaakmaeeyyaemaeeibawmaeeibawmaeeyeaknaeeiiaaiaeeyzaumaeeieagnaeeicaanaeeocainaeeyzaumaee4camnaee4camnaeeyzaumaeeizaqgabagaeeota4kaee4ba8maeeoba4maeeiiaaiaeeizaqmaeeyaakmaeeozaymaeeozaymaeeyzaumaeeocainaeeyzaumaeeoba4maeeidaqnaeeyaakmaeeyyaemaeeibawmaeeibawmaeeyeaknaeeiiaaiaeeyzaumaeeieagnaeeicaanaeeocainaeeyzaumaee4camnaee4camnaeeyzaumaeeizaqmaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaacaauaabeqadmaaaeaacqwgpbqacqggtaqlcqwgqbgaaeaacqwgpbqacqwgqbgaaeaacqwgqbgacqghsislcqwgpbqaaeaacqaixaqmaeaacqai5aqoaeaacqaizawmcqai4aaocqaiwaamaeaacqaixaqmaeaacqai0aanaeaacqaizawmcqai1aqncqai5aqocqaiwaamaaaaaa@8c66@

in this 2nd scenario, both approaches are still indicating a significant enrichment of the term i. however, the statistical association measured is now a random variable, since the data is a sample from the complete scenario. the frequentist test's p-value is  <dig> ·10- <dig>  the counts for all i-related genes were diminished proportionally , thus, the measured association remains the same gobs =  <dig> . nevertheless, there is now an uncertainty related to the measured statistical association and its 90% credibility interval is . despite the uncertainty, the association measured is much more probable than the association obtained from  <dig> uniformly generated random lists of differentially expressed genes, since p =  <dig> 

now, suppose that only one fifth of the i related genes had their expression status defined. the contingency table is:

differentially expressednon differentially expressed        i-jijj−i04380023590
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqaaewabaaabaaabagaeeiraqkaeeyaakmaeeozaymaeeozaymaeeyzaumaeeocainaeeyzaumaeeoba4maeeidaqnaeeyaakmaeeyyaemaeeibawmaeeibawmaeeyeaknaeeiiaaiaeeyzaumaeeieagnaeeicaanaeeocainaeeyzaumaee4camnaee4camnaeeyzaumaeeizaqgabagaeeota4kaee4ba8maeeoba4maeeiiaaiaeeizaqmaeeyaakmaeeozaymaeeozaymaeeyzaumaeeocainaeeyzaumaeeoba4maeeidaqnaeeyaakmaeeyyaemaeeibawmaeeibawmaeeyeaknaeeiiaaiaeeyzaumaeeieagnaeeicaanaeeocainaeeyzaumaee4camnaee4camnaeeyzaumaeeizaqmaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaacaauaabeqadmaaaeaacqwgpbqacqggtaqlcqwgqbgaaeaacqwgpbqacqwgqbgaaeaacqwgqbgacqghsislcqwgpbqaaeaacqaiwaamaeaacqai0aanaeaacqaizawmcqai4aaocqaiwaamaeaacqaiwaamaeaacqaiyagmaeaacqaizawmcqai1aqncqai5aqocqaiwaamaaaaaa@8c54@

in this 3rd scenario, the two approaches clearly disagree. the frequentist test's p-value is  <dig>  indicating no significant enrichment. the association measure gives the same result gobs =  <dig>  with the 90% credibility interval . the significance of the obtained association is p =  <dig> , indicating that the enrichment could be accepted in face of the usual  <dig>  cutoff.

intuitively, we believe that finding an abundance of 4/ <dig> for the differentially expressed genes is relevant when comparing with the total abundance of 6/ <dig> for all genes. therefore, we believe that the association measurement is capturing the essential feature of the data, even if subjected to uncertainty.

in the following, we will consider another extreme example: when the observed genes are highly biased. toward this aim, suppose that the test-organism has a gene annotation slightly different from the one used above, allocating the same  <dig> genes in a different way among the ontology terms. in the previous example, we emphasized the consistent pattern of the association measurement if the observed sample is "equilibrated" over the possible results. now, using the same test-organism and the same microarray setup, suppose that we could observe all available genes, yielding the following contingency table:

differentially expressednon differentially expressed        i-jijj−i053952503575
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqaaewabaaabaaabagaeeiraqkaeeyaakmaeeozaymaeeozaymaeeyzaumaeeocainaeeyzaumaeeoba4maeeidaqnaeeyaakmaeeyyaemaeeibawmaeeibawmaeeyeaknaeeiiaaiaeeyzaumaeeieagnaeeicaanaeeocainaeeyzaumaee4camnaee4camnaeeyzaumaeeizaqgabagaeeota4kaee4ba8maeeoba4maeeiiaaiaeeizaqmaeeyaakmaeeozaymaeeozaymaeeyzaumaeeocainaeeyzaumaeeoba4maeeidaqnaeeyaakmaeeyyaemaeeibawmaeeibawmaeeyeaknaeeiiaaiaeeyzaumaeeieagnaeeicaanaeeocainaeeyzaumaee4camnaee4camnaeeyzaumaeeizaqmaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaacaauaabeqadmaaaeaacqwgpbqacqggtaqlcqwgqbgaaeaacqwgpbqacqwgqbgaaeaacqwgqbgacqghsislcqwgpbqaaeaacqaiwaamaeaacqai1aqnaeaacqaizawmcqai5aqocqai1aqnaeaacqaiyagmcqai1aqnaeaacqaiwaamaeaacqaizawmcqai1aqncqai3awncqai1aqnaaaaaa@8d60@

it is clear that, from both frequentist test and bayesian model, there is no significant enrichment of the term i, since the p-value is  <dig> , gobs =  <dig>  without uncertainty and p =  <dig> .

suppose that one cannot observe the result from the genes related exclusively to the term i. let us consider, for instance, that the  <dig> i-exclusive genes were not spotted on the microarray slide due to gene selection. therefore, the contingency table is:

differentially expressednon differentially expressed        i-jijj−i05395003575
 mathtype@mtef@5@5@+=feaafiart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaafaqaaewabaaabaaabagaeeiraqkaeeyaakmaeeozaymaeeozaymaeeyzaumaeeocainaeeyzaumaeeoba4maeeidaqnaeeyaakmaeeyyaemaeeibawmaeeibawmaeeyeaknaeeiiaaiaeeyzaumaeeieagnaeeicaanaeeocainaeeyzaumaee4camnaee4camnaeeyzaumaeeizaqgabagaeeota4kaee4ba8maeeoba4maeeiiaaiaeeizaqmaeeyaakmaeeozaymaeeozaymaeeyzaumaeeocainaeeyzaumaeeoba4maeeidaqnaeeyaakmaeeyyaemaeeibawmaeeibawmaeeyeaknaeeiiaaiaeeyzaumaeeieagnaeeicaanaeeocainaeeyzaumaee4camnaee4camnaeeyzaumaeeizaqmaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaaiaeeiiaacaauaabeqadmaaaeaacqwgpbqacqggtaqlcqwgqbgaaeaacqwgpbqacqwgqbgaaeaacqwgqbgacqghsislcqwgpbqaaeaacqaiwaamaeaacqai1aqnaeaacqaizawmcqai5aqocqai1aqnaeaacqaiwaamaeaacqaiwaamaeaacqaizawmcqai1aqncqai3awncqai1aqnaaaaaa@8c64@

in this scenario, one is led to believe that there is a significant enrichment, since all spotted genes related to the term i were found to be differentially expressed. in fact, the p-value is <10- <dig> and the association is very strong with gobs =  <dig>  however, the 90% credibility interval of the association measurement is large  and the significance is low with p =  <dig> .

we believe that this example shows the importance of considering the sampling effect in the significance or in the association result, manifested by the large "error-bar".

application to real microarray data
to validate the baygo approach, we used the microarray experiment data corresponding to a relatively well-characterized biological phenomenon: the heat shock response in bacteria. the high temperature stress is an aggressive environmental perturbation for bacteria, triggering system level changes in their transcriptional program. although this stress response has many peculiarities depending on the particular bacteria studied, there are known conserved responses that can guide the validation of our model.

in this sense, we analyzed the response of the phytopathogenic bacterium xylella fastidiosa to a temperature shift-up from 29°c to 40°c for  <dig> minutes, using dna microarrays fully described in the geo database under the accession number gse <dig>  to define the up-regulated and down-regulated genes, as well the genes whose expression was unchanged, we used the htself method  <cit>  .

in this example, we will focus on the up-regulated genes induced by the temperature stress; therefore, the non-induced genes are the down-regulated plus the non-perturbed genes. it is not our aim in this work to explore the particular biological implications of this dataset. the complete study of heat shock response comprising several time-points, along with the biological rationale and conclusions will appear elsewhere .

we avoid making extensive comparisons with the methods available since there are several combinations of ways in which a term enrichment analysis can be performed  <cit> . a given method can yield a different qualitative result depending on the multiple-test correction used, depending on several free parameters or depending on the input ontology . furthermore, we believe that presently, there is no reasonable independent methodology of biological validation to confront the system-level biological conclusions obtained with different softwares.

we chose to present the baygo results along with the results obtained by genemerge  <cit> . genemerge is one of the few methods available that accepts arbitrary ontologies and supports arbitrary organisms, not being limited to the most studied ones  <cit> . note, however, that this is an illustrative comparison.

the first analysis is relative to kegg pathways. additional file  <dig> contains the complete output from the bayesian and frequentist softwares for kegg terms analysis. the pathway terms significantly enriched  according to the frequentist methods are: protein folding and associated processing and folding, sorting and degradation. the terms enriched  according to our bayesian methods are: protein folding and associated processing, folding, sorting and degradation and genetic information processing. these results are completely compatible with what is known about the bacterial heat shock response  <cit> . it seems that baygo correctly captured the kegg term genetic information processing since it is known that bacteria facing such stress change their gene expression program in a broad system-level sense.

the second analysis is relative to gene ontology. additional file  <dig> contains the outputs from the baygo and genemerge softwares for go terms analysis. the ontology terms significantly enriched  according to the frequentist method are: protein folding , unfolded protein binding , response to unfolded protein  and protein binding . the terms enriched according to our bayesian method  compose a more numerous set, including the  <dig> terms found by the frequentist method. table  <dig> shows these significant terms.

the biological insight provided by the bayesian method seems to be richer when one is trying to elaborate a system-level picture of the transcriptional disturbance caused by heat shock. for instance, baygo was able to highlight the term hsluv protease activity  and heat shock protein binding  that were not highlighted by the frequentist analysis. both activities are classically known to be involved in the heat shock response  <cit> .

we restricted our illustrative comparisons to the significance analysis since there is no similar software that approaches the statistical association issue presented in this work. we believe that the use of association measurements can help the biologists in their microarray analysis. for instance, the term chaperone activator activity  presents a strong association level  but not a high significance  and the chaperone molecules are known to be related to the heat shock response. results for all terms are available in additional file  <dig> 

it is important to note that the comparison performed in this section should be carefully considered since there are many possible variations for the frequentist analysis  <cit> . however, we believe that these experimental results show the usefulness of baygo software.

baygo source-code
our source-code is provided as r language  <cit>  scripts in three versions: linux, windows. and as a package for building custom web-based interface locally. the linux version receives its parameters non-interactively by command-line arguments and thus, it can be easily incorporated into pre-existing pipelines or web-based tools. the version for windows is a user-friendly program that is controlled interactively by menus, without the necessity of programming, being more appropriate for end-users. finally, the web-based version is a set of r, perl and html source-codes that allows one to build his own web-based tool locally, focussing on the organisms of interest.

using the web-based version, we have created a useful web-tool that supports organisms of interest to our local research community  <cit> . the ever-growing list of supported organisms includes some of those that are neglected by the most used similar tools, such as xylella fastidiosa, xanthomonas citri, blastocladiella emersonii, etc. although baygo was designed based on gene ontology terms, the software can also be used with other classification designs. for this, the user has to provide a gene-to-ontology hash table for all known genes and not only for those spotted in the microarray slide.

caveats, limitations and recommendations
the approach of finding enriched ontology terms in microarray data has several known intrinsic limitations. in our opinion, the most severe limitations are:  the practical difficulty in the experimental validation of the conclusions derived from such methods, since it is difficult to manipulate a large set of genes to observe which system-level deductions are real or methods' artifacts;  the large quantity of "free parameters" that can be changed in routinely use of these methods, from the hierarchical structure of ontologies limited by the user to the choice of cutoff p-values;  the tacit assumption that a given function, pathway, etc., is "important" or not solely based on numerical aspects  ignoring the qualitative aspects involved ; and  the results rely heavily on gene annotation provided for the studied organism.

it is likely that, even for well studied prokaryotes, many genes have no known function and others are likely to be involved in different processes and therefore, they are associated to multiple presently unassigned ontology terms. a potential implication is that the contingency tables probably hold more uncertainty than it is taken into account by the present models. there are some efforts in trying to quantify the effects of mis-annotation or to establish some form of probabilistic gene annotation, including bayesian models  <cit> . future directions of works in the ontology term enrichment problem should include such gene annotation uncertainties.

the ontology term enrichment problem is not restricted to differential gene expression analysis or to microarray derived data. the current models, including the one implemented in baygo, are capable of analysing the enrichment relative to other dichotomous properties such as "belonging to a particular gene cluster" vs. "not belonging", in clustering analysis  <cit> ; "it is expressed " vs. "it is not expressed ", in gene transcription analysis; "narrowly expressed transcripts" vs. "prevalently expressed transcripts"  <cit> ; and so on.

particularly for baygo, the dichotomous properties are defined in the two rows of the contingency table. the significance of the statistical association is measured relative to the first row, however, since gamma  is symmetric around zero, flipping rows order will yield the "opposite" analysis. in the illustration presented in the section application to real microarray data, we chose to analyze the induced genes after temperature stress, defining the dichotomous property as "up-regulated" vs. "not up-regulated" . conversely, one may want to focus on the repressed genes defining the contigency table's rows as "down-regulated" vs. "not down-regulated". another possibility is to analyze "perturbed" vs "no change", independent of the direction of the change.

generally, the methods to find enriched terms work using nominal lists of genes without knowledge of how the list was obtained. the means by which these gene lists were obtained define the interpretation and meaning of the result. it is important to note that the method used to obtain the differentially expressed genes  has an important impact on the enrichment analysis since they determine the gene list that is inputed. in this work, we analysed our microarray data using our recently published htself method  <cit>  but we provide the same analysis using widely used approaches as well at the supplemental material  <cit> .

baygo was designed to be a mathematical module and therefore, it has a limited interactive potential. for instance, it does not provide a graphical user interface  that allows the user to browse his/her results. these features are complex and are beyond baygo's scope. it was designed to be incorporated into pre-existing software with elaborated gui front-end. one good option of such front-end is the opensource software clutree  <cit> . one of the future directions for baygo evolution could be its incorporation on available guis.

CONCLUSIONS
when dealing with the system-level problem of finding enriched terms from microarray data, most of the softwares available use only the significance analysis. in this work, we have introduced the use of a measure of statistical association between ontology terms and differentially expressed genes, in addition to the common significance analysis. we elaborated a bayesian statistical model for the ontology term enrichment problem that incorporates information about the composition of the ontology by taking into account genes that were not observed in the microarray data. the examples given in this work aim at making the investigators aware of the necessity of considering the sampling problem when drawing system-level conclusions.

the baygo software can be used with generic gene-to-ontology tables and not only with go classification. the web-tool is implemented for a set of organisms with particular interest to our local research community, but we made available the source-code that allows one to build custom web-tools for other organisms. we also made available an r source-code and a web-based tool that calculates these association measurements and their significances.

finally, we would like to highlight that the estimation of statistical association and statistical significance are not equivalent procedures. we believe that the use of statistical association should be more explored in bioinformatics. statistical association is an established tool in statistics, widely used in other research fields since it allows the visualization of relationships inside the data that are not considered when using only significance analysis

availability and requirements
• project name: baygo

• project home page: 

• operating system: platform independent 

• programming language: r.

• other requirements: to build a local version of the web-service it is necessary to have apache with cgi allowed and perl.

• license: under the gnu general public license

list of abbreviations
go: gene ontology

kegg: kyoto encyclopedia of genes and genomes

sage: serial analysis of gene expression

gui: graphical user interface

authors' contributions
rznv and tk conducted the work and drafted the manuscript. rznv and cabp are responsible for the statistical model and software. tk and slg are responsible for all the experimental work and biological interpretation. all the authors wrote and approved the manuscript.

supplementary material
additional file 1
zipped file containing all the data relative to the artificial test-organism. it contains: the gene-to-go table, the complete genome, the input data for creating the examples of "examples of the baygo usefulness" section and all the outputs/results obtained for those examples.

click here for file

 additional file 2
excel or gnumeric worksheet containing all the results from term enrichment analysis of xylella fastidiosa heat shock experiment, described in the "application to real microarray data" section.

click here for file

 acknowledgements
we thank thiago m. venancio for several suggestions and critical reading of the manuscript. tk is supported by a doctoral fellowship from fundação de amparo à pesquisa do estado de são paulo . slg and cabp are partially supported by conselho nacional de desenvolvimento científico e tecnológico .
