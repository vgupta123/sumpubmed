BACKGROUND
three-dimensional protein structures provide invaluable insights into the molecular basis of protein functions, and such insights are essential for rational design of molecules regulating these functions. nowadays, in an increasing number of cases, it has become possible to model protein structures with acceptable accuracy by employing much less effort than that required in experimental methods. progress in computational protein structure prediction has been boosted by methodological improvements in the technique called template-based modeling , which uses experimental structures of homologous proteins as templates. as biological sequence and structure databases expand continuously, tbm is expected to become an even more promising tool for practical molecular biology, pharmaceutical chemistry, and protein engineering problems  <cit> .

template-based modeling, also called homology modeling or comparative modeling, generally consists of the following steps  <cit> :  identification of homologous proteins with known structures to be used as templates;  alignment of the sequences of the target and templates;  creation of model structures from the alignment; and  refinement of the models. contemporary methods usually treat each stage separately, and the full tbm procedure can therefore be established by combining methods for each of the above stages.

despite recent progresses, there still remain challenges for each stage mentioned above. one of the important challenges is how to optimally combine information from multiple templates to build a single model when experimental structures of multiple homologues are available. using multiple templates rather than a single template offers several obvious benefits: the possibility of including a better template increases, and the fraction of the target sequence covered by templates is extended  <cit> . in addition, different regions in template structures may be combined to produce a more accurate model  <cit> . however, in practice, it is complicated to combine information from multiple templates in an optimal way  <cit> . since the average quality of multiple templates is bound to be worse than that of the single best template, using multiple templates is associated with a rather large risk of contaminating reliable information from the best template. to overcome this problem, various approaches have been proposed  <cit> . most of them heavily rely on a single top template while additional templates are used to fill the gaps not covered by the top template  <cit> .

another challenge is to model structurally variable regions among templates or those regions not covered by any templates, which we call ulrs . unless the target sequence is quite similar to those of the templates , the expected quality of template-based models could be limited by such regions. moreover, such ill-conserved regions where sequence insertion/deletion occurs may not be the subject of typical tbm. despite previous efforts, progress in modeling such regions seems to be rather limited  <cit> . since high-resolution models are required for practical applications, it is doubtless that better ulr modeling is essential.

we recognize that the above  <dig> challenges are not independent of each other. for example, the performance of ulr modeling can be limited by the quality of the framework structure constructed from multiple templates  <cit> . we therefore propose a strategy by which both initial tbm and subsequent ulr modeling can benefit from each other. in the initial tbm, we focus on accurate modeling of more conserved regions among multiple templates, without the need to consider potentially unreliable regions since such regions are taken care of in the ulr modeling stage. in the ulr modeling stage, we fix the more reliable core structure so as not to deteriorate the overall model quality by potentially less reliable ab initio ulr modeling. therefore, ulrs can be modeled in a more accurate framework structure, and the conformational search space for ulr modeling is also effectively reduced to the local regions. related approaches that construct a reliable core and refine unreliable regions have been proposed previously  <cit> . the difference between our approach and these is that we put more stress on the “accuracy”  of the core structure in the initial tbm stage .

we call this new method galaxytbm, as it is based on the galaxy molecular modeling package  <cit> . galaxytbm employs a multiple-template method designed to produce reliable core structures by rescoring hhsearch  <cit>  results for multiple-template selection and by core sequence alignment using promals3d  <cit> . model building from the alignment and subsequent ulr modeling is performed using optimization modules in galaxy  <cit> .

all components of the prediction pipeline were tested in the 9th critical assessment of techniques for protein structure prediction  as a predictor named “seok-server.” according to the official results of casp <dig>  seok-server is recognized as one of the top  <dig> servers  <cit> . since the prediction strategy for seok-server had to be modified a few times during casp <dig>  as the method was immature at the beginning, the most recent version, galaxytbm, is presented here. when galaxytbm was tested on  <dig> single-domain casp <dig> tbm targets, fixing the structure database at the version with which seok-server was used during casp <dig>  it reproduced the performance of seok-server . performance of the tbm pipeline was evaluated by analyzing the improvements achieved at each stage. merits of the new components in the pipeline over other tbm methods are also discussed.

RESULTS
rescoring of hhsearch results improves the template quality
we used a simple but effective rescoring strategy to select multiple templates from the homologues detected by hhsearch  <cit> , as described in the methods section. here, we analyzed the performance of the rescoring method in terms of the quality of the top ranker compared to that of the hhsearch top ranker. template quality was measured by a similarity score called tm-score calculated using the tm-align tool  <cit> , which ranges from  <dig>  to  <dig> . improvement achieved by the selection scheme of “multiple” templates is discussed in the next subsection.

overall, top rankers obtained by the rescoring scheme were closer to the native structures of the target proteins than the hhsearch top rankers, when tested on the  <dig> single-domain casp <dig> tbm targets. different proteins ranked as top by rescoring in  <dig> out of the  <dig> cases, with an average improvement of  <dig>  in tm-score. tm-score increased for  <dig> out of the  <dig> targets and decreased for the remaining  <dig> targets, with average increases of  <dig>  and − <dig> , respectively. a paired t-test for the tm-score changes for the  <dig> targets showed that the improvement is statistically significant, with a p-value of  <dig> .

as can be seen from figure  <dig>  the improvement did not strongly correlate with target difficulty. it is also notable that outstanding improvement was obtained in some cases. for example, the top ranker in the hhsearch for t <dig> had a low tm-score of  <dig> , but the rescoring scheme ranked a protein with a tm-score of  <dig>  as the first, although this protein ranked very low  in the original hhsearch. these improvements could be primarily attributed to the greater consideration of the secondary structure score when scoring more difficult targets . in other words, when sequence conservation between target protein and homologues is low, information on secondary structure conservation can be more helpful in selecting closer homologues.

multiple-template information improves the model quality
in addition to selecting top rankers successfully, the template rescoring method is also effective in providing candidates for multiple templates. multiple templates were selected by filtering out structural outliers from the candidates after core structure alignment . to assess the improvement achieved by using multiple templates, model structures built from the multiple templates were compared with those built from the single top template   and those from a naïve multiple template selection method that considers all proteins with hhsearch e-values < 10- <dig> . the average number of templates selected by galaxytbm and the naïve method was  <dig>  and  <dig> , respectively. for each target and for each method,  <dig> models were generated by modeller  <cit> , and gdt-ts score  averaged over them is reported. although tm-score is used for measuring the quality of a “template” which has a different sequence from the native protein, the gdt-ts measure is used for assessing the quality of a “model” with the same sequence.

by using the current multiple template approach, gdt-ts improved when compared to the values obtained using the single-template approach  and the naïve multiple-template method . the gdt-ts improvement is statistically significant, with p-values of  <dig>  and  <dig> , respectively. improvement over the naïve method was prominent when high-ranking proteins by hhsearch have diverse structures, implying that the current multiple-template selection scheme that excludes dissimilar structures is fairly successful. for example, for t <dig>  mean gdt-ts of generated models is  <dig>  and  <dig>  by the current approach and by the naïve approach, respectively. similar type of large gdt-ts improvement of >  <dig> was also found in t <dig>  t <dig>  t <dig>  t <dig>  and t <dig> 

to determine whether the model improvement by the multiple-template approach is a consequence of covering more residues by additional templates, we checked whether a similar improvement was found for core regions . the core region is defined here as the target residues aligned with the single top template by promals3d  <cit> . the core region covers 31% to 100% of the whole protein, with an average coverage of 85%. as shown in figure 2a, gdt-ts of the core region was also improved by the current multiple-template method compared to the single-template method. average gdt-ts improvement was  <dig> %, with a p-value of  <dig> .

in conclusion, the current multiple template selection method contributes to improving the core structure by utilizing useful information from additional templates selected by the current pipeline.

better optimization during model-building further improves the model quality
in galaxytbm, model building is performed by the modeller-csa  <cit>  module implemented in galaxy. it was previously reported that more thorough optimization of the target restraint function derived by modeller is possible with the method, generating model structures more consistent with the restraints  <cit> . to evaluate the performance of model building in the current pipeline, we compared the structures generated in this stage with the model structures generated simply by using modeller  <cit> . the  <dig> methods, modeller and modeller-csa, use the same sequence alignments, template lists, and therefore the same spatial restraints, and differ only in the optimization method.

as in the previous subsection,  <dig> model structures were generated for each target. overall, model building by modeller-csa improved the sum of gdt-ts by  <dig> %  compared to modeller, with a p-value of  <dig> . average gdt-ts improvement was  <dig>  for the  <dig> targets for which single templates were used and  <dig>  for the  <dig> targets for which multiple templates were used. the better gdt-ts improvement in the multiple-template cases can be explained by the fact that the more complex target restraint functions for the multiple-template problems can be better optimized with the more rigorous optimization method  <cit> .

in addition to the backbone structure quality, the side-chain structure quality was also improved by the better optimization during model building. the χ <dig> accuracy  was improved in  <dig> out of  <dig> targets, with an average improvement of  <dig> %. the χ1 + χ <dig> accuracy  was also improved . this improvement is consistent with the findings of the previous report by joo et al. <cit> .

positive effects of the overall multiple-template strategy
to illustrate the effects of the overall multiple-template strategy in more detail, the relationship between the model quality improvement and the template quality improvement achieved by the use of multiple templates is demonstrated in figure  <dig>  in this figure, model qualities were measured for the core region, instead of the whole structure, to clarify the impact of using multiple templates. the points in the upper right corner of figure  <dig> represent the cases in which templates of higher quality than the top ranker contribute to improving the model quality. this is one of the expected positive effects of using multiple templates. it is particularly intriguing that in a non-negligible number of cases , model quality was improved even when the average template quality decreased from that of the top single template , particularly in those where no additional templates had better quality than the top ranker . this effect may be attributed in part to the success of the multiple-template selection method, which can pick out additional complementary templates without introducing large negative effects of contaminating good information from the top ranker. improvement by more thorough optimization in the model-building stage  is more pronounced in the left side of the figure, where the average template quality was worse than that of the top ranker.

the above analysis indicates that the positive effects of using multiple templates can be maximized by the current template selection strategy that considers core structure consensus and the more rigorous optimization during model-building, and the common adverse effects caused by including inconsistent templates in typical multiple-template methods can be minimized by use of such a combination.

ulr refinement also contributes to improvement of the model quality
here we present the results of the final stage of the pipeline, i.e., refinement of ulrs. a total of  <dig> ulrs  were detected in the initial stage, and  <dig> ulrs were finally subject to reconstruction following the selection rule described in methods. these reconstructed ulrs consisted not only of the regions that were not aligned to any template residues but also of the regions that were structurally inconsistent among templates.

of the  <dig> reconstructed ulrs,  <dig> ulrs corresponded to the regions in which more than half of the residues are disordered in experimental structures and thus were neglected in the following analysis. in figure  <dig>  rmsds of the ulr structures  before and after refinement are compared for each ulr. the average improvement in rmsd achieved by refinement was  <dig>  Å. the rmsd improvement was statistically significant, with a p-value of  <dig> . since the current refinement changes only local regions, improvement in the overall structure measured by gdt-ts was rather small. the sum of gdt-ts over  <dig> domains containing refined ulrs increased by  <dig> % , with an average increase of  <dig>  per domain. although the improvement was small, it is statistically significant, with a p-value of  <dig> . more accurate prediction of ulr regions is invaluable for functional or design studies that involve such protein-specific local regions. it is also notable that the current refinement result is comparable to the results obtained by seok-server in casp <dig>  <cit> , even though a lighter ulr optimization strategy has been employed.

computational cost
template selection and multiple sequence alignment take a few minutes on a single core. the median time required for model building with modeller-csa and refinement was  <dig>  and  <dig>  hours, respectively, when  <dig> cores were used in parallel.

CONCLUSIONS
in this article, we report a new tbm method—galaxytbm—that builds reliable core structure from multiple templates and reconstructs unreliable regions by ab initio loop or terminus modeling in the fixed framework of the core structure. the current multiple-template strategy maximizes the positive effects of using multiple templates by selecting complementary multiple templates that do not contaminate the information from the best template significantly and by thorough optimization of possibly conflicting template restraints during model building. when model refinement by detection and re-building of unreliable loop or terminus regions is applied, additional improvement in model quality is observed. several sound elements of the current strategy, such as template rescoring, multiple-template selection based on core-structure alignment, and multiple sequence alignment of core sequences could be easily incorporated into other tbm methods to enhance their performance.

