BACKGROUND
in comparison to other high-throughput methods, next generation sequencing  technologies enable genome-wide investigations of various phenomena, including single-nucleotide polymorphisms, epigenetic events, copy number variants, differential expression, and alternative splicing  <cit> . rna sequencing  uses the ngs technology for discovering novel rna sequences, and quantifying all transcripts in a cell  <cit> . like genome tiling arrays, an rnaseq experiment can capture evidence for yet unannotated genes and isoforms. the utility of rnaseq to uncover new transcripts is well documented . several laboratories have provided evidence that cdna library preparation and rna sequencing sets are technically well reproducible and in contrast to microarrays rnaseq offers a broader dynamic range, which makes this platform more sensitive in the detection of transcripts with low abundance  <cit> .

the steady increase of publications involving rnaseq experiments generated a need for statistical and computational tools to analyze the data. basically, all rnaseq analyses involve the following tasks: pre-processing, quality control, read mapping and further analyses like differential expression  analysis, single nucleotide polymorphism  analysis or gene isoform and splicing variant detection. however, the availability of tools following a standardized analysis protocol are limited  <cit> .

a number of software packages and pipelines have already been introduced to deal with these tasks. these software packages are mainly based on programming languages like c, python or r and require advanced expertise in programming or computer science for proper implementation and use or they do not provide advanced analytical tools like gene network inference methods, mirna-target predictions and/or the integration of protein-protein interactions . additionally, the possibility of discovering alternatively spliced genes or promoter activity would be desirable. furthermore, there is no common rnaseq data analysis strategy, despite the obvious need for such a standardized pipeline  <cit> . the increased dependence on computational approaches in life sciences has revealed grave concerns about the accessibility and reproducibility of the computed results  <cit> . galaxy is a free web-based platform for omics research that addresses the following needs  <cit> :accessibility: galaxy enables users to perform integrative omics analyses by providing a unified, web-based interface for obtaining omics data and applying computational tools to analyze these data. learning a programming language or the implementation details is not necessary.

reproducibility: galaxy produces metadata about every possible analysis step and automatically tracks descriptive information about datasets, tools, and parameter values to ensure reproducibility. user annotations and tagging is possible at each step of the pipeline.

transparency: galaxy includes a web based framework for sharing models including datasets, histories, workflows and repositories. it also allows users to communicate and discuss their experimental results in an online forum.



implementation
using galaxy, we developed a comprehensive, transparent, reproducible and automated analysis pipeline, named trapline, for rnaseq data processing , evaluation and prediction. the predictions are based on modules which are able to identify protein-protein interactions, mirna targets and alternatively splicing variants or promoter enriched sites. a schematic representation of the analysis pipeline is illustrated in fig.  <dig>  trapline can be accessed via the published galaxy page of trapline  or via www.sbi.uni-rostock.de/rnaseqtrapline.fig.  <dig> scheme to illustrate trapline’s rna sequencing analyses modules. * the target files are provided as galaxy histories - mirna targets  and protein-protein interactions 



trapline implements the following tools and resources:  fastq quality trimmer, fastxclipper and fastqc for pre-processing and quality control,  tophat <dig> for read mapping,  picard toolkit for read correction and snp identification,  cufflinks2/cuffdiff <dig> for de analysis, splicing and promoter testing  the database for annotation, visualization and integrated discovery  for gene annotation and functional classification,  miranda for mirna target prediction,  biogrid for protein-protein interactions and, finally, a compiling module for ready to use network construction files. for detailed instructions regarding the usage of trapline please see the manual in the additional file  <dig> 

RESULTS
to show the effectiveness of our automated pipeline, we exemplarily applied trapline to rnaseq data generated from our recently described antibiotic selected cardiac bodies , which are highly pure clusters of mouse embryonic stem cell  derived cardiomyocytes generated via myh <dig> promoter based antibiotic selection plus a standardized differentiation protocol   <cit> . their rna expression profiles were compared to control embryoid bodies  derived from the same cell line without administration of the antibiotic.

trapline includes state-of-the-art quality control processes
trapline analyses rnaseq reads obtained from illumina, solid and solexa platforms with the help of “fastq groomer”  <cit>  that converts the specific formats as a first step. in the following pre-processing step, adapter sequences, which have been added to the 5’ and 3’ ends of the cdna fragments during the sample preparation phase, are being clipped . in the illumina sequencing procedure, sequences are extended on both ends by -  <dig> nucleotide long adapters that may influence the results of the subsequent analysis  <cit> . these adapters are only used during the illumina bridge amplification procedure to immobilize the cdna transcripts. in trapline we implemented the tool “fastxclipper”  for this purpose.

it is necessary to discriminate sequencing errors from biological variation by using quality scores   <cit> . therefore, in the last pre-processing step uncalled and wrongly called bases are removed . standard approaches rely on the associated quality scores to retain the read, or a portion of it, if the score is above a predefined threshold  <cit> . as suggested by mbandi et al.  <cit>  we excluded reads with a score q <  <dig> to ensure reliable genome mapping results. for the purpose of discarding low quality reads, we implemented the widely used tool “fastq quality trimmer” which returns a quality control report for each dataset that was analyzed. the effects achieved by quality trimming our data are shown in additional file 3: figure s <dig> 

we compared the fraction of mapped reads with and without applying data pre-processing . our observations confirm the findings of chen et al.  <cit> , who demonstrated the necessity of applying the described pre-processing steps in a read-mapping benchmark.fig.  <dig> evaluating the different analyses modules of trapline. a a fraction of mapped reads with and without applying pre-processing modules . tophat <dig> was used for genome mapping. error bars indicate the standard deviation. asterisks indicate a significant difference: # welch’s t-test with α =  <dig> ; § anova with α =  <dig> ; . b comparison of different genome mapping tools. the bars indicate the transcript accuracy of the reads aligned to the genome in %, including the standard deviation. marks indicate significant difference: # welch’s t-test with α =  <dig> , bonferroni test with α =  <dig> ; . c and d comparison of read correction procedure by picard toolkit, before  and after , to visualize and correct for multiple rna sequences in the experimental datasets. rseqc shows the two specific read duplication correction possibilities: "sequence-base" reads have the same nucleotide sequence , "mapping-base" reads have the same mapped sequence, but are aligned to different locations on the genome . e comparison of three different de analysis tools , after read mapping with bowtie  tophat <dig> . the total number of significantly differentially expressed genes is based on fdr <  <dig>  and divided into upregulated and downregulated genes. f vulcano plot illustrating significantly differentially expressed genes 



tophat <dig> - the most accurate alignment tool in galaxy
to select the most suitable read alignment tool, we analyzed the overall mapped transcript coverage on the genome  of the most commonly used alignment tools, which are based on the exon first approach. figure 2b shows the results of our comparison between bwa  <cit> , bowtie  <cit> , bowtie <dig>  <cit> , and tophat <dig>  <cit> , and their average accuracy in the mapping of six different datasets. the overall alignment accuracy of the mapped reads to the reference genome is between 70 % and 85 %. bowtie <dig> and tophat <dig>  that share a similar algorithm, produce a significantly higher accuracy in comparison to the bwa and bowtie alignment tools . in our case, the bowtie <dig> alignment algorithm was able to map in average  <dig>  million more reads to the genome than the bwa/bowtie algorithm . our observations are consistent with the results of kim et al.  <cit> , who found that tophat <dig> generates more accurate alignments than competing tools, using fewer computational resources. because of the significantly superior mapping accuracy of tophat <dig>  in contrast to bowtie/bwa, and the additional functionality to find splice junctions and promoter regions, we decided to include tophat <dig> into trapline. the outputs of tophat <dig> are bam files which contain the aligned reads to the reference genome and text files summarizing the accuracies of the mapped reads for each fastq file.

correction of reads is necessary for snp detection
the presence of duplicates is a major issue in single/paired short reads from ngs platforms. pcr amplification is one of the major sources of duplicates, which are usually introduced during sequencing library amplification  <cit> . these duplicates might have a serious impact on research applications, especially towards snp detection, because they can confound the expression data of a particular gene and, therefore, are usually removed  <cit> . a popular tool for this task is “markduplicates” from the picard toolkit , which finds the 5’ coordinates and mapping orientations of each read pair and removes them. during this procedure, the tool considers all clipping that has taken place as well as any gaps or jumps in the alignment. to investigate the influence of the duplicate removing step with picard tools, we determined the read duplication rates and the number of reads mapped to the same location using the “rseqc” python module  <cit> . the results are visualized in fig. 2c and d. rseqc uses two strategies to determine read duplication rates:  sequence based , which means reads with identical sequences are regarded as duplicated reads;  mapping based  which expresses reads that are mapped to exactly the same genomic location. a comparison of both figures clearly shows an elevation of the mapping-base. the red dots are refined in fig. 2d in contrast to fig. 2c, meaning that there were many aligned reads with a similar mapping sequence but with a different location on the genome, which was corrected by “markduplicates”. the corrected bam-files can be further investigated by a snp calling analysis software such as gatk  <cit>  or crisp  <cit> .

cuffdiff <dig> adds value to the standard de analysis
the different de analysis methods are based on  negative binomial models, such as edger, deseq, bayseq,  non-parametric approaches, such as samseq, noiseq and  transcript-based detection methods, such as cuffdiff <dig> and ebseq  <cit> . we compared the performances of the most widely used de tools from each group, which are cuffdiff <dig>  <cit> , edger  <cit>  and samseq  <cit> , to show how they compare and to underline the de analysis efficiency of trapline. prior to the analysis reads were mapped to the reference genome with different methods , because each tool has different data input requirements. figure 2e shows only slight differences between the applied de methods. all tools nearly identified the same amount of genes as significantly upregulated among in acabs compared to ebs , however different amounts of genes were classified as downregulated. in general, the statistical approaches used by edger and samseq are more liberal in defining significant differences than the cuffdiff <dig> algorithm  <cit> . in agreement with our results, these widely used methods have recently been compared by several research groups  <cit> . cuffdiff <dig> estimates expression at transcript-level resolution and controls the variability and read mapping ambiguity by using a beta negative binomial model for fragment counts  <cit> . furthermore, the tool enhances the comparability between experiments, because it uses the derived “reads per kilobase per million”  mapped reads metric  <cit>  which normalizes for both gene size  and the total number of reads or fragments . seyednasrollah et al.  <cit>  stated cuffdiff <dig> as the most conservative de method with the lowest false positive rate. therefore, we included cuffdiff <dig> for rnaseq de analysis in trapline to retrieve precise results with highly significant genes.

as default setting cuffdiff <dig> considers genes as significant for p ≤  <dig> , and a fold change  higher than two. another reason to integrate cuffdiff <dig> into trapline is the possibility to determine differential splicing events and to perform differential promoter testing  <cit> . this possibility qualifies the pipeline to investigate for genes with two or more splice variants and genes producing two or more distinct primary transcripts . multiple splice and promoter isoforms are often co-expressed in a given tissue  <cit> .

we have performed a performance test between trapline and other tools. a summary of the ratio of mapped reads, discarded reads and significantly differentially expressed genes obtained with the indicated tools is shown in additional file 4: table s <dig> 

gene annotation, mirna target prediction and protein-protein interactions with trapline
additionally, we included three data annotation and prediction steps into trapline. first, filtering modules were implemented to scan the list of differentially expressed genes and extract sets of upregulated and downregulated genes. additionally, users receive a link to david  <cit>  to evaluate the functional influences of the significantly upregulated/downregulated transcripts within their data. in general, david finds gene ontology terms , signaling pathways  or protein domains  that are predominantly associated with lists of genes . moreover, david performs a functional annotation clustering analysis that groups these terms into functionally related clusters which gives the user a first and quick insight into the biological impact of the discovered differences  <cit> . second, trapline includes modules for mirna target prediction that use significantly upregulated and downregulated mirnas and automatically spot possible targets among the downregulated or upregulated mrnas in the analyzed datasets. for this purpose we provide formatted text files of conserved and non-conserved mirnas and their predicted targets for different species , based on the latest version of the microrna.org database . the files can be obtained via a galaxy history and have to be uploaded as trapline “mirna targets” input. third, we implemented a module which is able to identify verified interactions between proteins of significantly upregulated and downregulated mrnas. the protein-protein interactions are based on data from peer-reviewed publications deposited in the biogrid database . similar to the mirna targets, we provide protein-protein interactions from five different species  in the form of galaxy history files and will continuously extend the species.

identifying transcriptomic differences of ebs and acabs
a step by step description on how to use trapline is provided in the supplementary material section. in summary, users upload fastq files from a rnaseq experiment, select the reference genome for the species under investigation and run the pipeline to obtain the significantly differentially expressed transcripts. optionally, one can upload the provided mirna target and protein interaction files to use the full potential of trapline. exemplarily, we applied the developed pipeline on rnaseq data from our murine esc derived acabs  <cit>  in comparison to control ebs.

we uploaded in total six datasets , the murine reference annotation , the mm <dig> mirna targets file , the mm <dig> protein interactions file  and ran trapline with the default parameter settings. after a processing time of ~10 h we retrieved the results. we found ~ <dig> significantly differentially expressed transcripts,  <dig> of which were upregulated. the volcano plot shown in fig. 2f illustrates the results of the de analysis. it shows the ratio of the significantly differentially expressed genes  against the non-significant genes . at this point one might want to lower the cutoff of the p-value to obtain less reads marked as significant, which is easily possible by tuning the corresponding cuffdiff <dig> parameter. however, we took the  <dig> upregulated genes as input for the subsequent functional classification analysis with david, which revealed several annotation clusters. the first three annotation clusters contain  <dig> genes in total and suggest a biological impact on the cytoskeleton, actin and the contractile fibers . based on the annotated biological processes described by go terms, we created a network to show the links and significance of each go term using the cytoscape application cluego  <cit> . the network is shown in fig.  <dig> and illustrates the  <dig> upregulated genes that are associated with enriched biological processes. the distribution of significant biological processes is illustrated in additional file 6: figure s <dig>  these genes could be a starting point for subsequent analyses.fig.  <dig> cluego visualization of a gene ontology interaction network obtained after functional classification analysis with david. the network shows interconnections among different biological processes of  <dig> enriched significantly upregulated genes. subnetworks are grouped based on go superclasses . the colors range from red  to brown 



we also predicted mirna interactions of downregulated mrnas. their associated go terms suggest an impact on cardiac cell differentiation. exemplarily, we show the significantly upregulated mirna “mmu-mir369” with  <dig>  predicted targets which include  <dig> genes that are downregulated in acabs . these  <dig> genes were functionally classified by david and reveal a high probability to affect the cell cycle and to support cell differentiation. among these genes is “atp1a2” which is known to negatively regulate heart function  <cit> . furthermore, we analyzed the ~ <dig> significantly differentially expressed mrnas and identified ~ <dig> verified protein interactions,  <dig> splice variants and  <dig> multi promoter regions .

discussion
we developed trapline for rnaseq data analysis to link differentially expressed transcripts to the corresponding phenotypic changes and biological phenomena. there exist other tools such as the bioconductor packages edger and deseq  <cit> , that are with no doubt valuable resources to support the analysis of ngs data. our pipeline, however, includes pre-processing and genome mapping modules and, is furthermore, easily applicable. trapline mainly addresses researchers with limited or no programming skills e.g. in r or python. we are confident that the graphical user interface of trapline, which is implemented in the galaxy platform, greatly supports the accessibility of our rnaseq data analysis pipeline to users with no computational background. furthermore, we have carefully selected a set of best performing interconnected modules that evade compatibility or file formatting issues. the entire rnaseq data analysis workflow can thus be performed in one go without losing the flexibility that experienced users appreciate when being enabled to adjust module parameters to their own needs. different to other automated workflows like mev, chipster, robina or grape our pipeline is additionally predicting spliced variants, enriched promoter sites, mirna targets and protein-protein interactions to enable users getting a comprehensive insight to the analyzed samples . there are several other galaxy pipelines available online, for example the widely used oqtans workbench  <cit> . oqtans is a collection of tools without a pre-defined pipeline. in contrast, our work for the first time introduces an automated galaxy workflow that includes detailed data analysis and data annotation on a public galaxy server. trapline is using all benefits of galaxy and is independent of computational resources . researchers can access and share their data and the results worldwide via the internet, however galaxy also offers private accounts and the possibility to install a local galaxy instance on a private machine, which is beneficial in case of limited internet connectivity. moreover, galaxy enables a synchronous work, e.g. four read mapping tasks at a time are possible. in our case study the time for the analysis was reduced to 10 h in comparison to a desktop pc requiring 24 h . additionally, to accomplish a transparent computing speed analysis, we performed a comparison between a standard trapline run at the public galaxy instance and a local desktop pc based on a randomly selected publicly available sra dataset   <cit> .

the implementation of cuffdiff <dig> for detecting differentially expressed genes enhances the comparability between various rnaseq experiments, because the method is accompanied by rpkm normalization  <cit> . nevertheless, it has to be considered that the rpkm value for a gene from a deep library may have more statistical meaning than an equivalent value from a more shallow library  <cit> .

it is known that spatial biases along the genome exist, resulting in a non-uniform coverage of expressed transcripts  <cit> . especially when using cufflinks, it has been shown that de analysis attempting to correct for differences in gene length have the tendency of introducing a bias in the per gene variances, in particular for lowly expressed genes  <cit> . these spatial biases hinder comparisons between genomic regions and will therefore adversely affect any analysis where such a comparison is integrated. to overcome this problem the current version of cufflinks <dig> has an integrated bias correction algorithm  <cit> . in our investigated datasets there was no need for a bias correction, therefore, we turned this feature off . it can be re-imported manually by setting the respective cufflinks parameter.

with respect to the biological reliability of the results, the number of our above described  <dig> significantly differentially expressed genes could be further reduced based on p-value and fold change adjustments. please be aware that the performance of our pipeline was evaluated based on the illumina sequencing platform that was used to generate the experimental data. additionally, it is possible to apply different multiple testing correction method like bonferroni or benjamini-hochberg  <cit> . using the same parameters, all three applied methods deliver similar results for differentially expressed genes. with the default parameter values, the pipeline also considers genes which are only slightly up or downregulated . the gene annotation clustering approach enables enrichment in information and a pointer to the biological relevance of the apparently large number of differentially expressed genes. gene ontology terms and especially the gene set enrichment analysis performed by david are established methods for gaining first insights into phenotype variations between the tested experimental conditions  <cit> . interestingly, the first three enriched go term clusters in our case study relate to biological processes concerning the cytoskeleton and actin regulation which are two core factors of cardiomyocytes and thus provide a proof of principle for our pipeline .

after successful de analysis, there are several possibilities for further data evaluation and characterization of the transcripts. as we already showed, the go terms and differentially expressed mrnas can be visualized as interaction networks using cytoscape. miranda predictions have the largest relative overlap with other mirna prediction algorithms/tools  <cit> , which is why we chose to include miranda predictions into trapline in the first place. a snp analysis with respective tools can also be done by simply using the snp output of trapline. additionally, a co-expression network analysis could be performed to identify co-expressed mrnas that are simultaneously dis-regulated  <cit> .

CONCLUSIONS
taken together, our proposed pipeline includes all relevant rna sequencing data processing modules, is easily applicable, and needs no time consuming installation processes. trapline guides researchers through the ngs data analysis process in a transparent and automated state-of-the-art pipeline. experimentalists will be able to analyze their data on their own without learning programming skills or advanced computational knowledge. the data can be accessed worldwide and can optionally be shared among researchers. gaining quickly in-depth insights into the biology underlying the investigated data, our work for the first time introduces an automated galaxy workflow including detailed data processing, data evaluation and annotation modules .

availability and requirements
project name: trapline

project home page:https://usegalaxy.org/u/mwolfien/p/trapline---manual

operating system: platform independent

license: galaxy web portal service agreement 

materials and methods
cell culture and acab-generation
murine es cell lines described previously  <cit>  were grown in high glucose dmem with stable glutamine  containing 10 % fbs superior , 100 μm non-essential amino acids , 1 % penicillin/streptamycin  and 100 μm β-mercaptoethanol  in presence of  <dig> u/ml of leukemia inhibitory factor . differentiation of acabs was performed in hanging drop culture for two days using  <dig> cells as starting material for one eb in iscove’s basal medium  containing 10 % fbs , 100 μm non-essential amino acids , 1 % penicillin/streptamycin  and 450 μm 1-thioglycerol. for additional 4 days, the cells were differentiated in suspension culture, and at day  <dig> of differentiation consistently  <dig> ebs were seeded on one well of a 24-well-plate. antibiotic selection with 400 μg/ml g <dig>  was initiated at day  <dig> post seeding. 4 days thereafter, acabs were isolated via treatment with  <dig> u/ml collagenase iv  for 30 min. to obtain single cells for subsequent experiments, the bodies were further dissociated with 100 % accutase  for 15 min. to ensure successful generation of acabs, potential mycoplasma contamination was routinely controlled twice a week using the pcr based mycospy kit system .

rna-sequencing
for library generation and sequencing, cultured adherent cells were drained from the culture medium, washed and directly lysed by addition of lysis buffer.  <dig> ul of this lysate was used for cdna synthesis and amplification with the smarter kit  according to the manufacturer’s instructions. in brief, cdna synthesis was initiated by annealing a polya-specific primer and adding a reverse transcriptase with terminal transferase activity. the newly synthesized first strand cdna is then tailed first with a homopolymer stretch by terminal transferase and then with a specific amplification tag by template switching. the resulting double-tagged cdna was amplified by pcr, fragmented by sonication  and converted to barcoded illumina sequencing libraries using the nebnext ultra dna library preparation kit . after pcr enrichment the libraries were purified with ampurexp magnetic beads  and quantified on a bioanalyzer  <dig> . libraries were pooled at equimolar amounts and sequenced on an illumina genomeanalyzer iix in single-read mode with a read-length of  <dig> nucleotides and a depth of  <dig> million to  <dig> million raw reads per replicate.

additional files
additional file 1: 
trapline manual: step by step instructions for the usage. 

additional file 2: figure s <dig>  flowchart for acab generation. cartoon is displaying sequential steps for the generation of acabs, combining myh6-promoter selection and an additional cell-dissociation step  <cit> . 

additional file 3: figure s <dig>  visualization for rna transcript quality control and comparison of per base quality score q. the images are taken before  and after  quality trimming procedure  to estimate the effect of trimming. the quality score q is plotted to the read position by using the fastqc package in galaxy . the color indicates the quality of the read: "red" low quality, "orange" median quality, "green" good quality. red line expresses the mean of the measured values  and the blue line represents the mean quality. 

additional file 4: table s <dig>  performance comparison of trapline vs other tools. 

additional file 5: table s <dig>  example for david functional gene annotation clustering of significantly differentially expressed genes from acabs and ebs. 

additional file 6: table s <dig>  exemplarily we show a result of a mirna target prediction analysis of trapline. 

additional file 7: figure s <dig>  pie chart illustrating enriched biological processes of upregulated genes in the acab derived cardiomyocytes. the chart presents the enriched go superclasses. 

additional file 8: table s <dig>  exemplarily results of protein-protein interaction prediction, splice variants and multi promoter regions. 

additional file 9: table s <dig>  benchmarking results of trapline performed on a public galaxy server and on a local desktop pc . 

additional file 10: figure s <dig>  a comparison of experiments without  and with  bias correction performed with the help of cufflinks <dig>  the dots represent the dependency of the log ratio of two fpkm values  and their mean average . the ma plot is a common method to investigate the biases of datasets  <cit> . 



markus wolfien, christian rimmbach and ulf schmitz are first author

robert david and olaf wolkenhauer are senior author

competing interests

the authors declare that they have no competing interests.

authors’ contributions

mw, cr, us, jjj, gs and rd developed the idea. mw developed the workflow and did the galaxy implementation. cr and jjj designed and conducted the experiments. sk performed the rna sequencing. mw analyzed the experimental data. cr, us, rd helped with the analysis and biological interpretation of the data. ow provided the general framework for bioinformatics study. mw, us, rd, ow contributed in drafting the manuscript, revising it critically and approved the final version. mw, cr and us share first authorships. rd and ow are joint senior authors on this work. all authors read and approved the final manuscript.

