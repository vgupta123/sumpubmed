BACKGROUND
one of the major challenges in the post-genomic era is the understanding of the genetic basis of gene expression regulation. this involves the deciphering of molecular mechanisms that governs the establishment and maintenance of cellular phenotypes, which has led to a new area of research named "functional genomics"  <cit>  referring to a comprehensive analysis at the protein  and rna levels  of any cellular phenotype associated with the expression of whole sets of genes. this is characterized by high throughput or large-scale experimental methodologies combined with statistical and computational approaches.

the correlation between mrna and protein expression is typically not strong, as previously reported  <cit> . on the other hand, transcription is one of the most important steps in gene regulation, and information about transcript levels is important to estimate gene activity and to characterize a molecular signature for a cellular phenotype. in this context, new methods have been developed for transcriptome analysis and gene expression profiling  <cit> .

serial analysis of gene expression   <cit>  is one of the widest used techniques for this purpose. sage method allows a quantitative and parallelized analysis of a large number of gene transcripts in any particular cdna library derived from cells or tissues  <cit> , without prior knowledge of the genes. the sage technique is based on the isolation of short sequence tags that are extracted from defined positions of the transcript . these tags, in theory, are strongly associated with individual genes  <cit> . the tags are concatenated into long dna molecules, which subsequently are identified by conventional dna sequencing. sequence tags are extracted from raw sequence concatamers using a parsing program that tabulates the occurrence of each tag and creates an abundance level report file.

although being advantageous in many aspects  <cit> , sage protocol can be also subject to sequence errors, mainly introduced by the polymerase chain reaction  and sequencing steps. the occurrence of these errors produces sequence-based artifacts, introducing noise into the sampled transcriptome profile. massively parallel signature sequencing   <cit>  is another sequencing-based method that, similarly to sage, provides quantitative gene expression data. this technique can generate millions of short signature sequences, providing a better coverage of the transcriptome in a single cell population. it has a routine sensitivity on a low-molecular level of mrna per cell.

another recent technology with high sensitivity is deepsage  <cit> , which is similar to the initial steps of longsage  <cit>  in conjunction with an ultra-high throughput dna sequencing  <cit> .

in recent years, significant efforts have been directed towards the development of new and reliable dna sequencing technologies  <cit> . all three commercially available technologies today are characterized by the production of millions of reads in a single experiment  <cit> , reducing the cost of sequencing.

these technologies are available for quantitative measurement of gene expression and, as in sage, individual mrnas can be identified through short tag sequences, immediately adjacent to the 3'-most anchoring enzyme restriction site. the throughput reached by these new sequencing technologies allows also a shotgun strategy for the transcriptome.

although these represent technological advances, there are still many factors that potentially contribute to the production of artifact sequence tags, such as errors introduced through reverse transcription, pcr, and others, inherent to the cloning  and sequencing steps, leading to spurious molecular signatures. in order to mitigate these negative traits, several studies were made to define and explore the inherent implications, mainly to the sage protocol. in addition, these studies disclosed the impacts of the spurious sequences and proposed efficient algorithms for detection and removal of these tags  <cit> . in this work, we propose a new methodology to index the sequence tags according to their reliability, using a score system. we also present the implementation of this methodology in a web-based tool, initially available for human  and mouse  data. the main applications of this tool are the evaluation of the sequenced library, and the identification and selection of the reliable tags, which can be considered more effective for gene expression profiling, according to the scoring system. to rank the tags, we established some empirical rules merging relevant parameters, one based on absolute tag frequency and the other, on matches in a set of virtual tag databases. there is still another component associated with the previous, based on a concept of neighborhood  <cit> , i.e. abundant tags can contaminate those whose sequence is very close. the virtual tags are predictions of a real tag that might be produced by a sage , mpss  or sbs  experiments using different anchoring enzymes . they are extracted from gene transcript sequences from various sources with some relevant attributes  <cit> , considered in each score rule elaboration. the other rule component, based on the absolute frequency, assumes that the abundance and representation in the set of libraries presupposes more reliability. the automated library analysis process involves a series of searches on s3t database to retrieve relevant source information from corresponding virtual tag for the application of a specific classification rule set . another approach to rank tags according to their nature, using a relational database and a set of different transcript sequence sources, was previously described  <cit> . however it does not consider the possibilities of tags derived from sage adapters or cloning vectors, or tags matching mitochondrial or nuclear genomes, or tags that can be technology-related artifacts, such as generated by sequencing errors. the approach of s3t comprises these analyses, using additional virtual tag datasets and still considers the tag frequencies to rank the tags.

rule set used in s3t classification process of public sage data. the f represents the absolute frequency for tag x and m the average frequency for tag x, considering all libraries in our gene expression database, the set n represents the tag x neighbor tags , the t set represents the highest frequency tags of the library . 

there is an online service platform, publicly available at s3t website, for accessing and performing the referred analysis. the source code is also available for a local installation.

the s3t approach was applied to a public sage dataset and, in addition to the statistical comparisons; two hierarchical cluster analyses were performed using current methodologies  <cit> . the resulting clusters were compared and used to evaluate s3t effectiveness in the prevention against some biases related to sequence-based artifacts or possible contaminations .

RESULTS
the system formerly described, concerning the classification process, is available at s3t website. the services provided have been mainly used to select relevant information from long lists of tags, which are hardly meaningful. the entire library data can be submitted for immediate scanning. the whole procedure takes about  <dig> minutes for a library with  <dig>  unique tags. from these results, it is possible to compare the proportions of each score for the unique tags and their frequencies. the interface provides the means to investigate the makeup of individual tag lists for each score. these individual lists contain the tags, as well as their associated genes and descriptions.

according to the initial analysis using  <dig> public sage libraries, it is possible to observe the large diversity among proportions of tags throughout the established scores . the high percentage of unique tags with - <dig> score  is evident; they may have arisen from errors in abundant tags whose sequence is very close. this indicates that errors in the tag sequence are the most prevalent. the correlation between the total of sequenced tags in a library and the number of unique tags with - <dig> score is strong , i.e. the number of unique tags with - <dig> score increases according to the number of sequenced tags. the correlations between the total of tags in a library and the unique tags in the other scores were obtained and are available at the supplemental section of the s3t website.

these results can illustrate the overall quality of tag libraries. those samples observed with a high percentage of tags classified with negative scores, cannot be considered reliable for further analysis. box plots were used to visually summarize and compare the groups of data  <cit>  . this diagram contains the distributions of unique tags along the proposed scores. it is crucial to focus particularly on those with positive scores that represent the effective contribution for the biological information, the others, with negative scores, possibly represent contamination or technique errors inherent to the experimental process. however, the tags with negative scores that had matches in the genome sequences, or did not match on anything, could also come from unknown transcripts  <cit> . but it is also important to emphasize that these unknown transcripts will probably be characterized through the constant updates of the current transcript sequence databases, especially with the use of new high-throughput sequencing technologies, which has high sensitivity to detect rare transcripts. the hierarchical clustering analyses using the selected histological groups  of sage libraries were also performed. the clusters of samples with known histological information, in a general way, were more concordant with their predefined histological sample classes , after filtering, in some cases . in the others, the filtering did not affect the overall quality of cluster set  and, in a few cases , the clusters after filtering were less concordant with their previously defined classes . the brain group is one of them, once there are many heterogeneous samples into subgroups, leading to difficulties to distinguish them among other samples. the f-measure  <cit>  was used to evaluate the cluster quality. this measure cluster evaluation method combines the precision and recall ideas. the f-measure values are in the interval  and larger f-measure values indicate higher clustering quality. the clusters formed before and after s3t filtering were then compared using the overall f-measure , the expectation was to find clusters more congruous after filtering, properly grouping samples from the same cellular phenotypes together and closer than others .

groups of public sage libraries used in the hierarchical clustering analyses performed before and after  s3t filtering. four clustering methods were applied: pairwise complete-linkage , pairwise single-linkage , pairwise centroid-linkage , pairwise average-linkage . the histological groups are: brain , cartilage , cerebellum , colon , liver , lung , mammary gland , other , ovary , pancreas , prostate , retina , stomach , white blood cells . for each group we have the overall f-measure values for clusters generated with cluster <dig> and simcluster, respectively, in the first and second lines. the table cell pairs with values in bold represent cases where there was an improvement in the overall quality of clustering, according to f-measure, i.e. the f-measure was greater  or the quality between clusters did not change  after s3t filtering. the remaining table cell pairs, with values not in bold, represent cases where the f-measure was lower after s3t filtering , i.e. where the resulting cluster was less concordant with their previously defined classes.

in this analysis, applying the proposed set of rules , the results  point that the tags with score - <dig> is the most abundant among those who received negative scores. this was observed for almost all libraries, considering the count of unique tags and the sum of their frequencies . this obviously affects the difference between the raw data and the s3t-filtered data, and indicates which libraries do not have enough tags with good quality; the criterion for this consideration depends on the analysis stringency parameters.

the complete set of results can be found on the supplementary information page at the s3t website, together with other online resources for querying and download.

CONCLUSIONS
sage and sage-like techniques are useful and efficient methods for quantitative evaluation of gene expression level within a cell population. in addition, the computational approach proposed here enables a noticeable enhancement, in accuracy and efficiency, for these techniques. in this sense, the implementation of this approach provides means for automated analysis and selection of the most reliable tag datasets. in a general way, it was designed to provide researchers with more comprehensive and detailed assessment of a given gene expression profile.

despite the satisfactory results obtained, one hindrance remains towards tag classification for the process to be deeply related and ingrained to the tag-mapping step. it also depends on the virtual tag database definition and this procedure may lead, in some cases, to tag-to-gene assignments that can be ambiguous, incorrect, or unavailable  <cit> . this method must be reviewed to improve its accuracy in the presented context. moreover, the tool allows adjustments to remake the rule sets in order to improve the classification. additional tests can be made to develop more accurate rules for a precise evaluation of sage, mpss or sbs libraries.

implementation
the methodology for quality evaluation of the tag libraries, in a general way, comprises the following fundamental tasks:

 <dig>  collecting experimental data, virtual tag datasets and related information, and store them into the relational database;

 <dig>  setting the score classification rule parameters ;

 <dig>  carrying out the searches on database and applying the rules, that is a match of the experimental data with one of the tag scoring rules.

 <dig>  quantitating the unique tags and tag frequencies for each score to perform a library quality evaluation.

the classification process is executed in a pipeline mode, applying the rules in a pre-defined order to each and every tag in the library . the first attributed score is sustained when the rule is validated; otherwise, the next rule is triggered. a complete set of tools were developed to implement this methodology, which includes the automated process and the website interface. they were developed using object oriented perl programming language and related modules, e.g. for database connection , plot charts  and interface design . the s3t system allows multithreading for the classification process, and enables parallel execution on a multiprocessor system. a complete analysis to evaluate the proposed methodology was performed using an experimental sage dataset.

virtual tag datasets
the sets of virtual tags were obtained from different sources to characterize the experimental data and determine its reliability, based on the relevant characteristics of each sources, as following:

•cloning vector  – sequence of cloning vector plasmid  dna;

• mitochondrion genome – sequence of mitochondrial dna, complete genome ;

•linker  – adapter linker sequences used in sage library construction and 1-bp variations sequences ;

• fl cdnas – full-length cdna sequences from mgc  <cit> , refseq  <cit>  and "20k set"  <cit>  transcript database;

• consensus – sequences of trest  <cit> , a consensus sequence database;

• nuclear genome – sequence of nuclear dna ;

the procedures for tag extraction in these datasets were similar to the sage genie methodology  <cit> . in addition, we also considered alternative splicing events supported by evidences found through pairwise comparisons of expressed sequence tag  data. the cases where only one individual est confirmed the event of alternative polyadenylation or splicing were isolated from those with more than one est confirming the event. the fl cdnas and consensus datasets were divided into two subsets based on the presence of poly tail and signal: subsets with both signal and tail and the remaining ones with neither signal nor tail . only sequences with some evidences of their correct orientation were considered. these evidences include a poly tail of at least  <dig> adenosines or one of the aauaaa sequence variations  for poly signal, and the results of estscan  <cit>  analysis. possible internally primed polyadenylated cdna sequences were identified as a way to characterize internal tags resulted from cdna synthesis priming from a poly stretch other than the poly tail. alternative polyadenylation events were figured from the alignment of shorter transcript sequences with a poly signal and a poly tail of  <dig> adenosines that aligned within the longer entry. we also extracted virtual tags from the vector sequence, mitochondrial genomes, nuclear genomes and linkers representing possible contamination with plasmidial dna, mitochondrial dna, nuclear dna and sage adapters, respectively.

the main program receives as input parameters, the library file , the platform technology , the anchoring enzyme , the tags length and the species acronym . these input parameters define the rule set to be used in the s3t analysis. the online analysis has distinct preconfigured sets of rules. the rule set used in the paper analyses of the public sage libraries , were defined by the following input parameters: sage, nlaiii,  <dig> and hs. the intention of this rule set is to exclude any tag matching sage adapters , low frequency tags  = 1) matching internally primed dataset , and low frequency tags  < 5) similar to the high abundant tags ; the purpose is to detect possible technique artifacts; the next eleven score tests  are used to identify tags matching known transcript sequences from different sources and reliability; the next score  is the last chance to accept tags, if the average tag frequency in the gene expression database is greater than its frequency in the library, which is being evaluated  > f); the next score test is to retain the remained tags with frequency equal to  <dig>  possibly erroneous tags; the subsequent scores  are to test match with mitochondrial, nuclear genome and cloning vector, respectively; the last score  is not a test, it retains the remained tags.

experimental sage data
the experimental sage data used in the evaluation were collected chiefly from sage genie  <cit> , the effort of cgap sage project to create a comprehensive database of human gene expression  <cit>  and contains several sage libraries from normal and tumor tissues or cell-lines. these libraries were constructed by using nlaiii as the anchoring enzyme and bsmfi as the tagging enzyme as originally described  <cit> . a set of public sage libraries,  <dig> from cgap and  <dig> exclusively from ncbi gene expression omnibus , distributed among  <dig> histological groups, were loaded into our local database and submitted as described in this work.

data repositories
there are two in-house mysql relational databases that are deeply related with the automated process for an entire library evaluation. the main database contains the virtual tags and their source-related information. the virtual tag datasets, described before, with their respective attributes were loaded in there. the tag evaluation process requires a fast and accurate retrieval of the database content to check if the tag attributes satisfy any rule-based classification criteria. the other database, essential for the classification process, contains the experimental data for sage, mpss and sbs, which is used to retrieve the tag frequencies in other libraries. this database was designed to provide a comprehensive and integrative repository for gene expression data and related information. the information in there can be accessed programmatically through a soap interface or through a human-readable web interface . the main database, with virtual tag datasets and the gene expression database, with the experimental data, are regularly updated .

statistical description
all data were divided into two groups, each one respectively corresponding to the tags classified with positive scores and negative scores. the results were described in reports using statistical methods from r statistical package. these reports contain the average of tag frequency, the redundancy , and the proportions of tags and frequencies in each group. the samples were ordered according to their proportions of tags with negative scores. the differences between unique tags and frequencies of raw and filtered data  were achieved from each group of frequencies . pearson correlation was used to assess the relationship between these differences.

hierarchical clustering analysis
a hierarchical cluster analysis  <cit>  was performed using an open source clustering software  <cit>  on same tissue type samples in distinct biological conditions, typically normal versus tumor, and/or sample preparation . the analysis used raw datasets for all samples and these same datasets after filtering.

these samples were classified according to their phenotypes  and/or sample preparation into their histological group, using sage genie information. single-sample groups were excluded from this analysis.

clusters were generated using euclidean distance with four clustering methods: pairwise complete-linkage, pairwise single-linkage, pairwise centroid-linkage and pairwise average-linkage. simcluster  <cit>  were also used to generate clusters using these same clustering methods except the pairwise centroid-linkage, which was not implemented.

front-end
an interface for library evaluation using this automatized approach was built using perl cgi scripts. this interface is contained into the s3t website, it provides useful information to carry out an analysis and presents the results in a user-friendly manner, where it is possible to explore the submitted data. the methodology proposed by sage genie  <cit>  provides the tag-to-gene assignment used in the results page.

the s3t website is available online under apache web server running on a linux box .

availability and requirements
project name: s3t – score system for sequence tags

project home page: 

operating system: unix-like platforms

programming language: perl

other requirements: perl v <dig> . <dig> or higher, cpan modules, mysql  <dig> . <dig> or higher

license: gnu gpl

any restrictions to use by non-academics: licence needed

abbreviations
s3t: score system for sequence tags; sage: serial analysis of gene expression; mpss: massively parallel signature sequencing; sbs: sequencing-by-synthesis; est: expressed sequence tag; cgap: cancer genome anatomy project; ncbi: national center for biotechnology information; nih: national institute of health; cpan: comprehensive perl archive network.

authors' contributions
sjs and wasj conceived the study and the general design of this study. dgp and pafg did the technical design, the structure development and assembly the virtual tag datasets. dgp conducted the study, carried out the software and website implementation and drafted the manuscript. sjs and pafg helped to draft the manuscript. wasj and maz supervised and coordinated the study. all authors read and approved the final manuscript.

