BACKGROUND
with the increasing number of available bacterial genome sequences, when these genomes are compared, the genetic variation within bacterial species is greater than previously predicted  <cit> . rapid and reliable sub-typing of bacterial pathogens is important for identification of outbreaks and monitoring of trends in order to establish population structure and to study the evolution among bacterial genomes especially within and between the outbreak strains. today, the most widely used typing methods for bacterial genomes include multilocus sequence typing , pulsed field gel electrophoresis , sequencing of 16s rrna genes, and multilocus variable-number of tandem-repeat analysis .

pfge and mlva have major benefits, but are time consuming and the results are difficult to standardize  <cit> . other typing methods which rely on one or a few ubiquitous genes, such as the 16s rrna gene or a set of housekeeping genes in mlst, are capable of classification at the species level and sometimes also at the subspecies level, but the biological information in a narrow selection of genes will rarely be sufficient to clearly distinguish between closely related strains such as several isolates of the same serotype  <cit> . thus, more of the genome content should be considered rather than just one or a few genes  <cit> .

the price and time for whole genome sequencing will soon be in the same range as the traditional typing methods mentioned above. genome sequencing can be a powerful method in epidemiological and evolutionary investigations  <cit> . although, to date, this has only been used in more limited epidemiological investigations where isolates suspected to be part of the same outbreak have been compared to a reference genome. in the future, it is likely that wgs will become a routine tool for identification and characterization of bacterial isolates, as hinted at in the first 'real-time' sequencing of the e. coli o <dig> outbreak in germany in the summer of  <dig>  <cit>  and the vibrio cholerae outbreak in haiti in october  <dig>  <cit> . this requires standard procedures for identifying variation and for analyzing similarities and differences.

conserved genes are present across bacterial genomes of the same species . a fraction of these genes--those conserved in all  of the genomes of a given bacterial taxonomic group--is called the 'core-genome' of that group. the core-genome can be identified either within a genus or species  <cit>  and can be used to identify the variable genes in a given genome  <cit> . in addition, the conserved genes in general appear to evolve more slowly, and can be used for determining relationships among bacterial isolates  <cit> .

currently there are more than a hundred bacterial species for which sufficient genomic data are available to estimate the species core-genome   <cit> . among these, salmonella enterica is a good candidate species for conserved gene identification because the genomes are quite similar  <cit> . moreover, s. enterica is one of the most important food-borne pathogens and is responsible for global outbreaks  <cit>  which makes international standard typing procedures of major importance in order to allow for global comparisons  <cit> . the salmonella genus has only two species with sequenced genomes: salmonella bongori and salmonella enterica. in turn, s. enterica is divided into  <dig> sub-species: enterica, salamae, arizonae, diarizone, houtenae and indica. presently, s. enterica is classified into more than  <dig>  serotypes  <cit> .

in order to investigate an outbreak caused by salmonella, characterization of salmonella isolates from genome data is a crucial step. salmonella genomes are highly similar, particularly within subspecies enterica, where little variance exists in the genomes  <cit> . this high similarity presents a challenge for typing and classification.

in their pioneering work tettelin et al.  <cit>  defined the core genes of a species by being those genes found present in  all known members of the species. since then others have studied core and pan genomes at the genus level or even at the kingdom level  <cit> , but for our purposes the original definition at the species level is suitable. in this work we identify the core genes within s. enterica genomes and determine variation between the different available genomes, both in terms of sequence and presence/absence of non-core genes; in the latter case using a method originally published by snipen & ussery  <cit> . we evaluate the value of different approaches for classification of isolates in epidemiological settings and compare our findings to currently used sequencing methods, both in long term trend analysis and outbreak investigations.

RESULTS
the  <dig> salmonella genomes used in this study are summarized in additional file 1: table s <dig>  the set comprises  <dig> completed genomes and  <dig> nearly completed genomes. of these,  <dig> genomes are closely-related s. montevideo strains pertaining to an outbreak of salmonellosis from italian-style spiced meat  <cit> . all genomes were retrived from genbank  <cit>  except s. typhimurium str. dt <dig>  which was received from the sanger institute's bacterial genome database. all salmonella genomes are from subspecies enterica with the exception of the single s. enterica subsp. arizonae.

evaluation of traditional bacterial sequence-based typing
the ribosomal genes are essential for the survival of all cells, and their structure cannot change much because of their involvement in protein synthesis  <cit> . thus, 16s rrna genes are highly conserved among isolates belonging to the same bacterial species  <cit> . exceptions may be n. meningitidis  <cit>  and mycoplasma  <cit> . however, due to limited variation within a given species, the 16s sequencing is often not useful for epidemiological studies, where the classification of highly similar strains is needed. jacobsen et al. shows a phylogenetic tree based on 16s rrna genes, extracted from  <dig> salmonella enterica genomes, using rnammer  <cit> . as expected, there is not sufficient resolution to distinguish among the salmonella subspecies enterica.

genes such as rpob or soda have been suggested as substitutes for 16s rrna and have shown improved efficacy in species identification  <cit> , although it remains unlikely that a single gene can always reflect the subtle differences between genomes of the same species.

the limitations of using a single gene may be improved by the simultaneous analysis of multiple genes. multi locus sequence typing  has found wide applications, especially in phylogenetic studies and is most commonly based on seven housekeeping genes - each bacterial species having its own set. for salmonella these are: aroc, dnan, hemd, hisd, pure, suca and thra http://www.mlst.net. a mlst tree, based on an in silico analysis of the  <dig> available salmonella enterica genomes in genbank, is shown in figure  <dig>  strains of the same serovar generally cluster into distinct groups, although exceptions exist; for example the s. weltevreden str. hi_n05- <dig> is mixed with s. montivideo. futhermore, recent work on  <dig> sequenced e. coli genomes  <cit> , found that the 16s rrna tree cannot resolve well within the genus level and also that mlst cannot differentiate pathogenic strains from non- pathogenic strains. still, mlst has proven useful for long-term analysis of population structures, but often fails to detect differences between closely related strains  <cit> . indeed, improved mlst schemes that include more than  <dig> genes have been suggested  <cit> .

for salmonella, sequencing specific short repeats and virulence genes have recently been suggested as an alternative and improved method for typing of s. enteritidis <cit> . the usefulness of this approach in epidemiological studies and typing is currently unknown, although the choice of repeats must be tailored for the specific bacterial species studies.

identification of core genes
determining gene conservation across multiple genomes is not overly difficult, but certain choices must be made which will affect the final outcome. using a previously published method  <cit>  which employs single-linkage clustering on top of blastp alignments, sets of pan- and core-genomes were estimated, based on all  <dig> salmonella genomes. the progression of the pan- and core-genomes is shown in figure 2a. the number of novel gene clusters in the pan-genome gradually increases when more genomes are considered, while the number of conserved gene clusters constituting the core genome decreases slightly. when all salmonella genomes have been considered, there are  <dig>  pan gene clusters and  <dig>  core gene clusters  in species enterica. in the step going from s. typhimurium to s. typhi, the number of core genes drops suddenly, most likely because the s. typhi genome has undergone considerable pseudogene formation resulting in gene loss  <cit> . the number of core genes drops again when adding a genome of the subspecies arizonae which is associated with cold-blooded animals. this technique has previously been applied successfully in finding core genomes for proteobacteria genera burkholderia  <cit> , escherichia coli  <cit> , vibrionaceae  <cit>  and campylobacter jenuni  <cit> , as well as bacteroides  <cit>  and lactic acid bacteria  <cit> .

genomic variation within the core genes
the core genes as calculated above were used for constructing a gene variation plot by performing all-against-all blast alignments between  <dig>  core gene clusters and all  <dig> salmonella enterica genomes. the resulting average identities within each core gene cluster is displayed in figure 2b. from this figure, the average percent identity was very high  in most of the core genes, but dropped sharply for around 5% of the core genes. from this plot, the identified core genes can be divided into two categories: a small group of highly variable genes and the majority of genes which show little variation.

for the highly variable core genes, the variation in amino acid sequences  was higher than for the nucleotide sequences , whereas the opposite was the case for the more conserved core genes. this indicates that for core genes with low variation there is a selection against mutations leading to amino acid changes, whereas for the highly variable genes, positive selection for amino acid changes seems to be the case. in order to confirm these hypothesis, the approximation of dn/ds has been performed by dividing the number of non-synonymous changes per non-synonymous sites with the number of synnonymous changes per synonymous sites  <cit>  using s. typhimurium str. lt <dig> as a reference genome. the median dn/ds ratio for conserved and highly variable core genes are  <dig>  and  <dig>  respectively. therefore, the amino acid changes in highly variable core genes might be due to an increase in positive selection at some sites. nonetheless, the importance of this needs to be confirmed by additional analysis, although one could imagine, for example, a selective pressure to vary the surface proteins to avoid immune response.

the seven genes used for mlst are marked in the figure 2b, and are scattered throughout the highly conserved part of the core genes  and, as expected, little variation exists in these genes. including core genes from both the highly conserved and variable regions might be beneficial in evolution studies. on the one hand, the more slowly evolving genes are useful in distinguishing between divergent and convergent evolution, while faster evolving genes can help in strain identification.

functional analysis of conserved genes
in order to determine the functional profile of core genes, the core gene clusters were aligned against uniprot  <cit> . functional profiles were determined based on gene ontology  terms and visualized in figure  <dig>  though the difference is generally small, some terms common in conserved core genes tend to be less frequent in highly variable core genes; for example, electron carrier activity, structural molecule activity and metallochaperone activity. these functions are essential for living cells and are therefore enriched in conserved core genes. on the other hand, highly variable core genes encode many proteins that are associated with the extracellular region. in general, genes located outside the cell are known to be more variable  <cit> .

consensus tree based on core gene clusters
a previous study described that there are  <dig> genes unique to salmonella  <cit> . instead of using all core genes, we generated a consensus tree based on these  <dig> salmonella-specific genes . we also constructed an additional four consensus trees based on sets of  <dig> core genes randomly picked from different areas in the variation plot : from a mixture of high, medium and low variable core genes , from medium variable core genes , from highly variable core genes  and from the area where the curve decreases in the variation plot . the appearance of these  <dig> consensus trees was similar to the tree from figure  <dig>  with two exceptions: the trees based on the  <dig> specific genes  and the highly variable core genes . in the former, s. arizonae, which is not part of the subspecies enterica, was still mixed in with other enterica, while for the latter, s. agona str. sl <dig> clustered away from the other subspecies enterica. thus, based on these results, it appears that using only salmonella unique genes or highly variable genes does not provide phylogenetically useful information and should probably not be used for future wgs studies. comparisons using more genomes in more species can further test this.

pan-genome tree
in principle, genome similarity is not only measurable by shared genes, but also by the absence of genes. figure  <dig> is another tree, based on gene presence/absence across all the salmonella genomes  <cit> . this tree bears a striking resemblance to the consensus tree based on core genes , although the bootstrap values are higher in many of the branches, especially near the root. of all methods investigated in this study, the pan-genome tree presents itself as the best solution for a tree that can resolve strain differences in a biologically meaningful way, even if it would be expected to correlate more with phenotype than phylogeny. it is, however, important to note that creating pan-genome trees requires higher quality sequencing data and assemblies than what are typically obtained using short reads from second-generation sequencing methodologies. even so, we have found that pan-genome trees with good correspondence to known bacterial types can be constructed from solexa data , if care is taken to ensure good assembly and gene finding .

the power to discriminate between variants differs between the methods used. the phylogenetic analysis for the mlst tree is based on the identified informative sites among the seven housekeeping genes, for the pan-genome tree on presence and absence of genes and for the consensus tree based on the informative sites of core gene clusters from alignments of all core genes trees. the number of infomative sites for in silico mlst tree, pan-genome tree and consensus tree based on core gene clusters were  <dig> bp ,  <dig>  genes  and  <dig>  bp , respectively. the pan genome and core gene analysis were based on much more variation than the mlst analysis and have a much stronger power to discriminate closely related strains.

CONCLUSIONS
bacterial typing should provide meaningful information for both epidemiological and evolutionary studies. for epidemiology, the ability to differentiate unrelated isolates  and the ability to cluster related isolates are crucial. 16s rrna and the mlst genes rarely provide separation between closely related strains. the performance of the pan-genome tree, however, is valid for epidemiological investigation in both discriminatory and clustering abilities. one caveat is that this method depends on good quality genomic data.

comparative genomics can determine the conserved genes  among bacterial genomes at either genus or species level. genomic variation within the core-genome can then be used to reveal highly variable genes  and conserved genes . these core genes are useful for investigating molecular evolution and remain useful as candidate genes for bacterial genome typing--even if they cannot be expected to differentiate highly similar isolates from e.g. outbreak cases, such is not always desirable. even in cases where a deeper distinction of isolates is of interest, e.g. in mapping outbreaks, core genes might still be useful as a reference fragment for snps calling instead of using whole genome analysis. however, in term of computational costs, the consensus tree based on core genes requires more computational time than the other methods.

in the near future, global real-time surveillance of salmonella and other pathogens giving simultaneous information on population structure and evolution, as well as outbreak detection, may well be possible.

