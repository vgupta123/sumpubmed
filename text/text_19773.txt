BACKGROUND
a significant fraction of genes of many organisms appears to have arisen not vertically, by lineal descent from ancient ancestors of the organisms, but rather horizontally, by acquisition from outside the line
 <cit> . recognition of those genes acquired by horizontal transfer is necessary to reconstruct the evolutionary events that shape genomes and is useful in understanding the mechanisms by which that shaping occurs
 <cit> .

horizontal transfer may be viewed conceptually as a discordance between the phylogeny of a gene and a reference phylogeny of the cell that contains it, and so the analysis of phylogenetic trees would seem to be a natural tool to detect transfer events
 <cit> . the construction of informative trees, however, may be computationally intensive and require sequence information from related species that is often not available. furthermore, the analysis of trees is by no means straightforward
 <cit> .

several surrogate methods have been put forth to identify alien genes in a genome, using the sequence characteristics of the genes rather than phylogenetic information. specific genes of putative alien origin have been identified through unusual g + c content
 <cit> , codon usage
 <cit> , or g + c content at position  <dig> and/or  <dig> within codons
 <cit> . compositional contrasts, measured through frequencies of longer oligonucleotides or high order markov models, have been used to predict horizontal transfer
 <cit> , with oligonucleotides as long as eight or nine found to be more effective than shorter oligonucleotides
 <cit> .

all of these methods share a family resemblance: a norm is established for a sequence characteristic, and genes or genomic regions are sought that deviate from the norm. for example, tsirigos and rigoutsos 
 <cit>  determined the frequencies of all octanucleotides in a given genome and then compared these frequencies to those determined for a specific gene, using statistical tests to assess whether the deviation from the first set of frequencies was significant. a few critical components of such tests are evident: the choice of the characteristic, the choice of the norm, and the choice of how to determine significance.

it is important to note that many of these methods have produced strikingly different predictions as to the extent of horizontal transfer
 <cit>  and the specific genes predicted to be alien
 <cit> , possibly because they are sensitive to different ages of transfer events
 <cit>  or because they are not all reliable predictors of evolutionary events. most applications of these methods use the entire genome or the set of all genes within it as a training set, but this practice taints the training set with the foreign dna and genes that are sought
 <cit> .

we have developed a method to detect horizontally transferred genes that seeks to maximize the signal to noise ratio in oligonucleotide contrasts by limiting the training set to conserved core genes
 <cit> , thereby  removing foreign genes. at the same time, we considered that the paucity of genus-associated restriction sites in many genomes
 <cit>  and the rapidity with which genes encoding restriction enzymes are gained and lost in organisms
 <cit>  might point to underrepresented oligonucleotides as a source of a genome signature that changes rapidly over evolutionary time. we therefore initially focused on this subset, hoping to enhance the organism-specific signal.

RESULTS
method of evaluation
a method intended to detect horizontal gene transfer may fail on either of two counts: a failure to detect a genuinely foreign gene  or an erroneous claim that a genuinely native gene is foreign . to test for both possibilities, we assessed methods using two sets of genes, those artificially introduced into the genome from a single foreign source  and those within the genome that were deemed provisionally to be genuinely native . the latter were identified as those genes having orthologs in all considered cyanobacteria .

we chose to focus primarily on cyanobacterial genomes, because cyanobacteria constitute a broad taxon with a large number of fully sequenced genomes, and because a tool exists, cyanobike
 <cit> , that greatly facilitates analysis of their genomes. with genomes from organisms of varying phylogenetic distance from each other , we were able to assess the effect of distance on the ability of different tools to pick out foreign genes.
 <cit> . n.d. = not determined.

the goal of any method is to score genes in such a way as to maximize the separation between native genes and genes of foreign origin. figure 
 <dig> shows examples of the distribution of scores for the four methods considered: g + c frequency , codon bias
 <cit> , octanucleotide frequency , and core gene similarity . we define here discrimination as the difference between the fraction of true positives  minus the fraction of false-positives . the decision of where to place a threshold value is ultimately a matter of choice and will be discussed later. for testing purposes, we determined the maximal discrimination, defined as the discrimination at the threshold value that maximizes the difference between the detection of test-foreign and test-native genes. this is equivalent to finding the x-value that produces the maximum area under the curve, as shown in figure 
 <dig> 

tests of assumptions
the motivation behind this work stems from two assumptions. the first is that methods that compare the characteristics of individual genes to those derived from an entire genome will suffer because the genome  is contaminated by genes of foreign origin. the second assumption is that foreign genes will be more easily discerned if oligonucleotide frequency comparisons are confined to those frequencies that are the most informative. including other frequencies in the analysis will only reduce the signal to noise ratio. each assumption was tested under controlled albeit artificial conditions.

to determine the effect on the methods by contamination of a genome by foreign genes, the genome of synechocystis pcc  <dig>  was seeded with varying numbers of genes from two organisms, one organism, prochlorococcus sp. med <dig> , was chosen because it is evolutionarily distant from syn and has a very different gc content , and a second, thermosynechococcus elongatus bp <dig> , was chosen as one that is more similar to syn with respect to gc fraction  and transposon frequency  and to the incidence of a highly iterated palindrome  sequence gcgatcc
 <cit> . hip <dig> sequences are greatly enriched in the genomes of most cyanobacteria except those of small marine synechococcus and prochlorococcus . figure 
 <dig> shows that as the fraction of contaminating pmm genes increased to 20%, the discriminating power of the w <dig> method dropped to zero, consistent with an earlier, more limited test
 <cit> . maximal discrimination by the gc% method was less affected, and maximal discrimination by codon bias was hardly affected at all. contamination by tel genes had a much lesser effect on all three methods.

confining the range of oligonucleotide frequencies considered also had a striking effect on the results of the w <dig> method but not in the way we had anticipated. the w <dig> method was modified so that its set of reference octamers was taken from the lowest n percent of octameric oligonucleotides frequencies, with n varying from  <dig> to the usual  <dig>  we tested  <dig> donor/recipient pairs,  <dig> in detail, and representative types of samples are shown in figure 
 <dig>  the manner in which maximal discrimination responded to varying the frequency slice was found to be quite sensitive to the presence or absence in the donor and recipient genomes of hip <dig> sequences. when a hip1-rich genome was used to contaminate another hip1-rich genome, the maximal discrimination was little affected by the fraction of oligonucleotides used in the reference set, except for a large drop in discrimination when the 20% most overrepresented oligonucleotides were included .

less predictably, high-gc, hip1-poor genomes contaminated with high-gc genes sometimes increased maximal discrimination as the frequency width increased, illustrated in figure 
4b , while the maximal discrimination values of most other donor/recipient pairs were only modestly affected by the choice of frequency width . considering the overwhelming influence of hip <dig> frequency on the efficacy of omitting high frequency oligonucleotides from the reference set ; see also discussion), we considered the possibility that the genomes without frequent hip <dig> sequences might possess different high frequency sequences that influence the results. table 
 <dig> shows how the varied results of suppressing high frequency nucleotides in the reference set becomes more organized if organisms are distinguished by their possession of frequencies of hip <dig> sites and other octanucleotides. in brief, when the contaminating sequences are rich in hip <dig> sites, a reduced reference set is better able to pick them out, but when they are rich in other octanucleotides and have a high gc%, a complete reference set is more effective. there is no strong preference of one method over another in other cases.

a the values shown are the compilation of results of  <dig> experiments in which genes taken at random from one genome were used to contaminate a target genome  for a listing of the data on which the table is based). each value shown is the difference of the maximal discrimination calculated using the w <dig> method subtracted from the value calculated using a modified w <dig> method in which the 40% least frequent octanucleotides were chosen as the reference set. values in which the difference is at least  <dig> percentage points in favor of the 40% choice of octamers are rendered in bold. those in which the difference is at least  <dig> percentage points in favor of the 100% choice of octamers are rendered in bold italics.

b the categories of the source/target combinations were determined by whether the source and target genomes were high gc  or low and by the frequency of the most frequent octameric sequence: high hip <dig> if the most frequent octamer is gcgatcgc  and occurs at least  <dig> instances per million nucleotides, high 8mer if the most frequent octamer is not hip <dig> and occurs at least  <dig> instances per million nucleotides, and otherwise low 8mer. the number in parentheses indicates the number of times the particular source/target combination was tested. combinations were counted only if at least one condition  yielded a maximal discrimination value between  <dig>  and  <dig> .

preliminary tests of parameters of the standard method
in order to address the problems of existing methods demonstrated in the previous section, we modified the w <dig> method in two ways:  by defining the reference set using core genes, highly conserved genes retained in almost all eubacteria and therefore unlikely to be of foreign origin , and  by limiting the oligonucleotides in the reference set to the most underrepresented 20% . the value of 20% was chosen for historical reasons and is considered further in the discussion section. the parameters of the method  were tested as described below, by measuring the effect of changing these parameters on the maximal discrimination by cgs.

the cgs method relies on a set of genes, the core reference set, that one might expect to be relatively free of genes of foreign origin. however, if the set has just as high a frequency of foreign genes as those outside the set, then the method would not figure to have an advantage over the w <dig> method. to test the robustness of the method to contamination of the core reference set by genes of foreign origin, the set was intentionally contaminated by introducing genes that had the lowest cgs scores , as described later and provided in additional file
 <dig>  using the syn genome as a test case, increasing contamination of the core reference set with putative foreign genes led to a drop in maximal discrimination, but the drop was slight when contamination was less than 20% . contamination of the reference set had no effect in the case of pma , a genome that appears to have few genes of foreign origin . contamination of the reference set actually improved maximal discrimination in the specific case where the genome with a relatively high gc fraction  was supplemented with genes from high gc organisms , consistent with results described above, as one would expect, maximal discrimination per cgs was approximately equal to that per w <dig> when the reference set was contaminated by an amount comparable to the predicted level of foreign genes in the genome .

the cgs method appears therefore to be sufficiently robust to withstand low levels of foreign genes in the reference set. how high a level would one expect? we estimate that 6% of core genes have positions in phylogenetic trees discordant with a consensus organismal tree, based on an analysis of data presented by zhaxybayeva et al.
 <cit>  on  <dig> sets of orthologous genes from  <dig> cyanobacteria . the effective fraction may be significantly less, since many of the discordances indicated by the analysis of zhaxybayeva et al.
 <cit>  are consistent with horizontal transfer events that took place so far in the past that the participating genes would not be recognized as foreign by cgs . in brief, the occasional foreign gene in the core reference set would appear not to be a problem for the cgs method. the presence of foreign genes in the test-native set is another matter, one that is discussed in the next section.

one might imagine that scoring oligonucleotides from the coding strand would be more informative, as doing so might capture codon-specific tendencies. alternatively, examining both strands might double the amount of information available. in fact, the choice made little difference in three of the four target genomes tested, while the coding strand was more effective in the case of one target organism . we chose to use just the coding strand in subsequent calculations.

tsirigos and rigoutos
 <cit>  found that 8-nt was the optimal length in determining the set of reference oligonucleotides. we confirmed that 8-nt was generally more effective than 6-nt . our results  were also consistent with those of tsirigos and rigoutos in their finding that covariance was the most effective statistical means of comparing oligonucleotide frequencies calculated from genes and the set of reference oligonucleotides. the number of genes in the set of core genes had only a minor effect on the ability to detect artificially seeded foreign genes .

choice of threshold
maximal discrimination will not be a useful measure for most who seek foreign genes in genomes. instead, they will want a measure that can answer one of two distinct questions: which genes are most likely to be of foreign origin and which are most likely to have arisen by lineal descent. in either case, it would be helpful to have an estimate of error, i.e., the probability that a gene identified in one class is in fact a member of the other.

the descriptions of the w <dig> and codon bias methods provided empirical methods to calculate thresholds through which to predict foreign genes, and we wished to determine what fraction of false positives might be expected by using these thresholds. tsirigos and rigoutsos  placed the threshold at an inflection point in the distribution of scores obtained through the w <dig> method. when this procedure was applied to each of  <dig> cyanobacterial genomes not supplemented with test-foreign genes, 15%  of test-native genes were identified as foreign  and presumed to be false positives. mrazek et al.
 <cit>  provided a complex formula that takes input from scores obtained from different classes of genes to arrive at a threshold. using this threshold, the codon-bias method identified 7%  of test-native genes as foreign .

to permit a fair comparison of the methods under consideration, we chose to fix the thresholds for all methods such that each method produced a 5% putative false positive rate. it must be noted that if the test-native set contains genes of foreign origin with scores typical of foreign genes, then the threshold will be misplaced to the extent that false positives are replaced by foreign genes. for example, in the unlikely event that 10% of the test-native set are of foreign origin , half of the foreign genes in the genome may have scores beyond the 5% threshold and thus go undetected.

efficacy of cgs method relative to other methods
the efficacies of the four methods considered in this work were compared with respect to their abilities to pick out test-foreign genes in a variety of genomes. however, since a natural genome is likely to pose quite a different challenge from one artificially seeded with foreign genes, we also tried to assess effectiveness of the methods using internal measures, the identification of transposases and genomic islands, and a comparison of predictions with phylogenetic trees.

the cgs method was more effective than the gc method in 92% of the donor/recipient trials in picking out seeded foreign genes as judged by discrimination at a 5% false positive rate , including all of the  <dig> cases where at least one of the two discrimination values exceeded 65%. the gc method did better in those cases where the gc content of the donor organism is extreme. one would expect that the gc method would suffer as the gc content of the donor and recipient approached each other, even when two genomes with similar gc content are evolutionarily distant, and indeed this was the case .
 <dig> 

maximal discrimination was very poor  when the two organisms differed by less than 5% in gc fraction. in contrast, the performance of the cgs method was much less tied to the gc contents .

the codon bias method fared no better in this test , with cgs predicting seeded genes better than codon bias in all of the  <dig> cases where at least one of the two discrimination levels exceeded 65%. codon bias appeared to be generally more effective in those trials where discrimination was poor, but this may be an artifact of the method. the apparent floor value of  <dig>  to  <dig>  for codon bias is consistent with a failure in our assumption that the set of test genes  is a random sampling of all native genes  with respect to the measured quantity. indeed, confining the analysis to 80% of the genes of syn that have the most normal scores, the average codon bias score for test-native genes is far from the average score for all genes in the set and close to the average score for the highly expressed genes of the training set. in contrast, the average cgs score for test-native genes is indistinguishable from the average score for all genes of the set . codon bias would therefore identify more genes as foreign but at the cost of also identifying more native genes as foreign .
 <dig> 

the w <dig> method was more effective in this test than the previous two methods , as cgs had a higher rate of success than w <dig> in only 76% of the cases. however, cgs was more successful in almost all the cases where the difference was major.

the w <dig> and cgs methods are very similar, differing only in the reference frequency set  and the choice of reference gene set . in formulating the cgs method, we confined the reference set to core genes thinking that doing so would avoid the poisonous influence of foreign genes in the genome. to test how great this influence might be, we modified the standard test of w <dig> so that artificially seeded genes were tested one at a time, without affecting the set of reference frequencies , and we calculated the frequency set using the same infrequent octamers as used for cgs. with these modifications, the only difference remaining between the two methods was that the modified w <dig> method used all genes as the basis of the frequency set, while cgs used only core genes. if pre-existing foreign genes affected the frequency set, then it should be apparent by a comparison between cgs and modified w <dig>  of course it is not possible to exclude from the w <dig> calculation foreign genes in the genome, except in artificial tests such as these.

the results of such a comparison are shown in figure 
6c. in accordance with results presented in the last section, the discrimination ability of the modified w <dig> method was much improved relative to the unmodified w <dig> method. however there still remained a difference in discrimination relative to cgs. the modified method was more effective, particularly with the genomes of the marine prochlorococcus and synechococcus, but less effective with the genomes of those organisms with highest density of transposons.

one way to assess the effectiveness of the different methods without the artificiality of seeding a genome with exogenous genes is to identify genes that probably arose by lateral transfer and examine the success the methods in identifying them. transposases are plausible candidates
 <cit> , though it must be borne in mind that they, like viruses, can establish a close relationship to a group of related organisms. figure 
 <dig> shows the success the w <dig> and codon bias methods had relative to cgs in detecting transposases in  <dig> cyanobacterial genomes where transposases have been annotated. it is not surprising that w <dig> suffers by comparison, since repeated sequences such as transposons contribute to the reference set roughly in proportion to their numbers. codon bias also did not do well, comparable to its showing with seeded foreign genes .

another source of presumed foreign genes is the set of genes in genome islands. coleman et al.
 <cit>  compared the genomes of pmm and pmi and identified genome islands in each strain, presumably having arisen by lateral transfer. we used the  <dig> coding genes from pmm and the  <dig> coding genes from pmi lying within genome islands in tests of the methods . no method detected more than 30% of the genes in the islands. codon bias picked out the most but also identified far more genes as putative foreign than the other methods. as judged by a percentage of putative foreign genes confirmed by localization in genome islands, cgs was as good as codon bias or better. w <dig> did not find genes within the islands at a rate distinguishable from chance.

a all methods used a threshold that excludes 95% of the test-native set.

b genes identified as foreign by the method in the given genome. pmm has  <dig> coding genes in genome islands out of a total of  <dig> coding genes, and pmi has  <dig> coding genes in genome islands out of a total of  <dig> coding genes, per coleman et al. . c the number of genes identified as foreign by the method that lie within a genome island. the expected number is that which would arise if the genes identified as foreign were distributed randomly throughout the genome. asterisks indicate statistical significance to the level p <  <dig> . numbers without asterisks are not significant even to p <  <dig> . d the fraction of total putative foreign genes identified by the method that lie within genome islands. 

perhaps the ideal test is a comparison of the predictions of each method against discordances found from analyses of phylogenetic trees. zhaxybayeva et al.
 <cit>  presented  <dig> trees, based on sets of well conserved orthologous genes, that had a total of  <dig> conflicts with respect to an organismal tree, each associated with a discordant pair of genes. surprisingly, in only 9% of these reported conflicts was a gene predicted by cgs to be of foreign origin included in the discordant pair. the other methods did no better . while this fraction is significantly greater than that predicted by chance , it nonetheless seemed low, so we examined the trees in detail. all  <dig> conflicts from zhaxybayeva et al's list that name a gene with a low  cgs score were examined, along with  <dig> others chosen at random  with higher cgs scores, in order to assess why the reported conflict was not detected by the cgs method. all the trees are provided in additional file
 <dig>  they differ from those of zhaxybaeva et al. in that they consider sequences from up to  <dig> cyanobacteria  and use a bayesian approach and maximum likelihood to construct trees, as described in methods, instead of quartet analysis. trees from the two studies are often inconsistent, and in some cases the additional sequences in our trees reveal paralogous relationships that resolve the reported conflicts.

the trees were interpreted, extracting from each a time range of the simplest horizontal gene transfer events that could have produced well supported discrepancies with respect to the 16 s rrna gene tree . in many cases, multiple events are required. a summary of the analysis is shown in figure 
 <dig>  the time ranges of all  <dig> of the events predicted by cgs are consistent with hgt events that have occurred more recently than the divergence of pmf and pmt from the remaining marine cyanobacteria. although many potentially recent hgt events thus defined were not predicted by cgs, the probability is less than 5% per χ <dig> analysis that  <dig> potentially recent hgt events would arise from a random sampling of all the events considered. four syn genes chosen at random from those with cgs scores less than  <dig>  were also analyzed. in each case, their trees showed strong evidence of hgt .
 <dig>  each line is associated with a set of proteins reported by zhaxybayeva et al.
 <cit>  to contain at least one conflict with the 16 s rrna gene tree. the termini of the time ranges are defined by evolutionary events deduced from the 16 s rrna gene tree , either the divergence of a single organism  from many or the divergence of one or two organisms from one or two other organisms . evolutionary time proceeds left to right, roughly proportional to the number of mutations that have accumulated in ribosomal dna. the scores of the gene or genes  predicted to have resulted from horizontal gene transfer are given at the right, according to the four methods considered. green lines indicate time periods that are at least partially as recent as the divergence of pmf/pmt from synechococcus.

survey of putative foreign genes in cyanobacteria
one might reasonably expect that different genomes would carry different fractions of genes of foreign origin. we applied three of the methods to the genomes of  <dig> cyanobacteria, asking how many genes fell beyond a threshold score determined by a 5% false-positive rate. codon bias almost always identified more putative foreign genes for a given genome , and the gc and w <dig> methods generally identified fewer putative foreign genes relative to cgs . a possible reason for this was discussed in the previous section. for now we will focus on the values reported by cgs, which are given for all genes in additional file
 <dig> 

the number of foreign genes identified was correlated with the clade of the organism . reasonably enough, the fewest foreign genes were found in genomes of the low-gc prochlorococcus of group  <dig>  which are the smallest genomes amongst cyanobacteria, ranging from  <dig>  to  <dig>  mb for the five genomes in this category. four of the five have fewer than  <dig> % putative foreign genes per cgs, which should be interpreted as  <dig> %, as the chosen threshold should lead to a misidentification of 5% of native genes. the fifth, pmz, is also the only prochlorococcus with identified transposases .

the four genomes from the filamentous cyanobacteria also have a low reported incidence of putative foreign genes per cgs, all less than  <dig> % , despite a range of genome sizes from  <dig>  to  <dig>  mb.

the middle and high-gc marine prochlorococcus/synechococcus of group  <dig> have larger genomes  and a relatively high fraction of putative foreign genes . the unicellular members of group  <dig> have the broadest taxonomic range and the broadest range of putative foreign genes, from  <dig> %  to  <dig> % .

as might be expected, the set of putative foreign genes is heavily biased towards transposons and phage sequences when such are present in the organism, and the same is true for genes that have no known function . surprisingly, genes related to photosynthetic energy production are also overrepresented in the set of putative foreign genes, at least in the case of group ii cyanobacteria. genes that are highly expressed, including photosynthesis genes, have unusual codon preferences , which could conceivably affect cgs scores, but this phenomenon is unlikely to account for the observed bias, as we were unable to detect any obvious correlation between gene expression and cgs score in ana and syn, two organisms for which microarray data is available .

foreign proteins would also be expected in general to show greater similarity to proteins of distantly related organisms than would native proteins. to assess whether the proteins identified by cgs scores had this property, we counted the numbers and sources of similar proteins according to blast, a crude measure but one that could be practically applied to all proteins in an organism. figure 
 <dig> shows how the number of proteins in syn vary according to their cgs scores when classified by their evolutionary context. in brief, the context of a protein was termed cyanobacterial when matches were primarily to cyanobacterial proteins, recent when there were few matches but they were to proteins of closely related cyanobacteria, non-cyanobacterial when matches were primarily to proteins from outside the cyanobacteria, and solitary when the only match was to the protein itself .

chromosomal syn proteins that gave low cgs scores were much less likely than those with high cgs scores to have a cyanobacterial context . furthermore, the low cgs proteins were much more likely to be of apparently recent origin. plasmids are generally transient components of a genome, and this is reflected in the greater fraction of their proteins with non-cyanobacterial contexts and those that are solitary . this is especially evident in proteins with cgs scores <  <dig> , where 72% of the proteins are in these two categories.

discussion
there is great appeal to the idea of identifying genes of foreign origin as easily as one identifies the genes themselves, through information obtained directly from the genome, possibly supplemented by readily available outside resources. the analysis of compositional features of genes offers that prospect, but the operational simplicity comes at a cost: a layer of abstraction between the measure and the phenomenon. very little is understood as to why compositional features are conserved amongst like organisms, and so caution must be exercised in employing such features as surrogate measures of horizontal genetic transfer. we have attempted to identify parameters of oligomer frequency analysis important in identifying genes of foreign origin and propose a method that may often perform better than existing surrogate methods.

the proposed cgs method performed better than gc fraction, codon bias, or w <dig> in the great majority of trials artificially introducing foreign genes into genomes , overwhelmingly so when discrimination between foreign and core genes was high . the tests attempted to simulate the acquisition of foreign genes in the recent past, before sufficient time has elapsed for the genome-specific composition features to fade
 <cit> . one might argue that these seeding experiments are too unnatural to be fully convincing. we therefore sought tests of the methods using extant genes that are plausibly of foreign origin. the cgs method was considerably more effective than any of the other methods tested in flagging resident transposase genes as foreign . it was also clearly superior to either w <dig> or gc in finding genes within genome islands .

what is the basis of the superior performance of the core gene similarity method? as the name suggests, a distinctive feature of the method is its reliance on well conserved core genes, to define the training set without contamination by foreign genes that may be present in the genome. calculating the training set using all genes rather than core genes drastically degraded performance when the genome was artificially seeded with foreign genes at a level of 20% , a reasonable value for natural genomes . conversely, the conceptual removal of foreign genes from the training set greatly improved the performance of the w <dig> method .

a second distinctive feature of the method is that it limits the training set of oligomers. we initially considered that confining the training set to underrepresented octamers would increase the method’s ability to detect genes of foreign origin. this second hypothesis turned out not to be true, since for most simulations, there was little difference in discrimination when using only underrepresented octamers as compared to including the middle range of octamers . on the other hand, the inclusion of overrepresented octamers caused in most simulations a sharp drop in performance , correlated with the presence of high frequency hip <dig> sites in contaminating genomes. two of the most striking observations shown in table 
 <dig> are readily explained. first, if high frequency hip <dig> sites are retained in the training set, along with high frequency sequences one nucleotide removed from hip <dig> , then their presence in foreign genes would present a strong but misleading signal of the origin of that gene. second, ignoring high frequency oligomers reduces the ability of the method to discern foreign genes, when those genes come from high gc organisms with high frequency oligomers differing from those in the target genome . empirically, the optimal general solution seems to be to construct a training set from the 80% least frequent octamers, a practice that retains the benefit described in the first case and excludes almost all the injury described in the second case. understanding why this is would require insight into the nature and spectrum of repeated sequences in bacterial genomes, a goal we are pursuing.

some of the limitations of compositional methods to detect horizontal transfer are well known. the sequence signature of the originating genome must lessen with time
 <cit> . events occurring in the distant past may be invisible to compositional methods, and figure 
 <dig> provides evidence for this, just as recent events may prove difficult for phylogenetic methods to detect
 <cit> . compositional methods may also founder because of failure of the basic assumption that the measured feature is constant over the genome, except at locations of horizontal transfer. it has been reported that g + c in the third codon position varies along the length of the e. coli genome
 <cit> , and strand-specific deviations from randomness in the location of oligomers are well known
 <cit> . combinations of methods may be more effective in detecting instances of horizontal transfer
 <cit> . the current work makes clear that changing the parameters of even a single method may be important in optimizing the detection of certain combinations of source and target genomes.

it must also be noted that the method described here is not capable of detecting horizontal transfer of genes in the reference set. however, this restriction is easily sidestepped by running the algorithm twice with nonoverlapping sets, at the minor cost of doubling the execution time.

the most significant limitation of this work is that it focuses on a single class of organisms, the cyanobacteria, most of which are known to possess high frequency hip <dig> sites . while very few bacterial genome possess octomers as frequent as hip <dig> sites , many have other significantly repeated sequences, such as recombinogenic chi sites
 <cit>  and transformation uptake signals
 <cit> , which may also affect the performance of surrogate methods in a similar fashion as hip <dig> sites.

CONCLUSIONS
cgs scores provide a means by which thousands of genes can be evaluated for horizontal gene transfer in a few minutes of computer execution time. the use of the test-native gene set as an internal control enables the user to adjust parameters in a rational fashion to allow greater sensitivity at the expense of accuracy or vice versa. it is important to note that the method does not require any prior knowledge of species related to the target organism, as the reference and test-native sets are derived using genes that are common to all eubacteria.

