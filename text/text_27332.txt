BACKGROUND
in microorganisms, it is often seen that genes tend to locate in conserved proximity in a number of genomes forming conserved gene clusters  <cit> . further analyses often uncover biologically meaningful relationships between genes with conserved proximity  <cit> : they are often co-transcribed as operons  <cit> , or co-regulated as part of a larger biochemical network  <cit> . examples include the widely present dna restriction and modification gene pairs  <cit> , which provide a way of defending against bacteriophage and other foriegn dna, and the two component systems which respond to changes in environmental conditions  <cit> . thus, delineation of conserved gene clusters will help reveal functional relationships between genes within them  <cit> . in addition, the conserved gene clusters provide an invaluable resource for corroborating the growing number of co-expressed gene sets obtained from microarray based mrna expression experiments.

the increasing accumulation of genome sequence data has facilitated the practice of finding conserved gene clusters since both similarity and synteny information can be easily obtained  <cit> . various computational methods for finding clusters have been described  <cit> . an important issue has been the estimation of significance of the observed conserved proximity. it is generally accepted that phylogenetic distances between genomes largely determine the significance: conservation is deemed more significant when a cluster appears in distantly related genomes than in closely related ones. the rationale is that the greater the length of time a gene cluster has persisted, the more it has resisted dissolution by recombination events, and the stronger the selective pressure to maintain it. previous published methods have incorporated phylogenetic information into the estimation of significance by using either 16s rna distance  <cit>  or statistical methods  <cit> . however, few efforts have focused on the development of a full evolutionary model to describe conserved gene clusters. empirical approaches include grouping closely related genome into clades  <cit>  or choosing a subset of genomes based on knowledge of the evolution of microorganisms  <cit> . although the latter approaches are efficient in finding non-trivial conserved gene clusters, they do not scale automatically, which is problematic with more and more sequenced genomes.

moreover, sequenced organisms are often close relatives of known model organisms or pathogens selected for biomedical reasons, so phylogenetic coverage can be rather sparse and biased. for example, there are many more close relatives of escherichia coli than those of helicobacter pylori in the genome database. thus, simply counting the number of genomes where a gene cluster is conserved often overestimates the significance of conservation of a cluster observed in microorganisms such as e. coli.

delineation of evolutionarily conserved gene clusters must take into account a stochastic model of evolution of these clusters. in this paper we used a simplified stochastic generative evolutionary process where an organism inherits a gene cluster from its immediate ancestor with a probability proportional to the evolutionary distance in the tree. this model facilitates an efficient computation of the probability that a particular pattern of conservation in many genomes is observed. in particular, observing a large number of occurrences in closely related genomes will not carry the same significance as the occurrence of a cluster in a wider evolutionary phylum.

we define a tree-based probabilistic conservation score and show that it provides a quantitative measure the strength of proximity constraints in genome evolution and serves as a better predictor of functional links among genes than more naïve methods. it also sheds insight into the relationship between evolutionary development and the functional selection.

RESULTS
we applied our computational pipeline to  <dig> microbial genomes which were obtained from the ncbi website . pairwise genome comparisons of translated open reading frames were performed using blastp  <cit>  and putative orthologs between genomes were identified as reciprocal best hits . conservation scores cu and cd were assigned to each gene . intuitively, cu measures the strength of the conservation between the gene under consideration and its upstream neighboring genes while cd does the same with its downstream neighboring genes on the chromosome. the higher the cu or cd of a gene is, the more significant its conservation with its upstream or downstream neighbors. conserved gene clusters were then detected using a conservation score cutoff . the complete results of our method on all microbial genomes included can be accessed at  <cit> . results using more than  <dig> genomes available now are being incorporated into the database.

accounting for genome phylogeny can correct for databases bias
during evolution, genomes undergo frequent changes such as the rearrangement and exchange of genes. for those organisms that have diverged recently, such changes have had little time to occur so that vertically inherited synteny cannot be distinguished from functionally induced proximity information. the false positive rate could therefore drastically increase as more and more genomes from the same taxonomic group are included in the comparison. early methods ignored the phylogenetic relationship between genomes and assumed an independence between them, which could blur the distinction between gene clusters truly constrained by selection pressures and those that merely reflect vertical inheritance. the phylogenetic method we describe here is designed to integrate genome phylogenetic information into consideration and alleviate the common problem of overestimation. for illustration we devised an experiment and compared the performance of our method with the more naïve method where each genome is treated equally, which we refer to hereafter as "simple counting method". first, we chose e. coli k <dig> as the query genome and a group of  <dig> reference genomes including  <dig> closely related ones  and  <dig> distantly related ones . we then examined the genomic region of the entceba operon in e. coli k <dig>  <cit>  and used two methods to calculate the upstream conservation score  as defined in the methods section. in the simple counting method, when a gene and its upstream gene are also neighbors in a reference genome, the score for that gene will be incremented by  <dig>  figure 1a and 1b show the upstream conservation score profiles obtained from the simple counting method and our phylogenetic method respectively. in figure 1a, the scores of the entceba operon genes barely stands out from those of the flanking genes while in figure 1b there is a clear peak corresponding to the entceba operon. the signal to noise ratio, as estimated from the peak value and the base line of the cu profile, is about 3: <dig> for the phylogenetic method  but only about  <dig> : <dig> for the simple method .

the signal to noise ratio increases as more genomes are added to the reference set. the cu and cd profiles are shown in figure  <dig> for the same genomic region around the entceba operon as we progressively include more genomes in the reference set. while the scores of the genes in the operon increase as more reference genomes are included, the conservation scores of the flanking genes increase much more slowly . notice that cu for entc and cd for enta do not increase as much as other ent genes since they are the boundary genes of the ent operon. figure  <dig> shows that the phylogenetic method provides an improved framework for detecting conserved gene clusters as the number of genomes in the database increases.

conserved gene clusters inferred from orthology or similarity
it is known that using reciprocal best blast hits is a conservative method of identifying putative orthologous genes between two genomes. the advantage of using this conservative method is that any pairs identified are very likely to be true orthologs and share similar molecular and physiological function. however, for genes that have undergone fast evolution and for paralogous gene groups, which are quite common in bacterial genomes, the reciprocal relationships are usually obscured  <cit> . as a result, significantly conserved clusters or parts of a cluster may be missed if pairwise reciprocal connections are used. this is illustrated in figure  <dig>  which shows the upstream conservation score  profiles for a genomic region containing the fhu operon  <cit>  of e. coli. circles are calculated from the similarity data  and the squares are from the orthology data. for most genes where the orthology relationship is clear, scores calculated from the similarity data are equal to those from the orthology data . for those genes with no clear orthologs in other genomes, scores from similarity data are higher than those from orthology data. for instance, the cu of the fhuc gene from similarity data exceeds the threshold , but its cu from the orthology data does not. this is because fhua, the immediately upstream gene of fhuc, belongs to a paralogous gene family with  <dig> members in e. coli and its reciprocal best hit cannot be found in other genomes. as a result, the gene pair  is not identified as a widely conserved orthologous pair. on the other hand, only using the similarity data may introduce a higher false positive rate in making predictions about functional dependence, as discussed below.

application in operon prediction
to test the predictive value of our method for inferring operons, we took a compiled list of e. coli operons from the regulondb  <cit> . a total of  <dig> operons with multiple genes were extracted from the regulondb dataset. genes that are not in the regulondb set and have intergenic regions of larger than  <dig> nucleotides on both sides comprise the negative set . using different cutoffs, we calculated the sensitivity  and the specificity  by:

sn=tptp+fn,sp=tnfp+tn
 mathtype@mtef@5@5@+=feaafeart1ev1aaatcvaufkttlearuwrp9mdh5mbpbiqv92aaexatlxbi9gbaebbnrfifhhdyfgasaach8aky=wiffydh8gipec8eeeu0xxdbba9frfj0=oqffea0dxdd9vqai=hguq8kuc9pgc9s8qqaq=dirpe0xb9q8qilsfr0=vr0=vr0dc8meaabaqaciaacagaaeqabaqabegadaaakeaacqwgtbwucqwgubgbcqgh9aqpdawcaaqaaiabdsfaujabdcfaqbqaaiabdsfaujabdcfaqjabgucariabdaeagjabd6eaobaacqggsaalcqwgtbwucqwgwbaccqgh9aqpdawcaaqaaiabdsfaujabd6eaobqaaiabdaeagjabdcfaqjabgucariabdsfaujabd6eaobaaaaa@447f@

where tp and fp are the number of genes that are correctly or wrongly predicted to be in operons, and tn and fn are the number of genes that are correctly or wrongly predicted not to be in operons. notice that genes in operons must reside on the same strand while genes in clusters detected by our system may come from both strands. nevertheless, the high percentage of conserved clusters that overlap with operon dataset suggests our ability to identify clusters that are conserved due to the transcriptional selection pressure and demonstrates the potential use of the system in the task of operon prediction.

statistics of conserved gene clusters across genomes
case studies of conserved gene clusters
conserved gene clusters, once identified, can be used to make functional predictions for the genes within them, and to hypothesize interactions between their products. for example, in the genome of mycobacterium tuberculosis cdc <dig>  we found a four-gene cluster encoding putative homologs of  mraz ,  mraw/yabc ,  ftsl/mrar , and  ftsi/pbpb . this cluster is widely conserved among both gram-positive and gram-negative bacteria, and in e. coli these four genes comprise the start of a known operon of cell division and cell envelope genes  <cit> . ftsi and ftsl are known to be essential for the assembly of the cell division septum in e. coli. mraw has been shown to be a methyltransferase whose substrates are localized to the cell envelope  <cit> . furthermore, it has been shown that lack of s-adenosylmethionine  leads to a cell division defect in e. coli, with one possible explanation being that sam serves as a methyl donor in a required methylation event  <cit> . the location of mraw within this cluster suggests it may encode the methylase involved in such an event, possibly modifying the ftsl and/or ftsi proteins. indeed, there is experimental data to suggest this  <cit> , although it has not yet been conclusively shown.

in addition to conserved gene clusters that are widely distributed in many genomes, we also find statistically significant conserved gene clusters that are present in only a few species. instead of the number of genomes, the large evolutionary span across genomes contributes to the significance of the conservation. due to their limited occurrence, these clusters are difficult to find in the database using conventional methods. figure  <dig> gives two intriguing examples: one is conserved in  <dig> genomes  and the other is conserved in only  <dig> genomes . in both examples the large evolutionary span is reflected by the fact that they are conserved in both bacterial and archaeal species.

the gene cluster in figure 5a was originally found and characterized in sinorhizobium meliloti and was shown to synthesize a special type of siderophore, rhizobactin  <dig>  involved in iron uptake  <cit> . it is largely conserved in another three genomes: one is an archaea, halobacterium sp., and the other two are bacteria, nostoc sp. and bacillus halodurans. notice that this cluster is absent in other bacilli species  despite their closeness to bacillus halodurans. on the other hand, bacillus subtilis is known to possess the dhb operon responsible for synthesizing a different type of siderophore,  <dig> -dihydroxybenzoate  <cit> , and this operon is absent in bacillus halodurans. figure 5a suggests that the other three microorganisms may possess the ability to synthesize rhizobactin  <dig> or a siderophore with a similar structure, reflecting a requirement for iron in the life cycles of these species.

functional enrichment in conserved gene clusters
if conserved gene proximity indeed implies relatedness, we expect to see functional enrichment in the list of gene clusters found by our method. we used the  <dig> functional codes of cog  <cit>  as a crude measure of this, counting gene pairs in which both members belong to the same cog category. for  <dig> genomes examined, we determined the fraction of gene pairs found by our method , then performed a one-tailed fisher's exact test to determine the probability of observing at least m gene pairs with the same functional code among n pairs selected randomly from all gene pairs in the genome. gene pairs including at least one gene with no functional information  were excluded from the analysis.

a partial list of the results of this analysis is shown in table  <dig>  with the fraction of enriched clusters and the associated p-values in columns  <dig> and  <dig>  respectively. in all cases, these p-values are extremely significant , indicating that the gene pairs obtained by our method are much more likely to be functionally related than expected by chance.

a ratio is p-value for functional enrichment by the phylogeny method divided by p-value for functional enrichment by the counting method .

using the same methodology, we divided the gene pairs into colinear  and divergent  pairs to see if the bulk of functionally enriched pairs were of one type or the other. the p-values for colinear pairs were similar to those for all pairs, suggesting the vast majority of gene pairs captured by our method might be operons . on the other hand, there are only limited numbers of divergent pairs and the p-values for divergent pairs are often insignificant .

functional enrichment analysis has been also applied to the results from the simple counting method, using a cutoff of  <dig> organisms . the results are shown in table  <dig>  columns  <dig> and  <dig>  although there is no equivalency between them , the number of gene pairs captured by the two methods with their respective cutoffs were similar for many of the genomes examined . in most cases, the simple counting method also yielded significantly functionally enriched gene pairs, as indicated by the p-values in column  <dig>  for most genomes, the p-values of the simple counting method are much smaller than those from the phylogeny method . this is especially true for those genomes which have many close relatives in the database, e.g., e. coli and other enterobacteriaceae. in those cases, we also observe a large increase in the number of pairs obtained by the simple counting method. we expect this increase to consist largely of functionally unrelated false positives that are conserved because of close phylogenetic distance.

we recognize the limitations of using cog codes to capture functional relationships, and our results will certainly include both false positives and exclude false negatives. for example, consider a functionally related gene pair consisting of a transcriptional regulator and the gene it regulates. these genes would likely be assigned different cog codes, so such a functional relationship would not be captured by this analysis. therefore, to independently verify our results with cog, we performed a similar analysis using kegg pathway information in e. coli, the organism with the largest number of kegg pathway assignments. the overrepresentation statistics for e. coli using kegg are similar to our results using cog and thus support the above discussion .

discussion
there is a general problem when comparing sequenced genomes because the samples of such genomes presently available are not uniformly distributed across the microbial kingdoms. rather, several groups of related bacteria, such as the enterobacteriaceae, are over-represented. this means that the significance of a feature found in organisms from this group must be interpreted with caution because it may be conserved by simple lineage effects rather than by functional selection. most papers dealing with this problem either ignore it or simply remove the multiple members of the family and settle for a single representative example. both methods necessarily lead to inaccuracies in estimating significance. in this paper, we have attempted to overcome this problem by using a method that takes into account the phylogenies of the individual members of related families. we show that it results in a reduction in the false positive rate over the simple counting method. we have not attempted to compare it to the selective sampling method, where one organism is used to represent a phylum, because given the wide variability usually observed within a phylum, the results from that approach will vary widely depending upon which genome is selected as the exemplar.

we have applied our new phylogenetically informed method to the problem of detecting conserved gene clusters. such clusters are generally believed to reflect conservation of biological function in that often the gene products from the various genes in the cluster are involved in closely-related pathways. this may include the traditional operons known to encode the biosynthetic pathways of intermediary metabolism, or they may reflect the fact that enzymes responsible for post-translational modification will sometimes affect neighboring gene products. other functional connections may also be found in these clusters. this can be a powerful tool in making predictions about gene products that might otherwise be recalcitrant to direct similarity analysis. examples here include the restriction-modification enzymes where the dna methyltransferases often show reasonable degrees of similarity that enable them to be identified, whereas the genes for the restriction enzymes evolve rapidly and usually cannot be identified on the basis of sequence similarity. nevertheless, the genes are usually clustered. in addition, the current methodology is not necessarily restricted to the conserved synteny between genes. it may be applied to conserved synteny of other functional elements in genomes such as cis-elements, riboswitches, etc.

in our current methodology we have made several simplifying assumptions of which the most important might be to ignore horizontal gene transfer. while this is not a problem if an entire cluster is transferred horizontally, it does become a problem for those "hitchhiking" genes that may be transferred with the cluster. nevertheless, the results we report seem promising and we do not view this as being a serious limitation at the present time.

the mode of phylogenetic inference is an important consideration in the type of analysis presented here. the basis for the tree underlying the analysis is not restricted to shared gene content, as we have employed here, but could alternatively be based on 16s rna sequences, gene content, gene order, genome statistics, or coding sequences. our current method is oblivious to "local" changes such as rearrangements inside the cluster, or differential selection within individual coding sequences. for example, it is possible that genes in the cluster might have different gene trees from each other. the choice of the best phylogenetic methodology in this context is an important follow-up and we feel that the final solution will combine the benefits of multiple methodologies in a single system.

CONCLUSIONS
the methodology and results that we present here should be generally useful in any situation where the functional significance of conserved genes or clusters is being investigated, for example, as a way of cross-validating co-expressed genes inferred from many microarray experiments or as a starting point for the assembly of gene networks. as more and more genomes are sequenced, the approach described here should be generally applicable and it will scale well computationally.

of particular significance in this paper has been our finding that many of the clusters we have observed contain unknown genes with no biological function currently assigned. in these cases it seems reasonable to hypothesize that the product of the unknown gene has a function closely related to the functions of the known genes. such a function may be a key enzymatic step in a biosynthetic pathway, a key regulatory function or an important post-translational modification. we have assembled a database of conserved gene clusters, called genechords  <cit> , with a simple user interface to permit its rapid query. this will be described in detail in a separate publication.

