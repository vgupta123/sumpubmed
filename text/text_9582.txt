BACKGROUND
structural variations , such as insertions, deletions, and copy number variations , have been shown to account for a large portion of genetic variance in both mouse and human genomes  <cit>  <cit> . svs are also known to contribute to phenotypic variation and have been implicated in a number of diseases  <cit> . therefore these genetic variants can be utilized in a fashion similar to that of snps and may be useful when conducting association studies aimed at explaining mechanisms of complex diseases  <cit> . cnvs have been shown to make up around 12% of the human genome and various studies show their presence can affect gene expression, cause disease and alter the organism’s phenotype  <cit>  <cit>  <cit>  <cit> . for this reason, the problem of cnv detection has attracted a lot of recent attention. the efforts of many recent studies have been aimed at the detection of svs and the prediction of their genomic regions  <cit>  <cit>  <cit>  <cit>  <cit>  <cit>  <cit> . however, the general problems of detecting and especially reconstructing cnvs still lack effective methods.

there have been several proposed methods for detecting cnvs based on comparative genomic hybridization   <cit>  <cit>  <cit>  <cit>  <cit> . in cgh, both a genome of interest  and a reference genome are hybridized to a tiling array. the genomes are labeled so that the intensity of each can be differentiated on the array. the ratio of intensities  at each spot provides an estimate of the gain or loss of the genomic sequence represented by the spot. this method, although successful in detecting cnvs, suffers from a number of limitations. the cgh approach lacks the ability to detect cnvs with high resolution. that is, the exact boundaries of the sequence which exists in variable copies are not distinguishable. also, the cgh approach is unable to detect variations within the genomic copies  <cit>  <cit> . nannya et al.  <cit>  and wang et al.  <cit>  proposed more sensitive methods to improve resolution and genome coverage using whole-genome snp genotyping arrays. but even these methods lack the ability to effectively reconstruct the regions of interest. in general, array-based methods may theoretically be able to predict the exact boundaries and number of copies of a particular region, but cannot be used to reconstruct the actual region as it appears in the donor genome.

the rising availability of next-generation sequencing  technologies offers an alternative way to detect cnvs. next-generation sequencing provides a large number of short reads, as much as 40x coverage for a human individual. these reads can be mapped to a reference genome, in order to identify variations. a few recent studies have proposed methods to detect cnvs using datasets generated by ngs technologies  <cit>  <cit>  <cit>  <cit> . simpson et al.  <cit> , using sequence data generated with inbred mouse strains, attempted to predict occurences of cnvs by using a hidden markov model. their method breaks the genome into a series of windows and determines the copy number state at each window. adjacent windows that have the same copy number state are combined to determine the full region of the cnv.

unfortunatly, the boundary resolution for this method is limited by the size of the window, which is typically at least  <dig> kilo-base. chiang et al.  <cit>  used a sliding window approach in order to identify genomic regions that are suspected to contain cnvs and to estimate the location of their boundaries. this method is able to predict the boundaries with greater resolution, because it is not limited by the choice of window size. both of these methods have successfully identified true cnvs. however, their focus has been primarily on predicting the genomic sequence that exist in variable copies.

medvedev et al.  <cit>  proposed a method to use discordant paired-end reads to identify structural variations. discordant paired-end reads are reads mapped to the reference sequence in a way indicative of a structural variation. these discordant reads are clustered to provide high confidence for the occurrence of each structural variation. medvedev et al.  <cit>  proposed an elegant method to detect copy number variations using paired-end reads. similar to  <cit> , they first cluster discordant paired-end reads to identify cnv boundaries. next they build a “donor graph”, which represents the genome as a set of sequence blocks connected by a set of edges. the donor sequence can be reconstructed by walking along the edges of the donor graph. a maximal flow algorithm is applied to estimate the most-likely number of copies for each cnv. however, their method aims to solve the general cnv detection problem and is not specific for solving the cnv reconstruction problem.

in this work, we focus on the cnv detection and reconstruction problem for tandemly organized de novo cnvs. this type of cnv was shown to make up nearly 89% of all cnvs with size ≥ 10kb found in the mouse genomes  <cit> . tandem cnvs have the properties that there are no gaps or very short gaps between the copies and there is only one copy in the reference cnv, while there are multiple copies in the donor sequence. therefore, according to the definition of tandem cnvs, we are only trying to detect cnv gains but not cnv losses, since there can be only one copy of cnv in the reference sequence. this structure allows us to efficiently reconstruct the exact cnv copies. we call the cnv in the reference sequence reference cnv and the cnv in the donor sequence donor cnv. each copy in the donor sequence can potentially have a different beginning and ending position , which can be considered as insertions and deletions. we detect cnvs by examining the mapping structure across the genome using discordant paired-end reads. a discordant read pair is one that maps to the reference in a way that suggests a cnv. these discordant read pairs serve as a signal for potential cnvs. we interrogate the regions in which we observe discordant pairs, in order to determine if a cnv is likely to have occured.

discordant pairs are clustered to obtain estimates of the cnv boundaries and read coverage is used to estimate the number of copies that exists in the donor. unlike all the previous methods, our reconstruction algorithm utilizes unmapped reads in order to identify the exact boundaries of each of the predicted copies and subsequently reconstructs the cnv regions as they appear in the donor sequence. for each detected cnv, we estimate both the number of copies as well as the boundaries  of each copy in a donor genome. we then use these estimates in order to generate a reconstruction of the cnv region as it appears in the donor genome.

in order to validate our method, we constructed donor sequences using build  <dig> of the mouse genome. we chose to use the previous build , because she et al.  <cit>  recently identified a large number of cnv regions within this build. we use this information so that we can avoid known cnv regions and effectively simulate de novo cnvs. avoiding known cnvs, we simulate donor genomes by randomly selecting non-overlapping regions within the reference genome and tandemly inserting multiple copies. we generated a donor genome with  <dig> chromosomes, each chromosome with  <dig> randomly inserted cnvs. our detection method was applied and we found that we are able to accurately identify up to 91% of the inserted cnvs. also our reconstruction algorithm detects the breakpoints with accuracy up to 97%.

RESULTS
simulation
in order to test our methods, we developed a simulation framework in which a donor genome is created by altering a given template genome by inserting non-overlapping cnvs. the number of copies for each cnv is selected uniformly at random from between  <dig> and  <dig> and the prefix and suffix of each copy is selected uniformly at random within a range that guarantees that the copy will be no smaller than  <dig> base pairs.

for each of the resulting donor genomes, paired-end reads are simulated. the reads are of length  <dig> bp and the inserts are chosen between  <dig> and  <dig> bp, uniformly at random. the full set of reads are mapped to the original reference genome using the maq mapper  <cit>  and the resulting maq mapping files are then used by our detection and reconstruction methods.

we used this framework to generate one full mouse genome with  <dig> chromosomes, using build  <dig> of the mouse genome. for each chromosome we inserted  <dig> non-overlapping cnvs, avoiding regions with known cnvs, as described by  <cit> . each generated genome contains  <dig> chromosomes each with  <dig> inserted cnvs, resulting in  <dig>  cnvs in total. each donor chromsome resulted in over  <dig> million reads. table  <dig> summarizes the number of cnvs simulated within each length range, as well as the number of these belonging to each copy-count category.

the number of cnvs belonging to each length class along with the number of copy-counts for each range are given.

cnv detection
medvedev et al.  <cit>  illustrate that the formula  <dig> works well on yoruban hapmap individual na <dig>  we next show that this formula may not always work. for example, when the cnv copies have very different length, the likelihood function defined in formula  <dig> usually does not return the correct copy-counts. we applied our detection algorithm to the set of  <dig> chromosomes containing  <dig>  cnvs as described in section . when considering the fraction of detected cnvs in each chromosome, we find that our method is able to effectively detect on average  <dig> % of the inserted cnvs, while accurately predicting the copy-counts for 83% of these. table  <dig> summarizes the results obtained by our detection algorithm for varying coverage ratios as well as varying copy-counts. we show that as the copy-count increases, our algorithm has decreased power to detect both the presence of a cnv as well as the true copy-counts. our algorithm has a slight decrease in detection accuracy when the coverage ratio is reduced, but maintains roughly constant power to predict the true copy-counts over varying coverage ratios.
 summary of the percentage of detected cnvs and predicted copy-counts broken down by true copy-counts



cnvs were considered to be detected when the begining and ending reference cnv positions were predicted within  <dig> base-pairs. in practice, the average deviation from the true positions was about  <dig> base-pairs. the percentage of predicted-copy counts is reported as the percentage of detected cnvs for which were able to accurately predict the true copy-counts. the average running times for the detection algorithm are 552s, 527s and 497s for coverage of  <dig>   <dig> and  <dig>  respectively.


we found that most of the missing cnvs are in regions containing repeats. and for those which we are not able to predict the copy-counts, we found that the number of reads mapping to the reference cnv region was much smaller than expected given the length of the reference region and the true copy-counts. we examined the ratio of the total length of the cnv region in the donor to l × n where l is the length of the reference cnv, n is the copy-counts, and found that for cnvs for which we could not detect the copy-counts this ratio was smaller when compared with the cnvs for which we could predict the copy-counts . upon examining the distribution of these ratios, we find that their means are significantly different by t-test . as described in the methods section, for each cnv the lengths of the copies were generated randomly. given this, we can expect that as the number of copy-counts increases, the chance to have at least one copy that is significantly smaller than l increases. if this is the case, then we expect that on average our power to predict the true copy-counts will decrease as the number of copy-counts increases. this is what we observe and have summarized in table  <dig>  therefore, when the length of the copies varies too much, the formula  <dig> has relatively low prediction power for the copy-counts. when the cnv copies have similar length, such as those in yoruban hapmap individual na <dig>  our method can detect both the cnv and the copy-counts with high accuracy.

cnv reconstruction
once the predicted cnvs have been obtained, we attempt to reconstruct them as they appear in the donor sequence. we expect that reads spanning the junction between two adjacent copies will not map to the reference sequence. we utilize these reads in order to find the exact boundaries between copies. given the high coverage of the next generation sequencing data, each junction should be spanned by a at least one read. we can split these unmapped reads and try to map both parts to the reference sequence. if both parts map perfectly to the reference sequence , the mapped position indicates the corresponding start and end positions of the two adjacent copies.

we take the correctly identified cnv regions and their copy-counts from the previous step and then apply the reconstruction method to identify all junctions. to evaluate the accuracy of the reconstruction, we evaluate the accuracy of the identified junctions. we consider an identification as accurate if the identified position is within  <dig> bps of the true junction position. given a junction a|b, we do not require that a successful identification always identifies both a and b correctly. instead we allow partial identification, namely if we only identifie a successfully, we consider the identification of a as a success and the identification of b as a failure. therefore for all junctions, we calculate the percentage of the successful identifications. we summarize the performance of our method in table  <dig> and  <dig> 
 cnv length vs. coverage ratio vs. cnv junction identification accuracy 


l is the length of the cnv in the reference, c is coverage ratio.

as we can see in table  <dig>  the smaller the length of the cnv region is, the higher the accuracy is. this is because longer regions are more likely to contain longer repeats. thus even if we split the unmapped reads into two long enough parts, these parts may still randomly map to the repeat region. for cnv of length less than  <dig> , the accuracy of our method is very good. we also show the averaged run time of the method. the run time is just the time for junction validation and donor sequence reconstruction. it does not include determining the reads are from which cnv since this process depends on maq. as we can see, generally speaking, the longer the cnv is, the more time consuming the method is. however, the run time also depends on the sequences themselves, in that the sequences with more mapping positions require longer time to process. but generally speaking the averaged processing time for the cnvs is very short. in order to show how the coverage ratio affects the reconstruction algorithm, we also simulated data with  <dig> and  <dig> times coverage ratio, respectively. the results are shown in table  <dig>  as we can see, generally speaking, the higher the coverage ratio is, the better the reconstruction accuracy is. and the reconstruction accuracy also depends on the cnv sequence itself. if the cnv sequence contains more repeats, which leads to more mapping positions, the accuracy drops. that’s probably why we observe a performance drop for coverage ratio  <dig> and  <dig> when  <dig>   <dig> ≤ l ≤  <dig>   <dig>  as to the run time, the lower the coverage ratio is, the shorter the run time is, since we need to process fewer reads.

in table  <dig>  we observe that generally the accuracy increases as the copy-counts decreases. however, the accuracy for copy-counts  <dig> is slightly higher than the accuracy for copy-counts  <dig>  this is because the average length for cnv with copy-counts  <dig> is much shorter than that for cnv with copy-counts  <dig>  as we showed in table  <dig>  the smaller the length of the cnv region is, the higher the accuracy is. when the average length of the cnvs is similar, such as cnvs with copy-counts  <dig> and  <dig>  lower copy-counts makes the accuracy higher. the average run time shows that the more copies the cnv has, the longer time our method takes.
 copy counts vs. cnv junction identification accuracy


CONCLUSIONS
in this work, we proposed a novel method to first detect copy number variations  then to reconstruct cnv copies using paired-end reads generated by the next-generation sequencing  technology. our method focuses specifically on tandemly organized de novo cnvs, where there is only one copy in the reference sequence and there is no gap or very small gap between copies of cnvs in the donor sequence. we show our method achieves high prediction and reconstruction accuracies on the simulated data sets for tandemly organized de novo cnvs. given roughly 89% of cnvs found in the mouse genome with size ≥ 10kb are tandemly organized  <cit> , our method is practical for mouse genome cnv detection and reconstruction.

