BACKGROUND
metabolites are the small molecular intermediates and products of an organism's metabolism. the set of metabolites present within an organism form its 'metabolome'  <cit> . the comprehensive and quantitative analysis of the whole metabolome is referred to as 'metabolomics'   <cit> . the most commonly used experimental techniques for measuring the global metabolome are nuclear magnetic resonance spectroscopy  and mass spectrometry . both experimental methods produce spectral profiles which can be indicative of the metabolic composition of experimental samples. after various pre-processing steps, a set of 'binned' spectral regions  is produced for each sample  <cit> . these spectral regions or peaks may be viewed as a set of 'features' that may be used to characterize and discriminate between sample classes i.e. disease states, drug effects and cell types.

using the set of features produced by the above techniques, several forms of data analysis may be performed depending on the aim of an investigation  <cit> . if sample class labels are unavailable, or in cases where the presence of novel classes is suspected, 'unsupervised' classification may be used to discover sample groupings. data transformation methods such as principal component analysis  may be sufficient to reveal class structure within the samples  <cit> . hierarchical and partitional cluster analysis may also be applied to model sample relationships, within either the transformed or original feature space  <cit> . when class labels are available they may be used to support 'supervised' classification. predictive models or 'classifiers' may then be built to classify unlabelled data. linear discriminant analysis  has been applied to build a classification model from metabolomics data  <cit> . however due to the multi-collinear nature of metabolomics data it is better practice to perform principal component analysis  prior to the application of lda   <cit> . discriminant analysis based upon partial least squares  has also become popular within the metabolomics domain  <cit> . pls-da uncovers the latent variables within the data that both model the feature values and separate the sample classes. recently this technique has been enhanced in the form of orthogonal-pls-da   <cit> . other supervised methods used in this domain include support vector machines  and artificial neural networks   <cit> .

a topic that overlaps somewhat with supervised classification is that of supervised feature selection. feature selection may be employed to improve a classification model, in terms of generalization performance and accuracy, by eliminating non-informative features. aside from this, feature selection may also be used to gain further insight into the rationale underlying class divisions within a particular domain. in the context of metabolomics, retrieving the set of class discriminating features may aid in the identification of the class determining metabolites. this may allow further elucidation of the system  under investigation.

however, features selected on the basis of classification accuracy, i.e. features that are sufficient to separate classes, may not always translate directly into an explanation that makes sense from the perspective of the bio-analytical scientist. this is often the case in nmr metabolomics data, where a metabolite may be represented by one or more spectral features. in this case a subset of these features  may provide a perfect classification model. for example, the peaks  <dig>  ppm,  <dig>  ppm,  <dig>  ppm and  <dig>  ppm, which represent hippurate, can be seen in figure  <dig>  as these peaks belong to the same metabolite they will vary together, or correlate, over a set of samples. from the perspective of sample classification such correlated peaks may provide redundant information. as a result, employing standard feature selection alone may risk omitting features that are important for metabolite signature identification. high dimensional nmr metabolomics data is replete with feature correlations  both within the signal  and noise .

feature selection methods less prone to the bias effects of multi-collinear data include those based on variable influence on the projection  values, derived from pls-da, and variable importance produced by a random forest ensemble classifier. interestingly, there is a fundamental difference between random forest and pls-da. unlike pls-da, random forest is a non-parametric technique and is unaffected by feature scale. for this reason, these techniques may be seen to be somewhat complementary. in both techniques other factors, such as noise within the dataset or threshold selection, may cause relevant features to be omitted from a selected set. as a result, some features important for classification explanation and metabolite signature identification may be not be retrieved.

to further aid the retrieval of all peaks and metabolites relevant to both class discrimination and subsequent explanation, a novel metabolomics feature analysis tool called metafind  has been developed. the metafind application addresses the multi-collinear aspect of metabolomics data by providing an adjunct to standard feature selection techniques. this takes the form of a 'post-feature selection' correlation analysis step, as illustrated in figure  <dig> 

the initial function of metafind is to analyse the set of features retrieved by the investigator's chosen feature selection technique and provide support, via an interactive graphical interface, for uncovering the various metabolite signatures that may be present within this set. this provides a tool to bridge the gap between data driven class discrimination and domain explanation.

secondly, metafind also enables the user to examine correlations outside the selected feature set i.e. between the selected features and of the rest of the features in the dataset. this has the potential to discover novel features overlooked by the initial feature selection process. any additional features retrieved may then further aid identification or discovery of metabolites. lastly, metafind allows the higher level correlations between metabolite signatures themselves to be examined. both positively and negatively correlated metabolites signature may be uncovered. as discussed in  <cit> , the identification of correlated metabolites may in turn contribute to the construction of the metabolic networks. although some tools exist that enable analysis of spectral correlations  <cit> , metafind allows the user to dynamically examine the correlations of individual spectral features retrieved by arbitrary feature selection methods.

feature selection
in this study metafind was applied, in conjunction with two alternative feature selection approaches, to investigate two metabolomics datasets. the first feature selection technique employed is referred to as partial least squares  discriminant analysis  and is one of the most commonly used techniques within metabolomics and chemometrics in general. in this study we also utilize a non-parametric feature selection method based on random forest classification. we now provide a brief discussion of both pls-da and random forest based feature selection strategies.

partial least squares discriminant analysis
pls discriminant analysis  is a feature selection technique based upon the partial least squares regression method for constructing predictive models developed by herman wold  <cit> . pls is an improvement on the use of multiple linear regression  in this context due to its ability to handle data in which features far out-number samples and in which many features are correlated . in pls-da the response variable is produced by encoding class labels as a binary vector of 1's and 0's indicating class membership. pls extracts the set of latent variables which model the data but which are also correlated to the class membership vector. once a pls model has been built the influence of individual features may be captured with vip  measures derived from the pls coefficients for the optimal set of components  <cit> . features may then be ranked by vip scores and selected after the choice of an appropriate threshold . clearly the chosen threshold value may greatly affect the set of retrieved features. pls-da is also scale dependent with the choice of scaling factor again affecting features selected  <cit> . unit scaling  can produce loadings that are difficult to interpret and result in artefacts and up-weighting of spectral noise. mean centring alone favours features with higher intensity and variance. even pareto scaling  may enhance the contribution of metabolites present at high concentrations  <cit> . in this study we have applied this latter method of scaling to our features as a pre-processing step prior to pls-da.

random forest feature selection
random forest classification was first proposed by breiman  <cit> . this technique is based on growing many classification trees. a classification tree is an example of a supervised classification method in which feature values are used to build a model that enables the classification of unlabelled samples.

random forests may also be used as a basis to gain further insights into the data. one such extension allows random forest to assign importance values to features in terms of their influence on the classification accuracy of the forest and thus has been used to aid feature selection.

the influence of a particular feature on the classification accuracy of the random forest is referred to as its importance and may be evaluated by randomly permuting the feature over samples in each tree's 'out-of-bag' test set. these samples are then reclassified using the random forest. the difference in the number of correct classifications between the initial 'out-of-bag' data and the permuted 'out-of-bag' data is then divided by the number of trees in the forest and yields the importance value for that feature. the advantage of the random forest importance measure in feature selection over univariate screening methods is that it covers the impact of each feature individually as well as its multivariate interactions with other features. for example, lunetta et al. find that genetic markers relevant in interactions with other markers or environmental variables can be detected more efficiently by means of random forests than by means of univariate screening methods like fisher's exact test. as random forests are based on decision trees they also deal well with differently scaled features  <cit> . this is quite relevant to metabolomics data where the peaks may vary greatly in height .

post-feature selection analysis
given the high number of features and the high degree of feature collinearity in metabolomics data there is always potential, regardless of the feature selection technique employed, for the omission of explanatory features. the presence of noisy features, especially at lower scales  also adds to the risk of over-fitting and subsequent retrieval of irrelevant features. in the case of pls-da the investigator may use their experience to select an appropriate scaling technique to minimize the former risk while maximising the latter. nevertheless the risk of omitting relevant features, especially of those present at low intensities, cannot be eliminated. the scale independent random forest based feature selection offers no such opportunity for feature weighting. as a result there is added risk of promoting low intensity noisy features which may demote relevant features that would aid explanation. in both approaches a balance between true and false positive rates must again be struck during the threshold selection step in which f features are chosen from the ranked list. again the high dimensional, multi-collinear datasets found in metabolomics create further difficulties at this stage.

to help address these concerns it may be useful to carry out a second sweep of the dataset for additional features that may be relevant to the class explanation. one of the principal functions of metafind is to conduct such a 'post-feature selection' analysis step. the implementation of this as well as metafind's other functions will now be discussed in detail.

implementation
the metafind application contains several components which support the user in the:  reconstruction of the class discriminating metabolite signatures,  identification of additional relevant features omitted from the feature selection,  identification of correlated metabolites which may aid the inference of the metabolic correlations at play in the system under investigation.

the correlation graph
central to the metafind application is the correlation graph which provides a medium through which feature collinearity may be represented and analysed. in this graph the y-axis represents correlation. as this is derived from pearson's correlation, it may render both positive  and negative  correlations. the x-axis represents the binned regions or peak names assigned to a feature. see figure  <dig> for illustration.

the correlation graph enables the user to examine the intra-feature correlations between a feature retrieved by feature selection and the rest of features in the dataset. these features and the dataset are imported into metafind. as mentioned in the introduction, the features, or peaks, which are representative of a particular class discriminating metabolite should be highly correlated over samples . although this correlation may in some cases be reduced due to the cumulative effect of additional intensities in a region.

the user selects a reference feature to display from the imported list via a drop down menu above the correlation graph. apart from displaying the list of imported features, this drop down menu directs the user to features yet to be examined within the selected set . the currently displayed set of features  and the previously viewed features  are also highlighted in this list. this function is particularly useful when a large set  is imported. this function also means that a user may choose quite a liberal cut-off threshold during the initial feature selection stage.

should the current reference feature represent a peak from a metabolite signature, the user may render this signature at a certain correlation threshold. ordinarily the identification of this threshold and signature may prove a tedious pursuit with an investigator having to generate graphs at numerous correlation thresholds before happening upon the optimal rendering. however, metafind extends this correlation graph concept into an interactive application in which thresholds may be tweaked and assessed in real-time . this allows a rapid retrieval of the optimal metabolite signature and potentially aids the identification of class discriminating metabolites.

the current reference feature is projected as a red line in the correlation graph. correlated features above the chosen threshold appear as black lines  and green lines  of appropriate height  and position . green lines represent recommended features and may represent part or all of a relevant metabolite signature overlooked by feature selection. if the reference feature represents part of a metabolite the rest of the features within this signature should appear at an optimal threshold. as the correlation is lowered below the optimal threshold more peaks will appear. these peaks may appear above and below the x-axis representing positive and negative correlations respectively. correlated features may appear alone or in groups above the axis and may represent additional metabolite signatures which are positively correlated to the reference feature . these signatures may represent additional, correlated metabolites, which increase and decrease in tandem with the reference feature  and may help infer metabolic correlations. should these feature sets appear below the x-axis they may represent a negatively correlated metabolite signature. again these features may be projected as either black or green lines depending on their presence or absence from the initial imported list.

the interactive correlation graph also contains an additional zoom function which is very useful when displaying a high number of features . the user can then enlarge a region by simply clicking and dragging the cursor over the area of interest. having selected the appropriate resolution the user may then scroll left or right using the arrow buttons above the correlation graph. once a feature of interest is identified it may be further assessed by plotting its values over all samples. this is achieved by clicking on the projected feature which displays the feature plot.

the feature plot
the feature plot facility supports the user in determining the relevance of a feature of interest by examining how its values change over samples. in this way feature magnitude , class discrimination and outlying samples may be quickly examined. the metafind application also allows a feature plot to be retained on the desktop for reference and comparison with other features. in this way the user may also directly compare the feature vectors. this function is useful for determining the features which are representative of a single metabolite signature. the feature plot also contains a tool-tip function which allow feature identifiers to be displayed. lastly, the feature plot also provides the p-value for each feature in the form of the non-parametric kruskal-wallis statistic. although not demonstrated here, metafind may be used to analyse feature significance over multiple sample classes. for simultaneous assessment of all currently displayed features the heatmap function may be also be used.

the heatmap
the heatmap displays a colour representation of the values of all currently displayed features over all currently displayed samples. this function provides an alternative way to rapidly assess many features simultaneously. this display is also interactive returning feature names and values for individual samples. in practice the heatmap allows the user to rapidly assess the class separation and correlation of hundreds of features and direct the user to regions of interest. the user may then carry out a more detailed examination of these regions using the correlation graph and the feature plot functions. the heatmap is activated by clicking on the heatmap button above the correlation graph and it appears below the graph on the screen.

the class spectrum
the class spectrum function in metafind allows the user to display the mean class values for the currently displayed features. this class spectrum plot allows the user to view the mean magnitude of features over a sample class and aids preliminary identification of peaks. this again contains a tool-tip interaction and fulfils a role similar to that of the heatmap in directing the user to general regions of interest. the class spectrum is activated by clicking on the class spectrum button above the correlation graph. once opened both the heatmap and the class spectrum displays are tied to the main correlation graph and dynamically change in response to the currently displayed features.

implementations
we used the r statistical computing language for the basic random forest implementation. this utilizes breiman's original fortran code for random forest and is also the most practical implementation available in having sufficient speed to handle the large features sets in metabolomics data. pls-da was carried out using simca-p+ . the metafind feature analysis application is implemented in java and utilizes the jfreechart and jcommons packages. metafind and related documentation are available at .

RESULTS
in this section we present an evaluation of the metafind application using two metabolomics datasets described in section  <dig> . the objective of this evaluation is to establish if metafind can support the feature selection and subsequent metabolite identification processes. we employ metafind in a post-feature selection capacity supporting diverse feature selection methods based on pls-da and random forests .

metabolomics data
two nmr datasets were used in the evaluation. the first dataset  is derived from a previously published study  <cit> . this dataset consists of  <dig> spectral profiles  over  <dig> spectral bins in the range  <dig> – <dig> ppm. there are three classes of dietary intake corresponding to three different dietary regimes. the second dataset  is derived from a nmr analysis of different brain region in rats . it consists of  <dig> spectral profiles over  <dig> spectral bins. the data contains  <dig> classes, pre-frontal cortex , hippocampus , cerebellum  and brain stem . a sample of this dataset is available to download with the matafind application at . for further details, including experimental parameters and conditions, see  <cit> .

metafind evaluation
post-feature selection analysis using metafind
in pls-da based feature selection using vip scores a cut-off threshold of  <dig> was used to select the most important features. in the case of the random forest feature selection technique the variable importance plot was used to aid threshold selection, see figure  <dig>  in the diet dataset a sharp drop over the first  <dig> or so features is clearly visible in feature importance plot. in this diet data the top  <dig> features were selected for further analysis. a similar method was used to direct the selection of the top  <dig> features in the brain tissue dataset. differing modes of threshold selection again create further diversity between the two feature selection methods used in this study. the aim of the remainder of this section is to evaluate how metafind performs when used in conjunction with these alternative feature selection strategies.

dataset 1: diet study
the features selected by pls-da for dataset  <dig> were imported into the metafind application. features selected as being discriminating between classes day  <dig> and day  <dig> were first examined. the metabolite signature modelling aspect of metafind can be seen in figure  <dig>  feature  <dig>   was selected as the reference feature and the correlation threshold was gradually lowered using the correlation slider. the first most highly correlated  features to appear are those that represent hippurate . as the correlation is further lowered the first features to appear below the x-axis are  <dig>  and  <dig>  which represent creatinine. feature plots were then generated for  <dig>  and  <dig>   and showed these were present at a higher intensities on day  <dig> compared to day  <dig>  features representing creatinine  are present at lower levels on day  <dig> than on day  <dig>  feature plots for these features are shown on the bottom right. the correlation plot suggest that the intensity of the features representing each metabolite may be anti-correlated. several recommended features are also highlighted in green. in the region  <dig> – <dig>  ppm, as shown in figure  <dig>  the feature plot for the recommended feature  <dig>   is displayed. further investigation assigned this to nicotinic acid. this is an example of a feature overlooked during the initial pls-da feature selection that was representative of a metabolite that shows some class discrimination , illustrating the potential benefit of the feature discovery aspect of metafind. apart from using the feature plot, recommended features may be assessed via the class spectrum, as shown bottom right in figure  <dig>  this can be used for a preliminary assessment of the feature class separation. the investigator may then return to the original spectral data for confirmation. further features uncovered by metafind are presented in table  <dig> and figure  <dig> 

represented below are the initial features selected by pls-da  and random forest  feature selection techniques, denoted by fs for classes day  <dig> vs. day  <dig> and day  <dig> vs. day  <dig> in dataset  <dig>  also represented in bold are the additional features discovered by metafind, denoted by mf. the asterisk signifies those additional features discovered by metafind that were identified as being representative of all or part of a class discriminating metabolite. the original vip scores/rf importance rank  of the features discovered by metafind are also given.

dataset 2: brain region study
feature selection was carried out on dataset  <dig> for each brain region class comparison. dataset  <dig> contains many more features than dataset  <dig> and as a result a greater number of significant features are retrieved by pls-da and random forest feature selection methods. pls-da selected  <dig> features that discriminated between the brain stem and cerebellum classes,  <dig> features for the brain stem and hippocampus classes and  <dig> for the hippocampus and cerebellum classes. random forest feature selection retrieved  <dig> discriminating features for each class comparison.

metafind was then used to carry out post-feature selection analysis. figure  <dig> shows the correlation graph after the features selected by pls-da were imported. the cerebellum and hippocampus class comparison was first examined. the reference feature is  <dig>   represents part of the lactate signature . lactate is present at higher levels in the cerebellum compared to the hippocampus. as the correlation threshold is lowered the rest of the lactate signature appears first. this is followed by the myo-inositol  signature and creatinine signature  above the x-axis  and the nag  signature and glutamine/glutamate  signature  below the x-axis . additional discriminating features  were recommended by metafind for this class comparison and can be seen in table  <dig>  all features represent peaks and separate the classes fully . additional recommended features, recommended after random forest feature selection may also be seen in table  <dig>  those marked with an asterisk represent verified peaks missed by random forest feature selection but caught by metafind post-feature selection analysis.

additional class discriminating features recommended by metafind after initial pls-da  and random forest  feature selection for the cerebellum vs. hippocampus class comparison . the metafind column shows class discriminating features that were retrieved using the metafind application. an asterisk signifies that the feature represents part of a metabolite with a known assignment. the original vip scores/rf importance rank  of the features discovered by metafind are also given.

in table  <dig>  brain stem vs. cerebellum comparison,  <dig> additional features were recommended by metafind after importing features selected by pls-da. most features separated the classes fully . of these  <dig>  ppm,  <dig>  ppm,  <dig>  ppm peaks belong to gaba. additional features  were also uncovered by metafind upon importing those retrieved by random forest feature selection. these included features which represented the lactate, naa and taurine metabolites . similar results can be seen in table  <dig>  with metafind recommending additional discriminating peaks for brain stem vs. hippocampus comparison, for both pls-da and rf feature selection methods. in table  <dig> metafind aids retrieval of part of the glu/gln peak signature which was omitted by the initial feature selection. the feature plot showing the class separation of these peaks is illustrated in figure  <dig> 

additional class discriminating features retrieved using metafind after initial pls-da, vip cut-off ≥  <dig>  and random forest  feature selection for the brain stem vs. cerebellum class comparison . the metafind column shows class discriminating features that were retrieved using the metafind application. an asterisk signifies that the feature represents part of a metabolite with a known assignment. the original vip scores/rf importance rank  of the features discovered by metafind are also given.

additional class discriminating features recommended by metafind after initial pls-da, vip cut-off ≥  <dig>  and random forest  feature selection for the brain stem vs. hippocampus class comparison . the metafind column shows class discriminating features that were retrieved using the metafind application. an asterisk signifies that the feature represents part of a metabolite with a known assignment. the original vip scores/rf importance rank  of the features discovered by metafind are also given.

CONCLUSIONS
the high dimensionality and multi-collinear nature of metabolomics data provides a significant challenge for both feature selection and subsequent metabolite annotation. these issues combined with other factors such as experimental noise, scaling and threshold selection may lead to the omission of features relevant to class explanation. to address this risk we have developed the metafind application to enable the investigator to carry out an effective 'post-feature selection' correlation analysis. metafind supports the user in metabolite signature identification, feature discovery and may aid inference of metabolic relationships by identifying highly correlated metabolites.

in this study two diverse feature selection methods, namely pls-da and random forest, were applied to two metabolomics datasets. in all cases the metafind application aided retrieval of additional class discriminating peaks, some of which were subsequently found to represent relevant class discriminating metabolites. lastly, metafind supports the investigator in the discovery of correlated metabolites, this information may then aid in the construction of networks. this study has illustrated that the performance of data-driven feature selection methods may be augmented by additional user-driven input as supported by the metafind application.

competing interests
the authors declare that they have no competing interests.

availability and requirements
project home page: 

operating systems: platform independent

programming language: java

software packages: jfreechart and jcommons

any restrictions to use by non-academics: commercial use license can be obtained by contacting the authors

authors' contributions
kb carried out the programming and software design and drafted the manuscript. lb provided domain knowledge, data and application testing and helped to draft the manuscript. pc conceived of the study, and participated in its design and coordination and helped to draft the manuscript. all authors read and approved the final manuscript.

